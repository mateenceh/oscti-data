<!DOCTYPE html>
<html lang="en">

<head>
	

	


	

	<!--trying to figure out the canonical url issue with blogs-->
	<link rel="canonical" href="https://cybersecurity.att.com/blogs/labs-research/hunting-for-linux-library-injection-with-osquery" />

	<title>Hunting for Linux library injection with Osquery | AT&T Alien Labs</title>

	

		

	<meta property="og:site_name" value="AT&T Cybersecurity" />
	<meta property="og:title" content="Hunting for Linux library injection with Osquery" />
	<meta property="og:url" content="https://cybersecurity.att.com/blogs/labs-research/hunting-for-linux-library-injection-with-osquery" />
	
	<meta property="og:description" content="When analyzing malware and adversary activity in Windows environments, DLL injection techniques are commonly used, and there are plenty of resources on how to detect these activities.

When it comes to Linux, this is less commonly seen in the wild.

I recently came across a great blog from TrustedSec that describes a few techniques and tools that can be used to do library injection in Linux. In this blog post, we are going to review some of those techniques and focus on how we can hunt for them " />
		



	<meta charset="utf-8">

<link rel="preconnect" href="https://cdn-cybersecurity.att.com" />
<link rel="preconnect" href="https://www.att.com" />
<link rel="preconnect" href="https://www.googletagmanager.com" crossorigin />
<link rel="preconnect" href="https://cdn.vidyard.com" crossorigin />
<link rel="preconnect" href="https://ajax.cloudflare.com" crossorigin />
<link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin />
<link rel="preconnect" href="https://googleads.g.doubleclick.net" crossorigin />
<link rel="preconnect" href="https://www.google-analytics.com" crossorigin />
<link rel="preconnect" href="https://play.vidyard.com" crossorigin />
<link rel="preconnect" href="https://adservice.google.com" crossorigin />
<link rel="preconnect" href="https://www.googleadservices.com" crossorigin />
<link rel="preconnect" href="https://www.facebook.com" crossorigin />
<link rel="preconnect" href="https://www.google.com" crossorigin />
<link rel="preconnect" href="https://px.ads.linkedin.com" crossorigin />


<script src="https://cdn-cybersecurity.att.com/js/v2/imports/top-bundle.min.js?v=20210316522111"></script>


<link rel="preload" href="https://www.att.com/scripts/adobe/prod/edmDataDefinition.js" as="script">
<link rel="preload" href="https://www.att.com/scripts/adobe/prod/edmDataManager.js" as="script">
<link rel="preload" href="https://www.att.com/scripts/adobe/prod/marketing.min.js" as="script">
<link rel="preload" href="https://www.att.com/scripts/adobe/prod/detm_adobe.js" as="script">






<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KLJDXJN');</script>
<!-- End Google Tag Manager -->
<script src='https://www.att.com/scripts/adobe/prod/detm-container-hdr.js' data-restrictions='target' type='text/javascript'></script>


<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="ahrefs-site-verification" content="a6fa0378625f72f89c6f290c3c7559ffee326fb9232cd87fcace798afce3e30d">
<meta name="google-site-verification" content="GTQZz4AGa47UtmP64oC5BB735pkyncjtISHOcQZbIho" />

<link rel="preload" as="font" type="font/ttf" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/zero-width.ttf" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Bold.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Regular.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Light.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Medium.woff2" />


<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-LightItalic.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-BoldItalic.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-MediumItalic.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Italic.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Black.woff2" />

<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/css/fonts/glyphicons-halflings-regular.woff2" />
<link rel="preload" as="font" type="font/ttf" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/av-icons.ttf?e81fxl" />



<link rel="preload" as="style" href="https://cdn-cybersecurity.att.com/css/sass/main.min.css?v=20210316522111" />
<link rel="apple-touch-icon" sizes="144x144" href="https://cdn-cybersecurity.att.com/images/uploads/apple-touch-icon.png"/>
<link rel="icon" type="image/png" sizes="32x32" href="https://cdn-cybersecurity.att.com/images/uploads/favicon.ico"/>
<link rel="shortcut icon" href="https://cdn-cybersecurity.att.com/images/uploads/favicon.ico">
<link rel="manifest" href="https://cdn-cybersecurity.att.com/manifest.json">

<link rel="stylesheet" href="https://cdn-cybersecurity.att.com/css/sass/main.min.css?v=20210316522111" />








<script>
	if (typeof ddo !== "undefined") {
		$(document).ready(function() {
		
		

		
		
		});
	}

	function initAdobePageTrackingHeader() {
		ddo.disableAutoPageLoad();
		
		ddo.setVar('page.location.url','/blogs/labs-research/hunting-for-linux-library-injection-with-osquery');


		
		ddo.setVar('page.pageInfo.pageTitle', document.title.trim());


		 
		ddo.setVar('page.pageInfo.friendlyPageName','CYB '+ document.title.trim() +' Pg');


		
		
			ddo.setVar('page.category.siteSubSection1','blogs');
		


		
		
			ddo.setVar('page.category.siteSubSection2','labs-research');
		



		
		
			ddo.setVar('page.category.siteSubSection3','hunting-for-linux-library-injection-with-osquery');
		


		
		

		
		
	}
</script>


<script type="text/javascript">
    var _elqQ = _elqQ || [];
    _elqQ.push(['elqSetSiteId', '1086385399']);

    _elqQ.push(['elqUseFirstPartyCookie', 'cyber-tracking.att.com']);

    _elqQ.push(['elqTrackPageView', window.location.href]);

    (function () {
        function async_load() {
            var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true;
            s.src = '//img03.en25.com/i/elqCfg.min.js';
            var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x);
        }
        if (window.addEventListener) window.addEventListener('DOMContentLoaded', async_load, false);
        else if (window.attachEvent) window.attachEvent('onload', async_load);
    })();
</script>


	<link rel="alternate" type="application/rss+xml" title="AlienVault Open Threat Exchange Blog" href="http://feeds.feedblitz.com/alienvaultotx&x=1" />

	<style>
	.blog-author-info {
		width: 70%;
		float: left;
		color: #191919;
	}

	.blog-subscribe-grid ul {
		margin-left: 0px;
		margin-bottom: 0px;
		padding-left: 0px;
	}

	.blog-subscribe-grid ul li {
		list-style-type: none;
		line-height: 20px;
	}

	.blog-subscribe-grid ul li a {
		color: #c6ced5;
		font-size: 14px;
		text-decoration: none;
	}

	.blog-subscribe-grid ul li a:hover {
		text-decoration: underline;
	}

	.blog-content-area img {
		width: 100%!important;
		height: auto!important;
	}

	.blog-promo-item {
		clear: both;
		overflow: hidden;
		margin-bottom: 30px;
	}
	.promo-block .small {
		text-transform: uppercase;
	}

	.blog-promo-item-text {
		width: 345px;
		float: left;
		max-width:100%;
	}

	.blog-promo-item p {
		margin-bottom: 0px!important;
	}






	#blog-promo-block {
		padding-top: 20px;
	}



	/*promo block and sticky classes*/

	.sticky-sidebar {
		top: 147px;
		position: -webkit-sticky; /* Safari */
		position: sticky;
	}
	     .sidebar-search {
			 margin-bottom: 30px;
		 }

         .sidebar-search .search-button {
                width: 100%;
                position: relative;
            }

            .sidebar-search .search-button input {
                padding: 0px;
                margin: 2px 0px 0px 0px;
                position: absolute;
                background: url(https://cdn-cybersecurity.att.com/images/icn-sidebar-search.png) top left no-repeat;
                background-size: 25px 25px;
                width: 25px;
                height: 25px;
                cursor: pointer;
                text-indent: -9999em;
                border: none;
                left: 10px;
                top: 6px;
             }

			.sidebar-search .search-field input {
                border: 0;
                width: 100%;
                height: 30px;
                padding-left: 50px;
				margin-top: 5px;
            }

            .sidebar-search .search-field {
                border: 1px solid #CCCCCC;
                width: 100%;
                height: 40px;
            }

            #q::placeholder {
          		color: #767676!important;
            }

            #blog-subscribe-box {
			height:auto;
            padding: 32px;
            background-image: url('https://cdn-cybersecurity.att.com/images/uploads/backgrounds/blog-email-subscribe-bkg.jpg');
            background-size: cover;
            }

            #blog-subscribe-box h2 {
            color: #fff;
            font-size:32px;
            }

			#blog-subscribe-box p {
				margin-bottom: 10px;
			}






	@media (max-width: 991px) {
            .sidebar-search .search-button input {
                padding: 0px;
                background: transparent;
                cursor: pointer;
                text-indent: -9999em;
                border: none;
                right: 5px;
                top: 5px;
                padding-left: 0px;
             }

            .sidebar-search .search-field input {
             padding-left: 15px;
             }


            }

            	@media (min-width: 768px) and (max-width: 920px){
	.blog-subscribe-grid .btn {
		border-radius: 24px;
	    font-size: 12px;
	    line-height: 18px;
	    border: none;
	    padding: 6px 36px;
	    height: 30px;
	    font-weight: 500;
	}
}


		.blog-content-area p,
		.blog-content-area ul li,
		.blog-content-area ol li{
			font-size: 16px;
			line-height: 20px;
			font-weight: 400;
		}
		.blog-content-area ul li,
		.blog-content-area ol li {
			margin-bottom: 10px;
		}

	</style>

</head>

	<body class="listing-blog-entry-id-6164">
			<!-- Google Tag Manager (noscript) -->
<noscript><iframe src='https://www.googletagmanager.com/ns.html?id=GTM-KLJDXJN'
height='0' width='0' style='display:none;visibility:hidden'></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<script src='https://www.att.com/scripts/adobe/prod/detm-container-ftr.js' type='text/javascript'></script>


		<header id="header" class="navbar navbar-fixed-top">

	<style>
@media (max-width: 543px) {
	.hide-on-mobile {
		display: none;
	}
}
</style>

<div id="news-banner" style="background-color: #1A2027!important;">
    <div class="container-fluid">
        <div class="row vcenter">
            <div class="col-sm-12">

                <div id="news-headline-link">
                    <a href="/resource-center/industry-reports/cybersecurity-insights-report-tenth-edition" style="color: #009FDB;"><span class="caps"><strong>AT&T Cybersecurity Insights™ Report:</strong></span></a> <span class="text-white caps  hide-on-mobile" style="margin-right: 20px;">5G and the Journey to the Edge</span> <a class="text-white" href="/resource-center/industry-reports/cybersecurity-insights-report-tenth-edition">Learn more ⟶</a>
                </div>
				<div id="search-contact">
					<ul class="list-unstyled header_nav_top_list">
						<li class="header_nav_top_list_item"><a id="top-nav-support" href="/support">Support</a></li>
						<li class="header_nav_top_list_item"><a id="top-nav-contact" href="/contact">Contact</a></li>
						<li class="header_nav_top_list_item search">
							<a href="#" class="header_nav_toggle-search" aria-label="Search">
								<!-- <span class="hide-on-active"><img src="https://cdn-cybersecurity.att.com/images/uploads/nav/search.png"></span>
								<span class="show-on-active"><img src="https://cdn-cybersecurity.att.com/images/uploads/nav/search.png"></span> -->
								<span class="hide-on-active glyphicon glyphicon-search" aria-hidden="true"></span>
								<span class="show-on-active glyphicon glyphicon-search" aria-hidden="true"></span>
							</a>
							<form action="/search-results" method="get" id="top-search-form" __bizdiag="113" __biza="WJ__"><input name="q" id="top-search-form-text" type="text" placeholder="Search Now...." aria-label="Search"><button class="sr-only" type="submit">Search</button></form>
						</li>
					</ul>
				</div>
            </div>
        </div>
    </div>
</div>






	<div id="header-container" class="container-fluid">
		<div id="header-logo">
			<div class="logo-globe"><a href="https://business.att.com" target="_blank"><img src="https://cdn-cybersecurity.att.com/images/uploads/logos/att-globe.svg" alt="AT&amp;T Business" /></a></div>
			<div class="att-business"><a href="https://business.att.com" target="_blank"><img src="https://cdn-cybersecurity.att.com/images/uploads/logos/att-business-web.svg" alt="AT&amp;T Business" /></a></div>
			<div class="att-cybersecurity"><a href="/"><img src="https://cdn-cybersecurity.att.com/images/uploads/logos/att-cybersecurity-web.svg" alt="AT&amp;T Cybersecurity" /></a></div>
		</div>

		<button type="button" class="header_toggle_nav navbar-toggle collapsed" data-toggle="collapse" data-target="#header-nav" aria-expanded="false">
			<span class="sr-only">Toggle navigation</span>
			<span class="avicon avicon-bars"></span>
			<span class="avicon avicon-close"></span>
		</button>
		
		
			<a href="/contact" id="header-cta" class="hidden-md hidden-lg btn btn-blue btn-sm">Contact us</a>
		

		<nav class="navbar-collapse collapse" id="header-nav">
			<ul class="nav navbar-nav list-unstyled">
				<li class="nav-item has-dd products">
					<a id="main-nav-products" href="/products" class="dropdown-toggle" data-toggle="collapse" role="button" aria-expanded="false" data-target="#products-dd">Products<span class="glyphicon glyphicon-chevron-up"></span><span class="glyphicon glyphicon-chevron-down"></span>
					</a>
					<div class="nav-dropdown collapse" id="products-dd">
						<div class="dd-multi-col container-fluid">
							<ul class="list-unstyled sub-nav">
									<li id="first-sub-cyber-strategy-risk"><a href="/categories/cybersecurity-consulting-services" class="first-level">Cybersecurity Consulting Services</a>
										<div class="desktop-subnav open">
											<ul class="list-unstyled">
												<li class="second-sub-heading">Cyber Strategy</li>
												<li class="second-sub-link"><a href="/products/strategy-and-roadmap">Strategy and Roadmap Planning</a></li>

												<li class="second-sub-link"><a href="/products/security-assessment">Enterprise Security Assessment Services</a></li>
												<li class="second-sub-link"><a href="/products/risk-based-cyber-posture-assessment">Risk-based Cyber Posture Assessment</a></li>
											</ul>
											<ul class="list-unstyled">
												<li class="second-sub-heading">Risk and Compliance</li>
												<li class="second-sub-link"><a href="/products/security-compliance">Security Compliance</a></li>
											</ul>
											<ul class="list-unstyled">
												<li class="second-sub-heading">Vulnerability and Threat Management</li>
												<li class="second-sub-link"><a href="/products/vulnerability-scanning">Vulnerability Scanning</a></li>
												<li class="second-sub-link"><a href="/products/penetration-testing-services">Penetration Testing</a></li>
												<li class="second-sub-link"><a href="/products/adversary-simulation-service">Adversary Simulation Services</a></li>

											</ul>
											<ul class="list-unstyled">
												<li class="second-sub-heading">CSO Advisory Services</li>
												<li class="second-sub-link"><a href="/products/cybersecurity-iq-training">Cybersecurity IQ Training</a></li>
											</ul>
										</div>
										<div class="mobile-subnav">
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-link"><a href="/products/strategy-and-roadmap">Strategy and Roadmap Planning</a></li>
												<li class="second-sub-link"><a href="/products/security-assessment">Enterprise Security Assessment Services</a></li>
												<li class="second-sub-link"><a href="/products/risk-based-cyber-posture-assessment">Risk-based Cyber Posture Assessment</a></li>

												<li class="second-sub-link"><a href="/products/security-compliance">Security Compliance</a></li>

												<li class="second-sub-link"><a href="/products/vulnerability-scanning">Vulnerability Scanning</a></li>

												<li class="second-sub-link"><a href="/products/penetration-testing-services">Penetration Testing</a></li>
												<li class="second-sub-link"><a href="/products/adversary-simulation-service">Adversary Simulation Services</a></li>
												<li class="second-sub-link"><a href="/products/cybersecurity-iq-training">Cybersecurity IQ Training</a></li>
											</ul>
										</div>
									</li>
									<li id="first-sub-network-security"><a href="/categories/network-security" class="first-level">Network Security</a>
										<div class="desktop-subnav">
											<ul class="list-unstyled">
												<li class="second-sub-heading">AT&T Trusted Internet Access</li>
												<li class="second-sub-link"><a href="/products/global-security-gateway">Global Security Gateway</a></li>
												<li class="second-sub-link"><a href="/products/network-based-firewall">Network Based Firewalls</a></li>
												<li class="second-sub-link"><a href="/products/premises-based-firewall">Premises Based Firewalls</a></li>
												<li class="second-sub-link"><a href="/products/enhanced-access-security">Enhanced Cybersecurity Services</a></li>
											</ul>
											<ul class="list-unstyled">
												<li class="second-sub-heading">AT&T Infrastructure and Application Protection</li>
												<li class="second-sub-link"><a href="/products/reactive-ddos-services">Reactive Distributed Denial of Service Defense</a></li>
												<li class="second-sub-link"><a href="/products/application-layer-security">AT&T Application Layer Security</a></li>
											</ul>
										</div>
										<div class="mobile-subnav">
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">AT&T Trusted Internet Access</li>
												<li class="second-sub-link"><a href="/products/global-security-gateway">Global Security Gateway</a></li>
												<li class="second-sub-link"><a href="/products/network-based-firewall">Network Based Firewalls</a></li>
												<li class="second-sub-link"><a href="/products/premises-based-firewall">Premises Based Firewalls</a></li>
												<li class="second-sub-link"><a href="/products/enhanced-access-security">Enhanced Cybersecurity Services</a></li>

												<li class="second-sub-heading">AT&T Infrastructure and Application Protection</li>
												<li class="second-sub-link"><a href="/products/reactive-ddos-services">Reactive Distributed Denial of Service Defense</a></li>
												<li class="second-sub-link"><a href="/products/application-layer-security">AT&T Application Layer Security</a></li>
											</ul>
										</div>
									</li>
									<li id="first-sub-unified-endpoint"><a href="/categories/endpoint-security" class="first-level">Endpoint Security</a>
										<div class="desktop-subnav">
											<ul class="list-unstyled">
												<li class="second-sub-heading">Endpoint Security</li>
												<li class="second-sub-link"><a href="/products/sentinel-one">SentinelOne</a></li>
												<li class="second-sub-link"><a href="/products/mobile-iron">MobileIron</a></li>
												<li class="second-sub-link"><a href="/products/vmware">VMware Workspace ONE®</a></li>
												<li class="second-sub-link"><a href="/products/ibm-maas360">IBM MaaS360</a></li>
												<li class="second-sub-link"><a href="/products/lookout">Lookout Mobile Endpoint Security</a></li>
												<li class="second-sub-link"><a href="/products/mcafee-endpoint-protection">McAfee Endpoint Protection</a></li>
											</ul>
										</div>
										<div class="mobile-subnav">
											<ul class="list-unstyled sub-nav">
													<li class="second-sub-link"><a href="/products/sentinel-one">SentinelOne</a></li>
													<li class="second-sub-link"><a href="/products/mobile-iron">MobileIron</a></li>
													<li class="second-sub-link"><a href="/products/vmware">VMware Workspace ONE®</a></li>
													<li class="second-sub-link"><a href="/products/ibm-maas360">IBM MaaS360</a></li>
													<li class="second-sub-link"><a href="/products/lookout">Lookout Mobile Endpoint Security</a></li>
													<li class="second-sub-link"><a href="/products/mcafee-endpoint-protection">McAfee Endpoint Protection</a></li>
											</ul>
										</div>
									</li>
									<li id="first-sub-threat-detection-response"><a href="/categories/threat-detection-and-response" class="first-level">Threat Detection and Response</a>
										<div class="desktop-subnav">
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">Strategy, Assessment and Planning</li>
												<li class="second-sub-link"><a href="/products/incident-response">Incident Response and Forensics</a></li>
											</ul>
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">AT&T Threat Solutions</li>
												<li class="second-sub-link"><a href="/products/managed-threat-detection-and-response">Managed Threat Detection and Response</a></li>
												<li class="second-sub-link"><a href="/products/usm-anywhere">USM Anywhere</a></li>
												<li class="second-sub-link"><a href="/products/usm-for-mssp">USM for MSSPs</a></li>
											</ul>
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">Free Tools</li>
												<li class="second-sub-link"><a href="/open-threat-exchange">Open Threat Exchange</a></li>
												<li class="second-sub-link"><a href="/products/ossim">OSSIM</a></li>
											</ul>
										</div>
										<div class="mobile-subnav">
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">Strategy, Assessment and Planning</li>
												<li class="second-sub-link"><a href="/products/incident-response">Incident Response and Forensics</a></li>

												<li class="second-sub-heading">AT&T Threat Solutions</li>
												<li class="second-sub-link"><a href="/products/managed-threat-detection-and-response">Managed Threat Detection and Response</a></li>
												<li class="second-sub-link"><a href="/products/usm-anywhere">USM Anywhere</a></li>
												<li class="second-sub-link"><a href="/products/usm-for-mssp">USM for MSSPs</a></li>

												<li class="second-sub-heading">Free Tools</li>
												<li class="second-sub-link"><a href="/open-threat-exchange">Open Threat Exchange</a></li>
												<li class="second-sub-link"><a href="/products/ossim">OSSIM</a></li>
											</ul>
										</div>
									</li>
							</ul>
						</div>
						<!--<div class="dd-bottom visible-lg" id="view-all-products">
							<div class="container-fluid">
								<a href="/products">
									<span class="view-all-text">View All Products &LongRightArrow;</span>
								</a>
							</div>
						</div>-->
					</div>
				</li>
				<li class="nav-item has-dd solutions">
					<a id="main-nav-solutions" href="/solutions" class="dropdown-toggle" data-toggle="collapse" role="button" aria-expanded="false" data-target="#solutions-dd">Solutions<span class="glyphicon glyphicon-chevron-up"></span><span class="glyphicon glyphicon-chevron-down"></span></a>
					<div class="nav-dropdown collapse" id="solutions-dd">
						<div class="dd-multi-col container-fluid">
							<ul class="list-unstyled sub-nav hidden-md hidden-lg">
								<li><a id="main-nav-see-all-solutions-mobile" href="/solutions" class="header_nav_link">See All Solutions</a></li>
							</ul>
							<div id="compliance">
								<div class="menu-header">Compliance</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/solutions/it-compliance-management">Overview</a></li>
									<li><a href="/solutions/gdpr-compliance">GDPR</a></li>
									<li><a href="/solutions/hipaa-compliance">HIPAA</a></li>
									<li><a href="/solutions/iso-27001-compliance">ISO 27001</a></li>
									<li><a href="/solutions/pci-dss-compliance">PCI DSS</a></li>
									<li><a href="/solutions/soc-2-compliance">SOC 2</a></li>
								</ul>
							</div>
							<div id="industry">
								<div class="menu-header">Industry</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/solutions/education">Education</a></li>
									<li><a href="/solutions/energy-sector-security">Energy Sector</a></li>
									<li><a href="/solutions/government">Federal</a></li>
									<li><a href="/solutions/financial-services">Financial Services</a></li>
									<li><a href="/solutions/healthcare">Healthcare</a></li>
									<li><a href="/solutions/manufacturing">Manufacturing</a></li>
									<li><a href="/partners/mssp-program">MSSPs</a></li>
									<li><a href="/solutions/retail">Retail</a></li>
								</ul>
							</div>
							<div id="environment">
								<div class="menu-header">Environment</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/solutions/aws-security-and-compliance-management">AWS</a></li>
									<li><a href="/solutions/azure-security-and-compliance-management">Azure</a></li>
									<li><a href="/solutions/cloud-security">Cloud</a></li>
									<li><a href="/solutions/iot-and-mobility-security">IOT/Mobility</a></li>
									<li><a href="/solutions/hybrid-cloud-security">Hybrid</a></li>
									<li><a href="/solutions/network-security">Network</a></li>
									<li><a href="/solutions/remote-workforce-security">Remote Workforce</a></li>

								</ul>
							</div>
							<div id="core-capabilities">
								<div class="menu-header">Security Use Cases</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/solutions/asset-discovery-inventory">Asset Discovery</a></li>
									<li><a href="/solutions/endpoint-detection-and-response">Endpoint Detection &amp; Response</a></li>
									<li><a href="/solutions/intrusion-detection-system">Intrusion Detection</a></li>
									<li><a href="/solutions/secure-access-service-edge">Secure Access Service Edge</a></li>
									<li><a href="/solutions/secure-web-gateway">Secure Web Gateway</a></li>
									<li><a href="/solutions/siem-platform-solutions ">SIEM Platform Solutions</a></li>
									<li><a href="/solutions/threat-detection">Threat Detection</a></li>
									<li><a href="/solutions/threat-intelligence">Threat Intelligence</a></li>
									<li><a href="/solutions/zero-trust-architecture">Zero Trust Architecture</a></li>

								</ul>
							</div>
						</div>
						<div class="dd-bottom visible-lg" id="view-all-solutions">
							<div class="container-fluid">
								<a href="/solutions">
									<span class="view-all-text">View All Solutions &LongRightArrow;</span>
								</a>
							</div>
						</div>
					</div>
				</li>
				<li class="nav-item partners">
					<a id="main-nav-partners" href="/partners" class="dropdown-toggle" role="button" aria-expanded="false" data-target="#partners-dd">Partners</a>
					<div class="nav-dropdown collapse visible-lg" id="partners-dd">
						<div class="dd-multi-col container-fluid">
							<div id="become-a-partner">
								<div class="menu-header">Become a Partner</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/partners">All Partner Programs</a></li>
									<li><a href="/partners/mssp-program">MSSP Program</a></li>
									<li><a href="/partners/resellers">Reseller Program</a></li>
									<li><a href="/partners/partner-portal/">Partner Portal Login</a></li>
								</ul>
							</div>

							<div id="find-a-partner">
								<div class="menu-header">Find a Partner</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/products/managed-security-services">Partner Managed Solutions</a></li>
									<li><a href="/partners/find-partner">Find an MSSP</a></li>
									<li><a href="/partners/locator">Find a Reseller</a></li>
									<li><a href="/partners/certified-implementation-partners">Professional Services</a></li>
								</ul>
							</div>
							<div id="technology-partners">
								<div class="menu-header">Technology Partners</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/app">USM Anywhere Integrations</a></li>
									<li><a href="/partners/technology-partners">OTX Partners</a></li>
								</ul>
							</div>
						</div>
						<div class="dd-bottom visible-lg" id="view-all-partners">
							<div class="container-fluid">
								<a href="/partners/become-a-partner">
									<span class="view-all-text">Become a Partner &LongRightArrow;</span>
								</a>
							</div>
						</div>
					</div>
				</li>
				<li class="nav-item has-dd resources">
					<a id="main-nav-resources" href="/resource-center#language_en" class="dropdown-toggle" data-toggle="collapse" role="button" aria-expanded="false" data-target="#resources-dd">Resources<span class="glyphicon glyphicon-chevron-up"></span><span class="glyphicon glyphicon-chevron-down"></span></a>
					<div class="nav-dropdown collapse" id="resources-dd">
						<div class="dd-multi-col container-fluid">

							<div id="resources-menu-image" class="visible-lg">
								<img src="https://cdn-cybersecurity.att.com/images/uploads/thehub-thumbnail.jpg">
								<p>Explore The Hub, our home for all virtual experiences</p>
								<a href="https://hub.att.com/expo-hall/cybersecurity/">Explore now ⟶</a>
							</div>

							<ul class="list-unstyled sub-nav hidden-md hidden-lg">
								<li><a id="main-nav-resources-mobile" href="/resource-center#language_en">View All Resources</a></li>

							</ul>

							<div id="product-resources">
								<div class="menu-header">Product Resources</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/resource-center#content_customer-stories">Customer Stories</a></li>
									<li><a href="/resource-center#content_product-brief">Product Briefs</a></li>
									<li><a href="/resource-center#content_product-demo">Product Demos</a></li>
									<li><a href="/resource-center#content_product-review">Product Reviews</a></li>
									<li><a href="/resource-center#content_solution-brief">Solution Briefs</a></li>
									<li><a href="/resource-center#content_use-cases">Use Cases</a></li>

									<li><a id="free-trial" href="/products/usm-anywhere/free-trial">Free Trial</a></li>
								</ul>
							</div>
							<div id="security-resources">
								<div class="menu-header">Security Resources</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/resource-center#content_analyst-reports">Analyst Reports</a></li>
									<li><a href="/blogs">Blogs</a></li>
									<li><a href="/resource-center#content_ebook">eBooks</a></li>
									<li><a href="/resource-center#content_video">Videos</a></li>
									<li><a href="/resource-center#content_webcast">Webcasts</a></li>
									<li><a href="/resource-center#content_white-paper">White Papers</a></li>
									<li><a href="/resource-center#content_industry-reports">Industry Reports</a></li>
								</ul>
							</div>
							<div id="customer-resources">
								<div class="menu-header">Customer Resources</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="https://success.alienvault.com/">Success Center</a></li>
									<li><a href="/certification">Certification</a></li>
									<li><a href="/customer-success">Customer Success</a></li>
									<li><a href="/documentation">Documentation</a></li>
									<li><a href="/partners/certified-implementation-partners">Professional Services</a></li>
									<li><a href="/support">Support Overview</a></li>
									<li><a href="/training">Training</a></li>
								</ul>
							</div>
							<div id="browse-by-topic">
								<div class="menu-header">Browse by Topic</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/resource-center#category_incident-response">Incident Response</a></li>
									<li><a href="/resource-center#category_intrusion-detection">Intrusion Detection</a></li>
									<li><a href="/resource-center#category_partner-mssp-reseller">Partner: MSSP &amp; Reseller</a></li>
									<li><a href="/resource-center#category_regulatory-compliance">Regulatory Compliance</a></li>
									<li><a href="/resource-center#category_soc">Security Operations Center</a></li>
									<li><a href="/resource-center#category_siem-log-management">SIEM &amp; Log Management </a></li>
									<li><a href="/resource-center#category_threat-detection">Threat Detection</a></li>
									<li><a href="/resource-center#category_threat-intelligence">Threat Intelligence</a></li>
								</ul>
							</div>
						</div>

						<div class="dd-bottom visible-lg" id="view-all-resources">
							<div class="container-fluid">
								<a href="/resource-center#language_en">
									<span class="view-all-text">View All Resources &LongRightArrow;</span>
								</a>
							</div>
						</div>

					</div>
				</li>
				<li class="nav-item alien-labs">
					<a id="main-nav-alien-labs" href="/alien-labs" class="">AT&T Alien Labs</a>
				</li>
				<li class="nav-item support visible-sm visible-xs">
					<a id="main-nav-support" href="/support">Support</a>
				</li>
			</ul>
		</nav>

	</div>

	<div class="container-fluid visible-md visible-lg">
		
		
			<a id="main-nav-free-tools" class="header-nav-btn btn margin-bottom10" href="/products/usm-anywhere/free-trial">Free trial</a>
		


	</div>
</header>

						




			<main class="blog-detail">

				<div class="full-width-block top-content-width-bg" style="background-image: url('https://cdn-cybersecurity.att.com/blog-content/Blog-Images/hero/malware-red-sphere-2500x405.jpg'); background-position: top center; background-repeat: no-repeat; background-color: #000; background-size: 2500px 405px; min-height: 405px;">
					<div class="container-fluid">
						<div class="row rowPad">
							<div class="all-blogs-cta"><a href="/blogs">‹ ALL BLOGS</a></div>
							<div class="category-label">
								
									<a href="/blogs/labs-research">Alien Labs</a>
								
							</div>
							<h1>Hunting for Linux library injection with Osquery</h1>
							<div class="date">June 20, 2019 | <a href="/blogs/author/jaime-blasco">Jaime Blasco</a></div>
						</div>
					</div>
				</div>

				<section class="full-width-block">

					<div class="container-fluid">

						<div class="row flx-container">
							<div class="col-sm-8">
								<div class="blog-content-area">
									<script id="marvel" data-customerid="f00000000037663" src="https://marvel-b2-cdn.bc0a.com/marvel.js"></script>

<p>When analyzing malware and adversary activity in Windows environments, <a href="https://attack.mitre.org/techniques/T1055/" target="_blank">DLL injection</a> techniques are commonly used, and there are plenty of resources on how to detect these activities.</p>

<p>When it comes to Linux, this is less commonly seen in the wild.</p>

<p>I recently came across a <a href="https://www.trustedsec.com/2018/09/linux-hows-my-memory/" target="_blank">great blog from TrustedSec</a> that describes a few techniques and tools that can be used to do library injection in Linux. In this blog post, we are going to review some of those techniques and focus on how we can hunt for them using Osquery.</p>

<h2><strong>LD_PRELOAD</strong></h2>

<p>LD_PRELOAD is the easiest and most popular way to load a shared library in a process at startup. This environmental variable can be configured with a path to the shared library to be loaded before any other shared object.</p>

<p>For most of the blog, we will be using the examples available in <a href="https://github.com/gaffe23/linux-inject" target="_blank">GitHub, listed here.</a></p>

<p>Let&rsquo;s use sample-target as the <a href="https://github.com/gaffe23/linux-inject/blob/master/sample-target.c" target="_blank">target process</a> and <a href="https://github.com/gaffe23/linux-inject/blob/master/sample-library.c" target="_blank">sample-library</a> as the shared library we will be injecting.</p>

<p>We can utilize the ldd tool to inspect the shared libraries that are loaded into a process. If we execute the sample-target binary with ldd we can see that information.</p>

<p align="center"><img alt="LD Preload to load a shared libary in a process at startup" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/LD_PRELOAD.png" /></p>

<p>Linux-vdso.so.1, is a <a href="http://man7.org/linux/man-pages/man7/vdso.7.html" target="_blank">virtual dynamic shared object</a> that the kernel automatically maps into the address space in every process. Depending on the architecture, it can have other names.</p>

<p align="center"><img alt="Virtual dynamic shared object" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/vDSO.png" /></p>

<p>Libc.so.6 is one of the dynamic libraries that the sample-target requires to run, and <a href="https://linux.die.net/man/8/ld-linux.so" target="_blank">ld-linux.so.2</a> is in charge of finding and loading the shared libraries. We can see how this is defined in the sample-target ELF file by using readelf.</p>

<p><img alt="sample-target ELF file" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/sample-target_ELF_file.jpg" /></p>

<p>Now, let&rsquo;s set the LD_PRELOAD environment variable to load our library by executing.</p>

<pre>
export LD_PRELOAD=/home/ubuntu/linux-inject/sample-library.so; ldd /home/ubuntu/linux-inject/sample-target</pre>

<p><img alt="Ubuntu executing LD_PRELOAD" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/ubuntu_executing.jpg" /></p>

<p>We can see our sample-library being loaded now. We can also get more verbose information by setting the LD_DEBUG environment variable.</p>

<pre>
export LD_DEBUG=files</pre>

<p><img alt="More verbose information on LD_PRELOAD" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/more_verbose_information.png" /></p>

<p>A simple way to hunt for malicious LD_PRELOAD usage with Osquery is by querying the <a href="https://osquery.io/schema/3.3.2#process_envs" target="_blank">process_envs</a> table and looking for processes with the LD_PRELOAD environment variable set.</p>

<pre>
SELECT process_envs.pid as source_process_id, process_envs.key as environment_variable_key, process_envs.value as environment_variable_value, processes.name as source_process, processes.path as file_path, processes.cmdline as source_process_commandline, processes.cwd as current_working_directory, &#39;T1055&#39; as event_attack_id, &#39;Process Injection&#39; as event_attack_technique, &#39;Defense Evasion, Privilege Escalation&#39; as event_attack_tactic FROM process_envs join processes USING (pid) WHERE key = &#39;LD_PRELOAD&#39;;</pre>

<p><img alt="Query process to hunt for malicious LD_Preload usage" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/query_process.jpg" /></p>

<p>Since some monitoring and security software uses LD_PRELOAD for benign purposes, you will have to create a baseline of known processes in your environment using LD_PRELOAD.</p>

<p>A few benign examples we have encountered using LD_PRELOAD include the following.</p>

<ul>
	<li><a href="https://bugzilla-dev.allizom.org/show_bug.cgi?id=1268733" target="_blank">Firefox in some environments</a></li>
	<li><a href="https://www.dynatrace.com/support/help/technology-support/operating-systems/linux/operation/oneagent-files-and-logs-on-linux/" target="_blank">The DynaTrace agent</a></li>
</ul>

<p>From an attacker&rsquo;s perspective, as TrustedSec mentions in their blog, there are some inconveniences on using LD_PRELOAD - mainly that you need to restart the process that you want to inject code into in order for it to work. Below, I&rsquo;ve given an overview of other techniques that don&rsquo;t require this.</p>

<p>In addition to LD_PRELOAD, there are other similar techniques an attacker could use to achieve the same results. For example, by setting the LD_LIBRARY_PATH environmental variable, one could specify a directory where the loader will try to find the required libraries first, so an attacker could create a modified version of libc.so, or other required shared libraries, and load malicious code into the process.</p>

<p>Finally, it is recommended to monitor changes to /etc/ld.so.conf and /etc/ld.so.conf.d/*.conf since they can be used for the same purpose. This can be done using <a href="https://osquery.readthedocs.io/en/stable/deployment/file-integrity-monitoring/" target="_blank">Osquery&rsquo;s FIM functionality</a> by adding "/etc/ld.so.conf" and "/etc/ld.so.conf.d/%%" to the file_paths configuration.</p>

<p>As for particular examples in the wild, a recent one is a <a href="https://otx.alienvault.com/indicator/file/8914fd1cfade5059e626be90f18972ec963bbed75101c7fbf4a88a6da2bc671b" target="_blank">version of Winnti targeting Linux</a> systems that was unveiled by <a href="https://twitter.com/smoothimpact" target="_blank">Kris McConkey</a> during his presentation &ldquo;Skeletons in the supply chain,&rdquo; given at the SAS conference earlier this year. You can find a detailed analysis by <a href="https://www.intezer.com/blog-hiddenwasp-malware-targeting-linux-systems/" target="_blank">Intezer</a>.</p>

<h2><strong>Linux Inject</strong></h2>

<p>The <a href="https://github.com/gaffe23/linux-inject" target="_blank">Linux inject tool</a> can be used to load a shared library into a running process by using ptrace,&nbsp; similar to the well-known DLL injection technique in Windows.</p>

<p>Let&rsquo;s take a look at <a href="https://github.com/gaffe23/linux-inject/blob/master/slides_BHArsenal2015.pdf" target="_blank">how it works</a>. First, <a href="https://github.com/gaffe23/linux-inject/blob/master/inject-x86_64.c#L254" target="_blank">we attach to the target process using ptrace() and inject &nbsp;the code that will be loading the library</a>. Then, the <a href="https://github.com/gaffe23/linux-inject/blob/master/inject-x86_64.c#L26" target="_blank">loader code</a> allocates memory using malloc(), copies the path of the shared library to the buffer and calls __libc_dlopen_mode() to load the shared library. Let&rsquo;s give it a try.</p>

<pre>
./inject -n sample-target sample-library.so</pre>

<p><img alt="library injection failed" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/failure.jpg" /></p>

<p>It failed! What happened?</p>

<p>The source of this is a Linux security module called <a href="https://linux-audit.com/protect-ptrace-processes-kernel-yama-ptrace_scope/" target="_blank">Yama</a> that implements discretionary access control (DAC) for specific kernel functions such as ptrace.</p>

<p>You can check the current state by looking at /proc/sys/kernel/yama/ptrace_scope or using systemctl.</p>

<p><img alt="check current state using systemctl" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/systemctl.png" /></p>

<p>As you can see in the <a href="https://linux-audit.com/protect-ptrace-processes-kernel-yama-ptrace_scope/" target="_blank">docs</a><u>,</u> when ptrace_scope is set to 1, only a parent process can be debugged (this is the default in Ubuntu 18.04.2). When set to 3, no process can be debugged with ptrace and a reboot is required to change the value.</p>

<p>This is actually great from a defender&rsquo;s perspective because it means that an attacker would have to modify the value of ptrace_scope before using ptrace.</p>

<p>We can take advantage of this and utilize Osquery&rsquo;s <a href="https://osquery.io/schema/3.3.2#system_controls" target="_blank">system_controls</a> table to query the current configuration value of ptrace_scope.</p>

<pre>
osquery&gt; select  * from system_controls WHERE name == &#39;kernel.yama.ptrace_scope&#39;;</pre>

<p><img alt="kernel yama" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/kernel_yama.png" /></p>

<p>You can also utilize the following scheduled query in Osquery to monitor for changes to ptrace_scope.</p>

<pre>
"detection_ptrace_scope_changed": {&#10;&#10;      "platform": "linux",&#10;&#10;      "description": "Detects changes to kernel.yama.ptrace_scope",&#10;&#10;      "query": "SELECT name, current_value, config_value from system_controls&#10;&#10;  WHERE name == &#39;kernel.yama.ptrace_scope&#39;;",&#10;&#10;      "interval": 3600,&#10;&#10;      "removed": false&#10;&#10;}    </pre>

<p>We could also hunt for systems where the current value of ptrace_scope has been modified from the original one in /etc/sysctl.conf.</p>

<pre>
SELECT name, subsystem, current_value, config_value from system_controls WHERE name == &#39;kernel.yama.ptrace_scope&#39; AND current_value != config_value;&#10;</pre>

<p>Or, we could simply check for systems where ptrace is always allowed and flag this as a potential security issue.</p>

<pre>
SELECT name, subsystem, current_value, config_value from system_controls WHERE name == &#39;kernel.yama.ptrace_scope&#39; AND current_value = 0;</pre>

<p>More importantly, when ptrace is blocked, a Syslog message is recorded that can be used to detect unsuccessful attempts to use ptrace.</p>

<pre>
Jun 10 20:59:24 ip-172-31-32-145 kernel: [955105.055910] <strong>ptrace</strong> attach of "./sample-target"[13134] was attempted by "./inject -n sample-target sample-library.so"[13148]</pre>

<p>If you are already collecting Syslog messages in your security stack, I recommend you alert on multiple attempts to use ptrace in a system.</p>

<p>In Osquery, the following query can be used to monitor this specific syslog message.</p>

<pre>
SELECT * from syslog WHERE tag = &#39;kernel&#39; AND message LIKE &#39;%ptrace attach%&#39;;</pre>

<p><img alt="monitor specific syslog" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/monitor_specific_syslog.png" /></p>

<p>Ok, so now let&rsquo;s go back to the linux-inject tool. In order for ptrace to work, the attacker would need to set ptrace_scope to 0.</p>

<pre>
<strong>echo</strong> 0 | sudo tee /proc/sys/kernel/yama/ptrace_scope</pre>

<p><img alt="linux inject for ptrace to work" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/linux_inject.jpg" /></p>

<p><img alt="ubuntu success" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/ubuntu_success.jpg" /></p>

<p>Let&rsquo;s take a look at the process memory using Osquery&rsquo;s <a href="https://osquery.io/schema/3.3.2#process_memory_map" target="_blank">process_memory_map</a> table.</p>

<pre>
SELECT process_memory_map.*, pid as mpid from process_memory_map WHERE pid in (select PID from processes where name LIKE &#39;%sample-target&#39;);</pre>

<p><img alt="Osquery select memory map" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/osquery_select.jpg" /></p>

<p>Among other common memory regions, we can see some of the shared objects we are already familiar with (libc, ld, etc). In addition to that, the injected library, sample-library.so is also there.</p>

<p>We know that we are looking for memory regions that have execute permission, and we can also discard the original image and the regions marked as pseudo.</p>

<pre>
SELECT count(distinct(process_memory_map.pid)) from process_memory_map LEFT JOIN processes USING (pid) WHERE process_memory_map.path LIKE &#39;/%&#39; and process_memory_map.pseudo != 1 AND process_memory_map.path != processes.path AND process_memory_map.permissions LIKE &#39;%x%&#39;;</pre>

<p><img alt="query still too broad in osquery" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/broad_query_osquery.jpg" /></p>

<p>That query is still too broad. Let&rsquo;s check what the most common paths for the shared libraries are.</p>

<pre>
SELECT split(process_memory_map.path, &#39;/&#39;, 0) AS folder, count(*) as cnt from process_memory_map LEFT JOIN processes USING (pid) WHERE process_memory_map.path LIKE &#39;/%&#39; AND process_memory_map.pseudo != 1 AND process_memory_map.path != processes.path AND process_memory_map.permissions LIKE &#39;%x%&#39; GROUP by folder order by cnt desc;</pre>

<p><img alt="checking common paths" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/check_common_paths.jpg" /></p>

<p>That makes sense; we can create a query that ignores common paths. This would help us hunt for shared libraries that are loaded from non-standard locations.</p>

<pre>
SELECT process_memory_map.*, pid as mpid from process_memory_map LEFT JOIN processes USING (pid) WHERE process_memory_map.path LIKE &#39;/%&#39; and process_memory_map.pseudo != 1 AND process_memory_map.path NOT LIKE &#39;/lib/%&#39; AND process_memory_map.path NOT LIKE &#39;/usr/lib%&#39; AND process_memory_map.path != processes.path AND process_memory_map.permissions LIKE &#39;%x%&#39;;</pre>

<p><img alt="process memory map" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/process_memory_map.png" /></p>

<p>The TrustedSec blog mentions that in many cases attackers will remove the file from disk after loading it to make the analysis more difficult and avoid detection.</p>

<p>If we remove the injected .so file, we can validate with the following query, leveraging it to detect when the shared library has been deleted from disk.</p>

<pre>
SELECT process_memory_map.pid, process_memory_map.start, process_memory_map.end, process_memory_map.permissions, process_memory_map.offset, process_memory_map.path from process_memory_map LEFT join file USING (path) where pseudo != 1 AND process_memory_map.path NOT LIKE &#39;/lib/%&#39; AND process_memory_map.path NOT LIKE &#39;/usr/lib%&#39; AND process_memory_map.permissions LIKE &#39;%x%&#39; AND filename IS NULL and process_memory_map.inode !=0 AND process_memory_map.permissions = &#39;r-xp&#39;;</pre>

<p><img alt="injected .so file" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/injected_.so_file.png" /></p>

<p>In terms of detecting the code that gets <a href="https://github.com/gaffe23/linux-inject/blob/master/inject-x86_64.c#L26" target="_blank">injected in the target process</a>, we can use the following Yara rule.</p>

<p><img alt="yara table" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/yara_table.png" /><br />
<strong>ReflectiveSOInjection</strong>Interestingly, when I searched for ELF files matching those patterns in Virustotal, I quickly discovered that the popular <a href="https://github.com/n1nj4sec/pupy" target="_blank">Pupy RAT </a>actually <a href="https://github.com/n1nj4sec/pupy/blob/unstable/client/sources-linux/pupy.c#L21" target="_blank">uses Linux inject</a> in the Linux client.</p>

<p><a href="https://github.com/infosecguerrilla/ReflectiveSOInjection" target="_blank">ReflectiveSOInjection</a> is a tool based on linux-inject. The main difference is in the way the shared object is injected. In linux-inject, the shellcode uses <a href="https://github.com/gaffe23/linux-inject/blob/master/inject-x86.c#L52" target="_blank">__libc_dlopen_mode</a> to load the shared object. ReflectiveSOInjection <a href="https://github.com/infosecguerrilla/ReflectiveSOInjection/blob/master/inject/src/inject.c#L40" target="_blank">maps the shared object into memory</a> and then forces the main program to call the ReflectiveLoader export. The <a href="https://github.com/infosecguerrilla/ReflectiveSOInjection/blob/master/so/src/ReflectiveLoader.c" target="_blank">ReflectiveLoader</a> takes care of resolving functions, loading required libraries and map the program segments into memory.</p>

<p>Let&rsquo;s use ReflectiveSOInjection on the same sample-target that we used with linux-inject.</p>

<p><img alt="ReflectiveSOInjection" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/ReflectiveSOInjection.png" /></p>

<p>If we take a look at the memory map, we can see that there is a new memory <a href="https://github.com/infosecguerrilla/ReflectiveSOInjection/blob/master/inject/src/inject.c#L56" target="_blank">section marked as rwxp</a> with an empty path.</p>

<p><img alt="memory map with new section marked as rwxp" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/memory_map_with_new_section_marked_as_rwxp.jpg" /></p>

<p>As TrustedSec mentions in their blog, the advantage of this method is that the injected shared object doesn&rsquo;t have to be on disk.</p>

<p>We can use the following query to hunt for this activity.</p>

<pre>
SELECT processes.name, process_memory_map.*, pid as mpid from process_memory_map join processes USING (pid) WHERE process_memory_map.permissions = &#39;rwxp&#39; AND process_memory_map.path = &#39;&#39;;</pre>

<p><img alt="hunting for injected shared file" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/hunt_for_injected_shared_object.jpg" /></p>

<p>As a bonus detection, if the attacker is lazy and doesn&rsquo;t modify the ReflectiveSOInjection code, by default the code is looking for an export with the name &ldquo;ReflectiveLoader&rdquo; in the injected shared library. So, we can write a simple Yara signature to detect shared libraries on disk with that export.</p>

<table border="1" cellpadding="0" cellspacing="0" width="0">
	<tbody>
		<tr>
			<td style="width:624px;">
			<pre>
import "elf"&#10;&#10;&#10;rule ReflectiveLoader : LinuxMalware {&#10;&#10;                  meta:&#10;&#10;                                    author = "AlienVault Labs"&#10;&#10;                                    description = "Detects a shared object with the name of an export used by ReflectiveLoader"&#10;&#10;                                    reference = "https://github.com/infosecguerrilla/ReflectiveSOInjection"&#10;&#10;                  condition:&#10;&#10;                                    uint32(0) == 0x464c457f and&#10;&#10;                                    elf.type == elf.ET_DYN and&#10;&#10;                                    for any i in (0..elf.symtab_entries): (&#10;&#10;                                                      elf.symtab[i].name == "ReflectiveLoader"&#10;&#10;                                    )     &#10;&#10;}</pre>
			</td>
		</tr>
	</tbody>
</table>

<h2><strong>GDB</strong></h2>

<p>The last method we are going to explore is using the Gnu Project Debugger, <a href="https://www.gnu.org/software/gdb/" target="_blank">GDB</a> to load a shared object. From an attacker&rsquo;s perspective GDB may be already installed in the target system and it is less noisy than bringing your own tool. The advantage of using the GDB method is that we can take advantage of this.</p>

<p>Under the covers, this method is almost exactly the same as linux-inject. GDB uses ptrace to attach to a process and then calls the same __libc_dlopen_mode() function that we are familiar with to load the shared object.</p>

<p><img alt="gdb using ptrace" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/gdb_using_ptrace.jpg" /></p>

<p>The results are the same as with the linux-inject and we can use the same query to hunt for this.</p>

<p><img alt="query gdb" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/query_gdb.jpg" /></p>

<p>In summary, we analyzed multiple ways an attacker can inject a shared object into a running process, and we shared different Osquery queries and detection ideas that blue teams can use to hunt for this behavior in their environments. In addition to that, we shared some examples of how these techniques are being used in the wild.</p>
									<div class="blog-related">
									<div class="be-ix-link-block"></div>
									</div>
								</div>
								<div class="blog-author">
									<a href="https://cybersecurity.att.com/blogs/author/jaime-blasco" class="blog-avatar">
									
										<img src="data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22150px%22%20height%3D%22150px%22%3E%3Crect%20fill%3D%22none%22%20width%3D%22150%22%20height%3D%22150%22%2F%3E%3C%2Fsvg%3E" data-original="/avatars/uploads/avatar_17.jpg" width="150" height="150" alt="Jaime Blasco" />
									
									</a>

									<div class="blog-author-info">
										<p><strong>About the Author:</strong> <span>Jaime Blasco</span></p>
										<p>Jaime Blasco is a renowned Security Researcher with broad experience in network security, malware analysis and incident response. At AT&T Cybersecurity, Jaime leads the Alien Labs Intelligence and Research team that leads the charge of researching and integrating threat intelligence into detection mechanisms. Prior to working at AT&T, Jaime was Chief Scientist at AlienVault. Prior to that, he founded a couple of startups (Eazel, Aitsec) working on web application security, source code analysis and incident response. He is based in San Francisco. Jaime's work in emerging threats and targeted attacks is frequently cited in international publications such as New York Times, BBC, Washington Post and Al Jazeera.</p>


										<p><a href="/blogs/author/jaime-blasco">Read more posts from Jaime Blasco ›</a></p>

									</div>
								</div>


								<div class="blog-categories">
								<p>TAGS: <a href="/blogs/tag/malware" title="malware" rel="nofollow">malware</a>, <a href="/blogs/tag/malware+hunting" title="malware hunting" rel="nofollow">malware hunting</a>, <a href="/blogs/tag/alien+labs" title="alien labs" rel="nofollow">alien labs</a>, <a href="/blogs/tag/osquery" title="osquery" rel="nofollow">osquery</a>, <a href="/blogs/tag/linux" title="linux" rel="nofollow">linux</</p>
								</div>


								<p><a href="https://cybersecurity.att.com/blogs/labs-research" class="back-to-all">‹ BACK TO ALL BLOGS</a></p>
							</div>
							
							<div class="col-sm-4">
								<div>
									<div class="blog-sidebar-block">
    <form id="searchbox_002748587151982842036:gharkgtx6cu" action="/search-results/blog" class="sidebar-search">
        <input value="002748587151982842036:gharkgtx6cu" name="cx" type="hidden" />
        <input value="FORID:11" name="cof" type="hidden" />
        <div class="search-button">
            <input value="Search" name="sa" type="submit" />
        </div>
        <div class="search-field">
            <input id="q" name="q" type="text" placeholder="Search our blogs" />
        </div>
    </form>
</div>

<div class="blog-subscribe-grid" id="blog-subscribe-box">

    <h2>Get the latest security news in your inbox.</h2>

    <p class="text-center"><a class="btn btn-blue digestoform" id="digestobutton" target="_blank">Subscribe via email</a></p>

    <script>window.addEventListener('DOMContentLoaded', function() { var href_string="https://pages.alienvault.com/Digesto.html"+get_cookie_url_string()+"&redirect=https://cybersecurity.att.com/forms/email-thank-you";document.getElementById("digestobutton").href=href_string;});</script>
</div>
<p style="text-align: right; margin: 30px 10px 5px 0;"><a href="http://feeds.feedblitz.com/alienvault-blogs" target="_blank"><img src="https://cdn-cybersecurity.att.com/images/uploads/icons/rss.svg" width="20" height="20" style="display: inline-block; margin: 0 7px 2px;">RSS</a>
</p>
									<div class="promo-block">
										
													
			<style type="text/css">#blog-promo-block-v2 .blog-promo-item-v2 {
    box-shadow: 1px 1px 5px #D2D2D229;
    border: 1px solid #D2D2D2;
    margin-bottom: 30px;
}
#blog-promo-block-v2 .blog-promo-item-v2 .blog-promo-resource-type-v2 {
    font-size: 14px;
    color: #0568AE;
    font-weight: 500;
    padding: 15px;
    margin: 0;
}
#blog-promo-block-v2 .blog-promo-item-v2 .blog-promo-item-text-v2 {
    margin-bottom:15px;
}
#blog-promo-block-v2 .blog-promo-item-v2 .blog-promo-item-text-v2 a {
    color: black;
    text-decoration: none;
    font-weight: 500;
}
#blog-promo-block-v2 .blog-promo-item-v2 .blog-promo-item-text-v2 p {
   margin: 0 15px;
}

#blog-promo-block-v2 .blog-promo-item-icon-v2 {
   margin: 15px;
   font-size: 16px;
}
#blog-promo-block-v2 .blog-promo-item-icon-v2 .icon-right {
    width: 20px;
    height: 20px;
    border: 1px solid #0568ae;
    border-radius: 20px;
    font-size: 9.5px;
    line-height: 18px;
    font-weight: 400;
    margin-right: 10px;
    padding-left: 4px;
    top: -1px;
}
@media (max-width: 1024px) {
 .blog-promo-item-v2 img {
    display: none;
  }
}
</style>
<div id="blog-promo-block-v2">
<h3>Featured resources</h3>

<div class="blog-promo-item-v2"><img src="https://cdn-cybersecurity.att.com/images/uploads/resource-images/5g-and-the-journey.jpg" />
<p class="blog-promo-resource-type-v2">INDUSTRY REPORT</p>

<div class="blog-promo-item-text-v2">
<p><a href="/resource-center/industry-reports/cybersecurity-insights-report-tenth-edition">AT&amp;T Cybersecurity Insights&trade; Report:<br />
5G and the Journey to the Edge</a></p>
</div>

<div class="blog-promo-item-icon-v2"><span aria-hidden="true" class="icon-right glyphicon glyphicon-chevron-right">&nbsp;</span> <a href="/resource-center/industry-reports/cybersecurity-insights-report-tenth-edition">Learn more</a></div>
</div>

<div class="blog-promo-item-v2"><img src="https://cdn-cybersecurity.att.com/images/uploads/resource-images/security-maturity-assessment.jpg" />
<p class="blog-promo-resource-type-v2">SELF ASSESSMENT</p>

<div class="blog-promo-item-text-v2">
<p><a href="/resource-center/security-maturity-assessment?utm_internal=blog-rail-assess">Benchmark your cybersecurity maturity</a></p>
</div>

<div class="blog-promo-item-icon-v2"><span aria-hidden="true" class="icon-right glyphicon glyphicon-chevron-right">&nbsp;</span> <a href="/resource-center/security-maturity-assessment?utm_internal=blog-rail-assess">Explore</a></div>
</div>
</div>
		
										

									</div>
								</div>
							</div>
						</div>
					</div>
				</section>


			</main>


			
				<style>

	/* Sticky button */
	.desktop .sticky_bottom_keeper {
		height: 80px;
	}
	.sticky_bottom_desktop.fixed {
		height: 80px;
	}
	.sticky_bottom_keeper .btn {
		color: #fff;
	}
	.sticky_bottom_keeper .btn-white {
		border: 2px solid #fff;
	}
	.sticky_bottom_keeper .btn-white.btn-border {
		background: transparent;
	}




	.line.line-8 {
		height: 8px;
	}

	.hh .sticky_bottom_keeper {
		display: block !important;
		height: 8px;
		background: #009fdb;
	}

	.sticky_bottom_keeper .sticky_bottom_hh.fixed {display:none;}


</style>
<div class="sticky_bottom_keeper">


	<div class="sticky_bottom sticky_bottom_hh">
		<a class="sticky_bottom_hh_cta" href="#watch-alienvault-threat-detection-XwZyCKfKXbLhhBtQqFGT1L:7010Z000001v1DO">Watch
			a demo &#8250;</a>

		<a href="#" class="sticky_bottom_hh_close avicon-close"></a>
	</div>

	<div class="sticky_bottom sticky_bottom_desktop ibp">
		<a href="/pricing/request-quote" class="btn btn-border btn-white btn-rounded btn-with-arrow">Get price</a>
		<a href="/products/usm-anywhere/free-trial" class="btn btn-border btn-white btn-rounded btn-with-arrow">Free trial</a>

	</div>


</div>
			
		


		<footer id="footer" class="hidden-print">
  <div class="container-fluid">
    <div class="row">
      <div class="col-sm-6 col-md-3">
        
        <div class="footer_logo"><img src="data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22263px%22%20height%3D%2256px%22%3E%3Crect%20fill%3D%22none%22%20width%3D%22263%22%20height%3D%2257%22%2F%3E%3C%2Fsvg%3E" data-original="https://cdn-cybersecurity.att.com/images/uploads/logos/att_biz_hz_pref_rgb_white.png" alt="AT&T Business"></div>
        <div class="footer_featured">

          <div class="footer_featured_title">From the Blog</div>
          <article class="footer_featured_article">
            <div class="footer_featured_article_author clearfix">
	            
										<img src="data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22150px%22%20height%3D%22150px%22%3E%3Crect%20fill%3D%22none%22%20width%3D%22150%22%20height%3D%22150%22%2F%3E%3C%2Fsvg%3E" data-original="/avatars/uploads/avatar_357_1.jpg" width="150" height="150" alt="Mark Stone" />
									
              <div class="footer_featured_article_author_data">
                <h4>Mark Stone</h4>
                <time datetime="2021-06-18">Mar 18, 2021</time>
              </div>
            </div>
            <h3><a href="https://cybersecurity.att.com/blogs/security-essentials/what-is-a-security-operations-center-soc" id="footer-link-blog-post">What is a security operations center (SOC)? Explaining the SOC framework</a></h3>
          </article>
          <a id="footer-link-blog-all" href="/blogs" class="footer_featured_more">Explore All Blog Posts
            &#8250;</a>
        </div>
        

        <div class="social-style">
          <a href="https://www.twitter.com/attcyber/" class="social-link-twitter" target="_blank">Twitter</a>
          <a href="https://www.linkedin.com/company/attcybersecurity/" class="social-link-linkedin" target="_blank">Linkedin</a>
          <a href="https://www.facebook.com/ATTCyber/" class="social-link-facebook" target="_blank">Facebook</a>
          <a href="https://www.youtube.com/c/attcybersecurity" class="social-link-youtube" target="_blank">Youtube</a>
          <a href="https://www.instagram.com/attbusiness/" class="social-link-instagram" target="_blank">Instagram</a>
          <a href="https://community.spiceworks.com/pages/attcybersecurity" class="social-link-spiceworks" target="_blank">Spiceworks</a>


        </div>
      </div>

      <div class="col-sm-6 col-md-3">
        <div class="footer_links">
          <div class="heading">Who We Are</div>
          <ul>
            <li><a id="footer-link-labs" href="/alien-labs">Alien Labs</a></li>
            <li><a id="footer-link-customers" href="/who-we-are/customers">Customers</a></li>
            <li><a id="footer-link-careers" href="/who-we-are/careers">Careers</a></li>
            <li><a id="footer-link-contact" href="/contact">Contact Us</a></li>
          </ul>
        </div>

        <div class="footer_links">
          <div class="heading">News</div>
          <ul>
            <li><a id="footer-link-news-room" href="/who-we-are">Newsroom</a></li>
            <li><a id="footer-link-events" href="/who-we-are/events">Events</a></li>
            <li><a id="footer-link-blogs" href="/blogs">Blogs</a></li>
          </ul>
        </div>

        <div class="footer_links">
          <div class="heading">Partners</div>
          <ul>
            <li><a id="footer-link-partners" href="/partners">Partner Programs</a></li>
            <li><a id="footer-link-partner-portal" href="/partners/partner-portal/">Partner Portal</a></li>
          </ul>
        </div>
      </div>

      <div class="col-sm-6 col-md-3">
        <div class="footer_links">
          <div class="heading">Products</div>
          <ul>
		  	<li><a id="footer-link-mtdr" href="/products/managed-threat-detection-and-response">AT&T Managed Threat Detection and Response</a></li>
            <li><a id="footer-link-usm-anywhere" href="/products/usm-anywhere">USM Anywhere</a></li>
            <li><a id="footer-link-usm-mssp" href="/products/usm-for-mssp">USM for MSSPs</a></li>
            <li><a id="footer-link-managed-security" href="/products/managed-security-services">Partner Managed Solutions</a></li>
            <li><a id="footer-link-otx" href="/open-threat-exchange">Open Threat Exchange (OTX)</a></li>
            <li><a id="footer-link-ossim" href="/products/ossim">OSSIM</a></li>

          </ul>
        </div>



        <div class="footer_links">
          <div class="heading">Solutions</div>
          <ul>
            <li><a id="footer-link-cloud-security" href="/solutions/cloud-security-monitoring">Cloud Security Monitoring</a></li>
            <li><a id="footer-link-threat-detection" href="/solutions/threat-detection">Threat Detection</a></li>
            <li><a id="footer-link-ids" href="/solutions/intrusion-detection-system">Intrusion Detection</a></li>
            <li><a id="footer-link-siem" href="/solutions/siem-platform-solutions">SIEM platform solutions</a></li>
            <li><a id="footer-link-vulnerability" href="/solutions/vulnerability-assessment-remediation">Vulnerability
                Assessment</a></li>
            <li><a id="footer-link-all-solutions" class="btn-with-arrow" href="/solutions">See All Solutions</a></li>
          </ul>
        </div>
      </div>

      <div class="col-sm-6 col-md-3">
        <div class="footer_links">
          <div class="heading">Resources</div>
          <ul>
            <li><a id="footer-link-resources" href="/resource-center">Resources</a></li>
            <li><a id="footer-link-blog" href="/blogs">Blogs</a></li>
            <li><a id="footer-link-reference-guide" href="https://www.business.att.com/content/dam/attbusiness/guides/att-information-and-network-security-customer-reference-guide.pdf" target="_blank">Customer Reference Guide</a></li>

          </ul>
        </div>

        <div class="footer_links">
          <div class="heading">Customer Success</div>
          <ul>
            <li><a id="footer-link-support" href="/support">Support &amp; Services</a></li>
            <li><a id="footer-link-customer-portal" href="https://success.alienvault.com" target="_blank">Success Center</a></li>
            <li><a id="footer-link-documentation" href="/documentation">Documentation Center</a></li>
            <li><a id="footer-link-classroom-training" href="/training">Training</a></li>
            <li><a id="footer-link-certification" href="/certification">Certification</a></li>
          </ul>
        </div>

        <div class="footer_contact">
          <a href="/contact" id="footer-button-contact" class="btn btn-blue margin-bottom20">Contact us</a>
        </div>
      </div>
    </div>
    <div class="footer_legal">
      <p class="footer_legal_copy">&copy; Copyright 2021</p>
      <ul class="footer_legal_links">
        <li><a id="footer-link-privacy" href="/legal/privacy-policy">Privacy Policy</a></li>
        <li><a id="footer-link-terms" href="/terms/website-terms-of-use07may2018">Website Terms of Use</a></li>
        <li><a id="footer-link-gdpr" href="/legal/gdpr">GDPR</a></li>
        <li><a id="footer-link-cookie" href="/legal/cookie-policy">Cookie Policy</a></li>
        <li><a id="footer-link-personal-info" href="https://about.att.com/csr/home/privacy/rights_choices.html" target="_blank">Do Not Sell My Personal Information</a></li>

      </ul>
    </div>
  </div>
</footer>

<div id="valid_content"></div>

		
	<script src="https://cdn-cybersecurity.att.com/js/v2/imports/blog-bundle.min.js?v=20210316522111" defer></script>






		



<div class="cookie-notice">
    <p>We use cookies to provide you with a great user experience. By using our website, you agree to our <a href="https://www.att.com/privacy">Privacy Policy</a> and <a href="/terms/website-terms-of-use07may2018">Website Terms of Use</a>.</p>
    <a class="cookie-notice-close" href="#" aria-label="Close Cookie Notice"><span class="glyphicon glyphicon-remove"></span></a>
</div>


<!-- WGT-10310 -->

<!-- END WGT-10310 -->

<script src='https://www.att.com/scripts/adobe/prod/detm-container-hdr.js' data-restrictions='target' type='text/javascript' defer></script>
<script src='https://www.att.com/scripts/adobe/prod/detm-container-ftr.js' type='text/javascript' defer></script>



<script>
if (typeof ddo !== "undefined") {
	$(document).ready(function() {
	
	

	
	
	});
}

function initAdobePageTrackingFooter() {
	ddo.setVar('page.pageInfo.language','EN');
	ddo.setVar('page.pageInfo.lineOfBusiness','Business Solutions');
	ddo.setVar('page.category.pageFunction','Learn');
	ddo.setVar('page.category.pageOwnership','Business');
	ddo.setVar('page.attributes.applicationName','CYB');
	ddo.setVar('page.pageInfo.appCode','ACS');
	ddo.setVar('page.category.siteSection','CYB');
	ddo.setVar('page.category.siteSection','CYB');
	ddo.setVar('page.media.class','text');
	ddo.setVar('page.media.objective','Awareness');
	ddo.setVar('page.media.category','Security');
	ddo.setVar('page.location.domain','cybersecurity.att.com');
	ddo.pushEvent('pageLoad', 'Page_Load');
}
</script>


		<script>
			window.addEventListener('DOMContentLoaded', function() {
				$(window).load(function () {
					var hideSubscribe = AV.Utilities.readCookie('stickyBlogSubscribe');
					// if the cookie hasn't been set...
					if (hideSubscribe == null) {
						setTimeout(function () {
							// make the modal appear
							$('#blog-subscribe-box').fadeIn();
						}, 10000);

						// when the "Close" button is clicked
						$('.blog-subscribe-close-btn').click(function (e) {
							e.preventDefault();
							// set the cookie
							AV.Utilities.setCookie('stickyBlogSubscribe', true, 1);
							$('#blog-subscribe-box').fadeOut();
						});
					}
				});
			});
		</script>

	<script type="text/javascript" >var _cf = _cf || [];  _cf.push(['_setFsp', true]);  _cf.push(['_setBm', true]);  _cf.push(['_setAu', '/libraries/8ff88d9aano23331406e461ab4dfa32']); </script><script type="text/javascript"  src="/libraries/8ff88d9aano23331406e461ab4dfa32"></script></body>
</html>
