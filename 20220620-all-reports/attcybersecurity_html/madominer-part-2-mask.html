<!DOCTYPE html>
<html lang="en">

<head>
	

	


	

	<!--trying to figure out the canonical url issue with blogs-->
	<link rel="canonical" href="https://cybersecurity.att.com/blogs/labs-research/madominer-part-2-mask" />

	<title>MadoMiner Part 2 - Mask | AT&T Alien Labs</title>

	

		

	<meta property="og:site_name" value="AT&T Cybersecurity" />
	<meta property="og:title" content="MadoMiner Part 2 - Mask" />
	<meta property="og:url" content="https://cybersecurity.att.com/blogs/labs-research/madominer-part-2-mask" />
	
	<meta property="og:description" content="This is a guest post by independent security researcher James Quinn.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

If you have not yet read the first part of the MadoMiner analysis, please do so now.&nbsp; This analysis will pick up where Part 1 left off, while also including&nbsp; a brief correction.&nbsp; The x64 version of the Install module was listed as identical to the x86 Install module.&nbsp; However, this is not correct.&nbsp; The x64 Install module is identical in run-through to the 360Safe.exe" />
		



	<meta charset="utf-8">

<link rel="preconnect" href="https://cdn-cybersecurity.att.com" />
<link rel="preconnect" href="https://www.att.com" />
<link rel="preconnect" href="https://www.googletagmanager.com" crossorigin />
<link rel="preconnect" href="https://cdn.vidyard.com" crossorigin />
<link rel="preconnect" href="https://ajax.cloudflare.com" crossorigin />
<link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin />
<link rel="preconnect" href="https://googleads.g.doubleclick.net" crossorigin />
<link rel="preconnect" href="https://www.google-analytics.com" crossorigin />
<link rel="preconnect" href="https://play.vidyard.com" crossorigin />
<link rel="preconnect" href="https://adservice.google.com" crossorigin />
<link rel="preconnect" href="https://www.googleadservices.com" crossorigin />
<link rel="preconnect" href="https://www.facebook.com" crossorigin />
<link rel="preconnect" href="https://www.google.com" crossorigin />
<link rel="preconnect" href="https://px.ads.linkedin.com" crossorigin />


<script src="https://cdn-cybersecurity.att.com/js/v2/imports/top-bundle.min.js?v=20210316522111"></script>


<link rel="preload" href="https://www.att.com/scripts/adobe/prod/edmDataDefinition.js" as="script">
<link rel="preload" href="https://www.att.com/scripts/adobe/prod/edmDataManager.js" as="script">
<link rel="preload" href="https://www.att.com/scripts/adobe/prod/marketing.min.js" as="script">
<link rel="preload" href="https://www.att.com/scripts/adobe/prod/detm_adobe.js" as="script">






<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KLJDXJN');</script>
<!-- End Google Tag Manager -->
<script src='https://www.att.com/scripts/adobe/prod/detm-container-hdr.js' data-restrictions='target' type='text/javascript'></script>


<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="ahrefs-site-verification" content="a6fa0378625f72f89c6f290c3c7559ffee326fb9232cd87fcace798afce3e30d">
<meta name="google-site-verification" content="GTQZz4AGa47UtmP64oC5BB735pkyncjtISHOcQZbIho" />

<link rel="preload" as="font" type="font/ttf" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/zero-width.ttf" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Bold.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Regular.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Light.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Medium.woff2" />


<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-LightItalic.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-BoldItalic.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-MediumItalic.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Italic.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Black.woff2" />

<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/css/fonts/glyphicons-halflings-regular.woff2" />
<link rel="preload" as="font" type="font/ttf" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/av-icons.ttf?e81fxl" />



<link rel="preload" as="style" href="https://cdn-cybersecurity.att.com/css/sass/main.min.css?v=20210316522111" />
<link rel="apple-touch-icon" sizes="144x144" href="https://cdn-cybersecurity.att.com/images/uploads/apple-touch-icon.png"/>
<link rel="icon" type="image/png" sizes="32x32" href="https://cdn-cybersecurity.att.com/images/uploads/favicon.ico"/>
<link rel="shortcut icon" href="https://cdn-cybersecurity.att.com/images/uploads/favicon.ico">
<link rel="manifest" href="https://cdn-cybersecurity.att.com/manifest.json">

<link rel="stylesheet" href="https://cdn-cybersecurity.att.com/css/sass/main.min.css?v=20210316522111" />








<script>
	if (typeof ddo !== "undefined") {
		$(document).ready(function() {
		
		

		
		
		});
	}

	function initAdobePageTrackingHeader() {
		ddo.disableAutoPageLoad();
		
		ddo.setVar('page.location.url','/blogs/labs-research/madominer-part-2-mask');


		
		ddo.setVar('page.pageInfo.pageTitle', document.title.trim());


		 
		ddo.setVar('page.pageInfo.friendlyPageName','CYB '+ document.title.trim() +' Pg');


		
		
			ddo.setVar('page.category.siteSubSection1','blogs');
		


		
		
			ddo.setVar('page.category.siteSubSection2','labs-research');
		



		
		
			ddo.setVar('page.category.siteSubSection3','madominer-part-2-mask');
		


		
		

		
		
	}
</script>


<script type="text/javascript">
    var _elqQ = _elqQ || [];
    _elqQ.push(['elqSetSiteId', '1086385399']);

    _elqQ.push(['elqUseFirstPartyCookie', 'cyber-tracking.att.com']);

    _elqQ.push(['elqTrackPageView', window.location.href]);

    (function () {
        function async_load() {
            var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true;
            s.src = '//img03.en25.com/i/elqCfg.min.js';
            var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x);
        }
        if (window.addEventListener) window.addEventListener('DOMContentLoaded', async_load, false);
        else if (window.attachEvent) window.attachEvent('onload', async_load);
    })();
</script>


	<link rel="alternate" type="application/rss+xml" title="AlienVault Open Threat Exchange Blog" href="http://feeds.feedblitz.com/alienvaultotx&x=1" />

	<style>
	.blog-author-info {
		width: 70%;
		float: left;
		color: #191919;
	}

	.blog-subscribe-grid ul {
		margin-left: 0px;
		margin-bottom: 0px;
		padding-left: 0px;
	}

	.blog-subscribe-grid ul li {
		list-style-type: none;
		line-height: 20px;
	}

	.blog-subscribe-grid ul li a {
		color: #c6ced5;
		font-size: 14px;
		text-decoration: none;
	}

	.blog-subscribe-grid ul li a:hover {
		text-decoration: underline;
	}

	.blog-content-area img {
		width: 100%!important;
		height: auto!important;
	}

	.blog-promo-item {
		clear: both;
		overflow: hidden;
		margin-bottom: 30px;
	}
	.promo-block .small {
		text-transform: uppercase;
	}

	.blog-promo-item-text {
		width: 345px;
		float: left;
		max-width:100%;
	}

	.blog-promo-item p {
		margin-bottom: 0px!important;
	}






	#blog-promo-block {
		padding-top: 20px;
	}



	/*promo block and sticky classes*/

	.sticky-sidebar {
		top: 147px;
		position: -webkit-sticky; /* Safari */
		position: sticky;
	}
	     .sidebar-search {
			 margin-bottom: 30px;
		 }

         .sidebar-search .search-button {
                width: 100%;
                position: relative;
            }

            .sidebar-search .search-button input {
                padding: 0px;
                margin: 2px 0px 0px 0px;
                position: absolute;
                background: url(https://cdn-cybersecurity.att.com/images/icn-sidebar-search.png) top left no-repeat;
                background-size: 25px 25px;
                width: 25px;
                height: 25px;
                cursor: pointer;
                text-indent: -9999em;
                border: none;
                left: 10px;
                top: 6px;
             }

			.sidebar-search .search-field input {
                border: 0;
                width: 100%;
                height: 30px;
                padding-left: 50px;
				margin-top: 5px;
            }

            .sidebar-search .search-field {
                border: 1px solid #CCCCCC;
                width: 100%;
                height: 40px;
            }

            #q::placeholder {
          		color: #767676!important;
            }

            #blog-subscribe-box {
			height:auto;
            padding: 32px;
            background-image: url('https://cdn-cybersecurity.att.com/images/uploads/backgrounds/blog-email-subscribe-bkg.jpg');
            background-size: cover;
            }

            #blog-subscribe-box h2 {
            color: #fff;
            font-size:32px;
            }

			#blog-subscribe-box p {
				margin-bottom: 10px;
			}






	@media (max-width: 991px) {
            .sidebar-search .search-button input {
                padding: 0px;
                background: transparent;
                cursor: pointer;
                text-indent: -9999em;
                border: none;
                right: 5px;
                top: 5px;
                padding-left: 0px;
             }

            .sidebar-search .search-field input {
             padding-left: 15px;
             }


            }

            	@media (min-width: 768px) and (max-width: 920px){
	.blog-subscribe-grid .btn {
		border-radius: 24px;
	    font-size: 12px;
	    line-height: 18px;
	    border: none;
	    padding: 6px 36px;
	    height: 30px;
	    font-weight: 500;
	}
}


		.blog-content-area p,
		.blog-content-area ul li,
		.blog-content-area ol li{
			font-size: 16px;
			line-height: 20px;
			font-weight: 400;
		}
		.blog-content-area ul li,
		.blog-content-area ol li {
			margin-bottom: 10px;
		}

	</style>

</head>

	<body class="listing-blog-entry-id-488">
			<!-- Google Tag Manager (noscript) -->
<noscript><iframe src='https://www.googletagmanager.com/ns.html?id=GTM-KLJDXJN'
height='0' width='0' style='display:none;visibility:hidden'></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<script src='https://www.att.com/scripts/adobe/prod/detm-container-ftr.js' type='text/javascript'></script>


		<header id="header" class="navbar navbar-fixed-top">

	<style>
@media (max-width: 543px) {
	.hide-on-mobile {
		display: none;
	}
}
</style>

<div id="news-banner" style="background-color: #1A2027!important;">
    <div class="container-fluid">
        <div class="row vcenter">
            <div class="col-sm-12">

                <div id="news-headline-link">
                    <a href="/resource-center/industry-reports/cybersecurity-insights-report-tenth-edition" style="color: #009FDB;"><span class="caps"><strong>AT&T Cybersecurity Insights™ Report:</strong></span></a> <span class="text-white caps  hide-on-mobile" style="margin-right: 20px;">5G and the Journey to the Edge</span> <a class="text-white" href="/resource-center/industry-reports/cybersecurity-insights-report-tenth-edition">Learn more ⟶</a>
                </div>
				<div id="search-contact">
					<ul class="list-unstyled header_nav_top_list">
						<li class="header_nav_top_list_item"><a id="top-nav-support" href="/support">Support</a></li>
						<li class="header_nav_top_list_item"><a id="top-nav-contact" href="/contact">Contact</a></li>
						<li class="header_nav_top_list_item search">
							<a href="#" class="header_nav_toggle-search" aria-label="Search">
								<!-- <span class="hide-on-active"><img src="https://cdn-cybersecurity.att.com/images/uploads/nav/search.png"></span>
								<span class="show-on-active"><img src="https://cdn-cybersecurity.att.com/images/uploads/nav/search.png"></span> -->
								<span class="hide-on-active glyphicon glyphicon-search" aria-hidden="true"></span>
								<span class="show-on-active glyphicon glyphicon-search" aria-hidden="true"></span>
							</a>
							<form action="/search-results" method="get" id="top-search-form" __bizdiag="113" __biza="WJ__"><input name="q" id="top-search-form-text" type="text" placeholder="Search Now...." aria-label="Search"><button class="sr-only" type="submit">Search</button></form>
						</li>
					</ul>
				</div>
            </div>
        </div>
    </div>
</div>






	<div id="header-container" class="container-fluid">
		<div id="header-logo">
			<div class="logo-globe"><a href="https://business.att.com" target="_blank"><img src="https://cdn-cybersecurity.att.com/images/uploads/logos/att-globe.svg" alt="AT&amp;T Business" /></a></div>
			<div class="att-business"><a href="https://business.att.com" target="_blank"><img src="https://cdn-cybersecurity.att.com/images/uploads/logos/att-business-web.svg" alt="AT&amp;T Business" /></a></div>
			<div class="att-cybersecurity"><a href="/"><img src="https://cdn-cybersecurity.att.com/images/uploads/logos/att-cybersecurity-web.svg" alt="AT&amp;T Cybersecurity" /></a></div>
		</div>

		<button type="button" class="header_toggle_nav navbar-toggle collapsed" data-toggle="collapse" data-target="#header-nav" aria-expanded="false">
			<span class="sr-only">Toggle navigation</span>
			<span class="avicon avicon-bars"></span>
			<span class="avicon avicon-close"></span>
		</button>
		
		
			<a href="/contact" id="header-cta" class="hidden-md hidden-lg btn btn-blue btn-sm">Contact us</a>
		

		<nav class="navbar-collapse collapse" id="header-nav">
			<ul class="nav navbar-nav list-unstyled">
				<li class="nav-item has-dd products">
					<a id="main-nav-products" href="/products" class="dropdown-toggle" data-toggle="collapse" role="button" aria-expanded="false" data-target="#products-dd">Products<span class="glyphicon glyphicon-chevron-up"></span><span class="glyphicon glyphicon-chevron-down"></span>
					</a>
					<div class="nav-dropdown collapse" id="products-dd">
						<div class="dd-multi-col container-fluid">
							<ul class="list-unstyled sub-nav">
									<li id="first-sub-cyber-strategy-risk"><a href="/categories/cybersecurity-consulting-services" class="first-level">Cybersecurity Consulting Services</a>
										<div class="desktop-subnav open">
											<ul class="list-unstyled">
												<li class="second-sub-heading">Cyber Strategy</li>
												<li class="second-sub-link"><a href="/products/strategy-and-roadmap">Strategy and Roadmap Planning</a></li>

												<li class="second-sub-link"><a href="/products/security-assessment">Enterprise Security Assessment Services</a></li>
												<li class="second-sub-link"><a href="/products/risk-based-cyber-posture-assessment">Risk-based Cyber Posture Assessment</a></li>
											</ul>
											<ul class="list-unstyled">
												<li class="second-sub-heading">Risk and Compliance</li>
												<li class="second-sub-link"><a href="/products/security-compliance">Security Compliance</a></li>
											</ul>
											<ul class="list-unstyled">
												<li class="second-sub-heading">Vulnerability and Threat Management</li>
												<li class="second-sub-link"><a href="/products/vulnerability-scanning">Vulnerability Scanning</a></li>
												<li class="second-sub-link"><a href="/products/penetration-testing-services">Penetration Testing</a></li>
												<li class="second-sub-link"><a href="/products/adversary-simulation-service">Adversary Simulation Services</a></li>

											</ul>
											<ul class="list-unstyled">
												<li class="second-sub-heading">CSO Advisory Services</li>
												<li class="second-sub-link"><a href="/products/cybersecurity-iq-training">Cybersecurity IQ Training</a></li>
											</ul>
										</div>
										<div class="mobile-subnav">
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-link"><a href="/products/strategy-and-roadmap">Strategy and Roadmap Planning</a></li>
												<li class="second-sub-link"><a href="/products/security-assessment">Enterprise Security Assessment Services</a></li>
												<li class="second-sub-link"><a href="/products/risk-based-cyber-posture-assessment">Risk-based Cyber Posture Assessment</a></li>

												<li class="second-sub-link"><a href="/products/security-compliance">Security Compliance</a></li>

												<li class="second-sub-link"><a href="/products/vulnerability-scanning">Vulnerability Scanning</a></li>

												<li class="second-sub-link"><a href="/products/penetration-testing-services">Penetration Testing</a></li>
												<li class="second-sub-link"><a href="/products/adversary-simulation-service">Adversary Simulation Services</a></li>
												<li class="second-sub-link"><a href="/products/cybersecurity-iq-training">Cybersecurity IQ Training</a></li>
											</ul>
										</div>
									</li>
									<li id="first-sub-network-security"><a href="/categories/network-security" class="first-level">Network Security</a>
										<div class="desktop-subnav">
											<ul class="list-unstyled">
												<li class="second-sub-heading">AT&T Trusted Internet Access</li>
												<li class="second-sub-link"><a href="/products/global-security-gateway">Global Security Gateway</a></li>
												<li class="second-sub-link"><a href="/products/network-based-firewall">Network Based Firewalls</a></li>
												<li class="second-sub-link"><a href="/products/premises-based-firewall">Premises Based Firewalls</a></li>
												<li class="second-sub-link"><a href="/products/enhanced-access-security">Enhanced Cybersecurity Services</a></li>
											</ul>
											<ul class="list-unstyled">
												<li class="second-sub-heading">AT&T Infrastructure and Application Protection</li>
												<li class="second-sub-link"><a href="/products/reactive-ddos-services">Reactive Distributed Denial of Service Defense</a></li>
												<li class="second-sub-link"><a href="/products/application-layer-security">AT&T Application Layer Security</a></li>
											</ul>
										</div>
										<div class="mobile-subnav">
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">AT&T Trusted Internet Access</li>
												<li class="second-sub-link"><a href="/products/global-security-gateway">Global Security Gateway</a></li>
												<li class="second-sub-link"><a href="/products/network-based-firewall">Network Based Firewalls</a></li>
												<li class="second-sub-link"><a href="/products/premises-based-firewall">Premises Based Firewalls</a></li>
												<li class="second-sub-link"><a href="/products/enhanced-access-security">Enhanced Cybersecurity Services</a></li>

												<li class="second-sub-heading">AT&T Infrastructure and Application Protection</li>
												<li class="second-sub-link"><a href="/products/reactive-ddos-services">Reactive Distributed Denial of Service Defense</a></li>
												<li class="second-sub-link"><a href="/products/application-layer-security">AT&T Application Layer Security</a></li>
											</ul>
										</div>
									</li>
									<li id="first-sub-unified-endpoint"><a href="/categories/endpoint-security" class="first-level">Endpoint Security</a>
										<div class="desktop-subnav">
											<ul class="list-unstyled">
												<li class="second-sub-heading">Endpoint Security</li>
												<li class="second-sub-link"><a href="/products/sentinel-one">SentinelOne</a></li>
												<li class="second-sub-link"><a href="/products/mobile-iron">MobileIron</a></li>
												<li class="second-sub-link"><a href="/products/vmware">VMware Workspace ONE®</a></li>
												<li class="second-sub-link"><a href="/products/ibm-maas360">IBM MaaS360</a></li>
												<li class="second-sub-link"><a href="/products/lookout">Lookout Mobile Endpoint Security</a></li>
												<li class="second-sub-link"><a href="/products/mcafee-endpoint-protection">McAfee Endpoint Protection</a></li>
											</ul>
										</div>
										<div class="mobile-subnav">
											<ul class="list-unstyled sub-nav">
													<li class="second-sub-link"><a href="/products/sentinel-one">SentinelOne</a></li>
													<li class="second-sub-link"><a href="/products/mobile-iron">MobileIron</a></li>
													<li class="second-sub-link"><a href="/products/vmware">VMware Workspace ONE®</a></li>
													<li class="second-sub-link"><a href="/products/ibm-maas360">IBM MaaS360</a></li>
													<li class="second-sub-link"><a href="/products/lookout">Lookout Mobile Endpoint Security</a></li>
													<li class="second-sub-link"><a href="/products/mcafee-endpoint-protection">McAfee Endpoint Protection</a></li>
											</ul>
										</div>
									</li>
									<li id="first-sub-threat-detection-response"><a href="/categories/threat-detection-and-response" class="first-level">Threat Detection and Response</a>
										<div class="desktop-subnav">
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">Strategy, Assessment and Planning</li>
												<li class="second-sub-link"><a href="/products/incident-response">Incident Response and Forensics</a></li>
											</ul>
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">AT&T Threat Solutions</li>
												<li class="second-sub-link"><a href="/products/managed-threat-detection-and-response">Managed Threat Detection and Response</a></li>
												<li class="second-sub-link"><a href="/products/usm-anywhere">USM Anywhere</a></li>
												<li class="second-sub-link"><a href="/products/usm-for-mssp">USM for MSSPs</a></li>
											</ul>
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">Free Tools</li>
												<li class="second-sub-link"><a href="/open-threat-exchange">Open Threat Exchange</a></li>
												<li class="second-sub-link"><a href="/products/ossim">OSSIM</a></li>
											</ul>
										</div>
										<div class="mobile-subnav">
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">Strategy, Assessment and Planning</li>
												<li class="second-sub-link"><a href="/products/incident-response">Incident Response and Forensics</a></li>

												<li class="second-sub-heading">AT&T Threat Solutions</li>
												<li class="second-sub-link"><a href="/products/managed-threat-detection-and-response">Managed Threat Detection and Response</a></li>
												<li class="second-sub-link"><a href="/products/usm-anywhere">USM Anywhere</a></li>
												<li class="second-sub-link"><a href="/products/usm-for-mssp">USM for MSSPs</a></li>

												<li class="second-sub-heading">Free Tools</li>
												<li class="second-sub-link"><a href="/open-threat-exchange">Open Threat Exchange</a></li>
												<li class="second-sub-link"><a href="/products/ossim">OSSIM</a></li>
											</ul>
										</div>
									</li>
							</ul>
						</div>
						<!--<div class="dd-bottom visible-lg" id="view-all-products">
							<div class="container-fluid">
								<a href="/products">
									<span class="view-all-text">View All Products &LongRightArrow;</span>
								</a>
							</div>
						</div>-->
					</div>
				</li>
				<li class="nav-item has-dd solutions">
					<a id="main-nav-solutions" href="/solutions" class="dropdown-toggle" data-toggle="collapse" role="button" aria-expanded="false" data-target="#solutions-dd">Solutions<span class="glyphicon glyphicon-chevron-up"></span><span class="glyphicon glyphicon-chevron-down"></span></a>
					<div class="nav-dropdown collapse" id="solutions-dd">
						<div class="dd-multi-col container-fluid">
							<ul class="list-unstyled sub-nav hidden-md hidden-lg">
								<li><a id="main-nav-see-all-solutions-mobile" href="/solutions" class="header_nav_link">See All Solutions</a></li>
							</ul>
							<div id="compliance">
								<div class="menu-header">Compliance</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/solutions/it-compliance-management">Overview</a></li>
									<li><a href="/solutions/gdpr-compliance">GDPR</a></li>
									<li><a href="/solutions/hipaa-compliance">HIPAA</a></li>
									<li><a href="/solutions/iso-27001-compliance">ISO 27001</a></li>
									<li><a href="/solutions/pci-dss-compliance">PCI DSS</a></li>
									<li><a href="/solutions/soc-2-compliance">SOC 2</a></li>
								</ul>
							</div>
							<div id="industry">
								<div class="menu-header">Industry</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/solutions/education">Education</a></li>
									<li><a href="/solutions/energy-sector-security">Energy Sector</a></li>
									<li><a href="/solutions/government">Federal</a></li>
									<li><a href="/solutions/financial-services">Financial Services</a></li>
									<li><a href="/solutions/healthcare">Healthcare</a></li>
									<li><a href="/solutions/manufacturing">Manufacturing</a></li>
									<li><a href="/partners/mssp-program">MSSPs</a></li>
									<li><a href="/solutions/retail">Retail</a></li>
								</ul>
							</div>
							<div id="environment">
								<div class="menu-header">Environment</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/solutions/aws-security-and-compliance-management">AWS</a></li>
									<li><a href="/solutions/azure-security-and-compliance-management">Azure</a></li>
									<li><a href="/solutions/cloud-security">Cloud</a></li>
									<li><a href="/solutions/iot-and-mobility-security">IOT/Mobility</a></li>
									<li><a href="/solutions/hybrid-cloud-security">Hybrid</a></li>
									<li><a href="/solutions/network-security">Network</a></li>
									<li><a href="/solutions/remote-workforce-security">Remote Workforce</a></li>

								</ul>
							</div>
							<div id="core-capabilities">
								<div class="menu-header">Security Use Cases</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/solutions/asset-discovery-inventory">Asset Discovery</a></li>
									<li><a href="/solutions/endpoint-detection-and-response">Endpoint Detection &amp; Response</a></li>
									<li><a href="/solutions/intrusion-detection-system">Intrusion Detection</a></li>
									<li><a href="/solutions/secure-access-service-edge">Secure Access Service Edge</a></li>
									<li><a href="/solutions/secure-web-gateway">Secure Web Gateway</a></li>
									<li><a href="/solutions/siem-platform-solutions ">SIEM Platform Solutions</a></li>
									<li><a href="/solutions/threat-detection">Threat Detection</a></li>
									<li><a href="/solutions/threat-intelligence">Threat Intelligence</a></li>
									<li><a href="/solutions/zero-trust-architecture">Zero Trust Architecture</a></li>

								</ul>
							</div>
						</div>
						<div class="dd-bottom visible-lg" id="view-all-solutions">
							<div class="container-fluid">
								<a href="/solutions">
									<span class="view-all-text">View All Solutions &LongRightArrow;</span>
								</a>
							</div>
						</div>
					</div>
				</li>
				<li class="nav-item partners">
					<a id="main-nav-partners" href="/partners" class="dropdown-toggle" role="button" aria-expanded="false" data-target="#partners-dd">Partners</a>
					<div class="nav-dropdown collapse visible-lg" id="partners-dd">
						<div class="dd-multi-col container-fluid">
							<div id="become-a-partner">
								<div class="menu-header">Become a Partner</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/partners">All Partner Programs</a></li>
									<li><a href="/partners/mssp-program">MSSP Program</a></li>
									<li><a href="/partners/resellers">Reseller Program</a></li>
									<li><a href="/partners/partner-portal/">Partner Portal Login</a></li>
								</ul>
							</div>

							<div id="find-a-partner">
								<div class="menu-header">Find a Partner</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/products/managed-security-services">Partner Managed Solutions</a></li>
									<li><a href="/partners/find-partner">Find an MSSP</a></li>
									<li><a href="/partners/locator">Find a Reseller</a></li>
									<li><a href="/partners/certified-implementation-partners">Professional Services</a></li>
								</ul>
							</div>
							<div id="technology-partners">
								<div class="menu-header">Technology Partners</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/app">USM Anywhere Integrations</a></li>
									<li><a href="/partners/technology-partners">OTX Partners</a></li>
								</ul>
							</div>
						</div>
						<div class="dd-bottom visible-lg" id="view-all-partners">
							<div class="container-fluid">
								<a href="/partners/become-a-partner">
									<span class="view-all-text">Become a Partner &LongRightArrow;</span>
								</a>
							</div>
						</div>
					</div>
				</li>
				<li class="nav-item has-dd resources">
					<a id="main-nav-resources" href="/resource-center#language_en" class="dropdown-toggle" data-toggle="collapse" role="button" aria-expanded="false" data-target="#resources-dd">Resources<span class="glyphicon glyphicon-chevron-up"></span><span class="glyphicon glyphicon-chevron-down"></span></a>
					<div class="nav-dropdown collapse" id="resources-dd">
						<div class="dd-multi-col container-fluid">

							<div id="resources-menu-image" class="visible-lg">
								<img src="https://cdn-cybersecurity.att.com/images/uploads/thehub-thumbnail.jpg">
								<p>Explore The Hub, our home for all virtual experiences</p>
								<a href="https://hub.att.com/expo-hall/cybersecurity/">Explore now ⟶</a>
							</div>

							<ul class="list-unstyled sub-nav hidden-md hidden-lg">
								<li><a id="main-nav-resources-mobile" href="/resource-center#language_en">View All Resources</a></li>

							</ul>

							<div id="product-resources">
								<div class="menu-header">Product Resources</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/resource-center#content_customer-stories">Customer Stories</a></li>
									<li><a href="/resource-center#content_product-brief">Product Briefs</a></li>
									<li><a href="/resource-center#content_product-demo">Product Demos</a></li>
									<li><a href="/resource-center#content_product-review">Product Reviews</a></li>
									<li><a href="/resource-center#content_solution-brief">Solution Briefs</a></li>
									<li><a href="/resource-center#content_use-cases">Use Cases</a></li>

									<li><a id="free-trial" href="/products/usm-anywhere/free-trial">Free Trial</a></li>
								</ul>
							</div>
							<div id="security-resources">
								<div class="menu-header">Security Resources</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/resource-center#content_analyst-reports">Analyst Reports</a></li>
									<li><a href="/blogs">Blogs</a></li>
									<li><a href="/resource-center#content_ebook">eBooks</a></li>
									<li><a href="/resource-center#content_video">Videos</a></li>
									<li><a href="/resource-center#content_webcast">Webcasts</a></li>
									<li><a href="/resource-center#content_white-paper">White Papers</a></li>
									<li><a href="/resource-center#content_industry-reports">Industry Reports</a></li>
								</ul>
							</div>
							<div id="customer-resources">
								<div class="menu-header">Customer Resources</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="https://success.alienvault.com/">Success Center</a></li>
									<li><a href="/certification">Certification</a></li>
									<li><a href="/customer-success">Customer Success</a></li>
									<li><a href="/documentation">Documentation</a></li>
									<li><a href="/partners/certified-implementation-partners">Professional Services</a></li>
									<li><a href="/support">Support Overview</a></li>
									<li><a href="/training">Training</a></li>
								</ul>
							</div>
							<div id="browse-by-topic">
								<div class="menu-header">Browse by Topic</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/resource-center#category_incident-response">Incident Response</a></li>
									<li><a href="/resource-center#category_intrusion-detection">Intrusion Detection</a></li>
									<li><a href="/resource-center#category_partner-mssp-reseller">Partner: MSSP &amp; Reseller</a></li>
									<li><a href="/resource-center#category_regulatory-compliance">Regulatory Compliance</a></li>
									<li><a href="/resource-center#category_soc">Security Operations Center</a></li>
									<li><a href="/resource-center#category_siem-log-management">SIEM &amp; Log Management </a></li>
									<li><a href="/resource-center#category_threat-detection">Threat Detection</a></li>
									<li><a href="/resource-center#category_threat-intelligence">Threat Intelligence</a></li>
								</ul>
							</div>
						</div>

						<div class="dd-bottom visible-lg" id="view-all-resources">
							<div class="container-fluid">
								<a href="/resource-center#language_en">
									<span class="view-all-text">View All Resources &LongRightArrow;</span>
								</a>
							</div>
						</div>

					</div>
				</li>
				<li class="nav-item alien-labs">
					<a id="main-nav-alien-labs" href="/alien-labs" class="">AT&T Alien Labs</a>
				</li>
				<li class="nav-item support visible-sm visible-xs">
					<a id="main-nav-support" href="/support">Support</a>
				</li>
			</ul>
		</nav>

	</div>

	<div class="container-fluid visible-md visible-lg">
		
		
			<a id="main-nav-free-tools" class="header-nav-btn btn margin-bottom10" href="/products/usm-anywhere/free-trial">Free trial</a>
		


	</div>
</header>

						




			<main class="blog-detail">

				<div class="full-width-block top-content-width-bg" style="background-image: url('https://cdn-cybersecurity.att.com/blog-content/Blog-Images/hero/blog-hero-hackerone-dec-2017.jpg'); background-position: top center; background-repeat: no-repeat; background-color: #000; background-size: 2500px 405px; min-height: 405px;">
					<div class="container-fluid">
						<div class="row rowPad">
							<div class="all-blogs-cta"><a href="/blogs">‹ ALL BLOGS</a></div>
							<div class="category-label">
								
									<a href="/blogs/labs-research">Alien Labs</a>
								
							</div>
							<h1>MadoMiner Part 2 - Mask</h1>
							<div class="date">October 29, 2018 | <a href="/blogs/author/james-quinn">James Quinn</a></div>
						</div>
					</div>
				</div>

				<section class="full-width-block">

					<div class="container-fluid">

						<div class="row flx-container">
							<div class="col-sm-8">
								<div class="blog-content-area">
									<p><em>This is a guest post by independent security researcher James Quinn.</em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>

<p>If you have not yet read the first part of the <u><a href="/blogs/labs-research/madominer-part-1-install" target="_blank">MadoMiner analysis</a></u>, please do so now.&nbsp; This analysis will pick up where Part 1 left off, while also including&nbsp; a brief correction.&nbsp; The x64 version of the Install module was listed as identical to the x86 Install module.&nbsp; However, this is not correct.&nbsp; The x64 Install module is identical in run-through to the 360Safe.exe module, which will be discussed later in this analysis.</p>

<p>In addition, take care with this portion of the malware.&nbsp; The batch script for Mask.exe, DemC.bat, appears to run if it detects any copies of itself during runtime, or if you run the x64 version of install on a 32 bit machine.</p>

<p>Where Install.exe was in charge of infecting new victims with MadoMiner, it seems Mask.exe is where the real payoff lies.&nbsp; Mask.exe utilizes XMRig miners in order to mine for XMR which it then sells for profit.&nbsp; While madominer was earning $6,000 a month as of the last analysis,</p>

<p><img alt="" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/MadoMiner_Stats_Payment_History.png" style="width: 620px; height: 223px;" /></p>

<p>Around 10/14, MineXMR closed the old address due to botnet reports.&nbsp; A new address has been identified at 47QrUBQ4ejMW5wrWXiKUyRcQCZszauGWg9c3SLkzFoBJi45M5yN6gVPjVxSUfjMq4u8vepEejdnxyRQcv4RuFGy25x67433, mining through minexmr.com again.&nbsp; Currently, the hashrate is at 109Kh/s, and steadily rising.</p>

<p><img alt="" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/MadoMiner_Hash_Rate_History.png" style="width: 620px; height: 454px;" /></p>

<p>Also, around the time that the address changed, MadoMiner also became drastically different.</p>

<h2>Malware Analysis</h2>

<p>Where Install.exe only downloaded 1 file from a remote host, Mask.exe downloads two files.&nbsp; In addition, the servers used to download the files are also different than Install.exe, increasing the proposed size of the botnet.</p>

<p><img alt="" data-original="https://cdn-cybersecurity.att.com/blog-content/MadoMiner_Malware_Analysis-new.png" style="width: 620px; height: 348px;" /><strong>Domains</strong></p>

<p>In addition to the 2 domains identified in part 1, a new domain has also been identified for a distribution server:</p>

<ul>
	<li>http://d.honker[dot]info</li>
</ul>

<p>However, the domain is currently dead.&nbsp; In addition, the mining server currently used is pool.minexmr[dot]com</p>

<p>A C2 server(newly updated version):</p>

<ul>
	<li>http://qq.honker[dot]info</li>
</ul>

<p>Previously identified distribution domains:</p>

<ul>
	<li>http://da[dot]alibuf.com:3/</li>
	<li>http://bmw[dot]hobuff.info:3/</li>
</ul>

<p>Previously Identified IPs:</p>

<ul>
	<li>61.130.31.174</li>
</ul>

<p>Previously identified mining servers:</p>

<ul>
	<li>http://gle[dot]freebuf.info</li>
	<li>http://etc[dot]freebuf.info</li>
	<li>http://xmr[dot]freebuf.info</li>
	<li>http://xt[dot]freebuf.info</li>
	<li>http://boy[dot]freebuf.info</li>
	<li>http://liang[dot]alibuf.com</li>
	<li>http://dns[dot]alibuf.com</li>
	<li>http://x[dot]alibuf.com</li>
</ul>

<p>In addition, http://da[dot]alibuf.com:3, the main distribution server, seems to have been registered by bodfeo[at]hotmail.com in early October 2017. According to an analysis by Steve Butt of <u>DomainTools</u>, this email was linked to APT19/c0d0s0, however it was most likely due to domain reselling.</p>

<p><strong>Exploits</strong></p>

<p>During the execution of sogou.exe, the following exploits are used to install on new victims&rsquo; PCs:</p>

<ul>
	<li>CVE-2017-9073, RDP vulnerability on Windows XP and Windows Server 2003</li>
	<li>CVE-2017-0143, SMB exploit</li>
	<li>CVE-2017-0146, SMB exploit</li>
</ul>

<p><strong>Installation</strong></p>

<p>Mask.exe ends up on a victim&rsquo;s computer after either x86.dll or x64.dll downloads mado.exe or dst.exe, respectively.&nbsp; However, unlike with Install.exe, it doesn&rsquo;t matter which file is downloaded because they are the same files (They have the same file hash).</p>

<p><img alt="" data-original="https://cdn-cybersecurity.att.com/blog-content/MadoMiner_Installation-new.png" style="width: 623px; height: 64px;" /><img alt="" data-original="https://cdn-cybersecurity.att.com/blog-content/MadoMiner_Installation-new.png" style="width: 620px; height: 64px;" /></p>

<p><strong>Setup</strong></p>

<p>Once Mask.exe is on a victim&rsquo;s computer, it attempts to connect to one of the distribution servers identified above (bmw[dot]hobuff.info).&nbsp; Once a connection is established, it attempts to download two files, sogou.exe and 360safe.exe.&nbsp; Sogou.exe is the payload that contains the CPUInfo scanner, however, it has been set to scan for IPV6 addresses.&nbsp; Sogou is saved as Conhost.exe in C:\Windows\Installer.&nbsp; 360Safe.exe is the payload that contains the XMRig miners as well as the service manager (NSSM).&nbsp; 360Safe is saved as Makes.exe</p>

<p><strong>Mask.exe </strong></p>

<p>Mask.exe seems to be the profitable part of MadoMiner.&nbsp; Because of this, there are a lot more anti-debug tricks used during Mask.exe&rsquo;s runthrough.&nbsp; Mask.exe seems to be in charge of downloading/executing Sogou.exe and 360Safe.exe.&nbsp; Each of the modules also have batch scripts that will be discussed in the analysis that are run during different stages of the execution.&nbsp;</p>

<p>MadoMiner generates money by mining for XMR using Mask.exe, 360Safe.exe, and XMRig.&nbsp; Mask.exe installs 360Safe.exe which in turn installs XMRig.&nbsp; MadoMiner uses the service manager NSSM in order to install the necessary services for runtime and persistence.&nbsp; In addition, in Sogou.exe, MadoMiner appears to search for IPV6 addresses that are vulnerable to EternalBlue, as well as installs some tasks.</p>

<p>If Mask.exe detects another copy of itself, demC.Bat is run (see removal section for information).&nbsp; DemC.Bat is just like the DemC in Part 1, where it attempts to delete the malware from as an attempt at anti-debugging.&nbsp; It also seems to close any open ports so that you can&rsquo;t be reinfected --- how thoughtful!</p>

<p><strong>Sogou.exe runtime analysis</strong></p>

<p>Sogou.exe appears to be another propagation module for MadoMiner, which answers the question of &ldquo;Since x64.dll installed a miner during Install.exe, how did the x64 version of the malware propagate?&rdquo;&nbsp;</p>

<p>Sogou.exe, once downloaded by Mask.exe, saves itself to C:\%Windows%\Installer\conhost.exe, and then executes. However, Sogou.exe is more of a dropper than the full malware itself.&nbsp; Sogou.exe drops FileFtp.exe into C:\Program Files\Windowsd.&nbsp; FileFtp.exe appears to be a partially encrypted propagation module that uses the same exploits as ZombieBoyTools, which it drops into \Windowsd. However, this propagation module has a bit more in the way of hiding.&nbsp; Just like in all other modules of MadoMiner, FileFtp includes a script to delete itself from the filesystem.&nbsp; However, as any forensic investigator can tell you, when a file is deleted, it isn&rsquo;t really <em>gone</em>, at least not immediately.&nbsp; However, with FileFtp.exe, prior to deleting itself after installing the propagation exploits and the executable used to spread, runs <em>cmd /c cipher /w:C</em> , which begins overwriting unallocated space, where deleted files are stored.&nbsp; Not only does FileFTP.exe delete itself, <strong><em>it also wipes itself from the system entirely.</em></strong></p>

<p><img alt="" data-original="https://cdn-cybersecurity.att.com/blog-content/MadoMiner_Eternal_Romance-new.png" style="width: 619px; height: 169px;" /></p>

<p><strong>Tasks and batch scripts used by Sogou.exe</strong></p>

<p>AutoKMSK is used by sogou.exe to execute a copy of itself saved as C:\Windows\Installer\conhost.exe every 15 minute.&nbsp; It does this by using the command</p>

<p><em>schtasks /create /sc minute /mo 15 /tn &ldquo;AutoKMSK&rdquo; /tr &ldquo;C:\windows\Installer\conhost.exe&rdquo; /ru &ldquo;system&rdquo; /f</em></p>

<p>AutoKMSKK is used by sogou.exe to execute a script known as &ldquo;free.bat&rdquo;, which is very similar to Install.exe&rsquo;s free.bat.&nbsp; However, this script will essentially delete all files installed by conhost.exe every 26 mins.&nbsp; This is used by the malware in order to evade detection. The command for this is as follows</p>

<p><em>schtasks /create /sc minute /mo 26 /tn &ldquo;AutoKMSKK&rdquo; /tr &ldquo;C:\Windows\Installer\free.bat&rdquo; /ru &ldquo;system&rdquo; /f</em></p>

<p><em>Mask.exe&rsquo;s Free.bat</em></p>

<p><img alt="" data-original="https://cdn-cybersecurity.att.com/blog-content/MadoMiner_tasks_batch_scripts-new.png" style="width: 619px; height: 185px;" /></p>

<p><strong>360Safe.exe Brief Overview</strong></p>

<p>Where Sogou.exe appears to be a propagation module, 360Safe.exe is a pure mining module.&nbsp; 360Safe.exe begins on a computer after having been downloaded from bmw.hobuff[dot]info and executed by Mask.exe.&nbsp; As the main mining payload for MadoMiner, 360Safe is in charge of installing the service manager used by MadoMiner, and then dropping and installing the miner.&nbsp; However, 360Safe does this in a fairly modular and interesting way, because not only does 360Safe consist of both the x86 and x64 versions of the service manager used and the miner used, but it also identifies the architecture of the host PC and then dynamically creates a payload based on the architecture identified.&nbsp; In addition, 360Safe uses a number of anti-vm techniques, such as changing the base language of the files used by the service manager and using complete information when setting up registry keys (such as official looking descriptions and error messages upon tampering with malware).</p>

<p><strong>360Safe Service Manager</strong></p>

<p>360Safe uses NSSM as its service manager (Non-Sucking Service Manager).&nbsp; NSSM allows it to quickly and easily install services to the system using simple commands like <em>NSSM install <service name=""> <path-to-service></path-to-service></service></em>.&nbsp; However, 360Safe uses some techniques to hide the fact that it is NSSM.&nbsp; First, 360Safe changes the base language of the installation information for NSSM.&nbsp; The information is changed to the Host&rsquo;s language during runtime using the MessageBoxEx Windows API command.&nbsp; However, the result of this is that the strings are semi-unreadable when a basic string analysis is performed.</p>

<p><em>NSSM strings information</em></p>

<p><img alt="" data-original="https://cdn-cybersecurity.att.com/blog-content/MadoMiner_360safe-new.png" style="width: 620px; height: 236px;" /></p>

<p>In addition, once the architecture has been identified and the NSSM installer selected, a different installation location is used.&nbsp; In 360Safe&rsquo;s use of NSSM, it installs the service manager to the directory C:\%Windows%\Fonts as &ldquo;svchost.exe&rdquo;, with the registry keys&nbsp;</p>

<ul>
	<li>&ldquo;HKLM\SYSTEM\CurrentControlSet\Services\EventLog\&rdquo;</li>
	<li>&ldquo;HKLM\SYSTEM\CurrentControlSet\Services\EventLog\Application&rdquo;</li>
	<li>&ldquo;HKLM\SYSTEM\CurrentControlSet\Services\EventLog\Application\NSSM&rdquo;</li>
</ul>

<p>\NSSM values</p>

<ul>
	<li>&nbsp;&ldquo;EventMessageFile = C:\Windows\Fonts\svchost.exe&rdquo;</li>
	<li>&nbsp;&ldquo;TypesSupported = 0x00000007&rdquo;</li>
</ul>

<p>All of these can be used as IOCs.</p>

<p>In addition, any windows opened by NSSM are hidden so that the host doesn&rsquo;t suspect anything.&nbsp; Anytime that 360Safe needs to install a service, it calls &ldquo;C:\windows\Fonts\svchost.exe&rdquo; in order to do so.</p>

<p><em>NSSM Registry Installation</em></p>

<p><img alt="" data-original="https://cdn-cybersecurity.att.com/blog-content/MadoMiner_ncssm-new.png" style="width: 620px; height: 371px;" /></p>

<p><strong>360Safe Miner Installation</strong></p>

<p>Just like the rest of 360Safe, the mining portion also installs all of its executables to C:\%Windows%\Fonts.&nbsp; However, it doesn&rsquo;t use just one executable to install the miners.&nbsp; First, 360Safe.exe drops Conhost.exe into C:\%Windows%\Fonts.&nbsp; In addition to dropping conhost into C:\%Windows%\Fonts, a new service is created called ServiceMaims, which serves for persistence for Conhost.&nbsp;</p>

<p><img alt="" data-original="https://cdn-cybersecurity.att.com/blog-content/MadoMiner_Conhost-new.png" style="width: 620px; height: 127px;" /></p>

<p>The Display Name (EG: the Name that shows on Task manager) for ServiceMaims is &ldquo;<em>Network Location Service</em>&rdquo;, and the Description is &ldquo;<em>Provides performance library information from Windows Management</em>&rdquo;.</p>

<p>ServiceMaims is then started which in turn starts Conhost.</p>

<p>Registry Keys:</p>

<ul>
	<li>&ldquo;HKLM\SYSTEM\CurrentControlSet\Services\ServiceMaims&rdquo;</li>
	<li>&ldquo;HKLM\SYSTEM\CurrentControlSet\Services\ServiceMaims\Parameters&rdquo;</li>
	<li>&ldquo;HKLM\SYSTEM\CurrentControlSet\Services\ServiceMaims\Parameters\AppExit&rdquo;</li>
</ul>

<p>Values in \ServiceMaims\</p>

<ul>
	<li>&ldquo;DisplayName = ServiceMaims&rdquo;</li>
	<li>&ldquo;ErrorControl = 0x00000001&rdquo;</li>
	<li>&ldquo;ImagePath = C:\windows\Fonts\svchost.exe&rdquo;</li>
	<li>&ldquo;ObjectName = LocalSystem&rdquo;</li>
	<li>&ldquo;PreshutdownTimeout = 0x0002bf20&rdquo;</li>
	<li>&ldquo;Start = 0x00000002&rdquo;</li>
	<li>&ldquo;Type = 0x00000010&rdquo;</li>
</ul>

<p>Values in \ServiceMaims\Parameters\:</p>

<ul>
	<li>&ldquo;AppDirectory: C:\windows\Fonts&rdquo;</li>
	<li>&ldquo;Application: C:\windows\Fonts\conhost.exe&rdquo;</li>
	<li>&ldquo;AppParameters: &ldquo;</li>
</ul>

<p>Values in \ServiceMaims\Parameters\AppExit\:</p>

<ul>
	<li>&ldquo;(Default): Restart&rdquo;</li>
</ul>

<p><strong>360Safe Conhost</strong></p>

<p>Conhost.exe in C:\%Windows%\Fonts is used as a backup/dropper for the miner that will be installed.&nbsp; Conhost consists of the x86 version of XMRig, the x64 version of XMRig, and a dropper.&nbsp; The dropper has some installation scripts that are used for persistence, and also drops only one version of the miner, either x86 or x64 depending on your OS.</p>

<p>On first runtime, conhost enumerates the victim&rsquo;s OS architecture and then creates a file in C:\%Windows%\Fonts, called &ldquo;rundllhost.exe&rdquo;, where it saves either the x86 miner or the x64 miner, depending on your OS.&nbsp; It then runs a script to save the miner as a Service, as well as save the mining information into registry so that it can be passed to the miner during execution.</p>

<p><img alt="" data-original="https://cdn-cybersecurity.att.com/blog-content/MadoMiner_360_Conhost-new.png" style="width: 620px; height: 200px;" /></p>

<p>The DisplayName = &ldquo;<em>WMI Performance Services&rdquo; </em></p>

<p>The Description = &ldquo;<em>Identify Computers that are connected to the network, collect and store the properties of these networks, and notify the application when they are changed&rdquo;</em></p>

<p>The script then runs ServiceMais so that the miner can be executed.</p>

<p>Note:&nbsp; This miner only mines at 50% power, but was giving the authors over $6,000 a month before minexmr shut down the address.&nbsp; The new address is earning around $2,000 a month, and has only been active for a few days, however I&rsquo;ll get more into that below.</p>

<p>Registry Keys:</p>

<ul>
	<li>&ldquo;HKLM\SYSTEM\CurrentControlSet\Services\ServiceMais&rdquo;</li>
	<li>&ldquo;HKLM\SYSTEM\CurrentControlSet\Services\ServiceMais\Parameters&rdquo;</li>
	<li>&ldquo;HKLM\SYSTEM\CurrentControlSet\Services\ServiceMais\Parameters\AppExit&rdquo;</li>
</ul>

<p>Values in \ServiceMais\:</p>

<ul>
	<li>&ldquo;DisplayName = ServiceMais&rdquo;</li>
	<li>&ldquo;ErrorControl = 0x00000001&rdquo;</li>
	<li>&ldquo;ImagePath = C:\windows\Fonts\svchost.exe&rdquo;</li>
	<li>&ldquo;ObjectName = LocalSystem&rdquo;</li>
	<li>&ldquo;PreshutdownTimeout = 0x0002bf20&rdquo;</li>
	<li>&ldquo;Start = 0x00000002&rdquo;</li>
	<li>&ldquo;Type = 0x00000010&rdquo;</li>
</ul>

<p>Values in \ServiceMais\Parameters\:</p>

<ul>
	<li>&ldquo;AppDirectory: &ldquo;</li>
	<li>&ldquo;Application = rundllhost.exe&rdquo;</li>
	<li>&ldquo;AppParameters = -o pool.minexmr.com:443 -u 45WVNRZkKoR55thZWviZ3diXBLAcNRp4yFCtDCnCLRL7bq9E7XqQ7GX5auuc8thCvgUv1av6MpgC5gFVECYGHmx1VKkfEnp -p x -k --donate-level=1 --max-cpu-usage = 50</li>
</ul>

<h1>Mask.exe Removal</h1>

<p><strong>Disclaimer regarding updated malware:&nbsp; </strong>While MadoMiner did update itself around 10/14-10/16, 2018, it doesn&rsquo;t look like it can update the current bots that are already deployed, only new ones.&nbsp; For this reason, while IOCs regarding the new malware will be listed at the bottom, a removal section for the old malware will still be included.&nbsp; Just keep in mind that if your infection occurs after 10/16/2018, the file names listed in this guide may not be entirely accurate.&nbsp;</p>

<p><strong>Warning Regarding Batch Scripts</strong></p>

<p>Before attempting to remove this malware, the batch files should be brought up and treated with care.&nbsp; Make sure that all of your files are backed up.&nbsp; This malware deletes files and then wipes unallocated space, so file recovery is incredibly difficult.</p>

<p>DemC is mainly used by the malware to disable analysis attempts.&nbsp; If another copy of it is detected, or if you try to run the 64bit version of Install.exe on a 32 bit system, it scans your system for several different files and folders used in multiple different malware campaigns and makes them inaccessible.&nbsp; It also closes any open ports that are vulnerable to its campaigns.&nbsp; It also changes the Image File Execution Options, making it impossible to run the malware again.</p>

<p><strong>Removal Steps - Sogou.exe</strong></p>

<p>Sogou.exe installs 2 tasks during installation, which will need to be stopped, favorably before the free.bat task is allowed to run.&nbsp; The tasks, known as &ldquo;AutoKMSK&rdquo; and &ldquo;AutoKKMSK&rdquo;, can be located by opening the Windows tool &ldquo;Task Scheduler&rdquo;.&nbsp; These tasks will need to be stopped and deleted, however, note what files are executed by the tasks in the &ldquo;Actions&rdquo; tab of the task description.&nbsp; In this case, it would be &ldquo;C:\%Windows%\Installer\conhost.exe&rdquo; and &ldquo;C:\%Windows%\Installer\free.bat&rdquo;</p>

<p>In C:\%Windows%\, you&rsquo;ll want to locate a folder known as &ldquo;Installer&rdquo;.&nbsp; For Sogou.exe, this is the main installation folder.&nbsp; Inside Installer, you&rsquo;ll want to locate both &ldquo;Conhost.exe&rdquo; and &ldquo;free.bat&rdquo;.&nbsp; Delete them.&nbsp;</p>

<p>In C:\Program Files\, you&rsquo;ll want to locate a folder known as &ldquo;Windowsd&rdquo;.&nbsp; This is where Sogou.exe installs FileFTP.exe and all subsequent files dropped by FileFTP.exe.&nbsp; If the file deletion script hasn&rsquo;t already come through and removed them, you&rsquo;ll want to remove this entire folder.&nbsp; Note:&nbsp; Windowsd may or may not contain over 70 different files for propagation to other systems.</p>

<p><strong>Removal Steps - 360Safe.exe</strong></p>

<p>360Safe.exe appears to install more files into registry than Sogou.exe.&nbsp; First, as 360Safe.exe installs several services, those will need to be stopped using the Service manager, and then deleted from registry.</p>

<p>Service Name: Eventlog</p>

<p>Regkey: HKLM\SYSTEM\CurrentControlSet\Services\EventLog\</p>

<p>Image Location: C:\%windows%\Fonts\svchost.exe</p>

<p>Service Name: ServiceMaims</p>

<p>Regkey: HKLM\SYSTEM\CurrentControlSet\Services\ServiceMaims</p>

<p>Image Location: C:\%windows%\Fonts\conhost.exe</p>

<p>Service Name: ServiceMais</p>

<p>Regkey: HKLM\SYSTEM\CurrentControlSet\Services\ServiceMais</p>

<p>Image Location: C:\%windows%\Fonts\rundllhost.exe</p>

<p>360Safe saves itself to C:\%Windows%\ as makes.exe, which will need to be deleted as well.&nbsp;</p>

<p><strong>Removal Steps - Install.exe (x64)</strong></p>

<p>As the x64 version is a near identical miner to the x86 and x64 versions of mask.exe, the only things that have changed are the services installed.&nbsp; Removal steps are below however (order is respective.&nbsp; RpcEptManger = ServiceMaims, and Samserver = ServiceMais)</p>

<p>Service Name: Eventlog</p>

<p>Regkey: HKLM\SYSTEM\CurrentControlSet\Services\EventLog\</p>

<p>Image Location: C:\%windows%\Fonts\svchost.exe</p>

<p>Service Name = RpcEptManger</p>

<p>RegKey = SYSTEM/CurrentControlSet/Services/RpcEptManger/</p>

<p>Image Location = C:\%WindowsDirectory%\Fonts\wininit.exe</p>

<p>Service Name = Samserver</p>

<p>RegKey = SYSTEM/CurrentControlSet/Services/Samserver/</p>

<p>Image Location = C:\%WindowsDirectory%\Fonts\rundllhost.exe</p>

<p><strong>Removal - DemC Has Been Run</strong></p>

<p>In the case that DemC is run, removal becomes more complex.&nbsp; DemC&rsquo;s purpose is to hide MadoMiner from analysis and thus makes directories/takes ownership of current directories in order to hide.</p>

<p>Specifically</p>

<ul>
	<li>Removes the %Windows%\SpeechsTracing directory (if it exists)</li>
	<li>Removes the %Windows%\SecureBootThemes directory (If It exists)</li>
	<li>Removes the %Windows%\sysprepthemes directory (if it exists)</li>
	<li>Makes a new directory at %Windows%\SpeechsTracing\Microsoft and then proceeds to make that directory inaccessible for everyone</li>
	<li>Makes a new directory at %Windows%\SecureBootThemes and then proceeds to make that directory inaccessible for everyone.</li>
	<li>Makes a new directory at %Windows%\sysprepthemes and then proceeds to make that directory inaccessible for everyone</li>
	<li>Makes the file C:\ProgramData\Natihial\svshostr.exe inaccessible for everyone</li>
	<li>Makes the file C:\ProgramData\new\csrss inaccessible for everyone</li>
	<li>Makes the file C:\ProgramData\Microsoft\Natihial\cmd.exe inaccessible for everyone</li>
	<li>Makes the file C:\ProgramData\expl0rer.exe inaccessible for everyone</li>
	<li>Makes the file C:\windows\svchost.exe inaccessible for everyone</li>
	<li>Makes the directory C:\%windows%\svchost.exe and then proceeds to make that directory inaccessible for everyone</li>
	<li>Makes the directory C:\%windows%\tasksche.exe and then proceeds to make that directory inaccessible for everyone</li>
	<li>Makes the directory C:\program files (x86)\stormii\server.exe and then proceeds to make that directory inaccessible for everyone</li>
</ul>

<p>For the files made inaccessible, you&rsquo;ll need to take ownership of them, either by using the built in security manager GUI, or by using the sysinternals suite TakeOwn.</p>

<h2>Indicators of Compromise</h2>

<div style="overflow-x: auto;">
<table border="1" cellpadding="0" cellspacing="0" width="688">
	<tbody>
		<tr>
			<td style="width:117px;">
			<p><strong>Samples</strong></p>
			</td>
			<td style="width:102px;">
			<p><strong>Md5</strong></p>
			</td>
			<td style="width:88px;">
			<p><strong>Size</strong></p>
			</td>
			<td style="width:191px;">
			<p><strong>IP</strong></p>
			</td>
			<td style="width:190px;">
			<p><strong>IOC</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:117px;">
			<p>Mask.exe</p>
			</td>
			<td style="width:102px;">
			<p>4ae31911c1ef2ca4eded1fdbaa2c7a49</p>
			</td>
			<td style="width:88px;">
			<p>741.4 KB</p>
			</td>
			<td style="width:191px;">
			<p>bmw.hobuff[dot]info:3/</p>
			</td>
			<td style="width:190px;">
			<p>C:\%Windows%\tem.vbs</p>

			<p>C:\%Windows%\demc.bat</p>
			</td>
		</tr>
		<tr>
			<td style="width:117px;">
			<p>360Safe.exe</p>
			</td>
			<td style="width:102px;">
			<p>ce606d80b44ea2aae81056b9088ba1e4</p>
			</td>
			<td style="width:88px;">
			<p>3.6 MB</p>
			</td>
			<td style="width:191px;">
			<p>pool.minexmr[dot]com:443</p>
			</td>
			<td style="width:190px;">
			<p>Services:</p>

			<p>EventLog</p>

			<p>ServiceMaims</p>

			<p>ServiceMais</p>

			<p>&nbsp;</p>

			<p>Regkeys:&nbsp;</p>

			<p>&nbsp; +HKLM\SYSTEM\CurrentControlSet\Services\EventLog\</p>

			<p>&nbsp;+&nbsp; HKLM\SYSTEM\CurrentControlSet\Services\ServiceMaims</p>

			<p>&nbsp;+ HKLM\SYSTEM\CurrentControlSet\Services\ServiceMais\</p>

			<p>&nbsp;</p>

			<p>Executables:</p>

			<p>&nbsp;+ C:\%windows%\Fonts\svchost.exe</p>

			<p>&nbsp;+ C:\%windows%\Fonts\conhost.exe</p>

			<p>&nbsp;+ C:\%windows%\Fonts\rundllhost.exe</p>

			<p>&nbsp;</p>

			<p>Connection to pool.minexmr.com:443</p>

			<p>&nbsp;</p>

			<p>Scripts:</p>

			<p>C:\%Windows%\tem.vbs</p>
			</td>
		</tr>
		<tr>
			<td style="width:117px;">
			<p>360Safe_svchost_x86.exe</p>
			</td>
			<td style="width:102px;">
			<p>0a7d7ed55c4202f5106824f11ecb22fa</p>
			</td>
			<td style="width:88px;">
			<p>299 KB</p>
			</td>
			<td style="width:191px;">
			<p>-</p>
			</td>
			<td style="width:190px;">
			<p>Regkeys:&nbsp;</p>

			<p>&nbsp; +HKLM\SYSTEM\CurrentControlSet\Services\EventLog\</p>

			<p>&nbsp;</p>

			<p>Executables:</p>

			<p>&nbsp;+ C:\%windows%\Fonts\svchost.exe</p>

			<p>&nbsp;</p>
			</td>
		</tr>
		<tr>
			<td style="width:117px;">
			<p>360Safe_svchost_x64.exe</p>
			</td>
			<td style="width:102px;">
			<p>081f10718d76c9b3b19901f0ee630960</p>
			</td>
			<td style="width:88px;">
			<p>292KB</p>
			</td>
			<td style="width:191px;">
			<p>-</p>
			</td>
			<td style="width:190px;">
			<p>Services</p>

			<p>EventLog</p>

			<p>&nbsp;</p>

			<p>Regkeys:&nbsp;</p>

			<p>&nbsp; +HKLM\SYSTEM\CurrentControlSet\Services\EventLog\</p>

			<p>&nbsp;</p>

			<p>Executables:</p>

			<p>&nbsp;+ C:\%windows%\Fonts\svchost.exe</p>

			<p>&nbsp;</p>
			</td>
		</tr>
		<tr>
			<td style="width:117px;">
			<p>360Safe_conhost.exe</p>
			</td>
			<td style="width:102px;">
			<p>9c59ea0f58c5143b0860ec434d646780</p>
			</td>
			<td style="width:88px;">
			<p>2.3 MB</p>
			</td>
			<td style="width:191px;">
			<p>-</p>
			</td>
			<td style="width:190px;">
			<p>Services</p>

			<p>ServiceMaims</p>

			<p>&nbsp;</p>

			<p>Regkeys:</p>

			<p>+&nbsp; HKLM\SYSTEM\CurrentControlSet\Services\ServiceMaims</p>

			<p>&nbsp;</p>

			<p>Executables:</p>

			<p>+ C:\%windows%\Fonts\conhost.exe</p>

			<p>&nbsp;</p>
			</td>
		</tr>
		<tr>
			<td style="width:117px;">
			<p>360Safe_rundllhost_x86.exe</p>
			</td>
			<td style="width:102px;">
			<p>467d7dfe3a1fe82d12b38d997df5cfbe</p>
			</td>
			<td style="width:88px;">
			<p>1.6 MB</p>
			</td>
			<td style="width:191px;">
			<p>pool.minexmr[dot]com:443</p>
			</td>
			<td style="width:190px;">
			<p>Services:</p>

			<p>ServiceMais</p>

			<p>&nbsp;</p>

			<p>Regkeys:</p>

			<p>&nbsp;+ HKLM\SYSTEM\CurrentControlSet\Services\ServiceMais\</p>

			<p>&nbsp;</p>

			<p>&nbsp;</p>

			<p>Executables:</p>

			<p>&nbsp;+ C:\%windows%\Fonts\rundllhost.exe</p>

			<p>&nbsp;</p>

			<p>Connection to pool.minexmr.com:443</p>

			<p>&nbsp;</p>
			</td>
		</tr>
		<tr>
			<td style="width:117px;">
			<p>360Safe_rundllhost_x64.exe</p>
			</td>
			<td style="width:102px;">
			<p>e41f5e79400c985e8d8a25f0711095f15302e8dd</p>
			</td>
			<td style="width:88px;">
			<p>481 KB</p>
			</td>
			<td style="width:191px;">
			<p>pool.minexmr[dot]com:443/</p>
			</td>
			<td style="width:190px;">
			<p>Regkeys:</p>

			<p>&nbsp;+ HKLM\SYSTEM\CurrentControlSet\Services\ServiceMais\</p>

			<p>&nbsp;</p>

			<p>&nbsp;</p>

			<p>Executables:</p>

			<p>&nbsp;+ C:\%windows%\Fonts\rundllhost.exe</p>

			<p>&nbsp;</p>

			<p>Connection to pool.minexmr.com:443</p>
			</td>
		</tr>
		<tr>
			<td style="width:117px;">
			<p>Sogou.exe</p>
			</td>
			<td style="width:102px;">
			<p>edfa66accd958eb87a6e8ef1eb708d2f</p>
			</td>
			<td style="width:88px;">
			<p>3.9 MB</p>
			</td>
			<td style="width:191px;">
			<p>-</p>
			</td>
			<td style="width:190px;">
			<p>Folder:</p>

			<p>C:\%Program Files%\Windowsd</p>

			<p>&nbsp;</p>

			<p>Tasks:</p>

			<p>AutoKMSK</p>

			<p>AutoKKMSK</p>

			<p>&nbsp;</p>

			<p>Executables:</p>

			<p>C:\%Windows%\Installer\conhost.exe</p>

			<p>&nbsp;</p>

			<p>C:\%Windows%\Windowsd\FileFtp.exe</p>

			<p>&nbsp;</p>

			<p>Assorted executables needed for spreading found in \Windowsd</p>

			<p>&nbsp;</p>

			<p>Scripts:</p>

			<p>C:\%Windows%\free.bat</p>
			</td>
		</tr>
		<tr>
			<td style="width:117px;">
			<p>FileFtp.exe</p>
			</td>
			<td style="width:102px;">
			<p>1188f935979806545cbf118e22416be5</p>
			</td>
			<td style="width:88px;">
			<p>8.9 MB</p>
			</td>
			<td style="width:191px;">
			<p>-</p>
			</td>
			<td style="width:190px;">
			<p>C:\%Windows%\Windowsd\FileFtp.exe</p>

			<p>&nbsp;</p>

			<p>Assorted executables needed for spreading found in \Windowsd</p>

			<p>&nbsp;</p>
			</td>
		</tr>
		<tr>
			<td style="width:117px;">
			<p>Installx64.exe</p>
			</td>
			<td style="width:102px;">
			<p>d8470f5c12f5a5fee89de4d4c425d614</p>
			</td>
			<td style="width:88px;">
			<p>1.3 MB</p>
			</td>
			<td style="width:191px;">
			<p>x.alibuff[dot]com</p>
			</td>
			<td style="width:190px;">
			<p>Services:</p>

			<p>EventLog</p>

			<p>RpcEptManger</p>

			<p>Samserver</p>

			<p>&nbsp;</p>

			<p>RegKey:</p>

			<p>HKLM\SYSTEM\CurrentControlSet\Services\EventLog\</p>

			<p>HKLM\SYSTEM\CurrentControlSet\Services\RpcEptManger\</p>

			<p>HKLM\SYSTEM\CurrentControlSet\Services\Samserver\</p>

			<p>&nbsp;</p>

			<p>Executables: C:\%windows%\Fonts\svchost.exe</p>

			<p>C:\%WindowsDirectory%\Fonts\wininit.exe</p>

			<p>C:\%WindowsDirectory%\Fonts\rundllhost.exe</p>
			</td>
		</tr>
		<tr>
			<td style="width:117px;">
			<p>Installx64_svchost.exe</p>
			</td>
			<td style="width:102px;">
			<p>081f10718d76c9b3b19901f0ee630960</p>
			</td>
			<td style="width:88px;">
			<p>299 KB</p>
			</td>
			<td style="width:191px;">
			<p>-</p>
			</td>
			<td style="width:190px;">
			<p>Services:</p>

			<p>EventLog</p>

			<p>&nbsp;</p>

			<p>RegKey:</p>

			<p>HKLM\SYSTEM\CurrentControlSet\Services\EventLog\</p>

			<p>&nbsp;</p>

			<p>Executables:</p>

			<p>C:\%windows%\Fonts\svchost.exe</p>

			<p>&nbsp;</p>
			</td>
		</tr>
		<tr>
			<td style="width:117px;">
			<p>Installx64_wininit.exe</p>
			</td>
			<td style="width:102px;">
			<p>081f10718d76c9b3b19901f0ee630960</p>
			</td>
			<td style="width:88px;">
			<p>490 KB</p>
			</td>
			<td style="width:191px;">
			<p>-</p>
			</td>
			<td style="width:190px;">
			<p>Services:</p>

			<p>RpcEptManger</p>

			<p>&nbsp;</p>

			<p>RegKey:</p>

			<p>HKLM\SYSTEM\CurrentControlSet\Services\RpcEptManger\</p>

			<p>&nbsp;</p>

			<p>&nbsp;</p>

			<p>Executables:</p>

			<p>C:\%WindowsDirectory%\Fonts\wininit.exe</p>
			</td>
		</tr>
		<tr>
			<td style="width:117px;">
			<p>Installx64_rundllhost.exe</p>
			</td>
			<td style="width:102px;">
			<p>e41f5e79400c985e8d8a25f0711095f15302e8dd</p>
			</td>
			<td style="width:88px;">
			<p>481 KB</p>
			</td>
			<td style="width:191px;">
			<p>x.alibuff[dot]com</p>
			</td>
			<td style="width:190px;">
			<p>Services:</p>

			<p>Samserver</p>

			<p>&nbsp;</p>

			<p>RegKey:</p>

			<p>HKLM\SYSTEM\CurrentControlSet\Services\Samserver\</p>

			<p>&nbsp;</p>

			<p>Executables:</p>

			<p>C:\%WindowsDirectory%\Fonts\rundllhost.exe</p>
			</td>
		</tr>
		<tr>
			<td style="width:117px;">
			<p>MadoMiner_New_445.exe</p>
			</td>
			<td style="width:102px;">
			<p>d4d8f87c61051c28ca3cee7e38bf839d</p>
			</td>
			<td style="width:88px;">
			<p>2.1 MB</p>
			</td>
			<td style="width:191px;">
			<p>a.f2pool[dot]info:13531</p>
			</td>
			<td style="width:190px;">
			<p>Task named &ldquo;GooglePingInCongifs&rdquo; executing C:\windows\lsass.exe</p>

			<p>C:\%WindowsDirectory%\Install.exe</p>

			<p>C:\%WindowsDirectory%\lsass.bat</p>

			<p>Mining at a.f2pool[dot]info</p>
			</td>
		</tr>
		<tr>
			<td style="width:117px;">
			<p>MadoMiner_New_445_Lsass.exe</p>
			</td>
			<td style="width:102px;">
			<p>1dd1550f2586411766cba953badf76f7</p>
			</td>
			<td style="width:88px;">
			<p>4.5 MB</p>
			</td>
			<td style="width:191px;">
			<p>a.f2pool[dot]info:13531</p>
			</td>
			<td style="width:190px;">
			<p>C:\%WindowsDirectory%\lsass.exe</p>

			<p>&nbsp;</p>
			</td>
		</tr>
		<tr>
			<td style="width:117px;">
			<p>MadoMiner_New_Dst.exe</p>
			</td>
			<td style="width:102px;">
			<p>4ace52693bdeace5b285d35e47be6cfc</p>
			</td>
			<td style="width:88px;">
			<p>102.4 kb</p>
			</td>
			<td style="width:191px;">
			<p>qq.honker[dot]info</p>
			</td>
			<td style="width:190px;">
			<p>Service:</p>

			<p>Jklmno</p>

			<p>&nbsp;</p>

			<p>Regkey:</p>

			<p>HKLM\SYSTEM\CurrentControlSet\Services\Jklmno</p>

			<p>&nbsp;</p>

			<p>Executable:</p>

			<p>C:\%Windows%\svchost.exe</p>
			</td>
		</tr>
		<tr>
			<td style="width:117px;">
			<p>MadoMiner_New_Dst_DecryptedRAT.exe</p>
			</td>
			<td style="width:102px;">
			<p>01374ea3c48b69876d9375a2baba76ce</p>
			</td>
			<td style="width:88px;">
			<p>51.6 kb</p>
			</td>
			<td style="width:191px;">
			<p>qq.honker[dot]info</p>
			</td>
			<td style="width:190px;">
			<p>Service:</p>

			<p>Jklmno</p>

			<p>&nbsp;</p>

			<p>Regkey:</p>

			<p>HKLM\SYSTEM\CurrentControlSet\Services\Jklmno</p>

			<p>&nbsp;</p>

			<p>Executable:</p>

			<p>C:\%Windows%\svchost.exeds</p>
			</td>
		</tr>
		<tr>
			<td style="width:117px;">
			<p>MadoMiner_New_Mask.exe</p>
			</td>
			<td style="width:102px;">
			<p>345239f58ddfd522ff04ad67009d15e9</p>
			</td>
			<td style="width:88px;">
			<p>4.5 MB</p>
			</td>
			<td style="width:191px;">
			<p>l.f2pool[dot]info:443/</p>
			</td>
			<td style="width:190px;">
			<p>C:\%WindowsDirectory%\Fonts\lsass.exe</p>

			<p>C:\%WindowsDirectory%\Fonts\svchost.exe</p>

			<p>C:\%WindowsDirectory%\Fonts\runhost.exe</p>

			<p>&nbsp;</p>
			</td>
		</tr>
		<tr>
			<td style="width:117px;">
			<p>MadoMiner_New_Mask_lsass.exe</p>
			</td>
			<td style="width:102px;">
			<p>0ef0a7198444a43be51948e10cc15c53</p>
			</td>
			<td style="width:88px;">
			<p>3.5 MB</p>
			</td>
			<td style="width:191px;">
			<p>l.f2pool[dot]info:443/</p>
			</td>
			<td style="width:190px;">
			<p>C:\%WindowsDirectory%\Fonts\lsass.exe</p>
			</td>
		</tr>
		<tr>
			<td style="width:117px;">
			<p>MadoMiner_New_Mask_svchost.exe</p>
			</td>
			<td style="width:102px;">
			<p>8a44626c2ca26a84764e7ad771143d44</p>
			</td>
			<td style="width:88px;">
			<p>89.1 kb</p>
			</td>
			<td style="width:191px;">
			<p>-</p>
			</td>
			<td style="width:190px;">
			<p>C:\%WindowsDirectory%\Fonts\svchost.exe</p>
			</td>
		</tr>
	</tbody>
</table>
</div>
									<div class="blog-related">
									<div class="be-ix-link-block"></div>
									</div>
								</div>
								<div class="blog-author">
									<a href="https://cybersecurity.att.com/blogs/author/james-quinn" class="blog-avatar">
									
										<img src="data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22150px%22%20height%3D%22150px%22%3E%3Crect%20fill%3D%22none%22%20width%3D%22150%22%20height%3D%22150%22%2F%3E%3C%2Fsvg%3E" data-original="/avatars/uploads/avatar_253.jpg" width="150" height="150" alt="James Quinn" />
									
									</a>

									<div class="blog-author-info">
										<p><strong>About the Author:</strong> <span>James Quinn</span></p>
										<p>James has been programming since he was 12 but didn't become interested in Cybersecurity until around 16. He's now finishing his 3rd semester for a Cybersecurity associate's degree. In James' free time, he analyzes malware dropped on his dionaea honeypot and would consider himself an amateur photographer.</p>


										<p><a href="/blogs/author/james-quinn">Read more posts from James Quinn ›</a></p>

									</div>
								</div>


								<div class="blog-categories">
								<p>TAGS: <a href="/blogs/tag/malware" title="malware" rel="nofollow">malware</a>, <a href="/blogs/tag/malware+research" title="malware research" rel="nofollow">malware research</a>, <a href="/blogs/tag/madominer" title="madominer" rel="nofollow">madominer</</p>
								</div>


								<p><a href="https://cybersecurity.att.com/blogs/labs-research" class="back-to-all">‹ BACK TO ALL BLOGS</a></p>
							</div>
							
							<div class="col-sm-4">
								<div>
									<div class="blog-sidebar-block">
    <form id="searchbox_002748587151982842036:gharkgtx6cu" action="/search-results/blog" class="sidebar-search">
        <input value="002748587151982842036:gharkgtx6cu" name="cx" type="hidden" />
        <input value="FORID:11" name="cof" type="hidden" />
        <div class="search-button">
            <input value="Search" name="sa" type="submit" />
        </div>
        <div class="search-field">
            <input id="q" name="q" type="text" placeholder="Search our blogs" />
        </div>
    </form>
</div>

<div class="blog-subscribe-grid" id="blog-subscribe-box">

    <h2>Get the latest security news in your inbox.</h2>

    <p class="text-center"><a class="btn btn-blue digestoform" id="digestobutton" target="_blank">Subscribe via email</a></p>

    <script>window.addEventListener('DOMContentLoaded', function() { var href_string="https://pages.alienvault.com/Digesto.html"+get_cookie_url_string()+"&redirect=https://cybersecurity.att.com/forms/email-thank-you";document.getElementById("digestobutton").href=href_string;});</script>
</div>
<p style="text-align: right; margin: 30px 10px 5px 0;"><a href="http://feeds.feedblitz.com/alienvault-blogs" target="_blank"><img src="https://cdn-cybersecurity.att.com/images/uploads/icons/rss.svg" width="20" height="20" style="display: inline-block; margin: 0 7px 2px;">RSS</a>
</p>
									<div class="promo-block">
										
													
			<style type="text/css">#blog-promo-block-v2 .blog-promo-item-v2 {
    box-shadow: 1px 1px 5px #D2D2D229;
    border: 1px solid #D2D2D2;
    margin-bottom: 30px;
}
#blog-promo-block-v2 .blog-promo-item-v2 .blog-promo-resource-type-v2 {
    font-size: 14px;
    color: #0568AE;
    font-weight: 500;
    padding: 15px;
    margin: 0;
}
#blog-promo-block-v2 .blog-promo-item-v2 .blog-promo-item-text-v2 {
    margin-bottom:15px;
}
#blog-promo-block-v2 .blog-promo-item-v2 .blog-promo-item-text-v2 a {
    color: black;
    text-decoration: none;
    font-weight: 500;
}
#blog-promo-block-v2 .blog-promo-item-v2 .blog-promo-item-text-v2 p {
   margin: 0 15px;
}

#blog-promo-block-v2 .blog-promo-item-icon-v2 {
   margin: 15px;
   font-size: 16px;
}
#blog-promo-block-v2 .blog-promo-item-icon-v2 .icon-right {
    width: 20px;
    height: 20px;
    border: 1px solid #0568ae;
    border-radius: 20px;
    font-size: 9.5px;
    line-height: 18px;
    font-weight: 400;
    margin-right: 10px;
    padding-left: 4px;
    top: -1px;
}
@media (max-width: 1024px) {
 .blog-promo-item-v2 img {
    display: none;
  }
}
</style>
<div id="blog-promo-block-v2">
<h3>Featured resources</h3>

<div class="blog-promo-item-v2"><img src="https://cdn-cybersecurity.att.com/images/uploads/resource-images/5g-and-the-journey.jpg" />
<p class="blog-promo-resource-type-v2">INDUSTRY REPORT</p>

<div class="blog-promo-item-text-v2">
<p><a href="/resource-center/industry-reports/cybersecurity-insights-report-tenth-edition">AT&amp;T Cybersecurity Insights&trade; Report:<br />
5G and the Journey to the Edge</a></p>
</div>

<div class="blog-promo-item-icon-v2"><span aria-hidden="true" class="icon-right glyphicon glyphicon-chevron-right">&nbsp;</span> <a href="/resource-center/industry-reports/cybersecurity-insights-report-tenth-edition">Learn more</a></div>
</div>

<div class="blog-promo-item-v2"><img src="https://cdn-cybersecurity.att.com/images/uploads/resource-images/security-maturity-assessment.jpg" />
<p class="blog-promo-resource-type-v2">SELF ASSESSMENT</p>

<div class="blog-promo-item-text-v2">
<p><a href="/resource-center/security-maturity-assessment?utm_internal=blog-rail-assess">Benchmark your cybersecurity maturity</a></p>
</div>

<div class="blog-promo-item-icon-v2"><span aria-hidden="true" class="icon-right glyphicon glyphicon-chevron-right">&nbsp;</span> <a href="/resource-center/security-maturity-assessment?utm_internal=blog-rail-assess">Explore</a></div>
</div>
</div>
		
										

									</div>
								</div>
							</div>
						</div>
					</div>
				</section>


			</main>


			
				<style>

	/* Sticky button */
	.desktop .sticky_bottom_keeper {
		height: 80px;
	}
	.sticky_bottom_desktop.fixed {
		height: 80px;
	}
	.sticky_bottom_keeper .btn {
		color: #fff;
	}
	.sticky_bottom_keeper .btn-white {
		border: 2px solid #fff;
	}
	.sticky_bottom_keeper .btn-white.btn-border {
		background: transparent;
	}




	.line.line-8 {
		height: 8px;
	}

	.hh .sticky_bottom_keeper {
		display: block !important;
		height: 8px;
		background: #009fdb;
	}

	.sticky_bottom_keeper .sticky_bottom_hh.fixed {display:none;}


</style>
<div class="sticky_bottom_keeper">


	<div class="sticky_bottom sticky_bottom_hh">
		<a class="sticky_bottom_hh_cta" href="#watch-alienvault-threat-detection-XwZyCKfKXbLhhBtQqFGT1L:7010Z000001v1DO">Watch
			a demo &#8250;</a>

		<a href="#" class="sticky_bottom_hh_close avicon-close"></a>
	</div>

	<div class="sticky_bottom sticky_bottom_desktop ibp">
		<a href="/pricing/request-quote" class="btn btn-border btn-white btn-rounded btn-with-arrow">Get price</a>
		<a href="/products/usm-anywhere/free-trial" class="btn btn-border btn-white btn-rounded btn-with-arrow">Free trial</a>

	</div>


</div>
			
		


		<footer id="footer" class="hidden-print">
  <div class="container-fluid">
    <div class="row">
      <div class="col-sm-6 col-md-3">
        
        <div class="footer_logo"><img src="data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22263px%22%20height%3D%2256px%22%3E%3Crect%20fill%3D%22none%22%20width%3D%22263%22%20height%3D%2257%22%2F%3E%3C%2Fsvg%3E" data-original="https://cdn-cybersecurity.att.com/images/uploads/logos/att_biz_hz_pref_rgb_white.png" alt="AT&T Business"></div>
        <div class="footer_featured">

          <div class="footer_featured_title">From the Blog</div>
          <article class="footer_featured_article">
            <div class="footer_featured_article_author clearfix">
	            
										<img src="data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22150px%22%20height%3D%22150px%22%3E%3Crect%20fill%3D%22none%22%20width%3D%22150%22%20height%3D%22150%22%2F%3E%3C%2Fsvg%3E" data-original="/avatars/uploads/avatar_357_1.jpg" width="150" height="150" alt="Mark Stone" />
									
              <div class="footer_featured_article_author_data">
                <h4>Mark Stone</h4>
                <time datetime="2021-06-18">Mar 18, 2021</time>
              </div>
            </div>
            <h3><a href="https://cybersecurity.att.com/blogs/security-essentials/what-is-a-security-operations-center-soc" id="footer-link-blog-post">What is a security operations center (SOC)? Explaining the SOC framework</a></h3>
          </article>
          <a id="footer-link-blog-all" href="/blogs" class="footer_featured_more">Explore All Blog Posts
            &#8250;</a>
        </div>
        

        <div class="social-style">
          <a href="https://www.twitter.com/attcyber/" class="social-link-twitter" target="_blank">Twitter</a>
          <a href="https://www.linkedin.com/company/attcybersecurity/" class="social-link-linkedin" target="_blank">Linkedin</a>
          <a href="https://www.facebook.com/ATTCyber/" class="social-link-facebook" target="_blank">Facebook</a>
          <a href="https://www.youtube.com/c/attcybersecurity" class="social-link-youtube" target="_blank">Youtube</a>
          <a href="https://www.instagram.com/attbusiness/" class="social-link-instagram" target="_blank">Instagram</a>
          <a href="https://community.spiceworks.com/pages/attcybersecurity" class="social-link-spiceworks" target="_blank">Spiceworks</a>


        </div>
      </div>

      <div class="col-sm-6 col-md-3">
        <div class="footer_links">
          <div class="heading">Who We Are</div>
          <ul>
            <li><a id="footer-link-labs" href="/alien-labs">Alien Labs</a></li>
            <li><a id="footer-link-customers" href="/who-we-are/customers">Customers</a></li>
            <li><a id="footer-link-careers" href="/who-we-are/careers">Careers</a></li>
            <li><a id="footer-link-contact" href="/contact">Contact Us</a></li>
          </ul>
        </div>

        <div class="footer_links">
          <div class="heading">News</div>
          <ul>
            <li><a id="footer-link-news-room" href="/who-we-are">Newsroom</a></li>
            <li><a id="footer-link-events" href="/who-we-are/events">Events</a></li>
            <li><a id="footer-link-blogs" href="/blogs">Blogs</a></li>
          </ul>
        </div>

        <div class="footer_links">
          <div class="heading">Partners</div>
          <ul>
            <li><a id="footer-link-partners" href="/partners">Partner Programs</a></li>
            <li><a id="footer-link-partner-portal" href="/partners/partner-portal/">Partner Portal</a></li>
          </ul>
        </div>
      </div>

      <div class="col-sm-6 col-md-3">
        <div class="footer_links">
          <div class="heading">Products</div>
          <ul>
		  	<li><a id="footer-link-mtdr" href="/products/managed-threat-detection-and-response">AT&T Managed Threat Detection and Response</a></li>
            <li><a id="footer-link-usm-anywhere" href="/products/usm-anywhere">USM Anywhere</a></li>
            <li><a id="footer-link-usm-mssp" href="/products/usm-for-mssp">USM for MSSPs</a></li>
            <li><a id="footer-link-managed-security" href="/products/managed-security-services">Partner Managed Solutions</a></li>
            <li><a id="footer-link-otx" href="/open-threat-exchange">Open Threat Exchange (OTX)</a></li>
            <li><a id="footer-link-ossim" href="/products/ossim">OSSIM</a></li>

          </ul>
        </div>



        <div class="footer_links">
          <div class="heading">Solutions</div>
          <ul>
            <li><a id="footer-link-cloud-security" href="/solutions/cloud-security-monitoring">Cloud Security Monitoring</a></li>
            <li><a id="footer-link-threat-detection" href="/solutions/threat-detection">Threat Detection</a></li>
            <li><a id="footer-link-ids" href="/solutions/intrusion-detection-system">Intrusion Detection</a></li>
            <li><a id="footer-link-siem" href="/solutions/siem-platform-solutions">SIEM platform solutions</a></li>
            <li><a id="footer-link-vulnerability" href="/solutions/vulnerability-assessment-remediation">Vulnerability
                Assessment</a></li>
            <li><a id="footer-link-all-solutions" class="btn-with-arrow" href="/solutions">See All Solutions</a></li>
          </ul>
        </div>
      </div>

      <div class="col-sm-6 col-md-3">
        <div class="footer_links">
          <div class="heading">Resources</div>
          <ul>
            <li><a id="footer-link-resources" href="/resource-center">Resources</a></li>
            <li><a id="footer-link-blog" href="/blogs">Blogs</a></li>
            <li><a id="footer-link-reference-guide" href="https://www.business.att.com/content/dam/attbusiness/guides/att-information-and-network-security-customer-reference-guide.pdf" target="_blank">Customer Reference Guide</a></li>

          </ul>
        </div>

        <div class="footer_links">
          <div class="heading">Customer Success</div>
          <ul>
            <li><a id="footer-link-support" href="/support">Support &amp; Services</a></li>
            <li><a id="footer-link-customer-portal" href="https://success.alienvault.com" target="_blank">Success Center</a></li>
            <li><a id="footer-link-documentation" href="/documentation">Documentation Center</a></li>
            <li><a id="footer-link-classroom-training" href="/training">Training</a></li>
            <li><a id="footer-link-certification" href="/certification">Certification</a></li>
          </ul>
        </div>

        <div class="footer_contact">
          <a href="/contact" id="footer-button-contact" class="btn btn-blue margin-bottom20">Contact us</a>
        </div>
      </div>
    </div>
    <div class="footer_legal">
      <p class="footer_legal_copy">&copy; Copyright 2021</p>
      <ul class="footer_legal_links">
        <li><a id="footer-link-privacy" href="/legal/privacy-policy">Privacy Policy</a></li>
        <li><a id="footer-link-terms" href="/terms/website-terms-of-use07may2018">Website Terms of Use</a></li>
        <li><a id="footer-link-gdpr" href="/legal/gdpr">GDPR</a></li>
        <li><a id="footer-link-cookie" href="/legal/cookie-policy">Cookie Policy</a></li>
        <li><a id="footer-link-personal-info" href="https://about.att.com/csr/home/privacy/rights_choices.html" target="_blank">Do Not Sell My Personal Information</a></li>

      </ul>
    </div>
  </div>
</footer>

<div id="valid_content"></div>

		
	<script src="https://cdn-cybersecurity.att.com/js/v2/imports/blog-bundle.min.js?v=20210316522111" defer></script>






		



<div class="cookie-notice">
    <p>We use cookies to provide you with a great user experience. By using our website, you agree to our <a href="https://www.att.com/privacy">Privacy Policy</a> and <a href="/terms/website-terms-of-use07may2018">Website Terms of Use</a>.</p>
    <a class="cookie-notice-close" href="#" aria-label="Close Cookie Notice"><span class="glyphicon glyphicon-remove"></span></a>
</div>


<!-- WGT-10310 -->

<!-- END WGT-10310 -->

<script src='https://www.att.com/scripts/adobe/prod/detm-container-hdr.js' data-restrictions='target' type='text/javascript' defer></script>
<script src='https://www.att.com/scripts/adobe/prod/detm-container-ftr.js' type='text/javascript' defer></script>



<script>
if (typeof ddo !== "undefined") {
	$(document).ready(function() {
	
	

	
	
	});
}

function initAdobePageTrackingFooter() {
	ddo.setVar('page.pageInfo.language','EN');
	ddo.setVar('page.pageInfo.lineOfBusiness','Business Solutions');
	ddo.setVar('page.category.pageFunction','Learn');
	ddo.setVar('page.category.pageOwnership','Business');
	ddo.setVar('page.attributes.applicationName','CYB');
	ddo.setVar('page.pageInfo.appCode','ACS');
	ddo.setVar('page.category.siteSection','CYB');
	ddo.setVar('page.category.siteSection','CYB');
	ddo.setVar('page.media.class','text');
	ddo.setVar('page.media.objective','Awareness');
	ddo.setVar('page.media.category','Security');
	ddo.setVar('page.location.domain','cybersecurity.att.com');
	ddo.pushEvent('pageLoad', 'Page_Load');
}
</script>


		<script>
			window.addEventListener('DOMContentLoaded', function() {
				$(window).load(function () {
					var hideSubscribe = AV.Utilities.readCookie('stickyBlogSubscribe');
					// if the cookie hasn't been set...
					if (hideSubscribe == null) {
						setTimeout(function () {
							// make the modal appear
							$('#blog-subscribe-box').fadeIn();
						}, 10000);

						// when the "Close" button is clicked
						$('.blog-subscribe-close-btn').click(function (e) {
							e.preventDefault();
							// set the cookie
							AV.Utilities.setCookie('stickyBlogSubscribe', true, 1);
							$('#blog-subscribe-box').fadeOut();
						});
					}
				});
			});
		</script>

	<script type="text/javascript" >var _cf = _cf || [];  _cf.push(['_setFsp', true]);  _cf.push(['_setBm', true]);  _cf.push(['_setAu', '/libraries/8ff88d9aano23331406e461ab4dfa32']); </script><script type="text/javascript"  src="/libraries/8ff88d9aano23331406e461ab4dfa32"></script></body>
</html>
