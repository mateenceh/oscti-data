<!DOCTYPE html>
<html lang="en">

<head>
	

	


	

	<!--trying to figure out the canonical url issue with blogs-->
	<link rel="canonical" href="https://cybersecurity.att.com/blogs/labs-research/reversing-gh0strat-part-2-the-ddos-ening" />

	<title>Reversing Gh0stRAT part 2: the DDOS-ening | AT&T Alien Labs</title>

	

		

	<meta property="og:site_name" value="AT&T Cybersecurity" />
	<meta property="og:title" content="Reversing Gh0stRAT part 2: the DDOS-ening" />
	<meta property="og:url" content="https://cybersecurity.att.com/blogs/labs-research/reversing-gh0strat-part-2-the-ddos-ening" />
	
	<meta property="og:description" content="This is a guest post James Quinn, a SOC analyst from Binary Defense.

In Part 1 of the Reversing Gh0stRAT series, we talked about a partial Gh0stRAT variant which used an encryption algorithm to hide its traffic.&nbsp; In part 2, we will be talking about a much more complete Gh0stRAT sample which allows a hacker to take total control over a victim&rsquo;s computer.&nbsp; Additionally, once control is gained, the hacker can use unique commands in this Gh0stRAT sample to Denial of Service (&ldquo;" />
		



	<meta charset="utf-8">

<link rel="preconnect" href="https://cdn-cybersecurity.att.com" />
<link rel="preconnect" href="https://www.att.com" />
<link rel="preconnect" href="https://www.googletagmanager.com" crossorigin />
<link rel="preconnect" href="https://cdn.vidyard.com" crossorigin />
<link rel="preconnect" href="https://ajax.cloudflare.com" crossorigin />
<link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin />
<link rel="preconnect" href="https://googleads.g.doubleclick.net" crossorigin />
<link rel="preconnect" href="https://www.google-analytics.com" crossorigin />
<link rel="preconnect" href="https://play.vidyard.com" crossorigin />
<link rel="preconnect" href="https://adservice.google.com" crossorigin />
<link rel="preconnect" href="https://www.googleadservices.com" crossorigin />
<link rel="preconnect" href="https://www.facebook.com" crossorigin />
<link rel="preconnect" href="https://www.google.com" crossorigin />
<link rel="preconnect" href="https://px.ads.linkedin.com" crossorigin />


<script src="https://cdn-cybersecurity.att.com/js/v2/imports/top-bundle.min.js?v=20210316522111"></script>


<link rel="preload" href="https://www.att.com/scripts/adobe/prod/edmDataDefinition.js" as="script">
<link rel="preload" href="https://www.att.com/scripts/adobe/prod/edmDataManager.js" as="script">
<link rel="preload" href="https://www.att.com/scripts/adobe/prod/marketing.min.js" as="script">
<link rel="preload" href="https://www.att.com/scripts/adobe/prod/detm_adobe.js" as="script">






<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KLJDXJN');</script>
<!-- End Google Tag Manager -->
<script src='https://www.att.com/scripts/adobe/prod/detm-container-hdr.js' data-restrictions='target' type='text/javascript'></script>


<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="ahrefs-site-verification" content="a6fa0378625f72f89c6f290c3c7559ffee326fb9232cd87fcace798afce3e30d">
<meta name="google-site-verification" content="GTQZz4AGa47UtmP64oC5BB735pkyncjtISHOcQZbIho" />

<link rel="preload" as="font" type="font/ttf" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/zero-width.ttf" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Bold.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Regular.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Light.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Medium.woff2" />


<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-LightItalic.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-BoldItalic.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-MediumItalic.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Italic.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Black.woff2" />

<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/css/fonts/glyphicons-halflings-regular.woff2" />
<link rel="preload" as="font" type="font/ttf" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/av-icons.ttf?e81fxl" />



<link rel="preload" as="style" href="https://cdn-cybersecurity.att.com/css/sass/main.min.css?v=20210316522111" />
<link rel="apple-touch-icon" sizes="144x144" href="https://cdn-cybersecurity.att.com/images/uploads/apple-touch-icon.png"/>
<link rel="icon" type="image/png" sizes="32x32" href="https://cdn-cybersecurity.att.com/images/uploads/favicon.ico"/>
<link rel="shortcut icon" href="https://cdn-cybersecurity.att.com/images/uploads/favicon.ico">
<link rel="manifest" href="https://cdn-cybersecurity.att.com/manifest.json">

<link rel="stylesheet" href="https://cdn-cybersecurity.att.com/css/sass/main.min.css?v=20210316522111" />








<script>
	if (typeof ddo !== "undefined") {
		$(document).ready(function() {
		
		

		
		
		});
	}

	function initAdobePageTrackingHeader() {
		ddo.disableAutoPageLoad();
		
		ddo.setVar('page.location.url','/blogs/labs-research/reversing-gh0strat-part-2-the-ddos-ening');


		
		ddo.setVar('page.pageInfo.pageTitle', document.title.trim());


		 
		ddo.setVar('page.pageInfo.friendlyPageName','CYB '+ document.title.trim() +' Pg');


		
		
			ddo.setVar('page.category.siteSubSection1','blogs');
		


		
		
			ddo.setVar('page.category.siteSubSection2','labs-research');
		



		
		
			ddo.setVar('page.category.siteSubSection3','reversing-gh0strat-part-2-the-ddos-ening');
		


		
		

		
		
	}
</script>


<script type="text/javascript">
    var _elqQ = _elqQ || [];
    _elqQ.push(['elqSetSiteId', '1086385399']);

    _elqQ.push(['elqUseFirstPartyCookie', 'cyber-tracking.att.com']);

    _elqQ.push(['elqTrackPageView', window.location.href]);

    (function () {
        function async_load() {
            var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true;
            s.src = '//img03.en25.com/i/elqCfg.min.js';
            var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x);
        }
        if (window.addEventListener) window.addEventListener('DOMContentLoaded', async_load, false);
        else if (window.attachEvent) window.attachEvent('onload', async_load);
    })();
</script>


	<link rel="alternate" type="application/rss+xml" title="AlienVault Open Threat Exchange Blog" href="http://feeds.feedblitz.com/alienvaultotx&x=1" />

	<style>
	.blog-author-info {
		width: 70%;
		float: left;
		color: #191919;
	}

	.blog-subscribe-grid ul {
		margin-left: 0px;
		margin-bottom: 0px;
		padding-left: 0px;
	}

	.blog-subscribe-grid ul li {
		list-style-type: none;
		line-height: 20px;
	}

	.blog-subscribe-grid ul li a {
		color: #c6ced5;
		font-size: 14px;
		text-decoration: none;
	}

	.blog-subscribe-grid ul li a:hover {
		text-decoration: underline;
	}

	.blog-content-area img {
		width: 100%!important;
		height: auto!important;
	}

	.blog-promo-item {
		clear: both;
		overflow: hidden;
		margin-bottom: 30px;
	}
	.promo-block .small {
		text-transform: uppercase;
	}

	.blog-promo-item-text {
		width: 345px;
		float: left;
		max-width:100%;
	}

	.blog-promo-item p {
		margin-bottom: 0px!important;
	}






	#blog-promo-block {
		padding-top: 20px;
	}



	/*promo block and sticky classes*/

	.sticky-sidebar {
		top: 147px;
		position: -webkit-sticky; /* Safari */
		position: sticky;
	}
	     .sidebar-search {
			 margin-bottom: 30px;
		 }

         .sidebar-search .search-button {
                width: 100%;
                position: relative;
            }

            .sidebar-search .search-button input {
                padding: 0px;
                margin: 2px 0px 0px 0px;
                position: absolute;
                background: url(https://cdn-cybersecurity.att.com/images/icn-sidebar-search.png) top left no-repeat;
                background-size: 25px 25px;
                width: 25px;
                height: 25px;
                cursor: pointer;
                text-indent: -9999em;
                border: none;
                left: 10px;
                top: 6px;
             }

			.sidebar-search .search-field input {
                border: 0;
                width: 100%;
                height: 30px;
                padding-left: 50px;
				margin-top: 5px;
            }

            .sidebar-search .search-field {
                border: 1px solid #CCCCCC;
                width: 100%;
                height: 40px;
            }

            #q::placeholder {
          		color: #767676!important;
            }

            #blog-subscribe-box {
			height:auto;
            padding: 32px;
            background-image: url('https://cdn-cybersecurity.att.com/images/uploads/backgrounds/blog-email-subscribe-bkg.jpg');
            background-size: cover;
            }

            #blog-subscribe-box h2 {
            color: #fff;
            font-size:32px;
            }

			#blog-subscribe-box p {
				margin-bottom: 10px;
			}






	@media (max-width: 991px) {
            .sidebar-search .search-button input {
                padding: 0px;
                background: transparent;
                cursor: pointer;
                text-indent: -9999em;
                border: none;
                right: 5px;
                top: 5px;
                padding-left: 0px;
             }

            .sidebar-search .search-field input {
             padding-left: 15px;
             }


            }

            	@media (min-width: 768px) and (max-width: 920px){
	.blog-subscribe-grid .btn {
		border-radius: 24px;
	    font-size: 12px;
	    line-height: 18px;
	    border: none;
	    padding: 6px 36px;
	    height: 30px;
	    font-weight: 500;
	}
}


		.blog-content-area p,
		.blog-content-area ul li,
		.blog-content-area ol li{
			font-size: 16px;
			line-height: 20px;
			font-weight: 400;
		}
		.blog-content-area ul li,
		.blog-content-area ol li {
			margin-bottom: 10px;
		}

	</style>

</head>

	<body class="listing-blog-entry-id-5997">
			<!-- Google Tag Manager (noscript) -->
<noscript><iframe src='https://www.googletagmanager.com/ns.html?id=GTM-KLJDXJN'
height='0' width='0' style='display:none;visibility:hidden'></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<script src='https://www.att.com/scripts/adobe/prod/detm-container-ftr.js' type='text/javascript'></script>


		<header id="header" class="navbar navbar-fixed-top">

	<style>
@media (max-width: 543px) {
	.hide-on-mobile {
		display: none;
	}
}
</style>

<div id="news-banner" style="background-color: #1A2027!important;">
    <div class="container-fluid">
        <div class="row vcenter">
            <div class="col-sm-12">

                <div id="news-headline-link">
                    <a href="/resource-center/industry-reports/cybersecurity-insights-report-tenth-edition" style="color: #009FDB;"><span class="caps"><strong>AT&T Cybersecurity Insights™ Report:</strong></span></a> <span class="text-white caps  hide-on-mobile" style="margin-right: 20px;">5G and the Journey to the Edge</span> <a class="text-white" href="/resource-center/industry-reports/cybersecurity-insights-report-tenth-edition">Learn more ⟶</a>
                </div>
				<div id="search-contact">
					<ul class="list-unstyled header_nav_top_list">
						<li class="header_nav_top_list_item"><a id="top-nav-support" href="/support">Support</a></li>
						<li class="header_nav_top_list_item"><a id="top-nav-contact" href="/contact">Contact</a></li>
						<li class="header_nav_top_list_item search">
							<a href="#" class="header_nav_toggle-search" aria-label="Search">
								<!-- <span class="hide-on-active"><img src="https://cdn-cybersecurity.att.com/images/uploads/nav/search.png"></span>
								<span class="show-on-active"><img src="https://cdn-cybersecurity.att.com/images/uploads/nav/search.png"></span> -->
								<span class="hide-on-active glyphicon glyphicon-search" aria-hidden="true"></span>
								<span class="show-on-active glyphicon glyphicon-search" aria-hidden="true"></span>
							</a>
							<form action="/search-results" method="get" id="top-search-form" __bizdiag="113" __biza="WJ__"><input name="q" id="top-search-form-text" type="text" placeholder="Search Now...." aria-label="Search"><button class="sr-only" type="submit">Search</button></form>
						</li>
					</ul>
				</div>
            </div>
        </div>
    </div>
</div>






	<div id="header-container" class="container-fluid">
		<div id="header-logo">
			<div class="logo-globe"><a href="https://business.att.com" target="_blank"><img src="https://cdn-cybersecurity.att.com/images/uploads/logos/att-globe.svg" alt="AT&amp;T Business" /></a></div>
			<div class="att-business"><a href="https://business.att.com" target="_blank"><img src="https://cdn-cybersecurity.att.com/images/uploads/logos/att-business-web.svg" alt="AT&amp;T Business" /></a></div>
			<div class="att-cybersecurity"><a href="/"><img src="https://cdn-cybersecurity.att.com/images/uploads/logos/att-cybersecurity-web.svg" alt="AT&amp;T Cybersecurity" /></a></div>
		</div>

		<button type="button" class="header_toggle_nav navbar-toggle collapsed" data-toggle="collapse" data-target="#header-nav" aria-expanded="false">
			<span class="sr-only">Toggle navigation</span>
			<span class="avicon avicon-bars"></span>
			<span class="avicon avicon-close"></span>
		</button>
		
		
			<a href="/contact" id="header-cta" class="hidden-md hidden-lg btn btn-blue btn-sm">Contact us</a>
		

		<nav class="navbar-collapse collapse" id="header-nav">
			<ul class="nav navbar-nav list-unstyled">
				<li class="nav-item has-dd products">
					<a id="main-nav-products" href="/products" class="dropdown-toggle" data-toggle="collapse" role="button" aria-expanded="false" data-target="#products-dd">Products<span class="glyphicon glyphicon-chevron-up"></span><span class="glyphicon glyphicon-chevron-down"></span>
					</a>
					<div class="nav-dropdown collapse" id="products-dd">
						<div class="dd-multi-col container-fluid">
							<ul class="list-unstyled sub-nav">
									<li id="first-sub-cyber-strategy-risk"><a href="/categories/cybersecurity-consulting-services" class="first-level">Cybersecurity Consulting Services</a>
										<div class="desktop-subnav open">
											<ul class="list-unstyled">
												<li class="second-sub-heading">Cyber Strategy</li>
												<li class="second-sub-link"><a href="/products/strategy-and-roadmap">Strategy and Roadmap Planning</a></li>

												<li class="second-sub-link"><a href="/products/security-assessment">Enterprise Security Assessment Services</a></li>
												<li class="second-sub-link"><a href="/products/risk-based-cyber-posture-assessment">Risk-based Cyber Posture Assessment</a></li>
											</ul>
											<ul class="list-unstyled">
												<li class="second-sub-heading">Risk and Compliance</li>
												<li class="second-sub-link"><a href="/products/security-compliance">Security Compliance</a></li>
											</ul>
											<ul class="list-unstyled">
												<li class="second-sub-heading">Vulnerability and Threat Management</li>
												<li class="second-sub-link"><a href="/products/vulnerability-scanning">Vulnerability Scanning</a></li>
												<li class="second-sub-link"><a href="/products/penetration-testing-services">Penetration Testing</a></li>
												<li class="second-sub-link"><a href="/products/adversary-simulation-service">Adversary Simulation Services</a></li>

											</ul>
											<ul class="list-unstyled">
												<li class="second-sub-heading">CSO Advisory Services</li>
												<li class="second-sub-link"><a href="/products/cybersecurity-iq-training">Cybersecurity IQ Training</a></li>
											</ul>
										</div>
										<div class="mobile-subnav">
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-link"><a href="/products/strategy-and-roadmap">Strategy and Roadmap Planning</a></li>
												<li class="second-sub-link"><a href="/products/security-assessment">Enterprise Security Assessment Services</a></li>
												<li class="second-sub-link"><a href="/products/risk-based-cyber-posture-assessment">Risk-based Cyber Posture Assessment</a></li>

												<li class="second-sub-link"><a href="/products/security-compliance">Security Compliance</a></li>

												<li class="second-sub-link"><a href="/products/vulnerability-scanning">Vulnerability Scanning</a></li>

												<li class="second-sub-link"><a href="/products/penetration-testing-services">Penetration Testing</a></li>
												<li class="second-sub-link"><a href="/products/adversary-simulation-service">Adversary Simulation Services</a></li>
												<li class="second-sub-link"><a href="/products/cybersecurity-iq-training">Cybersecurity IQ Training</a></li>
											</ul>
										</div>
									</li>
									<li id="first-sub-network-security"><a href="/categories/network-security" class="first-level">Network Security</a>
										<div class="desktop-subnav">
											<ul class="list-unstyled">
												<li class="second-sub-heading">AT&T Trusted Internet Access</li>
												<li class="second-sub-link"><a href="/products/global-security-gateway">Global Security Gateway</a></li>
												<li class="second-sub-link"><a href="/products/network-based-firewall">Network Based Firewalls</a></li>
												<li class="second-sub-link"><a href="/products/premises-based-firewall">Premises Based Firewalls</a></li>
												<li class="second-sub-link"><a href="/products/enhanced-access-security">Enhanced Cybersecurity Services</a></li>
											</ul>
											<ul class="list-unstyled">
												<li class="second-sub-heading">AT&T Infrastructure and Application Protection</li>
												<li class="second-sub-link"><a href="/products/reactive-ddos-services">Reactive Distributed Denial of Service Defense</a></li>
												<li class="second-sub-link"><a href="/products/application-layer-security">AT&T Application Layer Security</a></li>
											</ul>
										</div>
										<div class="mobile-subnav">
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">AT&T Trusted Internet Access</li>
												<li class="second-sub-link"><a href="/products/global-security-gateway">Global Security Gateway</a></li>
												<li class="second-sub-link"><a href="/products/network-based-firewall">Network Based Firewalls</a></li>
												<li class="second-sub-link"><a href="/products/premises-based-firewall">Premises Based Firewalls</a></li>
												<li class="second-sub-link"><a href="/products/enhanced-access-security">Enhanced Cybersecurity Services</a></li>

												<li class="second-sub-heading">AT&T Infrastructure and Application Protection</li>
												<li class="second-sub-link"><a href="/products/reactive-ddos-services">Reactive Distributed Denial of Service Defense</a></li>
												<li class="second-sub-link"><a href="/products/application-layer-security">AT&T Application Layer Security</a></li>
											</ul>
										</div>
									</li>
									<li id="first-sub-unified-endpoint"><a href="/categories/endpoint-security" class="first-level">Endpoint Security</a>
										<div class="desktop-subnav">
											<ul class="list-unstyled">
												<li class="second-sub-heading">Endpoint Security</li>
												<li class="second-sub-link"><a href="/products/sentinel-one">SentinelOne</a></li>
												<li class="second-sub-link"><a href="/products/mobile-iron">MobileIron</a></li>
												<li class="second-sub-link"><a href="/products/vmware">VMware Workspace ONE®</a></li>
												<li class="second-sub-link"><a href="/products/ibm-maas360">IBM MaaS360</a></li>
												<li class="second-sub-link"><a href="/products/lookout">Lookout Mobile Endpoint Security</a></li>
												<li class="second-sub-link"><a href="/products/mcafee-endpoint-protection">McAfee Endpoint Protection</a></li>
											</ul>
										</div>
										<div class="mobile-subnav">
											<ul class="list-unstyled sub-nav">
													<li class="second-sub-link"><a href="/products/sentinel-one">SentinelOne</a></li>
													<li class="second-sub-link"><a href="/products/mobile-iron">MobileIron</a></li>
													<li class="second-sub-link"><a href="/products/vmware">VMware Workspace ONE®</a></li>
													<li class="second-sub-link"><a href="/products/ibm-maas360">IBM MaaS360</a></li>
													<li class="second-sub-link"><a href="/products/lookout">Lookout Mobile Endpoint Security</a></li>
													<li class="second-sub-link"><a href="/products/mcafee-endpoint-protection">McAfee Endpoint Protection</a></li>
											</ul>
										</div>
									</li>
									<li id="first-sub-threat-detection-response"><a href="/categories/threat-detection-and-response" class="first-level">Threat Detection and Response</a>
										<div class="desktop-subnav">
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">Strategy, Assessment and Planning</li>
												<li class="second-sub-link"><a href="/products/incident-response">Incident Response and Forensics</a></li>
											</ul>
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">AT&T Threat Solutions</li>
												<li class="second-sub-link"><a href="/products/managed-threat-detection-and-response">Managed Threat Detection and Response</a></li>
												<li class="second-sub-link"><a href="/products/usm-anywhere">USM Anywhere</a></li>
												<li class="second-sub-link"><a href="/products/usm-for-mssp">USM for MSSPs</a></li>
											</ul>
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">Free Tools</li>
												<li class="second-sub-link"><a href="/open-threat-exchange">Open Threat Exchange</a></li>
												<li class="second-sub-link"><a href="/products/ossim">OSSIM</a></li>
											</ul>
										</div>
										<div class="mobile-subnav">
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">Strategy, Assessment and Planning</li>
												<li class="second-sub-link"><a href="/products/incident-response">Incident Response and Forensics</a></li>

												<li class="second-sub-heading">AT&T Threat Solutions</li>
												<li class="second-sub-link"><a href="/products/managed-threat-detection-and-response">Managed Threat Detection and Response</a></li>
												<li class="second-sub-link"><a href="/products/usm-anywhere">USM Anywhere</a></li>
												<li class="second-sub-link"><a href="/products/usm-for-mssp">USM for MSSPs</a></li>

												<li class="second-sub-heading">Free Tools</li>
												<li class="second-sub-link"><a href="/open-threat-exchange">Open Threat Exchange</a></li>
												<li class="second-sub-link"><a href="/products/ossim">OSSIM</a></li>
											</ul>
										</div>
									</li>
							</ul>
						</div>
						<!--<div class="dd-bottom visible-lg" id="view-all-products">
							<div class="container-fluid">
								<a href="/products">
									<span class="view-all-text">View All Products &LongRightArrow;</span>
								</a>
							</div>
						</div>-->
					</div>
				</li>
				<li class="nav-item has-dd solutions">
					<a id="main-nav-solutions" href="/solutions" class="dropdown-toggle" data-toggle="collapse" role="button" aria-expanded="false" data-target="#solutions-dd">Solutions<span class="glyphicon glyphicon-chevron-up"></span><span class="glyphicon glyphicon-chevron-down"></span></a>
					<div class="nav-dropdown collapse" id="solutions-dd">
						<div class="dd-multi-col container-fluid">
							<ul class="list-unstyled sub-nav hidden-md hidden-lg">
								<li><a id="main-nav-see-all-solutions-mobile" href="/solutions" class="header_nav_link">See All Solutions</a></li>
							</ul>
							<div id="compliance">
								<div class="menu-header">Compliance</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/solutions/it-compliance-management">Overview</a></li>
									<li><a href="/solutions/gdpr-compliance">GDPR</a></li>
									<li><a href="/solutions/hipaa-compliance">HIPAA</a></li>
									<li><a href="/solutions/iso-27001-compliance">ISO 27001</a></li>
									<li><a href="/solutions/pci-dss-compliance">PCI DSS</a></li>
									<li><a href="/solutions/soc-2-compliance">SOC 2</a></li>
								</ul>
							</div>
							<div id="industry">
								<div class="menu-header">Industry</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/solutions/education">Education</a></li>
									<li><a href="/solutions/energy-sector-security">Energy Sector</a></li>
									<li><a href="/solutions/government">Federal</a></li>
									<li><a href="/solutions/financial-services">Financial Services</a></li>
									<li><a href="/solutions/healthcare">Healthcare</a></li>
									<li><a href="/solutions/manufacturing">Manufacturing</a></li>
									<li><a href="/partners/mssp-program">MSSPs</a></li>
									<li><a href="/solutions/retail">Retail</a></li>
								</ul>
							</div>
							<div id="environment">
								<div class="menu-header">Environment</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/solutions/aws-security-and-compliance-management">AWS</a></li>
									<li><a href="/solutions/azure-security-and-compliance-management">Azure</a></li>
									<li><a href="/solutions/cloud-security">Cloud</a></li>
									<li><a href="/solutions/iot-and-mobility-security">IOT/Mobility</a></li>
									<li><a href="/solutions/hybrid-cloud-security">Hybrid</a></li>
									<li><a href="/solutions/network-security">Network</a></li>
									<li><a href="/solutions/remote-workforce-security">Remote Workforce</a></li>

								</ul>
							</div>
							<div id="core-capabilities">
								<div class="menu-header">Security Use Cases</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/solutions/asset-discovery-inventory">Asset Discovery</a></li>
									<li><a href="/solutions/endpoint-detection-and-response">Endpoint Detection &amp; Response</a></li>
									<li><a href="/solutions/intrusion-detection-system">Intrusion Detection</a></li>
									<li><a href="/solutions/secure-access-service-edge">Secure Access Service Edge</a></li>
									<li><a href="/solutions/secure-web-gateway">Secure Web Gateway</a></li>
									<li><a href="/solutions/siem-platform-solutions ">SIEM Platform Solutions</a></li>
									<li><a href="/solutions/threat-detection">Threat Detection</a></li>
									<li><a href="/solutions/threat-intelligence">Threat Intelligence</a></li>
									<li><a href="/solutions/zero-trust-architecture">Zero Trust Architecture</a></li>

								</ul>
							</div>
						</div>
						<div class="dd-bottom visible-lg" id="view-all-solutions">
							<div class="container-fluid">
								<a href="/solutions">
									<span class="view-all-text">View All Solutions &LongRightArrow;</span>
								</a>
							</div>
						</div>
					</div>
				</li>
				<li class="nav-item partners">
					<a id="main-nav-partners" href="/partners" class="dropdown-toggle" role="button" aria-expanded="false" data-target="#partners-dd">Partners</a>
					<div class="nav-dropdown collapse visible-lg" id="partners-dd">
						<div class="dd-multi-col container-fluid">
							<div id="become-a-partner">
								<div class="menu-header">Become a Partner</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/partners">All Partner Programs</a></li>
									<li><a href="/partners/mssp-program">MSSP Program</a></li>
									<li><a href="/partners/resellers">Reseller Program</a></li>
									<li><a href="/partners/partner-portal/">Partner Portal Login</a></li>
								</ul>
							</div>

							<div id="find-a-partner">
								<div class="menu-header">Find a Partner</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/products/managed-security-services">Partner Managed Solutions</a></li>
									<li><a href="/partners/find-partner">Find an MSSP</a></li>
									<li><a href="/partners/locator">Find a Reseller</a></li>
									<li><a href="/partners/certified-implementation-partners">Professional Services</a></li>
								</ul>
							</div>
							<div id="technology-partners">
								<div class="menu-header">Technology Partners</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/app">USM Anywhere Integrations</a></li>
									<li><a href="/partners/technology-partners">OTX Partners</a></li>
								</ul>
							</div>
						</div>
						<div class="dd-bottom visible-lg" id="view-all-partners">
							<div class="container-fluid">
								<a href="/partners/become-a-partner">
									<span class="view-all-text">Become a Partner &LongRightArrow;</span>
								</a>
							</div>
						</div>
					</div>
				</li>
				<li class="nav-item has-dd resources">
					<a id="main-nav-resources" href="/resource-center#language_en" class="dropdown-toggle" data-toggle="collapse" role="button" aria-expanded="false" data-target="#resources-dd">Resources<span class="glyphicon glyphicon-chevron-up"></span><span class="glyphicon glyphicon-chevron-down"></span></a>
					<div class="nav-dropdown collapse" id="resources-dd">
						<div class="dd-multi-col container-fluid">

							<div id="resources-menu-image" class="visible-lg">
								<img src="https://cdn-cybersecurity.att.com/images/uploads/thehub-thumbnail.jpg">
								<p>Explore The Hub, our home for all virtual experiences</p>
								<a href="https://hub.att.com/expo-hall/cybersecurity/">Explore now ⟶</a>
							</div>

							<ul class="list-unstyled sub-nav hidden-md hidden-lg">
								<li><a id="main-nav-resources-mobile" href="/resource-center#language_en">View All Resources</a></li>

							</ul>

							<div id="product-resources">
								<div class="menu-header">Product Resources</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/resource-center#content_customer-stories">Customer Stories</a></li>
									<li><a href="/resource-center#content_product-brief">Product Briefs</a></li>
									<li><a href="/resource-center#content_product-demo">Product Demos</a></li>
									<li><a href="/resource-center#content_product-review">Product Reviews</a></li>
									<li><a href="/resource-center#content_solution-brief">Solution Briefs</a></li>
									<li><a href="/resource-center#content_use-cases">Use Cases</a></li>

									<li><a id="free-trial" href="/products/usm-anywhere/free-trial">Free Trial</a></li>
								</ul>
							</div>
							<div id="security-resources">
								<div class="menu-header">Security Resources</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/resource-center#content_analyst-reports">Analyst Reports</a></li>
									<li><a href="/blogs">Blogs</a></li>
									<li><a href="/resource-center#content_ebook">eBooks</a></li>
									<li><a href="/resource-center#content_video">Videos</a></li>
									<li><a href="/resource-center#content_webcast">Webcasts</a></li>
									<li><a href="/resource-center#content_white-paper">White Papers</a></li>
									<li><a href="/resource-center#content_industry-reports">Industry Reports</a></li>
								</ul>
							</div>
							<div id="customer-resources">
								<div class="menu-header">Customer Resources</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="https://success.alienvault.com/">Success Center</a></li>
									<li><a href="/certification">Certification</a></li>
									<li><a href="/customer-success">Customer Success</a></li>
									<li><a href="/documentation">Documentation</a></li>
									<li><a href="/partners/certified-implementation-partners">Professional Services</a></li>
									<li><a href="/support">Support Overview</a></li>
									<li><a href="/training">Training</a></li>
								</ul>
							</div>
							<div id="browse-by-topic">
								<div class="menu-header">Browse by Topic</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/resource-center#category_incident-response">Incident Response</a></li>
									<li><a href="/resource-center#category_intrusion-detection">Intrusion Detection</a></li>
									<li><a href="/resource-center#category_partner-mssp-reseller">Partner: MSSP &amp; Reseller</a></li>
									<li><a href="/resource-center#category_regulatory-compliance">Regulatory Compliance</a></li>
									<li><a href="/resource-center#category_soc">Security Operations Center</a></li>
									<li><a href="/resource-center#category_siem-log-management">SIEM &amp; Log Management </a></li>
									<li><a href="/resource-center#category_threat-detection">Threat Detection</a></li>
									<li><a href="/resource-center#category_threat-intelligence">Threat Intelligence</a></li>
								</ul>
							</div>
						</div>

						<div class="dd-bottom visible-lg" id="view-all-resources">
							<div class="container-fluid">
								<a href="/resource-center#language_en">
									<span class="view-all-text">View All Resources &LongRightArrow;</span>
								</a>
							</div>
						</div>

					</div>
				</li>
				<li class="nav-item alien-labs">
					<a id="main-nav-alien-labs" href="/alien-labs" class="">AT&T Alien Labs</a>
				</li>
				<li class="nav-item support visible-sm visible-xs">
					<a id="main-nav-support" href="/support">Support</a>
				</li>
			</ul>
		</nav>

	</div>

	<div class="container-fluid visible-md visible-lg">
		
		
			<a id="main-nav-free-tools" class="header-nav-btn btn margin-bottom10" href="/products/usm-anywhere/free-trial">Free trial</a>
		


	</div>
</header>

						




			<main class="blog-detail">

				<div class="full-width-block top-content-width-bg" style="background-image: url('https://cdn-cybersecurity.att.com/blog-content/Blog-Images/hero/blog-hero-this-week-june30-2017.jpg'); background-position: top center; background-repeat: no-repeat; background-color: #000; background-size: 2500px 405px; min-height: 405px;">
					<div class="container-fluid">
						<div class="row rowPad">
							<div class="all-blogs-cta"><a href="/blogs">‹ ALL BLOGS</a></div>
							<div class="category-label">
								
									<a href="/blogs/labs-research">Alien Labs</a>
								
							</div>
							<h1>Reversing Gh0stRAT part 2: the DDOS-ening</h1>
							<div class="date">May 2, 2019 | <a href="/blogs/author/james-quinn">James Quinn</a></div>
						</div>
					</div>
				</div>

				<section class="full-width-block">

					<div class="container-fluid">

						<div class="row flx-container">
							<div class="col-sm-8">
								<div class="blog-content-area">
									<p>This is a guest post James Quinn, a SOC analyst from Binary Defense.</p>

<p>In <a href="/blogs/labs-research/the-odd-case-of-a-gh0strat-variant" target="_blank">Part 1</a> of the Reversing Gh0stRAT series, we talked about a partial Gh0stRAT variant which used an encryption algorithm to hide its traffic.&nbsp; In part 2, we will be talking about a much more complete Gh0stRAT sample which allows a hacker to take total control over a victim&rsquo;s computer.&nbsp; Additionally, once control is gained, the hacker can use unique commands in this Gh0stRAT sample to Denial of Service (&ldquo;DDoS&rdquo;) a target.</p>

<p>Some of the key functionality of the sample includes:</p>

<ul>
	<li>Webcam Control</li>
	<li>File Manager</li>
	<li>Dial-up/VPN credential theft</li>
	<li>Multithreaded DDOS using TCP/UDP/HTTP/ICMP</li>
	<li>Adding a new net user and installing registry keys for RDP</li>
</ul>

<p><img alt="" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/GhOstRAT-Variant-image-1_(1)_(1)_(1)_(1)_(1)_(1)_(1)_(1)_(1)_(1).jpg" /></p>

<p><em>[SCR1] ICMP DDOS from my computer to my other computer.&nbsp; In 30s, 1,237,749 packets were sent with a total of 352Mbits/second.</em></p>

<p>Additionally, this blog post will also be expanding on my redirection technique, along with more information on how Gh0strat handles commands.</p>

<h2>Malware Analysis</h2>

<p>On first glance, this sample seems to be a fairly simple and unaltered Gh0stRAT sample.&nbsp; Its strings are not encrypted and it doesn&rsquo;t use any DLL&rsquo;s loaded into memory/dropped.&nbsp; In fact, on first glance, you&rsquo;ll see that its network traffic even contains &lsquo;Gh0st&rsquo;.</p>

<p><img alt="" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/Gh0stRAT-malware-analysis.jpg" /></p>

<p>However, it is anything but.&nbsp; It uses unique opcodes, unique commands, and while on first glance the header appears normal, it has actually been modified.&nbsp; Typically, &lsquo;Gh0st&rsquo; occurs in the first 5 bytes of the header, before the size fields, not after.</p>

<p><strong>Domains</strong></p>

<p>Interestingly, this sample communicates with its C2 server (z-hacker-y[.]win) over port 22, which is the port typically reserved for SSH. Additionally, this is a dynamic DNS, meaning the IP has changed, however here are some of the IP&rsquo;s I have seen</p>

<ul>
	<li>59.37.6[.]19 (current)</li>
	<li>185.173.92[.]170</li>
	<li>43.226.35[.]69</li>
</ul>

<p><strong>Exploits</strong></p>

<p>Just like in part 1, these were the 2 exploits used to drop the sample on my honeypot:</p>

<ul>
	<li><a href="https://otx.alienvault.com/indicator/cve/cve-2017-0143" target="_blank">CVE-2017-0143, SMB exploit</a></li>
	<li><a href="https://otx.alienvault.com/indicator/cve/CVE-2017-0146" target="_blank">CVE-2017-0146, SMB exploit</a></li>
</ul>

<p>These 2 exploits are EternalBlue/Doublepulsar and are used to drop the sample onto a system.</p>

<p><strong>Installation</strong></p>

<p>Upon execution, the very first thing the sample does is use its C2 URL to create a <a href="https://searchnetworking.techtarget.com/definition/mutex" target="_blank">mutex</a> (z-hacker-y[.]win).&nbsp; Immediately after that, it obtains the file path of the running process and then saves a registry key to SOFTWARE/Microsoft/Windows/CurrentVersion/Run with the value of NetService.exe and the data set to the path, for persistence.&nbsp;</p>

<p>After that, it pushes the C2 URL and port to the stack and begins attempting to communicate home.</p>

<p>When a connection is established, it gathers:</p>

<ul>
	<li>Version information</li>
	<li>Socket name</li>
	<li>Processor Count/Write Speed</li>
	<li>System Info</li>
	<li>Memory status</li>
	<li>Version description of capture driver</li>
</ul>

<p>Additionally, it searches the open processes for executables related to Kaspersky Security and 360 Total Security AntiVirus software.</p>

<p>It packages all of this information into a buffer, compresses it with zlib, and then sends it to the C2 server, after attaching its modified header.</p>

<p><strong>Network Communication</strong></p>

<p>Despite on first glance looking like a generic Gh0stRAT sample&rsquo;s communication, the packet format has been slightly modified:</p>

<p><img alt="" data-original="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/pasted_image.jpg" /></p>

<p>Typically Gh0stRAT packets consist of a 5 byte packet header (&lsquo;Gh0st&rsquo;), 4 Bytes of the size of compressed packet, 4 bytes of the size of uncompressed data, followed by the data, in that order.&nbsp; However, as seen above, this sample rearranges the packet format so that the packet header is the last item to occur prior to the data.&nbsp;</p>

<p>Additionally, this sample has unique response opcodes that it sends to the C2:</p>

<div class="table-responsive">
<table border="1" cellpadding="0" cellspacing="0" class="table table-bordered">
	<tbody>
		<tr>
			<td style="width:312px;">
			<p><strong>Opcode</strong></p>
			</td>
			<td style="width:312px;">
			<p><strong>Response type</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x42</p>
			</td>
			<td style="width:312px;">
			<p>Implant_Login</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x43</p>
			</td>
			<td style="width:312px;">
			<p>Implant_Drive_Response</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x44</p>
			</td>
			<td style="width:312px;">
			<p>Implant_File_List</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x45</p>
			</td>
			<td style="width:312px;">
			<p>Implant_File_Size</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x46</p>
			</td>
			<td style="width:312px;">
			<p>Implant_File_Data</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x47</p>
			</td>
			<td style="width:312px;">
			<p>Implant_Transfer_Finished</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x48</p>
			</td>
			<td style="width:312px;">
			<p>Implant_Delete_Finished</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x49</p>
			</td>
			<td style="width:312px;">
			<p>Implant_Get_Transfer_Mode</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x4B</p>
			</td>
			<td style="width:312px;">
			<p>Implant_CreateFolder_Finished</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x4C</p>
			</td>
			<td style="width:312px;">
			<p>Implant_Data_Continue</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x4D</p>
			</td>
			<td style="width:312px;">
			<p>Implant_Rename_Finish</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x4F</p>
			</td>
			<td style="width:312px;">
			<p>Implant_Screenspy_Response</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x50</p>
			</td>
			<td style="width:312px;">
			<p>Implant_BitmapInfo</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x51</p>
			</td>
			<td style="width:312px;">
			<p>Implant_FirstScreen/NextScreen</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x52</p>
			</td>
			<td style="width:312px;">
			<p>Implant_Clipboard_Text</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x53</p>
			</td>
			<td style="width:312px;">
			<p>Implant_Webcam_Response</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x54</p>
			</td>
			<td style="width:312px;">
			<p>Implant_Webcam_Data</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x55</p>
			</td>
			<td style="width:312px;">
			<p>Implant_Audio_Manager</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x56</p>
			</td>
			<td style="width:312px;">
			<p>Implant_Audio_Response</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x59</p>
			</td>
			<td style="width:312px;">
			<p>Implant_ProcEnum_Response</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x5A</p>
			</td>
			<td style="width:312px;">
			<p>Implant_Windows_List</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x5B</p>
			</td>
			<td style="width:312px;">
			<p>Implant_Dialupass</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0x5C</p>
			</td>
			<td style="width:312px;">
			<p>Implant_Command_Shell_Response</p>
			</td>
		</tr>
	</tbody>
</table>
</div>

<p><strong>Commands</strong></p>

<p>Along with having unique response opcodes, this sample also has 52 different commands, each using their own unique opcode</p>

<div class="table-responsive">
<table border="1" cellpadding="0" cellspacing="0" class="table table-bordered" width="627">
	<tbody>
		<tr>
			<td style="width:315px;">
			<p><strong>Opcode</strong></p>
			</td>
			<td style="width:312px;">
			<p><strong>Command</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x08</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Active</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x09</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_List_Drive</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x0A</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_List_File</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x0B</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_File_Size</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x0C</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Set_Transfer_Mode</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x0D</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_MoveFilePointer</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x0F</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_ReadFromOffset</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x10</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Finish_Transfer</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x11</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Delete_File</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x12</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Delete_Directory</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x13</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_File_Work</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x14</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Create_Folder</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x15</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Rename_Folder</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x16</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_ShellOpen_Show</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x17</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_ShellOpen_Hide</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x18</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_AddNewNetUser</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x19</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_ScreenSpy</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x1A</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Screen_Reset</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x1B</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Algorithm_Reset</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x1C</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Ctrl_Alt_Del</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x1D</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Control</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x1E</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Block_Input</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x1F</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Blank</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x20</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Capture_Layer</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x21</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Get_Clipboard</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x22</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Set_Clipboard</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x23</p>
			</td>
			<td style="width:312px;">
			<p><strong>Webcam</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x24</p>
			</td>
			<td style="width:312px;">
			<p><strong>EnableCompress</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x25</p>
			</td>
			<td style="width:312px;">
			<p><strong>DisableCompress</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x26</p>
			</td>
			<td style="width:312px;">
			<p><strong>Resize</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x27</p>
			</td>
			<td style="width:312px;">
			<p><strong>Next</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x28</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_RegAndRestart</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x29</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_DDOSToolTCPUDP</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x2A</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_DDOSToolComplete</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x2B</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_SendOK</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x2C</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_DDOSToolHTTP</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x30</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Audio</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x31</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_System</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x32</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_EnumProcs</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x33</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_EnumWindows</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x34</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Dialup</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x35</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_EnumProcAndWindows</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x36</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Shell</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x37</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Session</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x38</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_ExitCode</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x39</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_DownAndExec</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x3a</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Server_Update</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x3b</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_CleanEvent</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x3c</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Open_URL_Hide</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x3d</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Open_URL_Show</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:315px;">
			<p>0x3e</p>
			</td>
			<td style="width:312px;">
			<p><strong>Command_Rename_Host</strong></p>
			</td>
		</tr>
	</tbody>
</table>
</div>

<p>Color Key:</p>

<p>Red Commands:&nbsp; Special Commands - Parent</p>

<p>Blue Commands: Special Commands - Child</p>

<p>Green Commands: New Commands</p>

<p>In order to use the special commands, You must first call the Parent command and then call the Child command.</p>

<p>Example: If I want to get the clipboard data of the victim, I would call Command_ScreenSpy followed by Command_Get_Clipboard_Data.</p>

<p>As there are too many individual commands for me to describe the functionality of each command, instead I will do my best to describe the functionality of the new commands (green).</p>

<p><strong>Command_AddNewNetUser: </strong>This command is used for maintaining persistence on a victim&rsquo;s machine.&nbsp; This command takes a couple strings as an argument (like username and password as well as groupname) and then uses NetUserAdd to add a new user account to the machine.&nbsp; Additionally, it uses NetLocalGroupAddMembers to add the user to the group specified.</p>

<p><strong>Command_RegAndRestart: </strong>Sets up the Remote Desktop Protocol (RDP) with the following registry key operations</p>

<ul>
	<li>Netcache is disabled</li>
	<li>AdminTSRemote is enabled</li>
	<li>Remove ShutdownWithoutLogon from the login screen</li>
	<li>Enable terminal Server</li>
	<li>Set TermDD Start key to 2</li>
	<li>Set TermService Start key to 2</li>
	<li>Disable Remote Desktop Connections (Temporary)</li>
	<li>Set RDPTCP port number to 3389</li>
	<li>Set Winstations Terminal server RDP-TCP port to 3389</li>
	<li>Set another TCP port to 3389</li>
	<li>Set keyboard toggle hotkey to option 2</li>
	<li>Enable Remote desktop Connections</li>
</ul>

<p><strong>Command_DDOSToolTCPUDP:</strong> This is the first command that introduces this sample&rsquo;s unique functionality as a DDOS tool.&nbsp; However, compared to the complete DDoS tool, this command pales in comparison.&nbsp; It allows for 3 different options, a TCP DDoS, a UDP DDoS, and another TCP DDoS.</p>

<p><strong>Command_DDOSToolComplete</strong>:&nbsp; This is the main command used for DDoSing servers and allows for 24 different options.&nbsp; Additionally, this tool uses multithreading allowing for multiple attacks to be run at once.&nbsp; Also, based on my observations, using its fastest option (ICMP), it was sending around 42,570 packets per second.&nbsp;</p>

<div class="table-responsive">
<table border="1" cellpadding="0" cellspacing="0" class="table table-bordered" width="624">
	<tbody>
		<tr>
			<td style="width:312px;">
			<p><strong>Option</strong></p>
			</td>
			<td style="width:312px;">
			<p><strong>Description</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>0</p>
			</td>
			<td style="width:312px;">
			<p>Send &lsquo;OK&rsquo; to C2</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>1</p>
			</td>
			<td style="width:312px;">
			<p>UDP DDos Attack</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>2</p>
			</td>
			<td style="width:312px;">
			<p>TCP DDoS with spoofed ip</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>3</p>
			</td>
			<td style="width:312px;">
			<p>TCP DDoS attack on port 80</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>4</p>
			</td>
			<td style="width:312px;">
			<p>ICMP(Ping) Attack</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>5</p>
			</td>
			<td style="width:312px;">
			<p>HTTP DDos attack, no specified user agent</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>6</p>
			</td>
			<td style="width:312px;">
			<p>Close HTTP Connection</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>7</p>
			</td>
			<td style="width:312px;">
			<p>UDP Ddos to supplied IP, then TCP DDoS with spoofed IP.</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>8</p>
			</td>
			<td style="width:312px;">
			<p>Hybrid Attack.&nbsp; First UDP and then ICMP</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>9</p>
			</td>
			<td style="width:312px;">
			<p>Hybrid Attack.&nbsp; First UDP and then TCP</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>10</p>
			</td>
			<td style="width:312px;">
			<p>UDP DDos Attack</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>11</p>
			</td>
			<td style="width:312px;">
			<p>UDP DDos Attack</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>12</p>
			</td>
			<td style="width:312px;">
			<p>UDP DDos Attack</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>13</p>
			</td>
			<td style="width:312px;">
			<p>UDP DDos with Random Data</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>14</p>
			</td>
			<td style="width:312px;">
			<p>UDP DDos with Random Data</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>15</p>
			</td>
			<td style="width:312px;">
			<p>Connect to specific socket and send UDP data</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>16</p>
			</td>
			<td style="width:312px;">
			<p>Connect to specific socket and send TCP data</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>17</p>
			</td>
			<td style="width:312px;">
			<p>HTTP DDoS attack, Windows User agent</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>18</p>
			</td>
			<td style="width:312px;">
			<p>HTTP DDoS attack, Linux User Agent</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>19</p>
			</td>
			<td style="width:312px;">
			<p>UDP DDos Attack</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>20</p>
			</td>
			<td style="width:312px;">
			<p>HTTP DDoS</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>21</p>
			</td>
			<td style="width:312px;">
			<p>RAW Ddos</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>22</p>
			</td>
			<td style="width:312px;">
			<p>TCP DDos</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>23</p>
			</td>
			<td style="width:312px;">
			<p>UDP DDos with Random Data</p>
			</td>
		</tr>
		<tr>
			<td style="width:312px;">
			<p>24</p>
			</td>
			<td style="width:312px;">
			<p>HTTP DDoS</p>
			</td>
		</tr>
	</tbody>
</table>
</div>

<p><strong>Command_SendOK:</strong> Simply sends &lsquo;OK&rsquo; to the server</p>

<p><strong>Command_DDOSToolHTTP</strong>: Using GET, DDOS supplied IP.&nbsp; Then send &lsquo;OK&rsquo; to C2.</p>

<p>Additionally, as a bit of attribution info, each of the commands that open an HTTP connection accept Chinese as a language.&nbsp;</p>

<p><strong>Command and Control Behavior</strong></p>

<p>Prior to the malware author&rsquo;s move to their current IP, the C2 server was alive and sending commands.&nbsp; When a Gh0stRAT infected machine would attempt to connect to the C2 server, the C2 server would respond with a Command_Active, which puts the Gh0stRAT machine in a state where it can still accept commands, however, it isn&rsquo;t continually spamming its login packet.&nbsp;</p>

<p>At which point, the server went silent until March 31st, when I began to see a new behavior from this C2 server, and the botnet in general.&nbsp; On March 31st, the C2 Server sent out several Command_DDOSToolComplete&rsquo;s, with the target being a minecraft server.&nbsp; Based on my observation, they attempted 2 HTTP Floods (One with no user agent specified, and one with the Linux user agent specified) and an ICMP flood.&nbsp; I believe that the attack is still going as of April 4th, as the targeted server is still down.</p>

<p>Using this behavior as an indicator, I believe that the botnet is being used as a DDOS as a Service &ldquo;(DaaS&rdquo;) provider.</p>

<p><strong>FakeBot</strong></p>

<p>How did I obtain the above information you might ask?&nbsp; Well, it&rsquo;s rather simple.&nbsp; Instead of just running the sample and running Wireshark in the background and being patient, I came up with a more elegant solution.&nbsp; Using my redirection technique that was mentioned in part 1 of the blog series, I redirected the sample to my machine in order to grab the correctly formatted login packet.&nbsp;</p>

<p>Then, using Python, I created a socket script that communicates with the C2 server and sends the login packet that I received on my analysis machine.&nbsp; It then listens for commands sent by the C2 Server, and logs any commands to a text file located on the server.&nbsp; All I had to do then was periodically check up on the text file to see if any new additions were added.&nbsp; Additionally, on the C2 server end, my connection looks legitimate, however any attempts to control it will fail.</p>

<h2>Mitigation</h2>

<p>As with most of the samples I analyze, the best practice to mitigate this sample is to avoid it all together.&nbsp; As this sample uses a relatively old and patched exploit to spread, you&rsquo;ll need to make sure your machines are updated to the latest software patch.&nbsp; If updating is impossible due to software requirements, I&rsquo;d recommend closing port 445 on the machine to stop the spread of the malware.&nbsp;</p>

<p>Since this sample is a single stage sample, luckily, you don&rsquo;t have to deal with multiple dropped payloads scattered all over the device.&nbsp; However, depending on the level of infection, you may or may not have new user accounts added to your system.&nbsp;</p>

<p>In order to discover all user accounts on your system you can use the command <strong><em>net user</em></strong>.&nbsp; This will list all user accounts on your computer.&nbsp; In order to gain more information on a specific user, you can use <strong><em>net user [username]</em></strong>, which will allow you to see (among other things), the last time they logged in along with group membership.</p>

<p>Additionally, if infected, the installation folder may vary from system to system.&nbsp; The best way to identify both the installation folder and filename, you should open registry and navigate to the <strong>HKLM/SOFTWARE/Microsoft/Windows/Current Version/Run </strong>key and write down the install path for the value <strong>NetService.exe</strong>.&nbsp; You should then delete both that value, along with the file referenced in the install path.</p>

<h2>IoCs</h2>

<div class="table-responsive">
<table border="1" cellpadding="0" cellspacing="0" class="table table-bordered">
	<tbody>
		<tr>
			<td>
			<p><strong>Sample</strong></p>
			</td>
			<td>
			<p><strong>MD5</strong></p>
			</td>
			<td>
			<p><strong>Size</strong></p>
			</td>
			<td>
			<p><strong>C2</strong></p>
			</td>
			<td>
			<p><strong>IOC</strong></p>
			</td>
		</tr>
		<tr>
			<td>
			<p>NetService.exe</p>
			</td>
			<td>
			<p>63cfc1680284422620cb966af8e9f167</p>
			</td>
			<td>
			<p>122KB</p>
			</td>
			<td>
			<p>z-hacker-y.win:22</p>
			</td>
			<td>
			<p>SOFTWARE/Microsoft/Windows/Current Version/Run/NetService.exe</p>

			<p>&nbsp;</p>

			<p>Traffic to C2 server</p>
			</td>
		</tr>
	</tbody>
</table>
</div>

<p>rule Gh0stRAT_DDOS_Variant {</p>

<p>&nbsp;&nbsp; meta:</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; description = "Gh0stRAT Variant"</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; author = "James Quinn @LazyActivist192"</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; date = "2019-04-05"</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hash1 = "f1cd38bbb504b38d115b5c127afa913572cef4233395416b5b08aff5f718cfea"</p>

<p>&nbsp;&nbsp; strings:</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s1 = "User-Agent:Mozilla/4.0 (compatible; MSIE 6.00; Windows NT 5.0; MyIE 3.01)" fullword ascii</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s2 = "User-Agent:Mozilla/4.0 (compatible; MSIE 7.00; Windows NT 5.1; MyIE 3.01)" fullword ascii</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s3 = "User-Agent:Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)" fullword ascii</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s4 = "User-Agent:Mozilla/5.0 (X11; U; Linux i686; en-US; re:1.4.0) Gecko/20080808 Firefox/8.0" fullword ascii</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s5 = "aPPLICATIONS\\IEXPLORE.EXE\\SHELL\\OPEN\\COMMAND" fullword ascii</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s6 = "NetService.exe" fullword ascii</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s7 = "MSVCP60.dll" fullword ascii</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s8 = "\\CMD.EXE" fullword ascii</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s9 = "360tary.exe" fullword ascii</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s10 = "MFC42.DLL" fullword ascii</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s11 = "%s\\SHELL\\OPEN\\COMMAND" fullword ascii</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s12 = "360sd.exe" fullword ascii</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s13 = "Winlogon" fullword ascii</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s14 = "system\\cURRENTcONTROLsET\\sERVICES\\%s" fullword ascii</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s15 = "SYSTEM\\CurrentControlSet\\Services\\TermService" fullword ascii</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s16 = "SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp" fullword ascii</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s17 = "SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\Wds\\rdpwd\\Tds\\tcp" fullword ascii</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s18 = "Mozilla/4.0 (compatible)" fullword ascii</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s19 = "SYSTEM\\CurrentControlSet\\Services\\TermDD" fullword ascii</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s20 = "SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\RDPTcp" fullword ascii</p>

<p>&nbsp;&nbsp; condition:</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint16(0) == 0x5a4d and filesize &lt; 400KB and</p>

<p>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ( pe.imphash() == "90951b36f29a0f78c9e88cebc58ea5a6" or 8 of them )</p>

<p>}</p>
									<div class="blog-related">
									<div class="be-ix-link-block"></div>
									</div>
								</div>
								<div class="blog-author">
									<a href="https://cybersecurity.att.com/blogs/author/james-quinn" class="blog-avatar">
									
										<img src="data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22150px%22%20height%3D%22150px%22%3E%3Crect%20fill%3D%22none%22%20width%3D%22150%22%20height%3D%22150%22%2F%3E%3C%2Fsvg%3E" data-original="/avatars/uploads/avatar_253.jpg" width="150" height="150" alt="James Quinn" />
									
									</a>

									<div class="blog-author-info">
										<p><strong>About the Author:</strong> <span>James Quinn</span></p>
										<p>James has been programming since he was 12 but didn't become interested in Cybersecurity until around 16. He's now finishing his 3rd semester for a Cybersecurity associate's degree. In James' free time, he analyzes malware dropped on his dionaea honeypot and would consider himself an amateur photographer.</p>


										<p><a href="/blogs/author/james-quinn">Read more posts from James Quinn ›</a></p>

									</div>
								</div>


								<div class="blog-categories">
								<p>TAGS: <a href="/blogs/tag/malware+research" title="malware research" rel="nofollow">malware research</a>, <a href="/blogs/tag/ghostrat" title="ghostrat" rel="nofollow">ghostrat</</p>
								</div>


								<p><a href="https://cybersecurity.att.com/blogs/labs-research" class="back-to-all">‹ BACK TO ALL BLOGS</a></p>
							</div>
							
							<div class="col-sm-4">
								<div>
									<div class="blog-sidebar-block">
    <form id="searchbox_002748587151982842036:gharkgtx6cu" action="/search-results/blog" class="sidebar-search">
        <input value="002748587151982842036:gharkgtx6cu" name="cx" type="hidden" />
        <input value="FORID:11" name="cof" type="hidden" />
        <div class="search-button">
            <input value="Search" name="sa" type="submit" />
        </div>
        <div class="search-field">
            <input id="q" name="q" type="text" placeholder="Search our blogs" />
        </div>
    </form>
</div>

<div class="blog-subscribe-grid" id="blog-subscribe-box">

    <h2>Get the latest security news in your inbox.</h2>

    <p class="text-center"><a class="btn btn-blue digestoform" id="digestobutton" target="_blank">Subscribe via email</a></p>

    <script>window.addEventListener('DOMContentLoaded', function() { var href_string="https://pages.alienvault.com/Digesto.html"+get_cookie_url_string()+"&redirect=https://cybersecurity.att.com/forms/email-thank-you";document.getElementById("digestobutton").href=href_string;});</script>
</div>
<p style="text-align: right; margin: 30px 10px 5px 0;"><a href="http://feeds.feedblitz.com/alienvault-blogs" target="_blank"><img src="https://cdn-cybersecurity.att.com/images/uploads/icons/rss.svg" width="20" height="20" style="display: inline-block; margin: 0 7px 2px;">RSS</a>
</p>
									<div class="promo-block">
										
													
			<style type="text/css">#blog-promo-block-v2 .blog-promo-item-v2 {
    box-shadow: 1px 1px 5px #D2D2D229;
    border: 1px solid #D2D2D2;
    margin-bottom: 30px;
}
#blog-promo-block-v2 .blog-promo-item-v2 .blog-promo-resource-type-v2 {
    font-size: 14px;
    color: #0568AE;
    font-weight: 500;
    padding: 15px;
    margin: 0;
}
#blog-promo-block-v2 .blog-promo-item-v2 .blog-promo-item-text-v2 {
    margin-bottom:15px;
}
#blog-promo-block-v2 .blog-promo-item-v2 .blog-promo-item-text-v2 a {
    color: black;
    text-decoration: none;
    font-weight: 500;
}
#blog-promo-block-v2 .blog-promo-item-v2 .blog-promo-item-text-v2 p {
   margin: 0 15px;
}

#blog-promo-block-v2 .blog-promo-item-icon-v2 {
   margin: 15px;
   font-size: 16px;
}
#blog-promo-block-v2 .blog-promo-item-icon-v2 .icon-right {
    width: 20px;
    height: 20px;
    border: 1px solid #0568ae;
    border-radius: 20px;
    font-size: 9.5px;
    line-height: 18px;
    font-weight: 400;
    margin-right: 10px;
    padding-left: 4px;
    top: -1px;
}
@media (max-width: 1024px) {
 .blog-promo-item-v2 img {
    display: none;
  }
}
</style>
<div id="blog-promo-block-v2">
<h3>Featured resources</h3>

<div class="blog-promo-item-v2"><img src="https://cdn-cybersecurity.att.com/images/uploads/resource-images/5g-and-the-journey.jpg" />
<p class="blog-promo-resource-type-v2">INDUSTRY REPORT</p>

<div class="blog-promo-item-text-v2">
<p><a href="/resource-center/industry-reports/cybersecurity-insights-report-tenth-edition">AT&amp;T Cybersecurity Insights&trade; Report:<br />
5G and the Journey to the Edge</a></p>
</div>

<div class="blog-promo-item-icon-v2"><span aria-hidden="true" class="icon-right glyphicon glyphicon-chevron-right">&nbsp;</span> <a href="/resource-center/industry-reports/cybersecurity-insights-report-tenth-edition">Learn more</a></div>
</div>

<div class="blog-promo-item-v2"><img src="https://cdn-cybersecurity.att.com/images/uploads/resource-images/security-maturity-assessment.jpg" />
<p class="blog-promo-resource-type-v2">SELF ASSESSMENT</p>

<div class="blog-promo-item-text-v2">
<p><a href="/resource-center/security-maturity-assessment?utm_internal=blog-rail-assess">Benchmark your cybersecurity maturity</a></p>
</div>

<div class="blog-promo-item-icon-v2"><span aria-hidden="true" class="icon-right glyphicon glyphicon-chevron-right">&nbsp;</span> <a href="/resource-center/security-maturity-assessment?utm_internal=blog-rail-assess">Explore</a></div>
</div>
</div>
		
										

									</div>
								</div>
							</div>
						</div>
					</div>
				</section>


			</main>


			
				<style>

	/* Sticky button */
	.desktop .sticky_bottom_keeper {
		height: 80px;
	}
	.sticky_bottom_desktop.fixed {
		height: 80px;
	}
	.sticky_bottom_keeper .btn {
		color: #fff;
	}
	.sticky_bottom_keeper .btn-white {
		border: 2px solid #fff;
	}
	.sticky_bottom_keeper .btn-white.btn-border {
		background: transparent;
	}




	.line.line-8 {
		height: 8px;
	}

	.hh .sticky_bottom_keeper {
		display: block !important;
		height: 8px;
		background: #009fdb;
	}

	.sticky_bottom_keeper .sticky_bottom_hh.fixed {display:none;}


</style>
<div class="sticky_bottom_keeper">


	<div class="sticky_bottom sticky_bottom_hh">
		<a class="sticky_bottom_hh_cta" href="#watch-alienvault-threat-detection-XwZyCKfKXbLhhBtQqFGT1L:7010Z000001v1DO">Watch
			a demo &#8250;</a>

		<a href="#" class="sticky_bottom_hh_close avicon-close"></a>
	</div>

	<div class="sticky_bottom sticky_bottom_desktop ibp">
		<a href="/pricing/request-quote" class="btn btn-border btn-white btn-rounded btn-with-arrow">Get price</a>
		<a href="/products/usm-anywhere/free-trial" class="btn btn-border btn-white btn-rounded btn-with-arrow">Free trial</a>

	</div>


</div>
			
		


		<footer id="footer" class="hidden-print">
  <div class="container-fluid">
    <div class="row">
      <div class="col-sm-6 col-md-3">
        
        <div class="footer_logo"><img src="data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22263px%22%20height%3D%2256px%22%3E%3Crect%20fill%3D%22none%22%20width%3D%22263%22%20height%3D%2257%22%2F%3E%3C%2Fsvg%3E" data-original="https://cdn-cybersecurity.att.com/images/uploads/logos/att_biz_hz_pref_rgb_white.png" alt="AT&T Business"></div>
        <div class="footer_featured">

          <div class="footer_featured_title">From the Blog</div>
          <article class="footer_featured_article">
            <div class="footer_featured_article_author clearfix">
	            
										<img src="data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22150px%22%20height%3D%22150px%22%3E%3Crect%20fill%3D%22none%22%20width%3D%22150%22%20height%3D%22150%22%2F%3E%3C%2Fsvg%3E" data-original="/avatars/uploads/avatar_357_1.jpg" width="150" height="150" alt="Mark Stone" />
									
              <div class="footer_featured_article_author_data">
                <h4>Mark Stone</h4>
                <time datetime="2021-06-18">Mar 18, 2021</time>
              </div>
            </div>
            <h3><a href="https://cybersecurity.att.com/blogs/security-essentials/what-is-a-security-operations-center-soc" id="footer-link-blog-post">What is a security operations center (SOC)? Explaining the SOC framework</a></h3>
          </article>
          <a id="footer-link-blog-all" href="/blogs" class="footer_featured_more">Explore All Blog Posts
            &#8250;</a>
        </div>
        

        <div class="social-style">
          <a href="https://www.twitter.com/attcyber/" class="social-link-twitter" target="_blank">Twitter</a>
          <a href="https://www.linkedin.com/company/attcybersecurity/" class="social-link-linkedin" target="_blank">Linkedin</a>
          <a href="https://www.facebook.com/ATTCyber/" class="social-link-facebook" target="_blank">Facebook</a>
          <a href="https://www.youtube.com/c/attcybersecurity" class="social-link-youtube" target="_blank">Youtube</a>
          <a href="https://www.instagram.com/attbusiness/" class="social-link-instagram" target="_blank">Instagram</a>
          <a href="https://community.spiceworks.com/pages/attcybersecurity" class="social-link-spiceworks" target="_blank">Spiceworks</a>


        </div>
      </div>

      <div class="col-sm-6 col-md-3">
        <div class="footer_links">
          <div class="heading">Who We Are</div>
          <ul>
            <li><a id="footer-link-labs" href="/alien-labs">Alien Labs</a></li>
            <li><a id="footer-link-customers" href="/who-we-are/customers">Customers</a></li>
            <li><a id="footer-link-careers" href="/who-we-are/careers">Careers</a></li>
            <li><a id="footer-link-contact" href="/contact">Contact Us</a></li>
          </ul>
        </div>

        <div class="footer_links">
          <div class="heading">News</div>
          <ul>
            <li><a id="footer-link-news-room" href="/who-we-are">Newsroom</a></li>
            <li><a id="footer-link-events" href="/who-we-are/events">Events</a></li>
            <li><a id="footer-link-blogs" href="/blogs">Blogs</a></li>
          </ul>
        </div>

        <div class="footer_links">
          <div class="heading">Partners</div>
          <ul>
            <li><a id="footer-link-partners" href="/partners">Partner Programs</a></li>
            <li><a id="footer-link-partner-portal" href="/partners/partner-portal/">Partner Portal</a></li>
          </ul>
        </div>
      </div>

      <div class="col-sm-6 col-md-3">
        <div class="footer_links">
          <div class="heading">Products</div>
          <ul>
		  	<li><a id="footer-link-mtdr" href="/products/managed-threat-detection-and-response">AT&T Managed Threat Detection and Response</a></li>
            <li><a id="footer-link-usm-anywhere" href="/products/usm-anywhere">USM Anywhere</a></li>
            <li><a id="footer-link-usm-mssp" href="/products/usm-for-mssp">USM for MSSPs</a></li>
            <li><a id="footer-link-managed-security" href="/products/managed-security-services">Partner Managed Solutions</a></li>
            <li><a id="footer-link-otx" href="/open-threat-exchange">Open Threat Exchange (OTX)</a></li>
            <li><a id="footer-link-ossim" href="/products/ossim">OSSIM</a></li>

          </ul>
        </div>



        <div class="footer_links">
          <div class="heading">Solutions</div>
          <ul>
            <li><a id="footer-link-cloud-security" href="/solutions/cloud-security-monitoring">Cloud Security Monitoring</a></li>
            <li><a id="footer-link-threat-detection" href="/solutions/threat-detection">Threat Detection</a></li>
            <li><a id="footer-link-ids" href="/solutions/intrusion-detection-system">Intrusion Detection</a></li>
            <li><a id="footer-link-siem" href="/solutions/siem-platform-solutions">SIEM platform solutions</a></li>
            <li><a id="footer-link-vulnerability" href="/solutions/vulnerability-assessment-remediation">Vulnerability
                Assessment</a></li>
            <li><a id="footer-link-all-solutions" class="btn-with-arrow" href="/solutions">See All Solutions</a></li>
          </ul>
        </div>
      </div>

      <div class="col-sm-6 col-md-3">
        <div class="footer_links">
          <div class="heading">Resources</div>
          <ul>
            <li><a id="footer-link-resources" href="/resource-center">Resources</a></li>
            <li><a id="footer-link-blog" href="/blogs">Blogs</a></li>
            <li><a id="footer-link-reference-guide" href="https://www.business.att.com/content/dam/attbusiness/guides/att-information-and-network-security-customer-reference-guide.pdf" target="_blank">Customer Reference Guide</a></li>

          </ul>
        </div>

        <div class="footer_links">
          <div class="heading">Customer Success</div>
          <ul>
            <li><a id="footer-link-support" href="/support">Support &amp; Services</a></li>
            <li><a id="footer-link-customer-portal" href="https://success.alienvault.com" target="_blank">Success Center</a></li>
            <li><a id="footer-link-documentation" href="/documentation">Documentation Center</a></li>
            <li><a id="footer-link-classroom-training" href="/training">Training</a></li>
            <li><a id="footer-link-certification" href="/certification">Certification</a></li>
          </ul>
        </div>

        <div class="footer_contact">
          <a href="/contact" id="footer-button-contact" class="btn btn-blue margin-bottom20">Contact us</a>
        </div>
      </div>
    </div>
    <div class="footer_legal">
      <p class="footer_legal_copy">&copy; Copyright 2021</p>
      <ul class="footer_legal_links">
        <li><a id="footer-link-privacy" href="/legal/privacy-policy">Privacy Policy</a></li>
        <li><a id="footer-link-terms" href="/terms/website-terms-of-use07may2018">Website Terms of Use</a></li>
        <li><a id="footer-link-gdpr" href="/legal/gdpr">GDPR</a></li>
        <li><a id="footer-link-cookie" href="/legal/cookie-policy">Cookie Policy</a></li>
        <li><a id="footer-link-personal-info" href="https://about.att.com/csr/home/privacy/rights_choices.html" target="_blank">Do Not Sell My Personal Information</a></li>

      </ul>
    </div>
  </div>
</footer>

<div id="valid_content"></div>

		
	<script src="https://cdn-cybersecurity.att.com/js/v2/imports/blog-bundle.min.js?v=20210316522111" defer></script>






		



<div class="cookie-notice">
    <p>We use cookies to provide you with a great user experience. By using our website, you agree to our <a href="https://www.att.com/privacy">Privacy Policy</a> and <a href="/terms/website-terms-of-use07may2018">Website Terms of Use</a>.</p>
    <a class="cookie-notice-close" href="#" aria-label="Close Cookie Notice"><span class="glyphicon glyphicon-remove"></span></a>
</div>


<!-- WGT-10310 -->

<!-- END WGT-10310 -->

<script src='https://www.att.com/scripts/adobe/prod/detm-container-hdr.js' data-restrictions='target' type='text/javascript' defer></script>
<script src='https://www.att.com/scripts/adobe/prod/detm-container-ftr.js' type='text/javascript' defer></script>



<script>
if (typeof ddo !== "undefined") {
	$(document).ready(function() {
	
	

	
	
	});
}

function initAdobePageTrackingFooter() {
	ddo.setVar('page.pageInfo.language','EN');
	ddo.setVar('page.pageInfo.lineOfBusiness','Business Solutions');
	ddo.setVar('page.category.pageFunction','Learn');
	ddo.setVar('page.category.pageOwnership','Business');
	ddo.setVar('page.attributes.applicationName','CYB');
	ddo.setVar('page.pageInfo.appCode','ACS');
	ddo.setVar('page.category.siteSection','CYB');
	ddo.setVar('page.category.siteSection','CYB');
	ddo.setVar('page.media.class','text');
	ddo.setVar('page.media.objective','Awareness');
	ddo.setVar('page.media.category','Security');
	ddo.setVar('page.location.domain','cybersecurity.att.com');
	ddo.pushEvent('pageLoad', 'Page_Load');
}
</script>


		<script>
			window.addEventListener('DOMContentLoaded', function() {
				$(window).load(function () {
					var hideSubscribe = AV.Utilities.readCookie('stickyBlogSubscribe');
					// if the cookie hasn't been set...
					if (hideSubscribe == null) {
						setTimeout(function () {
							// make the modal appear
							$('#blog-subscribe-box').fadeIn();
						}, 10000);

						// when the "Close" button is clicked
						$('.blog-subscribe-close-btn').click(function (e) {
							e.preventDefault();
							// set the cookie
							AV.Utilities.setCookie('stickyBlogSubscribe', true, 1);
							$('#blog-subscribe-box').fadeOut();
						});
					}
				});
			});
		</script>

	<script type="text/javascript" >var _cf = _cf || [];  _cf.push(['_setFsp', true]);  _cf.push(['_setBm', true]);  _cf.push(['_setAu', '/libraries/8ff88d9aano23331406e461ab4dfa32']); </script><script type="text/javascript"  src="/libraries/8ff88d9aano23331406e461ab4dfa32"></script></body>
</html>
<!-- Debug: total time - 0.0024311542510986 -->