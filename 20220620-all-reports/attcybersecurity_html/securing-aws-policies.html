<!DOCTYPE html>
<html lang="en">

<head>
	

	


	

	<!--trying to figure out the canonical url issue with blogs-->
	<link rel="canonical" href="https://cybersecurity.att.com/blogs/labs-research/securing-aws-policies" />

	<title>Security best practices for AWS IAM policies | AT&T Alien Labs</title>

	

		

	<meta property="og:site_name" value="AT&T Cybersecurity" />
	<meta property="og:title" content="AWS IAM security" />
	<meta property="og:url" content="https://cybersecurity.att.com/blogs/labs-research/securing-aws-policies" />
	<meta property="og:image" content="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/open-graph/blog-OG-data-carving-2017.jpg" />
	<meta property="og:description" content="Executive summary

AWS Policies are a key foundation in good cloud security, but they are often overlooked. In this blog, we take a quick look on some AWS Policies, particularly for&nbsp;Identity and Access Management&nbsp;(IAM), that could become problematic if not properly managed. We&#39;ll discuss how they can be used against us to generate attacks like: Ransomware, data exfiltration, credential abuse, and more. Finally, we&#39;ll suggest some Open Source tools for cloud policy assessment an" />
		



	<meta charset="utf-8">

<link rel="preconnect" href="https://cdn-cybersecurity.att.com" />
<link rel="preconnect" href="https://www.att.com" />
<link rel="preconnect" href="https://www.googletagmanager.com" crossorigin />
<link rel="preconnect" href="https://cdn.vidyard.com" crossorigin />
<link rel="preconnect" href="https://ajax.cloudflare.com" crossorigin />
<link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin />
<link rel="preconnect" href="https://googleads.g.doubleclick.net" crossorigin />
<link rel="preconnect" href="https://www.google-analytics.com" crossorigin />
<link rel="preconnect" href="https://play.vidyard.com" crossorigin />
<link rel="preconnect" href="https://adservice.google.com" crossorigin />
<link rel="preconnect" href="https://www.googleadservices.com" crossorigin />
<link rel="preconnect" href="https://www.facebook.com" crossorigin />
<link rel="preconnect" href="https://www.google.com" crossorigin />
<link rel="preconnect" href="https://px.ads.linkedin.com" crossorigin />


<style>.async-hide { opacity: 0 !important} </style>
<script>(function(a,s,y,n,c,h,i,d,e){s.className+=' '+y;h.start=1*new Date;
    h.end=i=function(){s.className=s.className.replace(RegExp(' ?'+y),'')};
    (a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c;
})(window,document.documentElement,'async-hide','dataLayer',4000,
    {'GTM-WGVFC3T':true});</script>
<script async src="https://www.googleoptimize.com/optimize.js?id=GTM-WGVFC3T"></script>


<script src="https://cdn-cybersecurity.att.com/js/v2/imports/top-bundle.min.js?v=20210518514930"></script>


<link rel="preload" href="https://www.att.com/scripts/adobe/prod/edmDataDefinition.js" as="script">
<link rel="preload" href="https://www.att.com/scripts/adobe/prod/edmDataManager.js" as="script">
<link rel="preload" href="https://www.att.com/scripts/adobe/prod/marketing.min.js" as="script">
<link rel="preload" href="https://www.att.com/scripts/adobe/prod/detm_adobe.js" as="script">






<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KLJDXJN');</script>
<!-- End Google Tag Manager -->
<script src='https://www.att.com/scripts/adobe/prod/detm-container-hdr.js' data-restrictions='target' type='text/javascript'></script>


<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="ahrefs-site-verification" content="a6fa0378625f72f89c6f290c3c7559ffee326fb9232cd87fcace798afce3e30d">
<meta name="google-site-verification" content="GTQZz4AGa47UtmP64oC5BB735pkyncjtISHOcQZbIho" />

<link rel="preload" as="font" type="font/ttf" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/zero-width.ttf" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Bold.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Regular.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Light.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Medium.woff2" />


<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-LightItalic.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-BoldItalic.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-MediumItalic.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Italic.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Black.woff2" />

<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/css/fonts/glyphicons-halflings-regular.woff2" />
<link rel="preload" as="font" type="font/ttf" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/av-icons.ttf?e81fxl" />



<link rel="preload" as="style" href="https://cdn-cybersecurity.att.com/css/sass/main.min.css?v=20210518514930" />
<link rel="apple-touch-icon" sizes="144x144" href="https://cdn-cybersecurity.att.com/images/uploads/apple-touch-icon.png"/>
<link rel="icon" type="image/png" sizes="32x32" href="https://cdn-cybersecurity.att.com/images/uploads/favicon.ico"/>
<link rel="shortcut icon" href="https://cdn-cybersecurity.att.com/images/uploads/favicon.ico">
<link rel="manifest" href="https://cdn-cybersecurity.att.com/manifest.json">

<link rel="stylesheet" href="https://cdn-cybersecurity.att.com/css/sass/main.min.css?v=20210518514930" />








<script>
	var customAdobeTrackingPageLoadObj = {};
	if (typeof ddo !== "undefined") {initAdobePageTrackingHeader();}

	function initAdobePageTrackingHeader() {
		ddo.disableAutoPageLoad();
		document.addEventListener('click', function (event) {
			var target = event.target;
			if (!target.href || !target.text) { return true; }
			var linkEvent = {
				slotFriendlyName: "link-click",
				contentFriendlyName: "Link Click",
			};
			linkEvent.linkName = target.text;
			linkEvent.linkDestinationUrl = target.href;
			if (target.href.indexOf('#watch-') >= 0) {
				linkEvent.slotFriendlyName = 'watch-video';
				linkEvent.contentFriendlyName = 'Watch Video';
				linkEvent.linkName = 'Watch Video';
			}
			ddo.pushEvent("linkClick", "Link_Click", linkEvent);
		});
		
		customAdobeTrackingPageLoadObj['page.location.url'] = '/blogs/labs-research/securing-aws-policies';


		
		
		    customAdobeTrackingPageLoadObj['page.category.siteSubSection1'] = 'blogs';
		


		
		
			customAdobeTrackingPageLoadObj['page.category.siteSubSection2'] = 'labs-research';
		



		
		
			customAdobeTrackingPageLoadObj['page.category.siteSubSection3'] = 'securing-aws-policies';
		


		
		

		
		
	}
</script>


<script type="text/javascript">
    var _elqQ = _elqQ || [];
    _elqQ.push(['elqSetSiteId', '1086385399']);

    _elqQ.push(['elqUseFirstPartyCookie', 'cyber-tracking.att.com']);

    _elqQ.push(['elqTrackPageView', window.location.href]);

    (function () {
        function async_load() {
            var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true;
            s.src = '//img03.en25.com/i/elqCfg.min.js';
            var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x);
        }
        if (window.addEventListener) window.addEventListener('DOMContentLoaded', async_load, false);
        else if (window.attachEvent) window.attachEvent('onload', async_load);
    })();
</script>


	<link rel="alternate" type="application/rss+xml" title="AlienVault Open Threat Exchange Blog" href="http://feeds.feedblitz.com/alienvaultotx&x=1" />

	<style>
	.blog-author-info {
		width: 70%;
		float: left;
		color: #191919;
	}

	.blog-subscribe-grid ul {
		margin-left: 0px;
		margin-bottom: 0px;
		padding-left: 0px;
	}

	.blog-subscribe-grid ul li {
		list-style-type: none;
		line-height: 20px;
	}

	.blog-subscribe-grid ul li a {
		color: #c6ced5;
		font-size: 14px;
		text-decoration: none;
	}

	.blog-subscribe-grid ul li a:hover {
		text-decoration: underline;
	}

	.blog-content-area img {
		width: 100%!important;
		height: auto!important;
	}

	.blog-promo-item {
		clear: both;
		overflow: hidden;
		margin-bottom: 30px;
	}
	.promo-block .small {
		text-transform: uppercase;
	}

	.blog-promo-item-text {
		width: 345px;
		float: left;
		max-width:100%;
	}

	.blog-promo-item p {
		margin-bottom: 0px!important;
	}






	#blog-promo-block {
		padding-top: 20px;
	}



	/*promo block and sticky classes*/

	.sticky-sidebar {
		top: 147px;
		position: -webkit-sticky; /* Safari */
		position: sticky;
	}
	     .sidebar-search {
			 margin-bottom: 30px;
		 }

         .sidebar-search .search-button {
                width: 100%;
                position: relative;
            }

            .sidebar-search .search-button input {
                padding: 0px;
                margin: 2px 0px 0px 0px;
                position: absolute;
                background: url(https://cdn-cybersecurity.att.com/images/icn-sidebar-search.png) top left no-repeat;
                background-size: 25px 25px;
                width: 25px;
                height: 25px;
                cursor: pointer;
                text-indent: -9999em;
                border: none;
                left: 10px;
                top: 6px;
             }

			.sidebar-search .search-field input {
                border: 0;
                width: 100%;
                height: 30px;
                padding-left: 50px;
				margin-top: 5px;
            }

            .sidebar-search .search-field {
                border: 1px solid #CCCCCC;
                width: 100%;
                height: 40px;
            }

            #q::placeholder {
          		color: #767676!important;
            }

            #blog-subscribe-box {
			height:auto;
            padding: 32px;
            background-image: url('https://cdn-cybersecurity.att.com/images/uploads/backgrounds/blog-email-subscribe-bkg.jpg');
            background-size: cover;
            }

            #blog-subscribe-box h2 {
            color: #fff;
            font-size:32px;
            }

			#blog-subscribe-box p {
				margin-bottom: 10px;
			}






	@media (max-width: 991px) {
            .sidebar-search .search-button input {
                padding: 0px;
                background: transparent;
                cursor: pointer;
                text-indent: -9999em;
                border: none;
                right: 5px;
                top: 5px;
                padding-left: 0px;
             }

            .sidebar-search .search-field input {
             padding-left: 15px;
             }


            }

            	@media (min-width: 768px) and (max-width: 920px){
	.blog-subscribe-grid .btn {
		border-radius: 24px;
	    font-size: 12px;
	    line-height: 18px;
	    border: none;
	    padding: 6px 36px;
	    height: 30px;
	    font-weight: 500;
	}
}


		.blog-content-area p,
		.blog-content-area ul li,
		.blog-content-area ol li{
			font-size: 16px;
			line-height: 20px;
			font-weight: 400;
		}
		.blog-content-area ul li,
		.blog-content-area ol li {
			margin-bottom: 10px;
		}

	</style>

</head>

	<body class="listing-blog-entry-id-7287">
			<!-- Google Tag Manager (noscript) -->
<noscript><iframe src='https://www.googletagmanager.com/ns.html?id=GTM-KLJDXJN'
height='0' width='0' style='display:none;visibility:hidden'></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<script src='https://www.att.com/scripts/adobe/prod/detm-container-ftr.js' type='text/javascript'></script>


		<header id="header" class="navbar navbar-fixed-top">

	<style>
@media (max-width: 543px) {
	.hide-on-mobile {
		display: none;
	}
}
</style>

<div id="news-banner">
    <div class="container-fluid">
        <div class="row vcenter">
            <div class="col-sm-12">

                <div id="news-headline-link">
					<a href="/products/strategy-and-roadmap/sase-readiness" class="text-white">
						Start your SASE readiness consultation today.
						<span class="hide-on-mobile">Learn more</span> &LongRightArrow;
					</a>
                </div>
				<div id="search-contact">
					<ul class="list-unstyled header_nav_top_list">
						<li class="header_nav_top_list_item"><a id="top-nav-support" href="/support">Support</a></li>
						<li class="header_nav_top_list_item"><a id="top-nav-contact" href="/contact">Contact</a></li>
						<li class="header_nav_top_list_item search">
							<a href="#" class="header_nav_toggle-search" aria-label="Search">
								<!-- <span class="hide-on-active"><img src="https://cdn-cybersecurity.att.com/images/uploads/nav/search.png"></span>
								<span class="show-on-active"><img src="https://cdn-cybersecurity.att.com/images/uploads/nav/search.png"></span> -->
								<span class="hide-on-active glyphicon glyphicon-search" aria-hidden="true"></span>
								<span class="show-on-active glyphicon glyphicon-search" aria-hidden="true"></span>
							</a>
							<form action="/search-results" method="get" id="top-search-form" __bizdiag="113" __biza="WJ__"><input name="q" id="top-search-form-text" type="text" placeholder="Search Now...." aria-label="Search"><button class="sr-only" type="submit">Search</button></form>
						</li>
					</ul>
				</div>
            </div>
        </div>
    </div>
</div>






	<div id="header-container" class="container-fluid">
		<div id="header-logo">
			<div class="logo-globe"><a href="https://business.att.com" target="_blank"><img src="https://cdn-cybersecurity.att.com/images/uploads/logos/att-globe.svg" alt="AT&amp;T Business" /></a></div>
			<div class="att-business"><a href="https://business.att.com" target="_blank"><img src="https://cdn-cybersecurity.att.com/images/uploads/logos/att-business-web.svg" alt="AT&amp;T Business" /></a></div>
			<div class="att-cybersecurity"><a href="/"><img src="https://cdn-cybersecurity.att.com/images/uploads/logos/att-cybersecurity-web.svg" alt="AT&amp;T Cybersecurity" /></a></div>
		</div>

		<button type="button" class="header_toggle_nav navbar-toggle collapsed" data-toggle="collapse" data-target="#header-nav" aria-expanded="false">
			<span class="sr-only">Toggle navigation</span>
			<span class="avicon avicon-bars"></span>
			<span class="avicon avicon-close"></span>
		</button>
		
		
			<a href="/contact" id="header-cta" class="hidden-md hidden-lg btn btn-blue btn-sm">Contact us</a>
		

		<nav class="navbar-collapse collapse" id="header-nav">
			<ul class="nav navbar-nav list-unstyled">
				<li class="nav-item has-dd products">
					<a id="main-nav-products" href="/products" class="dropdown-toggle" data-toggle="collapse" role="button" aria-expanded="false" data-target="#products-dd">Products<span class="glyphicon glyphicon-chevron-up"></span><span class="glyphicon glyphicon-chevron-down"></span>
					</a>
					<div class="nav-dropdown collapse" id="products-dd">
						<div class="dd-multi-col container-fluid">
							<ul class="list-unstyled sub-nav">
									<li id="first-sub-cyber-strategy-risk"><a href="/categories/cybersecurity-consulting-services" class="first-level">Cybersecurity Consulting Services</a>
										<div class="desktop-subnav open">
											<ul class="list-unstyled">
												<li class="second-sub-heading">Cyber Strategy</li>
												<li class="second-sub-link"><a href="/products/strategy-and-roadmap">Strategy and Roadmap Planning</a></li>

												<li class="second-sub-link"><a href="/products/security-assessment">Enterprise Security Assessment Services</a></li>
												<li class="second-sub-link"><a href="/products/risk-based-cyber-posture-assessment">Risk-based Cyber Posture Assessment</a></li>
											</ul>
											<ul class="list-unstyled">
												<li class="second-sub-heading">Risk and Compliance</li>
												<li class="second-sub-link"><a href="/products/security-compliance">Security Compliance</a></li>
											</ul>
											<ul class="list-unstyled">
												<li class="second-sub-heading">Vulnerability and Threat Management</li>
												<li class="second-sub-link"><a href="/products/managed-vulnerability-program">Managed Vulnerability Program</a></li>
												<li class="second-sub-link"><a href="/products/penetration-testing-services">Penetration Testing</a></li>
												<li class="second-sub-link"><a href="/products/adversary-simulation-service">Adversary Simulation Services</a></li>

											</ul>
											<ul class="list-unstyled">
												<li class="second-sub-heading">CSO Advisory Services</li>
												<li class="second-sub-link"><a href="/products/cybersecurity-iq-training">Cybersecurity IQ Training</a></li>
											</ul>
										</div>
										<div class="mobile-subnav">
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-link"><a href="/products/strategy-and-roadmap">Strategy and Roadmap Planning</a></li>
												<li class="second-sub-link"><a href="/products/security-assessment">Enterprise Security Assessment Services</a></li>
												<li class="second-sub-link"><a href="/products/risk-based-cyber-posture-assessment">Risk-based Cyber Posture Assessment</a></li>

												<li class="second-sub-link"><a href="/products/security-compliance">Security Compliance</a></li>

												<li class="second-sub-link"><a href="/products/managed-vulnerability-program">Managed Vulnerability Program</a></li>

												<li class="second-sub-link"><a href="/products/penetration-testing-services">Penetration Testing</a></li>
												<li class="second-sub-link"><a href="/products/adversary-simulation-service">Adversary Simulation Services</a></li>
												<li class="second-sub-link"><a href="/products/cybersecurity-iq-training">Cybersecurity IQ Training</a></li>
											</ul>
										</div>
									</li>
                                    <li id="first-sub-managed-security-services"><a href="/categories/managed-security-services" class="first-level">Managed Security Services</a>
                                        <div class="desktop-subnav">
                                            <ul class="list-unstyled">
                                                <li class="second-sub-heading">Network Security</li>
												<li class="second-sub-link"><a href="/products/secure-web-gateway">Secure Web Gateway</a></li>
												<li class="second-sub-link"><a href="/products/secure-remote-access">Secure Remote Access</a></li>
                                                <li class="second-sub-link"><a href="/products/sase-branch-with-fortinet">SASE Branch with Fortinet</a></li>
                                                <li class="second-sub-link"><a href="/products/reactive-ddos-services">Reactive Distributed Denial of Service Defense</a></li>
                                                <li class="second-sub-link"><a href="/products/premises-based-firewall">Premises Based Firewalls</a></li>
                                                <li class="second-sub-link"><a href="/categories/network-security">View All</a></li>
                                            </ul>
                                            <ul class="list-unstyled">
                                                <li class="second-sub-heading">Threat Detection</li>
                                                <li class="second-sub-link"><a href="/products/managed-threat-detection-and-response">Managed Threat Detection and Response</a></li>
                                                <li class="second-sub-link"><a href="/products/incident-response">Incident Response and Forensics</a></li>
                                            </ul>
                                            <ul class="list-unstyled">
                                                <li class="second-sub-heading">Endpoint Security</li>
                                                <li class="second-sub-link"><a href="/products/sentinel-one">SentinelOne</a></li>
                                                <li class="second-sub-link"><a href="/products/mobile-iron">MobileIron</a></li>
                                                <li class="second-sub-link"><a href="/products/lookout">Lookout Mobile Endpoint Security</a></li>
                                            </ul>

                                        </div>
                                        <div class="mobile-subnav">
                                            <ul class="list-unstyled sub-nav">
												<li class="second-sub-link"><a href="/products/secure-web-gateway">Secure Web Gateway</a></li>
												<li class="second-sub-link"><a href="/products/secure-remote-access">Secure Remote Access</a></li>
                                                <li class="second-sub-link"><a href="/products/sase-branch-with-fortinet">SASE Branch with Fortinet</a></li>
                                                <li class="second-sub-link"><a href="/products/reactive-ddos-services">Reactive Distributed Denial of Service Defense</a></li>
                                                <li class="second-sub-link"><a href="/products/premises-based-firewall">Premises Based Firewalls</a></li>
                                                <li class="second-sub-link"><a href="/products/managed-threat-detection-and-response">Managed Threat Detection and Response</a></li>
                                                <li class="second-sub-link"><a href="/products/incident-response">Incident Response and Forensics</a></li>
                                                <li class="second-sub-link"><a href="/products/sentinel-one">SentinelOne</a></li>
                                                <li class="second-sub-link"><a href="/products/mobile-iron">MobileIron</a></li>
                                                <li class="second-sub-link"><a href="/products/lookout">Lookout Mobile Endpoint Security</a></li>
                                            </ul>
                                        </div>
                                    </li>
									<li id="first-sub-network-security"><a href="/categories/network-security" class="first-level">Network Security</a>
										<div class="desktop-subnav">
											<ul class="list-unstyled">
												<li class="second-sub-heading">AT&T Trusted Internet Access</li>
												<li class="second-sub-link"><a href="/products/secure-web-gateway">Secure Web Gateway</a></li>
												<li class="second-sub-link"><a href="/products/secure-remote-access">Secure Remote Access</a></li>
												<li class="second-sub-link"><a href="/products/network-based-firewall">Network Based Firewalls</a></li>
												<li class="second-sub-link"><a href="/products/premises-based-firewall">Premises Based Firewalls</a></li>
												<li class="second-sub-link"><a href="/products/enhanced-access-security">Enhanced Cybersecurity Services</a></li>
											</ul>
											<ul class="list-unstyled">
												<li class="second-sub-heading">AT&T Infrastructure and Application Protection</li>
												<li class="second-sub-link"><a href="/products/reactive-ddos-services">Reactive Distributed Denial of Service Defense</a></li>
												<li class="second-sub-link"><a href="/products/application-layer-security">AT&T Application Layer Security</a></li>
											</ul>
										</div>
										<div class="mobile-subnav">
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">AT&T Trusted Internet Access</li>
												<li class="second-sub-link"><a href="/products/secure-web-gateway">Secure Web Gateway</a></li>
												<li class="second-sub-link"><a href="/products/secure-remote-access">Secure Remote Access</a></li>
												<li class="second-sub-link"><a href="/products/network-based-firewall">Network Based Firewalls</a></li>
												<li class="second-sub-link"><a href="/products/premises-based-firewall">Premises Based Firewalls</a></li>
												<li class="second-sub-link"><a href="/products/enhanced-access-security">Enhanced Cybersecurity Services</a></li>

												<li class="second-sub-heading">AT&T Infrastructure and Application Protection</li>
												<li class="second-sub-link"><a href="/products/reactive-ddos-services">Reactive Distributed Denial of Service Defense</a></li>
												<li class="second-sub-link"><a href="/products/application-layer-security">AT&T Application Layer Security</a></li>
											</ul>
										</div>
									</li>
									<li id="first-sub-unified-endpoint"><a href="/categories/endpoint-security" class="first-level">Endpoint Security</a>
										<div class="desktop-subnav">
											<ul class="list-unstyled">
												<li class="second-sub-heading">Endpoint Security</li>
												<li class="second-sub-link"><a href="/products/sentinel-one">SentinelOne</a></li>
												<li class="second-sub-link"><a href="/products/mobile-iron">MobileIron</a></li>
												<li class="second-sub-link"><a href="/products/vmware">VMware Workspace ONE®</a></li>
												<li class="second-sub-link"><a href="/products/ibm-maas360">IBM MaaS360</a></li>
												<li class="second-sub-link"><a href="/products/lookout">Lookout Mobile Endpoint Security</a></li>
												<li class="second-sub-link"><a href="/products/mcafee-endpoint-protection">McAfee Endpoint Protection</a></li>
											</ul>
										</div>
										<div class="mobile-subnav">
											<ul class="list-unstyled sub-nav">
													<li class="second-sub-link"><a href="/products/sentinel-one">SentinelOne</a></li>
													<li class="second-sub-link"><a href="/products/mobile-iron">MobileIron</a></li>
													<li class="second-sub-link"><a href="/products/vmware">VMware Workspace ONE®</a></li>
													<li class="second-sub-link"><a href="/products/ibm-maas360">IBM MaaS360</a></li>
													<li class="second-sub-link"><a href="/products/lookout">Lookout Mobile Endpoint Security</a></li>
													<li class="second-sub-link"><a href="/products/mcafee-endpoint-protection">McAfee Endpoint Protection</a></li>
											</ul>
										</div>
									</li>
									<li id="first-sub-threat-detection-response"><a href="/categories/threat-detection-and-response" class="first-level">Threat Detection and Response</a>
										<div class="desktop-subnav">
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">Strategy, Assessment and Planning</li>
												<li class="second-sub-link"><a href="/products/incident-response">Incident Response and Forensics</a></li>
											</ul>
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">AT&T Threat Solutions</li>
												<li class="second-sub-link"><a href="/products/managed-threat-detection-and-response">Managed Threat Detection and Response</a></li>
												<li class="second-sub-link"><a href="/products/threat-detection-and-responses-for-government">Threat Detection and Response for Government</a></li>
												<li class="second-sub-link"><a href="/products/usm-anywhere">USM Anywhere</a></li>
												<li class="second-sub-link"><a href="/products/usm-anywhere-advisors">USM Anywhere Advisors</a></li>
												<li class="second-sub-link"><a href="/products/usm-for-mssp">USM for MSSPs</a></li>
											</ul>
											
											<div id="products-tdr-menu-image">
												<a href="/alien-labs">
													<img src="https://cdn-cybersecurity.att.com/images/uploads/icons/alien-labs.svg" alt="">
													<p >Powered by<br>AT&amp;T Alien Labs</p>
												</a>
											</div>
										</div>
										<div class="mobile-subnav">
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">Strategy, Assessment and Planning</li>
												<li class="second-sub-link"><a href="/products/incident-response">Incident Response and Forensics</a></li>

												<li class="second-sub-heading">AT&T Threat Solutions</li>
												<li class="second-sub-link"><a href="/products/managed-threat-detection-and-response">Managed Threat Detection and Response</a></li>
												<li class="second-sub-link"><a href="/products/threat-detection-and-responses-for-government">Threat Detection and Response for Government</a></li>

												<li class="second-sub-link"><a href="/products/usm-anywhere">USM Anywhere</a></li>
												<li class="second-sub-link"><a href="/products/usm-anywhere-advisors">USM Anywhere Advisors</a></li>
												<li class="second-sub-link"><a href="/products/usm-for-mssp">USM for MSSPs</a></li>

												</ul>
										</div>
									</li>

							</ul>
						</div>
						<!--<div class="dd-bottom visible-lg" id="view-all-products">
							<div class="container-fluid">
								<a href="/products">
									<span class="view-all-text">View All Products &LongRightArrow;</span>
								</a>
							</div>
						</div>-->
					</div>
				</li>
				<li class="nav-item has-dd solutions">
					<a id="main-nav-solutions" href="/solutions" class="dropdown-toggle" data-toggle="collapse" role="button" aria-expanded="false" data-target="#solutions-dd">Solutions<span class="glyphicon glyphicon-chevron-up"></span><span class="glyphicon glyphicon-chevron-down"></span></a>
					<div class="nav-dropdown collapse" id="solutions-dd">
						<div class="dd-multi-col container-fluid">
							<ul class="list-unstyled sub-nav hidden-md hidden-lg">
								<li><a id="main-nav-see-all-solutions-mobile" href="/solutions" class="header_nav_link">See All Solutions</a></li>
							</ul>
							<div id="compliance">
								<div class="menu-header">Compliance</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/solutions/it-compliance-management">Overview</a></li>
									<li><a href="/solutions/gdpr-compliance">GDPR</a></li>
									<li><a href="/solutions/hipaa-compliance">HIPAA</a></li>
									<li><a href="/solutions/iso-27001-compliance">ISO 27001</a></li>
									<li><a href="/solutions/pci-dss-compliance">PCI DSS</a></li>
									<li><a href="/solutions/soc-2-compliance">SOC 2</a></li>
								</ul>
							</div>
							<div id="industry">
								<div class="menu-header">Industry</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/solutions/education">Education</a></li>
									<li><a href="/solutions/energy-sector-security">Energy Sector</a></li>
									<li><a href="/solutions/government">Federal</a></li>
									<li><a href="/solutions/financial-services">Financial Services</a></li>
									<li><a href="/solutions/healthcare">Healthcare</a></li>
									<li><a href="/solutions/manufacturing">Manufacturing</a></li>
									<li><a href="/partners/mssp-program">MSSPs</a></li>
									<li><a href="/solutions/retail">Retail</a></li>
								</ul>
							</div>
							<div id="environment">
								<div class="menu-header">Environment</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/solutions/aws-security-and-compliance-management">AWS</a></li>
									<li><a href="/solutions/azure-security-and-compliance-management">Azure</a></li>
									<li><a href="/solutions/cloud-security">Cloud</a></li>
									<li><a href="/solutions/iot-and-mobility-security">IOT/Mobility</a></li>
									<li><a href="/solutions/hybrid-cloud-security">Hybrid</a></li>
									<li><a href="/solutions/network-security">Network</a></li>
									<li><a href="/solutions/remote-workforce-security">Remote Workforce</a></li>

								</ul>
							</div>
							<div id="core-capabilities">
								<div class="menu-header">Security Use Cases</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/solutions/asset-discovery-inventory">Asset Discovery</a></li>
									<li><a href="/solutions/endpoint-detection-and-response">Endpoint Detection &amp; Response</a></li>
									<li><a href="/solutions/intrusion-detection-system">Intrusion Detection</a></li>
									<li><a href="/solutions/secure-access-service-edge">Secure Access Service Edge</a></li>
									<li><a href="/solutions/secure-web-gateway">Secure Web Gateway</a></li>
									<li><a href="/solutions/siem-platform-solutions ">SIEM Platform Solutions</a></li>
									<li><a href="/solutions/threat-detection">Threat Detection</a></li>
									<li><a href="/solutions/threat-intelligence">Threat Intelligence</a></li>
									<li><a href="/solutions/zero-trust-architecture">Zero Trust Architecture</a></li>

								</ul>
							</div>
						</div>
						<div class="dd-bottom visible-lg" id="view-all-solutions">
							<div class="container-fluid">
								<a href="/solutions">
									<span class="view-all-text">View All Solutions &LongRightArrow;</span>
								</a>
							</div>
						</div>
					</div>
				</li>
				<li class="nav-item partners">
					<a id="main-nav-partners" href="/partners" class="dropdown-toggle" role="button" aria-expanded="false" data-target="#partners-dd">Partners</a>
					<div class="nav-dropdown collapse visible-lg" id="partners-dd">
						<div class="dd-multi-col container-fluid">
							<div id="become-a-partner">
								<div class="menu-header">Become a Partner</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/partners">All Partner Programs</a></li>
									<li><a href="/partners/mssp-program">MSSP Program</a></li>
									<li><a href="/partners/resellers">Reseller Program</a></li>
									<li><a href="/partners/partner-portal/">Partner Portal Login</a></li>
								</ul>
							</div>

							<div id="find-a-partner">
								<div class="menu-header">Find a Partner</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/partners/find-partner">Find an MSSP</a></li>
									<li><a href="/partners/locator">Find a Reseller</a></li>
									<li><a href="/partners/certified-implementation-partners">Professional Services</a></li>
								</ul>
							</div>
							<div id="technology-partners">
								<div class="menu-header">Technology Partners</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/app">USM Anywhere Integrations</a></li>
									<li><a href="/partners/technology-partners">OTX Partners</a></li>
								</ul>
							</div>
						</div>
						<div class="dd-bottom visible-lg" id="view-all-partners">
							<div class="container-fluid">
								<a href="/partners/become-a-partner">
									<span class="view-all-text">Become a Partner &LongRightArrow;</span>
								</a>
							</div>
						</div>
					</div>
				</li>
				<li class="nav-item has-dd resources">
					<a id="main-nav-resources" href="/resource-center#language_en" class="dropdown-toggle" data-toggle="collapse" role="button" aria-expanded="false" data-target="#resources-dd">Resources<span class="glyphicon glyphicon-chevron-up"></span><span class="glyphicon glyphicon-chevron-down"></span></a>
					<div class="nav-dropdown collapse" id="resources-dd">
						<div class="dd-multi-col container-fluid">

							<div id="resources-menu-image" class="visible-lg">
								<img src="https://cdn-cybersecurity.att.com/images/uploads/thehub-thumbnail.jpg">
								<p>Explore The Hub, our home for all virtual experiences</p>
								<a href="https://hub.att.com/expo-hall/cybersecurity/">Explore now ⟶</a>
							</div>

							<ul class="list-unstyled sub-nav hidden-md hidden-lg">
								<li><a id="main-nav-resources-mobile" href="/resource-center#language_en">View All Resources</a></li>

							</ul>

							<div id="product-resources">
								<div class="menu-header">Product Resources</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/resource-center#content_customer-stories">Customer Stories</a></li>
									<li><a href="/resource-center#content_product-brief">Product Briefs</a></li>
									<li><a href="/resource-center#content_product-demo">Product Demos</a></li>
									<li><a href="/resource-center#content_product-review">Product Reviews</a></li>
									<li><a href="/resource-center#content_solution-brief">Solution Briefs</a></li>
									<li><a href="/resource-center#content_use-cases">Use Cases</a></li>

									<li><a id="free-trial" href="/products/usm-anywhere/free-trial">Free Trial</a></li>
								</ul>
							</div>
							<div id="security-resources">
								<div class="menu-header">Security Resources</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/resource-center#content_analyst-reports">Analyst Reports</a></li>
									<li><a href="/blogs">Blogs</a></li>
									<li><a href="/resource-center#content_ebook">eBooks</a></li>
									<li><a href="/resource-center#content_video">Videos</a></li>
									<li><a href="/resource-center#content_webcast">Webcasts</a></li>
									<li><a href="/resource-center#content_white-paper">White Papers</a></li>
									<li><a href="/resource-center#content_industry-reports">Industry Reports</a></li>
								</ul>
							</div>
							<div id="customer-resources">
								<div class="menu-header">Customer Resources</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="https://success.alienvault.com/">Success Center</a></li>
									<li><a href="/certification">Certification</a></li>
									<li><a href="/customer-success">Customer Success</a></li>
									<li><a href="/documentation">Documentation</a></li>
									<li><a href="/partners/certified-implementation-partners">Professional Services</a></li>
									<li><a href="/support">Support Overview</a></li>
									<li><a href="/training">Training</a></li>
								</ul>
							</div>
							<div id="browse-by-topic">
								<div class="menu-header">Browse by Topic</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/resource-center#category_incident-response">Incident Response</a></li>
									<li><a href="/resource-center#category_intrusion-detection">Intrusion Detection</a></li>
									<li><a href="/resource-center#category_partner-mssp-reseller">Partner: MSSP &amp; Reseller</a></li>
									<li><a href="/resource-center#category_regulatory-compliance">Regulatory Compliance</a></li>
									<li><a href="/resource-center#category_soc">Security Operations Center</a></li>
									<li><a href="/resource-center#category_siem-log-management">SIEM &amp; Log Management </a></li>
									<li><a href="/resource-center#category_threat-detection">Threat Detection</a></li>
									<li><a href="/resource-center#category_threat-intelligence">Threat Intelligence</a></li>
								</ul>
							</div>
						</div>

						<div class="dd-bottom visible-lg" id="view-all-resources">
							<div class="container-fluid">
								<a href="/resource-center#language_en">
									<span class="view-all-text">View All Resources &LongRightArrow;</span>
								</a>
							</div>
						</div>

					</div>
				</li>
				<li class="nav-item alien-labs">
					<a id="main-nav-alien-labs" href="/alien-labs" class="">AT&T Alien Labs</a>
				</li>
				<li class="nav-item support visible-sm visible-xs">
					<a id="main-nav-support" href="/support">Support</a>
				</li>
			</ul>
		</nav>

	</div>

	<div class="container-fluid visible-md visible-lg">
		
		
			<a id="main-nav-free-tools" class="header-nav-btn btn margin-bottom10" href="/pricing/request-quote">Get price</a>
		


	</div>
</header>

						




			<main class="blog-detail">

				<div class="full-width-block top-content-width-bg" style="background-image: url('https://cdn-cybersecurity.att.com/blog-content/Blog-Images/hero/blog-hero-data-carving-2017.jpg'); background-position: top center; background-repeat: no-repeat; background-color: #000; background-size: 2500px 405px; min-height: 405px;">
					<div class="container-fluid">
						<div class="row rowPad">
							<div class="all-blogs-cta"><a href="/blogs">‹ ALL BLOGS</a></div>
							<div class="category-label">
								
									<a href="/blogs/labs-research">Alien Labs</a>
								
							</div>
							<h1>AWS IAM security</h1>
							<div class="date">May 24, 2021 | <a href="/blogs/author/fmartinez">Fernando Martinez</a></div>
						</div>
					</div>
				</div>

				<section class="full-width-block">

					<div class="container-fluid">

						<div class="row flx-container">
							<div class="col-sm-8">
								<div class="blog-content-area">
									<h2>Executive summary</h2>

<p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html" target="_blank">AWS Policies</a> are a key foundation in good cloud security, but they are often overlooked. In this blog, we take a quick look on some AWS Policies, particularly for&nbsp;Identity and Access Management&nbsp;(IAM), that could become problematic if not properly managed. We&#39;ll discuss how they can be used against us to generate attacks like: Ransomware, data exfiltration, credential abuse, and more. Finally, we&#39;ll suggest some Open Source tools for cloud policy assessment and pentesting.&nbsp;&nbsp;</p>

<div>
<h2>Analysis</h2>
</div>

<p>The first step in achieving good security is having effective policies to regulate what can and cannot be done in an environment, both physical devices and cloud infrastructure. These regulatory policies are frequently hard to define and keep up-to-date, especially in a fast-paced environment using infrastructure-as-a-service (IaaS). This blog looks at some changes in policies&nbsp;which can reduce success in some common attack types involving: exfiltration, ransomware, credential abuse, and more. For that reason, <a href="https://cybersecurity.att.com/alien-labs" target="_blank">AT&amp;T Alien Labs</a> is sharing an easy &lsquo;what to look for&rsquo; list in order to detect some red flags in AWS policy changes. It is our hope that this&nbsp;list will be helpful&nbsp;for security analysts and forensic investigators.</p>

<p>Policies are <em>spoiler alert</em>, defined by AWS Policies, which define permissions for identities and resources. Every time&nbsp;<a href="https://aws.amazon.com/iam/" target="_blank">AWS Identity and Access Management</a> makes a request of any kind to a resource, a policy determines if the IAM is allowed or denied access to that specific resource under the policies for the involved parties.</p>

<p>A full understanding of AWS policies (types, creation, enforcement, etc.) is outside the scope of this&nbsp;blog, but it can be found in <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html" target="_blank">AWS documentation</a>.</p>

<p>People implementing AWS policies should have knowledge of the organization, adapting&nbsp;policies to needs of the business. Afterwards, detection rules should be generated&nbsp;for red flags in CloudTrail or other security tools. By doing this, we are avoiding policy changes in a generic manner, for example using &lsquo;*&rsquo; to cover the whole Principal without setting any Conditions to it (MFA, IP, usernames, etc.). The problem resides in changes occurring on a daily basis to the policies, which are often overlooked by analysts. The impact that these changes could have&nbsp;is as big as any other event or alert investigated.</p>

<p>In order to classify all AWS actions involving a policy change that could be used by attackers, we&rsquo;ll sort them based on the potential final attack type. Most of the following techniques would fall under <a href="https://attack.mitre.org/techniques/T1578/002/" target="_blank">Modify Cloud Compute Infrastructure</a> (T1578) but we have attempted to classify them outside of their specific Cloud technique - as if the activity was happening in a traditional environment.</p>

<div>
<h2>Denial of Service (DoS)</h2>
</div>

<p><a href="https://attack.mitre.org/techniques/T1499/" target="_blank">Endpoint Denial of Service </a>(T1499): Adversaries may perform Endpoint DoS attacks to degrade or block the availability of services to users. This blockage could be used as an additional impact on top of <a href="https://attack.mitre.org/techniques/T1486/" target="_blank">Data Encrypted for Impact </a>(T1486) to avoid or slow down&nbsp;recovery efforts in a ransomware attack. In this scenario, attackers could be trying to block access to several AWS resources like: S3, EC2 through EFS or EBS, or backups between others.</p>

<p><a href="https://aws.amazon.com/s3/" target="_blank"><b>S3</b></a>: Amazon&rsquo;s storage service can suffer a DoS by adding policies that block access to its contents. Buckets and Access Points are both S3 resources that could be impacted by an excessively restrictive policy or access control list (<a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html" target="_blank">ACL</a>), hence their relevance.</p>

<p>Detection Guidance:</p>

<table style="border-collapse:collapse">
	<tbody>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:2px solid black; width:141px">
			<p>Event/command:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:2px solid black; width:483px">
			<p>PutAccessPointPolicy or PutBucketPolicy or PutBucketACL or PutObjectAcl</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>Effect:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>Deny</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>Action:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>s3:* or s3-outposts:*</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>GuardDuty alert:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>Policy:S3/AccountBlockPublicAccessDisabled or Policy:S3/BucketBlockPublicAccessDisabled (previously known as Policy:IAMUser/S3BlockPublicAccessDisabled)</p>
			</td>
		</tr>
	</tbody>
</table>

<p>Additionally, the events DeleteAccessPointPolicy or DeleteBucketPolicy would have a similar effect, since they would be removing the policies where the public access is allowed.</p>

<p>Detection Guidance:</p>

<table style="border-collapse:collapse">
	<tbody>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:2px solid black; width:138px">
			<p>Event/command:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:2px solid black; width:486px">
			<p>DeleteAccessPointPolicy or DeleteBucketPolicy</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:138px">
			<p>GuardDuty alert:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:486px">
			<p>Policy:S3/AccountBlockPublicAccessDisabled or Policy:S3/BucketBlockPublicAccessDisabled (previously known as Policy:IAMUser/S3BlockPublicAccessDisabled)</p>
			</td>
		</tr>
	</tbody>
</table>

<p>In a similar situation, <a href="https://aws.amazon.com/efs/" target="_blank"><b>Amazon&rsquo;s Elastic File System</b></a> (<b>EFS</b>): any policy change denying access to this storage solution&nbsp;could also lead to a DoS. Due to this, these&nbsp;events and resource policies should be closely observed.</p>

<p>Detection Guidance:</p>

<table style="border-collapse:collapse">
	<tbody>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:2px solid black; width:133px">
			<p>Event/command</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:2px solid black; width:491px">
			<p>PutFileSystemPolicy</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:133px">
			<p>Effect</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:491px">
			<p>Deny</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:133px">
			<p>Action</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:491px">
			<p>elasticfilesystem:ClientMount or elasticfilesystem:ClientWrite</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:133px">
			<p>GuardDuty alert</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:491px">
			<p>-</p>
			</td>
		</tr>
	</tbody>
</table>

<h2>Log Removal</h2>

<p><a href="https://attack.mitre.org/techniques/T1070/" target="_blank">Indicator Removal on Host</a> (T1070): Adversaries may delete or alter generated artifacts on a host system, including logs or captured files, such as quarantined malware. In this case, removed indicators not only affect the host, but the whole cloud and the log ingestion platform in charge of generating alerts. The main affected resource is <a href="https://aws.amazon.com/cloudwatch/" target="_blank">CloudWatch</a>, but there are others too.</p>

<p><b>CloudWatch </b>is&nbsp;the monitoring service for AWS resources&nbsp;tracks logs coming from different resources and accounts in AWS. Blocking the logging access to resources would have a similar effect as deleting logs in a traditional computer.</p>

<p>PutResourcePolicy gives permission for other AWS services to put log events to the current account. A new policy with Effect Deny on all&nbsp;could avoid resources logging on their expected log file, and delay alerting on a detection. Additionally, PutDestinationPolicy has a similar&nbsp;behavior - it has the capability of creating an access policy for existing log destinations. A restrictive policy could lead to a logs not being in the expected log location. In this case, PutResourcePolicy API or CLI does not allow specifying * as the Principal, and each sender account must be listed separately in the policy.</p>

<p>Several GuardDuty finding types could notify of any policy log tampering that could impact detection of indicators.</p>

<p>Detection Guidance:</p>

<table style="border-collapse:collapse">
	<tbody>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:2px solid black; width:141px">
			<p>Event/command:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:2px solid black; width:483px">
			<p>PutResourcePolicy or PutDestinationPolicy</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>Effect:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>Deny</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>Action:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>logs:*</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>GuardDuty alert:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>Stealth:S3/ServerAccessLoggingDisabled or</p>

			<p>Stealth:IAMUser/CloudTrailLoggingDisabled or</p>

			<p>Stealth:IAMUser/LoggingConfigurationModified</p>
			</td>
		</tr>
	</tbody>
</table>

<p>Other log events could be of relevance, like PutRetentionPolicy, but none of their effects would be as drastic as the previously mentioned or are not strictly determined by policies.</p>

<h2>Ransomware</h2>

<p><a href="https://attack.mitre.org/techniques/T1490/" target="_blank">Inhibit System Recovery</a> (T1490): blocking access to the backups or modifying permissions to delete them, most likely with ransomware intentions.</p>

<p><b>EFS</b> offers an automatic Backup System through the command PutBackupPolicy, which could be disabled in a ransomware scenario causing slower recovery efforts.</p>

<p>Detection Guidance:</p>

<table style="border-collapse:collapse">
	<tbody>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:2px solid black; width:141px">
			<p>Event/command:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:2px solid black; width:483px">
			<p>PutBackupPolicy</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>Status:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>DISABLED</p>
			</td>
		</tr>
	</tbody>
</table>

<p><b>Backups</b>: AWS offers several solutions for backing up systems (as we have already seen with the EFS solution). Looking into the AWS Backup official solution and disabling it or removing permissions to access them has the direct impact of a DoS, and aggravates the ransomware scenario.</p>

<p>Detection Guidance:</p>

<table style="border-collapse:collapse">
	<tbody>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:2px solid black; height:28px; width:123px">
			<p>Event/command:</p>
			</td>
			<td colspan="2" style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:2px solid black; height:28px; width:500px">
			<p>PutBackupVaultAccessPolicy</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:123px">
			<p>Effect:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:228px">
			<p>Deny</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:272px">
			<p>Allow</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:123px">
			<p>Action:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:228px">
			<p>Backup:*</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:272px">
			<p>Backup:Delete*</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; height:28px; width:123px">
			<p>GuardDuty alert:</p>
			</td>
			<td colspan="2" style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; height:28px; width:500px">
			<p>-</p>
			</td>
		</tr>
	</tbody>
</table>

<h2>Exfiltration</h2>

<p><a href="https://attack.mitre.org/techniques/T1567/" target="_blank">Exfiltration Over Web Service</a> (T1567): exposes current resources to the Internet with the intention of exfiltrating data outside of the organization.</p>

<p><b>S3</b>: As we saw in the DoS section, a change in policies could remove public Internet access to a Bucket or Access Point. In this situation we are looking at the opposite scenario, a private S3 being made public to leverage it for exfiltration purposes.</p>

<p>Detection Guidance:</p>

<table style="border-collapse:collapse">
	<tbody>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:2px solid black; width:141px">
			<p>Event/command:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:2px solid black; width:483px">
			<p>PutAccessPointPolicy or PutBucketPolicy or PutBucketACL or PutObjectAcl</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>Effect:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>Allow</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>Action:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>s3:* or s3-outposts:*</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>GuardDuty alert:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>Policy:S3/BucketPublicAccessGranted or Policy:S3/BucketAnonymousAccessGranted</p>
			</td>
		</tr>
	</tbody>
</table>

<p><a href="https://www.elastic.co/" target="_blank"><b>Elasticsearch</b></a>: If the domain associated with an Elasticsearch instance is public, an attacker could modify any existing condition, like IP addresses&nbsp;or command restrictions - to increase the actions that can be performed on this public domain. AWS does not have a specific command to modify its Access Policies for Elasticsearch, but they can be modified from the user interface or the API through the Domain Config, on an individual domain basis.</p>

<p>Detection Guidance:</p>

<table style="border-collapse:collapse">
	<tbody>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:2px solid black; width:141px">
			<p>Event/command:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:2px solid black; width:483px">
			<p>PutResourcePolicy</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>Effect:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>Allow</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>Action:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>es:* (in particular es:UpdateElasticsearchDomainConfig)</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>GuardDuty alert:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>-</p>
			</td>
		</tr>
	</tbody>
</table>

<p>Attackers could also create a new Elasticsearch domain and include the above-mentioned policies. It is outside the scope of this blog to discuss&nbsp;operations involving new resources to exfiltrate data (Elasticsearch, S3, EFS, etc.). This attack would become noisier, since it involves creating new resources, applying the mentioned policies, and copying any relevant data to these resources. Just for reference, this attack would classify as <a href="https://attack.mitre.org/techniques/T1537/" target="_blank">Transfer Data to Cloud Account</a> (T1537).</p>

<p><b><a href="https://aws.amazon.com/ecr/" target="_blank">Elastic Container Registry</a> (ECR)</b>: provides the capability to store Docker containers and have them ready for deployment. This deployment availability can also be turned around and be used for exfiltration by&nbsp;downloading docker containers from a pre-signed Amazon S3 download URL. This privilege can be obtained by modifying the SetRepositoryPolicy for the corresponding ECR and allowing the action GetDownloadUrlForLayer to access it externally.</p>

<p>Detection Guidance:</p>

<table style="border-collapse:collapse">
	<tbody>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:2px solid black; width:141px">
			<p>Event/command:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:2px solid black; width:483px">
			<p>SetRepositoryPolicy or PutRepositoryPolicy</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>Effect:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>Allow</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>Action:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>ecr:GetDownloadUrlForLayer</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>GuardDuty alert:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>-</p>
			</td>
		</tr>
	</tbody>
</table>

<h2>Credential Access</h2>

<p><a href="https://attack.mitre.org/techniques/T1003/" target="_blank">OS Credential Dumping </a>(T1003): uses a lack of security to dump credentials either encrypted, hashed or in clear text, to use them later in towards lateral movement or accessing confidential information.</p>

<p><a href="https://aws.amazon.com/secrets-manager/" target="_blank"><b>AWS Secrets Manager</b></a> is a great example of a target for a Credential Access scenario. The secrets in this vault need to be accessed by internal or external resources eventually, and a bad security policy might allow an attacker to take those credentials. These might be encrypted with a KMS key, but attackers would still be one step closer to their their goal.</p>

<p>An escalation of privileges (or decrease in security) could be achieved through the PutResourcePolicy for SecretsManager. An excess of allowed privileges could make credential access easier.</p>

<p>Detection Guidance:</p>

<table style="border-collapse:collapse">
	<tbody>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:2px solid black; width:141px">
			<p>Event/command:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:2px solid black; width:483px">
			<p>PutResourcePolicy</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>Effect:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>Allow</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>Action:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>secretsmanager:* (in particular GetSecretValue)</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>GuardDuty alert:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>-</p>
			</td>
		</tr>
	</tbody>
</table>

<p><b><a href="https://aws.amazon.com/kms/" target="_blank">AWS Key Management Service </a>(KMS)</b>: is Amazon&rsquo;s key manager to control what users and applications have access to certain cryptographic keys. Access to these keys is, as you can expect at this point of the blog, given by a specific policy. Changes made to this policy can enable&nbsp;several different attacks (like a DoS if access is denied to all users), but in this case we are looking at a too permissive policy set with PutKeyPolicy.</p>

<p>Detection Guidance:</p>

<table style="border-collapse:collapse">
	<tbody>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:2px solid black; width:141px">
			<p>Event/command:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:2px solid black; width:483px">
			<p>PutResourcePolicy</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>Effect:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>Allow</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>Action:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>kms:PutKeyPolicy</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:2px solid black; border-left:2px solid black; border-right:2px solid black; border-top:none; width:141px">
			<p>GuardDuty alert:</p>
			</td>
			<td style="border-bottom:2px solid black; border-left:none; border-right:2px solid black; border-top:none; width:483px">
			<p>-</p>
			</td>
		</tr>
	</tbody>
</table>

<p>In addition to the already mentioned events and AWS resources, there are others that could be leveraged by attackers, but these fall out of the scope of this blog to keep it a&nbsp;reasonable length. Just to mention some of these - they would be: Amazon Simple Queue Service (SQS) through sqs:AddPermission, Amazon Simple Notification Service (Amazon SNS) through sns:AddPermission, AWS Elemental MediaStore through PutContainerPolicy, AWS Lambda through lambda:AddPermission, etc.</p>

<div>
<h2>Pentesting tools</h2>
</div>

<p>After analyzing some of the most relevant policy changes impacting the cloud environment&rsquo;s security in your organization, we&rsquo;ll take a look at some of the AWS penetration testing tools available for free, and how they use&nbsp;policies.</p>

<h3>AWS IAM Access Analyzer</h3>

<p>AWS offers an Access Analyzer capable of assessing existing resource-based policies, and focuses on identifying any resources shared with external entities. Amazon refers to an external entity as any other AWS account, root user, IAM user or role, federated user, AWS service, anonymous user, or other entity.</p>

<p>It is a great resource for some critical resources like S3, KMS or SecretManager. However, it lacks coverage to other resources that could be as important, like Elasticsearch domains or CloudWatch resource policies.</p>

<h3>Endgame</h3>

<p>This free cloud pentesting tool provides a deep test of existing policies in AWS. The only prerequisite is an AWS API credential with privileges to update resource policies. It is capable of running in &lsquo;expose&rsquo; mode, modifying just the necessary resources to achieve a BackDoor, or &lsquo;smash&rsquo; mode, revealing potential security concerns by: enumerating resources, reading and modifying current policies, and finally implanting as many BackDoors as possible through weaknesses in the victim&rsquo;s IAM security policies.</p>

<p>It offers approximately 30% more coverage than AWS IAM Access Analyzer, including coverage for:</p>

<ul>
	<li>ACM private CAs</li>
	<li>CloudWatch Resource Policies</li>
	<li>EBS Volume Snapshots</li>
	<li>EC2 AMIs</li>
	<li>ECR Container Repositories</li>
	<li>EFS File Systems</li>
	<li>ElasticSearch Domains</li>
	<li>Glacier Vault Access Policies</li>
	<li>IAM roles</li>
	<li>KMS keys</li>
	<li>Lamda functions</li>
	<li>Lambda layers</li>
	<li>RDS Snapshots</li>
	<li>S3 Buckets</li>
	<li>Secrets Manager Secrets</li>
	<li>SQS Queues</li>
	<li>SNS Topics</li>
</ul>

<p>In the full list of policies required to achieve all the BackDoors included with the tool, we can see some policies already mentioned in this blog: ecr:SetRepositoryPolicy, elasticfilesystem:PutFileSystemPolicy, es:UpdateElasticsearchDomainConfig, kms:PutKeyPolicy, lambda:AddPermission, logs:PutResourcePolicy, s3:PutBucketPolicy, secretsmanager:PutResourcePolicy.</p>

<h3>Cloudsplaining</h3>

<p>Cloudsplaining performs a deep assessment on all the AWS IAM security policies and identifies violations of least privilege, producing a full HTML report. The report includes triage items as well as remediation indications, offering the user a very helpful resource to analyze their current configuration and offering improvement possibilities.</p>

<h3>Hacking the cloud</h3>

<p>Hacking the cloud is an online encyclopedia supported by volunteers. The webpage contains a list of attacks/tactics/techniques that offensive security professionals can use to pentest their cloud environments. The attacks are not very policy focused, but it does use them in some attacks, like in the &ldquo;Unauthenticated Enumeration of IAM Users and Roles&rdquo;, which is present in Pacu too.</p>

<p>There are many other open source useful tools for cloud pentesting or policy assessment, like: Parliament, Pacu, PMapper, Repokid, Policy Sentry.</p>

<h2>Conclusion</h2>

<p>In this blog we have seen several attacks&nbsp;that&nbsp;could be performed using AWS policies - especially if they weren&rsquo;t properly set up. We&#39;ve discussed&nbsp;the&nbsp;importance of AWS policies as the foundation of a good cloud security. We have seen how GuardDuty detects some dangerous policy changes, but leaves out many others that can only be detected through constantly reviewing&nbsp;Cloudtrail logs. The pentesting tools seen in the blog can help detect holes in the policies. An alternative solution is the use of SIEMs like <a href="https://cybersecurity.att.com/products/usm-anywhere" target="_blank">USM Anywhere</a>, with specific detection rules added on a daily basis, thanks to the threat content that the <a href="https://cybersecurity.att.com/alien-labs" target="_blank">AT&amp;T Alien Labs</a> team adds to the USM Anywhere platform.</p>

<h3>Resources</h3>

<p>AWS Policies: <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html" target="_blank">https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html</a></p>

<p>Endgame: <a href="https://endgame.readthedocs.io/en/latest" target="_blank">https://endgame.readthedocs.io/en/latest</a></p>

<p>Cloudsplaining: <a href="https://github.com/salesforce/cloudsplaining" target="_blank">https://github.com/salesforce/cloudsplaining</a></p>

<p>Hacking the cloud: <a href="https://hackingthe.cloud/aws/general-knowledge/connection-tracking/" target="_blank">https://hackingthe.cloud/aws/general-knowledge/connection-tracking/</a></p>

<p>Parliament: <a href="https://github.com/duo-labs/parliament" target="_blank">https://github.com/duo-labs/parliament</a></p>

<p>Pacu: <a href="https://rhinosecuritylabs.com/aws/pacu-open-source-aws-exploitation-framework/" target="_blank">https://rhinosecuritylabs.com/aws/pacu-open-source-aws-exploitation-framework/</a></p>

<p>PMapper: <a href="https://github.com/nccgroup/PMapper" target="_blank">https://github.com/nccgroup/PMapper</a></p>

<p>Repokid: <a href="https://github.com/Netflix/repokid" target="_blank">https://github.com/Netflix/repokid</a></p>

<p>Policy Sentry: <a href="https://github.com/salesforce/policy_sentry/" target="_blank">https://github.com/salesforce/policy_sentry/</a></p>

<h2>Mapping to MITRE ATT&amp;CK</h2>

<p>The findings of this report are mapped to the following <a href="https://attack.mitre.org/" target="_blank">MITRE ATT&amp;CK Matrix</a> techniques:</p>

<ul>
	<li>TA0005: Defense Evasion:
	<ul>
		<li><b>T1070</b>: Indicator Removal on Host</li>
		<li><b>T1078</b>: Valid Accounts</li>
		<li><b>T1578</b>: Modify Cloud Compute Infrastructure</li>
	</ul>
	</li>
	<li>TA0006: Credential Access
	<ul>
		<li><b>T1003</b>: OS Credential Dumping</li>
	</ul>
	</li>
	<li>TA0010: Exfiltration
	<ul>
		<li><b>T1537</b>: Transfer Data to Cloud Account</li>
		<li><b>T1567</b>: Exfiltration Over Web Service</li>
	</ul>
	</li>
	<li>TA0040: Impact
	<ul>
		<li><b>T1486: </b>Data Encrypted for Impact</li>
		<li><b>T1490</b>: Inhibit System Recovery</li>
		<li><b>T1499</b>: Endpoint Denial of Service</li>
	</ul>
	</li>
</ul>
									<div class="blog-related">
									<div class="be-ix-link-block"></div>
									</div>
								</div>
								<div class="blog-author">
									<a href="https://cybersecurity.att.com/blogs/author/fmartinez" class="blog-avatar">
									
										<img src="data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22150px%22%20height%3D%22150px%22%3E%3Crect%20fill%3D%22none%22%20width%3D%22150%22%20height%3D%22150%22%2F%3E%3C%2Fsvg%3E" data-original="/avatars/uploads/avatar_286_2.jpg" width="150" height="150" alt="Fernando Martinez" />
									
									</a>

									<div class="blog-author-info">
										<p><strong>About the Author:</strong> <span>Fernando Martinez</span></p>
										<p>Fernando Martinez is a Security Researcher working in AT&T Alien Labs team. Passionate about Security, running and coffee. Telecommunication Engineer, prior to working in Alien Labs, Fernando worked in Digital Forensics and Incident Response.</p>


										<p><a href="/blogs/author/fmartinez">Read more posts from Fernando Martinez ›</a></p>

									</div>
								</div>


								<div class="blog-categories">
								<p>TAGS: <a href="/blogs/tag/cloud+security" title="cloud security" rel="nofollow">cloud security</a>, <a href="/blogs/tag/ransomware" title="ransomware" rel="nofollow">ransomware</a>, <a href="/blogs/tag/attacks" title="attacks" rel="nofollow">attacks</a>, <a href="/blogs/tag/labs" title="labs" rel="nofollow">labs</a>, <a href="/blogs/tag/open+source" title="open source" rel="nofollow">open source</a>, <a href="/blogs/tag/iam" title="iam" rel="nofollow">iam</a>, <a href="/blogs/tag/aws+security" title="aws security" rel="nofollow">aws security</a>, <a href="/blogs/tag/aws+policy" title="aws policy" rel="nofollow">aws policy</</p>
								</div>


								<p><a href="https://cybersecurity.att.com/blogs/labs-research" class="back-to-all">‹ BACK TO ALL BLOGS</a></p>
							</div>
							
							<div class="col-sm-4">
								<div>
									<div class="blog-sidebar-block">
    <form id="searchbox_002748587151982842036:gharkgtx6cu" action="/search-results/blog" class="sidebar-search">
        <input value="002748587151982842036:gharkgtx6cu" name="cx" type="hidden" />
        <input value="FORID:11" name="cof" type="hidden" />
        <div class="search-button">
            <input value="Search" name="sa" type="submit" />
        </div>
        <div class="search-field">
            <input id="q" name="q" type="text" placeholder="Search our blogs" />
        </div>
    </form>
</div>

<div class="blog-subscribe-grid" id="blog-subscribe-box">

    <h2>Get the latest security news in your inbox.</h2>

    <p class="text-center"><a class="btn btn-blue digestoform" id="digestobutton" target="_blank">Subscribe via email</a></p>

    <script>window.addEventListener('DOMContentLoaded', function() { var href_string="https://pages.alienvault.com/Digesto.html"+get_cookie_url_string()+"&redirect=https://cybersecurity.att.com/forms/email-thank-you";document.getElementById("digestobutton").href=href_string;});</script>
</div>
<p style="text-align: right; margin: 30px 10px 5px 0;"><a href="http://feeds.feedblitz.com/alienvault-blogs" target="_blank"><img src="https://cdn-cybersecurity.att.com/images/uploads/icons/rss.svg" width="20" height="20" style="display: inline-block; margin: 0 7px 2px;">RSS</a>
</p>
									<div class="promo-block">
										
													
			<style type="text/css">#blog-promo-block-v2 .blog-promo-item-v2 {
    box-shadow: 1px 1px 5px #D2D2D229;
    border: 1px solid #D2D2D2;
    margin-bottom: 30px;
}
#blog-promo-block-v2 .blog-promo-item-v2 .blog-promo-resource-type-v2 {
    font-size: 14px;
    color: #0568AE;
    font-weight: 500;
    padding: 15px;
    margin: 0;
}
#blog-promo-block-v2 .blog-promo-item-v2 .blog-promo-item-text-v2 {
    margin-bottom:15px;
}
#blog-promo-block-v2 .blog-promo-item-v2 .blog-promo-item-text-v2 a {
    color: black;
    text-decoration: none;
    font-weight: 500;
}
#blog-promo-block-v2 .blog-promo-item-v2 .blog-promo-item-text-v2 p {
   margin: 0 15px;
}

#blog-promo-block-v2 .blog-promo-item-icon-v2 {
   margin: 15px;
   font-size: 16px;
}
#blog-promo-block-v2 .blog-promo-item-icon-v2 .icon-right {
    width: 20px;
    height: 20px;
    border: 1px solid #0568ae;
    border-radius: 20px;
    font-size: 9.5px;
    line-height: 18px;
    font-weight: 400;
    margin-right: 10px;
    padding-left: 4px;
    top: -1px;
}
@media (max-width: 1024px) {
 .blog-promo-item-v2 img {
    display: none;
  }
}
</style>
<div id="blog-promo-block-v2">
<h3>Featured resources</h3>

<div class="blog-promo-item-v2"><img src="https://cdn-cybersecurity.att.com/images/uploads/resource-images/5g-and-the-journey.jpg" />
<p class="blog-promo-resource-type-v2">INDUSTRY REPORT</p>

<div class="blog-promo-item-text-v2">
<p><a href="/resource-center/industry-reports/cybersecurity-insights-report-tenth-edition">AT&amp;T Cybersecurity Insights&trade; Report:<br />
5G and the Journey to the Edge</a></p>
</div>

<div class="blog-promo-item-icon-v2"><span aria-hidden="true" class="icon-right glyphicon glyphicon-chevron-right">&nbsp;</span> <a href="/resource-center/industry-reports/cybersecurity-insights-report-tenth-edition">Learn more</a></div>
</div>

<div class="blog-promo-item-v2"><img src="https://cdn-cybersecurity.att.com/images/uploads/resource-images/security-maturity-assessment.jpg" />
<p class="blog-promo-resource-type-v2">SELF ASSESSMENT</p>

<div class="blog-promo-item-text-v2">
<p><a href="/resource-center/security-maturity-assessment?utm_internal=blog-rail-assess">Benchmark your cybersecurity maturity</a></p>
</div>

<div class="blog-promo-item-icon-v2"><span aria-hidden="true" class="icon-right glyphicon glyphicon-chevron-right">&nbsp;</span> <a href="/resource-center/security-maturity-assessment?utm_internal=blog-rail-assess">Explore</a></div>
</div>
</div>
		
										

									</div>
								</div>
							</div>
						</div>
					</div>
				</section>


			</main>


			
			<style>

    /* Sticky button */
    .desktop .sticky_bottom_keeper {
        height: 80px;
    }
    .sticky_bottom_desktop.fixed {
        height: 80px;
    }
    .sticky_bottom_keeper .btn {
        color: #fff;
    }
    .sticky_bottom_keeper .btn-white {
        border: 2px solid #fff;
    }
    .sticky_bottom_keeper .btn-white.btn-border {
        background: transparent;
    }




    .line.line-8 {
        height: 8px;
    }

    .hh .sticky_bottom_keeper {
        display: none;
    }


</style>
<div class="sticky_bottom_keeper">

    <div class="sticky_bottom sticky_bottom_desktop ibp">
        <a href="/pricing/request-quote?utm_internal=sb_quote" class="btn btn-border btn-white btn-rounded btn-with-arrow">Get price</a>
        <a href="/products/usm-anywhere/free-trial?utm_internal=sb_freetrial_modal" class="btn btn-border btn-white btn-rounded btn-with-arrow">Free trial</a>

    </div>

</div>

			
		


		<footer id="footer" class="hidden-print">
  <div class="container-fluid">
    <div class="row">
      <div class="col-sm-6 col-md-3">
        
        <div class="footer_logo"><img src="data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22263px%22%20height%3D%2256px%22%3E%3Crect%20fill%3D%22none%22%20width%3D%22263%22%20height%3D%2257%22%2F%3E%3C%2Fsvg%3E" data-original="https://cdn-cybersecurity.att.com/images/uploads/logos/att_biz_hz_pref_rgb_white.png" alt="AT&T Business"></div>
        <div class="footer_featured">

          <div class="footer_featured_title">From the Blog</div>
          <article class="footer_featured_article">
            <div class="footer_featured_article_author clearfix">
	            
										<img src="data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22150px%22%20height%3D%22150px%22%3E%3Crect%20fill%3D%22none%22%20width%3D%22150%22%20height%3D%22150%22%2F%3E%3C%2Fsvg%3E" data-original="/avatars/uploads/avatar_286_2.jpg" width="150" height="150" alt="Fernando Martinez" />
									
              <div class="footer_featured_article_author_data">
                <h4>Fernando Martinez</h4>
                <time datetime="2021-05-24">May 24, 2021</time>
              </div>
            </div>
            <h3><a href="https://cybersecurity.att.com/blogs/labs-research/securing-aws-policies" id="footer-link-blog-post">AWS IAM security</a></h3>
          </article>
          <a id="footer-link-blog-all" href="/blogs" class="footer_featured_more">Explore All Blog Posts
            &#8250;</a>
        </div>
        

        <div class="social-style">
          <a href="https://www.twitter.com/attcyber/" class="social-link-twitter" target="_blank">Twitter</a>
          <a href="https://www.linkedin.com/company/attcybersecurity/" class="social-link-linkedin" target="_blank">Linkedin</a>
          <a href="https://www.facebook.com/ATTCyber/" class="social-link-facebook" target="_blank">Facebook</a>
          <a href="https://www.youtube.com/c/attcybersecurity" class="social-link-youtube" target="_blank">Youtube</a>
          <a href="https://www.instagram.com/attbusiness/" class="social-link-instagram" target="_blank">Instagram</a>
        </div>
      </div>

      <div class="col-sm-6 col-md-3">
        <div class="footer_links">
          <div class="heading">Who We Are</div>
          <ul>
            <li><a id="footer-link-labs" href="/alien-labs">Alien Labs</a></li>
            <li><a id="footer-link-customers" href="/who-we-are/customers">Customers</a></li>
            <li><a id="footer-link-careers" href="/who-we-are/careers">Careers</a></li>
            <li><a id="footer-link-contact" href="/contact">Contact Us</a></li>
          </ul>
        </div>

        <div class="footer_links">
          <div class="heading">News</div>
          <ul>
            <li><a id="footer-link-news-room" href="/who-we-are">Newsroom</a></li>
            <li><a id="footer-link-events" href="/who-we-are/events">Events</a></li>
            <li><a id="footer-link-blogs" href="/blogs">Blogs</a></li>
          </ul>
        </div>

        <div class="footer_links">
          <div class="heading">Partners</div>
          <ul>
            <li><a id="footer-link-partners" href="/partners">Partner Programs</a></li>
            <li><a id="footer-link-partner-portal" href="/partners/partner-portal/">Partner Portal</a></li>
          </ul>
        </div>
      </div>

      <div class="col-sm-6 col-md-3">
        <div class="footer_links">
          <div class="heading">Products</div>
          <ul>
		  	<li><a id="footer-link-mtdr" href="/products/managed-threat-detection-and-response">AT&T Managed Threat Detection and Response</a></li>
            <li><a id="footer-link-usm-anywhere" href="/products/usm-anywhere">USM Anywhere</a></li>
            <li><a id="footer-link-usm-mssp" href="/products/usm-for-mssp">USM for MSSPs</a></li>
            <li><a id="footer-link-otx" href="/open-threat-exchange">Open Threat Exchange (OTX)</a></li>
            <li><a id="footer-link-ossim" href="/products/ossim">OSSIM</a></li>

          </ul>
        </div>



        <div class="footer_links">
          <div class="heading">Solutions</div>
          <ul>
            <li><a id="footer-link-cloud-security" href="/solutions/cloud-security-monitoring">Cloud Security Monitoring</a></li>
            <li><a id="footer-link-threat-detection" href="/solutions/threat-detection">Threat Detection</a></li>
            <li><a id="footer-link-ids" href="/solutions/intrusion-detection-system">Intrusion Detection</a></li>
            <li><a id="footer-link-siem" href="/solutions/siem-platform-solutions">SIEM platform solutions</a></li>
            <li><a id="footer-link-vulnerability" href="/solutions/vulnerability-assessment-remediation">Vulnerability
                Assessment</a></li>
            <li><a id="footer-link-all-solutions" class="btn-with-arrow" href="/solutions">See All Solutions</a></li>
          </ul>
        </div>
      </div>

      <div class="col-sm-6 col-md-3">
        <div class="footer_links">
          <div class="heading">Resources</div>
          <ul>
            <li><a id="footer-link-resources" href="/resource-center">Resources</a></li>
            <li><a id="footer-link-blog" href="/blogs">Blogs</a></li>
            <li><a id="footer-link-reference-guide" href="https://www.business.att.com/content/dam/attbusiness/guides/att-information-and-network-security-customer-reference-guide.pdf" target="_blank">Customer Reference Guide</a></li>

          </ul>
        </div>

        <div class="footer_links">
          <div class="heading">Customer Success</div>
          <ul>
            <li><a id="footer-link-support" href="/support">Support &amp; Services</a></li>
            <li><a id="footer-link-customer-portal" href="https://success.alienvault.com" target="_blank">Success Center</a></li>
            <li><a id="footer-link-documentation" href="/documentation">Documentation Center</a></li>
            <li><a id="footer-link-classroom-training" href="/training">Training</a></li>
            <li><a id="footer-link-certification" href="/certification">Certification</a></li>
          </ul>
        </div>

        <div class="footer_contact">
          <a href="/contact" id="footer-button-contact" class="btn btn-blue margin-bottom20">Contact us</a>
        </div>
      </div>
    </div>
    <div class="footer_legal">
      <p class="footer_legal_copy">&copy; Copyright 2021</p>
      <ul class="footer_legal_links">
        <li><a id="footer-link-privacy" href="/legal/privacy-policy">Privacy Policy</a></li>
        <li><a id="footer-link-terms" href="/terms/website-terms-of-use07may2018">Website Terms of Use</a></li>
        <li><a id="footer-link-gdpr" href="/legal/gdpr">GDPR</a></li>
        <li><a id="footer-link-cookie" href="/legal/cookie-policy">Cookie Policy</a></li>
        <li><a id="footer-link-personal-info" href="https://about.att.com/csr/home/privacy/rights_choices.html" target="_blank">Do Not Sell My Personal Information</a></li>

      </ul>
    </div>
  </div>
</footer>

<div id="valid_content"></div>

		
	<script src="https://cdn-cybersecurity.att.com/js/v2/imports/blog-bundle.min.js?v=20210518514930" defer></script>






		



<div class="cookie-notice">
    <p>We use cookies to provide you with a great user experience. By using our website, you agree to our <a href="https://www.att.com/privacy">Privacy Policy</a> and <a href="/terms/website-terms-of-use07may2018">Website Terms of Use</a>.</p>
    <a class="cookie-notice-close" href="#" aria-label="Close Cookie Notice"><span class="glyphicon glyphicon-remove"></span></a>
</div>


<!-- WGT-10310 -->

<!-- END WGT-10310 -->




<script>
if (typeof ddo !== "undefined") {initAdobePageTrackingFooter();}

function initAdobePageTrackingFooter() {
    
    customAdobeTrackingPageLoadObj['page.pageInfo.pageTitle'] = document.title.trim();

    

    customAdobeTrackingPageLoadObj['page.pageInfo.friendlyPageName'] = 'CYB '+ document.title.trim() +' Pg';

    customAdobeTrackingPageLoadObj['page.pageInfo.language'] = 'EN';
    customAdobeTrackingPageLoadObj['page.pageInfo.lineOfBusiness'] = 'Business Solutions';
    customAdobeTrackingPageLoadObj['page.category.pageFunction'] = 'Learn';
    customAdobeTrackingPageLoadObj['page.category.pageOwnership'] = 'Business';
    customAdobeTrackingPageLoadObj['page.attributes.applicationName'] = 'CYB';
    customAdobeTrackingPageLoadObj['page.pageInfo.appCode'] = 'ACS';
    customAdobeTrackingPageLoadObj['page.category.siteSection'] = 'CYB';
    customAdobeTrackingPageLoadObj['page.category.siteSection'] = 'CYB';
    customAdobeTrackingPageLoadObj['page.media.class'] = 'Text';
    customAdobeTrackingPageLoadObj['page.media.objective'] = 'Awareness';
    customAdobeTrackingPageLoadObj['page.media.category'] = 'Security';
    customAdobeTrackingPageLoadObj['page.location.domain'] = window.location.hostname;
	ddo.pushEvent('pageLoad', 'Page_Load', customAdobeTrackingPageLoadObj);
}
</script>


		<script>
			window.addEventListener('DOMContentLoaded', function() {
				$(window).load(function () {
					var hideSubscribe = AV.Utilities.readCookie('stickyBlogSubscribe');
					// if the cookie hasn't been set...
					if (hideSubscribe == null) {
						setTimeout(function () {
							// make the modal appear
							$('#blog-subscribe-box').fadeIn();
						}, 10000);

						// when the "Close" button is clicked
						$('.blog-subscribe-close-btn').click(function (e) {
							e.preventDefault();
							// set the cookie
							AV.Utilities.setCookie('stickyBlogSubscribe', true, 1);
							$('#blog-subscribe-box').fadeOut();
						});
					}
				});
			});
		</script>

	<script type="text/javascript" >var _cf = _cf || [];  _cf.push(['_setFsp', true]);  _cf.push(['_setBm', true]);  _cf.push(['_setAu', '/libraries/5977d80deno2351e640f3d813f54263']); </script><script type="text/javascript"  src="/libraries/5977d80deno2351e640f3d813f54263"></script></body>
</html>
<!-- Debug: total time - 0.0021238327026367 -->