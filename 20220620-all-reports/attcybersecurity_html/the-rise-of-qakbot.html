<!DOCTYPE html>
<html lang="en">

<head>
	

	


	

	<!--trying to figure out the canonical url issue with blogs-->
	<link rel="canonical" href="https://cybersecurity.att.com/blogs/labs-research/the-rise-of-qakbot" />

	<title>The rise of QakBot | AT&T Alien Labs</title>

	

		

	<meta property="og:site_name" value="AT&T Cybersecurity" />
	<meta property="og:title" content="The rise of QakBot" />
	<meta property="og:url" content="https://cybersecurity.att.com/blogs/labs-research/the-rise-of-qakbot" />
	<meta property="og:image" content="https://cdn-cybersecurity.att.com/blog-content/Blog-Images/open-graph/malware-red-sphere-open-graph.jpg" />
	<meta property="og:description" content="This blog was jointly written with Ofer Caspi. Some of the links in this blog require an OTX account, and the QakBot infrastructure tracker will require readers to be customers with access to the Threat Intel subscription.. Thanks to the following researchers and the MalwareBazaar Project:


	@0verfl0w_&nbsp;&nbsp;
	@_alex_il_&nbsp;&nbsp;
	@malware_traffic&nbsp;&nbsp;
	@lazyactivist192&nbsp;&nbsp;
	@JAMESWT_MHT&nbsp;&nbsp;
	MalwareBazaar Project&nbsp;&nbsp;


Executive summary

AT&amp;T Alien La" />
		



	<meta charset="utf-8">

<link rel="preconnect" href="https://cdn-cybersecurity.att.com" />
<link rel="preconnect" href="https://www.att.com" />
<link rel="preconnect" href="https://www.googletagmanager.com" crossorigin />
<link rel="preconnect" href="https://cdn.vidyard.com" crossorigin />
<link rel="preconnect" href="https://ajax.cloudflare.com" crossorigin />
<link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin />
<link rel="preconnect" href="https://googleads.g.doubleclick.net" crossorigin />
<link rel="preconnect" href="https://www.google-analytics.com" crossorigin />
<link rel="preconnect" href="https://play.vidyard.com" crossorigin />
<link rel="preconnect" href="https://adservice.google.com" crossorigin />
<link rel="preconnect" href="https://www.googleadservices.com" crossorigin />
<link rel="preconnect" href="https://www.facebook.com" crossorigin />
<link rel="preconnect" href="https://www.google.com" crossorigin />
<link rel="preconnect" href="https://px.ads.linkedin.com" crossorigin />



<script src="https://www.googleoptimize.com/optimize.js?id=GTM-WGVFC3T"></script>



<script src="https://cdn-cybersecurity.att.com/js/v2/imports/top-bundle.min.js?v=20210413215850"></script>


<link rel="preload" href="https://www.att.com/scripts/adobe/prod/edmDataDefinition.js" as="script">
<link rel="preload" href="https://www.att.com/scripts/adobe/prod/edmDataManager.js" as="script">
<link rel="preload" href="https://www.att.com/scripts/adobe/prod/marketing.min.js" as="script">
<link rel="preload" href="https://www.att.com/scripts/adobe/prod/detm_adobe.js" as="script">






<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KLJDXJN');</script>
<!-- End Google Tag Manager -->
<script src='https://www.att.com/scripts/adobe/prod/detm-container-hdr.js' data-restrictions='target' type='text/javascript'></script>


<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="ahrefs-site-verification" content="a6fa0378625f72f89c6f290c3c7559ffee326fb9232cd87fcace798afce3e30d">
<meta name="google-site-verification" content="GTQZz4AGa47UtmP64oC5BB735pkyncjtISHOcQZbIho" />

<link rel="preload" as="font" type="font/ttf" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/zero-width.ttf" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Bold.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Regular.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Light.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Medium.woff2" />


<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-LightItalic.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-BoldItalic.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-MediumItalic.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Italic.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/aleck/ATTAleckSans-Black.woff2" />

<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/css/fonts/glyphicons-halflings-regular.woff2" />
<link rel="preload" as="font" type="font/ttf" crossorigin="anonymous" href="https://cdn-cybersecurity.att.com/fonts/av-icons.ttf?e81fxl" />



<link rel="preload" as="style" href="https://cdn-cybersecurity.att.com/css/sass/main.min.css?v=20210413215850" />
<link rel="apple-touch-icon" sizes="144x144" href="https://cdn-cybersecurity.att.com/images/uploads/apple-touch-icon.png"/>
<link rel="icon" type="image/png" sizes="32x32" href="https://cdn-cybersecurity.att.com/images/uploads/favicon.ico"/>
<link rel="shortcut icon" href="https://cdn-cybersecurity.att.com/images/uploads/favicon.ico">
<link rel="manifest" href="https://cdn-cybersecurity.att.com/manifest.json">

<link rel="stylesheet" href="https://cdn-cybersecurity.att.com/css/sass/main.min.css?v=20210413215850" />








<script>
	var customAdobeTrackingPageLoadObj = {};
	if (typeof ddo !== "undefined") {initAdobePageTrackingHeader();}

	function initAdobePageTrackingHeader() {
		ddo.disableAutoPageLoad();
		document.addEventListener('click', function (event) {
			var target = event.target;
			if (!target.href || !target.text) { return true; }
			var linkEvent = {
				slotFriendlyName: "link-click",
				contentFriendlyName: "Link Click",
			};
			linkEvent.linkName = target.text;
			linkEvent.linkDestinationUrl = target.href;
			if (target.href.indexOf('#watch-') >= 0) {
				linkEvent.slotFriendlyName = 'watch-video';
				linkEvent.contentFriendlyName = 'Watch Video';
				linkEvent.linkName = 'Watch Video';
			}
			ddo.pushEvent("linkClick", "Link_Click", linkEvent);
		});
		
		customAdobeTrackingPageLoadObj['page.location.url'] = '/blogs/labs-research/the-rise-of-qakbot';


		
		
		    customAdobeTrackingPageLoadObj['page.category.siteSubSection1'] = 'blogs';
		


		
		
			customAdobeTrackingPageLoadObj['page.category.siteSubSection2'] = 'labs-research';
		



		
		
			customAdobeTrackingPageLoadObj['page.category.siteSubSection3'] = 'the-rise-of-qakbot';
		


		
		

		
		
	}
</script>


<script type="text/javascript">
    var _elqQ = _elqQ || [];
    _elqQ.push(['elqSetSiteId', '1086385399']);

    _elqQ.push(['elqUseFirstPartyCookie', 'cyber-tracking.att.com']);

    _elqQ.push(['elqTrackPageView', window.location.href]);

    (function () {
        function async_load() {
            var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true;
            s.src = '//img03.en25.com/i/elqCfg.min.js';
            var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x);
        }
        if (window.addEventListener) window.addEventListener('DOMContentLoaded', async_load, false);
        else if (window.attachEvent) window.attachEvent('onload', async_load);
    })();
</script>


	<link rel="alternate" type="application/rss+xml" title="AlienVault Open Threat Exchange Blog" href="http://feeds.feedblitz.com/alienvaultotx&x=1" />

	<style>
	.blog-author-info {
		width: 70%;
		float: left;
		color: #191919;
	}

	.blog-subscribe-grid ul {
		margin-left: 0px;
		margin-bottom: 0px;
		padding-left: 0px;
	}

	.blog-subscribe-grid ul li {
		list-style-type: none;
		line-height: 20px;
	}

	.blog-subscribe-grid ul li a {
		color: #c6ced5;
		font-size: 14px;
		text-decoration: none;
	}

	.blog-subscribe-grid ul li a:hover {
		text-decoration: underline;
	}

	.blog-content-area img {
		width: 100%!important;
		height: auto!important;
	}

	.blog-promo-item {
		clear: both;
		overflow: hidden;
		margin-bottom: 30px;
	}
	.promo-block .small {
		text-transform: uppercase;
	}

	.blog-promo-item-text {
		width: 345px;
		float: left;
		max-width:100%;
	}

	.blog-promo-item p {
		margin-bottom: 0px!important;
	}






	#blog-promo-block {
		padding-top: 20px;
	}



	/*promo block and sticky classes*/

	.sticky-sidebar {
		top: 147px;
		position: -webkit-sticky; /* Safari */
		position: sticky;
	}
	     .sidebar-search {
			 margin-bottom: 30px;
		 }

         .sidebar-search .search-button {
                width: 100%;
                position: relative;
            }

            .sidebar-search .search-button input {
                padding: 0px;
                margin: 2px 0px 0px 0px;
                position: absolute;
                background: url(https://cdn-cybersecurity.att.com/images/icn-sidebar-search.png) top left no-repeat;
                background-size: 25px 25px;
                width: 25px;
                height: 25px;
                cursor: pointer;
                text-indent: -9999em;
                border: none;
                left: 10px;
                top: 6px;
             }

			.sidebar-search .search-field input {
                border: 0;
                width: 100%;
                height: 30px;
                padding-left: 50px;
				margin-top: 5px;
            }

            .sidebar-search .search-field {
                border: 1px solid #CCCCCC;
                width: 100%;
                height: 40px;
            }

            #q::placeholder {
          		color: #767676!important;
            }

            #blog-subscribe-box {
			height:auto;
            padding: 32px;
            background-image: url('https://cdn-cybersecurity.att.com/images/uploads/backgrounds/blog-email-subscribe-bkg.jpg');
            background-size: cover;
            }

            #blog-subscribe-box h2 {
            color: #fff;
            font-size:32px;
            }

			#blog-subscribe-box p {
				margin-bottom: 10px;
			}






	@media (max-width: 991px) {
            .sidebar-search .search-button input {
                padding: 0px;
                background: transparent;
                cursor: pointer;
                text-indent: -9999em;
                border: none;
                right: 5px;
                top: 5px;
                padding-left: 0px;
             }

            .sidebar-search .search-field input {
             padding-left: 15px;
             }


            }

            	@media (min-width: 768px) and (max-width: 920px){
	.blog-subscribe-grid .btn {
		border-radius: 24px;
	    font-size: 12px;
	    line-height: 18px;
	    border: none;
	    padding: 6px 36px;
	    height: 30px;
	    font-weight: 500;
	}
}


		.blog-content-area p,
		.blog-content-area ul li,
		.blog-content-area ol li{
			font-size: 16px;
			line-height: 20px;
			font-weight: 400;
		}
		.blog-content-area ul li,
		.blog-content-area ol li {
			margin-bottom: 10px;
		}

	</style>

</head>

	<body class="listing-blog-entry-id-7233">
			<!-- Google Tag Manager (noscript) -->
<noscript><iframe src='https://www.googletagmanager.com/ns.html?id=GTM-KLJDXJN'
height='0' width='0' style='display:none;visibility:hidden'></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<script src='https://www.att.com/scripts/adobe/prod/detm-container-ftr.js' type='text/javascript'></script>


		<header id="header" class="navbar navbar-fixed-top">

	<style>
@media (max-width: 543px) {
	.hide-on-mobile {
		display: none;
	}
}
</style>

<div id="news-banner" style="background-color: #1A2027!important;">
    <div class="container-fluid">
        <div class="row vcenter">
            <div class="col-sm-12">

                <div id="news-headline-link">
                    <a href="/resource-center/industry-reports/cybersecurity-insights-report-tenth-edition" style="color: #009FDB;"><span class="caps"><strong>AT&T Cybersecurity Insights™ Report:</strong></span></a> <span class="text-white caps  hide-on-mobile" style="margin-right: 20px;">5G and the Journey to the Edge</span> <a class="text-white" href="/resource-center/industry-reports/cybersecurity-insights-report-tenth-edition">Learn more ⟶</a>
                </div>
				<div id="search-contact">
					<ul class="list-unstyled header_nav_top_list">
						<li class="header_nav_top_list_item"><a id="top-nav-support" href="/support">Support</a></li>
						<li class="header_nav_top_list_item"><a id="top-nav-contact" href="/contact">Contact</a></li>
						<li class="header_nav_top_list_item search">
							<a href="#" class="header_nav_toggle-search" aria-label="Search">
								<!-- <span class="hide-on-active"><img src="https://cdn-cybersecurity.att.com/images/uploads/nav/search.png"></span>
								<span class="show-on-active"><img src="https://cdn-cybersecurity.att.com/images/uploads/nav/search.png"></span> -->
								<span class="hide-on-active glyphicon glyphicon-search" aria-hidden="true"></span>
								<span class="show-on-active glyphicon glyphicon-search" aria-hidden="true"></span>
							</a>
							<form action="/search-results" method="get" id="top-search-form" __bizdiag="113" __biza="WJ__"><input name="q" id="top-search-form-text" type="text" placeholder="Search Now...." aria-label="Search"><button class="sr-only" type="submit">Search</button></form>
						</li>
					</ul>
				</div>
            </div>
        </div>
    </div>
</div>






	<div id="header-container" class="container-fluid">
		<div id="header-logo">
			<div class="logo-globe"><a href="https://business.att.com" target="_blank"><img src="https://cdn-cybersecurity.att.com/images/uploads/logos/att-globe.svg" alt="AT&amp;T Business" /></a></div>
			<div class="att-business"><a href="https://business.att.com" target="_blank"><img src="https://cdn-cybersecurity.att.com/images/uploads/logos/att-business-web.svg" alt="AT&amp;T Business" /></a></div>
			<div class="att-cybersecurity"><a href="/"><img src="https://cdn-cybersecurity.att.com/images/uploads/logos/att-cybersecurity-web.svg" alt="AT&amp;T Cybersecurity" /></a></div>
		</div>

		<button type="button" class="header_toggle_nav navbar-toggle collapsed" data-toggle="collapse" data-target="#header-nav" aria-expanded="false">
			<span class="sr-only">Toggle navigation</span>
			<span class="avicon avicon-bars"></span>
			<span class="avicon avicon-close"></span>
		</button>
		
		
			<a href="/contact" id="header-cta" class="hidden-md hidden-lg btn btn-blue btn-sm">Contact us</a>
		

		<nav class="navbar-collapse collapse" id="header-nav">
			<ul class="nav navbar-nav list-unstyled">
				<li class="nav-item has-dd products">
					<a id="main-nav-products" href="/products" class="dropdown-toggle" data-toggle="collapse" role="button" aria-expanded="false" data-target="#products-dd">Products<span class="glyphicon glyphicon-chevron-up"></span><span class="glyphicon glyphicon-chevron-down"></span>
					</a>
					<div class="nav-dropdown collapse" id="products-dd">
						<div class="dd-multi-col container-fluid">
							<ul class="list-unstyled sub-nav">
									<li id="first-sub-cyber-strategy-risk"><a href="/categories/cybersecurity-consulting-services" class="first-level">Cybersecurity Consulting Services</a>
										<div class="desktop-subnav open">
											<ul class="list-unstyled">
												<li class="second-sub-heading">Cyber Strategy</li>
												<li class="second-sub-link"><a href="/products/strategy-and-roadmap">Strategy and Roadmap Planning</a></li>

												<li class="second-sub-link"><a href="/products/security-assessment">Enterprise Security Assessment Services</a></li>
												<li class="second-sub-link"><a href="/products/risk-based-cyber-posture-assessment">Risk-based Cyber Posture Assessment</a></li>
											</ul>
											<ul class="list-unstyled">
												<li class="second-sub-heading">Risk and Compliance</li>
												<li class="second-sub-link"><a href="/products/security-compliance">Security Compliance</a></li>
											</ul>
											<ul class="list-unstyled">
												<li class="second-sub-heading">Vulnerability and Threat Management</li>
												<li class="second-sub-link"><a href="/products/managed-vulnerability-program">Managed Vulnerability Program</a></li>
												<li class="second-sub-link"><a href="/products/penetration-testing-services">Penetration Testing</a></li>
												<li class="second-sub-link"><a href="/products/adversary-simulation-service">Adversary Simulation Services</a></li>

											</ul>
											<ul class="list-unstyled">
												<li class="second-sub-heading">CSO Advisory Services</li>
												<li class="second-sub-link"><a href="/products/cybersecurity-iq-training">Cybersecurity IQ Training</a></li>
											</ul>
										</div>
										<div class="mobile-subnav">
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-link"><a href="/products/strategy-and-roadmap">Strategy and Roadmap Planning</a></li>
												<li class="second-sub-link"><a href="/products/security-assessment">Enterprise Security Assessment Services</a></li>
												<li class="second-sub-link"><a href="/products/risk-based-cyber-posture-assessment">Risk-based Cyber Posture Assessment</a></li>

												<li class="second-sub-link"><a href="/products/security-compliance">Security Compliance</a></li>

												<li class="second-sub-link"><a href="/products/managed-vulnerability-program">Managed Vulnerability Program</a></li>

												<li class="second-sub-link"><a href="/products/penetration-testing-services">Penetration Testing</a></li>
												<li class="second-sub-link"><a href="/products/adversary-simulation-service">Adversary Simulation Services</a></li>
												<li class="second-sub-link"><a href="/products/cybersecurity-iq-training">Cybersecurity IQ Training</a></li>
											</ul>
										</div>
									</li>
                                    <li id="first-sub-managed-security-services"><a href="/categories/managed-security-services" class="first-level">Managed Security Services</a>
                                        <div class="desktop-subnav">
                                            <ul class="list-unstyled">
                                                <li class="second-sub-heading">Network Security</li>
                                                <li class="second-sub-link"><a href="/products/global-security-gateway">Global Security Gateway</a></li>
                                                <li class="second-sub-link"><a href="/products/sase-branch-with-fortinet">SASE Branch with Fortinet</a></li>
                                                <li class="second-sub-link"><a href="/products/reactive-ddos-services">Reactive Distributed Denial of Service Defense</a></li>
                                                <li class="second-sub-link"><a href="/products/premises-based-firewall">Premises Based Firewalls</a></li>
                                                <li class="second-sub-link"><a href="/categories/network-security">View All</a></li>
                                            </ul>
                                            <ul class="list-unstyled">
                                                <li class="second-sub-heading">Threat Detection</li>
                                                <li class="second-sub-link"><a href="/products/managed-threat-detection-and-response">Managed Threat Detection and Response</a></li>
                                                <li class="second-sub-link"><a href="/products/incident-response">Incident Response and Forensics</a></li>
                                            </ul>
                                            <ul class="list-unstyled">
                                                <li class="second-sub-heading">Endpoint Security</li>
                                                <li class="second-sub-link"><a href="/products/sentinel-one">SentinelOne</a></li>
                                                <li class="second-sub-link"><a href="/products/mobile-iron">MobileIron</a></li>
                                                <li class="second-sub-link"><a href="/products/lookout">Lookout Mobile Endpoint Security</a></li>
                                            </ul>

                                        </div>
                                        <div class="mobile-subnav">
                                            <ul class="list-unstyled sub-nav">
                                                <li class="second-sub-link"><a href="/products/global-security-gateway">Global Security Gateway</a></li>
                                                <li class="second-sub-link"><a href="/products/sase-branch-with-fortinet">SASE Branch with Fortinet</a></li>
                                                <li class="second-sub-link"><a href="/products/reactive-ddos-services">Reactive Distributed Denial of Service Defense</a></li>
                                                <li class="second-sub-link"><a href="/products/premises-based-firewall">Premises Based Firewalls</a></li>
                                                <li class="second-sub-link"><a href="/products/managed-threat-detection-and-response">Managed Threat Detection and Response</a></li>
                                                <li class="second-sub-link"><a href="/products/incident-response">Incident Response and Forensics</a></li>
                                                <li class="second-sub-link"><a href="/products/sentinel-one">SentinelOne</a></li>
                                                <li class="second-sub-link"><a href="/products/mobile-iron">MobileIron</a></li>
                                                <li class="second-sub-link"><a href="/products/lookout">Lookout Mobile Endpoint Security</a></li>
                                            </ul>
                                        </div>
                                    </li>
									<li id="first-sub-network-security"><a href="/categories/network-security" class="first-level">Network Security</a>
										<div class="desktop-subnav">
											<ul class="list-unstyled">
												<li class="second-sub-heading">AT&T Trusted Internet Access</li>
												<li class="second-sub-link"><a href="/products/global-security-gateway">Global Security Gateway</a></li>
												<li class="second-sub-link"><a href="/products/network-based-firewall">Network Based Firewalls</a></li>
												<li class="second-sub-link"><a href="/products/premises-based-firewall">Premises Based Firewalls</a></li>
												<li class="second-sub-link"><a href="/products/enhanced-access-security">Enhanced Cybersecurity Services</a></li>
											</ul>
											<ul class="list-unstyled">
												<li class="second-sub-heading">AT&T Infrastructure and Application Protection</li>
												<li class="second-sub-link"><a href="/products/reactive-ddos-services">Reactive Distributed Denial of Service Defense</a></li>
												<li class="second-sub-link"><a href="/products/application-layer-security">AT&T Application Layer Security</a></li>
											</ul>
										</div>
										<div class="mobile-subnav">
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">AT&T Trusted Internet Access</li>
												<li class="second-sub-link"><a href="/products/global-security-gateway">Global Security Gateway</a></li>
												<li class="second-sub-link"><a href="/products/network-based-firewall">Network Based Firewalls</a></li>
												<li class="second-sub-link"><a href="/products/premises-based-firewall">Premises Based Firewalls</a></li>
												<li class="second-sub-link"><a href="/products/enhanced-access-security">Enhanced Cybersecurity Services</a></li>

												<li class="second-sub-heading">AT&T Infrastructure and Application Protection</li>
												<li class="second-sub-link"><a href="/products/reactive-ddos-services">Reactive Distributed Denial of Service Defense</a></li>
												<li class="second-sub-link"><a href="/products/application-layer-security">AT&T Application Layer Security</a></li>
											</ul>
										</div>
									</li>
									<li id="first-sub-unified-endpoint"><a href="/categories/endpoint-security" class="first-level">Endpoint Security</a>
										<div class="desktop-subnav">
											<ul class="list-unstyled">
												<li class="second-sub-heading">Endpoint Security</li>
												<li class="second-sub-link"><a href="/products/sentinel-one">SentinelOne</a></li>
												<li class="second-sub-link"><a href="/products/mobile-iron">MobileIron</a></li>
												<li class="second-sub-link"><a href="/products/vmware">VMware Workspace ONE®</a></li>
												<li class="second-sub-link"><a href="/products/ibm-maas360">IBM MaaS360</a></li>
												<li class="second-sub-link"><a href="/products/lookout">Lookout Mobile Endpoint Security</a></li>
												<li class="second-sub-link"><a href="/products/mcafee-endpoint-protection">McAfee Endpoint Protection</a></li>
											</ul>
										</div>
										<div class="mobile-subnav">
											<ul class="list-unstyled sub-nav">
													<li class="second-sub-link"><a href="/products/sentinel-one">SentinelOne</a></li>
													<li class="second-sub-link"><a href="/products/mobile-iron">MobileIron</a></li>
													<li class="second-sub-link"><a href="/products/vmware">VMware Workspace ONE®</a></li>
													<li class="second-sub-link"><a href="/products/ibm-maas360">IBM MaaS360</a></li>
													<li class="second-sub-link"><a href="/products/lookout">Lookout Mobile Endpoint Security</a></li>
													<li class="second-sub-link"><a href="/products/mcafee-endpoint-protection">McAfee Endpoint Protection</a></li>
											</ul>
										</div>
									</li>
									<li id="first-sub-threat-detection-response"><a href="/categories/threat-detection-and-response" class="first-level">Threat Detection and Response</a>
										<div class="desktop-subnav">
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">Strategy, Assessment and Planning</li>
												<li class="second-sub-link"><a href="/products/incident-response">Incident Response and Forensics</a></li>
											</ul>
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">AT&T Threat Solutions</li>
												<li class="second-sub-link"><a href="/products/managed-threat-detection-and-response">Managed Threat Detection and Response</a></li>
												<li class="second-sub-link"><a href="/products/usm-anywhere">USM Anywhere</a></li>
												<li class="second-sub-link"><a href="/products/usm-for-mssp">USM for MSSPs</a></li>
											</ul>
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">Free Tools</li>
												<li class="second-sub-link"><a href="/open-threat-exchange">Open Threat Exchange</a></li>
												<li class="second-sub-link"><a href="/products/ossim">OSSIM</a></li>
											</ul>
										</div>
										<div class="mobile-subnav">
											<ul class="list-unstyled sub-nav">
												<li class="second-sub-heading">Strategy, Assessment and Planning</li>
												<li class="second-sub-link"><a href="/products/incident-response">Incident Response and Forensics</a></li>

												<li class="second-sub-heading">AT&T Threat Solutions</li>
												<li class="second-sub-link"><a href="/products/managed-threat-detection-and-response">Managed Threat Detection and Response</a></li>
												<li class="second-sub-link"><a href="/products/usm-anywhere">USM Anywhere</a></li>
												<li class="second-sub-link"><a href="/products/usm-for-mssp">USM for MSSPs</a></li>

												<li class="second-sub-heading">Free Tools</li>
												<li class="second-sub-link"><a href="/open-threat-exchange">Open Threat Exchange</a></li>
												<li class="second-sub-link"><a href="/products/ossim">OSSIM</a></li>
											</ul>
										</div>
									</li>

							</ul>
						</div>
						<!--<div class="dd-bottom visible-lg" id="view-all-products">
							<div class="container-fluid">
								<a href="/products">
									<span class="view-all-text">View All Products &LongRightArrow;</span>
								</a>
							</div>
						</div>-->
					</div>
				</li>
				<li class="nav-item has-dd solutions">
					<a id="main-nav-solutions" href="/solutions" class="dropdown-toggle" data-toggle="collapse" role="button" aria-expanded="false" data-target="#solutions-dd">Solutions<span class="glyphicon glyphicon-chevron-up"></span><span class="glyphicon glyphicon-chevron-down"></span></a>
					<div class="nav-dropdown collapse" id="solutions-dd">
						<div class="dd-multi-col container-fluid">
							<ul class="list-unstyled sub-nav hidden-md hidden-lg">
								<li><a id="main-nav-see-all-solutions-mobile" href="/solutions" class="header_nav_link">See All Solutions</a></li>
							</ul>
							<div id="compliance">
								<div class="menu-header">Compliance</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/solutions/it-compliance-management">Overview</a></li>
									<li><a href="/solutions/gdpr-compliance">GDPR</a></li>
									<li><a href="/solutions/hipaa-compliance">HIPAA</a></li>
									<li><a href="/solutions/iso-27001-compliance">ISO 27001</a></li>
									<li><a href="/solutions/pci-dss-compliance">PCI DSS</a></li>
									<li><a href="/solutions/soc-2-compliance">SOC 2</a></li>
								</ul>
							</div>
							<div id="industry">
								<div class="menu-header">Industry</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/solutions/education">Education</a></li>
									<li><a href="/solutions/energy-sector-security">Energy Sector</a></li>
									<li><a href="/solutions/government">Federal</a></li>
									<li><a href="/solutions/financial-services">Financial Services</a></li>
									<li><a href="/solutions/healthcare">Healthcare</a></li>
									<li><a href="/solutions/manufacturing">Manufacturing</a></li>
									<li><a href="/partners/mssp-program">MSSPs</a></li>
									<li><a href="/solutions/retail">Retail</a></li>
								</ul>
							</div>
							<div id="environment">
								<div class="menu-header">Environment</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/solutions/aws-security-and-compliance-management">AWS</a></li>
									<li><a href="/solutions/azure-security-and-compliance-management">Azure</a></li>
									<li><a href="/solutions/cloud-security">Cloud</a></li>
									<li><a href="/solutions/iot-and-mobility-security">IOT/Mobility</a></li>
									<li><a href="/solutions/hybrid-cloud-security">Hybrid</a></li>
									<li><a href="/solutions/network-security">Network</a></li>
									<li><a href="/solutions/remote-workforce-security">Remote Workforce</a></li>

								</ul>
							</div>
							<div id="core-capabilities">
								<div class="menu-header">Security Use Cases</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/solutions/asset-discovery-inventory">Asset Discovery</a></li>
									<li><a href="/solutions/endpoint-detection-and-response">Endpoint Detection &amp; Response</a></li>
									<li><a href="/solutions/intrusion-detection-system">Intrusion Detection</a></li>
									<li><a href="/solutions/secure-access-service-edge">Secure Access Service Edge</a></li>
									<li><a href="/solutions/secure-web-gateway">Secure Web Gateway</a></li>
									<li><a href="/solutions/siem-platform-solutions ">SIEM Platform Solutions</a></li>
									<li><a href="/solutions/threat-detection">Threat Detection</a></li>
									<li><a href="/solutions/threat-intelligence">Threat Intelligence</a></li>
									<li><a href="/solutions/zero-trust-architecture">Zero Trust Architecture</a></li>

								</ul>
							</div>
						</div>
						<div class="dd-bottom visible-lg" id="view-all-solutions">
							<div class="container-fluid">
								<a href="/solutions">
									<span class="view-all-text">View All Solutions &LongRightArrow;</span>
								</a>
							</div>
						</div>
					</div>
				</li>
				<li class="nav-item partners">
					<a id="main-nav-partners" href="/partners" class="dropdown-toggle" role="button" aria-expanded="false" data-target="#partners-dd">Partners</a>
					<div class="nav-dropdown collapse visible-lg" id="partners-dd">
						<div class="dd-multi-col container-fluid">
							<div id="become-a-partner">
								<div class="menu-header">Become a Partner</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/partners">All Partner Programs</a></li>
									<li><a href="/partners/mssp-program">MSSP Program</a></li>
									<li><a href="/partners/resellers">Reseller Program</a></li>
									<li><a href="/partners/partner-portal/">Partner Portal Login</a></li>
								</ul>
							</div>

							<div id="find-a-partner">
								<div class="menu-header">Find a Partner</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/partners/find-partner">Find an MSSP</a></li>
									<li><a href="/partners/locator">Find a Reseller</a></li>
									<li><a href="/partners/certified-implementation-partners">Professional Services</a></li>
								</ul>
							</div>
							<div id="technology-partners">
								<div class="menu-header">Technology Partners</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/app">USM Anywhere Integrations</a></li>
									<li><a href="/partners/technology-partners">OTX Partners</a></li>
								</ul>
							</div>
						</div>
						<div class="dd-bottom visible-lg" id="view-all-partners">
							<div class="container-fluid">
								<a href="/partners/become-a-partner">
									<span class="view-all-text">Become a Partner &LongRightArrow;</span>
								</a>
							</div>
						</div>
					</div>
				</li>
				<li class="nav-item has-dd resources">
					<a id="main-nav-resources" href="/resource-center#language_en" class="dropdown-toggle" data-toggle="collapse" role="button" aria-expanded="false" data-target="#resources-dd">Resources<span class="glyphicon glyphicon-chevron-up"></span><span class="glyphicon glyphicon-chevron-down"></span></a>
					<div class="nav-dropdown collapse" id="resources-dd">
						<div class="dd-multi-col container-fluid">

							<div id="resources-menu-image" class="visible-lg">
								<img src="https://cdn-cybersecurity.att.com/images/uploads/thehub-thumbnail.jpg">
								<p>Explore The Hub, our home for all virtual experiences</p>
								<a href="https://hub.att.com/expo-hall/cybersecurity/">Explore now ⟶</a>
							</div>

							<ul class="list-unstyled sub-nav hidden-md hidden-lg">
								<li><a id="main-nav-resources-mobile" href="/resource-center#language_en">View All Resources</a></li>

							</ul>

							<div id="product-resources">
								<div class="menu-header">Product Resources</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/resource-center#content_customer-stories">Customer Stories</a></li>
									<li><a href="/resource-center#content_product-brief">Product Briefs</a></li>
									<li><a href="/resource-center#content_product-demo">Product Demos</a></li>
									<li><a href="/resource-center#content_product-review">Product Reviews</a></li>
									<li><a href="/resource-center#content_solution-brief">Solution Briefs</a></li>
									<li><a href="/resource-center#content_use-cases">Use Cases</a></li>

									<li><a id="free-trial" href="/products/usm-anywhere/free-trial">Free Trial</a></li>
								</ul>
							</div>
							<div id="security-resources">
								<div class="menu-header">Security Resources</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/resource-center#content_analyst-reports">Analyst Reports</a></li>
									<li><a href="/blogs">Blogs</a></li>
									<li><a href="/resource-center#content_ebook">eBooks</a></li>
									<li><a href="/resource-center#content_video">Videos</a></li>
									<li><a href="/resource-center#content_webcast">Webcasts</a></li>
									<li><a href="/resource-center#content_white-paper">White Papers</a></li>
									<li><a href="/resource-center#content_industry-reports">Industry Reports</a></li>
								</ul>
							</div>
							<div id="customer-resources">
								<div class="menu-header">Customer Resources</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="https://success.alienvault.com/">Success Center</a></li>
									<li><a href="/certification">Certification</a></li>
									<li><a href="/customer-success">Customer Success</a></li>
									<li><a href="/documentation">Documentation</a></li>
									<li><a href="/partners/certified-implementation-partners">Professional Services</a></li>
									<li><a href="/support">Support Overview</a></li>
									<li><a href="/training">Training</a></li>
								</ul>
							</div>
							<div id="browse-by-topic">
								<div class="menu-header">Browse by Topic</div>
								<ul class="list-unstyled sub-nav">
									<li><a href="/resource-center#category_incident-response">Incident Response</a></li>
									<li><a href="/resource-center#category_intrusion-detection">Intrusion Detection</a></li>
									<li><a href="/resource-center#category_partner-mssp-reseller">Partner: MSSP &amp; Reseller</a></li>
									<li><a href="/resource-center#category_regulatory-compliance">Regulatory Compliance</a></li>
									<li><a href="/resource-center#category_soc">Security Operations Center</a></li>
									<li><a href="/resource-center#category_siem-log-management">SIEM &amp; Log Management </a></li>
									<li><a href="/resource-center#category_threat-detection">Threat Detection</a></li>
									<li><a href="/resource-center#category_threat-intelligence">Threat Intelligence</a></li>
								</ul>
							</div>
						</div>

						<div class="dd-bottom visible-lg" id="view-all-resources">
							<div class="container-fluid">
								<a href="/resource-center#language_en">
									<span class="view-all-text">View All Resources &LongRightArrow;</span>
								</a>
							</div>
						</div>

					</div>
				</li>
				<li class="nav-item alien-labs">
					<a id="main-nav-alien-labs" href="/alien-labs" class="">AT&T Alien Labs</a>
				</li>
				<li class="nav-item support visible-sm visible-xs">
					<a id="main-nav-support" href="/support">Support</a>
				</li>
			</ul>
		</nav>

	</div>

	<div class="container-fluid visible-md visible-lg">
		
		
			<a id="main-nav-free-tools" class="header-nav-btn btn margin-bottom10" href="/products/usm-anywhere/free-trial">Free trial</a>
		


	</div>
</header>

						




			<main class="blog-detail">

				<div class="full-width-block top-content-width-bg" style="background-image: url('https://cdn-cybersecurity.att.com/blog-content/Blog-Images/hero/malware_hero.jpg'); background-position: top center; background-repeat: no-repeat; background-color: #000; background-size: 2500px 405px; min-height: 405px;">
					<div class="container-fluid">
						<div class="row rowPad">
							<div class="all-blogs-cta"><a href="/blogs">‹ ALL BLOGS</a></div>
							<div class="category-label">
								
									<a href="/blogs/labs-research">Alien Labs</a>
								
							</div>
							<h1>The rise of QakBot</h1>
							<div class="date">April 15, 2021 | <a href="/blogs/author/dax-morrow">Dax Morrow</a></div>
						</div>
					</div>
				</div>

				<section class="full-width-block">

					<div class="container-fluid">

						<div class="row flx-container">
							<div class="col-sm-8">
								<div class="blog-content-area">
									<p><em>This blog was jointly written with Ofer Caspi. Some of the links in this blog require an OTX account, and the QakBot infrastructure tracker will require readers to be customers with access to the Threat Intel subscription.. Thanks to the following researchers and the MalwareBazaar Project:</em></p>

<ul>
	<li><a href="https://twitter.com/0verfl0w_" target="_blank">@0verfl0w</a>_&nbsp;&nbsp;</li>
	<li><a href="https://twitter.com/_alex_il_" target="_blank">@_alex_il_</a>&nbsp;&nbsp;</li>
	<li><a href="https://twitter.com/malware_traffic" target="_blank">@malware_traffic</a>&nbsp;&nbsp;</li>
	<li><a href="https://twitter.com/lazyactivist192" target="_blank">@lazyactivist192</a>&nbsp;&nbsp;</li>
	<li><a href="https://twitter.com/JAMESWT_MHT" target="_blank">@JAMESWT_MHT</a>&nbsp;&nbsp;</li>
	<li><a href="https://bazaar.abuse.ch/" target="_blank">MalwareBazaar Project</a>&nbsp;&nbsp;</li>
</ul>

<h2>Executive summary</h2>

<p>AT&amp;T Alien Labs closely monitors the evolution of crimeware such as the <a href="https://otx.alienvault.com/malware/Trojan:Win32%2FQakbot/" target="_blank">QakBot </a>malware family and campaigns in connection with QakBot. The jointly coordinated takedown of the actors behind Emotet in late <a href="https://www.europol.europa.eu/newsroom/news/world%E2%80%99s-most-dangerous-malware-emotet-disrupted-through-global-action" target="_blank">January</a> has left a gap in the cybercrime landscape, which QakBot seems poised to fill.</p>

<p>Key Points:</p>

<ul>
	<li>TA551 has added QakBot to its arsenal, which also includes <a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.qakbot" target="_blank">IcedID</a>.</li>
</ul>

<ul>
	<li>QakBot employs anti-virus evasion, anti-detection, and anti-sandbox tactics across the entire spectrum of the attack.</li>
</ul>

<ul>
	<li>The actor(s) behind QakBot possess a modular framework consisting of maldoc builders, signed loaders, and DLLs that produce initially low detection rates at the beginning of the attack, which creates opportunities to deliver additional malware such as Egregor and Cobalt Strike.</li>
	<li>The actor(s) responsible for QakBot have an active affiliate program.</li>
	<li>TA551, Cobalt Strike, and QakBot have all been observed jointly within the context of individual campaigns.</li>
</ul>

<h2>Analysis</h2>

<p>Qakbot, also known as QBot or Pinkslipbot, is a modular information stealer. It has been active since 2007 and primarily used by financially motivated actors. It was initially known as a banking Trojan and a loader using C2 servers for payload delivery; however, its use expanded beyond strictly being a <a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.qakbot" target="_blank">banking trojan</a>. The hallmarks of a QakBot infection chain consist of a phishing lure (T1566) delivered via email chain hijacking or spoofed emails that contain context-aware information such as shipping, work orders, urgent requests, invoices, claims, etc. The phishing emails alternate between file attachments (T1566.001) and links (T1566.002). QakBot is often used as a gateway entry, similar to TrickBot or Emotet, that leads to post exploitation operations leveraging frameworks such as Cobalt Strike as well as delivering <a href="https://isc.sans.edu/forums/diary/Recent+Qakbot+Qbot+activity/26862/" target="_blank">Ransomware</a>.</p>

<p>QakBot email lures are not the most sophisticated; however, by using contextually aware themes that originate from hijacked email chains or potentially compromised accounts within a user&rsquo;s social circle, they are effective. Figure 1 below illustrates an example of a recent QakBot lure with the subject &ldquo;Re: SIGNED QUOTE&rdquo; and a ZIP file attachment labeled &ldquo;Cancellation_Letter_272020508-02242021.zip&rdquo;.</p>

<p style="text-align:center"><img alt="signed quote screen" data-original="https://cdn-cybersecurity.att.com/blog-content/signed_quote.jpg" /></p>

<p style="text-align:center">Figure 1. QakBot "Signed Quote" Email Lure</p>

<p>The actors further establish the trust and confidence of the targeted user by presenting a semi-official looking DocuSign graphic that guides the user through the process of enabling the Excel 4 Macros. A representative sample, <a href="https://otx.alienvault.com/indicator/file/78ea3550e2697cd06b07df568242f7fc9f57e4d2b297b74f6ce26e97613de53a" target="_blank">78ea3550e2697cd06b07df568242f7fc9f57e4d2b297b74f6ce26e97613de53a</a>, seen in a recent QakBot campaign is shown in Figure 2 below.</p>

<p style="text-align:center"><img alt="docusign lure for qakbot" data-original="https://cdn-cybersecurity.att.com/blog-content/docusign_lure.jpg" /></p>

<p style="text-align:center">Figure 2. QakBot DocuSign Lure</p>

<p>QakBot Excel spreadsheets often contain hidden spreadsheets, Excel 4.0 macros, spreadsheet formulas, and BIFF records all designed to pass a visual inspection from the user with the added benefit of bypassing detection mechanisms that attempt to parse multiple legacy formats inside the spreadsheet. Figure 3 below shows a screenshot of output from the open-source <a href="https://github.com/DissectMalware/XLMMacroDeobfuscator" target="_blank">XLMMacroDeobfuscator</a> tool, which decodes obfuscated Excel 4.0 macros.</p>

<p><img alt="deobfuscator" data-original="https://cdn-cybersecurity.att.com/blog-content/deobfuscator.jpg" /></p>

<p style="text-align:center">Figure 3. XLMMacroDeobfuscator Output for a QakBot Excel 4.0 Macro Spreadsheet</p>

<p>Once the Excel 4.0 macro is decoded it is possible to see the CALL to URLDownloadToFileA, which downloads the QakBot DLL in this campaign from http[:]//rlyrt26rnxw02vqijgs[.]com/fera/frid[.]gif. Next, the EXEC function is evaluated which executes &ldquo;rundll32.exe nxckew.wle, DllRegisterServer&rdquo;. It is also a common tactic for QakBot to execute &ldquo;regsvr32.exe -s nxckew.wle,DllRegisterServer&rdquo;. Both instances are designed to evade sandbox environments that do not supply the expected <a href="https://www.binarydefense.com/qakbot-upgrades-to-stealthier-persistence-method/">command line arguments</a>. A representative QakBot DLL analyzed by Alien Labs, <a href="https://otx.alienvault.com/indicator/file/9a353d4b85b3097762282703f1807c2b459698966b967280c8e4e13cc56d2e28" target="_blank">9a353d4b85b3097762282703f1807c2b459698966b967280c8e4e13cc56d2e28</a>, has two exports: the entry point (0x10005a5d) and DllRegisterServer (0x10029c88)and if DllRegisterServer is not called via regsvr32.exe or rundll32.exe with command line options, then only the entry point is called and the malicious code in DllRegisterServer is not called. Figure 3 below shows improved readability and de-obfuscation of the macro by manually replacing and substituting the cell values and formulas.</p>

<p style="text-align:center"><img alt="better deobfuscation" data-original="https://cdn-cybersecurity.att.com/blog-content/better_deobfuscator.jpg" /></p>

<p style="text-align:center">Figure 3. Better de-obfuscation of the spreadsheet</p>

<p>The results of our additional de-obfuscation efforts are confirmed when the QakBot Excel spreadsheet is run inside a sandbox in Figure 4 below.</p>

<p style="text-align:center"><img alt="otx qakbot" data-original="https://cdn-cybersecurity.att.com/blog-content/otx_qakbot.jpg" /></p>

<p style="text-align:center">Figure 4. OTX screenshot showing the &ldquo;rundll32 ..\nxckew.wle, DllRegisterServer&#39;&#39; <a href="https://otx.alienvault.com/indicator/file/78ea3550e2697cd06b07df568242f7fc9f57e4d2b297b74f6ce26e97613de53a" target="_blank">execution</a></p>

<p>Before executing the main payload, the QakBot loader will first test the infected system to see if it is a good candidate for infection. The QakBot loader is responsible for checking its environment to include whether it is running on a Virtual Machine, identifying any installed and running security and monitoring tools such as AntiVirus products or common security researcher tools. Figure 5 below shows a high-level execution flow of the QakBot loader.</p>

<p style="text-align:center"><img alt="qakbot execution diagram" data-original="https://cdn-cybersecurity.att.com/blog-content/qakbot_execution.jpg" /></p>

<p style="text-align:center">Figure 5. QakBot Execution Flow</p>

<p>To make detection and analysis harder, QakBot encrypts its strings and decrypts them at runtime before use. Once the QakBot execution logic is finished using a string, it will immediately delete the string from memory. An example of this can be seen in Figure 6 below, which shows QakBot decrypting a string containing the value for lpProcName passed as a parameter to the GetProcAddress API call. The selected function, which has been labeled in IDA Pro as, &ldquo;oc_clear_mem&rdquo; deletes the string memory right after it retrieves the process address.</p>

<p style="text-align:center"><img alt="qakbot clearing memory" data-original="https://cdn-cybersecurity.att.com/blog-content/qakbot_clearing_memory.jpg" /></p>

<p style="text-align:center">Figure 6. QakBot GetProcAddress and clear_mem routines</p>

<p>When executed, QakBot will check whether it has previously been executed on the machine by checking for the specified malware folder. If QakBot discovers it is a first time run, it will relaunch itself from cmd.exe with the /C parameter that will inform the loader to proceed and run its Anti-VM checks on the machine and return the results to the parent process. If QakBot detects it is running in a VM environment, then the final payload will not be decrypted since QakBot uses the return value from these checks in its final decryption routine. Figure 7 below shows the QakBot environment check logic.</p>

<p style="text-align:center"><img alt="qakbot check" data-original="https://cdn-cybersecurity.att.com/blog-content/qakbot_check.jpg" /></p>

<p style="text-align:center">Figure 7. QakBot Environment Check Logic</p>

<p>Specifically, QakBot checks the system for the names of running processes that match the strings listed in Table 1 below.</p>

<table align="center" style="border-collapse:collapse">
	<tbody>
		<tr>
			<td colspan="3" style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:1px solid #959595; height:27px; width:624px">
			<p style="text-align:center">PROCESS NAMES</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:25px; width:206px">
			<pre style="text-align: center;">
Autoruns.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:25px; width:189px">
			<pre style="text-align: center;">
bds-vision-agent-app.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:25px; width:229px">
			<pre style="text-align: center;">
bds-vision-agent-nai.exe</pre>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:20px; width:206px">
			<pre style="text-align: center;">
bds-vision-apis.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:20px; width:189px">
			<pre style="text-align: center;">
CFF Explorer.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:20px; width:229px">
			<pre style="text-align: center;">
dsniff.exe</pre>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:19px; width:206px">
			<pre style="text-align: center;">
dumpcap.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:19px; width:189px">
			<pre style="text-align: center;">
Fiddler.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:19px; width:229px">
			<pre style="text-align: center;">
HashMyFiles.exe</pre>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:17px; width:206px">
			<pre style="text-align: center;">
idaq.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:17px; width:189px">
			<pre style="text-align: center;">
idaq64.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:17px; width:229px">
			<pre style="text-align: center;">
lordpe.exe</pre>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:18px; width:206px">
			<pre style="text-align: center;">
MultiAnalysis_v1.0.294.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:18px; width:189px">
			<pre style="text-align: center;">
netmon.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:18px; width:229px">
			<pre style="text-align: center;">
OLLYDBG.EXE</pre>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:18px; width:206px">
			<pre style="text-align: center;">
pr0c3xp.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:18px; width:189px">
			<pre style="text-align: center;">
ProcessHacker.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:18px; width:229px">
			<pre style="text-align: center;">
Procmon.exe</pre>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:22px; width:206px">
			<pre style="text-align: center;">
Procmon64.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:22px; width:189px">
			<pre style="text-align: center;">
regshot.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:22px; width:229px">
			<pre style="text-align: center;">
ResourceHacker.exe</pre>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:19px; width:206px">
			<pre style="text-align: center;">
runsample.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:19px; width:189px">
			<pre style="text-align: center;">
samp1e.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:19px; width:229px">
			<pre style="text-align: center;">
sample.exe</pre>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:18px; width:206px">
			<pre style="text-align: center;">
Tcpview.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:18px; width:189px">
			<pre style="text-align: center;">
TPAutoConnect.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:18px; width:229px">
			<pre style="text-align: center;">
VBoxService.exe</pre>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:18px; width:206px">
			<pre style="text-align: center;">
VBoxTray.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:18px; width:189px">
			<pre style="text-align: center;">
VGAuthService.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:18px; width:229px">
			<pre style="text-align: center;">
vm3dservice.exe</pre>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:16px; width:206px">
			<pre style="text-align: center;">
vmacthlp.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:16px; width:189px">
			<pre style="text-align: center;">
vmtoolsd.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:16px; width:229px">
			<pre style="text-align: center;">
windbg.exe</pre>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:17px; width:206px">
			<pre style="text-align: center;">
Wireshark.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:17px; width:189px">
			<pre style="text-align: center;">
x32dbg.exe</pre>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:17px; width:229px">
			<pre style="text-align: center;">
&nbsp;x64dbg.exe</pre>
			</td>
		</tr>
	</tbody>
</table>

<h3 style="text-align:center">Table 1. AntiVM process name checks for security, monitoring, and analysis tools</h3>

<p>Figure 8 below shows the decryption routine for the security and monitoring tool strings (T1140).</p>

<p style="text-align:center"><img alt="decryption step" data-original="https://cdn-cybersecurity.att.com/blog-content/qakbot_decrypt.jpg" /></p>

<p style="text-align:center">Figure 8. QakBot decrypting tool check strings</p>

<p>QakBot will also add its folder to the Windows Defender exclusions setting located in the Registry (T1112), which prevents Defender from scanning QakBot artifacts. The Registry location can be seen in Figure 9 below.</p>

<p style="text-align:center"><img alt="Qakbot exclusion paths" data-original="https://cdn-cybersecurity.att.com/blog-content/qakbot_exclusion_paths.jpg" /></p>

<p style="text-align:center">Figure 9. QakBot adding exclusion paths to Windows Defender settings</p>

<p>In addition to the previously mentioned environment check, QakBot collects system information (T1082) such as computer name, system directories, user profiles, and more, which is shown in Figure 10 below.</p>

<p style="text-align:center"><img alt="system info collected" data-original="https://cdn-cybersecurity.att.com/blog-content/qakbot_system_info.jpg" /></p>

<p style="text-align:center">Figure 10. QakBot system information collection</p>

<p>QakBot will use process hollowing (T1055.012) in order to inject itself into explorer.exe. If it is unsuccessful then QakBot will attempt to inject itself into mobsync.exe or iexplore.exe. The screen shot in Figure 11 illustrates the QakBot process name decryption routine.&nbsp;</p>

<p style="text-align:center"><img alt="qakbot routine" data-original="https://cdn-cybersecurity.att.com/blog-content/qakbot_routine.jpg" /></p>

<p style="text-align:center">Figure 11. QakBot routine to decrypt process names for injection</p>

<p>Figure 12 below shows the QakBot logic to overwrite the suspended explorer.exe process and then resume its execution.</p>

<p style="text-align:center"><img alt="process hollowing" data-original="https://cdn-cybersecurity.att.com/blog-content/process_hollowing.jpg" /></p>

<p style="text-align:center">Figure 12. QakBot process hollowing routine</p>

<p>Additionally, QakBot abuses the Service Control Manager (SCM) to create a child process, which is then detached from the parent when the SCM terminates the <a href="https://unit42.paloaltonetworks.com/unit42-abusing-service-control-manager-establish-persistence-non-service-applications/" target="_blank">parent process</a>. QakBot C2 communications begin in this stage to make it more difficult to monitor. Figure 13 below shows the SCM spawned process abuse technique.</p>

<p style="text-align:center"><img alt="qakbot abusing SCM" data-original="https://cdn-cybersecurity.att.com/blog-content/qakbot_abusing_scm.jpg" /></p>

<p style="text-align:center">Figure 13. QakBot abusing SCM to spawn a detached process</p>

<p>Figure 14 below shows the QakBot C2 ping during the SCM interaction.</p>

<p style="text-align:center"><img alt="c2 ping" data-original="https://cdn-cybersecurity.att.com/blog-content/qakbot_c2_ping.jpg" /></p>

<p style="text-align:center">Figure 14. QakBot sending C2 ping</p>

<p>Finally, if the QakBot loader has verified its execution environment has passed its tests, then QakBot will proceed to decrypt and execute the main QakBot payload, which is hidden as resource &ldquo;307&rdquo;. The decryption and import table resolution of its main payload is shown in Figure 15 below.</p>

<p style="text-align:center"><img alt="qakbot resolution" data-original="https://cdn-cybersecurity.att.com/blog-content/qakbot_resolution.jpg" /></p>

<p style="text-align:center">Figure 15. QakBot decryption and import table resolution of main payload</p>

<p>The combined anti-analysis and evasion techniques across the infection chain significantly impair antivirus, EDR, and other security defenses from detecting and preventing the initial infection. Despite the limitations and challenges presented by QakBot DLLs there is ample opportunity to detect QakBot loaders signed by revoked and blacklisted malicious certificates. Alien Labs has identified 42 unique <a href="https://bazaar.abuse.ch/faq/#cscb" target="_blank">signers</a> and signature serial numbers, which are included in Detection Methods section to aid in detection and hunting with<strong> <a href="https://otx.alienvault.com/indicator/yara/1454e3d91e3fd7f17f945f4ad826ffe01ed27693" target="_blank">YARA</a></strong> and Osquery. Additionally, there are a number of behavioral patterns, Indicators of Behavior (IOB), which provide opportunities for detection.</p>

<h2>Recommended actions</h2>

<ol>
	<li>Search for a renamed version of &ldquo;wmic.exe&rdquo; such as &ldquo;xml.com&rdquo;, which spawns &ldquo;regsvr32.exe&rdquo; and executes files with JPG or GIF <a href="https://twitter.com/redcanary/status/1365367464427716613" target="_blank">file extensions</a>.</li>
	<li>Regularly perform process auditing and accounting looking for process oddities such as
	<ol>
		<li>parent to child relationships &ldquo;excel.exe&rdquo; spawning &ldquo;rundll32.exe&rdquo;.</li>
		<li>Instances of &ldquo;WerFault.exe&rdquo; <a href="https://twitter.com/redcanary/status/1334224870536712192" target="_blank">executing without a command line</a>.</li>
		<li>&ldquo;<a href="https://redcanary.com/threat-detection-report/threats/qbot/" target="_blank">esentutl.exe</a>&rdquo; executing with a command line containing the term &ldquo;WebCache&rdquo;.</li>
	</ol>
	</li>
	<li>Check for unrecognized exclusions, files or folders, in Windows Defender settings.</li>
</ol>

<h2>Conclusion</h2>

<p>Alien Labs has observed QakBot over the past three months being used in a role similar to TrickBot, which includes malspam delivery, stealthy maldocs dropping signed loaders, establishing a foothold, and finally post exploitation activities such as lateral movement, access operations, and ransomware delivery. Alien Labs actively tracks the QakBot C2 infrastructure for customers, which is available via OTX <a href="https://otx.alienvault.com/pulse/5f33a76bf946bc5f6962b252" target="_blank">here</a>.</p>

<h3>Detection methods</h3>

<p>The following associated detection methods are in use by Alien Labs. They can be used by defenders to tune or deploy detections in their own environments or for aiding additional research.</p>

<table style="border-collapse:collapse">
	<tbody>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:1px solid #959595; height:26px; width:552px">
			<p>AGENT SIGNATURES</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:35px; width:552px">SELECT process.pid as source_process_id,&nbsp;process.name&nbsp;as source_process, process.path as file_path, authenticode.result, authenticode.serial_number as certificate_serial_number, authenticode.issuer_name as certificate_issuer_name, authenticode.subject_name as certificate_subject_name, parent_processes.path as source_process_parent, parent_processes.cmdline as source_process_parent_commandline, parent_processes.uid as parent_uid, hashes.sha256 AS file_hash_sha256 FROM processes as process LEFT JOIN authenticode ON process.path = authenticode.path LEFT OUTER JOIN processes parent_processes ON process.parent = parent_processes.pid LEFT JOIN hash AS hashes ON hashes.path = process.path WHERE authenticode.serial_number IN (&#39;00ac307e5257bb814b818d3633b630326f&#39;, &#39;186d49fac34ce99775b8e7ffbf50679d&#39;, &#39;02b6656292310b84022db5541bc48faf&#39;, &#39;17d99cc2f5b29522d422332e681f3e18&#39;, &#39;142aac4217e22b525c8587589773ba9b&#39;, &#39;00ca646b4275406df639cf603756f63d77&#39;, &#39;0cf2d0b5bfdd68cf777a0c12f806a569&#39;, &#39;7ab21306b11ff280a93fc445876988ab&#39;, &#39;00f097e59809ae2e771b7b9ae5fc3408d7&#39;, &#39;00d3356318924c8c42959bf1d1574e6482&#39;, &#39;00e38259cf24cc702ce441b683ad578911&#39;, &#39;00b61b8e71514059adc604da05c283e514&#39;, &#39;51cd5393514f7ace2b407c3dbfb09d8d&#39;, &#39;00b2e730b0526f36faf7d093d48d6d9997&#39;, &#39;3cee26c125b8c188f316c3fa78d9c2f1&#39;, &#39;7156ec47ef01ab8359ef4304e5af1a05&#39;, &#39;5c7e78f53c31d6aa5b45de14b47eb5c4&#39;, &#39;00dadf44e4046372313ee97b8e394c4079&#39;, &#39;00f8c2e08438bb0e9adc955e4b493e5821&#39;, &#39;70e1ebd170db8102d8c28e58392e5632&#39;, &#39;00c167f04b338b1e8747b92c2197403c43&#39;, &#39;00e04a344b397f752a45b128a594a3d6b5&#39;, &#39;00a7989f8be0c82d35a19e7b3dd4be30e5&#39;, &#39;08622b9dd9d78e67678ecc21e026522e&#39;, &#39;3696883055975d571199c6b5d48f3cd5&#39;, &#39;5b440a47e8ce3dd202271e5c7a666c78&#39;, &#39;690910dc89d7857c3500fb74bed2b08d&#39;, &#39;00d59a05955a4a421500f9561ce983aac4&#39;, &#39;00c2fc83d458e653837fcfc132c9b03062&#39;, &#39;016836311fc39fbb8e6f308bb03cc2b3&#39;, &#39;4743e140c05b33f0449023946bd05acb&#39;, &#39;aa28c9bd16d9d304f18af223b27bfa1e&#39;, &#39;00d627f1000d12485995514bfbdefc55d9&#39;, &#39;6e0ccbdfb4777e10ea6221b90dc350c2&#39;, &#39;1249aa2ada4967969b71ce63bf187c38&#39;, &#39;00e5ad42c509a7c24605530d35832c091e&#39;, &#39;38989ec61ecdb7391ff5647f7d58ad18&#39;, &#39;1a311630876f694fe1b75d972a953bca&#39;, &#39;4a7f07c5d4ad2e23f9e8e03f0e229dd4&#39;, &#39;00d4ef1ab6ab5d3cb35e4efb7984def7a2&#39;, &#39;37f3384b16d4eef0a9b3344b50f1d8a3&#39;, &#39;4e7545c9fc5938f5198ab9f1749ca31c&#39;);</td>
		</tr>
	</tbody>
</table>

<p>&nbsp;</p>

<div style="page-break-after: always"><span style="display: none;">&nbsp;</span></div>

<h3>Associated indicators (IOCs)</h3>

<p>The following technical indicators are associated with the reported intelligence. A list of indicators is also available in the <a href="https://otx.alienvault.com/pulse/603424bf09f30c4b8e8af5be" target="_blank">OTX Pulse</a>. Please note, the pulse may include other activities related but out of the scope of the report.</p>

<table style="border-collapse:collapse">
	<tbody>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:1px solid #959595; height:26px; width:97px">
			<p>TYPE</p>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:1px solid #959595; height:26px; width:311px">
			<p>INDICATOR</p>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:1px solid #959595; height:26px; width:216px">
			<p>DESCRIPTION</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:33px; width:97px">
			<p>HOSTNAME</p>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:33px; width:311px">
			<p>1[.]nvprivateoffice[.]info</p>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:33px; width:216px">
			<p>QakBot C2</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:33px; width:97px">
			<p>SHA256</p>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:33px; width:311px">
			<p>17cd3c11fba639c1fe987a79a1b998afe741636ac607254cc134eea02c63f658</p>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:33px; width:216px">
			<p>QakBot Maldoc Lure</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:33px; width:97px">
			<p>SHA256</p>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:33px; width:311px">
			<p>3be905066595dc785c9b6b98bfb2d9e0478f32df31337a8aeec96d7ccd52769e</p>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:33px; width:216px">
			<p>QakBot Loader</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:33px; width:97px">
			<p>SHA256</p>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:33px; width:311px">
			<p>6850bd6206735cc62b932900fceddfd7218e30a9f4b82c84cb15a0060726b436</p>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:33px; width:216px">
			<p>QakBot DLL Final Payload</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:33px; width:97px">
			<p>SHA256</p>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:33px; width:311px">
			<p>bf9efaf79a6990bbd9b378d05a609e0ad9d3a501a56a85e04479682435c22b0a</p>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:33px; width:216px">
			<p>Signed QakBot Loader, Signer &ldquo;SHOECORP LIMITED&rdquo;</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:33px; width:97px">
			<p>SHA256</p>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:33px; width:311px">
			<p>03412f800b9b512258e462aed00ee5725fcb970979e828d43069877e06a38f28</p>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:33px; width:216px">
			<p>Signed QakBot Loader, Signer &ldquo;DILA d.o.o.&rdquo;</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:33px; width:97px">
			<p>SHA256</p>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:33px; width:311px">
			<p>43d20a15d5e9cd51454a35946d762687cc2921a4581844ae32acd86427aadaab</p>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:33px; width:216px">
			<p>Signed QakBot Loader, Signer &ldquo;PKV Trading ApS&rdquo;</p>
			</td>
		</tr>
		<tr>
			<td style="border-bottom:1px solid #959595; border-left:1px solid #959595; border-right:1px solid #959595; border-top:none; height:33px; width:97px">
			<p>SHA256</p>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:33px; width:311px">
			<p>0f597a709ad87855695a88a71c46b690d1049d01da1d30c47927d8acba5fcc23</p>
			</td>
			<td style="border-bottom:1px solid #959595; border-left:none; border-right:1px solid #959595; border-top:none; height:33px; width:216px">
			<p>Signed QakBot Loader, Signer &ldquo;A.B. gostinstvo trgovina posredni&scaron;tvo in druge storitve, d.o.o.&rdquo;</p>
			</td>
		</tr>
	</tbody>
</table>

<h3>Mapped to MITRE ATT&amp;CK</h3>

<p>The findings of this report are mapped to the following <a href="https://attack.mitre.org/">MITRE ATT&amp;CK Matrix</a> techniques:</p>

<ul>
	<li>Initial Access
	<ul>
		<li>T1566: Phishing
		<ul>
			<li>T1566.001: Spearphishing Attachment</li>
			<li>T1566.002: Spearphishing Link</li>
			<li>T1566.003: Spearphishing via Service</li>
		</ul>
		</li>
	</ul>
	</li>
	<li>Execution
	<ul>
		<li>T1204: User Execution
		<ul>
			<li>T1204.001: Malicious Link</li>
			<li>T1204.002: Malicious File</li>
		</ul>
		</li>
		<li>T1059: Command and Scripting Interpreter
		<ul>
			<li>T1059.005: Visual Basic</li>
		</ul>
		</li>
		<li>T1053: Scheduled Task/Job
		<ul>
			<li>T1053.005: Scheduled Task</li>
		</ul>
		</li>
		<li>T1129: Shared Modules</li>
		<li>T1106: Native API</li>
		<li>T1047: Windows Management Instrumentation</li>
	</ul>
	</li>
	<li>Defense Evasion
	<ul>
		<li>T1027: Obfuscated Files or Information
		<ul>
			<li>T1027.002: Software Packing</li>
		</ul>
		</li>
		<li>T1553: Subvert Trust Controls
		<ul>
			<li>T1553.002: Code Signing</li>
		</ul>
		</li>
		<li>T1218: Signed Binary Proxy Execution
		<ul>
			<li>T1218.010: Regsvr32</li>
		</ul>
		</li>
		<li>T1497: Virtualization/Sandbox Evasion
		<ul>
			<li>T1497.001: System Checks</li>
			<li>T1497.002: User Activity Based Checks</li>
			<li>T1497.003: Time Based Evasion</li>
		</ul>
		</li>
		<li>T1112: Modify Registry</li>
		<li>T1070: Indicator Removal on Host
		<ul>
			<li>T1070.004: File Deletion</li>
		</ul>
		</li>
		<li>T1140: De-obfuscate/Decode Files or Information</li>
	</ul>
	</li>
	<li>Command and Control
	<ul>
		<li>T1090: Proxy
		<ul>
			<li>T1090.003: Multi-hop Proxy</li>
		</ul>
		</li>
		<li>T1105: Ingress Tool Transfer</li>
	</ul>
	</li>
	<li>Privilege Escalation
	<ul>
		<li>T1055: Process Injection
		<ul>
			<li>T1055.012: Process Hollowing</li>
		</ul>
		</li>
	</ul>
	</li>
	<li>Discovery
	<ul>
		<li>T1082: System Information Discovery</li>
		<li>T1049: System Network Connections Discovery</li>
		<li>T1016: System Network Configuration Discovery</li>
		<li>T1057: Process Discovery</li>
		<li>T1033: System Owner/User Discovery</li>
		<li>T1518: Software Discovery
		<ul>
			<li>T1518.001: Security Software Discovery</li>
		</ul>
		</li>
	</ul>
	</li>
	<li>Persistence
	<ul>
		<li>T1546: Event Triggered Execution</li>
		<li>T1547: Boot or Logon Autostart Execution
		<ul>
			<li>T1547.001: Registry Run Keys / Startup Folder</li>
		</ul>
		</li>
	</ul>
	</li>
</ul>
									<div class="blog-related">
									<div class="be-ix-link-block"></div>
									</div>
								</div>
								<div class="blog-author">
									<a href="https://cybersecurity.att.com/blogs/author/dax-morrow" class="blog-avatar">
									
										<img src="data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22150px%22%20height%3D%22150px%22%3E%3Crect%20fill%3D%22none%22%20width%3D%22150%22%20height%3D%22150%22%2F%3E%3C%2Fsvg%3E" data-original="/avatars/uploads/avatar_346_1.jpg" width="150" height="150" alt="Dax Morrow" />
									
									</a>

									<div class="blog-author-info">
										<p><strong>About the Author:</strong> <span>Dax Morrow</span></p>
										<p>Dax is a Security Researcher at Alien Labs, a part of AT&T Cybersecurity. He can be found on LinkedIn and Twitter. </p>


										<p><a href="/blogs/author/dax-morrow">Read more posts from Dax Morrow ›</a></p>

									</div>
								</div>


								<div class="blog-categories">
								<p>TAGS: <a href="/blogs/tag/malware+research" title="malware research" rel="nofollow">malware research</a>, <a href="/blogs/tag/alien+labs" title="alien labs" rel="nofollow">alien labs</a>, <a href="/blogs/tag/otx+pulse" title="otx pulse" rel="nofollow">otx pulse</a>, <a href="/blogs/tag/qakbot" title="qakbot" rel="nofollow">qakbot</</p>
								</div>


								<p><a href="https://cybersecurity.att.com/blogs/labs-research" class="back-to-all">‹ BACK TO ALL BLOGS</a></p>
							</div>
							
							<div class="col-sm-4">
								<div>
									<div class="blog-sidebar-block">
    <form id="searchbox_002748587151982842036:gharkgtx6cu" action="/search-results/blog" class="sidebar-search">
        <input value="002748587151982842036:gharkgtx6cu" name="cx" type="hidden" />
        <input value="FORID:11" name="cof" type="hidden" />
        <div class="search-button">
            <input value="Search" name="sa" type="submit" />
        </div>
        <div class="search-field">
            <input id="q" name="q" type="text" placeholder="Search our blogs" />
        </div>
    </form>
</div>

<div class="blog-subscribe-grid" id="blog-subscribe-box">

    <h2>Get the latest security news in your inbox.</h2>

    <p class="text-center"><a class="btn btn-blue digestoform" id="digestobutton" target="_blank">Subscribe via email</a></p>

    <script>window.addEventListener('DOMContentLoaded', function() { var href_string="https://pages.alienvault.com/Digesto.html"+get_cookie_url_string()+"&redirect=https://cybersecurity.att.com/forms/email-thank-you";document.getElementById("digestobutton").href=href_string;});</script>
</div>
<p style="text-align: right; margin: 30px 10px 5px 0;"><a href="http://feeds.feedblitz.com/alienvault-blogs" target="_blank"><img src="https://cdn-cybersecurity.att.com/images/uploads/icons/rss.svg" width="20" height="20" style="display: inline-block; margin: 0 7px 2px;">RSS</a>
</p>
									<div class="promo-block">
										
													
			<style type="text/css">#blog-promo-block-v2 .blog-promo-item-v2 {
    box-shadow: 1px 1px 5px #D2D2D229;
    border: 1px solid #D2D2D2;
    margin-bottom: 30px;
}
#blog-promo-block-v2 .blog-promo-item-v2 .blog-promo-resource-type-v2 {
    font-size: 14px;
    color: #0568AE;
    font-weight: 500;
    padding: 15px;
    margin: 0;
}
#blog-promo-block-v2 .blog-promo-item-v2 .blog-promo-item-text-v2 {
    margin-bottom:15px;
}
#blog-promo-block-v2 .blog-promo-item-v2 .blog-promo-item-text-v2 a {
    color: black;
    text-decoration: none;
    font-weight: 500;
}
#blog-promo-block-v2 .blog-promo-item-v2 .blog-promo-item-text-v2 p {
   margin: 0 15px;
}

#blog-promo-block-v2 .blog-promo-item-icon-v2 {
   margin: 15px;
   font-size: 16px;
}
#blog-promo-block-v2 .blog-promo-item-icon-v2 .icon-right {
    width: 20px;
    height: 20px;
    border: 1px solid #0568ae;
    border-radius: 20px;
    font-size: 9.5px;
    line-height: 18px;
    font-weight: 400;
    margin-right: 10px;
    padding-left: 4px;
    top: -1px;
}
@media (max-width: 1024px) {
 .blog-promo-item-v2 img {
    display: none;
  }
}
</style>
<div id="blog-promo-block-v2">
<h3>Featured resources</h3>

<div class="blog-promo-item-v2"><img src="https://cdn-cybersecurity.att.com/images/uploads/resource-images/5g-and-the-journey.jpg" />
<p class="blog-promo-resource-type-v2">INDUSTRY REPORT</p>

<div class="blog-promo-item-text-v2">
<p><a href="/resource-center/industry-reports/cybersecurity-insights-report-tenth-edition">AT&amp;T Cybersecurity Insights&trade; Report:<br />
5G and the Journey to the Edge</a></p>
</div>

<div class="blog-promo-item-icon-v2"><span aria-hidden="true" class="icon-right glyphicon glyphicon-chevron-right">&nbsp;</span> <a href="/resource-center/industry-reports/cybersecurity-insights-report-tenth-edition">Learn more</a></div>
</div>

<div class="blog-promo-item-v2"><img src="https://cdn-cybersecurity.att.com/images/uploads/resource-images/security-maturity-assessment.jpg" />
<p class="blog-promo-resource-type-v2">SELF ASSESSMENT</p>

<div class="blog-promo-item-text-v2">
<p><a href="/resource-center/security-maturity-assessment?utm_internal=blog-rail-assess">Benchmark your cybersecurity maturity</a></p>
</div>

<div class="blog-promo-item-icon-v2"><span aria-hidden="true" class="icon-right glyphicon glyphicon-chevron-right">&nbsp;</span> <a href="/resource-center/security-maturity-assessment?utm_internal=blog-rail-assess">Explore</a></div>
</div>
</div>
		
										

									</div>
								</div>
							</div>
						</div>
					</div>
				</section>


			</main>


			
			<style>

    /* Sticky button */
    .desktop .sticky_bottom_keeper {
        height: 80px;
    }
    .sticky_bottom_desktop.fixed {
        height: 80px;
    }
    .sticky_bottom_keeper .btn {
        color: #fff;
    }
    .sticky_bottom_keeper .btn-white {
        border: 2px solid #fff;
    }
    .sticky_bottom_keeper .btn-white.btn-border {
        background: transparent;
    }




    .line.line-8 {
        height: 8px;
    }

    .hh .sticky_bottom_keeper {
        display: none;
    }


</style>
<div class="sticky_bottom_keeper">

    <div class="sticky_bottom sticky_bottom_desktop ibp">
        <a href="/pricing/request-quote?utm_internal=sb_quote" class="btn btn-border btn-white btn-rounded btn-with-arrow">Get price</a>
        <a href="/products/usm-anywhere/free-trial?utm_internal=sb_freetrial_modal" class="btn btn-border btn-white btn-rounded btn-with-arrow">Free trial</a>

    </div>

</div>

			
		


		<footer id="footer" class="hidden-print">
  <div class="container-fluid">
    <div class="row">
      <div class="col-sm-6 col-md-3">
        
        <div class="footer_logo"><img src="data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22263px%22%20height%3D%2256px%22%3E%3Crect%20fill%3D%22none%22%20width%3D%22263%22%20height%3D%2257%22%2F%3E%3C%2Fsvg%3E" data-original="https://cdn-cybersecurity.att.com/images/uploads/logos/att_biz_hz_pref_rgb_white.png" alt="AT&T Business"></div>
        <div class="footer_featured">

          <div class="footer_featured_title">From the Blog</div>
          <article class="footer_featured_article">
            <div class="footer_featured_article_author clearfix">
	            
										<img src="data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22150px%22%20height%3D%22150px%22%3E%3Crect%20fill%3D%22none%22%20width%3D%22150%22%20height%3D%22150%22%2F%3E%3C%2Fsvg%3E" data-original="/avatars/uploads/avatar_346_1.jpg" width="150" height="150" alt="Dax Morrow" />
									
              <div class="footer_featured_article_author_data">
                <h4>Dax Morrow</h4>
                <time datetime="2021-05-15">Apr 15, 2021</time>
              </div>
            </div>
            <h3><a href="https://cybersecurity.att.com/blogs/labs-research/the-rise-of-qakbot" id="footer-link-blog-post">The rise of QakBot</a></h3>
          </article>
          <a id="footer-link-blog-all" href="/blogs" class="footer_featured_more">Explore All Blog Posts
            &#8250;</a>
        </div>
        

        <div class="social-style">
          <a href="https://www.twitter.com/attcyber/" class="social-link-twitter" target="_blank">Twitter</a>
          <a href="https://www.linkedin.com/company/attcybersecurity/" class="social-link-linkedin" target="_blank">Linkedin</a>
          <a href="https://www.facebook.com/ATTCyber/" class="social-link-facebook" target="_blank">Facebook</a>
          <a href="https://www.youtube.com/c/attcybersecurity" class="social-link-youtube" target="_blank">Youtube</a>
          <a href="https://www.instagram.com/attbusiness/" class="social-link-instagram" target="_blank">Instagram</a>
          <a href="https://community.spiceworks.com/pages/attcybersecurity" class="social-link-spiceworks" target="_blank">Spiceworks</a>


        </div>
      </div>

      <div class="col-sm-6 col-md-3">
        <div class="footer_links">
          <div class="heading">Who We Are</div>
          <ul>
            <li><a id="footer-link-labs" href="/alien-labs">Alien Labs</a></li>
            <li><a id="footer-link-customers" href="/who-we-are/customers">Customers</a></li>
            <li><a id="footer-link-careers" href="/who-we-are/careers">Careers</a></li>
            <li><a id="footer-link-contact" href="/contact">Contact Us</a></li>
          </ul>
        </div>

        <div class="footer_links">
          <div class="heading">News</div>
          <ul>
            <li><a id="footer-link-news-room" href="/who-we-are">Newsroom</a></li>
            <li><a id="footer-link-events" href="/who-we-are/events">Events</a></li>
            <li><a id="footer-link-blogs" href="/blogs">Blogs</a></li>
          </ul>
        </div>

        <div class="footer_links">
          <div class="heading">Partners</div>
          <ul>
            <li><a id="footer-link-partners" href="/partners">Partner Programs</a></li>
            <li><a id="footer-link-partner-portal" href="/partners/partner-portal/">Partner Portal</a></li>
          </ul>
        </div>
      </div>

      <div class="col-sm-6 col-md-3">
        <div class="footer_links">
          <div class="heading">Products</div>
          <ul>
		  	<li><a id="footer-link-mtdr" href="/products/managed-threat-detection-and-response">AT&T Managed Threat Detection and Response</a></li>
            <li><a id="footer-link-usm-anywhere" href="/products/usm-anywhere">USM Anywhere</a></li>
            <li><a id="footer-link-usm-mssp" href="/products/usm-for-mssp">USM for MSSPs</a></li>
            <li><a id="footer-link-otx" href="/open-threat-exchange">Open Threat Exchange (OTX)</a></li>
            <li><a id="footer-link-ossim" href="/products/ossim">OSSIM</a></li>

          </ul>
        </div>



        <div class="footer_links">
          <div class="heading">Solutions</div>
          <ul>
            <li><a id="footer-link-cloud-security" href="/solutions/cloud-security-monitoring">Cloud Security Monitoring</a></li>
            <li><a id="footer-link-threat-detection" href="/solutions/threat-detection">Threat Detection</a></li>
            <li><a id="footer-link-ids" href="/solutions/intrusion-detection-system">Intrusion Detection</a></li>
            <li><a id="footer-link-siem" href="/solutions/siem-platform-solutions">SIEM platform solutions</a></li>
            <li><a id="footer-link-vulnerability" href="/solutions/vulnerability-assessment-remediation">Vulnerability
                Assessment</a></li>
            <li><a id="footer-link-all-solutions" class="btn-with-arrow" href="/solutions">See All Solutions</a></li>
          </ul>
        </div>
      </div>

      <div class="col-sm-6 col-md-3">
        <div class="footer_links">
          <div class="heading">Resources</div>
          <ul>
            <li><a id="footer-link-resources" href="/resource-center">Resources</a></li>
            <li><a id="footer-link-blog" href="/blogs">Blogs</a></li>
            <li><a id="footer-link-reference-guide" href="https://www.business.att.com/content/dam/attbusiness/guides/att-information-and-network-security-customer-reference-guide.pdf" target="_blank">Customer Reference Guide</a></li>

          </ul>
        </div>

        <div class="footer_links">
          <div class="heading">Customer Success</div>
          <ul>
            <li><a id="footer-link-support" href="/support">Support &amp; Services</a></li>
            <li><a id="footer-link-customer-portal" href="https://success.alienvault.com" target="_blank">Success Center</a></li>
            <li><a id="footer-link-documentation" href="/documentation">Documentation Center</a></li>
            <li><a id="footer-link-classroom-training" href="/training">Training</a></li>
            <li><a id="footer-link-certification" href="/certification">Certification</a></li>
          </ul>
        </div>

        <div class="footer_contact">
          <a href="/contact" id="footer-button-contact" class="btn btn-blue margin-bottom20">Contact us</a>
        </div>
      </div>
    </div>
    <div class="footer_legal">
      <p class="footer_legal_copy">&copy; Copyright 2021</p>
      <ul class="footer_legal_links">
        <li><a id="footer-link-privacy" href="/legal/privacy-policy">Privacy Policy</a></li>
        <li><a id="footer-link-terms" href="/terms/website-terms-of-use07may2018">Website Terms of Use</a></li>
        <li><a id="footer-link-gdpr" href="/legal/gdpr">GDPR</a></li>
        <li><a id="footer-link-cookie" href="/legal/cookie-policy">Cookie Policy</a></li>
        <li><a id="footer-link-personal-info" href="https://about.att.com/csr/home/privacy/rights_choices.html" target="_blank">Do Not Sell My Personal Information</a></li>

      </ul>
    </div>
  </div>
</footer>

<div id="valid_content"></div>

		
	<script src="https://cdn-cybersecurity.att.com/js/v2/imports/blog-bundle.min.js?v=20210413215850" defer></script>






		



<div class="cookie-notice">
    <p>We use cookies to provide you with a great user experience. By using our website, you agree to our <a href="https://www.att.com/privacy">Privacy Policy</a> and <a href="/terms/website-terms-of-use07may2018">Website Terms of Use</a>.</p>
    <a class="cookie-notice-close" href="#" aria-label="Close Cookie Notice"><span class="glyphicon glyphicon-remove"></span></a>
</div>


<!-- WGT-10310 -->

<!-- END WGT-10310 -->




<script>
if (typeof ddo !== "undefined") {initAdobePageTrackingFooter();}

function initAdobePageTrackingFooter() {
    
    customAdobeTrackingPageLoadObj['page.pageInfo.pageTitle'] = document.title.trim();

    

    customAdobeTrackingPageLoadObj['page.pageInfo.friendlyPageName'] = 'CYB '+ document.title.trim() +' Pg';

    customAdobeTrackingPageLoadObj['page.pageInfo.language'] = 'EN';
    customAdobeTrackingPageLoadObj['page.pageInfo.lineOfBusiness'] = 'Business Solutions';
    customAdobeTrackingPageLoadObj['page.category.pageFunction'] = 'Learn';
    customAdobeTrackingPageLoadObj['page.category.pageOwnership'] = 'Business';
    customAdobeTrackingPageLoadObj['page.attributes.applicationName'] = 'CYB';
    customAdobeTrackingPageLoadObj['page.pageInfo.appCode'] = 'ACS';
    customAdobeTrackingPageLoadObj['page.category.siteSection'] = 'CYB';
    customAdobeTrackingPageLoadObj['page.category.siteSection'] = 'CYB';
    customAdobeTrackingPageLoadObj['page.media.class'] = 'Text';
    customAdobeTrackingPageLoadObj['page.media.objective'] = 'Awareness';
    customAdobeTrackingPageLoadObj['page.media.category'] = 'Security';
    customAdobeTrackingPageLoadObj['page.location.domain'] = window.location.hostname;
	ddo.pushEvent('pageLoad', 'Page_Load', customAdobeTrackingPageLoadObj);
}
</script>


		<script>
			window.addEventListener('DOMContentLoaded', function() {
				$(window).load(function () {
					var hideSubscribe = AV.Utilities.readCookie('stickyBlogSubscribe');
					// if the cookie hasn't been set...
					if (hideSubscribe == null) {
						setTimeout(function () {
							// make the modal appear
							$('#blog-subscribe-box').fadeIn();
						}, 10000);

						// when the "Close" button is clicked
						$('.blog-subscribe-close-btn').click(function (e) {
							e.preventDefault();
							// set the cookie
							AV.Utilities.setCookie('stickyBlogSubscribe', true, 1);
							$('#blog-subscribe-box').fadeOut();
						});
					}
				});
			});
		</script>

	<script type="text/javascript" >var _cf = _cf || [];  _cf.push(['_setFsp', true]);  _cf.push(['_setBm', true]);  _cf.push(['_setAu', '/libraries/587f91f31no23331406e461ab4dfa32']); </script><script type="text/javascript"  src="/libraries/587f91f31no23331406e461ab4dfa32"></script></body>
</html>
<!-- Debug: total time - 0.0027079582214355 -->