<!DOCTYPE html>
<html lang="en">

<head class="sans-serif">

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="baidu-site-verification" content="KeThzeyMOr" />
    <meta name="baidu-site-verification" content="code-NIlrS7gNhx" />

    <title>Too Old To Rocket Load, Too Young To Die</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css"
        href="https://cdnjs.cloudflare.com/ajax/libs/tippy.js/3.4.1/themes/light.css" />

    <link rel="stylesheet" type="text/css" href="/assets/built/index.css?v=fdf4009e30" />

    <script type="text/javascript" src="/assets/built/index.js?v=fdf4009e30"></script>
    <script src="/assets/js/check-for-tex.js" defer></script>

    <meta name="description" content="Rocket Loader is in the news again. One of Cloudflare&#x27;s earliest web performance products has been re-engineered for contemporary browsers and Web standards.

It controls the load and execution of your JavaScript, ensuring useful, meaningful page content is unblocked and displayed sooner." />
    <link rel="shortcut icon" href="/favicon.png" type="image/png" />
    <link rel="canonical" href="https://blog.cloudflare.com/too-old-to-rocket-load-too-young-to-die/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    
    <meta property="og:site_name" content="The Cloudflare Blog" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Too Old To Rocket Load, Too Young To Die" />
    <meta property="og:description" content="Rocket Loader is in the news again. One of Cloudflare&#x27;s earliest web performance products has been re-engineered for contemporary browsers and Web standards.

It controls the load and execution of your JavaScript, ensuring useful, meaningful page content is unblocked and displayed sooner." />
    <meta property="og:url" content="https://blog.cloudflare.com/too-old-to-rocket-load-too-young-to-die/" />
    <meta property="og:image" content="https://blog.cloudflare.com/content/images/2018/07/rocket-loader@4x-3.png" />
    <meta property="article:published_time" content="2018-07-04T14:58:21.000Z" />
    <meta property="article:modified_time" content="2018-12-13T22:59:59.000Z" />
    <meta property="article:tag" content="Rocket Loader" />
    <meta property="article:tag" content="Product News" />
    <meta property="article:tag" content="Speed &amp;amp; Reliability" />
    <meta property="article:tag" content="Optimization" />
    
    <meta property="article:publisher" content="https://www.facebook.com/cloudflare" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Too Old To Rocket Load, Too Young To Die" />
    <meta name="twitter:description" content="Rocket Loader is in the news again. One of Cloudflare&#x27;s earliest web performance products has been re-engineered for contemporary browsers and Web standards.

It controls the load and execution of your JavaScript, ensuring useful, meaningful page content is unblocked and displayed sooner." />
    <meta name="twitter:url" content="https://blog.cloudflare.com/too-old-to-rocket-load-too-young-to-die/" />
    <meta name="twitter:image" content="https://blog.cloudflare.com/content/images/2018/07/rocket-loader@4x-3.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Peter Belesis" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Rocket Loader, Product News, Speed &amp; Reliability, Optimization" />
    <meta name="twitter:site" content="@cloudflare" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "The Cloudflare Blog",
        "logo": {
            "@type": "ImageObject",
            "url": "https://blog-cloudflare-com-assets.storage.googleapis.com/2019/06/logo-cloudflare-dark-1.svg",
            "width": 109,
            "height": 40.5
        }
    },
    "author": {
        "@type": "Person",
        "name": "Peter Belesis",
        "image": "https://blog.cloudflare.com/content/images/2018/06/EjYeARURLAZJx59NtgSo_1204a20b3d1d96bba523a6a2a5fa3cd73bd4fe59240a27ad6eb8c064c6792446.jpg",
        "url": "https://blog.cloudflare.com/author/peter-belesis/",
        "sameAs": []
    },
    "headline": "Too Old To Rocket Load, Too Young To Die",
    "url": "https://blog.cloudflare.com/too-old-to-rocket-load-too-young-to-die/",
    "datePublished": "2018-07-04T14:58:21.000Z",
    "dateModified": "2018-12-13T22:59:59.000Z",
    "image": "https://blog.cloudflare.com/content/images/2018/07/rocket-loader@4x-3.png",
    "keywords": "Rocket Loader, Product News, Speed & Reliability, Optimization",
    "description": "Rocket Loader is in the news again. One of Cloudflare&#x27;s earliest web performance products has been re-engineered for contemporary browsers and Web standards.\n\nIt controls the load and execution of your JavaScript, ensuring useful, meaningful page content is unblocked and displayed sooner.",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://blog.cloudflare.com/"
    }
}
    </script>

    <meta name="generator" content="Ghost 3.5" />
    <link rel="alternate" type="application/rss+xml" title="The Cloudflare Blog" href="https://blog.cloudflare.com/rss/" />
    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','cfDataLayer','GTM-PKQFGQB');</script>
<!-- End Google Tag Manager -->

<!-- Google Optimize -->
<script src="https://www.googleoptimize.com/optimize.js?id=GTM-N4JSZJ8"></script>

<link rel="shortcut icon" href="https://blog.cloudflare.com/content/images/2019/12/favicon-8.png" type="image/png">

<meta name="msvalidate.01" content="CF295E1604697F9CAD18B5A232E871F6" />
<meta class="swiftype" name="language" data-type="string" content="en" />
<!--<script src="/assets/js/index.js"></script>-->
<script type="text/javascript" src="//cdn.bizible.com/scripts/bizible.js" async=""></script>
<script>
var trackRecruitingLink = function(role, url) {
   ga('send', 'event', 'recruiting', 'jobscore-click', role, {
     'transport': 'beacon',
     'hitCallback': function(){document.location = url;}
   });
}
</script> 
<script type="text/javascript">
	(function() {
		var didInit = false;
		function initMunchkin() {
			if(didInit === false) {
				didInit = true;
				Munchkin.init('713-XSC-918');
			}
		}
		var s = document.createElement('script');
		s.type = 'text/javascript';
		s.async = true;
		s.src = '//munchkin.marketo.net/munchkin.js';
		s.onreadystatechange = function() {
			if (this.readyState == 'complete' || this.readyState == 'loaded') {
				initMunchkin();
			}
		};
		s.onload = initMunchkin;
		document.getElementsByTagName('head')[0].appendChild(s);
		})();
</script>
<script>
var HTMLAttrToAdd = document.querySelector("html");
HTMLAttrToAdd.setAttribute("lang", "en");
</script>
<style>
    table {
        background-color: transparent;
    }
    td {
		padding: 5px 1em;
    }
    pre {
        max-height: 500px;
        overflow-y: scroll;
    }
</style>
<!-- Cloudflare Web Analytics -->
<script
        defer
        src='https://static.cloudflareinsights.com/beacon.min.js'
        data-cf-beacon='{"token": "f446eacb44504e50864bad7c47ffa9e8"}'></script>
<!-- End Cloudflare Web Analytics -->
    <style>
pre code.language-html,
pre code.language-javascript{
    font-size:0.8em;
	line-height:1.5em;    
}
</style>

</head>

<body id="main-body" class="post-template tag-rocketloader tag-product-news tag-speed-and-reliability tag-optimization tag-lindered sans-serif">

    <div class="site-wrapper">

        <header class="flex flex-row flex-wrap justify-between items-end mw8 center mv3 pl3 pr2">
    <div class="w-100 flex items-end justify-between justify-start-l">
        <div class="w-100 tr">
            <span class="dn di-l">
                <a href="https://www.cloudflare.com/plans/enterprise/contact/" class="f1 gray4 no-underline underline-hover">Contact Sales:
                </a>
                <a href="tel:+18889935273" class="f1 gray4 no-underline underline-hover">+1 (888) 274-3482</a>
            </span>
        </div>
    </div>
    <div class="w-100 w-50-l flex items-end justify-between justify-start-l">
        <a href="https://blog.cloudflare.com" class="header-logo mr4">
            <img src="https://blog-cloudflare-com-assets.storage.googleapis.com/2019/06/logo-cloudflare-dark-1.svg" alt="The Cloudflare Blog" class="header-logo" />
        </a>
        <h2 class="mt0 mb1">
            <a href="/" class="fw5 f5 gray3 no-underline">
                <span class="dn di-l">The Cloudflare Blog</span>
            </a>
        </h2>
    </div>
    <div class="w-100 w-50-l dn db-l">
        <div class="w-100 tr mkto-sub-message">
            <p class="f2">Thanks for being here, come back soon. Get notified of new posts:</p>
        </div>
        <div class="w-100 tr">
            <script src="//app-ab13.marketo.com/js/forms2/js/forms2.min.js"></script>
            <div class="marketo-form-container">
                <form id="mktoForm_1653"></form>
            </div>
            <script>
                MktoForms2.loadForm("//app-ab13.marketo.com", "713-XSC-918", 1653, function(form) {
                    document.querySelectorAll('#mktoForm_1653 .mktoEmailField')[0].placeholder = "Email Address";

                    form.onSuccess(function(vals, thanksURL){
                        // Hide form and show success msg
                        document.getElementById("mktoForm_1653").style.display = "none";
                        document.getElementsByClassName("mkto-sub-message")[0].style.display = "none";

                        document.getElementsByClassName("js-form-success-msg")[0].style.display = "block";
                        return false;
                    });
                });
            </script>
        </div>
        <div class="w-100 tr dn js-form-success-msg">
            <p class="f2">Subscription confirmed. Thank you for subscribing!</p>
        </div>
    </div>
</header>

<nav id="nav" class="w-100 bb b--black-10 z-1">
    <div id="desktop-nav-items-container" class="flex flex-row flex-wrap justify-between items-center mw8 center mv3 mv0-l">
        <div class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3" data-tag="product-news">
            <a href="/tag/product-news/" class="no-underline gray1 f2 fw5 pv3">Product News</a>
        </div>
        <div class="nav-item nav-item-desktop mh2 dn db-l pv3" data-tag="speed-and-reliability">
            <a href="/tag/speed-and-reliability/" class="no-underline gray1 f2 fw5 pv3">Speed &amp; Reliability</a>
        </div>
        <div class="nav-item nav-item-desktop mh2 dn db-l pv3" data-tag="security">
            <a href="/tag/security/" class="no-underline gray1 f2 fw5 pv3">Security</a>
        </div>
        <div class="nav-item nav-item-desktop mh2 dn db-l pv3" data-tag="serverless">
            <a href="/tag/serverless/" class="no-underline gray1 f2 fw5 pv3">Serverless</a>
        </div>
        <div class="nav-item nav-item-desktop mh2 dn db-l pv3" data-tag="cloudflare-network">
            <a href="/tag/cloudflare-network/" class="no-underline gray1 f2 fw5 pv3">Cloudflare Network</a>
        </div>
        <div class="nav-item nav-item-desktop mh2 dn db-l pv3" data-tag="developers">
            <a href="/tag/developers/" class="no-underline gray1 f2 fw5 pv3">Developers</a>
        </div>
        <div class="nav-item nav-item-desktop mh2 dn db-l pv3" data-tag="deep-dive">
            <a href="/tag/deep-dive/" class="no-underline gray1 f2 fw5 pv3">Deep Dive</a>
        </div>
        <div class="nav-item nav-item-desktop ml2 mr3 dn db-l pv3" data-tag="life-at-cloudflare">
            <a href="/tag/life-at-cloudflare/" class="no-underline gray1 f2 fw5 pv3">Life @Cloudflare</a>
        </div>
        <a href="/search/"><img src="/assets/images/magnifier.svg?v=fdf4009e30" class="js-search-box-trigger mw2 pointer ph3 ph2-l" />
        </a>
        <img src="/assets/images/hamburger.svg?v=fdf4009e30" class="w2 pointer js-mobile-nav-trigger ph3 db dn-l" />
    </div>

    <div class="js-mobile-nav-container dn">
        <div class="flex flex-column flex-wrap bg-gray9 o-95 absolute w-100 ph3 z-1">
            <div class="pv3 ph2">
                <a href="/tag/product-news/" class="no-underline gray1 f4 fw7">Product News</a>
            </div>
            <div class="pv3 ph2">
                <a href="/tag/speed-and-reliability/" class="no-underline gray1 f4 fw7">Speed &amp; Reliability</a>
            </div>
            <div class="pv3 ph2">
                <a href="/tag/security/" class="no-underline gray1 f4 fw7">Security</a>
            </div>
            <div class="pv3 ph2">
                <a href="/tag/serverless/" class="no-underline gray1 f4 fw7">Serverless</a>
            </div>
            <div class="pv3 ph2">
                <a href="/tag/cloudflare-network/" class="no-underline gray1 f4 fw7">Cloudflare Network</a>
            </div>
            <div class="pv3 ph2">
                <a href="/tag/developers/" class="no-underline gray1 f4 fw7">Developers</a>
            </div>
            <div class="pv3 ph2">
                <a href="/tag/deep-dive/" class="no-underline gray1 f4 fw7">Deep Dive</a>
            </div>
            <div class="pv3 ph2">
                <a href="/tag/life-at-cloudflare/" class="no-underline gray1 f4 fw7">Life @Cloudflare</a>
            </div>
        </div>
    </div>
</nav>
        


<main id="post" class="flex flex-row flex-wrap items-center justify-center pt2 pt4-l">
    <article
        class="post-full mw-100 ph3 ph0-l fs-20px post tag-rocketloader tag-product-news tag-speed-and-reliability tag-optimization tag-lindered ">
        <h1 class="f6 f7-l fw4 gray1 pt1 pt3-l mb1">Too Old To Rocket Load, Too Young To Die</h1>


        <p class="f3 fw5 gray5 db di-l mt2" localize datetime="2018-07-04T15:58:21+01:00">Loading...</p>
        <noscript>
            <p class="f3 fw5 gray5 db di-l mt2">July 04, 2018 3:58PM</p>
        </noscript>

        <ul class="flex flex-wrap pl0 mt4">
            <li class="list flex items-center ml0 pl0 pb1">
                <a href="/author/peter-belesis/" class="static-avatar pr1">
                    <img class="author-profile-image h2 w2 br-100 mr2" src="/content/images/2018/06/EjYeARURLAZJx59NtgSo_1204a20b3d1d96bba523a6a2a5fa3cd73bd4fe59240a27ad6eb8c064c6792446.jpg" alt="Peter Belesis" />
                </a>
                <div class="author-name-tooltip">
                    <a href="/author/peter-belesis" class="fw5 f3 no-underline black mr3">Peter Belesis</a>
                </div>
            </li>
            <li class="list flex items-center ml0 pl0 pb1">
                <a href="/author/ivan-nikulin/" class="static-avatar pr1">
                    <img class="author-profile-image h2 w2 br-100 mr2" src="/content/images/2018/07/fAhb3eFySpq2NB5eOvfy_1204a20b3d1d96bba523a6a2a5fa3cd73bd4fe59240a27ad6eb8c064c6792446.jpg" alt="Ivan Nikulin" />
                </a>
                <div class="author-name-tooltip">
                    <a href="/author/ivan-nikulin" class="fw5 f3 no-underline black mr3">Ivan Nikulin</a>
                </div>
            </li>
        </ul>

        <section class="post-full-content">
            <div class="post-content lh-copy gray1">
                <!--kg-card-begin: markdown--><p>Rocket Loader is in the news again. One of Cloudflare's earliest web performance products has been re-engineered for contemporary browsers and Web standards.</p>
<p>No longer a beta product, Rocket Loader controls the load and execution of your page JavaScript, ensuring useful and meaningful page content is unblocked and displayed sooner.</p>
<p>For a high-level discussion of Rocket Loader aims, please refer to our sister post, <a href="https://blog.cloudflare.com/we-have-lift-off-rocket-loader-ga-is-mobile/">We have lift off - Rocket Loader GA is mobile!</a></p>
<p>Below, we offer a lower-level outline of how Rocket Loader actually achieves its goals.</p>
<h3 id="prehistory">Prehistory</h3>
<p>Early humans looked upon Netscape 2.0, with its new ability to script HTML using LiveScript, and <code>&lt;BLINK&gt;</code>ed to ensure themselves they weren’t dreaming. They decided to use this technology, soon to be re-christened JavaScript (a story told often and elsewhere), for everything they didn’t know they needed: form input validation, image substitution, frameset manipulation, popup windows, and more. The sole requirement was a few interpreted commands enclosed in a <code>&lt;script&gt;</code> tag. The possibilities were endless.</p>
<p><img src="https://blog.cloudflare.com/content/images/2018/07/prehistory-@4x.png" alt="prehistory-@4x"></p>
<p>Soon, the introduction of the <code>src</code> attribute allowed them to import a file full of JS into their pages. Little need to fiddle with the markup, when all the requisite JS for the page could be included in a single, or a few, external files, specified in the page’s <code>&lt;HEAD&gt;</code>. It didn’t take our ancestors long before they decided that the same JS file(s) should be in <em>all</em> pages, throughout their website, containing JS for the complete site. No worries about bloat; after all, the browser would cache it.</p>
<p>A clear, sunny, road to dynamic, interactive sites lay ahead. What could go wrong?</p>
<p><img src="https://blog.cloudflare.com/content/images/2018/07/blockage@4x.png" alt="blockage@4x"></p>
<h3 id="blockage">Blockage</h3>
<p>Those early JS adopters deduced that when the HTML parser encountered an external script, it suspended visual rendering of the page while it went off to retrieve and execute it. Simple. The more numerous and larger the scripts, the longer the wait for the page to paint. JavaScript, therefore, was very soon, most often unnecessarily, blocking page rendering.</p>
<p>The solutions poured in, both from the developer community and browser vendors:</p>
<ul>
<li>
<p><em>Community</em>: Move script location to end of HTML page<br>
A classic <em>duh!</em> moment. Amazingly, this simple suggestion helped, unless the script was required to help build the page, eg. using <code>document.write</code> for markup.</p>
</li>
<li>
<p><em>Vendor</em>: Use <code>&lt;script defer&gt;</code>.<br>
It’s 1997, and IE4 introduces the <code>defer</code> attribute. Scripts that do not contribute to the initial rendering of the page should be marked with <code>defer</code>, and they will load in parallel, without blocking, and be executed in their markup order before <code>window.load</code> is fired (later, before <code>document.DOMContentLoaded</code>). Script tags could remain in the <code>&lt;head&gt;</code>, and execute as if they were at the end of page.<br>
The main benefit to page rendering was the saving in script retrieval time.</p>
</li>
<li>
<p><em>Community</em>: Reduce latency by reducing actual script size.<br>
What began as script <em>obfuscation</em> for intellectual property and vanity reasons, quickly became script <em><a href="https://en.wikipedia.org/wiki/Minification_(programming)">minification</a></em>, still used widely.</p>
</li>
<li>
<p><em>Community</em>: Reduce latency and http handshake instances through concatenation of all scripts, delivered as one.</p>
</li>
<li>
<p><em>Vendor</em>: Use <code>&lt;script async&gt;</code>.<br>
In 2010, 13 years (yes, 13, thirteen) after <code>defer</code> was born, HTML5 provided <code>defer</code> with a sibling, <code>async</code>. Scripts can be loaded asynchronously, be non-blocking, and be executed when they load. Markup order is irrelevant to execution order. A clear benefit over <code>defer </code>was that <code>load/DOMContentLoaded</code> events were not delayed.</p>
</li>
<li>
<p><em>Community</em>: Lazy Loading.<br>
Use JS to load JS by dynamically creating non-blocking script tags.</p>
</li>
<li>
<p><span style="color:orange"><em>Cloudflare</em>: Rocket Loader</span><br>
It's 2011, and Cloudflare enters the fray, leveraging our network to reduce http requests for 1st party scripts, “bag”ging 3rd party scripts into a single file, and delaying and controlling JS execution.<br>
See <a href="https://blog.cloudflare.com/we-have-lift-off-rocket-loader-ga-is-mobile/">Combining Javascript &amp; CSS, a Better Way</a></p>
</li>
<li>
<p><em>Vendor</em>: Use <code>&lt;link rel=&quot;preload&quot;&gt;</code> in the <code>&lt;head&gt;</code>.<br>
Important resources like scripts, in our case, can be specified for <em>preload</em>. The browser will load scripts in parallel and not block render-parsing.</p>
</li>
</ul>
<h3 id="rocketloadertheearlyyears">Rocket Loader, The Early Years</h3>
<p>Much has been written in this blog space about <a href="https://blog.cloudflare.com/tag/rocketloader/">Rocket Loader</a>, from its <a href="https://blog.cloudflare.com/how-cloudflare-rocket-loader-redefines-the-modern-cdn/">initial launch</a>, to the <a href="https://blog.cloudflare.com/we-have-lift-off-rocket-loader-ga-is-mobile/">current one</a>.</p>
<p>If reading outdated blog posts is not your thing, perhaps watching an extremely short video of a high-profile early Rocket Loader success (June 9, 2011) is:<br>
<a href="https://vimeo.com/24900882">CloudFlare Rocket Loader makes the Financial Times website (FT.com) faster</a></p>
<p>Rocket Loader improved page load times by:</p>
<ol>
<li>Minimising network requests through the bundling of JS files, including third-party, speeding up page rendering</li>
<li>Asynchronously loading the bundles, avoiding HTML parsing blockage</li>
<li>Caching scripts locally (using LocalStorage), reducing refetch requests.</li>
</ol>
<p>As browsers matured, Rocket Loader fell behind, leading to several severe shortcomings:</p>
<ul>
<li>
<p>It did not honour Content-Security-Policy.<br>
Rocket Loader was unaware of CSP headers, and loaded scripts indiscriminately.</p>
</li>
<li>
<p>It did not honour Subresource Integrity<br>
Rocket Loader loaded scripts through XHR, so browsers could not validate the fetched script.</p>
</li>
<li>
<p>It allowed for XSS Persistence<br>
Since Rocket Loader stored scripts in LocalStorage, a site’s compromised script could exist as a trojan in a customer’s storage, loading whenever the customer visited the site.</p>
</li>
<li>
<p>It was just out-of-date</p>
<ul>
<li>Script bundling fell out of favour with the introduction of http2.</li>
<li>The use of <code>eval()</code> was finally recognised as <em>evil</em>.</li>
<li>Mobile use skyrocketed; mobile browsers became sophisticated; eventually Rocket Loader was unable to support mobile.</li>
</ul>
</li>
</ul>
<h3 id="newandimprovedrocketloader">New and Improved Rocket Loader</h3>
<p>We recently rebuilt Rocket Loader from the ground up.</p>
<p>Although our aim remains the same, to improve customer page performance, we incorporated lessons learned. Most importantly, we learned not to aim too high. In order to satisfy all permutations of page layout, the old Rocket Loader created a virtual DOM, a decision that ultimately led to fragility. We've gone the simple, elegant route, knowing full well that there will be a minority of websites that will not benefit.</p>
<p><img src="https://blog.cloudflare.com/content/images/2018/07/new-and-improved-@4x.png" alt="new-and-improved-@4x"></p>
<p>The main concept behind Rocket Loader is quite straightforward: execute blocking scripts after all other page assets have loaded.</p>
<p>The scripts need to be loaded and executed in the originally intended order. Only external blocking scripts curtail page resources, but any script may rely on another one. We must simulate the <em>loading process of scripts</em>, mimicing how the browser would handle them during page load, but do it <em>after the page is actually fully loaded</em>.</p>
<h3 id="ontheserver">On the Server</h3>
<p>Rocket Loader has both a server-side and a client-side component. The goal of the former is to</p>
<ol>
<li>rewrite <code>&lt;script&gt;</code> tags in the page markup to make them non-executable, and</li>
<li>insert the client-side component of Rocket Loader into the page.</li>
</ol>
<p>The server-side component is built on top of our CF-HTML pipeline. CF-HTML is an nginx module that provides streaming HTML parsing and rewriting functionality with a SAX-style (<a href="https://en.wikipedia.org/wiki/Simple_API_for_XML">Simple API for XML</a>) API on top of it.</p>
<p>To make the scripts non-executable, we simply prepend their <code>type</code> attribute value with a randomly generated value (<a href="https://en.wikipedia.org/wiki/Cryptographic_nonce">nonce</a>), unique for each page request. Having a unique prefix for each page prevents Rocket Loader from being used as an XSS gadget to bypass various XSS filters.</p>
<p>Markup that looked like this:</p>
<pre><code class="language-HTML">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;script src=&quot;example.org/1.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;example.org/2.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    ...body markup... 
    &lt;script src=&quot;example.org/3.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
    ...more body markup... 
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>becomes:</p>
<pre><code class="language-HTML">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;script src=&quot;example.org/1.js&quot; type=&quot;42deadbeef-&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;example.org/2.js&quot; type=&quot;42deadbeef-text/javascript&quot;&gt;&lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    ...body markup... 
    &lt;script src=&quot;example.org/3.js&quot; type=&quot;42deadbeef-text/javascript&quot;&gt;&lt;/script&gt;
    ...more body markup... 
    &lt;script src=&quot;https://ajax.cloudflare.com/rocket-loader.js&quot;
            data-cf-nonce=&quot;42deadbeef&quot; defer&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>So far, no rocket science, but by making most, or all, scripts non-executable, Rocket Loader has unblocked page-parsing. Browsers display content sooner, improving perceived page load metrics, and engaging the user.</p>
<h4 id="ontheclient">On The Client</h4>
<p>Generally, scripts can be divided into four categories, each having  distinct load and execution behaviours when inserted into the DOM:</p>
<ol>
<li><em>Inline scripts</em> - executed immediately upon insertion.</li>
<li><em>External blocking scripts</em> - start loading upon insertion, preventing other scripts from loading and executing.</li>
<li><em>External</em> <code>defer</code> <em>scripts</em> - start loading upon insertion, without preventing other scripts from loading and executing. Execution should happen right before <code>DOMContentLoaded</code> event.</li>
<li><em>External <code>async</code> scripts</em> - start loading upon insertion, without preventing other scripts from  loading and executing. Executed when loaded.</li>
</ol>
<p><img src="https://blog.cloudflare.com/content/images/2018/06/loadExecute1.png" alt="loadExecute1"><br>
<small>Modified diagram from <a href="https://html.spec.whatwg.org/#attr-script-defer">HTML Standard</a></small></p>
<p>To handle load and execution of all script types, Rocket Loader needs two passes.</p>
<h4 id="passone">Pass One</h4>
<p>On the first pass, we collect all scripts with our nonce onto a stack, then re-insert them into the DOM, with nonce removed, and wrapped in a comment node. These serve as our placeholders.</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;!--&lt;script src=&quot;example.org/1.js&quot;&gt;&lt;/script&gt;--&gt; 
    &lt;!--&lt;script src=&quot;example.org/2.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;--&gt;
  &lt;/head&gt;
  &lt;body&gt;
    ...body markup...
    &lt;!--&lt;script src=&quot;example.org/3.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;--&gt;
    ...more body markup... 
    &lt;script src=&quot;https://ajax.cloudflare.com/rocket-loader.js&quot;
            data-cf-nonce=&quot;42deadbeef&quot; defer&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Rocket Loader now iterates through the scripts in our stack and re-inserts them, maintaining their intended position in relevant DOM collections (<code>document.scripts</code>, <code>document.querySelectorAll(&quot;script&quot;)</code>, <code>document.getElementsByTagName(&quot;script&quot;)</code>, etc.).</p>
<p>This process of script insertion and execution differs for each script category:</p>
<p><em>Inline scripts</em> - Placeholder is replaced with the original script element, without nonce, making the script executable. Browsers execute such scripts immediately upon insertion, <em>in the same execution tick</em>.</p>
<p><em>External blocking scripts</em> - As above, but Rocket Loader waits for the script’s <code>load</code> event before unwinding the script stack further. This delay simulates the script's blocking behaviour <em><strong>manually</strong></em>. Only parser-inserted external scripts (i.e. scripts present in the original HTML markup) are naturally blocking. External scripts inserted or created via a DOM API are considered async. This behaviour can’t be overridden, so we need our simulation.</p>
<p><em>External <code>async</code> scripts</em> - The same insertion procedure as inline scripts. Browsers treat all inserted external scripts as async, so the default behaviour suits us.</p>
<p><em>External <code>defer</code> scripts</em> - These are not executed during the first pass, since in the simulated environment we haven’t reached the <code>DOMContentLoaded</code> event yet. If we encounter a <code>defer</code> script on the stack we re-insert it, as is, without removing the nonce prefix. It remains non-executable, but in the correct DOM position.</p>
<h4 id="passtwo">Pass Two</h4>
<p>The second pass loads the <code>defer</code> scripts. Again, Rocket Loader collects all scripts with the nonce prefix (these are now just <code>defer</code> scripts) onto the execution stack, but does not replace them with placeholders. They remain in the DOM, since at this point in our simulated environment the complete document has loaded. We then activate them by replacing the <code>&lt;script&gt;</code> elements with themselves, nonce removed, and let the browser do the rest.</p>
<h4 id="quirksitamingthewaterfall">Quirks I: Taming the Waterfall</h4>
<p>Ostensibly, we have now simulated browser script loading and execution behaviours. However, there are some one-off issues we must deal with, quirks if you will.</p>
<p>There is one not-so-obvious difference between our algorithm and the real behaviour of browsers. Modern browsers try to be clever with the way they manage page resources, engaging various heuristics to improve performance during page load. These are, generally, implementation-specific and not set-in-stone by any specification.</p>
<div style="clear:both;padding-top:24px;">
<img align="right" style="margin:0 0 10px 10px" src="https://blog.cloudflare.com/content/images/2018/06/noRocketCroppedSm.png">One such optimisation that affects us, is <i>speculative parsing</i>. Despite the official specification requiring a browser to block parsing on script execution, browsers continue parsing received HTML markup speculatively, and prefetch found external resources. For example, even with blocking scripts on a page, Chrome loads them simultaneously, in parallel.
</div>
<div style="clear:both;padding-top:24px;"><img align="left" style="margin:0 10px 10px 0" src="https://blog.cloudflare.com/content/images/2018/06/prevRocketCroppedSm-1.png">With Rocket Loader, browsers don’t prefetch scripts, as our nonce makes them non-executable during page load. Later, when we sequentially re-insert activated scripts, we witness a sequential “waterfall” graph.
</div>
<div style="clear:both;padding:24px 0 24px;"><img align="right" style="margin:0 0 10px 10px" src="https://blog.cloudflare.com/content/images/2018/06/withRocketCroppedSm.png">In our attempt to improve page load performance, we significantly slowed down some script loading. Ironic. Fortunately, we have a workaround: we can insert <i>preload hints</i>
    (see <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Preloading_content">Preloading content with rel="preload"</a>) before we begin unwinding our script stack, giving the browser notice that we’ll soon be requiring these scripts. It begins fetching them as it would do during speculative parsing.
<p>Our waterfall is replaced with improved parallel loading and better load metrics.</p>
</div>
<div style="clear:both;height:24px;">&nbsp;</div>
<h4 id="quirksiidocumentwriteisnotdeadyet">Quirks II: <code>document.write()</code> is not dead yet</h4>
<p>We've simulated script execution and insertion. We still need to deal with dynamic markup insertion. We can’t use <code>document.write()</code> directly since the document is already parsed and <code>document.close()</code> has been implicitely executed. Calling <code>write()</code> will create a new document, erasing the entire current  document. We must manually parse content created by the <code>document.write</code> function and insert it in the intended location.</p>
<p>Not so simple, if one considers that <code>document.write</code> can insert partial markup. In the following example, if we parse and insert content on the first <code>document.write</code> call, we’ll completely ignore the completion of the <code>id</code> attribute that should be inserted with the second call:</p>
<pre><code class="language-javascript">document.write('&lt;div id=&quot;elm');
document.write(Date.now());
document.write('&quot;&gt;some content&lt;/div&gt;');
</code></pre>
<p>So, we have a hard choice:</p>
<ul>
<li>We can buffer <em>all</em> content inserted via <code>document.write</code> during script execution and flush it afterwards, in which case already executed code expecting elements to be in the DOM will fail, or</li>
<li>We can flush inserted markup immediately, but not handle partial markup writes.</li>
</ul>
<p>Choosing the lesser of two evils, we decided to go with the first option: our observations showed cases like these are more common.</p>
<p><small>(Actually, there is a third option that allows for handling of both cases, but it requires proxying of a significant number of DOM APIs, a rabbit hole that we don’t want to dive into, KISS FTW, you know…).</small></p>
<h4 id="quirksiiiiaintgotnobody">Quirks III: I ain't got no<code>&lt;body&gt;</code></h4>
<p>As mentioned, it’s not enough to just insert parsed markup. There are various modifications of the DOM performed by the parser during full document parsing that contend with <em>malformed markup</em>. We felt we should simulate at least some of them, because, well… scripts may rely on malformed markup.</p>
<p>Our initial implementation even included simulation of relatively exotic mechanisms such as <a href="https://html.spec.whatwg.org/multipage/parsing.html#unexpected-markup-in-tables"><em>foster parenting</em></a>, but eventually we decided to keep things simple and the only thing that Rocket Loader simulates is the squeezing out of unallowed content from the <code>&lt;head&gt;</code> element.</p>
<p>To perform this simulation we wrap our <code>document.write</code> buffer in a <code>&lt;head&gt;</code> element and feed this markup to the <a href="https://developer.mozilla.org/en-US/docs/Web/API/DOMParser">DOM Parser</a>.</p>
<p>Using the resulting document from the parser, we identify all nodes in its <code>&lt;head&gt;</code> and move them into the page, immediately following the script that performed the <code>document.write</code>. If we encounter any nodes in the parsed document's <code>&lt;body&gt;</code> element, we copy all nodes that follow the current script to the <code>&lt;body&gt;</code> element, prepended with the nodes in the parsed document.</p>
<p>To illustrate this simulation, consider the following page markup:</p>
<pre><code class="language-html">&lt;!DOCTYPE&gt;
&lt;head&gt;
  &lt;script&gt;
    document.write(‘&lt;link rel=”stylesheet” href=”1.css”&gt;’);
    document.write(‘&lt;div&gt;&lt;/div&gt;’);
    document.write(‘&lt;link rel=”stylesheet” href=”2.css”&gt;’);
  &lt;/script&gt;
  &lt;link rel=”stylesheet” href=”3.css”&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div&gt;Hey!&lt;/div&gt;
&lt;/body&gt;
</code></pre>
<p>The buffered, dynamically inserted, markup after script execution will be</p>
<pre><code class="language-html">&lt;link rel=”stylesheet” href=”1.css”&gt;
&lt;div&gt;&lt;/div&gt;
&lt;link rel=”stylesheet” href=”2.css”&gt;
</code></pre>
<p>and the string that we’ll feed to the DOMParser will be</p>
<pre><code class="language-html">&lt;!DOCTYPE&gt;
&lt;head&gt;
  &lt;link rel=”stylesheet” href=”1.css”&gt;
  &lt;div&gt;&lt;/div&gt;
  &lt;link rel=”stylesheet” href=”2.css”&gt;
&lt;/head&gt;
</code></pre>
<p>The parser will produce the following document structure from the provided markup (note that <code>&lt;div&gt;</code> is not allowed in <code>&lt;head&gt;</code> and was squeezed out to the <code>&lt;body&gt;</code>):</p>
<pre><code class="language-html">&lt;!DOCTYPE&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;link rel=”stylesheet” href=”1.css”&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div&gt;&lt;/div&gt;
  &lt;link rel=”stylesheet” href=”2.css”&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Now we move all nodes that we found in parsed document's <code>&lt;head&gt;</code> to the original document:</p>
<pre><code class="language-html">&lt;!DOCTYPE&gt;
&lt;head&gt;
  &lt;script&gt;
    document.write(‘&lt;link rel=”stylesheet” href=”1.css”&gt;’);
    document.write(‘&lt;div&gt;&lt;/div&gt;’);
    document.write(‘&lt;link rel=”stylesheet” href=”2.css”&gt;’);
  &lt;/script&gt;
  &lt;link rel=”stylesheet” href=”1.css”&gt;
  &lt;link rel=”stylesheet” href=”3.css”&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div&gt;Hey!&lt;/div&gt;
&lt;/body&gt;
</code></pre>
<p>We see that parsed document's <code>&lt;body&gt;</code> contains some nodes, so we prepend them to the original document’s <code>&lt;body&gt;</code>:</p>
<pre><code class="language-html">&lt;!DOCTYPE&gt;
&lt;head&gt;
  &lt;script&gt;
    document.write(‘&lt;link rel=”stylesheet” href=”1.css”&gt;’);
    document.write(‘&lt;div&gt;&lt;/div&gt;’);
    document.write(‘&lt;link rel=”stylesheet” href=”2.css”&gt;’);
  &lt;/script&gt;
  &lt;link rel=”stylesheet” href=”1.css”&gt;
  &lt;link rel=”stylesheet” href=”3.css”&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div&gt;&lt;/div&gt;
  &lt;link rel=”stylesheet” href=”2.css”&gt;
  &lt;div&gt;Hey!&lt;/div&gt;
&lt;/body&gt;
</code></pre>
<p>And as a final step, we move all nodes in the <code>&lt;head&gt;</code>, that initially followed the current script, to after the nodes that we’ve just inserted in the <code>&lt;body&gt;</code>:</p>
<pre><code class="language-html">&lt;!DOCTYPE&gt;
&lt;head&gt;
  &lt;script&gt;
    document.write(‘&lt;link rel=”stylesheet” href=”1.css”&gt;’);
    document.write(‘&lt;div&gt;&lt;/div&gt;’);
    document.write(‘&lt;link rel=”stylesheet” href=”2.css”&gt;’);
  &lt;/script&gt;
  &lt;link rel=”stylesheet” href=”1.css”&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div&gt;&lt;/div&gt;
  &lt;link rel=”stylesheet” href=”2.css”&gt;
  &lt;link rel=”stylesheet” href=”3.css”&gt;
  &lt;div&gt;Hey!&lt;/div&gt;
&lt;/body&gt;
</code></pre>
<div style="clear:both;height:24px;">&nbsp;</div>
<h4 id="quirksivhandlinghandlers">Quirks IV: Handling handlers</h4>
<p>There is one edge case which drastically changes the behaviour of our script-loading simulation. If we encounter elements with inline event handlers in the HTML markup, we need to execute <em>all scripts that precede such elements</em> since the handlers may rely on them.</p>
<p>We insert the Rocket Loader client side script in special &quot;bailout&quot; mode immediately before such elements. In bailout mode, we activate scripts the same way as in regular mode, except we do it in a blocking manner (remember, we need to prevent element from being parsed while we activate all preceding scripts).</p>
<p>As noted, it’s impossible to dynamically create blocking external scripts using DOM APIs such as <code>document.appendChild</code>. However, we have a solution to overcome this limitation.</p>
<p>Since the page is still loading, we can <code>document.write</code> the <code>outerHTML</code> of activatable script into the document, forcing the browser to mark it as parser-inserted and, thus, blocking. However, the script will be inserted in a DOM position different from its original, intended, position, which may break traversing of surrounding nodes from within the script (e.g. using <code>document.currentScript</code> as a starting point).</p>
<p>There is a trick. We leverage browser behaviour which parses generated content in the same execution tick as the <code>document.write</code> that produced it. We have immediate access to the written element. The <em>execution</em> of the external script is always scheduled for one of the <em>next</em> execution ticks. So, we can just move script to its original position right after we write it and have it in the correct DOM position, awaiting its execution.</p>
<h4 id="icanresisteverythingexcepttemptation">&quot;I can resist everything except temptation&quot;<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></h4>
<p>The need to account for every quirk, every variation in browser parsing, is strong, but implementation would eventually only weaken our product. We've dealt with the best part of browser parser behaviours, enough to benefit the majority of our customers.</p>
<p><img src="https://blog.cloudflare.com/content/images/2018/07/rock-house-@4x.png" alt="rock-house-@4x"></p>
<h3 id="whatsnext">What's Next?</h3>
<p>As Rocket Loader matures, and inevitably is affected by changes in Web technologies, it may be expanded and improved. For now, we're monitoring its use, identifying issues, and ensuring that it's worthy of its predecessor, which lasted through so many advances and changes in Web technology.</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>Oscar Wilde, Lady Windermere's Fan (1892), and apologies to <a href="http://jethrotull.com/too-old/">Jethro Tull</a> for the blog post title. <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</li>
</ol>
</section>
<!--kg-card-end: markdown-->
            </div>
        </section>

        <a href="/tag/rocketloader/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2">Rocket Loader</a>
        <a href="/tag/product-news/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2">Product News</a>
        <a href="/tag/speed-and-reliability/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2">Speed &amp; Reliability</a>
        <a href="/tag/optimization/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2">Optimization</a>
    </article>
</main>

<div class="pv4 flex flex-row flex-wrap mw7 center">
    <div class="w-100 ph3 bt b--gray8">
        <p class="orange fw5 f4 mt4 ttu">Related Posts</p>
    </div>

    <article class="w-100 w-100-m w-50-l ph3 mb4">
        <p class="f3 fw5 gray5" data-iso-date="2018-06-01T17:31:00+01:00">June 01, 2018 5:31PM</p>
        <a href="/we-have-lift-off-rocket-loader-ga-is-mobile/" class="no-underline gray1 f4 fw5">
            <h2 class="gray1 f4 fw5 mt2">We have lift off - Rocket Loader GA is mobile!</h2>
        </a>

        <p class="gray1 lh-copy">Today we’re excited to announce the official GA of Rocket Loader, our JavaScript optimisation feature that will prioritise getting your content in front of your visitors faster than ever before with improved Mobile device support....</p>
        <ul class="flex pl0 fw6 f2">
            <span>By&nbsp;</span>
            <li class="list flex items-center">
                <div class="author-name-tooltip">
                    
                    <a href="/author/simon-moore/" class="fw5 f2 black no-underline">Simon Moore</a>
                </div>
            </li>
        </ul>
        <div class="flex flex-row flex-wrap">
            
            <a href="/tag/rocketloader/" class="no-underline f1 fw2 blue3 underline-hover">Rocket Loader</a>
            <span class="f1 fw2 blue3 no-underline underline-hover">,&nbsp;</span>
            <a href="/tag/product-news/" class="no-underline f1 fw2 blue3 underline-hover">Product News</a>
            <span class="f1 fw2 blue3 no-underline underline-hover">,&nbsp;</span>
            <a href="/tag/speed-and-reliability/" class="no-underline f1 fw2 blue3 underline-hover">Speed &amp; Reliability</a>
            <span class="f1 fw2 blue3 no-underline underline-hover">,&nbsp;</span>
            <a href="/tag/optimization/" class="no-underline f1 fw2 blue3 underline-hover">Optimization</a>
        </div>
    </article>
    <article class="w-100 w-100-m w-50-l ph3 mb4">
        <p class="f3 fw5 gray5" data-iso-date="2013-02-08T05:08:00Z">February 08, 2013 5:08AM</p>
        <a href="/facebook-bug-takes-down-much-of-the-web-cloud/" class="no-underline gray1 f4 fw5">
            <h2 class="gray1 f4 fw5 mt2">Facebook Bug Redirects the Web Through Javascript Widget Error</h2>
        </a>

        <p class="gray1 lh-copy">You may have heard that Facebook took down a significant portion of the Internet today. A bug in their Facebook Connect script caused users to be redirected to a Facebook error page....</p>
        <ul class="flex pl0 fw6 f2">
            <span>By&nbsp;</span>
            <li class="list flex items-center">
                <div class="author-name-tooltip">
                    
                    <a href="/author/matthew-prince/" class="fw5 f2 black no-underline">Matthew Prince</a>
                </div>
            </li>
        </ul>
        <div class="flex flex-row flex-wrap">
            
            <a href="/tag/rocketloader/" class="no-underline f1 fw2 blue3 underline-hover">Rocket Loader</a>
            <span class="f1 fw2 blue3 no-underline underline-hover">,&nbsp;</span>
            <a href="/tag/speed-and-reliability/" class="no-underline f1 fw2 blue3 underline-hover">Speed &amp; Reliability</a>
        </div>
    </article>

</div>
<div class="pv4 ph3 mw7 center">
    <div id="disqus_thread"></div>
</div>



        <footer class="pt4 pb4 pl1 pr1 main-footer">
  <div class="mw8 center dn db-l ph3">
    <div class="flex flex-row justify-between">
      <div class="main-footer__menu-group">
        <ul id="sales-menu" class="list pl0">
          <li class="pt1 pb1 f1" data-submenu="sales-menu"
            class="main-footer__menu-group__header js-toggle-footer-group f1">
            Sales
            <i class="icon-caret-down"></i>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/plans/enterprise/contact/" data-tracking-category="footer"
              data-tracking-action="click" data-tracking-label="enterprise_sales"
              class="f1 blue3 no-underline underline-hover">
              Enterprise Sales
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/partners/" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="become_a_partner" class="f1 blue3 no-underline underline-hover">
              Become a Partner
            </a>
          </li>
        </ul>
        <p class="phone f1 blue3 no-underline underline-hover">
          <p class="tel f1 blue3 no-underline underline-hover">Contact Sales:</p>
          <p><a data-i18n-phonenumber="" class="tel f1 blue3 no-underline underline-hover" href="tel:+18889935273">+1
              (888) 99 FLARE</a></p>

          <noscript><a class="phone f1 blue3 no-underline underline-hover" href="tel:+16503198930">+1 650 319
              8930</a></noscript>
        </p>
      </div>
      <div class="main-footer__menu-group">
        <ul id="getting-started-menu" class="list pl0">
          <li class="pt1 pb1 f1" data-submenu="getting-started-menu"
            class="main-footer__menu-group__header js-toggle-footer-group">
            Getting Started
            <i class="icon-caret-down"></i>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/plans/" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="plans" class="f1 blue3 no-underline underline-hover">
              Pricing
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/case-studies/" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="case_studies" class="f1 blue3 no-underline underline-hover">
              Case Studies
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/resources/" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="white_papers" class="f1 blue3 no-underline underline-hover">
              White Papers
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/webinars/" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="webinars" class="f1 blue3 no-underline underline-hover">
              Webinars
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/learning/" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="learning_center" class="f1 blue3 no-underline underline-hover">
              Learning Center
            </a>
          </li>
        </ul>
      </div>
      <div class="main-footer__menu-group">
        <ul id="community-menu" class="list pl0">
          <li class="pt1 pb1 f1" data-submenu="community-menu"
            class="main-footer__menu-group__header js-toggle-footer-group">
            Community
            <i class="icon-caret-down"></i>
          </li>
          <li class="pt1 pb1">
            <a href="https://community.cloudflare.com" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="community_hub" class="f1 blue3 no-underline underline-hover">
              Community Hub
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://blog.cloudflare.com" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="blog" class="f1 blue3 no-underline underline-hover">
              Blog
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/galileo/" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="galileo" class="f1 blue3 no-underline underline-hover">
              Project Galileo
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/athenian/" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="athenian" class="f1 blue3 no-underline underline-hover">
              Athenian Project
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.tv/" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="tv" class="f1 blue3 no-underline underline-hover">
              Cloudflare TV
            </a>
          </li>
        </ul>
      </div>
      <div class="main-footer__menu-group">
        <ul id="developers-menu" class="list pl0">
          <li class="pt1 pb1 f1" data-submenu="developers-menu"
            class="main-footer__menu-group__header js-toggle-footer-group">
            Developers
            <i class="icon-caret-down"></i>
          </li>
          <li class="pt1 pb1">
            <a href="https://developers.cloudflare.com" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="developer_hub" class="f1 blue3 no-underline underline-hover">
              Developer Hub
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/technical-resources/" data-tracking-category="footer"
              data-tracking-action="click" data-tracking-label="technical_resources"
              class="f1 blue3 no-underline underline-hover">
              Technical Resources
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/products/cloudflare-workers/" data-tracking-category="footer"
              data-tracking-action="click" data-tracking-label="cloudflare_workers"
              class="f1 blue3 no-underline underline-hover">
              Cloudflare Workers
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/integrations/" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="integrations" class="f1 blue3 no-underline underline-hover">
              Integrations
            </a>
          </li>
        </ul>
      </div>
      <div class="main-footer__menu-group">
        <ul id="support-menu" class="list pl0">
          <li class="pt1 pb1 f1" data-submenu="support-menu"
            class="main-footer__menu-group__header js-toggle-footer-group">
            Support
            <i class="icon-caret-down"></i>
          </li>
          <li class="pt1 pb1">
            <a href="https://support.cloudflare.com" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="support" class="f1 blue3 no-underline underline-hover">
              Support
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://www.cloudflarestatus.com" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="status" class="f1 blue3 no-underline underline-hover">
              Cloudflare Status
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/compliance/" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="compliance" class="f1 blue3 no-underline underline-hover">
              Compliance
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/gdpr/introduction/" data-tracking-category="footer"
              data-tracking-action="click" data-tracking-label="gdpr" class="f1 blue3 no-underline underline-hover">
              GDPR
            </a>
          </li>
        </ul>
      </div>
      <div class="main-footer__menu-group">
        <ul id="company-menu" class="list pl0">
          <li class="pt1 pb1 f1" data-submenu="company-menu"
            class="main-footer__menu-group__header js-toggle-footer-group">
            Company
            <i class="icon-caret-down"></i>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/about-overview/" data-tracking-category="footer"
              data-tracking-action="click" data-tracking-label="overview" class="f1 blue3 no-underline underline-hover">
              About Cloudflare
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/people/" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="our_team" class="f1 blue3 no-underline underline-hover">
              Our Team
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/press/" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="press" class="f1 blue3 no-underline underline-hover">
              Press
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/analysts/" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="analysts" class="f1 blue3 no-underline underline-hover">
              Analysts
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/careers/" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="careers" class="f1 blue3 no-underline underline-hover">
              Careers
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/internetsummit/" data-tracking-category="footer"
              data-tracking-action="click" data-tracking-label="internet_summit"
              class="f1 blue3 no-underline underline-hover">
              Internet Summit
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/logo/" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="logo" class="f1 blue3 no-underline underline-hover">
              Logo
            </a>
          </li>
          <li class="pt1 pb1">
            <a href="https://cloudflare.com/network/" data-tracking-category="footer" data-tracking-action="click"
              data-tracking-label="network_map" class="f1 blue3 no-underline underline-hover">
              Network Map
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <div class="mw8 center ph3">
    <div class="flex flex-row flex-wrap justify-between pt4">
      <div class="flex flex-row items-start w-100 w-50-l pb4 pb0-l">
        <a target="_blank" rel="noopener" href="https://www.facebook.com/Cloudflare/" class="w-10"><img
            src="https://cloudflare.com/img/footer/facebook.svg" class="w-60"></a>
        <a target=" _blank" rel="noopener" href="https://twitter.com/Cloudflare" class="w-10"><img
            src="https://cloudflare.com/img/footer/twitter.svg" class="w-60"></a>
        <a target="_blank" rel="noopener" href="https://www.linkedin.com/company/cloudflare-inc-" class="w-10"><img
            src="https://cloudflare.com/img/footer/linkedin.svg" class="w-60"></a>
        <a target="_blank" rel="noopener" href="https://www.youtube.com/cloudflare" class="w-10"><img
            src="https://cloudflare.com/img/footer/youtube.svg" class="w-60"></a>
        <a target="_blank" rel="noopener" href="https://www.instagram.com/cloudflare" class="w-10"><img
            src="https://cloudflare.com/img/footer/instagram.svg" class="w-60"></a>
      </div>
      <div class="w-100 w-50-l tr-l tl-ns">
        <div>
          <span class="main-footer__copyright f1">© 2020 Cloudflare, Inc.</span>
          <span class="main-footer__copyright f1">|</span>
          <a href="https://cloudflare.com/privacypolicy/"
            class="main-footer__copyright f1 no-underline underline-hover">Privacy
            Policy</a>
          <span class="main-footer__copyright f1">|</span>
          <a href="https://cloudflare.com/website-terms/"
            class="main-footer__copyright f1 no-underline underline-hover">Terms of Use</a>
          <span class="main-footer__copyright f1">|</span>
          <a href="https://cloudflare.com/abuse/"
            class="main-footer__copyright f1 no-underline underline-hover">Trust &amp; Safety</a>
          <span class="main-footer__copyright f1">|</span>
          <a href="https://cloudflare.com/trademark/"
            class="main-footer__copyright f1 no-underline underline-hover">Trademark</a>
        </div>
      </div>
    </div>
  </div>
</footer>    </div>


    <script type="text/javascript" src="/assets/built/prism.js?v=fdf4009e30"></script>
<script type="text/javascript">
    var disqus_shortname = 'cloudflare';
    (function () {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
        Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
<script>!function (d, s, id) { var js, fjs = d.getElementsByTagName(s)[0], p = /^http:/.test(d.location) ? 'http' : 'https'; if (!d.getElementById(id)) { js = d.createElement(s); js.id = id; js.src = p + '://platform.twitter.com/widgets.js'; fjs.parentNode.insertBefore(js, fjs); } }(document, 'script', 'twitter-wjs');
</script>
<script>(function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=596756540369391";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
</script>
<script src="//platform.linkedin.com/in.js" type="text/javascript">lang: en_US</script>
<script type="text/javascript">
        (function () {
            var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
            po.src = 'https://apis.google.com/js/platform.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
        })();
</script>

<script>!function (d, s, id) { var js, fjs = d.getElementsByTagName(s)[0], p = /^http:/.test(d.location) ? 'http' : 'https'; if (!d.getElementById(id)) { js = d.createElement(s); js.id = id; js.src = p + '://platform.twitter.com/widgets.js'; fjs.parentNode.insertBefore(js, fjs); } }(document, 'script', 'twitter-wjs');
</script>
<script>(function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=596756540369391";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
</script>
<script src="//platform.linkedin.com/in.js" type="text/javascript">lang: en_US</script>
<script type="text/javascript">
        (function () {
            var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
            po.src = 'https://apis.google.com/js/platform.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
        })();
</script>


    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PKQFGQB"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<script>
    var links = document.links;

    for (var i = 0, linksLength = links.length; i < linksLength; i++) {  
       if (links[i].hostname != window.location.hostname) {
           links[i].target = '_blank';
       } 
    } 
</script>

</body>

</html>