
<!DOCTYPE html>
<html>
<head>

<script>
    var companyDetails6Sense = localStorage.getItem('_6senseCompanyDetails');

    if(null != companyDetails6Sense || companyDetails6Sense != "" || companyDetails6Sense != undefined){
		var jsonVal = JSON.parse(companyDetails6Sense);

        var companyRevenueRange = jsonVal.company.revenue_range;
        var companyCountry = jsonVal.company.country;
        var companyIndustry = jsonVal.company.industry;
        var companyName = jsonVal.company.name;
        var companyRegion = jsonVal.company.region;
        var companyDomain = jsonVal.company.domain;
    	var segments = JSON.stringify(jsonVal.segments);
    	
        window.dataLayer=window.dataLayer ||[];
        window.dataLayer.push({
                "company_industry" : companyIndustry,
                "company_name" : companyName,
                "company_revenue" : companyRevenueRange,
                "company_country" : companyCountry,
                "company_region" : companyRegion,
            	"company_domain" : companyDomain,
            	"segments" : segments
        });
    }

</script>

<style>.async-hide { opacity: 0 !important} </style>
<script>(function(a,s,y,n,c,h,i,d,e){s.className+=' '+y;h.start=1*new Date;
h.end=i=function(){s.className=s.className.replace(RegExp(' ?'+y),'')};
(a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c;
})(window,document.documentElement,'async-hide','dataLayer',4000,
{"GTM-5ZX7QTZ":true});</script>

<title>Ghosts in the Endpoint | FireEye Inc</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<link rel="alternate" type="application/atom+xml" title="Atom Feed for &#39;Ghosts in the Endpoint&#39;" href="/content/fireeye-www/en_US/blog/threat-research/2016/04/ghosts_in_the_endpoi/_jcr_content.feed">
<link rel="canonical" href="https://www.fireeye.com/blog/threat-research/2016/04/ghosts_in_the_endpoi.html">
<meta name="language" content="en">
<meta name="locale" content="en_US">
<meta http-equiv="cleartype" content="on">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
<meta name="description" content="">

<meta itemprop="name" content="Ghosts in the Endpoint">
<meta itemprop="description" content="">
<meta itemprop="image" content="https://www.fireeye.com/content/dam/fireeye-www/fw/images/fireeye-2-color-square.png">

<meta name="twitter:site" content="@FireEye">
<meta name="twitter:title" content="Ghosts in the Endpoint">
<meta name="twitter:description" content="">
<meta name="twitter:creator" content="@FireEye">
<meta name="twitter:image" content="https://www.fireeye.com/content/dam/fireeye-www/fw/images/fireeye-2-color-square.png">

<meta property="og:title" content="Ghosts in the Endpoint">
<meta property="og:type" content="website">
<meta property="og:url" content="https://www.fireeye.com/blog/threat-research/2016/04/ghosts_in_the_endpoi.html">
<meta property="og:image" content="https://www.fireeye.com/content/dam/fireeye-www/fw/images/fireeye-2-color-square.png">
<meta property="og:description" content="">
<meta property="og:site_name" content="FireEye">
<meta property="fb:admins" content="45127269202">
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/jquery.min.js"></script>

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MVGC8KK');</script>


<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/jquery/granite/csrf.min.js"></script>
<script type="text/javascript" src="/etc/designs/fireeye-www/clientlibs_nav.min.js"></script>
<script type="text/javascript">
var cookiesOK = $.cookie("ec-privacy");
var fdc =fdc || {};
var onAccept = function () {
	$.cookie("ec-privacy", "accept", { path: "/", expires: 365 });
	jQuery("#cookie-privacy-banner").hide();
};

var onDecline = function () {
	$.cookie("ec-privacy", "decline", { path: "/", expires: 365 });
	jQuery("#cookie-privacy-banner").hide();
};

var ipLocation = (function () {
	var banner ="#cookie-privacy-banner";

	/* Show the privacy notification banner. */
	var showBanner = function (banner) {
		jQuery(banner).show();
	};

	/* Suppress the privacy notification banner. */
	var hideBanner = function (banner) {
		jQuery(banner).hide();
	};

	/* These are the country codes for the countries subject to EC privacy laws.
	 * We will check to see if a visitor is coming from one of these countries.
	 * If they are, we display a privacy notification banner. If not, we
	 * do nothing. */
	var countries = {
		"AT": true,"BE": true,"BG": true,"HR": true,"CY": true,"CZ": true,"DK": true,
		"EE": true,"FI": true,"FR": true,"DE": true,"GR": true,"HU": true,"IE": true,
		"IT": true,"LV": true,"LT": true,"LU": true,"MT": true,"NL": true,"PL": true,
		"PT": true,"RO": true,"SK": true,"SI": true,"ES": true,"SE": true,"GB": true
	};
	var defaultSite = "US";

	var onSuccess = function (geoipResponse) {
		fdc.geoipresponse=geoipResponse;
		/* There's no guarantee that a successful response object
		 * has any particular property, so we need to code defensively. */
		if (!geoipResponse.country.iso_code) {
			hideBanner(banner);
			return;
		}
		//
		if (location.host.indexOf("stage") >= 0 && geoipResponse.country.iso_code === "SG") {
            geoipResponse.country.iso_code = "ES"
        }
		/* ISO country codes are in upper case. */
		var code = geoipResponse.country.iso_code;
			
		
		if ((countries[code]) && (cookiesOK == undefined)) {
			showBanner(banner);
		}
		else {
			hideBanner(banner);
		}
	};

	/* We don't really care what the error is. */
	var onError = function (error) {
		hideBanner(banner);
	};

	return function () {
		geoip2.country( onSuccess, onError );
	};
}());
ipLocation();
</script>
<div class="htmlpassthru_836d htmlpassthru">

<script type="text/javascript">
    if (!String.prototype.includes) {
        String.prototype.includes = function() {
            return String.prototype.indexOf.apply(this, arguments) !== -1;
        };
    }
var userAgent = navigator.userAgent,
gomezAgent = userAgent.includes("GomezAgent"),
prtgAgent = userAgent.includes("PRTG Network Monitor");

if (gomezAgent || prtgAgent) {
    cookiesOK = "decline";
}

if (cookiesOK != "decline") {
    // Google Analytics was here. Now it's in Tealium and GTM.
}
// Temporary patch for AA issue.
if(typeof _satellite == "undefined") {
    _satellite = {};
    _satellite.track = function(){};
}
</script>
<style>
@media ( max-width : 959px) {
    .g04 .megamenu .n03-sub_table .n03-sub_cell, .g04 .megamenu .separator {
        display: block;
    }
    .g04 .megamenu .n03_list-item-sub>.megamenu-cta {
        padding: 0;
    }
    .g04 .megamenu .n03-sub_cell.n03-sub_cell-utility {
        padding: 11px 0 11px 10px;
    }
}

@media ( min-width : 48em) {
    .cta-bar .n01 .n01_cell {
        width: auto;
    }
}

/* styles for the CTA bar test */
.n01.n01v1 .n01_cell {
    background-color: #222;
    border: 1px solid #444;
}

.n01.n01v1 .n01_cell .ficon, .n01.n01v1 .n01_cell .n01_label, .n01.n01v1 .n01_text
    {
    color: #fff;
}

@media ( min-width : 48em) {
    .n01.n01v1 .n01_cell {
        background-color: transparent;
        border: none;
    }
    .n01.n01v1 .n01_link {
        background-color: #222;
        border: 1px solid #444;
        border-right: 0;
    }
}
/* fix for new footer */
.g03v1 .g03-s-i:after {
    left: -3px;
}
/* fix for tables */
span.nowrap {
    white-space: nowrap;
}
/* fix for blog cta */
.blog-cta {
    border: 1px solid #dadadb;
    background-color: #ebebed;
    margin-bottom: 10px;
    line-height: 0;
}
</style>
<link rel="stylesheet" type="text/css" href="https://cloud.typography.com/6746836/6977592/css/fonts.css" />
<link rel="stylesheet" type="text/css" href="/content/dam/fireeye-www/fw/css/patch.css?v=1" />
<script type="text/javascript">
var addthis_config = addthis_config||{};
    addthis_config.data_track_clickback = false;
var addthis_share = {
   url: window.location.href
};
</script>
<style>
/* fix for IE */
.uc-he01v1 .uc-he01_container .background {
    max-height: 470px;
    position: absolute;
}
.uc-he01v2 .uc-he01_container .background {
    position: absolute;
}
@media (max-width: 48em) {
    .uc-he01v1 .uc-he01_container .background {
        max-height: 320px;
    }
}
@media (min-width: 54em) {
    .uc-he01v1 .uc-he01_container .background {
        max-height: 600px;
    }
}
</style>
<style>
/* Update the images used in the Table component. */
.c09v1 .tablesorter-default .header, .c09v1 .tablesorter-default .tablesorter-header {
background-position-x: calc(100% - 4px);
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggTWFjaW50b3NoIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjc2NDE0RUUyNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjc2NDE0RUUzNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTg5MzI0RkY2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTg5MzI1MDA2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz567IGQAAAApklEQVR42mL8//8/A0kApAELlgJiG2xyTDjMcQFiayDmRJfApkEbiJWgiq2J0eCCxLYBYkF8GjAUAIEvLg2C2JwAdZ42Ng022DyJ7kwmJFOM8YS+INRABkZSI45sDSAnxRFQuweIj8D8cA+Iz+JR/B6kGD2UQALf8ZiOEawgU45iUQyy/SqumD4C1YgMNhNKS3vwGYBNw1WoM75jdSKpGYjkiAMIMAAPu279CuYueAAAAABJRU5ErkJggg==)
}
.c09v1 .tablesorter-default thead .headerSortUp,.c09v1 .tablesorter-default thead .tablesorter-headerSortUp,.c09v1 .tablesorter-default thead .tablesorter-headerAsc{background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggTWFjaW50b3NoIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU4OTMyNEY5Njc2QjExRThBNEFDQTFFRUMyNzIyRjM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU4OTMyNEZBNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTg5MzI0Rjc2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTg5MzI0Rjg2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5TuQesAAAAp0lEQVR42mL8//8/A0kApAELNgbicmxyuDTsBuJ3QCxIjIbQ/wjQQYyGu/9RgRI+DeX/McFuXBqUoO7GBkKxaZj5Hze4i67B5T9hAA5mRlIjjmwNSkAcR0DtHiA+wgTl3APis3gUvwcpBjGYkARBAt/xmM6ArgFkylEsikG2X8WmAWbLezSxzcgcJnzWYzMAm4arUGd8x+pEHPlBCohtsMmRHHEAAQYAbP+KkOIl8zUAAAAASUVORK5CYII=)}
.c09v1 .tablesorter-default thead .headerSortDown,.c09v1 .tablesorter-default thead .tablesorter-headerSortDown,.c09v1 .tablesorter-default thead .tablesorter-headerDesc{background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggTWFjaW50b3NoIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU4OTMyNEZENjc2QjExRThBNEFDQTFFRUMyNzIyRjM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU4OTMyNEZFNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTg5MzI0RkI2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTg5MzI0RkM2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6nOhWUAAAAqElEQVR42mL8//8/AymACYe4FBDbkKLBBYitgZiTGA3aQKwEVWxNjAYXJDbIWYL4NGAoAAJfXBoEsTkB6jxtbBpssHkS3ZlMSKYY4wl+QVgwM1Ir4ghqALnxPwFcDlYJchIUz/yPG9yFqUPWoATE73BoCMWmAYTLsSjejawGXQMD1HpkoERIQyiS4g50eWwaGKDOAPlHEF2OBUdwV0CD+j26BMkxDRBgALvSCpUQlZEGAAAAAElFTkSuQmCC)}
.c09v1 .tablesorter-default thead .sorter-false {
    background-image: none;
}
@media (max-width: 41.9125em){
    .c09.c09v1.has-data-label tr>:not(:first-child):before {
        width: auto; min-width: 35%;
    }
}
</style>
<script>
$(document).ready(function(){
    if(typeof(ipLocation) !== "undefined" && typeof fdc.geoipResponse === "undefined"){ipLocation();}
    if(typeof fdc.geoipResponse !== "undefined"){showCountryNotification(fdc.geoipResponse);}
    if(typeof fdc.geoipResponse !== "undefined" && typeof fdc.geoipResponse.country !== "undefined" && fdc.geoipResponse.country.is_in_european_union && ($.cookie("ec-privacy") == undefined)){jQuery("#cookie-privacy-banner").show();}
});
function showCountryNotification(geoipResponse) {
	if (!geoipResponse.country || !geoipResponse.country.iso_code) {
        return;
    }
	var code = geoipResponse.country.iso_code,
	    langIndex = code === "FR" ? 2 : code === "DE" ? 3 : code === "JP" ? 4 : code === "KR" ? 5 : 1;
	if (langIndex > 1) {
		$('.c08_modal.lang').addClass("is-open");
		$('.c08_modal.lang .col:nth-child(' + (langIndex - 1) + ')').show();
		$('.c08_modal.lang, .c08_modal.lang [data-behavior="dismiss-c08"]').click(function(){
		    $.cookie("country-notification", "decline", { path: "/", expires: 365 });
		    closec08();
		});
		$('.c08_modal.lang .c08').click(function(e){
		    e.stopPropagation();
		});
		if (($.cookie("country-notification") === "decline") || $(".g01_options_list li:nth-child(" + langIndex + ") a").attr("href").indexOf(".html") < 0) {
		    closec08();
		} else {
		    $(".c08_modal.lang .btn").eq(langIndex - 2).attr("href", $(".g01_options_list li:nth-child(" + langIndex + ") a").attr("href"));
		}
	}
}
</script>
<script>    
     var _6SenseJsonObj = localStorage.getItem('_6senseCompanyDetails'),
         _6SenseTime = localStorage.getItem('_6senseCompanyDetails-timestamp'),
         isJsonStale = _6SenseTime === null ? true : Date.now() - parseInt(_6SenseTime) > 86400000; // 86400000 = 1 day in ms
     
     window._6si = window._6si || [];
     window._6si.push(['enableEventTracking', true]);
     window._6si.push(['setToken', '1322340356018696d853e0ac6f7ce3a2']);
     window._6si.push(['setEndpoint', 'b.6sc.co']);
     if(_6SenseJsonObj === null || isJsonStale){
       window._6si.push(['enableCompanyDetails', true]);
       window._6si.push(['setEpsilonKey', '325d6d60e24c7cfc3a782839d85ce08c8d3bb27c']);
       localStorage.setItem('_6senseCompanyDetails-timestamp', Date.now());
     }  
    (function () {
          var gd = document.createElement('script');
      gd.type = 'text/javascript';
      gd.async = true;
      gd.src = '//j.6sc.co/6si.min.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(gd, s);
     })();
</script>
<script>
    var jsonObj;

    function targetPageParams() { 
        jsonObj = localStorage.getItem('_6senseCompanyDetails');
        if(jsonObj) {
        	var jsonVal = JSON.parse(jsonObj);
            return { 
                "companyRevenueRange": jsonVal.company.revenue_range, 
                "companyCountry": jsonVal.company.country, 
                "companyIndustry": jsonVal.company.industry,
                "companyName": jsonVal.company.name,
                "companyRegion": jsonVal.company.region,
                "companyDomain": jsonVal.company.domain,
                "segments": JSON.stringify(jsonVal.segments)
            }; 
        }
     }; 
</script>
<script>
$(document).ready(function(){
    $(".loadmore").on("click", function(){$(".list.parbase").addClass("no-max-height");});
    // Don't show title text for textures.
    $(".texture img").attr("title", "");
});
</script>
<style>
.no-max-height .c11v9 h4{
    max-height: none !important;
}
.g04 #header-search .search-field_submit:after {
    font-size: 9px;
}
.c11v8.hideLinkText .btn {
    display: inline-block;
}
/* CTA fix */
.g04 .megamenu-tab .has-inner-cta .n03-sub_container {
    padding: 0;
    margin: 0 0 0 10px;
    max-width: 1210px;
}
.g04 .megamenu-tab .has-inner-cta .col-wrap {
    padding: 40px 0;
}
.g04 .n03-sub_container[data-columns="1"] .megamenu-cta {
    width: 50%;
}
.g04 .n03-sub_container[data-columns="2"] .megamenu-cta {
    width: 33.9%;
}
.g04 .has-inner-cta > [data-columns="2"] .n03-sub_cell {
    width: calc(50% - 60px);
}
.g04 .n03-sub_container[data-columns="3"] .megamenu-cta {
    width: 25%;
}
.g04 .n03-sub_container[data-columns="4"] .megamenu-cta {
    width: 20%;
}
.g04 .megamenu-cta h5 {
    line-height: 1.4;
}
html .g04 header .megamenu-cta h5 {
    font-weight: 500;
    font-size: 15px;
    color: #44474d;
}
html .g04 header .megamenu-cta p {
    text-transform: none;
}
.g04 .n03-sub_table > .megamenu-cta {
    background: none;
    padding: 0;
}
.g04 .megamenu-cta .n03_utility {
    border: none;
    height: 100%;
}
.g04 .megamenu-cta .n03_utility_cell {
    display: block;
    width: auto;
    margin-left: 30px;
}
/* Un/re-comment to add/remove in the line to the left of the CTA in the megamenu. */
/*.g04 .n03-sub_table .col-wrap:not(:last-child) .separator.disabled {
    border-right-color: #ebebed;
}*/

/* Put a grid over the texture from a neighboring grid. */
.force {
    z-index: 15;
    position: relative;
}
/* Remove the gradient above the tiles on blog pages and reduce the space there. */
.iparsys + .l_container>div.gradient-top {
    background-image: none;
}
.iparsys + .l_container>.gradient-top>div>.g {
    padding: 0;
}
@media (min-width: 35em) {
    .entries .highlightFirst .c11v9 .c11-image-div {
        border-left: 1px solid #dadadb;
        border-right: 1px solid #dadadb;
    }
}
@media (max-width: 1024px) {
    .uc-he01v2 .panel .asset .image img {
        max-height: 200px;
	max-width: 300px;
    }
}
/* mobile view for MegaMenu CTA. */
@media (max-width: 1024px) {
    .g04 .megamenu-tab.open .n03_list-item-sub.has-inner-cta {
        padding-bottom: 0;
    }
    .g04 .has-inner-cta > [data-columns="2"] .n03-sub_cell,
    .g04 .n03-sub_container[data-columns="2"] .megamenu-cta {
        width: 100%;
        display: block;
    }
    .g04 .megamenu-tab .has-inner-cta .n03-sub_container {
        margin: 0;
    }
    .g04 .megamenu-tab .has-inner-cta .n03-sub_container .col-wrap {
        padding: 0;
    }
    .g04 .megamenu-cta .n03_utility_cell {
        margin-left: 15px;
        margin-right: 22px;
    }
    .g04 .megamenu-cta .n03_utility_cell:nth-child(1) {
        padding-bottom: 0;
    }
    .g04 .megamenu-cta .n03_utility_cell:nth-child(2) {
        padding-top: 0;
    }
    .g04 .megamenu-cta .n03_utility_cell h5,
    .g04 .megamenu-cta .n03_utility_cell p {
        font-size: 12px;
    }
    .content-2-par .megamenus .n03-sub_table .megamenu-cta {
        border-radius: 0;
    }
}
/* Training pages side design. */
  .training-side-box {background: url('/content/dam/fireeye-www/brand/homepage-banner-images/hpb-bg-testimonial-red.jpg') left no-repeat; background-size: cover; padding:30px; border: 1px solid #dadadb; margin-bottom: 20px;}
  .training-side-text {color: #ffffff;}
  .training-side-text a:hover {color: #ffffff; text-decoration: underline;}

/* Avoid column breaks in ordered lists. */
  .c00 ol > li {page-break-inside: avoid; margin-bottom: 15px;}

/* Safari needs this on html to stop side scrolling, not just on the body. */
html {overflow-x:hidden;}
/* Make sure the footer is above a texture that precedes it. */
#g03-footer {z-index: 725;}
/* Allow border for linked images. */
.border>a>img {border: 1px solid #dadadb;}
/* Allows for easy scrollable text boxes on blog pages right in the Blog Text component. */
table.limitedHeight td {
    height: 350px;
    display: block;
    overflow-y: scroll;
    overflow-x: hidden;
    padding-bottom: 0;
}
/* Fix for edge case in Safari where page title in breadcrumbs wraps when the title is just the right length. */
.g02_list_item:last-child span {
    min-width: 360px;
    display: block;
}
/* fix issue of hidden Event Spotlights having margin when used with .row-count-2 */
.parsys > .spotlight-event.section:empty {
    display: none;
}
@media (min-width: 60em) {
.row-count-2 .parsys>div:nth-child(even):not(:empty) {
    margin-right: 40px;
}
}
/* Don't also vertically center a nested column. */
.l_container.vertically-center .g > div:not(.stacked) > .g-content .g > div > .g-content {
    top: auto;
    transform: none;
    position: unset;
}

/* Footer SVG resize. */
@media (max-width: 25em) {
  .g03 .g03_copyright {background-size: 36px;}
}

/* HPB padding and resize. */
@media (max-width: 81em) {
  .hero-container-v3 {padding: 0 60px !important;}
}
@media (max-width: 64em) {
  .hero-container-v3 {padding: 0 20px !important;}
}
@media (max-width: 42em) {
  .hero-container-v3 {padding: 0 10px !important;}
  .uc-he01v2 .uc-he01_title {font-size: 1.75rem !important;}
  .uc-he01v2 .uc-he01_description {font-size: 1.0rem !important;}
}

/* Some 2021 Redesign changes. */
html .a02 .search .search-field_text {
    border: 1px solid #dadadb;
    border-radius: 5px 0 0 5px;
}
html .a02 .search .search-field_submit {
    background-color: #bf2129;
    border: 1px solid #dadadb;
    border-radius: 0 5px 5px 0;
    height: 29px;
}
html .a02 .search .search-field_submit:after {
    top: 8px;
    left: 6px;
}
html.backdropfilter .g04.masthead {
    -webkit-backdrop-filter: saturate(150%) blur(15px);
}
.blog p, .blog li, .blog .entrytext p, .blog .entrytext li {
    font-size: 0.9375rem;
}

</style></div>

<link rel="stylesheet" href="/etc/designs/fireeye-www/clientlibs_fw-2021.min.css" type="text/css">
<link rel="stylesheet" href="/etc/clientlibs/fireeye-blog/clientlibs_base.min.css" type="text/css">
<link rel="icon" type="image/vnd.microsoft.icon" href="/content/dam/fireeye-www/brand/logos/fireeye.ico">
<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="/content/dam/fireeye-www/brand/logos/fireeye.ico">
</head>

<body itemscope itemtype="http://schema.org/WebPage" data-redesign="redesign-2021"><script type="text/javascript">window.Granite = window.Granite || {}; window.Granite.csrf = true;</script>


<div class="clientcontext parbase"><script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/utils.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/jquery/granite.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/foundation/clientlibs/jquery.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/foundation/clientlibs/shared.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/lodash/modern.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/cq/personalization/clientlib/personalization/kernel.min.js"></script>
<script type="text/javascript">
    $CQ(function() {
        CQ_Analytics.SegmentMgr.loadSegments("\/etc\/segmentation");
        CQ_Analytics.ClientContextUtils.init("\/etc\/clientcontext\/default", "\/content\/fireeye\u002Dwww\/en_US\/blog\/threat\u002Dresearch\/2016\/04\/ghosts_in_the_endpoi");

        
    });
</script>
</div>


<div class="masthead_v2 masthead-v2">
<div class="g04 masthead g04v1">
<header role="banner" itemscope itemtype="http://schema.org/WPHeader">
<div class="language-and-search"> <div class="search">
<div class="content-searchbox searchbox">
<a class="g01_options-option option-search" href="#header-search" data-for="q" data-behavior="showHeaderMenu focusField">Search</a>
<div class="option-menu option-menu_search" id="header-search">
<form method="get" action="/search.html">
<fieldset class="search-field" title="Search FireEye.com">
<label class="search-field_label" for="q">Search FireEye.com</label>
<input class="input-text search-field_text" type="text" name="q" id="q" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" data-locale="en_US" placeholder="Search FireEye.com">
<div id="searchboxsuggestions"></div>
<button class="btn btn-secondary search-field_submit" type="submit">Go</button>
</fieldset>
</form>
</div>
</div>
</div>
</div>
<div class="logo-and-megamenu">
<div class="logo" itemscope itemtype="https://schema.org/Brand">
<a href="https://www.fireeye.com"><img src="/content/dam/fireeye-www/fw/images/fe-logo-white.svg" alt="FireEye" itemprop="logo" class="fireeye" /></a>
</div>
<nav class="megamenu">
<ul><li class="megamenu-tab" data-curry="/blog.html" data-link="/products.html">
<h4 class="megamenu-title">
<a href="/products.html" itemprop="url" class="MegaMenus">Products</a>
</h4>
<div class="content-0-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Enterprise Security</h4><ul><li itemprop="url"><a href="/products/helix.html" itemprop="name" class="MegaMenus">Helix Security Platform</a></li>
<li itemprop="url"><a href="/products/network-security.html" itemprop="name" class="MegaMenus">Network Security and Forensics</a></li>
<li itemprop="url"><a href="/products/endpoint-security.html" itemprop="name" class="MegaMenus">Endpoint Security</a></li>
<li itemprop="url"><a href="/products/email-security.html" itemprop="name" class="MegaMenus">Email Security</a></li>
<li itemprop="url"><a href="/products/cloudvisory.html" itemprop="name" class="MegaMenus">Cloudvisory</a></li>
<li itemprop="url"><a href="/products/detection-on-demand.html" itemprop="name" class="MegaMenus">Detection On Demand</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Security For:</h4><ul><li itemprop="url"><a href="/products/cloud-security.html" itemprop="name" class="MegaMenus">Cloud</a></li>
<li itemprop="url"><a href="/products/financial-services.html" itemprop="name" class="MegaMenus">Financial Services</a></li>
<li itemprop="url"><a href="/products/government.html" itemprop="name" class="MegaMenus">Government</a></li>
<li itemprop="url"><a href="/products/healthcare.html" itemprop="name" class="MegaMenus">Healthcare</a></li>
<li itemprop="url"><a href="/products/education.html" itemprop="name" class="MegaMenus">Higher Education</a></li>
<li itemprop="url"><a href="/products/industrial-systems-and-critical-infrastructure-security.html" itemprop="name" class="MegaMenus">Industrial &amp; Critical Infrastructure</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-0-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}
</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>FireEye XDR</h5>
<p>Simplify threat detection and response with FireEye&nbsp;XDR.</p>
</div>
<div class="n03_utility_cell"><div class="button"><a class="btn btn-B2282D compact" href="/products/xdr.html">Explore FireEye XDR</a></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
<div class="view-all-bar">
<a href="/products.html" class="MegaMenus">
VIEW ALL PRODUCTS</a>
</div></div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/customers.html">
<h4 class="megamenu-title">
<a href="/company/customers.html" itemprop="url" class="MegaMenus">Customers</a>
</h4>
<div class="content-1-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Customers</h4><ul><li itemprop="url"><a href="/customers.html" itemprop="name" class="MegaMenus">Customer Stories</a></li>
<li itemprop="url"><a href="/company/customers.html" itemprop="name" class="MegaMenus">Customer Success</a></li>
<li itemprop="url"><a href="https://csportal.fireeye.com/" target="_blank" itemprop="name" class="MegaMenus">Customer Portal</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Get Support</h4><ul><li itemprop="url"><a href="/support/contacts.html" itemprop="name" class="MegaMenus">Contact Support</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Find Answers</h4><ul><li itemprop="url"><a href="/support/programs.html" itemprop="name" class="MegaMenus">Support Programs</a></li>
<li itemprop="url"><a href="/support/notices.html" itemprop="name" class="MegaMenus">Support Notices</a></li>
<li itemprop="url"><a href="/support/products.html" itemprop="name" class="MegaMenus">Supported Products</a></li>
<li itemprop="url"><a href="https://community.fireeye.com/" target="_blank" itemprop="name" class="MegaMenus">Communities</a></li>
<li itemprop="url"><a href="https://docs.fireeye.com" target="_blank" itemprop="name" class="MegaMenus">Documentation Portal</a></li>
</ul></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>Support</h5>
<p>A global network of support experts available 24x7. We offer simple and flexible support programs to maximize the value of your FireEye products and services.</p>
</div>
<div class="n03_utility_cell"><div class="button"><a class="btn btn-44474D expand" href="/support.html">Get support</a></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/partners.html">
<h4 class="megamenu-title">
<a href="/partners.html" itemprop="url" class="MegaMenus">Partners</a>
</h4>
<div class="content-2-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">FireEye Partners</h4><ul><li itemprop="url"><a href="/partners.html" itemprop="name" class="MegaMenus">Partners Overview</a></li>
<li itemprop="url"><a href="/partners/resellers.html" itemprop="name" class="MegaMenus">FireEye Affinity Resellers</a></li>
<li itemprop="url"><a href="/partners/strategic-technology-partners.html" itemprop="name" class="MegaMenus">Technology Partners</a></li>
<li itemprop="url"><a href="/partners/global-solution-providers.html" itemprop="name" class="MegaMenus">Global Solution Providers</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Partner Resources</h4><ul><li itemprop="url"><a href="https://partners.fireeye.com/directory/" target="_blank" itemprop="name" class="MegaMenus">Partner Locator</a></li>
<li itemprop="url"><a href="http://training.fireeye.com/" target="_blank" itemprop="name" class="MegaMenus">Partner Education Center</a></li>
<li itemprop="url"><a href="/support.html" itemprop="name" class="MegaMenus">Support</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Partnering with FireEye</h4><ul><li itemprop="url"><a href="https://www2.fireeye.com/Partner-Request-LP-New.html" target="_blank" itemprop="name" class="MegaMenus">Become a Partner</a></li>
</ul></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>Partner Portal</h5>
<p>Access for our registered Partners to help you be successful with FireEye.
Collateral, deal registration, request for funds, training, enablement, and more.</p>
</div>
<div class="n03_utility_cell"><div class="button"><a class="btn btn-44474D compact" href="https://partners.fireeye.com/" target="_blank">Access the portal</a></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/current-threats.html">
<h4 class="megamenu-title">
<a href="/current-threats.html" itemprop="url" class="MegaMenus">Resources</a>
</h4>
<div class="content-3-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub ">
<div class="n03-sub_container" data-columns="3">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Cyber Security</h4><ul><li itemprop="url"><a href="/current-threats/what-is-cyber-security.html" itemprop="name" class="MegaMenus">What is Cyber Security?</a></li>
<li itemprop="url"><a href="/current-threats/detect-and-prevent.html" itemprop="name" class="MegaMenus">Advanced Detection and Prevention</a></li>
<li itemprop="url"><a href="/current-threats/how-cyber-attackers-get-in.html" itemprop="name" class="MegaMenus">How Cyber Attacks Compromise Your Network</a></li>
<li itemprop="url"><a href="/current-threats/what-is-cyber-security/ransomware.html" itemprop="name" class="MegaMenus">What is Ransomware?</a></li>
<li itemprop="url"><a href="/current-threats/what-is-a-zero-day-exploit.html" itemprop="name" class="MegaMenus">What is a Zero-Day Exploit?</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">FireEye Blogs</h4><ul><li itemprop="url"><a href="/blog.html" itemprop="name" class="MegaMenus">Read the FireEye Blogs</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Training</h4><ul><li itemprop="url"><a href="/services/training.html" itemprop="name" class="MegaMenus">Education and Training</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Free Tools & Newsletters</h4><ul><li itemprop="url"><a href="https://fireeye.market" target="_blank" itemprop="name" class="MegaMenus">FireEye Market</a></li>
<li itemprop="url"><a href="https://vision.fireeye.com" target="_blank" itemprop="name" class="MegaMenus">The Vision – Digital Magazine</a></li>
</ul></div>
</div>
</div><div class="separator disabled"></div></div></div>
</div>
<div class="view-all-bar">
<a href="/current-threats.html" class="MegaMenus">
VIEW ALL RESOURCES</a>
</div></div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/company.html">
<h4 class="megamenu-title">
<a href="/company.html" itemprop="url" class="MegaMenus">About</a>
</h4>
<div class="content-4-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta " id="mandiant-mega-menu">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">About Us</h4><ul><li itemprop="url"><a href="/company.html" itemprop="name" class="MegaMenus">Why FireEye?</a></li>
<li itemprop="url"><a href="/company/awards.html" itemprop="name" class="MegaMenus">Awards and Honors</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Careers</h4><ul><li itemprop="url"><a href="/company/jobs.html" itemprop="name" class="MegaMenus">Career Opportunities</a></li>
<li itemprop="url"><a href="/company/jobs/internships.html" itemprop="name" class="MegaMenus">Internships</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
.g04 .megamenu-list a{padding-right:38px;line-height:1.358;padding-bottom:2px}@media (min-width:60em){.g04 .n03-sub_container{padding-bottom:23px}}@media(min-width:64em) and (max-width:64.5em){.g04 .megamenu-tab:first-child .megamenu-title{padding-left:14px}}@media (min-width:68em) and (max-width:69em){.g04 .megamenu-tab:first-child .megamenu-title{padding-left:30px}}
.g04 .megamenu-tab {text-transform: none !important;}

</style></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">News and Events</h4><ul><li itemprop="url"><a href="/company/newsroom.html" itemprop="name" class="MegaMenus">Newsroom</a></li>
<li itemprop="url"><a href="/company/press-releases.html" itemprop="name" class="MegaMenus">Press Releases</a></li>
<li itemprop="url"><a href="/company/webinars.html" itemprop="name" class="MegaMenus">Webinars</a></li>
<li itemprop="url"><a href="/company/events.html" itemprop="name" class="MegaMenus">Events</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Contact</h4><ul><li itemprop="url"><a href="/company/contact-us.html" itemprop="name" class="MegaMenus">Contact FireEye</a></li>
</ul></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>The Vision</h5>
<p>Read our digital magazine providing expert-authored stories, information, unique insights, and advice on cyber security.</p>
</div>
<div class="n03_utility_cell"><div class="button"><a class="btn btn-B2282D compact" href="https://vision.fireeye.com/" target="_blank">Get your copy</a></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</div>
</li></ul>
</nav>
</div>
<span class="burger ficon ficon-menu"></span>
</header>
</div>
</div>


<div id="cookie-privacy-banner" style="display:none;">
<div class="l_container">
<div class="g">
<div class="g-u-1">
<div class="g-content">
<div class="cookie-banner">
<p class="cookie-text">
To give you the best possible experience, this site uses cookies.&nbsp; Find out more on <a href='/company/privacy.html' target='_blank'>how we use cookies</a>.<button type="button" class="cookie-button highlighted" onclick='javascript:onAccept();'>Accept</button>
</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="breadcrumbs breadcrumb">
<div class="l_container is-full">
<div class="g02 g02v0" id="g02-breadcrumbs">
<div class="g02_container">
<div class="g02_content">
<ul class="list-inline g02_list" itemscope itemtype="http://schema.org/BreadcrumbList">
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" class="BreadCrumb" href="/"><span itemprop="name">Home</span></a><meta itemprop="position" content="1" /></li>
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" class="BreadCrumb" href="/blog.html"><span itemprop="name">FireEye Blogs</span></a><meta itemprop="position" content="2" /></li>
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" class="BreadCrumb" href="/blog/threat-research.html"><span itemprop="name">Threat Research</span></a><meta itemprop="position" content="3" /></li>
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><span itemprop="name">Ghosts in the Endpoint<meta itemprop="position" content="6" /></span>
</ul>
</div>
</div>
</div>
</div>
</div>
<main class="l_main" role="main">
<div class="l_container">
<div class="g g-alt ">
<div class="g-u-17-24 l_g-u-1">
<div class="g-content">
<div class="blog main"><div itemscope itemtype="http://schema.org/BlogPosting">
<div class="summary entrytextteaser">
</div>
<div class="title entrytitle">
<h2 class="category-name">Threat Research Blog</h2>
<h1 class="blogpostlanding red" itemprop="headline">Ghosts in the Endpoint</h1>
<div class="c00 c00v0 entry-meta-block selfClear">
<time class="entry-date" itemprop="datePublished" content="2016-04-13T13:00:00Z">April 13, 2016</time>
<span class="sep"> | </span>
<span class="by-author" itemscope itemptype="http://schema.org/Person">by <a href="/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/daniel-regalado" title="View all entries filed under 'Fireeye - Authors : Daniel Regalado'">Daniel Regalado</a>, <a href="/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/taha-karim" title="View all entries filed under 'Fireeye - Authors : Taha Karim'">Taha Karim</a>, <a href="/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/varun-jain" title="View all entries filed under 'Fireeye - Authors : Varun Jain'">Varun Jain</a>, <a href="/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/cap-erye-hernandez" title="View all entries filed under 'Fireeye - Authors : Erye Hernandez'">Erye Hernandez</a><span class="sep"> | </span><a href="/blog/threat-research.html/category/etc/tags/fireeye-blog-threat-research/threat-research/vulnerabilities" title="View all entries filed under 'Threat Research : Threat Research / Vulnerabilities'">Vulnerabilities</a><meta itemprop="author" content="Daniel Regalado" /><meta itemprop="contributor" content="Taha Karim" /><meta itemprop="contributor" content="Varun Jain" /><meta itemprop="contributor" content="Erye Hernandez" /></span>
<div class="tags-section">
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/software"> <span class="tagbutton">Software</span></a><br class="on-mobile" />
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-threat-research/threat-research/vulnerabilities"> <span class="tagbutton">Vulnerabilities</span></a><br class="on-mobile" />
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/software-vulnerabilities"> <span class="tagbutton">Software vulnerabilities</span></a><br class="on-mobile" />
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/antivirus"> <span class="tagbutton">antivirus</span></a><br class="on-mobile" />
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/anti-virus"> <span class="tagbutton">Anti-virus</span></a><br class="on-mobile" />
</div>
</div>
</div>
<div class="par parsys"><div class="entrytext section"><div class="c00 c00v0" itemprop="articleBody">
<p>We would like to introduce the first of our “Ghosts in the Endpoint” series, a report prepared by FireEye Labs that documents malicious software not being detected in the wild by traditional signature-based detections.</p>
<p>In this study, all the families identified are samples from VirusTotal (VT) with zero detections, but detected as malicious by our Multi-Vector Virtual Execution (MVX) Engine. We also added a few samples with very low detection rates (VT &lt;=3) but with interesting bypass techniques.</p>
<p>Our goal is to share indicators that help the AV community and others improve their detection coverage.</p>
<h5><b>Scope</b></h5>
<ul>
<li>So far, only samples found in VT with the following file types were included in this study:</li>
<li>Win32 binaries</li>
<li>Office documents (including Open XML format)</li>
<li>RTF documents</li>
<li>Hangul Word Processor (HWP)[1] documents</li>
</ul>
<p>The study includes samples submitted to VT in 2015 that were still found undetected or with minimal detection rates as of January 2016 (see VT detection Tables in the Appendix). &nbsp;</p>
<h5><b>Findings</b></h5>
<p>The following samples were identified in our research:</p>
<p><b>Suspected APT malware:</b></p>
<ol>
<li><b>GOODTIMES backdoor</b>: Suspected APT; MS Office with Embedded Hacking Team Flash Exploit</li>
<li><b>UPS backdoor: </b>Suspected APT3</li>
<li><b>VBA Macro + Metasploit Shellcode Loader:</b> Suspected Middle Eastern-based APT</li>
<li><b>Hancom Office HWP Exploit:</b> Possible APT targeting of South Korea.</li>
</ol>
<p><b>Malware without attribution:</b></p>
<ol>
<li><b>OccultAgent</b>: (New) Code hidden in Excel spreadsheet</li>
<li><b>Spy-Net RAT</b>: Targeting Brazilian victims</li>
<li><b>VBA Macros + PowerShell scripts:</b> Netcat Backdoor</li>
<li><b>VBA Macros + Python scripts:</b> Metasploit Shellcode Loader</li>
<li><b>Office Downloader</b></li>
</ol>
<h5><b>Detailed Sample Analysis</b></h5>
<p>Malware that remains undetected by more than 56 different AV vendors over a long period of time is worth investigating. This section briefly describes the malware and techniques identified in the undetected samples. A full list of indicators can be found in the IOC section at the end.</p>
<p><b>1. 4b3858c8b35e964a5eb0e291ff69ced6</b> - 201507.xlsx</p>
<p>Type: XLSX<br>
Description: CVE-2015-5119 (Flash exploit exposed in the Hacking Team leak)<br>
Attribution: Suspected APT threat group targeting Taiwan<br>
Current detection: 0/53<br>
First Submission: July 13, 2015<br>
Last Submission: January 27, 2016<br>
Time undetected in VT: At least 6 months&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
</p>
<p>This Excel document is PKZIP compressed (following the Open XML Format) with the structure shown in Figure 1:</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig1.png"></p>
<p><span class="type-XS">Figure 1: Structure of XLSX document</span></p>
<p>When the spreadsheet is opened, a dialog prompts the victim to allow unknown embedded content to be played, as shown in Figure 2. In this case, social engineering is needed to convince the victim to execute the malicious Flash object.</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig2.png"></p>
<p><span class="type-XS">Figure 2: Excel document content and prompt</span></p>
<p>When the victim allows the embedded content to be played, the <span class="code">activeX1.xml</span> file is read to locate the OLE Control to be used (which corresponds to Macromedia Flash Player, as shown in Figure 3) through the ClassID attribute to finally load the Flash Exploit embedded in the <span class="code">activeX1.bin </span>object.</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig3.png"></p>
<p><span class="type-XS">Figure 3: Content of activeX1.xml file</span></p>
<p>The embedded Flash exploit corresponds to CVE-2015-5119, one of several zero-day exploits identified following the Hacking Team leak in July 2015.<a name="_ftnref2"></a>[2]</p>
<p>A look at the Flash Action Script (AS) reveals code similar to that from the Hacking Team Exploit, such as the class name <span class="code">exp1_fla/MainTimeLine</span>, the function name <span class="code">TryExpl()</span> with the same use-after-free technique, and even the same error message “can’t cause UaF” as shown in Figure 4.</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig4.png"></p>
<p><span class="type-XS">Figure 4: Flash exploit code</span></p>
<p>The combination of the class name <span class="code">exp1_fla()</span> and classes S<span class="code">hellMac64, ShellWin32</span> and <span class="code">ShellWin64</span> built into the exploit (see Figure 5) were not observed in the original Hacking Team version of the exploit, suggesting that the group responsible for this malicious Excel file modified the original exploit code.</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig5.png"></p>
<p><span class="type-XS">Figure 5: Flash Action Script classes from malicious Excel file</span></p>
<p>The exploit drops a variant of the backdoor we call GOODTIMES (also known as Linopid). The backdoor communicates to Taiwan-based IP addresses 220.128.223.75 and 220.134.47.67 on ports 8080 and 443 via HTTP.</p>
<p>While this particular GOODTIMES sample has not been attributed to a specific threat group, GOODTIMES has previously been used by suspected APT actors. Based on previously identified targets and the use of Traditional Chinese language and Taiwan-centric themes in spear phishing messages and decoy documents, the group appears to focus on Taiwanese targets.</p>
<h5><b>Potential AV bypassing reason</b></h5>
<p>1.&nbsp;&nbsp;&nbsp;&nbsp; New delivery mechanism: The leaked CVE-2015-5119 Flash exploit has been used by a wide range of threat groups, including other APT groups such as APT3 and APT18<a name="_ftnref3"></a>[3]. Previous delivery methods entailed luring the victim to click on a malicious link (delivered via a spear phishing message) where the malicious Flash exploit was hosted on a web page. In this case, the suspected APT group responsible for the GOODTIMES backdoor changed the <b>delivery mechanism</b> by embedding the exploit as ActiveX object inside the Excel Open XML Format (PKZIP compressed).</p>
<p>2.&nbsp;&nbsp;&nbsp;&nbsp; In addition, while an ActiveX object would normally be embedded inside a Compound File Binary Format<a name="_ftnref4"></a>[4], in this case the uncompressed Flash content is embedded directly in the Excel file, right after the ClassID, as shown at Figure 6.</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig6.png"></p>
<p><span class="type-XS">Figure 6: Embedded Flash object</span></p>
<p>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The above steps might be enough to avoid proper parsing of the malicious Flash object. This is the first time we have seen a CVE-2015-5119 sample embedded in an Excel document this way.</p>
<p><b>2. 22da029dd4e018b7c7135a03d0ba9b99</b></p>
<p>Type: Win32 binary<br>
Description: A variant of the UPS backdoor<br>
Attribution: suspected APT3<br>
Current detection: 0/57<br>
First Submission: August 6, 2015<br>
Last Submission: February 2, 2016<br>
Time undetected in VT: At least 6 months</p>
<p>UPS is a backdoor capable of uploading and downloading files, creating a reverse shell, reconfiguring itself to use different command and control (CnC) servers, and acting as a proxy server. It uses a custom binary protocol to communicate with its CnC server and it encrypts this custom protocol using a TLS TCP connection.</p>
<p>While this particular UPS sample has not been attributed, UPS is commonly used by the China-based APT3.</p>
<p><b>Potential AV bypassing reason</b></p>
<p>1.&nbsp;&nbsp;&nbsp;&nbsp; Junk code insertion: Examining this UPS sample, we see a significant amount of “junk code” potentially designed to mask the malicious nature of the binary, as well as to complicate analysis or reverse engineering efforts.</p>
<p>In Figure 7 we see the backdoor executing a jump to address 0x4043AB by forcing the “jump if greater than” comparison to be true by moving a large value (0x4A2E88E4) to the ebx register and then comparing it with a hardcoded lower value (0x6A1E839), after which a large number of junk instructions are skipped (red square). This strategy can be seen through several different execution paths.</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig7.png"></p>
<p><span class="type-XS">Figure 7: Decompiled UPS sample showing junk code</span></p>
<p><b>3. aedd5d8446cc12ddfdc426cca3ed8bf0 - </b>S-old.xlsb<b></b></p>
<p>Type: XLSB<br>
Description: VBA Macro + Metasploit Shellcode Loader Backdoor<br>
Attribution: Suspected Middle Eastern-based APT<br>
Current detection: 1/52&nbsp;&nbsp;&nbsp;&nbsp;<br>
First Submission: September 28, 2015<br>
Last Submission: January 28, 2016<br>
Time undetected in VT: At least 4 months</p>
<p>This particular sample, an Excel Binary Workbook file,<a name="_ftnref5"></a>[5] has only one generic detection on VT, so we believe it is still worth mentioning in this report.</p>
<p>When the spreadsheet is opened, the victim is shown a table of Israeli holidays and prompted to enable macros to view the full list, as shown in Figure 8:</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig8.png"></p>
<p><span class="type-XS">Figure 8: Malicious Excel file showing calendar data</span></p>
<p>When the macro is executed it creates a Windows binary in memory as shown in Figure 9. Note the <span class="code">Chr(77) + Chr(90)</span> builds the MS-DOS header magic number “MZ”.</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig9.png"></p>
<p><span class="type-XS">Figure 9: Macro concatenating bytes to form a Windows binary</span></p>
<p>The binary is written to the file system with the file name <span class="code">NTUSER.dat{<b>GUID</b>}.exe</span> as shown in Figure 10.</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig10.png"></p>
<p><span class="type-XS">Figure 10: Creating the Windows binary</span></p>
<p>In this case, the GUID selected corresponds to Scriptlet.TypeLib ActiveX object, creating the file name <span class="code">NTUSER.dat{FB9D87AE-8FEA-4583-98AB-2FB396EAB5FC}.exe (md5&nbsp; 6aab47b18afacbfa7423f09bd1fa6d25)</span> that is later executed via the <span class="code">ShellExecute() </span>API with the <span class="code">SW_HIDE</span> parameter to run silently.</p>
<p>Finally, the executable comes with an embedded Metasploit Shellcode loader that connects to 84.11.146.62 on port TCP 13661.</p>
<p>While this sample has not been attributed, similar techniques (use of XLSB files with embedded, obfuscated macros; creation of the file name <span class="code">NTUSER.dat{GUID}.exe;</span> use of the binary to download additional malware) and the same CnC IP address have been referenced in reporting on a suspected Middle Eastern-based APT group known as “Rocket Kitten”, primarily targeting Middle Eastern and European organizations.</p>
<p><b><u>Potential AV bypassing reason</u></b></p>
<p>1.&nbsp;&nbsp;&nbsp;&nbsp; The byte concatenation inside the VBA Macro, used to build a Win32 binary at runtime, helps to bypass signature-based detection.</p>
<p><b>4. 4e51143b01e99afc3bd908794d81d3cb</b><br>
Type: HWP<br>
Description: Hancom Office HWP Exploit<br>
Attribution: None<br>
Current detection: 3/53&nbsp;&nbsp;&nbsp;&nbsp;<br>
First Submission: July 31, 2015<br>
Last Submission: February 2, 2016<br>
Time undetected in VT: At least 6 months with 3 generic detections</p>
<p>This sample, a Hangul Word Processor (HWP) document, has only three generic detections on VT, so we found it to be worth analyzing for this report.</p>
<p>When opened, the HWP document displays Korean text and some photographs, as shown in Figure 11. Behind the scenes the document will exploit vulnerable versions of Hancom Office, dropping and executing a malicious file.</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig11.png"></p>
<p><span class="type-XS">Figure 11: Content of malicious HWP document</span></p>
<p>Internally, the document structure includes three sections, where section 0 will trigger a Type Confusion vulnerability while parsing the content of the paragraph located at the data record structure <span class="code">HWPTAG_PARA_TEXT</span> starting at offset 0x1C (see uncompressed section 0 at Figure 12). The logic bug will cause the string starting at offset 0x50 to be treated as a control structure. This control structure contains a fake object at offset 0x56 pointing to an address (0x0e0a0e0a) filled by a heap spray that eventually will redirect the execution flow to the shellcode.</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig12.png"></p>
<p><span class="type-XS">Figure 12: Section0 malformed paragraph</span></p>
<p>A similar type confusion vulnerability has been previously documented by Ahnlab,<a name="_ftnref6"></a>[6] however, the vulnerability trigger is different.</p>
<p>Section 2 has an uncompressed size equal to 112MB, used to perform the heap spray and expecting to place the shellcode at a memory address close to 0x0e040e04. In Figure 13, the beginning of the shellcode can be seen (uncompressed).</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig13.png"></p>
<p><span class="type-XS">Figure 13: Start of shellcode</span></p>
<p>The shellcode drops a file on disk and executes it via H<span class="code">ncBLXX.HncShellExecute-&gt; SHELL32.ShellExecute.</span> This generates a connection to a compromised Korean automotive website and attempts to retrieve a file with a .JPG extension, which we suspect may be a second-stage binary. However, the file was no longer available on the website at the time of our analysis.</p>
<p>This particular sample has not been attributed to any threat group. However, the use of malicious HWP documents is notable, as that format is specific to a regional word processing program used heavily in South Korea and in particular by the South Korean government. While the use of malicious HWP files could simply indicate regional targeting by unspecified threat actors, similar exploits have been used in the past by suspected APT groups.</p>
<p><b>Potential AV bypassing reason</b></p>
<p>1.&nbsp;&nbsp;&nbsp;&nbsp; Heap Spray technique change: Similar exploits used to be created with multiple large-size sections in order to spray the heap. This exploit fulfills the same purpose but with only one large-size section.</p>
<p>2.&nbsp;&nbsp;&nbsp;&nbsp; Vulnerability triggered in a different format: A similar type confusion vulnerability described in this section was seen implemented in the Open XML Format (HWPX extension)<a name="_ftnref7"></a>[7], but this time ported to the Compound File Binary Format &nbsp;(HWP extension).</p>
<p><b>5. 497eddab53c07f4be1dc4a8c169261a5</b> - Barclays_Q22015_IMS_excel_tables.xlsm</p>
<p>Type: XLSM<br>
Description: <b>VBA Macro + VBScript generated from spreadsheet</b><br>
Attribution: None<br>
Current detection: 1/54&nbsp;&nbsp;&nbsp;&nbsp;<br>
First Submission: Julio 08, 2015<br>
Last Submission: January 27, 2016<br>
Time undetected in VT: At least 7 months</p>
<p>This sample, an Excel macro-enabled file, has only one generic detection. The embedded macro creates an encoded Visual Basic (VBE) file that connects to a CnC site and allows remote control of the victim’s computer. As we had not previously observed this backdoor, we named it OccultAgent.</p>
<p>When the XLSM file is opened, the user is prompted to enable macros, as shown in Figure 14. The instructions are displayed in both English and Greek:</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig14.png"></p>
<p><span class="type-XS">Figure 14: Prompt to enable macros</span></p>
<p>The macro drops an encoded VBScript file named <span class="code">ocagent.vbe</span> (69df0c3bab5e681c2e5eb5951a64776e), obtained from the data in a spreadsheet cell (see Figure 15), to C:\octemp001\ and executes it. The script connects to hxxp://0x5E469BFD, which is equivalent to hxxp://94.70.155.253, via the victim’s web browser.</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig15.png"></p>
<p><span class="type-XS">Figure 15: Obfuscated script embedded in spreadsheet cell</span></p>
<p>The first stage Macro source code can be seen in Figure 16.<img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig16.png"></p>
<p><span class="type-XS">Figure 16: Embedded VBA macro</span></p>
<p>The dropped <span class="code">ocagent.vbe</span> VBScript is essentially a backdoor that connects to the CnC server at 94.70.155.253 to register the victim’s computer and to obtain commands to run on the victim’s machine.</p>
<p><b>Potential AV bypassing reason</b></p>
<p>The following steps may be sufficient to bypass AV detection:</p>
<p>1.&nbsp;&nbsp;&nbsp;&nbsp; Adding encoded VB script into a spreadsheet cell allows attackers to hide the malicious code.</p>
<p>2.&nbsp;&nbsp;&nbsp;&nbsp; Representing the IP address in hexadecimal format may be sufficient to bypass regular expressions trying to match standard 32-bit IP addresses (dotted decimal notation).</p>
<p><b>6. dc15336e7e4579c9c04c6e4e1f11d3dd - </b>dedinho no cuzinho.rtf</p>
<p>Type: RTF<br>
Description: RTF file with embedded executable<br>
Attribution: None<br>
Current detection: 0/54&nbsp;&nbsp;&nbsp;&nbsp;<br>
First Submission: October 22, 2015<br>
Last Submission: January 15, 2016<br>
Time undetected in VT: At least 3 months</p>
<p>In this attack scenario, the victim receives an RTF document that appears to contain an embedded JPG image. The embedded file is actually an executable that attempts to hide its file extension by using a long sequence of underscore characters (e.g., <span class="code">Copy of foto.jpg&lt;underscores&gt;.exe</span> (see Figure 17).<img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig17.png"></p>
<p><span class="type-XS">Figure 17: RTF document with embedded file</span></p>
<p>The embedded binary (d409dc7e1ca0c86cb71e090591f16146) is packed with RLPack<a name="_ftnref8"></a>[8]. It drops a second Borland Delphi binary packed with a customized version of UPX, which will then drop the Spy-Net RAT on the system.</p>
<p>Spy-Net<a name="_ftnref9"></a>[9] allows an attacker to interact with the victim via a remote shell to upload/download files, interact with the registry, run processes and services, capture images of the desktop, and record from the webcam and microphone. It also contains functionality to extract saved passwords and turn the victim into a proxy server.&nbsp;</p>
<p>A beacon to dennyhacker[.]no-ip.org on TCP port 81 prepended with an ASCII representation of the length of the payload&nbsp; (33) and followed by a pipe and a new line character confirms Spy-Net activity:</p>
<p>00000000&nbsp; 33 33 7c 0a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 33|.</p>
<p>The RAT commands are translated to Portuguese to adapt the attack to Brazilian victims; some command examples are shown below (additional commands are listed in the Appendix):</p>
<p>Configuracoesdoserver = Server settings<br>
Listarjanelas = List windows<br>
Finalizarconexao = End connection<br>
Listarchaves = List keys</p>
<p><b>Potential AV bypassing reason</b></p>
<p>1.&nbsp;&nbsp;&nbsp;&nbsp; Packers are commonly used to obfuscate code in order to bypass traditional signature-based detection. The use of multiple files packed with two different packers may be sufficient to bypass detection.</p>
<p><b>7. b1f43ca11dcf9e60f230b9d6d332c479</b> – Book2 - Copy.xls</p>
<p>Type: XLSX<br>
Description: VBA + Python Shellcode loader<br>
Attribution: None<br>
Current detection: 0/54&nbsp;&nbsp;&nbsp;&nbsp;<br>
First Submission: September 20, 2015<br>
Last Submission: January 28, 2016<br>
Time undetected in VT: At least 6 months</p>
<p>When opened, this Excel document appears to be blank but contains the VBA macro shown in Figure 18.</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig18.png"></p>
<p><span class="type-XS">Figure 18: VBA Macro with OLE Object</span></p>
<p>The macro will instantiate an OLE Object and load it via the <span class="code">xlVerbPrimary verb</span>. The embedded OLE object contains two files:</p>
<ul>
<li>python27.dll (md5 7e6dd0d7cb29103df4a592e364680075) - a legitimate file</li>
<li>file.exe (md5 73f16dbf535042bc40e9c663fe01c720) - a binary created with py2exe<a name="_ftnref10"></a>[10]</li>
</ul>
<p>Once file.exe is executed it launches a copy of the Windows calculator (calc.exe) as a decoy. However, behind the scenes it performs a Metasploit reverse TCP Connect to a CnC server.</p>
<p>The unpacked version of file.exe is obfuscated python that can be seen in Figure 19.</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig19.png"></p>
<p><span class="type-XS">Figure 19: Python Shellcode</span></p>
<p>The following steps describe the process in greater detail:</p>
<ul>
<li>File.exe spawns a copy of calc.exe.</li>
<li>Base64-decode and AES-decrypt embedded shellcode.</li>
<li>Via Python ctypes, the environment is set to run the shellcode loader in memory.</li>
<li>The shellcode loader, which has been encoded with the Metasploit Shikata encoder, <a name="_ftnref11"></a>[11] is configured to connect to the host 31.168.144.18 on port 443.</li>
<li>The malware sleeps for 60 seconds and starts again.</li>
</ul>
<p><b>Potential AV bypassing reason</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
</p>
<p>Multiple tricks to evade detection can be seen here:</p>
<ol>
<li>The file extension of the document is .xls. However, the file is actually an Open XML Format file (.xlsx). This simple trick may bypass extension-based parsers.</li>
<li>The Embedded OLE object contains a legitimate binary (python27.dll) and a py2exe executable may appear to be a legitimate file.</li>
<li>The malicious python script is packed using py2exe.</li>
<li>The Embedded OLE object is extracted from a hidden Sheet3, so the VBA Macro may not appear malicious.</li>
<li>The shellcode is Base64 encoded and AES encrypted.</li>
</ol>
<p><b>8. 95e89fd65a63e8442dcf06d4e768e8f1 </b>- Doc1.docm</p>
<p>Type: DOCM<br>
Description: VBA + PowerShell + Netcat as Backdoor<br>
Attribution: None<br>
Current detection: 0/53&nbsp;&nbsp;&nbsp;&nbsp;<br>
First Submission: June 19, 2015<br>
Last Submission: January 26, 2016<br>
Time undetected in VT: At least 7 months</p>
<p>The word document comes with a simple message shown in Figure 20.</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig20.png"></p>
<p><span class="type-XS">Figure 20: Message distractor</span></p>
<p>When the VBA macro is executed (see Figure 21), PowerShell code is loaded from the document’s comments (see Figure 22):</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig21.png"></p>
<p><span class="type-XS">Figure 21: Loading malicious code</span></p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig22.png"></p>
<p><span class="type-XS">Figure 22: Code embedded in the document comments</span></p>
<p>The PowerShell script will act as a backdoor to allow remote access to the compromised machine. The script will download and execute netcat to listen on IP 192.168.52.129 and port 3724. Once a connection is received, a PowerShell shell will be sent (via <span class="code">–e powershell.exe </span>option) to the client (PowerShell Reverse shell) as shown in Figure 23.</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig23.png"></p>
<p><span class="type-XS">Figure 23: Malicious code content</span></p>
<p>It is interesting to note that attackers are moving from traditional command prompt shells (cmd.exe) to PowerShell shells (powershell.exe), which are actually more powerful. For example, PowerShell allows the use of WMI (Windows Management Instrumentation), something not readily accessible via the standard command prompt<a name="_ftnref12"></a>[12].</p>
<p>The script references a non-routable (RFC1918) IP address, so we suspect that the script was either a proof of concept or meant to be used during the lateral movement phase in a specific internal environment that uses this IP space.</p>
<p><b>Potential AV bypassing reason</b></p>
<p>1.&nbsp;&nbsp;&nbsp;&nbsp; Use of the .docm extension may evade extension-based parsers.</p>
<p>2.&nbsp;&nbsp;&nbsp;&nbsp; Embedding the PowerShell script in the document’s comments and executing it from a VB macro adds another layer of complexity. While this is clearly a suspicious behavior, it is not properly identified by signature-based detection.</p>
<p>We identified several other examples of malware using VBA Macros with PowerShell to mainly run shellcode loaders that allow attackers to gain remote access to victims’ machines. Another example is shown below; it has two VT detections, but serves as an example of a very common variant seen in the wild.</p>
<p><b>9. 8de1ebacb72f3b23a8235cc66a6b6f68</b> – Polnoe_raspisanie_igr.xlsm</p>
<p>Type: XLSM<br>
Description: VBA Macro + PowerShell – Shellcode Loader<br>
Attribution: None<br>
Current detection: 2/54&nbsp;&nbsp;&nbsp;&nbsp;<br>
First Submission: October 14, 2015<br>
Last Submission: January 28, 2016<br>
Time undetected: 3.5 months with two generic detections</p>
<p>When the Excel document is opened, a message is displayed in Russian. The user is even provided with a link to a legitimate article describing how to enable macros (see Figure 24).</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig24.png"><span class="type-XS">Figure 24: Excel file with legitimate link</span></p>
<p>When the VBA Macro runs, it executes a PowerShell script that Base64-decodes and decompresses a second-stage PowerShell Script that will be used as the shellcode loader in memory (see Figure 25).</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig25.png"><span class="type-XS">Figure 25: PowerShell script being built on the fly via VB script</span></p>
<p>PowerShell uses the<span class="code"> Invoke-Expression </span>(or IEX) call to execute the decompressed string, similar to the <span class="code">eval() </span>functionality from other programming languages.</p>
<p>The Shellcode in this case comes hardcoded in the second stage PowerShell script, loaded and executed from memory with the following syntax:</p>
<p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span class="code">$z=$o::CreateThread(0,0,$x,0,0,0); Start-Sleep -Second 100000</span></p>
<p>Where $x contains the Shellcode loaded in memory that eventually will connect to the domain spl[.]noip[.]me. Based on DNSDB query, the domain <b>spl[.]noip[.]me </b>previously resolved to Russian IP 81.23.177.72.</p>
<p>Most of the VBA Macro + PowerShell scripts we identified were created with the <span class="code">macro_safe.py</span><a name="_ftnref13"></a>[13] and <span class="code">unicorn.py</span><a name="_ftnref14"></a>[14] scripts, often used for penetration testing.</p>
<p><b>Potential AV bypassing reason</b></p>
<p>1.&nbsp;&nbsp;&nbsp;&nbsp; The .xlsm extension may bypass extension-based parsers</p>
<p>2.&nbsp;&nbsp;&nbsp;&nbsp; Using the VBA Macro in the first stage to build the first PowerShell script via concatenation provides an easy way to bypass signature-based detection</p>
<p>3.&nbsp;&nbsp;&nbsp;&nbsp; The PowerShell scripts are Base64 encoded and compressed</p>
<p><b>10. cda305a6a6c6ace02597881b01a116e3 - </b>CVE-2013-1331-doc.docx</p>
<p>Type: DOCX<br>
Description: Office Downloader<br>
Attribution: None<br>
Current detection: 0/55&nbsp;&nbsp;&nbsp;&nbsp;<br>
First Submission: January 12, 2015<br>
Last Submission: January 16, 2016<br>
Time undetected in VT: The whole year and counting!</p>
<p>In 2013, a stack-based buffer overflow triggered while parsing PNG images was exploited in the wild against MS Office 2003 and Office for Mac. CVE-2013-1331 was assigned to the vulnerability.</p>
<p>The malicious samples did not include the PNG directly embedded in the document; rather, the PNG file was loaded from the Internet by using the <span class="code">INCLUDEPICTURE option</span><a name="_ftnref15"></a>[15].</p>
<p>This new sample uses a different option from the new XML Format called “Relationships” in order to download a resource from the Internet, as seen at Figure 26.</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig26.png"></p>
<p><span class="type-XS">Figure 26: XML content loading the PNG image remotely</span></p>
<p>The same domain was used back in 2013, but now with a different download technique. Although the vulnerability has been patched by Microsoft, the aforementioned technique can be used to download any resource from the Internet.</p>
<p><b>Potential AV bypassing reason</b></p>
<p>1.&nbsp;&nbsp;&nbsp;&nbsp; Use of the XML ‘Relationship’ instead of the original INCLUDEPICTURE method to download resources from the Internet is a novel technique that may not be recognized.</p>
<p>2.&nbsp;&nbsp;&nbsp;&nbsp; Based on the code shown above, it is clear that the intention is not to download a .gif image but a .php resource. Signature-based engines should easily detect the unusual resource name with multiple dots.</p>
<h5><b>Conclusion</b></h5>
<p>Threat actors of all types continue to improve their techniques to compromise organizations and remain undetected within an environment. Our study identified a number of techniques that successfully bypassed many AV engines:</p>
<p>1.&nbsp;&nbsp;&nbsp;&nbsp; Alternate techniques to embed objects within Office documents that may not be recognized by AV engines.</p>
<p>2.&nbsp;&nbsp;&nbsp;&nbsp; The use of a multi-stage infection approach in order to look unsuspicious at each stage:</p>
<p>&nbsp;&nbsp;&nbsp; a.&nbsp;&nbsp;&nbsp;&nbsp; A document downloading an image from the Internet that cannot be flagged as malicious at that stage<br>
&nbsp;&nbsp;&nbsp; b.&nbsp;&nbsp;&nbsp;&nbsp; A VBA Macro script loading malicious content from spreadsheet cells</p>
<p>3.&nbsp;&nbsp;&nbsp;&nbsp; Multiple techniques to load malicious content from Office documents:</p>
<p>&nbsp;&nbsp;&nbsp; a.&nbsp;&nbsp;&nbsp;&nbsp; Embedded as ActiveX<br>
&nbsp;&nbsp;&nbsp; b.&nbsp;&nbsp;&nbsp;&nbsp; Embedded as OLE Binary<br>
&nbsp;&nbsp;&nbsp; c.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Embedded in the document’s comments<br>
&nbsp;&nbsp;&nbsp; d.&nbsp;&nbsp;&nbsp;&nbsp; Embedded in the spreadsheet cell</p>
<p>4.&nbsp;&nbsp;&nbsp;&nbsp; Standalone packed binaries containing malicious Python scripts.</p>
<p>5.&nbsp;&nbsp;&nbsp;&nbsp; Multi-layer Packing: RLPack + Custom UPX.</p>
<p>6.&nbsp;&nbsp;&nbsp;&nbsp; The combination of multiple scripting languages to allow the attackers to obfuscate malicious code, such as VBA Script building malicious PowerShell scripts.</p>
<p>In several cases we note that the attackers are reusing known exploits (such as CVE-2015-5119 or CVE-2013-1331), but changing the delivery method; or leveraging obfuscation, encoding, encryption, or multiple layers of packing to disguise their malicious scripts or backdoors.</p>
<p>For proper detection, it is essential to monitor an attack through its entire life cycle – not simply when a suspicious document or file first enters a network. This approach is necessary to detect and block multi-stage infection strategies. While initial events (such as the delivery of a macro-enabled spreadsheet) may appear innocuous, eventually a later stage of the attack will trigger detection.</p>
<p>It is much easier to stop an attack – including a multi-stage attack – when it first occurs, to include detecting known and unknown exploits (zero days), or even threats that require user interaction such as macros inside documents.</p>
<p>This detection approach is the core logic behind FireEye Multi-Vector Virtual Execution (MVX) technology.</p>
<h5><b>APPENDIX</b></h5>
<p><b>Indicators of Compromise - IOCs</b></p>
<p><b>Network Based:</b></p>
<p><b>4b3858c8b35e964a5eb0e291ff69ced6</b></p>
<p>POST /0000/a242550.asp<br>
IP: 220.128.223.75<br>
TCP Port: 8080&nbsp;</p>
<p><b>4e51143b01e99afc3bd908794d81d3cb</b></p>
<p>GET /bbs/file/machinery/machine_body.jpg<br>
IP: cncauto.co.kr<br>
PORT: 80</p>
<p><b>8de1ebacb72f3b23a8235cc66a6b6f68</b></p>
<p>IP: spl.noip.me<br>
TCP Port: 80</p>
<p><b>b1f43ca11dcf9e60f230b9d6d332c479</b></p>
<p>IP: 31.168.144.18<br>
TCP Port: 443</p>
<p><b>aedd5d8446cc12ddfdc426cca3ed8bf0</b></p>
<p>IP: 84.11.146.62<br>
TCP Port: 13661</p>
<p><b>497eddab53c07f4be1dc4a8c169261a5</b></p>
<p>GET /ocagnt/gethooks.asp<br>
IP: 94.70.155.253<br>
TCP Port: 80<br>
GET /ocagnt/enckeys<br>
IP: 94.70.155.253<br>
TCP Port: 80<br>
GET /ocagnt/getstatus.asp<br>
IP: 94.70.155.253<br>
TCP Port: 80</p>
<p><b>dc15336e7e4579c9c04c6e4e1f11d3dd</b></p>
<p>IP: dennyhacker.no-ip.org<br>
TCP Port: 81</p>
<p><b>Host-Based:</b></p>
<p>dc15336e7e4579c9c04c6e4e1f11d3dd</p>
<p>C:\Windows\System32\install\server.exe (copy of dropped binary) d409dc7e1ca0c86cb71e090591f16146</p>
<p>%AppData%\Local\Temp\XX--XX--XX.txt</p>
<p>Mutex created:<br>
_x_X_PASSWORDLIST_X_x_<br>
x_X_BLOCKMOUSE_X_x_<br>
***MUTEX***<br>
***MUTEX***_PERSIST</p>
<p><b>497eddab53c07f4be1dc4a8c169261a5</b></p>
<p>c:\octemp001\<br>
C:\octemp001\enccmdresults.txt<br>
C:\octemp001\ikeycharvalue.txt<br>
C:\octemp001\enchostnameres.txt<br>
C:\octemp001\certutil.txt<br>
C:\octemp001\cert.txt<br>
C:\octemp001\commands.txt<br>
C:\octemp001\prevcommands.txt<br>
C:\octemp001\enccmdresults.txt<br>
C:\octemp001\enccmdresults2.txt<br>
c:\octemp001\key.txt</p>
<p>Figure 27 shows the MD5s with zero detection detailed on this report.</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig27.png"></p>
<p><span class="type-XS">Figure 27: 2015 samples from VT with zero detections in 2016</span></p>
<p>Some exceptions to this study were added for samples with low detection rates, but with only generic detection (that is, not detected as part of any specific code family), that used an interesting technique or that were suspected of being used by an APT group (see Figure 28).</p>
<p><img src="/content/dam/fireeye-www/blog/images/Ghosts%20Endpoint%20Regalado/Fig28.png"></p>
<p><span class="type-XS">Figure 28: Samples with low and / or generic detection</span></p>
<p><b>dc15336e7e4579c9c04c6e4e1f11d3dd</b> – Brazilian RAT</p>
<p>Some interesting commands from the RAT in Portuguese language:</p>
<table width="100%" cellspacing="0" cellpadding="0" border="1">
<tbody><tr><td valign="top"><p>&nbsp;0002A3A8: pingtest</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A3BC: tentarnovamente</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A3E0: mouseposition</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A3F8: keyboardkey</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A40C: webcaminactive</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A424: webcamgetbuffer</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A43C: webcam</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A44C: desktop</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A45C: stopsearch</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A470: listarvalores</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A488: maininfo</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A49C: configuracoesdoserver</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A4BC: disconnect</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A4D0: uninstall</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A4E4: renameservidor</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A4FC: enviarexecnormal</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A518: enviarexechidden</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A534: executarcomandos</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A550: openweb</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A560: downexec</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A574: resumetransfer</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A58C: listardrives</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A5A4: listararquivos</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A5BC: execnormal</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A5D0: execinv</p>
</td>
</tr><tr><td valign="top"><p>&nbsp;0002A5E0: deletardir</p>
</td>
</tr><tr><td valign="top">&nbsp;</td>
</tr></tbody></table>
<p>[1] Hangul Word Processor is a word processing application developed by South Korean software firm Hancom.<br>
[2] http://www.securityweek.com/zero-day-exploits-leaked-hacking-team-breach<br>
[3] https://www.fireeye.com/blog/threat-research/2015/07/demonstrating_hustle.html<br>
[4] https://msdn.microsoft.com/en-us/library/dd942138.aspx<br>
[5] An XLSB file is stored in binary format instead of the normal XML format, allowing the file to be read from and written to much faster.&nbsp; See https://technet.microsoft.com/en-us/library/dd797428.aspx<br>
[6] http://asec.ahnlab.com/1035<br>
[7] https://www.fireeye.com/content/dam/fireeye-www/global/en/blog/threat-research/FireEye_HWP_ZeroDay.pdf<br>
[8] http://www.pcworld.com/product/997528/rlpack-basic-edition.html<br>
[9] https://www.fireeye.com/blog/threat-research/2014/07/the-little-signature-that-could-the-curious-case-of-cz-solution.html<br>
[10] Py2Exe is a distutils extension to create standalone windows programs from python scripts.&nbsp; See https://sourceforge.net/projects/py2exe/.<br>
[11] https://github.com/rapid7/metasploit-framework/blob/master/modules/encoders/x86/shikata_ga_nai.rb<br>
[12] http://www.howtogeek.com/163127/how-powershell-differs-from-the-windows-command-prompt/<br>
[13] https://github.com/khr0x40sh/MacroShop/blob/master/macro_safe.py<br>
[14] https://raw.githubusercontent.com/trustedsec/unicorn/master/unicorn.py<br>
[15] http://blogs.technet.com/b/srd/archive/2013/06/11/ms13-051-get-out-of-my-office.aspx</p>
</div>
<div class="clear-all"></div></div>
</div>
<div class="par prevnextbutton">
<div class="prevnext">
<div class="button">
<a id="leftBtnId" class="btn btn-B2282D" href="#"><span>Previous</span> <span>Post</span></a>
</div>
<div class="button">
<a id="rightBtnId" class="btn btn-B2282D" href="#"><span>Next</span> <span>Post</span></a>
</div>
</div>
<input type="hidden" value="/content/fireeye-www/en_US/blog/threat-research" id="categoryPathVal" name="categoryPath" />
<script>
    $(document).ready(function(){

         var prevenextHtml = $('.prevnext').html();	
         var categoryPathVal = $("#categoryPathVal").val();
            var blogsDetails;
        
            if(undefined == blogsDetails){
                    blogsDetails = [];
            }
        
        
            if(undefined != prevenextHtml){
                if(blogsDetails.length <= 0){
                     $.ajax({
                        type: "GET",
                        url: "/bin/www-blogs/read-blogentries",
                        dataType: "json",
                        data: { categoryPath: categoryPathVal} ,
                        async: false,
                        success : function(data) {
                            var totalFoundRes = data.blogs.length;
                            blogsDetails = data.blogs;
                            var currentPagePath = window.location.pathname;
                            currentPagePath = currentPagePath.split(".")[0]
                            console.log("currentPagePath :: "+currentPagePath);
        
                            for (var i = 0; i < blogsDetails.length; i++) {
                                var currentItrPath = blogsDetails[i].path;
        
                                if (currentItrPath.indexOf(currentPagePath) > -1) {
                                    console.log(blogsDetails[i-1]);
                                    console.log(blogsDetails[i+1]);

                                    if(undefined != blogsDetails[i-1] ){
										var prevPagePath = blogsDetails[i-1].path;
                                        $("#leftBtnId").attr("href",prevPagePath+".html");
                                        $("#leftBtnId").show();
                                    }else{
										$("#leftBtnId").hide();
                                    }
                                    if(undefined != blogsDetails[i+1] ){
										var nextPagePath = blogsDetails[i+1].path;  
                                    	$("#rightBtnId").attr("href",nextPagePath+".html");
                                        $("#rightBtnId").show();
                                    }else{
										$("#rightBtnId").hide();
                                    }
                                }
                            }
        
                        },
                        error : function(response){
                            console.log("Error: while connecting to servlet.");
                        }
                    });
                 }else{
                     alert("Blogs from global object :: "+blogsDetails);
                 }
            }else{
                alert("prevenextHtml :: "+prevenextHtml);
            }
    });
</script></div>
</div></div>
</div>
</div>
<div id="sidebar" class="g-u-7-24 l_g-u-1 blog-sidebar">
<div class="g-content">
<div class="sidebar reuse-blog-resources">
<div class="blog-resources">
<div class="grid-33-left parsys"><div class="rightrail section">
<div class="blog-right-rail">
<div class="bottom-bar"><div class="tab">
<span class="ficon ficon-star"></span>
<p>Promotion</p></div><div class="tab">
<span class="ficon ficon-checkbox-checked"></span>
<p>Subscribe</p></div>
<div class="tab">
<span class="ficon ficon-share"></span>
<p>Share</p></div>
<div class="tab">
<span class="ficon ficon-history2"></span>
<p>Recent</p></div>
<div class="tab">
<span class="ficon ficon-feed"></span>
<p>RSS</p></div>
</div><div class="section cta">
<div id="cq-image-jsp-/content/fireeye-www/site-content/en_US/blog-right-threat-research/jcr:content/grid-33-left/rightrail/image"><a href="/mandiant/advantage.html"><img src="/content/dam/fireeye-www/blog/images/blog-vision-edition7.gif" alt="blog-vision-edition7" title="blog-vision-edition7" class="cq-dd-image"></a></div></div><div class="section email">
<script src="https://www2.fireeye.com/js/forms2/js/forms2.min.js"></script>
<div id="mktoWrapper_3353" class="a08 bg-f2f2f2"><div class="c00 c00v0"><h3>Subscribe to Blogs</h3><p>Get email updates as new blog posts are added.</p></div><form id="mktoForm_3353"></form> <script type="text/javascript">
		if(typeof digitalData=="undefined"){digitalData={}}
        //alert(https://www2.fireeye.com+":"+848-DID-242)
        //alert("false");
		MktoForms2.loadForm("https://www2.fireeye.com", "848-DID-242", 3353,
		function(form) {
			
            if(typeof fdc.blog.initCheckboxes === "function") {
                fdc.blog.initCheckboxes(form);
            } 
			digitalData.form = {id: form.getId(),name: document.title,url: window.location.href};
			//if(typeof marketoFormViewTealiumEvent !== "undefined" && typeof utag!=="undefined"){marketoFormViewTealiumEvent(form);}
			if(typeof marketoFormViewGtmEvent !== "undefined") {
				marketoFormViewGtmEvent(form);
			}
			form.onSubmit(function(values){
                //Check if GA fields are present
                if(($("input[name='GACLIENTID__c']").length>0)&&($("input[name='GAUSERID__c']").length>0)&&($("input[name='GATRACKID__c']").length>0)&&(typeof ga!=="undefined"))
                {
                      ga(function(){ 
                          //Get tracking ID and Client ID
                           var tracker = ga.getAll()[0];
                           var trackingId = tracker.get('trackingId');
                           var clientId = tracker.get('clientId');
                           var userId = tracker.get('userId');
                           $("input[name='GACLIENTID__c'").val(clientId);
                           $("input[name='GATRACKID__c'").val(trackingId);
                           $("input[name='GAUSERID__c'").val(userId);
                       });
                 }
            
        	});
			form.onSuccess(function(values, followUpUrl) {
				//if(typeof marketoFormSubmitTealiumEvent !== "undefined"){marketoFormSubmitTealiumEvent(values);}
				if(typeof marketoFormSubmitGTMEvent !== "undefined") {
					marketoFormSubmitGTMEvent(values);
				}
				
				if(typeof fdc.blog.replaceFormWithThankYou === "function") {
					var result = fdc.blog.replaceFormWithThankYou(form,values,followUpUrl);
					if (result === false) {
						return false;
					}
				} 
				return true;
			});
			
			var adrC = typeof addMissingUTMsFromCookies !== "undefined" ? addMissingUTMsFromCookies(document.URL) : document.URL;
			form.addHiddenFields({ ADR__c: adrC,ADR_Credit__c_account: document.title,ADR_Credit__c: document.referrer });
			if(($("input[name='GACLIENTID__c']").length==0)&&($("input[name='GAUSERID__c']").length==0)&&($("input[name='GATRACKID__c']").length==0)){
				form.addHiddenFields({ GACLIENTID__c:"",GAUSERID__c:"",GATRACKID__c:""});				
			}
			
		});
	</script>
</div></div>
<div class="section share">
<h6><small>Share</small></h6>

<div class="addthis_inline_share_toolbox_7uq8"></div>
</div>
<div class="section recent">
<h6>Recent Posts</h6>

<div class="c05 c05v0"><ul>
<li class="c05_item"><p class="c05_date">15 Sep 2021</p><a class="c05_link" href="/blog/threat-research/2021/09/elfant-in-the-room-capa-v3.html" title="ELFant in the Room – capa v3">ELFant in the Room – capa v3</a></li>

<li class="c05_item"><p class="c05_date">12 Aug 2021</p><a class="c05_link" href="/blog/threat-research/2021/08/announcing-the-eighth-annual-flare-on-challenge.html" title="Announcing the Eighth Annual Flare-On Challenge">Announcing the Eighth Annual Flare-On Challenge</a></li>

<li class="c05_item"><p class="c05_date">19 Jul 2021</p><a class="c05_link" href="/blog/threat-research/2021/07/capa-2-better-stronger-faster.html" title="capa 2.0: Better, Faster, Stronger">capa 2.0: Better, Faster, Stronger</a></li>
</ul></div>
</div>
<a href="/content/fireeye-www/en_US/blog/threat-research/_jcr_content.feed" target="_blank">
<div class="section rss">
<h6><small>RSS Feed: </small><small>Stay Connected</small></h6>
<span class="ficon ficon-feed"></span>
</div>
</a>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</main>

<div class="footer_f635 footer">

<footer id="g03-footer" class="l_footer g03 g03v0 g03v2 g03-5col">
<div class="main-footer-wrapper">

<div class="g03_list g03_list_1">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>About</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/company.html" class="Footer">Why FireEye?</a></li>
<li class="g03_item"><a href="/customers.html" class="Footer">Customer Stories</a></li>
<li class="g03_item"><a href="/company/jobs.html" class="Footer">Careers</a></li>
<li class="g03_item"><a href="/company/compliance-certification.html" class="Footer">Certifications and Compliance</a></li>
<li class="g03_item"><a href="/company/supplier.html" class="Footer">Supplier Documents</a></li>
<li class="g03_item"><a href="/current-threats.html" class="Footer">Resources</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_2">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>News and Events</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/company/newsroom.html" class="Footer">Newsroom</a></li>
<li class="g03_item"><a href="/company/press-releases.html" class="Footer">Press Releases</a></li>
<li class="g03_item"><a href="/company/webinars.html" class="Footer">Webinars</a></li>
<li class="g03_item"><a href="/company/events.html" class="Footer">Events</a></li>
<li class="g03_item"><a href="/company/awards.html" class="Footer">Awards and Honors</a></li>
<li class="g03_item"><a href="/company/contact-us/manage-your-communication-preference.html" class="Footer">Email Preferences</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_3">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Technical Support</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/support.html" class="Footer">Support</a></li>
<li class="g03_item"><a href="/company/security.html" class="Footer">Report Security Issue</a></li>
<li class="g03_item"><a href="/support/contacts.html" class="Footer">Contact Support</a></li>
<li class="g03_item"><a href="https://csportal.fireeye.com/" target="_blank" class="Footer">Customer Portal</a></li>
<li class="g03_item"><a href="https://community.fireeye.com/" target="_blank" class="Footer">Communities</a></li>
<li class="g03_item"><a href="https://docs.fireeye.com" target="_blank" class="Footer">Documentation Portal</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_4">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>FireEye Blogs</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/blog/threat-research.html" class="Footer">Threat Research</a></li>
<li class="g03_item"><a href="/blog/products-and-services.html" class="Footer">FireEye Stories</a></li>
<li class="g03_item"><a href="/blog/executive-perspective.html" class="Footer">Industry Perspectives</a></li>
</ul></div>
<div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Threat Map</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/cyber-map/threat-map.html" class="Footer">View the Latest Threats</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_5">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Contact Us</strong><br>
<div class="footer-list section">
<ul class="g03_block">
<li class="g03_item"><a href="tel:+1 877-347-3393" class="contactlinks">+1 877-347-3393</a><br>&nbsp;</li>
</ul>
</div></div>
<div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Stay Connected</strong></p></div>
<div class="followus-footer section"><h4 class="g03_title" id="g03-followus-title"> </h4><ul class="g03_block g03-s" id="g03-followus-list"><li class="g03_item g03_item-s">
<a href="https://www.linkedin.com/company/fireeye" target="_blank">
<span class="g03-s-i ficon g03-s-i-li ficon-linkedin"></span>
<span class="g03-s_label">LinkedIn</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://twitter.com/fireeye" target="_blank">
<span class="g03-s-i ficon g03-s-i-tw ficon-twitter2"></span>
<span class="g03-s_label">Twitter</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://www.facebook.com/FireEye" target="_blank">
<span class="g03-s-i ficon g03-s-i-fb ficon-facebook2"></span>
<span class="g03-s_label">Facebook</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://www.youtube.com/user/FireEyeInc" target="_blank">
<span class="g03-s-i ficon g03-s-i-yt ficon-youtube2"></span>
<span class="g03-s_label">YouTube</span>
</a>
</li></ul>
</div>
<div class="htmlpassthru section">
<div class="country-notification">
<div id="c08_modal-lang" class="c08_modal lang">
<div class="c08 c08v1">
<div class="c08_header">
<a href="#dismiss-lightbox" class="ficon ficon-close c08_dismiss" data-behavior="dismiss-c08"></a>
</div>
<div class="c08_content">
<div class="c08_body">
<div class="col FR">
<p class="type-ML">Cette page est également disponible en français.</p>
<div class="button section"><a class="btn" href="/index.html">Version française</a></div>
</div>
<div class="col DE">
<p class="type-ML">Diese Seite ist auch auf Deutsch verfügbar</p>
<div class="button section"><a class="btn" href="/index.html">Zur deutschen Seite wechseln</a></div>
</div>
<div class="col JP">
<p class="type-ML">日本語ページを</p>
<div class="button section"><a class="btn" href="/index.html">見る</a></div>
</div>
<div class="col KR">
<p class="type-ML">해당 페이지는 한글 버전으로 보실 수 있습니다</p>
<div class="button section"><a class="btn" href="/index.html">바로 가기</a></div>
</div>
<hr>
<div class="col">
<p><a class="dismiss" href="#dismiss-lightbox" data-behavior="dismiss-c08">Continue viewing this page in English</a></p>
</div>
</div>
</div>
</div>
</div>
<style>
.c08_modal.lang {
    background: rgba(255,255,255,0.8);
}
.c08_modal.lang .c08_header {
    background: transparent;
    border-left: none;
}
.c08_modal.lang .c08 {
    top: 20%;
    width: 600px;
    border-radius: 12px;
    box-shadow: rgba(0, 0, 0, 0.37) 0 0 15px;
    border: 1px solid #b4b5b8;
    background-image: url("/content/dam/fireeye-www/fw/images/bg-language-select.jpg");
    background-position: right bottom;
    margin: 0 auto;
    position: relative;
    max-width: 90%;
}
.c08_modal.lang .c08_dismiss {
    color: #222;
}
.c08_modal.lang .c08_body {
    padding: 12px 50px 60px;
}
.c08_modal.lang .col {
    display: none;
}
.c08_modal.lang .col:last-child {
    display: block;
}
.c08_modal.lang .btn {
    margin-bottom: 0;
}
.c08_modal.lang hr {
    margin: 30px 80px;
}
.c08_modal.lang hr:before {
    border-bottom: none;
}
</style>
</div></div>
</div>
</div></div>
<div class="legal-footer-wrapper">
<div class="legal-footer">
<div class="g03_copyright">
<p class="g03_copyright_p">
Copyright&nbsp;&copy;&nbsp;2021&nbsp;FireEye.&nbsp;All rights reserved.&nbsp;<span class="g03-legal"><a href="/company/privacy.html">Privacy &amp; Cookies Policy</a> | <a href="/company/legal.html">Legal Documentation</a></span>
</p>
</div><div class="g03_languages">
<a class="g01_options-option" href="#footer-worldwide">
<span>Site Language</span>
<span>English<span class="ficon ficon-globe"></span></span>
</a>
<div class="option-menu" id="footer-worldwide">
<p><strong>My preferred language:</strong></p>
<ul class="g01_options_list"><li><a href="https://www.fireeye.com/blog/threat-research/2016/04/ghosts_in_the_endpoi.html" target="_blank">English (English)</a></li>
<li><a href="https://www.fireeye.fr" target="_blank">French (Français)</a></li>
<li><a href="https://www.fireeye.de" target="_blank">German (Deutsch)</a></li>
<li><a href="https://www.fireeye.jp" target="_blank">Japanese (日本語)</a></li>
<li><a href="https://www.fireeye.kr" target="_blank">Korean (한국어)</a></li>
<li><a href="/products/international-literature.html">More languages</a></li>
</ul>
</div>
</div> </div>
</div>
</footer>
</div>
<script type="text/javascript" src="/etc/designs/fireeye-www/clientlibs_fw.min.js"></script>


<div class="htmlpassthru_c66c htmlpassthru">

<script>
function changeSlide(a) {
    if(isNaN(a)){console.log("updating i");i=2;a=2;}
	$('#uc-he01_carousel').removeClass('uc-he01_s-1 uc-he01_s-2 uc-he01_s-3 uc-he01_s-4 uc-he01_s-5');
	$('.uc-he01_sc_s, .uc-he01_c_btn').removeClass('is-active');
	$('#uc-he01_sc_s-'+(a)+', [data-target="'+(a)+'"]').addClass('is-active animate');
	window.setTimeout(function() {$('.uc-he01_sc_s, .uc-he01_c_btn').not('#uc-he01_sc_s-'+(a)).removeClass('animate');}, 1000);
	$('#uc-he01_carousel').addClass('uc-he01_s-'+(a));
}
</script></div>

<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=fewebadmin"></script>
</body>
</html>
