
<!DOCTYPE html>
<html>
<head>

<script>
    var companyDetails6Sense = localStorage.getItem('_6senseCompanyDetails');

    if(null != companyDetails6Sense || companyDetails6Sense != "" || companyDetails6Sense != undefined){
		var jsonVal = JSON.parse(companyDetails6Sense);

        var companyRevenueRange = jsonVal.company.revenue_range;
        var companyCountry = jsonVal.company.country;
        var companyIndustry = jsonVal.company.industry;
        var companyName = jsonVal.company.name;
        var companyRegion = jsonVal.company.region;
        var companyDomain = jsonVal.company.domain;
    	var segments = JSON.stringify(jsonVal.segments);
    	
        window.dataLayer=window.dataLayer ||[];
        window.dataLayer.push({
                "company_industry" : companyIndustry,
                "company_name" : companyName,
                "company_revenue" : companyRevenueRange,
                "company_country" : companyCountry,
                "company_region" : companyRegion,
            	"company_domain" : companyDomain,
            	"segments" : segments
        });
    }

</script>

<style>.async-hide { opacity: 0 !important} </style>
<script>(function(a,s,y,n,c,h,i,d,e){s.className+=' '+y;h.start=1*new Date;
h.end=i=function(){s.className=s.className.replace(RegExp(' ?'+y),'')};
(a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c;
})(window,document.documentElement,'async-hide','dataLayer',4000,
{"GTM-5ZX7QTZ":true});</script>

<title>Emulation of Malicious Shellcode With Speakeasy | FireEye Inc</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<link rel="alternate" type="application/atom+xml" title="Atom Feed for &#39;Emulation of Malicious Shellcode With Speakeasy&#39;" href="/content/fireeye-www/en_US/blog/threat-research/2020/08/emulation-of-malicious-shellcode-with-speakeasy/_jcr_content.feed">
<link rel="canonical" href="https://www.fireeye.com/blog/threat-research/2020/08/emulation-of-malicious-shellcode-with-speakeasy.html">
<meta name="language" content="en">
<meta name="locale" content="en_US">
<meta http-equiv="cleartype" content="on">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
<meta name="description" content="We introduce the Speakeasy, a framework that enables emulation of malware samples at scale in the easiest way possible.
">

<meta itemprop="name" content="Emulation of Malicious Shellcode With Speakeasy">
<meta itemprop="description" content="We introduce the Speakeasy, a framework that enables emulation of malware samples at scale in the easiest way possible.
">
<meta itemprop="image" content="https://www.fireeye.com/content/dam/fireeye-www/fw/images/fireeye-2-color-square.png">

<meta name="twitter:site" content="@FireEye">
<meta name="twitter:title" content="Emulation of Malicious Shellcode With Speakeasy">
<meta name="twitter:description" content="We introduce the Speakeasy, a framework that enables emulation of malware samples at scale in the easiest way possible.
">
<meta name="twitter:creator" content="@FireEye">
<meta name="twitter:image" content="https://www.fireeye.com/content/dam/fireeye-www/fw/images/fireeye-2-color-square.png">

<meta property="og:title" content="Emulation of Malicious Shellcode With Speakeasy">
<meta property="og:type" content="website">
<meta property="og:url" content="https://www.fireeye.com/blog/threat-research/2020/08/emulation-of-malicious-shellcode-with-speakeasy.html">
<meta property="og:image" content="https://www.fireeye.com/content/dam/fireeye-www/fw/images/fireeye-2-color-square.png">
<meta property="og:description" content="We introduce the Speakeasy, a framework that enables emulation of malware samples at scale in the easiest way possible.
">
<meta property="og:site_name" content="FireEye">
<meta property="fb:admins" content="45127269202">
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/jquery.min.js"></script>

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MVGC8KK');</script>


<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/jquery/granite/csrf.min.js"></script>
<script type="text/javascript" src="/etc/designs/fireeye-www/clientlibs_nav.min.js"></script>
<script type="text/javascript">
var cookiesOK = $.cookie("ec-privacy");
var fdc =fdc || {};
var onAccept = function () {
	$.cookie("ec-privacy", "accept", { path: "/", expires: 365 });
	jQuery("#cookie-privacy-banner").hide();
};

var onDecline = function () {
	$.cookie("ec-privacy", "decline", { path: "/", expires: 365 });
	jQuery("#cookie-privacy-banner").hide();
};

var ipLocation = (function () {
	var banner ="#cookie-privacy-banner";

	/* Show the privacy notification banner. */
	var showBanner = function (banner) {
		jQuery(banner).show();
	};

	/* Suppress the privacy notification banner. */
	var hideBanner = function (banner) {
		jQuery(banner).hide();
	};

	/* These are the country codes for the countries subject to EC privacy laws.
	 * We will check to see if a visitor is coming from one of these countries.
	 * If they are, we display a privacy notification banner. If not, we
	 * do nothing. */
	var countries = {
		"AT": true,"BE": true,"BG": true,"HR": true,"CY": true,"CZ": true,"DK": true,
		"EE": true,"FI": true,"FR": true,"DE": true,"GR": true,"HU": true,"IE": true,
		"IT": true,"LV": true,"LT": true,"LU": true,"MT": true,"NL": true,"PL": true,
		"PT": true,"RO": true,"SK": true,"SI": true,"ES": true,"SE": true,"GB": true
	};
	var defaultSite = "US";

	var onSuccess = function (geoipResponse) {
		fdc.geoipresponse=geoipResponse;
		/* There's no guarantee that a successful response object
		 * has any particular property, so we need to code defensively. */
		if (!geoipResponse.country.iso_code) {
			hideBanner(banner);
			return;
		}
		//
		if (location.host.indexOf("stage") >= 0 && geoipResponse.country.iso_code === "SG") {
            geoipResponse.country.iso_code = "ES"
        }
		/* ISO country codes are in upper case. */
		var code = geoipResponse.country.iso_code;
			
		
		if ((countries[code]) && (cookiesOK == undefined)) {
			showBanner(banner);
		}
		else {
			hideBanner(banner);
		}
	};

	/* We don't really care what the error is. */
	var onError = function (error) {
		hideBanner(banner);
	};

	return function () {
		geoip2.country( onSuccess, onError );
	};
}());
ipLocation();
</script>
<div class="htmlpassthru_836d htmlpassthru">

<script type="text/javascript">
    if (!String.prototype.includes) {
        String.prototype.includes = function() {
            return String.prototype.indexOf.apply(this, arguments) !== -1;
        };
    }
var userAgent = navigator.userAgent,
gomezAgent = userAgent.includes("GomezAgent"),
prtgAgent = userAgent.includes("PRTG Network Monitor");

if (gomezAgent || prtgAgent) {
    cookiesOK = "decline";
}

if (cookiesOK != "decline") {
    // Google Analytics was here. Now it's in Tealium and GTM.
}
// Temporary patch for AA issue.
if(typeof _satellite == "undefined") {
    _satellite = {};
    _satellite.track = function(){};
}
</script>
<style>
@media ( max-width : 959px) {
    .g04 .megamenu .n03-sub_table .n03-sub_cell, .g04 .megamenu .separator {
        display: block;
    }
    .g04 .megamenu .n03_list-item-sub>.megamenu-cta {
        padding: 0;
    }
    .g04 .megamenu .n03-sub_cell.n03-sub_cell-utility {
        padding: 11px 0 11px 10px;
    }
}

@media ( min-width : 48em) {
    .cta-bar .n01 .n01_cell {
        width: auto;
    }
}

/* styles for the CTA bar test */
.n01.n01v1 .n01_cell {
    background-color: #222;
    border: 1px solid #444;
}

.n01.n01v1 .n01_cell .ficon, .n01.n01v1 .n01_cell .n01_label, .n01.n01v1 .n01_text
    {
    color: #fff;
}

@media ( min-width : 48em) {
    .n01.n01v1 .n01_cell {
        background-color: transparent;
        border: none;
    }
    .n01.n01v1 .n01_link {
        background-color: #222;
        border: 1px solid #444;
        border-right: 0;
    }
}
/* fix for new footer */
.g03v1 .g03-s-i:after {
    left: -3px;
}
/* fix for tables */
span.nowrap {
    white-space: nowrap;
}
/* fix for blog cta */
.blog-cta {
    border: 1px solid #dadadb;
    background-color: #ebebed;
    margin-bottom: 10px;
    line-height: 0;
}
</style>
<link rel="stylesheet" type="text/css" href="https://cloud.typography.com/6746836/6977592/css/fonts.css" />
<link rel="stylesheet" type="text/css" href="/content/dam/fireeye-www/fw/css/patch.css?v=1" />
<script type="text/javascript">
var addthis_config = addthis_config||{};
    addthis_config.data_track_clickback = false;
var addthis_share = {
   url: window.location.href
};
</script>
<style>
/* fix for IE */
.uc-he01v1 .uc-he01_container .background {
    max-height: 470px;
    position: absolute;
}
.uc-he01v2 .uc-he01_container .background {
    position: absolute;
}
@media (max-width: 48em) {
    .uc-he01v1 .uc-he01_container .background {
        max-height: 320px;
    }
}
@media (min-width: 54em) {
    .uc-he01v1 .uc-he01_container .background {
        max-height: 600px;
    }
}
</style>
<style>
/* Update the images used in the Table component. */
.c09v1 .tablesorter-default .header, .c09v1 .tablesorter-default .tablesorter-header {
background-position-x: calc(100% - 4px);
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggTWFjaW50b3NoIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjc2NDE0RUUyNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjc2NDE0RUUzNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTg5MzI0RkY2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTg5MzI1MDA2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz567IGQAAAApklEQVR42mL8//8/A0kApAELlgJiG2xyTDjMcQFiayDmRJfApkEbiJWgiq2J0eCCxLYBYkF8GjAUAIEvLg2C2JwAdZ42Ng022DyJ7kwmJFOM8YS+INRABkZSI45sDSAnxRFQuweIj8D8cA+Iz+JR/B6kGD2UQALf8ZiOEawgU45iUQyy/SqumD4C1YgMNhNKS3vwGYBNw1WoM75jdSKpGYjkiAMIMAAPu279CuYueAAAAABJRU5ErkJggg==)
}
.c09v1 .tablesorter-default thead .headerSortUp,.c09v1 .tablesorter-default thead .tablesorter-headerSortUp,.c09v1 .tablesorter-default thead .tablesorter-headerAsc{background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggTWFjaW50b3NoIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU4OTMyNEY5Njc2QjExRThBNEFDQTFFRUMyNzIyRjM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU4OTMyNEZBNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTg5MzI0Rjc2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTg5MzI0Rjg2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5TuQesAAAAp0lEQVR42mL8//8/A0kApAELNgbicmxyuDTsBuJ3QCxIjIbQ/wjQQYyGu/9RgRI+DeX/McFuXBqUoO7GBkKxaZj5Hze4i67B5T9hAA5mRlIjjmwNSkAcR0DtHiA+wgTl3APis3gUvwcpBjGYkARBAt/xmM6ArgFkylEsikG2X8WmAWbLezSxzcgcJnzWYzMAm4arUGd8x+pEHPlBCohtsMmRHHEAAQYAbP+KkOIl8zUAAAAASUVORK5CYII=)}
.c09v1 .tablesorter-default thead .headerSortDown,.c09v1 .tablesorter-default thead .tablesorter-headerSortDown,.c09v1 .tablesorter-default thead .tablesorter-headerDesc{background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggTWFjaW50b3NoIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU4OTMyNEZENjc2QjExRThBNEFDQTFFRUMyNzIyRjM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU4OTMyNEZFNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTg5MzI0RkI2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTg5MzI0RkM2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6nOhWUAAAAqElEQVR42mL8//8/AymACYe4FBDbkKLBBYitgZiTGA3aQKwEVWxNjAYXJDbIWYL4NGAoAAJfXBoEsTkB6jxtbBpssHkS3ZlMSKYY4wl+QVgwM1Ir4ghqALnxPwFcDlYJchIUz/yPG9yFqUPWoATE73BoCMWmAYTLsSjejawGXQMD1HpkoERIQyiS4g50eWwaGKDOAPlHEF2OBUdwV0CD+j26BMkxDRBgALvSCpUQlZEGAAAAAElFTkSuQmCC)}
.c09v1 .tablesorter-default thead .sorter-false {
    background-image: none;
}
@media (max-width: 41.9125em){
    .c09.c09v1.has-data-label tr>:not(:first-child):before {
        width: auto; min-width: 35%;
    }
}
</style>
<script>
$(document).ready(function(){
    if(typeof(ipLocation) !== "undefined" && typeof fdc.geoipResponse === "undefined"){ipLocation();}
    if(typeof fdc.geoipResponse !== "undefined"){showCountryNotification(fdc.geoipResponse);}
    if(typeof fdc.geoipResponse !== "undefined" && typeof fdc.geoipResponse.country !== "undefined" && fdc.geoipResponse.country.is_in_european_union && ($.cookie("ec-privacy") == undefined)){jQuery("#cookie-privacy-banner").show();}
});
function showCountryNotification(geoipResponse) {
	if (!geoipResponse.country || !geoipResponse.country.iso_code) {
        return;
    }
	var code = geoipResponse.country.iso_code,
	    langIndex = code === "FR" ? 2 : code === "DE" ? 3 : code === "JP" ? 4 : code === "KR" ? 5 : 1;
	if (langIndex > 1) {
		$('.c08_modal.lang').addClass("is-open");
		$('.c08_modal.lang .col:nth-child(' + (langIndex - 1) + ')').show();
		$('.c08_modal.lang, .c08_modal.lang [data-behavior="dismiss-c08"]').click(function(){
		    $.cookie("country-notification", "decline", { path: "/", expires: 365 });
		    closec08();
		});
		$('.c08_modal.lang .c08').click(function(e){
		    e.stopPropagation();
		});
		if (($.cookie("country-notification") === "decline") || $(".g01_options_list li:nth-child(" + langIndex + ") a").attr("href").indexOf(".html") < 0) {
		    closec08();
		} else {
		    $(".c08_modal.lang .btn").eq(langIndex - 2).attr("href", $(".g01_options_list li:nth-child(" + langIndex + ") a").attr("href"));
		}
	}
}
</script>
<script>    
     var _6SenseJsonObj = localStorage.getItem('_6senseCompanyDetails'),
         _6SenseTime = localStorage.getItem('_6senseCompanyDetails-timestamp'),
         isJsonStale = _6SenseTime === null ? true : Date.now() - parseInt(_6SenseTime) > 86400000; // 86400000 = 1 day in ms
     
     window._6si = window._6si || [];
     window._6si.push(['enableEventTracking', true]);
     window._6si.push(['setToken', '1322340356018696d853e0ac6f7ce3a2']);
     window._6si.push(['setEndpoint', 'b.6sc.co']);
     if(_6SenseJsonObj === null || isJsonStale){
       window._6si.push(['enableCompanyDetails', true]);
       window._6si.push(['setEpsilonKey', '325d6d60e24c7cfc3a782839d85ce08c8d3bb27c']);
       localStorage.setItem('_6senseCompanyDetails-timestamp', Date.now());
     }  
    (function () {
          var gd = document.createElement('script');
      gd.type = 'text/javascript';
      gd.async = true;
      gd.src = '//j.6sc.co/6si.min.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(gd, s);
     })();
</script>
<script>
    var jsonObj;

    function targetPageParams() { 
        jsonObj = localStorage.getItem('_6senseCompanyDetails');
        if(jsonObj) {
        	var jsonVal = JSON.parse(jsonObj);
            return { 
                "companyRevenueRange": jsonVal.company.revenue_range, 
                "companyCountry": jsonVal.company.country, 
                "companyIndustry": jsonVal.company.industry,
                "companyName": jsonVal.company.name,
                "companyRegion": jsonVal.company.region,
                "companyDomain": jsonVal.company.domain,
                "segments": JSON.stringify(jsonVal.segments)
            }; 
        }
     }; 
</script>
<script>
$(document).ready(function(){
    $(".loadmore").on("click", function(){$(".list.parbase").addClass("no-max-height");});
    // Don't show title text for textures.
    $(".texture img").attr("title", "");
});
</script>
<style>
.no-max-height .c11v9 h4{
    max-height: none !important;
}
.g04 #header-search .search-field_submit:after {
    font-size: 9px;
}
.c11v8.hideLinkText .btn {
    display: inline-block;
}
/* CTA fix */
.g04 .megamenu-tab .has-inner-cta .n03-sub_container {
    padding: 0;
    margin: 0 0 0 10px;
    max-width: 1210px;
}
.g04 .megamenu-tab .has-inner-cta .col-wrap {
    padding: 40px 0;
}
.g04 .n03-sub_container[data-columns="1"] .megamenu-cta {
    width: 50%;
}
.g04 .n03-sub_container[data-columns="2"] .megamenu-cta {
    width: 33.9%;
}
.g04 .has-inner-cta > [data-columns="2"] .n03-sub_cell {
    width: calc(50% - 60px);
}
.g04 .n03-sub_container[data-columns="3"] .megamenu-cta {
    width: 25%;
}
.g04 .n03-sub_container[data-columns="4"] .megamenu-cta {
    width: 20%;
}
.g04 .megamenu-cta h5 {
    line-height: 1.4;
}
html .g04 header .megamenu-cta h5 {
    font-weight: 500;
    font-size: 15px;
    color: #44474d;
}
html .g04 header .megamenu-cta p {
    font-weight: 300;
    color: #44474d;
}
.g04 .n03-sub_table > .megamenu-cta {
    background: none;
    padding: 0;
}
.g04 .megamenu-cta .n03_utility {
    border: none;
    height: 100%;
}
.g04 .megamenu-cta .n03_utility_cell {
    display: block;
    width: auto;
    margin-left: 30px;
}
/* Un/re-comment to add/remove in the line to the left of the CTA in the megamenu. */
.g04 .n03-sub_table .col-wrap:not(:last-child) .separator.disabled {
    border-right-color: #ebebed;
}

/* Put a grid over the texture from a neighboring grid. */
.force {
    z-index: 15;
    position: relative;
}
/* Remove the gradient above the tiles on blog pages and reduce the space there. */
.iparsys + .l_container>div.gradient-top {
    background-image: none;
}
.iparsys + .l_container>.gradient-top>div>.g {
    padding: 0;
}
@media (min-width: 35em) {
    .entries .highlightFirst .c11v9 .c11-image-div {
        border-left: 1px solid #dadadb;
        border-right: 1px solid #dadadb;
    }
}
@media (max-width: 1024px) {
    .uc-he01v2 .panel .asset .image img {
        max-height: 200px;
	max-width: 300px;
    }
}
/* mobile view for MegaMenu CTA. */
@media (max-width: 1024px) {
    .g04 .megamenu-tab.open .n03_list-item-sub.has-inner-cta {
        padding-bottom: 0;
    }
    .g04 .has-inner-cta > [data-columns="2"] .n03-sub_cell,
    .g04 .n03-sub_container[data-columns="2"] .megamenu-cta {
        width: 100%;
        display: block;
    }
    .g04 .megamenu-tab .has-inner-cta .n03-sub_container {
        margin: 0;
    }
    .g04 .megamenu-tab .has-inner-cta .n03-sub_container .col-wrap {
        padding: 0;
    }
    .g04 .megamenu-cta .n03_utility_cell {
        margin-left: 15px;
        margin-right: 22px;
    }
    .g04 .megamenu-cta .n03_utility_cell:nth-child(1) {
        padding-bottom: 0;
    }
    .g04 .megamenu-cta .n03_utility_cell:nth-child(2) {
        padding-top: 0;
    }
    .g04 .megamenu-cta .n03_utility_cell h5,
    .g04 .megamenu-cta .n03_utility_cell p {
        font-size: 12px;
    }
    .content-2-par .megamenus .n03-sub_table .megamenu-cta {
        border-radius: 0;
    }
}
/* Training pages side design. */
  .training-side-box {background: url('/content/dam/fireeye-www/brand/homepage-banner-images/hpb-bg-testimonial-red.jpg') left no-repeat; background-size: cover; padding:30px; border: 1px solid #dadadb; margin-bottom: 20px;}
  .training-side-text {color: #ffffff;}
  .training-side-text a:hover {color: #ffffff; text-decoration: underline;}

/* Avoid column breaks in ordered lists. */
  .c00 ol > li {page-break-inside: avoid; margin-bottom: 15px;}

/* Safari needs this on html to stop side scrolling, not just on the body. */
html {overflow-x:hidden;}
/* Make sure the footer is above a texture that precedes it. */
#g03-footer {z-index: 725;}
/* Allow border for linked images. */
.border>a>img {border: 1px solid #dadadb;}
/* Allows for easy scrollable text boxes on blog pages right in the Blog Text component. */
table.limitedHeight td {
    height: 350px;
    display: block;
    overflow-y: scroll;
    overflow-x: hidden;
    padding-bottom: 0;
}
/* Fix for edge case in Safari where page title in breadcrumbs wraps when the title is just the right length. */
.g02_list_item:last-child span {
    min-width: 360px;
    display: block;
}
</style></div>

<link rel="stylesheet" href="/etc/designs/fireeye-www/clientlibs_fw-2019.min.css" type="text/css">
<link rel="stylesheet" href="/etc/clientlibs/fireeye-blog/clientlibs_base.min.css" type="text/css">
<link rel="icon" type="image/vnd.microsoft.icon" href="/content/dam/fireeye-www/brand/logos/fireeye.ico">
<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="/content/dam/fireeye-www/brand/logos/fireeye.ico">
</head>

<body itemscope itemtype="http://schema.org/WebPage" data-redesign="redesign-2019"><script type="text/javascript">window.Granite = window.Granite || {}; window.Granite.csrf = true;</script>


<div class="clientcontext parbase"><script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/utils.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/jquery/granite.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/foundation/clientlibs/jquery.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/foundation/clientlibs/shared.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/lodash/modern.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/cq/personalization/clientlib/personalization/kernel.min.js"></script>
<script type="text/javascript">
    $CQ(function() {
        CQ_Analytics.SegmentMgr.loadSegments("\/etc\/segmentation");
        CQ_Analytics.ClientContextUtils.init("\/etc\/clientcontext\/default", "\/content\/fireeye\u002Dwww\/en_US\/blog\/threat\u002Dresearch\/2020\/08\/emulation\u002Dof\u002Dmalicious\u002Dshellcode\u002Dwith\u002Dspeakeasy");

        
    });
</script>
</div>


<div class="masthead_v2 masthead-v2">
<div class="g04 masthead g04v1">


<div class="bottom-bar">
<div class="tab">
<span class="ficon ficon-warning"></span>
<p><a class="contact_bar" href="/company/incident-response.html">Report an Incident</a></p>
</div>
<div class="tab">
<span class="ficon ficon-phone2"></span>
<p><a class="contact_bar" href="/company/contact-us.html">Contact Us</a></p>
</div>
</div>
<div class="cta-bar">
<div class="content-well">
<ul>
<li>
<a class="contact_bar" href="/company/contact-us.html">
<span class="g04_label">Contact Us</span><span class="g04_icon"><span class="ficon ficon-phone3"></span></span>
</a>
</li>
<li style="display: none;" id="liveagent_button_online_573a00000008kP3">
<a class="contact_bar" href="javascript://Chat" onclick="liveagent.startChat('573a00000008kP3')">
<span class="g04_label">Chat with an Expert</span><span class="g04_icon"><span class="ficon ficon-chat"></span></span>
</a>
</li>
<li class="red">
<a class="contact_bar" href="/company/incident-response.html">
<span class="g04_label">Report an Incident</span><span class="g04_icon"><span class="ficon ficon-incident"></span></span>
</a>
</li>
</ul>
</div>
</div>

<script type="text/javascript">
    if (!window._laq) { window._laq = []; }
    window._laq.push(function(){
    	liveagent.showWhenOnline('573a00000008kP3', document.getElementById('liveagent_button_online_573a00000008kP3'));
    });
</script>
<script type="text/javascript" src="https://c.la2c2.salesforceliveagent.com/content/g/js/34.0/deployment.js"></script>
<script type="text/javascript">
    liveagent.init("https://d.la2c2.salesforceliveagent.com/chat", "572a0000000H8aJ", "00D3000000063LS");
</script><header role="banner" itemscope itemtype="http://schema.org/WPHeader">
<div class="language-and-search"> <div class="search">
<div class="content-searchbox searchbox">
<a class="g01_options-option option-search" href="#header-search" data-for="q" data-behavior="showHeaderMenu focusField">Search</a>
<div class="option-menu option-menu_search" id="header-search">
<form method="get" action="/search.html">
<fieldset class="search-field" title="Search FireEye.com">
<label class="search-field_label" for="q">Search FireEye.com</label>
<input class="input-text search-field_text" type="text" name="q" id="q" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" data-locale="en_US" placeholder="Search FireEye.com">
<div id="searchboxsuggestions"></div>
<button class="btn btn-secondary search-field_submit" type="submit">Go</button>
</fieldset>
</form>
</div>
</div>
</div>
</div>
<div class="logo-and-megamenu">
<div class="logo" itemscope itemtype="https://schema.org/Brand">
<a href="https://www.fireeye.com"><img src="/content/dam/fireeye-www/fw/images/fe-logo-color.svg" alt="FireEye" itemprop="logo" class="fireeye" /></a>
</div>
<nav class="megamenu">
<ul><li class="megamenu-tab" data-curry="/blog.html" data-link="/products.html">
<h4 class="megamenu-title">
<a href="/products.html" itemprop="url" class="MegaMenus">Products</a>
</h4>
<div class="content-0-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Enterprise Security</h4><ul><li itemprop="url"><a href="/products/helix.html" itemprop="name" class="MegaMenus">Helix Security Platform</a></li>
<li itemprop="url"><a href="/products/network-security.html" itemprop="name" class="MegaMenus">Network Security and Forensics</a></li>
<li itemprop="url"><a href="/products/endpoint-security.html" itemprop="name" class="MegaMenus">Endpoint Security</a></li>
<li itemprop="url"><a href="/products/email-security.html" itemprop="name" class="MegaMenus">Email Security</a></li>
<li itemprop="url"><a href="/products/cloudvisory.html" itemprop="name" class="MegaMenus">Cloudvisory</a></li>
<li itemprop="url"><a href="/products/detection-on-demand.html" itemprop="name" class="MegaMenus">Detection On Demand</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Security For:</h4><ul><li itemprop="url"><a href="/products/cloud-security.html" itemprop="name" class="MegaMenus">Cloud</a></li>
<li itemprop="url"><a href="/products/financial-services.html" itemprop="name" class="MegaMenus">Financial Services</a></li>
<li itemprop="url"><a href="/products/government.html" itemprop="name" class="MegaMenus">Government</a></li>
<li itemprop="url"><a href="/products/healthcare.html" itemprop="name" class="MegaMenus">Healthcare</a></li>
<li itemprop="url"><a href="/products/industrial-systems-and-critical-infrastructure-security.html" itemprop="name" class="MegaMenus">Industrial Control Systems</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  @media (max-width: 1024px) {
    .megamenu-tab .parsys .megamenus .megamenu-cta {
      display: none;
    }
  }
  .content-0-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-customers.jpg) center no-repeat;
    background-size: cover;
    border-radius: 60px 0 0 60px;
    border: 0 solid #ffffff;
  }
  .content-0-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}
</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>Customer Stories</h5>
<p>Explore some of the companies who are succeeding with&nbsp;FireEye.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-2E5799 compact" href="/customers.html" id="learn-more-intel">Read the Stories</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
<div class="view-all-bar">
<a href="/products.html" class="MegaMenus">
VIEW ALL PRODUCTS</a>
</div></div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/mandiant.html">
<h4 class="megamenu-title">
<a href="/mandiant.html" itemprop="url" class="MegaMenus">Mandiant Solutions</a>
</h4>
<div class="content-1-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<ul><li itemprop="url"><a href="/mandiant/threat-intelligence.html" itemprop="name" class="MegaMenus">Threat Intelligence</a></li>
<li itemprop="url"><a href="/mandiant/security-validation.html" itemprop="name" class="MegaMenus">Security Validation</a></li>
<li itemprop="url"><a href="/mandiant/managed-detection-and-response.html" itemprop="name" class="MegaMenus">Managed Defense</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<ul><li itemprop="url"><a href="/mandiant/incident-response.html" itemprop="name" class="MegaMenus">Incident Response</a></li>
<li itemprop="url"><a href="/mandiant/cyber-security-consulting.html" itemprop="name" class="MegaMenus">Cyber Security Consulting</a></li>
<li itemprop="url"><a href="/mandiant/expertise-on-demand.html" itemprop="name" class="MegaMenus">Expertise On Demand</a></li>
<li itemprop="url"><a href="/services/training.html" itemprop="name" class="MegaMenus">Cyber Security Training</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-1-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-mandiant.jpg) center no-repeat;
    background-size: cover;
    background-position: bottom;
    border-radius: 60px 0 0 60px;
    border: 0 solid #ffffff;}
  .content-1-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}

</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>Mandiant Advantage</h5>
<p>The new standard in threat intelligence.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-B2282D expand" href="/mandiant/advantage.html">Learn More</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
<div class="view-all-bar">
<a href="/mandiant.html" class="MegaMenus">
VIEW ALL Mandiant Solutions</a>
</div></div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/customers.html">
<h4 class="megamenu-title">
<a href="/company/customers.html" itemprop="url" class="MegaMenus">Customers</a>
</h4>
<div class="content-2-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Customers</h4><ul><li itemprop="url"><a href="/customers.html" itemprop="name" class="MegaMenus">Customer Stories</a></li>
<li itemprop="url"><a href="/company/customers.html" itemprop="name" class="MegaMenus">Customer Success</a></li>
<li itemprop="url"><a href="https://fireeyecommunity.force.com/CustomerCommunity/s/" target="_blank" itemprop="name" class="MegaMenus">Customer Portal</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Get Support</h4><ul><li itemprop="url"><a href="/support/contacts.html" itemprop="name" class="MegaMenus">Contact Support</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Find Answers</h4><ul><li itemprop="url"><a href="/support/programs.html" itemprop="name" class="MegaMenus">Support Programs</a></li>
<li itemprop="url"><a href="/support/notices.html" itemprop="name" class="MegaMenus">Support Notices</a></li>
<li itemprop="url"><a href="/support/products.html" itemprop="name" class="MegaMenus">Supported Products</a></li>
<li itemprop="url"><a href="https://community.fireeye.com/s/support-community" target="_blank" itemprop="name" class="MegaMenus">Communities</a></li>
<li itemprop="url"><a href="https://docs.fireeye.com" target="_blank" itemprop="name" class="MegaMenus">Documentation Portal</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-2-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-support.jpg) center no-repeat;
    background-size: cover;
    border-radius: 60px 0 12px 60px;
    border: 0 solid #ffffff;}
  .content-2-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}

</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>Support</h5>
<p>A global network of support experts available 24x7. We offer simple and flexible support programs to maximize the value of your FireEye products and services.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-2E5799 compact" href="/support.html">Get Support</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/partners.html">
<h4 class="megamenu-title">
<a href="/partners.html" itemprop="url" class="MegaMenus">Partners</a>
</h4>
<div class="content-3-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">FireEye Partners</h4><ul><li itemprop="url"><a href="/partners.html" itemprop="name" class="MegaMenus">Partners Overview</a></li>
<li itemprop="url"><a href="/partners/resellers.html" itemprop="name" class="MegaMenus">FireEye Affinity Resellers</a></li>
<li itemprop="url"><a href="/partners/strategic-technology-partners.html" itemprop="name" class="MegaMenus">Technology Partners</a></li>
<li itemprop="url"><a href="/partners/strategic-technology-partners/cyber-risk-insurance.html" itemprop="name" class="MegaMenus">Cyber Risk Partners</a></li>
<li itemprop="url"><a href="/partners/global-solution-providers.html" itemprop="name" class="MegaMenus">Global Solution Providers</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Partner Resources</h4><ul><li itemprop="url"><a href="https://partners.fireeye.com/directory/" target="_blank" itemprop="name" class="MegaMenus">Partner Locator</a></li>
<li itemprop="url"><a href="http://training.fireeye.com/" target="_blank" itemprop="name" class="MegaMenus">Partner Education Center</a></li>
<li itemprop="url"><a href="/support.html" itemprop="name" class="MegaMenus">Support</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Partnering with FireEye</h4><ul><li itemprop="url"><a href="https://www2.fireeye.com/Partner-Request-LP-New.html" target="_blank" itemprop="name" class="MegaMenus">Become a Partner</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-3-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-partners.jpg) center no-repeat;
    background-size: cover;
    border-radius: 60px 0 12px 60px;
    border: 0 solid #ffffff;}
  .content-3-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}

</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>Partner Portal</h5>
<p>Access for our registered Partners to help you be successful with FireEye.
Collateral, deal registration, request for funds, training, enablement, and more.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-F99B1C compact mm-cta" href="https://partners.fireeye.com/" target="_blank">Partner Portal</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/current-threats.html">
<h4 class="megamenu-title">
<a href="/current-threats.html" itemprop="url" class="MegaMenus">Resources</a>
</h4>
<div class="content-4-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub " id="mandiant-mega-menu">
<div class="n03-sub_container" data-columns="3">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Intelligence Briefings and Bulletins</h4><ul><li itemprop="url"><a href="/current-threats/annual-threat-report.html" itemprop="name" class="MegaMenus">Annual Threat Reports</a></li>
<li itemprop="url"><a href="/current-threats/threat-intelligence-reports.html" itemprop="name" class="MegaMenus">Threat Intelligence Reports</a></li>
<li itemprop="url"><a href="/current-threats/reports-by-industry.html" itemprop="name" class="MegaMenus">Threat Intelligence Reports by Industry</a></li>
<li itemprop="url"><a href="/current-threats/apt-groups.html" itemprop="name" class="MegaMenus">APT Groups</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">FireEye Blogs</h4><ul><li itemprop="url"><a href="/blog.html" itemprop="name" class="MegaMenus">Read the FireEye Blogs</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Cyber Security</h4><ul><li itemprop="url"><a href="/current-threats/what-is-cyber-security.html" itemprop="name" class="MegaMenus">What is Cyber Security?</a></li>
<li itemprop="url"><a href="/campaigns/clarity-in-the-cloud.html" itemprop="name" class="MegaMenus">Clarity in the Cloud</a></li>
<li itemprop="url"><a href="/campaigns/security-effectiveness.html" itemprop="name" class="MegaMenus">Security Effectiveness and Validation</a></li>
<li itemprop="url"><a href="https://vision.fireeye.com" target="_blank" itemprop="name" class="MegaMenus">The Vision – Digital Magazine</a></li>
<li itemprop="url"><a href="/company/webinars.html" itemprop="name" class="MegaMenus">Webinars</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Free Tools & Apps</h4><ul><li itemprop="url"><a href="/services/freeware.html" itemprop="name" class="MegaMenus">Free Software Downloads</a></li>
<li itemprop="url"><a href="https://fireeye.market" target="_blank" itemprop="name" class="MegaMenus">FireEye Market</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Training</h4><ul><li itemprop="url"><a href="/services/training.html" itemprop="name" class="MegaMenus">Education and Training</a></li>
</ul></div>
</div>
</div><div class="separator disabled"></div></div></div>
</div>
<div class="view-all-bar">
<a href="/current-threats.html" class="MegaMenus">
VIEW ALL RESOURCES</a>
</div></div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/company.html">
<h4 class="megamenu-title">
<a href="/company.html" itemprop="url" class="MegaMenus">Company</a>
</h4>
<div class="content-5-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">About Us</h4><ul><li itemprop="url"><a href="/company.html" itemprop="name" class="MegaMenus">Why FireEye?</a></li>
<li itemprop="url"><a href="/company/awards.html" itemprop="name" class="MegaMenus">Awards and Honors</a></li>
<li itemprop="url"><a href="/company/leadership.html" itemprop="name" class="MegaMenus">Leadership</a></li>
<li itemprop="url"><a href="/company/board-of-directors.html" itemprop="name" class="MegaMenus">Board of Directors</a></li>
<li itemprop="url"><a href="http://investors.fireeye.com" target="_blank" itemprop="name" class="MegaMenus">Investor Relations</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Contact</h4><ul><li itemprop="url"><a href="/company/contact-us.html" itemprop="name" class="MegaMenus">Contact FireEye</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>.g04 .megamenu-list a{padding-right:38px;line-height:1.358;padding-bottom:2px}@media (min-width:60em){.g04 .n03-sub_container{padding-bottom:23px}}@media(min-width:64em) and (max-width:64.5em){.g04 .megamenu-tab:first-child .megamenu-title{padding-left:14px}}@media (min-width:68em) and (max-width:69em){.g04 .megamenu-tab:first-child .megamenu-title{padding-left:30px}}</style></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">News and Events</h4><ul><li itemprop="url"><a href="/company/newsroom.html" itemprop="name" class="MegaMenus">Newsroom</a></li>
<li itemprop="url"><a href="/company/press-releases.html" itemprop="name" class="MegaMenus">Press Releases</a></li>
<li itemprop="url"><a href="/company/events.html" itemprop="name" class="MegaMenus">Events</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Careers</h4><ul><li itemprop="url"><a href="/company/jobs.html" itemprop="name" class="MegaMenus">Job Opportunities</a></li>
<li itemprop="url"><a href="/company/jobs/internships.html" itemprop="name" class="MegaMenus">Internships</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-5-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-vision.jpg) center no-repeat;
    background-size: cover;
    border-radius: 60px 0 12px 60px;
    border: 0 solid #ffffff;}
  .content-5-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}

</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>The Vision</h5>
<p>Read our digital magazine providing expert-authored stories, information, unique insights, and advice on cyber security.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-B2282D compact" href="https://vision.fireeye.com/" target="_blank">Get Your Copy</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</div>
</li></ul>
</nav>
</div>
<span class="burger ficon ficon-menu"></span>
</header>
</div>
</div>


<div id="cookie-privacy-banner" style="display:none;">
<div class="l_container">
<div class="g">
<div class="g-u-1">
<div class="g-content">
<div class="cookie-banner">
<p class="cookie-text">
To give you the best possible experience, this site uses cookies.&nbsp; Find out more on <a href='/company/privacy.html' target='_blank'>how we use cookies</a>.<button type="button" class="cookie-button highlighted" onclick='javascript:onAccept();'>Accept</button>
</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="breadcrumbs breadcrumb">
<div class="l_container is-full">
<div class="g02 g02v0" id="g02-breadcrumbs">
<div class="g02_container">
<div class="g02_content">
<ul class="list-inline g02_list" itemscope itemtype="http://schema.org/BreadcrumbList">
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" class="BreadCrumb" href="/"><span itemprop="name">Home</span></a><meta itemprop="position" content="1" /></li>
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" class="BreadCrumb" href="/blog.html"><span itemprop="name">FireEye Blogs</span></a><meta itemprop="position" content="2" /></li>
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" class="BreadCrumb" href="/blog/threat-research.html"><span itemprop="name">Threat Research</span></a><meta itemprop="position" content="3" /></li>
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><span itemprop="name">Emulation of Malicious Shellcode With Speakeasy<meta itemprop="position" content="6" /></span>
</ul>
</div>
</div>
</div>
</div>
</div>
<main class="l_main" role="main">
<div class="l_container">
<div class="g g-alt ">
<div class="g-u-17-24 l_g-u-1">
<div class="g-content">
<div class="blog main"><div itemscope itemtype="http://schema.org/BlogPosting">
<div class="summary entrytextteaser">
</div>
<div class="title entrytitle">
<h2 class="category-name">Threat Research</h2>
<h1 class="blogpostlanding red" itemprop="headline">Emulation of Malicious Shellcode With Speakeasy</h1>
<div class="c00 c00v0 entry-meta-block selfClear">
<time class="entry-date" itemprop="datePublished" content="2020-08-26T15:00:00Z">August 26, 2020</time>
<span class="sep"> | </span>
<span class="by-author" itemscope itemptype="http://schema.org/Person">by <a href="/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/cap-andrew-davis" title="View all entries filed under 'Fireeye - Authors : Andrew Davis'">Andrew Davis</a><meta itemprop="author" content="Andrew Davis" /></span>
<div class="tags-section">
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/tools"> <span class="tagbutton">tools</span></a><br class="on-mobile" />
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/malware-analysis"> <span class="tagbutton">Malware Analysis</span></a><br class="on-mobile" />
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/FLARE"> <span class="tagbutton">FLARE</span></a><br class="on-mobile" />
</div>
</div>
</div>
<div class="par parsys"><div class="entrytext section"><div class="c00 c00v0" itemprop="articleBody">
<p>In order to enable emulation of malware samples at scale, we have developed the <a adhocenable="false" href="https://github.com/fireeye/speakeasy">Speakeasy emulation framework</a>. Speakeasy aims to make it as easy as possible for users who are not malware analysts to acquire triage reports in an automated way, as well as enabling reverse engineers to write custom plugins to triage difficult malware families.</p>
<p>Originally created to emulate Windows kernel mode malware, Speakeasy now also supports user mode samples. The project’s main goal is high resolution emulation of the Windows operating system for dynamic malware analysis for the x86 and amd64 platforms. Similar emulation frameworks exist to emulate user mode binaries. Speakeasy attempts to differentiate from other emulation frameworks the following ways:</p>
<ul>
<li>Architected specifically around emulation of Windows malware</li>
<li>Supports emulation of kernel mode binaries to analyze difficult to triage rootkits</li>
<li>Emulation and API support driven by current malware trends to provide the community with a means to extract indicators of compromise with no extra tooling</li>
<li>Completely configurable emulation environment requiring no additional code</li>
</ul>
<p>The project currently supports kernel mode drivers, user mode Windows DLLs and executables, as well as shellcode. Malware samples can be automatically emulated, with reports generated for later post processing. The ongoing project goal will be continuing to add support for new or popular malware families.</p>
<p>In this blog post, we will show an example of Speakeasy’s effectiveness at automatically extracting network indicators from a Cobalt Strike Beacon sample acquired from an online malware aggregate.</p>
<h4>Background</h4>
<p>Dynamic analysis of Windows malware has always been a crucial step during the malware analysis process. Understanding how malware interacts with the Windows API and extracting valuable host-based and network-based indicators of compromise (IOCs) are critical to assessing the impact malware has on an affected network. Typically, dynamic analysis is performed in an automated or targeted fashion. Malware can be queued to execute within a sandbox to monitor its functionality, or manually debugged to reveal code paths not executed during sandbox runs.</p>
<p>Code emulation has been used historically for testing, validation and even malware analysis. Being able to emulate malicious code lends many benefits from both manual and automated analysis. Emulation of CPU instructions allows for total instrumentation of binary code where control flow can be influenced for maximum code coverage. While emulating, all functionality can be monitored and logged in order to quickly extract indicators of compromise or other useful intelligence.</p>
<p>Emulation provides several advantages over execution within a hypervisor sandbox. A key advantage is noise reduction. While emulating, the only activity that can be recorded is either written by the malware author, or statically compiled within the binary. API hooking within a hypervisor (especially from a kernel mode perspective) can be difficult to attribute to the malware itself. For example, sandbox solutions will often hook heap allocator API calls without knowing if the malware author intended to allocate memory, or if a lower-level API was responsible for the memory allocation.</p>
<p>However, emulation has disadvantages as well. Since we are removing the operating system from the analysis phase, we, as the emulator, are now responsible for providing the expected inputs and outputs from API calls and memory access that occur during emulation. This requires substantial effort in order to successfully emulate malware samples that are expected to the run on a legitimate Windows system.</p>
<h4>Shellcode as an Attack Platform</h4>
<p>In general, shellcode is an excellent choice for attackers to remain stealthy on an infected system. Shellcode runs within executable memory and does not need to be backed by any file on disk. This allows attacker code to hide easily within memory where most forms of traditional forensic analysis will fail to identify it. Either the original binary file that loads the shellcode must first be identified, or the shellcode itself must be dumped from memory. To avoid detection, shellcode can be hidden within a benign appearing loader, and then be injected into another user mode process.</p>
<p>In the first part of this blog series, we will show the effectiveness of emulation with one of the more common samples of shellcode malware encountered during incident response investigations. Cobalt Strike is a commercial penetration testing framework that typically utilizes stagers to execute additional code. An example of a stager is one that downloads additional code via a HTTP request and executes the HTTP response data. The data in this case is shellcode that commonly begins with a decode loop, followed by a valid PE that contains code to reflectively load itself. In the case of Cobalt Strike, this means it can be executed from the start of the executable headers and will load itself into memory. Within the Cobalt Strike framework, the payload in this case is typically an implant known as Beacon. Beacon is designed to be a memory resident backdoor used to maintain command and control (C2) over an infected Windows system. It is built using the Cobalt Strike framework without any code modifications and can be easily built to have its core functionality and its command and control information modified.</p>
<p>All of this allows attackers to rapidly build and deploy new variants of Beacon implants on compromised networks. Therefore, a tool to rapidly extract the variable components of Beacon are necessary and, ideally, will not require the valuable time of malware analysts.</p>
<h4>Speakeasy Design</h4>
<p>Speakeasy currently employs the QEMU-based emulator engine Unicorn to emulate CPU instructions for the x86 and amd64 architectures. Speakeasy is designed to support arbitrary emulation engines in the future via an abstraction layer, but it currently relies on Unicorn.</p>
<p>Full OS sandboxing will likely always be required to analyze all samples as generically emulating all of Windows is somewhat unfeasible. Sandboxing can be difficult to scale on demand and can be time consuming to run samples. However, by making sure we emulate specific malware families, such as Beacon in this example, we can quickly reduce the need to reverse engineer variants. Being able to generate high level triage reports in an automated fashion is often all the analysis that is needed on a malware variant. This allows malware analysts more time to focus on samples that may require deeper analysis.</p>
<p>Shellcode or Windows PEs are loaded into the emulated address space. Windows data structures required to facilitate basic emulation of Windows kernel mode and user mode are created before attempting to emulate the malware. Processes, drivers, devices and user mode libraries are “faked” in order to present the malware with a realistic looking execution environment. Malware will be able to interact with an emulated file system, network and registry. All these emulated subsystems can be configured with a configuration file supplied to each emulation run.</p>
<p>Windows APIs are handled by Python API handlers. These handlers will try to emulate expected outputs from these APIs so that malware samples will continue their expected execution path. When defining an API handler, all that is needed is the name of the API, the number of arguments the API expects, and an optional calling convention specification. If no calling convention is supplied, stdcall is assumed. Currently, if an API call is attempted that is not supported, Speakeasy will log the unsupported API and move on to the next entry point. An example handler for the Windows HeapAlloc function exported by kernel32.dll is shown in Figure 1.</p>
<p><img src="/content/dam/fireeye-www/blog/images/speakeasy/picture1.png" alt=""><br>
<span class="type-XS">Figure 1: Example handler for Windows HeapAlloc function</span></p>
<p>All entry points are emulated by default. For example, for DLLs, all exports are emulated, and for drivers, the IRP major functions are each emulated. In addition, dynamic entry points that are discovered during runtime are followed. Some examples of dynamic entry points include threads that are created or callbacks that are registered. Attributing activity to specific entry points can be crucial to seeing the whole picture when trying to identify the impact of a malware infection.</p>
<h4>Reporting</h4>
<p>Currently, all events captured by the emulator are logged and represented by a JSON report for easy post processing. This report contains events of interest that are logged during emulation. Like most emulators, all Windows API calls are logged along with arguments. All entry points are emulated and tagged with their corresponding API listings. In addition to API tracing, other specific events are called out including file, registry and network access. All decoded or “memory resident” strings are dumped and displayed in the report to revealed useful information not found within static string analysis. Figure 2 shows an example of a file read event logged in a Speakeasy JSON report.</p>
<p><img src="/content/dam/fireeye-www/blog/images/speakeasy/picture2.png" alt=""><br>
<span class="type-XS">Figure 2: File read event in a Speakeasy report</span></p>
<h4>Speed</h4>
<p>Because the framework is written in Python, speed is an obvious concern. Unicorn and QEMU are written in C, which provides very fast emulation speeds; however, the API and event handlers we write are in Python. Transitioning between native code and Python is extremely expensive and should be done as little as possible. Therefore, the goal is to only execute Python code when it is absolutely necessary. By default, the only events we handle in Python are memory access exceptions or Windows API calls. In order to catch Windows API calls and emulate them in Python, import tables are doped with invalid memory addresses so that we only switch into Python when import tables are accessed. Similar techniques are used for when shellcode accesses the export tables of DLLs loaded within the emulated address space of the malware. By executing as little Python code as possible, we can maintain reasonable speeds while still allowing users to rapidly develop capabilities for the framework.</p>
<h4>Memory Management</h4>
<p>Speakeasy implements a lightweight memory manager on top of the emulator engine’s memory management. Each chunk of memory allocated by malware is tracked and tagged so that meaningful memory dumps can be acquired. Being able to attribute activity to specific chunks of memory can prove to be extremely useful for analysts. Logging memory reads and writes to sensitive data structures can reveal the true intent of malware not revealed by API call logging, which is particularly useful for samples such as rootkits.</p>
<p>Speakeasy offers an optional “memory tracing” feature that will log all memory accesses that samples exhibit. This will log all reads, writes and executes to memory. Since the emulator tags all allocated memory chunks, it is possible to glean much more context from this data. If malware hooks a critical data structure or pivots execution to dynamically mapped memory this will be revealed and can be useful for debugging or attribution. This feature comes at a great speed cost, however, and is not enabled by default.</p>
<p>The emulated environment presented to malware includes common data structures that shellcode uses to locate and execute exported Windows system functions. It is necessary to resolve exported functions in order to invoke the Win32 API and therefore have meaningful impact on a targeted system. In most cases, Beacon included, these functions are located by walking the process environment block (commonly called the PEB). From the PEB, shellcode can access a list of all loaded modules within a process’s virtual address space.</p>
<p>Figure 3 shows a memory report generated from emulating a Beacon shellcode sample. Here we can trace the malware walking the PEB in order to find the address of kernel32.dll. The malware then manually resolves and calls the function pointer for the “VirtualAlloc” API, and proceeds to decode and copy itself into the new buffer to pivot execution.</p>
<p><img src="/content/dam/fireeye-www/blog/images/speakeasy/picture3.png" alt=""><br>
<span class="type-XS">Figure 3: Memory trace report</span></p>
<h4>Configuration</h4>
<p>Speakeasy is highly configurable and allows users to create their own “execution profiles”. Different levels of analysis can be specified in order to optimize individual use cases. The end goal is allowing users easy switching of configuration options with no code changes. Configuration profiles are currently structured as JSON files. If no profile is provided by the user, a default configuration is provided by the framework. The individual fields are documented within the Speakeasy project.</p>
<p>Figure 4 shows a snippet of the network emulator configuration subsection. Here, users can specify what IP addresses get returned when a DNS lookup occurs, or in the case of some Beacon samples, what binary data gets returned during a TXT record query. HTTP responses have custom responses configured as well.</p>
<p><img src="/content/dam/fireeye-www/blog/images/speakeasy/picture4.png" alt=""><br>
<span class="type-XS">Figure 4: Network configuration</span></p>
<p>Many HTTP stagers will retrieve a web resource using a HTTP GET request. Often, such as with Cobalt Strike or Metasploit stagers, this buffer is then immediately executed so the next stage of execution can begin. This response can be easily configured with Speakeasy configurations. In the configuration in Figure 4, unless overridden, the framework will supply the data contained in the referenced default.bin file. This file currently contains debug interrupt instructions (int3), so if the malware attempts to execute the data it exits and will be logged in the report. Using this, we can easily label the malware as a downloader that downloads additional code. Configuration fields also exist for file system and registry emulation. Files and registry paths can similarly be configured to return data to samples that expect to be running on a live Windows system.</p>
<h4>Limitations</h4>
<p>As said, emulation comes with some challenges. Maintaining feature parity with the system being emulated is an ongoing battle; however, it provides unique opportunities for controlling the malware and greater introspection options.</p>
<p>In cases where emulation does not complete fully, emulation reports and memory dumps can still be generated in order to gather as much data as possible. For example, a backdoor may successfully install its persistence mechanism, but fail to connect to its C2 server. In this situation, the valuable host-based indicators are still logged and can provide value to an analyst.</p>
<p>Missing API handlers can quickly and easily be added to the emulator in order to handle these situations. For many API handlers, simply returning a success code will be sufficient to make the malware to continue execution. While full emulation of every piece of malware may not be feasible, targeting functionality of specific malware families can greatly reduce the need to reverse engineer variants of the same families.</p>
<h4>Usage</h4>
<p>Speakeasy is <a adhocenable="false" href="https://github.com/fireeye/speakeasy">available right now on our GitHub</a>. It can be installed with the included Python installer script or installed within a Docker container using the provided Dockerfile. It is platform agnostic and can be used to emulate Windows malware on Windows, Linux or MacOS. More information can be found on the project’s <a adhocenable="false" href="https://github.com/fireeye/speakeasy#readme">README</a>.</p>
<p>Once installed, Speakeasy can be used as a standalone library or invoked directly using the provided run_speakeasy.py script. In this blog post we will demonstrate how to emulate a malware sample directly from the command line. For information on how to use Speakeasy as a library, see the project’s <a adhocenable="false" href="https://github.com/fireeye/speakeasy#readme">README</a>.</p>
<p>The included script is meant to emulate a single sample and generate a JSON report with the logged events. The command line arguments for run_speakeasy.py are shown in Figure 5.</p>
<p><img src="/content/dam/fireeye-www/blog/images/speakeasy/picture5.png" alt=""><br>
<span class="type-XS">Figure 5: Command line arguments for run_speakeasy.py</span></p>
<p>Speakeasy also offers a rich development and hooking interface for writing custom plugins. This will be covered in more detail in a later blog post.</p>
<h4>Emulation of a Beacon Implant</h4>
<p>For this example, we will be emulating shellcode that decodes and executes a Beacon implant variant that has a SHA-256 hash of 7f6ce8a8c2093eaf6fea1b6f1ef68a957c1a06166d20023ee5b637b5f7838918. We begin by verifying the file format of the sample. This sample is expected to be launched either by a loader or used as part of an exploit payload.</p>
<p><img src="/content/dam/fireeye-www/blog/images/speakeasy/picture6.png" alt=""><br>
<span class="type-XS">Figure 6: Hex dump of malware sample</span></p>
<p>In Figure 6, we can clearly see that the file is not in the PE file format. An analyst who has seen many shellcode samples may notice the first two bytes: “0xfc 0xe8”. These bytes disassemble to the intel assembly instructions “cld” and “call”. The “cld” instruction is a common prelude to position independent shellcode as it will clear the direction flag allowing malware to easily parse string data from system DLL’s export tables. The following call instruction is often used by shellcode to get its current program counter by following it with a “pop” instruction. This allows the malware to discover where it is executing from in memory.</p>
<p>Since we are reasonably certain this sample is shellcode, we will invoke Speakeasy with the command line shown in Figure 7.</p>
<p><img src="/content/dam/fireeye-www/blog/images/speakeasy/picture7.png" alt=""><br>
<span class="type-XS">Figure 7: Command line used to emulate malware sample</span></p>
<p>This will instruct Speakeasy to emulate the sample from offset zero as x86 shellcode. Note: even though we are emulating code and not actually executing it, these are still attacker generated binaries. It may still be wise to emulate malicious code within a virtual machine in the event a vulnerability is discovered in whatever native CPU emulation engine is used.</p>
<p>After emulation, a report will be generated named “report.json”. In addition, a full memory dump of the emulation environment will be compressed and written to “memory_dump.zip”. The malware will get loaded into emulated memory inside of a fake container process to simulate a real execution environment that shellcode would expect to be running in. Once emulation begins, emulated API calls will be logged to the screen along with their arguments and return values. Figure 8 shows the Beacon sample allocating a new memory buffer where it will copy itself. The malware then begins to manually resolve exports it needs to execute.</p>
<p><img src="/content/dam/fireeye-www/blog/images/speakeasy/picture8.png" alt=""><br>
<span class="type-XS">Figure 8: Network configuration</span></p>
<p>After additional decoding and setup, the malware attempts to connect to its C2 server. In Figure 9, we can see the malware using the Wininet library to connect and read data from the C2 server using HTTP.</p>
<p><img src="/content/dam/fireeye-www/blog/images/speakeasy/picture9.png" alt=""><br>
<span class="type-XS">Figure 9: Wininet API calls to connect to C2</span></p>
<p>The malware will loop endlessly until it receives the data it expects from its C2 server. Speakeasy will timeout after a predetermined amount of time and generate a JSON report.</p>
<p><img src="/content/dam/fireeye-www/blog/images/speakeasy/picture10.png" alt=""><br>
<span class="type-XS">Figure 10: Network C2 events</span></p>
<p>The network indicators are summarized in the “network_events” and “traffic” sections of the generated report. In Figure 10, we can see the IP address, port number and, in this case, HTTP headers associated with the connections made by the malware.</p>
<p>In this example, when we emulated the sample, we instructed Speakeasy to create a memory dump of the emulated address space. A ZIP archive will get created of each memory allocation along with context around it. This context includes base address, size and a tag that is assigned by the emulator in order to identify what the memory allocation corresponds to. Figure 11 shows a snippet of the memory dump files created during emulation. The file names contain the tag and base address associated with each memory allocation.</p>
<p><img src="/content/dam/fireeye-www/blog/images/speakeasy/picture11.png" alt=""><br>
<span class="type-XS">Figure 11: Individual memory blocks acquired from emulation</span></p>
<p>If we just run strings on these memory dumps, we can quickly locate interesting strings along with the Beacon configuration data, which is shown in Figure 12.</p>
<p><img src="/content/dam/fireeye-www/blog/images/speakeasy/picture12.png" alt=""><br>
<span class="type-XS">Figure 12: Configuration string data for the malware</span></p>
<p>In a triage level of analysis, we may only care about the indicators of compromise for a malware variant of a known family. However, if full reverse engineering of the sample is required, we can also recover the decoded version of the Beacon malware in its DLL form. By simply doing a primitive grep for the “MZ” magic bytes, we find the only hits are the memory dumps related to the original sample’s allocation and the virtual allocated buffer that the malware copies itself to (Figure 13).</p>
<p><img src="/content/dam/fireeye-www/blog/images/speakeasy/picture13.png" alt=""><br>
<span class="type-XS">Figure 13: Memory dump containing the decoded malware</span></p>
<p>If we look at the bytes in the original shellcode buffer, we can see that it was decoded before it was copied and is sitting in memory ready to be dumped at offset 0x48. We can now successfully load the decoded Beacon DLL into IDA Pro for full analysis (Figure 14).</p>
<p><img src="/content/dam/fireeye-www/blog/images/speakeasy/picture14.png" alt=""><br>
<span class="type-XS">Figure 14: Decoded malware successfully loaded into IDA Pro</span></p>
<h4>Conclusion</h4>
<p>In this blog post we demonstrated how the Speakeasy emulation framework can be used to automatically triage a Beacon malware sample. We used it to discover valuable network indicators, extract its config information from memory, and acquire a decoded Beacon DLL for further analysis.</p>
<p>Head over to our GitHub to <a adhocenable="false" href="https://github.com/fireeye/speakeasy">start using Speakeasy today</a>, and stay tuned for the next blog post where we will demonstrate kernel malware analysis using emulation.</p>
</div>
<div class="clear-all"></div></div>
</div>
<div class="par prevnextbutton">
<div class="prevnext">
<div class="button">
<a id="leftBtnId" class="btn btn-B2282D" href="#"><span>Previous</span> <span>Post</span></a>
</div>
<div class="button">
<a id="rightBtnId" class="btn btn-B2282D" href="#"><span>Next</span> <span>Post</span></a>
</div>
</div>
<input type="hidden" value="/content/fireeye-www/en_US/blog/threat-research" id="categoryPathVal" name="categoryPath" />
<script>
    $(document).ready(function(){

         var prevenextHtml = $('.prevnext').html();	
         var categoryPathVal = $("#categoryPathVal").val();
            var blogsDetails;
        
            if(undefined == blogsDetails){
                    blogsDetails = [];
            }
        
        
            if(undefined != prevenextHtml){
                if(blogsDetails.length <= 0){
                     $.ajax({
                        type: "GET",
                        url: "/bin/www-blogs/read-blogentries",
                        dataType: "json",
                        data: { categoryPath: categoryPathVal} ,
                        async: false,
                        success : function(data) {
                            var totalFoundRes = data.blogs.length;
                            blogsDetails = data.blogs;
                            var currentPagePath = window.location.pathname;
                            currentPagePath = currentPagePath.split(".")[0]
                            console.log("currentPagePath :: "+currentPagePath);
        
                            for (var i = 0; i < blogsDetails.length; i++) {
                                var currentItrPath = blogsDetails[i].path;
        
                                if (currentItrPath.indexOf(currentPagePath) > -1) {
                                    console.log(blogsDetails[i-1]);
                                    console.log(blogsDetails[i+1]);

                                    if(undefined != blogsDetails[i-1] ){
										var prevPagePath = blogsDetails[i-1].path;
                                        $("#leftBtnId").attr("href",prevPagePath+".html");
                                        $("#leftBtnId").show();
                                    }else{
										$("#leftBtnId").hide();
                                    }
                                    if(undefined != blogsDetails[i+1] ){
										var nextPagePath = blogsDetails[i+1].path;  
                                    	$("#rightBtnId").attr("href",nextPagePath+".html");
                                        $("#rightBtnId").show();
                                    }else{
										$("#rightBtnId").hide();
                                    }
                                }
                            }
        
                        },
                        error : function(response){
                            console.log("Error: while connecting to servlet.");
                        }
                    });
                 }else{
                     alert("Blogs from global object :: "+blogsDetails);
                 }
            }else{
                alert("prevenextHtml :: "+prevenextHtml);
            }
    });
</script></div>
</div></div>
</div>
</div>
<div id="sidebar" class="g-u-7-24 l_g-u-1 blog-sidebar">
<div class="g-content">
<div class="sidebar reuse-blog-resources">
<div class="blog-resources">
<div class="grid-33-left parsys"><div class="rightrail section">
<div class="blog-right-rail">
<div class="bottom-bar"><div class="tab">
<span class="ficon ficon-star"></span>
<p>Promotion</p></div><div class="tab">
<span class="ficon ficon-checkbox-checked"></span>
<p>Subscribe</p></div>
<div class="tab">
<span class="ficon ficon-share"></span>
<p>Share</p></div>
<div class="tab">
<span class="ficon ficon-history2"></span>
<p>Recent</p></div>
<div class="tab">
<span class="ficon ficon-feed"></span>
<p>RSS</p></div>
</div><div class="section cta">
<div id="cq-image-jsp-/content/fireeye-www/site-content/en_US/blog-right-threat-research/jcr:content/grid-33-left/rightrail/image"><a href="/mandiant/advantage.html"><img src="/content/dam/fireeye-www/services/images/bnr-mandiant-advantage-v3-315x315.png" alt="bnr-mandiant-advantage-v3-315x315" title="bnr-mandiant-advantage-v3-315x315" class="cq-dd-image"></a></div></div><div class="section email">
<script src="https://www2.fireeye.com/js/forms2/js/forms2.min.js"></script>
<div id="mktoWrapper_3353" class="a08 bg-f2f2f2"><div class="c00 c00v0"><h3>Email Updates</h3><p>Information and insight on today's advanced threats from FireEye.</p></div><form id="mktoForm_3353"></form> <script type="text/javascript">
		if(typeof digitalData=="undefined"){digitalData={}}
        //alert(https://www2.fireeye.com+":"+848-DID-242)
        //alert("false");
		MktoForms2.loadForm("https://www2.fireeye.com", "848-DID-242", 3353,
		function(form) {
			
            if(typeof fdc.blog.initCheckboxes === "function") {
                fdc.blog.initCheckboxes(form);
            } 
			digitalData.form = {id: form.getId(),name: document.title,url: window.location.href};
			//if(typeof marketoFormViewTealiumEvent !== "undefined" && typeof utag!=="undefined"){marketoFormViewTealiumEvent(form);}
			if(typeof marketoFormViewGtmEvent !== "undefined") {
				marketoFormViewGtmEvent(form);
			}
			form.onSubmit(function(values){
                //Check if GA fields are present
                if(($("input[name='GACLIENTID__c']").length>0)&&($("input[name='GAUSERID__c']").length>0)&&($("input[name='GATRACKID__c']").length>0)&&(typeof ga!=="undefined"))
                {
                      ga(function(){ 
                          //Get tracking ID and Client ID
                           var tracker = ga.getAll()[0];
                           var trackingId = tracker.get('trackingId');
                           var clientId = tracker.get('clientId');
                           var userId = tracker.get('userId');
                           $("input[name='GACLIENTID__c'").val(clientId);
                           $("input[name='GATRACKID__c'").val(trackingId);
                           $("input[name='GAUSERID__c'").val(userId);
                       });
                 }
            
        	});
			form.onSuccess(function(values, followUpUrl) {
				//if(typeof marketoFormSubmitTealiumEvent !== "undefined"){marketoFormSubmitTealiumEvent(values);}
				if(typeof marketoFormSubmitGTMEvent !== "undefined") {
					marketoFormSubmitGTMEvent(values);
				}
				
				if(typeof fdc.blog.replaceFormWithThankYou === "function") {
					var result = fdc.blog.replaceFormWithThankYou(form,values,followUpUrl);
					if (result === false) {
						return false;
					}
				} 
				return true;
			});
			
			var adrC = typeof addMissingUTMsFromCookies !== "undefined" ? addMissingUTMsFromCookies(document.URL) : document.URL;
			form.addHiddenFields({ ADR__c: adrC,ADR_Credit__c_account: document.title,ADR_Credit__c: document.referrer });
			if(($("input[name='GACLIENTID__c']").length==0)&&($("input[name='GAUSERID__c']").length==0)&&($("input[name='GATRACKID__c']").length==0)){
				form.addHiddenFields({ GACLIENTID__c:"",GAUSERID__c:"",GATRACKID__c:""});				
			}
			
		});
	</script>
</div></div>
<div class="section share">
<h6><small>Share</small></h6>

<div class="addthis_inline_share_toolbox_7uq8"></div>
</div>
<div class="section recent">
<h6>Recent Posts</h6>

<div class="c05 c05v0"><ul>
<li class="c05_item"><p class="c05_date">04 Mar 2021</p><a class="c05_link" href="/blog/threat-research/2021/03/detection-response-to-exploitation-of-microsoft-exchange-zero-day-vulnerabilities.html" title="Detection and Response to Exploitation of Microsoft Exchange Zero-Day Vulnerabilities">Detection and Response to Exploitation of Microsoft Exchange Zero-Day Vulnerabilities</a></li>

<li class="c05_item"><p class="c05_date">04 Mar 2021</p><a class="c05_link" href="/blog/threat-research/2021/03/sunshuttle-second-stage-backdoor-targeting-us-based-entity.html" title="New SUNSHUTTLE Second-Stage Backdoor Uncovered Targeting U.S.-Based Entity; Possible Connection to UNC2452">New SUNSHUTTLE Second-Stage Backdoor Uncovered Targeting U.S.-Based
Entity; Possible Connection to UNC2452</a></li>

<li class="c05_item"><p class="c05_date">03 Mar 2021</p><a class="c05_link" href="/blog/threat-research/2021/03/fuzzing-image-parsing-in-windows-uninitialized-memory.html" title="Fuzzing Image Parsing in Windows, Part Two: Uninitialized Memory">Fuzzing Image Parsing in Windows, Part Two: Uninitialized Memory</a></li>
</ul></div>
</div>
<a href="/content/fireeye-www/en_US/blog/threat-research/_jcr_content.feed" target="_blank">
<div class="section rss">
<h6><small>RSS Feed: </small><small>Stay Connected</small></h6>
<span class="ficon ficon-feed"></span>
</div>
</a>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</main>

<div class="footer_f635 footer">

<footer id="g03-footer" class="l_footer g03 g03v0 g03v2 g03-5col">
<div class="main-footer-wrapper">

<div class="g03_list g03_list_1">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Company</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/company.html" class="Footer">Why FireEye?</a></li>
<li class="g03_item"><a href="/customers.html" class="Footer">Customer Stories</a></li>
<li class="g03_item"><a href="/company/jobs.html" class="Footer">Careers</a></li>
<li class="g03_item"><a href="/company/compliance-certification.html" class="Footer">Certifications and Compliance</a></li>
<li class="g03_item"><a href="http://investors.fireeye.com/" target="_blank" class="Footer">Investor Relations</a></li>
<li class="g03_item"><a href="/company/supplier.html" class="Footer">Supplier Documents</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_2">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>News and Events</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/company/newsroom.html" class="Footer">Newsroom</a></li>
<li class="g03_item"><a href="/company/press-releases.html" class="Footer">Press Releases</a></li>
<li class="g03_item"><a href="/company/webinars.html" class="Footer">Webinars</a></li>
<li class="g03_item"><a href="/company/events.html" class="Footer">Events</a></li>
<li class="g03_item"><a href="/company/awards.html" class="Footer">Awards and Honors</a></li>
<li class="g03_item"><a href="/company/contact-us/manage-your-communication-preference.html" class="Footer">Email Preferences</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_3">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Technical Support</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/company/incident-response.html" class="Footer">Incident?</a></li>
<li class="g03_item"><a href="/company/security.html" class="Footer">Report Security Issue</a></li>
<li class="g03_item"><a href="/support/contacts.html" class="Footer">Contact Support</a></li>
<li class="g03_item"><a href="https://csportal.fireeye.com/secur/login_portal.jsp?orgId=00D3000000063LS&portalId=06030000000pSNE" target="_blank" class="Footer">Customer Portal</a></li>
<li class="g03_item"><a href="https://community.fireeye.com/s/support-community" target="_blank" class="Footer">Communities</a></li>
<li class="g03_item"><a href="https://docs.fireeye.com" target="_blank" class="Footer">Documentation Portal</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_4">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>FireEye Blogs</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/blog/threat-research.html" class="Footer">Threat Research</a></li>
<li class="g03_item"><a href="/blog/products-and-services.html" class="Footer">FireEye Stories</a></li>
<li class="g03_item"><a href="/blog/executive-perspective.html" class="Footer">Industry Perspectives</a></li>
</ul></div>
<div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Threat Map</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/cyber-map/threat-map.html" class="Footer">View the Latest Threats</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_5">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Contact Us</strong><br>
<div class="footer-list section">
<ul class="g03_block">
<li class="g03_item"><a href="tel:+1 877-347-3393" class="contactlinks">+1 877-347-3393</a><br>&nbsp;</li>
</ul>
</div></div>
<div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Stay Connected</strong></p></div>
<div class="followus-footer section"><h4 class="g03_title" id="g03-followus-title"> </h4><ul class="g03_block g03-s" id="g03-followus-list"><li class="g03_item g03_item-s">
<a href="https://www.linkedin.com/company/fireeye" target="_blank">
<span class="g03-s-i ficon g03-s-i-li ficon-linkedin"></span>
<span class="g03-s_label">LinkedIn</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://twitter.com/fireeye" target="_blank">
<span class="g03-s-i ficon g03-s-i-tw ficon-twitter2"></span>
<span class="g03-s_label">Twitter</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://www.facebook.com/FireEye" target="_blank">
<span class="g03-s-i ficon g03-s-i-fb ficon-facebook2"></span>
<span class="g03-s_label">Facebook</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://www.youtube.com/user/FireEyeInc" target="_blank">
<span class="g03-s-i ficon g03-s-i-yt ficon-youtube2"></span>
<span class="g03-s_label">YouTube</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://itunes.apple.com/us/podcast/eye-on-security/id1073779629?mt=2" target="_blank">
<span class="g03-s-i ficon g03-s-i-pc ficon-podcast"></span>
<span class="g03-s_label">Podcast</span>
</a>
</li></ul>
</div>
<div class="htmlpassthru section">
<div class="country-notification">
<div id="c08_modal-lang" class="c08_modal lang">
<div class="c08 c08v1">
<div class="c08_header">
<a href="#dismiss-lightbox" class="ficon ficon-close c08_dismiss" data-behavior="dismiss-c08"></a>
</div>
<div class="c08_content">
<div class="c08_body">
<div class="col FR">
<p class="type-ML">Cette page est également disponible en français.</p>
<div class="button section"><a class="btn" href="/index.html">Version française</a></div>
</div>
<div class="col DE">
<p class="type-ML">Diese Seite ist auch auf Deutsch verfügbar</p>
<div class="button section"><a class="btn" href="/index.html">Zur deutschen Seite wechseln</a></div>
</div>
<div class="col JP">
<p class="type-ML">日本語ページを</p>
<div class="button section"><a class="btn" href="/index.html">見る</a></div>
</div>
<div class="col KR">
<p class="type-ML">해당 페이지는 한글 버전으로 보실 수 있습니다</p>
<div class="button section"><a class="btn" href="/index.html">바로 가기</a></div>
</div>
<hr>
<div class="col">
<p><a class="dismiss" href="#dismiss-lightbox" data-behavior="dismiss-c08">Continue viewing this page in English</a></p>
</div>
</div>
</div>
</div>
</div>
<style>
.c08_modal.lang {
    background: rgba(255,255,255,0.8);
}
.c08_modal.lang .c08_header {
    background: transparent;
    border-left: none;
}
.c08_modal.lang .c08 {
    top: 20%;
    width: 600px;
    border-radius: 12px;
    box-shadow: rgba(0, 0, 0, 0.37) 0 0 15px;
    border: 1px solid #b4b5b8;
    background-image: url("/content/dam/fireeye-www/fw/images/bg-language-select.jpg");
    background-position: right bottom;
    margin: 0 auto;
    position: relative;
    max-width: 90%;
}
.c08_modal.lang .c08_dismiss {
    color: #222;
}
.c08_modal.lang .c08_body {
    padding: 12px 50px 60px;
}
.c08_modal.lang .col {
    display: none;
}
.c08_modal.lang .col:last-child {
    display: block;
}
.c08_modal.lang .btn {
    margin-bottom: 0;
}
.c08_modal.lang hr {
    margin: 30px 80px;
}
.c08_modal.lang hr:before {
    border-bottom: none;
}
</style>
</div></div>
</div>
</div></div>
<div class="legal-footer-wrapper">
<div class="legal-footer">
<div class="g03_copyright">
<p class="g03_copyright_p">
Copyright&nbsp;&copy;&nbsp;2021&nbsp;FireEye, Inc.&nbsp;All rights reserved.&nbsp;<span class="g03-legal"><a href="/company/privacy.html">Privacy &amp; Cookies Policy</a> | <a href="/company/privacy-shield-commitment.html">Privacy Shield</a> | <a href="/company/legal.html">Legal Documentation</a></span>
</p>
</div><div class="g03_languages">
<a class="g01_options-option" href="#footer-worldwide">
<span>Site Language</span>
<span>English<span class="ficon ficon-globe"></span></span>
</a>
<div class="option-menu" id="footer-worldwide">
<p><strong>My preferred language:</strong></p>
<ul class="g01_options_list"><li><a href="https://www.fireeye.com/blog/threat-research/2020/08/emulation-of-malicious-shellcode-with-speakeasy.html" target="_blank">English (English)</a></li>
<li><a href="https://www.fireeye.fr" target="_blank">French (Français)</a></li>
<li><a href="https://www.fireeye.de" target="_blank">German (Deutsch)</a></li>
<li><a href="https://www.fireeye.jp" target="_blank">Japanese (日本語)</a></li>
<li><a href="https://www.fireeye.kr" target="_blank">Korean (한국어)</a></li>
<li><a href="/products/international-literature.html">More languages</a></li>
</ul>
</div>
</div> </div>
</div>
</footer>
</div>
<script type="text/javascript" src="/etc/designs/fireeye-www/clientlibs_fw.min.js"></script>


<div class="htmlpassthru_c66c htmlpassthru">
</div>

<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=fewebadmin"></script>
</body>
</html>
