<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head profile="http://gmpg.org/xfn/11">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>What We Can Learn from the Capital One Hack &mdash;  Krebs on Security</title>
	<link rel="stylesheet" href="https://krebsonsecurity.com/wp-content/themes/krebsads/krebsads/style.css?201108" type="text/css" media="screen" />
	<!--[if IE]><link type="text/css" href="https://krebsonsecurity.com/wp-content/themes/krebsads/krebsads/css/ie.css" rel="stylesheet" media="all" /><![endif]-->
	<link rel="alternate" type="application/rss+xml" title="Krebs on Security RSS Feed" href="https://krebsonsecurity.com/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Krebs on Security Atom Feed" href="https://krebsonsecurity.com/feed/atom/" />
	<link rel="pingback" href="https://krebsonsecurity.com/xmlrpc.php" />
	
	<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Krebs on Security &raquo; What We Can Learn from the Capital One Hack Comments Feed" href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/krebsonsecurity.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.6.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='colorbox-theme1-css'  href='https://krebsonsecurity.com/wp-content/plugins/jquery-lightbox-for-native-galleries/colorbox/theme1/colorbox.css?ver=1.3.14' type='text/css' media='screen' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://krebsonsecurity.com/wp-includes/css/dist/block-library/style.min.css?ver=5.6.2' type='text/css' media='all' />
<link rel='stylesheet' id='contact-form-7-css'  href='https://krebsonsecurity.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.4' type='text/css' media='all' />
<script type='text/javascript' src='https://krebsonsecurity.com/wp-includes/js/jquery/jquery.min.js?ver=3.5.1' id='jquery-core-js'></script>
<script type='text/javascript' src='https://krebsonsecurity.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://krebsonsecurity.com/wp-content/plugins/jquery-lightbox-for-native-galleries/colorbox/jquery.colorbox-min.js?ver=1.3.14' id='colorbox-js'></script>
<script type='text/javascript' src='https://krebsonsecurity.com/wp-content/themes/krebsads/krebsads/js/jquery.dropdown.js?ver=5.6.2' id='nav-js'></script>
<link rel="https://api.w.org/" href="https://krebsonsecurity.com/wp-json/" /><link rel="alternate" type="application/json" href="https://krebsonsecurity.com/wp-json/wp/v2/posts/48424" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://krebsonsecurity.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://krebsonsecurity.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.6.2" />
<link rel="canonical" href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/" />
<link rel='shortlink' href='https://krebsonsecurity.com/?p=48424' />
<link rel="alternate" type="application/json+oembed" href="https://krebsonsecurity.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fkrebsonsecurity.com%2F2019%2F08%2Fwhat-we-can-learn-from-the-capital-one-hack%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://krebsonsecurity.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fkrebsonsecurity.com%2F2019%2F08%2Fwhat-we-can-learn-from-the-capital-one-hack%2F&#038;format=xml" />
<!-- JavaScript Pull-Quotes plugin v2.2 -->
	<link rel="stylesheet" href="https://krebsonsecurity.com/wp-content/plugins/jspullquotes/resources/jspullquotes-core.css" type="text/css" />
	<link rel="stylesheet" href="https://krebsonsecurity.com/wp-content/plugins/jspullquotes/resources/jspullquotes-default.css" type="text/css" />
	<script type="text/javascript" src="https://krebsonsecurity.com/wp-content/plugins/jspullquotes/resources/jspullquotes.js"></script>
	<script type="text/javascript">
		var arrOptions = new Array("1", "1", "right", "1", "1", "blockquote", "pullquote", "pullquote pqRight");
		pullQuoteOpts(arrOptions);
	</script>
<!-- end pull-quote additions -->
<!-- jQuery Lightbox For Native Galleries v3.1.3 | http://www.viper007bond.com/wordpress-plugins/jquery-lightbox-for-native-galleries/ -->
<script type="text/javascript">
// <![CDATA[
	jQuery(document).ready(function($){
		$(".gallery").each(function(index, obj){
			var galleryid = Math.floor(Math.random()*10000);
			$(obj).find("a").colorbox({rel:galleryid, maxWidth:"95%", maxHeight:"95%"});
		});
		$("a.lightbox").colorbox({maxWidth:"95%", maxHeight:"95%"});
	});
// ]]>
</script>
<meta name="twitter:widgets:link-color" content="#000000" /><meta name="twitter:widgets:border-color" content="#000000" /><meta name="twitter:partner" content="tfwp" />
<meta name="twitter:card" content="summary" /><meta name="twitter:title" content="What We Can Learn from the Capital One Hack" /><meta name="twitter:site" content="@briankrebs" /><meta name="twitter:description" content="On Monday, a former Amazon employee was arrested and charged with stealing more than 100 million consumer applications for credit from Capital One. Since then, many have speculated the breach was perhaps the result of a previously unknown &quot;zero-day&quot; flaw, or an &quot;insider&quot; attack in which the accused took advantage of access surreptitiously obtained from her former employer.&hellip;" /><meta name="twitter:image" content="https://krebsonsecurity.com/wp-content/uploads/2019/08/capone.png" />

<HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">

<meta name="google-site-verification" content="KJUnFQJOARQGzfdipzjeGoYl07sFyzvo9yLgSyw_Uro" />


<meta name="viewport" content="width=device-width, content="initial-scale=0.8, maximum-scale=2">
<meta name="cloudpiercer-verification" content="364e0ba6c04aeef4e3e78bafc9264452">
</head>
<script type="text/javascript" language="javascript">
<!-- //
function ClearForm(){
    document.commentform.reset();
}
// -->
</script>
</head>
<body onload="ClearForm()">

	<div class="container_16">


<div id="top-banner">
		<div class="a-statement">Advertisement</div>
		




		
		<div id="social-networks">
			<div class="socnet-link">
				<a href="https://krebsonsecurity.com/feed/"><img src="https://krebsonsecurity.com/wp-content/themes/krebsads/krebsads/images/icon-rss.png" alt="RSS Feed" />&ensp;Subscribe to RSS</a><br />
			</div>
			
			<div class="socnet-link">
				<a href="http://www.twitter.com/briankrebs" target="_blank"><img src="https://krebsonsecurity.com/wp-content/themes/krebsads/krebsads/images/icon-twitter.png" alt="Twitter" />&ensp;Follow me on Twitter</a><br />
			</div>
			<div class="socnet-link">
				<a href="http://www.facebook.com/pages/Brian-Krebs/119740914725557" target="_blank"><img src="https://krebsonsecurity.com/wp-content/themes/krebsads/krebsads/images/icon-facebook.png" alt="Facebook" />&ensp;Join me on Facebook</a><br />
			</div>
		</div>


		<div class="a-img" id="top-banner-image">
<a href="https://www.akamai.com/us/en/resources/our-thinking/state-of-the-internet-report/global-state-of-the-internet-security-ddos-attack-reports.jsp?utm_source=krebsonsecurity&amp;utm_medium=display&amp;utm_id=GL_CrossSecurity&amp;utm_campaign=F-MC-52613&amp;utm_content=SOTI_Adapting">
<img src="/b-akamai/99.jpg">
</a>
		</div>
	</div>
	
		<div id="header"><!-- class="grid_16" -->
			<h1>Krebs on Security</h1>
			<h2>In-depth security news and investigation</h2>
			<h3 id="header-img"><a href="https://krebsonsecurity.com"><img src="https://krebsonsecurity.com/wp-content/themes/krebsads/krebsads/images/header.jpg" alt="Brian Krebs" /></a></h3>
		</div><!-- #header -->
		<div id="pgnav">
			<li class="page_item page-item-2"><a href="https://krebsonsecurity.com/about/">About the Author</a></li>
<li class="page_item page-item-645"><a href="https://krebsonsecurity.com/cpm/">Advertising/Speaking</a></li>
		</div><!-- #pgnav -->
		<hr />
<div class="grid_11">
	<div id="content">

	
		<div class="post-48424 post type-post status-publish format-standard hentry category-sunshine category-data-breaches category-comingstorm tag-apache tag-capital-one-breach tag-cloudflare tag-disruptops tag-evan-johnson tag-metadata-service tag-modsecurity tag-rich-mogull tag-server-side-request-forgery tag-ssrf tag-waf tag-web-application-firewall tag-william-bengston" id="post-48424"><div class="post-smallerfont">
 <small><span class="date">02</span><br />Aug 19 <!-- by BrianKrebs --></small>
			<h2 class="post-title">What We Can Learn from the Capital One Hack</h2>

			<div class="entry">
 				 
				<p>On Monday, a former <strong>Amazon</strong> employee was arrested and charged with <a href="https://krebsonsecurity.com/2019/07/capital-one-data-theft-impacts-106m-people/" target="_blank" rel="noopener">stealing more than 100 million consumer applications for credit from Capital One</a>. Since then, many have speculated the breach was perhaps the result of a previously unknown &#8220;zero-day&#8221; flaw, or an &#8220;insider&#8221; attack in which the accused took advantage of access surreptitiously obtained from her former employer. But new information indicates the methods she deployed have been well understood for years.</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-48436" src="https://krebsonsecurity.com/wp-content/uploads/2019/08/capone.png" alt="" width="568" height="377" /></p>
<p>What follows is based on interviews with almost a dozen security experts, including one who is privy to details about the ongoing breach investigation. Because this incident deals with somewhat jargon-laced and esoteric concepts, much of what is described below has been dramatically simplified. Anyone seeking a more technical explanation of the basic concepts referenced here should explore some of the many links included in this story.</p>
<p>According to a source with direct knowledge of the breach investigation, the problem stemmed in part from a misconfigured <a href="https://en.wikipedia.org/wiki/ModSecurity" target="_blank" rel="noopener">open-source Web Application Firewall</a> (WAF) that Capital One was using as part of its operations hosted in the cloud with Amazon Web Services (AWS).</p>
<p>Known as &#8220;<a href="https://en.wikipedia.org/wiki/ModSecurity" target="_blank" rel="noopener">ModSecurity</a>,&#8221; this WAF is deployed along with the open-source <strong>Apache</strong> Web server to provide protections against <a href="http://www.modsecurity.org/crs/" target="_blank" rel="noopener">several classes of vulnerabilities</a> that attackers most commonly use to compromise the security of Web-based applications.</p>
<p>The misconfiguration of the WAF allowed the intruder to trick the firewall into relaying requests to a key back-end resource on the AWS platform. This resource, known as the <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html" target="_blank" rel="noopener">&#8220;metadata&#8221; service</a>, is responsible for handing out temporary information to a cloud server, including current credentials sent from a security service to access any resource in the cloud to which that server has access.</p>
<p>In AWS, exactly what those credentials can be used for hinges on the permissions assigned to <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-roles-for-amazon-ec2.html" target="_blank" rel="noopener">the resource that is requesting them</a>. In Capital One&#8217;s case, the misconfigured WAF for whatever reason was assigned too many permissions, i.e. it was allowed to list all of the files in any buckets of data, and to read the contents of each of those files.</p>
<p>The type of vulnerability exploited by the intruder in the Capital One hack is a well-known method called a &#8220;<a href="https://www.hackerone.com/blog-How-To-Server-Side-Request-Forgery-SSRF" target="_blank" rel="noopener">Server Side Request Forgery</a>&#8221; (SSRF) attack, in which a server (in this case, CapOne&#8217;s WAF) can be tricked into running commands that it should never have been permitted to run, including those that allow it to talk to the metadata service.</p>
<p><a href="https://www.linkedin.com/in/ejcxx/" target="_blank" rel="noopener">Evan Johnson</a>, manager of the product security team at <strong>Cloudflare</strong>, recently <a href="https://ejj.io/blog/capital-one" target="_blank" rel="noopener">penned an easily digestible column</a> on the Capital One hack and the challenges of detecting and blocking SSRF attacks targeting cloud services. Johnson said it&#8217;s worth noting that SSRF attacks are not among <a href="http://www.modsecurity.org/crs/" target="_blank" rel="noopener">the dozen or so attack methods</a> for which detection rules are shipped by default in the WAF exploited as part of the Capital One intrusion.</p>
<p><span class="pullquote pqright">&#8220;SSRF has become the most serious vulnerability facing organizations that use public clouds,&#8221; Johnson wrote.</span> &#8220;The impact of SSRF is being worsened by the offering of public clouds, and the major players like AWS are not doing anything to fix it. The problem is common and well-known, but hard to prevent and does not have any mitigations built into the AWS platform.&#8221;</p>
<p>Johnson said AWS could address this shortcoming by including extra identifying information in any request sent to the metadata service, as Google has already done with its cloud hosting platform. He also acknowledged that doing so could break a lot of backwards compatibility within AWS.</p>
<p>&#8220;There&#8217;s a lot of specialized knowledge that comes with operating a service within AWS, and to someone without specialized knowledge of AWS, [SSRF attacks are] not something that would show up on any critical configuration guide,&#8221; Johnson said in an interview with KrebsOnSecurity.</p>
<p>&#8220;You have to learn how EC2 works, understand Amazon&#8217;s Identity and Access Management (IAM) system, and how to authenticate with other AWS services,&#8221; he continued. &#8220;A lot of people using AWS will interface with dozens of AWS services and write software that orchestrates and automates new services, but in the end people really lean into AWS a ton, and with that comes a lot of specialized knowledge that is hard to learn and hard to get right.&#8221;</p>
<p>In a statement provided to KrebsOnSecurity, Amazon said it is inaccurate to argue that the Capital One breach was caused by AWS IAM, the instance metadata service, or the AWS WAF in any way.</p>
<p>&#8220;The intrusion was caused by a misconfiguration of a web application firewall and not the underlying infrastructure or the location of the infrastructure,&#8221; the statement reads. &#8220;AWS is constantly delivering services and functionality to anticipate new threats at scale, offering more security capabilities and layers than customers can find anywhere else including within their own datacenters, and when broadly used, properly configured and monitored, offer unmatched security—and the track record for customers over 13+ years in securely using AWS provides unambiguous proof that these layers work.&#8221;</p>
<p>Amazon pointed to several (mostly a la carte) services it offers AWS customers to help mitigate many of the threats that were key factors in this breach, including:</p>
<p>&#8211;<a href="https://aws.amazon.com/about-aws/whats-new/2019/06/now-use-iam-access-advisor-with-aws-organizations-to-set-permission-guardrails-confidently/" target="_blank" rel="noopener">Access Advisor</a>, which helps identify and scope down AWS roles that may have more permissions than they need;<br />
&#8211;<a href="https://aws.amazon.com/guardduty/" target="_blank" rel="noopener">GuardDuty</a>, designed to raise alarms when someone is scanning for potentially vulnerable systems or moving unusually large amounts of data to or from unexpected places;<br />
&#8211;<a href="https://aws.amazon.com/waf/" target="_blank" rel="noopener">The AWS WAF</a>, which Amazon says can detect common exploitation techniques, including SSRF attacks;<br />
&#8211;<a href="https://aws.amazon.com/macie/" target="_blank" rel="noopener">Amazon Macie</a>, designed to automatically discover, classify and protect sensitive data stored in AWS.</p>
<p><a href="https://www.linkedin.com/in/william-bengtson/" target="_blank" rel="noopener">William Bengston</a>, formerly a senior security engineer at <strong>Netflix</strong>, wrote a series of blog posts last year on how Netflix built its own systems for <a href="https://medium.com/netflix-techblog/netflix-cloud-security-detecting-credential-compromise-in-aws-9493d6fd373a" target="_blank" rel="noopener">detecting</a> and <a href="https://medium.com/netflix-techblog/netflix-information-security-preventing-credential-compromise-in-aws-41b112c15179" target="_blank" rel="noopener">preventing</a> credential compromises in AWS. Interestingly, Bengston was hired roughly two months ago to be director of cloud security for Capital One. My guess is Capital One now wishes they had somehow managed to lure him away sooner.<span id="more-48424"></span></p>
<p><a href="https://www.linkedin.com/in/richmogull/" target="_blank" rel="noopener">Rich Mogull</a> is founder and chief technology officer with <a href="https://disruptops.com/breaking-attacker-kill-chains-in-aws-iam-roles/" target="_blank" rel="noopener">DisruptOPS</a>, a firm that helps companies secure their cloud infrastructure. Mogull said one major challenge for companies moving their operations from sprawling, expensive physical data centers to the cloud is that very often the employees responsible for handling that transition are application and software developers who may not be as steeped as they should in security.</p>
<p>&#8220;There is a basic skills and knowledge gap that everyone in the industry is fighting to deal with right now,&#8221; Mogull said. &#8220;For these big companies making that move, they have to learn all this new stuff while maintaining their old stuff. I can get you more secure in the cloud more easily than on-premise at a physical data center, but there&#8217;s going to be a transition period as you&#8217;re acquiring that new knowledge.&#8221;</p>
<div id="attachment_48457" style="width: 602px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-48457" loading="lazy" class=" wp-image-48457" src="https://krebsonsecurity.com/wp-content/uploads/2019/08/devops.png" alt="" width="592" height="377" /><p id="caption-attachment-48457" class="wp-caption-text">Image: Capital One</p></div>
<p>Since news of the Capital One breach broke on Monday, KrebsOnSecurity has received numerous emails and phone calls from security executives who are desperate for more information about how they can avoid falling prey to the missteps that led to this colossal breach (indeed, those requests were part of the impetus behind this story).</p>
<p>Some of those people included executives at big competing banks that haven&#8217;t yet taken the plunge into the cloud quite as deeply as Capital One has. But it&#8217;s probably not much of a stretch to say they&#8217;re all lining up in front of the diving board.</p>
<p>It&#8217;s been interesting to watch over the past couple of years how various cloud providers have responded to major outages on their platforms &#8212; very often soon after publishing detailed post-mortems on the underlying causes of the outage and what they are doing to prevent such occurrences in the future. In the same vein, it would be wonderful if this kind of public accounting extended to other big companies in the wake of a massive breach.</p>
<p>I&#8217;m not holding out much hope that we will get such detail officially from Capital One, which declined to comment on the record and referred me to <a href="https://www.capitalone.com/facts2019/" target="_blank" rel="noopener">their statement on the breach</a> and to the <a href="https://www.justice.gov/usao-wdwa/press-release/file/1188626/download" target="_blank" rel="noopener">Justice Department&#8217;s complaint</a> against the hacker. That&#8217;s probably to be expected, seeing as the company is <a href="https://finance.yahoo.com/news/capital-one-had-ample-warnings-of-weaknesses-and-risks-lawsuit-181832372.html" target="_blank" rel="noopener">already facing a class action lawsuit over the breach</a> and is likely to be targeted by more lawsuits going forward.</p>
<p>But as long as the public and private response to data breaches remains orchestrated primarily by attorneys (which is certainly the case now at most major corporations), everyone else will continue to lack the benefit of being able to learn from and avoid those same mistakes.</p>

 				

 								  



				<div id="comments"></div> 
				<p class="mid-banner" style="text-align: center; margin: auto;"> 
		 <a href="https://www.akamai.com/us/en/resources/our-thinking/state-of-the-internet-report/global-state-of-the-internet-security-ddos-attack-reports.jsp?utm_source=krebsonsecurity&amp;utm_medium=display&amp;utm_id=GL_CrossSecurity&amp;utm_campaign=F-MC-52613&amp;utm_content=SOTI_Adapting">
<img src="/b-akamai/106.jpg">
</a> </p>


				<p class="small">Tags: <a href="https://krebsonsecurity.com/tag/apache/" rel="tag">Apache</a>, <a href="https://krebsonsecurity.com/tag/capital-one-breach/" rel="tag">Capital One breach</a>, <a href="https://krebsonsecurity.com/tag/cloudflare/" rel="tag">CloudFlare</a>, <a href="https://krebsonsecurity.com/tag/disruptops/" rel="tag">DisruptOPS</a>, <a href="https://krebsonsecurity.com/tag/evan-johnson/" rel="tag">Evan Johnson</a>, <a href="https://krebsonsecurity.com/tag/metadata-service/" rel="tag">metadata service</a>, <a href="https://krebsonsecurity.com/tag/modsecurity/" rel="tag">ModSecurity</a>, <a href="https://krebsonsecurity.com/tag/rich-mogull/" rel="tag">Rich Mogull</a>, <a href="https://krebsonsecurity.com/tag/server-side-request-forgery/" rel="tag">server side request forgery</a>, <a href="https://krebsonsecurity.com/tag/ssrf/" rel="tag">SSRF</a>, <a href="https://krebsonsecurity.com/tag/waf/" rel="tag">WAF</a>, <a href="https://krebsonsecurity.com/tag/web-application-firewall/" rel="tag">Web Application Firewall</a>, <a href="https://krebsonsecurity.com/tag/william-bengston/" rel="tag">William Bengston</a></p>
				<p class="postmetadata alt">
					<small>
						This entry was posted on Friday, August 2nd, 2019 at 5:30 pm						and is filed under <a href="https://krebsonsecurity.com/category/sunshine/" rel="category tag">A Little Sunshine</a>, <a href="https://krebsonsecurity.com/category/data-breaches/" rel="category tag">Data Breaches</a>, <a href="https://krebsonsecurity.com/category/comingstorm/" rel="category tag">The Coming Storm</a>.
						You can follow any comments to this entry through the <a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/feed/">RSS 2.0</a> feed.

													Both comments and pings are currently closed.

						
					</small>
				</p>

			</div>
		</div></div>

	
<!-- You can start editing here. -->

	<h3 id="comments">87 comments</h3>

	<ol class="commentlist">
		   <li class="comment even thread-even depth-1" id="li-comment-494205">
    
     <div id="comment-494205">
     <div class="commenthead">
      <div class="comment-author vcard">
          <img alt='' src='https://secure.gravatar.com/avatar/78675a2782f6ced029f12076662a8f36?s=36&#038;d=mm&#038;r=pg' srcset='https://secure.gravatar.com/avatar/78675a2782f6ced029f12076662a8f36?s=72&#038;d=mm&#038;r=pg 2x' class='avatar avatar-36 photo' height='36' width='36' loading='lazy'/>
         <cite class="fn">Bob</cite>      </div>
      

      <div class="comment-meta commentmetadata"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-2/#comment-494205">August 5, 2019 at 1:20 pm</a>     
           </div>
      <div class="clear"></div>
     
     </div>
     

	<div class="commentbody">
      <p>How is it that the intruder was even able to access the misconfigured Web Application Firewall in the first place?  Isn’t some sort of authentication necessary to do this?  If not, or if the method of authentication is weak (using a password such as “password123”), wouldn’t some form of strong authentication for accessing the WAF have prevented the breach, despite the other misconfigurations? Or did the misconfiguration of the WAF itself disable any authentication necessary to access the WAF?</p>

      <div class="reply">
               </div>
     </div>
     </div>
<ul class="children">
   <li class="comment odd alt depth-2" id="li-comment-494223">
    
     <div id="comment-494223">
     <div class="commenthead">
      <div class="comment-author vcard">
          <img alt='' src='https://secure.gravatar.com/avatar/26d1533c5c53646ca31f46dfb3a3c135?s=36&#038;d=mm&#038;r=pg' srcset='https://secure.gravatar.com/avatar/26d1533c5c53646ca31f46dfb3a3c135?s=72&#038;d=mm&#038;r=pg 2x' class='avatar avatar-36 photo' height='36' width='36' loading='lazy'/>
         <cite class="fn">Dan</cite>      </div>
      

      <div class="comment-meta commentmetadata"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-2/#comment-494223">August 5, 2019 at 5:07 pm</a>     
           </div>
      <div class="clear"></div>
     
     </div>
     

	<div class="commentbody">
      <p>Most likely, the WAF was intentionally exposed to the Internet and was expected to transparently pass requests to servers running on EC2 instances inside the AWS account VPC.</p>
<p>This article implies that the intruder was able to cause the WAF to trigger AWS commands to enumerate and dump the contents of the S3 buckets.  This would imply that the WAF was itself running on an EC2 with an overly-permissive IAM role.</p>
<p>Another possibility is that the intruder used an additional hop and caused the WAF to pass HTTP requests to an EC2 server inside the VPC, and that server executed the S3 commands.  A misconfiguration on the WAF could allow requests to be passed to a server that wasn&#8217;t intended to be exposed, and thus have a permissive role.</p>

      <div class="reply">
               </div>
     </div>
     </div>
<ul class="children">
   <li class="comment even depth-3" id="li-comment-494228">
    
     <div id="comment-494228">
     <div class="commenthead">
      <div class="comment-author vcard">
          <img alt='' src='https://secure.gravatar.com/avatar/26d1533c5c53646ca31f46dfb3a3c135?s=36&#038;d=mm&#038;r=pg' srcset='https://secure.gravatar.com/avatar/26d1533c5c53646ca31f46dfb3a3c135?s=72&#038;d=mm&#038;r=pg 2x' class='avatar avatar-36 photo' height='36' width='36' loading='lazy'/>
         <cite class="fn">Dan</cite>      </div>
      

      <div class="comment-meta commentmetadata"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-2/#comment-494228">August 5, 2019 at 6:00 pm</a>     
           </div>
      <div class="clear"></div>
     
     </div>
     

	<div class="commentbody">
      <p>Actually, on reading related articles in more depth, the consensus appears to be that the WAF was intentionally set up to &#8220;redirect&#8221; incoming requests (really, more like a reverse proxy).  Due to the misconfiguration, the intruder was able to send a request to the local metadata service, which returned the temporary IAM credentials the WAF was using.  Then, the intruder used those creds to make API calls to the S3 service and dump all the data.</p>
<p>This would imply two bad configurations:  Whatever was on the WAF that allowed the redirection to the metadata service, and the overly-permissive role assigned to the EC2 instance and allowed all the S3 access.</p>
<p>This is a common, easy, well-understood attack.  The configuration errors are very easy mistakes to make.</p>

      <div class="reply">
               </div>
     </div>
     </div>
</li><!-- #comment-## -->
   <li class="comment odd alt depth-3" id="li-comment-494230">
    
     <div id="comment-494230">
     <div class="commenthead">
      <div class="comment-author vcard">
          <img alt='' src='https://secure.gravatar.com/avatar/b6dde82306b89dd954717b523c179dea?s=36&#038;d=mm&#038;r=pg' srcset='https://secure.gravatar.com/avatar/b6dde82306b89dd954717b523c179dea?s=72&#038;d=mm&#038;r=pg 2x' class='avatar avatar-36 photo' height='36' width='36' loading='lazy'/>
         <cite class="fn">SWEJ</cite>      </div>
      

      <div class="comment-meta commentmetadata"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-2/#comment-494230">August 5, 2019 at 6:12 pm</a>     
           </div>
      <div class="clear"></div>
     
     </div>
     

	<div class="commentbody">
      <p>I think it’s more so that they sent a request through the WAF that was a SSRF attack that called the metadata service on the EC2s running the WAF application to retrieve credentials. These credentials are for the role the EC2 is running under and had too permissive policies. Those credentials allowed the hacker to list buckets contents and download data from the attackers machines not from machines in Capital Ones VPC.</p>

      <div class="reply">
               </div>
     </div>
     </div>
<ul class="children">
   <li class="comment even depth-4" id="li-comment-494232">
    
     <div id="comment-494232">
     <div class="commenthead">
      <div class="comment-author vcard">
          <img alt='' src='https://secure.gravatar.com/avatar/26d1533c5c53646ca31f46dfb3a3c135?s=36&#038;d=mm&#038;r=pg' srcset='https://secure.gravatar.com/avatar/26d1533c5c53646ca31f46dfb3a3c135?s=72&#038;d=mm&#038;r=pg 2x' class='avatar avatar-36 photo' height='36' width='36' loading='lazy'/>
         <cite class="fn">Dan</cite>      </div>
      

      <div class="comment-meta commentmetadata"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-2/#comment-494232">August 5, 2019 at 6:32 pm</a>     
           </div>
      <div class="clear"></div>
     
     </div>
     

	<div class="commentbody">
      <p>Yes, it looks that way.  Sadly, your reply pointing that out appeared before my reply pointing that out.</p>
<p>Looking at the earlier article, it looks like she typically also used creds to set up EC2 instances and set up other services to exfiltrate.  Just pulling straight off the S3 buckets would have worked for Capital One, though.</p>

      <div class="reply">
               </div>
     </div>
     </div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
   <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-494254">
    
     <div id="comment-494254">
     <div class="commenthead">
      <div class="comment-author vcard">
          <img alt='' src='https://secure.gravatar.com/avatar/80c11799d71e976b8c2361aa4deaa278?s=36&#038;d=mm&#038;r=pg' srcset='https://secure.gravatar.com/avatar/80c11799d71e976b8c2361aa4deaa278?s=72&#038;d=mm&#038;r=pg 2x' class='avatar avatar-36 photo' height='36' width='36' loading='lazy'/>
         <cite class="fn">Drew Peacock</cite>      </div>
      

      <div class="comment-meta commentmetadata"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-2/#comment-494254">August 6, 2019 at 5:15 am</a>     
           </div>
      <div class="clear"></div>
     
     </div>
     

	<div class="commentbody">
      <p>Regardless of HOW this happened, wasn&#8217;t the personal data that was stolen encrypted? Or was it poorly encrypted and able to be brute-forced?</p>

      <div class="reply">
               </div>
     </div>
     </div>
<ul class="children">
   <li class="comment even depth-2" id="li-comment-494277">
    
     <div id="comment-494277">
     <div class="commenthead">
      <div class="comment-author vcard">
          <img alt='' src='https://secure.gravatar.com/avatar/f35b71ce2a4a46f974fff438b3685519?s=36&#038;d=mm&#038;r=pg' srcset='https://secure.gravatar.com/avatar/f35b71ce2a4a46f974fff438b3685519?s=72&#038;d=mm&#038;r=pg 2x' class='avatar avatar-36 photo' height='36' width='36' loading='lazy'/>
         <cite class="fn">Gordon Weakliem</cite>      </div>
      

      <div class="comment-meta commentmetadata"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-2/#comment-494277">August 6, 2019 at 11:11 am</a>     
           </div>
      <div class="clear"></div>
     
     </div>
     

	<div class="commentbody">
      <p>Leaving it unencrypted would be a huge security violation. My guess is that it was encrypted on S3 but the role on the EC2 had KMS decrypt permissions attached.</p>

      <div class="reply">
               </div>
     </div>
     </div>
<ul class="children">
   <li class="comment odd alt depth-3" id="li-comment-494347">
    
     <div id="comment-494347">
     <div class="commenthead">
      <div class="comment-author vcard">
          <img alt='' src='https://secure.gravatar.com/avatar/2a8c8dad3a6add86b14ac3d56c6ba3a8?s=36&#038;d=mm&#038;r=pg' srcset='https://secure.gravatar.com/avatar/2a8c8dad3a6add86b14ac3d56c6ba3a8?s=72&#038;d=mm&#038;r=pg 2x' class='avatar avatar-36 photo' height='36' width='36' loading='lazy'/>
         <cite class="fn">Andy</cite>      </div>
      

      <div class="comment-meta commentmetadata"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-2/#comment-494347">August 7, 2019 at 12:40 pm</a>     
           </div>
      <div class="clear"></div>
     
     </div>
     

	<div class="commentbody">
      <p>Almost certainly. The data was clearly not programmatically encrypted by the application. Given the SSRF risks and just &#8220;whoopsie&#8221; permissions issues with configuring S3 properly, and issues dealing with IAM roles &#8211; as mentioned by Krebs and the linked article from Evan, that stuff is complex and confusing, sensitive data should never be stored in S3 unencrypted. Figure out a way to programmatically encrypt it and protect the hell out of those keys. It just was not hard enough for this hacker to get to this data.</p>

      <div class="reply">
               </div>
     </div>
     </div>
<ul class="children">
   <li class="comment even depth-4" id="li-comment-494360">
    
     <div id="comment-494360">
     <div class="commenthead">
      <div class="comment-author vcard">
          <img alt='' src='https://secure.gravatar.com/avatar/21b41ffcd36df3a143bb634c399e7401?s=36&#038;d=mm&#038;r=pg' srcset='https://secure.gravatar.com/avatar/21b41ffcd36df3a143bb634c399e7401?s=72&#038;d=mm&#038;r=pg 2x' class='avatar avatar-36 photo' height='36' width='36' loading='lazy'/>
         <cite class="fn">SIC Guy</cite>      </div>
      

      <div class="comment-meta commentmetadata"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-2/#comment-494360">August 7, 2019 at 5:05 pm</a>     
           </div>
      <div class="clear"></div>
     
     </div>
     

	<div class="commentbody">
      <p>In public articles, Capital One&#8217;s CIO stated quite clearly, that Capital One created a product called &#8220;Cloud Custodian&#8221; that would &#8220;automatically encrypt all Capital One data&#8221; going into AWS.  (not some..ALL).</p>

      <div class="reply">
               </div>
     </div>
     </div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
   <li class="comment odd alt depth-2" id="li-comment-494586">
    
     <div id="comment-494586">
     <div class="commenthead">
      <div class="comment-author vcard">
          <img alt='' src='https://secure.gravatar.com/avatar/50bb96fe6925fe9b4a821d4f2e160b9f?s=36&#038;d=mm&#038;r=pg' srcset='https://secure.gravatar.com/avatar/50bb96fe6925fe9b4a821d4f2e160b9f?s=72&#038;d=mm&#038;r=pg 2x' class='avatar avatar-36 photo' height='36' width='36' loading='lazy'/>
         <cite class="fn">Jeff</cite>      </div>
      

      <div class="comment-meta commentmetadata"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-2/#comment-494586">August 12, 2019 at 4:27 pm</a>     
           </div>
      <div class="clear"></div>
     
     </div>
     

	<div class="commentbody">
      <p>Is there any evidence the data is not still encrypted by CapOne?  There is reporting that data was exfiltrated.  Nothing says it was in a format actually useful to the hacker.</p>

      <div class="reply">
               </div>
     </div>
     </div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
   <li class="comment even thread-even depth-1" id="li-comment-494264">
    
     <div id="comment-494264">
     <div class="commenthead">
      <div class="comment-author vcard">
          <img alt='' src='https://secure.gravatar.com/avatar/647a05f0263b4c3b0bf927105250528a?s=36&#038;d=mm&#038;r=pg' srcset='https://secure.gravatar.com/avatar/647a05f0263b4c3b0bf927105250528a?s=72&#038;d=mm&#038;r=pg 2x' class='avatar avatar-36 photo' height='36' width='36' loading='lazy'/>
         <cite class="fn">John D.</cite>      </div>
      

      <div class="comment-meta commentmetadata"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-2/#comment-494264">August 6, 2019 at 9:03 am</a>     
           </div>
      <div class="clear"></div>
     
     </div>
     

	<div class="commentbody">
      <p>should has a deny block in S3 bucket policy, just use the IAM and encrypts  are not enough.   Remember your data is on public-clouds.</p>

      <div class="reply">
               </div>
     </div>
     </div>
<ul class="children">
   <li class="comment odd alt depth-2" id="li-comment-494309">
    
     <div id="comment-494309">
     <div class="commenthead">
      <div class="comment-author vcard">
          <img alt='' src='https://secure.gravatar.com/avatar/2f2c002fbcdccd4698de30421e788a89?s=36&#038;d=mm&#038;r=pg' srcset='https://secure.gravatar.com/avatar/2f2c002fbcdccd4698de30421e788a89?s=72&#038;d=mm&#038;r=pg 2x' class='avatar avatar-36 photo' height='36' width='36' loading='lazy'/>
         <cite class="fn">Yogesh B</cite>      </div>
      

      <div class="comment-meta commentmetadata"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-2/#comment-494309">August 6, 2019 at 5:53 pm</a>     
           </div>
      <div class="clear"></div>
     
     </div>
     

	<div class="commentbody">
      <p>I agree, simple S3 policies are not enough, more restrictions to make access more specific can help. Even if the instance credentials are compromised, e.g. the S3 vpc-endpoint whitelisting may deny outside access.</p>

      <div class="reply">
               </div>
     </div>
     </div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
   <li class="comment even thread-odd thread-alt depth-1" id="li-comment-494284">
    
     <div id="comment-494284">
     <div class="commenthead">
      <div class="comment-author vcard">
          <img alt='' src='https://secure.gravatar.com/avatar/74be0ef09d907195176e275539315de3?s=36&#038;d=mm&#038;r=pg' srcset='https://secure.gravatar.com/avatar/74be0ef09d907195176e275539315de3?s=72&#038;d=mm&#038;r=pg 2x' class='avatar avatar-36 photo' height='36' width='36' loading='lazy'/>
         <cite class="fn">Gary E.</cite>      </div>
      

      <div class="comment-meta commentmetadata"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-2/#comment-494284">August 6, 2019 at 11:59 am</a>     
           </div>
      <div class="clear"></div>
     
     </div>
     

	<div class="commentbody">
      <p>Te basic 4 control family veracity were not there. If any of the 4 mentioned control families were weak, the threat is inevitable to become reality.<br />
Always try to have Control veracity  at highest when it comes to:<br />
1, AAA (authentication, authorization, access)<br />
2, Channel Security or crypto in transit<br />
3, Content Security or crypto at rest (hoping it is separated from 2)<br />
4, Audit (lastly this is where we all miss the signs of security &#8220;tickles&#8221; that we get before we fall over).<br />
It is easy to blame the vendors or admins or&#8230;<br />
The truth of the matter is that we are all vulnerable to low resources, authority, and budget to have the controls above maintained and operated. Far too many times when we are successful the first question from MGT is what do those guys do behind closed doors.</p>

      <div class="reply">
               </div>
     </div>
     </div>
</li><!-- #comment-## -->
   <li class="comment odd alt thread-even depth-1" id="li-comment-494362">
    
     <div id="comment-494362">
     <div class="commenthead">
      <div class="comment-author vcard">
          <img alt='' src='https://secure.gravatar.com/avatar/aab132dcd0805c67425e5a6efe4a46a1?s=36&#038;d=mm&#038;r=pg' srcset='https://secure.gravatar.com/avatar/aab132dcd0805c67425e5a6efe4a46a1?s=72&#038;d=mm&#038;r=pg 2x' class='avatar avatar-36 photo' height='36' width='36' loading='lazy'/>
         <cite class="fn"><a href='http://na' rel='external nofollow ugc' class='url'>jim</a></cite>      </div>
      

      <div class="comment-meta commentmetadata"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-2/#comment-494362">August 7, 2019 at 5:48 pm</a>     
           </div>
      <div class="clear"></div>
     
     </div>
     

	<div class="commentbody">
      <p>Something I never see addressed.  The executives of all these companies that have had break-ins, was any of THEIR personal information included?  Do they keep their info sand boxed away from the customer databases?  If they can keep their own information safe then why can they not keep ALL information safe?</p>

      <div class="reply">
               </div>
     </div>
     </div>
</li><!-- #comment-## -->
   <li class="comment even thread-odd thread-alt depth-1" id="li-comment-494523">
    
     <div id="comment-494523">
     <div class="commenthead">
      <div class="comment-author vcard">
          <img alt='' src='https://secure.gravatar.com/avatar/20d04bc3bf61df57ac651476d7aca7ff?s=36&#038;d=mm&#038;r=pg' srcset='https://secure.gravatar.com/avatar/20d04bc3bf61df57ac651476d7aca7ff?s=72&#038;d=mm&#038;r=pg 2x' class='avatar avatar-36 photo' height='36' width='36' loading='lazy'/>
         <cite class="fn">Tom</cite>      </div>
      

      <div class="comment-meta commentmetadata"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-2/#comment-494523">August 10, 2019 at 11:35 am</a>     
           </div>
      <div class="clear"></div>
     
     </div>
     

	<div class="commentbody">
      <p>In the deposition, it mentioned that someone saw the Capital One files on Github and informed Capital One at which point they began their investigation. It also states that she mentioned encrypting the information prior to putting it on Github. So, this also raises the question, how secure is encrypted information on Github?</p>

      <div class="reply">
               </div>
     </div>
     </div>
<ul class="children">
   <li class="comment odd alt depth-2" id="li-comment-494927">
    
     <div id="comment-494927">
     <div class="commenthead">
      <div class="comment-author vcard">
          <img alt='' src='https://secure.gravatar.com/avatar/050320caa796620aec177bd109527575?s=36&#038;d=mm&#038;r=pg' srcset='https://secure.gravatar.com/avatar/050320caa796620aec177bd109527575?s=72&#038;d=mm&#038;r=pg 2x' class='avatar avatar-36 photo' height='36' width='36' loading='lazy'/>
         <cite class="fn">timeless</cite>      </div>
      

      <div class="comment-meta commentmetadata"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-2/#comment-494927">August 18, 2019 at 12:07 am</a>     
           </div>
      <div class="clear"></div>
     
     </div>
     

	<div class="commentbody">
      <p>GitHub isn&#8217;t designed for security per se.</p>
<p>It&#8217;s designed for distributed coordination of development on source code. Generally speaking, it&#8217;s a way to share code and make changes to code.</p>
<p>If you choose to encrypt your content before submitting it to GitHub, then it&#8217;s up to you wrt how you choose to encrypt it.</p>
<p>Connections to GitHub themselves are transport encrypted w/ TLS/SSH, but that&#8217;s mostly just to prevent MitM attacks. Generally speaking anyone who is authorized can read the content of a given repository, and I think most repositories are public.</p>

      <div class="reply">
               </div>
     </div>
     </div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
   <li class="comment even thread-even depth-1" id="li-comment-494564">
    
     <div id="comment-494564">
     <div class="commenthead">
      <div class="comment-author vcard">
          <img alt='' src='https://secure.gravatar.com/avatar/80470295c5b018c9cb7740db718db59b?s=36&#038;d=mm&#038;r=pg' srcset='https://secure.gravatar.com/avatar/80470295c5b018c9cb7740db718db59b?s=72&#038;d=mm&#038;r=pg 2x' class='avatar avatar-36 photo' height='36' width='36' loading='lazy'/>
         <cite class="fn"><a href='https://www.linkedin.com/in/dane-s-3527a879/' rel='external nofollow ugc' class='url'>Dane Seelen</a></cite>      </div>
      

      <div class="comment-meta commentmetadata"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-2/#comment-494564">August 11, 2019 at 9:38 pm</a>     
           </div>
      <div class="clear"></div>
     
     </div>
     

	<div class="commentbody">
      <p>Isn&#8217;t anyone concerned that by notifying customers through various means if they were involved will only create a much larger phishing campaign with hackers moving forward?  Why is Capital One not establishing a search index similar to what Equifax did?</p>

      <div class="reply">
               </div>
     </div>
     </div>
<ul class="children">
   <li class="comment odd alt depth-2" id="li-comment-494577">
    
     <div id="comment-494577">
     <div class="commenthead">
      <div class="comment-author vcard">
          <img alt='' src='https://secure.gravatar.com/avatar/20d04bc3bf61df57ac651476d7aca7ff?s=36&#038;d=mm&#038;r=pg' srcset='https://secure.gravatar.com/avatar/20d04bc3bf61df57ac651476d7aca7ff?s=72&#038;d=mm&#038;r=pg 2x' class='avatar avatar-36 photo' height='36' width='36' loading='lazy'/>
         <cite class="fn">Tom</cite>      </div>
      

      <div class="comment-meta commentmetadata"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-2/#comment-494577">August 12, 2019 at 8:25 am</a>     
           </div>
      <div class="clear"></div>
     
     </div>
     

	<div class="commentbody">
      <p>Equifax&#8217;s response to their data breach was more horrible than the breach itself. It isn&#8217;t and shouldn&#8217;t be up to the victim to find out whether they are affected or not. The responsibility of notifying the victim was Equifax&#8217;s. By setting up a website for users to input 6 of the 9 digits in their social security number is just asking for someone to setup a rogue website to collect social security numbers.</p>

      <div class="reply">
               </div>
     </div>
     </div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
   <li class="comment even thread-odd thread-alt depth-1" id="li-comment-494904">
    
     <div id="comment-494904">
     <div class="commenthead">
      <div class="comment-author vcard">
          <img alt='' src='https://secure.gravatar.com/avatar/1e90bc26f22d393f8f1b69bb3a6ea26d?s=36&#038;d=mm&#038;r=pg' srcset='https://secure.gravatar.com/avatar/1e90bc26f22d393f8f1b69bb3a6ea26d?s=72&#038;d=mm&#038;r=pg 2x' class='avatar avatar-36 photo' height='36' width='36' loading='lazy'/>
         <cite class="fn">anon</cite>      </div>
      

      <div class="comment-meta commentmetadata"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-2/#comment-494904">August 16, 2019 at 9:01 pm</a>     
           </div>
      <div class="clear"></div>
     
     </div>
     

	<div class="commentbody">
      <p>most of capitalone should have migrated away from mod_security around 2 years ago</p>

      <div class="reply">
               </div>
     </div>
     </div>
</li><!-- #comment-## -->
   <li class="comment odd alt thread-even depth-1" id="li-comment-494905">
    
     <div id="comment-494905">
     <div class="commenthead">
      <div class="comment-author vcard">
          <img alt='' src='https://secure.gravatar.com/avatar/b39ebafbe12a8343836c44dec500818e?s=36&#038;d=mm&#038;r=pg' srcset='https://secure.gravatar.com/avatar/b39ebafbe12a8343836c44dec500818e?s=72&#038;d=mm&#038;r=pg 2x' class='avatar avatar-36 photo' height='36' width='36' loading='lazy'/>
         <cite class="fn">anon2</cite>      </div>
      

      <div class="comment-meta commentmetadata"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-2/#comment-494905">August 16, 2019 at 9:04 pm</a>     
           </div>
      <div class="clear"></div>
     
     </div>
     

	<div class="commentbody">
      <p>2 years ago capitalone switched their WAFs away from mod_security</p>

      <div class="reply">
               </div>
     </div>
     </div>
</li><!-- #comment-## -->
	</ol>

	<div class="comment-navigation">
		<div class="alignleft"><a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/comment-page-1/#comments" >&larr; Older Comments</a></div>
		<div class="alignright"></div>
		<div class="clearfix"></div>
	</div>
 


	
	</div>
</div>

	<div id="sidebar" class="grid_5">
		
		<div id="sidebar-box" style="margin-left:0px;">
			<div class="a-statement">Advertisement</div>
			<div class="a-img" id="sidebar-b-img">

			<a href="http://cybersecurity-strategy-masters.nyu.edu/landing-page/?utm_source=krebs&amp;utm_medium=banner">
<img src=/b-nyu/2.png>
</a>				
			</div>
		</div>

		<ul class="nobullet">
			<li>				<form method="get" id="searchform" action="https://krebsonsecurity.com/">
	<input type="text" name="s" id="s" value="" onfocus="clearInput('s', '')" onblur="clearInput('s', '')" /> 
	<input type="image" src="https://krebsonsecurity.com/wp-content/themes/krebsads/krebsads/images/search_magnifier.gif" id="searchbtn" value="Search" />
</form>
				</li>
</ul>
      <a href="https://www.akamai.com/us/en/resources/our-thinking/state-of-the-internet-report/global-state-of-the-internet-security-ddos-attack-reports.jsp?utm_source=krebsonsecurity&amp;utm_medium=display&amp;utm_id=GL_CrossSecurity&amp;utm_campaign=F-MC-52613&amp;utm_content=SOTI_Adapting">
<img src="/b-akamai/104.jpg">
</a><br />
<br />

		<ul class="nobullet">


			<li id="custom_html-2" class="widget_text widget widget_custom_html"><h2 class="widgettitle">Mailing List</h2>
<div class="textwidget custom-html-widget"><a href="/subscribe/">Subscribe here</a></div></li>

		<li id="recent-posts-3" class="widget widget_recent_entries">
		<h2 class="widgettitle">Recent Posts</h2>

		<ul>
											<li>
					<a href="https://krebsonsecurity.com/2021/03/fintech-giant-fiserv-used-unclaimed-domain/">Fintech Giant Fiserv Used Unclaimed Domain</a>
									</li>
											<li>
					<a href="https://krebsonsecurity.com/2021/03/can-we-stop-pretending-sms-is-secure-now/">Can We Stop Pretending SMS Is Secure Now?</a>
									</li>
											<li>
					<a href="https://krebsonsecurity.com/2021/03/weleakinfo-leaked-customer-payment-info/">WeLeakInfo Leaked Customer Payment Info</a>
									</li>
											<li>
					<a href="https://krebsonsecurity.com/2021/03/microsoft-patch-tuesday-march-2021-edition/">Microsoft Patch Tuesday, March 2021 Edition</a>
									</li>
											<li>
					<a href="https://krebsonsecurity.com/2021/03/warning-the-world-of-a-ticking-time-bomb/">Warning the World of a Ticking Time Bomb</a>
									</li>
					</ul>

		</li>
<li id="text-2" class="widget widget_text">			<div class="textwidget"><a name="subscribe2"></a></div>
		</li>
<li id="widget_sp_image-3" class="widget widget_sp_image"><h2 class="widgettitle">All About Skimmers </h2>
<a href="https://krebsonsecurity.com/all-about-skimmers/" target="_blank" class="widget_sp_image-image-link" title="All About Skimmers "><img width="299" height="232" alt="All About Skimmers" class="attachment-299x232 aligncenter" style="max-width: 100%;" src="https://krebsonsecurity.com/wp-content/uploads/2010/08/skimgallery1.jpg" /></a><div class="widget_sp_image-description" ><p>Click image for my skimmer series.</p>
</div></li>
<li id="widget_sp_image-24" class="widget widget_sp_image"><a href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&#038;hosted_button_id=MCCRKHWRX57HS" id="donate" target="_self" class="widget_sp_image-image-link"><img width="250" height="55" alt="Donate to Krebs On Security" class="attachment-medium aligncenter" style="max-width: 100%;" src="https://krebsonsecurity.com/wp-content/uploads/2016/09/donatepaypal2-1.png" /></a></li>
<li id="widget_sp_image-15" class="widget widget_sp_image"><h2 class="widgettitle">Spam Nation</h2>
<a href="https://www.amazon.com/Spam-Nation-Organized-Cybercrime-Epidemic-ebook/dp/B00L5QGBL0/ref=dp_kinw_strp_1" target="_blank" class="widget_sp_image-image-link" title="Spam Nation"><img width="266" height="404" alt="Spam Nation" class="attachment-266x404 aligncenter" style="max-width: 100%;" src="https://krebsonsecurity.com/wp-content/uploads/2015/04/spamnation-nyt.png" /></a><div class="widget_sp_image-description" ><p>A New York Times Bestseller! </p>
</div></li>
<li id="widget_sp_image-19" class="widget widget_sp_image"><a href="https://www.amazon.com/Spam-Nation-Organized-Cybercrime-Epidemic-ebook/dp/B00L5QGBL0/ref=dp_kinw_strp_1" target="_blank" class="widget_sp_image-image-link"><img width="181" height="48" alt=" " class="attachment-full aligncenter" style="max-width: 100%;" src="https://krebsonsecurity.com/wp-content/uploads/2014/10/amazon-mid.png" /></a></li>
<li id="widget_sp_image-5" class="widget widget_sp_image"><h2 class="widgettitle">The Value of a Hacked PC</h2>
<a href="https://krebsonsecurity.com/2012/10/the-scrap-value-of-a-hacked-pc-revisited/" target="_blank" class="widget_sp_image-image-link" title="The Value of a Hacked PC"><img width="285" height="180" alt="valuehackedpc " class="attachment-285x180 aligncenter" style="max-width: 100%;" src="https://krebsonsecurity.com/wp-content/uploads/2012/12/valuehackedpc-285x180.png" /></a><div class="widget_sp_image-description" ><p>Badguy uses for your PC</p>
</div></li>
<li id="widget_sp_image-7" class="widget widget_sp_image"><h2 class="widgettitle">The Pharma Wars</h2>
<a href="https://krebsonsecurity.com/category/pharma-wars/" target="_self" class="widget_sp_image-image-link" title="The Pharma Wars"><img width="252" height="228" alt="The Pharma Wars " class="attachment-full aligncenter" style="max-width: 100%;" src="https://krebsonsecurity.com/wp-content/uploads/2013/01/pharmawarsg.png" /></a><div class="widget_sp_image-description" ><p>Spammers Duke it Out</p>
</div></li>
<li id="widget_sp_image-9" class="widget widget_sp_image"><h2 class="widgettitle">Badguy Uses for Your Email </h2>
<a href="https://krebsonsecurity.com/2013/06/the-value-of-a-hacked-email-account/" target="_self" class="widget_sp_image-image-link" title="Badguy Uses for Your Email "><img width="296" height="170" alt="Badguy Uses for Your Email " class="attachment-full aligncenter" style="max-width: 100%;" srcset="https://krebsonsecurity.com/wp-content/uploads/2013/06/badguyemail.png 296w, https://krebsonsecurity.com/wp-content/uploads/2013/06/badguyemail-285x163.png 285w" sizes="(max-width: 296px) 100vw, 296px" src="https://krebsonsecurity.com/wp-content/uploads/2013/06/badguyemail.png" /></a><div class="widget_sp_image-description" ><p>Your email account may be worth far more than you imagine.</p>
</div></li>
<li id="widget_sp_image-10" class="widget widget_sp_image"><h2 class="widgettitle">eBanking Best Practices</h2>
<a href="https://krebsonsecurity.com/online-banking-best-practices-for-businesses/" target="_blank" class="widget_sp_image-image-link" title="eBanking Best Practices"><img width="285" height="213" alt="eBanking Best Practices" class="attachment-medium aligncenter" style="max-width: 100%;" srcset="https://krebsonsecurity.com/wp-content/uploads/2013/04/robotrobkb-285x213.jpg 285w, https://krebsonsecurity.com/wp-content/uploads/2013/04/robotrobkb.jpg 400w" sizes="(max-width: 285px) 100vw, 285px" src="https://krebsonsecurity.com/wp-content/uploads/2013/04/robotrobkb-285x213.jpg" /></a><div class="widget_sp_image-description" ><p>eBanking Best Practices for Businesses</p>
</div></li>
<li id="most_popular_posts-3" class="widget widget_most_popular_posts">
<h2 class="widgettitle">Most Popular Posts</h2>

<ul>	<li><a href="https://krebsonsecurity.com/2018/07/sextortion-scam-uses-recipients-hacked-passwords/">Sextortion Scam Uses Recipient's Hacked Passwords</a> (1076)</li>
	<li><a href="https://krebsonsecurity.com/2015/07/online-cheating-site-ashleymadison-hacked/">Online Cheating Site AshleyMadison Hacked</a> (798)</li>
	<li><a href="https://krebsonsecurity.com/2013/12/sources-target-investigating-data-breach/">Sources: Target Investigating Data Breach</a> (620)</li>
	<li><a href="https://krebsonsecurity.com/2020/11/trump-fires-security-chief-christopher-krebs/">Trump Fires Security Chief Christopher Krebs</a> (534)</li>
	<li><a href="https://krebsonsecurity.com/2013/12/cards-stolen-in-target-breach-flood-underground-markets/">Cards Stolen in Target Breach Flood Underground Markets</a> (445)</li>
	<li><a href="https://krebsonsecurity.com/2013/05/reports-liberty-reserve-founder-arrested-site-shuttered/">Reports: Liberty Reserve Founder Arrested, Site Shuttered</a> (416)</li>
	<li><a href="https://krebsonsecurity.com/2015/08/was-the-ashley-madison-database-leaked/">Was the Ashley Madison Database Leaked?</a> (376)</li>
	<li><a href="https://krebsonsecurity.com/2021/01/ddos-guard-to-forfeit-internet-space-occupied-by-parler/">DDoS-Guard To Forfeit Internet Space Occupied by Parler</a> (374)</li>
	<li><a href="https://krebsonsecurity.com/2014/05/true-goodbye-using-truecrypt-is-not-secure/">True Goodbye: 'Using TrueCrypt Is Not Secure'</a> (363)</li>
	<li><a href="https://krebsonsecurity.com/2015/08/who-hacked-ashley-madison/">Who Hacked Ashley Madison?</a> (361)</li>
</ul>
</li>

<li id="widget_sp_image-11" class="widget widget_sp_image"><h2 class="widgettitle">Category: Web Fraud 2.0</h2>
<a href="https://krebsonsecurity.com/category/web-fraud-2-0/" target="_blank" class="widget_sp_image-image-link" title="Category: Web Fraud 2.0"><img width="227" height="400" alt="Criminnovations" class="attachment-medium aligncenter" style="max-width: 100%;" src="https://krebsonsecurity.com/wp-content/uploads/2013/11/cybercrimeinnovations-227x400.png" /></a><div class="widget_sp_image-description" ><p>Innovations from the Underground</p>
</div></li>
<li id="widget_sp_image-12" class="widget widget_sp_image"><a href="https://krebsonsecurity.com/2014/03/are-credit-monitoring-services-worth-it/" target="_blank" class="widget_sp_image-image-link"><img width="285" height="189" class="attachment-medium aligncenter" style="max-width: 100%;" srcset="https://krebsonsecurity.com/wp-content/uploads/2014/03/shreddedID-copy-285x189.png 285w, https://krebsonsecurity.com/wp-content/uploads/2014/03/shreddedID-copy-600x399.png 600w, https://krebsonsecurity.com/wp-content/uploads/2014/03/shreddedID-copy.png 849w" sizes="(max-width: 285px) 100vw, 285px" src="https://krebsonsecurity.com/wp-content/uploads/2014/03/shreddedID-copy-285x189.png" /></a><div class="widget_sp_image-description" ><p>ID Protection Services Examined</p>
</div></li>
<li id="widget_sp_image-13" class="widget widget_sp_image"><h2 class="widgettitle">Is Antivirus Dead?</h2>
<a href="https://krebsonsecurity.com/2014/05/antivirus-is-dead-long-live-antivirus/" target="_blank" class="widget_sp_image-image-link" title="Is Antivirus Dead?"><img width="285" height="161" alt="Is Antivirus Dead?" class="attachment-medium aligncenter" style="max-width: 100%;" srcset="https://krebsonsecurity.com/wp-content/uploads/2014/05/cryptservices-285x161.png 285w, https://krebsonsecurity.com/wp-content/uploads/2014/05/cryptservices-600x339.png 600w, https://krebsonsecurity.com/wp-content/uploads/2014/05/cryptservices.png 945w" sizes="(max-width: 285px) 100vw, 285px" src="https://krebsonsecurity.com/wp-content/uploads/2014/05/cryptservices-285x161.png" /></a><div class="widget_sp_image-description" ><p>The reasons for its decline</p>
</div></li>
<li id="widget_sp_image-14" class="widget widget_sp_image"><h2 class="widgettitle">The Growing Tax Fraud Menace</h2>
<a href="https://krebsonsecurity.com/category/tax-refund-fraud/" target="_blank" class="widget_sp_image-image-link" title="The Growing Tax Fraud Menace"><img width="285" height="285" alt="The Growing Tax Fraud Menace" class="attachment-medium aligncenter" style="max-width: 100%;" srcset="https://krebsonsecurity.com/wp-content/uploads/2014/04/taxfraud-285x285.jpg 285w, https://krebsonsecurity.com/wp-content/uploads/2014/04/taxfraud-150x150.jpg 150w, https://krebsonsecurity.com/wp-content/uploads/2014/04/taxfraud-600x600.jpg 600w, https://krebsonsecurity.com/wp-content/uploads/2014/04/taxfraud.jpg 693w" sizes="(max-width: 285px) 100vw, 285px" src="https://krebsonsecurity.com/wp-content/uploads/2014/04/taxfraud-285x285.jpg" /></a><div class="widget_sp_image-description" ><p>File 'em Before the Bad Guys Can </p>
</div></li>
<li id="widget_sp_image-17" class="widget widget_sp_image"><h2 class="widgettitle">Inside a Carding Shop</h2>
<a href="https://krebsonsecurity.com/2014/06/peek-inside-a-professional-carding-shop/" target="_blank" class="widget_sp_image-image-link" title="Inside a Carding Shop"><img width="194" height="340" alt="Inside a Carding Shop" class="attachment-medium aligncenter" style="max-width: 100%;" src="https://krebsonsecurity.com/wp-content/uploads/2014/06/mcdumpalsjoined.png" /></a><div class="widget_sp_image-description" ><p>A crash course in carding. </p>
</div></li>
<li id="widget_sp_image-18" class="widget widget_sp_image"><h2 class="widgettitle">Beware Social Security Fraud</h2>
<a href="https://krebsonsecurity.com/2013/09/crooks-hijack-retirement-funds-via-ssa-portal/" target="_blank" class="widget_sp_image-image-link" title="Beware Social Security Fraud"><img width="285" height="293" alt="Beware Social Security Fraud" class="attachment-full aligncenter" style="max-width: 100%;" src="https://krebsonsecurity.com/wp-content/uploads/2016/09/myssn-285x293.png" /></a><div class="widget_sp_image-description" ><p>Sign up, or Be Signed Up! </p>
</div></li>
<li id="widget_sp_image-2" class="widget widget_sp_image"><h2 class="widgettitle">How Was Your Card Stolen?</h2>
<a href="https://krebsonsecurity.com/2015/01/how-was-your-credit-card-stolen/" target="_blank" class="widget_sp_image-image-link" title="How Was Your Card Stolen?"><img width="285" height="285" alt="How Was Your Card Stolen?" class="attachment-full aligncenter" style="max-width: 100%;" srcset="https://krebsonsecurity.com/wp-content/uploads/2016/09/carddominoes-285x285.jpg 285w, https://krebsonsecurity.com/wp-content/uploads/2016/09/carddominoes-285x285-150x150.jpg 150w" sizes="(max-width: 285px) 100vw, 285px" src="https://krebsonsecurity.com/wp-content/uploads/2016/09/carddominoes-285x285.jpg" /></a><div class="widget_sp_image-description" ><p>Finding out is not so easy. </p>
</div></li>
<li id="widget_sp_image-22" class="widget widget_sp_image"><h2 class="widgettitle">Krebs&#8217;s 3 Rules&#8230;</h2>
<a href="https://krebsonsecurity.com/2011/05/krebss-3-basic-rules-for-online-safety/" target="_blank" class="widget_sp_image-image-link" title="Krebs&#8217;s 3 Rules&#8230;"><img width="300" height="300" alt="Krebs&#8217;s 3 Rules&#8230;" class="attachment-medium aligncenter" style="max-width: 100%;" srcset="https://krebsonsecurity.com/wp-content/uploads/2011/05/three-300x300.jpg 300w, https://krebsonsecurity.com/wp-content/uploads/2011/05/three-150x150.jpg 150w, https://krebsonsecurity.com/wp-content/uploads/2011/05/three.jpg 347w" sizes="(max-width: 300px) 100vw, 300px" src="https://krebsonsecurity.com/wp-content/uploads/2011/05/three-300x300.jpg" /></a><div class="widget_sp_image-description" ><p>...For Online Safety. </p>
</div></li>

		</ul>
	</div>


<hr />
<div id="footer" class="grid_16">
	<p>
		&copy; 2021 Krebs on Security. 
		&ensp;Powered by <a href="http://wordpress.org/">WordPress</a>. 
&ensp;<a href="http://krebsonsecurity.com/wp-content/uploads/2010/04/kospp.pdf">Privacy Policy</a>
	</p>
</div>
</div>
		<script type='text/javascript' src='https://krebsonsecurity.com/wp-includes/js/wp-embed.min.js?ver=5.6.2' id='wp-embed-js'></script>


<!-- Piwik 
<script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(["trackPageView"]);
  _paq.push(["enableLinkTracking"]);

  (function() {
    var u=(("https:" == document.location.protocol) ? "https" : "http") + "://s.krebsonsecurity.com/";
    _paq.push(["setTrackerUrl", u+"piwik.php"]);
    _paq.push(["setSiteId", "1"]);
    var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0]; g.type="text/javascript";
    g.defer=true; g.async=true; g.src=u+"piwik.js"; s.parentNode.insertBefore(g,s);
  })();
</script>
  End Piwik Code -->


<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "https://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-12214465-1");
pageTracker._trackPageview();
} catch(err) {}</script>












</body>
</html>

<!--
Performance optimized by W3 Total Cache. Learn more: https://www.boldgrid.com/w3-total-cache/

Object Caching 151/215 objects using memcached
Page Caching using memcached 
Database Caching 2/24 queries in 0.008 seconds using memcached

Served from: krebsonsecurity.com @ 2021-03-21 23:37:35 by W3 Total Cache
-->