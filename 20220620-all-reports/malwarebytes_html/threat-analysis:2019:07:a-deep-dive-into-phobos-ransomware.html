<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>

  
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
    <!-- Taken from www.malwarebytes.com -->
  <!-- Fav Ico -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel='shortcut icon' href='//www.malwarebytes.com/images/favicon.ico' type='image/x-icon' />
  <link rel="apple-touch-icon" sizes="57x57" href="//www.malwarebytes.com/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="//www.malwarebytes.com/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="//www.malwarebytes.com/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="//www.malwarebytes.com/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="//www.malwarebytes.com/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="//www.malwarebytes.com/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="//www.malwarebytes.com/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="//www.malwarebytes.com/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="//www.malwarebytes.com/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="///www.malwarebytes.com/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="//www.malwarebytes.com/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="//www.malwarebytes.com/manifest.json">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="msapplication-TileImage" content="//www.malwarebytes.com/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">
  
<title>

A deep dive into Phobos ransomware - Malwarebytes Labs | Malwarebytes Labs  </title>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://blog.malwarebytes.com/xmlrpc.php">

  
	<!-- Meta Tag Manager -->
	<meta property="fb:app_id" content="358351844222748" />
	<!-- / Meta Tag Manager -->

	<!-- This site is optimized with the Yoast SEO plugin v15.9 - https://yoast.com/wordpress/plugins/seo/ -->
	<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<link rel="canonical" href="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="A deep dive into Phobos ransomware - Malwarebytes Labs" />
	<meta property="og:description" content="We take an in-depth look into Phobos ransomware which threat actors distribute via RDP and look at similarities with Dharma (AKA CrySis) ransomware." />
	<meta property="og:url" content="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/" />
	<meta property="og:site_name" content="Malwarebytes Labs" />
	<meta property="article:published_time" content="2019-07-24T18:09:33+00:00" />
	<meta property="article:modified_time" content="2019-07-24T18:57:14+00:00" />
	<meta property="og:image" content="https://blog.malwarebytes.com/wp-content/uploads/2016/08/photodune-3043497-chain-locker-s.jpg" />
	<meta property="og:image:width" content="948" />
	<meta property="og:image:height" content="632" />
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:creator" content="@hasherezade" />
	<meta name="twitter:site" content="@malwarebytes" />
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="hasherezade">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="16 minutes">
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://blog.malwarebytes.com/#website","url":"https://blog.malwarebytes.com/","name":"Malwarebytes Labs","description":"The Security Blog From Malwarebytes","potentialAction":[{"@type":"SearchAction","target":"https://blog.malwarebytes.com/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/#primaryimage","inLanguage":"en-US","url":"https://blog.malwarebytes.com/wp-content/uploads/2016/08/photodune-3043497-chain-locker-s.jpg","width":948,"height":632},{"@type":"WebPage","@id":"https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/#webpage","url":"https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/","name":"A deep dive into Phobos ransomware - Malwarebytes Labs","isPartOf":{"@id":"https://blog.malwarebytes.com/#website"},"primaryImageOfPage":{"@id":"https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/#primaryimage"},"datePublished":"2019-07-24T18:09:33+00:00","dateModified":"2019-07-24T18:57:14+00:00","author":{"@id":"https://blog.malwarebytes.com/#/schema/person/3c674ace3322ac9b8bd3368413fecf10"},"breadcrumb":{"@id":"https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/"]}]},{"@type":"BreadcrumbList","@id":"https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://blog.malwarebytes.com/","url":"https://blog.malwarebytes.com/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/","url":"https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/","name":"A deep dive into Phobos ransomware"}}]},{"@type":"Person","@id":"https://blog.malwarebytes.com/#/schema/person/3c674ace3322ac9b8bd3368413fecf10","name":"hasherezade","image":{"@type":"ImageObject","@id":"https://blog.malwarebytes.com/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/5d5dda1e7e00492cdb89a26415b1fa8f?s=96&d=identicon&r=g","caption":"hasherezade"},"description":"Unpacks malware with as much joy as a kid unpacking candies.","sameAs":["http://hasherezade.net","https://twitter.com/hasherezade"]}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Malwarebytes Unpacked" href="http://blog.malwarebytes.org/feed/" />
<link rel="alternate" type="application/rss+xml" title="Malwarebytes Unpacked | Comments" href="http://blog.malwarebytes.org/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Malwarebytes Labs &raquo; A deep dive into Phobos ransomware Comments Feed" href="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/blog.malwarebytes.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.6.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='https://blog.malwarebytes.com/wp-includes/css/dist/block-library/style.min.css?ver=5.6.2' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<link rel='stylesheet' id='responsive-lightbox-prettyphoto-css'  href='https://blog.malwarebytes.com/wp-content/plugins/responsive-lightbox/assets/prettyphoto/prettyPhoto.min.css?ver=2.3.2' type='text/css' media='all' />
<link crossorigin="anonymous" rel='stylesheet' id='mb_labs-fonts-css'  href='//fonts.googleapis.com/css?family=Source+Sans+Pro%3A300%2C400%2C700%2C300italic%2C400italic%2C700italic%7CBitter%3A400%2C700&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='https://blog.malwarebytes.com/wp-content/plugins/jetpack/_inc/genericons/genericons/genericons.css?ver=3.1' type='text/css' media='all' />
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-includes/js/jquery/jquery.min.js?ver=3.5.1' id='jquery-core-js'></script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-content/plugins/responsive-lightbox/assets/prettyphoto/jquery.prettyPhoto.min.js?ver=2.3.2' id='responsive-lightbox-prettyphoto-js'></script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-includes/js/underscore.min.js?ver=1.8.3' id='underscore-js'></script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-content/plugins/responsive-lightbox/assets/infinitescroll/infinite-scroll.pkgd.min.js?ver=5.6.2' id='responsive-lightbox-infinite-scroll-js'></script>
<script type='text/javascript' id='responsive-lightbox-js-extra'>
/* <![CDATA[ */
var rlArgs = {"script":"prettyphoto","selector":"lightbox","customEvents":"","activeGalleries":"1","animationSpeed":"normal","slideshow":"0","slideshowDelay":"5000","slideshowAutoplay":"0","opacity":"0.75","showTitle":"1","allowResize":"1","allowExpand":"1","width":"1080","height":"720","separator":"\/","theme":"pp_default","horizontalPadding":"20","hideFlash":"0","wmode":"opaque","videoAutoplay":"0","modal":"0","deeplinking":"0","overlayGallery":"1","keyboardShortcuts":"1","social":"0","woocommerce_gallery":"0","ajaxurl":"https:\/\/blog.malwarebytes.com\/wp-admin\/admin-ajax.php","nonce":"34b79a074b"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-content/plugins/responsive-lightbox/js/front.js?ver=2.3.2' id='responsive-lightbox-js'></script>
<link rel="https://api.w.org/" href="https://blog.malwarebytes.com/wp-json/" /><link rel="alternate" type="application/json" href="https://blog.malwarebytes.com/wp-json/wp/v2/posts/39371" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.malwarebytes.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.malwarebytes.com/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://blog.malwarebytes.com/?p=39371' />
<link rel="alternate" type="application/json+oembed" href="https://blog.malwarebytes.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.malwarebytes.com%2Fthreat-analysis%2F2019%2F07%2Fa-deep-dive-into-phobos-ransomware%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://blog.malwarebytes.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.malwarebytes.com%2Fthreat-analysis%2F2019%2F07%2Fa-deep-dive-into-phobos-ransomware%2F&#038;format=xml" />
	<style type="text/css" id="mb_labs-header-css">
			.site-header {
			background: url(https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/headers/circle.png) no-repeat scroll top;
			background-size: 1600px auto;
		}
		</style>
	<link rel="amphtml" href="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/amp/">    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.css" />
	<link rel="stylesheet" type="text/css" href="//www.malwarebytes.com/css/style.css?12-20-2016" />
	<link rel="stylesheet" type="text/css" href="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/style.css?03-03-2021" />


  <script src="//www.malwarebytes.com/js/jquery-1.11.3.min.js" type="text/javascript"></script>

<!-- OneTrust Cookies Consent Notice (Production Standard, malwarebytes.com, en-GB) start -->

<script src="https://optanon.blob.core.windows.net/consent/9530a107-0af8-4204-a2c2-217efb78222b.js" type="text/javascript" charset="UTF-8"></script>

<script type="text/javascript">

function OptanonWrapper() { }

</script>

<!-- OneTrust Cookies Consent Notice (Production Standard, malwarebytes.com, en-GB) end -->

  <script src="//www.malwarebytes.com/js/bootstrap.js" type="text/javascript"></script>
  <script src="//www.malwarebytes.com/js/ie-fixes/respond.min.js" type="text/javascript"></script>

<script src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/modernizr.js"></script>
<!--[if gte IE 9]><!-->
<script type="text/javascript" src="//www.malwarebytes.com/js/nav-resize.js"></script>
<!--<![endif]-->
	
  <script src="//www.malwarebytes.com/js/flexibility.js"></script>

  <!--<script src="//www.malwarebytes.com/js/nav.js"></script>-->
  <script>
function readCookie(name) {
  var nameEQ = name + "=";
  var ca = document.cookie.split(';');
  for (var i = 0; i < ca.length; i++) {
    var c = ca[i];
    while (c.charAt(0) == ' ') c = c.substring(1, c.length);
    if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
  }
  return null;
}

//disable functions based on cookie preference
var acceptCookies = readCookie('ce-cookie');
if (acceptCookies === "N") {
    $('body').css('visibility','visible');
    function setCookie() {
        return false;
    }
}
  
  
  
</script>
 
  <script src="//www.malwarebytes.com/js/global.js"></script>

  <script src="//www.malwarebytes.com/js/xs.js"></script>
  <script src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/js/search.js"></script>

<link rel="amphtml" href="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/amp/">
<script>
$(document).ready(function() {
  $("link[rel=amphtml]").each(function(){
    amphtml = $(this).attr("href");
    $(this).attr("href",amphtml.replace("/?amp","/amp"));
  });
});
</script>

<!-- New nav -->
  <link href="//www.malwarebytes.com/css/NEW-NAV.css" rel="stylesheet" type="text/css">
  <script src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/js/new-nav.js" type="text/javascript"></script>

  
</head>
<body>
<!-- Google Tag Manager -->
<noscript>
<iframe src="//www.googletagmanager.com/ns.html?id=GTM-MKSKW3"
height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MKSKW3');</script> 
<!-- End Google Tag Manager --> 

  
  

<!-- global nav -->
<nav id="mbnav" class="abtest">
    <div id="nav-background"></div>
    <div class="nav-container">
        <div class="logo">
            <a href="/" id="cta-navbar-company-logo-en-test">
                <!--<img src="https://blog.malwarebytes.com/wp-content/themes/labs.malwarebytes.org-1.7d/images/labs-log-w-tagline.svg" id="mb-labs-logo">-->
                <script>
                  $('document').ready(function () {
                    setTimeout(function () {
                      $('#main-logo, #logo-tagline').attr('class', 'changed');
                    }, 3000);
                    setTimeout(function () {
                      $('#main-logo, #logo-tagline').attr('class', '');
                    }, 7000);
                  })
                </script>

                <svg version="1.1" id="main-logo" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="-672 235.9 278.5 31.1" style="enable-background:new -672 235.9 254.5 31.1;" xml:space="preserve" class="" aria-labelledby="malwarebytes-main-logo-title malwarebytes-main-logo-desc" role="img">
    <title id="malwarebytes-main-logo-title">The official Malwarebytes logo</title>
                    <desc id="malwarebytes-main-logo-desc">The official Malwarebytes logo in a blue font</desc>
                    <image src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/malwarebytes-labs-logo.png" xlink:href=""></image>
                    <style type="text/css">
                        .st0 {
                            fill: #0D3ECC !important;
                        }

                        .st1 {
                            fill: #414042;
                        }

                        .st2 {
                            fill: none;
                        }

                        .st3 {
                            enable-background: new;
                        }

                        .st4 {
                            fill: #FFFFFF;
                        }
                    </style>
                    <path id="logo-icon" class="st0" d="M-659.1,263.1C-659,263.1-659,263.1-659.1,263.1c0.3,0,0.4-0.2,0.4-0.4c0-0.2-0.1-0.3-0.3-0.4h-0.1h-0.2
  c-3.8-0.8-6.8-4.2-6.8-8.2c0-1.7,0.5-3.3,1.4-4.7c0.1-0.2,0.4-0.3,0.6-0.1l6.1,6.2c0.1,0.1,0.2,0.1,0.3,0.1s0.2,0,0.3-0.1l6.2-6.1
  c0.2-0.2,0.4-0.2,0.6,0c0.9,1.3,1.4,2.9,1.4,4.7c0,2.2-0.8,4.1-2.1,5.6c0,0-0.1,0.1-0.1,0.2v0.1c0,0.2,0.2,0.3,0.3,0.3l0,0
  c0,0,0.1,0,0.2-0.1c8.1-3.5,7.8-11.5,7.8-11.5c0-4.6-2.2-8.8-5.6-11.4c-0.2-0.1-0.4-0.1-0.5,0l-8.1,8.1c-0.2,0.2-0.4,0.2-0.5,0
  l-8.1-8.1c-0.1-0.1-0.4-0.2-0.5,0c-3.4,2.6-5.6,6.8-5.6,11.4l0,0C-672,256.2-666.3,262.3-659.1,263.1"></path>
                    <g id="logo-maintext">
                        <polygon class="st1" points="-446.9,260.3 -454.3,242.4 -461.7,260.4 -459.7,260.4 -458.3,256.8 -453.5,256.8 -457.4,254.5
    -454.3,246.9 -450.3,257.1 -453.8,257.1 -446.8,260.3   "></polygon>
                        <path class="st0" d="M-545.7,244L-545.7,244l-0.1-7.8c0-0.2-0.2-0.3-0.4-0.3l-2.2,0.3c-0.2,0-0.3,0.2-0.3,0.3v23.1
    c0,0.2,0.1,0.3,0.2,0.3c1.9,0.4,4.3,0.6,5.8,0.6c6.3,0,7.2-3,7.2-6.3v-6c0-3.5-1.6-5.3-4.9-5.3C-542.6,242.8-544.6,243.5-545.7,244
    z M-538.2,248v6.3c0,2.3-0.7,3.8-4.2,3.8c-1.2,0-2.3-0.1-3.4-0.2h-0.1v-11.3l0,0c1-0.5,3.1-1.3,4.7-1.3
    C-539.1,245.3-538.2,246.1-538.2,248z"></path>
                        <path class="st0" d="M-531.7,243.2h-2.1c-0.2,0-0.4,0.2-0.3,0.4l5.3,16.3c0,0.1,0.2,0.2,0.3,0.2h0.6c0.2,0,0.4,0.2,0.3,0.4
    l-2.1,6.1c-0.1,0.2,0.1,0.4,0.3,0.4h2c0.1,0,0.2-0.1,0.3-0.2l2.3-6.6l5.5-16.6c0.1-0.2-0.1-0.4-0.3-0.4h-2.1
    c-0.1,0-0.2,0.1-0.3,0.2l-4.4,13.8c-0.1,0.3-0.5,0.3-0.6,0l-4.4-13.8C-531.4,243.3-531.6,243.2-531.7,243.2z"></path>
                        <path class="st0" d="M-505.6,249.2v5.1c0,4.2,2.1,6.2,6.7,6.2c2,0,4.1-0.3,5.7-0.9c0.2,0,0.2-0.2,0.2-0.4l-0.3-1.6
    c0-0.2-0.2-0.3-0.4-0.2c-1.9,0.5-3.5,0.7-5,0.7c-3.5,0-4.1-1.3-4.1-3.8v-1.2c0-0.2,0.1-0.3,0.3-0.3h9.6c0.2,0,0.3-0.1,0.3-0.3v-3.2
    c0-4.3-2.1-6.4-6.3-6.4C-503.3,242.8-505.6,245-505.6,249.2z M-502.8,248.9c0-2.6,1.2-3.8,3.8-3.8s3.7,1.1,3.7,3.8v1.2
    c0,0.2-0.1,0.3-0.3,0.3h-6.9c-0.2,0-0.3-0.1-0.3-0.3L-502.8,248.9L-502.8,248.9z"></path>
                        <path class="st0" d="M-484.4,250.5c-2.9-0.7-3-1.1-3-3c0-1.6,0.4-2.2,2.9-2.2c1.2,0,2.9,0.2,4.3,0.4c0.2,0,0.4-0.1,0.4-0.3l0.2-1.7
    c0-0.2-0.1-0.3-0.2-0.3c-1.3-0.3-2.9-0.5-4.5-0.5c-4.2,0-5.8,1.2-5.8,4.5c0,3.5,0.4,4.4,4.6,5.4c3.4,0.8,3.6,1,3.6,2.9
    c0,1.8-0.4,2.4-3.2,2.4c-1.3,0-3.1-0.2-4.5-0.6c-0.2,0-0.4,0.1-0.4,0.2l-0.3,1.6c0,0.2,0.1,0.3,0.2,0.4c1.4,0.5,3.5,0.8,5.1,0.8
    c4.9,0,5.8-1.6,5.8-4.9C-479.2,252-479.8,251.6-484.4,250.5z"></path>
                        <g>
                            <path class="st0" d="M-613.7,259.9l-3-16.5c0-0.2,0.1-0.4,0.3-0.4h3.4c0.2,0,0.3,0.1,0.3,0.2l1.8,9.9c0,0.3,0.5,0.4,0.6,0l3-10
      c0-0.1,0.2-0.2,0.3-0.2h4c0.1,0,0.2,0.1,0.3,0.2l2.9,10c0.1,0.3,0.5,0.3,0.6,0l1.8-9.9c0-0.2,0.2-0.2,0.3-0.2h3.4
      c0.2,0,0.3,0.2,0.3,0.4l-3,16.5c0,0.2-0.2,0.2-0.3,0.2h-4.5c-0.1,0-0.2-0.1-0.3-0.2l-3.3-11c-0.1-0.3-0.5-0.3-0.6,0l-3.3,11
      c0,0.1-0.2,0.2-0.3,0.2h-4.5C-613.5,260.2-613.7,260.1-613.7,259.9z"></path>
                        </g>
                        <path class="st0" d="M-618.6,257c-1.5,0-2-0.7-2-2.6v-12.3v-4.9c0-0.2-0.2-0.3-0.4-0.3l-3.6,0.5c-0.2,0-0.3,0.2-0.3,0.3v0.2v4.2
    v12.8c0,3.9,2.4,5.6,5.5,5.6c0.3,0,1.5,0,2-0.1c0.2,0,0.3-0.2,0.3-0.3v-2.7c0-0.2-0.2-0.3-0.3-0.3C-617.8,257-618.3,257-618.6,257z
    "></path>
                        <g>
                            <path class="st0" d="M-566.9,246.8c-1.5,0.7-2.7,1.4-4.2,2.3c-0.1,0-0.2,0.2-0.2,0.3v10.5c0,0.2-0.1,0.3-0.3,0.3h-3.7
      c-0.2,0-0.3-0.1-0.3-0.3V244c0-0.2,0.1-0.3,0.2-0.3l3.1-0.5c0.2,0,0.3,0.1,0.4,0.2l0.2,1.1c0,0.2,0.3,0.3,0.5,0.2
      c0.9-0.6,2.5-1.5,3.7-1.9c0.2-0.1,0.4,0.1,0.4,0.3l0.4,3.3C-566.7,246.6-566.7,246.7-566.9,246.8z"></path>
                        </g>
                        <path class="st0" d="M-510,258.1c-1.7,0-1.8-0.8-1.8-2v-10.3c0-0.2,0.1-0.3,0.3-0.3h4c0.2,0,0.3-0.1,0.3-0.3l0.2-1.7
    c0-0.2-0.1-0.4-0.3-0.4h-4.2c-0.2,0-0.3-0.1-0.3-0.3v-3.9c0-0.2-0.2-0.3-0.4-0.3l-2.2,0.3c-0.2,0-0.3,0.2-0.3,0.3v3.7
    c0,0.2-0.1,0.3-0.3,0.3h-2.4c-0.2,0-0.3,0.1-0.3,0.3v1.7c0,0.2,0.1,0.3,0.3,0.3h2.4c0.2,0,0.3,0.1,0.3,0.3v10.8
    c0,2.7,1.2,3.8,4.2,3.8c0.7,0,1.3-0.1,2-0.2c0.2,0,0.2-0.2,0.2-0.3v-1.6c0-0.2-0.2-0.3-0.4-0.3C-509.1,258.1-509.5,258.1-510,258.1
    z"></path>
                        <path class="st2" d="M-557.3,246.2c-0.2,0-0.4,0-0.7,0c-2.1,0-2.8,1.1-2.8,2.7v1.5l0,0h5.4c0.2,0,0.3-0.1,0.3-0.3v-1.2
    C-555.1,247.4-555.7,246.4-557.3,246.2z"></path>
                        <path class="st0" d="M-554.5,243.3c-0.9-0.4-2.1-0.6-3.5-0.6c-1.6,0-3,0.3-4,0.8c-2.3,1.1-3.1,3.4-3.1,5.9v4.5c0,4,1.8,6.5,6.9,6.6
    c0.4,0,0.8,0,1.2,0c1.4,0,2.8-0.2,4.2-0.4c0.2,0,0.3-0.2,0.3-0.4v-0.2l-0.4-2.3l0,0c-1.3,0.1-2.4,0.2-3.7,0.2l0,0
    c-3.1,0-4.1-0.9-4.1-2.8V254l0,0v-0.8l0,0h9.2c0.2,0,0.3-0.1,0.3-0.3v-1.3v-2.1C-551.3,246.8-552,244.4-554.5,243.3z M-555.1,250.1
    c0,0.2-0.1,0.3-0.3,0.3h-5.4l0,0v-1.5c0-1.6,0.7-2.7,2.8-2.7c0.2,0,0.5,0,0.7,0c1.6,0.2,2.2,1.3,2.2,2.7V250.1z"></path>
                        <path class="st0" d="M-635.8,242.8c-1.5,0-3.1,0.1-4.5,0.3c-0.2,0-0.3,0.2-0.2,0.4l0.4,2.6c0,0.2,0.2,0.3,0.3,0.3
    c1.4-0.2,2.3-0.2,3.7-0.2c3.1,0,4.1,0.9,4.1,2.8v1.1c0,0.2-0.1,0.3-0.3,0.3h-4c-3.5,0-5.5,1.8-5.5,5c0,3,2.3,5.1,5.7,5.1
    c2.2,0,3-0.3,3.7-1c0.2-0.2,0.5,0,0.5,0.2v0.2c0,0.2,0.1,0.3,0.3,0.3h3.4c0.2,0,0.3-0.1,0.3-0.3V249
    C-627.9,244.8-630.8,242.8-635.8,242.8z M-632.1,253.8c0,2.1-1.5,3.6-3.7,3.6c-1.8,0-2.7-0.7-2.7-2.1c0-1.5,0.9-2.1,2.7-2.1h3.4
    c0.2,0,0.3,0.1,0.3,0.3V253.8z"></path>
                        <path class="st0" d="M-586.4,242.8c-1.5,0-3.1,0.1-4.5,0.3c-0.2,0-0.3,0.2-0.2,0.4l0.4,2.6c0,0.2,0.2,0.3,0.3,0.3
    c1.4-0.2,2.3-0.2,3.7-0.2c3.1,0,4.1,0.9,4.1,2.8v1.1c0,0.2-0.1,0.3-0.3,0.3h-4c-3.5,0-5.5,1.8-5.5,5c0,3,2.3,5.1,5.7,5.1
    c2.2,0,3-0.3,3.7-1c0.2-0.2,0.5,0,0.5,0.2v0.2c0,0.2,0.1,0.3,0.3,0.3h3.5c0.2,0,0.3-0.1,0.3-0.3V249
    C-578.4,244.8-581.4,242.8-586.4,242.8z M-582.7,253.8c0,2.1-1.5,3.6-3.7,3.6c-1.8,0-2.7-0.7-2.7-2.1c0-1.5,0.9-2.1,2.7-2.1h3.4
    c0.2,0,0.3,0.1,0.3,0.3C-582.7,253.5-582.7,253.8-582.7,253.8z"></path>
                        <path class="st1" d="M-424,260.4c-2.2,0-4.6-0.5-6.9-1.4l0.5-1.8c2.1,0.7,4.4,1.2,6.3,1.2c2.7,0,4.3-1.1,4.3-2.6
    c0-1.3-0.8-2-4.7-3.5c-4.4-1.6-5.9-2.8-5.9-5.4c0-2.8,2.3-4,6.4-4c1.8,0,4.3,0.3,6,0.9l-0.4,1.8c-1.7-0.4-3.7-0.7-5.5-0.7
    c-3,0-4.2,0.5-4.2,2c0,1.6,1.1,2.2,5.1,3.7c4.4,1.7,5.5,2.7,5.5,5.1C-417.4,258.5-420,260.4-424,260.4z"></path>
                        <g>
                            <path class="st1" d="M-462.7,260.3h-7.5c-1,0-1.6-0.4-1.9-0.7c-0.6-0.7-0.6-1.5-0.6-1.8v-15h1.8V258c0,0.1,0,0.3,0.1,0.4
      c0.1,0.1,0.4,0.2,0.5,0.2h7.5L-462.7,260.3L-462.7,260.3z"></path>
                        </g>
                        B <path class="st1" d="M-432.2,255.4c0-2.1-1-3.8-3.1-4.6c1.3-0.7,2.3-2,2.3-3.8c0-2.6-2-4.1-5.5-4.1h-7v14.5l0,0v0.4
    c0,0.2,0,1.1,0.6,1.8c0.3,0.4,0.9,0.7,1.9,0.7h4.9h0.1l0,0h0.3l0,0C-433.9,260.2-432.2,258-432.2,255.4z M-443.6,244.6h5.1
    c2.5,0,3.7,0.8,3.7,2.6s-1.2,3-3.5,3h-5.3L-443.6,244.6L-443.6,244.6z M-436.8,258.5h-6.2c-0.2,0-0.4,0-0.5-0.2
    c-0.1-0.1-0.1-0.4-0.1-0.4v-6h5.9c2.5,0,3.7,1.5,3.6,3.4C-434.2,257-435.1,258.2-436.8,258.5z"></path>
                    </g>
    </svg>
                <p id="logo-tagline" class="">We research. You level up.</p>
            </a>
        </div>
        <div id="mb-nav-icon" type="button" data-target="#navbar" data-toggle="collapse" role="button" aria-label="Open mobile menu" tabindex="0" aria-pressed="true" aria-haspopup="true" aria-expanded="false" aria-controls="navbar">&nbsp;
            <span class="firstline">&nbsp;</span>
            <span class="secondline">&nbsp;</span>
            <span class="thirdline">&nbsp;</span>
        </div>
        <div id="main-nav-menu">
            <div id="main-top-nav">
                <div class="navitem has-dropdown" data-submenu="personal-nav" tabindex="0" aria-haspopup="true" >
                    <span>Personal</span>
                    <div class="submenu">
                        <div class="submenu-container submenu-container-full">
                            <div class="submenu-box divider" role="menuitem">
                                <a href="javascript:void(0)"  data-submenu="personal-nav" tabindex="-1" class="main-nav-item nav-back-link"><span class="back-arrow"></span> Personal</a>
                                <div class="submenu-content">
                                    <ul>
                                        <li class="title" role="none">Security & Antivirus</li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/premium/" id="cta-navbar-windows-en-test" tabindex="-1">Malwarebytes for Windows</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/mac/" id="cta-navbar-mac-en-test" tabindex="-1">Malwarebytes for Mac</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/chromebook/" id="cta-navbar-chromebook-en-test" tabindex="-1">Malwarebytes for Chromebook</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/browserguard/" id="cta-navbar-browserguard-en-test" tabindex="-1">Malwarebytes Browser Guard</a></li>
                                        <li role="none"><a href="//www.malwarebytes.com/for-home/" id="cta-press-navbar-forhome-en-test" class="bold-link" tabindex="-1">Overview <img class="text-arrow" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="Arrow"></a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="submenu-box divider">
                                <div class="submenu-content">
                                    <ul>
                                        <li class="title" role="none">Security & Antivirus for Mobile</li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/android/" id="cta-navbar-android-en-test" tabindex="-1">Malwarebytes for Android</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/ios/" id="cta-navbar-ios-en-test" tabindex="-1">Malwarebytes for iOS</a></li>

                                        <li class="title" role="none">Online Privacy</li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/vpn/" id="cta-navbar-malwarebytes-privacy-en-test" tabindex="-1">Malwarebytes Privacy VPN</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="submenu-box divider">
                                <div class="submenu-content submenu-gradient">
                                    <ul>
                                        <li class="title" role="none">Get Started</li>
                                        <li role="none">
                                            <a href="//www.malwarebytes.com/for-home/products/" id="cta-navbar-viewall-en-test" class="bold-link" tabindex="-1">
                                                <img class="link-icon" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/icons/personal-icon.svg" alt="Personal Icon">
                                                Explore all Personal Products
                                            </a>
                                        </li>
                                        <li role="none">
                                            <a href="//www.malwarebytes.com/pricing/" id="cta-navbar-pricing-en-test" class="bold-link" tabindex="-1">
                                                <img class="link-icon" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/icons/pricing-icon.svg" alt="Pricing Icon">
                                                Explore Pricing
                                            </a>
                                        </li>
                                        <li role="none">
                                            <a id="cta-navbar-freedownload-personaldropdown-en-test" href="//www.malwarebytes.com/mwb-download/thankyou/" class="free-download link-box" tabindex="-1">
                                                <div>
                                                    <h4>Free Trial of Malwarebytes Premium</h4>
                                                    <p>Protect your devices, your data, and your privacy—at home or on the go.</p>
                                                    <span class="cta-text">Get free trial <img class="text-arrow" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="Arrow"></span>
                                                </div>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="navitem has-dropdown" data-submenu="business-nav" tabindex="0">
                    <span>Business</span>
                    <div id="business-nav" class="submenu">
                        <div class="submenu-container submenu-container-full">
                            <div class="submenu-box divider">
                                <a href="javascript:void(0)" data-submenu="business-nav" tabindex="-1" class="main-nav-item nav-back-link"><span class="back-arrow"></span> Business</a>
                                <div class="submenu-content">
                                    <ul>
                                        <li class="title" role="none">Security & Antivirus</li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/business/cloud/" id="cta-navbar-forbusiness-nebula-en-test" tabindex="-1">Malwarebytes Nebula - Cloud Hosted Security Platform</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/business/endpoint-protection/" id="cta-navbar-forbusiness-ep-en-test" tabindex="-1">Malwarebytes Endpoint Protection</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/business/edr/" id="cta-navbar-forbusiness-edr-en-test" tabindex="-1">Malwarebytes Endpoint Detection & Response</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/business/incident-response/" id="cta-navbar-forbusiness-ir-en-test" tabindex="-1">Malwarebytes Incident Response</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/business/crowdstrike/" id="cta-navbar-forbusiness-crowdstrike-en-test" tabindex="-1">Malwarebytes Remediation for CrowdStrike</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/business/teams/" id="cta-navbar-forbusiness-teams-en-test" tabindex="-1">Malwarebytes for Teams</a></li>
                                        <li class="title" role="none">Services</li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/business/services/malware-removal/" id="cta-navbar-forbusiness-malwareremovalservice-en-test" tabindex="-1">Malwarebytes Malware Removal</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="submenu-box divider">
                                <div class="submenu-content">
                                    <ul>
                                        <li class="title" role="none">Server Protection</li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/business/endpoint-protection/server-security/" id="cta-navbar-forbusiness-ep-server-security-en-test" tabindex="-1">Malwarebytes Endpoint Protection for Servers</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/business/edr/server-security/" id="cta-navbar-forbusiness-edr-server-security-en-test" tabindex="-1">Malwarebytes Endpoint Detection and Response for Servers</a></li>

                                        <li class="title" role="none">Solutions</li>
                                        <li class="subtitle" role="none">BUSINESS SOLUTIONS</li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/business/solutions/small-business/" id="cta-navbar-forbusiness-solutions-small-business-en-test" tabindex="-1">Small Business Antivirus</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/business/solutions/mid-market/" id="cta-navbar-forbusiness-solutions-mid-market-en-test" tabindex="-1">Secure Remote Workers</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/business/solutions/enterprise/" id="cta-navbar-forbusiness-solutions-enterprise-en-test" tabindex="-1">Enterprise Antivirus and Cybersecurity</a></li>

                                        <li class="subtitle" role="none">INDUSTRY SOLUTIONS</li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/education/" id="cta-navbar-forbusiness-education-en-test" tabindex="-1">Education</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/finance/" id="cta-navbar-forbusiness-finance-en-test" tabindex="-1">Finance</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/healthcare/" id="cta-navbar-forbusiness-healthcare-en-test" tabindex="-1">Healthcare</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="submenu-box divider">
                                <div class="submenu-content submenu-gradient">
                                    <ul>
                                        <li class="title" role="none">Get Started</li>
                                        <li role="none">
                                            <a href="//www.malwarebytes.com/business/" id="cta-navbar-forbusiness-en-test" class="bold-link" tabindex="-1">
                                                <img class="link-icon" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/icons/business-icon.svg" alt="Business Icon">
                                                Explore all Business Products
                                            </a>
                                        </li>
                                        <li role="none">
                                            <a href="//www.malwarebytes.com/pricing/business/" id="cta-navbar-forbusiness-pricing-en-test" class="bold-link" tabindex="-1">
                                                <img class="link-icon" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/icons/pricing-icon.svg" alt="Pricing Icon">
                                                Explore Pricing
                                            </a>
                                        </li>
                                        <li role="none">
                                            <a id="cta-navbar-businesstrial-businessdropdown-en-test" href="//www.malwarebytes.com/business/request_trial/?ref=nav" class="link-box" tabindex="-1">
                                                <div class="biz">
                                                    <h4>Get a Free Trial</h4>
                                                    <p>Secure your endpoints and servers with industry-leading protection, detection, and response solutions.</p>
                                                    <span class="cta-text">Get Started <img class="text-arrow" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="Arrow"></span>
                                                </div>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="navitem" tabindex="0">
                    <a href="//www.malwarebytes.com/pricing/" class="pricing-link" id="cta-navbar-pricing-en-test" ><span>Pricing</span></a>
                </div>
                <div class="navitem has-dropdown" data-submenu="partners-nav" tabindex="0">
                    <span>Partners</span>
                    <div id="partner-nav" class="submenu">
                        <div class="submenu-container">
                            <div class="submenu-box"></div>
                            <div class="submenu-box divider">
                                <a  href="javascript:void(0)" data-submenu="partner-nav" tabindex="-1" class="main-nav-item nav-back-link"><span class="back-arrow"></span> Partners</a>
                                <div class="submenu-content">
                                    <div class="submenu-content submenu-gradient">
                                        <ul>
                                            <li role="none">
                                                <a href="//www.malwarebytes.com/partners/" id="cta-navbar-partners-explore-partnerships-en-test" class="bold-link" tabindex="-1">
                                                    <img class="link-icon" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/icons/partner-icon.svg" alt="Partner Icon">
                                                    Explore Partnerships
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                    <ul class="submenu-content divider-top">
                                        <li class="title" role="none">Partner Solutions</li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/partners/solution-providers/" id="cta-navbar-partners-solution-providers-en-test" tabindex="-1">Resellers</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/partners/managed-service-providers/" id="cta-navbar-partners-managed-service-providers-en-test" tabindex="-1">Managed Service Providers</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/techbench/" id="cta-navbar-partners-computer-repair-en-test" tabindex="-1">Computer Repair</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/integrations/" id="cta-navbar-partners-tech-partnerships-en-test" tabindex="-1">Technology Partners</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="submenu-box divider">
                                <div class="submenu-content submenu-gradient">
                                    <ul>
                                        <li class="title" role="none">Partner Success Story</li>
                                        <li class="partner-highlight" role="none">
                                            <div>
                                                <img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/partners/optimus-systems.webp" onerror='this.onerror = null; this.src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/partners/optimus-systems.png"' alt="Optimus Systems Logo">
                                            </div>
                                            <div class="name">Marek Drummond</div>
                                            <div class="position">Managing Director at Optimus Systems</div>
                                            <p>"Thanks to the Malwarebytes MSP program, we have this high-quality product in our stack. It’s a great addition, and I have confidence that customers’ systems are protected."</p>
                                        </li>
                                        <li role="none"><a href="https://resources.malwarebytes.com/casestudy/optimus-systems-delivers-trusted-desktop-security-services-malwarebytes-managed-services-provider/" id="cta-navbar-partners-featured-optimus-en-test" class="bold-link" tabindex="-1">See full story <img class="text-arrow" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="Arrow"></a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="navitem has-dropdown" data-submenu="resources-nav" tabindex="0">
                    <span>Resources</span>
                    <div id="resources-nav" class="submenu">
                        <div class="submenu-container submenu-container-full">
                            <div class="submenu-box divider">
                                <a  href="javascript:void(0)" data-submenu="resources-nav" tabindex="-1" class="main-nav-item nav-back-link"><span class="back-arrow"></span> Resources</a>
                                <div class="submenu-content">
                                    <ul>
                                        <li class="title" role="none">Learn About Cybersecurity</li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/antivirus/" id="cta-navbar-resources-antivirus-en-test" tabindex="-1">Antivirus</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/malware/" id="cta-navbar-resources-malware-en-test" tabindex="-1">Malware</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/ransomware/" id="cta-navbar-resources-ransomware-en-test" tabindex="-1">Ransomware</a></li>
                                        <li role="none"><a href="//www.malwarebytes.com/cybersecurity/" id="cta-navbar-resources-pillarhub-en-test" class="bold-link" tabindex="-1">See all <img class="text-arrow" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="Arrow"></a></li>

                                        <li class="title" role="none">Malwarebytes Labs</li>
                                        <li role="none"><a href="https://blog.malwarebytes.com/" id="cta-navbar-resources-blog-en-test" class="bold-link" tabindex="-1">Explore <img class="text-arrow" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="Arrow"></a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="submenu-box divider">
                                <div class="submenu-content">
                                    <ul>
                                        <li class="title" role="none">Business Resources</li>
                                        <li class="link" role="none"><a href="https://resources.malwarebytes.com/#reviews" id="cta-navbar-resources-reviews-en-test" tabindex="-1">Reviews</a></li>
                                        <li class="link" role="none"><a href="https://resources.malwarebytes.com/#analyst-reports" id="cta-navbar-resources-analyst-reports-en-test" tabindex="-1">Analyst Reports</a></li>
                                        <li class="link" role="none"><a href="https://resources.malwarebytes.com/casestudies/" id="cta-navbar-resources-casestudies-en-test" tabindex="-1">Case Studies</a></li>
                                        <li role="none"><a href="https://resources.malwarebytes.com/" id="cta-navbar-resources-viewall-en-test" class="bold-link" tabindex="-1">See all <img class="text-arrow" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="Arrow"></a></li>

                                        <li class="title" role="none">Press & News</li>
                                        <li role="none"><a href="https://press.malwarebytes.com/" id="cta-navbar-resources-news-press-en-test" class="bold-link" tabindex="-1">Learn more <img class="text-arrow" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="Arrow"></a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="submenu-box divider">
                                <div class="submenu-content submenu-gradient">
                                    <ul>
                                        <li class="title" role="none">Events</li>
                                        <li>
                                            <img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/rsa2021.jpg" alt="RSA 2021" width="250px">
                                            <br><br>
                                            <p><span class="title">Featured Event:</span> RSA 2021</p>
                                        </li>
                                        <li role="none"><a href="https://www.rsaconference.com/usa" id="cta-navbar-resources-featured-rsa-en-text" class="bold-link" tabindex="-1">See Event <img class="text-arrow" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="Arrow"></a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="navitem has-dropdown" data-submenu="support-nav" tabindex="0">
                    <span>Support</span>
                    <div id="support-nav" class="submenu">
                        <div class="submenu-container">
                            <div class="submenu-box"></div>
                            <div class="submenu-box divider">
                                <a href="javascript:void(0)" data-submenu="support-nav" tabindex="-1" class="main-nav-item nav-back-link"><span class="back-arrow"></span> Support</a>
                                <div class="submenu-content">
                                    <ul class="submenu-content">
                                        <li class="title" role="none">Technical Support</li>
                                        <li class="link" role="none"><a href="https://support.malwarebytes.com/hc/en-us" id="cta-navbar-support-en-test" tabindex="-1">Support</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/business/services/" id="cta-navbar-support-business_services-en-test" tabindex="-1">Premium Services</a></li>
                                        <li class="link" role="none"><a href="https://forums.malwarebytes.com/" id="cta-navbar-support-forum-en-test" tabindex="-1">Forums</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/secure/" id="cta-navbar-support-vulnerability_disclosure-en-test" tabindex="-1">Vulnerability Disclosure</a></li>
                                    </ul>
                                    <div class="submenu-content submenu-gradient divider-top">
                                        <ul>
                                            <li role="none">
                                                <a href="https://www.youtube.com/channel/UCB7JQhkZpiyvGPufW2RPBoQ" id="cta-navbar-support-support_services-en-test" class="bold-link" tabindex="-1">
                                                    <img class="link-icon" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/icons/watch-personal-icon.svg" alt="Watch Icon">
                                                    Training for Personal Products
                                                </a>
                                            </li>
                                            <li role="none">
                                                <a href="//www.malwarebytes.com/business/academy/" id="cta-navbar-support-training_for_business-en-test" class="bold-link" tabindex="-1">
                                                    <img class="link-icon" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/icons/watch-business-icon.svg" alt="Watch Icon">
                                                    Training for Business Products
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="submenu-box divider">
                                <div class="submenu-content">
                                    <ul class="submenu-content submenu-gradient">
                                        <li class="title" role="none">Featured Content</li>
                                        <li role="none">
                                            <img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/privacy.svg" alt="Privacy Logo">
                                            <br>
                                            <br>
                                            <p>Activate Malwarebytes Privacy on Windows device.</p>
                                        </li>
                                        <li role="none"><a href="https://support.malwarebytes.com/hc/en-us/articles/360046199873-Activate-Malwarebytes-Privacy-on-Windows-device" id="cta-navbar-support-privacy_activation-en-test" class="bold-link" tabindex="-1">See Content <img class="text-arrow" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="Arrow"></a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div>
                  <a id="cta-navbar-freedownload-main-en-test" href="//www.malwarebytes.com/mwb-download/thankyou/" class="free-download nav-download-btn">FREE DOWNLOAD</a>
                </div>
            </div>
            <div id="main-util-nav">
                <div class="navitem-caps">
                    <a href="//www.malwarebytes.com/contact/" id="cta-navbar-company-contactus-en-test">CONTACT US</a>
                </div>
                <div class="navitem-caps has-dropdown" data-submenu="company-nav" tabindex="0">
                    <span>COMPANY</span>
                    <div id="company-nav" class="submenu">
                        <div class="submenu-container">
                            <div class="submenu-box">
                                <a href="javascript:void(0)" data-submenu="company-nav" tabindex="-1" class="main-nav-item nav-back-link"><span class="back-arrow"></span> Company</a>
                                <ul>
                                    <li class="link" role="none"><a href="//www.malwarebytes.com/company/" id="cta-utilbar-company-aboutus-en-test" tabindex="-1">About Malwarebytes</a></li>
                                    <li class="link" role="none"><a href="https://jobs.malwarebytes.com/" id="cta-utilbar-company-careers-en-test" tabindex="-1">Careers</a></li>
                                    <li class="link" role="none"><a href="https://press.malwarebytes.com/" id="cta-utilbar-company-news-press-en-test" tabindex="-1">News & Press</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="navitem-caps has-dropdown" data-submenu="signin-nav" tabindex="0">
                    <span>SIGN IN</span>
                    <div id="signin-nav" class="submenu">
                        <div class="submenu-container">
                            <div class="submenu-box">
                                <a href="javascript:void(0)" data-submenu="signin-nav" tabindex="-1" class="main-nav-item nav-back-link"><span class="back-arrow"></span> Sign In</a>
                                <ul>
                                    <li class="link" role="none">
                                        <a href="https://my.malwarebytes.com/en/login/" id="cta-utilbar-login-myaccount-en-test" tabindex="-1">My Account</a>
                                    </li>
                                    <li class="link" role="none">
                                        <a href="https://cloud.malwarebytes.com/" id="cta-utilbar-login-cloud-console-en-test" tabindex="-1">Cloud Console</a>
                                    </li>
                                    <li class="link">
                                        <a href="https://partners.malwarebytes.com/English/" id="cta-utilbar-partner-portal-en-test">Partner Portal</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</nav>

<div id="labs-sub-nav">
    <div class="container">
        <div class="row">
            <div class="col-md-4 col-xs-6" id="search-section">
                <form id="search-form" onsubmit="submitSearchrightrail(event)" method="get">
                    <div class="searchbar-wrap-rightrail">
                        <label for="cta-labs-rightrail-search-submit-en" aria-label="cta-labs-rightrail-search-submit-en" aria-labelledby="cta-labs-rightrail-search-submit-en">
                            <input type="text" id="st-search-input-rightrail" class="st-search-input-rightrail"
                            placeholder="Search Labs" />
                        </label>
                        <button type="submit" id="cta-labs-rightrail-search-submit-en" aria-label="Submit your search query" /><span class=""><img
                                src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/search.svg" alt="Magnifying glass"></span>
                    </div>

                </form>
            </div>
            <div class="col-md-offset-4 col-md-4 col-xs-6" id="social">
                <div class="left col-lg-6 col-md-8 col-sm-7">
                    <a href="https://www.malwarebytes.com/newsletter/?email=&source=labs"
                        class="subscribe-btn">SUBSCRIBE</a>
                    <a href="https://blog.malwarebytes.com/feed/" target="_blank" class="socicon-rss" aria-label="Subscribe to Malwarebytes Labs RSS Feed"></a>
                </div>
                <div class="right col-lg-5 col-md-4 col-sm-4 col-xs-9">
                    <a class="social socicon-facebook" href="https://www.facebook.com/Malwarebytes/"
                        id="social-follow-facebook" target="_blank" aria-label="Visit Malwarebytes on Facebook"></a>
                    <a class="social socicon-twitter" href="https://twitter.com/malwarebytes" id="social-follow-twitter"
                        target="_blank" aria-label="Visit Malwarebytes on Twitter"></a>
                    <a class="social socicon-linkedin" href="https://www.linkedin.com/company/malwarebytes"
                        id="social-follow-linkedin" target="_blank" aria-label="Visit Malwarebytes on LinkedIn"></a>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">  
  $(function () {

    var navlinks = document.getElementsByClassName('has-dropdown');
    var mainNav = document.getElementById('main-nav-menu');
    var navBackLinks = document.getElementsByClassName('nav-back-link');
    var currentOpenNav = null;

    window.isMac = navigator.platform.match(/(Mac)/i) ? true : false;
    window.isWindows = navigator.userAgent.match(/(Windows)/i) ? true : false;
    window.isAndroid = navigator.userAgent.match(/(Android)/i) ? true : false;
    window.isiPhone = navigator.platform.match(/(iPhone)/i) ? true : false;
    window.isiPad = navigator.platform.match(/(iPad)/i) ? true : false;
    window.isChromeOS = (/\bCrOS\b/.test(navigator.userAgent)) ? true : false;

    var freeDownloadLinkElms = document.getElementsByClassName('free-download');
    var freeDownloadLink = "https://www.malwarebytes.com/mwb-download/thankyou/";

    if (isMac == true) {
      freeDownloadLink = "https://www.malwarebytes.com/mac-download/";
    }
    else if (isiPad || isiPhone) {
      freeDownloadLink = "https://go.onelink.me/app/633d1f14";
    }
    else if (isAndroid) {
      freeDownloadLink = "https://go.onelink.me/app/516cebeb";
    }
    else if (isChromeOS) {
      freeDownloadLink = "https://go.onelink.me/app/fe20dca8";
    }

    for(var i=0; i < freeDownloadLinkElms.length; i++) {
      freeDownloadLinkElms[i].setAttribute('href', freeDownloadLink);
    }

    var outsideClickClose = function(e) {
      closeNav(currentOpenNav);
    };

    var openNav = function(newNav, currentNav) {
      closeNav(currentNav);
      newNav.classList.add('open');
      var subMenu = newNav.getElementsByClassName('submenu')[0];
      if(isSubmenuTooLong(subMenu)) {
        subMenu.classList.add('submenu-scroll');
      } else {
        subMenu.classList.remove('submenu-scroll');
      }
      window.addEventListener('click', outsideClickClose);
      return newNav;
    };

    var isSubmenuTooLong = function(subMenuElm) {
      var subMenuContainer = subMenuElm.getElementsByClassName('submenu-container')[0];
      var subMenuContainerHeight = subMenuContainer.offsetHeight;
      var windowHeightMinusNav = window.innerHeight - 100;
      if(windowHeightMinusNav < subMenuContainerHeight) {
        return true;
      }
      return false;
    }

    var closeNav = function(currentNav) {
      if(!currentNav) return;
      window.removeEventListener('click', outsideClickClose);
      currentNav.classList.remove('open');
      currentNav.blur();
      currentOpenNav = null;
    };

    for(var i=0; i < navlinks.length; i++) {
      var navItem = navlinks[i];

      navItem.addEventListener('click', function(event) {
        event.stopPropagation();

        if(currentOpenNav && this.dataset.submenu === currentOpenNav.dataset.submenu) return;

        console.log('click');
        currentOpenNav = openNav(this, currentOpenNav);

      });

    };

    for(var i=0; i < navBackLinks.length; i++) {
      var navBackItem = navBackLinks[i];

      navBackItem.addEventListener('click', function(event) {
        event.stopPropagation();
        console.log('back click');
        closeNav(currentOpenNav);
      });
    }

    document.getElementById('mb-nav-icon').addEventListener('click', function(e) {

      if(this.classList.contains('open')) {
        document.documentElement.style.overflow = null;
        this.classList.remove('open');
        mainNav.classList.remove('open');
        closeNav(currentOpenNav);
      } else {
        document.documentElement.style.overflow = 'hidden';
        this.classList.add('open');
        mainNav.classList.add('open');
      }

    });

    var b2bRegex = /^\/business\/|^\/pricing\/business\/|^\/education\/|^\/finance\/|^\/healthcare\/|^\/partners\//;

    if(b2bRegex.test(window.location.pathname)){
      $('.pricing-link').attr('href', '/pricing/business/');
    }

  })
</script>
 

 
<!--
Start of DoubleClick Floodlight Tag: Please do not remove
Activity name of this tag: security blog articles
URL of the webpage where the tag is expected to be placed: https://blog.malwarebytes.com/
This tag must be placed between the <body> and </body> tags, as close as possible to the opening tag.
Creation Date: 05/20/2016
-->
<script type="text/plain" class="optanon-category-4">
var axel = Math.random() + "";
var a = axel * 10000000000000;
$('body').append('<iframe src="https://5118230.fls.doubleclick.net/activityi;src=5118230;type=count0;cat=secur00;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num=' + a + '?" width="1" height="1" frameborder="0" style="display:none"></iframe>');
</script>
<noscript>
<iframe src="https://5118230.fls.doubleclick.net/activityi;src=5118230;type=count0;cat=secur00;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num=1?" width="1" height="1" frameborder="0" style="display:none"></iframe>
</noscript>
<!-- End of DoubleClick Floodlight Tag: Please do not remove -->


<div class="wrapper" id="post">
           

  
  
<article id="single-post" class="h-entry">
  <section>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://google.com/article"
  },
  "headline": "A deep dive into Phobos ransomware",
  "image": {
    "@type": "ImageObject",
    "url": "https://blog.malwarebytes.com/wp-content/uploads/2016/08/photodune-3043497-chain-locker-s-604x270.jpg",
    "height": 405,
    "width": 720
  },
  "datePublished": "July 24, 2019",
  "dateModified": "July 24, 2019",
  "author": {
    "@type": "Person",
    "name": "hasherezade"
  },
   "publisher": {
    "@type": "Organization",
    "name": "Malwarebytes",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.malwarebytes.com/images/mb-logo-2.png",
      "width": 600,
      "height": 60
    }
  },
  "description": "We take an in-depth look into Phobos ransomware which threat actors distribute via RDP and look at similarities with Dharma (AKA CrySis) ransomware."
}
</script>

<div class="container">
  <div class="row">

    <div class="col-md-8" id="content">
      <div>
          <P><img src="https://blog.malwarebytes.com/wp-content/uploads/2016/08/photodune-3043497-chain-locker-s-900x506.jpg" alt="A deep dive into Phobos ransomware"></P>
            <p class="breadcrumbs hidden-xs"><a href="https://blog.malwarebytes.com/category/threat-analysis/" rel="category tag">Threat analysis</a></p>
       <h1 class="entry-title p-name">
					A deep dive into Phobos ransomware				</h1>
      <p class="small">Posted: <span class="published"><time class="dt-published" datetime="July 24, 2019">July 24, 2019</time></span> by <span class="vcard author p-author h-card"><a href="https://blog.malwarebytes.com/author/hasherezade/" title="Posts by hasherezade" rel="author">hasherezade</a></span> 
       
       <!-- shows last modified date if modified from original post -->
                
      </p>
      <div class="entry-summary p-summary" style="display:none;">We take an in-depth look into Phobos ransomware which threat actors distribute via RDP and look at similarities with Dharma (AKA CrySis) ransomware.</div>
           <div class="post-content entry-content e-content" id="articleBody" itemprop="articleBody"> 
<p>Phobos ransomware appeared at the beginning of 2019. <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://www.coveware.com/blog/phobos-ransomware-distributed-dharma-crew" target="_blank">It has been noted </a>that this new strain of ransomware is strongly based on the previously known family: Dharma (a.k.a. CrySis), and probably <a rel="noreferrer noopener" aria-label="distributed by the same group as Dharma (opens in a new tab)" href="https://www.zdnet.com/article/new-phobos-ransomware-exploits-weak-security-to-hit-targets-around-the-world/" target="_blank">distributed by the same group as Dharma</a>. </p>



<p>While attribution is by no means conclusive, you can read more about potential links between Phobos and Dharma <a rel="noreferrer noopener" aria-label="here (opens in a new tab)" href="https://www.coveware.com/blog/phobos-ransomware-distributed-dharma-crew" target="_blank">here</a>, to include an intriguing connection with the XDedic marketplace.</p>



<p>Phobos is one of the ransomware that are distributed via hacked Remote Desktop (RDP) connections.  This isn&#8217;t surprising, as hacked RDP servers are a cheap commodity on the underground market, and can make for an attractive and cost efficient dissemination vector for threat groups.</p>



<p>In this post we will take a look at the implementation of the mechanisms used in Phobos ransomware, as well as at its internal similarity to Dharma.</p>



<h3 id="mce_25">Analyzed sample</h3>



<p><a href="https://www.virustotal.com/gui/file/a91491f45b851a07f91ba5a200967921bf796d38677786de51a4a8fe5ddeafd2/detection" target="_blank" rel="noreferrer noopener" aria-label="a91491f45b851a07f91ba5a200967921bf796d38677786de51a4a8fe5ddeafd2 (opens in a new tab)">a91491f45b851a07f91ba5a200967921bf796d38677786de51a4a8fe5ddeafd2</a></p>



<h3>Behavioral analysis</h3>



<p>This ransomware does not deploy any techniques of UAC bypass. When we try to run it manually, the UAC confirmation pops up:</p>



<figure class="wp-block-image"><img data-attachment-id="39389" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/uac_prompt/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/uac_prompt.png" data-orig-size="466,280" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="uac_prompt" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/uac_prompt-300x180.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/uac_prompt.png" loading="lazy" width="466" height="280" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/uac_prompt.png" alt="" class="wp-image-39389" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/uac_prompt.png 466w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/uac_prompt-300x180.png 300w" sizes="(max-width: 466px) 100vw, 466px" /></figure>



<p>If we accept it, the main process deploys another copy of itself, with elevated privileges. It also executes some commands via windows shell.</p>



<figure class="wp-block-image"><img data-attachment-id="39391" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/phobos_running/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/phobos_running.png" data-orig-size="679,52" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="phobos_running" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/phobos_running-300x23.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/phobos_running-600x46.png" loading="lazy" width="600" height="46" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/phobos_running-600x46.png" alt="" class="wp-image-39391" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/phobos_running-600x46.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/phobos_running-300x23.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/phobos_running.png 679w" sizes="(max-width: 600px) 100vw, 600px" /></figure>



<p>Ransom notes of two types are being dropped: .txt as well as .hta. After the encryption process is finished, the ransom note in the .hta form is popped up:</p>



<figure class="wp-block-image"><a href="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypted.png" data-rel="lightbox-image-0" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="39372" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/encrypted-11/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypted.png" data-orig-size="1920,986" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="encrypted" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypted-300x154.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypted-600x308.png" loading="lazy" width="1920" height="986" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypted.png" alt="" class="wp-image-39372" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypted.png 1920w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypted-300x154.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypted-600x308.png 600w" sizes="(max-width: 1920px) 100vw, 1920px" /></a><figcaption>Ransom note in the .hta version</figcaption></figure>



<figure class="wp-block-image"><a href="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ransom_info.png" data-rel="lightbox-image-1" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="39388" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/ransom_info/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ransom_info.png" data-orig-size="1009,98" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ransom_info" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ransom_info-300x29.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ransom_info-600x58.png" loading="lazy" width="1009" height="98" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ransom_info.png" alt="" class="wp-image-39388" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ransom_info.png 1009w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/ransom_info-300x29.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/ransom_info-600x58.png 600w" sizes="(max-width: 1009px) 100vw, 1009px" /></a><figcaption>Ransom note in the .txt version</figcaption></figure>



<p>Even after the initial ransom note is popped up, the malware still runs in the background, and keeps encrypting newly created files. </p>



<p>All local disks, as well as network shares are attacked.</p>



<p>It also uses several persistence mechanisms: installs itself in %APPDATA% and in a Startup folder, adding the registry keys to autostart its process when the system is restarted.</p>



<figure class="wp-block-image"><img data-attachment-id="39498" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/persistence-7/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/persistence.png" data-orig-size="799,182" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="persistence" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/persistence-300x68.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/persistence-600x137.png" loading="lazy" width="799" height="182" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/persistence.png" alt="" class="wp-image-39498" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/persistence.png 799w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/persistence-300x68.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/persistence-600x137.png 600w" sizes="(max-width: 799px) 100vw, 799px" /><figcaption>A view from Sysinternals&#8217; Autoruns</figcaption></figure>



<p>Those mechanisms make Phobos ransomware very aggressive: the infection didn&#8217;t end on a single run, but can be repeated multiple times. To prevent repeated infection, we should remove all the persistence mechanisms as soon as we noticed that we got attacked by Phobos.</p>



<h4>The Encryption Process</h4>



<p>The ransomware is able to encrypt files without an internet connection (at this point we can guess that it comes with some hardcoded public key). Each file is encrypted with an individual key or an initialization vector: the same plaintext generates a different ciphertext.</p>



<p>It encrypts a variety of files, including executables. The encrypted files have an e-mail of the attacker added. The particular variant of Phobos also adds an extension &#8216;.acute&#8217; &#8211; however in different variants different extensions have been encountered. The general pattern is: <code>&lt;original name&gt;.id[&lt;victim ID&gt;-&lt;version ID&gt;][&lt;attacker's e-mail&gt;].&lt;added extention&gt;</code></p>



<figure class="wp-block-image"><img data-attachment-id="39390" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/encrypted_samples/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypted_samples.png" data-orig-size="433,76" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="encrypted_samples" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypted_samples-300x53.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypted_samples.png" loading="lazy" width="433" height="76" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypted_samples.png" alt="" class="wp-image-39390" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypted_samples.png 433w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypted_samples-300x53.png 300w" sizes="(max-width: 433px) 100vw, 433px" /></figure>



<p>Visualization of the encrypted content does not display any recognizable patterns. It suggests that either a stream cipher, or a cipher with chained blocks was used (possibly <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation" target="_blank">AES in CBC mode</a>). Example &#8211; a simple BMP before and after encryption:</p>



<figure class="wp-block-image"><img src="https://blog.malwarebytes.com/wp-content/uploads/2016/03/enc_square1.png" alt="" /></figure>



<figure class="wp-block-image"><img data-attachment-id="39392" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/enc_square2-bmp-id448d3b2b-1096-lockhelpqq-com-acute/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/enc_square2.bmp_.id448D3B2B-1096.lockhelp@qq.com_.acute_.png" data-orig-size="219,219" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="enc_square2.bmp.id[448D3B2B-1096].[lockhelp@qq.com].acute" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/enc_square2.bmp_.id448D3B2B-1096.lockhelp@qq.com_.acute_.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/enc_square2.bmp_.id448D3B2B-1096.lockhelp@qq.com_.acute_.png" loading="lazy" width="219" height="219" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/enc_square2.bmp_.id448D3B2B-1096.lockhelp@qq.com_.acute_.png" alt="" class="wp-image-39392" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/enc_square2.bmp_.id448D3B2B-1096.lockhelp@qq.com_.acute_.png 219w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/enc_square2.bmp_.id448D3B2B-1096.lockhelp@qq.com_.acute_-150x150.png 150w" sizes="(max-width: 219px) 100vw, 219px" /></figure>



<p>When we look inside the encrypted file, we can see a particular block at the end. It is separated from the encrypted content by &#8216;0&#8217; bytes padding. The first 16 bytes of this block are unique per each file (possible Initialization Vector). Then comes the block of 128 bytes that is the same in each file from the same infection. That possibly means that this block contains the encrypted key, that is uniquely generated each run. At the end we can find a 6-character long keyword which is typical for this ransomware. In this case it is &#8216;LOCK96&#8217;, however, different versions of Phobos have been observed with different keywords, i.e. &#8216;DAT260&#8217;.</p>



<figure class="wp-block-image"><img data-attachment-id="39395" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/ending_block/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block.png" data-orig-size="606,227" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ending_block" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block-300x112.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block-600x225.png" loading="lazy" width="600" height="225" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block-600x225.png" alt="" class="wp-image-39395" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block-600x225.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block-300x112.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block-604x227.png 604w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block.png 606w" sizes="(max-width: 600px) 100vw, 600px" /></figure>



<p>In order to fully understand the encryption process, we will look inside the code.</p>



<h3>Inside</h3>



<p>In contrast to most of the malware that comes protected by some crypter, Phobos is not packed or obfuscated. Although the lack of packing is not common in general population of malware, it is common among malware that are distributed manually by the attackers.</p>



<p>The execution starts in WinMain function:</p>



<figure class="wp-block-image"><img data-attachment-id="39447" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/start-4/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/start.png" data-orig-size="775,193" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="start" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/start-300x75.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/start-600x149.png" loading="lazy" width="775" height="193" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/start.png" alt="" class="wp-image-39447" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/start.png 775w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/start-300x75.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/start-600x149.png 600w" sizes="(max-width: 775px) 100vw, 775px" /></figure>



<p>During its execution, Phobos starts several threads, responsible for its different actions, such as: killing blacklisted processes, deploying commands from commandline, encrypting accessible drives and network shares.</p>



<h4>Used obfuscation</h4>



<p>The code of the ransomware is not packed or obfuscated. However, some constants, including strings, are protected by AES and decrypted on demand. A particular string can be requested by its index, for example:</p>



<figure class="wp-block-image"><img data-attachment-id="39569" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/decrypt_buffer/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypt_buffer.png" data-orig-size="405,58" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="decrypt_buffer" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypt_buffer-300x43.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypt_buffer.png" loading="lazy" width="405" height="58" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypt_buffer.png" alt="" class="wp-image-39569" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypt_buffer.png 405w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypt_buffer-300x43.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypt_buffer-400x58.png 400w" sizes="(max-width: 405px) 100vw, 405px" /></figure>



<p>The AES key used for this purpose is hardcoded (in obfuscated form), and imported each time when a chunk of data needs to be decrypted. </p>



<figure class="wp-block-image"><img data-attachment-id="39572" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/aes_key-4/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/aes_key.png" data-orig-size="626,66" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="aes_key" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/aes_key-300x32.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/aes_key-600x63.png" loading="lazy" width="626" height="66" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/aes_key.png" alt="" class="wp-image-39572" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/aes_key.png 626w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/aes_key-300x32.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/aes_key-600x63.png 600w" sizes="(max-width: 626px) 100vw, 626px" /><figcaption>Decrypted content of the AES key</figcaption></figure>



<p>The Initialization Vector is set to 16 NULL bytes.<br />The code responsible for loading the AES key is given below. The function wraps the key into a <a rel="noreferrer noopener" href="https://docs.microsoft.com/en-us/windows/win32/api/wincrypt/ns-wincrypt-publickeystruc" target="_blank">BLOBHEADER</a> structure, which is then imported.</p>



<figure class="wp-block-image"><img data-attachment-id="39415" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/import_key-2/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/import_key.png" data-orig-size="601,371" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="import_key" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/import_key-300x185.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/import_key-600x370.png" loading="lazy" width="601" height="371" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/import_key.png" alt="" class="wp-image-39415" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/import_key.png 601w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/import_key-300x185.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/import_key-600x370.png 600w" sizes="(max-width: 601px) 100vw, 601px" /></figure>



<p>From the <a rel="noreferrer noopener" aria-label="BLOBHEADER (opens in a new tab)" href="https://docs.microsoft.com/en-us/windows/win32/api/wincrypt/ns-wincrypt-publickeystruc" target="_blank">BLOBHEADER</a> structure we can read the following information: 0x8 &#8211; PLAINTEXTKEYBLOB, 0x2=CUR_BLOB_VERSION, 0x6610 &#8211; CALG_AES_256.</p>



<p>Example of a decrypted string:</p>



<figure class="wp-block-image"><img data-attachment-id="39431" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/decrypted_string/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypted_string.png" data-orig-size="524,200" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="decrypted_string" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypted_string-300x115.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypted_string.png" loading="lazy" width="524" height="200" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypted_string.png" alt="" class="wp-image-39431" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypted_string.png 524w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypted_string-300x115.png 300w" sizes="(max-width: 524px) 100vw, 524px" /></figure>



<p>Among the decrypted strings we can also see the list of the attacked extensions</p>



<figure class="wp-block-image"><img data-attachment-id="39432" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/extensions-5/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/extensions.png" data-orig-size="456,116" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="extensions" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/extensions-300x76.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/extensions.png" loading="lazy" width="456" height="116" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/extensions.png" alt="" class="wp-image-39432" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/extensions.png 456w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/extensions-300x76.png 300w" sizes="(max-width: 456px) 100vw, 456px" /></figure>



<p>We can also find a list of some keywords:</p>



<p><code>acute actin Acton actor Acuff Acuna acute adage Adair Adame banhu banjo Banks Banta Barak Caleb Cales Caley calix Calle Calum Calvo deuce Dever devil Devoe Devon Devos dewar eight eject eking Elbie elbow elder phobos help blend bqux com mamba KARLOS DDoS phoenix PLUT karma bbc CAPITAL</code></p>



<p>These are a list of possible extensions used by this ransomware. They are (probably) used to recognize and skip the files which already has been encrypted by a ransomware from this family. The extension that will be used in the current encryption round is hardcoded.</p>



<p>One of the encrypted strings specifies the formula for the file extension, that is later filled with the Victim ID:</p>



<p><code>UNICODE ".id[&lt;unique ID&gt;-1096].[lockhelp@qq.com].acute"</code></p>



<h4>Killing processes</h4>



<p>The ransomware comes with a list of processes that it kills before the encryption is deployed. Just like other strings, the full list is decrypted on demand:</p>



<pre class="wp-block-preformatted">msftesql.exe sqlagent.exe sqlbrowser.exe sqlservr.exe sqlwriter.exe<br />oracle.exe ocssd.exe dbsnmp.exe synctime.exe agntsvc.exe<br />mydesktopqos.exe isqlplussvc.exe xfssvccon.exe mydesktopservice.exe <br />ocautoupds.exe agntsvc.exe agntsvc.exe agntsvc.exe encsvc.exe <br />firefoxconfig.exe tbirdconfig.exe ocomm.exe mysqld.exe mysqld-nt.exe <br />mysqld-opt.exe dbeng50.exe sqbcoreservice.exe excel.exe infopath.exe <br />msaccess.exe mspub.exe onenote.exe outlook.exe powerpnt.exe steam.exe <br />thebat.exe thebat64.exe thunderbird.exe visio.exe winword.exe <br />wordpad.exe</pre>



<p>Those processes are killed so that they will not block access to the files that are going to be encrypted.</p>



<figure class="wp-block-image"><img data-attachment-id="39539" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/kill_blacklisted/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/kill_blacklisted.png" data-orig-size="404,556" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="kill_blacklisted" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/kill_blacklisted-218x300.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/kill_blacklisted.png" loading="lazy" width="404" height="556" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/kill_blacklisted.png" alt="" class="wp-image-39539" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/kill_blacklisted.png 404w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/kill_blacklisted-218x300.png 218w" sizes="(max-width: 404px) 100vw, 404px" /><figcaption>a fragment of the function enumerating and killing processes</figcaption></figure>



<h4 id="mce_100">Deployed commands</h4>



<p>The ransomware deploys several commands from the commandline. Those commands are supposed to prevent from recovering encrypted files from any backups.</p>



<p>Deleting the shadow copies:</p>



<pre class="wp-block-preformatted">vssadmin delete shadows /all /quiet<br />wmic shadowcopy delete</pre>



<p>Changing Bcdedit options (preventing booting the system in a recovery mode):</p>



<pre class="wp-block-preformatted">bcdedit /set {default} bootstatuspolicy ignoreallfailures<br />bcdedit /set {default} recoveryenabled no</pre>



<p>Deletes the backup catalog on the local computer:</p>



<pre class="wp-block-preformatted">wbadmin delete catalog -quiet</pre>



<p>It also disables firewall:</p>



<pre class="wp-block-preformatted">netsh advfirewall set currentprofile state off<br />netsh firewall set opmode mode=disable<br />exit</pre>



<h4>Attacked targets</h4>



<p>Before the Phobos starts its malicious actions, it checks system locale (using <a rel="noreferrer noopener" aria-label="GetLocaleInfoW (opens in a new tab)" href="https://docs.microsoft.com/en-us/windows/win32/api/winnls/nf-winnls-getlocaleinfow" target="_blank">GetLocaleInfoW</a> options: <a rel="noreferrer noopener" aria-label="LOCALE_SYSTEM_DEFAULT (opens in a new tab)" href="https://docs.microsoft.com/en-us/windows/win32/intl/locale-system-default" target="_blank">LOCALE_SYSTEM_DEFAULT</a>, <a rel="noreferrer noopener" aria-label="LOCALE_FONTSIGNATURE (opens in a new tab)" href="https://www.pinvoke.net/default.aspx/Enums/LCType.html" target="_blank">LOCALE_FONTSIGNATURE</a> ). It terminates execution in case if the 9th bit of the output is cleared. The 9th bit represent Cyrlic alphabets &#8211; so, the systems that have set it as default are not affected.</p>



<figure class="wp-block-image"><img data-attachment-id="39638" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/checking_locale/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/checking_locale.png" data-orig-size="747,108" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="checking_locale" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/checking_locale-300x43.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/checking_locale-600x87.png" loading="lazy" width="747" height="108" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/checking_locale.png" alt="" class="wp-image-39638" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/checking_locale.png 747w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/checking_locale-300x43.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/checking_locale-600x87.png 600w" sizes="(max-width: 747px) 100vw, 747px" /></figure>



<p>Both local drives and network shares are encrypted.</p>



<p>Before the encryption starts, Phobos lists all the files, and  compare their names against the hardcoded lists. The lists are stored inside the binary in AES encrypted form, strings are separated by the delimiter &#8216;;&#8217;.</p>



<figure class="wp-block-image"><img data-attachment-id="39637" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/phobos_lists/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/phobos_lists.png" data-orig-size="432,218" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="phobos_lists" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/phobos_lists-300x151.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/phobos_lists.png" loading="lazy" width="432" height="218" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/phobos_lists.png" alt="" class="wp-image-39637" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/phobos_lists.png 432w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/phobos_lists-300x151.png 300w" sizes="(max-width: 432px) 100vw, 432px" /><figcaption>Fragment of the function decrypting and parsing the hardcoded lists</figcaption></figure>



<p>Among those lists, we can find i.e. blacklist (those files will be skipped). Those files are related to operating system, plus the info.txt, info.hta files are the names of the Phobos ransom notes:</p>



<p><code>info.hta<br />info.txt<br />boot.ini<br />bootfont.bin<br />ntldr<br />ntdetect.com<br />io.sys</code></p>



<p>There is also a list of directories to be skipped &#8211; in the analyzed case it contains only one directory: <code>C:\Windows</code>.</p>



<p>Among the skipped files are also the extensions that are used by Phobos variants, that were mentioned before.</p>



<p>There is also a pretty long whitelist of extensions:</p>



<p><code>1cd 3ds 3fr 3g2 3gp 7z accda accdb accdc accde accdt accdw adb adp ai ai3 ai4 ai5 ai6 ai7 ai8 anim arw as asa asc ascx asm asmx asp aspx asr asx avi avs backup bak bay bd bin bmp bz2 c cdr cer cf cfc cfm cfml cfu chm cin class clx config cpp cr2 crt crw cs css csv cub dae dat db dbf dbx dc3 dcm dcr der dib dic dif divx djvu dng doc docm docx dot dotm dotx dpx dqy dsn dt dtd dwg dwt dx dxf edml efd elf emf emz epf eps epsf epsp erf exr f4v fido flm flv frm fxg geo gif grs gz h hdr hpp hta htc htm html icb ics iff inc indd ini iqy j2c j2k java jp2 jpc jpe jpeg jpf jpg jpx js jsf json jsp kdc kmz kwm lasso lbi lgf lgp log m1v m4a m4v max md mda mdb mde mdf mdw mef mft mfw mht mhtml mka mkidx mkv mos mov mp3 mp4 mpeg mpg mpv mrw msg mxl myd myi nef nrw obj odb odc odm odp ods oft one onepkg onetoc2 opt oqy orf p12 p7b p7c pam pbm pct pcx pdd pdf pdp pef pem pff pfm pfx pgm php php3 php4 php5 phtml pict pl pls pm png pnm pot potm potx ppa ppam ppm pps ppsm ppt pptm pptx prn ps psb psd pst ptx pub pwm pxr py qt r3d raf rar raw rdf rgbe rle rqy rss rtf rw2 rwl safe sct sdpx shtm shtml slk sln sql sr2 srf srw ssi st stm svg svgz swf tab tar tbb tbi tbk tdi tga thmx tif tiff tld torrent tpl txt u3d udl uxdc vb vbs vcs vda vdr vdw vdx vrp vsd vss vst vsw vsx vtm vtml vtx wb2 wav wbm wbmp wim wmf wml wmv wpd wps x3f xl xla xlam xlk xlm xls xlsb xlsm xlsx xlt xltm xltx xlw xml xps xsd xsf xsl xslt xsn xtp xtp2 xyze xz zip</code></p>



<h4>How does the encryption work</h4>



<p>Phobos uses the WindowsCrypto API for encryption of files. There are several parallel threads to deploy encryption on each accessible disk or a network share.</p>



<figure class="wp-block-image"><img data-attachment-id="39428" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/create_encrypting_thread/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/create_encrypting_thread.png" data-orig-size="431,167" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="create_encrypting_thread" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/create_encrypting_thread-300x116.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/create_encrypting_thread.png" loading="lazy" width="431" height="167" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/create_encrypting_thread.png" alt="" class="wp-image-39428" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/create_encrypting_thread.png 431w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/create_encrypting_thread-300x116.png 300w" sizes="(max-width: 431px) 100vw, 431px" /><figcaption>Deploying the encrypting thread</figcaption></figure>



<p>AES key is created prior to the encrypting thread being run, and it is passed in the thread parameter.</p>



<figure class="wp-block-image"><img data-attachment-id="39456" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/encrypt_logical_drives/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt_logical_drives.png" data-orig-size="591,428" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="encrypt_logical_drives" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt_logical_drives-300x217.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt_logical_drives.png" loading="lazy" width="591" height="428" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt_logical_drives.png" alt="" class="wp-image-39456" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt_logical_drives.png 591w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt_logical_drives-300x217.png 300w" sizes="(max-width: 591px) 100vw, 591px" /></figure>



<p>Fragment of the key generation function:</p>



<figure class="wp-block-image"><img data-attachment-id="39540" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/make_aes_key-3/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/make_aes_key.png" data-orig-size="523,301" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="make_aes_key" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/make_aes_key-300x173.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/make_aes_key.png" loading="lazy" width="523" height="301" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/make_aes_key.png" alt="" class="wp-image-39540" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/make_aes_key.png 523w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/make_aes_key-300x173.png 300w" sizes="(max-width: 523px) 100vw, 523px" /><figcaption>Calling the function generating the AES key (32 bytes)</figcaption></figure>



<p>Although the AES key is common to all the files that are encrypted in a single round, yet, each file is encrypted with a different initialization vector. The initialization vector is 16 bytes long,  generated just before the file is open, and then passed to the encrypting function:</p>



<figure class="wp-block-image"><img data-attachment-id="39544" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/before_encrypt_file-2/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/before_encrypt_file-1.png" data-orig-size="316,212" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="before_encrypt_file" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/before_encrypt_file-1-300x201.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/before_encrypt_file-1.png" loading="lazy" width="316" height="212" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/before_encrypt_file-1.png" alt="" class="wp-image-39544" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/before_encrypt_file-1.png 316w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/before_encrypt_file-1-300x201.png 300w" sizes="(max-width: 316px) 100vw, 316px" /><figcaption>Calling the function generating the AES IV (16 bytes)</figcaption></figure>



<p>Underneath, the AES key and the Initialization Vector both are generated with the help of the same function, that is a wrapper of <code>CryptGenRandom</code> (a strong random generator):</p>



<figure class="wp-block-image"><img data-attachment-id="39542" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/get_random_val/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/get_random_val.png" data-orig-size="635,128" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="get_random_val" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/get_random_val-300x60.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/get_random_val-600x121.png" loading="lazy" width="635" height="128" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/get_random_val.png" alt="" class="wp-image-39542" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/get_random_val.png 635w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/get_random_val-300x60.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/get_random_val-600x121.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/get_random_val-630x128.png 630w" sizes="(max-width: 635px) 100vw, 635px" /></figure>



<p>The AES IV is later appended to the content of the encryped file in a cleartext form. We can see it on the following example:</p>



<p>Before the file encryption function is executed, the random IV is being generated:<br /></p>



<figure class="wp-block-image"><img data-attachment-id="39439" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/random_key-2/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/random_key.png" data-orig-size="465,228" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="random_key" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/random_key-300x147.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/random_key.png" loading="lazy" width="465" height="228" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/random_key.png" alt="" class="wp-image-39439" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/random_key.png 465w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/random_key-300x147.png 300w" sizes="(max-width: 465px) 100vw, 465px" /></figure>



<p>The AES key, that was passed to the thread is being imported to the context (<code>CryptImportKey</code>), as well the IV is being set. We can see that the read file content is encrypted:</p>



<figure class="wp-block-image"><img data-attachment-id="39440" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/encrypt/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt.png" data-orig-size="479,215" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="encrypt" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt-300x135.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt.png" loading="lazy" width="479" height="215" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt.png" alt="" class="wp-image-39440" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt.png 479w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt-300x135.png 300w" sizes="(max-width: 479px) 100vw, 479px" /></figure>



<p>After the content of the file is encrypted, it is being saved into the newly created file, with the ransomware extension.</p>



<figure class="wp-block-image"><img data-attachment-id="39442" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/saved_into_file-2/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/saved_into_file-1.png" data-orig-size="602,132" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="saved_into_file" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/saved_into_file-1-300x66.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/saved_into_file-1-600x132.png" loading="lazy" width="602" height="132" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/saved_into_file-1.png" alt="" class="wp-image-39442" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/saved_into_file-1.png 602w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/saved_into_file-1-300x66.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/saved_into_file-1-600x132.png 600w" sizes="(max-width: 602px) 100vw, 602px" /></figure>



<p>The ransomware creates a block with metadata, including checksums, and the original file name. After this block, the random IV is being stored, and finally, the block containing the encrypted AES key. The last element is the file marker: &#8220;LOCK96&#8221;:</p>



<figure class="wp-block-image"><img data-attachment-id="39444" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/next_block/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/next_block.png" data-orig-size="453,176" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="next_block" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/next_block-300x117.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/next_block.png" loading="lazy" width="453" height="176" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/next_block.png" alt="" class="wp-image-39444" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/next_block.png 453w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/next_block-300x117.png 300w" sizes="(max-width: 453px) 100vw, 453px" /></figure>



<p>Before being written to the file, the metadata block is  being encrypted using the same AES key and IV as the file content.</p>



<figure class="wp-block-image"><img data-attachment-id="39443" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/imported_aes_key/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/imported_aes_key.png" data-orig-size="548,325" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="imported_aes_key" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/imported_aes_key-300x178.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/imported_aes_key.png" loading="lazy" width="548" height="325" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/imported_aes_key.png" alt="" class="wp-image-39443" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/imported_aes_key.png 548w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/imported_aes_key-300x178.png 300w" sizes="(max-width: 548px) 100vw, 548px" /><figcaption>setting the AES key before encrypting the metadata block</figcaption></figure>



<p>Encrypted metadata block:</p>



<figure class="wp-block-image"><img data-attachment-id="39445" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/encrypted_block/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypted_block.png" data-orig-size="450,159" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="encrypted_block" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypted_block-300x106.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypted_block.png" loading="lazy" width="450" height="159" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypted_block.png" alt="" class="wp-image-39445" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypted_block.png 450w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypted_block-300x106.png 300w" sizes="(max-width: 450px) 100vw, 450px" /></figure>



<p>Finally, the content is appended to the end of the newly created file:</p>



<figure class="wp-block-image"><img data-attachment-id="39446" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/file_content/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/file_content.png" data-orig-size="601,424" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="file_content" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/file_content-300x212.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/file_content-600x423.png" loading="lazy" width="601" height="424" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/file_content.png" alt="" class="wp-image-39446" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/file_content.png 601w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/file_content-300x212.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/file_content-600x423.png 600w" sizes="(max-width: 601px) 100vw, 601px" /></figure>



<p>Being a ransomware researcher, the common question that we want to answer is whether or not the ransomware is decryptable &#8211; meaning, if it contains the weakness allowing to recover the files without paying the ransom. The first thing to look at is how the encryption of the files is implemented. Unfortunately, as we can see from the above analysis, the used encryption algorithm is secure. It is AES, with a random key and initialization vector, both created by a secure random generator. The used implementation is also valid: the authors decided to use the Windows Crypto API.</p>



<h4 id="mce_22">Encrypting big files</h4>



<p>Phobos uses a different algorithm to encrypt big files (above 0x180000 bytes long). The algorithm explained above was used for encrypting files of typical size (in such case the full file was encrypted, from the beginning to the end). In case of big files, the main algorithm is similar, however only some parts of the content are selected for encryption.</p>



<figure class="wp-block-image"><img data-attachment-id="39645" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/encrypt_vs_size/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt_vs_size.png" data-orig-size="743,346" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="encrypt_vs_size" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt_vs_size-300x140.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt_vs_size-600x279.png" loading="lazy" width="743" height="346" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt_vs_size.png" alt="" class="wp-image-39645" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt_vs_size.png 743w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt_vs_size-300x140.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt_vs_size-600x279.png 600w" sizes="(max-width: 743px) 100vw, 743px" /></figure>



<p>We can see it on the following example. The file &#8216;test.bin&#8217; was filled with 0xAA bytes. Its original size was 0x77F87FF:</p>



<figure class="wp-block-image"><img data-attachment-id="39647" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/file_end-2/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/file_end-1.png" data-orig-size="636,297" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="file_end" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/file_end-1-300x140.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/file_end-1-600x280.png" loading="lazy" width="600" height="280" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/file_end-1-600x280.png" alt="" class="wp-image-39647" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/file_end-1-600x280.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/file_end-1-300x140.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/file_end-1.png 636w" sizes="(max-width: 600px) 100vw, 600px" /></figure>



<p>After being encrypted with Phobos, we see the following changes:</p>



<figure class="wp-block-image"><img data-attachment-id="39648" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/whipped_fragments/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/whipped_fragments.png" data-orig-size="706,214" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="whipped_fragments" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/whipped_fragments-300x91.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/whipped_fragments-600x182.png" loading="lazy" width="600" height="182" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/whipped_fragments-600x182.png" alt="" class="wp-image-39648" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/whipped_fragments-600x182.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/whipped_fragments-300x91.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/whipped_fragments.png 706w" sizes="(max-width: 600px) 100vw, 600px" /></figure>



<p>Some fragments of the file has been left unencrypted. Between of them, starting from the beginning, some fragments are wiped. Some random-looking block of bytes has been appended to the end of the file, after the original size. We can guess that this is the encrypted content of the wiped fragments. At the very end of the file, we can see a block of data typical for Phobos::</p>



<figure class="wp-block-image"><img data-attachment-id="39649" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/big_file_end/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/big_file_end.png" data-orig-size="708,270" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="big_file_end" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/big_file_end-300x114.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/big_file_end-600x229.png" loading="lazy" width="600" height="229" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/big_file_end-600x229.png" alt="" class="wp-image-39649" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/big_file_end-600x229.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/big_file_end-300x114.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/big_file_end.png 708w" sizes="(max-width: 600px) 100vw, 600px" /></figure>



<p>Looking inside we can see the reason of such an alignment. Only 3 chunks from the large file are being read into a buffer. Each chunk is 0x40000 bytes long:</p>



<figure class="wp-block-image"><img data-attachment-id="39656" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/reading_chunks/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/reading_chunks.png" data-orig-size="667,703" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="reading_chunks" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/reading_chunks-285x300.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/reading_chunks-569x600.png" loading="lazy" width="667" height="703" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/reading_chunks.png" alt="" class="wp-image-39656" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/reading_chunks.png 667w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/reading_chunks-285x300.png 285w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/reading_chunks-569x600.png 569w" sizes="(max-width: 667px) 100vw, 667px" /></figure>



<p>All read chunks are merged together into one buffer. After this content, usual metadata (checksums, original file name) are added, and the full buffer is encrypted:</p>



<figure class="wp-block-image"><img data-attachment-id="39657" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/encrypt_chunk_buf/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt_chunk_buf.png" data-orig-size="636,306" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="encrypt_chunk_buf" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt_chunk_buf-300x144.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt_chunk_buf-600x289.png" loading="lazy" width="600" height="289" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt_chunk_buf-600x289.png" alt="" class="wp-image-39657" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt_chunk_buf-600x289.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt_chunk_buf-300x144.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/encrypt_chunk_buf.png 636w" sizes="(max-width: 600px) 100vw, 600px" /></figure>



<p>By this way, authors of Phobos tried to minimize the time taken for encryption of large files, and at the same time maximize the damage done.</p>



<h4 id="mce_24">How is the AES key protected</h4>



<p>The next element that we need to check in order to analyze decryptability is the way in which the authors decided to store the generated key. </p>



<p>In case of Phobos, the AES key is encrypted just after being created. Its encrypted form is later appended at the end of the attacked file (in the aforementioned block of 128 bytes). Let&#8217;s take a closer look at the function responsible for encrypting the AES key.</p>



<figure class="wp-block-image"><img data-attachment-id="39574" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/to_make_aes/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/to_make_aes.png" data-orig-size="509,51" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="to_make_aes" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/to_make_aes-300x30.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/to_make_aes.png" loading="lazy" width="509" height="51" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/to_make_aes.png" alt="" class="wp-image-39574" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/to_make_aes.png 509w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/to_make_aes-300x30.png 300w" sizes="(max-width: 509px) 100vw, 509px" /></figure>



<p>The function generating and protecting the AES key is deployed before the each encrypting thread is started. Looking inside, we can see that first several variables are decrypted, in the same way as the aforementioned strings. </p>



<figure class="wp-block-image"><img data-attachment-id="39575" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/decrypting_buffers/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypting_buffers.png" data-orig-size="731,315" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="decrypting_buffers" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypting_buffers-300x129.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypting_buffers-600x259.png" loading="lazy" width="731" height="315" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypting_buffers.png" alt="" class="wp-image-39575" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypting_buffers.png 731w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypting_buffers-300x129.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypting_buffers-600x259.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypting_buffers-195x85.png 195w" sizes="(max-width: 731px) 100vw, 731px" /><figcaption>Decryption of the constants</figcaption></figure>



<p>One of the decrypted elements is the following buffer:</p>



<figure class="wp-block-image"><img data-attachment-id="39499" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/decrypting_protect_block_after/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypting_protect_block_after.png" data-orig-size="549,319" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="decrypting_protect_block_after" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypting_protect_block_after-300x174.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypting_protect_block_after.png" loading="lazy" width="549" height="319" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypting_protect_block_after.png" alt="" class="wp-image-39499" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypting_protect_block_after.png 549w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/decrypting_protect_block_after-300x174.png 300w" sizes="(max-width: 549px) 100vw, 549px" /></figure>



<p>It turns out that the decrypted block of 128 bytes is a public RSA key of the attacker. This buffer is then verified with the help of a checksum. A checksum of the RSA key is compared with the hardcoded one. In case if both matches, the size that will be used for AES key generation is set to 32. Otherwise, it is set to 4. </p>



<figure class="wp-block-image"><img data-attachment-id="39545" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/checksum_check/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/checksum_check.png" data-orig-size="570,154" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="checksum_check" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/checksum_check-300x81.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/checksum_check.png" loading="lazy" width="570" height="154" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/checksum_check.png" alt="" class="wp-image-39545" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/checksum_check.png 570w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/checksum_check-300x81.png 300w" sizes="(max-width: 570px) 100vw, 570px" /></figure>



<p>Then, a buffer of random bytes is generated for the AES key.</p>



<p>After being generated, the AES key is protected with the help of the hardcoded public key. This time the authors decided to not use Windows Crypto API, but an external library. Detailed analysis helped us to identify that it is <a rel="noreferrer noopener" aria-label="the following (opens in a new tab)" href="https://github.com/joyent/syslinux/blob/master/gpxe/src/crypto/axtls/rsa.c" target="_blank">the specific</a>  implementation of RSA algorithm (special thanks to <a rel="noreferrer noopener" aria-label="Mark Lechtik (opens in a new tab)" href="https://twitter.com/_marklech_" target="_blank">Mark Lechtik</a> for the help).</p>



<p>The decrypted 128 bytes long RSA key is imported with the help of the function <code>RSA_pub_key_new</code>. After that, the imported RSA key is used for encryption of the random AES key:</p>



<figure class="wp-block-image"><img data-attachment-id="39678" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/rsa_encrypt-4/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/rsa_encrypt-2.png" data-orig-size="500,174" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="rsa_encrypt" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/rsa_encrypt-2-300x104.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/rsa_encrypt-2.png" loading="lazy" width="500" height="174" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/rsa_encrypt-2.png" alt="" class="wp-image-39678" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/rsa_encrypt-2.png 500w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/rsa_encrypt-2-300x104.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/rsa_encrypt-2-470x165.png 470w" sizes="(max-width: 500px) 100vw, 500px" /></figure>



<p>Summing up, the AES key seems to be protected correctly, which is bad news for the victims of this ransomware.</p>



<h4 id="mce_22">Attacking network shares</h4>



<p>Phobos has a separate thread dedicated to attacking network shares.</p>



<figure class="wp-block-image"><img data-attachment-id="39454" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/get_computer_name/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/get_computer_name.png" data-orig-size="379,226" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="get_computer_name" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/get_computer_name-300x179.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/get_computer_name.png" loading="lazy" width="379" height="226" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/get_computer_name.png" alt="" class="wp-image-39454" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/get_computer_name.png 379w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/get_computer_name-300x179.png 300w" sizes="(max-width: 379px) 100vw, 379px" /></figure>



<p>Network shares are enumerated in a loop:</p>



<figure class="wp-block-image"><img data-attachment-id="39455" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/going_through_shares/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/going_through_shares.png" data-orig-size="515,472" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="going_through_shares" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/going_through_shares-300x275.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/going_through_shares.png" loading="lazy" width="515" height="472" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/going_through_shares.png" alt="" class="wp-image-39455" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/going_through_shares.png 515w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/going_through_shares-300x275.png 300w" sizes="(max-width: 515px) 100vw, 515px" /></figure>



<h4 id="mce_24">Comparison with Dharma</h4>



<p>Previous sources references Phobos as strongly based on Dharma ransomware. However, that comparison was based mostly on the outer look: a very similar ransom note, and the naming convention used for the encrypted files. The real answer in  to this question would lie in the code. Let’s have a look at both, and compare them together. This comparison will be based on the current sample of Phobos, with a Dharma sample (<a rel="noreferrer noopener" aria-label="d50f69f0d3a73c0a58d2ad08aedac1c8 (opens in a new tab)" href="https://www.virustotal.com/gui/file/c2ab289cbd2573572c39cac3f234d77fdf769e48a1715a14feddaea8ae9d9702/details" target="_blank">d50f69f0d3a73c0a58d2ad08aedac1c8</a>).</p>



<p>If we compare both with the help of BinDiff, we can see some similarities, but also a lot of mismatching functions.</p>



<figure class="wp-block-image"><img data-attachment-id="39620" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/mismatches/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/mismatches.png" data-orig-size="688,200" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="mismatches" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/mismatches-300x87.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/mismatches-600x174.png" loading="lazy" width="688" height="200" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/mismatches.png" alt="" class="wp-image-39620" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/mismatches.png 688w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/mismatches-300x87.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/mismatches-600x174.png 600w" sizes="(max-width: 688px) 100vw, 688px" /><figcaption>Fragment of code comparison: Phobos vs Dharma </figcaption></figure>



<p>In contrast to Phobos, Dharma loads the majority of its imports dynamically, making the code a bit more difficult to analyze.</p>



<figure class="wp-block-image"><img data-attachment-id="39621" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/dharma_loads_functions/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/dharma_loads_functions.png" data-orig-size="554,119" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dharma_loads_functions" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/dharma_loads_functions-300x64.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/dharma_loads_functions.png" loading="lazy" width="554" height="119" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/dharma_loads_functions.png" alt="" class="wp-image-39621" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/dharma_loads_functions.png 554w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/dharma_loads_functions-300x64.png 300w" sizes="(max-width: 554px) 100vw, 554px" /><figcaption>Dharma loads mosts of its imports at the beginning of execution</figcaption></figure>



<p>Addresses of the imported functions are stored in an additional array, and every call takes an additional jump to the value of this array. Example:</p>



<figure class="wp-block-image"><img data-attachment-id="39623" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/dharma_call_imp/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/dharma_call_imp.png" data-orig-size="621,278" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dharma_call_imp" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/dharma_call_imp-300x134.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/dharma_call_imp-600x269.png" loading="lazy" width="621" height="278" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/dharma_call_imp.png" alt="" class="wp-image-39623" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/dharma_call_imp.png 621w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/dharma_call_imp-300x134.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/dharma_call_imp-600x269.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/dharma_call_imp-604x270.png 604w" sizes="(max-width: 621px) 100vw, 621px" /></figure>



<p>In contrast, Phobos has a typical, unobfuscated Import Table</p>



<p>Before the encryption routine is started, Dharma sets a mutex: &#8220;Global\syncronize_&lt;hardcoded ID&gt;&#8221;.</p>



<p>Both, Phobos and Dharma use the same implementation of the RSA algorithm, from a static library. Fragment of code from Dharma:</p>



<figure class="wp-block-image"><img data-attachment-id="39624" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/bi_mod_power_fragment/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/bi_mod_power_fragment.png" data-orig-size="513,606" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="bi_mod_power_fragment" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/bi_mod_power_fragment-254x300.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/bi_mod_power_fragment-508x600.png" loading="lazy" width="508" height="600" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/bi_mod_power_fragment-508x600.png" alt="" class="wp-image-39624" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/bi_mod_power_fragment-508x600.png 508w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/bi_mod_power_fragment-254x300.png 254w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/bi_mod_power_fragment.png 513w" sizes="(max-width: 508px) 100vw, 508px" /><figcaption>The fragment of the function &#8220;bi_mod_power&#8221; from: <a href="https://github.com/joyent/syslinux/blob/master/gpxe/src/crypto/axtls/bigint.c#L1371" target="_blank" rel="noreferrer noopener" aria-label="https://github.com/joyent/syslinux/blob/master/gpxe/src/crypto/axtls/bigint.c#L1371 (opens in a new tab)">https://github.com/joyent/syslinux/blob/master/gpxe/src/crypto/axtls/bigint.c#L1371</a></figcaption></figure>



<p>File encryption is implemented similarly in both. However, while Dharma uses <a rel="noreferrer noopener" aria-label="AES implementation from the same static library (opens in a new tab)" href="https://github.com/joyent/syslinux/blob/master/gpxe/src/crypto/axtls/aes.c" target="_blank">AES implementation from the same static library</a>, Phobos uses AES from Windows Crypto API.</p>



<figure class="wp-block-image"><img data-attachment-id="39625" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/aes_dharma/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/aes_dharma.png" data-orig-size="997,592" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="aes_dharma" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/aes_dharma-300x178.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/aes_dharma-600x356.png" loading="lazy" width="997" height="592" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/aes_dharma.png" alt="" class="wp-image-39625" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/aes_dharma.png 997w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/aes_dharma-300x178.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/aes_dharma-600x356.png 600w" sizes="(max-width: 997px) 100vw, 997px" /><figcaption>Fragment of the AES implementation from Dharma ransomware</figcaption></figure>



<p>Looking at how the key is saved in the file, we can also see some similarities. The protected AES key is stored in the block at the end of the encrypted file. At the beginning of this block we can see some metadata that are similar like in Phobos, for example the original file name (in Phobos this data is encrypted). Then there is a 6 character long identifier, selected from a hardcoded pool.</p>



<figure class="wp-block-image"><img data-attachment-id="39628" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/ending_block_dharma/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block_dharma.png" data-orig-size="616,267" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ending_block_dharma" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block_dharma-300x130.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block_dharma-600x260.png" loading="lazy" width="600" height="260" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block_dharma-600x260.png" alt="" class="wp-image-39628" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block_dharma-600x260.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block_dharma-300x130.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block_dharma-195x85.png 195w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block_dharma.png 616w" sizes="(max-width: 600px) 100vw, 600px" /><figcaption>The block at the end of a file encrypted by Dharma</figcaption></figure>



<p>Such identifier occurs also in Phobos, but there it is stored at the very end of the block. In case of Phobos this identifier is constant for a particular sample.</p>



<figure class="wp-block-image"><img data-attachment-id="39629" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/ending_block_phobos/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block_phobos.png" data-orig-size="618,211" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ending_block_phobos" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block_phobos-300x102.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block_phobos-600x205.png" loading="lazy" width="600" height="205" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block_phobos-600x205.png" alt="" class="wp-image-39629" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block_phobos-600x205.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block_phobos-300x102.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/ending_block_phobos.png 618w" sizes="(max-width: 600px) 100vw, 600px" /><figcaption>The block at the end of a file encrypted by Phobos</figcaption></figure>



<h4 id="mce_26">Conclusion</h4>



<p>Phobos is an average ransomware, by no means showing any novelty. Looking at its internals, we can conclude that while it is not an exact rip-off Dharma, there are significant similarities between both of them, suggesting the same authors. The overlaps are at the conceptual level, as well as in the same RSA implementation used.</p>



<p>As with other threats, it is important to make sure your assets are secure to prevent such compromises. In this particular case, businesses should review any machines where Remote Desktop Procol (RDP) access has been enabled and either disable it if it is not needed, or making sure the credentials are strong to prevent such things are brute-forcing. </p>



<p><a rel="noreferrer noopener" aria-label="Malwarebytes for business (opens in a new tab)" href="https://www.malwarebytes.com/business/" target="_blank">Malwarebytes for business</a> protects against Phobos ransomware via its Anti-Ransomware protection module:</p>



<figure class="wp-block-image is-resized"><img data-attachment-id="39688" data-permalink="https://blog.malwarebytes.com/threat-analysis/2019/07/a-deep-dive-into-phobos-ransomware/attachment/block-9/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/block.png" data-orig-size="866,666" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="block" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/block-300x231.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2019/07/block-600x461.png" loading="lazy" src="https://blog.malwarebytes.com/wp-content/uploads/2019/07/block.png" alt="" class="wp-image-39688" width="365" height="281" srcset="https://blog.malwarebytes.com/wp-content/uploads/2019/07/block.png 866w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/block-300x231.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2019/07/block-600x461.png 600w" sizes="(max-width: 365px) 100vw, 365px" /></figure>



<p></p>
</div>
        
      <div class="share-section">
          <p><b>SHARE THIS ARTICLE</b></p>
         


         <a class="socicon-facebook" target="_blank" href="http://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.malwarebytes.com%2F%3Fp%3D39371&t=A+deep+dive+into+Phobos+ransomware" id="social-share-facebook" aria-label="Share this post on Facebook"></a>
         <a class="socicon-twitter" target="_blank" href="https://twitter.com/intent/tweet?text=A+deep+dive+into+Phobos+ransomware+https%3A%2F%2Fblog.malwarebytes.com%2F%3Fp%3D39371&via=Malwarebytes" id="social-share-twitter" aria-label="Share this post on Twitter"></a> 
        
          <a class="socicon-linkedin" target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fblog.malwarebytes.com%2F%3Fp%3D39371&title=A+deep+dive+into+Phobos+ransomware&summary=&source=" id="social-share-linkedin" aria-label="Share this post on LinkedIn"></a>
          

        
          
        </div>
      <hr />
      <div class="comments-section">
        <p><b>COMMENTS</b></p>
<div id="disqus_thread"></div>
</div>
        </div>
      <hr />
      <div class="related-articles">
        <p><b>RELATED ARTICLES</b></p>
    <div class="post">
      <div class="large-card">
                  <div class="thumb">
            <a href="https://blog.malwarebytes.com/threat-spotlight/2020/01/threat-spotlight-phobos-ransomware-lives-up-to-its-name/ ">
            <img src="https://blog.malwarebytes.com/wp-content/uploads/2019/12/download-604x270.png" alt="Threat spotlight: Phobos ransomware lives up to its name">
            </a>
          </div>
                    <div class="content">
            <p class="breadcrumbs hidden-xs"><a href="https://blog.malwarebytes.com/category/threat-spotlight/" rel="category tag">Threat spotlight</a></p>
            
                      <h2><a href="https://blog.malwarebytes.com/threat-spotlight/2020/01/threat-spotlight-phobos-ransomware-lives-up-to-its-name/ ">Threat spotlight: Phobos ransomware lives up to its name</a></h2>
            
          </div>
        </div>
                      <p class="desc"> January 10, 2020 - Phobos, which many believe was named after the Greek god of fear, isn’t as widespread as it was before nor is it more novel than your average ransomware. Yet, it remains a threat to consumers and businesses alike. We dive into Phobos ransomware and show users how to face their fears and protect against it.</p>
            <div class="post-action"><a href="https://blog.malwarebytes.com/threat-spotlight/2020/01/threat-spotlight-phobos-ransomware-lives-up-to-its-name/" class="continue-read">CONTINUE READING</a><a class="num-comments" href="https://blog.malwarebytes.com/threat-spotlight/2020/01/threat-spotlight-phobos-ransomware-lives-up-to-its-name/#disqus_thread"><span class="dsq-postid" data-dsqidentifier="41653 https://blog.malwarebytes.com/?p=41653">No Comments</span></a></div>
          </div> 

            <div class="post">
      <div class="large-card">
                  <div class="thumb">
            <a href="https://blog.malwarebytes.com/threat-analysis/2019/05/threat-spotlight-crysis-aka-dharma-ransomware-causing-a-crisis-for-businesses/ ">
            <img src="https://blog.malwarebytes.com/wp-content/uploads/2019/05/crisis_management-604x270.jpg" alt="Threat spotlight: CrySIS, aka Dharma ransomware, causing a crisis for businesses">
            </a>
          </div>
                    <div class="content">
            <p class="breadcrumbs hidden-xs"><a href="https://blog.malwarebytes.com/category/threat-analysis/malware-threat-analysis/" rel="category tag">Malware</a> | <a href="https://blog.malwarebytes.com/category/threat-analysis/" rel="category tag">Threat analysis</a></p>
            
                      <h2><a href="https://blog.malwarebytes.com/threat-analysis/2019/05/threat-spotlight-crysis-aka-dharma-ransomware-causing-a-crisis-for-businesses/ ">Threat spotlight: CrySIS, aka Dharma ransomware, causing a crisis for businesses</a></h2>
            
          </div>
        </div>
                      <p class="desc"> May 15, 2019 - CrySIS, aka Dharma, is a ransomware family making waves over the last two months, often being used in targeted attacks through RDP access. What other tricks are up its sleeve?</p>
            <div class="post-action"><a href="https://blog.malwarebytes.com/threat-analysis/2019/05/threat-spotlight-crysis-aka-dharma-ransomware-causing-a-crisis-for-businesses/" class="continue-read">CONTINUE READING</a><a class="num-comments" href="https://blog.malwarebytes.com/threat-analysis/2019/05/threat-spotlight-crysis-aka-dharma-ransomware-causing-a-crisis-for-businesses/#disqus_thread"><span class="dsq-postid" data-dsqidentifier="38596 https://blog.malwarebytes.com/?p=38596">No Comments</span></a></div>
          </div> 

          
        
      
      </div>
      
      
      
    </div>
    <div class="col-md-4" id="right-rail">
      <hr class="visible-xs visible-sm">



<!-- AUTHOR MODULE -->
<div class="right-rail-section author-info">
      <p><b>ABOUT THE AUTHOR</b></p>
              <div class="small-card">
            <img alt='' src='https://secure.gravatar.com/avatar/5d5dda1e7e00492cdb89a26415b1fa8f?s=96&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/5d5dda1e7e00492cdb89a26415b1fa8f?s=192&#038;d=identicon&#038;r=g 2x' class='avatar avatar-96 photo' height='96' width='96' loading='lazy'/>            <div class="content">
              <p class="details">
              <span class="name"><a href="https://blog.malwarebytes.com/author/hasherezade/" title="Posts by hasherezade" rel="author">hasherezade</a></span>
                
                                <span class="author-twitter"><a href="https://www.twitter.com/hasherezade" class="socicon-twitter" aria-label="See @hasherezade's tweets on Twitter"></a></span>
                                
                
                              <br/><span class="title">Malware Intelligence Analyst </span>
                            </p>

                            <p class="desc">Unpacks malware with as much joy as a kid unpacking candies.</p>
                          </div>
          </div>
      </div>

<!-- SUB CATEGORIES -->
      


	


         
<!-- TOP THREATS -->
    </div>
  </div>
</div>
  
</section>
</article>
  
  
      </div>


<script type="text/plain" class="optanon-category-3">
  var embeds = document.getElementsByClassName('embedded-video');
  var alts = document.getElementsByClassName('embedded-video-alt');
  if(embeds && alts) {
    for(var i = 0; i < embeds.length; i++) {
      embeds[i].src = embeds[i].dataset.src;
      embeds[i].style.display = 'inline-block';
    }

    for(var i = 0; i < alts.length; i++) {
      alts[i].style.display = 'none';
    }
  }
</script>

<script type="text/javascript">
    setTimeout(function() {
        var alts = document.getElementsByClassName('embedded-video-alt');
        for( i = 0; i < alts.length; i++) {
            alts[i].style.background = "none";
        }
    }, 2500);
</script>


<script type="text/plain" class="optanon-category-4">
  $("script[src='https://malwarebytesunpacked.disqus.com/embed.js']").each(function() {
    var scriptSrc = $(this).attr("src");
    var newScript = "<script type='text/javascript' async='' src='" + scriptSrc + "'>";
    $(this).before(newScript).remove();
  });
  
  $("link[href*='https://c.disquscdn.com/next/embed/lounge.bundle'], link[href*='https://c.disquscdn.com/next/embed/common.bundle']").each(function() {
    /**/
  });
  
</script>


<!-- for Labs Nav -->
<script>
var urlID = "blog";
</script>
<script src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/js/labs-nav.js"></script>
<section id="labs-links">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
      <div class="lablink">
        <p><a href="/authors/" id="cta-labs-footernavigation-linkto-contributors-en"><img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/footer/contributors.svg" alt="Silouette of person"><br>
            Contributors</a></p>

      </div>

      <div class="lablink">
        <p><a href="/threats/" id="cta-labs-footernavigation-linkto-threatcenter-en"><img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/footer/threat-center.svg" alt="Malware"><br>
            Threat Center</a></p>
            
      </div>

      <div class="lablink">
        <p><a href="/glossary/" id="cta-labs-footernavigation-linkto-glossary-en"><img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/footer/glossary.svg" alt="Book with bookmark"><br>
            Glossary</a></p>
            
      </div>

      <div class="lablink">
        <p><a href="/tech-support-scams/" id="cta-labs-footernavigation-linkto-scams-en"><img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/footer/scams.svg" alt="Suspicious person"><br>
            Scams</a></p>
            
      </div>

      <div class="lablink">
        <p><a href="/write/" id="cta-labs-footernavigation-linkto-writeforlabs-en"><img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/footer/write.svg" alt="Pencil"><br>
            Write for Labs</a></p>
            
      </div>
</div>
    </div>
  </div>
</section>


<footer class="refresh-footer">
    <div class="container">
        <div class="row links-row">
            <!-- newsletter -->
            <div class="col-md-3 col-xs-12 col-md-push-9 newsletter-col">
                <div class="row soc-icon-row newsletter-icons hidden-xs hidden-sm">
                    <div class="footer-soc-icon">
                        <a id="cta-footer-social-twitter-en" class="social socicon-twitter"
                           href="https://twitter.com/malwarebytes" aria-label="Visit Malwarebytes on Twitter"></a>
                    </div>
                    <div class="footer-soc-icon">
                        <a id="cta-footer-social-facebook-en" class="social socicon-facebook"
                           href="https://www.facebook.com/Malwarebytes/"
                           aria-label="Visit Malwarebytes on Facebook"></a>
                    </div>
                    <div class="footer-soc-icon">
                        <a id="cta-footer-social-linkedin-en" class="social socicon-linkedin"
                           href="https://www.linkedin.com/company/malwarebytes"
                           aria-label="Visit Malwarebytes on LinkedIn"></a>
                    </div>
                    <div class="footer-soc-icon">
                        <a id="cta-footer-social-youtube-en" class="social socicon-youtube"
                           href="https://www.youtube.com/user/Malwarebytes"
                           aria-label="Visit Malwarebytes on YouTube"></a>
                    </div>
                    <div class="footer-soc-icon">
                        <a id="cta-footer-social-instagram-en" class="social socicon-instagram-v2"
                           href="https://www.instagram.com/malwarebytesofficial/"
                           aria-label="Visit Malwarebytes on Instagram"></a>
                    </div>
                </div>
                <div class="row newsletter-refresh">
                    <div class="col-xs-12">
                        <h4>Cybersecurity info you can't do without</h4>
                        <p>Want to stay informed on the latest news in cybersecurity? Sign up for our newsletter and
                            learn
                            how to protect your computer from threats.</p>
                    </div>
                    <div class="col-xs-12">
                        <form class="newsletter-form form-inline" action="//www.malwarebytes.com/newsletter/" _lpchecked="1">
                            <div class="email-input">
                                <label for="cta-footer-newsletter-input-email-en"
                                       aria-label="cta-footer-newsletter-input-email-en"
                                       aria-labelledby="cta-footer-newsletter-input-email-en">
                                    <input type="text" class="email-input-field"
                                           id="cta-footer-newsletter-input-email-en" name="email"
                                           placeholder="Email address">
                                </label>
                                <input name="source" type="hidden" value="">
                                <input type="submit" class="submit-bttn" id="cta-footer-newsletter-subscribe-email-en"
                                       value="">
                            </div>
                        </form>
                    </div>
                </div>

            </div>
            <!--logo col-->
            <div class="col-md-2 col-xs-12 col-md-pull-3 footer-col">
                <div class="footer-logo hidden-xs hidden-sm">
                    <svg width="160px" height="25px" viewBox="0 0 160 25" version="1.1"
                         xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                            <g id="Footer-desktop" transform="translate(-165.000000, -68.000000)" fill="#FFFFFF">
                                <g id="Footer">
                                    <g id="Group-3">
                                        <g transform="translate(165.000000, 68.000000)">
                                            <g id="logo">
                                                <path
                                                        d="M104.620758,6.81492418 L104.53414,6.84800885 L104.53414,0.579460088 C104.53414,0.43037976 104.412794,0.314384104 104.256721,0.347468775 L102.436133,0.61294337 C102.314787,0.61294337 102.245333,0.728939026 102.245333,0.844934683 L102.245333,19.1016943 C102.245333,19.21769 102.33235,19.3340842 102.436133,19.3340842 C104.01363,19.6820712 105.99069,19.8315502 107.221712,19.8315502 C112.440783,19.8315502 113.151295,17.4434746 113.151295,14.840548 L113.151295,10.0313123 C113.151295,7.27890681 111.7642,5.86981868 109.076628,5.86981868 C107.135093,5.86981868 105.52247,6.36728459 104.620758,6.81492418 M110.827761,9.96514299 L110.827761,14.923459 C110.827761,16.7805854 110.238195,17.9078559 107.394949,17.9078559 C106.441346,17.9078559 105.504907,17.8249449 104.586031,17.7256909 L104.551304,17.7256909 L104.551304,8.85421552 L104.586031,8.85421552 C105.418288,8.47274526 107.152257,7.82580042 108.504625,7.82580042 C110.100084,7.80945739 110.827761,8.48908829 110.827761,9.96514299"
                                                        id="Fill-1"></path>
                                                <path
                                                        d="M116.202745,6.1348548 L114.469175,6.1348548 C114.313102,6.1348548 114.191357,6.28433374 114.226483,6.43341407 L118.612898,19.3675277 C118.647625,19.4835233 118.734244,19.516608 118.85559,19.516608 L119.375701,19.516608 C119.531774,19.516608 119.653519,19.6656883 119.618792,19.8151673 L117.884823,24.657089 C117.850095,24.8061694 117.971441,24.9556483 118.127115,24.9556483 L119.739738,24.9556483 C119.861084,24.9556483 119.930539,24.8727373 119.982829,24.8061694 L121.924763,19.5496927 L126.467251,6.43341407 C126.501978,6.28433374 126.380632,6.1348548 126.224559,6.1348548 L124.49059,6.1348548 C124.369244,6.1348548 124.300189,6.21776579 124.247898,6.28433374 L120.571996,17.2118421 C120.485377,17.4438334 120.173231,17.4438334 120.103776,17.2118421 L116.497727,6.28433374 C116.393945,6.21776579 116.306927,6.1348548 116.202745,6.1348548"
                                                        id="Fill-3"></path>
                                                <path
                                                        d="M137.858597,10.8605816 L137.858597,14.9068768 C137.858597,18.2731425 139.592566,19.8153666 143.389415,19.8153666 C145.002038,19.8153666 146.787898,19.549892 148.088375,19.135337 C148.21012,19.1022524 148.278776,18.9862567 148.245246,18.8702611 L148.001756,17.57677 C147.967029,17.4276897 147.846082,17.3447787 147.68961,17.3942064 C146.146441,17.7756766 144.759346,17.9582402 143.545887,17.9582402 C140.615224,17.9582402 140.112676,16.9796514 140.112676,14.8901352 L140.112676,13.9450297 C140.112676,13.7955508 140.234022,13.7126398 140.355368,13.7126398 L148.261612,13.7126398 C148.417685,13.7126398 148.504703,13.5966441 148.504703,13.4806485 L148.504703,10.9765773 C148.504703,7.57762552 146.805461,5.9524905 143.251304,5.9524905 C139.713512,5.86957951 137.858597,7.54454085 137.858597,10.8605816 L137.858597,10.8605816 Z M140.147005,10.7115013 C140.147005,8.63912529 141.135734,7.72710446 143.303195,7.72710446 C145.43553,7.72710446 146.302515,8.58929898 146.302515,10.7115013 L146.302515,11.6566068 C146.302515,11.8056871 146.181568,11.8885981 146.059823,11.8885981 L140.372931,11.8885981 C140.216858,11.8885981 140.12984,11.7726025 140.12984,11.6566068 L140.12984,10.7115013 L140.147005,10.7115013 Z"
                                                        id="Fill-5"></path>
                                                <path
                                                        d="M155.370725,11.888638 C152.995299,11.3254013 152.925845,11.0599267 152.925845,9.50135967 C152.925845,8.20786859 153.289883,7.76022899 155.370725,7.76022899 C156.359056,7.76022899 157.780479,7.87622465 158.977173,8.10821596 C159.133246,8.14169924 159.254193,8.02530497 159.254193,7.87622465 L159.375938,6.54925028 C159.375938,6.43325463 159.28892,6.31725897 159.185537,6.2841743 C158.075461,6.0186997 156.740656,5.86922077 155.474907,5.86922077 C151.954679,5.86922077 150.654601,6.84780955 150.654601,9.46827499 C150.654601,12.2202819 150.966747,12.9166545 154.45145,13.7457643 C157.260368,14.3927091 157.451169,14.5417895 157.451169,16.0840135 C157.451169,17.5269835 157.087131,17.9746231 154.763597,17.9746231 C153.65392,17.9746231 152.232497,17.7924581 151.053366,17.5269835 C150.897293,17.4938989 150.775548,17.5600682 150.74122,17.7095471 L150.498528,18.9532119 C150.463801,19.0692076 150.533255,19.1852032 150.654601,19.2182879 C151.799005,19.5997581 153.532974,19.8652327 154.885342,19.8652327 C158.95961,19.8652327 159.705248,18.5717417 159.705248,16.0011025 C159.722812,13.1323027 159.167974,12.8006588 155.370725,11.888638"
                                                        id="Fill-7"></path>
                                                <path
                                                        d="M48.2703991,19.417075 L45.7389002,6.3669657 C45.704173,6.21788537 45.8255189,6.06840643 45.9819912,6.06840643 L48.7909092,6.06840643 C48.9118559,6.06840643 49.033601,6.15131742 49.033601,6.25097004 L50.541643,14.1103733 C50.5763703,14.3762465 50.940408,14.3762465 51.0098626,14.1438566 L53.4547428,6.2342284 C53.489071,6.11823275 53.5760887,6.0520634 53.6974346,6.0520634 L57.0268626,6.0520634 C57.1478094,6.0520634 57.2168648,6.13497439 57.2691553,6.2342284 L59.7140355,14.1438566 C59.8006542,14.3762465 60.1475278,14.3762465 60.1822551,14.1103733 L61.6902971,6.25097004 C61.7250244,6.13497439 61.8120422,6.06840643 61.9333881,6.06840643 L64.7423061,6.06840643 C64.8979801,6.06840643 65.019326,6.21788537 64.9845987,6.3669657 L62.4359357,19.417075 C62.4012085,19.5330706 62.314989,19.5996386 62.1932439,19.5996386 L58.5177407,19.5996386 C58.3959956,19.5996386 58.326541,19.5167276 58.2746497,19.417075 L55.5874768,10.6452522 C55.500459,10.4132609 55.1883127,10.4132609 55.1192573,10.6452522 L52.4320843,19.417075 C52.3973571,19.5330706 52.3103393,19.5996386 52.1889934,19.5996386 L48.5130909,19.5996386 C48.391745,19.5996386 48.3051264,19.5330706 48.2703991,19.417075"
                                                        id="Fill-9"></path>
                                                <path
                                                        d="M44.1961309,17.1122293 C42.9303814,17.1122293 42.5312173,16.5816787 42.5312173,15.0725394 L42.5312173,5.27270015 L42.5312173,1.40856993 C42.5312173,1.25948961 42.4098714,1.14309534 42.2541974,1.17657862 L39.2025876,1.59113354 C39.0812417,1.59113354 39.0117872,1.70752781 39.0117872,1.82352347 L39.0117872,1.93951912 L39.0117872,5.27270015 L39.0117872,15.437268 C39.0117872,18.505373 40.9537207,19.8650334 43.554275,19.8650334 C43.8320932,19.8650334 44.733805,19.8315502 45.2535167,19.7817238 C45.3748626,19.7817238 45.4962085,19.6657282 45.4962085,19.5497325 L45.4962085,17.3940469 C45.4962085,17.2449666 45.3748626,17.1620556 45.2191885,17.1620556 C44.8723149,17.1122293 44.4040954,17.1122293 44.1961309,17.1122293"
                                                        id="Fill-11"></path>
                                                <path
                                                        d="M87.0914657,9.02011721 C85.8257163,9.55066779 84.8030578,10.114303 83.658255,10.8274172 C83.5720356,10.8605019 83.5373083,10.9434129 83.5373083,11.0099808 L83.5373083,19.3672486 C83.5373083,19.5167276 83.4155633,19.5996386 83.2942174,19.5996386 L80.2426076,19.5996386 C80.0865344,19.5996386 79.9999158,19.4832443 79.9999158,19.3672486 L79.9999158,6.78152062 C79.9999158,6.66552497 80.0865344,6.54952931 80.1907163,6.54952931 L82.7222152,6.13457578 C82.8782883,6.10149111 82.9996342,6.21748676 82.9996342,6.31713939 L83.1209801,7.1793339 C83.1557074,7.36189752 83.3636719,7.4448085 83.5197451,7.32881284 C84.317275,6.83134694 85.5834236,6.20114373 86.6060821,5.85275815 C86.7621553,5.81967348 86.9178293,5.88624143 86.9178293,6.03532176 L87.1956475,8.68847327 C87.2475389,8.85429524 87.1784835,8.93720622 87.0914657,9.02011721"
                                                        id="Fill-13"></path>
                                                <path
                                                        d="M134.217781,17.9744637 C132.795559,17.9744637 132.709339,17.3777438 132.709339,16.4322396 L132.709339,8.22405217 C132.709339,8.07497184 132.830286,7.99206086 132.951632,7.99206086 L136.28106,7.99206086 C136.402406,7.99206086 136.523353,7.90914987 136.523353,7.76006955 L136.679825,6.43349379 C136.679825,6.28401485 136.55808,6.1680192 136.437133,6.1680192 L132.951632,6.1680192 C132.795559,6.1680192 132.709339,6.05202354 132.709339,5.93562927 L132.709339,2.81889375 C132.709339,2.66941482 132.587594,2.55302055 132.431521,2.58650383 L130.611333,2.85197843 C130.489987,2.85197843 130.420532,2.96757547 130.420532,3.08357113 L130.420532,5.95237092 C130.420532,6.10184985 130.299186,6.18476084 130.17784,6.18476084 L128.20118,6.18476084 C128.045107,6.18476084 127.958089,6.3007565 127.958089,6.41675215 L127.958089,7.74332791 C127.958089,7.89240823 128.079834,7.97531922 128.20118,7.97531922 L130.17784,7.97531922 C130.333914,7.97531922 130.420532,8.09171348 130.420532,8.20770914 L130.420532,16.7638836 C130.420532,18.9195692 131.408863,19.7817637 133.853344,19.7817637 C134.408581,19.7817637 134.96302,19.748679 135.518257,19.6326834 C135.639603,19.5995987 135.708659,19.5166877 135.708659,19.4006921 L135.708659,18.0741163 C135.708659,17.9246374 135.552985,17.8086417 135.43124,17.8417264 C134.980184,17.941379 134.581818,17.9744637 134.217781,17.9744637"
                                                        id="Fill-15"></path>
                                                <path
                                                        d="M97.3387274,6.21776579 C96.5930888,5.91920652 95.6394857,5.72029988 94.4084635,5.72029988 C93.0213682,5.72029988 91.9631841,5.95229119 91.131326,6.31741841 C89.1893925,7.22943924 88.565499,9.00365459 88.565499,10.9600349 L88.565499,14.5586906 C88.565499,17.7423926 90.0216497,19.698773 94.2523903,19.781684 L95.2403216,19.781684 C96.3847251,19.781684 97.58102,19.6656883 98.6739314,19.5162094 C98.7948781,19.4831247 98.916224,19.3675277 98.8639335,19.251532 L98.8639335,19.1351377 L98.5869136,17.2780114 C97.5119646,17.3940071 96.5755256,17.4274903 95.5009757,17.4274903 C92.9000223,17.4274903 92.1024923,16.7143762 92.1024923,15.1888938 L92.1024923,14.7408556 L92.1024923,14.111051 L99.7313172,14.111051 C99.8873903,14.111051 99.974009,13.9946567 99.974009,13.878661 L99.974009,12.8506446 L99.974009,11.1920263 C99.9396808,9.02039623 99.4016076,7.07996031 97.3387274,6.21776579 L97.3387274,6.21776579 Z M96.8182174,11.5906368 C96.8182174,11.7397171 96.6972706,11.8226281 96.5755256,11.8226281 L92.0677651,11.8226281 L92.0677651,10.644734 C92.0677651,9.35164156 92.6569313,8.48944704 94.4084635,8.48944704 C94.599264,8.48944704 94.8068293,8.48944704 94.9980289,8.52293033 C96.2985057,8.70509533 96.8182174,9.5505482 96.8182174,10.644734 L96.8182174,11.5906368 Z"
                                                        id="Fill-17"></path>
                                                <path
                                                        d="M10.6807539,21.9044842 L10.7673725,21.9044842 C10.9230465,21.9044842 11.0443924,21.7825165 11.0443924,21.6257607 C11.0443924,21.5033739 10.9577738,21.3466181 10.8020998,21.3466181 L10.715082,21.3466181 L10.5242816,21.31183 C7.31659864,20.6839687 4.94157208,17.8070392 4.94157208,14.4414006 C4.94157208,13.0121568 5.37506432,11.6520699 6.12030375,10.5539413 C6.24204881,10.3967664 6.4324501,10.2747986 6.64081377,10.4667616 L11.7038116,15.6271281 C11.7377405,15.6619161 11.8247583,15.7143078 11.8942129,15.7143078 C11.9808315,15.7143078 12.050286,15.6795197 12.0850133,15.6271281 L17.1823392,10.5015496 C17.3731397,10.3095867 17.5467761,10.3447939 17.6509579,10.5363377 C18.3961974,11.6520699 18.8296896,12.9949723 18.8296896,14.4242161 C18.8296896,16.2197822 18.1535056,17.8418273 17.0434301,19.0799464 C17.009102,19.1147344 16.9572107,19.1671261 16.9224834,19.2019141 C16.9224834,19.2367022 16.8877561,19.2890938 16.8877561,19.3238818 C16.8877561,19.4810567 17.009102,19.6030245 17.1651752,19.6030245 L17.1999025,19.6030245 C17.2346297,19.6030245 17.2865211,19.5682364 17.3212484,19.5682364 C24.0830887,16.7084914 23.7713415,9.94368351 23.7713415,9.94368351 C23.7713415,6.09017397 21.9503548,2.62059033 19.1418359,0.441098316 C19.0204901,0.353918635 18.8296896,0.353918635 18.7426718,0.475886362 L12.1025765,7.24111341 C11.9808315,7.36308113 11.790031,7.36308113 11.6690843,7.24111341 L4.97590019,0.475886362 C4.8545543,0.353918635 4.69888029,0.353918635 4.57753439,0.441098316 C1.82050776,2.62059033 -7.98328266e-05,6.03778233 -7.98328266e-05,9.94368351 C-7.98328266e-05,16.1502062 4.66415301,21.2766229 10.6807539,21.9044842"
                                                        id="Fill-19"></path>
                                                <path
                                                        d="M29.9264125,5.80321087 C28.6953903,5.80321087 27.3949136,5.88612185 26.1638914,6.06828685 C26.0425455,6.10177013 25.9211996,6.21776579 25.9730909,6.33376145 L26.25051,8.37345139 C26.2852373,8.48944704 26.3722551,8.6054427 26.5275299,8.6054427 C27.6723326,8.48944704 28.4179712,8.45636237 29.5795388,8.45636237 C32.1800931,8.45636237 32.9780222,9.16907795 32.9780222,10.694959 L32.9780222,11.6073784 C32.9780222,11.7564587 32.8566763,11.8393697 32.7349313,11.8393697 L29.4577938,11.8393697 C26.5798204,11.8393697 24.8634147,13.2317162 24.8634147,15.768872 C24.8634147,18.1071213 26.7534568,19.781684 29.6146653,19.781684 C31.4001264,19.781684 32.1114369,19.516608 32.7006031,18.9860574 C32.8566763,18.8365785 33.1340954,18.9525741 33.1340954,19.1351377 L33.1340954,19.3177014 C33.1340954,19.4667817 33.2554413,19.5496927 33.3767872,19.5496927 L36.2547605,19.5496927 C36.4108337,19.5496927 36.4978515,19.433697 36.4978515,19.3177014 L36.4978515,10.794213 C36.5321796,7.42834589 34.0876985,5.80321087 29.9264125,5.80321087 L29.9264125,5.80321087 Z M33.0123503,14.5750336 C33.0123503,16.2830796 31.8332195,17.4107487 29.9264125,17.4107487 C28.4702617,17.4107487 27.7070599,16.8801981 27.7070599,15.7856137 C27.7070599,14.5750336 28.5045898,14.0775677 29.9264125,14.0775677 L32.7349313,14.0775677 C32.8914036,14.0775677 32.9780222,14.1935633 32.9780222,14.3099576 L32.9780222,14.5750336 L33.0123503,14.5750336 Z"
                                                        id="Fill-21"></path>
                                                <path
                                                        d="M70.879694,5.80321087 C69.649071,5.80321087 68.3485943,5.88612185 67.1175721,6.06828685 C66.9962262,6.10177013 66.8748803,6.21776579 66.9267717,6.33376145 L67.2041908,8.37345139 C67.238918,8.48944704 67.3255366,8.6054427 67.4812107,8.6054427 C68.6260134,8.48944704 69.371652,8.45636237 70.5332196,8.45636237 C73.1337739,8.45636237 73.931703,9.16907795 73.931703,10.694959 L73.931703,11.6073784 C73.931703,11.7564587 73.8099579,11.8393697 73.688612,11.8393697 L70.4118737,11.8393697 C67.5335012,11.8393697 65.8170954,13.2317162 65.8170954,15.768872 C65.8170954,18.1071213 67.7071376,19.781684 70.5679469,19.781684 C72.353408,19.781684 73.0647185,19.516608 73.6538847,18.9860574 C73.8099579,18.8365785 74.0877761,18.9525741 74.0877761,19.1351377 L74.0877761,19.3177014 C74.0877761,19.4667817 74.209122,19.5496927 74.3304679,19.5496927 L77.2084413,19.5496927 C77.3645145,19.5496927 77.4515323,19.433697 77.4515323,19.3177014 L77.4515323,10.794213 C77.5377517,7.42834589 75.0413792,5.80321087 70.879694,5.80321087 L70.879694,5.80321087 Z M73.9660311,14.5750336 C73.9660311,16.2830796 72.7869003,17.4107487 70.879694,17.4107487 C69.4235433,17.4107487 68.6603415,16.8801981 68.6603415,15.7856137 C68.6603415,14.5750336 69.4578714,14.0775677 70.879694,14.0775677 L73.688612,14.0775677 C73.8450844,14.0775677 73.931703,14.1935633 73.931703,14.3099576 L73.931703,14.5750336 L73.9660311,14.5750336 Z"
                                                        id="Fill-23"></path>
                                            </g>
                                        </g>
                                    </g>
                                </g>
                            </g>
                        </g>
                    </svg>
                </div>
                <p class="col-header imagine-title">Imagine a world without malware. We do. </p>

                <p>
                    <a href="//www.malwarebytes.com/for-home/" id="cta-footernavigation-company-linkto-for_home-en" class="for-home-link-en">FOR
                        PERSONAL</a>
                </p>
                <p>
                    <a href="//www.malwarebytes.com/business/" id="cta-footernavigation-company-linkto-for_business-en">FOR
                        BUSINESS</a>
                </p>

            </div>
            <!-- company -->
            <div class="col-md-2 col-xs-12 col-md-pull-3 footer-col company-col">
                <p class="col-header">COMPANY</p>
                <p>
                    <a href="//www.malwarebytes.com/company/" id="cta-footernavigation-company-linkto-about_us-en">ABOUT
                        US</a>
                </p>
                <p>
                    <a href="https://jobs.malwarebytes.com/"
                       id="cta-footernavigation-learn-linkto-careers-en">CAREERS</a>
                </p>
                <p>
                    <a href="https://press.malwarebytes.com/"
                       id="cta-footernavigation-learn-linkto-news_and_press-en">NEWS AND
                        PRESS</a>
                </p>
            </div>
            <!-- my account -->
            <div class="col-md-2 col-xs-12 col-md-pull-3 footer-col">
                <p class="col-header">MY ACCOUNT</p>
                <p>
                    <a href="https://my.malwarebytes.com/en/login"
                       id="cta-footernavigation-myaccount-linkto-sign_in-en">SIGN
                        IN</a>
                </p>
            </div>
            <!-- contact us -->
            <div class="col-md-3 col-xs-12 col-md-pull-3 footer-col">
                <p class="col-header">CONTACT US</p>
                <p>
                    <a href="https://support.malwarebytes.com/hc/en-us" class="pillar-page-lightbox"
                       id="cta-footernavigation-contactus-linkto-get_support-en">GET
                        SUPPORT</a>
                </p>
                <p>
                    <a href="https://www.malwarebytes.com/contact/" class="pillar-page-lightbox"
                       id="cta-footernavigation-contactus-linkto-contact_sales-en">CONTACT
                        SALES</a>
                </p>
                <div class="address">
                    <!-- icon here -->
                    <div class="hq">
                        <img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/footer/ic-pin-map.svg" alt="Map pin">
                        <div class="address-text">
                            3979 Freedom Circle, 12th Floor<br />Santa Clara, CA 95054
                        </div>
                    </div>
                    <div class="local hidden outside-na">
                        <img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/footer/ic-pin-map.svg" alt="Map pin">
                        <div class="address-text">
                            One Albert Quay, 2nd Floor<br />Cork T12 X8N6<br />Ireland
                        </div>
                    </div>
                </div>

            </div>

        </div>
        <div class="row soc-icon-row hidden-md hidden-lg">
            <div class="footer-soc-icon">
                <a id="cta-footer-social-twitter-en" class="social socicon-twitter"
                   href="https://twitter.com/malwarebytes" aria-label="Visit Malwarebytes on Twitter"></a>
            </div>
            <div class="footer-soc-icon">
                <a id="cta-footer-social-facebook-en" class="social socicon-facebook"
                   href="https://www.facebook.com/Malwarebytes/" aria-label="Visit Malwarebytes on Facebook"></a>
            </div>
            <div class="footer-soc-icon">
                <a id="cta-footer-social-linkedin-en" class="social socicon-linkedin"
                   href="https://www.linkedin.com/company/malwarebytes"
                   aria-label="Visit Malwarebytes on LinkedIn"></a>
            </div>
            <div class="footer-soc-icon">
                <a id="cta-footer-social-youtube-en" class="social socicon-youtube"
                   href="https://www.youtube.com/user/Malwarebytes" aria-label="Visit Malwarebytes on YouTube"></a>
            </div>
            <div class="footer-soc-icon">
                <a id="cta-footer-social-instagram-en" class="social socicon-instagram-v2"
                   href="https://www.instagram.com/malwarebytesofficial/"
                   aria-label="Visit Malwarebytes on Instagram"></a>
            </div>
        </div>

    </div>
    <div class="footer-bottom">
        <div class="container">
            <div class="row">
                <div class="col-xs-10 col-md-2">
                    <div class="lang-select-container">
                        <img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/footer/world.svg" alt="Globe icon">
                        &nbsp;&nbsp; <a href="#" class="language-select col-header"
                                        id="cta-footernavigation-linkto-languageselect-en">English</a>
                    </div>
                </div>
                <div class="col-xs-12 col-md-10 legal-list-col">
                    <div class="legal-list">
                        <div class="legal-link">
                            <a class="legal" href="//www.malwarebytes.com/legal/" id="cta-footernavigation-linkto-legal-en">Legal</a>
                        </div>
                        <div class="legal-link">
                            <a class="legal" href="//www.malwarebytes.com/privacy/" id="cta-footernavigation-linkto-privacy-en">Privacy</a>
                        </div>
                        <div class="legal-link">
                            <a class="legal" href="//www.malwarebytes.com/accessibility/"
                               id="cta-footernavigation-linkto-accessibility-en">Accessibility</a>
                        </div>

                        <div class="legal-link legal-last">
                            <a class="legal" href="//www.malwarebytes.com/tos/" id="cta-footernavigation-linkto-tos-en">Terms of Service</a>
                        </div>
                    </div>
                    <br class="hidden-md hidden-lg">
                    <p class="p-year">&copy;
                        <script>
                          $(document).ready(function () {
                            var d = new Date();
                            var year = d.getFullYear();
                            $(".currentYear").text(year);
                          });
                        </script><span class="currentYear"></span> All Rights Reserved</p>
                </div>
            </div>

        </div>
    </div>

</footer>

<!-- language select overlay -->
<section id="overlay-lang" class="text-center text-white" style="overflow-y: scroll;">
  <div class="container">
    <div class="row center-row">
      <div class="col-md-10">
     
        <p class="h2">Select your language</p>
      </div>
    </div>
    <div class="row center-row">
      <div class="col-md-5">
        <div class="text-center">
          <ul class="list-unstyled" id="intl-sites">
            </ul>
        </div>
      </div>
      
    </div>
  </div>
</section>
<!-- pillar page select overlay -->
<section id="pillar-pages" class="text-white overlay" style="overflow-y: scroll; display: none;">
  <div class="container">
    <div class="row">
      <div class="col-md-10">
        <p class="h2"><a href="https://www.malwarebytes.com/cybersecurity/" id="cta-labs-footernavigation-lightbox-learn-linkto-cybersecurity-en">Cybersecurity basics</a></p>
        <p>Your intro to everything relating to cyberthreats, and how to stop them.</p>
      </div>
    </div>
    <div class="row"> 
      <div class="col-md-8 pillar-pages-list">
              
              
              
            </div>
    </div>
  </div>
</section>
 <script>
  overlay('.language-select', '#overlay-lang');
  overlay('.pillar-page-lightbox', '#pillar-pages');
</script>

	<div style="display:none">
	<div class="grofile-hash-map-5d5dda1e7e00492cdb89a26415b1fa8f">
	</div>
	</div>
<link rel='stylesheet' id='jetpack-carousel-css'  href='https://blog.malwarebytes.com/wp-content/plugins/jetpack/modules/carousel/jetpack-carousel.css?ver=9.4' type='text/css' media='all' />
<script type='text/javascript' id='disqus_count-js-extra'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"malwarebytesunpacked"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.21' id='disqus_count-js'></script>
<script type='text/javascript' id='disqus_embed-js-extra'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.21"},"disqusIdentifier":"39371 https:\/\/blog.malwarebytes.com\/?p=39371","disqusShortname":"malwarebytesunpacked","disqusTitle":"A deep dive into Phobos ransomware","disqusUrl":"https:\/\/blog.malwarebytes.com\/threat-analysis\/2019\/07\/a-deep-dive-into-phobos-ransomware\/","postId":"39371"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.21' id='disqus_embed-js'></script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-includes/js/imagesloaded.min.js?ver=4.1.4' id='imagesloaded-js'></script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-includes/js/masonry.min.js?ver=4.2.2' id='masonry-js'></script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-includes/js/jquery/jquery.masonry.min.js?ver=3.1.2b' id='jquery-masonry-js'></script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/js/functions.js?ver=2013-07-18' id='mb_labs-script-js'></script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-includes/js/wp-embed.min.js?ver=5.6.2' id='wp-embed-js'></script>
<script type='text/javascript' id='jetpack-carousel-js-extra'>
/* <![CDATA[ */
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/blog.malwarebytes.com\/wp-admin\/admin-ajax.php","nonce":"d36e4f7e5d","display_exif":"1","display_comments":"1","display_geo":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"1","require_name_email":"0","login_url":"https:\/\/blog.malwarebytes.com\/wp-login.php?redirect_to=https%3A%2F%2Fblog.malwarebytes.com%2Fthreat-analysis%2F2019%2F07%2Fa-deep-dive-into-phobos-ransomware%2F","blog_id":"1","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"local_comments_commenting_as":"<p id=\"jp-carousel-commenting-as\">You must be <a href=\"#\" class=\"jp-carousel-comment-login\">logged in<\/a> to post a comment.<\/p>"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-content/plugins/jetpack/_inc/build/carousel/jetpack-carousel.min.js?ver=9.4' id='jetpack-carousel-js'></script>
<script src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/js/standard-search-results-footer.js" type="text/javascript"></script>
<script type="text/javascript">
  var countryError, country;
  $.browser = {};
  (function() {
    $.browser.msie = false;
    $.browser.version = 0;
    if (navigator.userAgent.match(/MSIE ([0-9]+)\./)) {
      $.browser.msie = true;
      $.browser.version = RegExp.$1;
    }
  })();
  // Use Microsoft XDR for IE8/9
  if ($.browser.msie && window.XDomainRequest && $.browser.version < 10) {
    //console.log("browser is IE less than 10");

    var xdr = new XDomainRequest();
    xdr.open("GET", "https://genesis.malwarebytes.com/api/v1/wai.gif");
    xdr.onload = function() {
      //console.log("onload function");
      // use xdr.responseText for ie8/9, since unable to specify JSON accept request header
      var dom = new ActiveXObject("Microsoft.XMLDOM");
      var data = $.parseJSON(xdr.responseText);
      //console.log("IE data: " + data);
      dom.async = false;
      if (data == null || typeof(data) == "undefined") {
        // console.log("data is null or undefined");
        window.countryError = data["error"]["errorCode"];
      }
      window.country = data["location"]["countryCode"];
      //console.log("IE country in geo: " + country);
    };
    // function to call when an error occurs
    xdr.onerror = function() {
      //console.log("onerror XDR");
      window.countryError = data["error"]["errorCode"];
    };
    //console.log("before the send");
    xdr.send();
    //console.log("after the function");
  } else { // not IE 8/9, so use AJAX
    $.ajax({
      url: "https://genesis.malwarebytes.com/api/v1/wai.gif",
      type: "GET",
      crossDomain: true,
      dataType: "json",
      success: function(data) {
        //set country     
        //console.log("in success" + JSON.stringify(data));
        window.country = data["location"]["countryCode"];
      },
      error: function(data, jqXHR, textStatus, errorThrown) {
        //      console.log('geohtml genesis error POST1: ' + JSON.stringify(data)); 
        //      console.log("jqXHR: " + jqXHR);
        //      console.log("textStatus: " + textStatus);
        //      console.log("errorThrown: " + errorThrown);
        window.countryError = data["error"]["errorCode"];
      },
      async: false
    });
  }
</script>

<script type="text/plain" class="optanon-category-4">
  $("script[src='https://malwarebytesunpacked.disqus.com/embed.js']").each(function() {
    var scriptSrc = $(this).attr("src");
    var newScript = "<script type='text/javascript' async='' src='" + scriptSrc + "'>";
    $(this).before(newScript).remove();
  });
</script>

<!--replace with onetrust -->

<!---->

<script>
/*
  function enableCookies() {
    //fire inline scripts
    $('.ce-script').each(function() {
      var scripts = $(this).text();
      var scriptParent = $(this).parent();
      //console.log($(this).attr('data-ce-src'));
      if (!$(this).attr('data-ce-src')) {
        //console.log('no attribute')
          //fire marketo forms
        if (scripts.indexOf("MktoForms2") > -1) {
          
          //set interval for mkto
          var mktoInt = setInterval(function() {
            if(typeof(MktoForms2) !== "undefined") {
              clearInterval(mktoInt);
              $(scriptParent).append('<script>' + scripts + '<\/script>');
              $(scriptParent).append("<script>(function(d,b,a,s,e){ var t = b.createElement(a),fs = b.getElementsByTagName(a)[0]; t.async=1; t.id=e; t.src=('https:'==document.location.protocol ? 'https://' : 'http://') + s; fs.parentNode.insertBefore(t, fs); })(window,document,'script','scripts.demandbase.com/HWyTnY16.min.js','demandbase_js_lib');<\/script>");
              
            }
          }, 10);
        } else {

          $(scriptParent).append('<script>' + scripts + '<\/script>');
        }
      } else {
        var attr = $(this).attr('data-ce-src');
        $(this).attr('src', attr);
        //console.log('attribute is: ' + attr);
        $(scriptParent).append('<script src="' + attr + '"><\/script>');
      }
      //console.log(scripts);
    });
    
    //iframes
    
    $('.ce-iframe').each(function() {
      var iframesrc = $(this).attr('data-ce-src');
      $(this).attr('src', iframesrc);
    });
    
    
  }

  var gdprCountries = [
    "BE",
    "BG",
    "CZ",
    "DK",
    "DE",
    "EE",
    "IE",
    "EL",
    "ES",
    "FR",
    "HR",
    "IT",
    "CY",
    "LV",
    "LT",
    "LU",
    "HU",
    "MT",
    "NL",
    "AT",
    "PL",
    "PT",
    "RO",
    "SI",
    "SK",
    "FI",
    "SE",
    "UK",
    "GB"
  ];
  //read user preference cookie
  var cookiePreference = $.cookie('ce-cookie');
  

  
  
  //cookie config
  if (gdprCountries.indexOf(country) > -1) {
    if (cookiePreference === "N" && cookiePreference !== "Y") {
      $(window).load(function() {
        $('a[href*="https://my.malwarebytes"]').attr('href','https://www.malwarebytes.com/myaccount-consent');
        //$('form[id*="mktoForm"]').append('<p>To view this content you need to enable cookies. <br>' + '<a style="text-decoration: underline;" href="#" class="ce-accept">Enable All Cookies</a>' + '</p>');
      });

    } else {
      enableCookies();
    }

    //variable for cookies to fire or not
    //var cookies = "no";

    //if (cookies === "yes") {
    //  enableCookies();
    //}
    
    //remove for onetrust
    COOKIES_ENABLER.init({
      scriptClass: 'ce-script',
      iframeClass: 'ce-iframe',
      acceptClass: 'ce-accept',
      dismissClass: 'ce-dismiss',
      disableClass: 'ce-disable',
      bannerClass: 'ce-banner',
      bannerHTML: '<p>By continuing to browse our website or by clicking "Accept All Cookies," you agree to the storing of first- and third-party cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts. <a href="https://www.malwarebytes.com/privacy/" style="margin-left:0;" id="cta-labs-cookiegdpr-linkto-privacypolicy-en">Privacy and Cookie Policy</a><br>' + '<a href="#" class="ce-accept bluecta-sm" style="width: auto; padding-left:10px; padding-right:10px;" id="cta-labs-cookiegdpr-acceptallcookies-en">' + 'Accept All Cookies' + '</a>' + '<a href="#" class="ce-disable ce-disable" id="cta-labs-cookiegdpr-disableallcookies-en">Disable Cookies</a>' + '</p>',
      eventScroll: false,
      scrollOffset: 200,
      clickOutside: false,
      cookieName: 'ce-cookie',
      cookieDuration: '365',
      wildcardDomain: true,
      iframesPlaceholder: true,
      iframesPlaceholderHTML: '<p>To view this content you need to enable cookies. <br>' + '<a style="text-decoration: underline;" href="#" class="ce-accept"  id="cta-labs-cookiegdpr-enablecookies-viaiframe-en">Enable All Cookies</a>' + '</p>',
      iframesPlaceholderClass: 'ce-iframe-placeholder',
      // Callbacks
      onEnable: function() {
        //enableCookies();
      },
      onDismiss: function() {
        //console.log('the banner has been dismissed');
      },
      onDisable: function() {
        $('a[href*="https://my.malwarebytes"]').attr('href','https://www.malwarebytes.com/myaccount-consent');
        $('form[id*="mktoForm"]').append('<p id="consent-message">To view this content you need to enable cookies. <br>' + '<a style="text-decoration: underline;" href="#" class="ce-accept">Enable All Cookies</a>' + '</p>');
        $('#consent-message .ce-accept').click(function() {
          setTimeout(function() {
            window.location.reload()
          }, 250);
          $('#consent-message').remove();
        });
      }
    });
  } else {
    enableCookies();
  }
  */
</script>
<style>
  .ce-banner {
    display: block;
    position: fixed;
    width: 100vw;
    background: #fff;
    bottom: 0;
    left: 0;
    z-index: 99999;
    box-sizing: border-box;
    padding: 20px;
    text-align: center;
    box-shadow: 0px 0px 20px #424242;
  }
  
  .ce-banner a {
    margin: 0 10px;
  }
</style>
<script>
$(document).ready(function() {
  $.getJSON("https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/pillarpages.json", function(allpillarpages){
    number_of_pillar_pages_to_show = 5;
    var pillar_card_slug;

    function pillar_card() {
      if (typeof allpillarpages[i].uri === "undefined") { 
        var pillar_card_slug = allpillarpages[i].pillarpage.replace(" ", "-").toLowerCase();
      }
      else {
        var pillar_card_slug = allpillarpages[i].uri;
      }
      var pillar_card_html = '<div class="col-md-3"><p><a href="https://www.malwarebytes.com/' + pillar_card_slug + '/" id="cta-labs-footernavigation-lightbox-learn-linkto-' + pillar_card_slug + '-en">' + allpillarpages[i].pillarpage +'</a></p></div>';
      
      var pillar_card_list_html = '<p><a href="https://www.malwarebytes.com/' + pillar_card_slug + '/" id="cta-labs-footernavigation-learn-linkto-' + pillar_card_slug + '-en">' + allpillarpages[i].pillarpage +'</a></p>'
      
      $("section#pillar-pages .pillar-pages-list").append(pillar_card_html);
      
      if ([i] < number_of_pillar_pages_to_show) {
        $("footer .pillar-pages-list").append(pillar_card_list_html);
      }
    };
    for (i=0;i<allpillarpages.length;i++) {
      pillar_card();
    } 
  });
});
</script>
<script>
$(document).ready(function() {
  $.getJSON("https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/intl-sites.json", function(intlSites){

    function listIntlSites() {
      let indCountry = '<li><a href="' + intlSites[i].url + '/" class="' + intlSites[i].country + '-site" id="cta-labs-footer-linkto-' + intlSites[i].country + '_site-en">' + intlSites[i].lang + '</a></li>'
      $("#intl-sites").append(indCountry);
    };
    for (i=0;i<intlSites.length;i++) {
            listIntlSites();
          }  
  });
});
</script>
</body>
</html>