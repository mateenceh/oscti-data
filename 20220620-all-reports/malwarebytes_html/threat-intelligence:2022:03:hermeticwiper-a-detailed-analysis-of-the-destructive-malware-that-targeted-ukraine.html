<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>

  
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
    <!-- Taken from www.malwarebytes.com -->
  <!-- Fav Ico -->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel='shortcut icon' href='https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme /images/favicon/favicon.ico' type='image/x-icon' />
<link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/favicon/apple-touch-icon-57x57.png" />
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/favicon/apple-touch-icon-114x114.png" />
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/favicon/apple-touch-icon-72x72.png" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/favicon/apple-touch-icon-144x144.png" />
<link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/favicon/apple-touch-icon-60x60.png" />
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/favicon/apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/favicon/apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/favicon/apple-touch-icon-152x152.png" />
<link rel="icon" type="image/png" href="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/favicon/favicon-196x196.png" sizes="196x196" />
<link rel="icon" type="image/png" href="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/favicon/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/png" href="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/favicon/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/favicon/favicon-16x16.png" sizes="16x16" />
<link rel="icon" type="image/png" href="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/favicon/favicon-128.png" sizes="128x128" />
<meta name="msapplication-TileColor" content="#" />
<meta name="msapplication-TileImage" content="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/favicon/mstile-144x144.png" />
<meta name="msapplication-square70x70logo" content="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/favicon/mstile-70x70.png" />
<meta name="msapplication-square150x150logo" content="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/favicon/mstile-150x150.png" />
<meta name="msapplication-wide310x150logo" content="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/favicon/mstile-310x150.png" />
<meta name="msapplication-square310x310logo" content="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/favicon/mstile-310x310.png" />
<meta name="theme-color" content="#ffffff">
  
<title>

HermeticWiper: A detailed analysis of the destructive malware that targeted Ukraine Looking at the internals of HermeticWiper | Malwarebytes Labs  </title>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://blog.malwarebytes.com/xmlrpc.php">

  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />

		<!-- Meta Tag Manager -->
		<meta property="fb:app_id" content="358351844222748" />
		<!-- / Meta Tag Manager -->

	<!-- This site is optimized with the Yoast SEO plugin v18.2 - https://yoast.com/wordpress/plugins/seo/ -->
	<meta name="description" content="Ukraine is notoriously attacked by the Russia-linked disk wipers. The implementation and quality of those wipers vary, which may suggest various different contractors being deployed. In this post we will cover the insights of this new malware, focusing on details." />
	<link rel="canonical" href="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="HermeticWiper: A detailed analysis of the destructive malware that targeted Ukraine Looking at the internals of HermeticWiper" />
	<meta property="og:description" content="Ukraine is notoriously attacked by the Russia-linked disk wipers. The implementation and quality of those wipers vary, which may suggest various different contractors being deployed. In this post we will cover the insights of this new malware, focusing on details." />
	<meta property="og:url" content="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/" />
	<meta property="og:site_name" content="Malwarebytes Labs" />
	<meta property="article:published_time" content="2022-03-04T17:18:26+00:00" />
	<meta property="article:modified_time" content="2022-03-05T03:58:48+00:00" />
	<meta property="og:image" content="https://blog.malwarebytes.com/wp-content/uploads/2016/04/night-computer-hdd-hard-drive-feature-1024x681.jpg" />
	<meta property="og:image:width" content="1024" />
	<meta property="og:image:height" content="681" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:creator" content="@malwarebytes" />
	<meta name="twitter:site" content="@malwarebytes" />
	<meta name="twitter:label1" content="Written by" />
	<meta name="twitter:data1" content="Threat Intelligence Team" />
	<meta name="twitter:label2" content="Est. reading time" />
	<meta name="twitter:data2" content="34 minutes" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://blog.malwarebytes.com/#website","url":"https://blog.malwarebytes.com/","name":"Malwarebytes Labs","description":"The Security Blog From Malwarebytes","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://blog.malwarebytes.com/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/#primaryimage","inLanguage":"en-US","url":"https://blog.malwarebytes.com/wp-content/uploads/2016/04/night-computer-hdd-hard-drive-feature.jpg","contentUrl":"https://blog.malwarebytes.com/wp-content/uploads/2016/04/night-computer-hdd-hard-drive-feature.jpg","width":6016,"height":4000},{"@type":"WebPage","@id":"https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/#webpage","url":"https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/","name":"HermeticWiper: A detailed analysis of the destructive malware that targeted Ukraine Looking at the internals of HermeticWiper","isPartOf":{"@id":"https://blog.malwarebytes.com/#website"},"primaryImageOfPage":{"@id":"https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/#primaryimage"},"datePublished":"2022-03-04T17:18:26+00:00","dateModified":"2022-03-05T03:58:48+00:00","author":{"@id":"https://blog.malwarebytes.com/#/schema/person/4d881617b9245231b3fc06670c79ffeb"},"description":"Ukraine is notoriously attacked by the Russia-linked disk wipers. The implementation and quality of those wipers vary, which may suggest various different contractors being deployed. In this post we will cover the insights of this new malware, focusing on details.","breadcrumb":{"@id":"https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/"]}]},{"@type":"BreadcrumbList","@id":"https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://blog.malwarebytes.com/"},{"@type":"ListItem","position":2,"name":"HermeticWiper: A detailed analysis of the destructive malware that targeted Ukraine"}]},{"@type":"Person","@id":"https://blog.malwarebytes.com/#/schema/person/4d881617b9245231b3fc06670c79ffeb","name":"Threat Intelligence Team","image":{"@type":"ImageObject","@id":"https://blog.malwarebytes.com/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/147cd7280d6ece931e4488a3a10809d9?s=96&d=identicon&r=g","contentUrl":"https://secure.gravatar.com/avatar/147cd7280d6ece931e4488a3a10809d9?s=96&d=identicon&r=g","caption":"Threat Intelligence Team"},"url":"https://blog.malwarebytes.com/author/threatintelligence/"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//secure.gravatar.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Malwarebytes Unpacked" href="http://blog.malwarebytes.org/feed/" />
<link rel="alternate" type="application/rss+xml" title="Malwarebytes Unpacked | Comments" href="http://blog.malwarebytes.org/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Malwarebytes Labs &raquo; HermeticWiper: A detailed analysis of the destructive malware that targeted Ukraine Comments Feed" href="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/blog.malwarebytes.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.8.3"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='jetpack_related-posts-css'  href='https://blog.malwarebytes.com/wp-content/plugins/jetpack/modules/related-posts/related-posts.css?ver=20211209' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://blog.malwarebytes.com/wp-includes/css/dist/block-library/style.min.css?ver=5.8.3' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<link rel='stylesheet' id='mediaelement-css'  href='https://blog.malwarebytes.com/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css?ver=4.2.16' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css'  href='https://blog.malwarebytes.com/wp-includes/js/mediaelement/wp-mediaelement.min.css?ver=5.8.3' type='text/css' media='all' />
<link rel='stylesheet' id='responsive-lightbox-prettyphoto-css'  href='https://blog.malwarebytes.com/wp-content/plugins/responsive-lightbox/assets/prettyphoto/prettyPhoto.min.css?ver=2.3.4' type='text/css' media='all' />
<link crossorigin="anonymous" rel='stylesheet' id='mb_labs-fonts-css'  href='//fonts.googleapis.com/css?family=Source+Sans+Pro%3A300%2C400%2C700%2C300italic%2C400italic%2C700italic%7CBitter%3A400%2C700&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='https://blog.malwarebytes.com/wp-content/plugins/jetpack/_inc/genericons/genericons/genericons.css?ver=3.1' type='text/css' media='all' />
<script type='text/javascript' id='jetpack_related-posts-js-extra'>
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-content/plugins/jetpack/_inc/build/related-posts/related-posts.min.js?ver=20211209' id='jetpack_related-posts-js'></script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-content/plugins/responsive-lightbox/assets/prettyphoto/jquery.prettyPhoto.min.js?ver=2.3.4' id='responsive-lightbox-prettyphoto-js'></script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-includes/js/underscore.min.js?ver=1.13.1' id='underscore-js'></script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-content/plugins/responsive-lightbox/assets/infinitescroll/infinite-scroll.pkgd.min.js?ver=5.8.3' id='responsive-lightbox-infinite-scroll-js'></script>
<script type='text/javascript' id='responsive-lightbox-js-extra'>
/* <![CDATA[ */
var rlArgs = {"script":"prettyphoto","selector":"lightbox","customEvents":"","activeGalleries":"1","animationSpeed":"normal","slideshow":"0","slideshowDelay":"5000","slideshowAutoplay":"0","opacity":"0.75","showTitle":"1","allowResize":"1","allowExpand":"1","width":"1080","height":"720","separator":"\/","theme":"pp_default","horizontalPadding":"20","hideFlash":"0","wmode":"opaque","videoAutoplay":"0","modal":"0","deeplinking":"0","overlayGallery":"1","keyboardShortcuts":"1","social":"0","woocommerce_gallery":"0","ajaxurl":"https:\/\/blog.malwarebytes.com\/wp-admin\/admin-ajax.php","nonce":"e919f81f08","preview":"false","postId":"54698"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-content/plugins/responsive-lightbox/js/front.js?ver=2.3.4' id='responsive-lightbox-js'></script>
<link rel="https://api.w.org/" href="https://blog.malwarebytes.com/wp-json/" /><link rel="alternate" type="application/json" href="https://blog.malwarebytes.com/wp-json/wp/v2/posts/54698" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.malwarebytes.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.malwarebytes.com/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://blog.malwarebytes.com/?p=54698' />
<link rel="alternate" type="application/json+oembed" href="https://blog.malwarebytes.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.malwarebytes.com%2Fthreat-intelligence%2F2022%2F03%2Fhermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://blog.malwarebytes.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.malwarebytes.com%2Fthreat-intelligence%2F2022%2F03%2Fhermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine%2F&#038;format=xml" />
	<style type="text/css" id="mb_labs-header-css">
			.site-header {
			background: url(https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/headers/circle.png) no-repeat scroll top;
			background-size: 1600px auto;
		}
		</style>
	<link rel="amphtml" href="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/amp/">    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.css" />
	<link rel="stylesheet" type="text/css" href="//www.malwarebytes.com/css/style.css?12-20-2016" />
	<link rel="stylesheet" type="text/css" href="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/style.css?05-11-2021" />


  <script src="//www.malwarebytes.com/js/jquery-1.11.3.min.js" type="text/javascript"></script>

<!-- OneTrust Cookies Consent Notice (Production Standard, malwarebytes.com, en-GB) start -->

<script src="https://optanon.blob.core.windows.net/consent/9530a107-0af8-4204-a2c2-217efb78222b.js" type="text/javascript" charset="UTF-8"></script>

<script type="text/javascript">

function OptanonWrapper() { }

</script>

<!-- OneTrust Cookies Consent Notice (Production Standard, malwarebytes.com, en-GB) end -->

  <script src="//www.malwarebytes.com/js/bootstrap.js" type="text/javascript"></script>
  <script src="//www.malwarebytes.com/js/ie-fixes/respond.min.js" type="text/javascript"></script>

<script src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/modernizr.js"></script>
<!--[if gte IE 9]><!-->
<script type="text/javascript" src="//www.malwarebytes.com/js/nav-resize.js"></script>
<!--<![endif]-->
	
  <script src="//www.malwarebytes.com/js/flexibility.js"></script>

  <!--<script src="//www.malwarebytes.com/js/nav.js"></script>-->
  <script>
function readCookie(name) {
  var nameEQ = name + "=";
  var ca = document.cookie.split(';');
  for (var i = 0; i < ca.length; i++) {
    var c = ca[i];
    while (c.charAt(0) == ' ') c = c.substring(1, c.length);
    if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
  }
  return null;
}

//disable functions based on cookie preference
var acceptCookies = readCookie('ce-cookie');
if (acceptCookies === "N") {
    $('body').css('visibility','visible');
    function setCookie() {
        return false;
    }
}
  
  
  
</script>
 
  <script src="//www.malwarebytes.com/js/global.js"></script>

  <script src="//www.malwarebytes.com/js/xs.js"></script>
  <script src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/js/search.js"></script>

<link rel="amphtml" href="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/amp/">
<script>
$(document).ready(function() {
  $("link[rel=amphtml]").each(function(){
    amphtml = $(this).attr("href");
    $(this).attr("href",amphtml.replace("/?amp","/amp"));
  });
});
</script>

<!-- New nav -->
<link href="//www.malwarebytes.com/css/NEW-NAV.css" rel="stylesheet" type="text/css">
<script src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/js/new-nav.js" type="text/javascript"></script>
<script src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/js/call-to-action.min.js" type="text/javascript"></script>
<script>
$(document).ready(function () {
    waitFor(function(){return global_variables.user.type !== null}, function(){
        if(global_variables.user.type.isBusinessLarge||global_variables.user.type.isBusinessSmall){
            default_changeGlobalNavPricing_changeGlobalNavCTA('true', {ctaURL : '//www.malwarebytes.com/pricing/business'});
        }
    })
}); 
</script>
</head>
<body>
<!-- Google Tag Manager -->
<noscript>
<iframe src="//www.googletagmanager.com/ns.html?id=GTM-MKSKW3"
height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MKSKW3');</script> 
<!-- End Google Tag Manager --> 

<!-- global nav -->
<nav id="mbnav" class="abtest">
    <div id="nav-background"></div>
    <div class="nav-container">
        <div class="logo">
            <a href="/" id="cta-navbar-company-logo-en-test">
                <script>
                  $('document').ready(function () {
                    setTimeout(function () {
                      $('#main-logo, #logo-tagline').attr('class', 'changed');
                    }, 3000);
                    setTimeout(function () {
                      $('#main-logo, #logo-tagline').attr('class', '');
                    }, 7000);
                  })
                </script>

                <svg version="1.1" id="main-logo" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="-672 235.9 278.5 31.1" style="enable-background:new -672 235.9 254.5 31.1;" xml:space="preserve" class="" aria-labelledby="malwarebytes-main-logo-title malwarebytes-main-logo-desc" role="img">
    <title id="malwarebytes-main-logo-title">The official Malwarebytes logo</title>
                    <desc id="malwarebytes-main-logo-desc">The official Malwarebytes logo in a blue font</desc>
                    <image src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/malwarebytes-labs-logo.png" xlink:href=""></image>
                    <style type="text/css">
                        .st0 {
                            fill: #0D3ECC !important;
                        }

                        .st1 {
                            fill: #414042;
                        }

                        .st2 {
                            fill: none;
                        }

                        .st3 {
                            enable-background: new;
                        }

                        .st4 {
                            fill: #FFFFFF;
                        }
                    </style>
                    <path id="logo-icon" class="st0" d="M-659.1,263.1C-659,263.1-659,263.1-659.1,263.1c0.3,0,0.4-0.2,0.4-0.4c0-0.2-0.1-0.3-0.3-0.4h-0.1h-0.2
  c-3.8-0.8-6.8-4.2-6.8-8.2c0-1.7,0.5-3.3,1.4-4.7c0.1-0.2,0.4-0.3,0.6-0.1l6.1,6.2c0.1,0.1,0.2,0.1,0.3,0.1s0.2,0,0.3-0.1l6.2-6.1
  c0.2-0.2,0.4-0.2,0.6,0c0.9,1.3,1.4,2.9,1.4,4.7c0,2.2-0.8,4.1-2.1,5.6c0,0-0.1,0.1-0.1,0.2v0.1c0,0.2,0.2,0.3,0.3,0.3l0,0
  c0,0,0.1,0,0.2-0.1c8.1-3.5,7.8-11.5,7.8-11.5c0-4.6-2.2-8.8-5.6-11.4c-0.2-0.1-0.4-0.1-0.5,0l-8.1,8.1c-0.2,0.2-0.4,0.2-0.5,0
  l-8.1-8.1c-0.1-0.1-0.4-0.2-0.5,0c-3.4,2.6-5.6,6.8-5.6,11.4l0,0C-672,256.2-666.3,262.3-659.1,263.1"></path>
                    <g id="logo-maintext">
                        <polygon class="st1" points="-446.9,260.3 -454.3,242.4 -461.7,260.4 -459.7,260.4 -458.3,256.8 -453.5,256.8 -457.4,254.5
    -454.3,246.9 -450.3,257.1 -453.8,257.1 -446.8,260.3   "></polygon>
                        <path class="st0" d="M-545.7,244L-545.7,244l-0.1-7.8c0-0.2-0.2-0.3-0.4-0.3l-2.2,0.3c-0.2,0-0.3,0.2-0.3,0.3v23.1
    c0,0.2,0.1,0.3,0.2,0.3c1.9,0.4,4.3,0.6,5.8,0.6c6.3,0,7.2-3,7.2-6.3v-6c0-3.5-1.6-5.3-4.9-5.3C-542.6,242.8-544.6,243.5-545.7,244
    z M-538.2,248v6.3c0,2.3-0.7,3.8-4.2,3.8c-1.2,0-2.3-0.1-3.4-0.2h-0.1v-11.3l0,0c1-0.5,3.1-1.3,4.7-1.3
    C-539.1,245.3-538.2,246.1-538.2,248z"></path>
                        <path class="st0" d="M-531.7,243.2h-2.1c-0.2,0-0.4,0.2-0.3,0.4l5.3,16.3c0,0.1,0.2,0.2,0.3,0.2h0.6c0.2,0,0.4,0.2,0.3,0.4
    l-2.1,6.1c-0.1,0.2,0.1,0.4,0.3,0.4h2c0.1,0,0.2-0.1,0.3-0.2l2.3-6.6l5.5-16.6c0.1-0.2-0.1-0.4-0.3-0.4h-2.1
    c-0.1,0-0.2,0.1-0.3,0.2l-4.4,13.8c-0.1,0.3-0.5,0.3-0.6,0l-4.4-13.8C-531.4,243.3-531.6,243.2-531.7,243.2z"></path>
                        <path class="st0" d="M-505.6,249.2v5.1c0,4.2,2.1,6.2,6.7,6.2c2,0,4.1-0.3,5.7-0.9c0.2,0,0.2-0.2,0.2-0.4l-0.3-1.6
    c0-0.2-0.2-0.3-0.4-0.2c-1.9,0.5-3.5,0.7-5,0.7c-3.5,0-4.1-1.3-4.1-3.8v-1.2c0-0.2,0.1-0.3,0.3-0.3h9.6c0.2,0,0.3-0.1,0.3-0.3v-3.2
    c0-4.3-2.1-6.4-6.3-6.4C-503.3,242.8-505.6,245-505.6,249.2z M-502.8,248.9c0-2.6,1.2-3.8,3.8-3.8s3.7,1.1,3.7,3.8v1.2
    c0,0.2-0.1,0.3-0.3,0.3h-6.9c-0.2,0-0.3-0.1-0.3-0.3L-502.8,248.9L-502.8,248.9z"></path>
                        <path class="st0" d="M-484.4,250.5c-2.9-0.7-3-1.1-3-3c0-1.6,0.4-2.2,2.9-2.2c1.2,0,2.9,0.2,4.3,0.4c0.2,0,0.4-0.1,0.4-0.3l0.2-1.7
    c0-0.2-0.1-0.3-0.2-0.3c-1.3-0.3-2.9-0.5-4.5-0.5c-4.2,0-5.8,1.2-5.8,4.5c0,3.5,0.4,4.4,4.6,5.4c3.4,0.8,3.6,1,3.6,2.9
    c0,1.8-0.4,2.4-3.2,2.4c-1.3,0-3.1-0.2-4.5-0.6c-0.2,0-0.4,0.1-0.4,0.2l-0.3,1.6c0,0.2,0.1,0.3,0.2,0.4c1.4,0.5,3.5,0.8,5.1,0.8
    c4.9,0,5.8-1.6,5.8-4.9C-479.2,252-479.8,251.6-484.4,250.5z"></path>
                        <g>
                            <path class="st0" d="M-613.7,259.9l-3-16.5c0-0.2,0.1-0.4,0.3-0.4h3.4c0.2,0,0.3,0.1,0.3,0.2l1.8,9.9c0,0.3,0.5,0.4,0.6,0l3-10
      c0-0.1,0.2-0.2,0.3-0.2h4c0.1,0,0.2,0.1,0.3,0.2l2.9,10c0.1,0.3,0.5,0.3,0.6,0l1.8-9.9c0-0.2,0.2-0.2,0.3-0.2h3.4
      c0.2,0,0.3,0.2,0.3,0.4l-3,16.5c0,0.2-0.2,0.2-0.3,0.2h-4.5c-0.1,0-0.2-0.1-0.3-0.2l-3.3-11c-0.1-0.3-0.5-0.3-0.6,0l-3.3,11
      c0,0.1-0.2,0.2-0.3,0.2h-4.5C-613.5,260.2-613.7,260.1-613.7,259.9z"></path>
                        </g>
                        <path class="st0" d="M-618.6,257c-1.5,0-2-0.7-2-2.6v-12.3v-4.9c0-0.2-0.2-0.3-0.4-0.3l-3.6,0.5c-0.2,0-0.3,0.2-0.3,0.3v0.2v4.2
    v12.8c0,3.9,2.4,5.6,5.5,5.6c0.3,0,1.5,0,2-0.1c0.2,0,0.3-0.2,0.3-0.3v-2.7c0-0.2-0.2-0.3-0.3-0.3C-617.8,257-618.3,257-618.6,257z
    "></path>
                        <g>
                            <path class="st0" d="M-566.9,246.8c-1.5,0.7-2.7,1.4-4.2,2.3c-0.1,0-0.2,0.2-0.2,0.3v10.5c0,0.2-0.1,0.3-0.3,0.3h-3.7
      c-0.2,0-0.3-0.1-0.3-0.3V244c0-0.2,0.1-0.3,0.2-0.3l3.1-0.5c0.2,0,0.3,0.1,0.4,0.2l0.2,1.1c0,0.2,0.3,0.3,0.5,0.2
      c0.9-0.6,2.5-1.5,3.7-1.9c0.2-0.1,0.4,0.1,0.4,0.3l0.4,3.3C-566.7,246.6-566.7,246.7-566.9,246.8z"></path>
                        </g>
                        <path class="st0" d="M-510,258.1c-1.7,0-1.8-0.8-1.8-2v-10.3c0-0.2,0.1-0.3,0.3-0.3h4c0.2,0,0.3-0.1,0.3-0.3l0.2-1.7
    c0-0.2-0.1-0.4-0.3-0.4h-4.2c-0.2,0-0.3-0.1-0.3-0.3v-3.9c0-0.2-0.2-0.3-0.4-0.3l-2.2,0.3c-0.2,0-0.3,0.2-0.3,0.3v3.7
    c0,0.2-0.1,0.3-0.3,0.3h-2.4c-0.2,0-0.3,0.1-0.3,0.3v1.7c0,0.2,0.1,0.3,0.3,0.3h2.4c0.2,0,0.3,0.1,0.3,0.3v10.8
    c0,2.7,1.2,3.8,4.2,3.8c0.7,0,1.3-0.1,2-0.2c0.2,0,0.2-0.2,0.2-0.3v-1.6c0-0.2-0.2-0.3-0.4-0.3C-509.1,258.1-509.5,258.1-510,258.1
    z"></path>
                        <path class="st2" d="M-557.3,246.2c-0.2,0-0.4,0-0.7,0c-2.1,0-2.8,1.1-2.8,2.7v1.5l0,0h5.4c0.2,0,0.3-0.1,0.3-0.3v-1.2
    C-555.1,247.4-555.7,246.4-557.3,246.2z"></path>
                        <path class="st0" d="M-554.5,243.3c-0.9-0.4-2.1-0.6-3.5-0.6c-1.6,0-3,0.3-4,0.8c-2.3,1.1-3.1,3.4-3.1,5.9v4.5c0,4,1.8,6.5,6.9,6.6
    c0.4,0,0.8,0,1.2,0c1.4,0,2.8-0.2,4.2-0.4c0.2,0,0.3-0.2,0.3-0.4v-0.2l-0.4-2.3l0,0c-1.3,0.1-2.4,0.2-3.7,0.2l0,0
    c-3.1,0-4.1-0.9-4.1-2.8V254l0,0v-0.8l0,0h9.2c0.2,0,0.3-0.1,0.3-0.3v-1.3v-2.1C-551.3,246.8-552,244.4-554.5,243.3z M-555.1,250.1
    c0,0.2-0.1,0.3-0.3,0.3h-5.4l0,0v-1.5c0-1.6,0.7-2.7,2.8-2.7c0.2,0,0.5,0,0.7,0c1.6,0.2,2.2,1.3,2.2,2.7V250.1z"></path>
                        <path class="st0" d="M-635.8,242.8c-1.5,0-3.1,0.1-4.5,0.3c-0.2,0-0.3,0.2-0.2,0.4l0.4,2.6c0,0.2,0.2,0.3,0.3,0.3
    c1.4-0.2,2.3-0.2,3.7-0.2c3.1,0,4.1,0.9,4.1,2.8v1.1c0,0.2-0.1,0.3-0.3,0.3h-4c-3.5,0-5.5,1.8-5.5,5c0,3,2.3,5.1,5.7,5.1
    c2.2,0,3-0.3,3.7-1c0.2-0.2,0.5,0,0.5,0.2v0.2c0,0.2,0.1,0.3,0.3,0.3h3.4c0.2,0,0.3-0.1,0.3-0.3V249
    C-627.9,244.8-630.8,242.8-635.8,242.8z M-632.1,253.8c0,2.1-1.5,3.6-3.7,3.6c-1.8,0-2.7-0.7-2.7-2.1c0-1.5,0.9-2.1,2.7-2.1h3.4
    c0.2,0,0.3,0.1,0.3,0.3V253.8z"></path>
                        <path class="st0" d="M-586.4,242.8c-1.5,0-3.1,0.1-4.5,0.3c-0.2,0-0.3,0.2-0.2,0.4l0.4,2.6c0,0.2,0.2,0.3,0.3,0.3
    c1.4-0.2,2.3-0.2,3.7-0.2c3.1,0,4.1,0.9,4.1,2.8v1.1c0,0.2-0.1,0.3-0.3,0.3h-4c-3.5,0-5.5,1.8-5.5,5c0,3,2.3,5.1,5.7,5.1
    c2.2,0,3-0.3,3.7-1c0.2-0.2,0.5,0,0.5,0.2v0.2c0,0.2,0.1,0.3,0.3,0.3h3.5c0.2,0,0.3-0.1,0.3-0.3V249
    C-578.4,244.8-581.4,242.8-586.4,242.8z M-582.7,253.8c0,2.1-1.5,3.6-3.7,3.6c-1.8,0-2.7-0.7-2.7-2.1c0-1.5,0.9-2.1,2.7-2.1h3.4
    c0.2,0,0.3,0.1,0.3,0.3C-582.7,253.5-582.7,253.8-582.7,253.8z"></path>
                        <path class="st1" d="M-424,260.4c-2.2,0-4.6-0.5-6.9-1.4l0.5-1.8c2.1,0.7,4.4,1.2,6.3,1.2c2.7,0,4.3-1.1,4.3-2.6
    c0-1.3-0.8-2-4.7-3.5c-4.4-1.6-5.9-2.8-5.9-5.4c0-2.8,2.3-4,6.4-4c1.8,0,4.3,0.3,6,0.9l-0.4,1.8c-1.7-0.4-3.7-0.7-5.5-0.7
    c-3,0-4.2,0.5-4.2,2c0,1.6,1.1,2.2,5.1,3.7c4.4,1.7,5.5,2.7,5.5,5.1C-417.4,258.5-420,260.4-424,260.4z"></path>
                        <g>
                            <path class="st1" d="M-462.7,260.3h-7.5c-1,0-1.6-0.4-1.9-0.7c-0.6-0.7-0.6-1.5-0.6-1.8v-15h1.8V258c0,0.1,0,0.3,0.1,0.4
      c0.1,0.1,0.4,0.2,0.5,0.2h7.5L-462.7,260.3L-462.7,260.3z"></path>
                        </g>
                        B <path class="st1" d="M-432.2,255.4c0-2.1-1-3.8-3.1-4.6c1.3-0.7,2.3-2,2.3-3.8c0-2.6-2-4.1-5.5-4.1h-7v14.5l0,0v0.4
    c0,0.2,0,1.1,0.6,1.8c0.3,0.4,0.9,0.7,1.9,0.7h4.9h0.1l0,0h0.3l0,0C-433.9,260.2-432.2,258-432.2,255.4z M-443.6,244.6h5.1
    c2.5,0,3.7,0.8,3.7,2.6s-1.2,3-3.5,3h-5.3L-443.6,244.6L-443.6,244.6z M-436.8,258.5h-6.2c-0.2,0-0.4,0-0.5-0.2
    c-0.1-0.1-0.1-0.4-0.1-0.4v-6h5.9c2.5,0,3.7,1.5,3.6,3.4C-434.2,257-435.1,258.2-436.8,258.5z"></path>
                    </g>
    </svg>
                <p id="logo-tagline" class="">We research. You level up.</p>
            </a>
        </div>
        <div id="mb-nav-icon" type="button" data-target="#navbar" data-toggle="collapse" role="button" aria-label="Open mobile menu" tabindex="0" aria-pressed="true" aria-haspopup="true" aria-expanded="false" aria-controls="navbar">&nbsp;
            <span class="firstline">&nbsp;</span>
            <span class="secondline">&nbsp;</span>
            <span class="thirdline">&nbsp;</span>
        </div>
        <div id="main-nav-menu">
            <div id="main-top-nav">
                <div class="navitem has-dropdown" data-submenu="personal-nav" tabindex="0" aria-haspopup="true" >
                    <span>Personal</span>
                    <div class="submenu">
                        <div class="submenu-container submenu-container-full">
                            <div class="submenu-box divider" role="menuitem">
                                <a href="javascript:void(0)"  data-submenu="personal-nav" tabindex="-1" class="main-nav-item nav-back-link"><span class="back-arrow"></span> Personal</a>
                                <div class="submenu-content">
                                    <ul>
                                        <li class="title" role="none">Security & Antivirus</li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/premium/" id="cta-navbar-windows-en-test" tabindex="-1">Malwarebytes for Windows</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/mac/" id="cta-navbar-mac-en-test" tabindex="-1">Malwarebytes for Mac</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/chromebook/" id="cta-navbar-chromebook-en-test" tabindex="-1">Malwarebytes for Chromebook</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/browserguard/" id="cta-navbar-browserguard-en-test" tabindex="-1">Malwarebytes Browser Guard</a></li>
                                        <li role="none"><a href="//www.malwarebytes.com/for-home/" id="cta-press-navbar-forhome-en-test" class="bold-link" tabindex="-1">Overview <img class="text-arrow" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="Overview of Malwarebytes products"></a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="submenu-box divider">
                                <div class="submenu-content">
                                    <ul>
                                        <li class="title" role="none">Security & Antivirus for Mobile</li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/android/" id="cta-navbar-android-en-test" tabindex="-1">Malwarebytes for Android</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/ios/" id="cta-navbar-ios-en-test" tabindex="-1">Malwarebytes for iOS</a></li>

                                        <li class="title" role="none">Online Privacy</li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/vpn/" id="cta-navbar-malwarebytes-privacy-en-test" tabindex="-1">Malwarebytes Privacy VPN</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="submenu-box divider">
                                <div class="submenu-content submenu-gradient">
                                    <ul>
                                        <li class="title" role="none">Get Started</li>
                                        <li role="none">
                                            <a href="//www.malwarebytes.com/for-home/products/" id="cta-navbar-viewall-en-test" class="bold-link" tabindex="-1">
                                                <img class="link-icon" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/icons/personal-icon.svg" alt="Personal Icon">
                                                Explore all Personal Products
                                            </a>
                                        </li>
                                        <li role="none">
                                            <a href="//www.malwarebytes.com/pricing/" id="cta-navbar-pricing-exp-en-test" class="bold-link" tabindex="-1">
                                                <img class="link-icon" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/icons/pricing-icon.svg" alt="Pricing Icon">
                                                Explore Pricing
                                            </a>
                                        </li>
                                        <li role="none">
                                            <a id="cta-navbar-freedownload-personaldropdown-en-test" href="//www.malwarebytes.com/mwb-download/thankyou/" class="free-download link-box" tabindex="-1">
                                                <div>
                                                    <h4>Free Trial of Malwarebytes Premium</h4>
                                                    <p>Protect your devices, your data, and your privacy—at home or on the go.</p>
                                                    <span class="cta-text">Get free trial <img class="text-arrow" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="Get a free trial"></span>
                                                </div>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="navitem has-dropdown" data-submenu="business-nav" tabindex="0">
                    <span>Business</span>
                    <div id="business-nav" class="submenu">
                        <div class="submenu-container submenu-container-full">
                            <div class="submenu-box divider solution-box">
                                <a href="javascript:void(0)" data-submenu="business-nav" tabindex="-1" class="main-nav-item nav-back-link"><span class="back-arrow"></span> Business</a>
                                <div class="submenu-content">
                                <ul>
                                    <div class="title" role="none"><a href="//www.malwarebytes.com/business/solutions" target="_self">Solutions</a></div>
                                    <li class="subtitle" role="none">BY COMPANY SIZE</li>
                                    <li class="link business-link link-height" role="none"><a href="//www.malwarebytes.com/business/solutions/small-business" id="cta-navbar-forbusiness-solutions-small-business-en" tabindex="-1">Small Business </a><div class="solution-line-height"><img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/nav/smb.svg" alt="single figure icon" width="14" height="15">&nbsp;<span style="color: #333333; font-size: 8pt; cursor: default;">1-99 Employees</span>&nbsp;<a href="//www.malwarebytes.com/pricing/business" id="cta-blog-navbar-pricing_business-click-en"><img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/nav/buy-label.svg" alt="Buy Online" width="74" height="18"></div></a></li>                                 
                                    <li class="link business-link link-height" role="none"><a href="//www.malwarebytes.com/business/solutions/mid-market/" id="cta-navbar-forbusiness-solutions-mid-market-en" tabindex="-1">Mid-size Businesses </a><div class="solution-line-height"><img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/nav/mid-size.svg" alt="two figure icon" width="19" height="15">&nbsp;<span style="color: #333333; font-size: 8pt; cursor: default;">100-999 Employees</span></div></li>                                   
                                    <li class="link business-link link-height" role="none"><a href="//www.malwarebytes.com/business/solutions/enterprise/" id="cta-navbar-forbusiness-solutions-enterprise-en" tabindex="-1">Large Enterprise </a><div class="solution-line-height"><img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/nav/large-ent.svg" alt="three figure icon" width="25" height="15">&nbsp;<span style="color: #333333; font-size: 8pt; cursor: default;">1000+ Empoyees</span></div></li>
                                    <li class="subtitle" role="none">BY INDUSTRY</li>
                                    <li class="link business-link" role="none"><a href="//www.malwarebytes.com/education/" id="cta-navbar-forbusiness-education-en" tabindex="-1">Education</a></li>
                                    <li class="link business-link" role="none"><a href="//www.malwarebytes.com/finance/" id="cta-navbar-forbusiness-finance-en" tabindex="-1">Finance</a></li>
                                    <li class="link business-link" role="none"><a href="//www.malwarebytes.com/healthcare/" id="cta-navbar-forbusiness-healthcare-en" tabindex="-1">Healthcare</a></li>
                                    <li class="link business-link" role="none"><a href="//www.malwarebytes.com/government/" id="cta-navbar-forbusiness-government-en" tabindex="-1">Government</a></li>
                                </ul>
                                </div>
                            </div>
                            <div class="submenu-box divider product-box">
                                <div class="submenu-content">
                                <ul>
                                    <div class="title" role="none"><a href="//www.malwarebytes.com/business/products" target="_self">Products</a></div>
                                    <li class="subtitle" role="none">CLOUD-BASED SECURITY MANAGEMENT AND SERVICES</li>
                                    <li class="link business-link" role="none"><a href="//www.malwarebytes.com/business/endpoint-protection/" id="cta-navbar-forbusiness-ep-en" tabindex="-1">Endpoint Protection</a></li>
                                    <li class="link business-link" role="none"><a href="//www.malwarebytes.com/business/endpoint-protection/server-security/" id="cta-navbar-forbusiness-ep-server-security-en" tabindex="-1">Endpoint Protection for Servers</a></li>
                                    <li class="link business-link" role="none"><a href="//www.malwarebytes.com/business/edr/" id="cta-navbar-forbusiness-edr-en" tabindex="-1">Endpoint Detection & Response</a></li>
                                    <li class="link business-link" role="none"><a href="//www.malwarebytes.com/business/edr/server-security/" id="cta-navbar-forbusiness-edr-server-security-en" tabindex="-1">Endpoint Detection & Response for Servers</a></li>
                                    <li class="link business-link" role="none"><a href="//www.malwarebytes.com/business/incident-response/" id="cta-navbar-forbusiness-ir-en" tabindex="-1">Incident Response</a></li>
                                    <li class="link business-link" role="none"><a href="//www.malwarebytes.com/business/services/malware-removal" id="cta-navbar-forbusiness-malware-removal-service-en" tabindex="-1">Malware Removal Service</a>&nbsp;<img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/nav/new.svg" alt="New" width="32" height="19"></li>
                                    <li class="link business-link" role="none"><a href="//www.malwarebytes.com/business/cloud/" id="cta-navbar-forbusiness-nebula-platform-architecture-en" tabindex="-1">Nebula Platform Architecture</a></li>

                                    <li class="subtitle" role="none">CLOUD-BASED SECURITY MODULES</li>
                                    <li class="link business-link" role="none"><a href="//www.malwarebytes.com/business/vulnerability-patch-management" id="cta-navbar-forbusiness-vulnerability-patch-management-en" tabindex="-1">Vulnerability & Patch Management</a>&nbsp;<img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/nav/new.svg" alt="New" width="32" height="19"></li>
                                    <li class="link business-link" role="none"><a href="//www.malwarebytes.com/business/crowdstrike/" id="cta-navbar-forbusiness-crowdstrike-en" tabindex="-1">Remediation for CrowdStrike®</a></li>
                                    
                                    <li class="subtitle" role="none">NEXT-GEN ANTIVIRUS FOR SMALL BUSINESS</li>
                                    <li class="link business-link" role="none"><a href="//www.malwarebytes.com/business/teams" id="cta-navbar-forbusiness-teams-en" tabindex="-1">For Teams</a></li>
                                    
                                </ul>
                                </div>
                            </div>
                            <div class="submenu-box divider">
                                <div class="submenu-content submenu-gradient">
                            <ul>
                                <li class="title" role="none">Get Started</li>
                                <li role="none"><div>
                                <ul>
                                <li class="section-label top-label" role="none">Find the right solution for your business</li>
                                <li role="none"><a href="//www.malwarebytes.com/pricing/business" id="cta-getstarted-pricing-business-en" class="bold-link" tabindex="-1"> <span class="cta-text">See business pricing <img class="text-arrow arrow-business" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="See business pricing"></span> </a></li>
                                </ul>
                                <hr>
                                <ul>
                                <li class="section-label" role="none">Don't know where to start?</li>
                                <li role="none"><a href="//www.malwarebytes.com/business/product-selector" id="cta-getstarted-business-productselector-en" class="bold-link" tabindex="-1"> <span class="cta-text">Help me choose a product <img class="text-arrow arrow-business" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="Help me choose a product"></span> </a></li>
                                </ul>
                                <hr>
                                <ul>
                                <li class="section-label" role="none">See what Malwarebytes can do for you</li>
                                <li role="none"><a href="//www.malwarebytes.com/business/request_trial?ref=nav" id="cta-getstarted-business-requesttrial-en" class="bold-link" tabindex="-1"> <span class="cta-text">Get a free trial <img class="text-arrow arrow-business" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="Request a trial"></span> </a></li>
                                </ul>
                                <hr>
                                <ul>
                                <li class="section-label" role="none">Our team is ready to help. Call us now</li>
                                <li class="section-label" role="none"><img class="phone-icon" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/nav/call.svg" alt="phone icon"> <span class="global-phonenum">+1-800-520-2796</span></li>
                                </ul>
                                </div></li>
                            </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="navitem" tabindex="0">
                    <a href="//www.malwarebytes.com/pricing/" class="pricing-link" id="cta-navbar-pricing-en-test" ><span>Pricing</span></a>
                </div>
                <div class="navitem has-dropdown" data-submenu="partners-nav" tabindex="0">
                    <span>Partners</span>
                    <div id="partner-nav" class="submenu">
                        <div class="submenu-container">
                            <div class="submenu-box"></div>
                            <div class="submenu-box divider">
                                <a  href="javascript:void(0)" data-submenu="partner-nav" tabindex="-1" class="main-nav-item nav-back-link"><span class="back-arrow"></span> Partners</a>
                                <div class="submenu-content">
                                    <div class="submenu-content submenu-gradient">
                                        <ul>
                                            <li role="none">
                                                <a href="//www.malwarebytes.com/partners/" id="cta-navbar-partners-explore-partnerships-en-test" class="bold-link" tabindex="-1">
                                                    <img class="link-icon" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/icons/partner-icon.svg" alt="Partner Icon">
                                                    Explore Partnerships
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                    <ul class="submenu-content divider-top">
                                        <li class="title" role="none">Partner Solutions</li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/partners/solution-providers/" id="cta-navbar-partners-solution-providers-en-test" tabindex="-1">Resellers</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/partners/managed-service-providers/" id="cta-navbar-partners-managed-service-providers-en-test" tabindex="-1">Managed Service Providers</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/techbench/" id="cta-navbar-partners-computer-repair-en-test" tabindex="-1">Computer Repair</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/integrations/" id="cta-navbar-partners-tech-partnerships-en-test" tabindex="-1">Technology Partners</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="submenu-box divider">
                                <div class="submenu-content submenu-gradient">
                                    <ul>
                                        <li class="title" role="none">Partner Success Story</li>
                                        <li class="partner-highlight" role="none">
                                            <div>
                                                <img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/partners/optimus-systems.webp" onerror='this.onerror = null; this.src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/partners/optimus-systems.png"' alt="Optimus Systems Logo">
                                            </div>
                                            <div class="name">Marek Drummond</div>
                                            <div class="position">Managing Director at Optimus Systems</div>
                                            <p>"Thanks to the Malwarebytes MSP program, we have this high-quality product in our stack. It’s a great addition, and I have confidence that customers’ systems are protected."</p>
                                        </li>
                                        <li role="none"><a href="https://resources.malwarebytes.com/casestudy/optimus-systems-delivers-trusted-desktop-security-services-malwarebytes-managed-services-provider/" id="cta-navbar-partners-featured-optimus-en-test" class="bold-link" tabindex="-1">See full story <img class="text-arrow" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="See the full story"></a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="navitem has-dropdown" data-submenu="resources-nav" tabindex="0">
                    <span>Resources</span>
                    <div id="resources-nav" class="submenu">
                        <div class="submenu-container submenu-container-full">
                            <div class="submenu-box divider">
                                <a  href="javascript:void(0)" data-submenu="resources-nav" tabindex="-1" class="main-nav-item nav-back-link"><span class="back-arrow"></span> Resources</a>
                                <div class="submenu-content">
                                    <ul>
                                        <li class="title" role="none">Learn About Cybersecurity</li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/antivirus/" id="cta-navbar-resources-antivirus-en-test" tabindex="-1">Antivirus</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/malware/" id="cta-navbar-resources-malware-en-test" tabindex="-1">Malware</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/ransomware/" id="cta-navbar-resources-ransomware-en-test" tabindex="-1">Ransomware</a></li>
                                        <li role="none"><a href="//www.malwarebytes.com/cybersecurity/" id="cta-navbar-resources-pillarhub-en-test" class="bold-link" tabindex="-1">See all <img class="text-arrow" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="See all"></a></li>

                                        <li class="title" role="none">Malwarebytes Labs</li>
                                        <li role="none"><a href="https://blog.malwarebytes.com/" id="cta-navbar-resources-blog-en-test" class="bold-link" tabindex="-1">Explore <img class="text-arrow" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="Explore the Malwarebytes blog"></a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="submenu-box divider">
                                <div class="submenu-content">
                                    <ul>
                                        <li class="title" role="none">Business Resources</li>
                                        <li class="link" role="none"><a href="https://resources.malwarebytes.com/#reviews" id="cta-navbar-resources-reviews-en-test" tabindex="-1">Reviews</a></li>
                                        <li class="link" role="none"><a href="https://resources.malwarebytes.com/#analyst-reports" id="cta-navbar-resources-analyst-reports-en-test" tabindex="-1">Analyst Reports</a></li>
                                        <li class="link" role="none"><a href="https://resources.malwarebytes.com/casestudies/" id="cta-navbar-resources-casestudies-en-test" tabindex="-1">Case Studies</a></li>
                                        <li role="none"><a href="https://resources.malwarebytes.com/" id="cta-navbar-resources-viewall-en-test" class="bold-link" tabindex="-1">See all <img class="text-arrow" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="See all resources"></a></li>

                                        <li class="title" role="none">Press & News</li>
                                        <li role="none"><a href="https://press.malwarebytes.com/" id="cta-navbar-resources-news-press-en-test" class="bold-link" tabindex="-1">Learn more <img class="text-arrow" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="Learn more"></a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="submenu-box divider">
                                <div class="submenu-content submenu-gradient">
                                    <ul>
                                        <li class="title" role="none">Events</li>
                                        <li>
                                            <img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/rsa2021.jpg" alt="RSA 2021" width="250px">
                                            <br><br>
                                            <p><span class="title">Featured Event:</span> RSA 2021</p>
                                        </li>
                                        <li role="none"><a href="https://www.rsaconference.com/usa" id="cta-navbar-resources-featured-rsa-en-text" class="bold-link" tabindex="-1">See Event <img class="text-arrow" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="See event"></a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="navitem has-dropdown" data-submenu="support-nav" tabindex="0">
                    <span>Support</span>
                    <div id="support-nav" class="submenu">
                        <div class="submenu-container">
                            <div class="submenu-box"></div>
                            <div class="submenu-box divider">
                                <a href="javascript:void(0)" data-submenu="support-nav" tabindex="-1" class="main-nav-item nav-back-link"><span class="back-arrow"></span> Support</a>
                                <div class="submenu-content">
                                    <ul class="submenu-content">
                                        <li class="title" role="none">Technical Support</li>
                                        <li class="link" role="none"><a href="https://support.malwarebytes.com/hc/en-us" id="cta-navbar-support-en-test" tabindex="-1">Support</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/business/services/" id="cta-navbar-support-business_services-en-test" tabindex="-1">Premium Services</a></li>
                                        <li class="link" role="none"><a href="https://forums.malwarebytes.com/" id="cta-navbar-support-forum-en-test" tabindex="-1">Forums</a></li>
                                        <li class="link" role="none"><a href="//www.malwarebytes.com/secure/" id="cta-navbar-support-vulnerability_disclosure-en-test" tabindex="-1">Vulnerability Disclosure</a></li>
                                    </ul>
                                    <div class="submenu-content submenu-gradient divider-top">
                                        <ul>
                                            <li role="none">
                                                <a href="https://www.youtube.com/channel/UCB7JQhkZpiyvGPufW2RPBoQ" id="cta-navbar-support-support_services-en-test" class="bold-link" tabindex="-1">
                                                    <img class="link-icon" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/icons/watch-personal-icon.svg" alt="Watch Icon">
                                                    Training for Personal Products
                                                </a>
                                            </li>
                                            <li role="none">
                                                <a href="//www.malwarebytes.com/business/academy/" id="cta-navbar-support-training_for_business-en-test" class="bold-link" tabindex="-1">
                                                    <img class="link-icon" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/icons/watch-business-icon.svg" alt="Watch Icon">
                                                    Training for Business Products
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="submenu-box divider">
                                <div class="submenu-content">
                                    <ul class="submenu-content submenu-gradient">
                                        <li class="title" role="none">Featured Content</li>
                                        <li role="none">
                                            <img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/privacy.svg" alt="Privacy Logo">
                                            <br>
                                            <br>
                                            <p>Activate Malwarebytes Privacy on Windows device.</p>
                                        </li>
                                        <li role="none"><a href="https://support.malwarebytes.com/hc/en-us/articles/360046199873-Activate-Malwarebytes-Privacy-on-Windows-device" id="cta-navbar-support-privacy_activation-en-test" class="bold-link" tabindex="-1">See Content <img class="text-arrow" src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/refreshed_homepage/arrow.svg" alt="See content"></a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div>
                  <a id="cta-navbar-freedownload-main-en-test" href="//www.malwarebytes.com/mwb-download/thankyou/" class="free-download nav-download-btn">FREE DOWNLOAD</a>
                </div>
            </div>
            <div id="main-util-nav">
                <div class="navitem-caps">
                    <a href="//www.malwarebytes.com/contact/" id="cta-navbar-company-contactus-en-test">CONTACT US</a>
                </div>
                <div class="navitem-caps has-dropdown" data-submenu="company-nav" tabindex="0">
                    <span>COMPANY</span>
                    <div id="company-nav" class="submenu">
                        <div class="submenu-container">
                            <div class="submenu-box">
                                <a href="javascript:void(0)" data-submenu="company-nav" tabindex="-1" class="main-nav-item nav-back-link"><span class="back-arrow"></span> Company</a>
                                <ul>
                                    <li class="link" role="none"><a href="//www.malwarebytes.com/company/" id="cta-utilbar-company-aboutus-en-test" tabindex="-1">About Malwarebytes</a></li>
                                    <li class="link" role="none"><a href="https://jobs.malwarebytes.com/" id="cta-utilbar-company-careers-en-test" tabindex="-1">Careers</a></li>
                                    <li class="link" role="none"><a href="https://press.malwarebytes.com/" id="cta-utilbar-company-news-press-en-test" tabindex="-1">News & Press</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="navitem-caps has-dropdown" data-submenu="signin-nav" tabindex="0">
                    <span>SIGN IN</span>
                    <div id="signin-nav" class="submenu">
                        <div class="submenu-container">
                            <div class="submenu-box">
                                <a href="javascript:void(0)" data-submenu="signin-nav" tabindex="-1" class="main-nav-item nav-back-link"><span class="back-arrow"></span> Sign In</a>
                                <ul>
                                    <li class="link" role="none">
                                        <a href="https://my.malwarebytes.com/en/login/" id="cta-utilbar-login-myaccount-en-test" tabindex="-1">My Account</a>
                                    </li>
                                    <li class="link" role="none">
                                        <a href="https://cloud.malwarebytes.com/" id="cta-utilbar-login-cloud-console-en-test" tabindex="-1">Cloud Console</a>
                                    </li>
                                    <li class="link">
                                        <a href="https://partners.malwarebytes.com/English/" id="cta-utilbar-partner-portal-en-test">Partner Portal</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</nav>

<div id="labs-sub-nav">
    <div class="container">
        <div class="row">
            <div class="col-md-4 col-xs-6" id="search-section">
                <form id="search-form" onsubmit="submitSearchrightrail(event)" method="get">
                    <div class="searchbar-wrap-rightrail">
                        <label for="cta-labs-rightrail-search-submit-en" aria-label="cta-labs-rightrail-search-submit-en" aria-labelledby="cta-labs-rightrail-search-submit-en">
                            <input type="text" id="st-search-input-rightrail" class="st-search-input-rightrail"
                            placeholder="Search Labs" />
                        </label>
                        <button type="submit" id="cta-labs-rightrail-search-submit-en" aria-label="Submit your search query" /><span class=""><img
                                src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/search.svg" alt="Magnifying glass"></span>
                    </div>

                </form>
            </div>
            <div class="col-md-offset-4 col-md-4 col-xs-6" id="social">
                <div class="left col-lg-6 col-md-8 col-sm-7">
                    <a href="https://www.malwarebytes.com/newsletter/?email=&source=labs"
                        class="subscribe-btn">SUBSCRIBE</a>
                    <a href="https://blog.malwarebytes.com/feed/" target="_blank" class="socicon-rss" aria-label="Subscribe to Malwarebytes Labs RSS Feed"></a>
                </div>
                <div class="right col-lg-5 col-md-4 col-sm-4 col-xs-9">
                    <a class="social socicon-facebook" href="https://www.facebook.com/Malwarebytes/"
                        id="social-follow-facebook" target="_blank" aria-label="Visit Malwarebytes on Facebook"></a>
                    <a class="social socicon-twitter" href="https://twitter.com/malwarebytes" id="social-follow-twitter"
                        target="_blank" aria-label="Visit Malwarebytes on Twitter"></a>
                    <a class="social socicon-linkedin" href="https://www.linkedin.com/company/malwarebytes"
                        id="social-follow-linkedin" target="_blank" aria-label="Visit Malwarebytes on LinkedIn"></a>
                </div>
            </div>
        </div>
    </div>
</div><script>window.global_variables = {
when: new Date(),
site : {
language: 'en',
country: 'us'
}
}</script>
<script src="https://www.malwarebytes.com/js/global_mwb.min.js?v=34556"></script>
<script src="https://www.malwarebytes.com/js/personalization/user.min.js?v=141053055"></script>
<link rel="stylesheet" type="text/css" href="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/css/styles.promobanners.min.css" />
<div class='active promotion-banner  topbelow gradient-green'>  <div class='banner-container container'>    
  <div class='col-lg-12 banner-content'>
  <p><span class="promobanner-text">Level Up to Cloud-Based Business Protection.&nbsp;</span><a class="promobanner-link" id="cta-homepage-cybercrimedemographics-banner-en" tagret="_blank" href="https://www.malwarebytes.com/pricing/business">Save 25% Today ></a></p> 
     </div>  </div>  <button class="close-banner"><img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/close.svg" alt="close x"></button></div>
<script src="https://www.malwarebytes.com/components/promo-banner/promo-banner.min.js?v=277391195"></script>
<script src="https://www.malwarebytes.com/js/ecommerce/nodiscountcountries.js"></script>
<script>
  $(document).ready(function () {
    components_promoBanner_Visibility({ selector: ".promotion-banner", showForBusinessLarge: false, countriesToHide: noDiscountCountries });
  });
</script>
<script>
$(document).ready(function () {
  var banner = document.getElementsByClassName('promotion-banner')[0];
  function initBanner() {
      var closeBtn = banner.getElementsByClassName('close-banner')[0];
      closeBtn &&
        closeBtn.addEventListener('click', function () {
          banner.classList.remove('active');
        });
  }
    initBanner();
});
</script>

<script type="text/javascript">  
  $(function () {

    var navlinks = document.getElementsByClassName('has-dropdown');
    var mainNav = document.getElementById('main-nav-menu');
    var navBackLinks = document.getElementsByClassName('nav-back-link');
    var currentOpenNav = null;

    window.isMac = navigator.platform.match(/(Mac)/i) ? true : false;
    window.isWindows = navigator.userAgent.match(/(Windows)/i) ? true : false;
    window.isAndroid = navigator.userAgent.match(/(Android)/i) ? true : false;
    window.isiPhone = navigator.platform.match(/(iPhone)/i) ? true : false;
    window.isiPad = navigator.platform.match(/(iPad)/i) ? true : false;
    window.isChromeOS = (/\bCrOS\b/.test(navigator.userAgent)) ? true : false;

    var freeDownloadLinkElms = document.getElementsByClassName('free-download');
    var freeDownloadLink = "https://www.malwarebytes.com/mwb-download/thankyou/";

    if (isMac == true) {
      freeDownloadLink = "https://www.malwarebytes.com/mac-download/";
    }
    else if (isiPad || isiPhone) {
      freeDownloadLink = "https://go.onelink.me/app/633d1f14";
    }
    else if (isAndroid) {
      freeDownloadLink = "https://go.onelink.me/app/516cebeb";
    }
    else if (isChromeOS) {
      freeDownloadLink = "https://go.onelink.me/app/fe20dca8";
    }

    for(var i=0; i < freeDownloadLinkElms.length; i++) {
      freeDownloadLinkElms[i].setAttribute('href', freeDownloadLink);
    }

    var outsideClickClose = function(e) {
      closeNav(currentOpenNav);
    };

    var openNav = function(newNav, currentNav) {
      closeNav(currentNav);
      newNav.classList.add('open');
      var subMenu = newNav.getElementsByClassName('submenu')[0];
      if(isSubmenuTooLong(subMenu)) {
        subMenu.classList.add('submenu-scroll');
      } else {
        subMenu.classList.remove('submenu-scroll');
      }
      window.addEventListener('click', outsideClickClose);
      return newNav;
    };

    var isSubmenuTooLong = function(subMenuElm) {
      var subMenuContainer = subMenuElm.getElementsByClassName('submenu-container')[0];
      var subMenuContainerHeight = subMenuContainer.offsetHeight;
      var windowHeightMinusNav = window.innerHeight - 100;
      if(windowHeightMinusNav < subMenuContainerHeight) {
        return true;
      }
      return false;
    }

    var closeNav = function(currentNav) {
      if(!currentNav) return;
      window.removeEventListener('click', outsideClickClose);
      currentNav.classList.remove('open');
      currentNav.blur();
      currentOpenNav = null;
    };

    for(var i=0; i < navlinks.length; i++) {
      var navItem = navlinks[i];

      navItem.addEventListener('click', function(event) {
        event.stopPropagation();

        if(currentOpenNav && this.dataset.submenu === currentOpenNav.dataset.submenu) return;

        console.log('click');
        currentOpenNav = openNav(this, currentOpenNav);

      });

    };

    for(var i=0; i < navBackLinks.length; i++) {
      var navBackItem = navBackLinks[i];

      navBackItem.addEventListener('click', function(event) {
        event.stopPropagation();
        console.log('back click');
        closeNav(currentOpenNav);
      });
    }

    document.getElementById('mb-nav-icon').addEventListener('click', function(e) {

      if(this.classList.contains('open')) {
        document.documentElement.style.overflow = null;
        this.classList.remove('open');
        mainNav.classList.remove('open');
        closeNav(currentOpenNav);
      } else {
        document.documentElement.style.overflow = 'hidden';
        this.classList.add('open');
        mainNav.classList.add('open');
      }

    });

    var b2bRegex = /^\/business\/|^\/pricing\/business\/|^\/education\/|^\/finance\/|^\/healthcare\/|^\/partners\/|^\/government\//;

    if(b2bRegex.test(window.location.pathname)){
      $('.pricing-link').attr('href', '//www.malwarebytes.com/pricing/business/');
    }

  })
</script>
 

 
<!--
Start of DoubleClick Floodlight Tag: Please do not remove
Activity name of this tag: security blog articles
URL of the webpage where the tag is expected to be placed: https://blog.malwarebytes.com/
This tag must be placed between the <body> and </body> tags, as close as possible to the opening tag.
Creation Date: 05/20/2016
-->
<script type="text/plain" class="optanon-category-4">
var axel = Math.random() + "";
var a = axel * 10000000000000;
$('body').append('<iframe src="https://5118230.fls.doubleclick.net/activityi;src=5118230;type=count0;cat=secur00;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num=' + a + '?" width="1" height="1" frameborder="0" style="display:none"></iframe>');
</script>
<noscript>
<iframe src="https://5118230.fls.doubleclick.net/activityi;src=5118230;type=count0;cat=secur00;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num=1?" width="1" height="1" frameborder="0" style="display:none"></iframe>
</noscript>
<!-- End of DoubleClick Floodlight Tag: Please do not remove -->


<div class="wrapper" id="post">
           

  
  
<article id="single-post" class="h-entry">
  <section>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://google.com/article"
  },
  "headline": "HermeticWiper: A detailed analysis of the destructive malware that targeted Ukraine",
  "image": {
    "@type": "ImageObject",
    "url": "https://blog.malwarebytes.com/wp-content/uploads/2016/04/night-computer-hdd-hard-drive-feature-604x270.jpg",
    "height": 405,
    "width": 720
  },
  "datePublished": "March 4, 2022",
  "dateModified": "March 4, 2022",
  "author": {
    "@type": "Person",
    "name": "Threat Intelligence Team"
  },
   "publisher": {
    "@type": "Organization",
    "name": "Malwarebytes",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.malwarebytes.com/images/mb-logo-2.png",
      "width": 600,
      "height": 60
    }
  },
  "description": "Hours before the invasion of Ukraine by Russian forces, a new piece of malware was launched at Ukrainian targets. In this blog post, we take apart its components and highlight its capabilities."
}
</script>

<div class="container">
  <div class="row">

    <div class="col-md-8" id="content">
      <div>
          <P><img src="https://blog.malwarebytes.com/wp-content/uploads/2016/04/night-computer-hdd-hard-drive-feature.jpg" alt="HermeticWiper: A detailed analysis of the destructive malware that targeted Ukraine"></P>
            <p class="breadcrumbs hidden-xs"><a href="https://blog.malwarebytes.com/category/threat-intelligence/" rel="category tag">Threat Intelligence</a></p>
       <h1 class="entry-title p-name">
					HermeticWiper: A detailed analysis of the destructive malware that targeted Ukraine				</h1>
      <p class="small">Posted: <span class="published"><time class="dt-published" datetime="March 4, 2022">March 4, 2022</time></span> by <span class="vcard author p-author h-card"><a href="https://blog.malwarebytes.com/author/threatintelligence/" title="Posts by Threat Intelligence Team" rel="author">Threat Intelligence Team</a></span> 
       
       <!-- shows last modified date if modified from original post -->
                
      </p>
      <div class="entry-summary p-summary" style="display:none;">Hours before the invasion of Ukraine by Russian forces, a new piece of malware was launched at Ukrainian targets. In this blog post, we take apart its components and highlight its capabilities.</div>
           <div class="post-content entry-content e-content" id="articleBody" itemprop="articleBody"> 
<p><em>This blog post was authored by Hasherezade, Ankur Saini and Roberto Santos</em></p>



<p>Disk wipers are one particular type of malware often used against Ukraine. The implementation and quality of those wipers vary, and may suggest different hired developers.</p>



<p>The day before the invasion on Ukraine by Russian forces on February 24, a <a href="https://twitter.com/ESETresearch/status/1496581903205511181?s=20&amp;t=5Zz6kStjdzGh2bRaH32DCA" target="_blank" rel="noreferrer noopener">new data wiper</a> was found to be unleashed against a number of Ukrainian entities. This malware was given the name &#8220;HermeticWiper&#8221; based on a stolen digital certificate from a company called Hermetica Digital Ltd.</p>



<p>This wiper is remarkable for its ability to bypass Windows security features and gain write access to many low-level data-structures on the disk. In addition, the attackers wanted to fragment files on disk and overwrite them to make recovery impossible.</p>



<p>As we were analyzing this data wiper, <a href="https://www.welivesecurity.com/2022/03/01/isaacwiper-hermeticwizard-wiper-worm-targeting-ukraine/" target="_blank" rel="noreferrer noopener">other research</a> has come out detailing additional components were used in this campaign, including a worm and typical ransomware thankfully <a href="https://www.crowdstrike.com/blog/how-to-decrypt-the-partyticket-ransomware-targeting-ukraine/" target="_blank" rel="noreferrer noopener">poorly implemented</a> and decryptable.</p>



<p>We obtained <a rel="noreferrer noopener" href="https://samples.vx-underground.org/APTs/2022/2022.02.23(2)/Samples/" target="_blank">samples</a> and in this post we will take apart this new malware.</p>



<h2 id="behavioral-analysis">Behavioral analysis</h2>



<p>First, what we see is a 32 bit Windows executable with an icon resembling a gift. It is not a cynical joke of the attackers, but just a standard icon for a Visual Studio GUI project.</p>



<div class="wp-block-image"><figure class="aligncenter size-full is-resized"><img data-attachment-id="54711" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/sample/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/sample.png" data-orig-size="98,111" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="sample" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/sample.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/sample.png" loading="lazy" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/sample.png" alt="Icon used by HermeticWiper" class="wp-image-54711" width="97" height="110" /><figcaption><em>Icon used by HermeticWiper</em></figcaption></figure></div>



<p>It has to be run as Administrator in order to work, and does not involve any UAC bypass techniques. As we will later find out, the name of the sample also (slightly) affects its functionality;  if the name starts with &#8220;c&#8221; (or &#8220;C&#8221;, as it is automatically converted to lowercase) the system will also reboot after execution.</p>



<p>Once run, the sample works silently in the background. For several minutes we may not notice anything suspicious. </p>



<p>Only if we watch the sample using tools like Process Explorer, we can notice some unusual actions. It calls various IOCTLs, related to retrieving details about the disks:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/create_and_delete.png" data-rel="lightbox-image-0" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54709" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/create_and_delete/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/create_and_delete.png" data-orig-size="1079,346" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="create_and_delete" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/create_and_delete-300x96.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/create_and_delete-600x192.png" loading="lazy" width="1079" height="346" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/create_and_delete.png" alt="Example of actions performed by HermeticWiper, seen in ProcessMonitor" class="wp-image-54709" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/create_and_delete.png 1079w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/create_and_delete-300x96.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/create_and_delete-600x192.png 600w" sizes="(max-width: 1079px) 100vw, 1079px" /></a><figcaption><em>Example of actions performed by HermeticWiper, seen in ProcessMonitor</em></figcaption></figure></div>



<p>&#8230;including <code><a href="https://docs.microsoft.com/en-us/windows/win32/api/winioctl/ni-winioctl-fsctl_get_retrieval_pointers" target="_blank" rel="noreferrer noopener"><span class="has-inline-color has-vivid-purple-color">FSCTL_GET_RETRIEVAL_POINTERS</span></a></code> and <code><a href="https://docs.microsoft.com/en-us/windows/win32/api/winioctl/ni-winioctl-fsctl_move_file" target="_blank" rel="noreferrer noopener"><span class="has-inline-color has-vivid-purple-color">FSCTL_MOVE_FILE</span></a></code> which can <a href="https://docs.microsoft.com/en-us/windows/win32/fileio/defragmenting-files" target="_blank" rel="noreferrer noopener">remind of files defragmentation</a>*. </p>



<p>[<em>*] Note, that at the low-level, files may not be kept in a filesystem in one continuous chunk (as we see them at high-level), but in multiple chunks, stored in the various sectors of the disk. Defragmentation is related to consolidating those chunks, and fragmentation &#8211; to splitting them.</em></p>



<figure class="wp-block-image size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/ioctls_content.png" data-rel="lightbox-image-1" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54710" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/ioctls_content/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/ioctls_content.png" data-orig-size="1328,200" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ioctls_content" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/ioctls_content-300x45.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/ioctls_content-600x90.png" loading="lazy" width="1328" height="200" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/ioctls_content.png" alt="" class="wp-image-54710" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/ioctls_content.png 1328w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/ioctls_content-300x45.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/ioctls_content-600x90.png 600w" sizes="(max-width: 1328px) 100vw, 1328px" /></a></figure>



<p>However, further examination has shown that the effect here is the opposite of defragmentation. In fact, the data gets more fragmented as a result of the malware execution.</p>



<p>The disk status regarding data fragmentation, before and after the malware execution, can be checked in the following images:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="54811" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/image-1-5/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-1.png" data-orig-size="1055,500" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-1" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-1-300x142.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-1-600x284.png" loading="lazy" width="1055" height="500" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-1.png" alt="" class="wp-image-54811" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-1.png 1055w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-1-300x142.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-1-600x284.png 600w" sizes="(max-width: 1055px) 100vw, 1055px" /><figcaption><em>Disk status before fragmentation</em></figcaption></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="54813" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/image-2-5/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-2.png" data-orig-size="1149,546" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-2" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-2-300x143.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-2-600x285.png" loading="lazy" width="1149" height="546" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-2.png" alt="Disk status after fragmentation" class="wp-image-54813" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-2.png 1149w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-2-300x143.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-2-600x285.png 600w" sizes="(max-width: 1149px) 100vw, 1149px" /><figcaption><em>Disk status after fragmentation</em></figcaption></figure></div>



<p>This is probably made in order to escalate the created damage: the more fragmented the file is, the more difficult it is to carve it out from the raw disk image, and reconstruct it forensically.</p>



<p>As the execution progresses, at some point, we may realize that some applications stopped working. It is because of the fact that some files, including system DLLs, have been overwritten with random data.</p>



<p>Example: an application failed to run because of a system DLL being trashed:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/bad_image_error.png" data-rel="lightbox-image-2" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54699" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/bad_image_error/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/bad_image_error.png" data-orig-size="512,235" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="bad_image_error" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/bad_image_error-300x138.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/bad_image_error.png" loading="lazy" width="512" height="235" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/bad_image_error.png" alt="Example of an error caused by the wiper" class="wp-image-54699" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/bad_image_error.png 512w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/bad_image_error-300x138.png 300w" sizes="(max-width: 512px) 100vw, 512px" /></a><figcaption><em>Example of an error caused by the wiper</em></figcaption></figure></div>



<p>If we now view the raw image of the disk (i.e. using HxD), we can notice that some sectors have been also overwritten with random data:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwrtitten_disk.png" data-rel="lightbox-image-3" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54701" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/overwrtitten_disk/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwrtitten_disk.png" data-orig-size="774,338" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="overwrtitten_disk" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwrtitten_disk-300x131.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwrtitten_disk-600x262.png" loading="lazy" width="774" height="338" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwrtitten_disk.png" alt="Sector overwritten by HermeticWiper, seen in HxD" class="wp-image-54701" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwrtitten_disk.png 774w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwrtitten_disk-300x131.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwrtitten_disk-600x262.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwrtitten_disk-195x85.png 195w" sizes="(max-width: 774px) 100vw, 774px" /></a><figcaption><em>Sector overwritten by HermeticWiper, seen in HxD</em></figcaption></figure></div>



<p>Not surprisingly, on reboot our Windows OS will no longer work:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/os_missing.png" data-rel="lightbox-image-4" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54702" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/os_missing/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/os_missing.png" data-orig-size="728,407" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="os_missing" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/os_missing-300x168.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/os_missing-600x335.png" loading="lazy" width="728" height="407" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/os_missing.png" alt="Message shown to the user after corruption of data" class="wp-image-54702" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/os_missing.png 728w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/os_missing-300x168.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/os_missing-600x335.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/os_missing-400x225.png 400w" sizes="(max-width: 728px) 100vw, 728px" /></a><figcaption><em>Message shown to the user after the reboot of the corrupt system</em></figcaption></figure></div>



<p>But what exactly happened underneath? Let’s have a closer look…</p>



<h2>Used components</h2>



<p>The initial sample: <a rel="noreferrer noopener" href="https://www.virustotal.com/gui/file/1bc44eef75779e3ca1eefb8ff5a64807dbc942b1e4a2672d77b9f6928d292591" target="_blank">1bc44eef75779e3ca1eefb8ff5a64807dbc942b1e4a2672d77b9f6928d292591</a> &#8211; comes with several PE files in its resources:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/drivers_in_resources.png" data-rel="lightbox-image-5" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54703" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/drivers_in_resources/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/drivers_in_resources.png" data-orig-size="1212,395" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="drivers_in_resources" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/drivers_in_resources-300x98.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/drivers_in_resources-600x196.png" loading="lazy" width="600" height="196" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/drivers_in_resources-600x196.png" alt="Resources of the malware" class="wp-image-54703" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/drivers_in_resources-600x196.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/drivers_in_resources-300x98.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/drivers_in_resources.png 1212w" sizes="(max-width: 600px) 100vw, 600px" /></a><figcaption><em>Resources of the malware</em></figcaption></figure></div>



<p>The names chosen for the resources (<code>DRV_X64</code>, <code>DRV_X86</code>, <code>DRV_XP_X86</code>, <code>DRV_XP_X64</code>) suggest that they are a version of the same driver, dedicated to different versions of Windows: appropriately 32 or 64 bit version, or a legacy version for Windows XP. Each of them is in compressed form. By checking the dumped files by the Linux <code>file</code> command, we can see the following output:</p>



<pre class="wp-block-preformatted">file DRV_XP_X86<strong>
DRV_XP_X86: MS Compress archive data, SZDD variant, original size: 13896 bytes</strong></pre>



<p>To find out how they are loaded, we need to have a look at the sample that carries them.</p>



<p>Fortunately, the sample is not obfuscated. We can easily find the fragment that is responsible for finding the appropriate version of the driver:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/searching_driver_res.png" data-rel="lightbox-image-6" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54704" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/searching_driver_res/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/searching_driver_res.png" data-orig-size="517,497" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="searching_driver_res" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/searching_driver_res-300x288.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/searching_driver_res.png" loading="lazy" width="517" height="497" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/searching_driver_res.png" alt="HermeticWiper selecting which driver will load" class="wp-image-54704" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/searching_driver_res.png 517w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/searching_driver_res-300x288.png 300w" sizes="(max-width: 517px) 100vw, 517px" /></a><figcaption><em>HermeticWiper selecting which driver will load</em></figcaption></figure></div>



<p>The buffers are then decompressed with the help of the LZMA algorithm:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/lzma_dec.png" data-rel="lightbox-image-7" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54706" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/lzma_dec/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/lzma_dec.png" data-orig-size="686,513" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="lzma_dec" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/lzma_dec-300x224.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/lzma_dec-600x449.png" loading="lazy" width="686" height="513" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/lzma_dec.png" alt="Code responsible of decompress drivers compressed by LZMA algorithm and driver installation" class="wp-image-54706" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/lzma_dec.png 686w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/lzma_dec-300x224.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/lzma_dec-600x449.png 600w" sizes="(max-width: 686px) 100vw, 686px" /></a><figcaption><em>Code responsible of decompress drivers compressed by LZMA algorithm and driver installation</em></figcaption></figure></div>



<p>This format of compression is supported by a popular extraction tool, 7zip. We can also make our own decoding tool, basing on the malware code (<a href="https://gist.github.com/hasherezade/2c7837874f7adf0f73192f4d861d83c6" target="_blank" rel="noreferrer noopener">example</a>).</p>



<p>As a result we get 4 versions of legitimate drivers from the EaseUS Partition Master – just as reported by ESET (<a href="https://twitter.com/ESETresearch/status/1496581912940396551?s=20&amp;t=wAz5sfT7pTIN-F0aqFaXTg" target="_blank" rel="noreferrer noopener">source</a>).</p>



<ul><li><a rel="noreferrer noopener" href="https://www.virustotal.com/gui/file/2c7732da3dcfc82f60f063f2ec9fa09f9d38d5cfbe80c850ded44de43bdb666d" target="_blank">2c7732da3dcfc82f60f063f2ec9fa09f9d38d5cfbe80c850ded44de43bdb666d</a></li><li><a href="https://www.virustotal.com/gui/file/23ef301ddba39bb00f0819d2061c9c14d17dc30f780a945920a51bc3ba0198a4">23ef301ddba39bb00f0819d2061c9c14d17dc30f780a945920a51bc3ba0198a4</a></li><li><a href="https://www.virustotal.com/gui/file/8c614cf476f871274aa06153224e8f7354bf5e23e6853358591bf35a381fb75b">8c614cf476f871274aa06153224e8f7354bf5e23e6853358591bf35a381fb75b</a></li><li><a href="https://www.virustotal.com/gui/file/96b77284744f8761c4f2558388e0aee2140618b484ff53fa8b222b340d2a9c84">96b77284744f8761c4f2558388e0aee2140618b484ff53fa8b222b340d2a9c84</a></li></ul>



<p>Based on the timestamps in the PE headers, the builds of the drivers are pretty old. Probably they have been stolen by the attackers from an original, legitimate software bundle. Each of them comes with a Debug directory, including a PDB path. Example:</p>



<figure class="wp-block-image size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/driver_pdb.png" data-rel="lightbox-image-8" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54707" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/driver_pdb/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/driver_pdb.png" data-orig-size="918,372" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="driver_pdb" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/driver_pdb-300x122.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/driver_pdb-600x243.png" loading="lazy" width="918" height="372" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/driver_pdb.png" alt="" class="wp-image-54707" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/driver_pdb.png 918w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/driver_pdb-300x122.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/driver_pdb-600x243.png 600w" sizes="(max-width: 918px) 100vw, 918px" /></a></figure>



<h2>Driver overview</h2>



<p>The drivers leveraged by HermeticWiper are part of the Suite from EaseUS, a legitimate software that brings to the user disk functionalities like partitioning and resizing. As told, this tool is legitimate so no one was detecting the sample in VirusTotal at the time of the attack:</p>



<div class="wp-block-image"><figure class="aligncenter size-full is-resized"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/4a614eb6-82c9-4e6f-b5b4-bd27fef1759b.png" data-rel="lightbox-image-9" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54749" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/4a614eb6-82c9-4e6f-b5b4-bd27fef1759b/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/4a614eb6-82c9-4e6f-b5b4-bd27fef1759b.png" data-orig-size="800,371" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="4a614eb6-82c9-4e6f-b5b4-bd27fef1759b" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/4a614eb6-82c9-4e6f-b5b4-bd27fef1759b-300x139.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/4a614eb6-82c9-4e6f-b5b4-bd27fef1759b-600x278.png" loading="lazy" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/4a614eb6-82c9-4e6f-b5b4-bd27fef1759b.png" alt="VirusTotal showed 0 detections for used drivers" class="wp-image-54749" width="839" height="389" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/4a614eb6-82c9-4e6f-b5b4-bd27fef1759b.png 800w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/4a614eb6-82c9-4e6f-b5b4-bd27fef1759b-300x139.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/4a614eb6-82c9-4e6f-b5b4-bd27fef1759b-600x278.png 600w" sizes="(max-width: 839px) 100vw, 839px" /></a><figcaption><em>VirusTotal showed 0 detections for used drivers</em></figcaption></figure></div>



<p>Looking inside the driver, we can see typical functions. The driver creates the required device and establishes some Dispatch Routines, as can be seen in the following image:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/c50cd22f-cee1-46b4-8028-92c6a1d671d4.png" data-rel="lightbox-image-10" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54751" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/c50cd22f-cee1-46b4-8028-92c6a1d671d4/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/c50cd22f-cee1-46b4-8028-92c6a1d671d4.png" data-orig-size="800,725" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="c50cd22f-cee1-46b4-8028-92c6a1d671d4" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/c50cd22f-cee1-46b4-8028-92c6a1d671d4-300x272.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/c50cd22f-cee1-46b4-8028-92c6a1d671d4-600x544.png" loading="lazy" width="800" height="725" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/c50cd22f-cee1-46b4-8028-92c6a1d671d4.png" alt="DriverEntry routine" class="wp-image-54751" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/c50cd22f-cee1-46b4-8028-92c6a1d671d4.png 800w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/c50cd22f-cee1-46b4-8028-92c6a1d671d4-300x272.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/c50cd22f-cee1-46b4-8028-92c6a1d671d4-600x544.png 600w" sizes="(max-width: 800px) 100vw, 800px" /></a><figcaption><em>DriverEntry routine</em></figcaption></figure></div>



<p>The internals of the driver are quite straightforward. In order to access the driver from usermode we need to use <code><span class="has-inline-color has-vivid-purple-color">CreateFile</span></code> API function and the name of the device under which the driver was installed (<code>\\.\EPMNTDRV</code>) along with the partition ID. Example shown below:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/a7acf8e2-6209-4b56-bcb5-3a89ad8bab0d.png" data-rel="lightbox-image-11" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54752" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/a7acf8e2-6209-4b56-bcb5-3a89ad8bab0d/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/a7acf8e2-6209-4b56-bcb5-3a89ad8bab0d.png" data-orig-size="800,212" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="a7acf8e2-6209-4b56-bcb5-3a89ad8bab0d" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/a7acf8e2-6209-4b56-bcb5-3a89ad8bab0d-300x80.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/a7acf8e2-6209-4b56-bcb5-3a89ad8bab0d-600x159.png" loading="lazy" width="800" height="212" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/a7acf8e2-6209-4b56-bcb5-3a89ad8bab0d.png" alt="Usermode artifact opening building the string that will be used to open a HANDLE to the device" class="wp-image-54752" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/a7acf8e2-6209-4b56-bcb5-3a89ad8bab0d.png 800w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/a7acf8e2-6209-4b56-bcb5-3a89ad8bab0d-300x80.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/a7acf8e2-6209-4b56-bcb5-3a89ad8bab0d-600x159.png 600w" sizes="(max-width: 800px) 100vw, 800px" /></a><figcaption><em>Usermode component, building the string that will be used to open a HANDLE to the device</em></figcaption></figure></div>



<p>This string is important to understand the driver capabilities. As you can see, this drivers code will convert this sent string from usermode to integer and will use that integer as an input to the `saveReferenceHardDisk` helper function. As it can be extracted from the images, this helper function will save a reference to the physical disk (<em><span class="has-inline-color has-vivid-green-cyan-color">\Device\Harddisk[num]\Partition0</span></em>) in FsContext attribute: </p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-16-edited.png" data-rel="lightbox-image-12" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54870" data-permalink="https://blog.malwarebytes.com/image-16-2/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-16-edited.png" data-orig-size="1653,513" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-16" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-16-edited-300x93.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-16-edited-600x186.png" loading="lazy" width="1653" height="513" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-16-edited.png" alt="IRP_MJ_CREATE function" class="wp-image-54870" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-16-edited.png 1653w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-16-edited-300x93.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-16-edited-600x186.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-16-edited-1536x477.png 1536w" sizes="(max-width: 1653px) 100vw, 1653px" /></a><figcaption>IRP_MJ_CREATE function</figcaption></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-19.png" data-rel="lightbox-image-13" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54871" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/image-19/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-19.png" data-orig-size="800,319" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-19" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-19-300x120.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-19-600x239.png" loading="lazy" width="800" height="319" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-19.png" alt="" class="wp-image-54871" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-19.png 800w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-19-300x120.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-19-600x239.png 600w" sizes="(max-width: 800px) 100vw, 800px" /></a><figcaption>Detail of helper function</figcaption></figure></div>



<p>This behaviour can has been tested also in real time. We can see how the leading backslash&nbsp;is removed prior to convert this value to integer type:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/0087f1d7-33b0-41ca-a0b5-7636e7f6d978.png" data-rel="lightbox-image-14" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54754" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/0087f1d7-33b0-41ca-a0b5-7636e7f6d978/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/0087f1d7-33b0-41ca-a0b5-7636e7f6d978.png" data-orig-size="800,131" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="0087f1d7-33b0-41ca-a0b5-7636e7f6d978" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/0087f1d7-33b0-41ca-a0b5-7636e7f6d978-300x49.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/0087f1d7-33b0-41ca-a0b5-7636e7f6d978-600x98.png" loading="lazy" width="800" height="131" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/0087f1d7-33b0-41ca-a0b5-7636e7f6d978.png" alt="" class="wp-image-54754" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/0087f1d7-33b0-41ca-a0b5-7636e7f6d978.png 800w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/0087f1d7-33b0-41ca-a0b5-7636e7f6d978-300x49.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/0087f1d7-33b0-41ca-a0b5-7636e7f6d978-600x98.png 600w" sizes="(max-width: 800px) 100vw, 800px" /></a><figcaption><em>Parameter handling shown in a kernelmode live debugging session</em></figcaption></figure></div>



<p>IRP_MJ_CREATE function will save a Device Object pointer for the hard disk in FsContext2 attribute, returned by getDeviceObject helper function. The DeviceObject pointer in getDeviceObject is used to find IRP_MJ_CREATE function will save a Device Object pointer for the hard disk in FsContext2 attribute (returned by getDeviceObject helper function). The DeviceObject pointer in getDeviceObject is used to find the disk.sys associated device object by traversing to the lowest device object leveraging IoGetLowerDeviceObject function. To confirm that the lower device object is indeed the one we are looking for we check the ServiceKeyName of the object with &#8220;Disk&#8221; which indicates that its looking for the disk.sys object as the ServiceKeyName for that object is &#8220;Disk&#8221;. These objects will be used later in read and write operations. That means that, when different operations are requested to the driver from usermode, the real operation will be performed over the machine physical disks.</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-20.png" data-rel="lightbox-image-15" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54878" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/image-20/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-20.png" data-orig-size="1720,806" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-20" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-20-300x141.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-20-600x281.png" loading="lazy" width="1720" height="806" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-20.png" alt="" class="wp-image-54878" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-20.png 1720w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-20-300x141.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-20-600x281.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-20-1536x720.png 1536w" sizes="(max-width: 1720px) 100vw, 1720px" /></a><figcaption>Detail of getDiskDeviceObject helper function</figcaption></figure></div>



<p>Next images show how the driver builds the incoming requests and forwards them to the lower level devices:</p>



<div class="wp-block-image"><figure class="aligncenter size-full is-resized"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/e53f1404-490b-4649-b625-1591428b4a32.png" data-rel="lightbox-image-16" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54756" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/e53f1404-490b-4649-b625-1591428b4a32/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/e53f1404-490b-4649-b625-1591428b4a32.png" data-orig-size="800,426" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="e53f1404-490b-4649-b625-1591428b4a32" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/e53f1404-490b-4649-b625-1591428b4a32-300x160.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/e53f1404-490b-4649-b625-1591428b4a32-600x320.png" loading="lazy" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/e53f1404-490b-4649-b625-1591428b4a32.png" alt="" class="wp-image-54756" width="787" height="419" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/e53f1404-490b-4649-b625-1591428b4a32.png 800w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/e53f1404-490b-4649-b625-1591428b4a32-300x160.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/e53f1404-490b-4649-b625-1591428b4a32-600x320.png 600w" sizes="(max-width: 787px) 100vw, 787px" /></a><figcaption><em>Example of EaseUS driver handling IOCTL requests</em></figcaption></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="54758" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/d1c66602-9fc8-4a58-a1c6-03624eb42e84/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/d1c66602-9fc8-4a58-a1c6-03624eb42e84.png" data-orig-size="800,319" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="d1c66602-9fc8-4a58-a1c6-03624eb42e84" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/d1c66602-9fc8-4a58-a1c6-03624eb42e84-300x120.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/d1c66602-9fc8-4a58-a1c6-03624eb42e84-600x239.png" loading="lazy" width="800" height="319" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/d1c66602-9fc8-4a58-a1c6-03624eb42e84.png" alt="" class="wp-image-54758" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/d1c66602-9fc8-4a58-a1c6-03624eb42e84.png 800w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/d1c66602-9fc8-4a58-a1c6-03624eb42e84-300x120.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/d1c66602-9fc8-4a58-a1c6-03624eb42e84-600x239.png 600w" sizes="(max-width: 800px) 100vw, 800px" /><figcaption><em>Example of EaseUS driver handling read operations</em></figcaption></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="54759" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/e0ec8d30-c66d-497d-bbc3-ce731018ec1e/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/e0ec8d30-c66d-497d-bbc3-ce731018ec1e.png" data-orig-size="800,304" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="e0ec8d30-c66d-497d-bbc3-ce731018ec1e" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/e0ec8d30-c66d-497d-bbc3-ce731018ec1e-300x114.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/e0ec8d30-c66d-497d-bbc3-ce731018ec1e-600x228.png" loading="lazy" width="800" height="304" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/e0ec8d30-c66d-497d-bbc3-ce731018ec1e.png" alt="" class="wp-image-54759" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/e0ec8d30-c66d-497d-bbc3-ce731018ec1e.png 800w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/e0ec8d30-c66d-497d-bbc3-ce731018ec1e-300x114.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/e0ec8d30-c66d-497d-bbc3-ce731018ec1e-600x228.png 600w" sizes="(max-width: 800px) 100vw, 800px" /><figcaption><em>Example of EaseUS driver handling IOCTL write operations</em></figcaption></figure></div>



<p>By using FsContext2 field saved by a <span class="has-inline-color has-vivid-purple-color">CreateFile</span> operation performed from usermode, this driver could be seen as <strong>a proxy </strong>driver where IRPs are handled by underlying devices. In a nutshell, this <em>legitimate</em> driver lets the attackers bypass some windows security mechanisms which would ideally be forbidden from usermode such as writing to certain sectors of the raw disk.</p>



<h2 id="implementation-of-the-wiper">Implementation of the Wiper</h2>



<p>This malware is designed to maximize damage done to the system. It does not only overwrite the MBR, but goes further: walking through many structures of the filesystem and corrupting all of them, also trashing individual files.</p>



<p>We know that this executable is going to somehow abuse those drivers in order to implement the wiper functionality. Yet, the question arises, how exactly is it implemented?</p>



<p>It is worth to note that Windows (since Vista) introduced limitations, thanks to which only the sectors at the beginning of the disk can be written to from usermode (with the help of the standard windows drivers). If we want to write to further sectors, i.e. overwrite MFT (Master File Table) we need some custom workarounds. (More explanation given <a href="https://community.osr.com/discussion/101522/vista-rtm-writing-to-raw-disk-sectors" target="_blank" rel="noreferrer noopener">here</a>.)</p>



<p><a href="https://blog.malwarebytes.com/threat-analysis/2016/04/petya-ransomware/" target="_blank" rel="noreferrer noopener">In case of Petya</a> (as well as NotPetya, which used the same component), this workaround was implemented by an alternative “kernel” that was booting (instead of Windows) on machine restart, and doing the overwrite. In case of the HermeticWiper, the authors decided for an easier way: they used another driver, that was able to do such overwrites.</p>



<p>First, the malware parses NTFS structures, and stores information about them in the internal structures. For implementing the reads, standard system devices being used. After the needed data is collected, the additional (EaseUS) driver comes into play: it is used as a proxy to <strong>write</strong> into the collected sectors.</p>



<p>The attack can be divided into several phases:</p>



<ol><li>Preparation, including:<ul><li>Installation of the additional driver (EaseUS)</li><li>Disabling system features that may help in recovery, or in noticing of the attack</li></ul></li><li>Data collection: walking through NTFS structure, collecting sectors and files that are going to be overwritten. Also, the random data of appropriate size is generated for the further overwrite.</li><li>Trashing (at this stage the EaseUS driver is utilized): the collected sectors are being overwritten by the previously generated random data</li></ol>



<p>At the end, the system may be automatically rebooted.</p>



<h2>Execution flow</h2>



<p>Let&#8217;s now have a look at the malware sample, to see how those phases are implemented in detail.</p>



<h3>Preparations</h3>



<p>First the sample parses command line arguments. They will have minor impact on the execution &#8211; may just alter how long the sample is going to sleep between the execution of the particular phases.</p>



<p>Then, the sample proceeds to set privileges that are needed in order to execute the actions that are going to be performed. Two privileges are being set in the main function of the malware: <code>SeShutdownPrivilege</code> (that allows to reboot the system) and <code>SeBackupPrivilege</code> (that allows to manipulate system backups):</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/privileges1.png" data-rel="lightbox-image-17" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54712" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/privileges1/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/privileges1.png" data-orig-size="805,585" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="privileges1" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/privileges1-300x218.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/privileges1-600x436.png" loading="lazy" width="805" height="585" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/privileges1.png" alt="Hermetic Wiper adjusting required privileges" class="wp-image-54712" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/privileges1.png 805w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/privileges1-300x218.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/privileges1-600x436.png 600w" sizes="(max-width: 805px) 100vw, 805px" /></a><figcaption><em>Hermetic Wiper adjusting required privileges</em></figcaption></figure></div>



<p>Here comes and interesting twist: the string defining <code>SeShutDownPrivilege</code> is composed on the stack, and one chunk in between is missing:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="54801" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/missing_part-2/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/missing_part.png" data-orig-size="953,384" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="missing_part" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/missing_part-300x121.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/missing_part-600x242.png" loading="lazy" width="953" height="384" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/missing_part.png" alt="Detail of uncompleted SeShutdownPrivilege string" class="wp-image-54801" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/missing_part.png 953w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/missing_part-300x121.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/missing_part-600x242.png 600w" sizes="(max-width: 953px) 100vw, 953px" /><figcaption><em>Detail of uncompleted SeShutdownPrivilege string</em></figcaption></figure></div>



<p>This missing chunk <code>wnPr</code> is then being filled at the position that is calculated depending on the first character of the current executable name. Due to this, the string becomes complete (and the privilege is set properly) only in the case if the sample has a name starting from &#8220;c&#8221;. </p>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="54802" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/chunk_filled/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/chunk_filled.png" data-orig-size="946,351" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="chunk_filled" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/chunk_filled-300x111.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/chunk_filled-600x223.png" loading="lazy" width="946" height="351" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/chunk_filled.png" alt="SeShutdownPrivilege completed completed in later steps" class="wp-image-54802" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/chunk_filled.png 946w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/chunk_filled-300x111.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/chunk_filled-600x223.png 600w" sizes="(max-width: 946px) 100vw, 946px" /><figcaption><em>SeShutdownPrivilege completed in later steps</em></figcaption></figure></div>



<p>The reason why the authors decided for such unusual alteration of the flow is not sure. It may be just to obfuscate this particular, suspicious string. It is also common for malware authors to use a name check as an anti-sandbox technique (since sandboxes may assign to samples some predictable names: in the case if such name was detected, sample may exit, so that its behavior cannot be tracked by the Sandbox). However, here the change in the sample behavior is very minor &#8211; it affects only the reboot functionality, not the main mission of the malware.</p>



<h4>Driver Installation</h4>



<p>After that, the malware proceeds to the installation of the driver:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/unpack_drivers.png" data-rel="lightbox-image-18" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54713" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/unpack_drivers/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/unpack_drivers.png" data-orig-size="803,112" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="unpack_drivers" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/unpack_drivers-300x42.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/unpack_drivers-600x84.png" loading="lazy" width="803" height="112" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/unpack_drivers.png" alt="" class="wp-image-54713" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/unpack_drivers.png 803w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/unpack_drivers-300x42.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/unpack_drivers-600x84.png 600w" sizes="(max-width: 803px) 100vw, 803px" /></a><figcaption><em>Driver installation</em></figcaption></figure></div>



<p>The installation function takes several steps.</p>



<p>First, the system is fingerprinted, so that the malware can select the most appropriate version of the driver to be used. Depending on the Windows version, and the bitness (32 or 64 bit), the resource is selected.</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/select_resource.png" data-rel="lightbox-image-19" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54714" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/select_resource/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/select_resource.png" data-orig-size="627,617" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="select_resource" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/select_resource-300x295.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/select_resource-600x590.png" loading="lazy" width="627" height="617" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/select_resource.png" alt="Different drivers available to load" class="wp-image-54714" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/select_resource.png 627w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/select_resource-300x295.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/select_resource-600x590.png 600w" sizes="(max-width: 627px) 100vw, 627px" /></a><figcaption><em>Different drivers available to load</em></figcaption></figure></div>



<p>Before installing the driver, the crash dump mechanism is being disabled:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/crash_dump_disable.png" data-rel="lightbox-image-20" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54715" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/crash_dump_disable/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/crash_dump_disable.png" data-orig-size="780,110" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="crash_dump_disable" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/crash_dump_disable-300x42.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/crash_dump_disable-600x85.png" loading="lazy" width="780" height="110" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/crash_dump_disable.png" alt="HermeticWiper disabling Crash Dumps" class="wp-image-54715" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/crash_dump_disable.png 780w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/crash_dump_disable-300x42.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/crash_dump_disable-600x85.png 600w" sizes="(max-width: 780px) 100vw, 780px" /></a><figcaption><em>HermeticWiper disabling Crash Dumps</em></figcaption></figure></div>



<p>Crash Dumps are usually being made if the full system crashes, possibly because of a bug/instability in a driver. They contain information about the full status of the system, and on what exactly happen, in order to help debugging. Disabling crashes before the installation suggests that the authors of the malware have some level of distrust in the used drivers, or believe that the executed operation posses some risk of crashing the system. That&#8217;s why they want to be extra sure that if it eventually happens, the Administrators will have a harder time to find the reason. </p>



<p>Then, they check if the driver is already installed. They do it by sending there and IOCTL, that is supposed to retrieve information about the drive geometry. If this operation has failed, it means the driver is not there, and they can proceed with the installation.</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/check_if_install.png" data-rel="lightbox-image-21" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54716" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/check_if_install/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/check_if_install.png" data-orig-size="670,64" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="check_if_install" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/check_if_install-300x29.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/check_if_install-600x57.png" loading="lazy" width="670" height="64" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/check_if_install.png" alt="EaseUs device object reference" class="wp-image-54716" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/check_if_install.png 670w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/check_if_install-300x29.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/check_if_install-600x57.png 600w" sizes="(max-width: 670px) 100vw, 670px" /></a><figcaption><em>EaseUS device object reference</em></figcaption></figure></div>



<p>The installation is done by first generating a pseudorandom, 4-character long name for the driver, from the hardcoded charset. The function also makes sure that the file with the generated name does not exist yet.</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/make_name.png" data-rel="lightbox-image-22" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54717" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/make_name/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/make_name.png" data-orig-size="801,261" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="make_name" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/make_name-300x98.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/make_name-600x196.png" loading="lazy" width="801" height="261" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/make_name.png" alt="Generation of driver name" class="wp-image-54717" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/make_name.png 801w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/make_name-300x98.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/make_name-600x196.png 600w" sizes="(max-width: 801px) 100vw, 801px" /></a><figcaption><em>Generation of driver name</em></figcaption></figure></div>



<p>Then, the compressed version of the file is being dropped. And finally, the driver is decompressed from it.</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="54718" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/dropped_files-10/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/dropped_files.png" data-orig-size="495,146" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dropped_files" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/dropped_files-300x88.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/dropped_files.png" loading="lazy" width="495" height="146" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/dropped_files.png" alt="Dropped EaseUS driver shown in explorer" class="wp-image-54718" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/dropped_files.png 495w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/dropped_files-300x88.png 300w" sizes="(max-width: 495px) 100vw, 495px" /><figcaption><em>Dropped EaseUS driver shown in explorer</em></figcaption></figure></div>



<p>The decompressed driver is installed as a service:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/decompress_and_install.png" data-rel="lightbox-image-23" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54719" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/decompress_and_install/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/decompress_and_install.png" data-orig-size="687,440" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="decompress_and_install" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/decompress_and_install-300x192.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/decompress_and_install-600x384.png" loading="lazy" width="687" height="440" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/decompress_and_install.png" alt="EasyUs driver installation " class="wp-image-54719" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/decompress_and_install.png 687w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/decompress_and_install-300x192.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/decompress_and_install-600x384.png 600w" sizes="(max-width: 687px) 100vw, 687px" /></a><figcaption><em>EasyUs driver installation </em></figcaption></figure></div>



<p><em>At this point, the newly dropped files are also added to the structures that will be further passed to the wiping functions &#8211; so that the files can be overwritten at low level. More about it is described in section &#8220;Data collection&#8221;.</em></p>



<p>The installation function (denoted as <code>create_driver_svc</code>) first enables yet another privilege: <code>SeLoadDriverPrivilege</code> (which is required to allow loading drivers):</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/enable_driver_load.png" data-rel="lightbox-image-24" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54721" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/enable_driver_load/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/enable_driver_load.png" data-orig-size="656,150" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="enable_driver_load" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/enable_driver_load-300x69.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/enable_driver_load-600x137.png" loading="lazy" width="656" height="150" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/enable_driver_load.png" alt="SeLoadDriverPrivilege" class="wp-image-54721" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/enable_driver_load.png 656w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/enable_driver_load-300x69.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/enable_driver_load-600x137.png 600w" sizes="(max-width: 656px) 100vw, 656px" /></a><figcaption><em>SeLoadDriverPrivilege</em></figcaption></figure></div>



<p>Then the driver is added as a system service, and started:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/add_and_start.png" data-rel="lightbox-image-25" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54722" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/add_and_start/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/add_and_start.png" data-orig-size="409,407" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="add_and_start" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/add_and_start-300x300.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/add_and_start.png" loading="lazy" width="409" height="407" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/add_and_start.png" alt="Detail driver service being created" class="wp-image-54722" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/add_and_start.png 409w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/add_and_start-300x300.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/add_and_start-150x150.png 150w" sizes="(max-width: 409px) 100vw, 409px" /></a><figcaption><em>Detail driver service being created</em></figcaption></figure></div>



<p>This triggers execution of the <code>DriverEntry</code> function, and since that point, the driver is residing in memory.</p>



<p>After the successful installation, the registry keys related to the service, as well as the dropped files, are deleted, to make the new driver more difficult to spot:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/delete_both_files.png" data-rel="lightbox-image-26" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54720" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/delete_both_files/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/delete_both_files.png" data-orig-size="379,107" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="delete_both_files" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/delete_both_files-300x85.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/delete_both_files.png" loading="lazy" width="379" height="107" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/delete_both_files.png" alt="Deletion of dropped files" class="wp-image-54720" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/delete_both_files.png 379w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/delete_both_files-300x85.png 300w" sizes="(max-width: 379px) 100vw, 379px" /></a><figcaption><em>Deletion of dropped files</em></figcaption></figure></div>



<p>We must note, that file deletion does not interfere in the functionality of the driver. It is still loaded in memory (till the next reboot) and will be available for the further use.</p>



<h3>Disabling shadow copies</h3>



<p>It is a common action done by ransomware to delete shadow copies. It is supposed to destroy system backups, and paralyze the recovery. In this case, we can see the sample disabling the Shadow copy Service:</p>



<div class="wp-block-image"><figure class="aligncenter size-full is-resized"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/disabling_shadow_copies.png" data-rel="lightbox-image-27" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54723" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/disabling_shadow_copies/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/disabling_shadow_copies.png" data-orig-size="735,411" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="disabling_shadow_copies" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/disabling_shadow_copies-300x168.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/disabling_shadow_copies-600x336.png" loading="lazy" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/disabling_shadow_copies.png" alt="Shadow Copies being disabled" class="wp-image-54723" width="735" height="411" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/disabling_shadow_copies.png 735w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/disabling_shadow_copies-300x168.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/disabling_shadow_copies-600x336.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/disabling_shadow_copies-400x225.png 400w" sizes="(max-width: 735px) 100vw, 735px" /></a><figcaption><em>Shadow Copies being disabled</em></figcaption></figure></div>



<h2>Data Fragmentation</h2>



<p>During our analysis, we noticed that the malware fragments the files present on the disk (as opposite of defragmentation).</p>



<p>Before the fragmentation routine, it changes some settings related to explorer:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/disabling_in_explorer.png" data-rel="lightbox-image-28" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54732" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/disabling_in_explorer/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/disabling_in_explorer.png" data-orig-size="1037,393" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="disabling_in_explorer" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/disabling_in_explorer-300x114.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/disabling_in_explorer-600x227.png" loading="lazy" width="1037" height="393" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/disabling_in_explorer.png" alt="Changes made to registry in order to not show some changes regarding NTFS" class="wp-image-54732" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/disabling_in_explorer.png 1037w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/disabling_in_explorer-300x114.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/disabling_in_explorer-600x227.png 600w" sizes="(max-width: 1037px) 100vw, 1037px" /></a><figcaption><em>Registry changes to make it harder to spot NTFS operations</em></figcaption></figure></div>



<p>This is probably to hide the information about the file status to the user, to keep them in blind for as long time as possible.</p>



<p>Below function shows how the fragmentation routine is executed:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image.png" data-rel="lightbox-image-29" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54763" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/image-12/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image.png" data-orig-size="899,195" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-300x65.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-600x130.png" loading="lazy" width="899" height="195" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image.png" alt="Wrapper function used for fragmentation purposes" class="wp-image-54763" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image.png 899w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-300x65.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-600x130.png 600w" sizes="(max-width: 899px) 100vw, 899px" /></a><figcaption><em>Wrapper function used for fragmentation purposes</em></figcaption></figure></div>



<p>The standard windows directories are being excluded:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="54735" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/exclude_file/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/exclude_file.png" data-orig-size="734,288" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="exclude_file" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/exclude_file-300x118.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/exclude_file-600x235.png" loading="lazy" width="734" height="288" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/exclude_file.png" alt="Folder list that will be skipped" class="wp-image-54735" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/exclude_file.png 734w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/exclude_file-300x118.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/exclude_file-600x235.png 600w" sizes="(max-width: 734px) 100vw, 734px" /><figcaption><em>Folder list that will be skipped</em></figcaption></figure></div>



<p>This can be done both to save time (by not corrupting standard files), and to avoid the interference with system stability.</p>



<p>The file fragmentation process can be seen in next images:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/fragment_revieval_points.png" data-rel="lightbox-image-30" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54736" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/fragment_revieval_points/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/fragment_revieval_points.png" data-orig-size="842,228" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="fragment_revieval_points" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/fragment_revieval_points-300x81.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/fragment_revieval_points-600x162.png" loading="lazy" width="842" height="228" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/fragment_revieval_points.png" alt="" class="wp-image-54736" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/fragment_revieval_points.png 842w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/fragment_revieval_points-300x81.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/fragment_revieval_points-600x162.png 600w" sizes="(max-width: 842px) 100vw, 842px" /></a><figcaption><em>Fragmentation detail (1)</em></figcaption></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/fragment_move.png" data-rel="lightbox-image-31" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54737" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/fragment_move/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/fragment_move.png" data-orig-size="789,648" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="fragment_move" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/fragment_move-300x246.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/fragment_move-600x493.png" loading="lazy" width="789" height="648" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/fragment_move.png" alt="" class="wp-image-54737" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/fragment_move.png 789w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/fragment_move-300x246.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/fragment_move-600x493.png 600w" sizes="(max-width: 789px) 100vw, 789px" /></a><figcaption><em>Fragmentation detail (2)</em></figcaption></figure></div>



<p>The fragmentation algorithm implementation is achieved by using different IOCTL_CODES (FSCTL) as FSCTL_GET_RETRIEVAL_POINTERS and FSCTL_GET_MOVE_FILES. The code looks pretty similar to a defragmentation code. But in this case, is being modified in order to fragment, where file chunks are splitted and moved to free clusters in the disk.</p>



<h2>Data collection</h2>



<p>After those preparations, malware enters the second stage of the execution: data collection. In casual ransomware cases, we may see sometimes that prior to the encryption, malware iterates through various directories,  and makes a list of files that it is going to attack. This case is analogous, but much more interesting, because the authors iterate not through directories (at high level, using windows API), but at low level, through NTFS file system, reading various structures and parsing them manually. To enumerate them, they send IOCTLs through standard Windows devices (the newly installed driver is not used yet).</p>



<h3>Data storage</h3>



<p>The output of this parsing is stored in custom structures which we managed to reconstruct, and defined in the following way:</p>



<pre class="wp-block-preformatted">struct elemStr
{
  elemStr *fLink;
  elemStr *bLink;
  chunkStr *chunkPtr;
  DWORD diskNumber;
  BYTE *randomBufToWrite;
  DWORD sizeBuffer;
};

struct chunkStr
{
  chunkStr *fLink;
  chunkStr *bLink;
  LARGE_INTEGER offset;
  QWORD chunk_size;
};</pre>



<p>They both are linked lists.</p>



<p>The first one <code>elemStr</code> defines the element that will be overwritten.  Its size is retrieved, and the random buffer dedicated for its overwrite is generated:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/generate_random_buf.png" data-rel="lightbox-image-32" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54726" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/generate_random_buf-2/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/generate_random_buf.png" data-orig-size="596,499" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="generate_random_buf" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/generate_random_buf-300x251.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/generate_random_buf.png" loading="lazy" width="596" height="499" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/generate_random_buf.png" alt="Random data being generated for later trashing action" class="wp-image-54726" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/generate_random_buf.png 596w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/generate_random_buf-300x251.png 300w" sizes="(max-width: 596px) 100vw, 596px" /></a><figcaption><em>Random data being generated for later trashing action</em></figcaption></figure></div>



<p>The &#8220;chunk&#8221; represents a continuous block of physical addresses to be overwritten. </p>



<p>So in general, the malware will use these structures in a 2 step process. First step will collect all the data. The second step will wipe this data, using the previous created structure.</p>



<h3>Collected elements</h3>



<p>As seen before, these structures will be sent to functions that will perform the data corruption, at a very low level. The elements that are collected for later destruction are presented below.</p>



<h4><em>Own executable and the dropped drivers</em></h4>



<p>We have seen that the attackers were interested in cleaning their trace. To accomplish that, they will delete their own executable from disk, even tough the binary itself keeps running and in memory. As any other task performed in the filesystem by HermeticWiper, the way of deleting their binary is slightly different as other malwares do. The attackers first manage to find which offset the binary occupies in raw, and finally they will overwrite that specific offset.</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="54837" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/image-15/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-15.png" data-orig-size="835,66" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-15" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-15-300x24.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-15-600x47.png" loading="lazy" width="835" height="66" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-15.png" alt="" class="wp-image-54837" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-15.png 835w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-15-300x24.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-15-600x47.png 600w" sizes="(max-width: 835px) 100vw, 835px" /><figcaption><em>HermeticWiper file will be destroyed, along with other elements</em></figcaption></figure></div>



<p>The dropped files (compressed and uncompressed driver) were added to the same  structure, just after the the installation.</p>



<h4><em>The Boot Sector</em></h4>



<p>One of the attackers motivation is making devices incapable of loading the OS. The first step followed is enumerating all physical devices, as well as partitions. For that, a simple loop is used that tries to open a handle to HardDisk[num], where num is iterated from 0 to 100:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="54912" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/fill_partitions_info-1/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/fill_partitions_info-1.png" data-orig-size="598,43" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="fill_partitions_info-1" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/fill_partitions_info-1-300x22.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/fill_partitions_info-1.png" loading="lazy" width="598" height="43" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/fill_partitions_info-1.png" alt="" class="wp-image-54912" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/fill_partitions_info-1.png 598w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/fill_partitions_info-1-300x22.png 300w" sizes="(max-width: 598px) 100vw, 598px" /><figcaption><em>Loop showing how attackers will iterate through HardDisk0 to HardDisk100</em></figcaption></figure></div>



<p>All this information is then stored into a <code>elemStr</code> structure that contains data as the disk number. In this case, chunkElement will describe raw addresses of boot sectors. In that regard, an especial mention is made to <code>C:\System Volume Information</code>. The attackers will add to boot_sectors structure this folder contents:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/891d661c-e093-4bb3-aa62-dd81025a58cd.png" data-rel="lightbox-image-33" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54765" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/891d661c-e093-4bb3-aa62-dd81025a58cd/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/891d661c-e093-4bb3-aa62-dd81025a58cd.png" data-orig-size="800,323" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="891d661c-e093-4bb3-aa62-dd81025a58cd" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/891d661c-e093-4bb3-aa62-dd81025a58cd-300x121.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/891d661c-e093-4bb3-aa62-dd81025a58cd-600x242.png" loading="lazy" width="800" height="323" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/891d661c-e093-4bb3-aa62-dd81025a58cd.png" alt="" class="wp-image-54765" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/891d661c-e093-4bb3-aa62-dd81025a58cd.png 800w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/891d661c-e093-4bb3-aa62-dd81025a58cd-300x121.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/891d661c-e093-4bb3-aa62-dd81025a58cd-600x242.png 600w" sizes="(max-width: 800px) 100vw, 800px" /></a><figcaption><em>Calls to parse_NTFS_AND_execute_callback function</em></figcaption></figure></div>



<p>According to Microsoft, &#8220;<em>The Mount Manager maintains the Mount Manager remote database on every NTFS volume in which the Mount Manager records any mount points defined for that volume. The database file resides in the directory System Volume Information on the NTFS volume</em>&#8221; (Windows Internals, 6th edition). So this technique is also created for increasing damage. Finally, all these collected offsets will be overwritten as the malicious binary was, leveraging the EasyUS driver.</p>



<h4><em>Reserved Sectors and MFT</em></h4>



<p>As before, the malware will brute-force again against the PhysicalDrive ID to find valid drive IDs. Then it uses IOCTL_DISK_GET_DRIVE_LAYOUT_EX to retrieve information about all the primary partitions present on the drive and reads the first sector from that partition. Other information required to read one sector from the disk is retrieved by using the IOCTL_DISK_GET_DRIVE_GEOMETRY_EX. </p>



<div class="wp-block-image"><figure class="aligncenter size-large"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/disk_one_by_one.png" data-rel="lightbox-image-34" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54913" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/disk_one_by_one/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/disk_one_by_one.png" data-orig-size="794,571" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="disk_one_by_one" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/disk_one_by_one-300x216.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/disk_one_by_one-600x431.png" loading="lazy" width="600" height="431" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/disk_one_by_one-600x431.png" alt="" class="wp-image-54913" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/disk_one_by_one-600x431.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/disk_one_by_one-300x216.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/disk_one_by_one.png 794w" sizes="(max-width: 600px) 100vw, 600px" /></a><figcaption><em>Retrieving information about each disk</em></figcaption></figure></div>



<p>Once the first sector of a partition is read then the callback function passed by the malware is invoked on this sector. </p>



<div class="wp-block-image"><figure class="aligncenter size-large"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/process_partitions-2.png" data-rel="lightbox-image-35" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54919" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/process_partitions-2/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/process_partitions-2.png" data-orig-size="833,903" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="process_partitions-2" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/process_partitions-2-277x300.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/process_partitions-2-553x600.png" loading="lazy" width="553" height="600" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/process_partitions-2-553x600.png" alt="" class="wp-image-54919" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/process_partitions-2-553x600.png 553w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/process_partitions-2-277x300.png 277w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/process_partitions-2.png 833w" sizes="(max-width: 553px) 100vw, 553px" /></a></figure></div>



<p>Depending on the filesystem type if its FAT then it wipes all the Reserved Sectors, the boot record sectors in FAT filesystem are part of Reserved Sectors. In case of NTFS the malware wipes the MFT and MFTMirror (backup MFT) present on the disk, the purpose of which is to make the recovery of the data harder.</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/b50111ec-f377-4b7f-9b91-a4019bd5c370.png" data-rel="lightbox-image-36" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54766" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/b50111ec-f377-4b7f-9b91-a4019bd5c370/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/b50111ec-f377-4b7f-9b91-a4019bd5c370.png" data-orig-size="800,217" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="b50111ec-f377-4b7f-9b91-a4019bd5c370" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/b50111ec-f377-4b7f-9b91-a4019bd5c370-300x81.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/b50111ec-f377-4b7f-9b91-a4019bd5c370-600x163.png" loading="lazy" width="800" height="217" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/b50111ec-f377-4b7f-9b91-a4019bd5c370.png" alt="" class="wp-image-54766" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/b50111ec-f377-4b7f-9b91-a4019bd5c370.png 800w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/b50111ec-f377-4b7f-9b91-a4019bd5c370-300x81.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/b50111ec-f377-4b7f-9b91-a4019bd5c370-600x163.png 600w" sizes="(max-width: 800px) 100vw, 800px" /></a><figcaption><em>Routine for FAT filesystem</em></figcaption></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="54767" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/dced0d2c-9ae1-4663-8e38-350fff2fa032/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/dced0d2c-9ae1-4663-8e38-350fff2fa032.png" data-orig-size="800,304" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="dced0d2c-9ae1-4663-8e38-350fff2fa032" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/dced0d2c-9ae1-4663-8e38-350fff2fa032-300x114.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/dced0d2c-9ae1-4663-8e38-350fff2fa032-600x228.png" loading="lazy" width="800" height="304" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/dced0d2c-9ae1-4663-8e38-350fff2fa032.png" alt="" class="wp-image-54767" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/dced0d2c-9ae1-4663-8e38-350fff2fa032.png 800w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/dced0d2c-9ae1-4663-8e38-350fff2fa032-300x114.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/dced0d2c-9ae1-4663-8e38-350fff2fa032-600x228.png 600w" sizes="(max-width: 800px) 100vw, 800px" /><figcaption><em>Routine for NTFS filesystem</em></figcaption></figure></div>



<p>Each file on an NTFS volume is represented by a record in a special file called the master file table (MFT). In case the MFT becomes corruptible then MFT mirror is read in an attempt to recover the original MFT, whose first record is identical to the first record of the MFT. MFT table is the index on which the filesystem relies, having information like where a file resides. Without MFT, the system will be unable to know were folders and files are, or modification dates, etc.&nbsp;</p>



<h4><em>Bitmap and LogFile</em></h4>



<p>In an attempt to hinder the recovery, Bitmap and LogFile are overwritten as well for all the logical drives present on the system. The logical drives are retrieved by GetLogicalDriveStringsW in this case. These structures are also important when doing recovery and postmortem investigation. $Bitmap contains information about free and occupied clusters and $Logfile contains a log of transactions that happened in the filesystem.</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="54769" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/c6f61d31-fed1-4cd3-8215-10e231305093/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/c6f61d31-fed1-4cd3-8215-10e231305093.png" data-orig-size="636,399" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="c6f61d31-fed1-4cd3-8215-10e231305093" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/c6f61d31-fed1-4cd3-8215-10e231305093-300x188.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/c6f61d31-fed1-4cd3-8215-10e231305093-600x376.png" loading="lazy" width="636" height="399" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/c6f61d31-fed1-4cd3-8215-10e231305093.png" alt="" class="wp-image-54769" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/c6f61d31-fed1-4cd3-8215-10e231305093.png 636w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/c6f61d31-fed1-4cd3-8215-10e231305093-300x188.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/c6f61d31-fed1-4cd3-8215-10e231305093-600x376.png 600w" sizes="(max-width: 636px) 100vw, 636px" /></figure></div>



<p>Also user files will be impacted by data destruction. We have discovered that the malware will overwrite as well almost everything inside C:/Documents and settings. In modern Windows, Documents and Settings will point to C:/Users. This folder contains users data folders (for example, My Documents or Desktop are located in these folders). Some files are skipped in this process, as the ones under APPDATA but in general, every file that is contained under these folders will be overwritten.</p>



<h4><em>Collecting clusters to erase the whole disk</em></h4>



<p>The final part of the data collection is to get information required to wipe all the occupied clusters on the disk. To get this information the malware uses FSCTL_GET_VOLUME_BITMAP IOCTL which gives us information about all the occupied and free clusters on the disk. The malware traverses all the logical disks and uses FSCTL_GET_VOLUME_BITMAP to retrieve the bitmap, every bit in the bitmap denotes a cluster, a value of 1 implying that the cluster is occupied and 0 meaning that the cluster is free. The bitmap retrieved with the IOCTL is traversed bit by bit and all the occupied clusters are added to the wiping structure which is described above in the post, one thing to note here is that malware combines all the contiguous clusters and these contiguous multiple clusters are denoted by a single chunk structure opposed to earlier usages where one chunk structure denoted a single cluster.</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/clusters.png" data-rel="lightbox-image-37" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54804" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/clusters/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/clusters.png" data-orig-size="1806,1146" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="clusters" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/clusters-300x190.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/clusters-600x381.png" loading="lazy" width="1806" height="1146" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/clusters.png" alt="Finally, all occupied clusters will be collected in a diskStr typed structure for its destruction" class="wp-image-54804" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/clusters.png 1806w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/clusters-300x190.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/clusters-600x381.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/clusters-1536x975.png 1536w" sizes="(max-width: 1806px) 100vw, 1806px" /></a></figure></div>



<p>Finally, all occupied clusters will be collected in a <code>elemStr</code> typed structure for its destruction.</p>



<h3>How is this all performed?</h3>



<p>Through the entire post its been told that some NTFS properties (like attributes, indexes, etc) are being used in order to collect data, that will be wiped after. We will like to show an example of how attackers implemented that functionality and show the level of sophistication.</p>



<p>For that, we will take as example the code responsible in collecting the Windows log files:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-3.png" data-rel="lightbox-image-38" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54819" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/image-3-2/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-3.png" data-orig-size="876,97" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-3" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-3-300x33.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-3-600x66.png" loading="lazy" width="876" height="97" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-3.png" alt="Code responsible in collecting the Windows log files" class="wp-image-54819" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-3.png 876w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-3-300x33.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-3-600x66.png 600w" sizes="(max-width: 876px) 100vw, 876px" /></a><figcaption><em>Code responsible in collecting Windows log files</em></figcaption></figure></div>



<p>After this call, some data structures are filled, containing data regarding physical disk properties and the folder name itself. Our first reference to the NTFS filesystem is found in the way that the HANDLE is retrieved. This folder is opened as a NTFS stream:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-4.png" data-rel="lightbox-image-39" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54820" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/image-4-3/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-4.png" data-orig-size="1121,97" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-4" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-4-300x26.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-4-600x52.png" loading="lazy" width="1121" height="97" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-4.png" alt="" class="wp-image-54820" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-4.png 1121w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-4-300x26.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-4-600x52.png 600w" sizes="(max-width: 1121px) 100vw, 1121px" /></a><figcaption><em>HANDLE to the default directory stream</em></figcaption></figure></div>



<p>Eventually, the code will reach the following point. The first call will parse $INDEX_ROOT attribute, and the functionality is relatively similar and simpler than the second one, where $INDEX_ALLOCATION attribute is used. Additional information about these NTFS attributes can be found <a href="http://inform.pucp.edu.pe/~inf232/Ntfs/ntfs_doc_v0.5/attributes/">here</a>. We will assume that the list of elements is long enough to have an $INDEX_ALLOCATION and we will deep into this call:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="54821" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/image-5-3/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-5.png" data-orig-size="849,306" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-5" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-5-300x108.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-5-600x216.png" loading="lazy" width="849" height="306" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-5.png" alt="" class="wp-image-54821" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-5.png 849w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-5-300x108.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-5-600x216.png 600w" sizes="(max-width: 849px) 100vw, 849px" /><figcaption><em>NTFS wrapping callback functions</em></figcaption></figure></div>



<p>It is important to have in mind the parameters sent for a better understanding of the whole process. First two parameters (nFileIndexLow and nFileIndexHigh) are used for calling the function <a href="https://docs.microsoft.com/en-us/windows/win32/api/winioctl/ni-winioctl-fsctl_get_ntfs_file_record" target="_blank" rel="noreferrer noopener"><span class="has-inline-color has-vivid-purple-color">FSCTL_GET_NTFS_FILE_RECORD</span></a>, which will retrieve a NTFS record. After some checks (for example, the magic value), we will pop out in a function that we have called <em>callback_when_attribute_is_found</em>. Note that the first parameter sent to this function will be the $INDEX_ALLOCATION (0x20) value that was previously sent:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-attachment-id="54823" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/image-6-3/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-6.png" data-orig-size="655,187" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-6" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-6-300x86.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-6-600x171.png" loading="lazy" width="600" height="171" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-6-600x171.png" alt="" class="wp-image-54823" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-6-600x171.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-6-300x86.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-6.png 655w" sizes="(max-width: 600px) 100vw, 600px" /><figcaption><em>Call to callback_when_attribute_is_found function</em></figcaption></figure></div>



<p>What this function will do is to iterate through all NTFS attributes that are part of the record. To do that, the code will have to find the offset to the first attribute. This offset is just 2 bytes long, as is relative to the structure. The layout of the header is demonstrated below:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="54824" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/image-7-2/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-7.png" data-orig-size="397,379" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-7" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-7-300x286.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-7.png" loading="lazy" width="397" height="379" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-7.png" alt="" class="wp-image-54824" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-7.png 397w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-7-300x286.png 300w" sizes="(max-width: 397px) 100vw, 397px" /><figcaption><em>NTFS RECORD HEADER layout &#8211; <a href="http://inform.pucp.edu.pe/" target="_blank" rel="noreferrer noopener">source</a></em></figcaption></figure></div>



<p>A NTFS File record will follow this structure:</p>



<figure class="wp-block-table"><table><tbody><tr><td>Record Header</td></tr><tr><td>Attribute</td></tr><tr><td>Attribute</td></tr><tr><td>Attribute</td></tr></tbody></table><figcaption>NTFS record layout</figcaption></figure>



<p>If we still remember the $INDEX_ALLOCATION (0x20), it becomes handy now. Attributes will start with a specific TypeCode, as $INDEX_ALLOCATION is. So, if one of the attributes matches the selected type that was required, the first callback function (the one sent steps before as a parameter) will be triggered:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="54827" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/image-8-2/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-8.png" data-orig-size="763,405" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-8" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-8-300x159.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-8-600x318.png" loading="lazy" width="763" height="405" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-8.png" alt="" class="wp-image-54827" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-8.png 763w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-8-300x159.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-8-600x318.png 600w" sizes="(max-width: 763px) 100vw, 763px" /><figcaption><em>Code showing matching attribute and callback</em></figcaption></figure></div>



<p><em>I<span style="font-size: revert;color: initial;, sans-serif">n the case there is not matching TypeCode but an $ATTRIBUTE_LIST is found, that will mean that exists more attributes, but these cannot fit into $MFT table. In this rare case, the malware will continue processing these extra attributes and will call recursively the first function.</span></em></p>



<p>Lets check what this callback will do. Remember that this callback function, in our case is <em>indexAllocation_Callback_CollectAllfiles</em>. The first step will be recovering the stream that this attribute points to. As $INDEX_ALLOCATION is an attribute meant for directories, makes sense this stream being an index array (block indexes):</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="54828" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/image-9-2/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-9.png" data-orig-size="763,164" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-9" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-9-300x64.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-9-600x129.png" loading="lazy" width="763" height="164" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-9.png" alt="" class="wp-image-54828" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-9.png 763w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-9-300x64.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-9-600x129.png 600w" sizes="(max-width: 763px) 100vw, 763px" /><figcaption><em>Block Indexes array being recovered using raw disk offsets</em></figcaption></figure></div>



<p>As this is an index array, these indexes will point to something. This something is, as you would imagine, NTFS records. In raw disk, these type of indexes look like that:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="54829" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/image-10-2/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-10.png" data-orig-size="1068,300" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-10" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-10-300x84.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-10-600x169.png" loading="lazy" width="1068" height="300" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-10.png" alt="Example of an index block found in a raw disk image file " class="wp-image-54829" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-10.png 1068w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-10-300x84.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-10-600x169.png 600w" sizes="(max-width: 1068px) 100vw, 1068px" /><figcaption><em>Example of an index block found in a raw disk image file </em></figcaption></figure></div>



<p>As indexes point to records, all of these records will be sent, recursively, once more to the initial function. But this time the callback function will be different, also the typecode:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-attachment-id="54832" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/image-13/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-13.png" data-orig-size="626,243" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-13" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-13-300x116.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-13-600x233.png" loading="lazy" width="600" height="233" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-13-600x233.png" alt="" class="wp-image-54832" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-13-600x233.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-13-300x116.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-13.png 626w" sizes="(max-width: 600px) 100vw, 600px" /><figcaption><em>$DATA callback function call</em></figcaption></figure></div>



<p>So this time, every record sent will behave differently. $DATA attributes will be looked for instead of $INDEX_ALLOCATION ($DATA contains file data). Also, the executed callback function will be different (named now <em>dataExecuting</em>). By using the disk properties that were sent in the first call combined with information gathered from indexes, this callback will locate the exact location of the file in disk. The last step for these files, as for all the ones that we have summarized in this report is being added as a member to a <code>elemStr</code>* structure. The offsets contained in this structures, as stated, will be overwritten by the malware in the last steps:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><img data-attachment-id="54833" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/image-14/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-14.png" data-orig-size="835,248" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-14" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-14-300x89.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-14-600x178.png" loading="lazy" width="835" height="248" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-14.png" alt="" class="wp-image-54833" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-14.png 835w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-14-300x89.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-14-600x178.png 600w" sizes="(max-width: 835px) 100vw, 835px" /><figcaption><em>Call to the function that will add the file&#8217;s offset to a elemStr typed structure, for later data destruction</em></figcaption></figure></div>



<h2>Data overwriting</h2>



<p>Finally, after all data is collected, the malware starts overwriting. The <code>elemStr</code> structure is passed into the function, and all the elements on the linked list are being processed:</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwrite_loop.png" data-rel="lightbox-image-40" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54727" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/overwrite_loop/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwrite_loop.png" data-orig-size="596,430" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="overwrite_loop" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwrite_loop-300x216.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwrite_loop.png" loading="lazy" width="596" height="430" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwrite_loop.png" alt="to_overwrite_collected_sectors function overview" class="wp-image-54727" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwrite_loop.png 596w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwrite_loop-300x216.png 300w" sizes="(max-width: 596px) 100vw, 596px" /></a><figcaption><em>to_overwrite_collected_sectors function overview</em></figcaption></figure></div>



<p>The overwriting function uses the installed driver in order to gain the write access to the sectors. It opens the device, and then walks through all the collected chunks, by their offsets. It uses <code>WriteFile</code> to fill it with the previously prepared, random data.</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwriting_func.png" data-rel="lightbox-image-41" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54728" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/overwriting_func/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwriting_func.png" data-orig-size="841,770" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="overwriting_func" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwriting_func-300x275.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwriting_func-600x549.png" loading="lazy" width="841" height="770" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwriting_func.png" alt="Final detail of data destruction" class="wp-image-54728" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwriting_func.png 841w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwriting_func-300x275.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/overwriting_func-600x549.png 600w" sizes="(max-width: 841px) 100vw, 841px" /></a><figcaption><em>Final detail of data destruction</em></figcaption></figure></div>



<p>Example below shows a fragment of a log from our experiments, when we dumped the content of particular structures during malware execution: first data collection, and then usage of the filled structures to wipe out the sectors on the disk:</p>



<figure class="wp-block-image size-full"><a href="https://blog.malwarebytes.com/wp-content/uploads/2022/03/chunks_listing.png" data-rel="lightbox-image-42" data-rl_title="" data-rl_caption="" title=""><img data-attachment-id="54906" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/chunks_listing/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/chunks_listing.png" data-orig-size="1363,301" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="chunks_listing" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/chunks_listing-300x66.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/chunks_listing-600x133.png" loading="lazy" width="1363" height="301" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/chunks_listing.png" alt="" class="wp-image-54906" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/chunks_listing.png 1363w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/chunks_listing-300x66.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/chunks_listing-600x133.png 600w" sizes="(max-width: 1363px) 100vw, 1363px" /></a></figure>



<h2>Conclusion</h2>



<p>As can be seen, by leveraging legitimate but flawless signed code, the attackers are capable of bypassing some Windows security mechanisms. This is extremely harmful because user applications are not meant to have this level of control in kernel space, for security reasons.</p>



<p>Also, we would like to state that recovery in this case is complicated. The attackers first fragment files on disk, and finally, will overwrite all of these fragments. Even without the last step (indiscriminate disk trashing), the combination of fragmentation and wiping of required structures (like $MFT) would be enough to make recovery almost impossible.</p>



<p>Our final thoughts are about the special focus that cybercriminals put in hiding their tracks. Maybe, that part is the final stage of a bigger operation. In fact, ESET recently described other related artifacts <a href="https://www.welivesecurity.com/2022/03/01/isaacwiper-hermeticwizard-wiper-worm-targeting-ukraine/" target="_blank" rel="noreferrer noopener">here</a>, and they connect them to the same actor and campaign. Being part of a bigger picture can explain why attackers are so much interested in corrupting files like $LogFile and Windows events.</p>



<p>Malwarebytes detects this disk wiper as Trojan.HermeticWiper.</p>



<figure class="wp-block-image size-large"><img data-attachment-id="54882" data-permalink="https://blog.malwarebytes.com/threat-intelligence/2022/03/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/attachment/image-21/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-21.png" data-orig-size="1463,890" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-21" data-image-description="" data-image-caption="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-21-300x183.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-21-600x365.png" loading="lazy" width="600" height="365" src="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-21-600x365.png" alt="Malwarebytes users are protected against this attack" class="wp-image-54882" srcset="https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-21-600x365.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-21-300x183.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2022/03/image-21.png 1463w" sizes="(max-width: 600px) 100vw, 600px" /></figure>

<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div></div>
        
      <div class="share-section">
          <p><b>SHARE THIS ARTICLE</b></p>
         


         <a class="socicon-facebook" target="_blank" href="http://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.malwarebytes.com%2F%3Fp%3D54698&t=HermeticWiper%3A+A+detailed+analysis+of+the+destructive+malware+that+targeted+Ukraine" id="social-share-facebook" aria-label="Share this post on Facebook"></a>
         <a class="socicon-twitter" target="_blank" href="https://twitter.com/intent/tweet?text=HermeticWiper%3A+A+detailed+analysis+of+the+destructive+malware+that+targeted+Ukraine+https%3A%2F%2Fblog.malwarebytes.com%2F%3Fp%3D54698&via=Malwarebytes" id="social-share-twitter" aria-label="Share this post on Twitter"></a> 
        
          <a class="socicon-linkedin" target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fblog.malwarebytes.com%2F%3Fp%3D54698&title=HermeticWiper%3A+A+detailed+analysis+of+the+destructive+malware+that+targeted+Ukraine&summary=&source=" id="social-share-linkedin" aria-label="Share this post on LinkedIn"></a>
          

        
          
        </div>
      <hr />
      <div class="comments-section">
        <p><b>COMMENTS</b></p><div id="comments">

	
	
</div><!-- #comments --></div>
        </div>
      <hr />
      <div class="related-articles">
        <p><b>RELATED ARTICLES</b></p>
    <div class="post">
      <div class="large-card">
                  <div class="thumb">
            <a href="https://blog.malwarebytes.com/a-week-in-security/2022/03/a-week-in-security-february-28-march-6/ ">
            <img src="https://blog.malwarebytes.com/wp-content/uploads/2018/01/shutterstock_610335074-604x270.jpg" alt="A week in security (February 28 – March 6)">
            </a>
          </div>
                    <div class="content">
            <p class="breadcrumbs hidden-xs"><a href="https://blog.malwarebytes.com/category/a-week-in-security/" rel="category tag">A week in security</a></p>
            
                      <h2><a href="https://blog.malwarebytes.com/a-week-in-security/2022/03/a-week-in-security-february-28-march-6/ ">A week in security (February 28 – March 6)</a></h2>
            
          </div>
        </div>
                      <p class="desc"> March 7, 2022 - The most important and interesting security stories from the last seven days.</p>
            <div class="post-action"><a href="https://blog.malwarebytes.com/a-week-in-security/2022/03/a-week-in-security-february-28-march-6/" class="continue-read">CONTINUE READING</a><a class="num-comments" href="https://blog.malwarebytes.com/a-week-in-security/2022/03/a-week-in-security-february-28-march-6/#disqus_thread">No Comments</a></div>
          </div> 

            <div class="post">
      <div class="large-card">
                  <div class="thumb">
            <a href="https://blog.malwarebytes.com/malwarebytes-news/2022/02/potential-cybersecurity-impacts-of-russias-invasion-of-ukraine/ ">
            <img src="https://blog.malwarebytes.com/wp-content/uploads/2022/02/Ukraine-map-604x270.jpeg" alt="Potential cybersecurity impacts of Russia&#8217;s invasion of Ukraine">
            </a>
          </div>
                    <div class="content">
            <p class="breadcrumbs hidden-xs"><a href="https://blog.malwarebytes.com/category/malwarebytes-news/" rel="category tag">Malwarebytes news</a></p>
            
                      <h2><a href="https://blog.malwarebytes.com/malwarebytes-news/2022/02/potential-cybersecurity-impacts-of-russias-invasion-of-ukraine/ ">Potential cybersecurity impacts of Russia&#8217;s invasion of Ukraine</a></h2>
            
          </div>
        </div>
                      <p class="desc"> February 25, 2022 - Responding to the crisis in Ukraine must prioritize physical safety, but there are related cyber-risks to consider too.  </p>
            <div class="post-action"><a href="https://blog.malwarebytes.com/malwarebytes-news/2022/02/potential-cybersecurity-impacts-of-russias-invasion-of-ukraine/" class="continue-read">CONTINUE READING</a><a class="num-comments" href="https://blog.malwarebytes.com/malwarebytes-news/2022/02/potential-cybersecurity-impacts-of-russias-invasion-of-ukraine/#disqus_thread">No Comments</a></div>
          </div> 

          
        
      
      </div>
      
      
      
    </div>
    <div class="col-md-4" id="right-rail">
      <hr class="visible-xs visible-sm">



<!-- AUTHOR MODULE -->
<div class="right-rail-section author-info">
      <p><b>ABOUT THE AUTHOR</b></p>
              <div class="small-card">
            <img alt='' src='https://secure.gravatar.com/avatar/147cd7280d6ece931e4488a3a10809d9?s=96&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/147cd7280d6ece931e4488a3a10809d9?s=192&#038;d=identicon&#038;r=g 2x' class='avatar avatar-96 photo' height='96' width='96' loading='lazy'/>            <div class="content">
              <p class="details">
              <span class="name"><a href="https://blog.malwarebytes.com/author/threatintelligence/" title="Posts by Threat Intelligence Team" rel="author">Threat Intelligence Team</a></span>
                
                                
                
                              <br/><span class="title"></span>
                            </p>

                            <p class="desc"></p>
                          </div>
          </div>
      </div>

<!-- SUB CATEGORIES -->
      


	


         
<!-- TOP THREATS -->
    </div>
  </div>
</div>
  
</section>
</article>
  
  
      </div>


<script type="text/plain" class="optanon-category-3">
  var embeds = document.getElementsByClassName('embedded-video');
  var alts = document.getElementsByClassName('embedded-video-alt');
  if(embeds && alts) {
    for(var i = 0; i < embeds.length; i++) {
      embeds[i].src = embeds[i].dataset.src;
      embeds[i].style.display = 'inline-block';
    }

    for(var i = 0; i < alts.length; i++) {
      alts[i].style.display = 'none';
    }
  }
</script>

<script type="text/javascript">
    setTimeout(function() {
        var alts = document.getElementsByClassName('embedded-video-alt');
        for( i = 0; i < alts.length; i++) {
            alts[i].style.background = "none";
        }
    }, 2500);
</script>


<script type="text/plain" class="optanon-category-4">
  $("script[src='https://malwarebytesunpacked.disqus.com/embed.js']").each(function() {
    var scriptSrc = $(this).attr("src");
    var newScript = "<script type='text/javascript' async='' src='" + scriptSrc + "'>";
    $(this).before(newScript).remove();
  });
  
  $("link[href*='https://c.disquscdn.com/next/embed/lounge.bundle'], link[href*='https://c.disquscdn.com/next/embed/common.bundle']").each(function() {
    /**/
  });
  
</script>


<!-- for Labs Nav -->
<script>
var urlID = "blog";
</script>
<script src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/js/labs-nav.js"></script>
<section id="labs-links">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
      <div class="lablink">
        <p><a href="/authors/" id="cta-labs-footernavigation-linkto-contributors-en"><img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/footer/contributors.svg" alt="Silouette of person"><br>
            Contributors</a></p>

      </div>

      <div class="lablink">
        <p><a href="/threats/" id="cta-labs-footernavigation-linkto-threatcenter-en"><img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/footer/threat-center.svg" alt="See all threats"><br>
            Threat Center</a></p>
            
      </div>
      <div class="lablink">
       <p><a href="/podcast/" id="cta-labs-footernavigation-linkto-podcasts-en"><img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/footer/podcast.svg" alt="Malwarebytes Podcast"><br>Podcast</a></p>
    </div>
      <div class="lablink">
        <p><a href="/glossary/" id="cta-labs-footernavigation-linkto-glossary-en"><img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/footer/glossary.svg" alt="Book with bookmark"><br>
            Glossary</a></p>
            
      </div>

      <div class="lablink">
        <p><a href="/tech-support-scams/" id="cta-labs-footernavigation-linkto-scams-en"><img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/footer/scams.svg" alt="Suspicious person"><br>
            Scams</a></p>
            
      </div>

      <div class="lablink">
        <p><a href="/write/" id="cta-labs-footernavigation-linkto-writeforlabs-en"><img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/footer/write.svg" alt="Write for Malwarebytes Labs"><br>
            Write for Labs</a></p>
            
      </div>
      
</div>
    </div>
  </div>
</section>


<footer class="refresh-footer">
    <div class="container">
        <div class="row links-row">
            <!-- newsletter -->
            <div class="col-md-3 col-xs-12 col-md-push-9 newsletter-col">
                <div class="row soc-icon-row newsletter-icons hidden-xs hidden-sm">
                    <div class="footer-soc-icon">
                        <a id="cta-footer-social-twitter-en" class="social socicon-twitter"
                           href="https://twitter.com/malwarebytes" aria-label="Visit Malwarebytes on Twitter"></a>
                    </div>
                    <div class="footer-soc-icon">
                        <a id="cta-footer-social-facebook-en" class="social socicon-facebook"
                           href="https://www.facebook.com/Malwarebytes/"
                           aria-label="Visit Malwarebytes on Facebook"></a>
                    </div>
                    <div class="footer-soc-icon">
                        <a id="cta-footer-social-linkedin-en" class="social socicon-linkedin"
                           href="https://www.linkedin.com/company/malwarebytes"
                           aria-label="Visit Malwarebytes on LinkedIn"></a>
                    </div>
                    <div class="footer-soc-icon">
                        <a id="cta-footer-social-youtube-en" class="social socicon-youtube"
                           href="https://www.youtube.com/user/Malwarebytes"
                           aria-label="Visit Malwarebytes on YouTube"></a>
                    </div>
                    <div class="footer-soc-icon">
                        <a id="cta-footer-social-instagram-en" class="social socicon-instagram-v2"
                           href="https://www.instagram.com/malwarebytesofficial/"
                           aria-label="Visit Malwarebytes on Instagram"></a>
                    </div>
                </div>
                <div class="row newsletter-refresh">
                    <div class="col-xs-12">
                        <h4>Cybersecurity info you can't do without</h4>
                        <p>Want to stay informed on the latest news in cybersecurity? Sign up for our newsletter and
                            learn
                            how to protect your computer from threats.</p>
                    </div>
                    <div class="col-xs-12">
                        <form class="newsletter-form form-inline" action="//www.malwarebytes.com/newsletter/" _lpchecked="1">
                            <div class="email-input">
                                <label for="cta-footer-newsletter-input-email-en"
                                       aria-label="cta-footer-newsletter-input-email-en"
                                       aria-labelledby="cta-footer-newsletter-input-email-en">
                                    <input type="text" class="email-input-field"
                                           id="cta-footer-newsletter-input-email-en" name="email"
                                           placeholder="Email address">
                                </label>
                                <input name="source" type="hidden" value="">
                                <input type="submit" class="submit-bttn" id="cta-footer-newsletter-subscribe-email-en"
                                       value="">
                            </div>
                        </form>
                    </div>
                </div>

            </div>
            <!--logo col-->
            <div class="col-md-2 col-xs-12 col-md-pull-3 footer-col">
                <div class="footer-logo hidden-xs hidden-sm">
                    <svg width="160px" height="25px" viewBox="0 0 160 25" version="1.1"
                         xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                            <g id="Footer-desktop" transform="translate(-165.000000, -68.000000)" fill="#FFFFFF">
                                <g id="Footer">
                                    <g id="Group-3">
                                        <g transform="translate(165.000000, 68.000000)">
                                            <g id="logo">
                                                <path
                                                        d="M104.620758,6.81492418 L104.53414,6.84800885 L104.53414,0.579460088 C104.53414,0.43037976 104.412794,0.314384104 104.256721,0.347468775 L102.436133,0.61294337 C102.314787,0.61294337 102.245333,0.728939026 102.245333,0.844934683 L102.245333,19.1016943 C102.245333,19.21769 102.33235,19.3340842 102.436133,19.3340842 C104.01363,19.6820712 105.99069,19.8315502 107.221712,19.8315502 C112.440783,19.8315502 113.151295,17.4434746 113.151295,14.840548 L113.151295,10.0313123 C113.151295,7.27890681 111.7642,5.86981868 109.076628,5.86981868 C107.135093,5.86981868 105.52247,6.36728459 104.620758,6.81492418 M110.827761,9.96514299 L110.827761,14.923459 C110.827761,16.7805854 110.238195,17.9078559 107.394949,17.9078559 C106.441346,17.9078559 105.504907,17.8249449 104.586031,17.7256909 L104.551304,17.7256909 L104.551304,8.85421552 L104.586031,8.85421552 C105.418288,8.47274526 107.152257,7.82580042 108.504625,7.82580042 C110.100084,7.80945739 110.827761,8.48908829 110.827761,9.96514299"
                                                        id="Fill-1"></path>
                                                <path
                                                        d="M116.202745,6.1348548 L114.469175,6.1348548 C114.313102,6.1348548 114.191357,6.28433374 114.226483,6.43341407 L118.612898,19.3675277 C118.647625,19.4835233 118.734244,19.516608 118.85559,19.516608 L119.375701,19.516608 C119.531774,19.516608 119.653519,19.6656883 119.618792,19.8151673 L117.884823,24.657089 C117.850095,24.8061694 117.971441,24.9556483 118.127115,24.9556483 L119.739738,24.9556483 C119.861084,24.9556483 119.930539,24.8727373 119.982829,24.8061694 L121.924763,19.5496927 L126.467251,6.43341407 C126.501978,6.28433374 126.380632,6.1348548 126.224559,6.1348548 L124.49059,6.1348548 C124.369244,6.1348548 124.300189,6.21776579 124.247898,6.28433374 L120.571996,17.2118421 C120.485377,17.4438334 120.173231,17.4438334 120.103776,17.2118421 L116.497727,6.28433374 C116.393945,6.21776579 116.306927,6.1348548 116.202745,6.1348548"
                                                        id="Fill-3"></path>
                                                <path
                                                        d="M137.858597,10.8605816 L137.858597,14.9068768 C137.858597,18.2731425 139.592566,19.8153666 143.389415,19.8153666 C145.002038,19.8153666 146.787898,19.549892 148.088375,19.135337 C148.21012,19.1022524 148.278776,18.9862567 148.245246,18.8702611 L148.001756,17.57677 C147.967029,17.4276897 147.846082,17.3447787 147.68961,17.3942064 C146.146441,17.7756766 144.759346,17.9582402 143.545887,17.9582402 C140.615224,17.9582402 140.112676,16.9796514 140.112676,14.8901352 L140.112676,13.9450297 C140.112676,13.7955508 140.234022,13.7126398 140.355368,13.7126398 L148.261612,13.7126398 C148.417685,13.7126398 148.504703,13.5966441 148.504703,13.4806485 L148.504703,10.9765773 C148.504703,7.57762552 146.805461,5.9524905 143.251304,5.9524905 C139.713512,5.86957951 137.858597,7.54454085 137.858597,10.8605816 L137.858597,10.8605816 Z M140.147005,10.7115013 C140.147005,8.63912529 141.135734,7.72710446 143.303195,7.72710446 C145.43553,7.72710446 146.302515,8.58929898 146.302515,10.7115013 L146.302515,11.6566068 C146.302515,11.8056871 146.181568,11.8885981 146.059823,11.8885981 L140.372931,11.8885981 C140.216858,11.8885981 140.12984,11.7726025 140.12984,11.6566068 L140.12984,10.7115013 L140.147005,10.7115013 Z"
                                                        id="Fill-5"></path>
                                                <path
                                                        d="M155.370725,11.888638 C152.995299,11.3254013 152.925845,11.0599267 152.925845,9.50135967 C152.925845,8.20786859 153.289883,7.76022899 155.370725,7.76022899 C156.359056,7.76022899 157.780479,7.87622465 158.977173,8.10821596 C159.133246,8.14169924 159.254193,8.02530497 159.254193,7.87622465 L159.375938,6.54925028 C159.375938,6.43325463 159.28892,6.31725897 159.185537,6.2841743 C158.075461,6.0186997 156.740656,5.86922077 155.474907,5.86922077 C151.954679,5.86922077 150.654601,6.84780955 150.654601,9.46827499 C150.654601,12.2202819 150.966747,12.9166545 154.45145,13.7457643 C157.260368,14.3927091 157.451169,14.5417895 157.451169,16.0840135 C157.451169,17.5269835 157.087131,17.9746231 154.763597,17.9746231 C153.65392,17.9746231 152.232497,17.7924581 151.053366,17.5269835 C150.897293,17.4938989 150.775548,17.5600682 150.74122,17.7095471 L150.498528,18.9532119 C150.463801,19.0692076 150.533255,19.1852032 150.654601,19.2182879 C151.799005,19.5997581 153.532974,19.8652327 154.885342,19.8652327 C158.95961,19.8652327 159.705248,18.5717417 159.705248,16.0011025 C159.722812,13.1323027 159.167974,12.8006588 155.370725,11.888638"
                                                        id="Fill-7"></path>
                                                <path
                                                        d="M48.2703991,19.417075 L45.7389002,6.3669657 C45.704173,6.21788537 45.8255189,6.06840643 45.9819912,6.06840643 L48.7909092,6.06840643 C48.9118559,6.06840643 49.033601,6.15131742 49.033601,6.25097004 L50.541643,14.1103733 C50.5763703,14.3762465 50.940408,14.3762465 51.0098626,14.1438566 L53.4547428,6.2342284 C53.489071,6.11823275 53.5760887,6.0520634 53.6974346,6.0520634 L57.0268626,6.0520634 C57.1478094,6.0520634 57.2168648,6.13497439 57.2691553,6.2342284 L59.7140355,14.1438566 C59.8006542,14.3762465 60.1475278,14.3762465 60.1822551,14.1103733 L61.6902971,6.25097004 C61.7250244,6.13497439 61.8120422,6.06840643 61.9333881,6.06840643 L64.7423061,6.06840643 C64.8979801,6.06840643 65.019326,6.21788537 64.9845987,6.3669657 L62.4359357,19.417075 C62.4012085,19.5330706 62.314989,19.5996386 62.1932439,19.5996386 L58.5177407,19.5996386 C58.3959956,19.5996386 58.326541,19.5167276 58.2746497,19.417075 L55.5874768,10.6452522 C55.500459,10.4132609 55.1883127,10.4132609 55.1192573,10.6452522 L52.4320843,19.417075 C52.3973571,19.5330706 52.3103393,19.5996386 52.1889934,19.5996386 L48.5130909,19.5996386 C48.391745,19.5996386 48.3051264,19.5330706 48.2703991,19.417075"
                                                        id="Fill-9"></path>
                                                <path
                                                        d="M44.1961309,17.1122293 C42.9303814,17.1122293 42.5312173,16.5816787 42.5312173,15.0725394 L42.5312173,5.27270015 L42.5312173,1.40856993 C42.5312173,1.25948961 42.4098714,1.14309534 42.2541974,1.17657862 L39.2025876,1.59113354 C39.0812417,1.59113354 39.0117872,1.70752781 39.0117872,1.82352347 L39.0117872,1.93951912 L39.0117872,5.27270015 L39.0117872,15.437268 C39.0117872,18.505373 40.9537207,19.8650334 43.554275,19.8650334 C43.8320932,19.8650334 44.733805,19.8315502 45.2535167,19.7817238 C45.3748626,19.7817238 45.4962085,19.6657282 45.4962085,19.5497325 L45.4962085,17.3940469 C45.4962085,17.2449666 45.3748626,17.1620556 45.2191885,17.1620556 C44.8723149,17.1122293 44.4040954,17.1122293 44.1961309,17.1122293"
                                                        id="Fill-11"></path>
                                                <path
                                                        d="M87.0914657,9.02011721 C85.8257163,9.55066779 84.8030578,10.114303 83.658255,10.8274172 C83.5720356,10.8605019 83.5373083,10.9434129 83.5373083,11.0099808 L83.5373083,19.3672486 C83.5373083,19.5167276 83.4155633,19.5996386 83.2942174,19.5996386 L80.2426076,19.5996386 C80.0865344,19.5996386 79.9999158,19.4832443 79.9999158,19.3672486 L79.9999158,6.78152062 C79.9999158,6.66552497 80.0865344,6.54952931 80.1907163,6.54952931 L82.7222152,6.13457578 C82.8782883,6.10149111 82.9996342,6.21748676 82.9996342,6.31713939 L83.1209801,7.1793339 C83.1557074,7.36189752 83.3636719,7.4448085 83.5197451,7.32881284 C84.317275,6.83134694 85.5834236,6.20114373 86.6060821,5.85275815 C86.7621553,5.81967348 86.9178293,5.88624143 86.9178293,6.03532176 L87.1956475,8.68847327 C87.2475389,8.85429524 87.1784835,8.93720622 87.0914657,9.02011721"
                                                        id="Fill-13"></path>
                                                <path
                                                        d="M134.217781,17.9744637 C132.795559,17.9744637 132.709339,17.3777438 132.709339,16.4322396 L132.709339,8.22405217 C132.709339,8.07497184 132.830286,7.99206086 132.951632,7.99206086 L136.28106,7.99206086 C136.402406,7.99206086 136.523353,7.90914987 136.523353,7.76006955 L136.679825,6.43349379 C136.679825,6.28401485 136.55808,6.1680192 136.437133,6.1680192 L132.951632,6.1680192 C132.795559,6.1680192 132.709339,6.05202354 132.709339,5.93562927 L132.709339,2.81889375 C132.709339,2.66941482 132.587594,2.55302055 132.431521,2.58650383 L130.611333,2.85197843 C130.489987,2.85197843 130.420532,2.96757547 130.420532,3.08357113 L130.420532,5.95237092 C130.420532,6.10184985 130.299186,6.18476084 130.17784,6.18476084 L128.20118,6.18476084 C128.045107,6.18476084 127.958089,6.3007565 127.958089,6.41675215 L127.958089,7.74332791 C127.958089,7.89240823 128.079834,7.97531922 128.20118,7.97531922 L130.17784,7.97531922 C130.333914,7.97531922 130.420532,8.09171348 130.420532,8.20770914 L130.420532,16.7638836 C130.420532,18.9195692 131.408863,19.7817637 133.853344,19.7817637 C134.408581,19.7817637 134.96302,19.748679 135.518257,19.6326834 C135.639603,19.5995987 135.708659,19.5166877 135.708659,19.4006921 L135.708659,18.0741163 C135.708659,17.9246374 135.552985,17.8086417 135.43124,17.8417264 C134.980184,17.941379 134.581818,17.9744637 134.217781,17.9744637"
                                                        id="Fill-15"></path>
                                                <path
                                                        d="M97.3387274,6.21776579 C96.5930888,5.91920652 95.6394857,5.72029988 94.4084635,5.72029988 C93.0213682,5.72029988 91.9631841,5.95229119 91.131326,6.31741841 C89.1893925,7.22943924 88.565499,9.00365459 88.565499,10.9600349 L88.565499,14.5586906 C88.565499,17.7423926 90.0216497,19.698773 94.2523903,19.781684 L95.2403216,19.781684 C96.3847251,19.781684 97.58102,19.6656883 98.6739314,19.5162094 C98.7948781,19.4831247 98.916224,19.3675277 98.8639335,19.251532 L98.8639335,19.1351377 L98.5869136,17.2780114 C97.5119646,17.3940071 96.5755256,17.4274903 95.5009757,17.4274903 C92.9000223,17.4274903 92.1024923,16.7143762 92.1024923,15.1888938 L92.1024923,14.7408556 L92.1024923,14.111051 L99.7313172,14.111051 C99.8873903,14.111051 99.974009,13.9946567 99.974009,13.878661 L99.974009,12.8506446 L99.974009,11.1920263 C99.9396808,9.02039623 99.4016076,7.07996031 97.3387274,6.21776579 L97.3387274,6.21776579 Z M96.8182174,11.5906368 C96.8182174,11.7397171 96.6972706,11.8226281 96.5755256,11.8226281 L92.0677651,11.8226281 L92.0677651,10.644734 C92.0677651,9.35164156 92.6569313,8.48944704 94.4084635,8.48944704 C94.599264,8.48944704 94.8068293,8.48944704 94.9980289,8.52293033 C96.2985057,8.70509533 96.8182174,9.5505482 96.8182174,10.644734 L96.8182174,11.5906368 Z"
                                                        id="Fill-17"></path>
                                                <path
                                                        d="M10.6807539,21.9044842 L10.7673725,21.9044842 C10.9230465,21.9044842 11.0443924,21.7825165 11.0443924,21.6257607 C11.0443924,21.5033739 10.9577738,21.3466181 10.8020998,21.3466181 L10.715082,21.3466181 L10.5242816,21.31183 C7.31659864,20.6839687 4.94157208,17.8070392 4.94157208,14.4414006 C4.94157208,13.0121568 5.37506432,11.6520699 6.12030375,10.5539413 C6.24204881,10.3967664 6.4324501,10.2747986 6.64081377,10.4667616 L11.7038116,15.6271281 C11.7377405,15.6619161 11.8247583,15.7143078 11.8942129,15.7143078 C11.9808315,15.7143078 12.050286,15.6795197 12.0850133,15.6271281 L17.1823392,10.5015496 C17.3731397,10.3095867 17.5467761,10.3447939 17.6509579,10.5363377 C18.3961974,11.6520699 18.8296896,12.9949723 18.8296896,14.4242161 C18.8296896,16.2197822 18.1535056,17.8418273 17.0434301,19.0799464 C17.009102,19.1147344 16.9572107,19.1671261 16.9224834,19.2019141 C16.9224834,19.2367022 16.8877561,19.2890938 16.8877561,19.3238818 C16.8877561,19.4810567 17.009102,19.6030245 17.1651752,19.6030245 L17.1999025,19.6030245 C17.2346297,19.6030245 17.2865211,19.5682364 17.3212484,19.5682364 C24.0830887,16.7084914 23.7713415,9.94368351 23.7713415,9.94368351 C23.7713415,6.09017397 21.9503548,2.62059033 19.1418359,0.441098316 C19.0204901,0.353918635 18.8296896,0.353918635 18.7426718,0.475886362 L12.1025765,7.24111341 C11.9808315,7.36308113 11.790031,7.36308113 11.6690843,7.24111341 L4.97590019,0.475886362 C4.8545543,0.353918635 4.69888029,0.353918635 4.57753439,0.441098316 C1.82050776,2.62059033 -7.98328266e-05,6.03778233 -7.98328266e-05,9.94368351 C-7.98328266e-05,16.1502062 4.66415301,21.2766229 10.6807539,21.9044842"
                                                        id="Fill-19"></path>
                                                <path
                                                        d="M29.9264125,5.80321087 C28.6953903,5.80321087 27.3949136,5.88612185 26.1638914,6.06828685 C26.0425455,6.10177013 25.9211996,6.21776579 25.9730909,6.33376145 L26.25051,8.37345139 C26.2852373,8.48944704 26.3722551,8.6054427 26.5275299,8.6054427 C27.6723326,8.48944704 28.4179712,8.45636237 29.5795388,8.45636237 C32.1800931,8.45636237 32.9780222,9.16907795 32.9780222,10.694959 L32.9780222,11.6073784 C32.9780222,11.7564587 32.8566763,11.8393697 32.7349313,11.8393697 L29.4577938,11.8393697 C26.5798204,11.8393697 24.8634147,13.2317162 24.8634147,15.768872 C24.8634147,18.1071213 26.7534568,19.781684 29.6146653,19.781684 C31.4001264,19.781684 32.1114369,19.516608 32.7006031,18.9860574 C32.8566763,18.8365785 33.1340954,18.9525741 33.1340954,19.1351377 L33.1340954,19.3177014 C33.1340954,19.4667817 33.2554413,19.5496927 33.3767872,19.5496927 L36.2547605,19.5496927 C36.4108337,19.5496927 36.4978515,19.433697 36.4978515,19.3177014 L36.4978515,10.794213 C36.5321796,7.42834589 34.0876985,5.80321087 29.9264125,5.80321087 L29.9264125,5.80321087 Z M33.0123503,14.5750336 C33.0123503,16.2830796 31.8332195,17.4107487 29.9264125,17.4107487 C28.4702617,17.4107487 27.7070599,16.8801981 27.7070599,15.7856137 C27.7070599,14.5750336 28.5045898,14.0775677 29.9264125,14.0775677 L32.7349313,14.0775677 C32.8914036,14.0775677 32.9780222,14.1935633 32.9780222,14.3099576 L32.9780222,14.5750336 L33.0123503,14.5750336 Z"
                                                        id="Fill-21"></path>
                                                <path
                                                        d="M70.879694,5.80321087 C69.649071,5.80321087 68.3485943,5.88612185 67.1175721,6.06828685 C66.9962262,6.10177013 66.8748803,6.21776579 66.9267717,6.33376145 L67.2041908,8.37345139 C67.238918,8.48944704 67.3255366,8.6054427 67.4812107,8.6054427 C68.6260134,8.48944704 69.371652,8.45636237 70.5332196,8.45636237 C73.1337739,8.45636237 73.931703,9.16907795 73.931703,10.694959 L73.931703,11.6073784 C73.931703,11.7564587 73.8099579,11.8393697 73.688612,11.8393697 L70.4118737,11.8393697 C67.5335012,11.8393697 65.8170954,13.2317162 65.8170954,15.768872 C65.8170954,18.1071213 67.7071376,19.781684 70.5679469,19.781684 C72.353408,19.781684 73.0647185,19.516608 73.6538847,18.9860574 C73.8099579,18.8365785 74.0877761,18.9525741 74.0877761,19.1351377 L74.0877761,19.3177014 C74.0877761,19.4667817 74.209122,19.5496927 74.3304679,19.5496927 L77.2084413,19.5496927 C77.3645145,19.5496927 77.4515323,19.433697 77.4515323,19.3177014 L77.4515323,10.794213 C77.5377517,7.42834589 75.0413792,5.80321087 70.879694,5.80321087 L70.879694,5.80321087 Z M73.9660311,14.5750336 C73.9660311,16.2830796 72.7869003,17.4107487 70.879694,17.4107487 C69.4235433,17.4107487 68.6603415,16.8801981 68.6603415,15.7856137 C68.6603415,14.5750336 69.4578714,14.0775677 70.879694,14.0775677 L73.688612,14.0775677 C73.8450844,14.0775677 73.931703,14.1935633 73.931703,14.3099576 L73.931703,14.5750336 L73.9660311,14.5750336 Z"
                                                        id="Fill-23"></path>
                                            </g>
                                        </g>
                                    </g>
                                </g>
                            </g>
                        </g>
                    </svg>
                </div>
                <p class="col-header imagine-title">Imagine a world without malware. We do. </p>

                <p>
                    <a href="//www.malwarebytes.com/for-home/" id="cta-footernavigation-company-linkto-for_home-en" class="for-home-link-en">FOR
                        PERSONAL</a>
                </p>
                <p>
                    <a href="//www.malwarebytes.com/business/" id="cta-footernavigation-company-linkto-for_business-en">FOR
                        BUSINESS</a>
                </p>

            </div>
            <!-- company -->
            <div class="col-md-2 col-xs-12 col-md-pull-3 footer-col company-col">
                <p class="col-header">COMPANY</p>
                <p>
                    <a href="//www.malwarebytes.com/company/" id="cta-footernavigation-company-linkto-about_us-en">ABOUT
                        US</a>
                </p>
                <p>
                    <a href="https://jobs.malwarebytes.com/"
                       id="cta-footernavigation-learn-linkto-careers-en">CAREERS</a>
                </p>
                <p>
                    <a href="https://press.malwarebytes.com/"
                       id="cta-footernavigation-learn-linkto-news_and_press-en">NEWS AND
                        PRESS</a>
                </p>
            </div>
            <!-- my account -->
            <div class="col-md-2 col-xs-12 col-md-pull-3 footer-col">
                <p class="col-header">MY ACCOUNT</p>
                <p>
                    <a href="https://my.malwarebytes.com/en/login"
                       id="cta-footernavigation-myaccount-linkto-sign_in-en">SIGN
                        IN</a>
                </p>
            </div>
            <!-- contact us -->
            <div class="col-md-3 col-xs-12 col-md-pull-3 footer-col">
                <p class="col-header">CONTACT US</p>
                <p>
                    <a href="https://support.malwarebytes.com/hc/en-us" 
                       id="cta-footernavigation-contactus-linkto-get_support-en">GET
                        SUPPORT</a>
                </p>
                <p>
                    <a href="https://www.malwarebytes.com/contact/" 
                       id="cta-footernavigation-contactus-linkto-contact_sales-en">CONTACT
                        SALES</a>
                </p>
                <div class="address">
                    <!-- icon here -->
                    <div class="hq">
                        <img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/footer/ic-pin-map.svg" alt="Map pin">
                        <div class="address-text">
                            3979 Freedom Circle, 12th Floor<br />Santa Clara, CA 95054
                        </div>
                    </div>
                    <div class="local hidden outside-na">
                        <img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/footer/ic-pin-map.svg" alt="Map pin">
                        <div class="address-text">
                            One Albert Quay, 2nd Floor<br />Cork T12 X8N6<br />Ireland
                        </div>
                    </div>
                </div>

            </div>

        </div>
        <div class="row soc-icon-row hidden-md hidden-lg">
            <div class="footer-soc-icon">
                <a id="cta-footer-social-twitter-en" class="social socicon-twitter"
                   href="https://twitter.com/malwarebytes" aria-label="Visit Malwarebytes on Twitter"></a>
            </div>
            <div class="footer-soc-icon">
                <a id="cta-footer-social-facebook-en" class="social socicon-facebook"
                   href="https://www.facebook.com/Malwarebytes/" aria-label="Visit Malwarebytes on Facebook"></a>
            </div>
            <div class="footer-soc-icon">
                <a id="cta-footer-social-linkedin-en" class="social socicon-linkedin"
                   href="https://www.linkedin.com/company/malwarebytes"
                   aria-label="Visit Malwarebytes on LinkedIn"></a>
            </div>
            <div class="footer-soc-icon">
                <a id="cta-footer-social-youtube-en" class="social socicon-youtube"
                   href="https://www.youtube.com/user/Malwarebytes" aria-label="Visit Malwarebytes on YouTube"></a>
            </div>
            <div class="footer-soc-icon">
                <a id="cta-footer-social-instagram-en" class="social socicon-instagram-v2"
                   href="https://www.instagram.com/malwarebytesofficial/"
                   aria-label="Visit Malwarebytes on Instagram"></a>
            </div>
        </div>

    </div>
    <div class="footer-bottom">
        <div class="container">
            <div class="row">
                <div class="col-xs-10 col-md-2">
                    <div class="lang-select-container">
                        <img src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/images/footer/world.svg" alt="Globe icon">
                        &nbsp;&nbsp; <a href="#" class="language-select col-header"
                                        id="cta-footernavigation-linkto-languageselect-en">English</a>
                    </div>
                </div>
                <div class="col-xs-12 col-md-10 legal-list-col">
                    <div class="legal-list">
                        <div class="legal-link">
                            <a class="legal" href="//www.malwarebytes.com/legal/" id="cta-footernavigation-linkto-legal-en">Legal</a>
                        </div>
                        <div class="legal-link">
                            <a class="legal" href="//www.malwarebytes.com/legal/privacy-policy" id="cta-footernavigation-linkto-privacy-en">Privacy</a>
                        </div>
                        <div class="legal-link">
                            <a class="legal" href="//www.malwarebytes.com/accessibility/"
                               id="cta-footernavigation-linkto-accessibility-en">Accessibility</a>
                        </div>

                        <div class="legal-link legal-last">
                            <a class="legal" href="//www.malwarebytes.com/tos/" id="cta-footernavigation-linkto-tos-en">Terms of Service</a>
                        </div>
                    </div>
                    <br class="hidden-md hidden-lg">
                    <p class="p-year">&copy;
                        <script>
                          $(document).ready(function () {
                            var d = new Date();
                            var year = d.getFullYear();
                            $(".currentYear").text(year);
                          });
                        </script><span class="currentYear"></span> All Rights Reserved</p>
                </div>
            </div>

        </div>
    </div>

</footer>

<!-- language select overlay -->
<section id="overlay-lang" class="text-center text-white" style="overflow-y: scroll;">
  <div class="container">
    <div class="row center-row">
      <div class="col-md-10">
     
        <p class="h2">Select your language</p>
      </div>
    </div>
    <div class="row center-row">
      <div class="col-md-5">
        <div class="text-center">
          <ul class="list-unstyled" id="intl-sites">
            </ul>
        </div>
      </div>
      
    </div>
  </div>
</section>
<!-- pillar page select overlay -->
<section id="pillar-pages" class="text-white overlay" style="overflow-y: scroll; display: none;">
  <div class="container">
    <div class="row">
      <div class="col-md-10">
        <p class="h2"><a href="https://www.malwarebytes.com/cybersecurity/" id="cta-labs-footernavigation-lightbox-learn-linkto-cybersecurity-en">Cybersecurity basics</a></p>
        <p>Your intro to everything relating to cyberthreats, and how to stop them.</p>
      </div>
    </div>
    <div class="row"> 
      <div class="col-md-8 pillar-pages-list">
              
              
              
            </div>
    </div>
  </div>
</section>
 <script>
  overlay('.language-select', '#overlay-lang');
  overlay('.pillar-page-lightbox', '#pillar-pages');
</script>

	<div style="display:none">
	<div class="grofile-hash-map-147cd7280d6ece931e4488a3a10809d9">
	</div>
	</div>
		<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div
				class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions"
				itemscope
				itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"/>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"/>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"/>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
							</span>
						</a>
												<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"/>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<div id="jp-carousel-comment-form-commenting-as">
												<p id="jp-carousel-commenting-as">
													You must be <a href="#" class="jp-carousel-comment-login">logged in</a> to post a comment.												</p>
											</div>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"/>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		<link rel='stylesheet' id='jetpack-carousel-swiper-css-css'  href='https://blog.malwarebytes.com/wp-content/plugins/jetpack/modules/carousel/swiper-bundle.css?ver=10.6' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack-carousel-css'  href='https://blog.malwarebytes.com/wp-content/plugins/jetpack/modules/carousel/jetpack-carousel.css?ver=10.6' type='text/css' media='all' />
<script type='text/javascript' src='https://secure.gravatar.com/js/gprofiles.js?ver=202212' id='grofiles-cards-js'></script>
<script type='text/javascript' id='wpgroho-js-extra'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-content/plugins/jetpack/modules/wpgroho.js?ver=10.6' id='wpgroho-js'></script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-includes/js/imagesloaded.min.js?ver=4.1.4' id='imagesloaded-js'></script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-includes/js/masonry.min.js?ver=4.2.2' id='masonry-js'></script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-includes/js/jquery/jquery.masonry.min.js?ver=3.1.2b' id='jquery-masonry-js'></script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/js/functions.js?ver=2013-07-18' id='mb_labs-script-js'></script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-includes/js/wp-embed.min.js?ver=5.8.3' id='wp-embed-js'></script>
<script type='text/javascript' id='jetpack-carousel-js-extra'>
/* <![CDATA[ */
var jetpackSwiperLibraryPath = {"url":"https:\/\/blog.malwarebytes.com\/wp-content\/plugins\/jetpack\/_inc\/build\/carousel\/swiper-bundle.min.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/blog.malwarebytes.com\/wp-admin\/admin-ajax.php","nonce":"95430eb848","display_exif":"1","display_comments":"1","display_geo":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"1","require_name_email":"0","login_url":"https:\/\/blog.malwarebytes.com\/wp-login.php?redirect_to=https%3A%2F%2Fblog.malwarebytes.com%2Fthreat-intelligence%2F2022%2F03%2Fhermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine%2F","blog_id":"1","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"]};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.malwarebytes.com/wp-content/plugins/jetpack/_inc/build/carousel/jetpack-carousel.min.js?ver=10.6' id='jetpack-carousel-js'></script>
<script src="https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/js/standard-search-results-footer.js" type="text/javascript"></script>
<script type="text/javascript">
  var countryError, country;
  $.browser = {};
  (function() {
    $.browser.msie = false;
    $.browser.version = 0;
    if (navigator.userAgent.match(/MSIE ([0-9]+)\./)) {
      $.browser.msie = true;
      $.browser.version = RegExp.$1;
    }
  })();
  // Use Microsoft XDR for IE8/9
  if ($.browser.msie && window.XDomainRequest && $.browser.version < 10) {
    //console.log("browser is IE less than 10");

    var xdr = new XDomainRequest();
    xdr.open("GET", "https://genesis.malwarebytes.com/api/v1/wai.gif");
    xdr.onload = function() {
      //console.log("onload function");
      // use xdr.responseText for ie8/9, since unable to specify JSON accept request header
      var dom = new ActiveXObject("Microsoft.XMLDOM");
      var data = $.parseJSON(xdr.responseText);
      //console.log("IE data: " + data);
      dom.async = false;
      if (data == null || typeof(data) == "undefined") {
        // console.log("data is null or undefined");
        window.countryError = data["error"]["errorCode"];
      }
      window.country = data["location"]["countryCode"];
      //console.log("IE country in geo: " + country);
    };
    // function to call when an error occurs
    xdr.onerror = function() {
      //console.log("onerror XDR");
      window.countryError = data["error"]["errorCode"];
    };
    //console.log("before the send");
    xdr.send();
    //console.log("after the function");
  } else { // not IE 8/9, so use AJAX
    $.ajax({
      url: "https://genesis.malwarebytes.com/api/v1/wai.gif",
      type: "GET",
      crossDomain: true,
      dataType: "json",
      success: function(data) {
        //set country     
        //console.log("in success" + JSON.stringify(data));
        window.country = data["location"]["countryCode"];
      },
      error: function(data, jqXHR, textStatus, errorThrown) {
        //      console.log('geohtml genesis error POST1: ' + JSON.stringify(data)); 
        //      console.log("jqXHR: " + jqXHR);
        //      console.log("textStatus: " + textStatus);
        //      console.log("errorThrown: " + errorThrown);
        window.countryError = data["error"]["errorCode"];
      },
      async: false
    });
  }
</script>

<script type="text/plain" class="optanon-category-4">
  $("script[src='https://malwarebytesunpacked.disqus.com/embed.js']").each(function() {
    var scriptSrc = $(this).attr("src");
    var newScript = "<script type='text/javascript' async='' src='" + scriptSrc + "'>";
    $(this).before(newScript).remove();
  });
</script>

<!--replace with onetrust -->

<!---->

<script>
/*
  function enableCookies() {
    //fire inline scripts
    $('.ce-script').each(function() {
      var scripts = $(this).text();
      var scriptParent = $(this).parent();
      //console.log($(this).attr('data-ce-src'));
      if (!$(this).attr('data-ce-src')) {
        //console.log('no attribute')
          //fire marketo forms
        if (scripts.indexOf("MktoForms2") > -1) {
          
          //set interval for mkto
          var mktoInt = setInterval(function() {
            if(typeof(MktoForms2) !== "undefined") {
              clearInterval(mktoInt);
              $(scriptParent).append('<script>' + scripts + '<\/script>');
              $(scriptParent).append("<script>(function(d,b,a,s,e){ var t = b.createElement(a),fs = b.getElementsByTagName(a)[0]; t.async=1; t.id=e; t.src=('https:'==document.location.protocol ? 'https://' : 'http://') + s; fs.parentNode.insertBefore(t, fs); })(window,document,'script','scripts.demandbase.com/HWyTnY16.min.js','demandbase_js_lib');<\/script>");
              
            }
          }, 10);
        } else {

          $(scriptParent).append('<script>' + scripts + '<\/script>');
        }
      } else {
        var attr = $(this).attr('data-ce-src');
        $(this).attr('src', attr);
        //console.log('attribute is: ' + attr);
        $(scriptParent).append('<script src="' + attr + '"><\/script>');
      }
      //console.log(scripts);
    });
    
    //iframes
    
    $('.ce-iframe').each(function() {
      var iframesrc = $(this).attr('data-ce-src');
      $(this).attr('src', iframesrc);
    });
    
    
  }

  var gdprCountries = [
    "BE",
    "BG",
    "CZ",
    "DK",
    "DE",
    "EE",
    "IE",
    "EL",
    "ES",
    "FR",
    "HR",
    "IT",
    "CY",
    "LV",
    "LT",
    "LU",
    "HU",
    "MT",
    "NL",
    "AT",
    "PL",
    "PT",
    "RO",
    "SI",
    "SK",
    "FI",
    "SE",
    "UK",
    "GB"
  ];
  //read user preference cookie
  var cookiePreference = $.cookie('ce-cookie');
  

  
  
  //cookie config
  if (gdprCountries.indexOf(country) > -1) {
    if (cookiePreference === "N" && cookiePreference !== "Y") {
      $(window).load(function() {
        $('a[href*="https://my.malwarebytes"]').attr('href','https://www.malwarebytes.com/myaccount-consent');
        //$('form[id*="mktoForm"]').append('<p>To view this content you need to enable cookies. <br>' + '<a style="text-decoration: underline;" href="#" class="ce-accept">Enable All Cookies</a>' + '</p>');
      });

    } else {
      enableCookies();
    }

    //variable for cookies to fire or not
    //var cookies = "no";

    //if (cookies === "yes") {
    //  enableCookies();
    //}
    
    //remove for onetrust
    COOKIES_ENABLER.init({
      scriptClass: 'ce-script',
      iframeClass: 'ce-iframe',
      acceptClass: 'ce-accept',
      dismissClass: 'ce-dismiss',
      disableClass: 'ce-disable',
      bannerClass: 'ce-banner',
      bannerHTML: '<p>By continuing to browse our website or by clicking "Accept All Cookies," you agree to the storing of first- and third-party cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts. <a href="https://www.malwarebytes.com/privacy/" style="margin-left:0;" id="cta-labs-cookiegdpr-linkto-privacypolicy-en">Privacy and Cookie Policy</a><br>' + '<a href="#" class="ce-accept bluecta-sm" style="width: auto; padding-left:10px; padding-right:10px;" id="cta-labs-cookiegdpr-acceptallcookies-en">' + 'Accept All Cookies' + '</a>' + '<a href="#" class="ce-disable ce-disable" id="cta-labs-cookiegdpr-disableallcookies-en">Disable Cookies</a>' + '</p>',
      eventScroll: false,
      scrollOffset: 200,
      clickOutside: false,
      cookieName: 'ce-cookie',
      cookieDuration: '365',
      wildcardDomain: true,
      iframesPlaceholder: true,
      iframesPlaceholderHTML: '<p>To view this content you need to enable cookies. <br>' + '<a style="text-decoration: underline;" href="#" class="ce-accept"  id="cta-labs-cookiegdpr-enablecookies-viaiframe-en">Enable All Cookies</a>' + '</p>',
      iframesPlaceholderClass: 'ce-iframe-placeholder',
      // Callbacks
      onEnable: function() {
        //enableCookies();
      },
      onDismiss: function() {
        //console.log('the banner has been dismissed');
      },
      onDisable: function() {
        $('a[href*="https://my.malwarebytes"]').attr('href','https://www.malwarebytes.com/myaccount-consent');
        $('form[id*="mktoForm"]').append('<p id="consent-message">To view this content you need to enable cookies. <br>' + '<a style="text-decoration: underline;" href="#" class="ce-accept">Enable All Cookies</a>' + '</p>');
        $('#consent-message .ce-accept').click(function() {
          setTimeout(function() {
            window.location.reload()
          }, 250);
          $('#consent-message').remove();
        });
      }
    });
  } else {
    enableCookies();
  }
  */
</script>
<style>
  .ce-banner {
    display: block;
    position: fixed;
    width: 100vw;
    background: #fff;
    bottom: 0;
    left: 0;
    z-index: 99999;
    box-sizing: border-box;
    padding: 20px;
    text-align: center;
    box-shadow: 0px 0px 20px #424242;
  }
  
  .ce-banner a {
    margin: 0 10px;
  }
</style>
<script>
$(document).ready(function() {
  $.getJSON("https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/pillarpages.json", function(allpillarpages){
    number_of_pillar_pages_to_show = 5;
    var pillar_card_slug;

    function pillar_card() {
      if (typeof allpillarpages[i].uri === "undefined") { 
        var pillar_card_slug = allpillarpages[i].pillarpage.replace(" ", "-").toLowerCase();
      }
      else {
        var pillar_card_slug = allpillarpages[i].uri;
      }
      var pillar_card_html = '<div class="col-md-3"><p><a href="https://www.malwarebytes.com/' + pillar_card_slug + '/" id="cta-labs-footernavigation-lightbox-learn-linkto-' + pillar_card_slug + '-en">' + allpillarpages[i].pillarpage +'</a></p></div>';
      
      var pillar_card_list_html = '<p><a href="https://www.malwarebytes.com/' + pillar_card_slug + '/" id="cta-labs-footernavigation-learn-linkto-' + pillar_card_slug + '-en">' + allpillarpages[i].pillarpage +'</a></p>'
      
      $("section#pillar-pages .pillar-pages-list").append(pillar_card_html);
      
      if ([i] < number_of_pillar_pages_to_show) {
        $("footer .pillar-pages-list").append(pillar_card_list_html);
      }
    };
    for (i=0;i<allpillarpages.length;i++) {
      pillar_card();
    } 
  });
});
</script>
<script>
$(document).ready(function() {
  $.getJSON("https://blog.malwarebytes.com/wp-content/themes/mb-labs-theme/intl-sites.json", function(intlSites){

    function listIntlSites() {
      let indCountry = '<li><a href="' + intlSites[i].url + '/" class="' + intlSites[i].country + '-site" id="cta-labs-footer-linkto-' + intlSites[i].country + '_site-en">' + intlSites[i].lang + '</a></li>'
      $("#intl-sites").append(indCountry);
    };
    for (i=0;i<intlSites.length;i++) {
            listIntlSites();
          }  
  });
});
</script>
</body>
</html>