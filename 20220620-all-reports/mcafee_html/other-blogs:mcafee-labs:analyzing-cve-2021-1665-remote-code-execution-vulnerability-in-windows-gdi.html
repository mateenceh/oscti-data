<!DOCTYPE html>
<html lang="en-US">

    <head>

        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <link rel="profile" href="https://gmpg.org/xfn/11">
        <link rel="pingback" href="https://www.mcafee.com/xmlrpc.php">
                    <link rel="canonical" href="https://www.mcafee.com/blogs/other-blogs/mcafee-labs/analyzing-cve-2021-1665-remote-code-execution-vulnerability-in-windows-gdi/">
                            <link rel="shortcut icon" href="https://www.mcafee.com/enterprise/en-us/img/favicon.ico">
        <!--<link rel="stylesheet" href="/wp-content/themes/securingtomorrow/css/responsive/blog.css" type="text/css">
        <link rel="stylesheet" href="/wp-content/themes/securingtomorrow/css/responsive/main.css" type="text/css">-->
        <link rel="stylesheet" href="/enterprise/www/css/main.min.css" type="text/css">
       
        	<script type="text/javascript">function theChampLoadEvent(e){var t=window.onload;if(typeof window.onload!="function"){window.onload=e}else{window.onload=function(){t();e()}}}</script>
		<script type="text/javascript">var theChampDefaultLang = 'en_US', theChampCloseIconPath = 'https://www.mcafee.com/wp-content/plugins/super-socializer/images/close.png';</script>
		<script>var theChampSiteUrl = 'https://www.mcafee.com/blogs', theChampVerified = 0, theChampEmailPopup = 0, heateorSsMoreSharePopupSearchText = 'Search';</script>
		<style type="text/css">.the_champ_horizontal_sharing .theChampSharing{
					color: #fff;
				border-width: 0px;
		border-style: solid;
		border-color: transparent;
	}
		.the_champ_horizontal_sharing .theChampTCBackground{
		color:#666;
	}
		.the_champ_horizontal_sharing .theChampSharing:hover{
				border-color: transparent;
	}
	.the_champ_vertical_sharing .theChampSharing{
					color: #fff;
				border-width: 0px;
		border-style: solid;
		border-color: transparent;
	}
		.the_champ_vertical_sharing .theChampTCBackground{
		color:#666;
	}
		.the_champ_vertical_sharing .theChampSharing:hover{
				border-color: transparent;
	}
	@media screen and (max-width:783px){.the_champ_vertical_sharing{display:none!important}}div.heateor_ss_mobile_footer{display:none;}@media screen and (max-width:783px){div.the_champ_bottom_sharing ul.the_champ_sharing_ul i.theChampTCBackground{background-color:white}div.the_champ_bottom_sharing{width:100%!important;left:0!important;}div.the_champ_bottom_sharing li{width:12.5% !important;}div.the_champ_bottom_sharing .theChampSharing{width: 100% !important;}div.the_champ_bottom_sharing div.theChampTotalShareCount{font-size:1em!important;line-height:28px!important}div.the_champ_bottom_sharing div.theChampTotalShareText{font-size:.7em!important;line-height:0px!important}div.heateor_ss_mobile_footer{display:block;height:40px;}.the_champ_bottom_sharing{padding:0!important;display:block!important;width: auto!important;bottom:-2px!important;top: auto!important;}.the_champ_bottom_sharing .the_champ_square_count{line-height: inherit;}.the_champ_bottom_sharing .theChampSharingArrow{display:none;}.the_champ_bottom_sharing .theChampTCBackground{margin-right: 1.1em !important}}</style>
	
	<!-- This site is optimized with the Yoast SEO plugin v16.2 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Analyzing CVE-2021-1665 – Remote Code Execution Vulnerability in Windows GDI+ | McAfee Blogs</title>
	<meta name="description" content="Introduction Microsoft Windows Graphics Device Interface+, also known as GDI+, allows various applications to use different graphics functionality on" />
	<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Analyzing CVE-2021-1665 – Remote Code Execution Vulnerability in Windows GDI+ | McAfee Blogs" />
	<meta property="og:description" content="Introduction Microsoft Windows Graphics Device Interface+, also known as GDI+, allows various applications to use different graphics functionality on" />
	<meta property="og:url" content="/blogs/other-blogs/mcafee-labs/analyzing-cve-2021-1665-remote-code-execution-vulnerability-in-windows-gdi/" />
	<meta property="og:site_name" content="McAfee Blogs" />
	<meta property="article:publisher" content="https://www.facebook.com/mcafee" />
	<meta property="article:published_time" content="2021-06-28T19:44:00+00:00" />
	<meta property="article:modified_time" content="2021-06-28T19:45:10+00:00" />
	<meta property="og:image" content="https://www.mcafee.com/wp-content/uploads/2021/06/AdobeStock_349881038_614x300-1.jpg" />
	<meta property="og:image:width" content="614" />
	<meta property="og:image:height" content="300" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:creator" content="@hardik05" />
	<meta name="twitter:site" content="@mcafee" />
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="Hardik Shah">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="16 minutes">
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://www.mcafee.com/blogs/#website","url":"https://www.mcafee.com/blogs/","name":"McAfee Blogs","description":"Securing Tomorrow. Today.","potentialAction":[{"@type":"SearchAction","target":"https://www.mcafee.com/blogs/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/analyzing-cve-2021-1665-remote-code-execution-vulnerability-in-windows-gdi/#primaryimage","inLanguage":"en-US","url":"/wp-content/uploads/2021/06/AdobeStock_349881038_614x300-1.jpg","contentUrl":"/wp-content/uploads/2021/06/AdobeStock_349881038_614x300-1.jpg","width":614,"height":300,"caption":"Consejos para protegerte de quienes intentan hackear tus correos electr\u00f3nicos"},{"@type":"WebPage","@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/analyzing-cve-2021-1665-remote-code-execution-vulnerability-in-windows-gdi/#webpage","url":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/analyzing-cve-2021-1665-remote-code-execution-vulnerability-in-windows-gdi/","name":"Analyzing CVE-2021-1665 \u2013 Remote Code Execution Vulnerability in Windows GDI+ | McAfee Blogs","isPartOf":{"@id":"https://www.mcafee.com/blogs/#website"},"primaryImageOfPage":{"@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/analyzing-cve-2021-1665-remote-code-execution-vulnerability-in-windows-gdi/#primaryimage"},"datePublished":"2021-06-28T19:44:00+00:00","dateModified":"2021-06-28T19:45:10+00:00","author":{"@id":"https://www.mcafee.com/blogs/#/schema/person/99cb905e9b4051dfea96a7752dea4342"},"description":"Introduction Microsoft Windows Graphics Device Interface+, also known as GDI+, allows various applications to use different graphics functionality on","breadcrumb":{"@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/analyzing-cve-2021-1665-remote-code-execution-vulnerability-in-windows-gdi/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://www.mcafee.com/blogs/other-blogs/mcafee-labs/analyzing-cve-2021-1665-remote-code-execution-vulnerability-in-windows-gdi/"]}]},{"@type":"BreadcrumbList","@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/analyzing-cve-2021-1665-remote-code-execution-vulnerability-in-windows-gdi/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"/blogs/","url":"/blogs/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"/blogs/other-blogs/","url":"/blogs/other-blogs/","name":"Other Blogs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"/blogs/other-blogs/mcafee-labs/","url":"/blogs/other-blogs/mcafee-labs/","name":"McAfee Labs"}},{"@type":"ListItem","position":4,"item":{"@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/analyzing-cve-2021-1665-remote-code-execution-vulnerability-in-windows-gdi/#webpage"}}]},{"@type":"Person","@id":"https://www.mcafee.com/blogs/#/schema/person/99cb905e9b4051dfea96a7752dea4342","name":"Hardik Shah","description":"Hardik Shah, a Senior Research Engineer in McAfee Labs, is an experienced security researcher and technology evangelist. He has extensive experience with exploits, malware analysis, and various IPS engines. Shah enjoys figuring out ways to protect customers from the latest threats. Prior to McAfee, he worked with the IPS research team at Symantec. You can follow him on twitter at @hardik05","sameAs":["https://www.linkedin.com/in/hardik05/","https://twitter.com/hardik05"]}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//stackpath.bootstrapcdn.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="McAfee Blogs &raquo; Feed" href="https://www.mcafee.com/blogs/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.6.3"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='/wp-includes/css/dist/block-library/style.min.css?ver=5.6.3' type='text/css' media='all' />
<link rel='stylesheet' id='mpp_gutenberg-css'  href='/wp-content/plugins/metronet-profile-picture/dist/blocks.style.build.css?ver=2.5.0' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='/wp-includes/css/dashicons.min.css?ver=5.6.3' type='text/css' media='all' />
<link rel='stylesheet' id='wpmm_css-css'  href='/wp-content/plugins/wp-megamenu/assets/css/wpmm.css?ver=1.3.7' type='text/css' media='all' />
<link rel='stylesheet' id='wp_megamenu_generated_css-css'  href='/wp-content/uploads/wp-megamenu/wp-megamenu.css?ver=1.3.7' type='text/css' media='all' />
<link rel='stylesheet' id='featuresbox_css-css'  href='/wp-content/plugins/wp-megamenu/addons/wpmm-featuresbox/wpmm-featuresbox.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='postgrid_css-css'  href='/wp-content/plugins/wp-megamenu/addons/wpmm-gridpost/wpmm-gridpost.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wp-bootstrap-pro-fontawesome-cdn-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6.3' type='text/css' media='all' />
<link rel='stylesheet' id='open-sans-google-font-css'  href='https://fonts.googleapis.com/css?family=Open+Sans%3A300%2C400&#038;ver=5.6.3' type='text/css' media='all' />
<link rel='stylesheet' id='theme-css-css'  href='/wp-content/themes/securingtomorrow/style.css?ver=5.6.3' type='text/css' media='all' />
<link rel='stylesheet' id='the_champ_frontend_css-css'  href='/wp-content/plugins/super-socializer/css/front.css?ver=7.13.16' type='text/css' media='all' />
<link rel='stylesheet' id='addtoany-css'  href='/wp-content/plugins/add-to-any/addtoany.min.css?ver=1.15' type='text/css' media='all' />
<link rel='stylesheet' id='poppins-css'  href='//fonts.googleapis.com/css?family=Poppins%3A100%2C100italic%2C200%2C200italic%2C300%2C300italic%2Cregular%2Citalic%2C500%2C500italic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic%2C900%2C900italic&#038;ver=1.3.7' type='text/css' media='all' />
<link rel='stylesheet' id='oswald-css'  href='//fonts.googleapis.com/css?family=Oswald%3A200%2C300%2Cregular%2C500%2C600%2C700&#038;ver=1.3.7' type='text/css' media='all' />
<script type='text/javascript' src='/wp-content/plugins/jquery-updater/js/jquery-3.6.0.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='/wp-content/plugins/jquery-updater/js/jquery-migrate-3.3.2.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='/wp-content/plugins/add-to-any/addtoany.min.js?ver=1.1' id='addtoany-js'></script>
<script type='text/javascript' src='/wp-content/plugins/wp-megamenu/addons/wpmm-featuresbox/wpmm-featuresbox.js?ver=1' id='featuresbox-style-js'></script>
<script type='text/javascript' id='postgrid-style-js-extra'>
/* <![CDATA[ */
var postgrid_ajax_load = {"ajax_url":"https:\/\/www.mcafee.com\/wp-admin\/admin-ajax.php","redirecturl":"https:\/\/www.mcafee.com\/blogs\/"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/wp-megamenu/addons/wpmm-gridpost/wpmm-gridpost.js?ver=1' id='postgrid-style-js'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='/wp-content/themes/securingtomorrow/js/html5.js?ver=3.7.0' id='html5hiv-js'></script>
<![endif]-->
<link rel="https://api.w.org/" href="https://www.mcafee.com/blogs/wp-json/" /><link rel="alternate" type="application/json" href="https://www.mcafee.com/blogs/wp-json/wp/v2/posts/123988" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.mcafee.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.mcafee.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.6.3" />
<link rel='shortlink' href='https://www.mcafee.com/blogs/?p=123988' />
<link rel="alternate" type="application/json+oembed" href="https://www.mcafee.com/blogs/wp-json/oembed/1.0/embed?url=%2Fblogs%2Fother-blogs%2Fmcafee-labs%2Fanalyzing-cve-2021-1665-remote-code-execution-vulnerability-in-windows-gdi%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://www.mcafee.com/blogs/wp-json/oembed/1.0/embed?url=%2Fblogs%2Fother-blogs%2Fmcafee-labs%2Fanalyzing-cve-2021-1665-remote-code-execution-vulnerability-in-windows-gdi%2F&#038;format=xml" />

<script data-cfasync="false">
window.a2a_config=window.a2a_config||{};a2a_config.callbacks=[];a2a_config.overlays=[];a2a_config.templates={};
(function(d,s,a,b){a=d.createElement(s);b=d.getElementsByTagName(s)[0];a.async=1;a.src="https://static.addtoany.com/menu/page.js";b.parentNode.insertBefore(a,b);})(document,"script");
</script>
<script>
var utag_data = {
tm_global_pagename:"",
tm_global_page_publish_date:"",
tm_global_businessunit:"consumer",
tm_global_sitesection:"",
tm_global_sitesection_level2:"",
tm_global_sitesection_level3:"",
tm_global_platform:"web",
tm_global_culture_code:"en-us",
tm_global_country:"united states",
tm_global_geo:"na",
tm_global_channel:"direct",
tm_global_affiliate_id:"",
tm_global_affiliate_name:"",
tm_global_campaign_id:"",
tm_global_page_version:"",
tm_global_pageurl:location.href,
tm_global_clientid :"",
tm_global_trafficsource:"",
tm_global_sourcetype:"blog",
tm_global_wssversion:"",
tm_global_coe:"",
tm_global_coe_level2:"",
tm_local_blogs_author:""
}
var sec=location.pathname.replace("/blogs","").split("/"); utag_data.tm_global_pagename="[consumer:web]";
if(sec.length > 2) {
for(i=1;i<sec.length-1;i++) {
utag_data.tm_global_pagename+="|"+sec[i];
if(i==1){utag_data.tm_global_sitesection=sec[i]}
if(i==2){utag_data.tm_global_sitesection_level2=sec[i]}
if(i==3){utag_data.tm_global_sitesection_level3=sec[i]}
}
}
else {
utag_data.tm_global_sitesection="Homepage"
utag_data.tm_global_pagename+="|Homepage"
}

var today = new Date(); var dd = today.getDate(); var mm = today.getMonth() + 1; var yyyy = today.getFullYear();
if (dd < 10) { dd = '0' + dd;    } 
if (mm < 10) {mm = '0' + mm;  } 
utag_data.tm_global_page_publish_date = dd + '/' + mm + '/' + yyyy;

</script>

<script>
	var ISOTOPE_CACHE 				=  [];
	var ISOTOPE_AJAX_URL 			= 'https://www.mcafee.com/wp-admin/admin-ajax.php';
	var ISOTOPE_AJAX_URL_ENDPOINT 	= 'https://www.mcafee.com/wp-content/plugins/ae-isotope/endpoint.php';
	var ISOTOPE_AJAX_ITEMS			= 25;
	var ISOTOPE_CURRENT_CATEGORY	= '';
</script>		<meta property="fb:app_id" content="346056175795920" />
					<meta property="fb:admins" content="100007220654854" />
			<style type="text/css">.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-97446.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-97446>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-97446>a { }li#wp-megamenu-item-97446> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-97446 a { }#wp-megamenu-item-97446> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-97445.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-97445>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-97445>a { }li#wp-megamenu-item-97445> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-97445 a { }#wp-megamenu-item-97445> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-101283.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-101283>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-101283>a { }li#wp-megamenu-item-101283> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-101283 a { }#wp-megamenu-item-101283> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-97443.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-97443>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-97443>a { }li#wp-megamenu-item-97443> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-97443 a { }#wp-megamenu-item-97443> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-97440.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-97440>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-97440>a { }li#wp-megamenu-item-97440> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-97440 a { }#wp-megamenu-item-97440> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-101284.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu-wrap .wpmm-nav-wrap > ul.wp-megamenu li.wpmm_dropdown_menu ul.wp-megamenu-sub-menu li.menu-item-has-children.wp-megamenu-item-101284.wpmm-submenu-right > ul.wp-megamenu-sub-menu {left: 100%;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-101284>a { text-align: left !important;}.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-101284>a { }li#wp-megamenu-item-101284> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-101284 a { }#wp-megamenu-item-101284> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-101279.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-101279>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-101279>a { }li#wp-megamenu-item-101279> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-101279 a { }#wp-megamenu-item-101279> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-101280.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-101280>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-101280>a { }li#wp-megamenu-item-101280> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-101280 a { }#wp-megamenu-item-101280> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-101281.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-101281>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-101281>a { }li#wp-megamenu-item-101281> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-101281 a { }#wp-megamenu-item-101281> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-97453.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-97453>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-97453>a { }li#wp-megamenu-item-97453> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-97453 a { }#wp-megamenu-item-97453> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-97447.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-97447>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-97447>a { }li#wp-megamenu-item-97447> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-97447 a { }#wp-megamenu-item-97447> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-97448.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-97448>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-97448>a { }li#wp-megamenu-item-97448> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-97448 a { }#wp-megamenu-item-97448> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-101282.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-101282>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-101282>a { }li#wp-megamenu-item-101282> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-101282 a { }#wp-megamenu-item-101282> .wp-megamenu-sub-menu { }</style><style type="text/css"></style><link rel="icon" href="/wp-content/uploads/2018/11/cropped-favicon-32x32.png" sizes="32x32" />
<link rel="icon" href="/wp-content/uploads/2018/11/cropped-favicon-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="/wp-content/uploads/2018/11/cropped-favicon-180x180.png" />
<meta name="msapplication-TileImage" content="/wp-content/uploads/2018/11/cropped-favicon-270x270.png" />
         <link rel="stylesheet" href="/enterprise/www/css/blog.css" type="text/css">
                <script type="text/javascript">
            var digitalData = {"page":{"pageInfo":{"pageName":"other-blogs:mcafee-labs:analyzing-cve-2021-1665-remote-code-execution-vulnerability-in-windows-gdi","pageNameGlobal":"analyzing-cve-2021-1665-remote-code-execution-vulnerability-in-windows-gdi","pageLanguage":"English","pageType":"","country":"us","geo":"NA","onsiteSearchTerm":"","onsiteSearchType":"","category":{"category":"other-blogs","subCategory1":"mcafee-labs"},"author":"Hardik Shah","pubDate":"Jun 28, 2021","metaData":{"keywords":""}}},"user":{"userInfo":{"ip":"10.44.130.38"}}}        </script>
                <script type='application/ld+json'>{
            "@context": "http://schema.org",
            "@type": "Article",
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/analyzing-cve-2021-1665-remote-code-execution-vulnerability-in-windows-gdi/"
            },
           "headline": "Analyzing CVE-2021-1665 – Remote Code Execution Vulnerability in Windows GDI+",
            "image": ["https://www.mcafee.com/wp-content/uploads/2021/06/AdobeStock_349881038_614x300-1.jpg"],	
            "datePublished": "2021-06-28",
            "dateModified": "Jun 28, 2021",
            "author": {
                "@type": "Person",           
                "name": ["Hardik Shah"]            
            },
            "publisher": {
                "@type": "Organization",
                "name": "McAfee",
                "logo": {
                    "@type": "ImageObject",
                    "url": "https://www.mcafee.com/enterprise/en-us/img/logos/mcafee-logo.png"
                }
            },
            "description": "IntroductionMicrosoft Windows Graphics Device Interface+, also known as GDI+, allows various applications to use different graphics functionality on video displays as well as printers. Windows applications don’t directly access graphics hardware such as device drivers, but they interact with GDI, which in turn then"        
            }
        </script>
        <style>
            #wp-megamenu-blog>.wpmm-nav-wrap ul.wp-megamenu>li>a{
                color:#ffffff !important;
            }
        </style> 
    
    <script>!function(){function o(n,i){if(n&&i)for(var r in i)i.hasOwnProperty(r)&&(void 0===n[r]?n[r]=i[r]:n[r].constructor===Object&&i[r].constructor===Object?o(n[r],i[r]):n[r]=i[r])}try{var n=decodeURIComponent("%7B%20%22BW%22%3A%20%7B%20%22test_https%22%3A%20true%20%7D%20%7D");if(n.length>0&&window.JSON&&"function"==typeof window.JSON.parse){var i=JSON.parse(n);void 0!==window.BOOMR_config?o(window.BOOMR_config,i):window.BOOMR_config=i}}catch(r){window.console&&"function"==typeof window.console.error&&console.error("mPulse: Could not parse configuration",r)}}();</script>
                          <script>!function(e){var n="https://s.go-mpulse.net/boomerang/";if("False"=="True")e.BOOMR_config=e.BOOMR_config||{},e.BOOMR_config.PageParams=e.BOOMR_config.PageParams||{},e.BOOMR_config.PageParams.pci=!0,n="https://s2.go-mpulse.net/boomerang/";if(window.BOOMR_API_key="LXNDQ-3SP7Y-P3JVN-Y4HAH-VQNKC",function(){function e(){if(!o){var e=document.createElement("script");e.id="boomr-scr-as",e.src=window.BOOMR.url,e.async=!0,i.parentNode.appendChild(e),o=!0}}function t(e){o=!0;var n,t,a,r,d=document,O=window;if(window.BOOMR.snippetMethod=e?"if":"i",t=function(e,n){var t=d.createElement("script");t.id=n||"boomr-if-as",t.src=window.BOOMR.url,BOOMR_lstart=(new Date).getTime(),e=e||d.body,e.appendChild(t)},!window.addEventListener&&window.attachEvent&&navigator.userAgent.match(/MSIE [67]\./))return window.BOOMR.snippetMethod="s",void t(i.parentNode,"boomr-async");a=document.createElement("IFRAME"),a.src="about:blank",a.title="",a.role="presentation",a.loading="eager",r=(a.frameElement||a).style,r.width=0,r.height=0,r.border=0,r.display="none",i.parentNode.appendChild(a);try{O=a.contentWindow,d=O.document.open()}catch(c){n=document.domain,a.src="javascript:var d=document.open();d.domain='"+n+"';void(0);",O=a.contentWindow,d=O.document.open()}if(n)d._boomrl=function(){this.domain=n,t()},d.write("<bo"+"dy onload='document._boomrl();'>");else if(O._boomrl=function(){t()},O.addEventListener)O.addEventListener("load",O._boomrl,!1);else if(O.attachEvent)O.attachEvent("onload",O._boomrl);d.close()}function a(e){window.BOOMR_onload=e&&e.timeStamp||(new Date).getTime()}if(!window.BOOMR||!window.BOOMR.version&&!window.BOOMR.snippetExecuted){window.BOOMR=window.BOOMR||{},window.BOOMR.snippetStart=(new Date).getTime(),window.BOOMR.snippetExecuted=!0,window.BOOMR.snippetVersion=12,window.BOOMR.url=n+"LXNDQ-3SP7Y-P3JVN-Y4HAH-VQNKC";var i=document.currentScript||document.getElementsByTagName("script")[0],o=!1,r=document.createElement("link");if(r.relList&&"function"==typeof r.relList.supports&&r.relList.supports("preload")&&"as"in r)window.BOOMR.snippetMethod="p",r.href=window.BOOMR.url,r.rel="preload",r.as="script",r.addEventListener("load",e),r.addEventListener("error",function(){t(!0)}),setTimeout(function(){if(!o)t(!0)},3e3),BOOMR_lstart=(new Date).getTime(),i.parentNode.appendChild(r);else t(!1);if(window.addEventListener)window.addEventListener("load",a,!1);else if(window.attachEvent)window.attachEvent("onload",a)}}(),"".length>0)if(e&&"performance"in e&&e.performance&&"function"==typeof e.performance.setResourceTimingBufferSize)e.performance.setResourceTimingBufferSize();!function(){if(BOOMR=e.BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},!BOOMR.plugins.AK){var n=""=="true"?1:0,t="",a="fb23dtixibxt6yg3o7dq-f-d25e35c6c-clientnsv4-s.akamaihd.net",i={"ak.v":"31","ak.cp":"108209","ak.ai":parseInt("250743",10),"ak.ol":"0","ak.cr":20,"ak.ipv":4,"ak.proto":"http/1.1","ak.rid":"2304e25","ak.r":33930,"ak.a2":n,"ak.m":"b","ak.n":"essl","ak.bpcip":"40.117.177.0","ak.cport":50196,"ak.gh":"23.47.145.215","ak.quicv":"","ak.tlsv":"tls1.3","ak.0rtt":"","ak.csrc":"-","ak.acc":"reno","ak.t":"1624995783","ak.ak":"hOBiQwZUYzCg5VSAfCLimQ==EO39ezVqZHfLX5acZwBX1hOcgEfARME9CkXiIY8NY4rhTPNYzbjyvG7bBFJU2cm5aBMvK9Hd6n47he5A7kGXniyHS9BVknebW2uu8tY0rRYRMtNuBq7503YRPxUCN/KqlVAPwNTz98MFwbUhDEMF2S0GvQxyOrIo/tyWlQWLlE2AosWj9wo7AIGHEHjZ2EYkXFwnJFl0FBXV4zmHUEPZ5RG4bElKllYRk8c2eApJAr6I9ffgOyxuKtrCL3asKNmiqNT0tnu+thRscxxmRb5i/aLF5DApiFX9nqHCbaJwy1x5VvHy93IWGQu2xvbRrnvHx8RLOYBzJB/PKr6pDFak4muvRGoEmED/Zu0GuGolqRLnZX1LDv2JdmoREKFYNcUW9lhzMFMDR1kv3yfdkIGzlqyhDLLJ6VxuudArWlMJnig=","ak.pv":"152","ak.dpoabenc":""};if(""!==t)i["ak.ruds"]=t;var o={i:!1,av:function(n){var t="http.initiator";if(n&&(!n[t]||"spa_hard"===n[t]))i["ak.feo"]=void 0!==e.aFeoApplied?1:0,BOOMR.addVar(i)},rv:function(){var e=["ak.bpcip","ak.cport","ak.cr","ak.csrc","ak.gh","ak.ipv","ak.m","ak.n","ak.ol","ak.proto","ak.quicv","ak.tlsv","ak.0rtt","ak.r","ak.acc","ak.t"];BOOMR.removeVar(e)}};BOOMR.plugins.AK={akVars:i,akDNSPreFetchDomain:a,init:function(){if(!o.i){var e=BOOMR.subscribe;e("before_beacon",o.av,null,null),e("onbeacon",o.rv,null,null),o.i=!0}return this},is_complete:function(){return!0}}}}()}(window);</script></head>

    <body  class="post-template-default single single-post postid-123988 single-format-standard wp-megamenu" id="short-header">
        <script src="/wp-content/themes/securingtomorrow/js/header_enterprise.js"></script>
        <div id="wrapper">
            <div class="textwidget custom-html-widget"><style>
	.headerbarContainer {
    background: rgba(0,0,0,0.9);
}
</style>
<header id="header">  
	<div class="headerbarContainer">
		<div class="headerbarContent">
			<div class="logo">
				 <img src="https://www.mcafee.com/enterprise/en-us/img/icons/logo-white.svg" alt="McAfee Logo"/>
			</div>
			<div class="quicklinks">
			 	<a class="symbols-label" href="https://www.mcafee.com/consumer/en-us/store/m0/index.html"><span>For Home</span></a>
			 	<a class="symbols-label" href="/enterprise/en-us/home.html"><span>For Enterprise</span></a>
			 	<a class="symbols-label" href="/enterprise/en-us/global-contact-us.html"><i class="symbol-contact"></i></a>
			</div>
		</div>
	</div>
</header>



<style>


@media screen and (min-width: 1025px) {
.hero{height: 756px !important;}
.hero.medium {
    min-height: 0;
    height: 640px  !important;
}
.hero.small {
    min-height: 0;
    height: 510px  !important;
}
.hero.title {
    height: 350px  !important;
}
	}
</style> 
<script>
$("document").ready(function(){
    $(".hero.title h1").each(function() {
        if ($(this).text().length > 50) {
            $(this).addClass("pt")
        }
    });
});
</script></div>  
		
<section class="hero title">
    <div class="bg-stretch">
        <img src="https://www.mcafee.com/wp-content/themes/securingtomorrow/img/light-shield-pattern.png" alt="">
    </div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-12 col-xs-12">
                <h1>Analyzing CVE-2021-1665 – Remote Code Execution Vulnerability in Windows GDI+</h1>
            </div>
        </div>
    </div>
</section>

<main id="main">

    <nav class="anchor-links">
        <div class="container medium">
            <div style="float:left">
<nav id="wp-megamenu-blog" class="wp-megamenu-wrap   ">
			<div class="wpmm-fullwidth-wrap"></div>
			<div class="wpmm-nav-wrap wpmm-main-wrap-blog">
				<a href="javascript:;" class="wpmm_mobile_menu_btn show-close-icon"><i class="fa fa-bars"></i> Menu</a> 
					<ul id="menu-mcafee-blog-navigation-new-05020" class="wp-megamenu" ><li id="wp-megamenu-item-101279" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101279  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#">Consumer <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-8946132506350948839" class="wpmm-row wp-megamenu-item-8946132506350948839 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-9218421875922206743" class="wpmm-col wpmm-col-12 wp-megamenu-item-9218421875922206743 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101279 wpmm-submenu-right"><div class="menu-consumer-category-container"><ul id="menu-consumer-category" class="menu"><li id="menu-item-97425" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97425"><a href="/blogs/consumer/family-safety/">Family Safety</a></li>
<li id="menu-item-97424" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97424"><a href="/blogs/consumer/consumer-threat-reports/">Consumer Threat Reports</a></li>
<li id="menu-item-121138" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-121138"><a href="/blogs/consumer/cyberthreat-news/">Cyberthreat News</a></li>
<li id="menu-item-121135" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-121135"><a href="/blogs/consumer/consumer-cyber-awareness/">Consumer Cyber Awareness</a></li>
<li id="menu-item-97427" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97427"><a href="/blogs/consumer/mobile-and-iot-security/">Mobile and IoT Security</a></li>
<li id="menu-item-121132" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-121132"><a href="/blogs/consumer/mcafee-consumer-news/">McAfee Consumer News</a></li>
<li id="menu-item-97453" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97453"><a href="/blogs/consumer/hackable/">Hackable? Podcast</a></li>
<li id="menu-item-101334" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-101334"><a href="/blogs/consumer/">All Consumer Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-101280" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101280  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#">Enterprise <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-2428369843960536652" class="wpmm-row wp-megamenu-item-2428369843960536652 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-7346585714938984257" class="wpmm-col wpmm-col-12 wp-megamenu-item-7346585714938984257 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101280 wpmm-submenu-right"><div class="menu-enterprise-category-container"><ul id="menu-enterprise-category" class="menu"><li id="menu-item-97421" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97421"><a href="/blogs/enterprise/cloud-security/">Cloud Security</a></li>
<li id="menu-item-97451" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97451"><a href="/blogs/enterprise/endpoint-security/">Endpoint Security</a></li>
<li id="menu-item-97422" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97422"><a href="/blogs/enterprise/security-operations/">Security Operations</a></li>
<li id="menu-item-97452" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97452"><a href="/blogs/enterprise/data-security/">Data Security</a></li>
<li id="menu-item-101336" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-101336"><a href="/blogs/enterprise/">All Enterprise Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-101281" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101281  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#">Corporate <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-8074542240906902463" class="wpmm-row wp-megamenu-item-8074542240906902463 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-1.1347662926941E+19" class="wpmm-col wpmm-col-12 wp-megamenu-item-1.1347662926941E+19 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101281 wpmm-submenu-right"><div class="menu-other-blogs-container"><ul id="menu-other-blogs" class="menu"><li id="menu-item-97442" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97442"><a href="/blogs/other-blogs/executive-perspectives/">Executive Perspectives</a></li>
<li id="menu-item-97441" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-97441"><a href="/blogs/other-blogs/mcafee-labs/">McAfee Labs</a></li>
<li id="menu-item-97443" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97443"><a href="/blogs/other-blogs/life-at-mcafee/">Life at McAfee</a></li>
<li id="menu-item-97440" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97440"><a href="/blogs/other-blogs/podcast/">Podcast</a></li>
<li id="menu-item-97444" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97444"><a href="/blogs/other-blogs/mcafee-partners/">McAfee Partners</a></li>
<li id="menu-item-101340" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-101340"><a href="/blogs/other-blogs/">All Corporate Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-101282" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101282  wpmm_dropdown_menu  wpmm-fadeindown wpmm-submenu-right"><a href="/blogs/authors/">Authors</a></li>
<li id="wp-megamenu-item-101283" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101283  wpmm_dropdown_menu  wpmm-fadeindown wpmm-submenu-right"><a href="/blogs/subscribe/">Subscribe</a></li>
<li id="wp-megamenu-item-101284" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101284  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#"><span class='wpmm-selected-icon wpmm-selected-icon-left'><i class='fa fa-globe'></i></span> <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-1434291509384959856" class="wpmm-row wp-megamenu-item-1434291509384959856 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-5787132522006665301" class="wpmm-col wpmm-col-12 wp-megamenu-item-5787132522006665301 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101284 wpmm-submenu-right"><div class="menu-languages-category-container"><ul id="menu-languages-category" class="menu"><li id="menu-item-121129" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-121129"><a href="/blogs/languages/chinese/">Chinese</a></li>
<li id="menu-item-97433" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97433"><a href="/blogs/languages/italia/">Italia</a></li>
<li id="menu-item-97434" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97434"><a href="/blogs/languages/japanese/">日本語</a></li>
<li id="menu-item-97435" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97435"><a href="/blogs/languages/espanol/">Español</a></li>
<li id="menu-item-97436" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97436"><a href="/blogs/languages/francais/">Français</a></li>
<li id="menu-item-97437" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97437"><a href="/blogs/languages/german/">German</a></li>
<li id="menu-item-97438" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97438"><a href="/blogs/languages/portugues/">Português</a></li>
<li id="menu-item-101338" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-101338"><a href="/blogs/languages/">All Language Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-" class="wpmm-social-link wpmm-social-link- wpmm-social-index-0 wp-megamenu-item-  wpmm_dropdown_menu  wpmm-fadeindown wpmm-submenu-right"><a target="_blank" ><i class=""></i></a></li>
</ul>
			</div>


			
		    
		</nav>            </div>
            <div class="anchors right">
                <form role="search" method="get" class="blog-search search-form" action="https://www.mcafee.com/blogs/">
                    <button type="submit" class="search-submit"><i class="symbol-arrow-forward"></i></button>
                    <input type="search" class="search-field" placeholder="Search Blogs" value="" name="s" />


                </form>  
            </div>

        </div>
    </nav>

    <div class="wrap-section padding-top-xs"> 
        <div class="container medium">
 
        <div class="breadcrumb-container theme1">
                    <ul>
                    
        <li ><a title="Mcafee" href="#"><span>Mcafee</span></a><span class="separator">/</span></li>
                
        <li ><a title="Home" href="https://www.mcafee.com/blogs"><span>Home</span></a><span class="separator">/</span></li>
                
        <li ><a title="Other Blogs" href="/blogs/other-blogs/"><span>Other Blogs</span></a><span class="separator">/</span></li>
                
        <li ><a title="McAfee Labs" href="/blogs/other-blogs/mcafee-labs/"><span>McAfee Labs</span></a><span class="separator">/</span></li>
                
        <li ><a title="Analyzing CVE-2021-1665 – Remote Code Execution Vulnerability in Windows GDI+" href="#"><span>Analyzing CVE-2021-1665 – Remote Code Execution Vulnerability in Windows GDI+</span></a><span class="separator">/</span></li>
                </ul>
            <script type="application/ld+json">
        {
            "@context": "http://schema.org",
            "@type": "BreadcrumbList",
            "itemListElement":
            [
                                        {
                            "@type": "ListItem",
                            "position":1,
                            "item":
                            {
                                "@id": "#",
                                "name": "Mcafee"
                            }
                        },                                                {
                            "@type": "ListItem",
                            "position":2,
                            "item":
                            {
                                "@id": "https://www.mcafee.com/blogs",
                                "name": "Home"
                            }
                        },                                                {
                            "@type": "ListItem",
                            "position":3,
                            "item":
                            {
                                "@id": "/blogs/other-blogs/",
                                "name": "Other Blogs"
                            }
                        },                                                {
                            "@type": "ListItem",
                            "position":4,
                            "item":
                            {
                                "@id": "/blogs/other-blogs/mcafee-labs/",
                                "name": "McAfee Labs"
                            }
                        },                                                {
                            "@type": "ListItem",
                            "position":5,
                            "item":
                            {
                                "@id": "#",
                                "name": "Analyzing CVE-2021-1665 – Remote Code Execution Vulnerability in Windows GDI+"
                            }
                        }                                    ]
        }
    </script>
        <style type="text/css">
        .breadcrumb-container {
            font-size: 13px;
        }
        .breadcrumb-container ul {
            margin: 0;
            padding: 0;
        }
        .breadcrumb-container li {
            box-sizing: unset;
            display: inline-block;
            margin: 0;
            padding: 0;
        }
        .breadcrumb-container li a {
            box-sizing: unset;
            padding: 0 10px;
        }
        .breadcrumb-container {
            font-size: 12px  !important;
            padding: 0px;
            margin: 0px;
        }
        .breadcrumb-container li a{
            color:  #c01818  !important;
            font-size:  12px  !important;
            line-height:  12px  !important;
        }
        .breadcrumb-container li .separator {
            color: #53565a  !important;
            font-size:  12px  !important;
        }
                    .breadcrumb-container li:last-child .separator {
                display: none;
            }
                </style>
        <style type="text/css">
        .breadcrumb-container.theme1 li {
            margin: 0;
            padding: 0;
        }
        .breadcrumb-container.theme1 a {
            background: ;
            display: inline-block;
            margin: 0 5px;
            padding: 5px 10px;
            text-decoration: none;
        }
    </style>
        <style type="text/css">
        .breadcrumb-container{}
.breadcrumb-container ul{}
.breadcrumb-container li{}
.breadcrumb-container a{}
.breadcrumb-container .separator{}
    </style>
    <script>
            </script>
            </div>
                </div>		 
    </div>

    <div class="wrap-section padding-small article">  
        <div class="container medium"> 
            <div class="border-line"></div>

            <div class="author-block padding-bottom-xs">
                <img class="author" src="https://www.mcafee.com/wp-content/themes/securingtomorrow/img/author-avatar-default.jpg" />
                <div class="meta">By <a href="/blogs/author/hardik-shah/" title="Posts by Hardik Shah" class="author url fn" rel="author">Hardik Shah</a> on Jun 28, 2021</div>
            </div>

                    <h2><strong>Introduction</strong></h2>
<p>Microsoft Windows Graphics Device Interface+, also known as GDI+, allows various applications to use different graphics functionality on video displays as well as printers. Windows applications don’t directly access graphics hardware such as device drivers, but they interact with GDI, which in turn then interacts with device drivers. In this way, there is an abstraction layer to Windows applications and a common set of APIs for everyone to use.</p>
<p>Because of its complex format, GDI+ has a known history of various vulnerabilities. We at McAfee continuously fuzz various open source and closed source software including windows GDI+. Over the last few years, we have reported various issues to Microsoft in various Windows components including GDI+ and have received CVEs for them.</p>
<p>In this post, we detail our root cause analysis of one such vulnerability which we found using WinAFL: CVE-2021-1665 &#8211; GDI+ Remote Code Execution Vulnerability.  This issue was fixed in January 2021 as part of a Microsoft Patch.</p>
<h2><strong>What is WinAFL?</strong></h2>
<p>WinAFL is a Windows port of a popular Linux AFL fuzzer and is maintained by Ivan Fratric of Google Project Zero. WinAFL uses dynamic binary instrumentation using DynamoRIO and it requires a program called as a harness. A harness is nothing but a simple program which calls the APIs we want to fuzz.</p>
<p>A simple harness for this was already provided with WinAFL, we can enable “<strong>Image-&gt;GetThumbnailImage</strong>” code which was commented by default in the code. Following is the harness code to fuzz GDI+ image and GetThumbnailImage API:</p>
<p>&nbsp;</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-123991" src="/wp-content/uploads/2021/06/1-4.png" alt="" width="870" height="702" srcset="/wp-content/uploads/2021/06/1-4.png 870w, /wp-content/uploads/2021/06/1-4-300x242.png 300w, /wp-content/uploads/2021/06/1-4-768x620.png 768w, /wp-content/uploads/2021/06/1-4-160x129.png 160w" sizes="(max-width: 870px) 100vw, 870px" /></p>
<p>As you can see, this small piece of code simply creates a new image object from the provided input file and then calls another function to generate a thumbnail image. This makes for an excellent attack vector and can affect various Windows applications if they use thumbnail images. In addition, this requires little user interaction, thus software which uses GDI+ and calls GetThumbnailImage API, is vulnerable.</p>
<h2><strong>Collecting Corpus:</strong></h2>
<p>A good corpus provides a sound foundation for fuzzing. For that we can use Google or GitHub in addition to further test corpus available from various software and public EMF files which were released for other vulnerabilities. We have generated a few test files by making changes to a sample code provided on Microsoft’s site which generates an EMF file with <strong>EMFPlusDrawString</strong> and other records:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-123994" src="/wp-content/uploads/2021/06/2-2.png" alt="" width="904" height="664" srcset="/wp-content/uploads/2021/06/2-2.png 904w, /wp-content/uploads/2021/06/2-2-300x220.png 300w, /wp-content/uploads/2021/06/2-2-768x564.png 768w, /wp-content/uploads/2021/06/2-2-176x129.png 176w" sizes="(max-width: 904px) 100vw, 904px" /></p>
<p>Ref: <a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-emfplus/07bda2af-7a5d-4c0b-b996-30326a41fa57">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-emfplus/07bda2af-7a5d-4c0b-b996-30326a41fa57</a></p>
<h2><strong>Minimizing Corpus:</strong></h2>
<p>After we have collected an initial corpus file, we need to minimize it. For this we can use a utility called winafl-cmin.py as follows:</p>
<table style="border-collapse: collapse; width: 100%;">
<tbody>
<tr>
<td style="width: 100%;">winafl-cmin.py -D D:\\work\\winafl\\DynamoRIO\\bin32 -t 10000 -i inCorpus -o minCorpus -covtype edge -coverage_module gdiplus.dll -target_module gdiplus_hardik.exe -target_method fuzzMe -nargs 2 &#8212; gdiplus_hardik.exe @@</td>
</tr>
</tbody>
</table>
<h2><strong>How does WinAFL work?</strong></h2>
<p>WinAFL uses the concept of in-memory fuzzing. We need to provide a function name to WinAFL. It will save the program state at the start of the function and take one input file from the corpus, mutate it, and feed it to the function.</p>
<p>It will monitor this for any new code paths or crashes. If it finds a new code path, it will consider the new file as an interesting test case and will add it to the queue for further mutation. If it finds any crashes, it will save the crashing file in crashes folder.</p>
<p>The following picture shows the fuzzing flow:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-123997" src="/wp-content/uploads/2021/06/3-2.png" alt="" width="604" height="376" srcset="/wp-content/uploads/2021/06/3-2.png 604w, /wp-content/uploads/2021/06/3-2-300x187.png 300w, /wp-content/uploads/2021/06/3-2-205x129.png 205w" sizes="(max-width: 604px) 100vw, 604px" /></p>
<h2><strong>Fuzzing with WinAFL:</strong></h2>
<p>Once we have compiled our harness program, collected, and minimized the corpus, we can run this command to fuzz our program with WinAFL:</p>
<table style="border-collapse: collapse; width: 100%;">
<tbody>
<tr>
<td style="width: 100%;">afl-fuzz.exe -i minCorpus -o out -D D:\work\winafl\DynamoRIO\bin32 -t 20000 &#8212;coverage_module gdiplus.dll -fuzz_iterations 5000 -target_module gdiplus_hardik.exe -target_offset 0x16e0 -nargs 2 &#8212; gdiplus_hardik.exe @@</td>
</tr>
</tbody>
</table>
<h2><strong>Results:</strong></h2>
<p>We found a few crashes and after triaging unique crashes, and we found a crash in “<strong>gdiplus!BuiltLine::GetBaselineOffset</strong>” which looks as follows in the call stack below:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124000" src="/wp-content/uploads/2021/06/4-2.png" alt="" width="904" height="558" srcset="/wp-content/uploads/2021/06/4-2.png 904w, /wp-content/uploads/2021/06/4-2-300x185.png 300w, /wp-content/uploads/2021/06/4-2-768x474.png 768w, /wp-content/uploads/2021/06/4-2-205x127.png 205w" sizes="(max-width: 904px) 100vw, 904px" /></p>
<p>As can be seen in the above image, the program is crashing while trying to read data from a memory address pointed by edx+8. We can see it registers ebx, ecx and edx contains c0c0c0c0 which means that page heap is enabled for the binary. We can also see that c0c0c0c0 is being passed as a parameter to “<strong>gdiplus!FullTextImager::RenderLine</strong>” function.</p>
<h2><strong>Patch Diffing to See If We Can Find the Root Cause</strong></h2>
<p>To figure out a root cause, we can use patch diffing—namely, we can use IDA <strong>BinDiff</strong> plugin to identify what changes have been made to patched file. If we are lucky, we can easily find the root cause by just looking at the code that was changed. So, we can generate an IDB file of patched and unpatched versions of gdiplus.dll and then run IDA <strong>BinDiff</strong> plugin to see the changes.</p>
<p>We can see that one new function was added in the patched file, and this seems to be a destructor for <strong>BuiltLine</strong> Object :</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124003" src="/wp-content/uploads/2021/06/5-2.png" alt="" width="680" height="85" srcset="/wp-content/uploads/2021/06/5-2.png 680w, /wp-content/uploads/2021/06/5-2-300x38.png 300w, /wp-content/uploads/2021/06/5-2-205x26.png 205w" sizes="(max-width: 680px) 100vw, 680px" /></p>
<p>We can also see that there are a few functions where the similarity score is &lt; 1 and one such function is <strong>FullTextImager::BuildAllLines</strong> as shown below:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124006" src="/wp-content/uploads/2021/06/6-2.png" alt="" width="845" height="140" srcset="/wp-content/uploads/2021/06/6-2.png 845w, /wp-content/uploads/2021/06/6-2-300x50.png 300w, /wp-content/uploads/2021/06/6-2-768x127.png 768w, /wp-content/uploads/2021/06/6-2-205x34.png 205w" sizes="(max-width: 845px) 100vw, 845px" /></p>
<p>Now, just to confirm if this function is really the one which was patched, we can run our test program and POC in windbg and set a break point on this function. We can see that the breakpoint is hit and the program doesn’t crash anymore:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124009" src="/wp-content/uploads/2021/06/7-2.png" alt="" width="904" height="182" srcset="/wp-content/uploads/2021/06/7-2.png 904w, /wp-content/uploads/2021/06/7-2-300x60.png 300w, /wp-content/uploads/2021/06/7-2-768x155.png 768w, /wp-content/uploads/2021/06/7-2-205x41.png 205w" sizes="(max-width: 904px) 100vw, 904px" /></p>
<p>Now, as a next step, we need to identify what has been changed in this function to fix this vulnerability. For that we can check flow graph of this function and we see something as follows. Unfortunately, there are too many changes to identify the vulnerability by simply looking at the diff:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124012" src="/wp-content/uploads/2021/06/8-1.png" alt="" width="755" height="545" srcset="/wp-content/uploads/2021/06/8-1.png 755w, /wp-content/uploads/2021/06/8-1-300x217.png 300w, /wp-content/uploads/2021/06/8-1-179x129.png 179w" sizes="(max-width: 755px) 100vw, 755px" /></p>
<p>The left side illustrates an unpatched dll while right side shows a patched dll:</p>
<ul>
<li>Green indicates that the patched and unpatched blocks are same.</li>
<li>Yellow blocks indicate there has been some changes between unpatched and patched dlls.</li>
<li>Red blocks call out differences in the dlls.</li>
</ul>
<p>If we zoom in on the yellow blocks we can see following:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124015" src="/wp-content/uploads/2021/06/9-1.png" alt="" width="863" height="540" srcset="/wp-content/uploads/2021/06/9-1.png 863w, /wp-content/uploads/2021/06/9-1-300x188.png 300w, /wp-content/uploads/2021/06/9-1-768x481.png 768w, /wp-content/uploads/2021/06/9-1-205x129.png 205w" sizes="(max-width: 863px) 100vw, 863px" /></p>
<p>We can note several changes. Few blocks are removed in the patched DLL, so patch diffing will alone will not be sufficient to identify the root cause of this issue. However, this presents valuable hints about where to look and what to look for when using other methods for debugging such as windbg. A few observations we can spot from the bindiff output above:</p>
<ul>
<li>In the unpatched DLL, if we check carefully we can see that there is a call to “<strong>GetuntrimmedCharacterCount</strong>” function and later on there is another call to a function “<strong>SetSpan::SpanVector</strong>”</li>
<li>In the patched DLL, we can see that there is a call to “<strong>GetuntrimmedCharacterCount</strong>” where a return value stored inside <strong>EAX</strong> register is checked. If it’s zero, then control jumps to another location—a <strong>destructor</strong> for <strong>BuiltLine </strong>Object, this was newly added code in the patched DLL:</li>
</ul>
<p><img loading="lazy" class="aligncenter size-full wp-image-124018" src="/wp-content/uploads/2021/06/10-1.png" alt="" width="755" height="103" srcset="/wp-content/uploads/2021/06/10-1.png 755w, /wp-content/uploads/2021/06/10-1-300x41.png 300w, /wp-content/uploads/2021/06/10-1-205x28.png 205w" sizes="(max-width: 755px) 100vw, 755px" /></p>
<p>So we can assume that this is where the vulnerability is fixed. Now we need to figure out following:</p>
<ol>
<li>Why our program is crashing with the provided POC file?</li>
<li>What field in the file is causing this crash?</li>
<li>What value of the field?</li>
<li>Which condition in program which is causing this crash?</li>
<li>How this was fixed?</li>
</ol>
<h2><strong>EMF File Format:</strong></h2>
<p>EMF is also known as enhanced meta file format which is used to store graphical images device independently. An EMF file is consisting of various records which is of variable length. It can contain definition of various graphic object, commands for drawing and other graphics properties.</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124021" src="/wp-content/uploads/2021/06/11.png" alt="" width="904" height="766" srcset="/wp-content/uploads/2021/06/11.png 904w, /wp-content/uploads/2021/06/11-300x254.png 300w, /wp-content/uploads/2021/06/11-768x651.png 768w, /wp-content/uploads/2021/06/11-152x129.png 152w" sizes="(max-width: 904px) 100vw, 904px" /></p>
<p>Credit: MS EMF documentation.</p>
<p>Generally, an EMF file consist of the following records:</p>
<ol>
<li><strong>EMF Header</strong> – This contains information about EMF structure.</li>
<li><strong>EMF Records</strong> – This can be various variable length records, containing information about graphics properties, drawing order, and so forth.</li>
<li><strong>EMF EOF Record</strong> – This is the last record in EMF file.</li>
</ol>
<p>Detailed specifications of EMF file format can be seen at Microsoft site at following URL:</p>
<p><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-emf/91c257d7-c39d-4a36-9b1f-63e3f73d30ca">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-emf/91c257d7-c39d-4a36-9b1f-63e3f73d30ca</a></p>
<h2><strong>Locating the Vulnerable Record in the EMF File:</strong></h2>
<p>Generally, most of the issues in EMF are because of malformed or corrupt records. We need to figure out which record type is causing this crash. For this if we look at the call stack we can see following:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124024" src="/wp-content/uploads/2021/06/12.png" alt="" width="904" height="240" srcset="/wp-content/uploads/2021/06/12.png 904w, /wp-content/uploads/2021/06/12-300x80.png 300w, /wp-content/uploads/2021/06/12-768x204.png 768w, /wp-content/uploads/2021/06/12-205x54.png 205w" sizes="(max-width: 904px) 100vw, 904px" /></p>
<p>We can notice a call to function “<strong>gdiplus!GdipPlayMetafileRecordCallback</strong>”</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124027" src="/wp-content/uploads/2021/06/13.png" alt="" width="904" height="210" srcset="/wp-content/uploads/2021/06/13.png 904w, /wp-content/uploads/2021/06/13-300x70.png 300w, /wp-content/uploads/2021/06/13-768x178.png 768w, /wp-content/uploads/2021/06/13-205x48.png 205w" sizes="(max-width: 904px) 100vw, 904px" /></p>
<p>By setting a breakpoint on this function and checking parameter, we can see following:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124030" src="/wp-content/uploads/2021/06/14.png" alt="" width="904" height="262" srcset="/wp-content/uploads/2021/06/14.png 904w, /wp-content/uploads/2021/06/14-300x87.png 300w, /wp-content/uploads/2021/06/14-768x223.png 768w, /wp-content/uploads/2021/06/14-205x59.png 205w" sizes="(max-width: 904px) 100vw, 904px" /></p>
<p>We can see that <strong>EDX</strong> contains some memory address and we can see that parameter given to this function are: 00x00401c,0x00000000 and 0x00000044.</p>
<p>Also, on checking the location pointed by <strong>EDX</strong> we can see following:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124033" src="/wp-content/uploads/2021/06/15.png" alt="" width="702" height="184" srcset="/wp-content/uploads/2021/06/15.png 702w, /wp-content/uploads/2021/06/15-300x79.png 300w, /wp-content/uploads/2021/06/15-205x54.png 205w" sizes="(max-width: 702px) 100vw, 702px" /></p>
<p>If we check our POC EMF file, we can see that this data belongs to file from offset: 0x15c:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124036" src="/wp-content/uploads/2021/06/16.png" alt="" width="904" height="180" srcset="/wp-content/uploads/2021/06/16.png 904w, /wp-content/uploads/2021/06/16-300x60.png 300w, /wp-content/uploads/2021/06/16-768x153.png 768w, /wp-content/uploads/2021/06/16-205x41.png 205w" sizes="(max-width: 904px) 100vw, 904px" /></p>
<p>By going through EMF specification and manually parsing the records, we can easily figure out that this is a “<strong>EmfPlusDrawString”</strong> record, the format of which is shown below:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124039" src="/wp-content/uploads/2021/06/17.png" alt="" width="904" height="860" srcset="/wp-content/uploads/2021/06/17.png 904w, /wp-content/uploads/2021/06/17-300x285.png 300w, /wp-content/uploads/2021/06/17-768x731.png 768w, /wp-content/uploads/2021/06/17-136x129.png 136w, /wp-content/uploads/2021/06/17-24x24.png 24w" sizes="(max-width: 904px) 100vw, 904px" /></p>
<p>In our case:</p>
<p>Record Type = 0x401c EmfPlusDrawString record</p>
<p>Flags = 0x0000</p>
<p>Size = 0x50</p>
<p>Data size = 0x44</p>
<p>Brushid = 0x02</p>
<p>Format id = 0x01</p>
<p><strong>Length = 0x14</strong></p>
<p>Layoutrect = 00 00 00 00 00 00 00 00 FC FF C7 42 00 00 80 FF</p>
<p>String data =</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124042" src="/wp-content/uploads/2021/06/18.png" alt="" width="904" height="154" srcset="/wp-content/uploads/2021/06/18.png 904w, /wp-content/uploads/2021/06/18-300x51.png 300w, /wp-content/uploads/2021/06/18-768x131.png 768w, /wp-content/uploads/2021/06/18-205x35.png 205w" sizes="(max-width: 904px) 100vw, 904px" /></p>
<p>Now that we have located the record that seems to be causing the crash, the next thing is to figure out why our program is crashing. If we debug and check the code, we can see that control reaches to a function “<strong>gdiplus!FullTextImager::BuildAllLines</strong>”. When we decompile this code, we can see something  like this:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124045" src="/wp-content/uploads/2021/06/19.png" alt="" width="904" height="368" srcset="/wp-content/uploads/2021/06/19.png 904w, /wp-content/uploads/2021/06/19-300x122.png 300w, /wp-content/uploads/2021/06/19-768x313.png 768w, /wp-content/uploads/2021/06/19-205x83.png 205w" sizes="(max-width: 904px) 100vw, 904px" /></p>
<p>The following diagram shows the function call hierarchy:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124048" src="/wp-content/uploads/2021/06/20.png" alt="" width="755" height="685" srcset="/wp-content/uploads/2021/06/20.png 755w, /wp-content/uploads/2021/06/20-300x272.png 300w, /wp-content/uploads/2021/06/20-142x129.png 142w" sizes="(max-width: 755px) 100vw, 755px" /></p>
<h2><strong>The execution low in summary:</strong></h2>
<ol>
<li>Inside “<strong>Builtline::BuildAllLines”</strong> function, there is a while loop inside which the program allocates 0x60 bytes of memory. Then it calls the “<strong>Builtline::BuiltLine”</strong></li>
<li>The<strong> “Builtline::BuiltLine”</strong> function moves data to the newly allocated memory and then it calls “<strong>BuiltLine::GetUntrimmedCharacterCount</strong>”.</li>
<li>The return value of “<strong>BuiltLine::GetUntrimmedCharacterCount</strong>” is added to loop counter, which is <strong>ECX</strong>. This process will be repeated until the loop counter (<strong>ECX</strong>) is &lt; string length(<strong>EAX</strong>), which is 0x14 here.</li>
<li>The loop starts from 0, so it should terminate at <strong>0x13</strong> or it should terminate when the return value of “<strong>GetUntrimmedCharacterCount” </strong>is 0.</li>
<li>But in the vulnerable <strong>DLL</strong>, the program doesn’t terminate because of the way loop counter is increased. Here, “<strong>BuiltLine::GetUntrimmedCharacterCount” </strong>returns 0, which is added to Loop counter(<strong>ECX</strong>) and doesn’t increase ECX value. It allocates 0x60 bytes of memory and creates another line, corrupting the data that later leads the program to crash. The loop is executed for <strong>21</strong> times instead of <strong>20.</strong></li>
</ol>
<h2><strong>In detail:</strong></h2>
<p>1. Inside “<strong>Builtline::BuildAllLines”</strong> memory will be allocated for 0x60 or 96 bytes, and in the debugger it looks as follows:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124054" src="/wp-content/uploads/2021/06/21-1.png" alt="" width="904" height="604" srcset="/wp-content/uploads/2021/06/21-1.png 904w, /wp-content/uploads/2021/06/21-1-300x200.png 300w, /wp-content/uploads/2021/06/21-1-768x513.png 768w, /wp-content/uploads/2021/06/21-1-193x129.png 193w" sizes="(max-width: 904px) 100vw, 904px" /></p>
<p>2. Then it calls “<strong>BuiltLine::BuiltLine</strong>” function and moves the data to newly allocated memory:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124057" src="/wp-content/uploads/2021/06/22.png" alt="" width="904" height="638" srcset="/wp-content/uploads/2021/06/22.png 904w, /wp-content/uploads/2021/06/22-300x212.png 300w, /wp-content/uploads/2021/06/22-768x542.png 768w, /wp-content/uploads/2021/06/22-183x129.png 183w" sizes="(max-width: 904px) 100vw, 904px" /></p>
<p>3. This happens in side a while loop and there is a function call to “<strong>BuiltLine::GetUntrimmedCharacterCount</strong>”.</p>
<p>4. Return value of “<strong>BuiltLine::GetUntrimmedCharacterCount</strong>” is stored in a location 0x12ff2ec. This value will be 1 as can be seen below:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124060" src="/wp-content/uploads/2021/06/23.png" alt="" width="904" height="200" srcset="/wp-content/uploads/2021/06/23.png 904w, /wp-content/uploads/2021/06/23-300x66.png 300w, /wp-content/uploads/2021/06/23-768x170.png 768w, /wp-content/uploads/2021/06/23-205x45.png 205w" sizes="(max-width: 904px) 100vw, 904px" /></p>
<p>5. This value gets added to ECX:</p>
<p><img loading="lazy" class="aligncenter wp-image-124063 size-full" src="/wp-content/uploads/2021/06/24.png" alt="" width="904" height="208" srcset="/wp-content/uploads/2021/06/24.png 904w, /wp-content/uploads/2021/06/24-300x69.png 300w, /wp-content/uploads/2021/06/24-768x177.png 768w, /wp-content/uploads/2021/06/24-205x47.png 205w" sizes="(max-width: 904px) 100vw, 904px" /></p>
<p>6. Then there is a check that determines if <strong>ecx&lt; eax</strong>. If true, it will continue loop, else it will jump to another location:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124066" src="/wp-content/uploads/2021/06/25.png" alt="" width="904" height="94" srcset="/wp-content/uploads/2021/06/25.png 904w, /wp-content/uploads/2021/06/25-300x31.png 300w, /wp-content/uploads/2021/06/25-768x80.png 768w, /wp-content/uploads/2021/06/25-205x21.png 205w" sizes="(max-width: 904px) 100vw, 904px" /></p>
<p>7. Now in the vulnerable version, loop doesn’t exist if the return value of “<strong>BuiltLine::GetUntrimmedCharacterCount</strong>” is 0, which means that this 0 will be added to <strong>ECX </strong>and which means ECX will not increase. So the loop will execute 1 more time with the “<strong>ECX</strong>” value of 0x13. Thus, this will lead to loop getting executed 21 times rather than 20 times. This is the root cause of the problem here.</p>
<p>Also after some debugging, we can figure out why <strong>EAX</strong> contains 14. It is read from the POC file at offset: 0x174:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124069" src="/wp-content/uploads/2021/06/26.png" alt="" width="958" height="370" srcset="/wp-content/uploads/2021/06/26.png 958w, /wp-content/uploads/2021/06/26-300x116.png 300w, /wp-content/uploads/2021/06/26-768x297.png 768w, /wp-content/uploads/2021/06/26-205x79.png 205w" sizes="(max-width: 958px) 100vw, 958px" /></p>
<p>If we recall, this is the <strong>EmfPlusDrawString</strong> record and <strong>0x14</strong> is the length we mentioned before.</p>
<p>Later on, the program reaches to “<strong>FullTextImager::Render</strong>” function corrupting the value of EAX because it reads the unused memory:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124072" src="/wp-content/uploads/2021/06/27.png" alt="" width="904" height="600" srcset="/wp-content/uploads/2021/06/27.png 904w, /wp-content/uploads/2021/06/27-300x199.png 300w, /wp-content/uploads/2021/06/27-768x510.png 768w, /wp-content/uploads/2021/06/27-194x129.png 194w" sizes="(max-width: 904px) 100vw, 904px" /></p>
<p>This will be passed as an argument to “<strong>FullTextImager::RenderLine</strong>” function:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124075" src="/wp-content/uploads/2021/06/28.png" alt="" width="804" height="130" srcset="/wp-content/uploads/2021/06/28.png 804w, /wp-content/uploads/2021/06/28-300x49.png 300w, /wp-content/uploads/2021/06/28-768x124.png 768w, /wp-content/uploads/2021/06/28-205x33.png 205w" sizes="(max-width: 804px) 100vw, 804px" /></p>
<p>Later, program will crash while trying to access this location.</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124078" src="/wp-content/uploads/2021/06/29.png" alt="" width="904" height="234" srcset="/wp-content/uploads/2021/06/29.png 904w, /wp-content/uploads/2021/06/29-300x78.png 300w, /wp-content/uploads/2021/06/29-768x199.png 768w, /wp-content/uploads/2021/06/29-205x53.png 205w" sizes="(max-width: 904px) 100vw, 904px" /></p>
<p>Our program was crashing while processing <strong>EmfPlusDrawString</strong> record inside the EMF file while accessing an invalid memory location and processing string data field. Basically, the program was not verifying the return value of “<strong>gdiplus!BuiltLine::GetUntrimmedCharacterCount</strong>” function and this resulted in taking a different program path that  corrupted the register and various memory values, ultimately causing the crash.</p>
<h2><strong>How this issue was fixed?</strong></h2>
<p>As we have figured out by looking at patch diff above, a check was added which determined the return value of “<strong>gdiplus!BuiltLine::GetUntrimmedCharacterCount</strong>” function.</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124081" src="/wp-content/uploads/2021/06/30.png" alt="" width="755" height="470" srcset="/wp-content/uploads/2021/06/30.png 755w, /wp-content/uploads/2021/06/30-300x187.png 300w, /wp-content/uploads/2021/06/30-205x129.png 205w" sizes="(max-width: 755px) 100vw, 755px" /></p>
<p>If the retuned value is 0, then program xor’s <strong>EBX</strong> which contains counter and jump to a location which calls destructor for Builtline Object:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124084" src="/wp-content/uploads/2021/06/31.png" alt="" width="700" height="170" srcset="/wp-content/uploads/2021/06/31.png 700w, /wp-content/uploads/2021/06/31-300x73.png 300w, /wp-content/uploads/2021/06/31-205x50.png 205w" sizes="(max-width: 700px) 100vw, 700px" /></p>
<p>Here is the destructor that prevents the issue:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124087" src="/wp-content/uploads/2021/06/32.png" alt="" width="755" height="215" srcset="/wp-content/uploads/2021/06/32.png 755w, /wp-content/uploads/2021/06/32-300x85.png 300w, /wp-content/uploads/2021/06/32-205x58.png 205w" sizes="(max-width: 755px) 100vw, 755px" /></p>
<h2><strong>Conclusion:</strong></h2>
<p>GDI+ is a very commonly used Windows component, and a vulnerability like this can affect billions of systems across the globe. We recommend our users to apply proper updates and keep their Windows deployment current.</p>
<p>We at McAfee are continuously fuzzing various open source and closed source library and work with vendors to fix such issues by responsibly disclosing such issues to them giving them proper time to fix the issue and release updates as needed.</p>
<p>We are thankful to Microsoft for working with us on fixing this issue and releasing an update.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong> </strong></p>
        </div>
    </div>

    <div class="wrap-section">  
        <div class="container medium">
            <h3>About the Author</h3>
        </div>
    </div>

    <div class="wrap-section padding-small bg-light-gray author-container">  
        <div class="container medium"> 


                <div class="row">
                    <div class="col-sm-2 col-xs-4 text-center">
                        <a href="/blogs/author/hardik-shah/"><img class="author" src="https://www.mcafee.com/wp-content/themes/securingtomorrow/img/author-avatar-default.jpg" /></a>
                        <ul class="social-networks">
                <li><a href="https://twitter.com/hardik05" rel="nofollow" target="_blank"><i class="symbol-twitter"></i><span>Twitter</span></a></li><li><a href="https://www.linkedin.com/in/hardik05/" rel="nofollow" target="_blank"><i class="symbol-linkedin"></i><span>LinkedIn</span></a></li>                        </ul>
                    </div>
                    <div class="col-sm-10 col-xs-8">
                        <h3 class="red"><a href="/blogs/author/hardik-shah/">Hardik Shah</a></h3>
                        <p>Hardik Shah, a Senior Research Engineer in McAfee Labs, is an experienced security researcher and technology evangelist. He has extensive experience with exploits, malware analysis, and various IPS engines. Shah enjoys figuring out ways to protect customers from the latest threats. Prior to McAfee, he worked with the IPS research team at Symantec. You can ...</p>						
                        <a href="/blogs/author/hardik-shah/" class="caret-link">Read more posts from Hardik Shah </a>
                    </div>
                </div><br/>
                                    </div>
    </div>

    <div class="wrap-section padding-top-xs">  
        <div class="container medium"> 
            <div class="row">
                            <div class="col-sm-6 col-xs-6">
            <a href="/blogs/consumer/family-safety/what-is-roblox-and-is-it-safe-for-kids/" rel="prev"><i class="fa fa-angle-left" aria-hidden="true"></i> Previous Article</a> 
                </div>
                <div class="col-sm-6 col-xs-6 text-right">
<a href="/blogs/other-blogs/life-at-mcafee/how-i-seized-mcafees-opportunities-to-realize-my-potential/" rel="next">Next Article <i class="fa fa-angle-right" aria-hidden="true"></i></a>                </div>
            </div>
        </div>
    </div>
    <div class="wrap-section padding-top-xs"> 
        <div class="container medium">
                    <p class="small rule">Categories: <a href="/blogs/other-blogs/mcafee-labs/" rel="category tag">McAfee Labs</a><br /> 
            </p>	

        </div>		 
    </div>
    <div class="container medium">
                    <ol class="commentlist">
                    </ol>
             
    </div>
    
    <div class="wrap-section padding-top-small">  
        <div class="container medium">
                                </div>
    </div>
        <div class="wrap-section bg-red bg-image padding-medium" id="subscribe">
      <div class="container medium">
        <div class="row">
          <div class="col-sm-12">
            <div class="cta-component text-center">
              <h3>Subscribe to McAfee Securing Tomorrow Blogs</h3>
                         <form method="get" action="/blogs/subscribe/" class="form-inline">
            
              <input type="text" placeholder="Email address" name="subscriber_email" />
          
            <button type="submit" class="btn transparent">Subscribe</button>
          </form>
              
            </div>
          </div>
        </div>
      </div>
    </div>

</main>
<!--Footer of en-us starts here --> 
    
	<aside class="tools">
		<a href="#wrapper" class="back-to-top">Back to top</a>
	</aside>
  
  <div class="textwidget custom-html-widget"><div class="wrap-section padding-bottom-medium padding-top-small bg-dark-gray" id="footer">
    <div class="container medium">           
      <div class="row">
         <div class="col-sm-6 breadcrumb">
        	<ul class="breadcrumb-list">
        		<li><a class="symbols-label first" href="/blogs"><i class="symbol-shield"></i><span>McAfee Home</span></a></li>
        		<li><a class="symbols-label" href="/blogs"><i class="symbol-arrow-forward"></i><span>Securing Tomorrow</span></a></li>
					 </ul>
				</div>
        <div class="col-sm-6 social">
          <!-- <a id="usbl-integrated-button" class="symbols-label" href=""><i class="symbol-feedback"></i><span>Feedback</span></a> -->
          <ul class="social-networks">
            <li><a href="https://twitter.com/mcafee" title="Twitter" target="_blank" rel="noopener"><i class="symbol-twitter"></i><span>Twitter</span></a></li>
            <li><a href="http://www.facebook.com/mcafee" title="Facebook" target="_blank" rel="noopener"><i class="symbol-facebook"></i><span>Facebook</span></a></li>
            <li><a href="https://www.linkedin.com/company/2336?trk=prof-exp-company-name" title="LinkedIn" target="_blank" rel="noopener"><i class="symbol-linkedin"></i><span>LinkedIn</span></a></li>
            <li><a href="http://www.youtube.com/mcafee" title="YouTube" target="_blank" rel="noopener"><i class="symbol-youtube"></i><span>YouTube</span></a></li>
            <li><a href="/blogs/" title="Blog" target="_blank" rel="noopener"><i class="symbol-blog"></i><span>Blog</span></a></li>
					</ul>
        </div>
      </div>
      <hr />
      <div class="row">
        <div class="col-sm-3">
          <a class="symbols-label" href="/enterprise/en-us/about/region-selector.html"><i class="symbol-language"></i><span>United States / English</span></a>
        </div>
        <div class="col-sm-9">
           <a href="//www.scanalert.com/RatingVerify?ref=www.mcafee.com" target="_blank" class="mcafee-secure" rel="noopener"><img src="https://www.mcafee.com/enterprise/en-us/img/v1/common/logo-mcafee-secure.svg" alt="McAfee SECURE"/></a>
          <ul class="footer-menu">
            <li><a href="/enterprise/en-us/about/legal/privacy.html">Privacy</a></li>
            <li><a href="/enterprise/en-us/about/legal/notices.html">Legal Notices</a></li>
            <li><a href="/enterprise/en-us/about/legal/contracts-terms.html">Legal Contracts &amp; Terms</a></li>
            <li><a href="/enterprise/en-us/site-map.html">Site Map</a></li>
            <li>Copyright ©2020 McAfee, LLC</li>
          </ul>
        </div>
      </div>          
    </div>            	
  </div>
</div></div>


<script type="text/javascript"  src="/i46YgIGqEI9K/CDuNeW/4tSlHd/b7umXbNbYSOE/fQUZPAE/XC5a/W3EMO0U"></script><link rel="stylesheet" type="text/css" href="/_sec/cp_challenge/sec-3-5.css">
            <script src="/_sec/cp_challenge/sec-cpt-3-5.js" async defer></script>
            <div id="sec-overlay" style="display:none;">
            <div id="sec-container">
            </div>
          </div></body>	
<script type="text/javascript">
   if ($('div.author-block .meta').length > 0) {
      utag_data.tm_local_blogs_author = $('div.author-block .meta').text().split(' on ')[0].replace("By","").trim();
    }
    (function(a,b,c,d){
    a='//tags.tiqcdn.com/utag/mcafee/consumer-main/prod/utag.js'; // Note: Please use prod for production version and dev for dev version before release
    b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;
    a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a);
    })();
</script>

<script type='text/javascript' src='/wp-content/plugins/metronet-profile-picture/js/mpp-frontend.js?ver=2.5.0' id='mpp_gutenberg_tabs-js'></script>
<script type='text/javascript' id='hlst-extend-js-before'>
/* Highlight Search Terms 1.5 ( RavanH - http://status301.net/wordpress-plugins/highlight-search-terms/ ) */
var hlst_query = []; var hlst_areas = ["#groups-dir-list","#members-dir-list","div.bbp-topic-content,div.bbp-reply-content,li.bbp-forum-info,.bbp-topic-title,.bbp-reply-title","article","div.hentry","div.post","#content","#main","div.content","#middle","#container","div.container","div.page","#wrapper","body"];
</script>
<script type='text/javascript' src='/wp-content/plugins/highlight-search-terms/hlst-extend.min.js?ver=1.5' id='hlst-extend-js'></script>
<script type='text/javascript' src='/wp-content/plugins/social-polls-by-opinionstage/public/js/shortcodes.js?ver=19.7.9' id='opinionstage-shortcodes-js'></script>
<script type='text/javascript' id='wpmm_js-js-extra'>
/* <![CDATA[ */
var ajax_objects = {"ajaxurl":"https:\/\/www.mcafee.com\/wp-admin\/admin-ajax.php","redirecturl":"https:\/\/www.mcafee.com\/blogs\/","loadingmessage":"Sending user info, please wait..."};
var wpmm_object = {"ajax_url":"https:\/\/www.mcafee.com\/wp-admin\/admin-ajax.php","wpmm_responsive_breakpoint":"767px","wpmm_disable_mobile":"false"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/wp-megamenu/assets/js/wpmm.js?ver=1.3.7' id='wpmm_js-js'></script>
<script type='text/javascript' src='/wp-content/themes/securingtomorrow/js/theme-script.js?ver=5.6.3' id='wp-bootstrap-starter-themejs-js'></script>
<script type='text/javascript' src='/wp-content/themes/securingtomorrow/js/skip-link-focus-fix.min.js?ver=20151215' id='wp-bootstrap-starter-skip-link-focus-fix-js'></script>
<script type='text/javascript' src='/wp-content/plugins/super-socializer/js/front/social_login/general.js?ver=7.13.16' id='the_champ_ss_general_scripts-js'></script>
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=5.6.3' id='wp-embed-js'></script>
	
<script src="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js?ver=10faaf528e636a046163bdb6753031b2"></script>
<script src="/wp-content/themes/securingtomorrow/js/jquery-lib.js"></script>
<script src="/wp-content/themes/securingtomorrow/js/main.js"></script>
<script src="/wp-content/themes/securingtomorrow/js/general_footer.js"></script>
<!-- Consumer Facebook Pixel Code -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '187610925152304');
  fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=187610925152304&ev=PageView&noscript=1"/></noscript>
<!-- End Facebook Pixel Code -->

<!-- Start linkedIn pixel -->
<script type="text/javascript">
_linkedin_partner_id = "68395";
window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || [];
window._linkedin_data_partner_ids.push(_linkedin_partner_id);
</script><script type="text/javascript">
(function(){var s = document.getElementsByTagName("script")[0];
var b = document.createElement("script");
b.type = "text/javascript";b.async = true;
b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js";
s.parentNode.insertBefore(b, s);})();
</script>
<noscript>
<img height="1" width="1" style="display:none;" alt="" src="https://dc.ads.linkedin.com/collect/?pid=68395&fmt=gif" />
</noscript>
<!-- End linkedIn pixel -->

<!-- Twitter universal website tag code -->
<script>
!function(e,t,n,s,u,a){e.twq||(s=e.twq=function(){s.exe?s.exe.apply(s,arguments):s.queue.push(arguments);
},s.version='1.1',s.queue=[],u=t.createElement(n),u.async=!0,u.src='//static.ads-twitter.com/uwt.js',
a=t.getElementsByTagName(n)[0],a.parentNode.insertBefore(u,a))}(window,document,'script');
// Insert Twitter Pixel ID and Standard Event data below
twq('init','nxlgc');
twq('track','PageView');
</script>
<!-- Twitter universal website tag code -->

<script>
/* <![CDATA[ */
var google_conversion_id = 975085349;
var google_custom_params = window.google_tag_params;
var google_remarketing_only = true;
/* ]]> */
document.write('\x3Cscript type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js">\x3C/script>');
//document.write('\x3Cnoscript>\x3Cimg height="1" width="1" style="border-style:none;display:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/975085349/?guid=ON&script=0"/>\x3C/noscript>');
</script>

<!-- Enterprise Facebook Pixel Code -->
<script>
// load Facebook
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '766537420057144');
fbq('track', "PageView");

//document.write('\x3Cnoscript>\x3Cimg height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=766537420057144&ev=PageView&noscript=1" />\x3C/noscript>');
</script>
<!-- Facebook Pixel Code -->

<!-- Adobe Launch START -->
<script src="//assets.adobedtm.com/launch-ENc117a6a508e14a879398dd6f37ed54a3.min.js"></script>
<!-- Adobe Launch END -->
<script>_satellite.pageBottom()</script>
</html>


<style>
    .commentlist {
        display: none;
    }
</style>
<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me - Debug: cached@1624958133 -->