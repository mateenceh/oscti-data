<!DOCTYPE html>
<html lang="en-US">

    <head>

        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <link rel="profile" href="https://gmpg.org/xfn/11">
        <link rel="pingback" href="https://www.mcafee.com/xmlrpc.php">
                    <link rel="canonical" href="https://www.mcafee.com/blogs/other-blogs/mcafee-labs/fuzzing-imagemagick-and-digging-deeper-into-cve-2020-27829/">
                            <link rel="shortcut icon" href="https://www.mcafee.com/enterprise/en-us/img/favicon.ico">
        <!--<link rel="stylesheet" href="/wp-content/themes/securingtomorrow/css/responsive/blog.css" type="text/css">
        <link rel="stylesheet" href="/wp-content/themes/securingtomorrow/css/responsive/main.css" type="text/css">-->
        <link rel="stylesheet" href="/enterprise/www/css/main.min.css" type="text/css">
       
        	<script type="text/javascript">function theChampLoadEvent(e){var t=window.onload;if(typeof window.onload!="function"){window.onload=e}else{window.onload=function(){t();e()}}}</script>
		<script type="text/javascript">var theChampDefaultLang = 'en_US', theChampCloseIconPath = 'https://www.mcafee.com/wp-content/plugins/super-socializer/images/close.png';</script>
		<script>var theChampSiteUrl = 'https://www.mcafee.com/blogs', theChampVerified = 0, theChampEmailPopup = 0, heateorSsMoreSharePopupSearchText = 'Search';</script>
		<style type="text/css">.the_champ_horizontal_sharing .theChampSharing{
					color: #fff;
				border-width: 0px;
		border-style: solid;
		border-color: transparent;
	}
		.the_champ_horizontal_sharing .theChampTCBackground{
		color:#666;
	}
		.the_champ_horizontal_sharing .theChampSharing:hover{
				border-color: transparent;
	}
	.the_champ_vertical_sharing .theChampSharing{
					color: #fff;
				border-width: 0px;
		border-style: solid;
		border-color: transparent;
	}
		.the_champ_vertical_sharing .theChampTCBackground{
		color:#666;
	}
		.the_champ_vertical_sharing .theChampSharing:hover{
				border-color: transparent;
	}
	@media screen and (max-width:783px){.the_champ_vertical_sharing{display:none!important}}div.heateor_ss_mobile_footer{display:none;}@media screen and (max-width:783px){div.the_champ_bottom_sharing ul.the_champ_sharing_ul i.theChampTCBackground{background-color:white}div.the_champ_bottom_sharing{width:100%!important;left:0!important;}div.the_champ_bottom_sharing li{width:12.5% !important;}div.the_champ_bottom_sharing .theChampSharing{width: 100% !important;}div.the_champ_bottom_sharing div.theChampTotalShareCount{font-size:1em!important;line-height:28px!important}div.the_champ_bottom_sharing div.theChampTotalShareText{font-size:.7em!important;line-height:0px!important}div.heateor_ss_mobile_footer{display:block;height:40px;}.the_champ_bottom_sharing{padding:0!important;display:block!important;width: auto!important;bottom:-2px!important;top: auto!important;}.the_champ_bottom_sharing .the_champ_square_count{line-height: inherit;}.the_champ_bottom_sharing .theChampSharingArrow{display:none;}.the_champ_bottom_sharing .theChampTCBackground{margin-right: 1.1em !important}}</style>
	
	<!-- This site is optimized with the Yoast SEO plugin v16.2 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Fuzzing ImageMagick and Digging Deeper into CVE-2020-27829 | McAfee Blogs</title>
	<meta name="description" content="Introduction: ImageMagick is a hugely popular open source software that is used in lot of systems around the world. It is available for the Windows," />
	<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Fuzzing ImageMagick and Digging Deeper into CVE-2020-27829 | McAfee Blogs" />
	<meta property="og:description" content="Introduction: ImageMagick is a hugely popular open source software that is used in lot of systems around the world. It is available for the Windows," />
	<meta property="og:url" content="/blogs/?p=124102" />
	<meta property="og:site_name" content="McAfee Blogs" />
	<meta property="article:publisher" content="https://www.facebook.com/mcafee" />
	<meta property="article:published_time" content="2021-06-30T15:00:42+00:00" />
	<meta property="article:modified_time" content="2021-06-28T22:07:33+00:00" />
	<meta property="og:image" content="https://www.mcafee.com/wp-content/uploads/2021/03/GoziBanker_TW-e1615823848762.png" />
	<meta property="og:image:width" content="500" />
	<meta property="og:image:height" content="281" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:creator" content="@hardik05" />
	<meta name="twitter:site" content="@mcafee" />
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="Hardik Shah">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="14 minutes">
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://www.mcafee.com/blogs/#website","url":"https://www.mcafee.com/blogs/","name":"McAfee Blogs","description":"Securing Tomorrow. Today.","potentialAction":[{"@type":"SearchAction","target":"https://www.mcafee.com/blogs/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://www.mcafee.com/blogs/#primaryimage","inLanguage":"en-US","url":"/wp-content/uploads/2021/03/GoziBanker_TW-e1615823848762.png","contentUrl":"/wp-content/uploads/2021/03/GoziBanker_TW-e1615823848762.png","width":500,"height":281},{"@type":"WebPage","@id":"https://www.mcafee.com/blogs/#webpage","url":"https://www.mcafee.com/blogs/","name":"Fuzzing ImageMagick and Digging Deeper into CVE-2020-27829 | McAfee Blogs","isPartOf":{"@id":"https://www.mcafee.com/blogs/#website"},"primaryImageOfPage":{"@id":"https://www.mcafee.com/blogs/#primaryimage"},"datePublished":"2021-06-30T15:00:42+00:00","dateModified":"2021-06-28T22:07:33+00:00","author":{"@id":"https://www.mcafee.com/blogs/#/schema/person/99cb905e9b4051dfea96a7752dea4342"},"description":"Introduction: ImageMagick is a hugely popular open source software that is used in lot of systems around the world. It is available for the Windows,","breadcrumb":{"@id":"https://www.mcafee.com/blogs/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://www.mcafee.com/blogs/"]}]},{"@type":"BreadcrumbList","@id":"https://www.mcafee.com/blogs/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"/blogs/","url":"/blogs/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"/blogs/other-blogs/","url":"/blogs/other-blogs/","name":"Other Blogs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"/blogs/other-blogs/mcafee-labs/","url":"/blogs/other-blogs/mcafee-labs/","name":"McAfee Labs"}},{"@type":"ListItem","position":4,"item":{"@id":"https://www.mcafee.com/blogs/#webpage"}}]},{"@type":"Person","@id":"https://www.mcafee.com/blogs/#/schema/person/99cb905e9b4051dfea96a7752dea4342","name":"Hardik Shah","description":"Hardik Shah, a Senior Research Engineer in McAfee Labs, is an experienced security researcher and technology evangelist. He has extensive experience with exploits, malware analysis, and various IPS engines. Shah enjoys figuring out ways to protect customers from the latest threats. Prior to McAfee, he worked with the IPS research team at Symantec. You can follow him on twitter at @hardik05","sameAs":["https://www.linkedin.com/in/hardik05/","https://twitter.com/hardik05"]}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//stackpath.bootstrapcdn.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="McAfee Blogs &raquo; Feed" href="https://www.mcafee.com/blogs/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.6.3"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='/wp-includes/css/dist/block-library/style.min.css?ver=5.6.3' type='text/css' media='all' />
<link rel='stylesheet' id='mpp_gutenberg-css'  href='/wp-content/plugins/metronet-profile-picture/dist/blocks.style.build.css?ver=2.5.0' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='/wp-includes/css/dashicons.min.css?ver=5.6.3' type='text/css' media='all' />
<link rel='stylesheet' id='wpmm_css-css'  href='/wp-content/plugins/wp-megamenu/assets/css/wpmm.css?ver=1.3.7' type='text/css' media='all' />
<link rel='stylesheet' id='wp_megamenu_generated_css-css'  href='/wp-content/uploads/wp-megamenu/wp-megamenu.css?ver=1.3.7' type='text/css' media='all' />
<link rel='stylesheet' id='featuresbox_css-css'  href='/wp-content/plugins/wp-megamenu/addons/wpmm-featuresbox/wpmm-featuresbox.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='postgrid_css-css'  href='/wp-content/plugins/wp-megamenu/addons/wpmm-gridpost/wpmm-gridpost.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wp-bootstrap-pro-fontawesome-cdn-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6.3' type='text/css' media='all' />
<link rel='stylesheet' id='open-sans-google-font-css'  href='https://fonts.googleapis.com/css?family=Open+Sans%3A300%2C400&#038;ver=5.6.3' type='text/css' media='all' />
<link rel='stylesheet' id='theme-css-css'  href='/wp-content/themes/securingtomorrow/style.css?ver=5.6.3' type='text/css' media='all' />
<link rel='stylesheet' id='the_champ_frontend_css-css'  href='/wp-content/plugins/super-socializer/css/front.css?ver=7.13.16' type='text/css' media='all' />
<link rel='stylesheet' id='addtoany-css'  href='/wp-content/plugins/add-to-any/addtoany.min.css?ver=1.15' type='text/css' media='all' />
<link rel='stylesheet' id='poppins-css'  href='//fonts.googleapis.com/css?family=Poppins%3A100%2C100italic%2C200%2C200italic%2C300%2C300italic%2Cregular%2Citalic%2C500%2C500italic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic%2C900%2C900italic&#038;ver=1.3.7' type='text/css' media='all' />
<link rel='stylesheet' id='oswald-css'  href='//fonts.googleapis.com/css?family=Oswald%3A200%2C300%2Cregular%2C500%2C600%2C700&#038;ver=1.3.7' type='text/css' media='all' />
<script type='text/javascript' src='/wp-content/plugins/jquery-updater/js/jquery-3.6.0.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='/wp-content/plugins/jquery-updater/js/jquery-migrate-3.3.2.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='/wp-content/plugins/add-to-any/addtoany.min.js?ver=1.1' id='addtoany-js'></script>
<script type='text/javascript' src='/wp-content/plugins/wp-megamenu/addons/wpmm-featuresbox/wpmm-featuresbox.js?ver=1' id='featuresbox-style-js'></script>
<script type='text/javascript' id='postgrid-style-js-extra'>
/* <![CDATA[ */
var postgrid_ajax_load = {"ajax_url":"https:\/\/www.mcafee.com\/wp-admin\/admin-ajax.php","redirecturl":"https:\/\/www.mcafee.com\/blogs\/"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/wp-megamenu/addons/wpmm-gridpost/wpmm-gridpost.js?ver=1' id='postgrid-style-js'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='/wp-content/themes/securingtomorrow/js/html5.js?ver=3.7.0' id='html5hiv-js'></script>
<![endif]-->
<link rel="https://api.w.org/" href="https://www.mcafee.com/blogs/wp-json/" /><link rel="alternate" type="application/json" href="https://www.mcafee.com/blogs/wp-json/wp/v2/posts/124102" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.mcafee.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.mcafee.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.6.3" />
<link rel='shortlink' href='https://www.mcafee.com/blogs/?p=124102' />
<link rel="alternate" type="application/json+oembed" href="https://www.mcafee.com/blogs/wp-json/oembed/1.0/embed?url=%2Fblogs%2Fother-blogs%2Fmcafee-labs%2Ffuzzing-imagemagick-and-digging-deeper-into-cve-2020-27829%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://www.mcafee.com/blogs/wp-json/oembed/1.0/embed?url=%2Fblogs%2Fother-blogs%2Fmcafee-labs%2Ffuzzing-imagemagick-and-digging-deeper-into-cve-2020-27829%2F&#038;format=xml" />

<script data-cfasync="false">
window.a2a_config=window.a2a_config||{};a2a_config.callbacks=[];a2a_config.overlays=[];a2a_config.templates={};
(function(d,s,a,b){a=d.createElement(s);b=d.getElementsByTagName(s)[0];a.async=1;a.src="https://static.addtoany.com/menu/page.js";b.parentNode.insertBefore(a,b);})(document,"script");
</script>
<script>
var utag_data = {
tm_global_pagename:"",
tm_global_page_publish_date:"",
tm_global_businessunit:"consumer",
tm_global_sitesection:"",
tm_global_sitesection_level2:"",
tm_global_sitesection_level3:"",
tm_global_platform:"web",
tm_global_culture_code:"en-us",
tm_global_country:"united states",
tm_global_geo:"na",
tm_global_channel:"direct",
tm_global_affiliate_id:"",
tm_global_affiliate_name:"",
tm_global_campaign_id:"",
tm_global_page_version:"",
tm_global_pageurl:location.href,
tm_global_clientid :"",
tm_global_trafficsource:"",
tm_global_sourcetype:"blog",
tm_global_wssversion:"",
tm_global_coe:"",
tm_global_coe_level2:"",
tm_local_blogs_author:""
}
var sec=location.pathname.replace("/blogs","").split("/"); utag_data.tm_global_pagename="[consumer:web]";
if(sec.length > 2) {
for(i=1;i<sec.length-1;i++) {
utag_data.tm_global_pagename+="|"+sec[i];
if(i==1){utag_data.tm_global_sitesection=sec[i]}
if(i==2){utag_data.tm_global_sitesection_level2=sec[i]}
if(i==3){utag_data.tm_global_sitesection_level3=sec[i]}
}
}
else {
utag_data.tm_global_sitesection="Homepage"
utag_data.tm_global_pagename+="|Homepage"
}

var today = new Date(); var dd = today.getDate(); var mm = today.getMonth() + 1; var yyyy = today.getFullYear();
if (dd < 10) { dd = '0' + dd;    } 
if (mm < 10) {mm = '0' + mm;  } 
utag_data.tm_global_page_publish_date = dd + '/' + mm + '/' + yyyy;

</script>

<script>
	var ISOTOPE_CACHE 				=  [];
	var ISOTOPE_AJAX_URL 			= 'https://www.mcafee.com/wp-admin/admin-ajax.php';
	var ISOTOPE_AJAX_URL_ENDPOINT 	= 'https://www.mcafee.com/wp-content/plugins/ae-isotope/endpoint.php';
	var ISOTOPE_AJAX_ITEMS			= 25;
	var ISOTOPE_CURRENT_CATEGORY	= '';
</script>		<meta property="fb:app_id" content="346056175795920" />
					<meta property="fb:admins" content="100007220654854" />
			<style type="text/css">.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-97446.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-97446>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-97446>a { }li#wp-megamenu-item-97446> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-97446 a { }#wp-megamenu-item-97446> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-97445.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-97445>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-97445>a { }li#wp-megamenu-item-97445> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-97445 a { }#wp-megamenu-item-97445> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-101283.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-101283>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-101283>a { }li#wp-megamenu-item-101283> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-101283 a { }#wp-megamenu-item-101283> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-97443.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-97443>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-97443>a { }li#wp-megamenu-item-97443> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-97443 a { }#wp-megamenu-item-97443> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-97440.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-97440>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-97440>a { }li#wp-megamenu-item-97440> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-97440 a { }#wp-megamenu-item-97440> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-101284.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu-wrap .wpmm-nav-wrap > ul.wp-megamenu li.wpmm_dropdown_menu ul.wp-megamenu-sub-menu li.menu-item-has-children.wp-megamenu-item-101284.wpmm-submenu-right > ul.wp-megamenu-sub-menu {left: 100%;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-101284>a { text-align: left !important;}.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-101284>a { }li#wp-megamenu-item-101284> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-101284 a { }#wp-megamenu-item-101284> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-101279.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-101279>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-101279>a { }li#wp-megamenu-item-101279> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-101279 a { }#wp-megamenu-item-101279> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-101280.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-101280>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-101280>a { }li#wp-megamenu-item-101280> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-101280 a { }#wp-megamenu-item-101280> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-101281.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-101281>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-101281>a { }li#wp-megamenu-item-101281> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-101281 a { }#wp-megamenu-item-101281> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-97453.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-97453>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-97453>a { }li#wp-megamenu-item-97453> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-97453 a { }#wp-megamenu-item-97453> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-97447.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-97447>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-97447>a { }li#wp-megamenu-item-97447> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-97447 a { }#wp-megamenu-item-97447> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-97448.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-97448>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-97448>a { }li#wp-megamenu-item-97448> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-97448 a { }#wp-megamenu-item-97448> .wp-megamenu-sub-menu { }.wp-megamenu-wrap > ul.wp-megamenu > li.wpmm_mega_menu > .wpmm-strees-row-container 
                        > ul.wp-megamenu-sub-menu { width: 100% !important;}.wp-megamenu > li.wp-megamenu-item-101282.wpmm-item-fixed-width  > ul.wp-megamenu-sub-menu { width: 100% !important;}.wpmm-nav-wrap ul.wp-megamenu>li ul.wp-megamenu-sub-menu #wp-megamenu-item-101282>a { }.wpmm-nav-wrap .wp-megamenu>li>ul.wp-megamenu-sub-menu li#wp-megamenu-item-101282>a { }li#wp-megamenu-item-101282> ul ul ul> li { width: 100%; display: inline-block;} li#wp-megamenu-item-101282 a { }#wp-megamenu-item-101282> .wp-megamenu-sub-menu { }</style><style type="text/css"></style><link rel="icon" href="/wp-content/uploads/2018/11/cropped-favicon-32x32.png" sizes="32x32" />
<link rel="icon" href="/wp-content/uploads/2018/11/cropped-favicon-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="/wp-content/uploads/2018/11/cropped-favicon-180x180.png" />
<meta name="msapplication-TileImage" content="/wp-content/uploads/2018/11/cropped-favicon-270x270.png" />
         <link rel="stylesheet" href="/enterprise/www/css/blog.css" type="text/css">
                <script type="text/javascript">
            var digitalData = {"page":{"pageInfo":{"pageName":"other-blogs:mcafee-labs:fuzzing-imagemagick-and-digging-deeper-into-cve-2020-27829","pageNameGlobal":"fuzzing-imagemagick-and-digging-deeper-into-cve-2020-27829","pageLanguage":"English","pageType":"","country":"us","geo":"NA","onsiteSearchTerm":"","onsiteSearchType":"","category":{"category":"other-blogs","subCategory1":"mcafee-labs"},"author":"Hardik Shah","pubDate":"Jun 30, 2021","metaData":{"keywords":""}}},"user":{"userInfo":{"ip":"10.44.130.39"}}}        </script>
                <script type='application/ld+json'>{
            "@context": "http://schema.org",
            "@type": "Article",
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/fuzzing-imagemagick-and-digging-deeper-into-cve-2020-27829/"
            },
           "headline": "Fuzzing ImageMagick and Digging Deeper into CVE-2020-27829",
            "image": ["https://www.mcafee.com/wp-content/uploads/2021/03/GoziBanker_TW-e1615823848762.png"],	
            "datePublished": "2021-06-30",
            "dateModified": "Jun 28, 2021",
            "author": {
                "@type": "Person",           
                "name": ["Hardik Shah"]            
            },
            "publisher": {
                "@type": "Organization",
                "name": "McAfee",
                "logo": {
                    "@type": "ImageObject",
                    "url": "https://www.mcafee.com/enterprise/en-us/img/logos/mcafee-logo.png"
                }
            },
            "description": "Introduction:ImageMagick is a hugely popular open source software that is used in lot of systems around the world. It is available for the Windows, Linux, MacOS platforms as well as Android and iOS. It is used for editing, creating or converting various digital image formats and supports various formats like PNG, JPEG,"        
            }
        </script>
        <style>
            #wp-megamenu-blog>.wpmm-nav-wrap ul.wp-megamenu>li>a{
                color:#ffffff !important;
            }
        </style> 
    
    <script>!function(){function o(n,i){if(n&&i)for(var r in i)i.hasOwnProperty(r)&&(void 0===n[r]?n[r]=i[r]:n[r].constructor===Object&&i[r].constructor===Object?o(n[r],i[r]):n[r]=i[r])}try{var n=decodeURIComponent("%7B%20%22BW%22%3A%20%7B%20%22test_https%22%3A%20true%20%7D%20%7D");if(n.length>0&&window.JSON&&"function"==typeof window.JSON.parse){var i=JSON.parse(n);void 0!==window.BOOMR_config?o(window.BOOMR_config,i):window.BOOMR_config=i}}catch(r){window.console&&"function"==typeof window.console.error&&console.error("mPulse: Could not parse configuration",r)}}();</script>
                          <script>!function(e){var n="https://s.go-mpulse.net/boomerang/";if("False"=="True")e.BOOMR_config=e.BOOMR_config||{},e.BOOMR_config.PageParams=e.BOOMR_config.PageParams||{},e.BOOMR_config.PageParams.pci=!0,n="https://s2.go-mpulse.net/boomerang/";if(window.BOOMR_API_key="LXNDQ-3SP7Y-P3JVN-Y4HAH-VQNKC",function(){function e(){if(!o){var e=document.createElement("script");e.id="boomr-scr-as",e.src=window.BOOMR.url,e.async=!0,i.parentNode.appendChild(e),o=!0}}function t(e){o=!0;var n,t,a,r,d=document,O=window;if(window.BOOMR.snippetMethod=e?"if":"i",t=function(e,n){var t=d.createElement("script");t.id=n||"boomr-if-as",t.src=window.BOOMR.url,BOOMR_lstart=(new Date).getTime(),e=e||d.body,e.appendChild(t)},!window.addEventListener&&window.attachEvent&&navigator.userAgent.match(/MSIE [67]\./))return window.BOOMR.snippetMethod="s",void t(i.parentNode,"boomr-async");a=document.createElement("IFRAME"),a.src="about:blank",a.title="",a.role="presentation",a.loading="eager",r=(a.frameElement||a).style,r.width=0,r.height=0,r.border=0,r.display="none",i.parentNode.appendChild(a);try{O=a.contentWindow,d=O.document.open()}catch(c){n=document.domain,a.src="javascript:var d=document.open();d.domain='"+n+"';void(0);",O=a.contentWindow,d=O.document.open()}if(n)d._boomrl=function(){this.domain=n,t()},d.write("<bo"+"dy onload='document._boomrl();'>");else if(O._boomrl=function(){t()},O.addEventListener)O.addEventListener("load",O._boomrl,!1);else if(O.attachEvent)O.attachEvent("onload",O._boomrl);d.close()}function a(e){window.BOOMR_onload=e&&e.timeStamp||(new Date).getTime()}if(!window.BOOMR||!window.BOOMR.version&&!window.BOOMR.snippetExecuted){window.BOOMR=window.BOOMR||{},window.BOOMR.snippetStart=(new Date).getTime(),window.BOOMR.snippetExecuted=!0,window.BOOMR.snippetVersion=12,window.BOOMR.url=n+"LXNDQ-3SP7Y-P3JVN-Y4HAH-VQNKC";var i=document.currentScript||document.getElementsByTagName("script")[0],o=!1,r=document.createElement("link");if(r.relList&&"function"==typeof r.relList.supports&&r.relList.supports("preload")&&"as"in r)window.BOOMR.snippetMethod="p",r.href=window.BOOMR.url,r.rel="preload",r.as="script",r.addEventListener("load",e),r.addEventListener("error",function(){t(!0)}),setTimeout(function(){if(!o)t(!0)},3e3),BOOMR_lstart=(new Date).getTime(),i.parentNode.appendChild(r);else t(!1);if(window.addEventListener)window.addEventListener("load",a,!1);else if(window.attachEvent)window.attachEvent("onload",a)}}(),"".length>0)if(e&&"performance"in e&&e.performance&&"function"==typeof e.performance.setResourceTimingBufferSize)e.performance.setResourceTimingBufferSize();!function(){if(BOOMR=e.BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},!BOOMR.plugins.AK){var n=""=="true"?1:0,t="",a="fb23dtixe64eqyg42dpq-f-fa7dd3768-clientnsv4-s.akamaihd.net",i={"ak.v":"31","ak.cp":"108209","ak.ai":parseInt("250743",10),"ak.ol":"0","ak.cr":5,"ak.ipv":4,"ak.proto":"http/1.1","ak.rid":"d55d864","ak.r":34483,"ak.a2":n,"ak.m":"b","ak.n":"essl","ak.bpcip":"40.117.177.0","ak.cport":51078,"ak.gh":"69.192.0.198","ak.quicv":"","ak.tlsv":"tls1.3","ak.0rtt":"","ak.csrc":"-","ak.acc":"reno","ak.t":"1625084127","ak.ak":"hOBiQwZUYzCg5VSAfCLimQ==WN0LRlhMy5tB0wPWDr80T0FUUWRBWmMWuDJBcMCH4VZ0tFyVvH9DVpZN5m7DcjQA8sUg5DsQcjxDAQdfJDFPcPmoE27c2OE93T4osgtE514Ylg8WzSF+0CycdvAX3W94+Yyl8yqa3iLquXZxvMG1Hl3liVlxPL3TNHyGWrOsolDJ7hSiw88KVlf+h4jmHCfnc8ATjXwgt8VAhPQUS8/v/5Egc1QEgLUxwJMNdY3+kOMkhvqLpDhOBl+2qiD+IXsQP4iG07cmhQ1PNew8Mb+nsvzvECqbUNyi6PQ8wfb329TA3AK1wBSxVH/cwrPBeEHqpcHuzTgsgh0php0b+nqdc42FnaioXFxl8s3JzWEtRNFnsHpSMBD2d2nTgJhB1NECrAEOJydQZITY0haegTvHNm9WBlWaI1rpjNMz8HDrlWs=","ak.pv":"152","ak.dpoabenc":""};if(""!==t)i["ak.ruds"]=t;var o={i:!1,av:function(n){var t="http.initiator";if(n&&(!n[t]||"spa_hard"===n[t]))i["ak.feo"]=void 0!==e.aFeoApplied?1:0,BOOMR.addVar(i)},rv:function(){var e=["ak.bpcip","ak.cport","ak.cr","ak.csrc","ak.gh","ak.ipv","ak.m","ak.n","ak.ol","ak.proto","ak.quicv","ak.tlsv","ak.0rtt","ak.r","ak.acc","ak.t"];BOOMR.removeVar(e)}};BOOMR.plugins.AK={akVars:i,akDNSPreFetchDomain:a,init:function(){if(!o.i){var e=BOOMR.subscribe;e("before_beacon",o.av,null,null),e("onbeacon",o.rv,null,null),o.i=!0}return this},is_complete:function(){return!0}}}}()}(window);</script></head>

    <body  class="post-template-default single single-post postid-124102 single-format-standard wp-megamenu" id="short-header">
        <script src="/wp-content/themes/securingtomorrow/js/header_enterprise.js"></script>
        <div id="wrapper">
            <div class="textwidget custom-html-widget"><style>
	.headerbarContainer {
    background: rgba(0,0,0,0.9);
}
</style>
<header id="header">  
	<div class="headerbarContainer">
		<div class="headerbarContent">
			<div class="logo">
				 <img src="https://www.mcafee.com/enterprise/en-us/img/icons/logo-white.svg" alt="McAfee Logo"/>
			</div>
			<div class="quicklinks">
			 	<a class="symbols-label" href="https://www.mcafee.com/consumer/en-us/store/m0/index.html"><span>For Home</span></a>
			 	<a class="symbols-label" href="/enterprise/en-us/home.html"><span>For Enterprise</span></a>
			 	<a class="symbols-label" href="/enterprise/en-us/global-contact-us.html"><i class="symbol-contact"></i></a>
			</div>
		</div>
	</div>
</header>



<style>


@media screen and (min-width: 1025px) {
.hero{height: 756px !important;}
.hero.medium {
    min-height: 0;
    height: 640px  !important;
}
.hero.small {
    min-height: 0;
    height: 510px  !important;
}
.hero.title {
    height: 350px  !important;
}
	}
</style> 
<script>
$("document").ready(function(){
    $(".hero.title h1").each(function() {
        if ($(this).text().length > 50) {
            $(this).addClass("pt")
        }
    });
});
</script></div>  
		
<section class="hero title">
    <div class="bg-stretch">
        <img src="https://www.mcafee.com/wp-content/themes/securingtomorrow/img/light-shield-pattern.png" alt="">
    </div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-12 col-xs-12">
                <h1>Fuzzing ImageMagick and Digging Deeper into CVE-2020-27829</h1>
            </div>
        </div>
    </div>
</section>

<main id="main">

    <nav class="anchor-links">
        <div class="container medium">
            <div style="float:left">
<nav id="wp-megamenu-blog" class="wp-megamenu-wrap   ">
			<div class="wpmm-fullwidth-wrap"></div>
			<div class="wpmm-nav-wrap wpmm-main-wrap-blog">
				<a href="javascript:;" class="wpmm_mobile_menu_btn show-close-icon"><i class="fa fa-bars"></i> Menu</a> 
					<ul id="menu-mcafee-blog-navigation-new-05020" class="wp-megamenu" ><li id="wp-megamenu-item-101279" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101279  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#">Consumer <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-5834392111210184618" class="wpmm-row wp-megamenu-item-5834392111210184618 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-6210655100807055808" class="wpmm-col wpmm-col-12 wp-megamenu-item-6210655100807055808 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101279 wpmm-submenu-right"><div class="menu-consumer-category-container"><ul id="menu-consumer-category" class="menu"><li id="menu-item-97425" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97425"><a href="/blogs/consumer/family-safety/">Family Safety</a></li>
<li id="menu-item-97424" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97424"><a href="/blogs/consumer/consumer-threat-reports/">Consumer Threat Reports</a></li>
<li id="menu-item-121138" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-121138"><a href="/blogs/consumer/cyberthreat-news/">Cyberthreat News</a></li>
<li id="menu-item-121135" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-121135"><a href="/blogs/consumer/consumer-cyber-awareness/">Consumer Cyber Awareness</a></li>
<li id="menu-item-97427" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97427"><a href="/blogs/consumer/mobile-and-iot-security/">Mobile and IoT Security</a></li>
<li id="menu-item-121132" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-121132"><a href="/blogs/consumer/mcafee-consumer-news/">McAfee Consumer News</a></li>
<li id="menu-item-97453" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97453"><a href="/blogs/consumer/hackable/">Hackable? Podcast</a></li>
<li id="menu-item-101334" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-101334"><a href="/blogs/consumer/">All Consumer Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-101280" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101280  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#">Enterprise <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-5082657912256872002" class="wpmm-row wp-megamenu-item-5082657912256872002 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-1.2444905033827E+19" class="wpmm-col wpmm-col-12 wp-megamenu-item-1.2444905033827E+19 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101280 wpmm-submenu-right"><div class="menu-enterprise-category-container"><ul id="menu-enterprise-category" class="menu"><li id="menu-item-97421" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97421"><a href="/blogs/enterprise/cloud-security/">Cloud Security</a></li>
<li id="menu-item-97451" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97451"><a href="/blogs/enterprise/endpoint-security/">Endpoint Security</a></li>
<li id="menu-item-97422" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97422"><a href="/blogs/enterprise/security-operations/">Security Operations</a></li>
<li id="menu-item-97452" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97452"><a href="/blogs/enterprise/data-security/">Data Security</a></li>
<li id="menu-item-101336" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-101336"><a href="/blogs/enterprise/">All Enterprise Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-101281" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101281  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#">Corporate <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-3791343494728242357" class="wpmm-row wp-megamenu-item-3791343494728242357 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-1.0847387785412E+19" class="wpmm-col wpmm-col-12 wp-megamenu-item-1.0847387785412E+19 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101281 wpmm-submenu-right"><div class="menu-other-blogs-container"><ul id="menu-other-blogs" class="menu"><li id="menu-item-97442" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97442"><a href="/blogs/other-blogs/executive-perspectives/">Executive Perspectives</a></li>
<li id="menu-item-97441" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-97441"><a href="/blogs/other-blogs/mcafee-labs/">McAfee Labs</a></li>
<li id="menu-item-97443" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97443"><a href="/blogs/other-blogs/life-at-mcafee/">Life at McAfee</a></li>
<li id="menu-item-97440" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97440"><a href="/blogs/other-blogs/podcast/">Podcast</a></li>
<li id="menu-item-97444" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97444"><a href="/blogs/other-blogs/mcafee-partners/">McAfee Partners</a></li>
<li id="menu-item-101340" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-101340"><a href="/blogs/other-blogs/">All Corporate Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-101282" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101282  wpmm_dropdown_menu  wpmm-fadeindown wpmm-submenu-right"><a href="/blogs/authors/">Authors</a></li>
<li id="wp-megamenu-item-101283" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101283  wpmm_dropdown_menu  wpmm-fadeindown wpmm-submenu-right"><a href="/blogs/subscribe/">Subscribe</a></li>
<li id="wp-megamenu-item-101284" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101284  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#"><span class='wpmm-selected-icon wpmm-selected-icon-left'><i class='fa fa-globe'></i></span> <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-4444067474207110682" class="wpmm-row wp-megamenu-item-4444067474207110682 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-6118912570348718308" class="wpmm-col wpmm-col-12 wp-megamenu-item-6118912570348718308 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101284 wpmm-submenu-right"><div class="menu-languages-category-container"><ul id="menu-languages-category" class="menu"><li id="menu-item-121129" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-121129"><a href="/blogs/languages/chinese/">Chinese</a></li>
<li id="menu-item-97433" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97433"><a href="/blogs/languages/italia/">Italia</a></li>
<li id="menu-item-97434" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97434"><a href="/blogs/languages/japanese/">日本語</a></li>
<li id="menu-item-97435" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97435"><a href="/blogs/languages/espanol/">Español</a></li>
<li id="menu-item-97436" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97436"><a href="/blogs/languages/francais/">Français</a></li>
<li id="menu-item-97437" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97437"><a href="/blogs/languages/german/">German</a></li>
<li id="menu-item-97438" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97438"><a href="/blogs/languages/portugues/">Português</a></li>
<li id="menu-item-101338" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-101338"><a href="/blogs/languages/">All Language Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-" class="wpmm-social-link wpmm-social-link- wpmm-social-index-0 wp-megamenu-item-  wpmm_dropdown_menu  wpmm-fadeindown wpmm-submenu-right"><a target="_blank" ><i class=""></i></a></li>
</ul>
			</div>


			
		    
		</nav>            </div>
            <div class="anchors right">
                <form role="search" method="get" class="blog-search search-form" action="https://www.mcafee.com/blogs/">
                    <button type="submit" class="search-submit"><i class="symbol-arrow-forward"></i></button>
                    <input type="search" class="search-field" placeholder="Search Blogs" value="" name="s" />


                </form>  
            </div>

        </div>
    </nav>

    <div class="wrap-section padding-top-xs"> 
        <div class="container medium">
 
        <div class="breadcrumb-container theme1">
                    <ul>
                    
        <li ><a title="Mcafee" href="#"><span>Mcafee</span></a><span class="separator">/</span></li>
                
        <li ><a title="Home" href="https://www.mcafee.com/blogs"><span>Home</span></a><span class="separator">/</span></li>
                
        <li ><a title="Other Blogs" href="/blogs/other-blogs/"><span>Other Blogs</span></a><span class="separator">/</span></li>
                
        <li ><a title="McAfee Labs" href="/blogs/other-blogs/mcafee-labs/"><span>McAfee Labs</span></a><span class="separator">/</span></li>
                
        <li ><a title="Fuzzing ImageMagick and Digging Deeper into CVE-2020-27829" href="#"><span>Fuzzing ImageMagick and Digging Deeper into CVE-2020-27829</span></a><span class="separator">/</span></li>
                </ul>
            <script type="application/ld+json">
        {
            "@context": "http://schema.org",
            "@type": "BreadcrumbList",
            "itemListElement":
            [
                                        {
                            "@type": "ListItem",
                            "position":1,
                            "item":
                            {
                                "@id": "#",
                                "name": "Mcafee"
                            }
                        },                                                {
                            "@type": "ListItem",
                            "position":2,
                            "item":
                            {
                                "@id": "https://www.mcafee.com/blogs",
                                "name": "Home"
                            }
                        },                                                {
                            "@type": "ListItem",
                            "position":3,
                            "item":
                            {
                                "@id": "/blogs/other-blogs/",
                                "name": "Other Blogs"
                            }
                        },                                                {
                            "@type": "ListItem",
                            "position":4,
                            "item":
                            {
                                "@id": "/blogs/other-blogs/mcafee-labs/",
                                "name": "McAfee Labs"
                            }
                        },                                                {
                            "@type": "ListItem",
                            "position":5,
                            "item":
                            {
                                "@id": "#",
                                "name": "Fuzzing ImageMagick and Digging Deeper into CVE-2020-27829"
                            }
                        }                                    ]
        }
    </script>
        <style type="text/css">
        .breadcrumb-container {
            font-size: 13px;
        }
        .breadcrumb-container ul {
            margin: 0;
            padding: 0;
        }
        .breadcrumb-container li {
            box-sizing: unset;
            display: inline-block;
            margin: 0;
            padding: 0;
        }
        .breadcrumb-container li a {
            box-sizing: unset;
            padding: 0 10px;
        }
        .breadcrumb-container {
            font-size: 12px  !important;
            padding: 0px;
            margin: 0px;
        }
        .breadcrumb-container li a{
            color:  #c01818  !important;
            font-size:  12px  !important;
            line-height:  12px  !important;
        }
        .breadcrumb-container li .separator {
            color: #53565a  !important;
            font-size:  12px  !important;
        }
                    .breadcrumb-container li:last-child .separator {
                display: none;
            }
                </style>
        <style type="text/css">
        .breadcrumb-container.theme1 li {
            margin: 0;
            padding: 0;
        }
        .breadcrumb-container.theme1 a {
            background: ;
            display: inline-block;
            margin: 0 5px;
            padding: 5px 10px;
            text-decoration: none;
        }
    </style>
        <style type="text/css">
        .breadcrumb-container{}
.breadcrumb-container ul{}
.breadcrumb-container li{}
.breadcrumb-container a{}
.breadcrumb-container .separator{}
    </style>
    <script>
            </script>
            </div>
                </div>		 
    </div>

    <div class="wrap-section padding-small article">  
        <div class="container medium"> 
            <div class="border-line"></div>

            <div class="author-block padding-bottom-xs">
                <img class="author" src="https://www.mcafee.com/wp-content/themes/securingtomorrow/img/author-avatar-default.jpg" />
                <div class="meta">By <a href="/blogs/author/hardik-shah/" title="Posts by Hardik Shah" class="author url fn" rel="author">Hardik Shah</a> on Jun 30, 2021</div>
            </div>

                    <h2><strong>Introduction:</strong></h2>
<p>ImageMagick is a hugely popular open source software that is used in lot of systems around the world. It is available for the Windows, Linux, MacOS platforms as well as Android and iOS. It is used for editing, creating or converting various digital image formats and supports various formats like PNG, JPEG, WEBP, TIFF, HEIC and PDF, among others.</p>
<p>Google OSS Fuzz and other threat researchers have made ImageMagick the frequent focus of fuzzing, an extremely popular technique used by security researchers to discover potential zero-day vulnerabilities in open, as well as closed source software. This research has resulted in various vulnerability discoveries that must be addressed on a regular basis by its maintainers. Despite the efforts of many to expose such vulnerabilities, recent fuzzing research from McAfee has exposed new vulnerabilities involving processing of multiple image formats, in various open source and closed source software and libraries including ImageMagick and Windows GDI+.</p>
<h3><strong>Fuzzing ImageMagick:</strong></h3>
<p>Fuzzing open source libraries has been covered in a detailed blog <a href="https://www.mcafee.com/blogs/other-blogs/mcafee-labs/vulnerability-discovery-in-open-source-libraries-part-1-tools-of-the-trade/" target="_blank" rel="noopener">“Vulnerability Discovery in Open Source Libraries Part 1: Tools of the Trade”</a> last year. Fuzzing ImageMagick is very well documented, so we will be quickly covering the process in this blog post and will focus on the root cause analysis of the issue we have found.</p>
<h3><strong>Compiling ImageMagick with AFL:</strong></h3>
<p>ImageMagick has lot of configuration options which we can see by running following command:</p>
<table style="border-collapse: collapse; width: 16.0211%; height: 24px;">
<tbody>
<tr>
<td style="width: 100%;"><strong>$./configure –help</strong></td>
</tr>
</tbody>
</table>
<p>We can customize various parameters as per our needs. To compile and install ImageMagick with AFL for our case, we can use following commands:</p>
<table style="border-collapse: collapse; width: 69.3441%; height: 144px;">
<tbody>
<tr>
<td style="width: 100%;"><strong>$CC=afl-gcc CXX=afl=g++ CFLAGS=&#8221;-ggdb -O0 -fsanitize=address,undefined -fno-omit-frame-pointer&#8221; LDFLAGS=&#8221;-ggdb -fsanitize=address,undefined -fno-omit-frame-pointer&#8221; ./configure</strong></p>
<p><strong>$</strong> <strong>make -j$(nproc)</strong></p>
<p><strong>$sudo make install</strong></td>
</tr>
</tbody>
</table>
<p>This will compile and install ImageMagick with AFL instrumentation. The binary we will be fuzzing is “<strong>magick</strong>”, also known as “magick tool”. It has various options, but we will be using its image conversion feature to convert our image from one format to another.</p>
<p>A simple command would be include the following:</p>
<table style="border-collapse: collapse; width: 26.9366%; height: 28px;">
<tbody>
<tr>
<td style="width: 100%;"><strong>$ magick &lt;input file&gt; &lt;output file&gt;</strong></td>
</tr>
</tbody>
</table>
<p>This command will convert an input file to an output file format. We will be fuzzing this with AFL.</p>
<h3><strong>Collecting Corpus:</strong></h3>
<p>Before we start fuzzing, we need to have a good input corpus. One way of collecting corpus is to search on Google or GitHub. We can also use existing test corpus from various software. A good test corpus is available on the  AFL site here: <a href="https://lcamtuf.coredump.cx/afl/demo/" target="_blank" rel="noopener">https://lcamtuf.coredump.cx/afl/demo/</a></p>
<h3><strong>Minimizing Corpus:</strong></h3>
<p>Corpus collection is one thing, but we also need to minimize the corpus. The way AFL works is that it will instrument each basic block so that it can trace the program execution path. It maintains a shared memory as a bitmap and it uses an algorithm to check new block hits. If a new block hit has been found, it will save this information to bitmap.</p>
<p>Now it may be possible that more than one input file from the corpus can trigger the same path, as we have collected sample files from various sources, we don’t have any information on what paths they will trigger at the runtime. If we use this corpus without removing such files, then we end up wasting time and CPU cycles. We need to avoid that.</p>
<p>Interestingly AFL offers a utility called “<strong>afl-cmin</strong>” which we can use to minimize our test corpus. This is a recommended thing to do before you start any fuzzing campaign. We can run this as follows:</p>
<table style="border-collapse: collapse; width: 56.7782%;">
<tbody>
<tr>
<td style="width: 100%;"><strong>$afl-cmin -i &lt;input directory&gt; -o &lt;output directory&gt; &#8212; magick @@ /dev/null</strong></td>
</tr>
</tbody>
</table>
<p>This command will minimize the input corpus and will keep only those files which trigger unique paths.</p>
<h3><strong>Running Fuzzers:</strong></h3>
<p>After we have minimized corpus, we can start fuzzing. To fuzz we need to use following command:</p>
<table style="border-collapse: collapse; width: 59.9472%;">
<tbody>
<tr>
<td style="width: 100%;"><strong>$afl-fuzz -i &lt;mincorpus directory&gt; -o &lt;output directory&gt; &#8212; magick @@ /dev/null</strong></td>
</tr>
</tbody>
</table>
<p>This will only run a single instance of AFL utilizing a single core. In case we have multicore processors, we can run multiple instances of AFL, with one Master and n number of Slaves. Where n is the available CPU cores.</p>
<p>To check available CPU cores, we can use this command:</p>
<table style="border-collapse: collapse; width: 7.39437%;">
<tbody>
<tr>
<td style="width: 100%;"><strong>$nproc</strong></td>
</tr>
</tbody>
</table>
<p>This will give us the number of CPU cores (depending on the system) as follows:</p>
<p><img loading="lazy" class="alignnone wp-image-124105 size-full" src="/wp-content/uploads/2021/06/1-5-e1624910564724.png" alt="" width="176" height="85" /></p>
<p>In this case there are eight cores. So, we can run one Master and up to seven Slaves.</p>
<p>To run master instances, we can use following command:</p>
<table style="border-collapse: collapse; width: 67.7817%;">
<tbody>
<tr>
<td style="width: 100%;"><strong>$afl-fuzz -M Master -i &lt;mincorpus directory&gt; -o &lt;output directory&gt; &#8212; magick @@ /dev/null</strong></td>
</tr>
</tbody>
</table>
<p>We can run slave instances using following command:</p>
<table style="border-collapse: collapse; width: 66.9014%;">
<tbody>
<tr>
<td style="width: 100%;"><strong>$afl-fuzz -S Slave1 -i &lt;mincorpus directory&gt; -o &lt;output directory&gt; &#8212; magick @@ /dev/null</strong></p>
<p><strong>$afl-fuzz -S Slave2 -i &lt;mincorpus directory&gt; -o &lt;output directory&gt; &#8212; magick @@ /dev/null</strong></td>
</tr>
</tbody>
</table>
<p>The same can be done for each slave. We just need to use an argument -S and can use any name like slave1, slave2, etc.</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-124108" src="/wp-content/uploads/2021/06/2-3.png" alt="" width="904" height="628" srcset="/wp-content/uploads/2021/06/2-3.png 904w, /wp-content/uploads/2021/06/2-3-300x208.png 300w, /wp-content/uploads/2021/06/2-3-768x534.png 768w, /wp-content/uploads/2021/06/2-3-186x129.png 186w" sizes="(max-width: 904px) 100vw, 904px" /></p>
<h3><strong>Results:</strong></h3>
<p>Within a few hours of beginning this Fuzzing campaign, we found one crash related to an out of bound read inside a heap memory. We have reported this issue to ImageMagick, and they were very prompt in fixing it with a patch the very next day. ImageMagick has release a new build with version: 7.0.46 to fix this issue. This issue was assigned <strong>CVE-2020-27829</strong>.</p>
<h3><strong>Analyzing CVE-2020-27829:</strong></h3>
<p>On checking the POC file, we found that it was a TIFF file.</p>
<p><img loading="lazy" class="alignnone wp-image-124111 size-full" src="/wp-content/uploads/2021/06/3-3-e1624910544186.png" alt="" width="926" height="125" srcset="/wp-content/uploads/2021/06/3-3-e1624910544186.png 926w, /wp-content/uploads/2021/06/3-3-e1624910544186-300x40.png 300w, /wp-content/uploads/2021/06/3-3-e1624910544186-768x104.png 768w, /wp-content/uploads/2021/06/3-3-e1624910544186-205x28.png 205w" sizes="(max-width: 926px) 100vw, 926px" /></p>
<p>When we open this file with ImageMagick with following command:</p>
<table style="border-collapse: collapse; width: 21.831%;">
<tbody>
<tr>
<td style="width: 100%;"><strong>$magick poc.tif /dev/null</strong></td>
</tr>
</tbody>
</table>
<p>As a result, we see a crash like below:</p>
<p><img loading="lazy" class="aligncenter wp-image-124114 size-full" src="/wp-content/uploads/2021/06/4-3-e1624910626499.png" alt="" width="927" height="753" srcset="/wp-content/uploads/2021/06/4-3-e1624910626499.png 927w, /wp-content/uploads/2021/06/4-3-e1624910626499-300x244.png 300w, /wp-content/uploads/2021/06/4-3-e1624910626499-768x624.png 768w, /wp-content/uploads/2021/06/4-3-e1624910626499-159x129.png 159w" sizes="(max-width: 927px) 100vw, 927px" /></p>
<p>As is clear from the above log, the program was trying to read 1 byte past allocated heap buffer and therefore ASAN caused this crash. This can atleast lead to a <em> ImageMagick crash</em> on the systems running vulnerable version of ImageMagick.</p>
<h3><strong>Understanding TIFF file format:</strong></h3>
<p>Before we start debugging this issue to find a root cause, it is necessary to understand the TIFF file format. Its specification is very well described here: <a href="http://paulbourke.net/dataformats/tiff/tiff_summary.pdf" target="_blank" rel="noopener">http://paulbourke.net/dataformats/tiff/tiff_summary.pdf</a>.</p>
<p>In short, a TIFF file has three parts:</p>
<ol>
<li><strong>Image File Header (IFH)</strong> – Contains information such as file identifier, version, offset of IFD.</li>
<li><strong>Image File Directory (IFD)</strong> – Contains information on the height, width, and depth of the image, the number of colour planes, etc. It also contains various TAGs like <strong>colormap</strong>, <strong>page number</strong>, <strong>BitPerSample</strong>, <strong>FillOrder,</strong></li>
<li><strong>Bitmap data</strong> – Contains various image data like strips, tiles, etc.</li>
</ol>
<p>We can <strong>tiffinfo</strong> utility from <strong>libtiff</strong> to gather various information about the POC file. This allows us to see the following information with <strong>tiffinfo</strong> like <strong>width</strong>, <strong>height</strong>, <strong>sample per pixel</strong>, <strong>row per strip</strong> etc.:</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-124117" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.05.46-PM-1024x643.png" alt="" width="1024" height="643" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.05.46-PM-1024x643.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.05.46-PM-300x188.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.05.46-PM-768x482.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.05.46-PM-205x129.png 205w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.05.46-PM.png 1242w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p>There are a few things to note here:</p>
<table style="border-collapse: collapse; width: 38.4683%;">
<tbody>
<tr>
<td style="width: 100%;">TIFF Dir offset is: <strong>0xa0</strong></p>
<p>Image width is: <strong>3</strong> and length is: <strong>32</strong></p>
<p>Bits per sample is: <strong>9</strong></p>
<p>Sample per pixel is: <strong>3</strong></p>
<p>Rows per strip is: <strong>1024</strong></p>
<p>Planer configuration is: <strong>single image plane</strong>.</p>
<p>We will be using this data moving forward in this post.</td>
</tr>
</tbody>
</table>
<h3><strong>Debugging the issue:</strong></h3>
<p>As we can see in the crash log, program was crashing at function “PushQuantumPixel” in the following location in quantum-import.c line 256:</p>
<p><img loading="lazy" class="alignnone wp-image-124120 size-full" src="/wp-content/uploads/2021/06/5-3-e1624910868905.png" alt="" width="926" height="78" srcset="/wp-content/uploads/2021/06/5-3-e1624910868905.png 926w, /wp-content/uploads/2021/06/5-3-e1624910868905-300x25.png 300w, /wp-content/uploads/2021/06/5-3-e1624910868905-768x65.png 768w, /wp-content/uploads/2021/06/5-3-e1624910868905-205x17.png 205w" sizes="(max-width: 926px) 100vw, 926px" /></p>
<p>On checking “PushQuantumPixel” function in “MagickCore/quantum-import.c” we can see the following code at line #256 where program is crashing:</p>
<p><img loading="lazy" class="alignnone wp-image-124123 size-full" src="/wp-content/uploads/2021/06/6-3-e1624910928895.png" alt="" width="814" height="268" srcset="/wp-content/uploads/2021/06/6-3-e1624910928895.png 814w, /wp-content/uploads/2021/06/6-3-e1624910928895-300x99.png 300w, /wp-content/uploads/2021/06/6-3-e1624910928895-768x253.png 768w, /wp-content/uploads/2021/06/6-3-e1624910928895-205x67.png 205w" sizes="(max-width: 814px) 100vw, 814px" /></p>
<p>We can see following:</p>
<ul>
<li>“pixels” seems to be a character array</li>
<li>inside a for loop its value is being read and it is being assigned to <strong>quantum_info-&gt;state.pixel</strong></li>
<li>its address is increased by one in each loop iteration</li>
</ul>
<p>The program is crashing at this location while reading the value of “pixels” which means that value is out of bound from the allocated heap memory.</p>
<p>Now we need to figure out following:</p>
<ol>
<li>What is “pixels” and what data it contains?</li>
<li>Why it is crashing?</li>
<li>How this was fixed?</li>
</ol>
<h3><strong>Finding root cause:</strong></h3>
<p>To start with, we can check “ReadTIFFImage” function in coders/tiff.c file and see that it allocates memory using a “AcquireQuantumMemory” function call, which appears as per the documentation mentioned here:</p>
<p><a href="https://imagemagick.org/api/memory.php" target="_blank" rel="noopener">https://imagemagick.org/api/memory.php</a>:</p>
<p>“Returns a pointer to a block of memory at least count * quantum bytes suitably aligned for any use.</p>
<p>The format of the “<strong>AcquireQuantumMemory”</strong> method is:</p>
<p><strong>void *AcquireQuantumMemory(const size_t count,const size_t quantum)</strong></p>
<p>A description of each parameter follows:</p>
<p><strong>count</strong></p>
<p>the number of objects to allocate contiguously.</p>
<p><strong>quantum</strong></p>
<p>the size (in bytes) of each object. “</p>
<p>In this case two parameters passed to this function are <strong>“extent”</strong> and <strong>“sizeof(*strip_pixels)”</strong></p>
<p><img loading="lazy" class="aligncenter size-large wp-image-124126" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.09.29-PM-1024x483.png" alt="" width="1024" height="483" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.09.29-PM-1024x483.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.09.29-PM-300x142.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.09.29-PM-768x363.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.09.29-PM-205x97.png 205w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.09.29-PM.png 1220w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p>We can see that <strong>“extent”</strong> is calculated as following in the code below:</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-124129" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.10.35-PM-1024x462.png" alt="" width="1024" height="462" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.10.35-PM-1024x462.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.10.35-PM-300x135.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.10.35-PM-768x346.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.10.35-PM-205x92.png 205w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.10.35-PM.png 1206w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p>There is a function TIFFStripSize(tiff) which returns size for a strip of data as mentioned in libtiff documentation here:</p>
<p><a href="http://www.libtiff.org/man/TIFFstrip.3t.html" target="_blank" rel="noopener">http://www.libtiff.org/man/TIFFstrip.3t.html</a></p>
<p>In our case, it returns <strong>224</strong> and we can also see that in the code mentioned above,  “<strong>image-&gt;columns * sizeof(uint64)”</strong> is also added to extent, which results in <strong>24</strong> added to extent, so extent value becomes <strong>248</strong>.</p>
<p>So, this extent value of 248 and sizeof(*strip_pixels) which is 1 is passed to “<strong>AcquireQuantumMemory”</strong> function and total memory of <strong>248</strong> bytes get allocated.</p>
<p>This is how memory is allocated.</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-124132" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.11.39-PM-1024x268.png" alt="" width="1024" height="268" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.11.39-PM-1024x268.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.11.39-PM-300x78.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.11.39-PM-768x201.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.11.39-PM-205x54.png 205w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.11.39-PM.png 1202w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p><strong>“Strip_pixel</strong>” is pointer to newly allocated memory.</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-124135" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.12.09-PM-1024x232.png" alt="" width="1024" height="232" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.12.09-PM-1024x232.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.12.09-PM-300x68.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.12.09-PM-768x174.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.12.09-PM-205x46.png 205w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.12.09-PM.png 1210w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p>Note that this is <strong>248</strong> bytes of newly allocated memory. Since we are using ASAN, each byte will contain “0xbe” which is default for newly allocated memory by ASAN:</p>
<p><a href="https://github.com/llvm-mirror/compiler-rt/blob/master/lib/asan/asan_flags.inc" target="_blank" rel="noopener">https://github.com/llvm-mirror/compiler-rt/blob/master/lib/asan/asan_flags.inc</a></p>
<p><img loading="lazy" class="aligncenter size-large wp-image-124138" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.12.53-PM-1024x423.png" alt="" width="1024" height="423" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.12.53-PM-1024x423.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.12.53-PM-300x124.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.12.53-PM-768x317.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.12.53-PM-205x85.png 205w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-1.12.53-PM.png 1162w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p>The memory start location is 0x6110000002c0 and the end location is 0x6110000003b7, which is 248 bytes total.</p>
<p><img loading="lazy" class="alignnone wp-image-124141 size-full" src="/wp-content/uploads/2021/06/7-3-e1624911230951.png" alt="" width="462" height="234" srcset="/wp-content/uploads/2021/06/7-3-e1624911230951.png 462w, /wp-content/uploads/2021/06/7-3-e1624911230951-300x152.png 300w, /wp-content/uploads/2021/06/7-3-e1624911230951-205x104.png 205w" sizes="(max-width: 462px) 100vw, 462px" /></p>
<p>This memory is set to 0 by a “<strong>memset”</strong> call and this is assigned to a variable <strong>“p”,</strong> as mentioned in below image. Please also note that <strong>“p”</strong> will be used as a pointer to traverse this memory location going forward in the program:</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-124150" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.32.56-PM-1024x251.png" alt="" width="1024" height="251" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.32.56-PM-1024x251.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.32.56-PM-300x74.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.32.56-PM-768x188.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.32.56-PM-205x50.png 205w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.32.56-PM.png 1198w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p>Later on we see that there is a call to “<strong>TIFFReadEncodedPixels”</strong> which reads strip data from TIFF file and stores it into newly allocated buffer “<strong>strip_pixels</strong>” of <strong>248</strong> bytes (documentation here: <a href="http://www.libtiff.org/man/TIFFReadEncodedStrip.3t.html">http://www.libtiff.org/man/TIFFReadEncodedStrip.3t.html</a>):</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-124153" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.33.49-PM-1024x281.png" alt="" width="1024" height="281" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.33.49-PM-1024x281.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.33.49-PM-300x82.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.33.49-PM-768x211.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.33.49-PM-205x56.png 205w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.33.49-PM.png 1210w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p>To understand what this TIFF file data is, we need to again refer to TIFF file structure. We can see that there is a tag called “<strong>StripOffsets”</strong> and its value is 8, which specifies the offset of strip data inside TIFF file:</p>
<p><img loading="lazy" class="aligncenter wp-image-124159 size-large" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.34.29-PM-1024x208.png" alt="" width="1024" height="208" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.34.29-PM-1024x208.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.34.29-PM-300x61.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.34.29-PM-768x156.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.34.29-PM-205x42.png 205w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.34.29-PM.png 1204w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p>We see the following when we check data at <strong>offset 8</strong> in the TIFF file:</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-124162" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.35.10-PM-1024x465.png" alt="" width="1024" height="465" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.35.10-PM-1024x465.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.35.10-PM-300x136.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.35.10-PM-768x348.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.35.10-PM-205x93.png 205w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.35.10-PM.png 1208w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p>We see the following when we print the data in “<strong>strip_pixels</strong>” (note that it is in <strong>little endian</strong> format):</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-124165" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.35.49-PM-1024x494.png" alt="" width="1024" height="494" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.35.49-PM-1024x494.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.35.49-PM-300x145.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.35.49-PM-768x370.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.35.49-PM-205x99.png 205w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.35.49-PM.png 1182w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p>So <strong>“strip_pixels”</strong> is the actual data from the TIFF file from <strong>offset 8</strong>. This will be traversed through pointer <strong>“p”.</strong></p>
<p>Inside “<strong>ReadTIFFImage”</strong> function there are two nested for loops.</p>
<ul>
<li>The first <strong>“for loop”</strong> is responsible for iterating for “<strong>samples_per_pixel”</strong> time which is <strong>3</strong>.</li>
<li>The second <strong>“for loop”</strong> is responsible for iterating the pixel data for “<strong>image-&gt;rows</strong>” times, which is <strong>32</strong>. This second loop will be executed for <strong>32</strong> times or number of rows in the image irrespective of <strong>allocated buffer size</strong> .</li>
<li>Inside this second for loop, we can see something like this:</li>
</ul>
<p><img loading="lazy" class="aligncenter size-large wp-image-124168" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.36.36-PM-1024x191.png" alt="" width="1024" height="191" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.36.36-PM-1024x191.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.36.36-PM-300x56.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.36.36-PM-768x143.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.36.36-PM-205x38.png 205w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.36.36-PM.png 1210w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<ul>
<li>We can notice that <strong>“ImportQuantumPixel”</strong> function uses the <strong>“p”</strong> pointer to read the data from <strong>“strip_pixels”</strong> and after each call to “<strong>ImportQuantumPixel</strong>”, value of <strong>“p”</strong> will be increased by <strong>“stride”</strong>.</li>
</ul>
<p><img loading="lazy" class="aligncenter size-large wp-image-124171" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.37.35-PM-1024x194.png" alt="" width="1024" height="194" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.37.35-PM-1024x194.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.37.35-PM-300x57.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.37.35-PM-768x146.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.37.35-PM-205x39.png 205w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.37.35-PM.png 1222w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p>Here “<strong>stride</strong>” is calculated by calling function “<strong>TIFFVStripSize()</strong>” function which as per documentation returns the number of bytes in a strip with <em>nrows</em> rows of data.  In this case it is <strong>14</strong>. So, every time pointer <strong>“p”</strong> is incremented by “<strong>14”</strong> or “<strong>0xE</strong>” inside the <strong>second for loop</strong>.</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-124174" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.38.13-PM-1024x165.png" alt="" width="1024" height="165" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.38.13-PM-1024x165.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.38.13-PM-300x48.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.38.13-PM-768x124.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.38.13-PM-205x33.png 205w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.38.13-PM.png 1142w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p>If we print the <strong>image</strong> structure which is passed to “<strong>ImportQuantumPixels</strong>” function as parameter, we can see following:</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-124177" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.38.49-PM-1024x205.png" alt="" width="1024" height="205" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.38.49-PM-1024x205.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.38.49-PM-300x60.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.38.49-PM-768x154.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.38.49-PM-205x41.png 205w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.38.49-PM.png 1208w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p>Here we can notice that the <strong>columns</strong> value is <strong>3</strong>, the <strong>rows</strong> value is <strong>32</strong> and <strong>depth</strong> is <strong>9</strong>. If we check in the POC TIFF file, this has been taken from <strong>ImageWidth</strong> and <strong>ImageLength</strong> and <strong>BitsPerSample</strong> value:</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-124180" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.39.33-PM-1024x654.png" alt="" width="1024" height="654" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.39.33-PM-1024x654.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.39.33-PM-300x192.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.39.33-PM-768x490.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.39.33-PM-202x129.png 202w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.39.33-PM.png 1206w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p>Ultimately, control reaches to “<strong>ImportRGBQuantum</strong>” and then to the “<strong>PushQuantumPixel</strong>” function and one of the arguments to this function is the pixels data which is pointed by <strong>“p”</strong>. Remember that this points to the memory address which was previously allocated using the “<strong>AcquireQuantumMemory</strong>” function, and that its length is 248 byte and every time value of “p” is increased by 14.</p>
<p>The<strong> “PushQuantumPixel”</strong> function is used to read pixel data from <strong>“p”</strong> into the internal pixel data storage of <strong>ImageMagick</strong>. There is a for loop which is responsible for reading data from the provided pixels array of 248 bytes into a structure “<strong>quantum_Info</strong>”. This loop reads data from pixels incrementally and saves it in the <strong>“quantum_info-&gt;state.pixels”</strong> field.</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-124183" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.40.18-PM-1024x339.png" alt="" width="1024" height="339" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.40.18-PM-1024x339.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.40.18-PM-300x99.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.40.18-PM-768x255.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.40.18-PM-205x68.png 205w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.40.18-PM.png 1074w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p>The <strong>root cause</strong> here is that there are no proper bounds checks and the program tries to read data beyond the allocated buffer size on the heap, while reading the strip data inside a <strong>for loop</strong>.</p>
<p>This causes a crash in ImageMagick as we can see below:</p>
<h3><img loading="lazy" class="aligncenter size-large wp-image-124186" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.41.45-PM-1024x838.png" alt="" width="1024" height="838" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.41.45-PM-1024x838.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.41.45-PM-300x245.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.41.45-PM-768x628.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.41.45-PM-158x129.png 158w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.41.45-PM.png 1198w" sizes="(max-width: 1024px) 100vw, 1024px" /></h3>
<h3><strong>Root cause</strong></h3>
<p>Therefore, to summarize, the program crashes because:</p>
<ol>
<li>The program allocates 248 bytes of memory to process strip data for image, a pointer <strong>“p”</strong> points to this memory.</li>
<li>Inside a for loop this pointer is increased by “14” or “0xE” for number of rows in the image, which in this case is 32.</li>
<li>Based on this calculation, 32*14=448 bytes or more amount of memory is required but only 248 in actual memory were allocated.</li>
<li>The program tries to read data assuming total memory is of 448+ bytes, but the fact that only 248 bytes are available causes an Out of Bound memory read issue.</li>
</ol>
<h3><strong>How it was fixed?</strong></h3>
<p>If we check at the patch diff, we can see that the following changes were made to fix this issue:</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-124189" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.49.42-PM-1024x352.png" alt="" width="1024" height="352" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.49.42-PM-1024x352.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.49.42-PM-300x103.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.49.42-PM-768x264.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.49.42-PM-205x70.png 205w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.49.42-PM.png 1356w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p>Here the 2<sup>nd</sup> argument to “<strong>AcquireQuantumMemory</strong>” is multiplied by <strong>2</strong> thus increasing the total amount of memory and preventing this Out of Bound read issue from heap memory. The total memory allocated is <strong>496</strong> bytes, <strong>248*2=496</strong> bytes, as we can see below:</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-124192" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.51.25-PM-1024x952.png" alt="" width="1024" height="952" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.51.25-PM-1024x952.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.51.25-PM-300x279.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.51.25-PM-768x714.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.51.25-PM-139x129.png 139w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.51.25-PM.png 1222w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<h3><strong>Another issue with the fix:</strong></h3>
<p>A new version of ImageMagick 7.0.46 was released to fix this issue. While the patch fixes the memory allocation issue, if we check the code below, we can see that there was a call to <strong>memset</strong> which didn’t set the proper memory size to zero.</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-124195" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.54.54-PM-1024x143.png" alt="" width="1024" height="143" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.54.54-PM-1024x143.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.54.54-PM-300x42.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.54.54-PM-768x107.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.54.54-PM-205x29.png 205w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.54.54-PM.png 1130w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p>Memory was allocated <strong>extent*2*sizeof(*strip_pixels)</strong> but in this <strong>memset</strong> to <strong>0</strong> was only done for <strong>extent*sizeof(*strip_pixels).</strong> This means half of the memory was set to 0 and rest contained <strong>0xbebebebe,</strong> which is by default for ASAN new memory allocation.</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-124198" src="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.55.28-PM-1024x927.png" alt="" width="1024" height="927" srcset="/wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.55.28-PM-1024x927.png 1024w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.55.28-PM-300x272.png 300w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.55.28-PM-768x696.png 768w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.55.28-PM-142x129.png 142w, /wp-content/uploads/2021/06/Screen-Shot-2021-06-28-at-2.55.28-PM.png 1230w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p>This has since been fixed in subsequent releases of ImageMagick by using <strong>extent=2*TIFFStripSize(tiff);</strong> in the following patch:</p>
<p><a href="https://github.com/ImageMagick/ImageMagick/commit/a5b64ccc422615264287028fe6bea8a131043b59#diff-0a5eef63b187504ff513056aa8fd6a7f5c1f57b6d2577a75cff428c0c7530978" target="_blank" rel="noopener">https://github.com/ImageMagick/ImageMagick/commit/a5b64ccc422615264287028fe6bea8a131043b59#diff-0a5eef63b187504ff513056aa8fd6a7f5c1f57b6d2577a75cff428c0c7530978</a></p>
<h3><strong>Conclusion:</strong></h3>
<p>Processing various image files requires deep understanding of various file formats and thus it is possible that something may not be exactly implemented or missed. This can lead to various vulnerabilities in such image processing software. Some of this vulnerability can lead to DoS and some can lead to remote code execution affecting every installation of such popular software.</p>
<p>Fuzzing plays an important role in finding vulnerabilities often missed by developers and during testing. We at McAfee constantly fuzz various closed source as well as open source software to help secure them. We work very closely with various vendors and do responsible disclosure. This shows McAfee’s commitment towards securing the software and protecting our customers from various threats.</p>
<p>We will continue to fuzz various software and work with vendors to help mitigate risk arriving from such threats.</p>
<p>We would like to thank and appreciate ImageMagick team for quickly resolving this issue within 24 hours and releasing a new version to fix this issue.</p>
        </div>
    </div>

    <div class="wrap-section">  
        <div class="container medium">
            <h3>About the Author</h3>
        </div>
    </div>

    <div class="wrap-section padding-small bg-light-gray author-container">  
        <div class="container medium"> 


                <div class="row">
                    <div class="col-sm-2 col-xs-4 text-center">
                        <a href="/blogs/author/hardik-shah/"><img class="author" src="https://www.mcafee.com/wp-content/themes/securingtomorrow/img/author-avatar-default.jpg" /></a>
                        <ul class="social-networks">
                <li><a href="https://twitter.com/hardik05" rel="nofollow" target="_blank"><i class="symbol-twitter"></i><span>Twitter</span></a></li><li><a href="https://www.linkedin.com/in/hardik05/" rel="nofollow" target="_blank"><i class="symbol-linkedin"></i><span>LinkedIn</span></a></li>                        </ul>
                    </div>
                    <div class="col-sm-10 col-xs-8">
                        <h3 class="red"><a href="/blogs/author/hardik-shah/">Hardik Shah</a></h3>
                        <p>Hardik Shah, a Senior Research Engineer in McAfee Labs, is an experienced security researcher and technology evangelist. He has extensive experience with exploits, malware analysis, and various IPS engines. Shah enjoys figuring out ways to protect customers from the latest threats. Prior to McAfee, he worked with the IPS research team at Symantec. You can ...</p>						
                        <a href="/blogs/author/hardik-shah/" class="caret-link">Read more posts from Hardik Shah </a>
                    </div>
                </div><br/>
                                    </div>
    </div>

    <div class="wrap-section padding-top-xs">  
        <div class="container medium"> 
            <div class="row">
                            <div class="col-sm-6 col-xs-6">
            <a href="/blogs/consumer/consumer-cyber-awareness/protect-your-social-media-accounts-from-hacks-and-attacks/" rel="prev"><i class="fa fa-angle-left" aria-hidden="true"></i> Previous Article</a> 
                </div>
                <div class="col-sm-6 col-xs-6 text-right">
                </div>
            </div>
        </div>
    </div>
    <div class="wrap-section padding-top-xs"> 
        <div class="container medium">
                    <p class="small rule">Categories: <a href="/blogs/other-blogs/mcafee-labs/" rel="category tag">McAfee Labs</a><br /> 
            </p>	

        </div>		 
    </div>
    <div class="container medium">
                    <ol class="commentlist">
                    </ol>
             
    </div>
    
    <div class="wrap-section padding-top-small">  
        <div class="container medium">
                                </div>
    </div>
        <div class="wrap-section bg-red bg-image padding-medium" id="subscribe">
      <div class="container medium">
        <div class="row">
          <div class="col-sm-12">
            <div class="cta-component text-center">
              <h3>Subscribe to McAfee Securing Tomorrow Blogs</h3>
                         <form method="get" action="/blogs/subscribe/" class="form-inline">
            
              <input type="text" placeholder="Email address" name="subscriber_email" />
          
            <button type="submit" class="btn transparent">Subscribe</button>
          </form>
              
            </div>
          </div>
        </div>
      </div>
    </div>

</main>
<!--Footer of en-us starts here --> 
    
	<aside class="tools">
		<a href="#wrapper" class="back-to-top">Back to top</a>
	</aside>
  
  <div class="textwidget custom-html-widget"><div class="wrap-section padding-bottom-medium padding-top-small bg-dark-gray" id="footer">
    <div class="container medium">           
      <div class="row">
         <div class="col-sm-6 breadcrumb">
        	<ul class="breadcrumb-list">
        		<li><a class="symbols-label first" href="/blogs"><i class="symbol-shield"></i><span>McAfee Home</span></a></li>
        		<li><a class="symbols-label" href="/blogs"><i class="symbol-arrow-forward"></i><span>Securing Tomorrow</span></a></li>
					 </ul>
				</div>
        <div class="col-sm-6 social">
          <!-- <a id="usbl-integrated-button" class="symbols-label" href=""><i class="symbol-feedback"></i><span>Feedback</span></a> -->
          <ul class="social-networks">
            <li><a href="https://twitter.com/mcafee" title="Twitter" target="_blank" rel="noopener"><i class="symbol-twitter"></i><span>Twitter</span></a></li>
            <li><a href="http://www.facebook.com/mcafee" title="Facebook" target="_blank" rel="noopener"><i class="symbol-facebook"></i><span>Facebook</span></a></li>
            <li><a href="https://www.linkedin.com/company/2336?trk=prof-exp-company-name" title="LinkedIn" target="_blank" rel="noopener"><i class="symbol-linkedin"></i><span>LinkedIn</span></a></li>
            <li><a href="http://www.youtube.com/mcafee" title="YouTube" target="_blank" rel="noopener"><i class="symbol-youtube"></i><span>YouTube</span></a></li>
            <li><a href="/blogs/" title="Blog" target="_blank" rel="noopener"><i class="symbol-blog"></i><span>Blog</span></a></li>
					</ul>
        </div>
      </div>
      <hr />
      <div class="row">
        <div class="col-sm-3">
          <a class="symbols-label" href="/enterprise/en-us/about/region-selector.html"><i class="symbol-language"></i><span>United States / English</span></a>
        </div>
        <div class="col-sm-9">
           <a href="//www.scanalert.com/RatingVerify?ref=www.mcafee.com" target="_blank" class="mcafee-secure" rel="noopener"><img src="https://www.mcafee.com/enterprise/en-us/img/v1/common/logo-mcafee-secure.svg" alt="McAfee SECURE"/></a>
          <ul class="footer-menu">
            <li><a href="/enterprise/en-us/about/legal/privacy.html">Privacy</a></li>
            <li><a href="/enterprise/en-us/about/legal/notices.html">Legal Notices</a></li>
            <li><a href="/enterprise/en-us/about/legal/contracts-terms.html">Legal Contracts &amp; Terms</a></li>
            <li><a href="/enterprise/en-us/site-map.html">Site Map</a></li>
            <li>Copyright ©2020 McAfee, LLC</li>
          </ul>
        </div>
      </div>          
    </div>            	
  </div>
</div></div>


<script type="text/javascript"  src="/fY7e3/F/h0/V4nA/uB8aaunf/EQ7brwVhuE/LlUCAg/M2x/PUW4sGzI"></script><link rel="stylesheet" type="text/css" href="/_sec/cp_challenge/sec-3-5.css">
            <script src="/_sec/cp_challenge/sec-cpt-3-5.js" async defer></script>
            <div id="sec-overlay" style="display:none;">
            <div id="sec-container">
            </div>
          </div></body>	
<script type="text/javascript">
   if ($('div.author-block .meta').length > 0) {
      utag_data.tm_local_blogs_author = $('div.author-block .meta').text().split(' on ')[0].replace("By","").trim();
    }
    (function(a,b,c,d){
    a='//tags.tiqcdn.com/utag/mcafee/consumer-main/prod/utag.js'; // Note: Please use prod for production version and dev for dev version before release
    b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;
    a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a);
    })();
</script>

<script type='text/javascript' src='/wp-content/plugins/metronet-profile-picture/js/mpp-frontend.js?ver=2.5.0' id='mpp_gutenberg_tabs-js'></script>
<script type='text/javascript' id='hlst-extend-js-before'>
/* Highlight Search Terms 1.5 ( RavanH - http://status301.net/wordpress-plugins/highlight-search-terms/ ) */
var hlst_query = []; var hlst_areas = ["#groups-dir-list","#members-dir-list","div.bbp-topic-content,div.bbp-reply-content,li.bbp-forum-info,.bbp-topic-title,.bbp-reply-title","article","div.hentry","div.post","#content","#main","div.content","#middle","#container","div.container","div.page","#wrapper","body"];
</script>
<script type='text/javascript' src='/wp-content/plugins/highlight-search-terms/hlst-extend.min.js?ver=1.5' id='hlst-extend-js'></script>
<script type='text/javascript' src='/wp-content/plugins/social-polls-by-opinionstage/public/js/shortcodes.js?ver=19.7.9' id='opinionstage-shortcodes-js'></script>
<script type='text/javascript' id='wpmm_js-js-extra'>
/* <![CDATA[ */
var ajax_objects = {"ajaxurl":"https:\/\/www.mcafee.com\/wp-admin\/admin-ajax.php","redirecturl":"https:\/\/www.mcafee.com\/blogs\/","loadingmessage":"Sending user info, please wait..."};
var wpmm_object = {"ajax_url":"https:\/\/www.mcafee.com\/wp-admin\/admin-ajax.php","wpmm_responsive_breakpoint":"767px","wpmm_disable_mobile":"false"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/wp-megamenu/assets/js/wpmm.js?ver=1.3.7' id='wpmm_js-js'></script>
<script type='text/javascript' src='/wp-content/themes/securingtomorrow/js/theme-script.js?ver=5.6.3' id='wp-bootstrap-starter-themejs-js'></script>
<script type='text/javascript' src='/wp-content/themes/securingtomorrow/js/skip-link-focus-fix.min.js?ver=20151215' id='wp-bootstrap-starter-skip-link-focus-fix-js'></script>
<script type='text/javascript' src='/wp-content/plugins/super-socializer/js/front/social_login/general.js?ver=7.13.16' id='the_champ_ss_general_scripts-js'></script>
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=5.6.3' id='wp-embed-js'></script>
	
<script src="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js?ver=10faaf528e636a046163bdb6753031b2"></script>
<script src="/wp-content/themes/securingtomorrow/js/jquery-lib.js"></script>
<script src="/wp-content/themes/securingtomorrow/js/main.js"></script>
<script src="/wp-content/themes/securingtomorrow/js/general_footer.js"></script>
<!-- Consumer Facebook Pixel Code -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '187610925152304');
  fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=187610925152304&ev=PageView&noscript=1"/></noscript>
<!-- End Facebook Pixel Code -->

<!-- Start linkedIn pixel -->
<script type="text/javascript">
_linkedin_partner_id = "68395";
window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || [];
window._linkedin_data_partner_ids.push(_linkedin_partner_id);
</script><script type="text/javascript">
(function(){var s = document.getElementsByTagName("script")[0];
var b = document.createElement("script");
b.type = "text/javascript";b.async = true;
b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js";
s.parentNode.insertBefore(b, s);})();
</script>
<noscript>
<img height="1" width="1" style="display:none;" alt="" src="https://dc.ads.linkedin.com/collect/?pid=68395&fmt=gif" />
</noscript>
<!-- End linkedIn pixel -->

<!-- Twitter universal website tag code -->
<script>
!function(e,t,n,s,u,a){e.twq||(s=e.twq=function(){s.exe?s.exe.apply(s,arguments):s.queue.push(arguments);
},s.version='1.1',s.queue=[],u=t.createElement(n),u.async=!0,u.src='//static.ads-twitter.com/uwt.js',
a=t.getElementsByTagName(n)[0],a.parentNode.insertBefore(u,a))}(window,document,'script');
// Insert Twitter Pixel ID and Standard Event data below
twq('init','nxlgc');
twq('track','PageView');
</script>
<!-- Twitter universal website tag code -->

<script>
/* <![CDATA[ */
var google_conversion_id = 975085349;
var google_custom_params = window.google_tag_params;
var google_remarketing_only = true;
/* ]]> */
document.write('\x3Cscript type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js">\x3C/script>');
//document.write('\x3Cnoscript>\x3Cimg height="1" width="1" style="border-style:none;display:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/975085349/?guid=ON&script=0"/>\x3C/noscript>');
</script>

<!-- Enterprise Facebook Pixel Code -->
<script>
// load Facebook
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '766537420057144');
fbq('track', "PageView");

//document.write('\x3Cnoscript>\x3Cimg height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=766537420057144&ev=PageView&noscript=1" />\x3C/noscript>');
</script>
<!-- Facebook Pixel Code -->

<!-- Adobe Launch START -->
<script src="//assets.adobedtm.com/launch-ENc117a6a508e14a879398dd6f37ed54a3.min.js"></script>
<!-- Adobe Launch END -->
<script>_satellite.pageBottom()</script>
</html>


<style>
    .commentlist {
        display: none;
    }
</style>
<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me - Debug: cached@1625084085 -->