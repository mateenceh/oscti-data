<!DOCTYPE html>
<html lang="en-US">

    <head>

        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <link rel="profile" href="https://gmpg.org/xfn/11">
        <link rel="pingback" href="https://www.mcafee.com/xmlrpc.php">
                    <link rel="canonical" href="https://www.mcafee.com/blogs/other-blogs/mcafee-labs/my-adventures-hacking-the-iparcelbox/">
                            <link rel="shortcut icon" href="https://www.mcafee.com/enterprise/en-us/img/favicon.ico">
        <!--<link rel="stylesheet" href="/wp-content/themes/securingtomorrow/css/responsive/blog.css" type="text/css">
        <link rel="stylesheet" href="/wp-content/themes/securingtomorrow/css/responsive/main.css" type="text/css">-->
        <link rel="stylesheet" href="/enterprise/www/css/main.min.css" type="text/css">
       
        	<script type="text/javascript">function theChampLoadEvent(e){var t=window.onload;if(typeof window.onload!="function"){window.onload=e}else{window.onload=function(){t();e()}}}</script>
		<script type="text/javascript">var theChampDefaultLang = 'en_US', theChampCloseIconPath = 'https://www.mcafee.com/wp-content/plugins/super-socializer/images/close.png';</script>
		<script> var theChampSiteUrl = 'https://www.mcafee.com/blogs', theChampVerified = 0, theChampEmailPopup = 0; </script>
		<style type="text/css">.the_champ_horizontal_sharing .theChampSharing{
					color: #fff;
				border-width: 0px;
		border-style: solid;
		border-color: transparent;
	}
		.the_champ_horizontal_sharing .theChampTCBackground{
		color:#666;
	}
		.the_champ_horizontal_sharing .theChampSharing:hover{
				border-color: transparent;
	}
	.the_champ_vertical_sharing .theChampSharing{
					color: #fff;
				border-width: 0px;
		border-style: solid;
		border-color: transparent;
	}
		.the_champ_vertical_sharing .theChampTCBackground{
		color:#666;
	}
		.the_champ_vertical_sharing .theChampSharing:hover{
				border-color: transparent;
	}
	@media screen and (max-width:783px){.the_champ_vertical_sharing{display:none!important}}div.heateor_ss_mobile_footer{display:none;}@media screen and (max-width:783px){i.theChampTCBackground{background-color:white!important}div.the_champ_bottom_sharing{width:100%!important;left:0!important;}div.the_champ_bottom_sharing li{width:12.5% !important;}div.the_champ_bottom_sharing .theChampSharing{width: 100% !important;}div.the_champ_bottom_sharing div.theChampTotalShareCount{font-size:1em!important;line-height:28px!important}div.the_champ_bottom_sharing div.theChampTotalShareText{font-size:.7em!important;line-height:0px!important}div.heateor_ss_mobile_footer{display:block;height:40px;}.the_champ_bottom_sharing{padding:0!important;display:block!important;width: auto!important;bottom:-2px!important;top: auto!important;}.the_champ_bottom_sharing .the_champ_square_count{line-height: inherit;}.the_champ_bottom_sharing .theChampSharingArrow{display:none;}.the_champ_bottom_sharing .theChampTCBackground{margin-right: 1.1em !important}}</style>
	
	<!-- This site is optimized with the Yoast SEO plugin v14.2 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>My Adventures Hacking the iParcelBox | McAfee Blogs</title>
	<meta name="description" content="In 2019, McAfee Advanced Threat Research (ATR) disclosed a vulnerability in a product called BoxLock. Sometime after this, the CEO of iParcelBox, a U.K." />
	<meta name="robots" content="index, follow" />
	<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="My Adventures Hacking the iParcelBox | McAfee Blogs" />
	<meta property="og:description" content="In 2019, McAfee Advanced Threat Research (ATR) disclosed a vulnerability in a product called BoxLock. Sometime after this, the CEO of iParcelBox, a U.K." />
	<meta property="og:url" content="/blogs/other-blogs/mcafee-labs/my-adventures-hacking-the-iparcelbox/" />
	<meta property="og:site_name" content="McAfee Blogs" />
	<meta property="article:publisher" content="https://www.facebook.com/mcafee" />
	<meta property="article:published_time" content="2020-06-18T07:01:48+00:00" />
	<meta property="article:modified_time" content="2020-06-20T10:32:14+00:00" />
	<meta property="og:image" content="https://www.mcafee.com/wp-content/uploads/2020/06/box1.png" />
	<meta property="og:image:width" content="800" />
	<meta property="og:image:height" content="533" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:creator" content="@mcafee" />
	<meta name="twitter:site" content="@mcafee" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://www.mcafee.com/blogs/#website","url":"https://www.mcafee.com/blogs/","name":"McAfee Blogs","description":"Securing Tomorrow. Today.","potentialAction":[{"@type":"SearchAction","target":"https://www.mcafee.com/blogs/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/my-adventures-hacking-the-iparcelbox/#primaryimage","inLanguage":"en-US","url":"/wp-content/uploads/2020/06/box1.png","width":800,"height":533},{"@type":"WebPage","@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/my-adventures-hacking-the-iparcelbox/#webpage","url":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/my-adventures-hacking-the-iparcelbox/","name":"My Adventures Hacking the iParcelBox | McAfee Blogs","isPartOf":{"@id":"https://www.mcafee.com/blogs/#website"},"primaryImageOfPage":{"@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/my-adventures-hacking-the-iparcelbox/#primaryimage"},"datePublished":"2020-06-18T07:01:48+00:00","dateModified":"2020-06-20T10:32:14+00:00","author":{"@id":"https://www.mcafee.com/blogs/#/schema/person/e66d604e9acc14787d29ba40c9b0eaac"},"description":"In 2019, McAfee Advanced Threat Research (ATR) disclosed a vulnerability in a product called BoxLock. Sometime after this, the CEO of iParcelBox, a U.K.","breadcrumb":{"@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/my-adventures-hacking-the-iparcelbox/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://www.mcafee.com/blogs/other-blogs/mcafee-labs/my-adventures-hacking-the-iparcelbox/"]}]},{"@type":"BreadcrumbList","@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/my-adventures-hacking-the-iparcelbox/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"/blogs/","url":"/blogs/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"/blogs/other-blogs/","url":"/blogs/other-blogs/","name":"Other Blogs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"/blogs/other-blogs/mcafee-labs/","url":"/blogs/other-blogs/mcafee-labs/","name":"McAfee Labs"}},{"@type":"ListItem","position":4,"item":{"@type":"WebPage","@id":"/blogs/other-blogs/mcafee-labs/my-adventures-hacking-the-iparcelbox/","url":"/blogs/other-blogs/mcafee-labs/my-adventures-hacking-the-iparcelbox/","name":"My Adventures Hacking the iParcelBox"}}]},{"@type":["Person"],"@id":"https://www.mcafee.com/blogs/#/schema/person/e66d604e9acc14787d29ba40c9b0eaac","name":"Sam Quinn","description":"Sam Quinn is a Security Researcher on McAfee\u2019s Advanced Threat Research team , focused on finding new vulnerabilities in both software and hardware. Sam has a focus on IOT and embedded devices with knowledge in the fields of reverse engineering and penetration testing.","sameAs":["http://www.linkedin.com/in/sam--quinn"]}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//stackpath.bootstrapcdn.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="McAfee Blogs &raquo; Feed" href="https://www.mcafee.com/blogs/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.4.2"}};
			/*! This file is auto-generated */
			!function(e,a,t){var r,n,o,i,p=a.createElement("canvas"),s=p.getContext&&p.getContext("2d");function c(e,t){var a=String.fromCharCode;s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,e),0,0);var r=p.toDataURL();return s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,t),0,0),r===p.toDataURL()}function l(e){if(!s||!s.fillText)return!1;switch(s.textBaseline="top",s.font="600 32px Arial",e){case"flag":return!c([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])&&(!c([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!c([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]));case"emoji":return!c([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340])}return!1}function d(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(i=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},o=0;o<i.length;o++)t.supports[i[o]]=l(i[o]),t.supports.everything=t.supports.everything&&t.supports[i[o]],"flag"!==i[o]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[i[o]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(r=t.source||{}).concatemoji?d(r.concatemoji):r.wpemoji&&r.twemoji&&(d(r.twemoji),d(r.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='/wp-includes/css/dist/block-library/style.min.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_poll_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/poll/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_trivia_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/trivia/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_personality_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/personality/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_survey_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/survey/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_slideshow_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/slideshow/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_form_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/form/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='mpp_gutenberg-css'  href='/wp-content/plugins/metronet-profile-picture/dist/blocks.style.build.css?ver=2.3.8' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='/wp-includes/css/dashicons.min.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='wpmm_css-css'  href='/wp-content/plugins/wp-megamenu/assets/css/wpmm.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='wp_megamenu_generated_css-css'  href='/wp-content/uploads/wp-megamenu/wp-megamenu.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='featuresbox_css-css'  href='/wp-content/plugins/wp-megamenu/addons/wpmm-featuresbox/wpmm-featuresbox.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='postgrid_css-css'  href='/wp-content/plugins/wp-megamenu/addons/wpmm-gridpost/wpmm-gridpost.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wp-bootstrap-pro-fontawesome-cdn-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='open-sans-google-font-css'  href='https://fonts.googleapis.com/css?family=Open+Sans%3A300%2C400&#038;ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='theme-css-css'  href='/wp-content/themes/securingtomorrow/style.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='the_champ_frontend_css-css'  href='/wp-content/plugins/super-socializer/css/front.css?ver=7.12.37' type='text/css' media='all' />
<link rel='stylesheet' id='addtoany-css'  href='/wp-content/plugins/add-to-any/addtoany.min.css?ver=1.15' type='text/css' media='all' />
<link rel='stylesheet' id='poppins-css'  href='//fonts.googleapis.com/css?family=Poppins%3A100%2C100italic%2C200%2C200italic%2C300%2C300italic%2Cregular%2Citalic%2C500%2C500italic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic%2C900%2C900italic&#038;ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='oswald-css'  href='//fonts.googleapis.com/css?family=Oswald%3A200%2C300%2Cregular%2C500%2C600%2C700&#038;ver=1.3.1' type='text/css' media='all' />
<script type='text/javascript' src='/wp-content/plugins/jquery-updater/js/jquery-3.4.1.min.js?ver=3.4.1'></script>
<script type='text/javascript' src='/wp-content/plugins/add-to-any/addtoany.min.js?ver=1.1'></script>
<script type='text/javascript' src='/wp-content/plugins/wp-megamenu/addons/wpmm-featuresbox/wpmm-featuresbox.js?ver=1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var postgrid_ajax_load = {"ajax_url":"https:\/\/www.mcafee.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/wp-megamenu/addons/wpmm-gridpost/wpmm-gridpost.js?ver=1'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='/wp-content/themes/securingtomorrow/js/html5.js?ver=3.7.0'></script>
<![endif]-->
<link rel='https://api.w.org/' href='https://www.mcafee.com/blogs/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.mcafee.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.mcafee.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.2" />
<link rel='shortlink' href='https://www.mcafee.com/blogs/?p=101923' />
<link rel="alternate" type="application/json+oembed" href="https://www.mcafee.com/blogs/wp-json/oembed/1.0/embed?url=%2Fblogs%2Fother-blogs%2Fmcafee-labs%2Fmy-adventures-hacking-the-iparcelbox%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://www.mcafee.com/blogs/wp-json/oembed/1.0/embed?url=%2Fblogs%2Fother-blogs%2Fmcafee-labs%2Fmy-adventures-hacking-the-iparcelbox%2F&#038;format=xml" />

<script data-cfasync="false">
window.a2a_config=window.a2a_config||{};a2a_config.callbacks=[];a2a_config.overlays=[];a2a_config.templates={};
(function(d,s,a,b){a=d.createElement(s);b=d.getElementsByTagName(s)[0];a.async=1;a.src="https://static.addtoany.com/menu/page.js";b.parentNode.insertBefore(a,b);})(document,"script");
</script>
<script>
var utag_data = {
tm_global_pagename:"",
tm_global_page_publish_date:"",
tm_global_businessunit:"consumer",
tm_global_sitesection:"",
tm_global_sitesection_level2:"",
tm_global_sitesection_level3:"",
tm_global_platform:"web",
tm_global_culture_code:"en-us",
tm_global_country:"united states",
tm_global_geo:"na",
tm_global_channel:"direct",
tm_global_affiliate_id:"",
tm_global_affiliate_name:"",
tm_global_campaign_id:"",
tm_global_page_version:"",
tm_global_pageurl:location.href,
tm_global_clientid :"",
tm_global_trafficsource:"",
tm_global_sourcetype:"blog",
tm_global_wssversion:"",
tm_global_coe:"",
tm_global_coe_level2:"",
tm_local_blogs_author:""
}
var sec=location.pathname.replace("/blogs","").split("/"); utag_data.tm_global_pagename="[consumer:web]";
if(sec.length > 2) {
for(i=1;i<sec.length-1;i++) {
utag_data.tm_global_pagename+="|"+sec[i];
if(i==1){utag_data.tm_global_sitesection=sec[i]}
if(i==2){utag_data.tm_global_sitesection_level2=sec[i]}
if(i==3){utag_data.tm_global_sitesection_level3=sec[i]}
}
}
else {
utag_data.tm_global_sitesection="Homepage"
utag_data.tm_global_pagename+="|Homepage"
}

var today = new Date(); var dd = today.getDate(); var mm = today.getMonth() + 1; var yyyy = today.getFullYear();
if (dd < 10) { dd = '0' + dd;    } 
if (mm < 10) {mm = '0' + mm;  } 
utag_data.tm_global_page_publish_date = dd + '/' + mm + '/' + yyyy;

</script>

<script>
	var ISOTOPE_CACHE 				=  [];
	var ISOTOPE_AJAX_URL 			= 'https://www.mcafee.com/wp-admin/admin-ajax.php';
	var ISOTOPE_AJAX_URL_ENDPOINT 	= 'https://www.mcafee.com/wp-content/plugins/ae-isotope/endpoint.php';
	var ISOTOPE_AJAX_ITEMS			= 25;
	var ISOTOPE_CURRENT_CATEGORY	= '';
</script>		<meta property="fb:app_id" content="346056175795920" />
					<meta property="fb:admins" content="100007220654854" />
			<style type="text/css">.wp-megamenu-wrap .wpmm-nav-wrap > ul.wp-megamenu li.wpmm_dropdown_menu ul.wp-megamenu-sub-menu li.menu-item-has-children.wp-megamenu-item-101284.wpmm-submenu-right > ul.wp-megamenu-sub-menu {left: 100%;}</style><style type="text/css"></style><link rel="icon" href="/wp-content/uploads/2018/11/cropped-favicon-32x32.png" sizes="32x32" />
<link rel="icon" href="/wp-content/uploads/2018/11/cropped-favicon-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="/wp-content/uploads/2018/11/cropped-favicon-180x180.png" />
<meta name="msapplication-TileImage" content="/wp-content/uploads/2018/11/cropped-favicon-270x270.png" />
         <link rel="stylesheet" href="/enterprise/www/css/blog.css" type="text/css">
                <script type="text/javascript">
            var digitalData = {"page":{"pageInfo":{"pageName":"other-blogs:mcafee-labs:my-adventures-hacking-the-iparcelbox","pageNameGlobal":"my-adventures-hacking-the-iparcelbox","pageLanguage":"English","pageType":"","country":"us","geo":"NA","onsiteSearchTerm":"","onsiteSearchType":"","category":{"category":"other-blogs","subCategory1":"mcafee-labs"},"author":"Sam Quinn","pubDate":"Jun 18, 2020","metaData":{"keywords":""}}},"user":{"userInfo":{"ip":"161.69.31.4"}}}        </script>
                <script type='application/ld+json'>{
            "@context": "http://schema.org",
            "@type": "Article",
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/my-adventures-hacking-the-iparcelbox/"
            },
           "headline": "My Adventures Hacking the iParcelBox",
            "image": ["https://www.mcafee.com/wp-content/uploads/2020/06/box1.png"],	
            "datePublished": "2020-06-18",
            "dateModified": "Jun 20, 2020",
            "author": {
                "@type": "Person",           
                "name": ["Sam Quinn"]            
            },
            "publisher": {
                "@type": "Organization",
                "name": "McAfee",
                "logo": {
                    "@type": "ImageObject",
                    "url": "https://www.mcafee.com/enterprise/en-us/img/logos/mcafee-logo.png"
                }
            },
            "description": "In 2019, McAfee Advanced Threat Research (ATR) disclosed a vulnerability in a product called BoxLock. Sometime after this, the CEO of iParcelBox, a U.K. company, reached out to us and offered to send a few of their products to test. While this isn’t the typical M.O. for our research we applaud the company for being proactive"        
            }
        </script>
        <style>
            #wp-megamenu-blog>.wpmm-nav-wrap ul.wp-megamenu>li>a{
                color:#ffffff !important;
            }
        </style> 
    
    <script>!function(){function o(n,i){if(n&&i)for(var r in i)i.hasOwnProperty(r)&&(void 0===n[r]?n[r]=i[r]:n[r].constructor===Object&&i[r].constructor===Object?o(n[r],i[r]):n[r]=i[r])}try{var n=decodeURIComponent("%7B%20%22BW%22%3A%20%7B%20%22test_https%22%3A%20true%20%7D%20%7D");if(n.length>0&&window.JSON&&"function"==typeof window.JSON.parse){var i=JSON.parse(n);void 0!==window.BOOMR_config?o(window.BOOMR_config,i):window.BOOMR_config=i}}catch(r){window.console&&"function"==typeof window.console.error&&console.error("mPulse: Could not parse configuration",r)}}();</script>
                          <script>!function(a){var e="https://s.go-mpulse.net/boomerang/",t="addEventListener";if("False"=="True")a.BOOMR_config=a.BOOMR_config||{},a.BOOMR_config.PageParams=a.BOOMR_config.PageParams||{},a.BOOMR_config.PageParams.pci=!0,e="https://s2.go-mpulse.net/boomerang/";if(window.BOOMR_API_key="LXNDQ-3SP7Y-P3JVN-Y4HAH-VQNKC",function(){function n(e){a.BOOMR_onload=e&&e.timeStamp||(new Date).getTime()}if(!a.BOOMR||!a.BOOMR.version&&!a.BOOMR.snippetExecuted){a.BOOMR=a.BOOMR||{},a.BOOMR.snippetExecuted=!0;var i,_,o,r=document.createElement("iframe");if(a[t])a[t]("load",n,!1);else if(a.attachEvent)a.attachEvent("onload",n);r.src="javascript:void(0)",r.title="",r.role="presentation",(r.frameElement||r).style.cssText="width:0;height:0;border:0;display:none;",o=document.getElementsByTagName("script")[0],o.parentNode.insertBefore(r,o);try{_=r.contentWindow.document}catch(O){i=document.domain,r.src="javascript:var d=document.open();d.domain='"+i+"';void(0);",_=r.contentWindow.document}_.open()._l=function(){var a=this.createElement("script");if(i)this.domain=i;a.id="boomr-if-as",a.src=e+"LXNDQ-3SP7Y-P3JVN-Y4HAH-VQNKC",BOOMR_lstart=(new Date).getTime(),this.body.appendChild(a)},_.write("<bo"+'dy onload="document._l();">'),_.close()}}(),"".length>0)if(a&&"performance"in a&&a.performance&&"function"==typeof a.performance.setResourceTimingBufferSize)a.performance.setResourceTimingBufferSize();!function(){if(BOOMR=a.BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},!BOOMR.plugins.AK){var e=""=="true"?1:0,t="",n="fb23dtlikiwjgycyd43a-f-c11cd0cd4-clientnsv4-s.akamaihd.net",i={"ak.v":"30","ak.cp":"108209","ak.ai":parseInt("250743",10),"ak.ol":"0","ak.cr":7,"ak.ipv":4,"ak.proto":"http/1.1","ak.rid":"1c3e2ce3","ak.r":37116,"ak.a2":e,"ak.m":"b","ak.n":"essl","ak.bpcip":"40.117.177.0","ak.cport":41928,"ak.gh":"23.200.158.136","ak.quicv":"","ak.tlsv":"tls1.3","ak.0rtt":"","ak.csrc":"-","ak.acc":"reno","ak.t":"1616387894","ak.ak":"hOBiQwZUYzCg5VSAfCLimQ==qGXtvRwK/TMVCt9INeY21qXWTfEHBgSNtteer0B1zvISC0LxWXIHpdAQ44IrwOAPUnTw1B9P1bqDr6/prInhoFri5nx6AF5qt3oFoRgFrV9OSh4UrYsR5Z1mR+sHAw5LVsjr96ja/S8sZHb5wbQ9RNBOGndQZxPyT9x3jdKEwv/mHfMJdXXyFkYgU6DDwBs7JFe1hZ39XAEWkR3mnb2crooNDuFkWhtfxX7cKOdRgnli/9jPeqikw55faHqwcMutAZ7fQ+mVPEfm3Gfd+vXWcR10nztq36NUN6kW/9i9huVg5jEXlIjO4DLxZ1roA7bmIN9hQF4Jrvx8REfLvNCYB2MmFUrKToShPODHOyXMMmfNBVu+j9GLt8RFwM54rNFFWumTdAE6FNpnwKO5eSpdf426ZvSYmk1bbGWx24wWPAw=","ak.pv":"141","ak.dpoabenc":""};if(""!==t)i["ak.ruds"]=t;var _={i:!1,av:function(e){var t="http.initiator";if(e&&(!e[t]||"spa_hard"===e[t]))i["ak.feo"]=void 0!==a.aFeoApplied?1:0,BOOMR.addVar(i)},rv:function(){var a=["ak.bpcip","ak.cport","ak.cr","ak.csrc","ak.gh","ak.ipv","ak.m","ak.n","ak.ol","ak.proto","ak.quicv","ak.tlsv","ak.0rtt","ak.r","ak.acc","ak.t"];BOOMR.removeVar(a)}};BOOMR.plugins.AK={akVars:i,akDNSPreFetchDomain:n,init:function(){if(!_.i){var a=BOOMR.subscribe;a("before_beacon",_.av,null,null),a("onbeacon",_.rv,null,null),_.i=!0}return this},is_complete:function(){return!0}}}}()}(window);</script></head>

    <body  class="post-template-default single single-post postid-101923 single-format-standard wp-megamenu" id="short-header">
        <script src="/wp-content/themes/securingtomorrow/js/header_enterprise.js"></script>
        <div id="wrapper">
            <div class="textwidget custom-html-widget"><style>
	.headerbarContainer {
    background: rgba(0,0,0,0.9);
}
</style>
<header id="header">  
	<div class="headerbarContainer">
		<div class="headerbarContent">
			<div class="logo">
				 <img src="https://www.mcafee.com/enterprise/en-us/img/icons/logo-white.svg" alt="McAfee Logo"/>
			</div>
			<div class="quicklinks">
			 	<a class="symbols-label" href="https://www.mcafee.com/consumer/en-us/store/m0/index.html"><span>For Home</span></a>
			 	<a class="symbols-label" href="/enterprise/en-us/home.html"><span>For Enterprise</span></a>
			 	<a class="symbols-label" href="/enterprise/en-us/global-contact-us.html"><i class="symbol-contact"></i></a>
			</div>
		</div>
	</div>
</header>



<style>


@media screen and (min-width: 1025px) {
.hero{height: 756px !important;}
.hero.medium {
    min-height: 0;
    height: 640px  !important;
}
.hero.small {
    min-height: 0;
    height: 510px  !important;
}
.hero.title {
    height: 350px  !important;
}
	}
</style> 
<script>
$("document").ready(function(){
    $(".hero.title h1").each(function() {
        if ($(this).text().length > 50) {
            $(this).addClass("pt")
        }
    });
});
</script></div>  
		
<section class="hero title">
    <div class="bg-stretch">
        <img src="https://www.mcafee.com/wp-content/themes/securingtomorrow/img/light-shield-pattern.png" alt="">
    </div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-12 col-xs-12">
                <h1>My Adventures Hacking the iParcelBox</h1>
            </div>
        </div>
    </div>
</section>

<main id="main">

    <nav class="anchor-links">
        <div class="container medium">
            <div style="float:left">
<nav id="wp-megamenu-blog" class="wp-megamenu-wrap   ">
			<div class="wpmm-fullwidth-wrap"></div>
			<div class="wpmm-nav-wrap wpmm-main-wrap-blog">
				<a href="javascript:;" class="wpmm_mobile_menu_btn show-close-icon"><i class="fa fa-bars"></i> Menu</a> 
					<ul id="menu-mcafee-blog-navigation-new-05020" class="wp-megamenu" ><li id="wp-megamenu-item-101279" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101279  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#">Consumer <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-72235732105292601" class="wpmm-row wp-megamenu-item-72235732105292601 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-6455673079127746224" class="wpmm-col wpmm-col-12 wp-megamenu-item-6455673079127746224 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101279 wpmm-submenu-right"><div class="menu-consumer-category-container"><ul id="menu-consumer-category" class="menu"><li id="menu-item-97453" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97453"><a href="/blogs/consumer/hackable/">Hackable? Podcast</a></li>
<li id="menu-item-97424" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97424"><a href="/blogs/consumer/consumer-threat-notices/">Consumer Threat Notices</a></li>
<li id="menu-item-97425" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97425"><a href="/blogs/consumer/family-safety/">Family Safety</a></li>
<li id="menu-item-97426" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97426"><a href="/blogs/consumer/identity-protection/">Identity Protection</a></li>
<li id="menu-item-97427" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97427"><a href="/blogs/consumer/mobile-and-iot-security/">Mobile and IoT Security</a></li>
<li id="menu-item-101334" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-101334"><a href="/blogs/consumer/">All Consumer Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-101280" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101280  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#">Enterprise <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-1773782748351816586" class="wpmm-row wp-megamenu-item-1773782748351816586 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-4190045446434762497" class="wpmm-col wpmm-col-12 wp-megamenu-item-4190045446434762497 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101280 wpmm-submenu-right"><div class="menu-enterprise-category-container"><ul id="menu-enterprise-category" class="menu"><li id="menu-item-97421" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97421"><a href="/blogs/enterprise/cloud-security/">Cloud Security</a></li>
<li id="menu-item-97451" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97451"><a href="/blogs/enterprise/endpoint-security/">Endpoint Security</a></li>
<li id="menu-item-97422" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97422"><a href="/blogs/enterprise/security-operations/">Security Operations</a></li>
<li id="menu-item-97452" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97452"><a href="/blogs/enterprise/data-security/">Data Security</a></li>
<li id="menu-item-101336" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-101336"><a href="/blogs/enterprise/">All Enterprise Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-101281" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101281  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#">Corporate <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-3503422651760237451" class="wpmm-row wp-megamenu-item-3503422651760237451 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-9.6398873834191E+18" class="wpmm-col wpmm-col-12 wp-megamenu-item-9.6398873834191E+18 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101281 wpmm-submenu-right"><div class="menu-other-blogs-container"><ul id="menu-other-blogs" class="menu"><li id="menu-item-97442" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97442"><a href="/blogs/other-blogs/executive-perspectives/">Executive Perspectives</a></li>
<li id="menu-item-97441" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-97441"><a href="/blogs/other-blogs/mcafee-labs/">McAfee Labs</a></li>
<li id="menu-item-97443" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97443"><a href="/blogs/other-blogs/life-at-mcafee/">Life at McAfee</a></li>
<li id="menu-item-97440" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97440"><a href="/blogs/other-blogs/podcast/">Podcast</a></li>
<li id="menu-item-97444" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97444"><a href="/blogs/other-blogs/mcafee-partners/">McAfee Partners</a></li>
<li id="menu-item-101340" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-101340"><a href="/blogs/other-blogs/">All Corporate Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-101282" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101282  wpmm_dropdown_menu  wpmm-fadeindown wpmm-submenu-right"><a href="/blogs/authors/">Authors</a></li>
<li id="wp-megamenu-item-101283" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101283  wpmm_dropdown_menu  wpmm-fadeindown wpmm-submenu-right"><a href="/blogs/subscribe/">Subscribe</a></li>
<li id="wp-megamenu-item-101284" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101284  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#"><span class='wpmm-selected-icon wpmm-selected-icon-left'><i class='fa fa-globe'></i></span> <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-2364790456102543758" class="wpmm-row wp-megamenu-item-2364790456102543758 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-8990141445230146821" class="wpmm-col wpmm-col-12 wp-megamenu-item-8990141445230146821 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101284 wpmm-submenu-right"><div class="menu-languages-category-container"><ul id="menu-languages-category" class="menu"><li id="menu-item-97433" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97433"><a href="/blogs/languages/italia/">Italia</a></li>
<li id="menu-item-97434" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97434"><a href="/blogs/languages/japanese/">日本語</a></li>
<li id="menu-item-97435" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97435"><a href="/blogs/languages/espanol/">Español</a></li>
<li id="menu-item-97436" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97436"><a href="/blogs/languages/francais/">Français</a></li>
<li id="menu-item-97437" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97437"><a href="/blogs/languages/german/">German</a></li>
<li id="menu-item-97438" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97438"><a href="/blogs/languages/portugues/">Português</a></li>
<li id="menu-item-101338" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-101338"><a href="/blogs/languages/">All Language Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-" class="wpmm-social-link wpmm-social-link- wp-megamenu-item-  wpmm_dropdown_menu  wpmm-fadeindown wpmm-submenu-right"><a target="_blank" ><i class=""></i></a></li>
</ul>
			</div>
		</nav>            </div>
            <div class="anchors right">
                <form role="search" method="get" class="blog-search search-form" action="https://www.mcafee.com/blogs/">
                    <button type="submit" class="search-submit"><i class="symbol-arrow-forward"></i></button>
                    <input type="search" class="search-field" placeholder="Search Blogs" value="" name="s" />


                </form>  
            </div>

        </div>
    </nav>

    <div class="wrap-section padding-top-xs"> 
        <div class="container medium">
 
        <div class="breadcrumb-container theme1">
            <ul itemscope itemtype="http://schema.org/BreadcrumbList">
                
                    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" title="Mcafee" href="/"><span itemprop="name">Mcafee</span></a><span class="separator">/</span><meta itemprop="position" content="1"></li>
                    
                    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" title="Home" href="https://www.mcafee.com/blogs"><span itemprop="name">Home</span></a><span class="separator">/</span><meta itemprop="position" content="2"></li>
                    
                    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" title="Other Blogs" href="/blogs/other-blogs/"><span itemprop="name">Other Blogs</span></a><span class="separator">/</span><meta itemprop="position" content="3"></li>
                    
                    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" title="McAfee Labs" href="/blogs/other-blogs/mcafee-labs/"><span itemprop="name">McAfee Labs</span></a><span class="separator">/</span><meta itemprop="position" content="4"></li>
                    
                    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" title="My Adventures Hacking the iParcelBox" href="#"><span itemprop="name">My Adventures Hacking the iParcelBox</span></a><meta itemprop="position" content="5"></li>
                                   </ul>
        </div>
        <style type="text/css">
            .breadcrumb-container {
                font-size: 13px;
            }
            .breadcrumb-container ul {
                margin: 0;
                padding: 0;
            }
            .breadcrumb-container li {
                box-sizing: unset;
                display: inline-block;
                margin: 0;
                padding: 0;
            }
            .breadcrumb-container li a {
                box-sizing: unset;
                padding: 0 10px;
            }
            .breadcrumb-container {
                font-size: 12px  !important;
                padding: 0px;
                margin: 0px;
            }
            .breadcrumb-container li a{
                color:  #c01818  !important;
                font-size:  12px  !important;
                line-height:  12px  !important;
            }
            .breadcrumb-container li .separator {
                color: #53565a  !important;
                font-size:  12px  !important;
            }
                            .breadcrumb-container li:last-child .separator {
                    display: none;
                }
                
							
							
.breadcrumb-container.theme1 li {
	margin: 0;
	padding: 0;
}							
							
.breadcrumb-container.theme1 a {
	background: ;
	display: inline-block;
	margin: 0 5px;
	padding: 5px 10px;
	text-decoration: none;
}

.breadcrumb-container{}
.breadcrumb-container ul{}
.breadcrumb-container li{}
.breadcrumb-container a{}
.breadcrumb-container .separator{}
        </style>
                </div>		 
    </div>

    <div class="wrap-section padding-small article">  
        <div class="container medium"> 
            <div class="border-line"></div>

            <div class="author-block padding-bottom-xs">
                <img class="author" src="/wp-content/uploads/2019/02/quinnsa-300x300.jpg" />
                <div class="meta">By <a href="/blogs/author/sam-quinn/" title="Posts by Sam Quinn" class="author url fn" rel="author">Sam Quinn</a> on Jun 18, 2020</div>
            </div>

                    <p>In 2019, McAfee Advanced Threat Research (ATR) disclosed a vulnerability in a product called <a href="https://www.mcafee.com/blogs/other-blogs/mcafee-labs/whats-in-the-box/" target="_blank" rel="noopener noreferrer">BoxLock</a>. Sometime after this, the CEO of iParcelBox, a U.K. company, reached out to us and offered to send a few of their products to test. While this isn’t the typical M.O. for our research we applaud the company for being proactive in their security efforts and so, as the team over at iParcelBox were kind enough to get everything shipped over to us, we decided to take a look.</p>
<p>The iParcelBox is a large steel box that package couriers, neighbors, etc. can access to retrieve or deliver items securely without needing to enter your home. The iParcelBox has a single button on it that when pushed will notify the owner that someone wants to place an object inside. The owner will get an “open” request push notification on their mobile device, which they can either accept or deny.</p>
<p><img class="aligncenter size-full wp-image-101924" src="/wp-content/uploads/2020/06/box1.png" alt="" width="800" height="533" srcset="/wp-content/uploads/2020/06/box1.png 800w, /wp-content/uploads/2020/06/box1-300x200.png 300w, /wp-content/uploads/2020/06/box1-768x512.png 768w, /wp-content/uploads/2020/06/box1-194x129.png 194w" sizes="(max-width: 800px) 100vw, 800px" /></p>
<p style="text-align: center;"><em>The iParcelBox (Photo Credit: iparcelbox.com)</em></p>
<h2>Recon</h2>
<p>The first thing we noticed about this device is the simplicity of it. In the mindset of an attacker, we are always looking at a wide variety of attack vectors. This device only has three external vectors: remote cloud APIs, WIFI, and a single physical button.</p>
<p><img class="aligncenter size-full wp-image-101925" src="/wp-content/uploads/2020/06/box2.png" alt="" width="800" height="533" srcset="/wp-content/uploads/2020/06/box2.png 800w, /wp-content/uploads/2020/06/box2-300x200.png 300w, /wp-content/uploads/2020/06/box2-768x512.png 768w, /wp-content/uploads/2020/06/box2-194x129.png 194w" sizes="(max-width: 800px) 100vw, 800px" /></p>
<p style="text-align: center;"><em>iParcelBox Delivery Button (Photo Credit: iparcelbox.com)</em></p>
<p>During setup the iParcelBox creates a WIFI access point for the mobile application to connect with and send setup information. Each iParcelBox has a unique randomly generated 16-character WiFi password that makes brute forcing the WPA2 key out of the question; additionally, this Access Point is only available when the iParcelBox is in setup mode. The iParcelBox can be placed into setup mode by holding the button down but it will warn the owner via a notification and will only remain in setup mode for a few minutes before returning to normal operation.</p>
<p><img class="aligncenter size-full wp-image-101926" src="/wp-content/uploads/2020/06/wifi-password.jpg" alt="" width="1430" height="752" srcset="/wp-content/uploads/2020/06/wifi-password.jpg 1430w, /wp-content/uploads/2020/06/wifi-password-300x158.jpg 300w, /wp-content/uploads/2020/06/wifi-password-1024x538.jpg 1024w, /wp-content/uploads/2020/06/wifi-password-768x404.jpg 768w, /wp-content/uploads/2020/06/wifi-password-205x108.jpg 205w" sizes="(max-width: 1430px) 100vw, 1430px" /></p>
<p style="text-align: center;"><em>iParcelBox Random WiFi Access Point Password (16 Characters)</em></p>
<p>Since we have the WiFi password for the iParcelBox in our lab, we connected to the device to see what we could glean from the webserver. The device was only listening on port 443, meaning that the traffic between the application and iParcelBox was most likely encrypted, which we later verified. This pointed us to the Android app to try to decipher what type of messages were being sent to the iParcelBox during setup.</p>
<p><img class="aligncenter size-full wp-image-101927" src="/wp-content/uploads/2020/06/port-scan.png" alt="" width="975" height="507" srcset="/wp-content/uploads/2020/06/port-scan.png 975w, /wp-content/uploads/2020/06/port-scan-300x156.png 300w, /wp-content/uploads/2020/06/port-scan-768x399.png 768w, /wp-content/uploads/2020/06/port-scan-205x107.png 205w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p style="text-align: center;"><em>iParcelBox Port Scan</em></p>
<p>Using dex2jar we were able to disassemble the APK file and look at the code within the app. We noticed quickly that the iParcelBox was using MQTT (MQ Telemetry Transport) for passing messages back and forth between the iParcelBox and the cloud. MQTT is a publish/subscribe message protocol where devices can subscribe to “topics” and receive messages. A simple description can be found here: (<a href="https://youtu.be/EIxdz-2rhLs" target="_blank" rel="noopener noreferrer">https://youtu.be/EIxdz-2rhLs</a>)</p>
<p style="text-align: center;"><img class="aligncenter size-large wp-image-101928" src="/wp-content/uploads/2020/06/Dex2Jar-1024x346.png" alt="" width="1024" height="346" srcset="/wp-content/uploads/2020/06/Dex2Jar-1024x346.png 1024w, /wp-content/uploads/2020/06/Dex2Jar-300x101.png 300w, /wp-content/uploads/2020/06/Dex2Jar-768x260.png 768w, /wp-content/uploads/2020/06/Dex2Jar-205x69.png 205w, /wp-content/uploads/2020/06/Dex2Jar.png 1426w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p style="text-align: center;"><em>Dex2Jar Command</em></p>
<p>A typical next step is to retrieve the firmware for the device, so we started to look through the disassembled APK code for interesting URLs. While we didn’t find any direct firmware links, we were able to find some useful information.</p>
<p><img class="aligncenter size-large wp-image-101929" src="/wp-content/uploads/2020/06/disassembled-code-1024x556.png" alt="" width="1024" height="556" srcset="/wp-content/uploads/2020/06/disassembled-code-1024x556.png 1024w, /wp-content/uploads/2020/06/disassembled-code-300x163.png 300w, /wp-content/uploads/2020/06/disassembled-code-768x417.png 768w, /wp-content/uploads/2020/06/disassembled-code-205x111.png 205w, /wp-content/uploads/2020/06/disassembled-code.png 1431w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p style="text-align: center;"><em>Disassembled Code pulled from APK</em></p>
<p>The code snipped above shows a few interesting points, including the string “config.iparcelbox.com” as well as the line with “app” and “TBpwkjoU68M”. We thought that this could be credentials for an app user passed to the iParcelBox during setup; however, we’ll come back to this later. The URL didn’t resolve on the internet, but when connecting to the iParcelBox access point and doing a Dig query we were able to see that it resolves to the iParcelBox.</p>
<p><img class="aligncenter size-large wp-image-101932" src="/wp-content/uploads/2020/06/DNS-lookup-1024x629.png" alt="" width="1024" height="629" srcset="/wp-content/uploads/2020/06/DNS-lookup-1024x629.png 1024w, /wp-content/uploads/2020/06/DNS-lookup-300x184.png 300w, /wp-content/uploads/2020/06/DNS-lookup-768x472.png 768w, /wp-content/uploads/2020/06/DNS-lookup-205x126.png 205w, /wp-content/uploads/2020/06/DNS-lookup.png 1429w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p style="text-align: center;"><em>DNS Lookup of config.iparcelbox.com</em></p>
<p>Nothing from the Android app or the webserver on the device popped out to us so we decided to look deeper. One of the most common ways that information about targets can be gathered is by looking through user forums and seeing if there are others trying to tweak and modify the device. Often with IOT devices, home automation forums have numerous examples of API usage as well as user scripts to interact with such devices. We wanted to see if there was anything like this for the iParcelBox. Our initial search for iParcelBox came up empty, other than some marketing content, but when the search was changed to iParcelBox API, we noticed a few interesting posts.</p>
<p><img class="aligncenter size-full wp-image-101934" src="/wp-content/uploads/2020/06/Google-search.png" alt="" width="635" height="705" srcset="/wp-content/uploads/2020/06/Google-search.png 635w, /wp-content/uploads/2020/06/Google-search-270x300.png 270w, /wp-content/uploads/2020/06/Google-search-116x129.png 116w" sizes="(max-width: 635px) 100vw, 635px" /></p>
<p style="text-align: center;"><em>Google Search for “iparcelbox api”</em></p>
<p>We could see that even on the first page there are a few bug reports and a couple of user forums for “Mongoose-OS”. After going to the Mongoose-OS forums we could clearly see that one user was a part of the iParcelBox development team. This gave us some insight that the device was running Mongoose-OS on an <a href="https://www.espressif.com/en/products/socs/esp32/overview" target="_blank" rel="noopener noreferrer">ESP32 Development board</a>, which is important since an ESP32 device can be flashed with many other types of code. We started to track the user’s posts and were able to discover extensive information about the device and the development decisions throughout the building process. Most importantly this served as a shortcut to many of the remaining analysis techniques.</p>
<p>As mentioned earlier, a high priority is to try to gain access to the device’s firmware by either pulling it from the device directly or by downloading it from the vendor’s site. Pulling firmware is slightly more tedious since you must often solder wires to the flash chip or remove the chip all-together to interface with the flash. Before we began to attempt to pull the firmware from the ESP32, we noticed another post within the forums that mentioned that the flash memory on the device was encrypted.</p>
<p><img class="aligncenter size-full wp-image-101935" src="/wp-content/uploads/2020/06/flash-encryption.png" alt="" width="526" height="370" srcset="/wp-content/uploads/2020/06/flash-encryption.png 526w, /wp-content/uploads/2020/06/flash-encryption-300x211.png 300w, /wp-content/uploads/2020/06/flash-encryption-183x129.png 183w" sizes="(max-width: 526px) 100vw, 526px" /></p>
<p style="text-align: center;"><em>Post describing flash encryption</em></p>
<p>With this knowledge, we skipped soldering wires to the ESP32 and didn’t even try to pull the firmware manually since it would have proven difficult to get anything off it. This also gave us insight into the provisioning process and how each device is set up. With this knowledge we started to look for how the OTA updates are downloaded.</p>
<p>Searching around a little longer we were able to find a file upload of a large log file containing what seemed like the iParcelBox boot procedure. Searching through the log we found some highly sensitive data.</p>
<p><img class="aligncenter size-large wp-image-101936" src="/wp-content/uploads/2020/06/admin-credentials-1024x280.png" alt="" width="1024" height="280" srcset="/wp-content/uploads/2020/06/admin-credentials-1024x280.png 1024w, /wp-content/uploads/2020/06/admin-credentials-300x82.png 300w, /wp-content/uploads/2020/06/admin-credentials-768x210.png 768w, /wp-content/uploads/2020/06/admin-credentials-205x56.png 205w, /wp-content/uploads/2020/06/admin-credentials.png 1429w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p style="text-align: center;"><em>Admin Credentials and gh-token from boot log</em></p>
<p>In the snippet above you can see that the admin credentials are passed as well as the GitHub token. Needless to say, this isn’t good practice, we will see if we can use that later. But in this log, we also found a firmware URL.</p>
<p><img class="aligncenter size-large wp-image-101937" src="/wp-content/uploads/2020/06/boot-log-1024x278.png" alt="" width="1024" height="278" srcset="/wp-content/uploads/2020/06/boot-log-1024x278.png 1024w, /wp-content/uploads/2020/06/boot-log-300x81.png 300w, /wp-content/uploads/2020/06/boot-log-768x208.png 768w, /wp-content/uploads/2020/06/boot-log-205x56.png 205w, /wp-content/uploads/2020/06/boot-log.png 1431w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p style="text-align: center;"><em>Firmware URL from boot log</em></p>
<p>However, the URL required a username and password.</p>
<p><img class="aligncenter size-full wp-image-101939" src="/wp-content/uploads/2020/06/firmware-1.png" alt="" width="620" height="417" srcset="/wp-content/uploads/2020/06/firmware-1.png 620w, /wp-content/uploads/2020/06/firmware-1-300x202.png 300w, /wp-content/uploads/2020/06/firmware-1-192x129.png 192w" sizes="(max-width: 620px) 100vw, 620px" /></p>
<p style="text-align: center;"><em>Firmware.iparcelbox.com .htaccess</em></p>
<p>We found this forum post where “.htaccess” is set up to prevent unintended access to the firmware download.</p>
<p><img class="aligncenter size-full wp-image-101940" src="/wp-content/uploads/2020/06/htaccess.png" alt="" width="504" height="124" srcset="/wp-content/uploads/2020/06/htaccess.png 504w, /wp-content/uploads/2020/06/htaccess-300x74.png 300w, /wp-content/uploads/2020/06/htaccess-205x50.png 205w" sizes="(max-width: 504px) 100vw, 504px" /></p>
<p style="text-align: center;"><em>.htaccess post</em></p>
<p>The admin password found earlier didn’t authenticate, so we wanted to get the logs off the device to see if these were old credentials and if we could print the new credentials out to UART.</p>
<p><img class="aligncenter wp-image-101941 size-large" src="/wp-content/uploads/2020/06/internals-1024x512.jpg" alt="" width="1024" height="512" srcset="/wp-content/uploads/2020/06/internals-1024x512.jpg 1024w, /wp-content/uploads/2020/06/internals-300x150.jpg 300w, /wp-content/uploads/2020/06/internals-768x384.jpg 768w, /wp-content/uploads/2020/06/internals-205x103.jpg 205w, /wp-content/uploads/2020/06/internals.jpg 1430w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p style="text-align: center;"><em>The internals of the iParcelBox (TX and RX highlighted in red)</em></p>
<p>The ESP32 RX and TX pins are mapped to the USB-C connection, but if you look at the circuit there is no <a href="https://en.wikipedia.org/wiki/FTDI">FTDI</a> (Future Technology Devices International) chip to do processing, so this is just raw serial. We decided to just solder to the <a href="https://en.wikipedia.org/wiki/Via_(electronics)">vias</a> (Vertical Interconnect Access) highlighted in red above, but still no data was transferred.</p>
<p>Then we started to search those overly helpful forum postings again, and quickly found the reason.</p>
<p><img class="aligncenter size-full wp-image-101942" src="/wp-content/uploads/2020/06/disable-UART.png" alt="" width="501" height="160" srcset="/wp-content/uploads/2020/06/disable-UART.png 501w, /wp-content/uploads/2020/06/disable-UART-300x96.png 300w, /wp-content/uploads/2020/06/disable-UART-205x65.png 205w" sizes="(max-width: 501px) 100vw, 501px" /></p>
<p style="text-align: center;"><em>Disable UART</em></p>
<p>This at least verified that it wasn’t something that we set up incorrectly, but rather that logging was simply disabled over UART.</p>
<h2>Method #1 &#8211; RPC</h2>
<p>From our recon work we pretty much settled on the fact that we were not going to get into the iParcelBox easily from a physical standpoint and decided to switch a network approach. We knew that during setup the iParcelBox creates a wireless AP and that we can connect to it. Armed with our knowledge from the forums we decided to revisit the web server on the iParcelBox. We began by sending some “MOS” (Mongoose-OS) control commands to see what stuck.</p>
<p>Setup instructions for Mongoose-OS can be found <a href="https://mongoose-os.com/docs/mongoose-os/quickstart/setup.md" target="_blank" rel="noopener noreferrer">here</a>. Instead of installing directly to the OS we did it in Docker for portability.</p>
<p><img class="aligncenter size-large wp-image-101943" src="/wp-content/uploads/2020/06/Docker-file-1024x469.png" alt="" width="1024" height="469" srcset="/wp-content/uploads/2020/06/Docker-file-1024x469.png 1024w, /wp-content/uploads/2020/06/Docker-file-300x137.png 300w, /wp-content/uploads/2020/06/Docker-file-768x352.png 768w, /wp-content/uploads/2020/06/Docker-file-205x94.png 205w, /wp-content/uploads/2020/06/Docker-file.png 1431w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p style="text-align: center;"><em>Docker file used to create mos</em></p>
<p>Referencing the forums provided several examples of how to use the mos command.</p>
<p><img class="aligncenter size-large wp-image-101944" src="/wp-content/uploads/2020/06/mos-commands-1024x425.png" alt="" width="1024" height="425" srcset="/wp-content/uploads/2020/06/mos-commands-1024x425.png 1024w, /wp-content/uploads/2020/06/mos-commands-300x125.png 300w, /wp-content/uploads/2020/06/mos-commands-768x319.png 768w, /wp-content/uploads/2020/06/mos-commands-205x85.png 205w, /wp-content/uploads/2020/06/mos-commands.png 1430w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p style="text-align: center;"><em>Docker mos commands</em></p>
<p>The first command returned a promising message that we just need to supply credentials. Remember when we found the boot log earlier? Yep, the admin credentials were posted online, and they actually work!</p>
<p>At this point we had full effective root access to the iParcelBox including access to all the files, JavaScript code, and even more importantly, the AWS certificate and private key.</p>
<p>With the files extracted from the device we noticed that the developers at iParcelBox implemented an Access Control List (ACL). For an IOT device this is uncommon but a good practice.</p>
<p><img class="aligncenter size-large wp-image-101945" src="/wp-content/uploads/2020/06/ACL-permissions-1024x219.png" alt="" width="1024" height="219" srcset="/wp-content/uploads/2020/06/ACL-permissions-1024x219.png 1024w, /wp-content/uploads/2020/06/ACL-permissions-300x64.png 300w, /wp-content/uploads/2020/06/ACL-permissions-768x164.png 768w, /wp-content/uploads/2020/06/ACL-permissions-205x44.png 205w, /wp-content/uploads/2020/06/ACL-permissions.png 1429w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p style="text-align: center;"><em>ACL showing users permissions</em></p>
<p>The credentials we found earlier in the disassembled Android APK with the username “app” were RPC credentials but with limited permissions to only run Sys.GetInfo, Wifi.Scan, Wifi.PortalSave and Sys.Reboot. Nothing too interesting can be done with those credentials, so for the rest of this method we will stick with the “admin” credentials.</p>
<p>Now that we have the credentials, certificates, and private keys we wanted to try to pivot to other devices. During setup we noticed that the MAC address was labeled “TopicID.”</p>
<p><img class="aligncenter size-large wp-image-101946" src="/wp-content/uploads/2020/06/MAC-address-1024x955.png" alt="" width="1024" height="955" srcset="/wp-content/uploads/2020/06/MAC-address-1024x955.png 1024w, /wp-content/uploads/2020/06/MAC-address-300x280.png 300w, /wp-content/uploads/2020/06/MAC-address-768x716.png 768w, /wp-content/uploads/2020/06/MAC-address-138x129.png 138w, /wp-content/uploads/2020/06/MAC-address.png 1079w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p style="text-align: center;"><em>Setup process linking MAC Address to the TopicID</em></p>
<p>As we determined earlier, the iParcelBox uses MQTT for brokering the communication between the device, cloud, and mobile application. We were interested to find out if there were any authentication barriers in place, or if all you need is the MAC address of the device to initiate commands remotely.</p>
<p>Since we essentially had root access, enabling logging was a logical next step so we could see what was happening on the device. From one of the Mongoose-OS forums posts we saw that you can enable UDP logging to a local device by changing the configuration on the iParcelBox.</p>
<p><img class="aligncenter size-full wp-image-101948" src="/wp-content/uploads/2020/06/UDP-logging-post.png" alt="" width="605" height="285" srcset="/wp-content/uploads/2020/06/UDP-logging-post.png 605w, /wp-content/uploads/2020/06/UDP-logging-post-300x141.png 300w, /wp-content/uploads/2020/06/UDP-logging-post-205x97.png 205w" sizes="(max-width: 605px) 100vw, 605px" /></p>
<p style="text-align: center;"><em>How to enable UDP logging post</em></p>
<p>We provisioned the iParcelBox, then held the button down until we entered setup mode (where the AP was available), thus reenabling RPC calls. Then we set the “udp_log_addr” to our local machine.</p>
<p><img class="aligncenter size-large wp-image-101949" src="/wp-content/uploads/2020/06/logging-1024x569.png" alt="" width="1024" height="569" srcset="/wp-content/uploads/2020/06/logging-1024x569.png 1024w, /wp-content/uploads/2020/06/logging-300x167.png 300w, /wp-content/uploads/2020/06/logging-768x427.png 768w, /wp-content/uploads/2020/06/logging-205x114.png 205w, /wp-content/uploads/2020/06/logging.png 1430w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p style="text-align: center;"><em>Reenabling Logging on iParcelBox</em></p>
<p>Now we have logs and much more information. We wanted to test if we could access the MQTT broker and modify other iParcelBoxes. In the logs we were able to validate that the MQTT broker was setup on AWS IOT and was using the certificate and keys that we pulled earlier. We found some Python examples of connecting to the AWS MQTT broker (<a href="https://github.com/aws/aws-iot-device-sdk-python" target="_blank" rel="noopener noreferrer">https://github.com/aws/aws-iot-device-sdk-python</a>) but it assumed it knows the full topic path (e.g. topic_id/command/unlock).</p>
<p><img class="aligncenter size-large wp-image-101950" src="/wp-content/uploads/2020/06/log-file-1024x683.png" alt="" width="1024" height="683" srcset="/wp-content/uploads/2020/06/log-file-1024x683.png 1024w, /wp-content/uploads/2020/06/log-file-300x200.png 300w, /wp-content/uploads/2020/06/log-file-768x512.png 768w, /wp-content/uploads/2020/06/log-file-194x129.png 194w, /wp-content/uploads/2020/06/log-file.png 1431w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p style="text-align: center;"><em>UDP Log file</em></p>
<p>Parsing through the extracted logs from UDP, we were able to find the format for the “shadow/update” MQTT topic. However, when trying to subscribe to it with the Python script, it seemed to connect to the MQTT broker, but we couldn’t ever get any messages to send or receive. Our best guess is that it was limited to one subscribe per topic or that our code was broken.</p>
<p>We went searching for another way to control devices. This brought us back to the Mongoose-OS forum (seeing a pattern here?). We found this post explaining that the devices can run RPC commands over MQTT.</p>
<p><img class="aligncenter size-full wp-image-101951" src="/wp-content/uploads/2020/06/RPC.png" alt="" width="616" height="156" srcset="/wp-content/uploads/2020/06/RPC.png 616w, /wp-content/uploads/2020/06/RPC-300x76.png 300w, /wp-content/uploads/2020/06/RPC-205x52.png 205w" sizes="(max-width: 616px) 100vw, 616px" /></p>
<p style="text-align: center;"><em>RPC over MQTT</em></p>
<p>This would be better for an attacker than only MQTT access, since this gives full access to the device including certificates, keys, user configuration files, WIFI passwords, and more. We could also use RPC to write custom code or custom firmware at this point.  We found the official Mongoose-OS support for this here (<a href="https://github.com/mongoose-os-libs/rpc-mqtt" target="_blank" rel="noopener noreferrer">https://github.com/mongoose-os-libs/rpc-mqtt</a>), to which they even included an example with AWS IOT.</p>
<p>After plugging that into the “mos” command we were able to run all administrative RPC commands on the device that we pulled the keys from, but also any other device that we knew the MAC address of.</p>
<p><img class="aligncenter size-large wp-image-101952" src="/wp-content/uploads/2020/06/running-RPC-commands-1024x605.png" alt="" width="1024" height="605" srcset="/wp-content/uploads/2020/06/running-RPC-commands-1024x605.png 1024w, /wp-content/uploads/2020/06/running-RPC-commands-300x177.png 300w, /wp-content/uploads/2020/06/running-RPC-commands-768x454.png 768w, /wp-content/uploads/2020/06/running-RPC-commands-205x121.png 205w, /wp-content/uploads/2020/06/running-RPC-commands.png 1430w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p style="text-align: center;"><em>Running RPC commands on multiple ATR lab devices</em></p>
<p>From looking at the two iParcelBoxes that were sent to us, the MAC addresses are only slightly different and strongly suggest that they are probably generated incrementally.</p>
<ul>
<li>30AEA4C59D30</li>
<li>30AEA4C59D6C</li>
</ul>
<p>Theoretically, with the MAC addresses incremental we could have just written a simple script to iterate through each of the iParcelBoxes’ MAC addresses, found any iParcelBox connected to the internet, and controlled or modified them in any way we wanted. However, the most common attack would likely be a more targeted one, where the attacker was looking to steal a package or even a victim’s home WiFi credentials. An attacker could do a simple network scan to find the MAC address of the target iParcelbox using a tool like “airodump-ng”. Then, after the attacker knows the target MAC address, they could use the admin credentials to initiate a “mos” command over MQTT and execute a “GPIO.Toggle” command directed at the GPIO (General Purpose Input Output) pin that controls the locking mechanism on the iParcelBox. A toggle will invert the state, so if the iParcelBox is locked, a GPIO toggle will unlock the box. If the attacker had other motives, they could also initiate a config dump to gain access to the WiFi credentials to which the iParcelBox is connected.</p>
<p><img class="aligncenter size-large wp-image-101953" src="/wp-content/uploads/2020/06/scanning-1024x469.png" alt="" width="1024" height="469" srcset="/wp-content/uploads/2020/06/scanning-1024x469.png 1024w, /wp-content/uploads/2020/06/scanning-300x137.png 300w, /wp-content/uploads/2020/06/scanning-768x352.png 768w, /wp-content/uploads/2020/06/scanning-205x94.png 205w, /wp-content/uploads/2020/06/scanning.png 1430w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p style="text-align: center;"><em>Scanning for iParcelBoxes and Controlling them with RPC</em></p>
<h2>Method #2 – AWS Misconfiguration</h2>
<p><img class="aligncenter size-full wp-image-101954" src="/wp-content/uploads/2020/06/1-2.png" alt="" width="494" height="149" srcset="/wp-content/uploads/2020/06/1-2.png 494w, /wp-content/uploads/2020/06/1-2-300x90.png 300w, /wp-content/uploads/2020/06/1-2-205x62.png 205w" sizes="(max-width: 494px) 100vw, 494px" /></p>
<p>While writing this blog we wanted to double check that SSL pinning was done properly. After we saw this post during our recon, we assumed it was pinning a certificate. We set up an Android with a certificate unpinner using Frida.  With the unpinner installed and working we were able to decrypt traffic between the application and the AWS servers, but it failed to decrypt the data from application to the iParcelBox. Please follow this <a href="https://www.mcafee.com/enterprise/en-us/threat-center/advanced-threat-research/tools-techniques-library.html" target="_blank" rel="noopener noreferrer">technique</a> if you’d like to learn how you can unpin certificates on Android devices.</p>
<p>Next, we reran the iParcelBox application without the Frida SSL Unpinner, which returned the same AWS server transactions, meaning that pinning wasn’t enabled. We browsed through some of the captures and found some interesting requests.</p>
<p><img class="aligncenter size-large wp-image-101955" src="/wp-content/uploads/2020/06/cognito-1024x269.png" alt="" width="1024" height="269" srcset="/wp-content/uploads/2020/06/cognito-1024x269.png 1024w, /wp-content/uploads/2020/06/cognito-300x79.png 300w, /wp-content/uploads/2020/06/cognito-768x202.png 768w, /wp-content/uploads/2020/06/cognito-205x54.png 205w, /wp-content/uploads/2020/06/cognito.png 1430w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p style="text-align: center;"><em>Cognito Credential SSL Network Capture</em></p>
<p>The “credentials” in the capture immediately piqued our interest. They are returned by a service called “Cognito”, which is an AWS service allowing apps and users to access resources within the AWS ecosystem for short periods of time and with limited access to private resources.</p>
<p><img class="aligncenter size-full wp-image-101957" src="/wp-content/uploads/2020/06/example.png" alt="" width="368" height="411" srcset="/wp-content/uploads/2020/06/example.png 368w, /wp-content/uploads/2020/06/example-269x300.png 269w, /wp-content/uploads/2020/06/example-116x129.png 116w" sizes="(max-width: 368px) 100vw, 368px" /></p>
<p style="text-align: center;"><em>AWS Cognito example (Photo Credit: Amazon.com)</em></p>
<p>When an application wants to access an AWS service, it can ask for temporary credentials for the specific task. If the permissions are configured correctly, the credentials issued by the Cognito service will allow the application or user to complete that one task and deny all other uses of the credentials to other services.</p>
<p>To use these credentials, we needed the AWS-CLI interface. Thankfully, Amazon even has a Docker image for AWS-CLI which made things much easier for us. We just saved the credentials returned from the Cognito service inside of a “~/.aws” folder. Then we checked what role these credentials were given.</p>
<p><img class="aligncenter size-large wp-image-101958" src="/wp-content/uploads/2020/06/docker-command-1024x190.png" alt="" width="1024" height="190" srcset="/wp-content/uploads/2020/06/docker-command-1024x190.png 1024w, /wp-content/uploads/2020/06/docker-command-300x56.png 300w, /wp-content/uploads/2020/06/docker-command-768x142.png 768w, /wp-content/uploads/2020/06/docker-command-205x38.png 205w, /wp-content/uploads/2020/06/docker-command.png 1429w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p style="text-align: center;"><em>AWS-CLI docker command</em></p>
<p>The credentials captured from the Android application were given the “AppAuth_Role”. To find out what the “AppAuth_Role” had access to we then ran a cloud service enumeration using the credentials; the scripts can be found here (<a href="https://github.com/NotSoSecure/cloud-service-enum" target="_blank" rel="noopener noreferrer">https://github.com/NotSoSecure/cloud-service-enum</a>) and are provided by the NotSoSecure team. The AWS script didn’t find any significant security holes and showed that the credentials were properly secured. However, looking at the next few network captures we noticed that these credentials were being used to access the DynamoDB database.</p>
<p><img class="aligncenter size-large wp-image-101959" src="/wp-content/uploads/2020/06/premium-1024x215.png" alt="" width="1024" height="215" srcset="/wp-content/uploads/2020/06/premium-1024x215.png 1024w, /wp-content/uploads/2020/06/premium-300x63.png 300w, /wp-content/uploads/2020/06/premium-768x161.png 768w, /wp-content/uploads/2020/06/premium-205x43.png 205w, /wp-content/uploads/2020/06/premium.png 1430w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p style="text-align: center;"><em>Checking if the user is subscribed to the Premium service</em></p>
<p><img class="aligncenter size-large wp-image-101960" src="/wp-content/uploads/2020/06/getting-devices-1024x269.png" alt="" width="1024" height="269" srcset="/wp-content/uploads/2020/06/getting-devices-1024x269.png 1024w, /wp-content/uploads/2020/06/getting-devices-300x79.png 300w, /wp-content/uploads/2020/06/getting-devices-768x202.png 768w, /wp-content/uploads/2020/06/getting-devices-205x54.png 205w, /wp-content/uploads/2020/06/getting-devices.png 1430w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p style="text-align: center;"><em>Getting the owner’s devices</em></p>
<p>After reading through some of the DynamoDB documentation we were able to craft database queries.</p>
<p><img class="aligncenter size-large wp-image-101961" src="/wp-content/uploads/2020/06/Dynamo-DB-query-961x1024.png" alt="" width="961" height="1024" srcset="/wp-content/uploads/2020/06/Dynamo-DB-query-961x1024.png 961w, /wp-content/uploads/2020/06/Dynamo-DB-query-281x300.png 281w, /wp-content/uploads/2020/06/Dynamo-DB-query-768x818.png 768w, /wp-content/uploads/2020/06/Dynamo-DB-query-121x129.png 121w, /wp-content/uploads/2020/06/Dynamo-DB-query.png 1430w" sizes="(max-width: 961px) 100vw, 961px" /></p>
<p style="text-align: center;"><em>DynamoDB Query</em></p>
<p>Because the “primary key” for the database is the “DeviceID” which we know is just the MAC address of the iParcelBox, we can then modify this query and get any other device’s database entries. While we didn’t test this for ethical reasons, we suspect that we could have used this information to gain access to the MQTT services. We also did not attempt to write to the database since this was a live production database and we didn’t want to corrupt any data.</p>
<p>We investigated the Android application attempting to trigger some more database interactions to see what other queries were being sent, but were limited to the following:</p>
<ul>
<li>Accounts – Shows premium subscription info</li>
<li>Owners – Shows devices and guests of each iParcelBox</li>
<li>Users – Used to save owners of each iParcelBox (only during setup)</li>
</ul>
<p>With our self-imposed database write restrictions, none of these tables really helped us anyway. That is when we began looking at the disassembled code of the Android app for more clues. Since we now knew the table names, we searched for “ClientID”, which turned up the Java file “DBConstants.class.”</p>
<p><img class="aligncenter size-large wp-image-101962" src="/wp-content/uploads/2020/06/constants-file-1024x896.png" alt="" width="1024" height="896" srcset="/wp-content/uploads/2020/06/constants-file-1024x896.png 1024w, /wp-content/uploads/2020/06/constants-file-300x263.png 300w, /wp-content/uploads/2020/06/constants-file-768x672.png 768w, /wp-content/uploads/2020/06/constants-file-147x129.png 147w, /wp-content/uploads/2020/06/constants-file.png 1429w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p style="text-align: center;"><em>Constants file from APK</em></p>
<p>This constants file gave us information that there are more database tables and fields, even though we never saw them in the network traffic. The “TABLE_DEVICES_PASSWORD” caught our eyes from the “iParcelBox_devices” table.</p>
<p>We tested the “AppAuth_Role” credentials on this table as well, which was accepted.</p>
<p><img class="aligncenter size-large wp-image-101963" src="/wp-content/uploads/2020/06/devices-table-1024x569.png" alt="" width="1024" height="569" srcset="/wp-content/uploads/2020/06/devices-table-1024x569.png 1024w, /wp-content/uploads/2020/06/devices-table-300x167.png 300w, /wp-content/uploads/2020/06/devices-table-768x427.png 768w, /wp-content/uploads/2020/06/devices-table-205x114.png 205w, /wp-content/uploads/2020/06/devices-table.png 1430w" sizes="(max-width: 1024px) 100vw, 1024px" /></p>
<p style="text-align: center;"><em>Requesting information from the iParcelBox_devices table</em></p>
<p>We were able to get the device password and serial number all from the MAC address. Recall the “iParcelBox Setup Information” image at the beginning of the blog and how it mentions that you should keep this information safe. The reason that this information should be kept safe is that you can become the owner of the iParcelBox if you know the MAC address, serial number, and password even without the QR code thanks to the “Add Manually” button.</p>
<p><img class="aligncenter size-large wp-image-101964" src="/wp-content/uploads/2020/06/add-manually-576x1024.png" alt="" width="576" height="1024" srcset="/wp-content/uploads/2020/06/add-manually-576x1024.png 576w, /wp-content/uploads/2020/06/add-manually-169x300.png 169w, /wp-content/uploads/2020/06/add-manually-73x129.png 73w, /wp-content/uploads/2020/06/add-manually.png 649w" sizes="(max-width: 576px) 100vw, 576px" /></p>
<p style="text-align: center;"><em>“Add manually” option during setup</em></p>
<p>With this information an attacker could register for a new iParcelBox account, login to the application, capture the Cognito credentials, begin the “setup” process, click “Add Manually” and then enter all the required information returned from the database to gain full control over any iParcelBox. This could all take place from simply knowing the MAC address since the “AppAuth_Role” can read any database entry.</p>
<p><img class="aligncenter size-large wp-image-101965" src="/wp-content/uploads/2020/06/required-information-576x1024.png" alt="" width="576" height="1024" srcset="/wp-content/uploads/2020/06/required-information-576x1024.png 576w, /wp-content/uploads/2020/06/required-information-169x300.png 169w, /wp-content/uploads/2020/06/required-information-73x129.png 73w, /wp-content/uploads/2020/06/required-information.png 607w" sizes="(max-width: 576px) 100vw, 576px" /></p>
<p style="text-align: center;"><em>Required Information to set up the iParcelBox</em></p>
<h2>Lessons Learned</h2>
<p>This project took a turn from a classic hardware/IOT device research project to an OSINT research topic very early on. It really goes to show that even simple mistakes with online data hygiene could expose key details to attackers allowing them to narrow down attack vectors or expose sensitive information like credentials.</p>
<p>Since this was a sponsored project from iParcelBox, we reported this to the company immediately. They promptly changed the admin password for every iParcelBox and asked the developers at Mongoose-OS to implement a change where one device’s AWS certificate and private key cannot control any other device. This was patched within 12 hours after our vendor disclosure, which puts iParcelBox in the top response time for a patch that we have ever seen. We have tested the patch and can no longer control other devices or use the old admin password to access the devices from within setup mode.</p>
<p>iParcelBox also fixed the Android application not pinning certificates properly and removed all direct calls to the DynamoDB. We were still able to decrypt some traffic using the Frida SSL unpinner, but the application would freeze, which we believe is due to the MQTT broker not accepting a custom certificate. The DynamoDB queries are now wrapped in API calls which also check against the customer ID. This prevents someone from using their extracted Cognito credentials to obtain information from any device other than their own. Wrapping the database queries within API calls is an effective security fix as well, as the data can be parsed, verified, and sanitized all before committing to the database.</p>
<p>We wanted to give props to the team at iParcelBox for their focus on security throughout the development of this product. It is easy to see from the device and the forum posts that the developers have been trying to make this device secure from the start and have done it well. All non-essential features like UART and Bluetooth are turned off by default and a focus on data protection is clearly there as evidenced through the use of SSL and encryption of the flash memory. There are not many attack surfaces that an attacker could leverage from the device and is a great refreshment to see IOT devices heading this direction.</p>
        </div>
    </div>

    <div class="wrap-section">  
        <div class="container medium">
            <h3>About the Author</h3>
        </div>
    </div>

    <div class="wrap-section padding-small bg-light-gray author-container">  
        <div class="container medium"> 


                <div class="row">
                    <div class="col-sm-2 col-xs-4 text-center">
                        <a href="/blogs/author/sam-quinn/"><img class="author" src="/wp-content/uploads/2019/02/quinnsa-300x300.jpg" /></a>
                        <ul class="social-networks">
                <li><a href="http://www.linkedin.com/in/sam--quinn" rel="nofollow" target="_blank"><i class="symbol-linkedin"></i><span>LinkedIn</span></a></li>                        </ul>
                    </div>
                    <div class="col-sm-10 col-xs-8">
                        <h3 class="red"><a href="/blogs/author/sam-quinn/">Sam Quinn</a></h3>
                        <p>Sam Quinn is a Security Researcher on McAfee’s Advanced Threat Research team , focused on finding new vulnerabilities in both software and hardware. Sam has a focus on IOT and embedded devices with knowledge in the fields of reverse engineering and penetration testing.</p>						
                        <a href="/blogs/author/sam-quinn/" class="caret-link">Read more posts from Sam Quinn </a>
                    </div>
                </div><br/>
                                    </div>
    </div>

    <div class="wrap-section padding-top-xs">  
        <div class="container medium"> 
            <div class="row">
                            <div class="col-sm-6 col-xs-6">
            <a href="/blogs/other-blogs/mcafee-labs/whats-in-the-box-part-ii-hacking-the-iparcelbox/" rel="prev"><i class="fa fa-angle-left" aria-hidden="true"></i> Previous Article</a> 
                </div>
                <div class="col-sm-6 col-xs-6 text-right">
<a href="/blogs/other-blogs/podcast/st20-quantum-computing-with-steve-grobman-jon-king/" rel="next">Next Article <i class="fa fa-angle-right" aria-hidden="true"></i></a>                </div>
            </div>
        </div>
    </div>
    <div class="wrap-section padding-top-xs"> 
        <div class="container medium">
                    <p class="small rule">Categories: <a href="/blogs/other-blogs/mcafee-labs/" rel="category tag">McAfee Labs</a><br /> 
            </p>	

        </div>		 
    </div>
    <div class="container medium">
                    <ol class="commentlist">
                    </ol>
             
    </div>
    
    <div class="wrap-section padding-top-small">  
        <div class="container medium">
                                </div>
    </div>
        <div class="wrap-section bg-red bg-image padding-medium" id="subscribe">
      <div class="container medium">
        <div class="row">
          <div class="col-sm-12">
            <div class="cta-component text-center">
              <h3>Subscribe to McAfee Securing Tomorrow Blogs</h3>
                         <form method="get" action="/blogs/subscribe/" class="form-inline">
            
              <input type="text" placeholder="Email address" name="subscriber_email" />
          
            <button type="submit" class="btn transparent">Subscribe</button>
          </form>
              
            </div>
          </div>
        </div>
      </div>
    </div>

</main>
<!--Footer of en-us starts here --> 
    
	<aside class="tools">
		<a href="#wrapper" class="back-to-top">Back to top</a>
	</aside>
  
  <div class="textwidget custom-html-widget"><div class="wrap-section padding-bottom-medium padding-top-small bg-dark-gray" id="footer">
    <div class="container medium">           
      <div class="row">
         <div class="col-sm-6 breadcrumb">
        	<ul class="breadcrumb-list">
        		<li><a class="symbols-label first" href="/blogs"><i class="symbol-shield"></i><span>McAfee Home</span></a></li>
        		<li><a class="symbols-label" href="/blogs"><i class="symbol-arrow-forward"></i><span>Securing Tomorrow</span></a></li>
					 </ul>
				</div>
        <div class="col-sm-6 social">
          <!-- <a id="usbl-integrated-button" class="symbols-label" href=""><i class="symbol-feedback"></i><span>Feedback</span></a> -->
          <ul class="social-networks">
            <li><a href="https://twitter.com/mcafee" title="Twitter" target="_blank" rel="noopener noreferrer"><i class="symbol-twitter"></i><span>Twitter</span></a></li>
            <li><a href="http://www.facebook.com/mcafee" title="Facebook" target="_blank" rel="noopener noreferrer"><i class="symbol-facebook"></i><span>Facebook</span></a></li>
            <li><a href="https://www.linkedin.com/company/2336?trk=prof-exp-company-name" title="LinkedIn" target="_blank" rel="noopener noreferrer"><i class="symbol-linkedin"></i><span>LinkedIn</span></a></li>
            <li><a href="http://www.youtube.com/mcafee" title="YouTube" target="_blank" rel="noopener noreferrer"><i class="symbol-youtube"></i><span>YouTube</span></a></li>
            <li><a href="/blogs/" title="Blog" target="_blank" rel="noopener noreferrer"><i class="symbol-blog"></i><span>Blog</span></a></li>
					</ul>
        </div>
      </div>
      <hr />
      <div class="row">
        <div class="col-sm-3">
          <a class="symbols-label" href="/enterprise/en-us/about/region-selector.html"><i class="symbol-language"></i><span>United States / English</span></a>
        </div>
        <div class="col-sm-9">
           <a href="//www.scanalert.com/RatingVerify?ref=www.mcafee.com" target="_blank" class="mcafee-secure" rel="noopener noreferrer"><img src="https://www.mcafee.com/enterprise/en-us/img/v1/common/logo-mcafee-secure.svg" alt="McAfee SECURE"/></a>
          <ul class="footer-menu">
            <li><a href="/enterprise/en-us/about/legal/privacy.html">Privacy</a></li>
            <li><a href="/enterprise/en-us/about/legal/notices.html">Legal Notices</a></li>
            <li><a href="/enterprise/en-us/about/legal/contracts-terms.html">Legal Contracts &amp; Terms</a></li>
            <li><a href="/enterprise/en-us/site-map.html">Site Map</a></li>
            <li>Copyright ©2020 McAfee, LLC</li>
          </ul>
        </div>
      </div>          
    </div>            	
  </div>
</div></div>


</body>	
<script type="text/javascript">
   if ($('div.author-block .meta').length > 0) {
      utag_data.tm_local_blogs_author = $('div.author-block .meta').text().split(' on ')[0].replace("By","").trim();
    }
    (function(a,b,c,d){
    a='//tags.tiqcdn.com/utag/mcafee/consumer-main/prod/utag.js'; // Note: Please use prod for production version and dev for dev version before release
    b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;
    a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a);
    })();
</script>

<script type='text/javascript' src='/wp-content/plugins/metronet-profile-picture/js/mpp-frontend.js?ver=2.3.8'></script>
<script type='text/javascript'>
/* Highlight Search Terms 1.5 ( RavanH - http://status301.net/wordpress-plugins/highlight-search-terms/ ) */
var hlst_query = []; var hlst_areas = ["#groups-dir-list","#members-dir-list","div.bbp-topic-content,div.bbp-reply-content,li.bbp-forum-info,.bbp-topic-title,.bbp-reply-title","article","div.hentry","div.post","#content","#main","div.content","#middle","#container","div.container","div.page","#wrapper","body"];
</script>
<script type='text/javascript' src='/wp-content/plugins/highlight-search-terms/hlst-extend.min.js?ver=1.5'></script>
<script type='text/javascript' src='/wp-content/plugins/social-polls-by-opinionstage/public/js/shortcodes.js?ver=19.6.31'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpmm_object = {"ajax_url":"https:\/\/www.mcafee.com\/wp-admin\/admin-ajax.php","wpmm_responsive_breakpoint":"767px","wpmm_disable_mobile":"false"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/wp-megamenu/assets/js/wpmm.js?ver=1.3.1'></script>
<script type='text/javascript' src='/wp-content/themes/securingtomorrow/js/theme-script.js?ver=5.4.2'></script>
<script type='text/javascript' src='/wp-content/themes/securingtomorrow/js/skip-link-focus-fix.min.js?ver=20151215'></script>
<script type='text/javascript' src='/wp-content/plugins/super-socializer/js/front/social_login/general.js?ver=7.12.37'></script>
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=5.4.2'></script>
	
<script src="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js?ver=10faaf528e636a046163bdb6753031b2"></script>
<script src="/wp-content/themes/securingtomorrow/js/jquery-lib.js"></script>
<script src="/wp-content/themes/securingtomorrow/js/main.js"></script>
<script src="/wp-content/themes/securingtomorrow/js/general_footer.js"></script>
<!-- Consumer Facebook Pixel Code -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '187610925152304');
  fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=187610925152304&ev=PageView&noscript=1"/></noscript>
<!-- End Facebook Pixel Code -->

<!-- Start linkedIn pixel -->
<script type="text/javascript">
_linkedin_partner_id = "68395";
window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || [];
window._linkedin_data_partner_ids.push(_linkedin_partner_id);
</script><script type="text/javascript">
(function(){var s = document.getElementsByTagName("script")[0];
var b = document.createElement("script");
b.type = "text/javascript";b.async = true;
b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js";
s.parentNode.insertBefore(b, s);})();
</script>
<noscript>
<img height="1" width="1" style="display:none;" alt="" src="https://dc.ads.linkedin.com/collect/?pid=68395&fmt=gif" />
</noscript>
<!-- End linkedIn pixel -->

<!-- Twitter universal website tag code -->
<script>
!function(e,t,n,s,u,a){e.twq||(s=e.twq=function(){s.exe?s.exe.apply(s,arguments):s.queue.push(arguments);
},s.version='1.1',s.queue=[],u=t.createElement(n),u.async=!0,u.src='//static.ads-twitter.com/uwt.js',
a=t.getElementsByTagName(n)[0],a.parentNode.insertBefore(u,a))}(window,document,'script');
// Insert Twitter Pixel ID and Standard Event data below
twq('init','nxlgc');
twq('track','PageView');
</script>
<!-- Twitter universal website tag code -->

<script>
/* <![CDATA[ */
var google_conversion_id = 975085349;
var google_custom_params = window.google_tag_params;
var google_remarketing_only = true;
/* ]]> */
document.write('\x3Cscript type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js">\x3C/script>');
//document.write('\x3Cnoscript>\x3Cimg height="1" width="1" style="border-style:none;display:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/975085349/?guid=ON&script=0"/>\x3C/noscript>');
</script>

<!-- Enterprise Facebook Pixel Code -->
<script>
// load Facebook
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '766537420057144');
fbq('track', "PageView");

//document.write('\x3Cnoscript>\x3Cimg height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=766537420057144&ev=PageView&noscript=1" />\x3C/noscript>');
</script>
<!-- Facebook Pixel Code -->

<!-- Adobe Launch START -->
<script src="//assets.adobedtm.com/launch-ENc117a6a508e14a879398dd6f37ed54a3.min.js"></script>
<!-- Adobe Launch END -->
<script>_satellite.pageBottom()</script>
</html>


<style>
    .commentlist {
        display: none;
    }
</style>
<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me - Debug: cached@1616227342 -->