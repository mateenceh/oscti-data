<!DOCTYPE html>
<html lang="en-US">

    <head>

        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <link rel="profile" href="https://gmpg.org/xfn/11">
        <link rel="pingback" href="https://www.mcafee.com/xmlrpc.php">
                    <link rel="canonical" href="https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ragnarlocker-ransomware-threatens-to-release-confidential-information/">
                            <link rel="shortcut icon" href="https://www.mcafee.com/enterprise/en-us/img/favicon.ico">
        <!--<link rel="stylesheet" href="/wp-content/themes/securingtomorrow/css/responsive/blog.css" type="text/css">
        <link rel="stylesheet" href="/wp-content/themes/securingtomorrow/css/responsive/main.css" type="text/css">-->
        <link rel="stylesheet" href="/enterprise/www/css/main.min.css" type="text/css">
       
        	<script type="text/javascript">function theChampLoadEvent(e){var t=window.onload;if(typeof window.onload!="function"){window.onload=e}else{window.onload=function(){t();e()}}}</script>
		<script type="text/javascript">var theChampDefaultLang = 'en_US', theChampCloseIconPath = 'https://www.mcafee.com/wp-content/plugins/super-socializer/images/close.png';</script>
		<script> var theChampSiteUrl = 'https://www.mcafee.com/blogs', theChampVerified = 0, theChampEmailPopup = 0; </script>
		<style type="text/css">.the_champ_horizontal_sharing .theChampSharing{
					color: #fff;
				border-width: 0px;
		border-style: solid;
		border-color: transparent;
	}
		.the_champ_horizontal_sharing .theChampTCBackground{
		color:#666;
	}
		.the_champ_horizontal_sharing .theChampSharing:hover{
				border-color: transparent;
	}
	.the_champ_vertical_sharing .theChampSharing{
					color: #fff;
				border-width: 0px;
		border-style: solid;
		border-color: transparent;
	}
		.the_champ_vertical_sharing .theChampTCBackground{
		color:#666;
	}
		.the_champ_vertical_sharing .theChampSharing:hover{
				border-color: transparent;
	}
	@media screen and (max-width:783px){.the_champ_vertical_sharing{display:none!important}}div.heateor_ss_mobile_footer{display:none;}@media screen and (max-width:783px){i.theChampTCBackground{background-color:white!important}div.the_champ_bottom_sharing{width:100%!important;left:0!important;}div.the_champ_bottom_sharing li{width:12.5% !important;}div.the_champ_bottom_sharing .theChampSharing{width: 100% !important;}div.the_champ_bottom_sharing div.theChampTotalShareCount{font-size:1em!important;line-height:28px!important}div.the_champ_bottom_sharing div.theChampTotalShareText{font-size:.7em!important;line-height:0px!important}div.heateor_ss_mobile_footer{display:block;height:40px;}.the_champ_bottom_sharing{padding:0!important;display:block!important;width: auto!important;bottom:-2px!important;top: auto!important;}.the_champ_bottom_sharing .the_champ_square_count{line-height: inherit;}.the_champ_bottom_sharing .theChampSharingArrow{display:none;}.the_champ_bottom_sharing .theChampTCBackground{margin-right: 1.1em !important}}</style>
	
	<!-- This site is optimized with the Yoast SEO plugin v14.2 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>RagnarLocker Ransomware Threatens to Release Confidential Information | McAfee Blogs</title>
	<meta name="description" content="EXECUTIVE SUMMARY The RagnarLocker ransomware first appeared in the wild at the end of December 2019 as part of a campaign against compromised networks" />
	<meta name="robots" content="index, follow" />
	<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="RagnarLocker Ransomware Threatens to Release Confidential Information | McAfee Blogs" />
	<meta property="og:description" content="EXECUTIVE SUMMARY The RagnarLocker ransomware first appeared in the wild at the end of December 2019 as part of a campaign against compromised networks" />
	<meta property="og:url" content="/blogs/other-blogs/mcafee-labs/ragnarlocker-ransomware-threatens-to-release-confidential-information/" />
	<meta property="og:site_name" content="McAfee Blogs" />
	<meta property="article:publisher" content="https://www.facebook.com/mcafee" />
	<meta property="article:published_time" content="2020-06-09T16:21:01+00:00" />
	<meta property="article:modified_time" content="2020-08-19T12:54:18+00:00" />
	<meta property="og:image" content="https://www.mcafee.com/wp-content/uploads/2020/06/img_1595410606698738.jpg" />
	<meta property="og:image:width" content="400" />
	<meta property="og:image:height" content="300" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:creator" content="@ValthekOn" />
	<meta name="twitter:site" content="@mcafee" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://www.mcafee.com/blogs/#website","url":"https://www.mcafee.com/blogs/","name":"McAfee Blogs","description":"Securing Tomorrow. Today.","potentialAction":[{"@type":"SearchAction","target":"https://www.mcafee.com/blogs/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ragnarlocker-ransomware-threatens-to-release-confidential-information/#primaryimage","inLanguage":"en-US","url":"/wp-content/uploads/2020/06/img_1595410606698738.jpg","width":400,"height":300},{"@type":"WebPage","@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ragnarlocker-ransomware-threatens-to-release-confidential-information/#webpage","url":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ragnarlocker-ransomware-threatens-to-release-confidential-information/","name":"RagnarLocker Ransomware Threatens to Release Confidential Information | McAfee Blogs","isPartOf":{"@id":"https://www.mcafee.com/blogs/#website"},"primaryImageOfPage":{"@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ragnarlocker-ransomware-threatens-to-release-confidential-information/#primaryimage"},"datePublished":"2020-06-09T16:21:01+00:00","dateModified":"2020-08-19T12:54:18+00:00","author":{"@id":"https://www.mcafee.com/blogs/#/schema/person/c3f45299d8c53eed9afcc781d0664cb0"},"description":"EXECUTIVE SUMMARY The RagnarLocker ransomware first appeared in the wild at the end of December 2019 as part of a campaign against compromised networks","breadcrumb":{"@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ragnarlocker-ransomware-threatens-to-release-confidential-information/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ragnarlocker-ransomware-threatens-to-release-confidential-information/"]}]},{"@type":"BreadcrumbList","@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ragnarlocker-ransomware-threatens-to-release-confidential-information/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"/blogs/","url":"/blogs/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"/blogs/other-blogs/","url":"/blogs/other-blogs/","name":"Other Blogs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"/blogs/other-blogs/mcafee-labs/","url":"/blogs/other-blogs/mcafee-labs/","name":"McAfee Labs"}},{"@type":"ListItem","position":4,"item":{"@type":"WebPage","@id":"/blogs/other-blogs/mcafee-labs/ragnarlocker-ransomware-threatens-to-release-confidential-information/","url":"/blogs/other-blogs/mcafee-labs/ragnarlocker-ransomware-threatens-to-release-confidential-information/","name":"RagnarLocker Ransomware Threatens to Release Confidential Information"}}]},{"@type":["Person"],"@id":"https://www.mcafee.com/blogs/#/schema/person/c3f45299d8c53eed9afcc781d0664cb0","name":"Alexandre Mundo","description":"Alexandre Mundo, Senior Malware Analyst is part of Mcafee's Advanced Threat Research team. He reverses the new threads in advanced attacks and make research of them in a daily basis. He is focused in APT and new, and old but very active, ransomware attacks and malware. He performs malware and forensic analysis and teach junior malware analysts and has developed training courses, workshops and presentations of malware analysis. He worked as freelance and consultor in the past too.","sameAs":["https://www.linkedin.com/in/alexandre-mundo-alguacil-38a98011a/","https://twitter.com/ValthekOn"]}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//stackpath.bootstrapcdn.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="McAfee Blogs &raquo; Feed" href="https://www.mcafee.com/blogs/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.4.2"}};
			/*! This file is auto-generated */
			!function(e,a,t){var r,n,o,i,p=a.createElement("canvas"),s=p.getContext&&p.getContext("2d");function c(e,t){var a=String.fromCharCode;s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,e),0,0);var r=p.toDataURL();return s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,t),0,0),r===p.toDataURL()}function l(e){if(!s||!s.fillText)return!1;switch(s.textBaseline="top",s.font="600 32px Arial",e){case"flag":return!c([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])&&(!c([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!c([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]));case"emoji":return!c([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340])}return!1}function d(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(i=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},o=0;o<i.length;o++)t.supports[i[o]]=l(i[o]),t.supports.everything=t.supports.everything&&t.supports[i[o]],"flag"!==i[o]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[i[o]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(r=t.source||{}).concatemoji?d(r.concatemoji):r.wpemoji&&r.twemoji&&(d(r.twemoji),d(r.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='/wp-includes/css/dist/block-library/style.min.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_poll_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/poll/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_trivia_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/trivia/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_personality_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/personality/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_survey_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/survey/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_slideshow_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/slideshow/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_form_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/form/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='mpp_gutenberg-css'  href='/wp-content/plugins/metronet-profile-picture/dist/blocks.style.build.css?ver=2.3.8' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='/wp-includes/css/dashicons.min.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='wpmm_css-css'  href='/wp-content/plugins/wp-megamenu/assets/css/wpmm.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='wp_megamenu_generated_css-css'  href='/wp-content/uploads/wp-megamenu/wp-megamenu.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='featuresbox_css-css'  href='/wp-content/plugins/wp-megamenu/addons/wpmm-featuresbox/wpmm-featuresbox.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='postgrid_css-css'  href='/wp-content/plugins/wp-megamenu/addons/wpmm-gridpost/wpmm-gridpost.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wp-bootstrap-pro-fontawesome-cdn-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='open-sans-google-font-css'  href='https://fonts.googleapis.com/css?family=Open+Sans%3A300%2C400&#038;ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='theme-css-css'  href='/wp-content/themes/securingtomorrow/style.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='the_champ_frontend_css-css'  href='/wp-content/plugins/super-socializer/css/front.css?ver=7.12.37' type='text/css' media='all' />
<link rel='stylesheet' id='addtoany-css'  href='/wp-content/plugins/add-to-any/addtoany.min.css?ver=1.15' type='text/css' media='all' />
<link rel='stylesheet' id='poppins-css'  href='//fonts.googleapis.com/css?family=Poppins%3A100%2C100italic%2C200%2C200italic%2C300%2C300italic%2Cregular%2Citalic%2C500%2C500italic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic%2C900%2C900italic&#038;ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='oswald-css'  href='//fonts.googleapis.com/css?family=Oswald%3A200%2C300%2Cregular%2C500%2C600%2C700&#038;ver=1.3.1' type='text/css' media='all' />
<script type='text/javascript' src='/wp-content/plugins/jquery-updater/js/jquery-3.4.1.min.js?ver=3.4.1'></script>
<script type='text/javascript' src='/wp-content/plugins/add-to-any/addtoany.min.js?ver=1.1'></script>
<script type='text/javascript' src='/wp-content/plugins/wp-megamenu/addons/wpmm-featuresbox/wpmm-featuresbox.js?ver=1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var postgrid_ajax_load = {"ajax_url":"https:\/\/www.mcafee.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/wp-megamenu/addons/wpmm-gridpost/wpmm-gridpost.js?ver=1'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='/wp-content/themes/securingtomorrow/js/html5.js?ver=3.7.0'></script>
<![endif]-->
<link rel='https://api.w.org/' href='https://www.mcafee.com/blogs/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.mcafee.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.mcafee.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.2" />
<link rel='shortlink' href='https://www.mcafee.com/blogs/?p=101742' />
<link rel="alternate" type="application/json+oembed" href="https://www.mcafee.com/blogs/wp-json/oembed/1.0/embed?url=%2Fblogs%2Fother-blogs%2Fmcafee-labs%2Fragnarlocker-ransomware-threatens-to-release-confidential-information%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://www.mcafee.com/blogs/wp-json/oembed/1.0/embed?url=%2Fblogs%2Fother-blogs%2Fmcafee-labs%2Fragnarlocker-ransomware-threatens-to-release-confidential-information%2F&#038;format=xml" />

<script data-cfasync="false">
window.a2a_config=window.a2a_config||{};a2a_config.callbacks=[];a2a_config.overlays=[];a2a_config.templates={};
(function(d,s,a,b){a=d.createElement(s);b=d.getElementsByTagName(s)[0];a.async=1;a.src="https://static.addtoany.com/menu/page.js";b.parentNode.insertBefore(a,b);})(document,"script");
</script>
<script>
var utag_data = {
tm_global_pagename:"",
tm_global_page_publish_date:"",
tm_global_businessunit:"consumer",
tm_global_sitesection:"",
tm_global_sitesection_level2:"",
tm_global_sitesection_level3:"",
tm_global_platform:"web",
tm_global_culture_code:"en-us",
tm_global_country:"united states",
tm_global_geo:"na",
tm_global_channel:"direct",
tm_global_affiliate_id:"",
tm_global_affiliate_name:"",
tm_global_campaign_id:"",
tm_global_page_version:"",
tm_global_pageurl:location.href,
tm_global_clientid :"",
tm_global_trafficsource:"",
tm_global_sourcetype:"blog",
tm_global_wssversion:"",
tm_global_coe:"",
tm_global_coe_level2:"",
tm_local_blogs_author:""
}
var sec=location.pathname.replace("/blogs","").split("/"); utag_data.tm_global_pagename="[consumer:web]";
if(sec.length > 2) {
for(i=1;i<sec.length-1;i++) {
utag_data.tm_global_pagename+="|"+sec[i];
if(i==1){utag_data.tm_global_sitesection=sec[i]}
if(i==2){utag_data.tm_global_sitesection_level2=sec[i]}
if(i==3){utag_data.tm_global_sitesection_level3=sec[i]}
}
}
else {
utag_data.tm_global_sitesection="Homepage"
utag_data.tm_global_pagename+="|Homepage"
}

var today = new Date(); var dd = today.getDate(); var mm = today.getMonth() + 1; var yyyy = today.getFullYear();
if (dd < 10) { dd = '0' + dd;    } 
if (mm < 10) {mm = '0' + mm;  } 
utag_data.tm_global_page_publish_date = dd + '/' + mm + '/' + yyyy;

</script>

<script>
	var ISOTOPE_CACHE 				=  [];
	var ISOTOPE_AJAX_URL 			= 'https://www.mcafee.com/wp-admin/admin-ajax.php';
	var ISOTOPE_AJAX_URL_ENDPOINT 	= 'https://www.mcafee.com/wp-content/plugins/ae-isotope/endpoint.php';
	var ISOTOPE_AJAX_ITEMS			= 25;
	var ISOTOPE_CURRENT_CATEGORY	= '';
</script>		<meta property="fb:app_id" content="346056175795920" />
					<meta property="fb:admins" content="100007220654854" />
			<style type="text/css">.wp-megamenu-wrap .wpmm-nav-wrap > ul.wp-megamenu li.wpmm_dropdown_menu ul.wp-megamenu-sub-menu li.menu-item-has-children.wp-megamenu-item-101284.wpmm-submenu-right > ul.wp-megamenu-sub-menu {left: 100%;}</style><style type="text/css"></style><link rel="icon" href="/wp-content/uploads/2018/11/cropped-favicon-32x32.png" sizes="32x32" />
<link rel="icon" href="/wp-content/uploads/2018/11/cropped-favicon-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="/wp-content/uploads/2018/11/cropped-favicon-180x180.png" />
<meta name="msapplication-TileImage" content="/wp-content/uploads/2018/11/cropped-favicon-270x270.png" />
         <link rel="stylesheet" href="/enterprise/www/css/blog.css" type="text/css">
                <script type="text/javascript">
            var digitalData = {"page":{"pageInfo":{"pageName":"other-blogs:mcafee-labs:ragnarlocker-ransomware-threatens-to-release-confidential-information","pageNameGlobal":"ragnarlocker-ransomware-threatens-to-release-confidential-information","pageLanguage":"English","pageType":"","country":"us","geo":"NA","onsiteSearchTerm":"","onsiteSearchType":"","category":{"category":"other-blogs","subCategory1":"mcafee-labs"},"author":"Alexandre Mundo","pubDate":"Jun 09, 2020","metaData":{"keywords":""}}},"user":{"userInfo":{"ip":"161.69.31.4"}}}        </script>
                <script type='application/ld+json'>{
            "@context": "http://schema.org",
            "@type": "Article",
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ragnarlocker-ransomware-threatens-to-release-confidential-information/"
            },
           "headline": "RagnarLocker Ransomware Threatens to Release Confidential Information",
            "image": ["https://www.mcafee.com/wp-content/uploads/2020/06/img_1595410606698738.jpg"],	
            "datePublished": "2020-06-09",
            "dateModified": "Aug 19, 2020",
            "author": {
                "@type": "Person",           
                "name": ["Alexandre Mundo"]            
            },
            "publisher": {
                "@type": "Organization",
                "name": "McAfee",
                "logo": {
                    "@type": "ImageObject",
                    "url": "https://www.mcafee.com/enterprise/en-us/img/logos/mcafee-logo.png"
                }
            },
            "description": "EXECUTIVE SUMMARYThe RagnarLocker ransomware first appeared in the wild at the end of December 2019 as part of a campaign against compromised networks targeted by its operators.The ransomware code is small (only 48kb after the protection in its custom packer is removed) and coded in a high programming language (C/C++)."        
            }
        </script>
        <style>
            #wp-megamenu-blog>.wpmm-nav-wrap ul.wp-megamenu>li>a{
                color:#ffffff !important;
            }
        </style> 
    
    <script>!function(){function o(n,i){if(n&&i)for(var r in i)i.hasOwnProperty(r)&&(void 0===n[r]?n[r]=i[r]:n[r].constructor===Object&&i[r].constructor===Object?o(n[r],i[r]):n[r]=i[r])}try{var n=decodeURIComponent("%7B%20%22BW%22%3A%20%7B%20%22test_https%22%3A%20true%20%7D%20%7D");if(n.length>0&&window.JSON&&"function"==typeof window.JSON.parse){var i=JSON.parse(n);void 0!==window.BOOMR_config?o(window.BOOMR_config,i):window.BOOMR_config=i}}catch(r){window.console&&"function"==typeof window.console.error&&console.error("mPulse: Could not parse configuration",r)}}();</script>
                          <script>!function(a){var e="https://s.go-mpulse.net/boomerang/",t="addEventListener";if("False"=="True")a.BOOMR_config=a.BOOMR_config||{},a.BOOMR_config.PageParams=a.BOOMR_config.PageParams||{},a.BOOMR_config.PageParams.pci=!0,e="https://s2.go-mpulse.net/boomerang/";if(window.BOOMR_API_key="LXNDQ-3SP7Y-P3JVN-Y4HAH-VQNKC",function(){function n(e){a.BOOMR_onload=e&&e.timeStamp||(new Date).getTime()}if(!a.BOOMR||!a.BOOMR.version&&!a.BOOMR.snippetExecuted){a.BOOMR=a.BOOMR||{},a.BOOMR.snippetExecuted=!0;var i,_,o,r=document.createElement("iframe");if(a[t])a[t]("load",n,!1);else if(a.attachEvent)a.attachEvent("onload",n);r.src="javascript:void(0)",r.title="",r.role="presentation",(r.frameElement||r).style.cssText="width:0;height:0;border:0;display:none;",o=document.getElementsByTagName("script")[0],o.parentNode.insertBefore(r,o);try{_=r.contentWindow.document}catch(O){i=document.domain,r.src="javascript:var d=document.open();d.domain='"+i+"';void(0);",_=r.contentWindow.document}_.open()._l=function(){var a=this.createElement("script");if(i)this.domain=i;a.id="boomr-if-as",a.src=e+"LXNDQ-3SP7Y-P3JVN-Y4HAH-VQNKC",BOOMR_lstart=(new Date).getTime(),this.body.appendChild(a)},_.write("<bo"+'dy onload="document._l();">'),_.close()}}(),"".length>0)if(a&&"performance"in a&&a.performance&&"function"==typeof a.performance.setResourceTimingBufferSize)a.performance.setResourceTimingBufferSize();!function(){if(BOOMR=a.BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},!BOOMR.plugins.AK){var e=""=="true"?1:0,t="",n="fb23dtlilz6gqycyd42q-f-f4771f533-clientnsv4-s.akamaihd.net",i={"ak.v":"30","ak.cp":"108209","ak.ai":parseInt("250743",10),"ak.ol":"0","ak.cr":7,"ak.ipv":4,"ak.proto":"http/1.1","ak.rid":"1a3af1db","ak.r":30888,"ak.a2":e,"ak.m":"b","ak.n":"essl","ak.bpcip":"40.117.177.0","ak.cport":33270,"ak.gh":"23.201.31.149","ak.quicv":"","ak.tlsv":"tls1.3","ak.0rtt":"","ak.csrc":"-","ak.acc":"reno","ak.t":"1616387893","ak.ak":"hOBiQwZUYzCg5VSAfCLimQ==OX6CijWlo7WWri4Py1SqVSjhIKOyDSMFiR5EQmFO7WpHNJiO35l2MGmvsz2g1XaBJV2gC6LE7Hvjra5cMvmSyC/7Na+jb+dCKabZ7VAGjZ+wk/jSc6Ea0DZ5+BeZw6jVZdMD0EhkHxtn5cIWznq1LZXv9kctET/LluUKG4/2hhbV3O52E82UCn9PMz0qHXkMzv8tWHLQ1uVLlHwkmnik0mL+KBsGhbJZdbIymeM4Lc9JWs8On+8wz1gAJZY0sd2s68mSjdvJ6LFRnh07RufPQRW6NaV7QRDbCRjzcnRQlQr5XvxErU7R3OTr+hxxXgjWF7ZuSN8WFHNzb18EjRRWTZjgx73g2WN4gIQVRX5SPtAUxDlvaNuTY2joHfDZJ8csVHL7TkQzrgI+z7hdkB9s69sIYKOj4tYQxjsYQfJ70+E=","ak.pv":"141","ak.dpoabenc":""};if(""!==t)i["ak.ruds"]=t;var _={i:!1,av:function(e){var t="http.initiator";if(e&&(!e[t]||"spa_hard"===e[t]))i["ak.feo"]=void 0!==a.aFeoApplied?1:0,BOOMR.addVar(i)},rv:function(){var a=["ak.bpcip","ak.cport","ak.cr","ak.csrc","ak.gh","ak.ipv","ak.m","ak.n","ak.ol","ak.proto","ak.quicv","ak.tlsv","ak.0rtt","ak.r","ak.acc","ak.t"];BOOMR.removeVar(a)}};BOOMR.plugins.AK={akVars:i,akDNSPreFetchDomain:n,init:function(){if(!_.i){var a=BOOMR.subscribe;a("before_beacon",_.av,null,null),a("onbeacon",_.rv,null,null),_.i=!0}return this},is_complete:function(){return!0}}}}()}(window);</script></head>

    <body  class="post-template-default single single-post postid-101742 single-format-standard wp-megamenu" id="short-header">
        <script src="/wp-content/themes/securingtomorrow/js/header_enterprise.js"></script>
        <div id="wrapper">
            <div class="textwidget custom-html-widget"><style>
	.headerbarContainer {
    background: rgba(0,0,0,0.9);
}
</style>
<header id="header">  
	<div class="headerbarContainer">
		<div class="headerbarContent">
			<div class="logo">
				 <img src="https://www.mcafee.com/enterprise/en-us/img/icons/logo-white.svg" alt="McAfee Logo"/>
			</div>
			<div class="quicklinks">
			 	<a class="symbols-label" href="https://www.mcafee.com/consumer/en-us/store/m0/index.html"><span>For Home</span></a>
			 	<a class="symbols-label" href="/enterprise/en-us/home.html"><span>For Enterprise</span></a>
			 	<a class="symbols-label" href="/enterprise/en-us/global-contact-us.html"><i class="symbol-contact"></i></a>
			</div>
		</div>
	</div>
</header>



<style>


@media screen and (min-width: 1025px) {
.hero{height: 756px !important;}
.hero.medium {
    min-height: 0;
    height: 640px  !important;
}
.hero.small {
    min-height: 0;
    height: 510px  !important;
}
.hero.title {
    height: 350px  !important;
}
	}
</style> 
<script>
$("document").ready(function(){
    $(".hero.title h1").each(function() {
        if ($(this).text().length > 50) {
            $(this).addClass("pt")
        }
    });
});
</script></div>  
		
<section class="hero title">
    <div class="bg-stretch">
        <img src="https://www.mcafee.com/wp-content/themes/securingtomorrow/img/light-shield-pattern.png" alt="">
    </div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-12 col-xs-12">
                <h1>RagnarLocker Ransomware Threatens to Release Confidential Information</h1>
            </div>
        </div>
    </div>
</section>

<main id="main">

    <nav class="anchor-links">
        <div class="container medium">
            <div style="float:left">
<nav id="wp-megamenu-blog" class="wp-megamenu-wrap   ">
			<div class="wpmm-fullwidth-wrap"></div>
			<div class="wpmm-nav-wrap wpmm-main-wrap-blog">
				<a href="javascript:;" class="wpmm_mobile_menu_btn show-close-icon"><i class="fa fa-bars"></i> Menu</a> 
					<ul id="menu-mcafee-blog-navigation-new-05020" class="wp-megamenu" ><li id="wp-megamenu-item-101279" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101279  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#">Consumer <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-6805053755537084297" class="wpmm-row wp-megamenu-item-6805053755537084297 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-1.1533115921048E+19" class="wpmm-col wpmm-col-12 wp-megamenu-item-1.1533115921048E+19 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101279 wpmm-submenu-right"><div class="menu-consumer-category-container"><ul id="menu-consumer-category" class="menu"><li id="menu-item-97453" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97453"><a href="/blogs/consumer/hackable/">Hackable? Podcast</a></li>
<li id="menu-item-97424" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97424"><a href="/blogs/consumer/consumer-threat-notices/">Consumer Threat Notices</a></li>
<li id="menu-item-97425" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97425"><a href="/blogs/consumer/family-safety/">Family Safety</a></li>
<li id="menu-item-97426" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97426"><a href="/blogs/consumer/identity-protection/">Identity Protection</a></li>
<li id="menu-item-97427" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97427"><a href="/blogs/consumer/mobile-and-iot-security/">Mobile and IoT Security</a></li>
<li id="menu-item-101334" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-101334"><a href="/blogs/consumer/">All Consumer Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-101280" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101280  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#">Enterprise <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-6929972101952162698" class="wpmm-row wp-megamenu-item-6929972101952162698 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-1.5468315792599E+19" class="wpmm-col wpmm-col-12 wp-megamenu-item-1.5468315792599E+19 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101280 wpmm-submenu-right"><div class="menu-enterprise-category-container"><ul id="menu-enterprise-category" class="menu"><li id="menu-item-97421" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97421"><a href="/blogs/enterprise/cloud-security/">Cloud Security</a></li>
<li id="menu-item-97451" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97451"><a href="/blogs/enterprise/endpoint-security/">Endpoint Security</a></li>
<li id="menu-item-97422" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97422"><a href="/blogs/enterprise/security-operations/">Security Operations</a></li>
<li id="menu-item-97452" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97452"><a href="/blogs/enterprise/data-security/">Data Security</a></li>
<li id="menu-item-101336" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-101336"><a href="/blogs/enterprise/">All Enterprise Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-101281" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101281  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#">Corporate <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-6168142863255850891" class="wpmm-row wp-megamenu-item-6168142863255850891 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-1.0725541608452E+19" class="wpmm-col wpmm-col-12 wp-megamenu-item-1.0725541608452E+19 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101281 wpmm-submenu-right"><div class="menu-other-blogs-container"><ul id="menu-other-blogs" class="menu"><li id="menu-item-97442" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97442"><a href="/blogs/other-blogs/executive-perspectives/">Executive Perspectives</a></li>
<li id="menu-item-97441" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-97441"><a href="/blogs/other-blogs/mcafee-labs/">McAfee Labs</a></li>
<li id="menu-item-97443" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97443"><a href="/blogs/other-blogs/life-at-mcafee/">Life at McAfee</a></li>
<li id="menu-item-97440" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97440"><a href="/blogs/other-blogs/podcast/">Podcast</a></li>
<li id="menu-item-97444" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97444"><a href="/blogs/other-blogs/mcafee-partners/">McAfee Partners</a></li>
<li id="menu-item-101340" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-101340"><a href="/blogs/other-blogs/">All Corporate Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-101282" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101282  wpmm_dropdown_menu  wpmm-fadeindown wpmm-submenu-right"><a href="/blogs/authors/">Authors</a></li>
<li id="wp-megamenu-item-101283" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101283  wpmm_dropdown_menu  wpmm-fadeindown wpmm-submenu-right"><a href="/blogs/subscribe/">Subscribe</a></li>
<li id="wp-megamenu-item-101284" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101284  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#"><span class='wpmm-selected-icon wpmm-selected-icon-left'><i class='fa fa-globe'></i></span> <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-2385026031308890510" class="wpmm-row wp-megamenu-item-2385026031308890510 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-7753054460115929349" class="wpmm-col wpmm-col-12 wp-megamenu-item-7753054460115929349 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101284 wpmm-submenu-right"><div class="menu-languages-category-container"><ul id="menu-languages-category" class="menu"><li id="menu-item-97433" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97433"><a href="/blogs/languages/italia/">Italia</a></li>
<li id="menu-item-97434" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97434"><a href="/blogs/languages/japanese/">日本語</a></li>
<li id="menu-item-97435" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97435"><a href="/blogs/languages/espanol/">Español</a></li>
<li id="menu-item-97436" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97436"><a href="/blogs/languages/francais/">Français</a></li>
<li id="menu-item-97437" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97437"><a href="/blogs/languages/german/">German</a></li>
<li id="menu-item-97438" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97438"><a href="/blogs/languages/portugues/">Português</a></li>
<li id="menu-item-101338" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-101338"><a href="/blogs/languages/">All Language Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-" class="wpmm-social-link wpmm-social-link- wp-megamenu-item-  wpmm_dropdown_menu  wpmm-fadeindown wpmm-submenu-right"><a target="_blank" ><i class=""></i></a></li>
</ul>
			</div>
		</nav>            </div>
            <div class="anchors right">
                <form role="search" method="get" class="blog-search search-form" action="https://www.mcafee.com/blogs/">
                    <button type="submit" class="search-submit"><i class="symbol-arrow-forward"></i></button>
                    <input type="search" class="search-field" placeholder="Search Blogs" value="" name="s" />


                </form>  
            </div>

        </div>
    </nav>

    <div class="wrap-section padding-top-xs"> 
        <div class="container medium">
 
        <div class="breadcrumb-container theme1">
            <ul itemscope itemtype="http://schema.org/BreadcrumbList">
                
                    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" title="Mcafee" href="/"><span itemprop="name">Mcafee</span></a><span class="separator">/</span><meta itemprop="position" content="1"></li>
                    
                    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" title="Home" href="https://www.mcafee.com/blogs"><span itemprop="name">Home</span></a><span class="separator">/</span><meta itemprop="position" content="2"></li>
                    
                    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" title="Other Blogs" href="/blogs/other-blogs/"><span itemprop="name">Other Blogs</span></a><span class="separator">/</span><meta itemprop="position" content="3"></li>
                    
                    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" title="McAfee Labs" href="/blogs/other-blogs/mcafee-labs/"><span itemprop="name">McAfee Labs</span></a><span class="separator">/</span><meta itemprop="position" content="4"></li>
                    
                    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" title="RagnarLocker Ransomware Threatens to Release Confidential Information" href="#"><span itemprop="name">RagnarLocker Ransomware Threatens to Release Confidential Information</span></a><meta itemprop="position" content="5"></li>
                                   </ul>
        </div>
        <style type="text/css">
            .breadcrumb-container {
                font-size: 13px;
            }
            .breadcrumb-container ul {
                margin: 0;
                padding: 0;
            }
            .breadcrumb-container li {
                box-sizing: unset;
                display: inline-block;
                margin: 0;
                padding: 0;
            }
            .breadcrumb-container li a {
                box-sizing: unset;
                padding: 0 10px;
            }
            .breadcrumb-container {
                font-size: 12px  !important;
                padding: 0px;
                margin: 0px;
            }
            .breadcrumb-container li a{
                color:  #c01818  !important;
                font-size:  12px  !important;
                line-height:  12px  !important;
            }
            .breadcrumb-container li .separator {
                color: #53565a  !important;
                font-size:  12px  !important;
            }
                            .breadcrumb-container li:last-child .separator {
                    display: none;
                }
                
							
							
.breadcrumb-container.theme1 li {
	margin: 0;
	padding: 0;
}							
							
.breadcrumb-container.theme1 a {
	background: ;
	display: inline-block;
	margin: 0 5px;
	padding: 5px 10px;
	text-decoration: none;
}

.breadcrumb-container{}
.breadcrumb-container ul{}
.breadcrumb-container li{}
.breadcrumb-container a{}
.breadcrumb-container .separator{}
        </style>
                </div>		 
    </div>

    <div class="wrap-section padding-small article">  
        <div class="container medium"> 
            <div class="border-line"></div>

            <div class="author-block padding-bottom-xs">
                <img class="author" src="/wp-content/uploads/2018/07/alex-300x230.png" />
                <div class="meta">By <a href="/blogs/author/alexandre-mundo/" title="Posts by Alexandre Mundo" class="author url fn" rel="author">Alexandre Mundo</a> on Jun 09, 2020</div>
            </div>

                    <h2>EXECUTIVE SUMMARY</h2>
<p>The RagnarLocker ransomware first appeared in the wild at the end of December 2019 as part of a campaign against compromised networks targeted by its operators.</p>
<p>The ransomware code is small (only 48kb after the protection in its custom packer is removed) and coded in a high programming language (C/C++). Like all ransomware, the<strong> goal of this malware is to encrypt all files that it can and request a ransom for decrypting them.</strong></p>
<p>RagnarLocker’s operators, as we have seen with other bad actors recently, threaten to publish the information they get from compromised machines if ransoms are not paid.</p>
<p>After conducting reconnaissance, the ransomware operators enter the victim’s network and, in some pre-deployment stages, steal information before finally dropping the ransomware that will encrypt all files in the victim’s machines.</p>
<p>The most notable RagnarLocker attack to date saw this malware deployed in a large company where the malware operators then requested a ransom of close to $11 million USD in return for not leaking information stolen from the company. In this report we will talk about the sample used in this attack.</p>
<p>At the time of writing there are no free decryptors for RagnarLocker.</p>
<p><strong>However, certain McAfee products, including personal antivirus, endpoint, and gateway can protect our customers against the threats that we talk about in this report.</strong></p>
<h2>RAGNARLOCKER OVERVIEW</h2>
<p>The unpacked malware is a binary file of 32 bits that can be found as an EXE file.</p>
<p><img class="aligncenter size-full wp-image-101743" src="/wp-content/uploads/2020/06/figure-1.png" alt="" width="518" height="259" srcset="/wp-content/uploads/2020/06/figure-1.png 518w, /wp-content/uploads/2020/06/figure-1-300x150.png 300w, /wp-content/uploads/2020/06/figure-1-205x103.png 205w" sizes="(max-width: 518px) 100vw, 518px" /></p>
<p style="text-align: center;">FIGURE 1. INFORMATION ABOUT THE MALWARE</p>
<p>As can be seen in the previous screenshot, this sample was compiled on the 6th of April 2020. The attack mentioned earlier took place some days later, but this sample was prepared for the victim, as we will explain later.</p>
<table>
<tbody>
<tr>
<td width="104"><strong>Name</strong></td>
<td width="497">malware.exe</td>
</tr>
<tr>
<td width="104"><strong>Size</strong></td>
<td width="497">48,460 bytes unpacked (can change between samples), packed can be variable</td>
</tr>
<tr>
<td width="104"><strong>File-Type</strong></td>
<td width="497">EXE 32 bits (can change between samples)</td>
</tr>
<tr>
<td width="104"><strong>SHA 256</strong></td>
<td width="497">7af61ce420051640c50b0e73e718dd8c55dddfcb58917a3bead9d3ece2f3e929</td>
</tr>
<tr>
<td width="104"><strong>SHA 1</strong></td>
<td width="497">60747604d54a18c4e4dc1a2c209e77a793e64dde</td>
</tr>
<tr>
<td width="104"><strong>Compile time</strong></td>
<td width="497">06-04-2020 (can change between samples)</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h2>TECHNICAL DETAILS</h2>
<p>As we often see with ransomware, RagnarLocker starts preparing some strings of languages for the CIS countries that are embedded within its own code (in Unicode).</p>
<p><img class="aligncenter size-full wp-image-101744" src="/wp-content/uploads/2020/06/figure-2.png" alt="" width="523" height="183" srcset="/wp-content/uploads/2020/06/figure-2.png 523w, /wp-content/uploads/2020/06/figure-2-300x105.png 300w, /wp-content/uploads/2020/06/figure-2-205x72.png 205w" sizes="(max-width: 523px) 100vw, 523px" /></p>
<p style="text-align: center;">FIGURE 2. THE LANGUAGE STRINGS EMBEDDED INTO THE CODE IN THE STACK</p>
<p>The languages that are hardcoded are:</p>
<table>
<tbody>
<tr>
<td>Georgian</td>
</tr>
<tr>
<td>Russian</td>
</tr>
<tr>
<td>Ukrainian</td>
</tr>
<tr>
<td>Moldavian</td>
</tr>
<tr>
<td>Belorussian</td>
</tr>
<tr>
<td>Azerbaijani</td>
</tr>
<tr>
<td>Turkmen</td>
</tr>
<tr>
<td>Kyrgyz</td>
</tr>
<tr>
<td>Kazakh</td>
</tr>
<tr>
<td>Uzbek</td>
</tr>
<tr>
<td>Tajik</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>After preparing these strings, the malware uses the function “GetLocaleInfoW” to get the LOCALE_SYSTEM_DEFAULT language as a string. Once obtained, it will check the system language with the blacklisted languages and, if any of them match, it will terminate itself with the function “TerminateProcess” and with an error result code of 0x29A (as we have seen before with many different malware samples).</p>
<p><img class="aligncenter size-full wp-image-101748" src="/wp-content/uploads/2020/06/figure-3.png" alt="" width="1382" height="521" srcset="/wp-content/uploads/2020/06/figure-3.png 1382w, /wp-content/uploads/2020/06/figure-3-300x113.png 300w, /wp-content/uploads/2020/06/figure-3-1024x386.png 1024w, /wp-content/uploads/2020/06/figure-3-768x290.png 768w, /wp-content/uploads/2020/06/figure-3-205x77.png 205w" sizes="(max-width: 1382px) 100vw, 1382px" /></p>
<p style="text-align: center;">FIGURE 3. CHECK OF THE LANGUAGE AGAINST THE BLACKLIST</p>
<p>The check against the LOCALE_SYSTEM_DEFAULT is to prevent a user from installing a language they would not otherwise use as a means of avoiding infection. The check is made against the language selected in Windows. Of course, not everyone in these countries will be using a CIS language in Windows so English is also ok to use. As with other ransomware families, there is no guarantee that infection will be avoided if other languages are selected as the default.</p>
<p>After this the malware will get the name of the infected computer with the function “GetComputerNameW” and the username of whoever is actively using the machine at that time with the function “GetUserNameW”.</p>
<p><img class="aligncenter size-full wp-image-101749" src="/wp-content/uploads/2020/06/figure-4.png" alt="" width="817" height="391" srcset="/wp-content/uploads/2020/06/figure-4.png 817w, /wp-content/uploads/2020/06/figure-4-300x144.png 300w, /wp-content/uploads/2020/06/figure-4-768x368.png 768w, /wp-content/uploads/2020/06/figure-4-205x98.png 205w" sizes="(max-width: 817px) 100vw, 817px" /></p>
<p style="text-align: center;">FIGURE 4. GET THE COMPUTER NAME AND THE USERNAME</p>
<p>After this the malware will read two registry keys:</p>
<ul>
<li>HKLM\SOFTWARE\Microsoft\Cryptography and the subkey MachineGuid to get the GUID of the victim machine.</li>
<li>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion and the subkey “ProductName” to get the name of the operating system.</li>
</ul>
<p>For this the malware uses the functions “RegOpenKeyExW”, “RegQueryValueExW” and “RegCloseKey” in the hive HKEY_LOCAL_MACHINE. This hive can be read without admin rights.</p>
<p><img class="aligncenter size-full wp-image-101750" src="/wp-content/uploads/2020/06/figure-5.png" alt="" width="969" height="517" srcset="/wp-content/uploads/2020/06/figure-5.png 969w, /wp-content/uploads/2020/06/figure-5-300x160.png 300w, /wp-content/uploads/2020/06/figure-5-768x410.png 768w, /wp-content/uploads/2020/06/figure-5-205x109.png 205w" sizes="(max-width: 969px) 100vw, 969px" /></p>
<p style="text-align: center;">FIGURE 5. READ FROM THE REGISTRY THE NAME OF OPERATING SYSTEM AND GUID</p>
<p>Next, RagnarLocker will prepare the first string in the stack with the function “lstrcpyW” and later will start joining the strings with the function “lstrcatW”.</p>
<p>The sequence is first the GUID of the machine, then the Windows operating system name, the user logged in the machine and, finally, the name of the victim machine.</p>
<p><img class="aligncenter size-full wp-image-101751" src="/wp-content/uploads/2020/06/figure-6.png" alt="" width="772" height="499" srcset="/wp-content/uploads/2020/06/figure-6.png 772w, /wp-content/uploads/2020/06/figure-6-300x194.png 300w, /wp-content/uploads/2020/06/figure-6-768x496.png 768w, /wp-content/uploads/2020/06/figure-6-200x129.png 200w" sizes="(max-width: 772px) 100vw, 772px" /></p>
<p style="text-align: center;">FIGURE 6. GET INFORMATION OF THE USER AND MACHINE AND JOIN ALL STRINGS</p>
<p>In the screenshot some values were modified to protect my virtual machine. After getting this information and preparing the string, the malware makes a custom hash with each.</p>
<p>For this, the malware will reserve some memory with “VirtualAlloc” and get the size of the string and compute the hash in a very small loop. After this it will format the hash with the function “wsprintfW” to have it as a Unicode string.</p>
<p><img class="aligncenter size-full wp-image-101752" src="/wp-content/uploads/2020/06/figure-7.png" alt="" width="1089" height="378" srcset="/wp-content/uploads/2020/06/figure-7.png 1089w, /wp-content/uploads/2020/06/figure-7-300x104.png 300w, /wp-content/uploads/2020/06/figure-7-1024x355.png 1024w, /wp-content/uploads/2020/06/figure-7-768x267.png 768w, /wp-content/uploads/2020/06/figure-7-205x71.png 205w" sizes="(max-width: 1089px) 100vw, 1089px" /></p>
<p style="text-align: center;">FIGURE 7. MAKE THE CUSTOM HASH AND FORMAT AS UNICODE STRING</p>
<p>The hashes are made in the following order:</p>
<ul>
<li>Machine name (g. 0xf843256f*)</li>
<li>Name of the user logged into the machine (e.g. 0x56ef3218*)</li>
<li>GUID of the infected machine (e.g. 0x78ef216f*)</li>
<li>Name of the operating system (e.g. 0x91fffe45*)</li>
<li>Finally, the full string with all strings joined (e.g. 0xe35d68fe*)</li>
</ul>
<p>*The above values have been changed to protect my machine.</p>
<p>After this it will use the function “wsprintfW”, with the template string “%s-%s-%s-%s-%s”, to format the custom hashes together with hyphens between them, but in this case the hashes are in this order:</p>
<ul>
<li>GUID</li>
<li>Operating System Name</li>
<li>Name of the logged in user</li>
<li>Name of the infected machine</li>
<li>Full string with all other strings joined together</li>
</ul>
<p><img class="aligncenter size-full wp-image-101753" src="/wp-content/uploads/2020/06/figure-8.png" alt="" width="892" height="485" srcset="/wp-content/uploads/2020/06/figure-8.png 892w, /wp-content/uploads/2020/06/figure-8-300x163.png 300w, /wp-content/uploads/2020/06/figure-8-768x418.png 768w, /wp-content/uploads/2020/06/figure-8-205x111.png 205w" sizes="(max-width: 892px) 100vw, 892px" /></p>
<p style="text-align: center;">FIGURE 8. CREATE CUSTOM HASH OF THE STRINGS AND FORMAT THE FINAL STRING IN A SPECIAL ORDER</p>
<p>The malware will get the command line of this launch process and will check if it has more than one argument (the first argument is always in C/C++) with the functions “GetCommandLineW”, to get the full command line with arguments if it exists, and “CommandLineToArgvW” to get the arguments if they exist.</p>
<p>If there is more than one argument the malware will avoid the next procedure. To keep the normal flow in the technical details section we will put what happens if only one argument exists. In this case the malware will try to make a Windows Event with the name of the formatted string with all hashes, as explained earlier (in our example case above, 78ef216f-91fffe45-56ef3218-f843256f-e35d68fe).</p>
<p>After trying to create the event the malware will check the last error with the function “GetLastError” and compare with ERROR_ALREADY_EXISTS (0xB7). If the event already exists the malware will check a counter with the value at 0x8000 (32768) and, if is not this value, it will increase the counter by one and try again to make the event, check the last error, and so on, until it can finally make the event, reach the counter value, or it reaches the maximum value in the counter (64233). If the event cannot be created the malware will get the pseudohandle to its own process with the function “GetCurrentProcess” and terminate it with the function “TerminateProcess” with the exit code 0x29A.</p>
<p><img class="aligncenter size-full wp-image-101754" src="/wp-content/uploads/2020/06/figure-9.png" alt="" width="902" height="515" srcset="/wp-content/uploads/2020/06/figure-9.png 902w, /wp-content/uploads/2020/06/figure-9-300x171.png 300w, /wp-content/uploads/2020/06/figure-9-768x438.png 768w, /wp-content/uploads/2020/06/figure-9-205x117.png 205w" sizes="(max-width: 902px) 100vw, 902px" /></p>
<p style="text-align: center;">FIGURE 9. CREATE EVENT LOOP AFTER CHECKING THERE IS ONLY ONE ARGUMENT IN THE COMMAND LINE</p>
<p>This is done for several reasons:</p>
<ul>
<li>The event is created to avoid relaunching another instance of the malware at the same time.</li>
<li>The check of the counter is made if another instance of the malware is launched, to wait for the previous one to finish before continuing the process (this avoids some issues with the malware checking for crypted files).</li>
<li>The check of the argument, as we will explain later, can be used to avoid the event behavior so the malware will always try to encrypt files. It is one of the reasons why a vaccine against this malware is useless if the malware operator executes the malware with an argument as simple as “1”.</li>
</ul>
<p>After this, the malware will try to access in raw mode all units connected to the victim machine in a physical way, preparing the string “\\.\PHYSICALDRIVE%d”. This string will be formatted with the function “wsprintfW”, starting with the first unit that is 0 to a maximum of 16 in a loop. After the format, the malware will use “CreateFileW” and check that it does not return the error “ERROR_INVALID_HANDLE” (that means the unit cannot be accessed or that it does not exist). If this error is returned it will increase the counter and format the string with the new value of the counter. If it can open the handle to the unit in raw mode it will send two commands using the function “DeviceIoControl”.</p>
<p>The commands are:</p>
<ul>
<li>0x7C0F4 -&gt; IOCTL_DISK_SET_DISK_ATTRIBUTES with the attributes of: DISK_ATTRIBUTE_READ_ONLY and DISK_ATTRIBUTE_OFFLINE.</li>
<li>0x70140 -&gt; IOCTL_DISK_UPDATE_PROPERTIES that will be make the drive update its partition table. As the attributes are updated the malware can be accessed in sharing mode on the disk.</li>
</ul>
<p><img class="aligncenter size-full wp-image-101755" src="/wp-content/uploads/2020/06/figure-10.png" alt="" width="673" height="477" srcset="/wp-content/uploads/2020/06/figure-10.png 673w, /wp-content/uploads/2020/06/figure-10-300x213.png 300w, /wp-content/uploads/2020/06/figure-10-182x129.png 182w" sizes="(max-width: 673px) 100vw, 673px" /></p>
<p style="text-align: center;">FIGURE 10. CONTROL THE PHYSICAL DISK TO HAVE ACCESS TO IT</p>
<p>The ransomware’s next action is checking the units that exist and can be accessed without any problem. This can be done in two ways, the first of which is using the functions “FindFirstVolumeA”, “FindNextVolumeA” and “FindVolumeClose”.</p>
<p><img class="aligncenter size-full wp-image-101756" src="/wp-content/uploads/2020/06/figure-11.png" alt="" width="1226" height="402" srcset="/wp-content/uploads/2020/06/figure-11.png 1226w, /wp-content/uploads/2020/06/figure-11-300x98.png 300w, /wp-content/uploads/2020/06/figure-11-1024x336.png 1024w, /wp-content/uploads/2020/06/figure-11-768x252.png 768w, /wp-content/uploads/2020/06/figure-11-205x67.png 205w" sizes="(max-width: 1226px) 100vw, 1226px" /></p>
<p style="text-align: center;">FIGURE 11. GET VOLUME LETTER AND INFORMATION TO CHECK IT EXISTS AND CAN BE ACCESSED</p>
<p>The first two functions return the volume and the special internal value associated with it. This information comes from Windows, so the malware needs to translate it to the logic unit letter associated to this volume. This is done with the function “GetVolumePathNamesForVolumeNameA” that will return the logic letter associated to the volume inspected.</p>
<p>With this letter the function “GetVolumeInformationA” is then used to get information of the volume if it exists and is enabled. If the volume does not exist or cannot be checked the function will fail and the volume ignored, and the process will move onto the next volume in the machine.</p>
<p>Another check is made using the function “GetLogicalDrives” that will return a structure and, by checking one byte, the malware will know if the unit exists or not.</p>
<p>After this, the malware will prepare the keys that later will be needed to encrypt the files. To make them it will get the crypto context with the function “CryptAquireContextW” that will generate random data with “CryptGenRandom” and prepare to permutate this value with the SHA-512 algorithm. These values are the key and nonce of the Salsa20 algorithm that will be used later to encrypt files.</p>
<p><img class="aligncenter size-full wp-image-101757" src="/wp-content/uploads/2020/06/figure-12.png" alt="" width="806" height="526" srcset="/wp-content/uploads/2020/06/figure-12.png 806w, /wp-content/uploads/2020/06/figure-12-300x196.png 300w, /wp-content/uploads/2020/06/figure-12-768x501.png 768w, /wp-content/uploads/2020/06/figure-12-198x129.png 198w" sizes="(max-width: 806px) 100vw, 806px" /></p>
<p style="text-align: center;">FIGURE 12. AQUIRE CRYPTO CONTEXT AND GENERATE SOME DATA AND PREPARE WITH SHA-512</p>
<p>The malware continues decrypting some strings using two steps, one in a big function for the first layer and the other that is used later for the second layer and the final string of the service. The services stopped are:</p>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<td>vss</td>
</tr>
<tr>
<td>sql</td>
</tr>
<tr>
<td>memtas -&gt; associated with MailEnable</td>
</tr>
<tr>
<td>mepocs -&gt; associated with MailEnable</td>
</tr>
<tr>
<td>Sophos -&gt; associated with Sophos Antivirus</td>
</tr>
<tr>
<td>Veeam -&gt; associated with a program to make backups and save in the cloud</td>
</tr>
<tr>
<td>Backup -&gt; associated with Asus WebStorage</td>
</tr>
<tr>
<td>Pulseway -&gt; associated with remote control software for IT departments</td>
</tr>
<tr>
<td>Logme -&gt; associated with remote control software</td>
</tr>
<tr>
<td>Logmein -&gt; associated with a remote control software</td>
</tr>
<tr>
<td>Conectwise -&gt; associated with a remote control software</td>
</tr>
<tr>
<td>Splastop -&gt; associated with a remote control software</td>
</tr>
<tr>
<td>Mysql -&gt; associated with a program of databases</td>
</tr>
<tr>
<td>Dfs -&gt; associated with the Distribute File System (Microsoft)</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Please note: The services list can change between samples.</p>
<p>After decrypting the strings, the malware accesses the SCManager with the function “OpenSCManagerA”. If it does not want access it will ignore all services and continue onto the next step.</p>
<p>If it can open a handle to it, it will get the status of the service with the function “EnumServicesStatusA” and if the service is stopped already will pass to the next one. The malware calls this function two times, firstly to get the correct size needed for this function, with the last error being checked with ¨GetLastError¨ against the value 0xEA (ERROR_MORE_DATA) (that means that the application needs more memory to fill all information than the function gives).</p>
<p><img class="aligncenter size-full wp-image-101758" src="/wp-content/uploads/2020/06/figure-13.png" alt="" width="486" height="434" srcset="/wp-content/uploads/2020/06/figure-13.png 486w, /wp-content/uploads/2020/06/figure-13-300x268.png 300w, /wp-content/uploads/2020/06/figure-13-144x129.png 144w" sizes="(max-width: 486px) 100vw, 486px" /></p>
<p style="text-align: center;">FIGURE 13. OPEN THE SERVICE MANAGER AND ENUMSERVICESTATUS</p>
<p>This memory is reserved and the function called again later, in this case to get the real status and, if not stopped, the malware will open the service with the function “OpenServiceA” and query the status of the service with the function “QueryServiceStatusEx”. If the service is not stopped, it will get all dependencies of the service with “EnumDependentServicesA” and finally it will control the service to stop it with the function “ControlService”.</p>
<p><img class="aligncenter size-full wp-image-101759" src="/wp-content/uploads/2020/06/figure-14.png" alt="" width="562" height="342" srcset="/wp-content/uploads/2020/06/figure-14.png 562w, /wp-content/uploads/2020/06/figure-14-300x183.png 300w, /wp-content/uploads/2020/06/figure-14-205x125.png 205w" sizes="(max-width: 562px) 100vw, 562px" /></p>
<p style="text-align: center;">FIGURE 14. OPEN THE SERVICES AND CONTROL THEM</p>
<p>After this, the malware decrypts a list of the processes that it will try terminating if it finds them in the infected machine. For this decryption, the malware uses a string that converts into an integer and uses this integer as a critical value to decrypt the list.</p>
<p>For this task, the malware will create a snapshot of all processes in the system per this blacklist:</p>
<table>
<tbody>
<tr>
<td><strong>sql</strong></td>
</tr>
<tr>
<td><strong>mysql</strong></td>
</tr>
<tr>
<td><strong>veeam</strong></td>
</tr>
<tr>
<td><strong>oracle</strong></td>
</tr>
<tr>
<td><strong>ocssd</strong></td>
</tr>
<tr>
<td><strong>dbsnmp</strong></td>
</tr>
<tr>
<td><strong>synctime</strong></td>
</tr>
<tr>
<td><strong>agntsvc</strong></td>
</tr>
<tr>
<td><strong>isqlpussvc</strong></td>
</tr>
<tr>
<td><strong>xfssvccon</strong></td>
</tr>
<tr>
<td><strong>mydesktopqos</strong></td>
</tr>
<tr>
<td><strong>ocomm</strong></td>
</tr>
<tr>
<td><strong>dbeng50</strong></td>
</tr>
<tr>
<td><strong>sqbcoreservice</strong></td>
</tr>
<tr>
<td><strong>excel</strong></td>
</tr>
<tr>
<td><strong>infopath</strong></td>
</tr>
<tr>
<td><strong>msaccess</strong></td>
</tr>
<tr>
<td><strong>mspub</strong></td>
</tr>
<tr>
<td><strong>onenote</strong></td>
</tr>
<tr>
<td><strong>outlook</strong></td>
</tr>
<tr>
<td><strong>powerpnt</strong></td>
</tr>
<tr>
<td><strong>steam</strong></td>
</tr>
<tr>
<td><strong>thebat</strong></td>
</tr>
<tr>
<td><strong>thunderbird</strong></td>
</tr>
<tr>
<td><strong>visio</strong></td>
</tr>
<tr>
<td><strong>wordpad</strong></td>
</tr>
<tr>
<td><strong>winword</strong></td>
</tr>
<tr>
<td><strong>EduLink2SIMS</strong></td>
</tr>
<tr>
<td><strong>bengine</strong></td>
</tr>
<tr>
<td><strong>benetns</strong></td>
</tr>
<tr>
<td><strong>beserver</strong></td>
</tr>
<tr>
<td><strong>pvlsvr</strong></td>
</tr>
<tr>
<td><strong>beremote</strong></td>
</tr>
<tr>
<td><strong>VxLockdownServer</strong></td>
</tr>
<tr>
<td><strong>postgres</strong></td>
</tr>
<tr>
<td><strong>fdhost</strong></td>
</tr>
<tr>
<td><strong>WSSADMIN</strong></td>
</tr>
<tr>
<td><strong>wsstracing</strong></td>
</tr>
<tr>
<td><strong>OWSTIMER</strong></td>
</tr>
<tr>
<td><strong>dfssvc.exe</strong></td>
</tr>
<tr>
<td><strong>swc_service.exe</strong></td>
</tr>
<tr>
<td><strong>sophos</strong></td>
</tr>
<tr>
<td><strong>SAVAdminService</strong></td>
</tr>
<tr>
<td><strong>SavService.exe</strong></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Please note: The processes list can change between samples.</p>
<p>After making the snapshot it will enumerate all processes with the functions “Process32FirstW” and “Process32NextW” and for each process found will call the function “WideCharToMultyByte” to get the size needed to convert the name of the process returned in Unicode into Ascii. Later it reserves memory for the name and calls the same function to make the string conversion.</p>
<p><img class="aligncenter size-full wp-image-101761" src="/wp-content/uploads/2020/06/figure-15.png" alt="" width="1077" height="604" srcset="/wp-content/uploads/2020/06/figure-15.png 1077w, /wp-content/uploads/2020/06/figure-15-300x168.png 300w, /wp-content/uploads/2020/06/figure-15-1024x574.png 1024w, /wp-content/uploads/2020/06/figure-15-768x431.png 768w, /wp-content/uploads/2020/06/figure-15-205x115.png 205w" sizes="(max-width: 1077px) 100vw, 1077px" /></p>
<p style="text-align: center;">FIGURE 15. GET ALL SYSTEM PROCESSES</p>
<p>If the malware, after comparison with the function “StrStrIA”, detects some of the blacklisted processes it will open the process with the function “OpenProcess” and terminate it with the function “TerminateProcess” and with the exit  code of 0x29A.</p>
<p><img class="aligncenter size-full wp-image-101762" src="/wp-content/uploads/2020/06/figure-16.png" alt="" width="991" height="438" srcset="/wp-content/uploads/2020/06/figure-16.png 991w, /wp-content/uploads/2020/06/figure-16-300x133.png 300w, /wp-content/uploads/2020/06/figure-16-768x339.png 768w, /wp-content/uploads/2020/06/figure-16-205x91.png 205w" sizes="(max-width: 991px) 100vw, 991px" /></p>
<p style="text-align: center;">FIGURE 16. OPEN THE PROCESS AND TERMINATE IT IF IT IS BLACKLISTED</p>
<p>The malware will check for all processes in the blacklist, using part of the string rather than the exact name. Not using the extension allows for greater obfuscation but carries the risk that some processes could be closed by accident if they share that string.</p>
<p>After this the malware will check if the operating system is 64-bit or not with the function “GetNativeSystemInfo” against the value 9 (that means that the OS is 64-bit).</p>
<p>If the operating system is 64-bit it will get, using “LoadLibraryW” and “GetProcAddress”, the function “Woe64EnableWow64FsRedirection” to remove the redirection that by default is found in 64-bit operating systems. This call is done in a dynamic way, but the malware does not check that the function was retrieved with success; usually it will be, but it is not 100% certain and a crash calling a null pointer could ensue.</p>
<p><img class="aligncenter wp-image-101763 size-full" src="/wp-content/uploads/2020/06/figure-17.png" alt="" width="1078" height="600" srcset="/wp-content/uploads/2020/06/figure-17.png 1078w, /wp-content/uploads/2020/06/figure-17-300x167.png 300w, /wp-content/uploads/2020/06/figure-17-1024x570.png 1024w, /wp-content/uploads/2020/06/figure-17-768x427.png 768w, /wp-content/uploads/2020/06/figure-17-205x114.png 205w" sizes="(max-width: 1078px) 100vw, 1078px" /></p>
<p style="text-align: center;">FIGURE 17. CHECK THE OPERATING SYSTEM AND DISABLE REDIRECTION IF NEEDED</p>
<p>After this, the malware will prepare a string in Unicode embedded in the code with the string “wmic.exe shadowcopy delete” and will call it with the function “CreateProcessW”. After the call it will wait for up to an infinite amount of time using the function “WaitForSingleObject” so that the “wmic.exe” process can finish, irrespective of the size and number of shadow volumes, available machine resources, etc.</p>
<p>Of course, the malware will also use the typical program of “vssadmin” to delete the shadow volumes with the command “vssadmin delete shadows /all /quiet”, as well as with the function “CreateProcessW”. After that it will wait again with “WaitForSingleObject” for the end of the new process.</p>
<p>When it finishes, the malware will check again if the operating system is 64-bit and, if it is, will use “LoadLibraryW” and “GetProcAddress” to get the function “Wo64EnableWow64FsRedirection” to leave the system as before with the redirection. Again, the malware does not check that the function is resolved with success and calls it directly in a dynamic way.</p>
<p><img class="aligncenter size-full wp-image-101764" src="/wp-content/uploads/2020/06/figure-18.png" alt="" width="1040" height="585" srcset="/wp-content/uploads/2020/06/figure-18.png 1040w, /wp-content/uploads/2020/06/figure-18-300x169.png 300w, /wp-content/uploads/2020/06/figure-18-1024x576.png 1024w, /wp-content/uploads/2020/06/figure-18-768x432.png 768w, /wp-content/uploads/2020/06/figure-18-205x115.png 205w" sizes="(max-width: 1040px) 100vw, 1040px" /></p>
<p style="text-align: center;">FIGURE 18. DESTROY THE SHADOW VOLUMES AND RE-ENABLE THE REDIRECTION</p>
<p>While it seems like a mistake to destroy the shadow volumes again, it is not, as RagnarLocker has support for Windows XP and the WMIC classes do not exist in that operating system, hence the need to use the old program “vssadmin” that exists in both new and old operating systems.</p>
<p>The malware continues with the decryption of one PEM block encoded in base64 and the ransom note is prepared for the target in memory.</p>
<p><img class="aligncenter size-full wp-image-101765" src="/wp-content/uploads/2020/06/figure-19.png" alt="" width="1018" height="228" srcset="/wp-content/uploads/2020/06/figure-19.png 1018w, /wp-content/uploads/2020/06/figure-19-300x67.png 300w, /wp-content/uploads/2020/06/figure-19-768x172.png 768w, /wp-content/uploads/2020/06/figure-19-205x46.png 205w" sizes="(max-width: 1018px) 100vw, 1018px" /></p>
<p style="text-align: center;">FIGURE 19. DECRYPTION OF THE PEM BLOCK AND THE RANSOM NOTE</p>
<p>An example of the ransom note, with confidential information removed, can be seen below:</p>
<p><img class="aligncenter size-full wp-image-101766" src="/wp-content/uploads/2020/06/figure-20.png" alt="" width="520" height="402" srcset="/wp-content/uploads/2020/06/figure-20.png 520w, /wp-content/uploads/2020/06/figure-20-300x232.png 300w, /wp-content/uploads/2020/06/figure-20-167x129.png 167w" sizes="(max-width: 520px) 100vw, 520px" /></p>
<p style="text-align: center;">FIGURE 20. EXAMPLE REDACTED RANSOM NOTE</p>
<p>After preparing both things the malware decodes the PEM block from the base64 as an object, getting a key that will be used to protect the keys used in the crypto process (of course this procedure may change in future samples as the malware evolves) of the RSA algorithm. It is important to note here that this RSA key changes per sample.</p>
<p><img class="aligncenter size-full wp-image-101767" src="/wp-content/uploads/2020/06/figure-21.png" alt="" width="707" height="559" srcset="/wp-content/uploads/2020/06/figure-21.png 707w, /wp-content/uploads/2020/06/figure-21-300x237.png 300w, /wp-content/uploads/2020/06/figure-21-163x129.png 163w" sizes="(max-width: 707px) 100vw, 707px" /></p>
<p style="text-align: center;">FIGURE 21. DECODE FROM BASE64 AND DECODE THE OBJECT AND IMPORT IT TO USE LATER</p>
<p>With this key it will encrypt the two random keys previously generated to protect them in memory. After that, the crypto will release the memory.</p>
<p>Later, it will get the name of the infected machine again, get the size of the name and will calculate the custom hash with the same algorithm as before.</p>
<p><img class="aligncenter size-full wp-image-101768" src="/wp-content/uploads/2020/06/figure-22.png" alt="" width="945" height="527" srcset="/wp-content/uploads/2020/06/figure-22.png 945w, /wp-content/uploads/2020/06/figure-22-300x167.png 300w, /wp-content/uploads/2020/06/figure-22-768x428.png 768w, /wp-content/uploads/2020/06/figure-22-205x114.png 205w" sizes="(max-width: 945px) 100vw, 945px" /></p>
<p style="text-align: center;">FIGURE 22. CRYPT THE PREVIOUSLY GENERATED VALUES AND GET THE COMPUTER NAME</p>
<p>With this hash it will prepare a string with this structure:</p>
<ul>
<li>RGNR_</li>
<li>hash from the name of the victim machine</li>
<li>the extension .txt</li>
<li>a backslash character at the start of the string</li>
</ul>
<p>It is done with the function “lstrcatW”.</p>
<p><img class="aligncenter size-full wp-image-101769" src="/wp-content/uploads/2020/06/figure-23.png" alt="" width="1189" height="579" srcset="/wp-content/uploads/2020/06/figure-23.png 1189w, /wp-content/uploads/2020/06/figure-23-300x146.png 300w, /wp-content/uploads/2020/06/figure-23-1024x499.png 1024w, /wp-content/uploads/2020/06/figure-23-768x374.png 768w, /wp-content/uploads/2020/06/figure-23-205x100.png 205w" sizes="(max-width: 1189px) 100vw, 1189px" /></p>
<p style="text-align: center;">FIGURE 23. CREATION OF THE RANSOM NOTE NAME</p>
<p>With this string it will get the folder of “My Documents” for all users with the function “SHGetSpecialFolderPathW” (this function, based on the operating system, will get different paths for the documents). This string with the path of the folders will join with the string of the ransom note name and later make the final path to create the file.</p>
<p><img class="aligncenter size-full wp-image-101770" src="/wp-content/uploads/2020/06/figure-24.png" alt="" width="920" height="602" srcset="/wp-content/uploads/2020/06/figure-24.png 920w, /wp-content/uploads/2020/06/figure-24-300x196.png 300w, /wp-content/uploads/2020/06/figure-24-768x503.png 768w, /wp-content/uploads/2020/06/figure-24-197x129.png 197w" sizes="(max-width: 920px) 100vw, 920px" /></p>
<p style="text-align: center;">FIGURE 24. GET THE DOCUMENTS FOLDER TO LATER WRITE THE RANSOM NOTE</p>
<p>After this it will encode in base64 the critical information to decrypt the files with the function “CryptBinaryToStringA”. The malware uses the function the first time to get the size needed and reserve memory and then uses it again to encode the data. After encoding the data, it creates the ransom note file in the documents path with the string previously joined with the path with the function “CreateFileW” and will write the contents of the ransom note that has been prepared in memory. Later, it will format a special string with some hardcoded characters with “&#8212;RAGNAR SECRET&#8212;” as a start of block and end of block and, between, will format the encode string in base64 and write in the ransom note.</p>
<p><img class="aligncenter size-full wp-image-101771" src="/wp-content/uploads/2020/06/figure-25.png" alt="" width="939" height="600" srcset="/wp-content/uploads/2020/06/figure-25.png 939w, /wp-content/uploads/2020/06/figure-25-300x192.png 300w, /wp-content/uploads/2020/06/figure-25-768x491.png 768w, /wp-content/uploads/2020/06/figure-25-202x129.png 202w" sizes="(max-width: 939px) 100vw, 939px" /></p>
<p style="text-align: center;">FIGURE 25. CREATION OF THE RANSOM NOTE AND PUT THE RAGNAR SECRET AT THE END OF IT</p>
<p>Later, the malware will create a new string with the strings:</p>
<ul>
<li>.ragnar_</li>
<li>hash of the name of the victim machine</li>
</ul>
<p>This string will be used later as the new extension in the crypted files. After this the malware will enumerate again the logic units of the system with the function “GetLogicalDrivesW” and, to check if the unit is correct, will use the function “GetVolumeInformationW” and check the type of the unit and avoid the type of CD-ROM. For each logic unit it will enumerate all files and folders and will start the crypto process.</p>
<p><img class="aligncenter size-full wp-image-101772" src="/wp-content/uploads/2020/06/figure-26.png" alt="" width="896" height="496" srcset="/wp-content/uploads/2020/06/figure-26.png 896w, /wp-content/uploads/2020/06/figure-26-300x166.png 300w, /wp-content/uploads/2020/06/figure-26-768x425.png 768w, /wp-content/uploads/2020/06/figure-26-205x113.png 205w" sizes="(max-width: 896px) 100vw, 896px" /></p>
<p style="text-align: center;">FIGURE 26. GET ALL LOGIC UNITS AND CHECK THEM</p>
<p>Before starting the crypto process, the malware will try to write the ransom note in the root of each unit that is found as a target.</p>
<p>The malware will ignore folders with these names:</p>
<table>
<tbody>
<tr>
<td>Windows</td>
</tr>
<tr>
<td>Windows.old</td>
</tr>
<tr>
<td>Internet Explorer</td>
</tr>
<tr>
<td>Google</td>
</tr>
<tr>
<td>Opera</td>
</tr>
<tr>
<td>Opera Software</td>
</tr>
<tr>
<td>Mozilla</td>
</tr>
<tr>
<td>Mozilla Firefox</td>
</tr>
<tr>
<td>$Recycle.Bin</td>
</tr>
<tr>
<td>ProgramData</td>
</tr>
<tr>
<td>All Users</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>The ransom note will be written in all folders that are affected and, as with other ransomware, it will use the functions “FindFirstFileW” and “FindNextFileW” to enumerate all contents in each folder.</p>
<p><img class="aligncenter size-full wp-image-101773" src="/wp-content/uploads/2020/06/figure-27.png" alt="" width="687" height="368" srcset="/wp-content/uploads/2020/06/figure-27.png 687w, /wp-content/uploads/2020/06/figure-27-300x161.png 300w, /wp-content/uploads/2020/06/figure-27-205x110.png 205w" sizes="(max-width: 687px) 100vw, 687px" /></p>
<p style="text-align: center;">FIGURE 27. CHECK OF THE BLACKLISTED FOLDER NAMES</p>
<p>RagnarLocker also avoids crypting certain files:</p>
<table>
<tbody>
<tr>
<td>autorun.inf</td>
</tr>
<tr>
<td>boot.ini</td>
</tr>
<tr>
<td>bootfont.bin</td>
</tr>
<tr>
<td>bootsect.bak</td>
</tr>
<tr>
<td>bootmgr</td>
</tr>
<tr>
<td>botmgr.efi</td>
</tr>
<tr>
<td>bootmgfw.efi</td>
</tr>
<tr>
<td>desktop.ini</td>
</tr>
<tr>
<td>iconcache.db</td>
</tr>
<tr>
<td>ntldr</td>
</tr>
<tr>
<td>ntuser.dat</td>
</tr>
<tr>
<td>ntuser.dat.log</td>
</tr>
<tr>
<td>ntuser.ini</td>
</tr>
<tr>
<td>thumbs.db</td>
</tr>
<tr>
<td>RGNR_&lt;hash&gt;.txt</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><img class="aligncenter size-full wp-image-101774" src="/wp-content/uploads/2020/06/figure-28.png" alt="" width="709" height="389" srcset="/wp-content/uploads/2020/06/figure-28.png 709w, /wp-content/uploads/2020/06/figure-28-300x165.png 300w, /wp-content/uploads/2020/06/figure-28-205x112.png 205w" sizes="(max-width: 709px) 100vw, 709px" /></p>
<p style="text-align: center;">FIGURE 28. CHECK OF BLACKLISTED FILE NAMES</p>
<p>If a file has one of these names it will be ignored and, if it has another name, the malware will avoid any file that has these extensions:</p>
<table>
<tbody>
<tr>
<td>.db</td>
</tr>
<tr>
<td>.sys</td>
</tr>
<tr>
<td>.dll</td>
</tr>
<tr>
<td>.lnk</td>
</tr>
<tr>
<td>.msi</td>
</tr>
<tr>
<td>.drv</td>
</tr>
<tr>
<td>.exe</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><img class="aligncenter size-full wp-image-101775" src="/wp-content/uploads/2020/06/figure-29.png" alt="" width="734" height="366" srcset="/wp-content/uploads/2020/06/figure-29.png 734w, /wp-content/uploads/2020/06/figure-29-300x150.png 300w, /wp-content/uploads/2020/06/figure-29-205x102.png 205w" sizes="(max-width: 734px) 100vw, 734px" /></p>
<p style="text-align: center;">FIGURE 29. CHECK OF BLACKLISTED EXTENSIONS</p>
<p>These checks are in place to prevent the ransomware from destroying the operating system as the victim needs to have access to the machine to pay the ransom.</p>
<p>For each file that passes all controls a thread will be created that will encrypt it. After creating all threads, the malware will wait for up to an infinite amount of time with the function “WaitForMultipleObjects”.</p>
<p>In the crypto process, in the threads, the malware will check if the file has the mark “_RAGNAR_” at the end with the function “SetFilePointerEx” and by reading 9 bytes and checking if they are this string. If it has this mark the file will be ignored in the crypto process and will be renamed again (with an extension name based on the current machine name).</p>
<p><img class="aligncenter size-full wp-image-101776" src="/wp-content/uploads/2020/06/figure-30.png" alt="" width="778" height="602" srcset="/wp-content/uploads/2020/06/figure-30.png 778w, /wp-content/uploads/2020/06/figure-30-300x232.png 300w, /wp-content/uploads/2020/06/figure-30-768x594.png 768w, /wp-content/uploads/2020/06/figure-30-167x129.png 167w" sizes="(max-width: 778px) 100vw, 778px" /></p>
<p style="text-align: center;">FIGURE 30. CHECK OF THE MARK OF CRYPTO IN THE FILE</p>
<p>In other cases the malware will encrypt the file and at the end of it will write the block crypted of the key, used in a block of 256 bytes, and the nonce used in another block of 256 bytes and, finally, the mark “_RAGNAR_”, along with one byte as NULL to end the string (that makes 9 bytes). The key and nonce used in the Salsa20 algorithm are encrypted by the RSA public key embedded in the malware. This ensures only the malware developers can have the RSA private key that belongs to the public key used to decrypt the key and nonce and, thus, decrypt the files in the system.</p>
<p>Before writing this information, the malware will use the function “LockFile” and, when the process of writing the function is finished, “UnlockFile” to release the file already crypted. This is done to prevent the file being changed or deleted during the encryption process.</p>
<p><img class="aligncenter size-full wp-image-101777" src="/wp-content/uploads/2020/06/figure-31.png" alt="" width="546" height="487" srcset="/wp-content/uploads/2020/06/figure-31.png 546w, /wp-content/uploads/2020/06/figure-31-300x268.png 300w, /wp-content/uploads/2020/06/figure-31-145x129.png 145w" sizes="(max-width: 546px) 100vw, 546px" /></p>
<p style="text-align: center;">FIGURE 31. WRITE THE NEW CONTENTS AT THE END OF THE FILE</p>
<p>After the crypto, or if the file is already crypted, the malware will change the extension to a new one, such as “.ragnar_45EF5632”.</p>
<p><img class="aligncenter size-full wp-image-101778" src="/wp-content/uploads/2020/06/figure-32.png" alt="" width="903" height="302" srcset="/wp-content/uploads/2020/06/figure-32.png 903w, /wp-content/uploads/2020/06/figure-32-300x100.png 300w, /wp-content/uploads/2020/06/figure-32-768x257.png 768w, /wp-content/uploads/2020/06/figure-32-205x69.png 205w" sizes="(max-width: 903px) 100vw, 903px" /></p>
<p style="text-align: center;">FIGURE 32. CHANGE OF THE EXTENSION OF THE CRYPTED FILE</p>
<p>After all threads of crypto, the malware tries to get the session of the Terminal Services or the session of the user logged in the local machine with the function “WTSGetActiveConsoleSessionId”. With this session it gets the current process of the malware with the function “GetCurrentProcess” and the token of this process with the function “OpenProcessToken”. With the session that was got previously it tries to duplicate the token with the function “DuplicateTokenEx” and sets this token with the function “SetTokenInformation”. After this it will get the system directory with the function “GetSystemDirectoryW” and joins to this path the string “\notepad.exe”.</p>
<p><img class="aligncenter size-full wp-image-101779" src="/wp-content/uploads/2020/06/figure-33.png" alt="" width="776" height="599" srcset="/wp-content/uploads/2020/06/figure-33.png 776w, /wp-content/uploads/2020/06/figure-33-300x232.png 300w, /wp-content/uploads/2020/06/figure-33-768x593.png 768w, /wp-content/uploads/2020/06/figure-33-167x129.png 167w" sizes="(max-width: 776px) 100vw, 776px" /></p>
<p style="text-align: center;">FIGURE 33. GET THE SESSION OF THE LOCAL USER OR TERMINAL SERVICES AND MANAGE THE TOKENS</p>
<p>With this prepared, the malware executes Notepad and, as an argument, the ransom note to show to the user what happened in the machine. The function used in this case is “CreateProcessAsUserW” to impersonate the user that had the session previously. Of course, this function is called with the desktop as “WinSta0\Default”.</p>
<p><img class="aligncenter size-full wp-image-101780" src="/wp-content/uploads/2020/06/figure-34.png" alt="" width="702" height="493" srcset="/wp-content/uploads/2020/06/figure-34.png 702w, /wp-content/uploads/2020/06/figure-34-300x211.png 300w, /wp-content/uploads/2020/06/figure-34-184x129.png 184w" sizes="(max-width: 702px) 100vw, 702px" /></p>
<p style="text-align: center;">FIGURE 34. CREATE A PROCESS OF THE NOTEPAD TO SHOW THE RANSOM NOTE</p>
<p>After this the malware finishes itself with the function “ExitProcess” and a code of exit of 0.</p>
<h2>VACCINE</h2>
<p>RagnarLocker can have a vaccine if a program is made that can make the event, as explained in the technical part of this blog. If this event exists, the malware does not make anything in the system, but this type of vaccine is not likely to offer a long-term solution for several reasons:</p>
<ul>
<li>The way that the event is done, the malware developers can change the algorithm, or the order of the name of the event, or make a mutex instead of an event and the vaccine will stop working.</li>
<li>The algorithm has a hardcoded value. If this value is changed the final hash will be different and the vaccine becomes useless.</li>
<li>The malware is developed in such a way that if it has at least two arguments the event is not created so, if the operators want to execute with safety, they need only to execute with an argument, for example “&lt;malware.exe&gt; 1”.</li>
<li>The malware may evolve over time so the vaccine can be very fragile and limited.</li>
</ul>
<p>For these reasons we think that a vaccine using this system is not helpful in the longer-term.</p>
<h2>CONCLUSION</h2>
<p>RagnarLocker is a simple ransomware, much like others that exist in the criminal market. Due to its small size, its operator’s aggressive behavior and the knowledge they seem to have that allows them to enter the networks of enterprises, as well as the threat to leak information if the ransom is not paid, RagnarLocker could potentially become a big threat in the future. Time will tell if RagnarLocker becomes a serious threat or disappears against a backdrop of other ransomware with more resources. The code is medium in quality.</p>
<h2>COVERAGE</h2>
<p>McAfee can protect against this threat in all its products, including personal antivirus, endpoint and gateway.</p>
<p>The names that it can have are:</p>
<ul>
<li>Ransom-ragnar</li>
</ul>
<p>Also, learn how Enhanced Remediation, a new capability in ENS 10.7, can automatically <a href="https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ens-10-7-rolls-back-the-curtain-on-ransomware/">rollback changes</a> made by processes that exhibit malicious behavior.</p>
<h2>MITRE ATT&amp;CK COVERAGE</h2>
<ul>
<li>Command and Control : Standard Application Layer Protocol</li>
<li>Defense Evasion : Disabling Security Tools</li>
<li>Discovery : Security Software Discovery</li>
<li>Discovery : Software Discovery</li>
<li>Discovery : System Information Discovery</li>
<li>Discovery : System Service Discovery</li>
<li>Discovery : System Time Discovery</li>
<li>Discovery : Query registry</li>
<li>Execution : Command-Line Interface</li>
<li>Execution : Execution through API</li>
<li>Exfiltration : Data Encrypted</li>
<li>Impact : Data Encrypted for Impact</li>
<li>Impact : Service Stop</li>
</ul>
<h2>YARA RULES</h2>
<table>
<tbody>
<tr>
<td><strong>rule RagnarLocker</strong></p>
<p><strong>{</strong></p>
<p><strong>    /*</strong></p>
<p><strong>      This YARA rule detects the ransomware RagnarLocker in memory or unpacked in disk for the sample with hash SHA1 97f45184770693a91054075f8a45290d4d1fc06f and perhaps other samples</strong></p>
<p><strong>    */</strong></p>
<p><strong>    meta:</strong></p>
<p><strong>        author      = &#8220;McAfee ATR Team&#8221;</strong></p>
<p><strong>        description = &#8220;Rule to detect unpacked sample of RagnarLocker&#8221;</strong></p>
<p><strong>        version     = &#8220;1.0&#8221;</strong></p>
<p><strong>    strings:</strong></p>
<p><strong>        $a = { 42 81 F1 3C FF 01 AB 03 F1 8B C6 C1 C0 0D 2B F0 3B D7 }</strong></p>
<p><strong>    condition:</strong></p>
<p><strong>        $a</strong></p>
<p><strong>}</strong></p>
<p><strong> </strong></p>
<p><strong>import &#8220;pe&#8221;</strong></p>
<p><strong> </strong></p>
<p><strong>rule ragnarlocker_ransomware </strong></p>
<p><strong>{</strong></p>
<p><strong>   meta:</strong></p>
<p><strong>   </strong></p>
<p><strong>      description = &#8220;Rule to detect RagnarLocker samples&#8221;</strong></p>
<p><strong>      author = &#8220;Christiaan Beek | Marc Rivero | McAfee ATR Team&#8221;</strong></p>
<p><strong>      reference = &#8220;https://www.bleepingcomputer.com/news/security/ragnar-locker-ransomware-targets-msp-enterprise-support-tools/&#8221;</strong></p>
<p><strong>      date = &#8220;2020-04-15&#8221;</strong></p>
<p><strong>      hash1 = &#8220;63096f288f49b25d50f4aea52dc1fc00871b3927fa2a81fa0b0d752b261a3059&#8221;</strong></p>
<p><strong>      hash2 = &#8220;9bdd7f965d1c67396afb0a84c78b4d12118ff377db7efdca4a1340933120f376&#8221;</strong></p>
<p><strong>      hash3 = &#8220;ec35c76ad2c8192f09c02eca1f263b406163470ca8438d054db7adcf5bfc0597&#8221;</strong></p>
<p><strong>      hash4 = &#8220;9706a97ffa43a0258571def8912dc2b8bf1ee207676052ad1b9c16ca9953fc2c&#8221;</strong></p>
<p><strong>      </strong></p>
<p><strong>   strings:</strong></p>
<p><strong>   </strong></p>
<p><strong>      //&#8212;RAGNAR SECRET&#8212;</strong></p>
<p><strong>      $s1 = {2D 2D 2D 52 41 47 4E 41 52 20 53 45 43 52 45 54 2D 2D 2D}</strong></p>
<p><strong>      $s2 = { 66 ?? ?? ?? ?? ?? ?? 66 ?? ?? ?? B8 ?? ?? ?? ?? 0F 44 }</strong></p>
<p><strong>      $s3 = { 5? 8B ?? 5? 5? 8B ?? ?? 8B ?? 85 ?? 0F 84 }</strong></p>
<p><strong>      $s4 = { FF 1? ?? ?? ?? ?? 3D ?? ?? ?? ?? 0F 85 }</strong></p>
<p><strong>      $s5 = { 8D ?? ?? ?? ?? ?? 5? FF 7? ?? E8 ?? ?? ?? ?? 85 ?? 0F 85 }</strong></p>
<p><strong>      </strong></p>
<p><strong>      $op1 = { 0f 11 85 70 ff ff ff 8b b5 74 ff ff ff 0f 10 41 }</strong></p>
<p><strong>      </strong></p>
<p><strong>      $p0 = { 72 eb fe ff 55 8b ec 81 ec 00 01 00 00 53 56 57 }</strong></p>
<p><strong>      $p1 = { 60 be 00 00 41 00 8d be 00 10 ff ff 57 eb 0b 90 }</strong></p>
<p><strong>      </strong></p>
<p><strong>      $bp0 = { e8 b7 d2 ff ff ff b6 84 }</strong></p>
<p><strong>      $bp1 = { c7 85 7c ff ff ff 24 d2 00 00 8b 8d 7c ff ff ff }</strong></p>
<p><strong>      $bp2 = { 8d 85 7c ff ff ff 89 85 64 ff ff ff 8d 4d 84 89 }</strong></p>
<p><strong>      </strong></p>
<p><strong>   condition:</strong></p>
<p><strong>   </strong></p>
<p><strong>     uint16(0) == 0x5a4d and </strong></p>
<p><strong>     filesize &lt; 100KB and </strong></p>
<p><strong>     (4 of ($s*) and $op1) or</strong></p>
<p><strong>     all of ($p*) and pe.imphash() == &#8220;9f611945f0fe0109fe728f39aad47024&#8221; or</strong></p>
<p><strong>     all of ($bp*) and pe.imphash() == &#8220;489a2424d7a14a26bfcfb006de3cd226&#8221; </strong></p>
<p><strong>}</strong></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h2>IOCs</h2>
<table width="548">
<tbody>
<tr>
<td>SHA256</td>
<td>7af61ce420051640c50b0e73e718dd8c55dddfcb58917a3bead9d3ece2f3e929</td>
</tr>
<tr>
<td>SHA256</td>
<td>c2bd70495630ed8279de0713a010e5e55f3da29323b59ef71401b12942ba52f6</td>
</tr>
<tr>
<td>SHA256</td>
<td>dd5d4cf9422b6e4514d49a3ec542cffb682be8a24079010cda689afbb44ac0f4</td>
</tr>
<tr>
<td>SHA256</td>
<td>63096f288f49b25d50f4aea52dc1fc00871b3927fa2a81fa0b0d752b261a3059</td>
</tr>
<tr>
<td>SHA256</td>
<td>b670441066ff868d06c682e5167b9dbc85b5323f3acfbbc044cabc0e5a594186</td>
</tr>
<tr>
<td>SHA256</td>
<td>68eb2d2d7866775d6bf106a914281491d23769a9eda88fc078328150b8432bb3</td>
</tr>
<tr>
<td>SHA256</td>
<td>1bf68d3d1b89e4f225c947442dc71a4793a3100465c95ae85ce6f7d987100ee1</td>
</tr>
<tr>
<td>SHA256</td>
<td>30dcc7a8ae98e52ee5547379048ca1fc90925e09a2a81c055021ba225c1d064c</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h2>USING MVISION EDR TO DETECT RAGNARLOCKER</h2>
<p>With thanks to <a href="https://www.mcafee.com/blogs/author/mo-cashman/">Mo Cashman</a> and <a href="https://www.mcafee.com/blogs/author/filippo-sitzia/">Filippo Sitzia</a></p>
<p>We downloaded a RagnarLocker sample from Virus Total to test detection capability by MVISION Endpoint Detection and Response (EDR). We tested first with the original sample which was known to most detection engines by this time. We then changed file hashes to test detection with an unknown sample. In both cases, MVISION EDR identified the suspicious behaviors and raised alerts. The original sample was detected as a HIGH Risk because the file had a known malicious reputation in McAfee Global Threat Intelligence which is integrated with MVISION EDR. The unknown samples were detected as Medium Risk and most likely would have triggered further inspection by a security analyst.</p>
<p><strong>Sample VT submission </strong></p>
<p>2020-05-30 13:30:55, File size: 48.50 KB, File type Win32 EXE, File name: omniga.exe, VT detections: 51/73</p>
<p><strong>Test Environment</strong></p>
<p>OS Win10, ENS 10.7 Threat Protection off, Adaptive Threat Protection off, MVISION EDR</p>
<p><strong>Execution with original HASH &#8211; 3bc8ce79ee7043c9ad70698e3fc2013806244dc5112c8c8d465e96757b57b1e1</strong></p>
<p><img class="aligncenter size-full wp-image-101781" src="/wp-content/uploads/2020/06/figure-35.png" alt="" width="1917" height="811" srcset="/wp-content/uploads/2020/06/figure-35.png 1917w, /wp-content/uploads/2020/06/figure-35-300x127.png 300w, /wp-content/uploads/2020/06/figure-35-1024x433.png 1024w, /wp-content/uploads/2020/06/figure-35-768x325.png 768w, /wp-content/uploads/2020/06/figure-35-1536x650.png 1536w, /wp-content/uploads/2020/06/figure-35-205x87.png 205w" sizes="(max-width: 1917px) 100vw, 1917px" /></p>
<p><strong>To further test MVISION EDR effectiveness, we modified the hash file slightly:</strong></p>
<p><strong>Execution with HASH changed &#8211; 63F5B6ED99C559341CF1AD081BAF55B4EACAD8E46D056764531BD316BF3C3EE3</strong></p>
<p><img class="aligncenter size-full wp-image-101782" src="/wp-content/uploads/2020/06/figure-36.png" alt="" width="1914" height="820" srcset="/wp-content/uploads/2020/06/figure-36.png 1914w, /wp-content/uploads/2020/06/figure-36-300x129.png 300w, /wp-content/uploads/2020/06/figure-36-1024x439.png 1024w, /wp-content/uploads/2020/06/figure-36-768x329.png 768w, /wp-content/uploads/2020/06/figure-36-1536x658.png 1536w, /wp-content/uploads/2020/06/figure-36-205x88.png 205w" sizes="(max-width: 1914px) 100vw, 1914px" /></p>
<p><strong>Alerting Results for both samples</strong></p>
<p><img class="aligncenter size-full wp-image-101783" src="/wp-content/uploads/2020/06/figure-37.png" alt="" width="1319" height="327" srcset="/wp-content/uploads/2020/06/figure-37.png 1319w, /wp-content/uploads/2020/06/figure-37-300x74.png 300w, /wp-content/uploads/2020/06/figure-37-1024x254.png 1024w, /wp-content/uploads/2020/06/figure-37-768x190.png 768w, /wp-content/uploads/2020/06/figure-37-205x51.png 205w" sizes="(max-width: 1319px) 100vw, 1319px" /></p>
        </div>
    </div>

    <div class="wrap-section">  
        <div class="container medium">
            <h3>About the Author</h3>
        </div>
    </div>

    <div class="wrap-section padding-small bg-light-gray author-container">  
        <div class="container medium"> 


                <div class="row">
                    <div class="col-sm-2 col-xs-4 text-center">
                        <a href="/blogs/author/alexandre-mundo/"><img class="author" src="/wp-content/uploads/2018/07/alex-300x230.png" /></a>
                        <ul class="social-networks">
                <li><a href="https://twitter.com/ValthekOn" rel="nofollow" target="_blank"><i class="symbol-twitter"></i><span>Twitter</span></a></li><li><a href="https://www.linkedin.com/in/alexandre-mundo-alguacil-38a98011a/" rel="nofollow" target="_blank"><i class="symbol-linkedin"></i><span>LinkedIn</span></a></li>                        </ul>
                    </div>
                    <div class="col-sm-10 col-xs-8">
                        <h3 class="red"><a href="/blogs/author/alexandre-mundo/">Alexandre Mundo</a></h3>
                        <p>Alexandre Mundo, Senior Malware Analyst is part of Mcafee's Advanced Threat Research team. He reverses the new threads in advanced attacks and make research of them in a daily basis. He is focused in APT and new, and old but very active, ransomware attacks and malware. He performs malware and forensic analysis and teach junior ...</p>						
                        <a href="/blogs/author/alexandre-mundo/" class="caret-link">Read more posts from Alexandre Mundo </a>
                    </div>
                </div><br/>
                                    </div>
    </div>

    <div class="wrap-section padding-top-xs">  
        <div class="container medium"> 
            <div class="row">
                            <div class="col-sm-6 col-xs-6">
            <a href="/blogs/other-blogs/executive-perspectives/your-ceo-just-asked-if-we-are-protected-from-this-threat-now-what/" rel="prev"><i class="fa fa-angle-left" aria-hidden="true"></i> Previous Article</a> 
                </div>
                <div class="col-sm-6 col-xs-6 text-right">
<a href="/blogs/enterprise/cloud-security/quantifying-cloud-security-effectiveness/" rel="next">Next Article <i class="fa fa-angle-right" aria-hidden="true"></i></a>                </div>
            </div>
        </div>
    </div>
    <div class="wrap-section padding-top-xs"> 
        <div class="container medium">
                    <p class="small rule">Categories: <a href="/blogs/other-blogs/mcafee-labs/" rel="category tag">McAfee Labs</a><br /> 
            </p>	

        </div>		 
    </div>
    <div class="container medium">
                    <ol class="commentlist">
                    </ol>
             
    </div>
    
    <div class="wrap-section padding-top-small">  
        <div class="container medium">
                                </div>
    </div>
        <div class="wrap-section bg-red bg-image padding-medium" id="subscribe">
      <div class="container medium">
        <div class="row">
          <div class="col-sm-12">
            <div class="cta-component text-center">
              <h3>Subscribe to McAfee Securing Tomorrow Blogs</h3>
                         <form method="get" action="/blogs/subscribe/" class="form-inline">
            
              <input type="text" placeholder="Email address" name="subscriber_email" />
          
            <button type="submit" class="btn transparent">Subscribe</button>
          </form>
              
            </div>
          </div>
        </div>
      </div>
    </div>

</main>
<!--Footer of en-us starts here --> 
    
	<aside class="tools">
		<a href="#wrapper" class="back-to-top">Back to top</a>
	</aside>
  
  <div class="textwidget custom-html-widget"><div class="wrap-section padding-bottom-medium padding-top-small bg-dark-gray" id="footer">
    <div class="container medium">           
      <div class="row">
         <div class="col-sm-6 breadcrumb">
        	<ul class="breadcrumb-list">
        		<li><a class="symbols-label first" href="/blogs"><i class="symbol-shield"></i><span>McAfee Home</span></a></li>
        		<li><a class="symbols-label" href="/blogs"><i class="symbol-arrow-forward"></i><span>Securing Tomorrow</span></a></li>
					 </ul>
				</div>
        <div class="col-sm-6 social">
          <!-- <a id="usbl-integrated-button" class="symbols-label" href=""><i class="symbol-feedback"></i><span>Feedback</span></a> -->
          <ul class="social-networks">
            <li><a href="https://twitter.com/mcafee" title="Twitter" target="_blank" rel="noopener noreferrer"><i class="symbol-twitter"></i><span>Twitter</span></a></li>
            <li><a href="http://www.facebook.com/mcafee" title="Facebook" target="_blank" rel="noopener noreferrer"><i class="symbol-facebook"></i><span>Facebook</span></a></li>
            <li><a href="https://www.linkedin.com/company/2336?trk=prof-exp-company-name" title="LinkedIn" target="_blank" rel="noopener noreferrer"><i class="symbol-linkedin"></i><span>LinkedIn</span></a></li>
            <li><a href="http://www.youtube.com/mcafee" title="YouTube" target="_blank" rel="noopener noreferrer"><i class="symbol-youtube"></i><span>YouTube</span></a></li>
            <li><a href="/blogs/" title="Blog" target="_blank" rel="noopener noreferrer"><i class="symbol-blog"></i><span>Blog</span></a></li>
					</ul>
        </div>
      </div>
      <hr />
      <div class="row">
        <div class="col-sm-3">
          <a class="symbols-label" href="/enterprise/en-us/about/region-selector.html"><i class="symbol-language"></i><span>United States / English</span></a>
        </div>
        <div class="col-sm-9">
           <a href="//www.scanalert.com/RatingVerify?ref=www.mcafee.com" target="_blank" class="mcafee-secure" rel="noopener noreferrer"><img src="https://www.mcafee.com/enterprise/en-us/img/v1/common/logo-mcafee-secure.svg" alt="McAfee SECURE"/></a>
          <ul class="footer-menu">
            <li><a href="/enterprise/en-us/about/legal/privacy.html">Privacy</a></li>
            <li><a href="/enterprise/en-us/about/legal/notices.html">Legal Notices</a></li>
            <li><a href="/enterprise/en-us/about/legal/contracts-terms.html">Legal Contracts &amp; Terms</a></li>
            <li><a href="/enterprise/en-us/site-map.html">Site Map</a></li>
            <li>Copyright ©2020 McAfee, LLC</li>
          </ul>
        </div>
      </div>          
    </div>            	
  </div>
</div></div>


</body>	
<script type="text/javascript">
   if ($('div.author-block .meta').length > 0) {
      utag_data.tm_local_blogs_author = $('div.author-block .meta').text().split(' on ')[0].replace("By","").trim();
    }
    (function(a,b,c,d){
    a='//tags.tiqcdn.com/utag/mcafee/consumer-main/prod/utag.js'; // Note: Please use prod for production version and dev for dev version before release
    b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;
    a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a);
    })();
</script>

<script type='text/javascript' src='/wp-content/plugins/metronet-profile-picture/js/mpp-frontend.js?ver=2.3.8'></script>
<script type='text/javascript'>
/* Highlight Search Terms 1.5 ( RavanH - http://status301.net/wordpress-plugins/highlight-search-terms/ ) */
var hlst_query = []; var hlst_areas = ["#groups-dir-list","#members-dir-list","div.bbp-topic-content,div.bbp-reply-content,li.bbp-forum-info,.bbp-topic-title,.bbp-reply-title","article","div.hentry","div.post","#content","#main","div.content","#middle","#container","div.container","div.page","#wrapper","body"];
</script>
<script type='text/javascript' src='/wp-content/plugins/highlight-search-terms/hlst-extend.min.js?ver=1.5'></script>
<script type='text/javascript' src='/wp-content/plugins/social-polls-by-opinionstage/public/js/shortcodes.js?ver=19.6.31'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpmm_object = {"ajax_url":"https:\/\/www.mcafee.com\/wp-admin\/admin-ajax.php","wpmm_responsive_breakpoint":"767px","wpmm_disable_mobile":"false"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/wp-megamenu/assets/js/wpmm.js?ver=1.3.1'></script>
<script type='text/javascript' src='/wp-content/themes/securingtomorrow/js/theme-script.js?ver=5.4.2'></script>
<script type='text/javascript' src='/wp-content/themes/securingtomorrow/js/skip-link-focus-fix.min.js?ver=20151215'></script>
<script type='text/javascript' src='/wp-content/plugins/super-socializer/js/front/social_login/general.js?ver=7.12.37'></script>
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=5.4.2'></script>
	
<script src="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js?ver=10faaf528e636a046163bdb6753031b2"></script>
<script src="/wp-content/themes/securingtomorrow/js/jquery-lib.js"></script>
<script src="/wp-content/themes/securingtomorrow/js/main.js"></script>
<script src="/wp-content/themes/securingtomorrow/js/general_footer.js"></script>
<!-- Consumer Facebook Pixel Code -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '187610925152304');
  fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=187610925152304&ev=PageView&noscript=1"/></noscript>
<!-- End Facebook Pixel Code -->

<!-- Start linkedIn pixel -->
<script type="text/javascript">
_linkedin_partner_id = "68395";
window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || [];
window._linkedin_data_partner_ids.push(_linkedin_partner_id);
</script><script type="text/javascript">
(function(){var s = document.getElementsByTagName("script")[0];
var b = document.createElement("script");
b.type = "text/javascript";b.async = true;
b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js";
s.parentNode.insertBefore(b, s);})();
</script>
<noscript>
<img height="1" width="1" style="display:none;" alt="" src="https://dc.ads.linkedin.com/collect/?pid=68395&fmt=gif" />
</noscript>
<!-- End linkedIn pixel -->

<!-- Twitter universal website tag code -->
<script>
!function(e,t,n,s,u,a){e.twq||(s=e.twq=function(){s.exe?s.exe.apply(s,arguments):s.queue.push(arguments);
},s.version='1.1',s.queue=[],u=t.createElement(n),u.async=!0,u.src='//static.ads-twitter.com/uwt.js',
a=t.getElementsByTagName(n)[0],a.parentNode.insertBefore(u,a))}(window,document,'script');
// Insert Twitter Pixel ID and Standard Event data below
twq('init','nxlgc');
twq('track','PageView');
</script>
<!-- Twitter universal website tag code -->

<script>
/* <![CDATA[ */
var google_conversion_id = 975085349;
var google_custom_params = window.google_tag_params;
var google_remarketing_only = true;
/* ]]> */
document.write('\x3Cscript type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js">\x3C/script>');
//document.write('\x3Cnoscript>\x3Cimg height="1" width="1" style="border-style:none;display:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/975085349/?guid=ON&script=0"/>\x3C/noscript>');
</script>

<!-- Enterprise Facebook Pixel Code -->
<script>
// load Facebook
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '766537420057144');
fbq('track', "PageView");

//document.write('\x3Cnoscript>\x3Cimg height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=766537420057144&ev=PageView&noscript=1" />\x3C/noscript>');
</script>
<!-- Facebook Pixel Code -->

<!-- Adobe Launch START -->
<script src="//assets.adobedtm.com/launch-ENc117a6a508e14a879398dd6f37ed54a3.min.js"></script>
<!-- Adobe Launch END -->
<script>_satellite.pageBottom()</script>
</html>


<style>
    .commentlist {
        display: none;
    }
</style>
<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me - Debug: cached@1616227682 -->