<!DOCTYPE html>
<html lang="en-US">

    <head>

        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <link rel="profile" href="https://gmpg.org/xfn/11">
        <link rel="pingback" href="https://www.mcafee.com/xmlrpc.php">
                    <link rel="canonical" href="https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ripple20-critical-vulnerabilities-detection-logic-and-signatures/">
                            <link rel="shortcut icon" href="https://www.mcafee.com/enterprise/en-us/img/favicon.ico">
        <!--<link rel="stylesheet" href="/wp-content/themes/securingtomorrow/css/responsive/blog.css" type="text/css">
        <link rel="stylesheet" href="/wp-content/themes/securingtomorrow/css/responsive/main.css" type="text/css">-->
        <link rel="stylesheet" href="/enterprise/www/css/main.min.css" type="text/css">
       
        	<script type="text/javascript">function theChampLoadEvent(e){var t=window.onload;if(typeof window.onload!="function"){window.onload=e}else{window.onload=function(){t();e()}}}</script>
		<script type="text/javascript">var theChampDefaultLang = 'en_US', theChampCloseIconPath = 'https://www.mcafee.com/wp-content/plugins/super-socializer/images/close.png';</script>
		<script> var theChampSiteUrl = 'https://www.mcafee.com/blogs', theChampVerified = 0, theChampEmailPopup = 0; </script>
		<style type="text/css">.the_champ_horizontal_sharing .theChampSharing{
					color: #fff;
				border-width: 0px;
		border-style: solid;
		border-color: transparent;
	}
		.the_champ_horizontal_sharing .theChampTCBackground{
		color:#666;
	}
		.the_champ_horizontal_sharing .theChampSharing:hover{
				border-color: transparent;
	}
	.the_champ_vertical_sharing .theChampSharing{
					color: #fff;
				border-width: 0px;
		border-style: solid;
		border-color: transparent;
	}
		.the_champ_vertical_sharing .theChampTCBackground{
		color:#666;
	}
		.the_champ_vertical_sharing .theChampSharing:hover{
				border-color: transparent;
	}
	@media screen and (max-width:783px){.the_champ_vertical_sharing{display:none!important}}div.heateor_ss_mobile_footer{display:none;}@media screen and (max-width:783px){i.theChampTCBackground{background-color:white!important}div.the_champ_bottom_sharing{width:100%!important;left:0!important;}div.the_champ_bottom_sharing li{width:12.5% !important;}div.the_champ_bottom_sharing .theChampSharing{width: 100% !important;}div.the_champ_bottom_sharing div.theChampTotalShareCount{font-size:1em!important;line-height:28px!important}div.the_champ_bottom_sharing div.theChampTotalShareText{font-size:.7em!important;line-height:0px!important}div.heateor_ss_mobile_footer{display:block;height:40px;}.the_champ_bottom_sharing{padding:0!important;display:block!important;width: auto!important;bottom:-2px!important;top: auto!important;}.the_champ_bottom_sharing .the_champ_square_count{line-height: inherit;}.the_champ_bottom_sharing .theChampSharingArrow{display:none;}.the_champ_bottom_sharing .theChampTCBackground{margin-right: 1.1em !important}}</style>
	
	<!-- This site is optimized with the Yoast SEO plugin v14.2 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Ripple20 Critical Vulnerabilities – Detection Logic and Signatures | McAfee Blogs</title>
	<meta name="description" content="This document has been prepared by McAfee Advanced Threat Research in collaboration with JSOF who discovered and responsibly disclosed the" />
	<meta name="robots" content="index, follow" />
	<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Ripple20 Critical Vulnerabilities – Detection Logic and Signatures | McAfee Blogs" />
	<meta property="og:description" content="This document has been prepared by McAfee Advanced Threat Research in collaboration with JSOF who discovered and responsibly disclosed the" />
	<meta property="og:url" content="/blogs/other-blogs/mcafee-labs/ripple20-critical-vulnerabilities-detection-logic-and-signatures/" />
	<meta property="og:site_name" content="McAfee Blogs" />
	<meta property="article:publisher" content="https://www.facebook.com/mcafee" />
	<meta property="article:published_time" content="2020-08-05T13:00:05+00:00" />
	<meta property="article:modified_time" content="2020-08-06T19:33:36+00:00" />
	<meta property="og:image" content="https://www.mcafee.com/wp-content/uploads/2020/08/labs-thumbnail-3.jpeg" />
	<meta property="og:image:width" content="1920" />
	<meta property="og:image:height" content="1080" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:creator" content="@spovolny" />
	<meta name="twitter:site" content="@mcafee" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://www.mcafee.com/blogs/#website","url":"https://www.mcafee.com/blogs/","name":"McAfee Blogs","description":"Securing Tomorrow. Today.","potentialAction":[{"@type":"SearchAction","target":"https://www.mcafee.com/blogs/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ripple20-critical-vulnerabilities-detection-logic-and-signatures/#primaryimage","inLanguage":"en-US","url":"/wp-content/uploads/2020/08/labs-thumbnail-3.jpeg","width":1920,"height":1080},{"@type":"WebPage","@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ripple20-critical-vulnerabilities-detection-logic-and-signatures/#webpage","url":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ripple20-critical-vulnerabilities-detection-logic-and-signatures/","name":"Ripple20 Critical Vulnerabilities \u2013 Detection Logic and Signatures | McAfee Blogs","isPartOf":{"@id":"https://www.mcafee.com/blogs/#website"},"primaryImageOfPage":{"@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ripple20-critical-vulnerabilities-detection-logic-and-signatures/#primaryimage"},"datePublished":"2020-08-05T13:00:05+00:00","dateModified":"2020-08-06T19:33:36+00:00","author":{"@id":"https://www.mcafee.com/blogs/#/schema/person/210ec6c1c7e372f17c4b1109f06b8267"},"description":"This document has been prepared by McAfee Advanced Threat Research in collaboration with JSOF who discovered and responsibly disclosed the","breadcrumb":{"@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ripple20-critical-vulnerabilities-detection-logic-and-signatures/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ripple20-critical-vulnerabilities-detection-logic-and-signatures/"]}]},{"@type":"BreadcrumbList","@id":"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ripple20-critical-vulnerabilities-detection-logic-and-signatures/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"/blogs/","url":"/blogs/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"/blogs/other-blogs/","url":"/blogs/other-blogs/","name":"Other Blogs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"/blogs/other-blogs/mcafee-labs/","url":"/blogs/other-blogs/mcafee-labs/","name":"McAfee Labs"}},{"@type":"ListItem","position":4,"item":{"@type":"WebPage","@id":"/blogs/other-blogs/mcafee-labs/ripple20-critical-vulnerabilities-detection-logic-and-signatures/","url":"/blogs/other-blogs/mcafee-labs/ripple20-critical-vulnerabilities-detection-logic-and-signatures/","name":"Ripple20 Critical Vulnerabilities \u2013 Detection Logic and Signatures"}}]},{"@type":["Person"],"@id":"https://www.mcafee.com/blogs/#/schema/person/210ec6c1c7e372f17c4b1109f06b8267","name":"Steve Povolny","description":"Steve Povolny is the Head of McAfee Advanced Threat Research, which delivers groundbreaking vulnerability research spanning nearly every industry. With more than a decade of experience in network security, Steve is a recognized authority on hardware and software vulnerabilities, and regularly collaborates with influencers in academia, government, law enforcement, consumers and enterprise businesses of all sizes. Steve is a sought after public speaker and media commentator who often blogs on key topics. He brings to McAfee his passion for threat research and a unique vision to harness the power of collaboration between the research community and product vendors, through responsible disclosure, for the benefit of all.","sameAs":["https://www.linkedin.com/in/steve-povolny-595a776/","https://twitter.com/spovolny"]}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//stackpath.bootstrapcdn.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="McAfee Blogs &raquo; Feed" href="https://www.mcafee.com/blogs/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.4.2"}};
			/*! This file is auto-generated */
			!function(e,a,t){var r,n,o,i,p=a.createElement("canvas"),s=p.getContext&&p.getContext("2d");function c(e,t){var a=String.fromCharCode;s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,e),0,0);var r=p.toDataURL();return s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,t),0,0),r===p.toDataURL()}function l(e){if(!s||!s.fillText)return!1;switch(s.textBaseline="top",s.font="600 32px Arial",e){case"flag":return!c([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])&&(!c([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!c([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]));case"emoji":return!c([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340])}return!1}function d(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(i=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},o=0;o<i.length;o++)t.supports[i[o]]=l(i[o]),t.supports.everything=t.supports.everything&&t.supports[i[o]],"flag"!==i[o]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[i[o]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(r=t.source||{}).concatemoji?d(r.concatemoji):r.wpemoji&&r.twemoji&&(d(r.twemoji),d(r.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='/wp-includes/css/dist/block-library/style.min.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_poll_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/poll/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_trivia_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/trivia/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_personality_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/personality/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_survey_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/survey/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_slideshow_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/slideshow/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='opinionStage_form_oswp_style_css_set-css'  href='/wp-content/plugins/social-polls-by-opinionstage/gutenberg/form/dist/blocks.style.build.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='mpp_gutenberg-css'  href='/wp-content/plugins/metronet-profile-picture/dist/blocks.style.build.css?ver=2.3.8' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='/wp-includes/css/dashicons.min.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='wpmm_css-css'  href='/wp-content/plugins/wp-megamenu/assets/css/wpmm.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='wp_megamenu_generated_css-css'  href='/wp-content/uploads/wp-megamenu/wp-megamenu.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='featuresbox_css-css'  href='/wp-content/plugins/wp-megamenu/addons/wpmm-featuresbox/wpmm-featuresbox.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='postgrid_css-css'  href='/wp-content/plugins/wp-megamenu/addons/wpmm-gridpost/wpmm-gridpost.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wp-bootstrap-pro-fontawesome-cdn-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='open-sans-google-font-css'  href='https://fonts.googleapis.com/css?family=Open+Sans%3A300%2C400&#038;ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='theme-css-css'  href='/wp-content/themes/securingtomorrow/style.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='the_champ_frontend_css-css'  href='/wp-content/plugins/super-socializer/css/front.css?ver=7.12.37' type='text/css' media='all' />
<link rel='stylesheet' id='addtoany-css'  href='/wp-content/plugins/add-to-any/addtoany.min.css?ver=1.15' type='text/css' media='all' />
<link rel='stylesheet' id='poppins-css'  href='//fonts.googleapis.com/css?family=Poppins%3A100%2C100italic%2C200%2C200italic%2C300%2C300italic%2Cregular%2Citalic%2C500%2C500italic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic%2C900%2C900italic&#038;ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='oswald-css'  href='//fonts.googleapis.com/css?family=Oswald%3A200%2C300%2Cregular%2C500%2C600%2C700&#038;ver=1.3.1' type='text/css' media='all' />
<script type='text/javascript' src='/wp-content/plugins/jquery-updater/js/jquery-3.4.1.min.js?ver=3.4.1'></script>
<script type='text/javascript' src='/wp-content/plugins/add-to-any/addtoany.min.js?ver=1.1'></script>
<script type='text/javascript' src='/wp-content/plugins/wp-megamenu/addons/wpmm-featuresbox/wpmm-featuresbox.js?ver=1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var postgrid_ajax_load = {"ajax_url":"https:\/\/www.mcafee.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/wp-megamenu/addons/wpmm-gridpost/wpmm-gridpost.js?ver=1'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='/wp-content/themes/securingtomorrow/js/html5.js?ver=3.7.0'></script>
<![endif]-->
<link rel='https://api.w.org/' href='https://www.mcafee.com/blogs/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.mcafee.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.mcafee.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.2" />
<link rel='shortlink' href='https://www.mcafee.com/blogs/?p=104523' />
<link rel="alternate" type="application/json+oembed" href="https://www.mcafee.com/blogs/wp-json/oembed/1.0/embed?url=%2Fblogs%2Fother-blogs%2Fmcafee-labs%2Fripple20-critical-vulnerabilities-detection-logic-and-signatures%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://www.mcafee.com/blogs/wp-json/oembed/1.0/embed?url=%2Fblogs%2Fother-blogs%2Fmcafee-labs%2Fripple20-critical-vulnerabilities-detection-logic-and-signatures%2F&#038;format=xml" />

<script data-cfasync="false">
window.a2a_config=window.a2a_config||{};a2a_config.callbacks=[];a2a_config.overlays=[];a2a_config.templates={};
(function(d,s,a,b){a=d.createElement(s);b=d.getElementsByTagName(s)[0];a.async=1;a.src="https://static.addtoany.com/menu/page.js";b.parentNode.insertBefore(a,b);})(document,"script");
</script>
<script>
var utag_data = {
tm_global_pagename:"",
tm_global_page_publish_date:"",
tm_global_businessunit:"consumer",
tm_global_sitesection:"",
tm_global_sitesection_level2:"",
tm_global_sitesection_level3:"",
tm_global_platform:"web",
tm_global_culture_code:"en-us",
tm_global_country:"united states",
tm_global_geo:"na",
tm_global_channel:"direct",
tm_global_affiliate_id:"",
tm_global_affiliate_name:"",
tm_global_campaign_id:"",
tm_global_page_version:"",
tm_global_pageurl:location.href,
tm_global_clientid :"",
tm_global_trafficsource:"",
tm_global_sourcetype:"blog",
tm_global_wssversion:"",
tm_global_coe:"",
tm_global_coe_level2:"",
tm_local_blogs_author:""
}
var sec=location.pathname.replace("/blogs","").split("/"); utag_data.tm_global_pagename="[consumer:web]";
if(sec.length > 2) {
for(i=1;i<sec.length-1;i++) {
utag_data.tm_global_pagename+="|"+sec[i];
if(i==1){utag_data.tm_global_sitesection=sec[i]}
if(i==2){utag_data.tm_global_sitesection_level2=sec[i]}
if(i==3){utag_data.tm_global_sitesection_level3=sec[i]}
}
}
else {
utag_data.tm_global_sitesection="Homepage"
utag_data.tm_global_pagename+="|Homepage"
}

var today = new Date(); var dd = today.getDate(); var mm = today.getMonth() + 1; var yyyy = today.getFullYear();
if (dd < 10) { dd = '0' + dd;    } 
if (mm < 10) {mm = '0' + mm;  } 
utag_data.tm_global_page_publish_date = dd + '/' + mm + '/' + yyyy;

</script>

<script>
	var ISOTOPE_CACHE 				=  [];
	var ISOTOPE_AJAX_URL 			= 'https://www.mcafee.com/wp-admin/admin-ajax.php';
	var ISOTOPE_AJAX_URL_ENDPOINT 	= 'https://www.mcafee.com/wp-content/plugins/ae-isotope/endpoint.php';
	var ISOTOPE_AJAX_ITEMS			= 25;
	var ISOTOPE_CURRENT_CATEGORY	= '';
</script>		<meta property="fb:app_id" content="346056175795920" />
					<meta property="fb:admins" content="100007220654854" />
			<style type="text/css">.wp-megamenu-wrap .wpmm-nav-wrap > ul.wp-megamenu li.wpmm_dropdown_menu ul.wp-megamenu-sub-menu li.menu-item-has-children.wp-megamenu-item-101284.wpmm-submenu-right > ul.wp-megamenu-sub-menu {left: 100%;}</style><style type="text/css"></style><link rel="icon" href="/wp-content/uploads/2018/11/cropped-favicon-32x32.png" sizes="32x32" />
<link rel="icon" href="/wp-content/uploads/2018/11/cropped-favicon-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="/wp-content/uploads/2018/11/cropped-favicon-180x180.png" />
<meta name="msapplication-TileImage" content="/wp-content/uploads/2018/11/cropped-favicon-270x270.png" />
         <link rel="stylesheet" href="/enterprise/www/css/blog.css" type="text/css">
                <script type="text/javascript">
            var digitalData = {"page":{"pageInfo":{"pageName":"other-blogs:mcafee-labs:ripple20-critical-vulnerabilities-detection-logic-and-signatures","pageNameGlobal":"ripple20-critical-vulnerabilities-detection-logic-and-signatures","pageLanguage":"English","pageType":"","country":"us","geo":"NA","onsiteSearchTerm":"","onsiteSearchType":"","category":{"category":"other-blogs","subCategory1":"mcafee-labs"},"author":"Steve Povolny","pubDate":"Aug 05, 2020","metaData":{"keywords":""}}},"user":{"userInfo":{"ip":"161.69.31.4"}}}        </script>
                <script type='application/ld+json'>{
            "@context": "http://schema.org",
            "@type": "Article",
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ripple20-critical-vulnerabilities-detection-logic-and-signatures/"
            },
           "headline": "Ripple20 Critical Vulnerabilities – Detection Logic and Signatures",
            "image": ["https://www.mcafee.com/wp-content/uploads/2020/08/labs-thumbnail-3.jpeg"],	
            "datePublished": "2020-08-05",
            "dateModified": "Aug 06, 2020",
            "author": {
                "@type": "Person",           
                "name": ["Steve Povolny","Douglas McKee","Mark Bereza","Kevin McGrath"]            
            },
            "publisher": {
                "@type": "Organization",
                "name": "McAfee",
                "logo": {
                    "@type": "ImageObject",
                    "url": "https://www.mcafee.com/enterprise/en-us/img/logos/mcafee-logo.png"
                }
            },
            "description": "This document has been prepared by McAfee Advanced Threat Research in collaboration with JSOF who discovered and responsibly disclosed the vulnerabilities. It is intended to serve as a joint research effort to produce valuable insights for network administrators and security personnel, looking to further understand these"        
            }
        </script>
        <style>
            #wp-megamenu-blog>.wpmm-nav-wrap ul.wp-megamenu>li>a{
                color:#ffffff !important;
            }
        </style> 
    
    <script>!function(){function o(n,i){if(n&&i)for(var r in i)i.hasOwnProperty(r)&&(void 0===n[r]?n[r]=i[r]:n[r].constructor===Object&&i[r].constructor===Object?o(n[r],i[r]):n[r]=i[r])}try{var n=decodeURIComponent("%7B%20%22BW%22%3A%20%7B%20%22test_https%22%3A%20true%20%7D%20%7D");if(n.length>0&&window.JSON&&"function"==typeof window.JSON.parse){var i=JSON.parse(n);void 0!==window.BOOMR_config?o(window.BOOMR_config,i):window.BOOMR_config=i}}catch(r){window.console&&"function"==typeof window.console.error&&console.error("mPulse: Could not parse configuration",r)}}();</script>
                          <script>!function(a){var e="https://s.go-mpulse.net/boomerang/",t="addEventListener";if("False"=="True")a.BOOMR_config=a.BOOMR_config||{},a.BOOMR_config.PageParams=a.BOOMR_config.PageParams||{},a.BOOMR_config.PageParams.pci=!0,e="https://s2.go-mpulse.net/boomerang/";if(window.BOOMR_API_key="LXNDQ-3SP7Y-P3JVN-Y4HAH-VQNKC",function(){function n(e){a.BOOMR_onload=e&&e.timeStamp||(new Date).getTime()}if(!a.BOOMR||!a.BOOMR.version&&!a.BOOMR.snippetExecuted){a.BOOMR=a.BOOMR||{},a.BOOMR.snippetExecuted=!0;var i,_,o,r=document.createElement("iframe");if(a[t])a[t]("load",n,!1);else if(a.attachEvent)a.attachEvent("onload",n);r.src="javascript:void(0)",r.title="",r.role="presentation",(r.frameElement||r).style.cssText="width:0;height:0;border:0;display:none;",o=document.getElementsByTagName("script")[0],o.parentNode.insertBefore(r,o);try{_=r.contentWindow.document}catch(O){i=document.domain,r.src="javascript:var d=document.open();d.domain='"+i+"';void(0);",_=r.contentWindow.document}_.open()._l=function(){var a=this.createElement("script");if(i)this.domain=i;a.id="boomr-if-as",a.src=e+"LXNDQ-3SP7Y-P3JVN-Y4HAH-VQNKC",BOOMR_lstart=(new Date).getTime(),this.body.appendChild(a)},_.write("<bo"+'dy onload="document._l();">'),_.close()}}(),"".length>0)if(a&&"performance"in a&&a.performance&&"function"==typeof a.performance.setResourceTimingBufferSize)a.performance.setResourceTimingBufferSize();!function(){if(BOOMR=a.BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},!BOOMR.plugins.AK){var e=""=="true"?1:0,t="",n="fb23dtlilz6gqycyd43q-f-28e272560-clientnsv4-s.akamaihd.net",i={"ak.v":"30","ak.cp":"108209","ak.ai":parseInt("250743",10),"ak.ol":"0","ak.cr":4,"ak.ipv":4,"ak.proto":"http/1.1","ak.rid":"1a3af84f","ak.r":30888,"ak.a2":e,"ak.m":"b","ak.n":"essl","ak.bpcip":"40.117.177.0","ak.cport":33590,"ak.gh":"23.201.31.149","ak.quicv":"","ak.tlsv":"tls1.3","ak.0rtt":"","ak.csrc":"-","ak.acc":"reno","ak.t":"1616387895","ak.ak":"hOBiQwZUYzCg5VSAfCLimQ==qaSB4AyZlZe2K+sXg8zj0qCYWgOTmscMFJ5fBUaAN91aWV7z7M8WPs47wSuBW/iCbmuqTPU+9gZ4tNqK/LKi2yzxhSgYUNoVS3+DrdVIFnEavK4l3mUjhQ0Woe9aqKK43IX2UqppJ9xDI8Zz43lQ+Uxjgu0RnfxjLgKwV0/dDLgu6iCbxOfYqvEnaY8ijjGDFJny8DfOE4DlMbMQLqYEc9U1sgXHo+eATvRx2ijQI0qJ8bpiQ8/9UX7mcW0Y/VOlIDpUGWEX7o2k5kH54LH3S7s15v29vm8+rhRe1ga6SbVFkbwYAWDYu92Z1RTBTgouktyM7f2vmkW/o5qfWhmnf6/zSVC4mWFn8SasfgGUiVZvqbvKZwsFSEUx0+/bMVOshLVRy7TE47jJzuo4bNlrx7cGUpjDUtfsWhQ1ug93CAk=","ak.pv":"141","ak.dpoabenc":""};if(""!==t)i["ak.ruds"]=t;var _={i:!1,av:function(e){var t="http.initiator";if(e&&(!e[t]||"spa_hard"===e[t]))i["ak.feo"]=void 0!==a.aFeoApplied?1:0,BOOMR.addVar(i)},rv:function(){var a=["ak.bpcip","ak.cport","ak.cr","ak.csrc","ak.gh","ak.ipv","ak.m","ak.n","ak.ol","ak.proto","ak.quicv","ak.tlsv","ak.0rtt","ak.r","ak.acc","ak.t"];BOOMR.removeVar(a)}};BOOMR.plugins.AK={akVars:i,akDNSPreFetchDomain:n,init:function(){if(!_.i){var a=BOOMR.subscribe;a("before_beacon",_.av,null,null),a("onbeacon",_.rv,null,null),_.i=!0}return this},is_complete:function(){return!0}}}}()}(window);</script></head>

    <body  class="post-template-default single single-post postid-104523 single-format-standard wp-megamenu" id="short-header">
        <script src="/wp-content/themes/securingtomorrow/js/header_enterprise.js"></script>
        <div id="wrapper">
            <div class="textwidget custom-html-widget"><style>
	.headerbarContainer {
    background: rgba(0,0,0,0.9);
}
</style>
<header id="header">  
	<div class="headerbarContainer">
		<div class="headerbarContent">
			<div class="logo">
				 <img src="https://www.mcafee.com/enterprise/en-us/img/icons/logo-white.svg" alt="McAfee Logo"/>
			</div>
			<div class="quicklinks">
			 	<a class="symbols-label" href="https://www.mcafee.com/consumer/en-us/store/m0/index.html"><span>For Home</span></a>
			 	<a class="symbols-label" href="/enterprise/en-us/home.html"><span>For Enterprise</span></a>
			 	<a class="symbols-label" href="/enterprise/en-us/global-contact-us.html"><i class="symbol-contact"></i></a>
			</div>
		</div>
	</div>
</header>



<style>


@media screen and (min-width: 1025px) {
.hero{height: 756px !important;}
.hero.medium {
    min-height: 0;
    height: 640px  !important;
}
.hero.small {
    min-height: 0;
    height: 510px  !important;
}
.hero.title {
    height: 350px  !important;
}
	}
</style> 
<script>
$("document").ready(function(){
    $(".hero.title h1").each(function() {
        if ($(this).text().length > 50) {
            $(this).addClass("pt")
        }
    });
});
</script></div>  
		
<section class="hero title">
    <div class="bg-stretch">
        <img src="https://www.mcafee.com/wp-content/themes/securingtomorrow/img/light-shield-pattern.png" alt="">
    </div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-12 col-xs-12">
                <h1>Ripple20 Critical Vulnerabilities – Detection Logic and Signatures</h1>
            </div>
        </div>
    </div>
</section>

<main id="main">

    <nav class="anchor-links">
        <div class="container medium">
            <div style="float:left">
<nav id="wp-megamenu-blog" class="wp-megamenu-wrap   ">
			<div class="wpmm-fullwidth-wrap"></div>
			<div class="wpmm-nav-wrap wpmm-main-wrap-blog">
				<a href="javascript:;" class="wpmm_mobile_menu_btn show-close-icon"><i class="fa fa-bars"></i> Menu</a> 
					<ul id="menu-mcafee-blog-navigation-new-05020" class="wp-megamenu" ><li id="wp-megamenu-item-101279" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101279  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#">Consumer <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-8821484289045152649" class="wpmm-row wp-megamenu-item-8821484289045152649 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-1.734727196922E+19" class="wpmm-col wpmm-col-12 wp-megamenu-item-1.734727196922E+19 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101279 wpmm-submenu-right"><div class="menu-consumer-category-container"><ul id="menu-consumer-category" class="menu"><li id="menu-item-97453" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97453"><a href="/blogs/consumer/hackable/">Hackable? Podcast</a></li>
<li id="menu-item-97424" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97424"><a href="/blogs/consumer/consumer-threat-notices/">Consumer Threat Notices</a></li>
<li id="menu-item-97425" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97425"><a href="/blogs/consumer/family-safety/">Family Safety</a></li>
<li id="menu-item-97426" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97426"><a href="/blogs/consumer/identity-protection/">Identity Protection</a></li>
<li id="menu-item-97427" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97427"><a href="/blogs/consumer/mobile-and-iot-security/">Mobile and IoT Security</a></li>
<li id="menu-item-101334" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-101334"><a href="/blogs/consumer/">All Consumer Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-101280" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101280  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#">Enterprise <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-8063589094363088778" class="wpmm-row wp-megamenu-item-8063589094363088778 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-1.0314687905955E+19" class="wpmm-col wpmm-col-12 wp-megamenu-item-1.0314687905955E+19 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101280 wpmm-submenu-right"><div class="menu-enterprise-category-container"><ul id="menu-enterprise-category" class="menu"><li id="menu-item-97421" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97421"><a href="/blogs/enterprise/cloud-security/">Cloud Security</a></li>
<li id="menu-item-97451" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97451"><a href="/blogs/enterprise/endpoint-security/">Endpoint Security</a></li>
<li id="menu-item-97422" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97422"><a href="/blogs/enterprise/security-operations/">Security Operations</a></li>
<li id="menu-item-97452" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97452"><a href="/blogs/enterprise/data-security/">Data Security</a></li>
<li id="menu-item-101336" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-101336"><a href="/blogs/enterprise/">All Enterprise Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-101281" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101281  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#">Corporate <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-8691623216956426123" class="wpmm-row wp-megamenu-item-8691623216956426123 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-9.2908449261011E+18" class="wpmm-col wpmm-col-12 wp-megamenu-item-9.2908449261011E+18 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101281 wpmm-submenu-right"><div class="menu-other-blogs-container"><ul id="menu-other-blogs" class="menu"><li id="menu-item-97442" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97442"><a href="/blogs/other-blogs/executive-perspectives/">Executive Perspectives</a></li>
<li id="menu-item-97441" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-97441"><a href="/blogs/other-blogs/mcafee-labs/">McAfee Labs</a></li>
<li id="menu-item-97443" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97443"><a href="/blogs/other-blogs/life-at-mcafee/">Life at McAfee</a></li>
<li id="menu-item-97440" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97440"><a href="/blogs/other-blogs/podcast/">Podcast</a></li>
<li id="menu-item-97444" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97444"><a href="/blogs/other-blogs/mcafee-partners/">McAfee Partners</a></li>
<li id="menu-item-101340" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-101340"><a href="/blogs/other-blogs/">All Corporate Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-101282" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101282  wpmm_dropdown_menu  wpmm-fadeindown wpmm-submenu-right"><a href="/blogs/authors/">Authors</a></li>
<li id="wp-megamenu-item-101283" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101283  wpmm_dropdown_menu  wpmm-fadeindown wpmm-submenu-right"><a href="/blogs/subscribe/">Subscribe</a></li>
<li id="wp-megamenu-item-101284" class="menu-item menu-item-type-custom menu-item-object-custom wp-megamenu-item-101284  wpmm_mega_menu  wpmm-fadeindown wpmm-submenu-right"><a href="#"><span class='wpmm-selected-icon wpmm-selected-icon-left'><i class='fa fa-globe'></i></span> <b class="fa fa-angle-down"></b> </a>
<ul class="wp-megamenu-sub-menu" >
	<li id="wp-megamenu-item-2203166030685659534" class="wpmm-row wp-megamenu-item-2203166030685659534 wpmm-submenu-right">
	<ul class="wp-megamenu-sub-menu" >
		<li id="wp-megamenu-item-9.9466041878708E+18" class="wpmm-col wpmm-col-12 wp-megamenu-item-9.9466041878708E+18 wpmm-submenu-right">
		<ul class="wp-megamenu-sub-menu" >
			<li class="menu-item wpmm-type-widget menu-widget-class wpmm-type-widget wp-megamenu-item-101284 wpmm-submenu-right"><div class="menu-languages-category-container"><ul id="menu-languages-category" class="menu"><li id="menu-item-97433" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97433"><a href="/blogs/languages/italia/">Italia</a></li>
<li id="menu-item-97434" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97434"><a href="/blogs/languages/japanese/">日本語</a></li>
<li id="menu-item-97435" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97435"><a href="/blogs/languages/espanol/">Español</a></li>
<li id="menu-item-97436" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97436"><a href="/blogs/languages/francais/">Français</a></li>
<li id="menu-item-97437" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97437"><a href="/blogs/languages/german/">German</a></li>
<li id="menu-item-97438" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-97438"><a href="/blogs/languages/portugues/">Português</a></li>
<li id="menu-item-101338" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-101338"><a href="/blogs/languages/">All Language Blogs</a></li>
</ul></div></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li id="wp-megamenu-item-" class="wpmm-social-link wpmm-social-link- wp-megamenu-item-  wpmm_dropdown_menu  wpmm-fadeindown wpmm-submenu-right"><a target="_blank" ><i class=""></i></a></li>
</ul>
			</div>
		</nav>            </div>
            <div class="anchors right">
                <form role="search" method="get" class="blog-search search-form" action="https://www.mcafee.com/blogs/">
                    <button type="submit" class="search-submit"><i class="symbol-arrow-forward"></i></button>
                    <input type="search" class="search-field" placeholder="Search Blogs" value="" name="s" />


                </form>  
            </div>

        </div>
    </nav>

    <div class="wrap-section padding-top-xs"> 
        <div class="container medium">
 
        <div class="breadcrumb-container theme1">
            <ul itemscope itemtype="http://schema.org/BreadcrumbList">
                
                    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" title="Mcafee" href="/"><span itemprop="name">Mcafee</span></a><span class="separator">/</span><meta itemprop="position" content="1"></li>
                    
                    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" title="Home" href="https://www.mcafee.com/blogs"><span itemprop="name">Home</span></a><span class="separator">/</span><meta itemprop="position" content="2"></li>
                    
                    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" title="Other Blogs" href="/blogs/other-blogs/"><span itemprop="name">Other Blogs</span></a><span class="separator">/</span><meta itemprop="position" content="3"></li>
                    
                    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" title="McAfee Labs" href="/blogs/other-blogs/mcafee-labs/"><span itemprop="name">McAfee Labs</span></a><span class="separator">/</span><meta itemprop="position" content="4"></li>
                    
                    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" title="Ripple20 Critical Vulnerabilities  Detection Logic and Signatures" href="#"><span itemprop="name">Ripple20 Critical Vulnerabilities  Detection Logic and Signatures</span></a><meta itemprop="position" content="5"></li>
                                   </ul>
        </div>
        <style type="text/css">
            .breadcrumb-container {
                font-size: 13px;
            }
            .breadcrumb-container ul {
                margin: 0;
                padding: 0;
            }
            .breadcrumb-container li {
                box-sizing: unset;
                display: inline-block;
                margin: 0;
                padding: 0;
            }
            .breadcrumb-container li a {
                box-sizing: unset;
                padding: 0 10px;
            }
            .breadcrumb-container {
                font-size: 12px  !important;
                padding: 0px;
                margin: 0px;
            }
            .breadcrumb-container li a{
                color:  #c01818  !important;
                font-size:  12px  !important;
                line-height:  12px  !important;
            }
            .breadcrumb-container li .separator {
                color: #53565a  !important;
                font-size:  12px  !important;
            }
                            .breadcrumb-container li:last-child .separator {
                    display: none;
                }
                
							
							
.breadcrumb-container.theme1 li {
	margin: 0;
	padding: 0;
}							
							
.breadcrumb-container.theme1 a {
	background: ;
	display: inline-block;
	margin: 0 5px;
	padding: 5px 10px;
	text-decoration: none;
}

.breadcrumb-container{}
.breadcrumb-container ul{}
.breadcrumb-container li{}
.breadcrumb-container a{}
.breadcrumb-container .separator{}
        </style>
                </div>		 
    </div>

    <div class="wrap-section padding-small article">  
        <div class="container medium"> 
            <div class="border-line"></div>

            <div class="author-block padding-bottom-xs">
                <img class="author" src="/wp-content/uploads/2019/04/steve_p_mcafee-300x261.png" />
                <div class="meta">By <a href="/blogs/author/steve-povolny/" title="Posts by Steve Povolny" class="author url fn" rel="author">Steve Povolny</a>, <a href="/blogs/author/douglas-mckee/" title="Posts by Douglas McKee" class="author url fn" rel="author">Douglas McKee</a>, <a href="/blogs/author/mark-bereza/" title="Posts by Mark Bereza" class="author url fn" rel="author">Mark Bereza</a> and <a href="/blogs/author/kevin-mcgrath/" title="Posts by Kevin McGrath" class="author url fn" rel="author">Kevin McGrath</a> on Aug 05, 2020</div>
            </div>

                    <p>This document has been prepared by McAfee Advanced Threat Research in collaboration with JSOF who discovered and responsibly <a href="https://www.jsof-tech.com/ripple20/">disclosed the vulnerabilities</a>. It is intended to serve as a joint research effort to produce valuable insights for network administrators and security personnel, looking to further understand these vulnerabilities to defend against exploitation. The signatures produced here should be thoroughly considered and vetted in staging environments prior to being used in production and may benefit from specific tuning to the target deployment. There are technical limitations to this work, including the fact that more complex methods of detection might be required to detect these vulnerabilities. For example, multiple layers of encapsulation may obfuscate the exploitation of the flaws and increase the difficulty of detection.</p>
<p>We have also provided packet captures taken from the vulnerability Proof-of-Concepts as artifacts for testing and deployment of either the signatures below or customized signatures based on the detection logic. Signatures and Lua Scripts are located on ATR’s <a href="https://github.com/advanced-threat-research/Ripple-20-Detection-Logic">Github</a> page<strong>,</strong> as well as inline and in the appendix of this document respectively.</p>
<p>As of this morning (August 5<sup>th</sup>), JSOF has presented additional technical detail and exploitation analysis at <a href="https://www.blackhat.com/us-20/briefings/schedule/index.html#hacking-the-supply-chain--vulnerabilities-haunt-tens-of-millions-of-critical-devices-19493">BlackHat 2020</a>, on the two most critical vulnerabilities in DNS.</p>
<p><em>The information provided herein is subject to change without notice, and is provided “AS IS”, with all faults, without guarantee or warranty as to the accuracy or applicability of the information to any specific situation or circumstance and for use at your own risk. Additionally, we cannot guarantee any performance or efficacy benchmarks for any of the signatures.</em></p>
<h2>Integer Overflow in <code>tfDnsExpLabelLength</code> Leading to Heap Overflow and RCE</h2>
<p><strong>CVE:</strong> CVE-2020-11901 (Variant 1)<br />
<strong>CVSS:</strong> 9<br />
<strong>Protocol(s): </strong>DNS over UDP (and likely DNS over TCP)<br />
<strong>Port(s): </strong>53</p>
<p><strong>Vulnerability description: </strong><br />
In the Treck stack, DNS names are calculated via the function <code>tfDnsExpLabelLength</code>. A bug exists in this function where the computation is performed using an unsigned short, making it possible to overflow the computed value with a specially constructed DNS response packet. Since <code>tfDnsExpLabelLength</code> computes the full length of a DNS name after it is decompressed, it is possible to induce an overflow using a DNS packet far smaller than 2<sup>16</sup> bytes. In some code paths, <code>tfGetRawBuffer</code> is called shortly after <code>tfDnsExpLabelLength</code>, allocating a buffer on the heap where the DNS name will be stored using the size computed by <code>tfDnsExpLabelLength</code>, thus leading to a heap overflow and potential RCE.</p>
<p>While newer versions of the Treck stack will stop copying the DNS name into the buffer as soon as a character that isn’t alphanumeric or a hyphen is reached, older versions do not have this restriction and further use predictable transaction IDs for DNS queries, making this vulnerability easier to exploit.</p>
<p><strong>Limitations or special considerations for detection:</strong><br />
Ideally, detection logic for this vulnerability would involve independently computing the uncompressed length of all DNS names contained within incoming DNS responses. Unfortunately, this may be computationally expensive for a device to perform for every incoming DNS response, especially since each one may contain many DNS names. Instead, we must rely on a combination of heuristics.</p>
<p>Furthermore, it is currently unclear whether exercising this vulnerability is possible when using EDNS(0) or DNS over TCP. We recommend assuming it is possible for the purposes of implementing detection logic.  During our testing, an inconsistency in how Suricata handled DNS over TCP was discovered – in some cases it was correctly identified as DNS traffic and in other cases, it was not. Consequently, two rules have been created to determine the size of DNS over TCP traffic. The second rule uses the TCP primitive instead of the DNS primitive; however, the second rule will only be evaluated if not flagged by the first rule.</p>
<p>Because the Suricata rule in dns_invalid_size.rules uses the DNS responses’ EDNS UDP length, which may be controlled by the attacker, a second upper limit of 4096 bytes is enforced.</p>
<p><strong>Recommended detection criteria:</strong></p>
<ul>
<li>The device must be capable of processing DNS traffic and matching responses to their corresponding requests.</li>
<li>The device must be capable of identifying individual DNS names within individual DNS packets.</li>
<li>The device should flag any DNS responses whose size exceeds what is “expected”. The expected size depends on the type of DNS packet sent:
<ul>
<li style="list-style-type: none;">
<ul>
<li>For DNS over TCP, the size should not exceed the value specified in the first two bytes of the TCP payload.</li>
<li>For DNS over UDP <em>with </em>EDNS(0), the size should not exceed the value negotiated in the request, which is specified in the CLASS field of the OPT RR, if present.</li>
<li>For DNS over UDP <em>without </em>EDNS(0), the size should not exceed 512 bytes.</li>
<li>These are all checked in dns_invalid_size.rules, which invokes either dns_size.lua or dns_tcp_size.lua for the logic.</li>
</ul>
</li>
</ul>
</li>
<li>The device should flag DNS responses containing DNS names exceeding 255 bytes (prior to decompression).
<ul>
<li style="list-style-type: none;">
<ul>
<li>This is checked in dns_invalid_name.rules, which invokes dns_invalid_name.lua for the logic.</li>
</ul>
</li>
</ul>
</li>
<li>The device should flag DNS responses containing DNS names comprised of characters besides a-z, A-Z, 0-9, “-”, “_”, and “*”.
<ul>
<li style="list-style-type: none;">
<ul>
<li>This is also checked in dns_invalid_name.rules, which invokes dns_invalid_name.lua for the logic.</li>
</ul>
</li>
</ul>
</li>
<li>The device should flag DNS responses containing a large number of DNS compression pointers, particularly pointers one after the other. The specific tolerance will depend on the network.
<ul>
<li style="list-style-type: none;">
<ul>
<li>The device should count all labels starting with the bits 0b10, 0b01, or 0b11 against this pointer total, as vulnerable versions of the Treck stack (incorrectly) classify all labels where the first two bits aren’t 0b00 as compression pointers. In the Lua script, we treat any value above 63 (0x3F) as a pointer for this reason, as any value in that range will have at least one of these bits set.</li>
<li>The specific thresholds were set to 40 total pointers in a single DNS packet or 4 consecutive pointers for our implementation of this rule. These values were chosen since they did not seem to trigger any false positives in a very large test PCAP but should be altered as needed to suit typical traffic for the network the rule will be deployed on. The test for consecutive pointers is especially useful since each domain name should only ever have one pointer (at the very end), meaning we should never be seeing many pointers in a row in normal traffic.</li>
<li>This is implemented in dns_heap_overflow_variant_1.lua, which is invoked by dns_heap_overflow.rules.</li>
</ul>
</li>
</ul>
</li>
<li>Implementation of the detection logic above has been split up amongst several Suricata rule files since only the pointer counting logic is specific to this vulnerability. Detection of exploits leveraging this vulnerability are enhanced with the addition of the DNS layer size check, domain name compressed length check, and domain name character check implemented in the other rules, but these are considered to be “helper” signatures and flagging one of these does not necessarily indicate an exploitation attempt for this specific vulnerability.</li>
</ul>
<p><strong>False positive conditions (signatures detecting non-malicious traffic):</strong><br />
Networks expecting non-malicious traffic containing DNS names using non-alphanumeric characters or an abnormally large number of DNS compression pointers may generate false positives. Unfortunately, checking for pointers in only the domain name fields is insufficient, as a malicious packet could use a compression pointer that points to an arbitrary offset within said packet, so our rule instead checks every byte of the DNS layer. Consequently, Treck’s overly liberal classification of DNS compression pointers means that our rule will often misclassify unrelated bytes in the DNS payload as pointers.</p>
<p>In our testing, we ran into false positives with domain names containing spaces or things like “https://&#8221;. Per the RFCs, characters such as “:” and “/” should not be present in domain names but may show up from time to time in real, non-malicious traffic. The list of acceptable characters should be expanded as needed for the targeted network to avoid excessive false positives. That being said, keeping the list of acceptable characters as small as possible will make it more difficult to sneak in shellcode to leverage one of the Ripple20 DNS vulnerabilities.</p>
<p>False positives on the DNS size rules may occur when DNS over TCP is used if Suricata does not properly classify the packet as a DNS packet – something that has occurred multiple times during our testing. This would cause the second size check to occur, which assumes that all traffic over port 53 is DNS traffic and processes the payload accordingly. As a result, any non-DNS traffic on TCP port 53 may cause false positives in this specific case. It is recommended the port number in the rule be adjusted for any network where a different protocol is expected over port 53.</p>
<p>Fragmentation of DNS traffic over TCP may also introduce false positives. If the streams are not properly reconstructed at the time the rules execute on the DNS payload, byte offsets utilized in the attached Lua scripts could analyze incorrect data. Fragmentation in DNS response packets is not common on a standard network unless MTU values have been set particularly low. Each rule should be evaluated independently prior to use in production based on specific network requirements and conditions.</p>
<p><strong>False negative conditions (signatures failing to detect vulnerability/exploitation):</strong><br />
False negatives are more likely as this detection logic relies on heuristics due to computation of the uncompressed DNS name length being too computationally expensive. Carefully constructed malicious packets may be able to circumvent the suggested pointer limitations and still trigger the vulnerability.</p>
<p><strong>Signature(s):</strong><br />
dns_invalid_size.rules:</p>
<p><code>alert dns any any ‑&gt; any any (msg:"DNS packet too large"; flow:to_client; flowbits:set,flagged; lua:dns_size.lua; sid:2020119014; rev:1;)</code><br />
<em>Lua</em><em> script (dns_size.lua) can be found in </em><em>Appendix A</em></p>
<p><code>alert tcp any 53 -&gt; any any (msg:"DNS over TCP packet too large"; flow:to_client,no_frag; flowbits:isnotset,flagged; lua:dns_tcp_size.lua; sid:2020119015; rev:1;)</code><br />
<em>Lua</em><em> script (dns_tcp_size.lua) can be found in </em><em>Appendix A</em></p>
<p>dns_invalid_name.rules:</p>
<p><code>alert dns any any -&gt; any any (flow:to_client; msg:"DNS response contains invalid domain name"; lua:dns_invalid_name.lua; sid:2020119013; rev:1;)</code><br />
<em>Lua</em><em> script (dns_invalid_name.lua) can be found in </em><em>Appendix A</em></p>
<p>dns_heap_overflow.rules:</p>
<p><code># Variant 1</code><br />
<code>alert dns any any -&gt; any any (flow:to_client; msg:"Potential DNS heap overflow exploit (CVE-2020-11901)"; lua:dns_heap_overflow_variant_1.lua; sid:2020119011; rev:1;)</code><br />
<em>Lua</em><em> script (dns_heap_overflow_variant_1.lua) can be found in </em><em>Appendix A</em></p>
<h2>RDATA Length Mismatch in DNS CNAME Records Causes Heap Overflow</h2>
<p><strong>CVE:</strong> CVE-2020-11901 (Variant 2)<br />
<strong>CVSS:</strong> 9<br />
<strong>Protocol(s):</strong> DNS/UDP (and likely DNS/TCP)<br />
<strong>Port(s): </strong>53</p>
<p><strong>Vulnerability description:</strong><br />
In some versions of the Treck stack, a vulnerability exists in the way the stack processes DNS responses containing CNAME records. In such records, the length of the buffer allocated to store the DNS name is taken from the RDLENGTH field, while the data written is the full, decompressed domain name, terminating only at a null byte. As a result, if the size of the decompressed domain name specified in RDATA exceeds the provided RDLENGTH in a CNAME record, the excess is written past the end of the allocated buffer, resulting in a heap overflow and potential RCE.</p>
<p><strong>Limitations or special considerations for detection:</strong><br />
Although exploitation of this vulnerability has been confirmed using malicious DNS over UDP packets, it has not been tested using DNS over TCP and it is unclear if such packets would exercise the same vulnerable code path. Until this can be confirmed, detection logic should assume both vectors are vulnerable.</p>
<p><strong>Recommended detection criteria:</strong></p>
<ul>
<li>The device must be capable of processing incoming DNS responses.</li>
<li>The device must be capable of identifying CNAME records within DNS responses</li>
<li>The device should flag all DNS responses where the actual size of the RDATA field for a CNAME record exceeds the value specified in the same record’s RDLENGTH field.
<ul>
<li style="list-style-type: none;">
<ul>
<li>In this case, the “actual size” corresponds to how vulnerable versions of the Treck stack compute the RDATA length, which involves adding up the size of every label until either null byte, a DNS compression pointer, or the end of the payload is encountered. The Treck stack will follow and decompress the pointer that terminates the domain name, if present, but the script does not as this computation is simply too expensive, as mentioned previously.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>False positive conditions (signatures detecting non-malicious traffic):</strong><br />
False positives should be unlikely, but possible in scenarios where network devices send non-malicious traffic where RDLENGTH is not equal to the size of RDATA, thereby breaking RFC 1035.</p>
<p><strong>False negative conditions (signatures failing to detect vulnerability/exploitation):</strong><br />
Since the detection logic does not perform decompression when computing the “actual size” of RDATA, it will fail to detect malicious packets that contain domain names whose length only exceeds RDLENGTH after decompression. Unfortunately, coverage for this case is non-trivial as such packets are actually RFC-compliant. According to RFC 1035, section 4.1.4:</p>
<p>If a domain name is contained in a part of the message subject to a length field (such as the RDATA section of an RR), and compression is used, the length of the compressed name is used in the length calculation, rather than the length of the expanded name.</p>
<p>Besides the computational overhead, enforcing such a check would likely result in very high false positive rates.</p>
<p><strong>Signature(s):</strong><br />
dns_heap_overflow.rules:</p>
<p><code># Variant 2</code><br />
<code>alert dns any any -&gt; any any (flow:to_client; msg:"Potential DNS heap overflow exploit (CVE-2020-11901)"; lua:dns_heap_overflow_variant_2.lua; sid:2020119012; rev:1;)</code><br />
<em>Lua script (dns_heap_overflow_variant_2.lua) can be found in </em><em>Appendix A</em></p>
<h2>Write Out-of-Bounds Using Routing Header Type 0</h2>
<p><strong>CVE:</strong> CVE-2020-11897<br />
<strong>CVSS:</strong> 10<br />
<strong>Protocol(s):</strong> IPv6<br />
<strong>Port(s):</strong> N/A</p>
<p><strong>Vulnerability description: </strong><br />
When processing IPv6 incoming packets, an inconsistency parsing the IPv6 routing header can be triggered where the header length is checked against the total packet and not against the fragment length. This means that if we send fragmented packets with the overall size greater than or equal to the specified routing header length, then we process the routing header under the assumption that we have enough bytes in our current fragment (where we have enough bytes in the overall reassembled packet only). Thus, using routing header type 0 (RH0) we can force read and write into out-of-bounds memory location.</p>
<p>There is also a secondary side effect where we can get an info leak in a source IPv6 address in an ICMP parameter returned from the device.</p>
<p><strong>Limitations or special considerations for detection:</strong><br />
The RFC for RH0 defines the length field as equal to “two times the number of addresses in the header.”  For example, if the routing header length is six, then there are three IPv6 addresses expected in the header. Upon reconstruction of the fragmented packets, the reported number of addresses is filled with data from the fragments that follow. This creates “invalid” IPv6 addresses in the header and potentially malforms the next layer of the packet. During exploitation, it would also be likely for the next layer of the packet to be malformed. Although ICMP can be used to perform an information leak, it is possible for the next layer to be any type and therefore vary in length. Verification of the length of this layer could therefore be very expensive and non-deterministic.</p>
<p><strong>Recommended detection criteria:</strong></p>
<ul>
<li>The device must be capable of processing fragmented IPv6 traffic</li>
<li>The device should inspect fragmented packets containing Routing Header type 0 (RH0). If a RH0 IPv6 packet is fragmented, then the vulnerability is likely being exploited</li>
<li>If the length of the IPv6 layer of a packet fragment containing the RH0 header is less than the length reported in the routing header, then the vulnerability is likely being exploited</li>
<li>Upon reconstruction of the fragmented packets, if the header of the layer following IPv6 is malformed, the vulnerability may be being exploited</li>
</ul>
<p><strong>Notes:</strong><br />
The routing header type 0 was deprecated in IPv6 traffic in RFC 5095 as of December 2007. As a result, it may be feasible simply to detect packets using this criterion. False positives may be possible in this scenario for legacy devices or platforms. Suricata already provides a default rule for this scenario which has been added below. According to the RFC, routers are not supposed to fragment IPv6 packets and must support an MTU of 1280, which would always contain all of the RH0 header, unless an unusual amount of header extensions or an unusually large header is used. If this is followed, then a packet using the RH0 header should never be fragmented across the RH0 extension header bounds and any RH0 packet fragmented in this manner should be treated as potentially malicious. Treating any fragmented RH0 packet as potentially malicious may be sufficient. Furthermore, treating any fragmented RH0 packet with fragments size below a threshold as well as IPv6 packets with multiple extension headers or an unusually large header above a threshold may provide high accuracy detection.</p>
<p><strong>False positive conditions (signatures detecting non-malicious traffic)</strong>:<br />
If all detection criteria outlined above are used, false positives should be minimal since the reported length of a packet should match its actual length and the next header should never contain malformed data.  If only routing header type 0 is checked, false positives are more likely to occur.  In the additional provided rule, false positives should be minimal since RH0 is deprecated and the ICMP header should never have invalid checksums or unknown codes.</p>
<p><strong>False negative conditions (signatures failing to detect vulnerability/exploitation)</strong>:<br />
False negatives may occur if the signature is developed overly specific to the layer following IPv6, for example, ICMP.  An attacker could potentially leverage another layer and still exploit the vulnerability without the information leak; however, this would still trigger the default RH0 rule. In the second rule below, false negatives are likely to occur if:</p>
<ul>
<li>An attacker uses a non-ICMP layer following the IPv6 layer</li>
<li>A valid ICMP code is used</li>
<li>The checksum is valid, and the payload is less than or equal to 5 bytes (this value can be tuned in the signature)</li>
</ul>
<p><strong>Signature(s):</strong><br />
Ipv6_rh0.rules:</p>
<p><code>alert ipv6 any any -&gt; any any (msg:"SURICATA RH Type 0"; decode-event:ipv6.rh_type_0; classtype:protocol-command-decode; sid:2200093; rev:2;)</code></p>
<p><code>alert ipv6 any any -&gt; any any (msg:"IPv6 RH0 Treck CVE-2020-11897"; decode-event:ipv6.rh_type_0; decode-event:icmpv6.unknown_code; icmpv6-csum:invalid; dsize:&gt;5; sid:2020118971; rev:1;)</code></p>
<h2>IPv4/UDP Tunneling Remote Code Execution</h2>
<p><strong>CVE:</strong> CVE-2020-11896<br />
<strong>CVSS:</strong> 10.0<br />
<strong>Protocol(s):</strong> IPv4/UDP<br />
<strong>Port(s):</strong> Any</p>
<p><strong>Vulnerability description:</strong><br />
The Treck TCP/IP stack does not properly handle incoming IPv4-in-IPv4 packets with fragmented payload data. This could lead to remote code execution when sending multiple specially crafted tunneled UDP packets to a vulnerable host.</p>
<p>The vulnerability is a result of an incorrect trimming operation when the advertised total IP length (in the packet header) is strictly less than the data available. When sending tunneled IPv4 packets using multiple fragments with a small total IP length value, the TCP/IP stack would execute the trimming operation. This leads to a heap overflow situation when the packet is copied to a destination packet allocated based on the smaller length. When the tunneled IPv4 packets are UDP packets sent to a listening port, there’s a possibility to trigger this exploit if the UDP receive queue is non-empty. This can result in an exploitable heap overflow situation, leading to remote code execution in the context in which the Treck TCP/IP stack runs.</p>
<p><strong>Recommended detection criteria:</strong><br />
In order to detect an ongoing attack, the following conditions should be met <em>if encapsulation can be unpacked</em>:</p>
<ul>
<li>The UDP receive queue must be non-empty</li>
<li>Incoming UDP packets must be fragmented
<ul>
<li style="list-style-type: none;">
<ul>
<li>Flag MF = 1 with any offset, or</li>
<li>Flag MF = 0 with non-zero offset</li>
</ul>
</li>
</ul>
</li>
<li>Fragmented packets must have encapsulated IPv4 packet (upon assembly)<br />
protocol = 0x4 (IPIP)</li>
<li>Encapsulated IPv4 packet must be split across 2 packet fragments.</li>
<li>Reassembled (inner-most) IPv4 packet has incorrect data length stored in IP header.</li>
</ul>
<p>The fourth condition above is required to activate the code-path which is vulnerable, as it spreads the data to be copied across multiple in-memory buffers. The final detection step is the source of the buffer overflow, as such, triggering on this may be sufficient.</p>
<p>Depending on the limitations of the network inspection device in question, a looser condition could be used, though it may be more prone to false positives.</p>
<p>In order to detect an ongoing attack <em>if encapsulation cannot be unpacked</em>:</p>
<ul>
<li>The UDP receive queue must be non-empty</li>
<li>Incoming UDP packets must be fragmented
<ul>
<li style="list-style-type: none;">
<ul>
<li>Flag MF = 1 with any value in offset field, or</li>
<li>Flag MF = 0 with any non-zero value in offset field</li>
</ul>
</li>
</ul>
</li>
<li>Final fragment has total fragment length longer than offset field.</li>
</ul>
<p>The final condition shown above is not something that should be seen in a normal network.</p>
<p>Fragmentation, when it occurs, is the result of data overflowing the MTU of a given packet type. This indicates the final fragment should be no larger than any other fragment – and in practice would likely be smaller. The inverse, where the final fragment is somehow larger than previous fragments, indicates that the fragmentation is not the result of MTU overflow, but instead something else. In this case, malicious intent.</p>
<p>As network monitors in common usage are likely to have the ability to unpack encapsulation, only that ruleset is provided.</p>
<p><strong>Limitations or special considerations for detection:</strong><br />
The Treck stack supports (at least) two levels of tunneling. Each tunnel level can be IPv4-in-IPv4, IPv6-in-IPv4, or IPv4-in-IPv6. The above logic is specific to the IPv4-in-IPv4, single level of tunneling case. In cases of deeper nesting, either a recursive check or a full unwrapping of all tunneling layers will be necessary.</p>
<p><strong>False positive conditions (signatures detecting non-malicious traffic):</strong><br />
False positives should be minimal if all detection criteria outlined above are used in the case where the tunneling can be unpacked. In the case where tunneling cannot be unpacked, this is unlikely to trigger many false positives in the presence of standards compliant applications. Fragmentation as seen here is simply not common.</p>
<p><strong>False negative conditions (signatures failing to detect vulnerability/exploitation):</strong><br />
False negatives could occur with deeper levels of nesting, or nesting of IPv6.</p>
<p><strong>Signature(s):</strong><br />
ipv4_tunneling.rules:</p>
<p><code>alert ip any any -&gt; any any (msg:"IPv4 TUNNELING EXPLOIT (CVE‑2020‑11896)"; ip_proto:4; lua:tunnel_length_check.lua; sid:2020118961; rev:1;)</code><br />
<em>Lua</em><em> script (tunnel_length_check.Lua) can be found in </em><em>Appendix A</em></p>
<h2>Appendix A</h2>
<p>Appendix A contains Lua scripts that are required for usage with corresponding Suricata signatures. These scripts are also located on McAfee ATR’s <a href="https://github.com/advanced-threat-research/Ripple-20-Detection-Logic/tree/master/suricata_rules">GitHub</a><span style="font-size: 16px;">.</span></p>
<h3><span class="TextRun SCXW8946001 BCX0" lang="EN-US" xml:lang="EN-US" data-contrast="auto"><span class="NormalTextRun SpellingErrorV2 SCXW8946001 BCX0" data-ccp-parastyle="heading 2">dns_tcp_size</span></span><span class="TextRun SCXW8946001 BCX0" lang="EN-US" xml:lang="EN-US" data-contrast="auto"><span class="NormalTextRun SpellingErrorV2 SCXW8946001 BCX0" data-ccp-parastyle="heading 2">.</span></span><span class="TextRun SCXW8946001 BCX0" lang="EN-US" xml:lang="EN-US" data-contrast="auto"><span class="NormalTextRun SpellingErrorV2 SCXW8946001 BCX0" data-ccp-parastyle="heading 2">l</span></span><span class="TextRun SCXW8946001 BCX0" lang="EN-US" xml:lang="EN-US" data-contrast="auto"><span class="NormalTextRun SpellingErrorV2 SCXW8946001 BCX0" data-ccp-parastyle="heading 2">ua</span></span><span class="TextRun SCXW8946001 BCX0" lang="EN-US" xml:lang="EN-US" data-contrast="auto"><span class="NormalTextRun SCXW8946001 BCX0" data-ccp-parastyle="heading 2">:</span></span><span class="EOP SCXW8946001 BCX0" data-ccp-props="{&quot;201341983&quot;:0,&quot;335559738&quot;:120,&quot;335559739&quot;:120,&quot;335559740&quot;:240}"> </span></h3>
<h3><img class="alignnone size-full wp-image-104746" src="/wp-content/uploads/2020/08/dns_tcp_size-1.png" alt="" width="2220" height="1274" srcset="/wp-content/uploads/2020/08/dns_tcp_size-1.png 2220w, /wp-content/uploads/2020/08/dns_tcp_size-1-300x172.png 300w, /wp-content/uploads/2020/08/dns_tcp_size-1-1024x588.png 1024w, /wp-content/uploads/2020/08/dns_tcp_size-1-768x441.png 768w, /wp-content/uploads/2020/08/dns_tcp_size-1-1536x881.png 1536w, /wp-content/uploads/2020/08/dns_tcp_size-1-2048x1175.png 2048w, /wp-content/uploads/2020/08/dns_tcp_size-1-205x118.png 205w" sizes="(max-width: 2220px) 100vw, 2220px" /></h3>
<h3><span class="TextRun SCXW19765359 BCX0" lang="EN-US" xml:lang="EN-US" data-contrast="auto"><span class="NormalTextRun SpellingErrorV2 SCXW19765359 BCX0" data-ccp-parastyle="heading 2">dns_size.</span></span><span class="TextRun SCXW19765359 BCX0" lang="EN-US" xml:lang="EN-US" data-contrast="auto"><span class="NormalTextRun SpellingErrorV2 SCXW19765359 BCX0" data-ccp-parastyle="heading 2">l</span></span><span class="TextRun SCXW19765359 BCX0" lang="EN-US" xml:lang="EN-US" data-contrast="auto"><span class="NormalTextRun SpellingErrorV2 SCXW19765359 BCX0" data-ccp-parastyle="heading 2">ua</span></span><span class="TextRun SCXW19765359 BCX0" lang="EN-US" xml:lang="EN-US" data-contrast="auto"><span class="NormalTextRun SCXW19765359 BCX0" data-ccp-parastyle="heading 2">:</span></span><span class="EOP SCXW19765359 BCX0" data-ccp-props="{&quot;201341983&quot;:0,&quot;335559738&quot;:120,&quot;335559739&quot;:120,&quot;335559740&quot;:240}"> </span></h3>
<p><img class="alignnone size-full wp-image-104749" src="/wp-content/uploads/2020/08/dns_size-1.png" alt="" width="2220" height="2652" srcset="/wp-content/uploads/2020/08/dns_size-1.png 2220w, /wp-content/uploads/2020/08/dns_size-1-251x300.png 251w, /wp-content/uploads/2020/08/dns_size-1-857x1024.png 857w, /wp-content/uploads/2020/08/dns_size-1-768x917.png 768w, /wp-content/uploads/2020/08/dns_size-1-1286x1536.png 1286w, /wp-content/uploads/2020/08/dns_size-1-1714x2048.png 1714w, /wp-content/uploads/2020/08/dns_size-1-108x129.png 108w" sizes="(max-width: 2220px) 100vw, 2220px" /></p>
<h3>dns_invalid_name.lua:</h3>
<p><img class="alignnone size-full wp-image-104764" src="/wp-content/uploads/2020/08/dns_invalid_name-4.png" alt="" width="1110" height="4287" srcset="/wp-content/uploads/2020/08/dns_invalid_name-4.png 1110w, /wp-content/uploads/2020/08/dns_invalid_name-4-78x300.png 78w, /wp-content/uploads/2020/08/dns_invalid_name-4-265x1024.png 265w, /wp-content/uploads/2020/08/dns_invalid_name-4-768x2966.png 768w, /wp-content/uploads/2020/08/dns_invalid_name-4-398x1536.png 398w, /wp-content/uploads/2020/08/dns_invalid_name-4-530x2048.png 530w" sizes="(max-width: 1110px) 100vw, 1110px" /></p>
<pre></pre>
<h3>dns_heap_overflow_variant_1.lua:</h3>
<p><img class="alignnone size-full wp-image-104755" src="/wp-content/uploads/2020/08/dns_heap_overflow_variant_1-3.png" alt="" width="2220" height="2802" srcset="/wp-content/uploads/2020/08/dns_heap_overflow_variant_1-3.png 2220w, /wp-content/uploads/2020/08/dns_heap_overflow_variant_1-3-238x300.png 238w, /wp-content/uploads/2020/08/dns_heap_overflow_variant_1-3-811x1024.png 811w, /wp-content/uploads/2020/08/dns_heap_overflow_variant_1-3-768x969.png 768w, /wp-content/uploads/2020/08/dns_heap_overflow_variant_1-3-1217x1536.png 1217w, /wp-content/uploads/2020/08/dns_heap_overflow_variant_1-3-1623x2048.png 1623w, /wp-content/uploads/2020/08/dns_heap_overflow_variant_1-3-102x129.png 102w" sizes="(max-width: 2220px) 100vw, 2220px" /></p>
<h3>dns_heap_overflow_variant_2.lua:</h3>
<p><img class="alignnone size-full wp-image-104770" src="/wp-content/uploads/2020/08/dns_heap_overflow_variant_2-1.png" alt="" width="2220" height="4738" srcset="/wp-content/uploads/2020/08/dns_heap_overflow_variant_2-1.png 2220w, /wp-content/uploads/2020/08/dns_heap_overflow_variant_2-1-141x300.png 141w, /wp-content/uploads/2020/08/dns_heap_overflow_variant_2-1-480x1024.png 480w, /wp-content/uploads/2020/08/dns_heap_overflow_variant_2-1-768x1639.png 768w, /wp-content/uploads/2020/08/dns_heap_overflow_variant_2-1-720x1536.png 720w, /wp-content/uploads/2020/08/dns_heap_overflow_variant_2-1-960x2048.png 960w, /wp-content/uploads/2020/08/dns_heap_overflow_variant_2-1-60x129.png 60w" sizes="(max-width: 2220px) 100vw, 2220px" /></p>
<h3>tunnel_length_check.lua:</h3>
<p><img class="alignnone size-full wp-image-104773" src="/wp-content/uploads/2020/08/tunnel_length_check-1.png" alt="" width="2220" height="1908" srcset="/wp-content/uploads/2020/08/tunnel_length_check-1.png 2220w, /wp-content/uploads/2020/08/tunnel_length_check-1-300x258.png 300w, /wp-content/uploads/2020/08/tunnel_length_check-1-1024x880.png 1024w, /wp-content/uploads/2020/08/tunnel_length_check-1-768x660.png 768w, /wp-content/uploads/2020/08/tunnel_length_check-1-1536x1320.png 1536w, /wp-content/uploads/2020/08/tunnel_length_check-1-2048x1760.png 2048w, /wp-content/uploads/2020/08/tunnel_length_check-1-150x129.png 150w" sizes="(max-width: 2220px) 100vw, 2220px" /></p>
        </div>
    </div>

    <div class="wrap-section">  
        <div class="container medium">
            <h3>About the Author</h3>
        </div>
    </div>

    <div class="wrap-section padding-small bg-light-gray author-container">  
        <div class="container medium"> 


                <div class="row">
                    <div class="col-sm-2 col-xs-4 text-center">
                        <a href="/blogs/author/steve-povolny/"><img class="author" src="/wp-content/uploads/2019/04/steve_p_mcafee-300x261.png" /></a>
                        <ul class="social-networks">
                <li><a href="https://twitter.com/spovolny" rel="nofollow" target="_blank"><i class="symbol-twitter"></i><span>Twitter</span></a></li><li><a href="https://www.linkedin.com/in/steve-povolny-595a776/" rel="nofollow" target="_blank"><i class="symbol-linkedin"></i><span>LinkedIn</span></a></li>                        </ul>
                    </div>
                    <div class="col-sm-10 col-xs-8">
                        <h3 class="red"><a href="/blogs/author/steve-povolny/">Steve Povolny</a></h3>
                        <p>Steve Povolny is the Head of McAfee Advanced Threat Research, which delivers groundbreaking vulnerability research spanning nearly every industry. With more than a decade of experience in network security, Steve is a recognized authority on hardware and software vulnerabilities, and regularly collaborates with influencers in academia, government, law enforcement, consumers and enterprise businesses of all ...</p>						
                        <a href="/blogs/author/steve-povolny/" class="caret-link">Read more posts from Steve Povolny </a>
                    </div>
                </div><br/>
                            
                <div class="row">
                    <div class="col-sm-2 col-xs-4 text-center">
                        <a href="/blogs/author/douglas-mckee/"><img class="author" src="/wp-content/uploads/2019/01/Douglas-01-5x5-300x300.jpg" /></a>
                        <ul class="social-networks">
                <li><a href="https://twitter.com/fulmetalpackets" rel="nofollow" target="_blank"><i class="symbol-twitter"></i><span>Twitter</span></a></li><li><a href="https://www.linkedin.com/in/douglas-mckee-77460677/" rel="nofollow" target="_blank"><i class="symbol-linkedin"></i><span>LinkedIn</span></a></li>                        </ul>
                    </div>
                    <div class="col-sm-10 col-xs-8">
                        <h3 class="red"><a href="/blogs/author/douglas-mckee/">Douglas McKee</a></h3>
                        <p>Douglas McKee is a Principal Engineer and Senior Security Researcher for the McAfee Advanced Threat Research team, focused on finding new vulnerabilities in both software and hardware. Douglas has an extensive background in penetration testing, reverse engineering, malware analysis and forensics and throughout his career has provided software exploitation training to many audiences, including law ...</p>						
                        <a href="/blogs/author/douglas-mckee/" class="caret-link">Read more posts from Douglas McKee </a>
                    </div>
                </div><br/>
                            
                <div class="row">
                    <div class="col-sm-2 col-xs-4 text-center">
                        <a href="/blogs/author/mark-bereza/"><img class="author" src="/wp-content/uploads/2019/08/headshot-267x300.png" /></a>
                        <ul class="social-networks">
                <li><a href="https://twitter.com/@ROPsicle" rel="nofollow" target="_blank"><i class="symbol-twitter"></i><span>Twitter</span></a></li><li><a href="https://www.linkedin.com/in/mark-bereza/" rel="nofollow" target="_blank"><i class="symbol-linkedin"></i><span>LinkedIn</span></a></li>                        </ul>
                    </div>
                    <div class="col-sm-10 col-xs-8">
                        <h3 class="red"><a href="/blogs/author/mark-bereza/">Mark Bereza</a></h3>
                        <p>Mark Bereza is a Security Researcher and recent addition to McAfee's Advanced Threat Research team. An alumnus of Oregon State University's CS systems program, Mark's work has focused on vulnerability discovery and exploit development for embedded systems.</p>						
                        <a href="/blogs/author/mark-bereza/" class="caret-link">Read more posts from Mark Bereza </a>
                    </div>
                </div><br/>
                            
                <div class="row">
                    <div class="col-sm-2 col-xs-4 text-center">
                        <a href="/blogs/author/kevin-mcgrath/"><img class="author" src="/wp-content/uploads/2020/01/dmcgrath_headshot-232x300.jpg" /></a>
                        <ul class="social-networks">
                                        </ul>
                    </div>
                    <div class="col-sm-10 col-xs-8">
                        <h3 class="red"><a href="/blogs/author/kevin-mcgrath/">Kevin McGrath</a></h3>
                        <p>D. Kevin McGrath is a Security Researcher on McAfee’s Advanced Threat Research team, focused on finding new vulnerabilities in both software and hardware. Kevin has a focus on embedded devices, RTOS security, and security education, with emphasis on computer architecture and operating systems.</p>						
                        <a href="/blogs/author/kevin-mcgrath/" class="caret-link">Read more posts from Kevin McGrath </a>
                    </div>
                </div><br/>
                                    </div>
    </div>

    <div class="wrap-section padding-top-xs">  
        <div class="container medium"> 
            <div class="row">
                            <div class="col-sm-6 col-xs-6">
            <a href="/blogs/consumer/what-security-means-to-families/" rel="prev"><i class="fa fa-angle-left" aria-hidden="true"></i> Previous Article</a> 
                </div>
                <div class="col-sm-6 col-xs-6 text-right">
<a href="/blogs/other-blogs/mcafee-labs/dopple-ganging-up-on-facial-recognition-systems/" rel="next">Next Article <i class="fa fa-angle-right" aria-hidden="true"></i></a>                </div>
            </div>
        </div>
    </div>
    <div class="wrap-section padding-top-xs"> 
        <div class="container medium">
                    <p class="small rule">Categories: <a href="/blogs/other-blogs/mcafee-labs/" rel="category tag">McAfee Labs</a><br /> 
            </p>	

        </div>		 
    </div>
    <div class="container medium">
                    <ol class="commentlist">
                    </ol>
             
    </div>
    
    <div class="wrap-section padding-top-small">  
        <div class="container medium">
                                </div>
    </div>
        <div class="wrap-section bg-red bg-image padding-medium" id="subscribe">
      <div class="container medium">
        <div class="row">
          <div class="col-sm-12">
            <div class="cta-component text-center">
              <h3>Subscribe to McAfee Securing Tomorrow Blogs</h3>
                         <form method="get" action="/blogs/subscribe/" class="form-inline">
            
              <input type="text" placeholder="Email address" name="subscriber_email" />
          
            <button type="submit" class="btn transparent">Subscribe</button>
          </form>
              
            </div>
          </div>
        </div>
      </div>
    </div>

</main>
<!--Footer of en-us starts here --> 
    
	<aside class="tools">
		<a href="#wrapper" class="back-to-top">Back to top</a>
	</aside>
  
  <div class="textwidget custom-html-widget"><div class="wrap-section padding-bottom-medium padding-top-small bg-dark-gray" id="footer">
    <div class="container medium">           
      <div class="row">
         <div class="col-sm-6 breadcrumb">
        	<ul class="breadcrumb-list">
        		<li><a class="symbols-label first" href="/blogs"><i class="symbol-shield"></i><span>McAfee Home</span></a></li>
        		<li><a class="symbols-label" href="/blogs"><i class="symbol-arrow-forward"></i><span>Securing Tomorrow</span></a></li>
					 </ul>
				</div>
        <div class="col-sm-6 social">
          <!-- <a id="usbl-integrated-button" class="symbols-label" href=""><i class="symbol-feedback"></i><span>Feedback</span></a> -->
          <ul class="social-networks">
            <li><a href="https://twitter.com/mcafee" title="Twitter" target="_blank" rel="noopener noreferrer"><i class="symbol-twitter"></i><span>Twitter</span></a></li>
            <li><a href="http://www.facebook.com/mcafee" title="Facebook" target="_blank" rel="noopener noreferrer"><i class="symbol-facebook"></i><span>Facebook</span></a></li>
            <li><a href="https://www.linkedin.com/company/2336?trk=prof-exp-company-name" title="LinkedIn" target="_blank" rel="noopener noreferrer"><i class="symbol-linkedin"></i><span>LinkedIn</span></a></li>
            <li><a href="http://www.youtube.com/mcafee" title="YouTube" target="_blank" rel="noopener noreferrer"><i class="symbol-youtube"></i><span>YouTube</span></a></li>
            <li><a href="/blogs/" title="Blog" target="_blank" rel="noopener noreferrer"><i class="symbol-blog"></i><span>Blog</span></a></li>
					</ul>
        </div>
      </div>
      <hr />
      <div class="row">
        <div class="col-sm-3">
          <a class="symbols-label" href="/enterprise/en-us/about/region-selector.html"><i class="symbol-language"></i><span>United States / English</span></a>
        </div>
        <div class="col-sm-9">
           <a href="//www.scanalert.com/RatingVerify?ref=www.mcafee.com" target="_blank" class="mcafee-secure" rel="noopener noreferrer"><img src="https://www.mcafee.com/enterprise/en-us/img/v1/common/logo-mcafee-secure.svg" alt="McAfee SECURE"/></a>
          <ul class="footer-menu">
            <li><a href="/enterprise/en-us/about/legal/privacy.html">Privacy</a></li>
            <li><a href="/enterprise/en-us/about/legal/notices.html">Legal Notices</a></li>
            <li><a href="/enterprise/en-us/about/legal/contracts-terms.html">Legal Contracts &amp; Terms</a></li>
            <li><a href="/enterprise/en-us/site-map.html">Site Map</a></li>
            <li>Copyright ©2020 McAfee, LLC</li>
          </ul>
        </div>
      </div>          
    </div>            	
  </div>
</div></div>


</body>	
<script type="text/javascript">
   if ($('div.author-block .meta').length > 0) {
      utag_data.tm_local_blogs_author = $('div.author-block .meta').text().split(' on ')[0].replace("By","").trim();
    }
    (function(a,b,c,d){
    a='//tags.tiqcdn.com/utag/mcafee/consumer-main/prod/utag.js'; // Note: Please use prod for production version and dev for dev version before release
    b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;
    a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a);
    })();
</script>

<script type='text/javascript' src='/wp-content/plugins/metronet-profile-picture/js/mpp-frontend.js?ver=2.3.8'></script>
<script type='text/javascript'>
/* Highlight Search Terms 1.5 ( RavanH - http://status301.net/wordpress-plugins/highlight-search-terms/ ) */
var hlst_query = []; var hlst_areas = ["#groups-dir-list","#members-dir-list","div.bbp-topic-content,div.bbp-reply-content,li.bbp-forum-info,.bbp-topic-title,.bbp-reply-title","article","div.hentry","div.post","#content","#main","div.content","#middle","#container","div.container","div.page","#wrapper","body"];
</script>
<script type='text/javascript' src='/wp-content/plugins/highlight-search-terms/hlst-extend.min.js?ver=1.5'></script>
<script type='text/javascript' src='/wp-content/plugins/social-polls-by-opinionstage/public/js/shortcodes.js?ver=19.6.31'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpmm_object = {"ajax_url":"https:\/\/www.mcafee.com\/wp-admin\/admin-ajax.php","wpmm_responsive_breakpoint":"767px","wpmm_disable_mobile":"false"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/wp-megamenu/assets/js/wpmm.js?ver=1.3.1'></script>
<script type='text/javascript' src='/wp-content/themes/securingtomorrow/js/theme-script.js?ver=5.4.2'></script>
<script type='text/javascript' src='/wp-content/themes/securingtomorrow/js/skip-link-focus-fix.min.js?ver=20151215'></script>
<script type='text/javascript' src='/wp-content/plugins/super-socializer/js/front/social_login/general.js?ver=7.12.37'></script>
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=5.4.2'></script>
	
<script src="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js?ver=10faaf528e636a046163bdb6753031b2"></script>
<script src="/wp-content/themes/securingtomorrow/js/jquery-lib.js"></script>
<script src="/wp-content/themes/securingtomorrow/js/main.js"></script>
<script src="/wp-content/themes/securingtomorrow/js/general_footer.js"></script>
<!-- Consumer Facebook Pixel Code -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '187610925152304');
  fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=187610925152304&ev=PageView&noscript=1"/></noscript>
<!-- End Facebook Pixel Code -->

<!-- Start linkedIn pixel -->
<script type="text/javascript">
_linkedin_partner_id = "68395";
window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || [];
window._linkedin_data_partner_ids.push(_linkedin_partner_id);
</script><script type="text/javascript">
(function(){var s = document.getElementsByTagName("script")[0];
var b = document.createElement("script");
b.type = "text/javascript";b.async = true;
b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js";
s.parentNode.insertBefore(b, s);})();
</script>
<noscript>
<img height="1" width="1" style="display:none;" alt="" src="https://dc.ads.linkedin.com/collect/?pid=68395&fmt=gif" />
</noscript>
<!-- End linkedIn pixel -->

<!-- Twitter universal website tag code -->
<script>
!function(e,t,n,s,u,a){e.twq||(s=e.twq=function(){s.exe?s.exe.apply(s,arguments):s.queue.push(arguments);
},s.version='1.1',s.queue=[],u=t.createElement(n),u.async=!0,u.src='//static.ads-twitter.com/uwt.js',
a=t.getElementsByTagName(n)[0],a.parentNode.insertBefore(u,a))}(window,document,'script');
// Insert Twitter Pixel ID and Standard Event data below
twq('init','nxlgc');
twq('track','PageView');
</script>
<!-- Twitter universal website tag code -->

<script>
/* <![CDATA[ */
var google_conversion_id = 975085349;
var google_custom_params = window.google_tag_params;
var google_remarketing_only = true;
/* ]]> */
document.write('\x3Cscript type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js">\x3C/script>');
//document.write('\x3Cnoscript>\x3Cimg height="1" width="1" style="border-style:none;display:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/975085349/?guid=ON&script=0"/>\x3C/noscript>');
</script>

<!-- Enterprise Facebook Pixel Code -->
<script>
// load Facebook
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '766537420057144');
fbq('track', "PageView");

//document.write('\x3Cnoscript>\x3Cimg height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=766537420057144&ev=PageView&noscript=1" />\x3C/noscript>');
</script>
<!-- Facebook Pixel Code -->

<!-- Adobe Launch START -->
<script src="//assets.adobedtm.com/launch-ENc117a6a508e14a879398dd6f37ed54a3.min.js"></script>
<!-- Adobe Launch END -->
<script>_satellite.pageBottom()</script>
</html>


<style>
    .commentlist {
        display: none;
    }
</style>
<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me - Debug: cached@1616227654 -->