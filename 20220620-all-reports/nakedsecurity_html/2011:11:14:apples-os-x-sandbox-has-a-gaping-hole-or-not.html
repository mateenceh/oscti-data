<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="RHQeasQqjasbRt5asY6atZYbs5tr10gFBevDt2HRhW0" />
<link rel="pingback" href="https://nakedsecurity.sophos.com/xmlrpc.php">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5VK6LTK');</script>
<!-- End Google Tag Manager -->

<meta name="description" content="Argentinian security researchers have publicised what they call a hole in Apple&#039;s OS X sandbox. Apple says the sandbox is, strictly speaking, doing what it says on the tin. The rest of us can&#039;t actually see what it says on the tin - so who&#039;s right?" />
<meta name="keywords" content="apple, os x, sophoslabs, apple, exploit, obscurity, os x, poc, sandbox, vulnerability" />
<title>Apple&#8217;s OS X sandbox has a gaping hole &#8211; or not &#8211; Naked Security</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="I9dHFo-YhnK2MfAHn-20V4GnWrOttVUYyISGamyU41M" />
<meta name="msvalidate.01" content="7D8D1FA2892142B1543D2CBCD07FB88F" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Feed" href="https://nakedsecurity.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Comments Feed" href="https://nakedsecurity.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Apple&#8217;s OS X sandbox has a gaping hole &#8211; or not Comments Feed" href="https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/feed/" />
<link rel='stylesheet' id='all-css-0' href='https://nakedsecurity.sophos.com/_static/??-eJyVz80KwjAMwPEXss0qOPEgPkvWBVvtF03K2Nuvw928KDkF/j9IYCnKJxvaTAyWGWbPAlPI9q2CnyrWFVjWQDr6pHtwgi5sTkJJQBzF7jgXlznRwuo8mMsB/olVQCGWX81+KM5aXCUU5VqPq8ZYvnxsqoT29InhRVKwf3XTH3/sO3nEuxn7XI0Zxg13CmMK' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqUUWAK9KIh0='></script>
<link rel="https://api.w.org/" href="https://nakedsecurity.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://nakedsecurity.sophos.com/wp-json/wp/v2/posts/98973" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://nakedsecurity.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://nakedsecurity.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/" />
<link rel='shortlink' href='https://nakedsecurity.sophos.com/?p=98973' />
<link rel="alternate" type="application/json+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2011%2F11%2F14%2Fapples-os-x-sandbox-has-a-gaping-hole-or-not%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2011%2F11%2F14%2Fapples-os-x-sandbox-has-a-gaping-hole-or-not%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Apple&#8217;s OS X sandbox has a gaping hole &#8211; or not" />
<meta property="og:url" content="https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/" />
<meta property="og:description" content="Argentinian security researchers have publicised what they call a hole in Apple&#8217;s OS X sandbox. Apple says the sandbox is, strictly speaking, doing what it says on the tin. The rest of us canâ€¦" />
<meta property="article:published_time" content="2011-11-14T02:19:24+00:00" />
<meta property="article:modified_time" content="2012-09-18T15:29:33+00:00" />
<meta property="og:site_name" content="Naked Security" />
<meta property="og:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2011/11/sandbox-comic-250.png?w=250" />
<meta property="og:image:secure_url" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2011/11/sandbox-comic-250.png?w=250" />
<meta property="og:image:width" content="250" />
<meta property="og:image:height" content="250" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@NakedSecurity" />
<meta name="twitter:text:title" content="Apple&#8217;s OS X sandbox has a gaping hole &#8211; or not" />
<meta name="twitter:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2011/11/sandbox-comic-250.png?w=144" />
<meta name="twitter:card" content="summary" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=270" />
</head>
<body class="post-template-default single single-post postid-98973 single-format-standard" >
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VK6LTK"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div style="display: none">
<svg>
	<symbol id="sophos" viewBox="0 0 132 24">
		<path d="m111.82 22.176h11.64c3.267 0 4.65-0.2 5.74-0.896 1.715-1.063 2.804-3.26 2.804-5.62 0-1.928-0.658-3.89-1.647-4.888-1.288-1.33-3.035-1.828-6.271-1.828h-3.527c-1.586 0-2.754-0.067-3.412-0.365-0.794-0.367-1.256-1.165-1.256-2.161 0-1.165 0.56-2.03 1.486-2.264 0.692-0.163 1.498-0.163 3.574-0.198h10.419v-3.956h-11.473c-2.574 0-3.727 0.099-4.718 0.466-2.279 0.796-3.828 3.257-3.828 6.083 0 1.93 0.76 3.727 2.079 4.89 1.155 0.996 2.872 1.462 5.51 1.462h4.697c1.057 0 1.915 0.132 2.376 0.398 0.893 0.433 1.418 1.328 1.418 2.36 0 0.864-0.395 1.597-1.087 2.027-0.561 0.369-1.517 0.534-3.268 0.534h-11.256zm-111.35 0h11.64c3.267 0 4.652-0.2 5.741-0.896 1.714-1.063 2.803-3.26 2.803-5.62 0-1.928-0.66-3.89-1.65-4.888-1.285-1.33-3.034-1.828-6.27-1.828h-3.527c-1.584 0-2.751-0.067-3.41-0.365-0.792-0.367-1.253-1.165-1.253-2.161 0-1.165 0.56-2.03 1.484-2.264 0.693-0.163 1.496-0.163 3.574-0.198h10.42v-3.956h-11.477c-2.573 0-3.727 0.099-4.715 0.466-2.278 0.796-3.83 3.257-3.83 6.083 0 1.93 0.762 3.727 2.08 4.89 1.155 0.996 2.871 1.462 5.51 1.462h4.696c1.057 0 1.913 0.132 2.377 0.398 0.888 0.433 1.416 1.328 1.416 2.36 0 0.864-0.394 1.597-1.089 2.027-0.558 0.369-1.517 0.534-3.264 0.534h-11.256v3.956zm94.05-16.18c-0.68 1.076-1.003 2.803-1.003 5.122 0 5.088 1.747 7.405 5.63 7.405 3.822 0 5.568-2.317 5.568-7.34 0-5.092-1.715-7.373-5.568-7.373-2.102 0-3.754 0.784-4.627 2.186zm13.174-2.511c1.329 1.761 2.072 4.63 2.072 7.992 0 3.816-1.197 6.948-3.334 8.677-1.619 1.304-4.078 2.022-6.995 2.022-4.142 0-7.41-1.372-9.092-3.817-1.263-1.793-1.88-4.176-1.88-7.08 0-4.172 1.133-7.339 3.27-9.035 1.682-1.37 4.339-2.122 7.383-2.122 3.85 0 6.925 1.209 8.576 3.363zm-22.018-3.068h-4.596v8.908h-8.319v-8.908h-4.597v21.759h4.597v-8.97h8.318v8.97h4.596v-21.759zm-28.61 10.277c1.23 0 1.941-0.163 2.427-0.62 0.581-0.49 0.938-1.533 0.938-2.74 0-1.436-0.58-2.478-1.584-2.838-0.356-0.13-0.94-0.197-1.684-0.197h-6.344v6.395zm-6.247 11.481h-4.598v-21.758h10.78c3.786 0 5.114 0.39 6.538 1.991 1.264 1.37 1.942 3.163 1.942 5.088 0 2.284-0.904 4.404-2.394 5.676-1.262 1.077-2.43 1.402-4.888 1.402h-7.38zm-22.589-16.179c-0.682 1.076-1.004 2.803-1.004 5.122 0 5.088 1.748 7.405 5.634 7.405 3.818 0 5.568-2.317 5.568-7.34 0-5.092-1.716-7.373-5.568-7.373-2.106 0-3.757 0.784-4.63 2.186zm13.174-2.511c1.328 1.761 2.073 4.63 2.073 7.992 0 3.816-1.2 6.948-3.335 8.677-1.618 1.304-4.079 2.022-6.993 2.022-4.144 0-7.413-1.372-9.096-3.817-1.264-1.793-1.878-4.176-1.878-7.08 0-4.172 1.133-7.339 3.272-9.035 1.681-1.37 4.337-2.122 7.38-2.122 3.851 0 6.93 1.209 8.578 3.363z"></path>
	</symbol>
	<symbol id="twitter" viewBox="0 0 24 24">
 		<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path>
 	</symbol>
	<symbol id="facebook" viewBox="0 0 24 24">
 		<path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path>
 	</symbol>
	<symbol id="instagram" viewBox="0 0 24 24">
		<path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path>
	</symbol>
	<symbol id="linkedin" viewBox="0 0 24 24">
		<path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"></path>
	</symbol>
	<symbol id="rss" viewBox="0 0 24 24">
		<path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"></path>
	</symbol>
	<symbol id="reddit" viewBox="0 0 24 24">
		<path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"></path>
	</symbol>
</svg>
</div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header variation variation-3" role="banner">
		<div class="header-container">
			<div class="site-branding">
				<div class="site-title">
					<a title="Naked Security" href="https://nakedsecurity.sophos.com/" rel="home"><img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/naked-security-logo-white@2x.png"></a>
					by
					<a title="sophos.com" href="https://www.sophos.com"><svg viewBox="0 0 132 24" class="icon sophos"><use xlink:href="#sophos"></use></svg></a>
				</div>
			</div><!-- .site-branding -->
			<nav id="site-navigation" class="main-navigation" role="navigation">
				<div class="container">
					<ul id="menu-variation-two" class="exit-links menu"><li id="menu-item-436509" class="products menu-item menu-item-type-custom menu-item-object-custom menu-item-436509"><a href="#">Products</a></li>
<li id="menu-item-436515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436515"><a href="https://www.sophos.com/en-us/products/free-tools.aspx">Free Tools</a></li>
<li id="menu-item-436531" class="search-toggle menu-item menu-item-type-custom menu-item-object-custom menu-item-436531"><a href="#">Search</a></li>
<li id="menu-item-436532" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436532"><a href="https://home.sophos.com/en-us.aspx">Free Sophos Home</a></li>
</ul>				</div>
			</nav><!-- #site-navigation -->
			<div class="site-search-block">
	<form target="_top" role="search" class="search-form" method="get" action="https://nakedsecurity.sophos.com/">
        <fieldset>
            <div class="field">
				<input type="search" value="" name="s" class="search-field" placeholder="Search naked security...">
            </div>
            <div class="submit">
				<button type="submit" class="search-submit button">Go</button>
            </div>
        </fieldset>
    </form>
</div>
		</div><!-- .container -->
	</header>

	<div class="responsive-flyout-panel small-12 column active" style="opacity: 1; display: none;">
		<div class="modal-filler"></div>
	    <div class="productNavBox">
	        <div class="productNavContainer">
	            <div class="row prodRow">
	                <div class="prodListBox column large-9">
	                    <div class="row margin-0 highlightProduct">
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/next-gen-firewall.aspx"><img src="https://www.sophos.com/medialibrary/2F4785DE8C3F43ECBD699A18F332FEEB.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">XG Firewall</div>
	                                	<div class="menu-section-subtitle">Next-Gen Firewall</div>
									</div>
	                            </a>
	                        </div>
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/intercept-x.aspx"><img src="https://www.sophos.com/medialibrary/27111765D65A45D49A232925D2CE428B.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">Intercept X</div>
	                                	<div class="menu-section-subtitle">Next-Gen Endpoint</div>
									</div>
	                            </a>
	                        </div>
	                    </div>
	                    <div class="productList">
	                        <ul>
								<li>
									<a href="https://www.sophos.com/en-us/products/cloud-optix.aspx"><img src="https://www.sophos.com/medialibrary/SophosNext/Images/Products/Icons/sophos-cloud-optix-icon.svg">Sophos Cloud Optix</a>
								</li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-central.aspx"><img src="https://www.sophos.com/medialibrary/08EA66123F1B4DDE8FE5C9B578A7FAA7.ashx">Sophos Central</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/mobile-control.aspx"><img src="https://www.sophos.com/medialibrary/678FE994855047739F50D6C411184FA6.ashx">Sophos Mobile</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/server-security.aspx"><img src="https://www.sophos.com/medialibrary/01B80E7D7CD54EF8AC2E51C9C6EC0236.ashx">Intercept X for Server</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-wifi.aspx"><img src="https://www.sophos.com/medialibrary/BEBD9C41BB4E480498514B29B92A145A.ashx">Secure Wi-Fi</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/phish-threat.aspx"><img src="https://www.sophos.com/medialibrary/DC9D1A7BA3964B0C9DAF1F1E68806B5A.ashx">Phish Threat</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/safeguard-encryption.aspx"><img src="https://www.sophos.com/medialibrary/8F51F06B62814B108D3B2763FF018E37.ashx">SafeGuard Encryption</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-email.aspx"><img src="https://www.sophos.com/medialibrary/597ADA0AF01A4A12B2B27239D0F9992C.ashx">Secure Email</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/unified-threat-management.aspx"><img src="https://www.sophos.com/medialibrary/8CB72BF5E1AD41F7894CE5E42101B0F3.ashx">SG UTM</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-web-gateway.aspx"><img src="https://www.sophos.com/medialibrary/C586E372694547A1B207A61D87246BA7.ashx">Secure Web Gateway</a>
	                            </li>
	                        </ul>
	                    </div>
	                </div>
	                <div class="homeUserBox column large-3">
						<img src="https://www.sophos.com/medialibrary/3376DF5742A64AEE93FDB9DCA7291239.ashx">
						<div class="menu-section-title">For Home Users</div>
	                    <p>Sophos Home protects every Mac and PC in your home </p><a href="https://home.sophos.com/" target="_blank" class="greenSmallMenuBtn">Learn More</a>
					</div>
	            </div>
	            <div class="row blueRow">
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-tools.aspx"><img width="19" src="https://www.sophos.com/medialibrary/A1FF440D2BB84511B8C94D771D44E207.ashx">Free Security Tools</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-trials.aspx"><img width="20" src="https://www.sophos.com/medialibrary/FCD3410ED2C347808D9DB8AC12C62DBD.ashx">Free Trials</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/demos.aspx"><img width="18" src="https://www.sophos.com/medialibrary/50985180E5F54C94917A2A6508E24287.ashx">Product Demos</a>
	                </div>
	                <!-- <div class="column large-3 medium-6">
	                    <a href="javascript:fairfax.openLiveChatFromFlyoutLink();" class="flyout-live-chat-link"><img width="20" src="https://www.sophos.com/medialibrary/E24C5050837145F6A5C592E299BA2A0D.ashx">Live Sales Chat</a>
	                </div> -->
	            </div>
	        </div>
	    </div>
	</div>
	<script>

	jQuery(document).ready( function () {
		var productButton   = jQuery('nav .menu-item.products');
		var modalBackground = jQuery('.modal-filler');
		var flyoutMenu		= jQuery('.responsive-flyout-panel');
		var Sophos			= Sophos || {};

		Sophos.MenuTest = {};

		Sophos.MenuTest.open = function () {
				productButton.addClass('open');
				flyoutMenu.show();
				modalBackground.show();
		};

		Sophos.MenuTest.close = function () {
			productButton.removeClass('open');
			flyoutMenu.hide();
			modalBackground.hide();
		};

		Sophos.MenuTest.toggle = function () {
			if ( productButton.hasClass('open') ) {
				Sophos.MenuTest.close();
			} else {
				Sophos.MenuTest.open();
			}
		};

		productButton.click( Sophos.MenuTest.toggle );
		modalBackground.click( Sophos.MenuTest.close );
	});

	</script>

	
	<section class="about-panel">
	<div class="container">
	<div class="panel-content ">

		<div class="description"><span>Have you listened to our podcast? <a href="/podcast/">Listen now</a></span></div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	<div id="content" class="site-content">
		<div class="content-container">

</div> <!-- .container -->
</div> <!-- #content -->


	<section class="content-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

		<main id="main" class="site-main" role="main">

	
		
<article id="post-98973" class="post-98973 post type-post status-publish format-standard has-post-thumbnail hentry category-apple category-featured category-os-x category-sophoslabs tag-apple tag-exploit tag-obscurity tag-os-x tag-poc tag-sandbox tag-vulnerability-2">

	<header class="entry-header">
		<h1 class="entry-title">Apple&#8217;s OS X sandbox has a gaping hole &#8211; or not</h1>		<div class="entry-meta">
			<div>
				
	<span class="entry-published">
		<time class="entry-date published" datetime="2011-11-14T02:19:24+00:00">14 Nov 2011</time>
	</span>

					<a href="#comments" class="comment-box">
					<span class="count">10</span>
				</a>
					
	<span class="entry-categories">
	<a href="https://nakedsecurity.sophos.com/category/organisations/apple/">Apple</a>, <a href="https://nakedsecurity.sophos.com/category/technologies/operating-systems/os-x/">OS X</a>, <a href="https://nakedsecurity.sophos.com/category/sophoslabs/">SophosLabs</a>	</span>

			</div>
	</header> <!-- .entry-header -->

    <div id="newsletter-signup" class="container top"></div>

			<div class="entry-featured-image">
			<img width="250" height="250" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2011/11/sandbox-comic-250.png?w=250&amp;h=250&amp;crop=1" class="attachment-hero-thumbnail size-hero-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2011/11/sandbox-comic-250.png 250w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2011/11/sandbox-comic-250.png?resize=150,150 150w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2011/11/sandbox-comic-250.png?resize=225,225 225w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2011/11/sandbox-comic-250.png?resize=70,70 70w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2011/11/sandbox-comic-250.png?resize=32,32 32w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2011/11/sandbox-comic-250.png?resize=50,50 50w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2011/11/sandbox-comic-250.png?resize=64,64 64w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2011/11/sandbox-comic-250.png?resize=96,96 96w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2011/11/sandbox-comic-250.png?resize=128,128 128w" sizes="(max-width: 250px) 100vw, 250px" />					</div> <!-- .entry-featured-image -->
		
		<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2011/11/12/facebook-nears-settlement-with-ftc-on-privacy-opt-in/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> Facebook nears settlement with FTC on privacy opt-in</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2011/11/14/shopping-spree-morrisons-facebook-scam/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Shopping spree at Morrisons? Nope, another Facebook scam&#8230;</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	<div class="entry-content">
		<div class="entry-prefix">
			<div class="entry-author">
				
	
					<span class="by">by</span>
			<a href="https://nakedsecurity.sophos.com/author/paul-ducklin/" title="Posts by Paul Ducklin" class="author url fn" rel="author">Paul Ducklin</a>		
	
				</div>
			<div class="entry-sharing">
				
	<ul class="block social share">
		<li class="facebook"><a href="https://www.facebook.com/share.php?u=https%3A%2F%2Fnakedsecurity.sophos.com%2F2011%2F11%2F14%2Fapples-os-x-sandbox-has-a-gaping-hole-or-not%2F&title=Apple%E2%80%99s+OS+X+sandbox+has+a+gaping+hole+%E2%80%93+or+not" data-title="Appleâ€™s OS X sandbox has a gaping hole â€“ or not" title="Share on Facebook"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
		<li class="twitter"><a href="https://twitter.com/intent/tweet?text=Apple%E2%80%99s+OS+X+sandbox+has+a+gaping+hole+%E2%80%93+or+not+https%3A%2F%2Fnakedsecurity.sophos.com%2F%3Fp%3D98973" data-title="Apple&#8217;s OS X sandbox has a gaping hole &#8211; or not" title="Share on Twitter"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
		<li class="linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2011%2F11%2F14%2Fapples-os-x-sandbox-has-a-gaping-hole-or-not%2F&title=Apple%E2%80%99s+OS+X+sandbox+has+a+gaping+hole+%E2%80%93+or+not" data-title="Appleâ€™s OS X sandbox has a gaping hole â€“ or not" title="Share on LinkedIn"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
		<li class="reddit"><a href="https://reddit.com/submit/?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2011%2F11%2F14%2Fapples-os-x-sandbox-has-a-gaping-hole-or-not%2F&title=Apple%E2%80%99s+OS+X+sandbox+has+a+gaping+hole+%E2%80%93+or+not" title="Share on Reddit"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon reddit"><use xlink:href="#reddit"></use></svg></a></li>

			</ul>

				</div>
		</div>
		<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2011/11/sandbox-comic-180.png" alt="" title="Boy in a sandbox in the playground" width="178" height="178" align="right" hspace="10" vspace="10"></img>Argentinian security company Core Labs (which is the core research group, if you will pardon the pun, of US-based Core Security Technologies) has just published a <a href="http://blog.coresecurity.com/2011/11/11/a-tale-of-two-advisories/" rel="nofollow">critique</a> of Apple&#8217;s attitude to security.</p>
<p>In an article entitled <a href="http://blog.coresecurity.com/2011/11/11/a-tale-of-two-advisories/" rel="nofollow"><em>A Tale of Two Advisories</em></a>, the Core Labs researchers discuss vulnerabilities disclosed to Adobe and Apple, and the response of the two companies.</p>
<p>Adobe, apparently, reacted well. But Apple, says Core, was found wanting.</p>
<p>The claimed vulnerability is in Apple&#8217;s much-vaunted sandbox, a kernel-enforced system of application restrictions which software can use to harden itself against attackers.</p>
<p>For example, an application which doesn&#8217;t have any networking code can voluntarily subject itself to the <strong>no-network</strong> (or <strong>kSBXProfileNoNetwork</strong>) profile. This ought to allow the application to &#8220;promise&#8221; that, even in the presence of remote code execution bugs, it can&#8217;t be tricked by a hacker into providing network access.</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2011/11/sandbox-500.png" alt="" title="Salient points from &#039;man sandbox_init&#039;" width="493" height="127"></img></p>
<p>According to Apple, anything sold or given away through the App Store <a href="http://developer.apple.com/news/index.php?id=11022011a" rel="nofollow">&#8220;must implement sandboxing&#8221;</a> by 2012-03-01.</p>
<p>I&#8217;d love to summarise what &#8220;must implement sandboxing&#8221; means, but the relevant <a href="https://developer.apple.com/devcenter/mac/app-sandbox/" rel="nofollow">App Sandbox page</a> isn&#8217;t open to the public, or even to entry-level Apple Developers. Apple ought to rethink this restriction. </p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2011/11/blocked-dev-500.png" alt="" title="blocked-dev-500" width="493" height="124"></img></p>
<p>Since entry-level developers can download and use Apple&#8217;s development tools, it would be a good idea to have them thinking about sandboxing for OS X software of any sort. The publicly-available documentation seems to consist only of how to use the five predefined profiles shown above, which are listed when you run <strong>man sandbox_init</strong>.</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2011/11/escape-180.png" alt="" title="PoC script from Core Labs, in part" width="178" height="106" align="right" hspace="10" vspace="10"></img>The criticism from Core Labs is that, whilst sandbox restrictions apply recursively to processes directly spawned by a sandboxed application, they don&#8217;t apply to processes spawned indirectly. </p>
<p>So, for example, you can use Apple Script to tell OS X to start some other arbitrary program (or a second copy of your own) which won&#8217;t inherit your sandbox settings.</p>
<p>According to Core Labs, Apple&#8217;s response <a href="http://www.coresecurity.com/content/apple-osx-sandbox-bypass" rel="nofollow">was problematic</a> because the company merely offered to document more clearly that sandboxing restrictions can&#8217;t be assumed to apply to any process other than the sandboxed one.</p>
<p>Core Labs wants Apple to make its <strong>no-network</strong> sandbox profile mean exactly that, for <em>any</em> OS process initiated by a <strong>no-network</strong> program.</p>
<p>What happens next?</p>
<p>Will Apple harden up the sandbox as a result? Let&#8217;s hope so. </p>
<p>And let&#8217;s hope Apple will be much more open about its sandbox, and how get the best out of it.</p>
<p><br />
&#8211;<br />
<span>PS. Readers who are interested in the internals of Apple&#8217;s sandbox should read Dionysus Blazakis&#8217;s <a href="http://dl.packetstormsecurity.net/papers/general/apple-sandbox.pdf">detailed analysis</a> of it. Sandbox rules are written in a Lisp dialect (actually, <a href="http://tinyscheme.sourceforge.net/home.html" rel="nofollow">TinyScheme</a> 1.38), which is documented by Apple only as being an &#8220;Apple System Private Interface and subject to change at any time&#8221;.</span></p>
<p><span>Looking at some of the sample scripts in <strong>/usr/share/sandbox</strong>, and taking advice from Blazakis&#8217;s paper, a simple modification of the <strong>no-network</strong> policy gives a simple, if rather specific, workaround to the Core Labs &#8220;exploit.&#8221; Core Labs says to run its proof-of-concept like this:</span></p>
<pre><span>$ sandbox-exec -n no-network python corelabsPoC.py 127.0.0.1</span></pre>
<p><span>But a slightly stricter sandbox policy will prevent the existing PoC from doing its Apple Script trickery:</span></p>
<pre><span>$ sandbox-exec -p '
&gt;(version 1) (allow default) (deny network*) 
&gt;(deny process-exec (literal "/usr/bin/osascript"))
&gt;' /usr/bin/python corelabsPoC.py 127.0.0.1</span></pre>
<p><span>Once you&#8217;ve played with the sandbox a little, you&#8217;re sure to want to know more. C&#8217;mon, Apple! The Bad Guys will find the holes even if you keep the secrecy up. Let the Good Guys play in the sandbox, too!</span></p>
			</div> <!-- .entry-content -->
	<ul class="block social follow">
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon twitter"><use xlink:href="#twitter"></use></svg>
			<p>Follow <strong><a href="https://twitter.com/nakedsecurity">@NakedSecurity on Twitter</a></strong> for the latest computer security news.</p>
		</li>
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon instagram"><use xlink:href="#instagram"></use></svg>
			<p>Follow <strong><a href="https://www.instagram.com/nakedsecurity/">@NakedSecurity on Instagram</a></strong> for exclusive pics, gifs, vids and LOLs!</p>
		</li>
	</ul>
</article><!-- #post-## -->

		<div class="free-tools-block">
			<h2 class="block-title">Free tools</h2>

<div class="ns-free-tools">
	<div class="ns-free-tools__item ns-free-tools__item--sophos-home">
		<a class="ns-free-tools__link" href="https://home.sophos.com/en-us.aspx?cmp=701j0000001eLpnAAE">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/sophos-home@2x.png" alt="Sophos Home" class="ns-free-tools__image" width="166" height="100">
			<h4 class="ns-free-tools__title">
				Sophos Home			</h4>
			<div class="ns-free-tools__sub-title">
				Protect personal PCs and Macs			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--hitman-pro">
		<a class="ns-free-tools__link" href="https://www.hitmanpro.com/en-us/hmp.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/hitman-pro@2x.png" alt="Hitman Pro" class="ns-free-tools__image" width="154" height="100">
			<h4 class="ns-free-tools__title">
				Hitman Pro			</h4>
			<div class="ns-free-tools__sub-title">
				Find and remove malware			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--intercept-x">
		<a class="ns-free-tools__link" href="https://www.sophos.com/en-us/products/free-tools/sophos-mobile-security-free-edition.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/mobile-security-android@2x.png" alt="Sophos Intercept X for Mobile" class="ns-free-tools__image" width="96" height="110">
			<h4 class="ns-free-tools__title">
				Intercept X for Mobile			</h4>
			<div class="ns-free-tools__sub-title">
				Protect Android devices			</div>
		</a>
	</div>
</div>
		</div>

			<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2011/11/12/facebook-nears-settlement-with-ftc-on-privacy-opt-in/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> Facebook nears settlement with FTC on privacy opt-in</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2011/11/14/shopping-spree-morrisons-facebook-scam/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Shopping spree at Morrisons? Nope, another Facebook scam&#8230;</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	
	</main><!-- #main -->

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<section class="comments-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

			
<div id="comments" class="comments-area">

			<h2 class="comments-title">
			10 comments on &ldquo;<span>Apple&#8217;s OS X sandbox has a gaping hole &#8211; or not</span>&rdquo;		</h2>

		<ol class="comment-list">
					<li id="comment-13977" class="comment even thread-even depth-1">
			<article id="div-comment-13977" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/61fb16f3ca3c8ec0da126a12db3889ab?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/61fb16f3ca3c8ec0da126a12db3889ab?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">snare</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/#comment-13977"><time datetime="2011-11-14T05:25:52+00:00">November 14, 2011 at 5:25 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Duck, </p>
<p>I think that Core Labs&#039; assessment of this vulnerability is incorrect. The &quot;no network&quot; policy simply enforces that a process and its children will not be allowed to create socket connections. It does not restrict access to AppleEvents, filesystems or anything else. The problem is not that the &quot;no network&quot; policy is doing something wrong, the problem is that &quot;no network&quot; is not enough. </p>
<p>All they&#039;re doing in this PoC is telling some other process, using a system IPC method, to do something on their behalf. Any application can send AppleEvents directly using the APIs without resorting to calling osascript(1). Shellcode could quite feasibly send AppleEvents directly to launchd or some other process even if the sandbox policy restricted its ability to write to the filesystem or execute osascript.</p>
<p>[comment edited for length]</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_13977"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_13977={"id":7238218,"unique_id":"wp-comment-13977","title":"Hi%20Duck%2C%20%20I%20think%20that%20Core%20Labs%26%23039%3B%20assessment%20of%20this%20vulnerability%20is%20incorrect.%20The%20%26quot%3Bno%20network%26quot%3B%20policy%20simply%20enforces%20that%20a%20process%20and%20its%20children%20will%20not%20be%20allowed%20to%20crea%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2011\/11\/14\/apples-os-x-sandbox-has-a-gaping-hole-or-not\/#comment-13977","item_id":"_comm_13977"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/?replytocom=13977#respond' data-commentid="13977" data-postid="98973" data-belowelement="div-comment-13977" data-respondelement="respond" data-replyto="Reply to snare" aria-label='Reply to snare'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-13979" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-13979" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">@iamleeg</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/#comment-13979"><time datetime="2011-11-14T10:14:25+00:00">November 14, 2011 at 10:14 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>The sandbox profiles you describe in this post, based on the &quot;seatbelt&quot; technology Apple introduced in Snow Leopard (10.6), aren&#039;t the same as the sandbox capabilities used for the app store in Lion (10.7), and it&#039;s the latter that app store developers &quot;must implement&quot; by March. </p>
<p>The app store sandbox technology is described at a high level on this (public) page in Apple&#039;s documentation: <a href="http://developer.apple.com/library/mac/#documentation/General/Conceptual/MOSXAppProgrammingGuide/AppRuntime/AppRuntime.html" rel="nofollow">http://developer.apple.com/library/mac/#documenta&#8230;</a><br />
It&#039;s based on a collection of entitlements that are baked into an app when it&#039;s signed by the developer. That means that the rules for what an app is allowed to do are baked into the app&#039;s identity, not into its process tree. </p>
<p>Either this post or the report it&#039;s based on (or maybe both) is confused: an app store app that opts into the &quot;no network&quot; sandbox restriction could not access the network no matter how it&#039;s invoked by other software on the system. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_13979"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_13979={"id":7238218,"unique_id":"wp-comment-13979","title":"The%20sandbox%20profiles%20you%20describe%20in%20this%20post%2C%20based%20on%20the%20%26quot%3Bseatbelt%26quot%3B%20technology%20Apple%20introduced%20in%20Snow%20Leopard%20%2810.6%29%2C%20aren%26%23039%3Bt%20the%20same%20as%20the%20sandbox%20capabilities%20used%20for%20the%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2011\/11\/14\/apples-os-x-sandbox-has-a-gaping-hole-or-not\/#comment-13979","item_id":"_comm_13979"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/?replytocom=13979#respond' data-commentid="13979" data-postid="98973" data-belowelement="div-comment-13979" data-respondelement="respond" data-replyto="Reply to @iamleeg" aria-label='Reply to @iamleeg'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-13981" class="comment even depth-2 parent">
			<article id="div-comment-13981" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/441e7fae6894199e8fc3025efb70919d?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/441e7fae6894199e8fc3025efb70919d?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/#comment-13981"><time datetime="2011-11-14T10:56:24+00:00">November 14, 2011 at 10:56 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Read the previous comment from Snare&#8230;   </p>
<p>The problem here is not that an app that opts into &quot;no-network&quot; can access the network, but but that app an which opts in _can be tricked into starting another app which isn&#039;t covered by the same sandbox restrictions_, albeit indirectly.   </p>
<p>The &quot;no-network&quot; restriction, baked into the app with a digital signature as it might be, isn&#039;t enough on its own to prevent that app from triggering network access. It can&#039;t do it by spawning a sub-process of its own, but it can do so by using some sort of IPC. As Snare points out, that means that shellcode inside a &quot;no-network&quot; app may nevertheless be able to conjure up network access.    </p>
<p>Core Labs says, &quot;That&#039;s a vulnerability, because &#039;no-network&#039; should mean just that, no network. For any code triggered by the sandboxed app. Full stop.&quot;   </p>
<p>Snare (see above &#8211; he&#039;s a long-term low-level Apple expert/fanbuoy out of Australia) disagrees, saying, &quot;No-network only means what it says for the process it applies to; if you allow IPC then all bets are off and that&#039;s not a bug, no matter how much you might not like that it works that way. If you don&#039;t want IPC and its concomittant risks, forbid it too.&quot;   </p>
<p>Both sides are probably right, and I&#039;m sitting on the fence ðŸ™‚   </p>
<p>FWIW I&#039;m pretty sure you&#039;ll find that the sandbox in 10.6.8 is more-or-less identical to the one in 10.7.x. (It&#039;s still got the TinyScheme 1.38 core, at any rate.)    </p>
<p>I achieved identical results on Snow Leopard and Lion with the PoC code and the mitigations discussed above. I&#039;m not sure what makes you think the internals of the sandbox userland and kernel-land components are different between 10.6 and 10.7. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_13981"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_13981={"id":7238218,"unique_id":"wp-comment-13981","title":"Read%20the%20previous%20comment%20from%20Snare...%20%20%20%20%20%20The%20problem%20here%20is%20not%20that%20an%20app%20that%20opts%20into%20%26quot%3Bno-network%26quot%3B%20can%20access%20the%20network%2C%20but%20but%20that%20app%20an%20which%20opts%20in%20_can%20be%20tricked%20in%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2011\/11\/14\/apples-os-x-sandbox-has-a-gaping-hole-or-not\/#comment-13981","item_id":"_comm_13981"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/?replytocom=13981#respond' data-commentid="13981" data-postid="98973" data-belowelement="div-comment-13981" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-13984" class="comment odd alt depth-3">
			<article id="div-comment-13984" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/61fb16f3ca3c8ec0da126a12db3889ab?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/61fb16f3ca3c8ec0da126a12db3889ab?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">snare</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/#comment-13984"><time datetime="2011-11-14T11:46:00+00:00">November 14, 2011 at 11:46 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I&#039;m not 100% sure on how the sandboxing has changed in Lion, but I can tell you the TrustedBSD (&quot;Seatbelt&quot;) framework in Sandbox.kext that was in 10.6 is still there. I had assumed that the App Store sandboxing &quot;Entitlements&quot; were simply a wrapper around the existing Seatbelt implementation (it certainly has the capabilities to do exactly what the check boxes in Xcode specify). I know the Lion implementation does some other magic with regards to &quot;containers&quot; (keeping all the files for an app within a specific directory, similar to the way it works on iOS), but I had assumed this was basically chroot() + Seatbelt. I could be wrong and it warrants some further investigation. </p>
<p>To reiterate the main point from my long-winded post that Duck (probably thankfully for the rest of you) cut short &#8211; Apple needs to give developers an official fine-grained interface to Seatbelt so that they/we can use it to its full potential without hacking Scheme config files that might not work in the next point release. Semantics of &quot;vulnerability&quot; aside, this is a problem that needs to be addressed if it is to be used effectively. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_13984"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_13984={"id":7238218,"unique_id":"wp-comment-13984","title":"I%26%23039%3Bm%20not%20100%25%20sure%20on%20how%20the%20sandboxing%20has%20changed%20in%20Lion%2C%20but%20I%20can%20tell%20you%20the%20TrustedBSD%20%28%26quot%3BSeatbelt%26quot%3B%29%20framework%20in%20Sandbox.kext%20that%20was%20in%2010.6%20is%20still%20there.%20I%20had%20assumed%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2011\/11\/14\/apples-os-x-sandbox-has-a-gaping-hole-or-not\/#comment-13984","item_id":"_comm_13984"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/?replytocom=13984#respond' data-commentid="13984" data-postid="98973" data-belowelement="div-comment-13984" data-respondelement="respond" data-replyto="Reply to snare" aria-label='Reply to snare'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-13986" class="comment even depth-3 parent">
			<article id="div-comment-13986" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/61fb16f3ca3c8ec0da126a12db3889ab?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/61fb16f3ca3c8ec0da126a12db3889ab?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">snare</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/#comment-13986"><time datetime="2011-11-14T12:33:02+00:00">November 14, 2011 at 12:33 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Please ignore my last comment Duck ðŸ™‚ </p>
<p>After a quick look at what actually happens when you use the new sandboxing &quot;entitlements&quot; in a project, I understand it a bit better. @iamleeg is partially correct &#8211; the same PoC would not work using the Lion sandboxing. However, as expected, the sandboxing in Lion is not some new magic, it&#039;s just Seatbelt configured by the options in the Xcode &quot;entitlements&quot; configuration. </p>
<p>One key difference, though, is that when sandboxing is enabled for an app it applies a white-listing approach with a default deny rule, rather than a black-listing approach with a default allow (and deny networking etc rules) like the &quot;no network&quot; policy. Sending AppleEvents is implicitly denied by the default deny. From the documentation: &quot;With App Sandbox, you can receive Apple events and respond to Apple events, but you cannot send Apple events to arbitrary apps.&quot; The PoC I posted before with installing a crontab doesn&#039;t work either, due to the fact that the Seatbelt policy denies access to files outside the &quot;container&quot; (I guess). </p>
<p>So yes, the kernel sandbox implementation is still the same, just Xcode gives developers a better interface to define the rights that an application requires. I think it&#039;s a step in the right direction but it is still very restrictive in what rights can be requested as it is aimed specifically at apps to be deployed in the Mac App Store. Developers of non-App Store apps still need a supported mechanism for specifying sandboxing options. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_13986"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_13986={"id":7238218,"unique_id":"wp-comment-13986","title":"Please%20ignore%20my%20last%20comment%20Duck%20%3A%29%20%20After%20a%20quick%20look%20at%20what%20actually%20happens%20when%20you%20use%20the%20new%20sandboxing%20%26quot%3Bentitlements%26quot%3B%20in%20a%20project%2C%20I%20understand%20it%20a%20bit%20better.%20%40iamleeg%20is%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2011\/11\/14\/apples-os-x-sandbox-has-a-gaping-hole-or-not\/#comment-13986","item_id":"_comm_13986"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/?replytocom=13986#respond' data-commentid="13986" data-postid="98973" data-belowelement="div-comment-13986" data-respondelement="respond" data-replyto="Reply to snare" aria-label='Reply to snare'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-13993" class="comment odd alt depth-4 parent">
			<article id="div-comment-13993" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">@iamleeg</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/#comment-13993"><time datetime="2011-11-14T14:54:40+00:00">November 14, 2011 at 2:54 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>@snare, apps that are distributed outside the app store can opt in to sandboxing too, they just need to be code signed. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_13993"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_13993={"id":7238218,"unique_id":"wp-comment-13993","title":"%40snare%2C%20apps%20that%20are%20distributed%20outside%20the%20app%20store%20can%20opt%20in%20to%20sandboxing%20too%2C%20they%20just%20need%20to%20be%20code%20signed.%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2011\/11\/14\/apples-os-x-sandbox-has-a-gaping-hole-or-not\/#comment-13993","item_id":"_comm_13993"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/?replytocom=13993#respond' data-commentid="13993" data-postid="98973" data-belowelement="div-comment-13993" data-respondelement="respond" data-replyto="Reply to @iamleeg" aria-label='Reply to @iamleeg'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-14029" class="comment even depth-5">
			<article id="div-comment-14029" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/61fb16f3ca3c8ec0da126a12db3889ab?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/61fb16f3ca3c8ec0da126a12db3889ab?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">snare</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/#comment-14029"><time datetime="2011-11-14T23:57:54+00:00">November 14, 2011 at 11:57 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>When I say non-App Store apps I mean apps that cannot be distributed via the app store because the coarse-grained sandboxing defined in Xcode is too restrictive. The bottom line is still that Apple should give developers the same fine-grained access to sandboxing that the core OS components have. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_14029"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_14029={"id":7238218,"unique_id":"wp-comment-14029","title":"When%20I%20say%20non-App%20Store%20apps%20I%20mean%20apps%20that%20cannot%20be%20distributed%20via%20the%20app%20store%20because%20the%20coarse-grained%20sandboxing%20defined%20in%20Xcode%20is%20too%20restrictive.%20The%20bottom%20line%20is%20still%20that%20App%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2011\/11\/14\/apples-os-x-sandbox-has-a-gaping-hole-or-not\/#comment-14029","item_id":"_comm_14029"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/?replytocom=14029#respond' data-commentid="14029" data-postid="98973" data-belowelement="div-comment-14029" data-respondelement="respond" data-replyto="Reply to snare" aria-label='Reply to snare'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-13992" class="comment odd alt depth-3">
			<article id="div-comment-13992" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">@iamleeg</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/#comment-13992"><time datetime="2011-11-14T14:53:34+00:00">November 14, 2011 at 2:53 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>It&#039;s not that the implementation has changed &#8211; indeed it&#039;s not relevant whether the implementation is the same or not. It&#039;s that the effects have changed that are important. You say &quot;an which opts in _can be tricked into starting another app which isn&#039;t covered by the same sandbox restrictions_&hellip; The &quot;no-network&quot; restriction, baked into the app with a digital signature as it might be, isn&#039;t enough on its own to prevent that app from triggering network access.&quot; </p>
<p>However, sandboxed applications _cannot_ send Apple Events unless they have requested that as an exception  <a href="http://(https://twitter.com/#!/radian/status/97376026992197633)" rel="nofollow">(https://twitter.com/#!/radian/status/97376026992197633)</a>. Apps are &quot;vulnerable&quot; to IPC only if they opt in to it; which is how the sandbox is supposed to work. </p>
<p>Allowing a process that doesn&#039;t have network access to call out to a process that does is a feature, not a bug. For example, consider the design of Safari 5, or Google Chrome. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_13992"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_13992={"id":7238218,"unique_id":"wp-comment-13992","title":"It%26%23039%3Bs%20not%20that%20the%20implementation%20has%20changed%20-%20indeed%20it%26%23039%3Bs%20not%20relevant%20whether%20the%20implementation%20is%20the%20same%20or%20not.%20It%26%23039%3Bs%20that%20the%20effects%20have%20changed%20that%20are%20important.%20You%20sa%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2011\/11\/14\/apples-os-x-sandbox-has-a-gaping-hole-or-not\/#comment-13992","item_id":"_comm_13992"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/?replytocom=13992#respond' data-commentid="13992" data-postid="98973" data-belowelement="div-comment-13992" data-respondelement="respond" data-replyto="Reply to @iamleeg" aria-label='Reply to @iamleeg'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-14068" class="comment even thread-even depth-1 parent">
			<article id="div-comment-14068" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/07fb66a19df978bd3249d7ef5e2439d2?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/07fb66a19df978bd3249d7ef5e2439d2?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Balthazar</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/#comment-14068"><time datetime="2011-11-15T11:15:57+00:00">November 15, 2011 at 11:15 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Suppose you have a sandboxed process that is restricted of network access, but has file access. The process tampers with your browser&#039;s settings file, so that it changes its start page, to make it open a malicious site or do something else network related. Your browser has network access, and next time you start your browser, it opens the page. Wouldn&#039;t this be possible? There may be other restrictions that prevent a hacker from doing this, but my point is that, unfortunately, sandboxing itself doesn&#039;t prevent a process from tricking anohter process into doing what the first process is not allowed to do. Unless the other process is directly spawned by the first one. Therefore, I agree that Apple&#039;s sandboxing technology does precisely what it&#039;s supposed to do. But as you have demonstrated, it can also be configured to be even more secure than the standard settings. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_14068"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_14068={"id":7238218,"unique_id":"wp-comment-14068","title":"Suppose%20you%20have%20a%20sandboxed%20process%20that%20is%20restricted%20of%20network%20access%2C%20but%20has%20file%20access.%20The%20process%20tampers%20with%20your%20browser%26%23039%3Bs%20settings%20file%2C%20so%20that%20it%20changes%20its%20start%20page%2C%20to%20m%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2011\/11\/14\/apples-os-x-sandbox-has-a-gaping-hole-or-not\/#comment-14068","item_id":"_comm_14068"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/?replytocom=14068#respond' data-commentid="14068" data-postid="98973" data-belowelement="div-comment-14068" data-respondelement="respond" data-replyto="Reply to Balthazar" aria-label='Reply to Balthazar'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-14255" class="comment odd alt depth-2">
			<article id="div-comment-14255" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/61fb16f3ca3c8ec0da126a12db3889ab?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/61fb16f3ca3c8ec0da126a12db3889ab?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">snare</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/#comment-14255"><time datetime="2011-11-17T11:55:53+00:00">November 17, 2011 at 11:55 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Absolutely. Another example is if the process has rights to execute subprocesses you could call `crontab` and pass it configuration to run some arbitrary shell command every minute or whatever. </p>
<p>However, if the app is sandboxed using the new container-based sandbox policies applied by the &quot;Entitlements&quot; settings in Xcode 4.2, the app would be unable to write outside this container root or execute processes existing outside of it, so none of these attacks would work, as @iamleeg pointed out. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_14255"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_14255={"id":7238218,"unique_id":"wp-comment-14255","title":"Absolutely.%20Another%20example%20is%20if%20the%20process%20has%20rights%20to%20execute%20subprocesses%20you%20could%20call%20%60crontab%60%20and%20pass%20it%20configuration%20to%20run%20some%20arbitrary%20shell%20command%20every%20minute%20or%20whatever.%20%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2011\/11\/14\/apples-os-x-sandbox-has-a-gaping-hole-or-not\/#comment-14255","item_id":"_comm_14255"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/?replytocom=14255#respond' data-commentid="14255" data-postid="98973" data-belowelement="div-comment-14255" data-respondelement="respond" data-replyto="Reply to snare" aria-label='Reply to snare'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">What do you think? <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2011/11/14/apples-os-x-sandbox-has-a-gaping-hole-or-not/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://nakedsecurity.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='98973' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="856317b27e" /></p><input type="hidden" id="ak_js" name="ak_js" value="201"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->
		<div class="comments-widget-area">
					</div>
	
	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	

	<section class="recommended-panel">
	<div class="container">
	<div class="panel-content ">

		<h3 class="block-title">Recommended reads</h3>
	<div class="blocks">
		<article id="post-560915" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/03/09/serious-security-webshells-explained-in-the-aftermath-of-hafnium-attacks/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/shell-1200.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Mar</span><span class="day">09</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">4</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/03/09/serious-security-webshells-explained-in-the-aftermath-of-hafnium-attacks/" rel="bookmark">Serious Security: Webshells explained in the aftermath of HAFNIUM attacks</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-544489" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/01/11/naked-security-live-https-do-we-really-need-it/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/10/nslive-1200-3.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Jan</span><span class="day">11</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">1</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/01/11/naked-security-live-https-do-we-really-need-it/" rel="bookmark">Naked Security Live &#8211; HTTPS: do we REALLY need it?</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-544375" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2020/12/31/s3-ep13-a-chat-with-hacker-keren-elazari-podcast/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/10/nean-with-mic-wt-1200.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Dec</span><span class="day">31</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">1</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2020/12/31/s3-ep13-a-chat-with-hacker-keren-elazari-podcast/" rel="bookmark">S3 Ep13: A chat with hacker Keren Elazari [Podcast]</a></h3>	</div>
</article> <!-- .card-article -->
	</div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="footer-container">
			<a href="#" class="js-collapse-footer"><svg style="height: 20px" viewBox="0 0 132 24" class="block icon sophos"><use xlink:href="#sophos"></use></svg></a>
			<div id="collapseFooter" class="blocks">
				<div class="sophos block">
					<ul id="menu-footer-primary" class="primary menu"><li id="menu-item-306737" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306737"><a href="https://nakedsecurity.sophos.com/about/">About Naked Security</a></li>
<li id="menu-item-306754" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306754"><a href="https://www.sophos.com/en-us/company.aspx">About Sophos</a></li>
<li id="menu-item-306747" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306747"><a href="https://nakedsecurity.sophos.com/send-us-a-tip/">Send us a tip</a></li>
<li id="menu-item-323171" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323171"><a href="/cookies-and-scripts/">Cookies</a></li>
<li id="menu-item-323170" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323170"><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
<li id="menu-item-323169" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323169"><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
</ul>				</div>
										<div class="news block">
							<ul id="menu-products-column-one" class="small menu"><li id="menu-item-306998" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306998"><a href="https://www.sophos.com/en-us/products/intercept-x.aspx">Intercept X</a></li>
<li id="menu-item-440801" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440801"><a href="https://www.sophos.com/en-us/products/server-security.aspx">Intercept X for Server</a></li>
<li id="menu-item-440802" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440802"><a href="https://www.sophos.com/en-us/products/mobile-control.aspx">Intercept X for Mobile</a></li>
</ul>						</div>
											<div class="products block">
							<ul id="menu-products-column-two" class="small menu"><li id="menu-item-440803" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440803"><a href="https://www.sophos.com/en-us/products/next-gen-firewall.aspx">XG Firewall</a></li>
<li id="menu-item-440805" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440805"><a href="https://www.sophos.com/en-us/products/sophos-email.aspx">Sophos Email</a></li>
<li id="menu-item-440804" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440804"><a href="https://www.sophos.com/en-us/products/secure-wifi.aspx">Sophos Wireless</a></li>
</ul>						</div>
											<div class="threats block">
							<ul id="menu-server-protection" class="small menu"><li id="menu-item-440806" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440806"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx">Managed Threat Response</a></li>
<li id="menu-item-448404" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-448404"><a href="https://www.sophos.com/en-us/products/cloud-optix.aspx">Cloud Optix</a></li>
<li id="menu-item-440807" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440807"><a href="https://www.sophos.com/en-us/products/phish-threat.aspx">Phish Threat</a></li>
</ul>						</div>
								</div>
			<ul class="block social footer">
				<li class="twitter"><a rel="nofollow" href="https://twitter.com/NakedSecurity" title="Follow our team of security experts on Twitter"><svg style="height: 14px" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
				<li class="facebook"><a rel="nofollow" href="https://www.facebook.com/SophosSecurity" title="Join over 250,000 people in our Facebook community"><svg style="height: 14px" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
				<li class="instagram"><a rel="nofollow" href="https://www.instagram.com/nakedsecurity/" title="Follow Naked Security on Instagram"><svg style="height: 14px" viewBox="0 0 100 100" class="icon instagram"><use xlink:href="#instagram"></use></svg></a></li>
				<li class="linkedin"><a rel="nofollow" href="https://www.linkedin.com/company/5053/" title="Join the naked security discussion group on LinkedIn"><svg style="height: 14px" viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
				<li class="rss"><a rel="nofollow" href="/feed" title="Subscribe to our RSS feed"><svg style="height: 14px" viewBox="0 0 100 100" class="icon rss"><use xlink:href="#rss"></use></svg></a></li>
			</ul>

							<div class="vip-powered-wpcom">
					<span class="copyright">Â© 1997 - 2021 Sophos Ltd.</span>
					All rights reserved.
					Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=nakedsecurity.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>				</div>
					</div>
		<script type="text/javascript">
			window.cookieconsent_options = {
				"message":"This site uses cookies. By continuing to browse the site you are agreeing to our use of cookies.",
				"dismiss":"Got it!",
				"learnMore":"Learn More",
				"link":"/cookies-and-scripts",
				"theme":"https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/css/sophos.css"};
		</script>
	</footer><!-- #colophon -->
</div><!-- #page -->
<div id="survey-wrapper" class="mfp-hide"><div class="pd-embed" id="pd_1499706777" data-settings=""></div></div>
<script id='child-js-plugins-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"0","nextLink":""};
</script>
<script id='child-js-core-js-extra'>
var Sophos = {"ajaxurl":"https:\/\/nakedsecurity.sophos.com\/wp-admin\/admin-ajax.php","nonce":"64f6810f0c"};
</script>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJyNjtEKwjAMRX/ILqvgfBI/RbSLrrVJS9My9veGsYEPPkiecnMONzBn4xJX5Ap1QkIBSXlKwjiLOfb2BEEgx/byLF2QA/wluFRwpz272Ebl1pxITVMwx6Ujz78gXZEeOH7f90pqZnsG7m8vhBVu6sIzFVL2Shc76Jyt7YfwARFiT2s='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161173',post:'98973',tz:'0',srv:'nakedsecurity.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161173', '98973' ]);
</script>
</body>
</html>
