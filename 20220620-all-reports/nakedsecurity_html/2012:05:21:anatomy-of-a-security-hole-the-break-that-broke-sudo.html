<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="RHQeasQqjasbRt5asY6atZYbs5tr10gFBevDt2HRhW0" />
<link rel="pingback" href="https://nakedsecurity.sophos.com/xmlrpc.php">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5VK6LTK');</script>
<!-- End Google Tag Manager -->

<meta name="description" content="A recently-patched bug in the widely-used sudo command makes for interesting reading. The patch reminds us of some important points in security-related programming." />
<meta name="keywords" content="vulnerability, break, bugwatch, c, escalation, exploit, it, privilege, sudo, switch, vulnerability" />
<title>Anatomy of a security hole &#8211; the break that broke sudo &#8211; Naked Security</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="I9dHFo-YhnK2MfAHn-20V4GnWrOttVUYyISGamyU41M" />
<meta name="msvalidate.01" content="7D8D1FA2892142B1543D2CBCD07FB88F" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Feed" href="https://nakedsecurity.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Comments Feed" href="https://nakedsecurity.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Anatomy of a security hole &#8211; the break that broke sudo Comments Feed" href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/feed/" />
<link rel='stylesheet' id='all-css-0' href='https://nakedsecurity.sophos.com/_static/??-eJyVz00KwjAQhuELmUwjptCFeJY0HUw0f2QmlN6+KXbnRpcD7wPfwFqETza0BQksESyeGOaQ7VsEP1dTNyDeAsrok+zBBbqwOTEmBnYYu6NcXKaEK4nroPQJ/olFMIzEv5pjqFkku4qGhWs9rtLE8uVjEyW0p08EL+Ri+leT/PjzPsgj3tWo9G0ctJp2dx1jEg==' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpmWEWAK8/Ihc='></script>
<link rel="https://api.w.org/" href="https://nakedsecurity.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://nakedsecurity.sophos.com/wp-json/wp/v2/posts/167271" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://nakedsecurity.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://nakedsecurity.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/" />
<link rel='shortlink' href='https://nakedsecurity.sophos.com/?p=167271' />
<link rel="alternate" type="application/json+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2012%2F05%2F21%2Fanatomy-of-a-security-hole-the-break-that-broke-sudo%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2012%2F05%2F21%2Fanatomy-of-a-security-hole-the-break-that-broke-sudo%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Anatomy of a security hole &#8211; the break that broke sudo" />
<meta property="og:url" content="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/" />
<meta property="og:description" content="A recently-patched bug in the widely-used sudo command makes for interesting reading. The patch reminds us of some important points in security-related programming." />
<meta property="article:published_time" content="2012-05-21T00:27:06+00:00" />
<meta property="article:modified_time" content="2012-06-29T07:48:39+00:00" />
<meta property="og:site_name" content="Naked Security" />
<meta property="og:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/05/sudo-logo-250.png?w=250" />
<meta property="og:image:secure_url" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/05/sudo-logo-250.png?w=250" />
<meta property="og:image:width" content="250" />
<meta property="og:image:height" content="250" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@NakedSecurity" />
<meta name="twitter:text:title" content="Anatomy of a security hole &#8211; the break that broke sudo" />
<meta name="twitter:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/05/sudo-logo-250.png?w=144" />
<meta name="twitter:card" content="summary" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=270" />
</head>
<body class="post-template-default single single-post postid-167271 single-format-standard" >
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VK6LTK"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div style="display: none">
<svg>
	<symbol id="sophos" viewBox="0 0 132 24">
		<path d="m111.82 22.176h11.64c3.267 0 4.65-0.2 5.74-0.896 1.715-1.063 2.804-3.26 2.804-5.62 0-1.928-0.658-3.89-1.647-4.888-1.288-1.33-3.035-1.828-6.271-1.828h-3.527c-1.586 0-2.754-0.067-3.412-0.365-0.794-0.367-1.256-1.165-1.256-2.161 0-1.165 0.56-2.03 1.486-2.264 0.692-0.163 1.498-0.163 3.574-0.198h10.419v-3.956h-11.473c-2.574 0-3.727 0.099-4.718 0.466-2.279 0.796-3.828 3.257-3.828 6.083 0 1.93 0.76 3.727 2.079 4.89 1.155 0.996 2.872 1.462 5.51 1.462h4.697c1.057 0 1.915 0.132 2.376 0.398 0.893 0.433 1.418 1.328 1.418 2.36 0 0.864-0.395 1.597-1.087 2.027-0.561 0.369-1.517 0.534-3.268 0.534h-11.256zm-111.35 0h11.64c3.267 0 4.652-0.2 5.741-0.896 1.714-1.063 2.803-3.26 2.803-5.62 0-1.928-0.66-3.89-1.65-4.888-1.285-1.33-3.034-1.828-6.27-1.828h-3.527c-1.584 0-2.751-0.067-3.41-0.365-0.792-0.367-1.253-1.165-1.253-2.161 0-1.165 0.56-2.03 1.484-2.264 0.693-0.163 1.496-0.163 3.574-0.198h10.42v-3.956h-11.477c-2.573 0-3.727 0.099-4.715 0.466-2.278 0.796-3.83 3.257-3.83 6.083 0 1.93 0.762 3.727 2.08 4.89 1.155 0.996 2.871 1.462 5.51 1.462h4.696c1.057 0 1.913 0.132 2.377 0.398 0.888 0.433 1.416 1.328 1.416 2.36 0 0.864-0.394 1.597-1.089 2.027-0.558 0.369-1.517 0.534-3.264 0.534h-11.256v3.956zm94.05-16.18c-0.68 1.076-1.003 2.803-1.003 5.122 0 5.088 1.747 7.405 5.63 7.405 3.822 0 5.568-2.317 5.568-7.34 0-5.092-1.715-7.373-5.568-7.373-2.102 0-3.754 0.784-4.627 2.186zm13.174-2.511c1.329 1.761 2.072 4.63 2.072 7.992 0 3.816-1.197 6.948-3.334 8.677-1.619 1.304-4.078 2.022-6.995 2.022-4.142 0-7.41-1.372-9.092-3.817-1.263-1.793-1.88-4.176-1.88-7.08 0-4.172 1.133-7.339 3.27-9.035 1.682-1.37 4.339-2.122 7.383-2.122 3.85 0 6.925 1.209 8.576 3.363zm-22.018-3.068h-4.596v8.908h-8.319v-8.908h-4.597v21.759h4.597v-8.97h8.318v8.97h4.596v-21.759zm-28.61 10.277c1.23 0 1.941-0.163 2.427-0.62 0.581-0.49 0.938-1.533 0.938-2.74 0-1.436-0.58-2.478-1.584-2.838-0.356-0.13-0.94-0.197-1.684-0.197h-6.344v6.395zm-6.247 11.481h-4.598v-21.758h10.78c3.786 0 5.114 0.39 6.538 1.991 1.264 1.37 1.942 3.163 1.942 5.088 0 2.284-0.904 4.404-2.394 5.676-1.262 1.077-2.43 1.402-4.888 1.402h-7.38zm-22.589-16.179c-0.682 1.076-1.004 2.803-1.004 5.122 0 5.088 1.748 7.405 5.634 7.405 3.818 0 5.568-2.317 5.568-7.34 0-5.092-1.716-7.373-5.568-7.373-2.106 0-3.757 0.784-4.63 2.186zm13.174-2.511c1.328 1.761 2.073 4.63 2.073 7.992 0 3.816-1.2 6.948-3.335 8.677-1.618 1.304-4.079 2.022-6.993 2.022-4.144 0-7.413-1.372-9.096-3.817-1.264-1.793-1.878-4.176-1.878-7.08 0-4.172 1.133-7.339 3.272-9.035 1.681-1.37 4.337-2.122 7.38-2.122 3.851 0 6.93 1.209 8.578 3.363z"></path>
	</symbol>
	<symbol id="twitter" viewBox="0 0 24 24">
 		<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path>
 	</symbol>
	<symbol id="facebook" viewBox="0 0 24 24">
 		<path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path>
 	</symbol>
	<symbol id="instagram" viewBox="0 0 24 24">
		<path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path>
	</symbol>
	<symbol id="linkedin" viewBox="0 0 24 24">
		<path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"></path>
	</symbol>
	<symbol id="rss" viewBox="0 0 24 24">
		<path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"></path>
	</symbol>
	<symbol id="reddit" viewBox="0 0 24 24">
		<path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"></path>
	</symbol>
</svg>
</div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header variation variation-3" role="banner">
		<div class="header-container">
			<div class="site-branding">
				<div class="site-title">
					<a title="Naked Security" href="https://nakedsecurity.sophos.com/" rel="home"><img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/naked-security-logo-white@2x.png"></a>
					by
					<a title="sophos.com" href="https://www.sophos.com"><svg viewBox="0 0 132 24" class="icon sophos"><use xlink:href="#sophos"></use></svg></a>
				</div>
			</div><!-- .site-branding -->
			<nav id="site-navigation" class="main-navigation" role="navigation">
				<div class="container">
					<ul id="menu-variation-two" class="exit-links menu"><li id="menu-item-436509" class="products menu-item menu-item-type-custom menu-item-object-custom menu-item-436509"><a href="#">Products</a></li>
<li id="menu-item-436515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436515"><a href="https://www.sophos.com/en-us/products/free-tools.aspx">Free Tools</a></li>
<li id="menu-item-436531" class="search-toggle menu-item menu-item-type-custom menu-item-object-custom menu-item-436531"><a href="#">Search</a></li>
<li id="menu-item-436532" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436532"><a href="https://home.sophos.com/en-us.aspx">Free Sophos Home</a></li>
</ul>				</div>
			</nav><!-- #site-navigation -->
			<div class="site-search-block">
	<form target="_top" role="search" class="search-form" method="get" action="https://nakedsecurity.sophos.com/">
        <fieldset>
            <div class="field">
				<input type="search" value="" name="s" class="search-field" placeholder="Search naked security...">
            </div>
            <div class="submit">
				<button type="submit" class="search-submit button">Go</button>
            </div>
        </fieldset>
    </form>
</div>
		</div><!-- .container -->
	</header>

	<div class="responsive-flyout-panel small-12 column active" style="opacity: 1; display: none;">
		<div class="modal-filler"></div>
	    <div class="productNavBox">
	        <div class="productNavContainer">
	            <div class="row prodRow">
	                <div class="prodListBox column large-9">
	                    <div class="row margin-0 highlightProduct">
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/next-gen-firewall.aspx"><img src="https://www.sophos.com/medialibrary/2F4785DE8C3F43ECBD699A18F332FEEB.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">XG Firewall</div>
	                                	<div class="menu-section-subtitle">Next-Gen Firewall</div>
									</div>
	                            </a>
	                        </div>
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/intercept-x.aspx"><img src="https://www.sophos.com/medialibrary/27111765D65A45D49A232925D2CE428B.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">Intercept X</div>
	                                	<div class="menu-section-subtitle">Next-Gen Endpoint</div>
									</div>
	                            </a>
	                        </div>
	                    </div>
	                    <div class="productList">
	                        <ul>
								<li>
									<a href="https://www.sophos.com/en-us/products/cloud-optix.aspx"><img src="https://www.sophos.com/medialibrary/SophosNext/Images/Products/Icons/sophos-cloud-optix-icon.svg">Sophos Cloud Optix</a>
								</li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-central.aspx"><img src="https://www.sophos.com/medialibrary/08EA66123F1B4DDE8FE5C9B578A7FAA7.ashx">Sophos Central</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/mobile-control.aspx"><img src="https://www.sophos.com/medialibrary/678FE994855047739F50D6C411184FA6.ashx">Sophos Mobile</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/server-security.aspx"><img src="https://www.sophos.com/medialibrary/01B80E7D7CD54EF8AC2E51C9C6EC0236.ashx">Intercept X for Server</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-wifi.aspx"><img src="https://www.sophos.com/medialibrary/BEBD9C41BB4E480498514B29B92A145A.ashx">Secure Wi-Fi</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/phish-threat.aspx"><img src="https://www.sophos.com/medialibrary/DC9D1A7BA3964B0C9DAF1F1E68806B5A.ashx">Phish Threat</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/safeguard-encryption.aspx"><img src="https://www.sophos.com/medialibrary/8F51F06B62814B108D3B2763FF018E37.ashx">SafeGuard Encryption</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-email.aspx"><img src="https://www.sophos.com/medialibrary/597ADA0AF01A4A12B2B27239D0F9992C.ashx">Secure Email</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/unified-threat-management.aspx"><img src="https://www.sophos.com/medialibrary/8CB72BF5E1AD41F7894CE5E42101B0F3.ashx">SG UTM</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-web-gateway.aspx"><img src="https://www.sophos.com/medialibrary/C586E372694547A1B207A61D87246BA7.ashx">Secure Web Gateway</a>
	                            </li>
	                        </ul>
	                    </div>
	                </div>
	                <div class="homeUserBox column large-3">
						<img src="https://www.sophos.com/medialibrary/3376DF5742A64AEE93FDB9DCA7291239.ashx">
						<div class="menu-section-title">For Home Users</div>
	                    <p>Sophos Home protects every Mac and PC in your home </p><a href="https://home.sophos.com/" target="_blank" class="greenSmallMenuBtn">Learn More</a>
					</div>
	            </div>
	            <div class="row blueRow">
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-tools.aspx"><img width="19" src="https://www.sophos.com/medialibrary/A1FF440D2BB84511B8C94D771D44E207.ashx">Free Security Tools</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-trials.aspx"><img width="20" src="https://www.sophos.com/medialibrary/FCD3410ED2C347808D9DB8AC12C62DBD.ashx">Free Trials</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/demos.aspx"><img width="18" src="https://www.sophos.com/medialibrary/50985180E5F54C94917A2A6508E24287.ashx">Product Demos</a>
	                </div>
	                <!-- <div class="column large-3 medium-6">
	                    <a href="javascript:fairfax.openLiveChatFromFlyoutLink();" class="flyout-live-chat-link"><img width="20" src="https://www.sophos.com/medialibrary/E24C5050837145F6A5C592E299BA2A0D.ashx">Live Sales Chat</a>
	                </div> -->
	            </div>
	        </div>
	    </div>
	</div>
	<script>

	jQuery(document).ready( function () {
		var productButton   = jQuery('nav .menu-item.products');
		var modalBackground = jQuery('.modal-filler');
		var flyoutMenu		= jQuery('.responsive-flyout-panel');
		var Sophos			= Sophos || {};

		Sophos.MenuTest = {};

		Sophos.MenuTest.open = function () {
				productButton.addClass('open');
				flyoutMenu.show();
				modalBackground.show();
		};

		Sophos.MenuTest.close = function () {
			productButton.removeClass('open');
			flyoutMenu.hide();
			modalBackground.hide();
		};

		Sophos.MenuTest.toggle = function () {
			if ( productButton.hasClass('open') ) {
				Sophos.MenuTest.close();
			} else {
				Sophos.MenuTest.open();
			}
		};

		productButton.click( Sophos.MenuTest.toggle );
		modalBackground.click( Sophos.MenuTest.close );
	});

	</script>

	
	<section class="about-panel">
	<div class="container">
	<div class="panel-content ">

		<div class="description"><span>Have you listened to our podcast? <a href="/podcast/">Listen now</a></span></div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	<div id="content" class="site-content">
		<div class="content-container">

</div> <!-- .container -->
</div> <!-- #content -->


	<section class="content-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

		<main id="main" class="site-main" role="main">

	
		
<article id="post-167271" class="post-167271 post type-post status-publish format-standard has-post-thumbnail hentry category-featured category-vulnerability tag-break tag-bugwatch tag-c tag-escalation tag-exploit tag-it tag-privilege tag-sudo tag-switch tag-vulnerability-2">

	<header class="entry-header">
		<h1 class="entry-title">Anatomy of a security hole &#8211; the break that broke sudo</h1>		<div class="entry-meta">
			<div>
				
	<span class="entry-published">
		<time class="entry-date published" datetime="2012-05-21T01:27:06+01:00">21 May 2012</time>
	</span>

					<a href="#comments" class="comment-box">
					<span class="count">25</span>
				</a>
					
	<span class="entry-categories">
	<a href="https://nakedsecurity.sophos.com/category/security-threats/vulnerability/">Vulnerability</a>	</span>

			</div>
	</header> <!-- .entry-header -->

    <div id="newsletter-signup" class="container top"></div>

			<div class="entry-featured-image">
			<img width="250" height="250" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/05/sudo-logo-250.png?w=250&amp;h=250&amp;crop=1" class="attachment-hero-thumbnail size-hero-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/05/sudo-logo-250.png 250w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/05/sudo-logo-250.png?resize=150,150 150w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/05/sudo-logo-250.png?resize=225,225 225w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/05/sudo-logo-250.png?resize=70,70 70w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/05/sudo-logo-250.png?resize=32,32 32w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/05/sudo-logo-250.png?resize=50,50 50w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/05/sudo-logo-250.png?resize=64,64 64w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/05/sudo-logo-250.png?resize=96,96 96w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/05/sudo-logo-250.png?resize=128,128 128w" sizes="(max-width: 250px) 100vw, 250px" />					</div> <!-- .entry-featured-image -->
		
		<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2012/05/19/state-of-utah-outlines-mistakes-made-allowing-theft-of-780k-records/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> State of Utah outlines mistakes made allowing theft of 780K records</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2012/05/21/doctors-shouldnt-buddy-up-with-patients-on-facebook-or-twitter-hospitals-warn/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Doctors shouldn&#8217;t buddy up with patients on Facebook or Twitter, hospitals warn</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	<div class="entry-content">
		<div class="entry-prefix">
			<div class="entry-author">
				
	
					<span class="by">by</span>
			<a href="https://nakedsecurity.sophos.com/author/paul-ducklin/" title="Posts by Paul Ducklin" class="author url fn" rel="author">Paul Ducklin</a>		
	
				</div>
			<div class="entry-sharing">
				
	<ul class="block social share">
		<li class="facebook"><a href="https://www.facebook.com/share.php?u=https%3A%2F%2Fnakedsecurity.sophos.com%2F2012%2F05%2F21%2Fanatomy-of-a-security-hole-the-break-that-broke-sudo%2F&title=Anatomy+of+a+security+hole+%E2%80%93+the+break+that+broke+sudo" data-title="Anatomy of a security hole – the break that broke sudo" title="Share on Facebook"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
		<li class="twitter"><a href="https://twitter.com/intent/tweet?text=Anatomy+of+a+security+hole+%E2%80%93+the+break+that+broke+sudo+https%3A%2F%2Fnakedsecurity.sophos.com%2F%3Fp%3D167271" data-title="Anatomy of a security hole &#8211; the break that broke sudo" title="Share on Twitter"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
		<li class="linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2012%2F05%2F21%2Fanatomy-of-a-security-hole-the-break-that-broke-sudo%2F&title=Anatomy+of+a+security+hole+%E2%80%93+the+break+that+broke+sudo" data-title="Anatomy of a security hole – the break that broke sudo" title="Share on LinkedIn"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
		<li class="reddit"><a href="https://reddit.com/submit/?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2012%2F05%2F21%2Fanatomy-of-a-security-hole-the-break-that-broke-sudo%2F&title=Anatomy+of+a+security+hole+%E2%80%93+the+break+that+broke+sudo" title="Share on Reddit"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon reddit"><use xlink:href="#reddit"></use></svg></a></li>

			</ul>

				</div>
		</div>
		<p><a href="http://www.gratisoft.us/sudo/" rel="nofollow"><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2012/05/sudo-logo-170.png" alt="" title="The SUDO logo" width="168" height="188" align="right" hspace="10" vspace="10"></img></a>A recently-patched bug in the widely-used <a href="http://www.gratisoft.us/sudo/" rel="nofollow"><strong>sudo</strong></a> command makes for interesting reading. </p>
<p>The patch reminds us of some important points in security-related programming.</p>
<p>The UNIX <strong>sudo</strong> command is usually translated to mean &#8220;<strong>do</strong> as <strong>su</strong>peruser&#8221; &#8211; in other words, it lets you run administrative commands one at a time, without logging in as the superuser (<em>root</em>, in UNIX parlance). </p>
<p>More accurately, sudo stands for &#8220;<strong>su</strong>bstitute user identity and <strong>do</strong>&#8220;, so that you can use it to take on an identity other than root, such as a backup user or a database administrator.</p>
<p>Clearly, sudo is the sort of program in which a vulnerability will almost certainly lead to an escalation-of-privilege exploit. Since sudo&#8217;s main purpose is to let you enjoy root-like powers in a controlled way, anyone who can sneak past sudo&#8217;s permission checks can turn a minor intrusion into an effectively unlimited one.</p>
<p>So why use a potentially risky command like sudo at all? The answer is that sudo can improve security significantly:</p>
<p><strong>* You don&#8217;t need to tell all your administrative users the root password.</strong> Sudo lets them authenticate individually, and keeps a log of each individual&#8217;s administrative activity.</p>
<p><strong>* You don&#8217;t need to work at a root prompt.</strong> This avoids running every command with supreme power. You take on root privileges only when they are strictly necessary.</p>
<p><strong>* You can authorise users to run some, but not all, administrative commands.</strong> You can let them start a backup, for example, but not add new users to the system.</p>
<p>In fact, some operating system distributions &#8211; the Ubuntu family, for example, and OS X &#8211; discourage root login altogether, and use sudo for all administrative tasks.</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2012/05/sudo-gets-root-190.png" alt="" title="Sudo used to get a root prompt" width="188" height="114" align="right" hspace="10" vspace="10"></img></a>This isn&#8217;t perfect, so caution is still required. </p>
<p>Sudo lets you activate a root prompt if you want &#8211; for example, with the commands <tt>sudo su -</tt> or <tt>sudo -s</tt>. </p>
<p>And many users, confronted with a <em>Permission denied</em> error, fall into the bad habit of repeating their previous command with <strong>sudo</strong> in front. (If you have developed this habit, get rid of it. Use sudo because you ought to, not merely because it&#8217;s convenient.)</p>
<p><a href="http://xkcd.com/149/" rel="nofollow"><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2012/05/xkcd-149-sandwich-comic-500.png" alt="" title="XKCD 149 - &#039;Sudo sandwich&#039; at http://xkcd.com/149/" width="481" height="220" class="alignnone size-full wp-image-167278" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/05/xkcd-149-sandwich-comic-500.png 481w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/05/xkcd-149-sandwich-comic-500.png?resize=300,137 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/05/xkcd-149-sandwich-comic-500.png?resize=100,46 100w" sizes="(max-width: 481px) 100vw, 481px" /></a></p>
<p>Anyway, sudo was recently found to have a single-line bug which affected its user authentication in rather specific circumstances. </p>
<p>Sudo is controlled by a configuration file called <strong>sudoers</strong>, or by similar configuration data managed by LDAP directory services. </p>
<p>Amongst other things, this file lets you regulate the power of users by the network they&#8217;re on. When sudo sets out to verify a user&#8217;s network mask &#8211; for example, <a href="http://www.rfc-editor.org/rfc/rfc5737.txt" rel="nofollow">203.0.113.0/24</a> &#8211; it enters a C function called <tt>addr_matches_if_netmask()</tt>. </p>
<p>The authorisation part of this function is split into two parts. One part checks IPv4 addresses; the other checks IPv6 addresses. </p>
<p>The function chooses which path to take using a <strong>switch</strong> statement. Switches are one of C&#8217;s decision-making instructions, and they look something like this:</p>
<pre style="font-size:80%;">   switch (dayofweek) {
      case SUNDAY: 
         do_sunday_stuff();
         break;
      case SATURDAY:
         do_saturday_stuff();
         break;
      default:
         do_weekday_stuff();
         break;
   }</pre>
<p>Notice the <strong>break</strong> statements. These tell C, &#8220;That&#8217;s everything for this code path through this switch, thanks. Exit the switch right now.&#8221;</p>
<p>However, you can legally omit any <strong>break</strong>, if you want processing to fall through to the next case in the switch:</p>
<pre style="font-size:80%;">   switch (dayofweek) {
      case SUNDAY: 
         do_special_sunday_stuff();
         break;
      case SATURDAY:
         do_saturday_stuff();
         /* Break omitted - deliberate fall-through */
         /* to do non-Sunday stuff on Saturday too. */
      default:
         do_nonsunday_stuff();
         break;
   }</pre>
<p>And that&#8217;s what happened in sudo. The <strong>break</strong> statement between the IPv4 checking and the IPv6 checking was left out. So if the IPv4 checks failed, the IPv6 checks &#8211; inappropriate in the circumstances &#8211; were tried instead. With nothing to match against nothing, the checks succeeded, even though they had already failed in the IPv4 code above.</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2012/05/sudo-patch-anim-500.gif" alt="" title="Animated view of sudo patch 1.8.4p5" width="494" height="190"></img></p>
<p>Result: users whose sudo access was regulated by network masks would be authenticated when they shouldn&#8217;t be. So an attacker could masquerade as an authorised internal user, even from outside the network.</p>
<p>And, as promised at the outset, this reminds us of some important points in security-related programming:</p>
<p><strong>* Bugs can be arcane enough to escape notice for years.</strong> This can happen even in security software, and even if the source code is freely available.</p>
<p><strong>* Bugs can be caused even (or especially!) by minuscule errors.</strong> </p>
<p><strong>* Bugs are worth patching.</strong></p>
<p><strong>* Watch your breaks.</strong> </p>
<p>By the way, always put a <strong>break</strong> after the last <strong>case</strong> in a <strong>switch</strong>. It might not be necessary now, but it ensures that coders who add cases later don&#8217;t forget the now-necessary breaks above their new code.</p>
<p>Technically, if you don&#8217;t use IPv4 network masks in your sudo configuration, you aren&#8217;t affected by this bug. But since almost every Linux or UNIX has sudo installed, it&#8217;s worth upgrading. </p>
<p><br />
&#8211;</p>
<p style="font-size:80%;"><em>The XKCD &#8216;Sandwich&#8217; is <a href="http://xkcd.com/149/" rel="nofollow">comic #149</a> from <a href="http://xkcd.com/" rel="nofollow">http://xkcd.com/</a> &#8211; &#8220;a webcomic of romance,<br />
sarcasm, math, and language.</em>&#8220;</p>
<p style="font-size:80%;"><em>Note to Windows users: your equivalent of sudo is <strong>runas</strong>. Try <tt>runas /?</tt> at a command prompt to find out more.</em>&#8220;</p>
			</div> <!-- .entry-content -->
	<ul class="block social follow">
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon twitter"><use xlink:href="#twitter"></use></svg>
			<p>Follow <strong><a href="https://twitter.com/nakedsecurity">@NakedSecurity on Twitter</a></strong> for the latest computer security news.</p>
		</li>
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon instagram"><use xlink:href="#instagram"></use></svg>
			<p>Follow <strong><a href="https://www.instagram.com/nakedsecurity/">@NakedSecurity on Instagram</a></strong> for exclusive pics, gifs, vids and LOLs!</p>
		</li>
	</ul>
</article><!-- #post-## -->

		<div class="free-tools-block">
			<h2 class="block-title">Free tools</h2>

<div class="ns-free-tools">
	<div class="ns-free-tools__item ns-free-tools__item--sophos-home">
		<a class="ns-free-tools__link" href="https://home.sophos.com/en-us.aspx?cmp=701j0000001eLpnAAE">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/sophos-home@2x.png" alt="Sophos Home" class="ns-free-tools__image" width="166" height="100">
			<h4 class="ns-free-tools__title">
				Sophos Home			</h4>
			<div class="ns-free-tools__sub-title">
				Protect personal PCs and Macs			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--hitman-pro">
		<a class="ns-free-tools__link" href="https://www.hitmanpro.com/en-us/hmp.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/hitman-pro@2x.png" alt="Hitman Pro" class="ns-free-tools__image" width="154" height="100">
			<h4 class="ns-free-tools__title">
				Hitman Pro			</h4>
			<div class="ns-free-tools__sub-title">
				Find and remove malware			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--intercept-x">
		<a class="ns-free-tools__link" href="https://www.sophos.com/en-us/products/free-tools/sophos-mobile-security-free-edition.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/mobile-security-android@2x.png" alt="Sophos Intercept X for Mobile" class="ns-free-tools__image" width="96" height="110">
			<h4 class="ns-free-tools__title">
				Intercept X for Mobile			</h4>
			<div class="ns-free-tools__sub-title">
				Protect Android devices			</div>
		</a>
	</div>
</div>
		</div>

			<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2012/05/19/state-of-utah-outlines-mistakes-made-allowing-theft-of-780k-records/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> State of Utah outlines mistakes made allowing theft of 780K records</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2012/05/21/doctors-shouldnt-buddy-up-with-patients-on-facebook-or-twitter-hospitals-warn/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Doctors shouldn&#8217;t buddy up with patients on Facebook or Twitter, hospitals warn</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	
	</main><!-- #main -->

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<section class="comments-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

			
<div id="comments" class="comments-area">

			<h2 class="comments-title">
			25 comments on &ldquo;<span>Anatomy of a security hole &#8211; the break that broke sudo</span>&rdquo;		</h2>

		<ol class="comment-list">
					<li id="comment-33105" class="comment even thread-even depth-1 parent">
			<article id="div-comment-33105" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/5daecd8f19204b20d32ad7558c4196ce?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5daecd8f19204b20d32ad7558c4196ce?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">asfonseca</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33105"><time datetime="2012-05-21T01:35:50+01:00">May 21, 2012 at 1:35 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>In the list of reasons to use sudo you forgot to mention one that is really important: using sudo activities are logged in the system log files. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33105"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33105={"id":7238218,"unique_id":"wp-comment-33105","title":"In%20the%20list%20of%20reasons%20to%20use%20sudo%20you%20forgot%20to%20mention%20one%20that%20is%20really%20important%3A%20using%20sudo%20activities%20are%20logged%20in%20the%20system%20log%20files.%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33105","item_id":"_comm_33105"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33105#respond' data-commentid="33105" data-postid="167271" data-belowelement="div-comment-33105" data-respondelement="respond" data-replyto="Reply to asfonseca" aria-label='Reply to asfonseca'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-33114" class="comment odd alt depth-2 parent">
			<article id="div-comment-33114" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/441e7fae6894199e8fc3025efb70919d?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/441e7fae6894199e8fc3025efb70919d?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33114"><time datetime="2012-05-21T02:28:03+01:00">May 21, 2012 at 2:28 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Errr, I wrote in my first point: &quot;Sudo lets [multiple admin users] authenticate individually, and keeps a log of each individual&#039;s administrative activity.&quot; </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33114"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33114={"id":7238218,"unique_id":"wp-comment-33114","title":"Errr%2C%20I%20wrote%20in%20my%20first%20point%3A%20%26quot%3BSudo%20lets%20%26%23091%3Bmultiple%20admin%20users%26%23093%3B%20authenticate%20individually%2C%20and%20keeps%20a%20log%20of%20each%20individual%26%23039%3Bs%20administrative%20activity.%26quot%3B%20%20%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33114","item_id":"_comm_33114"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33114#respond' data-commentid="33114" data-postid="167271" data-belowelement="div-comment-33114" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-33131" class="comment even depth-3">
			<article id="div-comment-33131" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/5daecd8f19204b20d32ad7558c4196ce?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5daecd8f19204b20d32ad7558c4196ce?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">@antoniofonseca</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33131"><time datetime="2012-05-21T05:06:50+01:00">May 21, 2012 at 5:06 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Sorry, my fault. For some reason I didn&#8217;t see it before. You&#8217;re absolutely right.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33131"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33131={"id":7238218,"unique_id":"wp-comment-33131","title":"Sorry%2C%20my%20fault.%20For%20some%20reason%20I%20didn%26%23039%3Bt%20see%20it%20before.%20You%26%23039%3Bre%20absolutely%20right.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33131","item_id":"_comm_33131"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33131#respond' data-commentid="33131" data-postid="167271" data-belowelement="div-comment-33131" data-respondelement="respond" data-replyto="Reply to @antoniofonseca" aria-label='Reply to @antoniofonseca'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-33119" class="comment odd alt depth-2 parent">
			<article id="div-comment-33119" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/65f5c5ef601575103f5ef0afbdc4fc01?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/65f5c5ef601575103f5ef0afbdc4fc01?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Markus Stumpf</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33119"><time datetime="2012-05-21T03:14:04+01:00">May 21, 2012 at 3:14 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>»sudo bash«<br />
There goes your logging &#8230;</p>
<p>Oh, I am only allowed to edit files?<br />
»sudo vi /tmp/bla«<br />
»:!bash«<br />
There goes your logging &#8230;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33119"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33119={"id":7238218,"unique_id":"wp-comment-33119","title":"sudo%20bashThere%20goes%20your%20logging%20...Oh%2C%20I%20am%20only%20allowed%20to%20edit%20files%3Fsudo%20vi%20%2Ftmp%2Fbla%3A%21bashThere%20goes%20your%20logging%20...%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33119","item_id":"_comm_33119"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33119#respond' data-commentid="33119" data-postid="167271" data-belowelement="div-comment-33119" data-respondelement="respond" data-replyto="Reply to Markus Stumpf" aria-label='Reply to Markus Stumpf'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-33124" class="comment even depth-3 parent">
			<article id="div-comment-33124" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/441e7fae6894199e8fc3025efb70919d?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/441e7fae6894199e8fc3025efb70919d?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33124"><time datetime="2012-05-21T03:47:34+01:00">May 21, 2012 at 3:47 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Indeed, as we mentioned above if you do sudo su &#8211; or sudo -s. </p>
<p>However, logging would at least show administrative activity _by user X_. Which is more than you get if you just see &quot;user root logged in and did stuff,&quot; with no disambiguation of &quot;which admin&quot;. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33124"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33124={"id":7238218,"unique_id":"wp-comment-33124","title":"Indeed%2C%20as%20we%20mentioned%20above%20if%20you%20do%20sudo%20su%20-%20or%20sudo%20-s.%20%20However%2C%20logging%20would%20at%20least%20show%20administrative%20activity%20_by%20user%20X_.%20Which%20is%20more%20than%20you%20get%20if%20you%20just%20see%20%26quot%3Buser%20root%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33124","item_id":"_comm_33124"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33124#respond' data-commentid="33124" data-postid="167271" data-belowelement="div-comment-33124" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-33186" class="comment odd alt depth-4">
			<article id="div-comment-33186" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/5daecd8f19204b20d32ad7558c4196ce?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5daecd8f19204b20d32ad7558c4196ce?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">asfonseca</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33186"><time datetime="2012-05-21T14:42:23+01:00">May 21, 2012 at 2:42 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Exactly. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33186"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33186={"id":7238218,"unique_id":"wp-comment-33186","title":"Exactly.%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33186","item_id":"_comm_33186"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33186#respond' data-commentid="33186" data-postid="167271" data-belowelement="div-comment-33186" data-respondelement="respond" data-replyto="Reply to asfonseca" aria-label='Reply to asfonseca'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-33107" class="comment even thread-odd thread-alt depth-1 parent">
			<article id="div-comment-33107" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/b8b1cb13b0fab9ec06403f718d0eec7b?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b8b1cb13b0fab9ec06403f718d0eec7b?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">jmb</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33107"><time datetime="2012-05-21T01:56:05+01:00">May 21, 2012 at 1:56 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>&#8220;sudo -s&#8221;, surely? </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33107"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33107={"id":7238218,"unique_id":"wp-comment-33107","title":"%26quot%3Bsudo%20-s%26quot%3B%2C%20surely%3F%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33107","item_id":"_comm_33107"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33107#respond' data-commentid="33107" data-postid="167271" data-belowelement="div-comment-33107" data-respondelement="respond" data-replyto="Reply to jmb" aria-label='Reply to jmb'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-33115" class="comment odd alt depth-2">
			<article id="div-comment-33115" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/441e7fae6894199e8fc3025efb70919d?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/441e7fae6894199e8fc3025efb70919d?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33115"><time datetime="2012-05-21T02:49:00+01:00">May 21, 2012 at 2:49 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Surely.  </p>
<p>I&#039;ve updated the article (and the image) to clarify that there are several ways to get a root prompt. I now mention sudo -s and sudo su -,  and sudo /bin/sh and sudo login -f root spring to mind, too. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33115"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33115={"id":7238218,"unique_id":"wp-comment-33115","title":"Surely.%20%20%20I%26%23039%3Bve%20updated%20the%20article%20%28and%20the%20image%29%20to%20clarify%20that%20there%20are%20several%20ways%20to%20get%20a%20root%20prompt.%20I%20now%20mention%20sudo%20-s%20and%20sudo%20su%20-%2C%20%20and%20sudo%20%2Fbin%2Fsh%20and%20sudo%20login%20-f%20root%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33115","item_id":"_comm_33115"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33115#respond' data-commentid="33115" data-postid="167271" data-belowelement="div-comment-33115" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-33116" class="comment even thread-even depth-1 parent">
			<article id="div-comment-33116" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/b62c392b65c3ae456279b8cdad257911?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b62c392b65c3ae456279b8cdad257911?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Roger owens</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33116"><time datetime="2012-05-21T02:57:57+01:00">May 21, 2012 at 2:57 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I used to lecture the software engineers (that I managed b4 I retired) on this very point. Always use the break or use a compound if. If statements make for better code when you only have two conditions, but don&#8217;t forget the else statements. If you want to use switches cause they&#8217;re easier to see the logic, always perform peer code reviews. And, furthermore, always perform exhaustive tests! </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33116"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33116={"id":7238218,"unique_id":"wp-comment-33116","title":"I%20used%20to%20lecture%20the%20software%20engineers%20%28that%20I%20managed%20b4%20I%20retired%29%20on%20this%20very%20point.%20Always%20use%20the%20break%20or%20use%20a%20compound%20if.%20If%20statements%20make%20for%20better%20code%20when%20you%20only%20have%20two%20con%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33116","item_id":"_comm_33116"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33116#respond' data-commentid="33116" data-postid="167271" data-belowelement="div-comment-33116" data-respondelement="respond" data-replyto="Reply to Roger owens" aria-label='Reply to Roger owens'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-33126" class="comment odd alt depth-2">
			<article id="div-comment-33126" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/441e7fae6894199e8fc3025efb70919d?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/441e7fae6894199e8fc3025efb70919d?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33126"><time datetime="2012-05-21T04:00:29+01:00">May 21, 2012 at 4:00 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I too would have preferred  </p>
<p>if (it_is_IPv4) {<br />
  /* do ipv4 stuff */<br />
} else if (it_is_IPv6) {<br />
  /* do ipv6 stuff */<br />
} else {<br />
/* it&#039;s an error situation */<br />
} </p>
<p>with a switch introduced only if there are more than two legal alternatives. Switches can often let the compiler generate more efficient code, but only for a decently-sized set of alternatives. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33126"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33126={"id":7238218,"unique_id":"wp-comment-33126","title":"I%20too%20would%20have%20preferred%20%20%20%20if%20%28it_is_IPv4%29%20%7B%20%20%20%20%2F%2A%20do%20ipv4%20stuff%20%2A%2F%20%20%7D%20else%20if%20%28it_is_IPv6%29%20%7B%20%20%20%20%2F%2A%20do%20ipv6%20stuff%20%2A%2F%20%20%7D%20else%20%7B%20%20%2F%2A%20it%26%23039%3Bs%20an%20error%20situation%20%2A%2F%20%7D%20%20%20with%20a%20switch%20introduced%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33126","item_id":"_comm_33126"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33126#respond' data-commentid="33126" data-postid="167271" data-belowelement="div-comment-33126" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-33117" class="comment even thread-odd thread-alt depth-1 parent">
			<article id="div-comment-33117" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/c403a5e5121760f891f0d1fc90708024?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c403a5e5121760f891f0d1fc90708024?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Xorinzor</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33117"><time datetime="2012-05-21T02:59:25+01:00">May 21, 2012 at 2:59 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I dont get it, in PHP calling a switch statement but forgetting the break will result in a PHP error, not so weird as you cant call &quot;case&quot; in a &quot;case&quot; function without a switch surrounding it, how could this happen here?</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33117"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33117={"id":7238218,"unique_id":"wp-comment-33117","title":"I%20dont%20get%20it%2C%20in%20PHP%20calling%20a%20switch%20statement%20but%20forgetting%20the%20break%20will%20result%20in%20a%20PHP%20error%2C%20not%20so%20weird%20as%20you%20cant%20call%20%26quot%3Bcase%26quot%3B%20in%20a%20%26quot%3Bcase%26quot%3B%20function%20without%20a%20switc%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33117","item_id":"_comm_33117"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33117#respond' data-commentid="33117" data-postid="167271" data-belowelement="div-comment-33117" data-respondelement="respond" data-replyto="Reply to Xorinzor" aria-label='Reply to Xorinzor'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-33125" class="comment odd alt depth-2">
			<article id="div-comment-33125" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/441e7fae6894199e8fc3025efb70919d?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/441e7fae6894199e8fc3025efb70919d?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33125"><time datetime="2012-05-21T03:54:04+01:00">May 21, 2012 at 3:54 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Sudo is written in C, not in PHP. </p>
<p>As mentioned in the article, &quot;[in C] you can legally omit any break, if you want processing to fall through to the next [case] in the switch.&quot;  </p>
<p>(See the example I gave &#8211; where you want the Saturday case to perform the default case&#039;s code, too.) </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33125"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33125={"id":7238218,"unique_id":"wp-comment-33125","title":"Sudo%20is%20written%20in%20C%2C%20not%20in%20PHP.%20%20As%20mentioned%20in%20the%20article%2C%20%26quot%3B%26%23091%3Bin%20C%26%23093%3B%20you%20can%20legally%20omit%20any%20break%2C%20if%20you%20want%20processing%20to%20fall%20through%20to%20the%20next%20%26%23091%3Bcase%26%23093%3B%20in%20the%20switch.%26quot%3B%20%20%20%28See%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33125","item_id":"_comm_33125"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33125#respond' data-commentid="33125" data-postid="167271" data-belowelement="div-comment-33125" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-33149" class="comment even depth-2">
			<article id="div-comment-33149" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/7a9e7b9527cfd6aa92876dcb2fead531?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7a9e7b9527cfd6aa92876dcb2fead531?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Jorrit Kronjee</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33149"><time datetime="2012-05-21T08:01:32+01:00">May 21, 2012 at 8:01 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>This is not true. PHP allows omitting breaks in a switch statement. </p>
<p>Here&#8217;s a direct excerpt from their manual: &#8220;PHP continues to execute the statements until the end of the switch block, or the first time it sees a break statement. If you don&#8217;t write a break statement at the end of a case&#8217;s statement list, PHP will go on executing the statements of the following case.&#8221;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33149"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33149={"id":7238218,"unique_id":"wp-comment-33149","title":"This%20is%20not%20true.%20PHP%20allows%20omitting%20breaks%20in%20a%20switch%20statement.%20Here%26%23039%3Bs%20a%20direct%20excerpt%20from%20their%20manual%3A%20%26quot%3BPHP%20continues%20to%20execute%20the%20statements%20until%20the%20end%20of%20the%20switch%20block%2C%20or%20the%20f%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33149","item_id":"_comm_33149"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33149#respond' data-commentid="33149" data-postid="167271" data-belowelement="div-comment-33149" data-respondelement="respond" data-replyto="Reply to Jorrit Kronjee" aria-label='Reply to Jorrit Kronjee'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-33177" class="comment odd alt thread-even depth-1">
			<article id="div-comment-33177" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/9fe2d1307fb0c8d048dbd64829f5c58f?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9fe2d1307fb0c8d048dbd64829f5c58f?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">dav2</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33177"><time datetime="2012-05-21T13:28:02+01:00">May 21, 2012 at 1:28 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>&#8220;But cince almost every Linux or UNIX has sudo installed, it&#8217;s worth upgrading.&#8221;</p>
<p>&#8230; since </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33177"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33177={"id":7238218,"unique_id":"wp-comment-33177","title":"%26quot%3BBut%20cince%20almost%20every%20Linux%20or%20UNIX%20has%20sudo%20installed%2C%20it%26%23039%3Bs%20worth%20upgrading.%26quot%3B%20...%20since%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33177","item_id":"_comm_33177"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33177#respond' data-commentid="33177" data-postid="167271" data-belowelement="div-comment-33177" data-respondelement="respond" data-replyto="Reply to dav2" aria-label='Reply to dav2'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-33230" class="comment even thread-odd thread-alt depth-1 parent">
			<article id="div-comment-33230" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/ac86ca08715bdf36aef79bb26e039536?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ac86ca08715bdf36aef79bb26e039536?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Mark Fisher</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33230"><time datetime="2012-05-21T20:41:30+01:00">May 21, 2012 at 8:41 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Unit tests should show this sort of thing pronto &#8211; I can&#039;t believe they have not been implemented for such a ubiquitous command.  Typical! </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33230"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33230={"id":7238218,"unique_id":"wp-comment-33230","title":"Unit%20tests%20should%20show%20this%20sort%20of%20thing%20pronto%20-%20I%20can%26%23039%3Bt%20believe%20they%20have%20not%20been%20implemented%20for%20such%20a%20ubiquitous%20command.%20%20Typical%21%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33230","item_id":"_comm_33230"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33230#respond' data-commentid="33230" data-postid="167271" data-belowelement="div-comment-33230" data-respondelement="respond" data-replyto="Reply to Mark Fisher" aria-label='Reply to Mark Fisher'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-33606" class="comment odd alt depth-2">
			<article id="div-comment-33606" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Foo</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33606"><time datetime="2012-05-23T21:35:44+01:00">May 23, 2012 at 9:35 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>If it&#039;s typical, you *should* be able to believe they&#039;ve not been implemented. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33606"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33606={"id":7238218,"unique_id":"wp-comment-33606","title":"If%20it%26%23039%3Bs%20typical%2C%20you%20%2Ashould%2A%20be%20able%20to%20believe%20they%26%23039%3Bve%20not%20been%20implemented.%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33606","item_id":"_comm_33606"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33606#respond' data-commentid="33606" data-postid="167271" data-belowelement="div-comment-33606" data-respondelement="respond" data-replyto="Reply to Foo" aria-label='Reply to Foo'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-33242" class="comment even thread-even depth-1 parent">
			<article id="div-comment-33242" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/215a33f6cc39e1c6db4ea4505de4b89d?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/215a33f6cc39e1c6db4ea4505de4b89d?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">chipbuster</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33242"><time datetime="2012-05-21T21:28:35+01:00">May 21, 2012 at 9:28 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Aha! Just a few days ago, I was complaining that Ubuntu released an update that &quot;changed sudo behavior&quot; but didn&#039;t provide any easily accessible details. I suppose this is what that was about? </p>
<p>Also, I&#039;ve heard from several sources that simply doing a &quot;sudo !!&quot; is bad practice, but I haven&#039;t seen any examples. Could you show where a sudo !! could be avoided and how to do it? Usually what happens to me is I try to apt-get upgrade and have to put a sudo in front; as far as I know there&#039;s no other way to do that. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33242"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33242={"id":7238218,"unique_id":"wp-comment-33242","title":"Aha%21%20Just%20a%20few%20days%20ago%2C%20I%20was%20complaining%20that%20Ubuntu%20released%20an%20update%20that%20%26quot%3Bchanged%20sudo%20behavior%26quot%3B%20but%20didn%26%23039%3Bt%20provide%20any%20easily%20accessible%20details.%20I%20suppose%20this%20is%20what%20tha%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33242","item_id":"_comm_33242"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33242#respond' data-commentid="33242" data-postid="167271" data-belowelement="div-comment-33242" data-respondelement="respond" data-replyto="Reply to chipbuster" aria-label='Reply to chipbuster'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-33593" class="comment odd alt depth-2 parent">
			<article id="div-comment-33593" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">krill</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33593"><time datetime="2012-05-23T21:37:57+01:00">May 23, 2012 at 9:37 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>You should explicitly retype the command, or recall it from your command history and sudo it, I think. Running commands with elevated privileges should be explicit, not convenient. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33593"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33593={"id":7238218,"unique_id":"wp-comment-33593","title":"You%20should%20explicitly%20retype%20the%20command%2C%20or%20recall%20it%20from%20your%20command%20history%20and%20sudo%20it%2C%20I%20think.%20Running%20commands%20with%20elevated%20privileges%20should%20be%20explicit%2C%20not%20convenient.%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33593","item_id":"_comm_33593"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33593#respond' data-commentid="33593" data-postid="167271" data-belowelement="div-comment-33593" data-respondelement="respond" data-replyto="Reply to krill" aria-label='Reply to krill'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-33604" class="comment even depth-3">
			<article id="div-comment-33604" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/441e7fae6894199e8fc3025efb70919d?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/441e7fae6894199e8fc3025efb70919d?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33604"><time datetime="2012-05-23T22:52:37+01:00">May 23, 2012 at 10:52 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Agreed.  </p>
<p>I use my command history so I can review what I just typed if I think I needed &quot;sudo&quot;.  </p>
<p>Did the command fail because I made a mistake? Did the command fail because I forgot to ask it _not_ to try to perform actions which would require admin privileges? Or was it really a command I intended to, and ought to, run as root? </p>
<p>If you&#039;re really serious about security, you probably want to use apt-get to &#8211;download-only running as yourself and only do the actual install (from your local repository) running as root 🙂 </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33604"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33604={"id":7238218,"unique_id":"wp-comment-33604","title":"Agreed.%20%20%20I%20use%20my%20command%20history%20so%20I%20can%20review%20what%20I%20just%20typed%20if%20I%20think%20I%20needed%20%26quot%3Bsudo%26quot%3B.%20%20%20Did%20the%20command%20fail%20because%20I%20made%20a%20mistake%3F%20Did%20the%20command%20fail%20because%20I%20forgot%20t%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33604","item_id":"_comm_33604"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33604#respond' data-commentid="33604" data-postid="167271" data-belowelement="div-comment-33604" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-33551" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-33551" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/8082cfc89ffe2f627aedceb3f1247b8c?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8082cfc89ffe2f627aedceb3f1247b8c?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Christy Nicol</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33551"><time datetime="2012-05-23T16:43:03+01:00">May 23, 2012 at 4:43 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>If the code sample you show is accurate then the AF_INET6 block isn&#8217;t being executed unless AF_INET4 and AF_INET6 happen to have the same value. So the bug isn&#8217;t quite what you described. Although the missing break is the cause, what is happening is a bit more subtle. (Unless I&#8217;m missing something. Haven&#8217;t done C in a while.) </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33551"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33551={"id":7238218,"unique_id":"wp-comment-33551","title":"If%20the%20code%20sample%20you%20show%20is%20accurate%20then%20the%20AF_INET6%20block%20isn%26%23039%3Bt%20being%20executed%20unless%20AF_INET4%20and%20AF_INET6%20happen%20to%20have%20the%20same%20value.%20So%20the%20bug%20isn%26%23039%3Bt%20quite%20what%20you%20described.%20Althoug%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33551","item_id":"_comm_33551"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33551#respond' data-commentid="33551" data-postid="167271" data-belowelement="div-comment-33551" data-respondelement="respond" data-replyto="Reply to Christy Nicol" aria-label='Reply to Christy Nicol'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-33553" class="comment even depth-2">
			<article id="div-comment-33553" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/8082cfc89ffe2f627aedceb3f1247b8c?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8082cfc89ffe2f627aedceb3f1247b8c?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Christy Nicol</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33553"><time datetime="2012-05-23T16:51:43+01:00">May 23, 2012 at 4:51 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Oh wow I suppressed how non-intuitive the C switch statement is. What a great language feature. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33553"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33553={"id":7238218,"unique_id":"wp-comment-33553","title":"Oh%20wow%20I%20suppressed%20how%20non-intuitive%20the%20C%20switch%20statement%20is.%20What%20a%20great%20language%20feature.%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33553","item_id":"_comm_33553"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33553#respond' data-commentid="33553" data-postid="167271" data-belowelement="div-comment-33553" data-respondelement="respond" data-replyto="Reply to Christy Nicol" aria-label='Reply to Christy Nicol'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-33554" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-33554" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/c0a60bbeee9ead9a4630a3d4c2cf9a82?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c0a60bbeee9ead9a4630a3d4c2cf9a82?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Cogito</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33554"><time datetime="2012-05-23T17:13:28+01:00">May 23, 2012 at 5:13 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Ubuntu is part of the Debian family of distributions. Does that make members of the Ubuntu family part of the Debian family too? </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33554"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33554={"id":7238218,"unique_id":"wp-comment-33554","title":"Ubuntu%20is%20part%20of%20the%20Debian%20family%20of%20distributions.%20Does%20that%20make%20members%20of%20the%20Ubuntu%20family%20part%20of%20the%20Debian%20family%20too%3F%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33554","item_id":"_comm_33554"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33554#respond' data-commentid="33554" data-postid="167271" data-belowelement="div-comment-33554" data-respondelement="respond" data-replyto="Reply to Cogito" aria-label='Reply to Cogito'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-33605" class="comment even depth-2">
			<article id="div-comment-33605" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/441e7fae6894199e8fc3025efb70919d?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/441e7fae6894199e8fc3025efb70919d?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33605"><time datetime="2012-05-23T23:01:19+01:00">May 23, 2012 at 11:01 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Do you mean distros like Lubuntu and Kubuntu? (Officially-recognised Ubuntu variants with different window managers.) </p>
<p>If so, I guess so.  </p>
<p>I think the best way of describing the relationship, lest Ubuntu be thought a superset of Debian (i.e. it has all Debian&#039;s benefits, and more) is to say, &quot;Ubuntu variants are derived from Debian. But Ubuntu != Debian.&quot; </p>
<p>Try this graphical family tree of Linux distroland&#8230;<br />
  <a href="http://upload.wikimedia.org/wikipedia/commons/8/8c/Gldt.svg" rel="nofollow">http://upload.wikimedia.org/wikipedia/commons/8/8&#8230;</a> </p>
<p>If the compilers of this are to be believed, most Linuxes are part of just three tribes:  Debian, Red Hat and Slackware. (And Slackware, of course, comes from the very first ever distro, Softlanding Linux System, or SLS.) </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33605"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33605={"id":7238218,"unique_id":"wp-comment-33605","title":"Do%20you%20mean%20distros%20like%20Lubuntu%20and%20Kubuntu%3F%20%28Officially-recognised%20Ubuntu%20variants%20with%20different%20window%20managers.%29%20%20If%20so%2C%20I%20guess%20so.%20%20%20I%20think%20the%20best%20way%20of%20describing%20the%20relationship%2C%20le%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33605","item_id":"_comm_33605"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33605#respond' data-commentid="33605" data-postid="167271" data-belowelement="div-comment-33605" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-33721" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-33721" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/41bb782fd6d8ff2c5067be7cf3f5081e?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/41bb782fd6d8ff2c5067be7cf3f5081e?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Elliott</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-33721"><time datetime="2012-05-24T15:13:03+01:00">May 24, 2012 at 3:13 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>A possibly unexpected side-effect of this column&#8230; I usually understand xkcd but that one had me stumped. Thanks for the explanation. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_33721"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_33721={"id":7238218,"unique_id":"wp-comment-33721","title":"A%20possibly%20unexpected%20side-effect%20of%20this%20column...%20I%20usually%20understand%20xkcd%20but%20that%20one%20had%20me%20stumped.%20Thanks%20for%20the%20explanation.%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-33721","item_id":"_comm_33721"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=33721#respond' data-commentid="33721" data-postid="167271" data-belowelement="div-comment-33721" data-respondelement="respond" data-replyto="Reply to Elliott" aria-label='Reply to Elliott'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-5058762" class="comment even thread-even depth-1">
			<article id="div-comment-5058762" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/cd03d857de83f57022d567bcbd006c64?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/cd03d857de83f57022d567bcbd006c64?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Oscar Penaloza Cabanzo</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#comment-5058762"><time datetime="2018-04-26T19:47:31+01:00">April 26, 2018 at 7:47 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I understand that sudo is insecure, unless you keep the libraries you use up-to-date. How to show a client that sudo is unsafe and should use RBAC in AIX.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_5058762"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_5058762={"id":7238218,"unique_id":"wp-comment-5058762","title":"I%20understand%20that%20sudo%20is%20insecure%2C%20unless%20you%20keep%20the%20libraries%20you%20use%20up-to-date.%20How%20to%20show%20a%20client%20that%20sudo%20is%20unsafe%20and%20should%20use%20RBAC%20in%20AIX.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/05\/21\/anatomy-of-a-security-hole-the-break-that-broke-sudo\/#comment-5058762","item_id":"_comm_5058762"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/?replytocom=5058762#respond' data-commentid="5058762" data-postid="167271" data-belowelement="div-comment-5058762" data-respondelement="respond" data-replyto="Reply to Oscar Penaloza Cabanzo" aria-label='Reply to Oscar Penaloza Cabanzo'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">What do you think? <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2012/05/21/anatomy-of-a-security-hole-the-break-that-broke-sudo/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://nakedsecurity.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='167271' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="4108a1946c" /></p><input type="hidden" id="ak_js" name="ak_js" value="159"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->
		<div class="comments-widget-area">
					</div>
	
	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	

	<section class="recommended-panel">
	<div class="container">
	<div class="panel-content ">

		<h3 class="block-title">Recommended reads</h3>
	<div class="blocks">
		<article id="post-547402" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/02/25/s3-ep21-cryptomining-clampdown-the-100-ton-man-and-scamclub-ads-podcast/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/11/nean-with-mic-wt-bluer-1200.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Feb</span><span class="day">25</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">3</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/02/25/s3-ep21-cryptomining-clampdown-the-100-ton-man-and-scamclub-ads-podcast/" rel="bookmark">S3 Ep21: Cryptomining clampdown, the 100-ton man, and ScamClub ads [Podcast]</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-544685" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/01/26/ghost-hack-criminals-use-deceased-employees-account-to-wreak-havoc/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/01/gs-1200.jpg?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Jan</span><span class="day">26</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">4</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/01/26/ghost-hack-criminals-use-deceased-employees-account-to-wreak-havoc/" rel="bookmark">Ghost hack &#8211; criminals use deceased employee&#8217;s account to wreak havoc</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-544987" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/02/01/naked-security-live-what-if-my-password-manager-gets-hacked/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/10/nslive-1200-3.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Feb</span><span class="day">01</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">30</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/02/01/naked-security-live-what-if-my-password-manager-gets-hacked/" rel="bookmark">Naked Security Live &#8211; What if my password manager gets hacked?</a></h3>	</div>
</article> <!-- .card-article -->
	</div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="footer-container">
			<a href="#" class="js-collapse-footer"><svg style="height: 20px" viewBox="0 0 132 24" class="block icon sophos"><use xlink:href="#sophos"></use></svg></a>
			<div id="collapseFooter" class="blocks">
				<div class="sophos block">
					<ul id="menu-footer-primary" class="primary menu"><li id="menu-item-306737" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306737"><a href="https://nakedsecurity.sophos.com/about/">About Naked Security</a></li>
<li id="menu-item-306754" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306754"><a href="https://www.sophos.com/en-us/company.aspx">About Sophos</a></li>
<li id="menu-item-306747" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306747"><a href="https://nakedsecurity.sophos.com/send-us-a-tip/">Send us a tip</a></li>
<li id="menu-item-323171" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323171"><a href="/cookies-and-scripts/">Cookies</a></li>
<li id="menu-item-323170" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323170"><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
<li id="menu-item-323169" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323169"><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
</ul>				</div>
										<div class="news block">
							<ul id="menu-products-column-one" class="small menu"><li id="menu-item-306998" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306998"><a href="https://www.sophos.com/en-us/products/intercept-x.aspx">Intercept X</a></li>
<li id="menu-item-440801" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440801"><a href="https://www.sophos.com/en-us/products/server-security.aspx">Intercept X for Server</a></li>
<li id="menu-item-440802" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440802"><a href="https://www.sophos.com/en-us/products/mobile-control.aspx">Intercept X for Mobile</a></li>
</ul>						</div>
											<div class="products block">
							<ul id="menu-products-column-two" class="small menu"><li id="menu-item-440803" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440803"><a href="https://www.sophos.com/en-us/products/next-gen-firewall.aspx">XG Firewall</a></li>
<li id="menu-item-440805" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440805"><a href="https://www.sophos.com/en-us/products/sophos-email.aspx">Sophos Email</a></li>
<li id="menu-item-440804" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440804"><a href="https://www.sophos.com/en-us/products/secure-wifi.aspx">Sophos Wireless</a></li>
</ul>						</div>
											<div class="threats block">
							<ul id="menu-server-protection" class="small menu"><li id="menu-item-440806" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440806"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx">Managed Threat Response</a></li>
<li id="menu-item-448404" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-448404"><a href="https://www.sophos.com/en-us/products/cloud-optix.aspx">Cloud Optix</a></li>
<li id="menu-item-440807" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440807"><a href="https://www.sophos.com/en-us/products/phish-threat.aspx">Phish Threat</a></li>
</ul>						</div>
								</div>
			<ul class="block social footer">
				<li class="twitter"><a rel="nofollow" href="https://twitter.com/NakedSecurity" title="Follow our team of security experts on Twitter"><svg style="height: 14px" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
				<li class="facebook"><a rel="nofollow" href="https://www.facebook.com/SophosSecurity" title="Join over 250,000 people in our Facebook community"><svg style="height: 14px" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
				<li class="instagram"><a rel="nofollow" href="https://www.instagram.com/nakedsecurity/" title="Follow Naked Security on Instagram"><svg style="height: 14px" viewBox="0 0 100 100" class="icon instagram"><use xlink:href="#instagram"></use></svg></a></li>
				<li class="linkedin"><a rel="nofollow" href="https://www.linkedin.com/company/5053/" title="Join the naked security discussion group on LinkedIn"><svg style="height: 14px" viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
				<li class="rss"><a rel="nofollow" href="/feed" title="Subscribe to our RSS feed"><svg style="height: 14px" viewBox="0 0 100 100" class="icon rss"><use xlink:href="#rss"></use></svg></a></li>
			</ul>

							<div class="vip-powered-wpcom">
					<span class="copyright">© 1997 - 2021 Sophos Ltd.</span>
					All rights reserved.
					Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=nakedsecurity.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>				</div>
					</div>
		<script type="text/javascript">
			window.cookieconsent_options = {
				"message":"This site uses cookies. By continuing to browse the site you are agreeing to our use of cookies.",
				"dismiss":"Got it!",
				"learnMore":"Learn More",
				"link":"/cookies-and-scripts",
				"theme":"https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/css/sophos.css"};
		</script>
	</footer><!-- #colophon -->
</div><!-- #page -->
<div id="survey-wrapper" class="mfp-hide"><div class="pd-embed" id="pd_1499706777" data-settings=""></div></div>
<script id='child-js-plugins-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"0","nextLink":""};
</script>
<script id='child-js-core-js-extra'>
var Sophos = {"ajaxurl":"https:\/\/nakedsecurity.sophos.com\/wp-admin\/admin-ajax.php","nonce":"64f6810f0c"};
</script>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJyNjkEKwjAQRS9kOo2YggvxKGLT0SZmJiGTULx9Q7HgwoXL+f89/sCSlI1ckAuUGQkFJKY5CuMi6thrA14ghfp0LJ2XA/wl2Jhxpx3bUKfGbTlRM1XGFN4dOf4FtRNpxOm73yepqs8zcH85ISxway48YqbGXumiB21OQ2/02a8RfU9z'></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161173',post:'167271',tz:'0',srv:'nakedsecurity.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161173', '167271' ]);
</script>
</body>
</html>
