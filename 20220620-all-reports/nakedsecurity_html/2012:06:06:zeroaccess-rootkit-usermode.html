<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="RHQeasQqjasbRt5asY6atZYbs5tr10gFBevDt2HRhW0" />
<link rel="pingback" href="https://nakedsecurity.sophos.com/xmlrpc.php">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5VK6LTK');</script>
<!-- End Google Tag Manager -->

<meta name="description" content="The ZeroAccess rootkit, which hijacks PCs and recruits them into a botnet, has undergone a significant revision - SophosLabs researcher James Wyke reveals." />
<meta name="keywords" content="botnet, malware, sophoslabs, bot, botnet, malware, p2p, rootkit, sirefef, zeroaccess" />
<title>Major shift in strategy for ZeroAccess rootkit malware, as it shifts to user-mode &#8211; Naked Security</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="I9dHFo-YhnK2MfAHn-20V4GnWrOttVUYyISGamyU41M" />
<meta name="msvalidate.01" content="7D8D1FA2892142B1543D2CBCD07FB88F" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Feed" href="https://nakedsecurity.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Comments Feed" href="https://nakedsecurity.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Major shift in strategy for ZeroAccess rootkit malware, as it shifts to user-mode Comments Feed" href="https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/feed/" />
<link rel='stylesheet' id='all-css-0' href='https://nakedsecurity.sophos.com/_static/??-eJyVz00OwiAQhuELCSM1mLgwnoXCRFD+wgxpevvS2J0bXU7yPsk3sFQRso3dIYElAheIYY7FvkUMczNtBeI1okwhyxGcYAhbMmNmYI9pOCrVF8q4kJjOSh/gn1hEw0j8q9mHGifZNzQsfB9xkybVL5+6qLE/QyZ4IVczvrrJjz/unTzSXV2VvkxKa70BdwtjDg==' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqWkWAK9EIho='></script>
<link rel="https://api.w.org/" href="https://nakedsecurity.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://nakedsecurity.sophos.com/wp-json/wp/v2/posts/169337" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://nakedsecurity.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://nakedsecurity.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/" />
<link rel='shortlink' href='https://nakedsecurity.sophos.com/?p=169337' />
<link rel="alternate" type="application/json+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2012%2F06%2F06%2Fzeroaccess-rootkit-usermode%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2012%2F06%2F06%2Fzeroaccess-rootkit-usermode%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Major shift in strategy for ZeroAccess rootkit malware, as it shifts to user-mode" />
<meta property="og:url" content="https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/" />
<meta property="og:description" content="The ZeroAccess rootkit, which hijacks PCs and recruits them into a botnet, has undergone a significant revision &#8211; SophosLabs researcher James Wyke reveals." />
<meta property="article:published_time" content="2012-06-06T11:06:38+00:00" />
<meta property="article:modified_time" content="2012-10-15T09:51:47+00:00" />
<meta property="og:site_name" content="Naked Security" />
<meta property="og:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/computer-malware-thumb.jpg?w=250" />
<meta property="og:image:secure_url" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/computer-malware-thumb.jpg?w=250" />
<meta property="og:image:width" content="250" />
<meta property="og:image:height" content="250" />
<meta property="og:image:alt" content="Major shift in strategy for ZeroAccess rootkit malware, as it shifts to user-mode" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@NakedSecurity" />
<meta name="twitter:text:title" content="Major shift in strategy for ZeroAccess rootkit malware, as it shifts to user-mode" />
<meta name="twitter:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/computer-malware-thumb.jpg?w=144" />
<meta name="twitter:image:alt" content="Major shift in strategy for ZeroAccess rootkit malware, as it shifts to user-mode" />
<meta name="twitter:card" content="summary" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=270" />
</head>
<body class="post-template-default single single-post postid-169337 single-format-standard" >
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VK6LTK"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div style="display: none">
<svg>
	<symbol id="sophos" viewBox="0 0 132 24">
		<path d="m111.82 22.176h11.64c3.267 0 4.65-0.2 5.74-0.896 1.715-1.063 2.804-3.26 2.804-5.62 0-1.928-0.658-3.89-1.647-4.888-1.288-1.33-3.035-1.828-6.271-1.828h-3.527c-1.586 0-2.754-0.067-3.412-0.365-0.794-0.367-1.256-1.165-1.256-2.161 0-1.165 0.56-2.03 1.486-2.264 0.692-0.163 1.498-0.163 3.574-0.198h10.419v-3.956h-11.473c-2.574 0-3.727 0.099-4.718 0.466-2.279 0.796-3.828 3.257-3.828 6.083 0 1.93 0.76 3.727 2.079 4.89 1.155 0.996 2.872 1.462 5.51 1.462h4.697c1.057 0 1.915 0.132 2.376 0.398 0.893 0.433 1.418 1.328 1.418 2.36 0 0.864-0.395 1.597-1.087 2.027-0.561 0.369-1.517 0.534-3.268 0.534h-11.256zm-111.35 0h11.64c3.267 0 4.652-0.2 5.741-0.896 1.714-1.063 2.803-3.26 2.803-5.62 0-1.928-0.66-3.89-1.65-4.888-1.285-1.33-3.034-1.828-6.27-1.828h-3.527c-1.584 0-2.751-0.067-3.41-0.365-0.792-0.367-1.253-1.165-1.253-2.161 0-1.165 0.56-2.03 1.484-2.264 0.693-0.163 1.496-0.163 3.574-0.198h10.42v-3.956h-11.477c-2.573 0-3.727 0.099-4.715 0.466-2.278 0.796-3.83 3.257-3.83 6.083 0 1.93 0.762 3.727 2.08 4.89 1.155 0.996 2.871 1.462 5.51 1.462h4.696c1.057 0 1.913 0.132 2.377 0.398 0.888 0.433 1.416 1.328 1.416 2.36 0 0.864-0.394 1.597-1.089 2.027-0.558 0.369-1.517 0.534-3.264 0.534h-11.256v3.956zm94.05-16.18c-0.68 1.076-1.003 2.803-1.003 5.122 0 5.088 1.747 7.405 5.63 7.405 3.822 0 5.568-2.317 5.568-7.34 0-5.092-1.715-7.373-5.568-7.373-2.102 0-3.754 0.784-4.627 2.186zm13.174-2.511c1.329 1.761 2.072 4.63 2.072 7.992 0 3.816-1.197 6.948-3.334 8.677-1.619 1.304-4.078 2.022-6.995 2.022-4.142 0-7.41-1.372-9.092-3.817-1.263-1.793-1.88-4.176-1.88-7.08 0-4.172 1.133-7.339 3.27-9.035 1.682-1.37 4.339-2.122 7.383-2.122 3.85 0 6.925 1.209 8.576 3.363zm-22.018-3.068h-4.596v8.908h-8.319v-8.908h-4.597v21.759h4.597v-8.97h8.318v8.97h4.596v-21.759zm-28.61 10.277c1.23 0 1.941-0.163 2.427-0.62 0.581-0.49 0.938-1.533 0.938-2.74 0-1.436-0.58-2.478-1.584-2.838-0.356-0.13-0.94-0.197-1.684-0.197h-6.344v6.395zm-6.247 11.481h-4.598v-21.758h10.78c3.786 0 5.114 0.39 6.538 1.991 1.264 1.37 1.942 3.163 1.942 5.088 0 2.284-0.904 4.404-2.394 5.676-1.262 1.077-2.43 1.402-4.888 1.402h-7.38zm-22.589-16.179c-0.682 1.076-1.004 2.803-1.004 5.122 0 5.088 1.748 7.405 5.634 7.405 3.818 0 5.568-2.317 5.568-7.34 0-5.092-1.716-7.373-5.568-7.373-2.106 0-3.757 0.784-4.63 2.186zm13.174-2.511c1.328 1.761 2.073 4.63 2.073 7.992 0 3.816-1.2 6.948-3.335 8.677-1.618 1.304-4.079 2.022-6.993 2.022-4.144 0-7.413-1.372-9.096-3.817-1.264-1.793-1.878-4.176-1.878-7.08 0-4.172 1.133-7.339 3.272-9.035 1.681-1.37 4.337-2.122 7.38-2.122 3.851 0 6.93 1.209 8.578 3.363z"></path>
	</symbol>
	<symbol id="twitter" viewBox="0 0 24 24">
 		<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path>
 	</symbol>
	<symbol id="facebook" viewBox="0 0 24 24">
 		<path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path>
 	</symbol>
	<symbol id="instagram" viewBox="0 0 24 24">
		<path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path>
	</symbol>
	<symbol id="linkedin" viewBox="0 0 24 24">
		<path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"></path>
	</symbol>
	<symbol id="rss" viewBox="0 0 24 24">
		<path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"></path>
	</symbol>
	<symbol id="reddit" viewBox="0 0 24 24">
		<path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"></path>
	</symbol>
</svg>
</div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header variation variation-3" role="banner">
		<div class="header-container">
			<div class="site-branding">
				<div class="site-title">
					<a title="Naked Security" href="https://nakedsecurity.sophos.com/" rel="home"><img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/naked-security-logo-white@2x.png"></a>
					by
					<a title="sophos.com" href="https://www.sophos.com"><svg viewBox="0 0 132 24" class="icon sophos"><use xlink:href="#sophos"></use></svg></a>
				</div>
			</div><!-- .site-branding -->
			<nav id="site-navigation" class="main-navigation" role="navigation">
				<div class="container">
					<ul id="menu-variation-two" class="exit-links menu"><li id="menu-item-436509" class="products menu-item menu-item-type-custom menu-item-object-custom menu-item-436509"><a href="#">Products</a></li>
<li id="menu-item-436515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436515"><a href="https://www.sophos.com/en-us/products/free-tools.aspx">Free Tools</a></li>
<li id="menu-item-436531" class="search-toggle menu-item menu-item-type-custom menu-item-object-custom menu-item-436531"><a href="#">Search</a></li>
<li id="menu-item-436532" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436532"><a href="https://home.sophos.com/en-us.aspx">Free Sophos Home</a></li>
</ul>				</div>
			</nav><!-- #site-navigation -->
			<div class="site-search-block">
	<form target="_top" role="search" class="search-form" method="get" action="https://nakedsecurity.sophos.com/">
        <fieldset>
            <div class="field">
				<input type="search" value="" name="s" class="search-field" placeholder="Search naked security...">
            </div>
            <div class="submit">
				<button type="submit" class="search-submit button">Go</button>
            </div>
        </fieldset>
    </form>
</div>
		</div><!-- .container -->
	</header>

	<div class="responsive-flyout-panel small-12 column active" style="opacity: 1; display: none;">
		<div class="modal-filler"></div>
	    <div class="productNavBox">
	        <div class="productNavContainer">
	            <div class="row prodRow">
	                <div class="prodListBox column large-9">
	                    <div class="row margin-0 highlightProduct">
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/next-gen-firewall.aspx"><img src="https://www.sophos.com/medialibrary/2F4785DE8C3F43ECBD699A18F332FEEB.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">XG Firewall</div>
	                                	<div class="menu-section-subtitle">Next-Gen Firewall</div>
									</div>
	                            </a>
	                        </div>
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/intercept-x.aspx"><img src="https://www.sophos.com/medialibrary/27111765D65A45D49A232925D2CE428B.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">Intercept X</div>
	                                	<div class="menu-section-subtitle">Next-Gen Endpoint</div>
									</div>
	                            </a>
	                        </div>
	                    </div>
	                    <div class="productList">
	                        <ul>
								<li>
									<a href="https://www.sophos.com/en-us/products/cloud-optix.aspx"><img src="https://www.sophos.com/medialibrary/SophosNext/Images/Products/Icons/sophos-cloud-optix-icon.svg">Sophos Cloud Optix</a>
								</li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-central.aspx"><img src="https://www.sophos.com/medialibrary/08EA66123F1B4DDE8FE5C9B578A7FAA7.ashx">Sophos Central</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/mobile-control.aspx"><img src="https://www.sophos.com/medialibrary/678FE994855047739F50D6C411184FA6.ashx">Sophos Mobile</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/server-security.aspx"><img src="https://www.sophos.com/medialibrary/01B80E7D7CD54EF8AC2E51C9C6EC0236.ashx">Intercept X for Server</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-wifi.aspx"><img src="https://www.sophos.com/medialibrary/BEBD9C41BB4E480498514B29B92A145A.ashx">Secure Wi-Fi</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/phish-threat.aspx"><img src="https://www.sophos.com/medialibrary/DC9D1A7BA3964B0C9DAF1F1E68806B5A.ashx">Phish Threat</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/safeguard-encryption.aspx"><img src="https://www.sophos.com/medialibrary/8F51F06B62814B108D3B2763FF018E37.ashx">SafeGuard Encryption</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-email.aspx"><img src="https://www.sophos.com/medialibrary/597ADA0AF01A4A12B2B27239D0F9992C.ashx">Secure Email</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/unified-threat-management.aspx"><img src="https://www.sophos.com/medialibrary/8CB72BF5E1AD41F7894CE5E42101B0F3.ashx">SG UTM</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-web-gateway.aspx"><img src="https://www.sophos.com/medialibrary/C586E372694547A1B207A61D87246BA7.ashx">Secure Web Gateway</a>
	                            </li>
	                        </ul>
	                    </div>
	                </div>
	                <div class="homeUserBox column large-3">
						<img src="https://www.sophos.com/medialibrary/3376DF5742A64AEE93FDB9DCA7291239.ashx">
						<div class="menu-section-title">For Home Users</div>
	                    <p>Sophos Home protects every Mac and PC in your home </p><a href="https://home.sophos.com/" target="_blank" class="greenSmallMenuBtn">Learn More</a>
					</div>
	            </div>
	            <div class="row blueRow">
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-tools.aspx"><img width="19" src="https://www.sophos.com/medialibrary/A1FF440D2BB84511B8C94D771D44E207.ashx">Free Security Tools</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-trials.aspx"><img width="20" src="https://www.sophos.com/medialibrary/FCD3410ED2C347808D9DB8AC12C62DBD.ashx">Free Trials</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/demos.aspx"><img width="18" src="https://www.sophos.com/medialibrary/50985180E5F54C94917A2A6508E24287.ashx">Product Demos</a>
	                </div>
	                <!-- <div class="column large-3 medium-6">
	                    <a href="javascript:fairfax.openLiveChatFromFlyoutLink();" class="flyout-live-chat-link"><img width="20" src="https://www.sophos.com/medialibrary/E24C5050837145F6A5C592E299BA2A0D.ashx">Live Sales Chat</a>
	                </div> -->
	            </div>
	        </div>
	    </div>
	</div>
	<script>

	jQuery(document).ready( function () {
		var productButton   = jQuery('nav .menu-item.products');
		var modalBackground = jQuery('.modal-filler');
		var flyoutMenu		= jQuery('.responsive-flyout-panel');
		var Sophos			= Sophos || {};

		Sophos.MenuTest = {};

		Sophos.MenuTest.open = function () {
				productButton.addClass('open');
				flyoutMenu.show();
				modalBackground.show();
		};

		Sophos.MenuTest.close = function () {
			productButton.removeClass('open');
			flyoutMenu.hide();
			modalBackground.hide();
		};

		Sophos.MenuTest.toggle = function () {
			if ( productButton.hasClass('open') ) {
				Sophos.MenuTest.close();
			} else {
				Sophos.MenuTest.open();
			}
		};

		productButton.click( Sophos.MenuTest.toggle );
		modalBackground.click( Sophos.MenuTest.close );
	});

	</script>

	
	<section class="about-panel">
	<div class="container">
	<div class="panel-content ">

		<div class="description"><span>Have you listened to our podcast? <a href="/podcast/">Listen now</a></span></div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	<div id="content" class="site-content">
		<div class="content-container">

</div> <!-- .container -->
</div> <!-- #content -->


	<section class="content-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

		<main id="main" class="site-main" role="main">

	
		
<article id="post-169337" class="post-169337 post type-post status-publish format-standard has-post-thumbnail hentry category-botnet-malware category-featured category-malware category-sophoslabs tag-bot tag-botnet tag-malware tag-p2p tag-rootkit tag-sirefef tag-zeroaccess">

	<header class="entry-header">
		<h1 class="entry-title">Major shift in strategy for ZeroAccess rootkit malware, as it shifts to user-mode</h1>		<div class="entry-meta">
			<div>
				
	<span class="entry-published">
		<time class="entry-date published" datetime="2012-06-06T12:06:38+01:00">06 Jun 2012</time>
	</span>

					<a href="#comments" class="comment-box">
					<span class="count">12</span>
				</a>
					
	<span class="entry-categories">
	<a href="https://nakedsecurity.sophos.com/category/security-threats/malware/botnet-malware/">Botnet</a>, <a href="https://nakedsecurity.sophos.com/category/security-threats/malware/">Malware</a>, <a href="https://nakedsecurity.sophos.com/category/sophoslabs/">SophosLabs</a>	</span>

			</div>
	</header> <!-- .entry-header -->

    <div id="newsletter-signup" class="container top"></div>

			<div class="entry-featured-image">
			<img width="250" height="250" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/computer-malware-thumb.jpg?w=250&amp;h=250&amp;crop=1" class="attachment-hero-thumbnail size-hero-thumbnail wp-post-image" alt="Major shift in strategy for ZeroAccess rootkit malware, as it shifts to user-mode" loading="lazy" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/computer-malware-thumb.jpg 250w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/computer-malware-thumb.jpg?resize=150,150 150w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/computer-malware-thumb.jpg?resize=225,225 225w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/computer-malware-thumb.jpg?resize=70,70 70w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/computer-malware-thumb.jpg?resize=32,32 32w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/computer-malware-thumb.jpg?resize=50,50 50w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/computer-malware-thumb.jpg?resize=64,64 64w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/computer-malware-thumb.jpg?resize=96,96 96w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/computer-malware-thumb.jpg?resize=128,128 128w" sizes="(max-width: 250px) 100vw, 250px" />					</div> <!-- .entry-featured-image -->
		
		<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2012/06/06/facebook-burglars/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> Burglars notify Brooklyn police of crimes via Facebook status updates</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2012/06/06/google-state-sponsored-attackers-may-be-attempting-to-compromise-your-account/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Google: &#8220;State-sponsored attackers may be attempting to compromise your account&#8221;</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	<div class="entry-content">
		<div class="entry-prefix">
			<div class="entry-author">
				
	
					<span class="by">by</span>
			<a href="https://nakedsecurity.sophos.com/author/james-wyke/" title="Posts by James Wyke" class="author url fn" rel="author">James Wyke</a>		
	
				</div>
			<div class="entry-sharing">
				
	<ul class="block social share">
		<li class="facebook"><a href="https://www.facebook.com/share.php?u=https%3A%2F%2Fnakedsecurity.sophos.com%2F2012%2F06%2F06%2Fzeroaccess-rootkit-usermode%2F&title=Major+shift+in+strategy+for+ZeroAccess+rootkit+malware%2C+as+it+shifts+to+user-mode" data-title="Major shift in strategy for ZeroAccess rootkit malware, as it shifts to user-mode" title="Share on Facebook"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
		<li class="twitter"><a href="https://twitter.com/intent/tweet?text=Major+shift+in+strategy+for+ZeroAccess+rootkit+malware%2C+as+it+shifts+to+user-mode+https%3A%2F%2Fnakedsecurity.sophos.com%2F%3Fp%3D169337" data-title="Major shift in strategy for ZeroAccess rootkit malware, as it shifts to user-mode" title="Share on Twitter"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
		<li class="linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2012%2F06%2F06%2Fzeroaccess-rootkit-usermode%2F&title=Major+shift+in+strategy+for+ZeroAccess+rootkit+malware%2C+as+it+shifts+to+user-mode" data-title="Major shift in strategy for ZeroAccess rootkit malware, as it shifts to user-mode" title="Share on LinkedIn"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
		<li class="reddit"><a href="https://reddit.com/submit/?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2012%2F06%2F06%2Fzeroaccess-rootkit-usermode%2F&title=Major+shift+in+strategy+for+ZeroAccess+rootkit+malware%2C+as+it+shifts+to+user-mode" title="Share on Reddit"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon reddit"><use xlink:href="#reddit"></use></svg></a></li>

			</ul>

				</div>
		</div>
		<p><img src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2012/06/computer-malware-1701.jpg" align="right" vspace="10" hspace="10" alt="Artistic interpretation of computer malware. Image courtesy of Shutterstock" title="Artistic interpretation of computer malware. Image courtesy of Shutterstock"></img>SophosLabs has been monitoring a new strain of the infamous <a href="http://nakedsecurity.sophos.com/2012/04/11/technical-paper-the-zeroaccess-rootkit-under-the-microscope/" title="Technical paper: The ZeroAccess rootkit under the microscope">ZeroAccess rootkit</a> that has been hitting the internet over the last few weeks.</p>
<p>ZeroAccess is a sophisticated kernel-mode rootkit that enslaves victim PCs, adding them to a peer-to-peer botnet from which they receive commands to download other malware. The rootkit has undergone several revisions since its inception but this new version represents a major shift in strategy.</p>
<p>All previous versions have employed a kernel-mode component on 32-bit Windows. However, under 64-bit Windows there was no kernel-mode component &#8211; ZeroAccess operated entirely in user-mode memory.</p>
<p>And operating entirely in user-mode is exactly the shift in strategy that this new version employs.</p>
<p>ZeroAccess no longer has any kernel-mode component. Instead, a DLL is loaded into services.exe and explorer.exe and all functionality is performed inside those processes.</p>
<p>The previous generation of ZeroAccess would maintain reboot persistence by overwriting a Windows driver. This version uses the registry to ensure it will start again at the next boot.</p>
<p>ZeroAccess will create two files on an infected machine, either of which can launch the Trojan:</p>
<blockquote><p><tt>%WINDOWS%\installer\{GUID}\n</tt></p>
<p><tt>%profile%\local settings\application data\{GUID}\n</tt>
</p></blockquote>
<p>These two files are launched through the registry by hijacking an existing COM object and by abusing the load order of user COM objects under Windows.</p>
<p>The first file is launched by hijacking a COM object associated with WMI. The following registry entry is changed so that the malicious ZeroAccess DLL is loaded in place of the legitimate wbemess.dll:</p>
<blockquote><p>
<tt>HKCR\CLSID\{F3130CDB-AA52-4C3A-AB32-85FFC23AF9C1}\InprocServer32</tt>
</p></blockquote>
<p>Correct value:</p>
<blockquote><p>
<tt>%systemroot%\system32\wbem\wbemess.dll</tt>
</p></blockquote>
<p>Hijacked value:</p>
<blockquote><p>
<tt>\\.\globalroot\systemroot\Installer\{e051c979-bddd-5d1f-8953-4b8c940e9b4d}\n.</tt>
</p></blockquote>
<p>The second file is launched by creating the following COM object:</p>
<blockquote><p>
<tt>HKCU\Software\Classes\clsid\{42aedc87-2188-41fd-b9a3-0c966feabec1}</tt>
</p></blockquote>
<p>This object points to the file at:</p>
<blockquote><p>
<tt>%profile%\local settings\application data\{GUID}\n</tt>
</p></blockquote>
<p>This will ensure that the DLL is loaded because a legitimate COM object exists at:</p>
<blockquote><p>
<tt>HKCR\clsid\{42aedc87-2188-41fd-b9a3-0c966feabec1}</tt>
</p></blockquote>
<p>This COM object belongs to MruPidlList which will load shell32.dll on Windows 7 and shdocvm.dll on Windows XP.</p>
<p>Because the COM object that ZeroAccess creates is a user object, Windows will load it before the legitimate object located in the registry under HKCR. The real benefit of this approach is that it will work under both 32 and 64-bit versions of Windows.</p>
<p>The peer-to-peer protocol used by the ZeroAccess botnet has also changed. Previously all communications were RC4 encrypted using a fixed key. That has now changed. The main encryption algorithm used is now much simpler, DWORD XOR is applied with a key that is adjusted on each round:</p>
<p><img src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2012/06/rol-loop.png" title="rol loop" alt="rol loop" /></p>
<p>The actual commands involved in the protocol have been slightly modified too.</p>
<p>The previous version would start by issuing a &#8216;getL&#8217; command to each peer contained in its bootstrap file of peers. The command is issued over TCP and usually to one of ports 22292, 34354, 34355, 21810.</p>
<p>The remote machine would then respond with a &#8216;retL&#8217; command that contained its own list of peers and a listing of files that the bot has downloaded. The new bot would then check the list of files and download any new files by issuing a &#8216;getF&#8217; command. These files are signed with a 512 bit RSA key:</p>
<p><img src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2012/06/oldfileret2.png" title="old filer" alt="old filer" /></p>
<p>The new version also starts by issuing a &#8216;getL&#8217; command. But this time the command is sent out over UDP, the port numbers being used are different and the structure of the command header has changed.</p>
<p>The remote peer still sends back a &#8216;retL&#8217; command, this time over UDP and this time the file information is accompanied by a signature produced by a new 1024 bit RSA key. Now, instead of sending a &#8216;getF&#8217; command to the remote peer to retrieve files the local peer doesn&#8217;t already have, the peer simply sends the encrypted file information (filename, length and timestamp value) to the remote peer over TCP on the same port number that the UDP communication took place.</p>
<p>The remote peer then sends back the file encrypted with RC4 and a key derived from the file information:</p>
<p><img src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2012/06/newfileret2.png" title="new filer" alt="new filer" /></p>
<p>This new version of ZeroAccess is being aggressively distributed through the normal mechanisms &#8211; drive by downloads, fake keygens, fake game downloads, and new samples of the old variant have all but dried up.</p>
<p>It&#8217;s clear that the malware&#8217;s authors have decided on a more unified approach to supported platforms and to change the footprint of ZeroAccess both on infected machines and on infected networks.</p>
<p><img src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2012/06/computer-malware-170.jpg" align="right" vspace="10" hspace="10" alt="Artistic interpretation of computer malware. Image courtesy of Shutterstock" title="Artistic interpretation of computer malware. Image courtesy of Shutterstock"></img>This is most likely due to the increased attention that this malware family has been receiving from security companies, but also as more and more people are using 64-bit machines it makes sense for malware authors to focus on that platform, so maintaining a complicated kernel-mode component that only works on 32-bit systems seems less and less cost effective.</p>
<p>The goal of ZeroAccess remains the same: to download further malware onto the infected machine. The types of malware we are seeing downloaded are broadly the same: click fraud and spam bots, although a BitCoin miner has now been added to the mix.</p>
<p>SophosLabs will continue to monitor this threat and protect our customers.  For more background information on ZeroAccess, be sure to read the <a href="http://nakedsecurity.sophos.com/2012/04/11/technical-paper-the-zeroaccess-rootkit-under-the-microscope/" title="Technical paper: The ZeroAccess rootkit under the microscope">technical paper</a> we published earlier this year.</p>

<p style="font-size:80%;width:495px;margin:0;padding:6px 0 6px 5px;">
<p><sub><a href="http://www.shutterstock.com/pic.mhtml?id=73319461">Laptop with red bacteria</a> image courtesy of Shutterstock.</sub></p>
			</div> <!-- .entry-content -->
	<ul class="block social follow">
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon twitter"><use xlink:href="#twitter"></use></svg>
			<p>Follow <strong><a href="https://twitter.com/nakedsecurity">@NakedSecurity on Twitter</a></strong> for the latest computer security news.</p>
		</li>
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon instagram"><use xlink:href="#instagram"></use></svg>
			<p>Follow <strong><a href="https://www.instagram.com/nakedsecurity/">@NakedSecurity on Instagram</a></strong> for exclusive pics, gifs, vids and LOLs!</p>
		</li>
	</ul>
</article><!-- #post-## -->

		<div class="free-tools-block">
			<h2 class="block-title">Free tools</h2>

<div class="ns-free-tools">
	<div class="ns-free-tools__item ns-free-tools__item--sophos-home">
		<a class="ns-free-tools__link" href="https://home.sophos.com/en-us.aspx?cmp=701j0000001eLpnAAE">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/sophos-home@2x.png" alt="Sophos Home" class="ns-free-tools__image" width="166" height="100">
			<h4 class="ns-free-tools__title">
				Sophos Home			</h4>
			<div class="ns-free-tools__sub-title">
				Protect personal PCs and Macs			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--hitman-pro">
		<a class="ns-free-tools__link" href="https://www.hitmanpro.com/en-us/hmp.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/hitman-pro@2x.png" alt="Hitman Pro" class="ns-free-tools__image" width="154" height="100">
			<h4 class="ns-free-tools__title">
				Hitman Pro			</h4>
			<div class="ns-free-tools__sub-title">
				Find and remove malware			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--intercept-x">
		<a class="ns-free-tools__link" href="https://www.sophos.com/en-us/products/free-tools/sophos-mobile-security-free-edition.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/mobile-security-android@2x.png" alt="Sophos Intercept X for Mobile" class="ns-free-tools__image" width="96" height="110">
			<h4 class="ns-free-tools__title">
				Intercept X for Mobile			</h4>
			<div class="ns-free-tools__sub-title">
				Protect Android devices			</div>
		</a>
	</div>
</div>
		</div>

			<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2012/06/06/facebook-burglars/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> Burglars notify Brooklyn police of crimes via Facebook status updates</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2012/06/06/google-state-sponsored-attackers-may-be-attempting-to-compromise-your-account/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Google: &#8220;State-sponsored attackers may be attempting to compromise your account&#8221;</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	
	</main><!-- #main -->

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<section class="comments-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

			
<div id="comments" class="comments-area">

			<h2 class="comments-title">
			12 comments on &ldquo;<span>Major shift in strategy for ZeroAccess rootkit malware, as it shifts to user-mode</span>&rdquo;		</h2>

		<ol class="comment-list">
					<li id="comment-36089" class="comment even thread-even depth-1">
			<article id="div-comment-36089" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/623e580534e4b99279b62779c599d774?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/623e580534e4b99279b62779c599d774?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Gareth Connors</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/#comment-36089"><time datetime="2012-06-06T15:21:55+01:00">June 6, 2012 at 3:21 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>My approach to those who deliberately create such malicious software is search and destroy. I do not mean this only in a virtual sense but also in real world scenarios.<br />
The electron may be as fast as light but the bullet extinguishes the light, permanently. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_36089"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_36089={"id":7238218,"unique_id":"wp-comment-36089","title":"My%20approach%20to%20those%20who%20deliberately%20create%20such%20malicious%20software%20is%20search%20and%20destroy.%20I%20do%20not%20mean%20this%20only%20in%20a%20virtual%20sense%20but%20also%20in%20real%20world%20scenarios.%20The%20electron%20may%20be%20as%20fas%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/06\/06\/zeroaccess-rootkit-usermode\/#comment-36089","item_id":"_comm_36089"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/?replytocom=36089#respond' data-commentid="36089" data-postid="169337" data-belowelement="div-comment-36089" data-respondelement="respond" data-replyto="Reply to Gareth Connors" aria-label='Reply to Gareth Connors'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-36122" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-36122" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/3f5b34e1d4f054c33423cb07a3e2a4df?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3f5b34e1d4f054c33423cb07a3e2a4df?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Nigel</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/#comment-36122"><time datetime="2012-06-06T17:40:56+01:00">June 6, 2012 at 5:40 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks for linking the technical paper article, where it says, &quot;Yes, Sophos Anti-Virus can detect, block and remediate this rootkit and the various malware which uses it.&quot; </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_36122"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_36122={"id":7238218,"unique_id":"wp-comment-36122","title":"Thanks%20for%20linking%20the%20technical%20paper%20article%2C%20where%20it%20says%2C%20%26quot%3BYes%2C%20Sophos%20Anti-Virus%20can%20detect%2C%20block%20and%20remediate%20this%20rootkit%20and%20the%20various%20malware%20which%20uses%20it.%26quot%3B%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/06\/06\/zeroaccess-rootkit-usermode\/#comment-36122","item_id":"_comm_36122"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/?replytocom=36122#respond' data-commentid="36122" data-postid="169337" data-belowelement="div-comment-36122" data-respondelement="respond" data-replyto="Reply to Nigel" aria-label='Reply to Nigel'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-36157" class="comment even thread-even depth-1">
			<article id="div-comment-36157" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/9dad5cb5f427b581be98f17e4ad3b75d?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9dad5cb5f427b581be98f17e4ad3b75d?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Robert Wurzburg</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/#comment-36157"><time datetime="2012-06-06T19:33:34+01:00">June 6, 2012 at 7:33 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Excellent article about a now persistent threat and exploit. Now I can really look for<br />
this on my machines with this information, not that I think it&#039;s present now. </p>
<p>Hopefully we will see countermeasures with the new Malicious Software Removal<br />
Tool to be issued June 12, 2012 as part of this month&#039;s Microsoft Updates, and in<br />
updates to antivirus and antispyware programs from all vendors. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_36157"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_36157={"id":7238218,"unique_id":"wp-comment-36157","title":"Excellent%20article%20about%20a%20now%20persistent%20threat%20and%20exploit.%20Now%20I%20can%20really%20look%20for%20this%20on%20my%20machines%20with%20this%20information%2C%20not%20that%20I%20think%20it%26%23039%3Bs%20present%20now.%20%20Hopefully%20we%20will%20see%20co%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/06\/06\/zeroaccess-rootkit-usermode\/#comment-36157","item_id":"_comm_36157"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/?replytocom=36157#respond' data-commentid="36157" data-postid="169337" data-belowelement="div-comment-36157" data-respondelement="respond" data-replyto="Reply to Robert Wurzburg" aria-label='Reply to Robert Wurzburg'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-36333" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-36333" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">@TigzyRK</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/#comment-36333"><time datetime="2012-06-07T11:42:46+01:00">June 7, 2012 at 11:42 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hello </p>
<p>I saw this version was pushing a PE file into %windir%/Assembly/GAC/Desktop.ini<br />
What for? Have you seen this while reversing your variant? </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_36333"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_36333={"id":7238218,"unique_id":"wp-comment-36333","title":"Hello%20%20I%20saw%20this%20version%20was%20pushing%20a%20PE%20file%20into%20%25windir%25%2FAssembly%2FGAC%2FDesktop.ini%20What%20for%3F%20Have%20you%20seen%20this%20while%20reversing%20your%20variant%3F%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/06\/06\/zeroaccess-rootkit-usermode\/#comment-36333","item_id":"_comm_36333"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/?replytocom=36333#respond' data-commentid="36333" data-postid="169337" data-belowelement="div-comment-36333" data-respondelement="respond" data-replyto="Reply to @TigzyRK" aria-label='Reply to @TigzyRK'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-36361" class="comment even thread-even depth-1">
			<article id="div-comment-36361" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Tobal</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/#comment-36361"><time datetime="2012-06-07T14:39:24+01:00">June 7, 2012 at 2:39 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>is there a way to remove this newer version of the sirefef virus? The sophos virus removal tool when run on machines infected with this variant only causes windows to restart during the scan process. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_36361"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_36361={"id":7238218,"unique_id":"wp-comment-36361","title":"is%20there%20a%20way%20to%20remove%20this%20newer%20version%20of%20the%20sirefef%20virus%3F%20The%20sophos%20virus%20removal%20tool%20when%20run%20on%20machines%20infected%20with%20this%20variant%20only%20causes%20windows%20to%20restart%20during%20the%20scan%20proc%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/06\/06\/zeroaccess-rootkit-usermode\/#comment-36361","item_id":"_comm_36361"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/?replytocom=36361#respond' data-commentid="36361" data-postid="169337" data-belowelement="div-comment-36361" data-respondelement="respond" data-replyto="Reply to Tobal" aria-label='Reply to Tobal'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-36364" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-36364" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/df3c8509879109a6721f4f10a4855ca6?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/df3c8509879109a6721f4f10a4855ca6?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Lain</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/#comment-36364"><time datetime="2012-06-07T14:54:09+01:00">June 7, 2012 at 2:54 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Well come on it&#039;s not like this is new news. 32-bit rootkits have been trying to install themselves on 64-bit machines for the longest time, and it never went well (clearly). So it&#039;s not surprising ZeroAccess is deciding to actually target them. Up til this year theres been no 64-bit rootkits in the wild as far as I knew.  </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_36364"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_36364={"id":7238218,"unique_id":"wp-comment-36364","title":"Well%20come%20on%20it%26%23039%3Bs%20not%20like%20this%20is%20new%20news.%2032-bit%20rootkits%20have%20been%20trying%20to%20install%20themselves%20on%2064-bit%20machines%20for%20the%20longest%20time%2C%20and%20it%20never%20went%20well%20%28clearly%29.%20So%20it%26%23039%3Bs%20no%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/06\/06\/zeroaccess-rootkit-usermode\/#comment-36364","item_id":"_comm_36364"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/?replytocom=36364#respond' data-commentid="36364" data-postid="169337" data-belowelement="div-comment-36364" data-respondelement="respond" data-replyto="Reply to Lain" aria-label='Reply to Lain'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-36413" class="comment even thread-even depth-1">
			<article id="div-comment-36413" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/522507c5e70970e42a7cd65cb01eb082?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/522507c5e70970e42a7cd65cb01eb082?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">thisisu</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/#comment-36413"><time datetime="2012-06-07T18:58:40+01:00">June 7, 2012 at 6:58 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Nice coverage. Very clear and concise.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_36413"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_36413={"id":7238218,"unique_id":"wp-comment-36413","title":"Nice%20coverage.%20Very%20clear%20and%20concise.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/06\/06\/zeroaccess-rootkit-usermode\/#comment-36413","item_id":"_comm_36413"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/?replytocom=36413#respond' data-commentid="36413" data-postid="169337" data-belowelement="div-comment-36413" data-respondelement="respond" data-replyto="Reply to thisisu" aria-label='Reply to thisisu'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-36626" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-36626" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/5668984226e274615ee2d1c0261e807a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5668984226e274615ee2d1c0261e807a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">njorl</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/#comment-36626"><time datetime="2012-06-08T13:58:27+01:00">June 8, 2012 at 1:58 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Interesting detail from the technical paper: &quot;to make the folder inaccessible to programs using standard Windows APIs it is made into a symbolic link pointing to &#039;systemrootsystem32config&#039;&quot;. </p>
<p>This suggests a design flaw in NTFS: a folder is able simultaneously to have contents of its own (files and other folders) and to be a link to another folder.  Our expectation (as reflected by all normal software) is that each folder must be either a genuine container or some type of link. </p>
<p>It&#039;s probably now completely impractical for the flaw to be removed (from the file system definition), but I think it can be countered by changes to the drivers. </p>
<p>I suggest that, upon encountering a split-personality folder, the NTFS drivers should clear the link definition part, if writing is not barred by the context of the operation, or at least ignore it.  Such a change would be fairly benign, as all data would be accessible.  The loss of the link could, temporarily, disable some functionality, but our driver change is not breaking a good system; it&#039;s exposing a system that was already broken. </p>
<p>In the absence of a corrective change to NTFS or its drivers, our antivirus scanners must allow for the flaw, by not taking link folders at face value.  Are all major Windows security suites now on top of this? </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_36626"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_36626={"id":7238218,"unique_id":"wp-comment-36626","title":"Interesting%20detail%20from%20the%20technical%20paper%3A%20%26quot%3Bto%20make%20the%20folder%20inaccessible%20to%20programs%20using%20standard%20Windows%20APIs%20it%20is%20made%20into%20a%20symbolic%20link%20pointing%20to%20%26%23039%3Bsystemrootsystem32conf%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/06\/06\/zeroaccess-rootkit-usermode\/#comment-36626","item_id":"_comm_36626"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/?replytocom=36626#respond' data-commentid="36626" data-postid="169337" data-belowelement="div-comment-36626" data-respondelement="respond" data-replyto="Reply to njorl" aria-label='Reply to njorl'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-36734" class="comment even thread-even depth-1">
			<article id="div-comment-36734" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/da429ada99bde8e6d30b69cb4be58f13?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/da429ada99bde8e6d30b69cb4be58f13?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">JimboC</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/#comment-36734"><time datetime="2012-06-08T20:35:56+01:00">June 8, 2012 at 8:35 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Lain, </p>
<p>Unfortunately, 64 bit rootkits have been available for some time (as far back as August 2010). </p>
<p>Here are some links to the relevant articles on these threats: </p>
<p>Alureon 64 bit:<br />
  <a href="http://blogs.technet.com/b/mmpc/archive/2010/08/27/alureon-evolves-to-64-bit.aspx" rel="nofollow">http://blogs.technet.com/b/mmpc/archive/2010/08/2&#8230;</a><br />
  <a href="http://www.symantec.com/connect/blogs/tidserv-64-bit-goes-hiding" rel="nofollow">http://www.symantec.com/connect/blogs/tidserv-64-&#8230;</a><br />
  <a href="http://www.symantec.com/connect/blogs/backdoortidserv-and-x64" rel="nofollow">http://www.symantec.com/connect/blogs/backdoortid&#8230;</a> </p>
<p>64 bit MBR Rootkit:<br />
  <a href="http://nakedsecurity.sophos.com/2009/10/02/w32xpajb-avoid-virus/" rel="nofollow">http://nakedsecurity.sophos.com/2009/10/02/w32xpa&#8230;</a><br />
  <a href="http://www.symantec.com/connect/blogs/strange-case-w32xpajb-patient-zero" rel="nofollow">http://www.symantec.com/connect/blogs/strange-cas&#8230;</a> </p>
<p>Apologies for posting links from competitor&rsquo;s websites but I could not locate matching articles on this Sophos blog in all cases. </p>
<p>Thanks very much James for this great article and the link to the technical paper. Both are very interesting and have encouraged me to bolster my defences even more. </p>
<p>I really like this blog; I obtain extremely helpful information from it every day. Keep up the excellent work. </p>
<p>Thanks again. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_36734"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_36734={"id":7238218,"unique_id":"wp-comment-36734","title":"Hi%20Lain%2C%20%20Unfortunately%2C%2064%20bit%20rootkits%20have%20been%20available%20for%20some%20time%20%28as%20far%20back%20as%20August%202010%29.%20%20Here%20are%20some%20links%20to%20the%20relevant%20articles%20on%20these%20threats%3A%20%20Alureon%2064%20bit%3A%20%20%20%26lt%3Ba%20href%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/06\/06\/zeroaccess-rootkit-usermode\/#comment-36734","item_id":"_comm_36734"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/?replytocom=36734#respond' data-commentid="36734" data-postid="169337" data-belowelement="div-comment-36734" data-respondelement="respond" data-replyto="Reply to JimboC" aria-label='Reply to JimboC'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-41241" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-41241" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/3293eefd0bcedc93a050c14cad12ec4d?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3293eefd0bcedc93a050c14cad12ec4d?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Stephan Peters</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/#comment-41241"><time datetime="2012-07-09T07:08:22+01:00">July 9, 2012 at 7:08 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Worked!  </p>
<p>When FixZeroAccess from Symantec did not (no infections found).  </p>
<p>Just edited one registry value, then deleted the other (after removing another suspicious file in localsettings/applicationdata that may have had nothing to do with ZeroAccess (could be an innocent file related to Java 5 r 5). </p>
<p>I&#039;ll have to keep an eye on it to make sure it isn&#039;t still lurking on this computer. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_41241"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_41241={"id":7238218,"unique_id":"wp-comment-41241","title":"Worked%21%20%20%20When%20FixZeroAccess%20from%20Symantec%20did%20not%20%28no%20infections%20found%29.%20%20%20Just%20edited%20one%20registry%20value%2C%20then%20deleted%20the%20other%20%28after%20removing%20another%20suspicious%20file%20in%20localsettings%2Fapplica%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/06\/06\/zeroaccess-rootkit-usermode\/#comment-41241","item_id":"_comm_41241"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/?replytocom=41241#respond' data-commentid="41241" data-postid="169337" data-belowelement="div-comment-41241" data-respondelement="respond" data-replyto="Reply to Stephan Peters" aria-label='Reply to Stephan Peters'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-44195" class="comment even thread-even depth-1">
			<article id="div-comment-44195" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/3f309d51d4fbc8a43d253803f204404a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3f309d51d4fbc8a43d253803f204404a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">robert</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/#comment-44195"><time datetime="2012-07-26T17:33:49+01:00">July 26, 2012 at 5:33 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Restarting explorer.exe causes the trojan to go dormant.  Maybe useful if you want to retrieve data before a re-image. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_44195"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_44195={"id":7238218,"unique_id":"wp-comment-44195","title":"Restarting%20explorer.exe%20causes%20the%20trojan%20to%20go%20dormant.%20%20Maybe%20useful%20if%20you%20want%20to%20retrieve%20data%20before%20a%20re-image.%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/06\/06\/zeroaccess-rootkit-usermode\/#comment-44195","item_id":"_comm_44195"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/?replytocom=44195#respond' data-commentid="44195" data-postid="169337" data-belowelement="div-comment-44195" data-respondelement="respond" data-replyto="Reply to robert" aria-label='Reply to robert'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-45917" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-45917" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/b66ce2e6cbc056537354902c4595e98a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b66ce2e6cbc056537354902c4595e98a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Sebastian</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/#comment-45917"><time datetime="2012-08-03T23:48:31+01:00">August 3, 2012 at 11:48 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Kaspersky tdsskiller cleaned this quickly..  however I noticed that this virus attached itself to Akamai&#039;s netsession.dll  what a way to spread eh? </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_45917"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_45917={"id":7238218,"unique_id":"wp-comment-45917","title":"Kaspersky%20tdsskiller%20cleaned%20this%20quickly..%20%20however%20I%20noticed%20that%20this%20virus%20attached%20itself%20to%20Akamai%26%23039%3Bs%20netsession.dll%20%20what%20a%20way%20to%20spread%20eh%3F%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/06\/06\/zeroaccess-rootkit-usermode\/#comment-45917","item_id":"_comm_45917"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/06/06/zeroaccess-rootkit-usermode/?replytocom=45917#respond' data-commentid="45917" data-postid="169337" data-belowelement="div-comment-45917" data-respondelement="respond" data-replyto="Reply to Sebastian" aria-label='Reply to Sebastian'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">What do you think? <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2012/06/06/zeroaccess-rootkit-usermode/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://nakedsecurity.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='169337' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="2a8bd330d0" /></p><input type="hidden" id="ak_js" name="ak_js" value="180"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->
		<div class="comments-widget-area">
					</div>
	
	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	

	<section class="recommended-panel">
	<div class="container">
	<div class="panel-content ">

		<h3 class="block-title">Recommended reads</h3>
	<div class="blocks">
		<article id="post-544590" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/01/21/s3-ep16-darkweb-bust-security-at-home-and-browser-snoopage-podcast/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/01/nean-with-mic-wt-greys-1200.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Jan</span><span class="day">21</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">3</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/01/21/s3-ep16-darkweb-bust-security-at-home-and-browser-snoopage-podcast/" rel="bookmark">S3 Ep16: Darkweb bust, security at home, and browser snoopage [Podcast]</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-544685" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/01/26/ghost-hack-criminals-use-deceased-employees-account-to-wreak-havoc/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/01/gs-1200.jpg?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Jan</span><span class="day">26</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">4</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/01/26/ghost-hack-criminals-use-deceased-employees-account-to-wreak-havoc/" rel="bookmark">Ghost hack &#8211; criminals use deceased employee&#8217;s account to wreak havoc</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-544534" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/01/14/europol-announces-bust-of-worlds-biggest-dark-web-marketplace/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/01/dw-1200.jpg?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Jan</span><span class="day">14</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">11</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/01/14/europol-announces-bust-of-worlds-biggest-dark-web-marketplace/" rel="bookmark">Europol announces bust of &#8220;world&#8217;s biggest&#8221; dark web marketplace</a></h3>	</div>
</article> <!-- .card-article -->
	</div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="footer-container">
			<a href="#" class="js-collapse-footer"><svg style="height: 20px" viewBox="0 0 132 24" class="block icon sophos"><use xlink:href="#sophos"></use></svg></a>
			<div id="collapseFooter" class="blocks">
				<div class="sophos block">
					<ul id="menu-footer-primary" class="primary menu"><li id="menu-item-306737" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306737"><a href="https://nakedsecurity.sophos.com/about/">About Naked Security</a></li>
<li id="menu-item-306754" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306754"><a href="https://www.sophos.com/en-us/company.aspx">About Sophos</a></li>
<li id="menu-item-306747" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306747"><a href="https://nakedsecurity.sophos.com/send-us-a-tip/">Send us a tip</a></li>
<li id="menu-item-323171" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323171"><a href="/cookies-and-scripts/">Cookies</a></li>
<li id="menu-item-323170" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323170"><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
<li id="menu-item-323169" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323169"><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
</ul>				</div>
										<div class="news block">
							<ul id="menu-products-column-one" class="small menu"><li id="menu-item-306998" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306998"><a href="https://www.sophos.com/en-us/products/intercept-x.aspx">Intercept X</a></li>
<li id="menu-item-440801" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440801"><a href="https://www.sophos.com/en-us/products/server-security.aspx">Intercept X for Server</a></li>
<li id="menu-item-440802" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440802"><a href="https://www.sophos.com/en-us/products/mobile-control.aspx">Intercept X for Mobile</a></li>
</ul>						</div>
											<div class="products block">
							<ul id="menu-products-column-two" class="small menu"><li id="menu-item-440803" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440803"><a href="https://www.sophos.com/en-us/products/next-gen-firewall.aspx">XG Firewall</a></li>
<li id="menu-item-440805" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440805"><a href="https://www.sophos.com/en-us/products/sophos-email.aspx">Sophos Email</a></li>
<li id="menu-item-440804" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440804"><a href="https://www.sophos.com/en-us/products/secure-wifi.aspx">Sophos Wireless</a></li>
</ul>						</div>
											<div class="threats block">
							<ul id="menu-server-protection" class="small menu"><li id="menu-item-440806" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440806"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx">Managed Threat Response</a></li>
<li id="menu-item-448404" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-448404"><a href="https://www.sophos.com/en-us/products/cloud-optix.aspx">Cloud Optix</a></li>
<li id="menu-item-440807" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440807"><a href="https://www.sophos.com/en-us/products/phish-threat.aspx">Phish Threat</a></li>
</ul>						</div>
								</div>
			<ul class="block social footer">
				<li class="twitter"><a rel="nofollow" href="https://twitter.com/NakedSecurity" title="Follow our team of security experts on Twitter"><svg style="height: 14px" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
				<li class="facebook"><a rel="nofollow" href="https://www.facebook.com/SophosSecurity" title="Join over 250,000 people in our Facebook community"><svg style="height: 14px" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
				<li class="instagram"><a rel="nofollow" href="https://www.instagram.com/nakedsecurity/" title="Follow Naked Security on Instagram"><svg style="height: 14px" viewBox="0 0 100 100" class="icon instagram"><use xlink:href="#instagram"></use></svg></a></li>
				<li class="linkedin"><a rel="nofollow" href="https://www.linkedin.com/company/5053/" title="Join the naked security discussion group on LinkedIn"><svg style="height: 14px" viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
				<li class="rss"><a rel="nofollow" href="/feed" title="Subscribe to our RSS feed"><svg style="height: 14px" viewBox="0 0 100 100" class="icon rss"><use xlink:href="#rss"></use></svg></a></li>
			</ul>

							<div class="vip-powered-wpcom">
					<span class="copyright">© 1997 - 2021 Sophos Ltd.</span>
					All rights reserved.
					Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=nakedsecurity.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>				</div>
					</div>
		<script type="text/javascript">
			window.cookieconsent_options = {
				"message":"This site uses cookies. By continuing to browse the site you are agreeing to our use of cookies.",
				"dismiss":"Got it!",
				"learnMore":"Learn More",
				"link":"/cookies-and-scripts",
				"theme":"https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/css/sophos.css"};
		</script>
	</footer><!-- #colophon -->
</div><!-- #page -->
<div id="survey-wrapper" class="mfp-hide"><div class="pd-embed" id="pd_1499706777" data-settings=""></div></div>
<script id='child-js-plugins-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"0","nextLink":""};
</script>
<script id='child-js-core-js-extra'>
var Sophos = {"ajaxurl":"https:\/\/nakedsecurity.sophos.com\/wp-admin\/admin-ajax.php","nonce":"64f6810f0c"};
</script>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJyNjkEOwjAMBD9EalKU3hBPQZAamhDbUZyo4vdEiEocOHD07ozWsGbjhStyhbogoYJKXkQZVzXj3jqICjm1e2Adou7gL8FLwY0O7FObO/fOibppCub0HCjwL6ifSFecv/ttkpr5PAOXR1DCCufuwk0KdfZERztZdxitc1N8ARFpT3A='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161173',post:'169337',tz:'0',srv:'nakedsecurity.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161173', '169337' ]);
</script>
</body>
</html>
