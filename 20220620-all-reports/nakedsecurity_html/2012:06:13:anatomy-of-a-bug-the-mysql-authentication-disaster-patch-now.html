<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="RHQeasQqjasbRt5asY6atZYbs5tr10gFBevDt2HRhW0" />
<link rel="pingback" href="https://nakedsecurity.sophos.com/xmlrpc.php">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5VK6LTK');</script>
<!-- End Google Tag Manager -->

<meta name="description" content="What if your authentication system itself were at fault? You could have the hardest-to-guess password, salted and hashed thousands of times, and still be at risk. That&#039;s what happened to MySQL and MariaDB." />
<meta name="keywords" content="vulnerability, authentication, bugwatch, bypass, exploit, hash, it, mariadb, memcmp, metasploit, mysql, return value, vulnerability" />
<title>&#8220;One in 256 times *any* password might get you in&#8221; &#8211; MySQL authentication disaster &#8211; Naked Security</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="I9dHFo-YhnK2MfAHn-20V4GnWrOttVUYyISGamyU41M" />
<meta name="msvalidate.01" content="7D8D1FA2892142B1543D2CBCD07FB88F" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Feed" href="https://nakedsecurity.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Comments Feed" href="https://nakedsecurity.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; &#8220;One in 256 times *any* password might get you in&#8221; &#8211; MySQL authentication disaster Comments Feed" href="https://nakedsecurity.sophos.com/2012/06/13/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now/feed/" />
<link rel='stylesheet' id='all-css-0' href='https://nakedsecurity.sophos.com/_static/??-eJyVz00OwiAQhuELCSM1mLgwnoXCRFD+wgxpevvS2J0bXU7yPsk3sFQRso3dIYElAheIYY7FvkUMczNtBeI1okwhyxGcYAhbMmNmYI9pOCrVF8q4kJjOSh/gn1hEw0j8q9mHGifZNzQsfB9xkybVL5+6qLE/QyZ4IVczvrrJjz/unTzSXV2VvkxKa70BdwtjDg==' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqWkWAK9EIho='></script>
<link rel="https://api.w.org/" href="https://nakedsecurity.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://nakedsecurity.sophos.com/wp-json/wp/v2/posts/171391" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://nakedsecurity.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://nakedsecurity.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://nakedsecurity.sophos.com/2012/06/13/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now/" />
<link rel='shortlink' href='https://nakedsecurity.sophos.com/?p=171391' />
<link rel="alternate" type="application/json+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2012%2F06%2F13%2Fanatomy-of-a-bug-the-mysql-authentication-disaster-patch-now%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2012%2F06%2F13%2Fanatomy-of-a-bug-the-mysql-authentication-disaster-patch-now%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://nakedsecurity.sophos.com/2012/06/13/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="&#8220;One in 256 times *any* password might get you in&#8221; &#8211; MySQL authentication disaster" />
<meta property="og:url" content="https://nakedsecurity.sophos.com/2012/06/13/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now/" />
<meta property="og:description" content="What if your authentication system itself were at fault? You could have the hardest-to-guess password, salted and hashed thousands of times, and still be at risk. That&#8217;s what happened to MySQ…" />
<meta property="article:published_time" content="2012-06-12T23:31:40+00:00" />
<meta property="article:modified_time" content="2012-06-29T07:48:21+00:00" />
<meta property="og:site_name" content="Naked Security" />
<meta property="og:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/mysql-logo-250.png?w=250" />
<meta property="og:image:secure_url" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/mysql-logo-250.png?w=250" />
<meta property="og:image:width" content="250" />
<meta property="og:image:height" content="250" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@NakedSecurity" />
<meta name="twitter:text:title" content="&#8220;One in 256 times *any* password might get you in&#8221; &#8211; MySQL authentication disaster" />
<meta name="twitter:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/mysql-logo-250.png?w=144" />
<meta name="twitter:card" content="summary" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=270" />
</head>
<body class="post-template-default single single-post postid-171391 single-format-standard" >
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VK6LTK"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div style="display: none">
<svg>
	<symbol id="sophos" viewBox="0 0 132 24">
		<path d="m111.82 22.176h11.64c3.267 0 4.65-0.2 5.74-0.896 1.715-1.063 2.804-3.26 2.804-5.62 0-1.928-0.658-3.89-1.647-4.888-1.288-1.33-3.035-1.828-6.271-1.828h-3.527c-1.586 0-2.754-0.067-3.412-0.365-0.794-0.367-1.256-1.165-1.256-2.161 0-1.165 0.56-2.03 1.486-2.264 0.692-0.163 1.498-0.163 3.574-0.198h10.419v-3.956h-11.473c-2.574 0-3.727 0.099-4.718 0.466-2.279 0.796-3.828 3.257-3.828 6.083 0 1.93 0.76 3.727 2.079 4.89 1.155 0.996 2.872 1.462 5.51 1.462h4.697c1.057 0 1.915 0.132 2.376 0.398 0.893 0.433 1.418 1.328 1.418 2.36 0 0.864-0.395 1.597-1.087 2.027-0.561 0.369-1.517 0.534-3.268 0.534h-11.256zm-111.35 0h11.64c3.267 0 4.652-0.2 5.741-0.896 1.714-1.063 2.803-3.26 2.803-5.62 0-1.928-0.66-3.89-1.65-4.888-1.285-1.33-3.034-1.828-6.27-1.828h-3.527c-1.584 0-2.751-0.067-3.41-0.365-0.792-0.367-1.253-1.165-1.253-2.161 0-1.165 0.56-2.03 1.484-2.264 0.693-0.163 1.496-0.163 3.574-0.198h10.42v-3.956h-11.477c-2.573 0-3.727 0.099-4.715 0.466-2.278 0.796-3.83 3.257-3.83 6.083 0 1.93 0.762 3.727 2.08 4.89 1.155 0.996 2.871 1.462 5.51 1.462h4.696c1.057 0 1.913 0.132 2.377 0.398 0.888 0.433 1.416 1.328 1.416 2.36 0 0.864-0.394 1.597-1.089 2.027-0.558 0.369-1.517 0.534-3.264 0.534h-11.256v3.956zm94.05-16.18c-0.68 1.076-1.003 2.803-1.003 5.122 0 5.088 1.747 7.405 5.63 7.405 3.822 0 5.568-2.317 5.568-7.34 0-5.092-1.715-7.373-5.568-7.373-2.102 0-3.754 0.784-4.627 2.186zm13.174-2.511c1.329 1.761 2.072 4.63 2.072 7.992 0 3.816-1.197 6.948-3.334 8.677-1.619 1.304-4.078 2.022-6.995 2.022-4.142 0-7.41-1.372-9.092-3.817-1.263-1.793-1.88-4.176-1.88-7.08 0-4.172 1.133-7.339 3.27-9.035 1.682-1.37 4.339-2.122 7.383-2.122 3.85 0 6.925 1.209 8.576 3.363zm-22.018-3.068h-4.596v8.908h-8.319v-8.908h-4.597v21.759h4.597v-8.97h8.318v8.97h4.596v-21.759zm-28.61 10.277c1.23 0 1.941-0.163 2.427-0.62 0.581-0.49 0.938-1.533 0.938-2.74 0-1.436-0.58-2.478-1.584-2.838-0.356-0.13-0.94-0.197-1.684-0.197h-6.344v6.395zm-6.247 11.481h-4.598v-21.758h10.78c3.786 0 5.114 0.39 6.538 1.991 1.264 1.37 1.942 3.163 1.942 5.088 0 2.284-0.904 4.404-2.394 5.676-1.262 1.077-2.43 1.402-4.888 1.402h-7.38zm-22.589-16.179c-0.682 1.076-1.004 2.803-1.004 5.122 0 5.088 1.748 7.405 5.634 7.405 3.818 0 5.568-2.317 5.568-7.34 0-5.092-1.716-7.373-5.568-7.373-2.106 0-3.757 0.784-4.63 2.186zm13.174-2.511c1.328 1.761 2.073 4.63 2.073 7.992 0 3.816-1.2 6.948-3.335 8.677-1.618 1.304-4.079 2.022-6.993 2.022-4.144 0-7.413-1.372-9.096-3.817-1.264-1.793-1.878-4.176-1.878-7.08 0-4.172 1.133-7.339 3.272-9.035 1.681-1.37 4.337-2.122 7.38-2.122 3.851 0 6.93 1.209 8.578 3.363z"></path>
	</symbol>
	<symbol id="twitter" viewBox="0 0 24 24">
 		<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path>
 	</symbol>
	<symbol id="facebook" viewBox="0 0 24 24">
 		<path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path>
 	</symbol>
	<symbol id="instagram" viewBox="0 0 24 24">
		<path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path>
	</symbol>
	<symbol id="linkedin" viewBox="0 0 24 24">
		<path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"></path>
	</symbol>
	<symbol id="rss" viewBox="0 0 24 24">
		<path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"></path>
	</symbol>
	<symbol id="reddit" viewBox="0 0 24 24">
		<path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"></path>
	</symbol>
</svg>
</div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header variation variation-3" role="banner">
		<div class="header-container">
			<div class="site-branding">
				<div class="site-title">
					<a title="Naked Security" href="https://nakedsecurity.sophos.com/" rel="home"><img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/naked-security-logo-white@2x.png"></a>
					by
					<a title="sophos.com" href="https://www.sophos.com"><svg viewBox="0 0 132 24" class="icon sophos"><use xlink:href="#sophos"></use></svg></a>
				</div>
			</div><!-- .site-branding -->
			<nav id="site-navigation" class="main-navigation" role="navigation">
				<div class="container">
					<ul id="menu-variation-two" class="exit-links menu"><li id="menu-item-436509" class="products menu-item menu-item-type-custom menu-item-object-custom menu-item-436509"><a href="#">Products</a></li>
<li id="menu-item-436515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436515"><a href="https://www.sophos.com/en-us/products/free-tools.aspx">Free Tools</a></li>
<li id="menu-item-436531" class="search-toggle menu-item menu-item-type-custom menu-item-object-custom menu-item-436531"><a href="#">Search</a></li>
<li id="menu-item-436532" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436532"><a href="https://home.sophos.com/en-us.aspx">Free Sophos Home</a></li>
</ul>				</div>
			</nav><!-- #site-navigation -->
			<div class="site-search-block">
	<form target="_top" role="search" class="search-form" method="get" action="https://nakedsecurity.sophos.com/">
        <fieldset>
            <div class="field">
				<input type="search" value="" name="s" class="search-field" placeholder="Search naked security...">
            </div>
            <div class="submit">
				<button type="submit" class="search-submit button">Go</button>
            </div>
        </fieldset>
    </form>
</div>
		</div><!-- .container -->
	</header>

	<div class="responsive-flyout-panel small-12 column active" style="opacity: 1; display: none;">
		<div class="modal-filler"></div>
	    <div class="productNavBox">
	        <div class="productNavContainer">
	            <div class="row prodRow">
	                <div class="prodListBox column large-9">
	                    <div class="row margin-0 highlightProduct">
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/next-gen-firewall.aspx"><img src="https://www.sophos.com/medialibrary/2F4785DE8C3F43ECBD699A18F332FEEB.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">XG Firewall</div>
	                                	<div class="menu-section-subtitle">Next-Gen Firewall</div>
									</div>
	                            </a>
	                        </div>
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/intercept-x.aspx"><img src="https://www.sophos.com/medialibrary/27111765D65A45D49A232925D2CE428B.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">Intercept X</div>
	                                	<div class="menu-section-subtitle">Next-Gen Endpoint</div>
									</div>
	                            </a>
	                        </div>
	                    </div>
	                    <div class="productList">
	                        <ul>
								<li>
									<a href="https://www.sophos.com/en-us/products/cloud-optix.aspx"><img src="https://www.sophos.com/medialibrary/SophosNext/Images/Products/Icons/sophos-cloud-optix-icon.svg">Sophos Cloud Optix</a>
								</li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-central.aspx"><img src="https://www.sophos.com/medialibrary/08EA66123F1B4DDE8FE5C9B578A7FAA7.ashx">Sophos Central</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/mobile-control.aspx"><img src="https://www.sophos.com/medialibrary/678FE994855047739F50D6C411184FA6.ashx">Sophos Mobile</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/server-security.aspx"><img src="https://www.sophos.com/medialibrary/01B80E7D7CD54EF8AC2E51C9C6EC0236.ashx">Intercept X for Server</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-wifi.aspx"><img src="https://www.sophos.com/medialibrary/BEBD9C41BB4E480498514B29B92A145A.ashx">Secure Wi-Fi</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/phish-threat.aspx"><img src="https://www.sophos.com/medialibrary/DC9D1A7BA3964B0C9DAF1F1E68806B5A.ashx">Phish Threat</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/safeguard-encryption.aspx"><img src="https://www.sophos.com/medialibrary/8F51F06B62814B108D3B2763FF018E37.ashx">SafeGuard Encryption</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-email.aspx"><img src="https://www.sophos.com/medialibrary/597ADA0AF01A4A12B2B27239D0F9992C.ashx">Secure Email</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/unified-threat-management.aspx"><img src="https://www.sophos.com/medialibrary/8CB72BF5E1AD41F7894CE5E42101B0F3.ashx">SG UTM</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-web-gateway.aspx"><img src="https://www.sophos.com/medialibrary/C586E372694547A1B207A61D87246BA7.ashx">Secure Web Gateway</a>
	                            </li>
	                        </ul>
	                    </div>
	                </div>
	                <div class="homeUserBox column large-3">
						<img src="https://www.sophos.com/medialibrary/3376DF5742A64AEE93FDB9DCA7291239.ashx">
						<div class="menu-section-title">For Home Users</div>
	                    <p>Sophos Home protects every Mac and PC in your home </p><a href="https://home.sophos.com/" target="_blank" class="greenSmallMenuBtn">Learn More</a>
					</div>
	            </div>
	            <div class="row blueRow">
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-tools.aspx"><img width="19" src="https://www.sophos.com/medialibrary/A1FF440D2BB84511B8C94D771D44E207.ashx">Free Security Tools</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-trials.aspx"><img width="20" src="https://www.sophos.com/medialibrary/FCD3410ED2C347808D9DB8AC12C62DBD.ashx">Free Trials</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/demos.aspx"><img width="18" src="https://www.sophos.com/medialibrary/50985180E5F54C94917A2A6508E24287.ashx">Product Demos</a>
	                </div>
	                <!-- <div class="column large-3 medium-6">
	                    <a href="javascript:fairfax.openLiveChatFromFlyoutLink();" class="flyout-live-chat-link"><img width="20" src="https://www.sophos.com/medialibrary/E24C5050837145F6A5C592E299BA2A0D.ashx">Live Sales Chat</a>
	                </div> -->
	            </div>
	        </div>
	    </div>
	</div>
	<script>

	jQuery(document).ready( function () {
		var productButton   = jQuery('nav .menu-item.products');
		var modalBackground = jQuery('.modal-filler');
		var flyoutMenu		= jQuery('.responsive-flyout-panel');
		var Sophos			= Sophos || {};

		Sophos.MenuTest = {};

		Sophos.MenuTest.open = function () {
				productButton.addClass('open');
				flyoutMenu.show();
				modalBackground.show();
		};

		Sophos.MenuTest.close = function () {
			productButton.removeClass('open');
			flyoutMenu.hide();
			modalBackground.hide();
		};

		Sophos.MenuTest.toggle = function () {
			if ( productButton.hasClass('open') ) {
				Sophos.MenuTest.close();
			} else {
				Sophos.MenuTest.open();
			}
		};

		productButton.click( Sophos.MenuTest.toggle );
		modalBackground.click( Sophos.MenuTest.close );
	});

	</script>

	
	<section class="about-panel">
	<div class="container">
	<div class="panel-content ">

		<div class="description"><span>Have you listened to our podcast? <a href="/podcast/">Listen now</a></span></div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	<div id="content" class="site-content">
		<div class="content-container">

</div> <!-- .container -->
</div> <!-- #content -->


	<section class="content-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

		<main id="main" class="site-main" role="main">

	
		
<article id="post-171391" class="post-171391 post type-post status-publish format-standard has-post-thumbnail hentry category-featured category-vulnerability tag-authentication tag-bugwatch tag-bypass tag-exploit tag-hash tag-it tag-mariadb tag-memcmp tag-metasploit tag-mysql tag-return-value tag-vulnerability-2 post_format-post-format-standard">

	<header class="entry-header">
		<h1 class="entry-title">&#8220;One in 256 times *any* password might get you in&#8221; &#8211; MySQL authentication disaster</h1>		<div class="entry-meta">
			<div>
				
	<span class="entry-published">
		<time class="entry-date published" datetime="2012-06-13T00:31:40+01:00">13 Jun 2012</time>
	</span>

					<a href="#comments" class="comment-box">
					<span class="count">7</span>
				</a>
					
	<span class="entry-categories">
	<a href="https://nakedsecurity.sophos.com/category/security-threats/vulnerability/">Vulnerability</a>	</span>

			</div>
	</header> <!-- .entry-header -->

    <div id="newsletter-signup" class="container top"></div>

			<div class="entry-featured-image">
			<img width="250" height="250" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/mysql-logo-250.png?w=250&amp;h=250&amp;crop=1" class="attachment-hero-thumbnail size-hero-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/mysql-logo-250.png 250w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/mysql-logo-250.png?resize=150,150 150w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/mysql-logo-250.png?resize=225,225 225w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/mysql-logo-250.png?resize=70,70 70w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/mysql-logo-250.png?resize=32,32 32w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/mysql-logo-250.png?resize=50,50 50w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/mysql-logo-250.png?resize=64,64 64w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/mysql-logo-250.png?resize=96,96 96w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2012/06/mysql-logo-250.png?resize=128,128 128w" sizes="(max-width: 250px) 100vw, 250px" />					</div> <!-- .entry-featured-image -->
		
		<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2012/06/12/beware-fake-facebook-notifications/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> Beware fake Facebook notifications arriving in your email</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2012/06/13/patch-tuesday-june-2012-critical-updates-for-ie-rdp-net-flash-and-java/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Patch Tuesday June 2012 &#8211; Critical updates for IE, RDP, .NET, Flash and Java</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	<div class="entry-content">
		<div class="entry-prefix">
			<div class="entry-author">
				
	
					<span class="by">by</span>
			<a href="https://nakedsecurity.sophos.com/author/paul-ducklin/" title="Posts by Paul Ducklin" class="author url fn" rel="author">Paul Ducklin</a>		
	
				</div>
			<div class="entry-sharing">
				
	<ul class="block social share">
		<li class="facebook"><a href="https://www.facebook.com/share.php?u=https%3A%2F%2Fnakedsecurity.sophos.com%2F2012%2F06%2F13%2Fanatomy-of-a-bug-the-mysql-authentication-disaster-patch-now%2F&title=%E2%80%9COne+in+256+times+%2Aany%2A+password+might+get+you+in%E2%80%9D+%E2%80%93+MySQL+authentication+disaster" data-title="“One in 256 times *any* password might get you in” – MySQL authentication disaster" title="Share on Facebook"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
		<li class="twitter"><a href="https://twitter.com/intent/tweet?text=%E2%80%9COne+in+256+times+%2Aany%2A+password+might+get+you+in%E2%80%9D+%E2%80%93+MySQL+authentication+disaster+https%3A%2F%2Fnakedsecurity.sophos.com%2F%3Fp%3D171391" data-title="&#8220;One in 256 times *any* password might get you in&#8221; &#8211; MySQL authentication disaster" title="Share on Twitter"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
		<li class="linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2012%2F06%2F13%2Fanatomy-of-a-bug-the-mysql-authentication-disaster-patch-now%2F&title=%E2%80%9COne+in+256+times+%2Aany%2A+password+might+get+you+in%E2%80%9D+%E2%80%93+MySQL+authentication+disaster" data-title="“One in 256 times *any* password might get you in” – MySQL authentication disaster" title="Share on LinkedIn"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
		<li class="reddit"><a href="https://reddit.com/submit/?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2012%2F06%2F13%2Fanatomy-of-a-bug-the-mysql-authentication-disaster-patch-now%2F&title=%E2%80%9COne+in+256+times+%2Aany%2A+password+might+get+you+in%E2%80%9D+%E2%80%93+MySQL+authentication+disaster" title="Share on Reddit"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon reddit"><use xlink:href="#reddit"></use></svg></a></li>

			</ul>

				</div>
		</div>
		<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2012/06/hashes-enmasse-180.png" alt="" title="Hashes in a rectangle (they&#039;re from /bin on OS X 10.6)" width="180" height="192" align="right" hspace="10" vspace="10"></img>We&#8217;ve <a href="http://nakedsecurity.sophos.com/2012/06/06/millions-of-linkedin-passwords-reportedly-leaked-take-action-now/">reported</a> on a number of <a href="http://nakedsecurity.sophos.com/2012/06/10/league-of-legends-online-game-joins-the-league-of-the-hacked/">hacks</a> lately in which password hashes have been stolen. </p>
<p>A hashed password is useless on its own, of course, but checking a list of really obvious passwords against a hash can <a href="http://nakedsecurity.sophos.com/2012/06/06/linkedin-confirms-hack-over-60-of-stolen-passwords-already-cracked/">quickly reveal</a> low-hanging fruit. </p>
<p>That&#8217;s why we keep advising you to choose non-obvious passwords &#8211; so they&#8217;re harder for hackers to guess.</p>
<p>But what if the authentication system itself is at fault? </p>
<p>You could have the hardest-to-guess password, salted and hashed thousands of times, and still be at risk. </p>
<p>That happened about a year ago at Dropbox, for instance, when the file-sharing site <a href="http://nakedsecurity.sophos.com/2011/06/21/dropbox-lets-anyone-log-in-as-anyone/">inadvertently removed</a> its authentication validation altogether for a few hours. Anyone could use any password.</p>
<p>It&#8217;s happened again, this time with a more corporate angle. </p>
<p>Open source database giant <a href="http://www.mysql.com/" rel="nofollow">MySQL</a> (and its post-Oracle  fork, <a href="http://mariadb.org/" rel="nofollow">MariaDB</a>) contained a bug which meant that your password might be checked correctly only 255 out of every 256 times. One in 256 times, <em>anything</em> might get you in.</p>
<p>The good news is that this bug doesn&#8217;t show itself on all systems, and <a href="http://seclists.org/oss-sec/2012/q2/493" rel="nofollow">was fixed</a> well over a month ago in both MariaDB and MySQL. To summarise:</p>
<blockquote><p><tt>All MariaDB and MySQL versions up to 5.1.61, 5.2.11, 5.3.5, 5.5.22 are vulnerable. MariaDB versions from 5.1.62, 5.2.12, 5.3.6, 5.5.23 are not. MySQL versions from 5.1.63, 5.5.24, 5.6.6 are not.</tt></p></blockquote>
<p>The bad news is that the popular exploitation automation tool Metasploit now has a plug-in that tries to retrieve the password hashes from a vulnerable system. That&#8217;s so you can use this exploit whilst it lasts, and then recover weak passwords off-line to use later when the system is patched.</p>
<p>The vulnerability is a weird one. </p>
<p>When you compare two memory buffers in C &#8211; as you might when checking if a supplied password&#8217;s hash matches the one from your database &#8211; you usually use the <tt>memcmp()</tt> function.</p>
<p>If the two memory blocks are the same, <tt>memcmp()</tt> returns zero. (Although zero generally means <tt>FALSE</tt> in C, many library functions return zero on success, leaving a choice of non-zero values to denote various error conditions.)</p>
<p>If the memory blocks differ, <tt>memcmp()</tt> returns a number which indicates the sort order of the two memory buffers. A negative number means that the first block would sort before the second; positive means it would sort after it. </p>
<p>But what do &#8220;a negative number&#8221; and &#8220;a positive number&#8221; mean? According to my Linux <tt>man</tt> page:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2012/06/memcmp-lin-480.png" alt="" title="Linux manpage for memcmp()" width="480" height="97"></img></p>
<p>And according to my OS X <tt>man</tt> page:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2012/06/memcmp-osx-480.png" alt="" title="OS X manpage for memcmp()" width="480" height="92"></img></p>
<p>Since a byte can hold a value from zero to 255, my conclusions are therefore that:</p>
<p>* The value returned by <tt>memcmp()</tt> on OS X is theoretically limited to the range from -255 (zero minus 255) up to +255 (255 minus zero).</p>
<p>* The value returned by Linux isn&#8217;t obviously limited other than by the range of the <tt>int</tt> that the function returns. </p>
<p>* It would be unwise to assume any artificial limits on the return value of <tt>memcmp()</tt>.</p>
<p>Apparently, in the MySQL code, the password hash validation bug happened if <tt>memcmp()</tt> returned a value outside the range from -128 up to +127 (the ambit of a <tt>signed char</tt>). </p>
<p>Then, with a one-in-256 chance, the code would recognise two cryptographic hashes as equal regardless of reality. In short, with repeated attempts to log in with <em>any</em> password, you&#8217;d eventually get in just by chance.</p>
<p>With most paths through the Linux <tt>memcmp()</tt> library code, the function just happens to stick to a return value which fits into a <tt>signed char</tt>, so the bug never shows itself. </p>
<p>But in some cases &#8211; if an SSE-accelerated implementation of <tt>memcmp()</tt> is used, for example &#8211; the bug <a href="http://seclists.org/oss-sec/2012/q2/493" rel="nofollow">may be triggered</a>:</p>
<blockquote><p><tt>Whether a particular build of MySQL or MariaDB is vulnerable, depends on how and where it was built. A prerequisite is a memcmp() that can return an arbitrary integer (outside of -128..127 range). To my knowledge gcc builtin memcmp is safe, BSD libc memcmp is safe. Linux glibc sse-optimized memcmp is not safe, but gcc usually uses the inlined builtin version.</tt></p></blockquote>
<p>Ouch. Four security morals from this story:</p>
<p><strong>1. Never make assumptions when coding.</strong> If a function returns an <tt>int</tt>, accept that any value which fits in an <tt>int</tt> <em>might</em> be returned, regardless of what the developer, the manual and received wisdom tell you.</p>
<p><strong>2. Patch your MySQL or MariaDB installations</strong> if you haven&#8217;t already.</p>
<p><strong>3. Don&#8217;t expose database servers to external connectivity</strong> unless you really mean to. Even inside your corporate network, be very restrictive about who can reach database servers at all, let alone log in to them. </p>
<p><strong>4. Watch out for speed optimisations.</strong> Invoke them only if you genuinely need extra speed &#8211; they may represent a less-travelled code path and thus expose your users to obscure bugs.</p>
<p><br />
&#8211;</p>
<p style='font-size:90%;'><em><strong>NB.</strong> Thanks to Naked Security reader Bill for his email about this intriguing bug.</em></p>
			</div> <!-- .entry-content -->
	<ul class="block social follow">
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon twitter"><use xlink:href="#twitter"></use></svg>
			<p>Follow <strong><a href="https://twitter.com/nakedsecurity">@NakedSecurity on Twitter</a></strong> for the latest computer security news.</p>
		</li>
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon instagram"><use xlink:href="#instagram"></use></svg>
			<p>Follow <strong><a href="https://www.instagram.com/nakedsecurity/">@NakedSecurity on Instagram</a></strong> for exclusive pics, gifs, vids and LOLs!</p>
		</li>
	</ul>
</article><!-- #post-## -->

		<div class="free-tools-block">
			<h2 class="block-title">Free tools</h2>

<div class="ns-free-tools">
	<div class="ns-free-tools__item ns-free-tools__item--sophos-home">
		<a class="ns-free-tools__link" href="https://home.sophos.com/en-us.aspx?cmp=701j0000001eLpnAAE">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/sophos-home@2x.png" alt="Sophos Home" class="ns-free-tools__image" width="166" height="100">
			<h4 class="ns-free-tools__title">
				Sophos Home			</h4>
			<div class="ns-free-tools__sub-title">
				Protect personal PCs and Macs			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--hitman-pro">
		<a class="ns-free-tools__link" href="https://www.hitmanpro.com/en-us/hmp.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/hitman-pro@2x.png" alt="Hitman Pro" class="ns-free-tools__image" width="154" height="100">
			<h4 class="ns-free-tools__title">
				Hitman Pro			</h4>
			<div class="ns-free-tools__sub-title">
				Find and remove malware			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--intercept-x">
		<a class="ns-free-tools__link" href="https://www.sophos.com/en-us/products/free-tools/sophos-mobile-security-free-edition.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/mobile-security-android@2x.png" alt="Sophos Intercept X for Mobile" class="ns-free-tools__image" width="96" height="110">
			<h4 class="ns-free-tools__title">
				Intercept X for Mobile			</h4>
			<div class="ns-free-tools__sub-title">
				Protect Android devices			</div>
		</a>
	</div>
</div>
		</div>

			<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2012/06/12/beware-fake-facebook-notifications/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> Beware fake Facebook notifications arriving in your email</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2012/06/13/patch-tuesday-june-2012-critical-updates-for-ie-rdp-net-flash-and-java/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Patch Tuesday June 2012 &#8211; Critical updates for IE, RDP, .NET, Flash and Java</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	
	</main><!-- #main -->

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<section class="comments-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

			
<div id="comments" class="comments-area">

			<h2 class="comments-title">
			7 comments on &ldquo;<span>&#8220;One in 256 times *any* password might get you in&#8221; &#8211; MySQL authentication disaster</span>&rdquo;		</h2>

		<ol class="comment-list">
					<li id="comment-37665" class="comment even thread-even depth-1 parent">
			<article id="div-comment-37665" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/2a34430d42d8aa3034c8194407662817?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2a34430d42d8aa3034c8194407662817?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Toby</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/06/13/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now/#comment-37665"><time datetime="2012-06-13T11:52:31+01:00">June 13, 2012 at 11:52 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I&#039;m a bit confused here.<br />
From what I understand about the memcmp() function is deterministic, i.e. if I compare two blocks A and B I will always get the same result, however often I do the comparison. Thus then, to exploit the bug, one would need to basically need to do a bruteforce attack, trying different passwords, until you find one that appears to be equal under SSE-accelerated memcmp(). Which would be slightly less dramatic because depending on the password it might be hard to find such a &quot;collision&quot; that mis-matches.<br />
However, you seem to suggest (&quot;&#8230;repeated attempts to log in with any password&#8230;&quot;) that by repeated attempts with the same password, you can trigger the bug. Which would be even worse. </p>
<p>So how bad is it? Though I suppose either way is really well bad enough. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_37665"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_37665={"id":7238218,"unique_id":"wp-comment-37665","title":"I%26%23039%3Bm%20a%20bit%20confused%20here.%20From%20what%20I%20understand%20about%20the%20memcmp%28%29%20function%20is%20deterministic%2C%20i.e.%20if%20I%20compare%20two%20blocks%20A%20and%20B%20I%20will%20always%20get%20the%20same%20result%2C%20however%20often%20I%20do%20the%20c%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/06\/13\/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now\/#comment-37665","item_id":"_comm_37665"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/06/13/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now/?replytocom=37665#respond' data-commentid="37665" data-postid="171391" data-belowelement="div-comment-37665" data-respondelement="respond" data-replyto="Reply to Toby" aria-label='Reply to Toby'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-37814" class="comment odd alt depth-2 parent">
			<article id="div-comment-37814" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/441e7fae6894199e8fc3025efb70919d?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/441e7fae6894199e8fc3025efb70919d?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/06/13/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now/#comment-37814"><time datetime="2012-06-14T05:55:36+01:00">June 14, 2012 at 5:55 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>According to the bug reporters, the probability of an accidental mismatch is 1/256. </p>
<p>Also, AFAIR, the hash-compute-and-check function includes some randomness so that the actual values compared are different each time you try to log in. So you don&#039;t even need to supply a different faux-password each time &#8211; you can just keep knocking on the door with the same password, and the randomness added to the hash-and-check routine does the rest &#8211; ironically reducing security slightly rather than increasing it. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_37814"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_37814={"id":7238218,"unique_id":"wp-comment-37814","title":"According%20to%20the%20bug%20reporters%2C%20the%20probability%20of%20an%20accidental%20mismatch%20is%201%2F256.%20%20Also%2C%20AFAIR%2C%20the%20hash-compute-and-check%20function%20includes%20some%20randomness%20so%20that%20the%20actual%20values%20compared%20a%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/06\/13\/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now\/#comment-37814","item_id":"_comm_37814"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/06/13/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now/?replytocom=37814#respond' data-commentid="37814" data-postid="171391" data-belowelement="div-comment-37814" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-37914" class="comment even depth-3">
			<article id="div-comment-37914" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/5668984226e274615ee2d1c0261e807a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5668984226e274615ee2d1c0261e807a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">njorl</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/06/13/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now/#comment-37914"><time datetime="2012-06-14T17:13:09+01:00">June 14, 2012 at 5:13 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I&#039;ve previously noticed that the md5crypt function (the GRUB4DOS implementation thereof) does not return a constant result for a fixed input.  I presume that this feature has been employed to increase the size of pre-built hash table necessary for a particular level of success in a &quot;rainbow table attack&quot;.  (It&#039;s less effective than a per-user salt for protecting passwords from that mode of attack, of course.) </p>
<p>Note, however, that when I use my password, to attempt to gain the protected access, I enter it just the once.  I would conclude, therefore, that the verification process must begin generating and checking all possible results of hashing the entered password, at least until it finds one result that equals the one it has recorded for my account. </p>
<p>The number of possible hashes, for a single password, must be limited because of  the increase to the time required to validate the log-in and, possibly, an increase in coincidental matches.  (Let me call the number &quot;n&quot;.) </p>
<p>However, if such a mechanism were employed in MySQL, with this data-size bug present, a single, trial, password would have the same n chances of getting through the loophole, each time we input it.  Thus, the trial password would consistently either work (with a probability which we are unable to calculate from the available information) or fail.  So, an attacker should try a different password each time. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_37914"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_37914={"id":7238218,"unique_id":"wp-comment-37914","title":"I%26%23039%3Bve%20previously%20noticed%20that%20the%20md5crypt%20function%20%28the%20GRUB4DOS%20implementation%20thereof%29%20does%20not%20return%20a%20constant%20result%20for%20a%20fixed%20input.%20%20I%20presume%20that%20this%20feature%20has%20been%20employed%20t%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/06\/13\/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now\/#comment-37914","item_id":"_comm_37914"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/06/13/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now/?replytocom=37914#respond' data-commentid="37914" data-postid="171391" data-belowelement="div-comment-37914" data-respondelement="respond" data-replyto="Reply to njorl" aria-label='Reply to njorl'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-37707" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-37707" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/ab8fff5db8fc26cc1d926caf928d3353?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ab8fff5db8fc26cc1d926caf928d3353?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Bill C.</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/06/13/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now/#comment-37707"><time datetime="2012-06-13T17:24:15+01:00">June 13, 2012 at 5:24 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Another great read, very detailed description of the bug. </p>
<p>Thank you for taking the time to read my e-mail. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_37707"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_37707={"id":7238218,"unique_id":"wp-comment-37707","title":"Another%20great%20read%2C%20very%20detailed%20description%20of%20the%20bug.%20%20Thank%20you%20for%20taking%20the%20time%20to%20read%20my%20e-mail.%20%20%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/06\/13\/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now\/#comment-37707","item_id":"_comm_37707"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/06/13/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now/?replytocom=37707#respond' data-commentid="37707" data-postid="171391" data-belowelement="div-comment-37707" data-respondelement="respond" data-replyto="Reply to Bill C." aria-label='Reply to Bill C.'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-37934" class="comment even thread-even depth-1">
			<article id="div-comment-37934" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/5668984226e274615ee2d1c0261e807a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5668984226e274615ee2d1c0261e807a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">njorl</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/06/13/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now/#comment-37934"><time datetime="2012-06-14T20:07:36+01:00">June 14, 2012 at 8:07 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I am deeply doubtful that a result &quot;outside the range from -128 up to +127&quot; is sufficient. </p>
<p>For example, -129 is 0xFFFF&#8230;FF7F or 11111111&#8230;1111111101111111 (binary) and it&#039;s very difficult to imagine a program mistaking it for zero.  (I state, explicitly, that I&#039;ve adopted the signed-number convention used by nearly all modern processors.  Other representations are possible, as are non-binary processors.) </p>
<p>Let&#039;s look, first, at the Linux case. </p>
<p>For completeness, I introduce p as the probability that the trial password would be accepted by a sound implementation (either because the attacker has guessed correctly, or because he has hit upon a hash collision). </p>
<p>So, there is a probability (1 &#8211; p) that memcmp will signal &quot;wrong password&quot;, which it does by returning a non-zero, signed, integer (we are told). </p>
<p>The bug, most likely, is that MySQL considers only the least (/less) significant byte of the result, i.e. the lower eight bits.  (Doing so is consistent with expecting a return &quot;value which fits into a signed char&quot;.) </p>
<p>MySQL would, thus, reach the wrong conclusion when both every one of the bottom eight bits is 0 and at least one of the higher bits is 1.  (When all bits are zero, memcmp is signalling a password match, of course.) </p>
<p>If we assume the integer data type is n bytes (or 8n bits), there are (256^n) &#8211; 1 memcmp results that could be used to signal &quot;wrong password&quot;, of which (256^(n &#8211; 1)) &#8211; 1 have the hoped-for zero as their bottom byte.  (To see this, we note that after discarding the bottom byte, we have n -1 bytes left, and, hence, the number of non-zero values they can convey is (256^(n &#8211; 1)) -1.) </p>
<p>Hence, MySQL would reach the false-positive match (256^(n &#8211; 1)) -1 times out of (256^n) &#8211; 1 (under the assumption of even distribution). </p>
<p>If we assume n = 2 (i.e. a two-byte integer, which is the case for a lot of implementations), the result is one in 257.  For n &gt;= 3, it tends rapidly to one in 256. </p>
<p>Incorporating the possibility (probability p) that the bug-free implementation would have accepted the trial password, the probability that the buggy MySQL accepts our log-in is p + (1 &#8211; p)((256^(n &#8211; 1)) -1)/((256^n) &#8211; 1). </p>
<p>Looking at the OSX case, there seems not to be a problem.  There is no integral, value, between -255 and -1 {0xFFFF&#8230;FF01, 0xFFFF&#8230;FF02, &#8230; 0xFFFF&#8230;FFFE, 0xFFFF&#8230;FFFF} or between +1 and +255 {0x01, 0x02, &#8230; 0xFE, 0xFF}, that has zero as its bottom byte. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_37934"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_37934={"id":7238218,"unique_id":"wp-comment-37934","title":"I%20am%20deeply%20doubtful%20that%20a%20result%20%26quot%3Boutside%20the%20range%20from%20-128%20up%20to%20%2B127%26quot%3B%20is%20sufficient.%20%20For%20example%2C%20-129%20is%200xFFFF...FF7F%20or%2011111111...1111111101111111%20%28binary%29%20and%20it%26%23039%3Bs%20very%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/06\/13\/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now\/#comment-37934","item_id":"_comm_37934"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/06/13/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now/?replytocom=37934#respond' data-commentid="37934" data-postid="171391" data-belowelement="div-comment-37934" data-respondelement="respond" data-replyto="Reply to njorl" aria-label='Reply to njorl'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-46348" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-46348" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/cb39d2fcb8f8cacd13792a502e64aec9?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/cb39d2fcb8f8cacd13792a502e64aec9?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Mark Sitkowski</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/06/13/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now/#comment-46348"><time datetime="2012-08-07T00:05:15+01:00">August 7, 2012 at 12:05 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Very interesting, and thanks for the detailed analysis. Personally, I&#039;ve always used bcmp(), which only returns 0 or 1 (also, because I didn&#039;t understand what &#039;lexicographically&#039; meant&#8230; 🙂</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_46348"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_46348={"id":7238218,"unique_id":"wp-comment-46348","title":"Very%20interesting%2C%20and%20thanks%20for%20the%20detailed%20analysis.%20Personally%2C%20I%26%23039%3Bve%20always%20used%20bcmp%28%29%2C%20which%20only%20returns%200%20or%201%20%28also%2C%20because%20I%20didn%26%23039%3Bt%20understand%20what%20%26%23039%3Blexicographically%26amp%3B%230%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/06\/13\/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now\/#comment-46348","item_id":"_comm_46348"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/06/13/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now/?replytocom=46348#respond' data-commentid="46348" data-postid="171391" data-belowelement="div-comment-46348" data-respondelement="respond" data-replyto="Reply to Mark Sitkowski" aria-label='Reply to Mark Sitkowski'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-46372" class="comment even depth-2">
			<article id="div-comment-46372" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/441e7fae6894199e8fc3025efb70919d?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/441e7fae6894199e8fc3025efb70919d?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2012/06/13/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now/#comment-46372"><time datetime="2012-08-07T04:50:10+01:00">August 7, 2012 at 4:50 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>According to &quot;man bcmp&quot; on OS X, bcmp() returns &quot;zero if the byte strings are identical, non-zero otherwise.&quot; No suggestion that it returns only zero or one&#8230; </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_46372"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_46372={"id":7238218,"unique_id":"wp-comment-46372","title":"According%20to%20%26quot%3Bman%20bcmp%26quot%3B%20on%20OS%20X%2C%20bcmp%28%29%20returns%20%26quot%3Bzero%20if%20the%20byte%20strings%20are%20identical%2C%20non-zero%20otherwise.%26quot%3B%20No%20suggestion%20that%20it%20returns%20only%20zero%20or%20one...%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2012\/06\/13\/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now\/#comment-46372","item_id":"_comm_46372"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2012/06/13/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now/?replytocom=46372#respond' data-commentid="46372" data-postid="171391" data-belowelement="div-comment-46372" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">What do you think? <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2012/06/13/anatomy-of-a-bug-the-mysql-authentication-disaster-patch-now/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://nakedsecurity.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='171391' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="ff6a28b760" /></p><input type="hidden" id="ak_js" name="ak_js" value="16"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->
		<div class="comments-widget-area">
					</div>
	
	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	

	<section class="recommended-panel">
	<div class="container">
	<div class="panel-content ">

		<h3 class="block-title">Recommended reads</h3>
	<div class="blocks">
		<article id="post-545039" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/02/04/s3-ep18-apple-emergency-crypto-blunder-and-botnet-takedown-podcast/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/02/nean-with-mic-wt-orangey-1200.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Feb</span><span class="day">04</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">1</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/02/04/s3-ep18-apple-emergency-crypto-blunder-and-botnet-takedown-podcast/" rel="bookmark">S3 Ep18: Apple emergency, crypto blunder and botnet takedown [Podcast]</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-563309" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/03/18/s3-ep24-how-not-to-get-snooped-scammed-or-hoaxed-podcast/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/nean-with-mic-wt-paleish-green-1200.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Mar</span><span class="day">18</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">3</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/03/18/s3-ep24-how-not-to-get-snooped-scammed-or-hoaxed-podcast/" rel="bookmark">S3 Ep24: How not to get snooped, scammed or hoaxed [Podcast]</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-549437" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/03/02/search-crimes-how-the-gootkit-gang-poisons-google-searches/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/poison-1200.jpg?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Mar</span><span class="day">02</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">9</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/03/02/search-crimes-how-the-gootkit-gang-poisons-google-searches/" rel="bookmark">Search crimes &#8211; how the Gootkit gang poisons Google searches</a></h3>	</div>
</article> <!-- .card-article -->
	</div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="footer-container">
			<a href="#" class="js-collapse-footer"><svg style="height: 20px" viewBox="0 0 132 24" class="block icon sophos"><use xlink:href="#sophos"></use></svg></a>
			<div id="collapseFooter" class="blocks">
				<div class="sophos block">
					<ul id="menu-footer-primary" class="primary menu"><li id="menu-item-306737" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306737"><a href="https://nakedsecurity.sophos.com/about/">About Naked Security</a></li>
<li id="menu-item-306754" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306754"><a href="https://www.sophos.com/en-us/company.aspx">About Sophos</a></li>
<li id="menu-item-306747" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306747"><a href="https://nakedsecurity.sophos.com/send-us-a-tip/">Send us a tip</a></li>
<li id="menu-item-323171" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323171"><a href="/cookies-and-scripts/">Cookies</a></li>
<li id="menu-item-323170" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323170"><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
<li id="menu-item-323169" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323169"><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
</ul>				</div>
										<div class="news block">
							<ul id="menu-products-column-one" class="small menu"><li id="menu-item-306998" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306998"><a href="https://www.sophos.com/en-us/products/intercept-x.aspx">Intercept X</a></li>
<li id="menu-item-440801" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440801"><a href="https://www.sophos.com/en-us/products/server-security.aspx">Intercept X for Server</a></li>
<li id="menu-item-440802" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440802"><a href="https://www.sophos.com/en-us/products/mobile-control.aspx">Intercept X for Mobile</a></li>
</ul>						</div>
											<div class="products block">
							<ul id="menu-products-column-two" class="small menu"><li id="menu-item-440803" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440803"><a href="https://www.sophos.com/en-us/products/next-gen-firewall.aspx">XG Firewall</a></li>
<li id="menu-item-440805" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440805"><a href="https://www.sophos.com/en-us/products/sophos-email.aspx">Sophos Email</a></li>
<li id="menu-item-440804" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440804"><a href="https://www.sophos.com/en-us/products/secure-wifi.aspx">Sophos Wireless</a></li>
</ul>						</div>
											<div class="threats block">
							<ul id="menu-server-protection" class="small menu"><li id="menu-item-440806" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440806"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx">Managed Threat Response</a></li>
<li id="menu-item-448404" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-448404"><a href="https://www.sophos.com/en-us/products/cloud-optix.aspx">Cloud Optix</a></li>
<li id="menu-item-440807" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440807"><a href="https://www.sophos.com/en-us/products/phish-threat.aspx">Phish Threat</a></li>
</ul>						</div>
								</div>
			<ul class="block social footer">
				<li class="twitter"><a rel="nofollow" href="https://twitter.com/NakedSecurity" title="Follow our team of security experts on Twitter"><svg style="height: 14px" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
				<li class="facebook"><a rel="nofollow" href="https://www.facebook.com/SophosSecurity" title="Join over 250,000 people in our Facebook community"><svg style="height: 14px" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
				<li class="instagram"><a rel="nofollow" href="https://www.instagram.com/nakedsecurity/" title="Follow Naked Security on Instagram"><svg style="height: 14px" viewBox="0 0 100 100" class="icon instagram"><use xlink:href="#instagram"></use></svg></a></li>
				<li class="linkedin"><a rel="nofollow" href="https://www.linkedin.com/company/5053/" title="Join the naked security discussion group on LinkedIn"><svg style="height: 14px" viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
				<li class="rss"><a rel="nofollow" href="/feed" title="Subscribe to our RSS feed"><svg style="height: 14px" viewBox="0 0 100 100" class="icon rss"><use xlink:href="#rss"></use></svg></a></li>
			</ul>

							<div class="vip-powered-wpcom">
					<span class="copyright">© 1997 - 2021 Sophos Ltd.</span>
					All rights reserved.
					Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=nakedsecurity.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>				</div>
					</div>
		<script type="text/javascript">
			window.cookieconsent_options = {
				"message":"This site uses cookies. By continuing to browse the site you are agreeing to our use of cookies.",
				"dismiss":"Got it!",
				"learnMore":"Learn More",
				"link":"/cookies-and-scripts",
				"theme":"https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/css/sophos.css"};
		</script>
	</footer><!-- #colophon -->
</div><!-- #page -->
<div id="survey-wrapper" class="mfp-hide"><div class="pd-embed" id="pd_1499706777" data-settings=""></div></div>
<script id='child-js-plugins-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"0","nextLink":""};
</script>
<script id='child-js-core-js-extra'>
var Sophos = {"ajaxurl":"https:\/\/nakedsecurity.sophos.com\/wp-admin\/admin-ajax.php","nonce":"64f6810f0c"};
</script>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJyNjkEOwjAMBD9EalKU3hBPQZAamhDbUZyo4vdEiEocOHD07ozWsGbjhStyhbogoYJKXkQZVzXj3jqICjm1e2Adou7gL8FLwY0O7FObO/fOibppCub0HCjwL6ifSFecv/ttkpr5PAOXR1DCCufuwk0KdfZERztZdxitc1N8ARFpT3A='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161173',post:'171391',tz:'0',srv:'nakedsecurity.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161173', '171391' ]);
</script>
</body>
</html>
