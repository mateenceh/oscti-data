<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="RHQeasQqjasbRt5asY6atZYbs5tr10gFBevDt2HRhW0" />
<link rel="pingback" href="https://nakedsecurity.sophos.com/xmlrpc.php">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5VK6LTK');</script>
<!-- End Google Tag Manager -->

<meta name="description" content="A whole lot has been talked, over the past week, about BREACH, a newly-documented attack against HTTPS. Paul Ducklin digs into the theory, shows how it works in practice, and suggests how to soften the blow..." />
<meta name="keywords" content="cryptography, breach, https, ssl, tls" />
<title>Anatomy of a cryptographic oracle &#8211; understanding (and mitigating) the BREACH attack &#8211; Naked Security</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="I9dHFo-YhnK2MfAHn-20V4GnWrOttVUYyISGamyU41M" />
<meta name="msvalidate.01" content="7D8D1FA2892142B1543D2CBCD07FB88F" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Feed" href="https://nakedsecurity.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Comments Feed" href="https://nakedsecurity.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Anatomy of a cryptographic oracle &#8211; understanding (and mitigating) the BREACH attack Comments Feed" href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/feed/" />
<link rel='stylesheet' id='all-css-0' href='https://nakedsecurity.sophos.com/_static/??-eJyVz00KwjAQhuELmUwqttCFeJY0GUw0f2QmlN6+KXbnRpcD7wPfwFqETyY0iwSGCKwnhiVk8xbBL1XXDYi3gDL6JHtwgS5MToyJgR3G7igXlynhSuKqhvEE/8QiaEbiX80xVFvJrqJm4VqPq9SxfPnYRAnt6RPBC7no/tUsP/68D/KI92Eaxtuk1Kx2dxVjDA==' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqXEWAK9AIhg='></script>
<link rel="https://api.w.org/" href="https://nakedsecurity.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://nakedsecurity.sophos.com/wp-json/wp/v2/posts/231876" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://nakedsecurity.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://nakedsecurity.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/" />
<link rel='shortlink' href='https://nakedsecurity.sophos.com/?p=231876' />
<link rel="alternate" type="application/json+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2013%2F08%2F06%2Fanatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2013%2F08%2F06%2Fanatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Anatomy of a cryptographic oracle &#8211; understanding (and mitigating) the BREACH attack" />
<meta property="og:url" content="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/" />
<meta property="og:description" content="A whole lot has been talked, over the past week, about BREACH, a newly-documented attack against HTTPS. Paul Ducklin digs into the theory, shows how it works in practice, and suggests how to soften…" />
<meta property="article:published_time" content="2013-08-06T09:02:40+00:00" />
<meta property="article:modified_time" content="2017-02-22T16:28:59+00:00" />
<meta property="og:site_name" content="Naked Security" />
<meta property="og:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/breach-250.png?w=250" />
<meta property="og:image:secure_url" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/breach-250.png?w=250" />
<meta property="og:image:width" content="250" />
<meta property="og:image:height" content="250" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@NakedSecurity" />
<meta name="twitter:text:title" content="Anatomy of a cryptographic oracle &#8211; understanding (and mitigating) the BREACH attack" />
<meta name="twitter:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/breach-250.png?w=144" />
<meta name="twitter:card" content="summary" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=270" />
</head>
<body class="post-template-default single single-post postid-231876 single-format-standard" >
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VK6LTK"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div style="display: none">
<svg>
	<symbol id="sophos" viewBox="0 0 132 24">
		<path d="m111.82 22.176h11.64c3.267 0 4.65-0.2 5.74-0.896 1.715-1.063 2.804-3.26 2.804-5.62 0-1.928-0.658-3.89-1.647-4.888-1.288-1.33-3.035-1.828-6.271-1.828h-3.527c-1.586 0-2.754-0.067-3.412-0.365-0.794-0.367-1.256-1.165-1.256-2.161 0-1.165 0.56-2.03 1.486-2.264 0.692-0.163 1.498-0.163 3.574-0.198h10.419v-3.956h-11.473c-2.574 0-3.727 0.099-4.718 0.466-2.279 0.796-3.828 3.257-3.828 6.083 0 1.93 0.76 3.727 2.079 4.89 1.155 0.996 2.872 1.462 5.51 1.462h4.697c1.057 0 1.915 0.132 2.376 0.398 0.893 0.433 1.418 1.328 1.418 2.36 0 0.864-0.395 1.597-1.087 2.027-0.561 0.369-1.517 0.534-3.268 0.534h-11.256zm-111.35 0h11.64c3.267 0 4.652-0.2 5.741-0.896 1.714-1.063 2.803-3.26 2.803-5.62 0-1.928-0.66-3.89-1.65-4.888-1.285-1.33-3.034-1.828-6.27-1.828h-3.527c-1.584 0-2.751-0.067-3.41-0.365-0.792-0.367-1.253-1.165-1.253-2.161 0-1.165 0.56-2.03 1.484-2.264 0.693-0.163 1.496-0.163 3.574-0.198h10.42v-3.956h-11.477c-2.573 0-3.727 0.099-4.715 0.466-2.278 0.796-3.83 3.257-3.83 6.083 0 1.93 0.762 3.727 2.08 4.89 1.155 0.996 2.871 1.462 5.51 1.462h4.696c1.057 0 1.913 0.132 2.377 0.398 0.888 0.433 1.416 1.328 1.416 2.36 0 0.864-0.394 1.597-1.089 2.027-0.558 0.369-1.517 0.534-3.264 0.534h-11.256v3.956zm94.05-16.18c-0.68 1.076-1.003 2.803-1.003 5.122 0 5.088 1.747 7.405 5.63 7.405 3.822 0 5.568-2.317 5.568-7.34 0-5.092-1.715-7.373-5.568-7.373-2.102 0-3.754 0.784-4.627 2.186zm13.174-2.511c1.329 1.761 2.072 4.63 2.072 7.992 0 3.816-1.197 6.948-3.334 8.677-1.619 1.304-4.078 2.022-6.995 2.022-4.142 0-7.41-1.372-9.092-3.817-1.263-1.793-1.88-4.176-1.88-7.08 0-4.172 1.133-7.339 3.27-9.035 1.682-1.37 4.339-2.122 7.383-2.122 3.85 0 6.925 1.209 8.576 3.363zm-22.018-3.068h-4.596v8.908h-8.319v-8.908h-4.597v21.759h4.597v-8.97h8.318v8.97h4.596v-21.759zm-28.61 10.277c1.23 0 1.941-0.163 2.427-0.62 0.581-0.49 0.938-1.533 0.938-2.74 0-1.436-0.58-2.478-1.584-2.838-0.356-0.13-0.94-0.197-1.684-0.197h-6.344v6.395zm-6.247 11.481h-4.598v-21.758h10.78c3.786 0 5.114 0.39 6.538 1.991 1.264 1.37 1.942 3.163 1.942 5.088 0 2.284-0.904 4.404-2.394 5.676-1.262 1.077-2.43 1.402-4.888 1.402h-7.38zm-22.589-16.179c-0.682 1.076-1.004 2.803-1.004 5.122 0 5.088 1.748 7.405 5.634 7.405 3.818 0 5.568-2.317 5.568-7.34 0-5.092-1.716-7.373-5.568-7.373-2.106 0-3.757 0.784-4.63 2.186zm13.174-2.511c1.328 1.761 2.073 4.63 2.073 7.992 0 3.816-1.2 6.948-3.335 8.677-1.618 1.304-4.079 2.022-6.993 2.022-4.144 0-7.413-1.372-9.096-3.817-1.264-1.793-1.878-4.176-1.878-7.08 0-4.172 1.133-7.339 3.272-9.035 1.681-1.37 4.337-2.122 7.38-2.122 3.851 0 6.93 1.209 8.578 3.363z"></path>
	</symbol>
	<symbol id="twitter" viewBox="0 0 24 24">
 		<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path>
 	</symbol>
	<symbol id="facebook" viewBox="0 0 24 24">
 		<path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path>
 	</symbol>
	<symbol id="instagram" viewBox="0 0 24 24">
		<path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path>
	</symbol>
	<symbol id="linkedin" viewBox="0 0 24 24">
		<path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"></path>
	</symbol>
	<symbol id="rss" viewBox="0 0 24 24">
		<path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"></path>
	</symbol>
	<symbol id="reddit" viewBox="0 0 24 24">
		<path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"></path>
	</symbol>
</svg>
</div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header variation variation-3" role="banner">
		<div class="header-container">
			<div class="site-branding">
				<div class="site-title">
					<a title="Naked Security" href="https://nakedsecurity.sophos.com/" rel="home"><img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/naked-security-logo-white@2x.png"></a>
					by
					<a title="sophos.com" href="https://www.sophos.com"><svg viewBox="0 0 132 24" class="icon sophos"><use xlink:href="#sophos"></use></svg></a>
				</div>
			</div><!-- .site-branding -->
			<nav id="site-navigation" class="main-navigation" role="navigation">
				<div class="container">
					<ul id="menu-variation-two" class="exit-links menu"><li id="menu-item-436509" class="products menu-item menu-item-type-custom menu-item-object-custom menu-item-436509"><a href="#">Products</a></li>
<li id="menu-item-436515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436515"><a href="https://www.sophos.com/en-us/products/free-tools.aspx">Free Tools</a></li>
<li id="menu-item-436531" class="search-toggle menu-item menu-item-type-custom menu-item-object-custom menu-item-436531"><a href="#">Search</a></li>
<li id="menu-item-436532" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436532"><a href="https://home.sophos.com/en-us.aspx">Free Sophos Home</a></li>
</ul>				</div>
			</nav><!-- #site-navigation -->
			<div class="site-search-block">
	<form target="_top" role="search" class="search-form" method="get" action="https://nakedsecurity.sophos.com/">
        <fieldset>
            <div class="field">
				<input type="search" value="" name="s" class="search-field" placeholder="Search naked security...">
            </div>
            <div class="submit">
				<button type="submit" class="search-submit button">Go</button>
            </div>
        </fieldset>
    </form>
</div>
		</div><!-- .container -->
	</header>

	<div class="responsive-flyout-panel small-12 column active" style="opacity: 1; display: none;">
		<div class="modal-filler"></div>
	    <div class="productNavBox">
	        <div class="productNavContainer">
	            <div class="row prodRow">
	                <div class="prodListBox column large-9">
	                    <div class="row margin-0 highlightProduct">
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/next-gen-firewall.aspx"><img src="https://www.sophos.com/medialibrary/2F4785DE8C3F43ECBD699A18F332FEEB.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">XG Firewall</div>
	                                	<div class="menu-section-subtitle">Next-Gen Firewall</div>
									</div>
	                            </a>
	                        </div>
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/intercept-x.aspx"><img src="https://www.sophos.com/medialibrary/27111765D65A45D49A232925D2CE428B.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">Intercept X</div>
	                                	<div class="menu-section-subtitle">Next-Gen Endpoint</div>
									</div>
	                            </a>
	                        </div>
	                    </div>
	                    <div class="productList">
	                        <ul>
								<li>
									<a href="https://www.sophos.com/en-us/products/cloud-optix.aspx"><img src="https://www.sophos.com/medialibrary/SophosNext/Images/Products/Icons/sophos-cloud-optix-icon.svg">Sophos Cloud Optix</a>
								</li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-central.aspx"><img src="https://www.sophos.com/medialibrary/08EA66123F1B4DDE8FE5C9B578A7FAA7.ashx">Sophos Central</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/mobile-control.aspx"><img src="https://www.sophos.com/medialibrary/678FE994855047739F50D6C411184FA6.ashx">Sophos Mobile</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/server-security.aspx"><img src="https://www.sophos.com/medialibrary/01B80E7D7CD54EF8AC2E51C9C6EC0236.ashx">Intercept X for Server</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-wifi.aspx"><img src="https://www.sophos.com/medialibrary/BEBD9C41BB4E480498514B29B92A145A.ashx">Secure Wi-Fi</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/phish-threat.aspx"><img src="https://www.sophos.com/medialibrary/DC9D1A7BA3964B0C9DAF1F1E68806B5A.ashx">Phish Threat</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/safeguard-encryption.aspx"><img src="https://www.sophos.com/medialibrary/8F51F06B62814B108D3B2763FF018E37.ashx">SafeGuard Encryption</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-email.aspx"><img src="https://www.sophos.com/medialibrary/597ADA0AF01A4A12B2B27239D0F9992C.ashx">Secure Email</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/unified-threat-management.aspx"><img src="https://www.sophos.com/medialibrary/8CB72BF5E1AD41F7894CE5E42101B0F3.ashx">SG UTM</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-web-gateway.aspx"><img src="https://www.sophos.com/medialibrary/C586E372694547A1B207A61D87246BA7.ashx">Secure Web Gateway</a>
	                            </li>
	                        </ul>
	                    </div>
	                </div>
	                <div class="homeUserBox column large-3">
						<img src="https://www.sophos.com/medialibrary/3376DF5742A64AEE93FDB9DCA7291239.ashx">
						<div class="menu-section-title">For Home Users</div>
	                    <p>Sophos Home protects every Mac and PC in your home </p><a href="https://home.sophos.com/" target="_blank" class="greenSmallMenuBtn">Learn More</a>
					</div>
	            </div>
	            <div class="row blueRow">
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-tools.aspx"><img width="19" src="https://www.sophos.com/medialibrary/A1FF440D2BB84511B8C94D771D44E207.ashx">Free Security Tools</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-trials.aspx"><img width="20" src="https://www.sophos.com/medialibrary/FCD3410ED2C347808D9DB8AC12C62DBD.ashx">Free Trials</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/demos.aspx"><img width="18" src="https://www.sophos.com/medialibrary/50985180E5F54C94917A2A6508E24287.ashx">Product Demos</a>
	                </div>
	                <!-- <div class="column large-3 medium-6">
	                    <a href="javascript:fairfax.openLiveChatFromFlyoutLink();" class="flyout-live-chat-link"><img width="20" src="https://www.sophos.com/medialibrary/E24C5050837145F6A5C592E299BA2A0D.ashx">Live Sales Chat</a>
	                </div> -->
	            </div>
	        </div>
	    </div>
	</div>
	<script>

	jQuery(document).ready( function () {
		var productButton   = jQuery('nav .menu-item.products');
		var modalBackground = jQuery('.modal-filler');
		var flyoutMenu		= jQuery('.responsive-flyout-panel');
		var Sophos			= Sophos || {};

		Sophos.MenuTest = {};

		Sophos.MenuTest.open = function () {
				productButton.addClass('open');
				flyoutMenu.show();
				modalBackground.show();
		};

		Sophos.MenuTest.close = function () {
			productButton.removeClass('open');
			flyoutMenu.hide();
			modalBackground.hide();
		};

		Sophos.MenuTest.toggle = function () {
			if ( productButton.hasClass('open') ) {
				Sophos.MenuTest.close();
			} else {
				Sophos.MenuTest.open();
			}
		};

		productButton.click( Sophos.MenuTest.toggle );
		modalBackground.click( Sophos.MenuTest.close );
	});

	</script>

	
	<section class="about-panel">
	<div class="container">
	<div class="panel-content ">

		<div class="description"><span>Have you listened to our podcast? <a href="/podcast/">Listen now</a></span></div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	<div id="content" class="site-content">
		<div class="content-container">

</div> <!-- .container -->
</div> <!-- #content -->


	<section class="content-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

		<main id="main" class="site-main" role="main">

	
		
<article id="post-231876" class="post-231876 post type-post status-publish format-standard has-post-thumbnail hentry category-cryptography category-featured tag-breach tag-https tag-ssl tag-tls">

	<header class="entry-header">
		<h1 class="entry-title">Anatomy of a cryptographic oracle &#8211; understanding (and mitigating) the BREACH attack</h1>		<div class="entry-meta">
			<div>
				
	<span class="entry-published">
		<time class="entry-date published" datetime="2013-08-06T10:02:40+01:00">06 Aug 2013</time>
	</span>

					<a href="#comments" class="comment-box">
					<span class="count">20</span>
				</a>
					
	<span class="entry-categories">
	<a href="https://nakedsecurity.sophos.com/category/cryptography/">Cryptography</a>	</span>

			</div>
	</header> <!-- .entry-header -->

    <div id="newsletter-signup" class="container top"></div>

			<div class="entry-featured-image">
			<img width="250" height="250" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/breach-250.png?w=250&amp;h=250&amp;crop=1" class="attachment-hero-thumbnail size-hero-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/breach-250.png 250w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/breach-250.png?resize=150,150 150w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/breach-250.png?resize=225,225 225w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/breach-250.png?resize=70,70 70w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/breach-250.png?resize=32,32 32w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/breach-250.png?resize=50,50 50w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/breach-250.png?resize=64,64 64w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/breach-250.png?resize=96,96 96w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/breach-250.png?resize=128,128 128w" sizes="(max-width: 250px) 100vw, 250px" />					</div> <!-- .entry-featured-image -->
		
		<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2013/08/05/freedom-hosting-arrest-and-takedown-linked-to-tor-privacy-compromise/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> Freedom Hosting arrest and takedown linked to Tor privacy compromise</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2013/08/06/ok-who-uses-their-pets-name-as-their-password/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Ok, who uses their pet&#8217;s name as their password?</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	<div class="entry-content">
		<div class="entry-prefix">
			<div class="entry-author">
				
	
					<span class="by">by</span>
			<a href="https://nakedsecurity.sophos.com/author/paul-ducklin/" title="Posts by Paul Ducklin" class="author url fn" rel="author">Paul Ducklin</a>		
	
				</div>
			<div class="entry-sharing">
				
	<ul class="block social share">
		<li class="facebook"><a href="https://www.facebook.com/share.php?u=https%3A%2F%2Fnakedsecurity.sophos.com%2F2013%2F08%2F06%2Fanatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack%2F&title=Anatomy+of+a+cryptographic+oracle+%E2%80%93+understanding+%28and+mitigating%29+the+BREACH+attack" data-title="Anatomy of a cryptographic oracle – understanding (and mitigating) the BREACH attack" title="Share on Facebook"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
		<li class="twitter"><a href="https://twitter.com/intent/tweet?text=Anatomy+of+a+cryptographic+oracle+%E2%80%93+understanding+%28and+mitigating%29+the+BREACH+attack+https%3A%2F%2Fnakedsecurity.sophos.com%2F%3Fp%3D231876" data-title="Anatomy of a cryptographic oracle &#8211; understanding (and mitigating) the BREACH attack" title="Share on Twitter"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
		<li class="linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2013%2F08%2F06%2Fanatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack%2F&title=Anatomy+of+a+cryptographic+oracle+%E2%80%93+understanding+%28and+mitigating%29+the+BREACH+attack" data-title="Anatomy of a cryptographic oracle – understanding (and mitigating) the BREACH attack" title="Share on LinkedIn"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
		<li class="reddit"><a href="https://reddit.com/submit/?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2013%2F08%2F06%2Fanatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack%2F&title=Anatomy+of+a+cryptographic+oracle+%E2%80%93+understanding+%28and+mitigating%29+the+BREACH+attack" title="Share on Reddit"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon reddit"><use xlink:href="#reddit"></use></svg></a></li>

			</ul>

				</div>
		</div>
		<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2013/08/breach-170.png" width="170" height="182" align="right" hspace="10"></img>A whole lot has been talked, over the past week, about a newly-documented attack against secure HTTP, better known as HTTPS.</p>
<p>The attack is dubbed BREACH, fancifully expanded as <em>Browser Reconnaissance and Exfiltration via Adaptive Compression of Hypertext</em>.</p>
<p>Its notoriety comes from the fact that it <a href="https://www.blackhat.com/us-13/briefings.html#Prado" rel="nofollow">was presented</a> at the BlackHat 2013 conference.</p>
<p>There seems to be a fair bit of misunderstanding of exactly how BREACH works, and therefore how it might be mitigated or fixed.</p>
<p>Some articles have likened BREACH to previous attacks against secure HTTP, such as <a href="https://www.blackhat.com/us-13/briefings.html#Prado">Lucky 13</a> and <a href="http://nakedsecurity.sophos.com/2011/09/24/secure-web-browsing-cracked-by-beast/">BEAST</a>.</p>
<p>But that&#8217;s not the full story, because those earlier attacks were against <a href="http://en.wikipedia.org/wiki/Secure_Socket_Layer" rel="nofollow">TLS</a>.</p>
<p>TLS is the cryptographic wrapper, known as Transport Layer Security, that provides a secure conduit for electronic transactions of many sorts, notably web and email.</p>
<p>BREACH is really an attack against HTTP itself, the hypertext transfer protocol that is used ubiquitously for delivering web pages.</p>
<p>Indeed, you could even use the BREACH attack against an unencrypted web session, if you were unable to sniff the entire session but could only capture certain metadata about it, such as the lengths of HTTP replies.</p>
<h4>What sort of attack is BREACH?</h4>
<p>BREACH is what&#8217;s known as an <a href="http://www.drdobbs.com/understanding-oracle-attacks-on-informat/184405917" rel="nofollow"><em>oracle attack</em></a>.</p>
<p>That&#8217;s where you are able to fire some questions at a computer system, observe the answers that come back, and use them to infer facts that the answers didn&#8217;t intend to disclose &#8211; regardless of how garbled or irrelevant those answers might seem at first.</p>
<p style='background-color:#e8e8e8;font-size:80%;padding:.71em;padding-left:2em;text-indent:-1.29em;'>&rarr; The name comes from the Oracle at Delphi, a Greek priestess who would answer questions while under the influence of psychotropic vapours. Presumably, the answers were trippily disconnected enough to be useless on their own, but were nevertheless interpreted by priestly intermediaries in an attempt to make them shed light on the issues under consideration.</p>
<p>A easy-to-understand example is given in a <a href="http://security.stackexchange.com/questions/20406/is-http-compression-safe" rel="nofollow">discussion on StackExchange</a> from nearly a year ago, where the poster, Thomas Pornin, describes a trick he says was used in World War One by French codebreakers.</p>
<p>They noticed that the Germans included the rank of the intended recipient in the preamble of their messages, and though it was encrypted, the Germans did not disguise the length of this field.</p>
<p>So messages to the Colonel (<em>Oberst</em>) would stand out from messages to a junior officer (<em>Oberleutnant</em>) simply because of the difference in length of the two words.</p>
<p>Since messages to the Colonel were generally much more important, they were attempted first.</p>
<h4>How does BREACH work?</h4>
<p>The attack relies on the fact that many web pages are compressed to save bandwidth before they are sent out. </p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2013/08/vulno-deflate-183.png" width="183" height="137" align="right" hspace="10"></img>Loosely speaking, the web server takes the body of an HTTP reply and squashes it with an algorithm known as <a href="http://tools.ietf.org/html/rfc1951" rel="nofollow">deflate</a>, the same compression that is used in PKZIP and gzip. </p>
<p>On arrival, your browser inflates it and processes it from there as if the HTTP session had been uncompressed all along.</p>
<p>Even when a compressed HTTP response is wrapped in TLS encryption to produce a secure HTTPS connection, the actual length of the encrypted data stream (more precisely, the length of the compressed data inside the encrypted stream) can be determined.</p>
<p>And by trying lots of different inputs, each slightly different from the last, and seeing how well or badly they compress, you may be able to guess some of what&#8217;s inside, even though you can&#8217;t decrypt any of the messages</p>
<h4>A practical example</h4>
<p>Imagine a vendor&#8217;s website that has a page on which you can search for invoices. </p>
<p>Of course, you need to login to get access, so when you first visit the search page, you&#8217;ll be asked to do so:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2013/08/vulno-login-486.png" width="486" height="272"></img></p>
<p>Once that&#8217;s out of the way, the web server will probably set a session cookie that your browser will send in the headers of future HTTP requests in order to denote that you have successfully logged in. </p>
<p>(An attacker can&#8217;t just use an automatic tool like <a href="http://nakedsecurity.sophos.com/2010/10/26/secure-websites-insecure/">Firesheep</a> to grab the cookie by sniffing &#8211; the traffic is encrypted over HTTPS.)</p>
<p>Now you can carry out a search:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2013/08/vulno-search-487.png" width="487" height="272"></img></p>
<p>You get back an answer which looks like this:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2013/08/vulno-search-result-487.png" width="487" height="272"></img></p>
<p>The raw HTML, decrypted and inflated, looks like this:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2013/08/vulno-html-487.png" width="487" height="242"></img></p>
<p>Because the content is encrypted in transmission, it doesn&#8217;t seem inappropriate to include what amounts to Personally Identifiable Information (PII) in the body of the web page, in this case the login ID <tt>10462897</tt>.</p>
<p>But notice that even though the web page is encrypted, there is one part that you can not only predict, but control precisely: the search term that you entered into the search box.</p>
<p>For example, once you&#8217;ve logged in and a suitable session cookie has been set by the vendor&#8217;s server, you can bypass the search box and control the search results by directly tweaking the search URL:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2013/08/vulno-search-result-chosen-annot-487.png" width="487" height="272"></img></p>
<p>Now stop to ask yourself, &#8220;In the web page above, where the login ID appears twice in close proximity, what would happen to the compression ratio?&#8221;</p>
<p>The deflate algorithm works by detecting repeated byte sequences in the input, and avoiding repeating them in the output.</p>
<p>Instead of outputting <tt>10462897</tt> a second time, the compressor says, &#8220;I already saw the next eight characters 66 characters ago.&#8221;</p>
<p>So if you run a series of searches, with each search term being a guess at the login ID, you&#8217;d expect to get back HTTP replies of varying length.</p>
<p>In theory, the better your guess, the better the reply will compress (because of the repeated data), and the shorter it will be.</p>
<h4>From oracular response to probable fact</h4>
<p>For our imaginary website, I wrote a tiny HTML page that uses JavaScript to force you to perform 10000 searches of the <tt>vulnocorp.test</tt> website, each embedded in a tiny IFRAME:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2013/08/vulno-script-487.png" width="487" height="147"></img></p>
<p>I left each IFRAME visible, just for visual confirmation that the multi-search script was working and harvesting results for every four-digit combination, despite the script&#8217;s tiny size:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2013/08/vulno-hitme-487.png" width="487" height="273"></img></p>
<p>Using the Firebug debugger shows us the HTML that was generated and actually rendered in the browser:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2013/08/vulno-firebug-480.png" width="480" height="330"></img></p>
<p>(In practice, those IFRAMES could be be made smaller, and hidden in amongst legitimate-looking content, or even made entirely invisible.)</p>
<p>I measured the compressed sizes of the 10,000 HTML pages that were returned.</p>
<p>There wasn&#8217;t much variety in the compressed lengths, which ranged from 267 to 270 bytes, but there was a massive skew in how many times each length showed up, to the extent that I had to use a logarithmic scale to make the graph fit:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2013/08/vulno-graph-487.png" width="487" height="159"></img></p>
<p>It would be a good guess that, amongst the 30 replies that gave a minimum compressed length (i.e. compressed the best through having most repetition), we would find:</p>
<ul>
<li>Search terms with four repeated digits, e.g. 7777.</li>
<li>Search terms with three or four characters that match a substring in the login ID.</li>
</ul>
<p>And so it turned out, as you can see from the list of the 30 &#8220;best compressed&#8221; search terms:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2013/08/vulno-chain-487.png" width="487" height="226"></img></p>
<p>In the above list I was easily able to construct a chain of four-digit values in which the last three digits of one value overlapped with the first three of the next.</p>
<p>There&#8217;s a potential ambiguity at 6289, the fourth block, which can be followed by 2890, 2893 or 2897.</p>
<p>But only 2897 is followed by other sequences in the list (8790 and 8793), suggesting that the three digits 897 make up the end of the  login ID.</p>
<p>Technically, I haven&#8217;t decrypted anything, but I have nevertheless recovered a modest but significant block of data from the encrypted stream: the value of the eight-digit login ID, <tt>10462897</tt>.</p>
<p>And that, in an admittedly fairly extensive nutshell, is the nature of the BREACH attack.</p>
<h4>Defending againt BREACH</h4>
<p>Clearly, to use my imaginary attack in real life, the following are required:</p>
<ul>
<li>The HTTP pages must include both the PII that I want to guess and some chosen plaintext that I can control.
<li>The server must be requested, and configured, to serve the pages with compression turned on.
<li>I need to persuade you, while you are logged in, to visit a page containing my malicious do-lots-of-searches JavaScript.
<li>I have to know what sort of PII I am looking for in order to structure my searches correctly.
<li>I have to be able to sniff your traffic in sufficient detail to recover the length of each HTTP reply.
</ul>
<p>So, if you run a web server and you turn off compression for any pages that include PII, you neutralise this attack.</p>
<p>On the other side of the equation, you may be able to force your browser not to invite the use of HTTP compression in the first place, thus neutralising the attack.</p>
<p>For example, in Firefox, the <tt>about:config</tt> page allows you to edit the <tt>Accept-Encoding:</tt> header sent by the browser, changing it from the default of <tt>gzip, deflate</tt> to an empty string, meaning, &#8220;No compression, thanks&#8221;:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2013/08/vuln-fffix-487.png" width="487" height="245"></img></p>
<p>If any readers know how to achieve similar results in their favourite browsers, please let us know in the comments!</p>
<p style='padding-bottom:.8em;padding-top:.8em;'></p>
<p style='background-color:#e8e8e8;font-size:80%;padding:.71em;'><strong>NB.</strong> Be aware that if you configure your browser to disallow compressed HTTP replies, your bandwidth use is likely to increase significantly. Compression will be off even for unencrypted web pages (where an attacker who can sniff your HTTP reply lengths can probably just grab the raw data anyway), and for pages where BREACH is irrelevant because there is no PII to extract. By way of example, I just loaded a Naked Security page that used up 183 KBytes with compression enabled, but would have taken more than 500 KBytes without.</p>
			</div> <!-- .entry-content -->
	<ul class="block social follow">
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon twitter"><use xlink:href="#twitter"></use></svg>
			<p>Follow <strong><a href="https://twitter.com/nakedsecurity">@NakedSecurity on Twitter</a></strong> for the latest computer security news.</p>
		</li>
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon instagram"><use xlink:href="#instagram"></use></svg>
			<p>Follow <strong><a href="https://www.instagram.com/nakedsecurity/">@NakedSecurity on Instagram</a></strong> for exclusive pics, gifs, vids and LOLs!</p>
		</li>
	</ul>
</article><!-- #post-## -->

		<div class="free-tools-block">
			<h2 class="block-title">Free tools</h2>

<div class="ns-free-tools">
	<div class="ns-free-tools__item ns-free-tools__item--sophos-home">
		<a class="ns-free-tools__link" href="https://home.sophos.com/en-us.aspx?cmp=701j0000001eLpnAAE">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/sophos-home@2x.png" alt="Sophos Home" class="ns-free-tools__image" width="166" height="100">
			<h4 class="ns-free-tools__title">
				Sophos Home			</h4>
			<div class="ns-free-tools__sub-title">
				Protect personal PCs and Macs			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--hitman-pro">
		<a class="ns-free-tools__link" href="https://www.hitmanpro.com/en-us/hmp.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/hitman-pro@2x.png" alt="Hitman Pro" class="ns-free-tools__image" width="154" height="100">
			<h4 class="ns-free-tools__title">
				Hitman Pro			</h4>
			<div class="ns-free-tools__sub-title">
				Find and remove malware			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--intercept-x">
		<a class="ns-free-tools__link" href="https://www.sophos.com/en-us/products/free-tools/sophos-mobile-security-free-edition.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/mobile-security-android@2x.png" alt="Sophos Intercept X for Mobile" class="ns-free-tools__image" width="96" height="110">
			<h4 class="ns-free-tools__title">
				Intercept X for Mobile			</h4>
			<div class="ns-free-tools__sub-title">
				Protect Android devices			</div>
		</a>
	</div>
</div>
		</div>

			<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2013/08/05/freedom-hosting-arrest-and-takedown-linked-to-tor-privacy-compromise/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> Freedom Hosting arrest and takedown linked to Tor privacy compromise</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2013/08/06/ok-who-uses-their-pets-name-as-their-password/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Ok, who uses their pet&#8217;s name as their password?</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	
	</main><!-- #main -->

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<section class="comments-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

			
<div id="comments" class="comments-area">

			<h2 class="comments-title">
			20 comments on &ldquo;<span>Anatomy of a cryptographic oracle &#8211; understanding (and mitigating) the BREACH attack</span>&rdquo;		</h2>

		<ol class="comment-list">
					<li id="comment-229748" class="comment even thread-even depth-1 parent">
			<article id="div-comment-229748" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/7fac19946bc14e57d5487a058152d269?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7fac19946bc14e57d5487a058152d269?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Mr C</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#comment-229748"><time datetime="2013-08-06T10:45:08+01:00">August 6, 2013 at 10:45 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Very interesting, do you know if IIS 7. 5 with PHP would by default compress pages? I think we have the PHP cache installed.  </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_229748"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_229748={"id":7238218,"unique_id":"wp-comment-229748","title":"Very%20interesting%2C%20do%20you%20know%20if%20IIS%207.%205%20with%20PHP%20would%20by%20default%20compress%20pages%3F%20I%20think%20we%20have%20the%20PHP%20cache%20installed.%20%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/06\/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack\/#comment-229748","item_id":"_comm_229748"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/?replytocom=229748#respond' data-commentid="229748" data-postid="231876" data-belowelement="div-comment-229748" data-respondelement="respond" data-replyto="Reply to Mr C" aria-label='Reply to Mr C'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-229869" class="comment odd alt depth-2 parent">
			<article id="div-comment-229869" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#comment-229869"><time datetime="2013-08-06T14:28:29+01:00">August 6, 2013 at 2:28 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>No idea. But in logging stuff for my images I got a bunch of pages from IIS 7.5 servers that were (from memory) all compressed where that made sense, e.g. for HTML, CSS and JS but not for already-compressed stuff like GIFs and PNGs. </p>
<p>Of course, that was for HTTP pages, not HTTPS &#8211; the IIS default for secure pages *might* be uncompressed precisely because this &quot;oracle attack&quot; is not a new idea. </p>
<p>Anyone know the answer for Mr C? </p>
<p>(Not to naysay the BEAST paper, of course &#8211; it&#039;s a new PoC to make the dangers clear &#8211; but this sort of danger has been known, if perhaps not appreciated, for some time.) </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_229869"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_229869={"id":7238218,"unique_id":"wp-comment-229869","title":"No%20idea.%20But%20in%20logging%20stuff%20for%20my%20images%20I%20got%20a%20bunch%20of%20pages%20from%20IIS%207.5%20servers%20that%20were%20%28from%20memory%29%20all%20compressed%20where%20that%20made%20sense%2C%20e.g.%20for%20HTML%2C%20CSS%20and%20JS%20but%20not%20for%20already%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/06\/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack\/#comment-229869","item_id":"_comm_229869"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/?replytocom=229869#respond' data-commentid="229869" data-postid="231876" data-belowelement="div-comment-229869" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-4695647" class="comment even depth-3 parent">
			<article id="div-comment-4695647" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/f049fe6727867307ba8f993721b21021?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f049fe6727867307ba8f993721b21021?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Jan Reilink</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#comment-4695647"><time datetime="2017-02-22T14:27:32+00:00">February 22, 2017 at 2:27 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>You&#8217;d have to disable Static- and Dynamic HTTP Compression in IIS, which can be done on a per website basis. </p>
<p>PS: I noticed a typo in the &#8220;Defending agains&#8221; part: S&#8221;o, if you run a web server and you turn off compression for any pages that inlcude PII, you neutralise this attack.&#8221;</p>
<p>Here, &#8220;inlcude&#8221; must be &#8220;include&#8221; 🙂</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_4695647"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_4695647={"id":7238218,"unique_id":"wp-comment-4695647","title":"You%26%23039%3Bd%20have%20to%20disable%20Static-%20and%20Dynamic%20HTTP%20Compression%20in%20IIS%2C%20which%20can%20be%20done%20on%20a%20per%20website%20basis.%20PS%3A%20I%20noticed%20a%20typo%20in%20the%20%26quot%3BDefending%20agains%26quot%3B%20part%3A%20S%26quot%3Bo%2C%20if%20you%20run%20a%20web%20server%20and%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/06\/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack\/#comment-4695647","item_id":"_comm_4695647"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/?replytocom=4695647#respond' data-commentid="4695647" data-postid="231876" data-belowelement="div-comment-4695647" data-respondelement="respond" data-replyto="Reply to Jan Reilink" aria-label='Reply to Jan Reilink'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-4695666" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-4">
			<article id="div-comment-4695666" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#comment-4695666"><time datetime="2017-02-22T16:29:16+00:00">February 22, 2017 at 4:29 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Fixed the typo, thanks!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_4695666"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_4695666={"id":7238218,"unique_id":"wp-comment-4695666","title":"Fixed%20the%20typo%2C%20thanks%21%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/06\/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack\/#comment-4695666","item_id":"_comm_4695666"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/?replytocom=4695666#respond' data-commentid="4695666" data-postid="231876" data-belowelement="div-comment-4695666" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-229764" class="comment even thread-odd thread-alt depth-1 parent">
			<article id="div-comment-229764" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Obliterator</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#comment-229764"><time datetime="2013-08-06T11:19:54+01:00">August 6, 2013 at 11:19 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Good article. Thanks.  </p>
<p>So could I not just configure the server to output some random hidden text to each page each time to mitigate against this whilst still using compression? </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_229764"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_229764={"id":7238218,"unique_id":"wp-comment-229764","title":"Good%20article.%20Thanks.%20%20%20So%20could%20I%20not%20just%20configure%20the%20server%20to%20output%20some%20random%20hidden%20text%20to%20each%20page%20each%20time%20to%20mitigate%20against%20this%20whilst%20still%20using%20compression%3F%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/06\/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack\/#comment-229764","item_id":"_comm_229764"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/?replytocom=229764#respond' data-commentid="229764" data-postid="231876" data-belowelement="div-comment-229764" data-respondelement="respond" data-replyto="Reply to Obliterator" aria-label='Reply to Obliterator'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-229855" class="comment odd alt depth-2">
			<article id="div-comment-229855" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/44aca4fe646a4be9a73388b56cc19085?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/44aca4fe646a4be9a73388b56cc19085?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">2072</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#comment-229855"><time datetime="2013-08-06T13:57:36+01:00">August 6, 2013 at 1:57 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I think so but make sure this random text is also random in length and compresses badly. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_229855"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_229855={"id":7238218,"unique_id":"wp-comment-229855","title":"I%20think%20so%20but%20make%20sure%20this%20random%20text%20is%20also%20random%20in%20length%20and%20compresses%20badly.%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/06\/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack\/#comment-229855","item_id":"_comm_229855"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/?replytocom=229855#respond' data-commentid="229855" data-postid="231876" data-belowelement="div-comment-229855" data-respondelement="respond" data-replyto="Reply to 2072" aria-label='Reply to 2072'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-229866" class="comment even depth-2">
			<article id="div-comment-229866" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#comment-229866"><time datetime="2013-08-06T14:22:43+01:00">August 6, 2013 at 2:22 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I suppose you could add an HTML comment of randomly-varying length to mess up the stats so that good compression might be made to look bad by a long random comment, and bad compression made to look good by a short one.  </p>
<p>It&#039;s the length that needs to vary. If you dump a fixed-size random string into each HTML page you won&#039;t make any difference to which outputs compress the most , only to how long those shortest outputs are. (Generally speaking, this attack is about relative sizes, not absolutes.)  </p>
<p>Just be careful that by adding a hack like this you don&#039;t introduce some other flaw 🙂  </p>
<p>(And use a good PRNG!) </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_229866"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_229866={"id":7238218,"unique_id":"wp-comment-229866","title":"I%20suppose%20you%20could%20add%20an%20HTML%20comment%20of%20randomly-varying%20length%20to%20mess%20up%20the%20stats%20so%20that%20good%20compression%20might%20be%20made%20to%20look%20bad%20by%20a%20long%20random%20comment%2C%20and%20bad%20compression%20made%20to%20lo%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/06\/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack\/#comment-229866","item_id":"_comm_229866"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/?replytocom=229866#respond' data-commentid="229866" data-postid="231876" data-belowelement="div-comment-229866" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-229882" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-229882" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">@anshuman_bh</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#comment-229882"><time datetime="2013-08-06T14:58:40+01:00">August 6, 2013 at 2:58 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I think there is a typo here. Notice the difference in numbers. You have mentioned 98 in some places where it should be 89: </p>
<p>&quot;<br />
There&#039;s a potential ambiguity at 6298, the fourth block, which can be followed by 2980, 2893 or 2897. </p>
<p>But only 2987 is followed by other sequences in the list (8790 and 8793), suggesting that the three digits 897 make up the end of the login ID. </p>
<p>Technically, I haven&#039;t decrypted anything, but I have nevertheless recovered a modest but significant block of data from the encrypted stream: the value of the eight-digit login ID, 10462987.&quot; </p>
<p>It should be:<br />
&quot;<br />
There&#039;s a potential ambiguity at 6289, the fourth block, which can be followed by 2890, 2893 or 2897. </p>
<p>But only 2897 is followed by other sequences in the list (8970 and 8793), suggesting that the three digits 897 make up the end of the login ID. </p>
<p>Technically, I haven&#039;t decrypted anything, but I have nevertheless recovered a modest but significant block of data from the encrypted stream: the value of the eight-digit login ID, 10462897.&quot; </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_229882"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_229882={"id":7238218,"unique_id":"wp-comment-229882","title":"I%20think%20there%20is%20a%20typo%20here.%20Notice%20the%20difference%20in%20numbers.%20You%20have%20mentioned%2098%20in%20some%20places%20where%20it%20should%20be%2089%3A%20%20%26quot%3B%20There%26%23039%3Bs%20a%20potential%20ambiguity%20at%206298%2C%20the%20fourth%20block%2C%20w%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/06\/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack\/#comment-229882","item_id":"_comm_229882"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/?replytocom=229882#respond' data-commentid="229882" data-postid="231876" data-belowelement="div-comment-229882" data-respondelement="respond" data-replyto="Reply to @anshuman_bh" aria-label='Reply to @anshuman_bh'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-229960" class="comment even depth-2">
			<article id="div-comment-229960" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#comment-229960"><time datetime="2013-08-06T18:08:19+01:00">August 6, 2013 at 6:08 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Aaaargh. I kept looking at that and thinking, &quot;Something is wrong here.&quot; </p>
<p>I think the problem started when I mistyped the 8-digit code the first time, then copy-n-pasted it so I was sure to have exactly the same text for the deflate algorithm to match 🙂 </p>
<p>All 2987s are now 2897s. (At least the error wasn&#039;t in the image of the 30 numbers, as that would have been more hassle to fix 🙂 </p>
<p>Thanks for spotting! </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_229960"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_229960={"id":7238218,"unique_id":"wp-comment-229960","title":"Aaaargh.%20I%20kept%20looking%20at%20that%20and%20thinking%2C%20%26quot%3BSomething%20is%20wrong%20here.%26quot%3B%20%20I%20think%20the%20problem%20started%20when%20I%20mistyped%20the%208-digit%20code%20the%20first%20time%2C%20then%20copy-n-pasted%20it%20so%20I%20was%20sur%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/06\/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack\/#comment-229960","item_id":"_comm_229960"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/?replytocom=229960#respond' data-commentid="229960" data-postid="231876" data-belowelement="div-comment-229960" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-229945" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-229945" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/9bfee7ea8ec9000284a080227c7afdf1?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9bfee7ea8ec9000284a080227c7afdf1?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Carson</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#comment-229945"><time datetime="2013-08-06T17:42:17+01:00">August 6, 2013 at 5:42 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I think you mixed the numbers a bit up in the &#8220;2897&#8221; part. But on the other hand, Im a bit sleepy. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_229945"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_229945={"id":7238218,"unique_id":"wp-comment-229945","title":"I%20think%20you%20mixed%20the%20numbers%20a%20bit%20up%20in%20the%20%26quot%3B2897%26quot%3B%20part.%20But%20on%20the%20other%20hand%2C%20Im%20a%20bit%20sleepy.%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/06\/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack\/#comment-229945","item_id":"_comm_229945"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/?replytocom=229945#respond' data-commentid="229945" data-postid="231876" data-belowelement="div-comment-229945" data-respondelement="respond" data-replyto="Reply to Carson" aria-label='Reply to Carson'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-229961" class="comment even depth-2 parent">
			<article id="div-comment-229961" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#comment-229961"><time datetime="2013-08-06T18:11:49+01:00">August 6, 2013 at 6:11 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I mixed them up a lot. All due to one transposition (89-&gt;98) at the start 🙁 </p>
<p>Would you mind having another look and seeing if I have got it right at last? (I thought I had it right before, so a second look would be handy.) </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_229961"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_229961={"id":7238218,"unique_id":"wp-comment-229961","title":"I%20mixed%20them%20up%20a%20lot.%20All%20due%20to%20one%20transposition%20%2889-%26gt%3B98%29%20at%20the%20start%20%3A-%28%20%20Would%20you%20mind%20having%20another%20look%20and%20seeing%20if%20I%20have%20got%20it%20right%20at%20last%3F%20%28I%20thought%20I%20had%20it%20right%20before%2C%20s%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/06\/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack\/#comment-229961","item_id":"_comm_229961"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/?replytocom=229961#respond' data-commentid="229961" data-postid="231876" data-belowelement="div-comment-229961" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-229993" class="comment odd alt depth-3">
			<article id="div-comment-229993" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/9bfee7ea8ec9000284a080227c7afdf1?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9bfee7ea8ec9000284a080227c7afdf1?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Carson</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#comment-229993"><time datetime="2013-08-06T19:47:16+01:00">August 6, 2013 at 7:47 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Yes, I think now it is all good. Thats what happens if you fiddle with numbers (thats why I scored pretty low on my first College math exam). </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_229993"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_229993={"id":7238218,"unique_id":"wp-comment-229993","title":"Yes%2C%20I%20think%20now%20it%20is%20all%20good.%20Thats%20what%20happens%20if%20you%20fiddle%20with%20numbers%20%28thats%20why%20I%20scored%20pretty%20low%20on%20my%20first%20College%20math%20exam%29.%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/06\/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack\/#comment-229993","item_id":"_comm_229993"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/?replytocom=229993#respond' data-commentid="229993" data-postid="231876" data-belowelement="div-comment-229993" data-respondelement="respond" data-replyto="Reply to Carson" aria-label='Reply to Carson'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-230475" class="comment even thread-even depth-1">
			<article id="div-comment-230475" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Simon Lowe</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#comment-230475"><time datetime="2013-08-07T15:41:51+01:00">August 7, 2013 at 3:41 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thank you for this article! At first, I was sceptical about whether I would stand even a remote chance of understanding it, but you dumbed it down to my level nicely! 😛 </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_230475"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_230475={"id":7238218,"unique_id":"wp-comment-230475","title":"Thank%20you%20for%20this%20article%21%20At%20first%2C%20I%20was%20sceptical%20about%20whether%20I%20would%20stand%20even%20a%20remote%20chance%20of%20understanding%20it%2C%20but%20you%20dumbed%20it%20down%20to%20my%20level%20nicely%21%20%3AP%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/06\/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack\/#comment-230475","item_id":"_comm_230475"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/?replytocom=230475#respond' data-commentid="230475" data-postid="231876" data-belowelement="div-comment-230475" data-respondelement="respond" data-replyto="Reply to Simon Lowe" aria-label='Reply to Simon Lowe'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-230745" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-230745" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/ed3c6be89b9f686acb7c27edfb92d0d1?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ed3c6be89b9f686acb7c27edfb92d0d1?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Steve</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#comment-230745"><time datetime="2013-08-08T03:18:13+01:00">August 8, 2013 at 3:18 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Exceptionally well-presented, as usual.  Is that too contradictory?  Let me clarify: &quot;as usual&quot;, for Mr. Ducklin; exceptional, relative to most of what passes for &quot;professional&quot; writing these days. </p>
<p>And the little nugget about the Oracle at Delphi was a treat&#8230; &quot;trippily disconnected&quot;?  LOL! </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_230745"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_230745={"id":7238218,"unique_id":"wp-comment-230745","title":"Exceptionally%20well-presented%2C%20as%20usual.%20%20Is%20that%20too%20contradictory%3F%20%20Let%20me%20clarify%3A%20%26quot%3Bas%20usual%26quot%3B%2C%20for%20Mr.%20Ducklin%3B%20exceptional%2C%20relative%20to%20most%20of%20what%20passes%20for%20%26quot%3Bprofessional%26amp%3Bquo%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/06\/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack\/#comment-230745","item_id":"_comm_230745"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/?replytocom=230745#respond' data-commentid="230745" data-postid="231876" data-belowelement="div-comment-230745" data-respondelement="respond" data-replyto="Reply to Steve" aria-label='Reply to Steve'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-231489" class="comment even thread-even depth-1">
			<article id="div-comment-231489" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/fa10a5996fcba78a441924d60b09a4fe?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/fa10a5996fcba78a441924d60b09a4fe?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Felix</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#comment-231489"><time datetime="2013-08-09T06:59:59+01:00">August 9, 2013 at 6:59 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Great article, thanks for helping people to understand this breach attack! One question that arises, then, is: are subjected to this attack only those pages that send some tokens several times (like the ID in your example)? For example: sites using wordpress do not use the address bar to sending tokens, so we could say that are something more protected against this attack?<br />
Regards! </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_231489"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_231489={"id":7238218,"unique_id":"wp-comment-231489","title":"Great%20article%2C%20thanks%20for%20helping%20people%20to%20understand%20this%20breach%20attack%21%20One%20question%20that%20arises%2C%20then%2C%20is%3A%20are%20subjected%20to%20this%20attack%20only%20those%20pages%20that%20send%20some%20tokens%20several%20times%20%28l%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/06\/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack\/#comment-231489","item_id":"_comm_231489"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/?replytocom=231489#respond' data-commentid="231489" data-postid="231876" data-belowelement="div-comment-231489" data-respondelement="respond" data-replyto="Reply to Felix" aria-label='Reply to Felix'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-233357" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-233357" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/f228a77b5518537e9554f5575b8a1e19?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f228a77b5518537e9554f5575b8a1e19?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Thrawn</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#comment-233357"><time datetime="2013-08-12T12:14:11+01:00">August 12, 2013 at 12:14 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Rather than inserting random HTML comments, couldn&#8217;t the website set a random-length cookie each time?</p>
<p>That way, you can compress the HTML response body just like always; you can be sure that the true recipient will ignore your &#8216;noise&#8217;; you can set the &#8216;Secure&#8217; flag to avoid wasting bandwidth on unencrypted pages; and since modern browsers no longer use TLS compression due to CRIME, you don&#8217;t have to worry about whether the noise is compressible. Plus, if you&#8217;re running a web server like Apache/Nginx with an application server behind it, you could apply this at the web server level and not have to touch the application server at all.</p>
<p>As a bonus, if you do ensure that the noise is (mostly) incompressible, then in theory you could safely turn TLS compression back on, because the browser would send your noise cookie back each time and scramble CRIME attacks.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_233357"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_233357={"id":7238218,"unique_id":"wp-comment-233357","title":"Rather%20than%20inserting%20random%20HTML%20comments%2C%20couldn%26%23039%3Bt%20the%20website%20set%20a%20random-length%20cookie%20each%20time%3FThat%20way%2C%20you%20can%20compress%20the%20HTML%20response%20body%20just%20like%20always%3B%20you%20can%20be%20sure%20that%20the%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/06\/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack\/#comment-233357","item_id":"_comm_233357"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/?replytocom=233357#respond' data-commentid="233357" data-postid="231876" data-belowelement="div-comment-233357" data-respondelement="respond" data-replyto="Reply to Thrawn" aria-label='Reply to Thrawn'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-233680" class="comment even thread-even depth-1">
			<article id="div-comment-233680" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/f228a77b5518537e9554f5575b8a1e19?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f228a77b5518537e9554f5575b8a1e19?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Thrawn</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#comment-233680"><time datetime="2013-08-12T23:48:30+01:00">August 12, 2013 at 11:48 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Instead of inserting random text into the page, why not set a random-length &#039;noise&#039; cookie on each request? </p>
<p>Advantages:<br />
&#8211; You don&#039;t tamper with the page contents, so you&#039;re not likely to break anything.<br />
&#8211; If you use a web proxy for your SSL termination, then it can do the work without any changes to your application.<br />
&#8211; The browser will send the cookie for requests as well, so regular CRIME is defeated into the bargain.<br />
&#8211; Since browsers have disabled TLS compression to fight CRIME, your noise definitely won&#039;t be compressed (although you should make it mostly-incompressible anyway, in case they ever turn it back on).<br />
&#8211; You can set the Secure flag, so the cookie won&#039;t waste bandwidth on unencrypted requests. </p>
<p>The attacker could still crack it by making a large number of requests and analysing the average change for each inserted string. But then their attack time blows out from 30 seconds (feasible) to several hours (probably not feasible in the real world). </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_233680"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_233680={"id":7238218,"unique_id":"wp-comment-233680","title":"Instead%20of%20inserting%20random%20text%20into%20the%20page%2C%20why%20not%20set%20a%20random-length%20%26%23039%3Bnoise%26%23039%3B%20cookie%20on%20each%20request%3F%20%20Advantages%3A%20-%20You%20don%26%23039%3Bt%20tamper%20with%20the%20page%20contents%2C%20so%20you%26%23039%3Bre%20n%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/06\/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack\/#comment-233680","item_id":"_comm_233680"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/?replytocom=233680#respond' data-commentid="233680" data-postid="231876" data-belowelement="div-comment-233680" data-respondelement="respond" data-replyto="Reply to Thrawn" aria-label='Reply to Thrawn'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-429127" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-429127" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/f8d35beba21e1068aaea47deb42f87fd?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f8d35beba21e1068aaea47deb42f87fd?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Cristian</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#comment-429127"><time datetime="2013-10-21T19:41:30+01:00">October 21, 2013 at 7:41 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I don&#039;t understand this algorithm. It&#039;s do tricky for me! </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_429127"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_429127={"id":7238218,"unique_id":"wp-comment-429127","title":"I%20don%26%23039%3Bt%20understand%20this%20algorithm.%20It%26%23039%3Bs%20do%20tricky%20for%20me%21%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/06\/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack\/#comment-429127","item_id":"_comm_429127"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/?replytocom=429127#respond' data-commentid="429127" data-postid="231876" data-belowelement="div-comment-429127" data-respondelement="respond" data-replyto="Reply to Cristian" aria-label='Reply to Cristian'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-4688166" class="comment even thread-even depth-1 parent">
			<article id="div-comment-4688166" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/04009b77308fee0689fdc3fb593f7340?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/04009b77308fee0689fdc3fb593f7340?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">jmzc</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#comment-4688166"><time datetime="2017-02-07T12:36:20+00:00">February 7, 2017 at 12:36 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks for your article.<br />
One question , how does your tiny HTML inspect the size of the answer ?<br />
I know that js code on tiny HTML cannot access to  content ( by SOP ), but how can it access to size of responses ?</p>
<p>Thanks</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_4688166"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_4688166={"id":7238218,"unique_id":"wp-comment-4688166","title":"Thanks%20for%20your%20article.One%20question%20%2C%20how%20does%20your%20tiny%20HTML%20inspect%20the%20size%20of%20the%20answer%20%3FI%20know%20that%20js%20code%20on%20tiny%20HTML%20cannot%20access%20to%20%20content%20%28%20by%20SOP%20%29%2C%20but%20how%20can%20it%20access%20to%20size%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/06\/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack\/#comment-4688166","item_id":"_comm_4688166"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/?replytocom=4688166#respond' data-commentid="4688166" data-postid="231876" data-belowelement="div-comment-4688166" data-respondelement="respond" data-replyto="Reply to jmzc" aria-label='Reply to jmzc'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-4688976" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2">
			<article id="div-comment-4688976" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#comment-4688976"><time datetime="2017-02-08T10:04:56+00:00">February 8, 2017 at 10:04 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>As suggested in the article, this attack does require a number of planets to align (see under the subheading &#8220;Defending against BREACH&#8221;), including that &#8220;&#8230;I have to be able to sniff your traffic in sufficient detail to recover the length of each HTTP reply&#8230;&#8221;</p>
<p>The idea is that based on knowing some of the input to the compression function and a rough measurement of how well the data compressed, you can make inferences about the parts of the input data you didn&#8217;t know.</p>
<p>In other words, as far as I can tell there is no way to pull off this attack based on JavaScript alone. In the data I collected I cheated a bit by using HTTP and simply running the connection through a proxy that listed the size of each reply. To make it more realistic, I guess I could have used HTTPS and run tcpdump or Wireshark along the path of the packets, though the idea of the article was to focus on the &#8220;compression ration inferencing&#8221; rather than on how to collect the traffic size data. </p>
<p>At any rate, you typically need something *inside* the browser to provoke the traffic and something *outside* the browser to measure it in order to make this work.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_4688976"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_4688976={"id":7238218,"unique_id":"wp-comment-4688976","title":"As%20suggested%20in%20the%20article%2C%20this%20attack%20does%20require%20a%20number%20of%20planets%20to%20align%20%28see%20under%20the%20subheading%20%26quot%3BDefending%20against%20BREACH%26quot%3B%29%2C%20including%20that%20%26quot%3B...I%20have%20to%20be%20able%20to%20sniff%20your%20traffi%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/06\/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack\/#comment-4688976","item_id":"_comm_4688976"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/?replytocom=4688976#respond' data-commentid="4688976" data-postid="231876" data-belowelement="div-comment-4688976" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">What do you think? <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2013/08/06/anatomy-of-a-cryptographic-oracle-understanding-and-mitigating-the-breach-attack/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://nakedsecurity.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='231876' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="405b11bcd5" /></p><input type="hidden" id="ak_js" name="ak_js" value="185"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->
		<div class="comments-widget-area">
					</div>
	
	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	

	<section class="recommended-panel">
	<div class="container">
	<div class="panel-content ">

		<h3 class="block-title">Recommended reads</h3>
	<div class="blocks">
		<article id="post-561067" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/03/17/serious-security-the-linux-kernel-bugs-that-surfaced-after-15-years/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/3lb.001.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Mar</span><span class="day">17</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">5</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/03/17/serious-security-the-linux-kernel-bugs-that-surfaced-after-15-years/" rel="bookmark">Serious Security: The Linux kernel bugs that surfaced after 15 years</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-544664" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/01/25/naked-security-live-dont-let-digital-jokes-turn-into-digital-disasters/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/10/nslive-1200-3.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Jan</span><span class="day">25</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">0</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/01/25/naked-security-live-dont-let-digital-jokes-turn-into-digital-disasters/" rel="bookmark">Naked Security Live &#8211; Don’t let digital jokes turn into digital disasters</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-545475" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/02/18/s3-ep20-corporate-megahacking-true-love-gone-bad-and-tax-grabs-podcast/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/02/nean-with-mic-wt-green-ivy-1200.jpg?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Feb</span><span class="day">18</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">1</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/02/18/s3-ep20-corporate-megahacking-true-love-gone-bad-and-tax-grabs-podcast/" rel="bookmark">S3 Ep20: Corporate megahacking, true love gone bad, and tax grabs [Podcast]</a></h3>	</div>
</article> <!-- .card-article -->
	</div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="footer-container">
			<a href="#" class="js-collapse-footer"><svg style="height: 20px" viewBox="0 0 132 24" class="block icon sophos"><use xlink:href="#sophos"></use></svg></a>
			<div id="collapseFooter" class="blocks">
				<div class="sophos block">
					<ul id="menu-footer-primary" class="primary menu"><li id="menu-item-306737" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306737"><a href="https://nakedsecurity.sophos.com/about/">About Naked Security</a></li>
<li id="menu-item-306754" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306754"><a href="https://www.sophos.com/en-us/company.aspx">About Sophos</a></li>
<li id="menu-item-306747" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306747"><a href="https://nakedsecurity.sophos.com/send-us-a-tip/">Send us a tip</a></li>
<li id="menu-item-323171" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323171"><a href="/cookies-and-scripts/">Cookies</a></li>
<li id="menu-item-323170" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323170"><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
<li id="menu-item-323169" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323169"><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
</ul>				</div>
										<div class="news block">
							<ul id="menu-products-column-one" class="small menu"><li id="menu-item-306998" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306998"><a href="https://www.sophos.com/en-us/products/intercept-x.aspx">Intercept X</a></li>
<li id="menu-item-440801" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440801"><a href="https://www.sophos.com/en-us/products/server-security.aspx">Intercept X for Server</a></li>
<li id="menu-item-440802" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440802"><a href="https://www.sophos.com/en-us/products/mobile-control.aspx">Intercept X for Mobile</a></li>
</ul>						</div>
											<div class="products block">
							<ul id="menu-products-column-two" class="small menu"><li id="menu-item-440803" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440803"><a href="https://www.sophos.com/en-us/products/next-gen-firewall.aspx">XG Firewall</a></li>
<li id="menu-item-440805" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440805"><a href="https://www.sophos.com/en-us/products/sophos-email.aspx">Sophos Email</a></li>
<li id="menu-item-440804" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440804"><a href="https://www.sophos.com/en-us/products/secure-wifi.aspx">Sophos Wireless</a></li>
</ul>						</div>
											<div class="threats block">
							<ul id="menu-server-protection" class="small menu"><li id="menu-item-440806" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440806"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx">Managed Threat Response</a></li>
<li id="menu-item-448404" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-448404"><a href="https://www.sophos.com/en-us/products/cloud-optix.aspx">Cloud Optix</a></li>
<li id="menu-item-440807" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440807"><a href="https://www.sophos.com/en-us/products/phish-threat.aspx">Phish Threat</a></li>
</ul>						</div>
								</div>
			<ul class="block social footer">
				<li class="twitter"><a rel="nofollow" href="https://twitter.com/NakedSecurity" title="Follow our team of security experts on Twitter"><svg style="height: 14px" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
				<li class="facebook"><a rel="nofollow" href="https://www.facebook.com/SophosSecurity" title="Join over 250,000 people in our Facebook community"><svg style="height: 14px" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
				<li class="instagram"><a rel="nofollow" href="https://www.instagram.com/nakedsecurity/" title="Follow Naked Security on Instagram"><svg style="height: 14px" viewBox="0 0 100 100" class="icon instagram"><use xlink:href="#instagram"></use></svg></a></li>
				<li class="linkedin"><a rel="nofollow" href="https://www.linkedin.com/company/5053/" title="Join the naked security discussion group on LinkedIn"><svg style="height: 14px" viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
				<li class="rss"><a rel="nofollow" href="/feed" title="Subscribe to our RSS feed"><svg style="height: 14px" viewBox="0 0 100 100" class="icon rss"><use xlink:href="#rss"></use></svg></a></li>
			</ul>

							<div class="vip-powered-wpcom">
					<span class="copyright">© 1997 - 2021 Sophos Ltd.</span>
					All rights reserved.
					Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=nakedsecurity.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>				</div>
					</div>
		<script type="text/javascript">
			window.cookieconsent_options = {
				"message":"This site uses cookies. By continuing to browse the site you are agreeing to our use of cookies.",
				"dismiss":"Got it!",
				"learnMore":"Learn More",
				"link":"/cookies-and-scripts",
				"theme":"https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/css/sophos.css"};
		</script>
	</footer><!-- #colophon -->
</div><!-- #page -->
<div id="survey-wrapper" class="mfp-hide"><div class="pd-embed" id="pd_1499706777" data-settings=""></div></div>
<script id='child-js-plugins-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"0","nextLink":""};
</script>
<script id='child-js-core-js-extra'>
var Sophos = {"ajaxurl":"https:\/\/nakedsecurity.sophos.com\/wp-admin\/admin-ajax.php","nonce":"64f6810f0c"};
</script>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJyNjkEKwjAQRS9kOonYggvxKGLT0SZmJiGTULx9Q7HgwoXL+f89/sCSlI1ckAuUGQkFJKY5CuMi6qhND14ghfp0LJ2XA/wl2Jhxpx3bUKfGbTlRM1XGFN4dOf4FtRNpxOm73yepqs8zcH85ISxway48YqbGXuliBtOfBq3P2q8Rb09t'></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161173',post:'231876',tz:'0',srv:'nakedsecurity.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161173', '231876' ]);
</script>
</body>
</html>
