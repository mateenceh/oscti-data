<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="RHQeasQqjasbRt5asY6atZYbs5tr10gFBevDt2HRhW0" />
<link rel="pingback" href="https://nakedsecurity.sophos.com/xmlrpc.php">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5VK6LTK');</script>
<!-- End Google Tag Manager -->

<meta name="description" content="You don&#039;t always have to break into someone&#039;s web server to get them to deliver your malware for you. You can just break into the server they get their online ads from. Or you can pre-infect the online ad server software so you can own it as soon as it is installed." />
<meta name="keywords" content="malware, security threats, vulnerability, bsi, javascript, malware, openx, php, poisoned ad" />
<title>OpenX ad servers &#8220;pre-compromised&#8221; &#8211; official distro contained remote code backdoor &#8211; Naked Security</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="I9dHFo-YhnK2MfAHn-20V4GnWrOttVUYyISGamyU41M" />
<meta name="msvalidate.01" content="7D8D1FA2892142B1543D2CBCD07FB88F" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Feed" href="https://nakedsecurity.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Comments Feed" href="https://nakedsecurity.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; OpenX ad servers &#8220;pre-compromised&#8221; &#8211; official distro contained remote code backdoor Comments Feed" href="https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/feed/" />
<link rel='stylesheet' id='all-css-0' href='https://nakedsecurity.sophos.com/_static/??-eJyVz00OwiAQhuELCSM1mLgwnoXCRFD+wgxpevvS2J0bXU7yPsk3sFQRso3dIYElAheIYY7FvkUMczNtBeI1okwhyxGcYAhbMmNmYI9pOCrVF8q4kJjOSh/gn1hEw0j8q9mHGifZNzQsfB9xkybVL5+6qLE/QyZ4IVczvrrJjz/unTzSXV2VvkxKa70BdwtjDg==' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqWkWAK9EIho='></script>
<link rel="https://api.w.org/" href="https://nakedsecurity.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://nakedsecurity.sophos.com/wp-json/wp/v2/posts/231960" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://nakedsecurity.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://nakedsecurity.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/" />
<link rel='shortlink' href='https://nakedsecurity.sophos.com/?p=231960' />
<link rel="alternate" type="application/json+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2013%2F08%2F07%2Fopenx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2013%2F08%2F07%2Fopenx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="OpenX ad servers &#8220;pre-compromised&#8221; &#8211; official distro contained remote code backdoor" />
<meta property="og:url" content="https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/" />
<meta property="og:description" content="You don&#8217;t always have to break into someone&#8217;s web server to get them to deliver your malware for you. You can just break into the server they get their online ads from. Or you can pre-i…" />
<meta property="article:published_time" content="2013-08-06T23:08:37+00:00" />
<meta property="article:modified_time" content="2013-08-12T11:16:24+00:00" />
<meta property="og:site_name" content="Naked Security" />
<meta property="og:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/op-x-250.png?w=250" />
<meta property="og:image:secure_url" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/op-x-250.png?w=250" />
<meta property="og:image:width" content="250" />
<meta property="og:image:height" content="250" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@NakedSecurity" />
<meta name="twitter:text:title" content="OpenX ad servers &#8220;pre-compromised&#8221; &#8211; official distro contained remote code backdoor" />
<meta name="twitter:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/op-x-250.png?w=144" />
<meta name="twitter:card" content="summary" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=270" />
</head>
<body class="post-template-default single single-post postid-231960 single-format-standard" >
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VK6LTK"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div style="display: none">
<svg>
	<symbol id="sophos" viewBox="0 0 132 24">
		<path d="m111.82 22.176h11.64c3.267 0 4.65-0.2 5.74-0.896 1.715-1.063 2.804-3.26 2.804-5.62 0-1.928-0.658-3.89-1.647-4.888-1.288-1.33-3.035-1.828-6.271-1.828h-3.527c-1.586 0-2.754-0.067-3.412-0.365-0.794-0.367-1.256-1.165-1.256-2.161 0-1.165 0.56-2.03 1.486-2.264 0.692-0.163 1.498-0.163 3.574-0.198h10.419v-3.956h-11.473c-2.574 0-3.727 0.099-4.718 0.466-2.279 0.796-3.828 3.257-3.828 6.083 0 1.93 0.76 3.727 2.079 4.89 1.155 0.996 2.872 1.462 5.51 1.462h4.697c1.057 0 1.915 0.132 2.376 0.398 0.893 0.433 1.418 1.328 1.418 2.36 0 0.864-0.395 1.597-1.087 2.027-0.561 0.369-1.517 0.534-3.268 0.534h-11.256zm-111.35 0h11.64c3.267 0 4.652-0.2 5.741-0.896 1.714-1.063 2.803-3.26 2.803-5.62 0-1.928-0.66-3.89-1.65-4.888-1.285-1.33-3.034-1.828-6.27-1.828h-3.527c-1.584 0-2.751-0.067-3.41-0.365-0.792-0.367-1.253-1.165-1.253-2.161 0-1.165 0.56-2.03 1.484-2.264 0.693-0.163 1.496-0.163 3.574-0.198h10.42v-3.956h-11.477c-2.573 0-3.727 0.099-4.715 0.466-2.278 0.796-3.83 3.257-3.83 6.083 0 1.93 0.762 3.727 2.08 4.89 1.155 0.996 2.871 1.462 5.51 1.462h4.696c1.057 0 1.913 0.132 2.377 0.398 0.888 0.433 1.416 1.328 1.416 2.36 0 0.864-0.394 1.597-1.089 2.027-0.558 0.369-1.517 0.534-3.264 0.534h-11.256v3.956zm94.05-16.18c-0.68 1.076-1.003 2.803-1.003 5.122 0 5.088 1.747 7.405 5.63 7.405 3.822 0 5.568-2.317 5.568-7.34 0-5.092-1.715-7.373-5.568-7.373-2.102 0-3.754 0.784-4.627 2.186zm13.174-2.511c1.329 1.761 2.072 4.63 2.072 7.992 0 3.816-1.197 6.948-3.334 8.677-1.619 1.304-4.078 2.022-6.995 2.022-4.142 0-7.41-1.372-9.092-3.817-1.263-1.793-1.88-4.176-1.88-7.08 0-4.172 1.133-7.339 3.27-9.035 1.682-1.37 4.339-2.122 7.383-2.122 3.85 0 6.925 1.209 8.576 3.363zm-22.018-3.068h-4.596v8.908h-8.319v-8.908h-4.597v21.759h4.597v-8.97h8.318v8.97h4.596v-21.759zm-28.61 10.277c1.23 0 1.941-0.163 2.427-0.62 0.581-0.49 0.938-1.533 0.938-2.74 0-1.436-0.58-2.478-1.584-2.838-0.356-0.13-0.94-0.197-1.684-0.197h-6.344v6.395zm-6.247 11.481h-4.598v-21.758h10.78c3.786 0 5.114 0.39 6.538 1.991 1.264 1.37 1.942 3.163 1.942 5.088 0 2.284-0.904 4.404-2.394 5.676-1.262 1.077-2.43 1.402-4.888 1.402h-7.38zm-22.589-16.179c-0.682 1.076-1.004 2.803-1.004 5.122 0 5.088 1.748 7.405 5.634 7.405 3.818 0 5.568-2.317 5.568-7.34 0-5.092-1.716-7.373-5.568-7.373-2.106 0-3.757 0.784-4.63 2.186zm13.174-2.511c1.328 1.761 2.073 4.63 2.073 7.992 0 3.816-1.2 6.948-3.335 8.677-1.618 1.304-4.079 2.022-6.993 2.022-4.144 0-7.413-1.372-9.096-3.817-1.264-1.793-1.878-4.176-1.878-7.08 0-4.172 1.133-7.339 3.272-9.035 1.681-1.37 4.337-2.122 7.38-2.122 3.851 0 6.93 1.209 8.578 3.363z"></path>
	</symbol>
	<symbol id="twitter" viewBox="0 0 24 24">
 		<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path>
 	</symbol>
	<symbol id="facebook" viewBox="0 0 24 24">
 		<path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path>
 	</symbol>
	<symbol id="instagram" viewBox="0 0 24 24">
		<path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path>
	</symbol>
	<symbol id="linkedin" viewBox="0 0 24 24">
		<path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"></path>
	</symbol>
	<symbol id="rss" viewBox="0 0 24 24">
		<path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"></path>
	</symbol>
	<symbol id="reddit" viewBox="0 0 24 24">
		<path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"></path>
	</symbol>
</svg>
</div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header variation variation-3" role="banner">
		<div class="header-container">
			<div class="site-branding">
				<div class="site-title">
					<a title="Naked Security" href="https://nakedsecurity.sophos.com/" rel="home"><img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/naked-security-logo-white@2x.png"></a>
					by
					<a title="sophos.com" href="https://www.sophos.com"><svg viewBox="0 0 132 24" class="icon sophos"><use xlink:href="#sophos"></use></svg></a>
				</div>
			</div><!-- .site-branding -->
			<nav id="site-navigation" class="main-navigation" role="navigation">
				<div class="container">
					<ul id="menu-variation-two" class="exit-links menu"><li id="menu-item-436509" class="products menu-item menu-item-type-custom menu-item-object-custom menu-item-436509"><a href="#">Products</a></li>
<li id="menu-item-436515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436515"><a href="https://www.sophos.com/en-us/products/free-tools.aspx">Free Tools</a></li>
<li id="menu-item-436531" class="search-toggle menu-item menu-item-type-custom menu-item-object-custom menu-item-436531"><a href="#">Search</a></li>
<li id="menu-item-436532" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436532"><a href="https://home.sophos.com/en-us.aspx">Free Sophos Home</a></li>
</ul>				</div>
			</nav><!-- #site-navigation -->
			<div class="site-search-block">
	<form target="_top" role="search" class="search-form" method="get" action="https://nakedsecurity.sophos.com/">
        <fieldset>
            <div class="field">
				<input type="search" value="" name="s" class="search-field" placeholder="Search naked security...">
            </div>
            <div class="submit">
				<button type="submit" class="search-submit button">Go</button>
            </div>
        </fieldset>
    </form>
</div>
		</div><!-- .container -->
	</header>

	<div class="responsive-flyout-panel small-12 column active" style="opacity: 1; display: none;">
		<div class="modal-filler"></div>
	    <div class="productNavBox">
	        <div class="productNavContainer">
	            <div class="row prodRow">
	                <div class="prodListBox column large-9">
	                    <div class="row margin-0 highlightProduct">
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/next-gen-firewall.aspx"><img src="https://www.sophos.com/medialibrary/2F4785DE8C3F43ECBD699A18F332FEEB.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">XG Firewall</div>
	                                	<div class="menu-section-subtitle">Next-Gen Firewall</div>
									</div>
	                            </a>
	                        </div>
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/intercept-x.aspx"><img src="https://www.sophos.com/medialibrary/27111765D65A45D49A232925D2CE428B.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">Intercept X</div>
	                                	<div class="menu-section-subtitle">Next-Gen Endpoint</div>
									</div>
	                            </a>
	                        </div>
	                    </div>
	                    <div class="productList">
	                        <ul>
								<li>
									<a href="https://www.sophos.com/en-us/products/cloud-optix.aspx"><img src="https://www.sophos.com/medialibrary/SophosNext/Images/Products/Icons/sophos-cloud-optix-icon.svg">Sophos Cloud Optix</a>
								</li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-central.aspx"><img src="https://www.sophos.com/medialibrary/08EA66123F1B4DDE8FE5C9B578A7FAA7.ashx">Sophos Central</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/mobile-control.aspx"><img src="https://www.sophos.com/medialibrary/678FE994855047739F50D6C411184FA6.ashx">Sophos Mobile</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/server-security.aspx"><img src="https://www.sophos.com/medialibrary/01B80E7D7CD54EF8AC2E51C9C6EC0236.ashx">Intercept X for Server</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-wifi.aspx"><img src="https://www.sophos.com/medialibrary/BEBD9C41BB4E480498514B29B92A145A.ashx">Secure Wi-Fi</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/phish-threat.aspx"><img src="https://www.sophos.com/medialibrary/DC9D1A7BA3964B0C9DAF1F1E68806B5A.ashx">Phish Threat</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/safeguard-encryption.aspx"><img src="https://www.sophos.com/medialibrary/8F51F06B62814B108D3B2763FF018E37.ashx">SafeGuard Encryption</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-email.aspx"><img src="https://www.sophos.com/medialibrary/597ADA0AF01A4A12B2B27239D0F9992C.ashx">Secure Email</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/unified-threat-management.aspx"><img src="https://www.sophos.com/medialibrary/8CB72BF5E1AD41F7894CE5E42101B0F3.ashx">SG UTM</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-web-gateway.aspx"><img src="https://www.sophos.com/medialibrary/C586E372694547A1B207A61D87246BA7.ashx">Secure Web Gateway</a>
	                            </li>
	                        </ul>
	                    </div>
	                </div>
	                <div class="homeUserBox column large-3">
						<img src="https://www.sophos.com/medialibrary/3376DF5742A64AEE93FDB9DCA7291239.ashx">
						<div class="menu-section-title">For Home Users</div>
	                    <p>Sophos Home protects every Mac and PC in your home </p><a href="https://home.sophos.com/" target="_blank" class="greenSmallMenuBtn">Learn More</a>
					</div>
	            </div>
	            <div class="row blueRow">
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-tools.aspx"><img width="19" src="https://www.sophos.com/medialibrary/A1FF440D2BB84511B8C94D771D44E207.ashx">Free Security Tools</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-trials.aspx"><img width="20" src="https://www.sophos.com/medialibrary/FCD3410ED2C347808D9DB8AC12C62DBD.ashx">Free Trials</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/demos.aspx"><img width="18" src="https://www.sophos.com/medialibrary/50985180E5F54C94917A2A6508E24287.ashx">Product Demos</a>
	                </div>
	                <!-- <div class="column large-3 medium-6">
	                    <a href="javascript:fairfax.openLiveChatFromFlyoutLink();" class="flyout-live-chat-link"><img width="20" src="https://www.sophos.com/medialibrary/E24C5050837145F6A5C592E299BA2A0D.ashx">Live Sales Chat</a>
	                </div> -->
	            </div>
	        </div>
	    </div>
	</div>
	<script>

	jQuery(document).ready( function () {
		var productButton   = jQuery('nav .menu-item.products');
		var modalBackground = jQuery('.modal-filler');
		var flyoutMenu		= jQuery('.responsive-flyout-panel');
		var Sophos			= Sophos || {};

		Sophos.MenuTest = {};

		Sophos.MenuTest.open = function () {
				productButton.addClass('open');
				flyoutMenu.show();
				modalBackground.show();
		};

		Sophos.MenuTest.close = function () {
			productButton.removeClass('open');
			flyoutMenu.hide();
			modalBackground.hide();
		};

		Sophos.MenuTest.toggle = function () {
			if ( productButton.hasClass('open') ) {
				Sophos.MenuTest.close();
			} else {
				Sophos.MenuTest.open();
			}
		};

		productButton.click( Sophos.MenuTest.toggle );
		modalBackground.click( Sophos.MenuTest.close );
	});

	</script>

	
	<section class="about-panel">
	<div class="container">
	<div class="panel-content ">

		<div class="description"><span>Have you listened to our podcast? <a href="/podcast/">Listen now</a></span></div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	<div id="content" class="site-content">
		<div class="content-container">

</div> <!-- .container -->
</div> <!-- #content -->


	<section class="content-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

		<main id="main" class="site-main" role="main">

	
		
<article id="post-231960" class="post-231960 post type-post status-publish format-standard has-post-thumbnail hentry category-featured category-malware category-security-threats category-vulnerability tag-bsi tag-javascript tag-malware tag-openx tag-php tag-poisoned-ad">

	<header class="entry-header">
		<h1 class="entry-title">OpenX ad servers &#8220;pre-compromised&#8221; &#8211; official distro contained remote code backdoor</h1>		<div class="entry-meta">
			<div>
				
	<span class="entry-published">
		<time class="entry-date published" datetime="2013-08-07T00:08:37+01:00">07 Aug 2013</time>
	</span>

					<a href="#comments" class="comment-box">
					<span class="count">11</span>
				</a>
					
	<span class="entry-categories">
	<a href="https://nakedsecurity.sophos.com/category/security-threats/malware/">Malware</a>, <a href="https://nakedsecurity.sophos.com/category/security-threats/">Security threats</a>, <a href="https://nakedsecurity.sophos.com/category/security-threats/vulnerability/">Vulnerability</a>	</span>

			</div>
	</header> <!-- .entry-header -->

    <div id="newsletter-signup" class="container top"></div>

			<div class="entry-featured-image">
			<img width="250" height="250" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/op-x-250.png?w=250&amp;h=250&amp;crop=1" class="attachment-hero-thumbnail size-hero-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/op-x-250.png 250w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/op-x-250.png?resize=150,150 150w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/op-x-250.png?resize=225,225 225w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/op-x-250.png?resize=70,70 70w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/op-x-250.png?resize=32,32 32w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/op-x-250.png?resize=50,50 50w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/op-x-250.png?resize=64,64 64w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/op-x-250.png?resize=96,96 96w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2013/08/op-x-250.png?resize=128,128 128w" sizes="(max-width: 250px) 100vw, 250px" />					</div> <!-- .entry-featured-image -->
		
		<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2013/08/06/just-when-you-thought-it-was-safe-to-go-back-in-the-water-closet/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> Just when you thought it was safe to go back in the water (closet)!</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2013/08/07/daily-mail-readers-wince-as-mail-online-slices-and-dices-their-data/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Daily Mail readers wince as Mail Online slices and dices their data</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	<div class="entry-content">
		<div class="entry-prefix">
			<div class="entry-author">
				
	
					<span class="by">by</span>
			<a href="https://nakedsecurity.sophos.com/author/paul-ducklin/" title="Posts by Paul Ducklin" class="author url fn" rel="author">Paul Ducklin</a>		
	
				</div>
			<div class="entry-sharing">
				
	<ul class="block social share">
		<li class="facebook"><a href="https://www.facebook.com/share.php?u=https%3A%2F%2Fnakedsecurity.sophos.com%2F2013%2F08%2F07%2Fopenx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor%2F&title=OpenX+ad+servers+%E2%80%9Cpre-compromised%E2%80%9D+%E2%80%93+official+distro+contained+remote+code+backdoor" data-title="OpenX ad servers “pre-compromised” – official distro contained remote code backdoor" title="Share on Facebook"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
		<li class="twitter"><a href="https://twitter.com/intent/tweet?text=OpenX+ad+servers+%E2%80%9Cpre-compromised%E2%80%9D+%E2%80%93+official+distro+contained+remote+code+backdoor+https%3A%2F%2Fnakedsecurity.sophos.com%2F%3Fp%3D231960" data-title="OpenX ad servers &#8220;pre-compromised&#8221; &#8211; official distro contained remote code backdoor" title="Share on Twitter"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
		<li class="linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2013%2F08%2F07%2Fopenx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor%2F&title=OpenX+ad+servers+%E2%80%9Cpre-compromised%E2%80%9D+%E2%80%93+official+distro+contained+remote+code+backdoor" data-title="OpenX ad servers “pre-compromised” – official distro contained remote code backdoor" title="Share on LinkedIn"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
		<li class="reddit"><a href="https://reddit.com/submit/?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2013%2F08%2F07%2Fopenx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor%2F&title=OpenX+ad+servers+%E2%80%9Cpre-compromised%E2%80%9D+%E2%80%93+official+distro+contained+remote+code+backdoor" title="Share on Reddit"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon reddit"><use xlink:href="#reddit"></use></svg></a></li>

			</ul>

				</div>
		</div>
		<p>You don&#8217;t always have to break into someone&#8217;s web server to get them to deliver your malware for you.</p>
<p>You may be able to implant malware onto a site from which your victim fetches third-party content, and thus serve up your malware one step removed.</p>
<p>You compromise the third party&#8217;s servers; they pass on the compromise to their customers; and those customers pass the compromised files onto users as they browse.</p>
<p>As you can probably imagine, ad servers are a prime target for this sort of indirect compromise: their whole purpose is to take content they didn&#8217;t originate themselves and to push it out as widely as they can.</p>
<p style='background-color:#e8e8e8;font-size:80%;padding:.71em;padding-left:2em;text-indent:-1.29em;'>&rarr; Malware foisted on you by an ad server can also be harder to track down and analyse because ads on a site are deliberately varied from visitor to visitor, and from visit to visit. So a URL reported as malicious by a user might have no (or different) malware when visited again later.</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2013/08/op-x-150.png" width="156" height="156" align="right" hspace="10"></img>We&#8217;ve written regularly about <a href="http://nakedsecurity.sophos.com/2010/03/05/adservers-compromised-latest-zbot-push/">this problem</a> over the years, and the freebie ad server OpenX has <a href="http://nakedsecurity.sophos.com/2010/07/01/attacks-compromised-openx-adservers/">popped up</a> in <a href="http://nakedsecurity.sophos.com/2011/04/28/compromised-ads-leading-to-tdss-rootkit-infections/">the saga</a> on <a href="http://nakedsecurity.sophos.com/2012/03/28/openx-ads-leading-to-malware-co-blackadvertspro/">numerous occasions</a>.</p>
<p>Like running a self-hosted blog site, operating your own ad server is not an undertaking to be entered into lightly, not least because you represent potentially serious ill-gotten profits to a Malware-as-a-Service cybercrook. </p>
<p>So it was no surprise to see the Federal Office of Information Security in Germany (BSI, or Bundesamt für Sicherheit in der Informationstechnik), <a href="https://www.bsi.bund.de/DE/Presse/Pressemitteilungen/Presse2013/Verteilung_von_Schadprogrammen_ueber_Werbebanne_05042013.html" rel="nofollow">pushing out warnings</a> about poisoned online adverts in January and in April 2013.</p>
<p>Once again, the BSI pointed the finger at OpenX installations:</p>
<blockquote><p><tt>In the past few days, online criminals have again carried out large-scale compromises of OpenX servers delivering advertising banners. The BSI already warned about this problem in January of this year.</tt></p></blockquote>
<p>Then, two days ago, the BSI issued <a href="https://www.bsi.bund.de/DE/Presse/Pressemitteilungen/Presse2013/Hintertuer_in_aktueller_Version_OpenX_Ad-Servers_06082013.html">another press release</a> on this topic that may help to explain the prevalence of OpenX in reports about poisoned ads:</p>
<blockquote><p><tt>The BSI is reporting a backdoor in the current version of (2.8.10) of the OpenX ad server...The backdoor gives an attacker remote code execution of PHP programs.</tt></p></blockquote>
<p>If fact, it looks as though the Trojanised content was hidden in the OpenX distribution back in November 2012, ten months ago.</p>
<p style='background-color:#e8e8e8;font-size:80%;padding:.71em;padding-left:1.2em;padding-right:1.2em;'><strong>Update:</strong> OpenX emailed us at 2013-08-07T22:12Z to say that 2.8.11 is out, fixing the problem. Details of how to see if you were affected are <a href="http://forum.openx.org/index.php?showtopic=503521628" rel="nofollow">on the OpenX forum</a>.</p>
<h4>What the Trojanised content looks like</h4>
<p>I don&#8217;t have a complete set of malicious files to show you &#8211; happily, 2.8.10 has been pulled from the OpenX download site.</p>
<p>But the core of the attack code is written in PHP and buried, rather unusually, in a JavaScript file that is part of a video player plugin (<tt>vastServeVideoPlayer</tt>) in the OpenX distribution:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2013/08/opnx-php1-470.png" width="470" height="163"></img>  </p>
<p>PHP and JavaScript don&#8217;t usually mix.</p>
<p>JavaScript is delivered to your browser and executed there in order to adjust the look and feel of web pages; PHP is processed on the web server, where it generates web content before it is served.</p>
<p>In this case, the JavaScript you see inside the PHP code fragment above is just there as a visual disguise, consisting entirely of comments that are ignored anyway. </p>
<p>With the comments chopped out, the PHP remaining reads like this:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2013/08/op-x-php2-470.png" width="470" height="86"></img>  </p>
<p>And this boils down to a short but bitter payload:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2013/08/op-x-php3-470.png" width="470" height="56"></img>  </p>
<p>This takes anything that attacker posts, via a form field called <tt>vastPlayer</tt>, reverses it, rot13s it [*], and finally submits it to the PHP engine for execution via the <tt>eval()</tt> function.</p>
<p>Ouch! </p>
<p>This implies that an OpenX server installed from the compromised 2.8.10 sources may very well have been pre-owned, ready for cybcercrooks to wade in and take over as soon as you made it live.</p>
<p>OpenX doesn&#8217;t seem to have made any public announcement so far; indeed, the 2.8.10 version is still listed as the current official download from the OpenX servers:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2013/08/op-x-dload-480.png" width="480" height="275"></img> </p>
<p>However, as mentioned above, the files have been removed:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2013/08/op-x-gone-480.png" width="480" height="231"></img>  </p>
<h4>Suggestions for mitigation</h4>
<p>In you are using OpenX, you can look for evidence of this compromise, or anything orchestrated similarly, by searching through the JavaScript files in your OpenX installation directory for embedded PHP code.</p>
<p>Since embedded PHP code appears between the delimiters <tt>&lt;?php</tt> and <tt>?&gt;</tt>, looking for the opening delimiter is a good start:</p>
<pre style='font-size:80%;'>
$ grep -i '&lt;\?php&#039; $(find /your/openx/tree -name &#039;*.js&#039;)
</pre>
<p>If you have 2.8.10, reports are (and the infected file I received suggests this) that the malicious PHP remote code execution fragment is in a file named:</p>
<pre style='font-size:80%;'>
plugins/
  deliveryLog/
    vastServeVideoPlayer/
      flowplayer/
        3.1.1/
          flowplayer-3.1.1.min.js
</pre>
<p>This file was unchanged from OpenX 2.8.9, so you can replace it from the 2.8.9 download if you like.</p>
<p>(The <tt>vastServeVideoPlayer</tt> is found inside the <tt>openXVideoAds.zip</tt> file in the <tt>etc/plugins</tt> directory.)</p>
<h4>What next?</h4>
<p>I hope this helps, and I hope even more that OpenX comes up soon with some official statements that will help OpenX users determine whether they were affected by this hole.</p>
<p style='padding-bottom:.8em;padding-top:.8em;'></p>
<p style='background-color:#e8e8e8;font-size:80%;padding:.71em;padding-left:1.2em;padding-right:1.2em;'>Sophos Anti-Virus on all platforms detects and blocks this malware as <strong>Troj/PHP-M</strong>.</p>
			</div> <!-- .entry-content -->
	<ul class="block social follow">
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon twitter"><use xlink:href="#twitter"></use></svg>
			<p>Follow <strong><a href="https://twitter.com/nakedsecurity">@NakedSecurity on Twitter</a></strong> for the latest computer security news.</p>
		</li>
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon instagram"><use xlink:href="#instagram"></use></svg>
			<p>Follow <strong><a href="https://www.instagram.com/nakedsecurity/">@NakedSecurity on Instagram</a></strong> for exclusive pics, gifs, vids and LOLs!</p>
		</li>
	</ul>
</article><!-- #post-## -->

		<div class="free-tools-block">
			<h2 class="block-title">Free tools</h2>

<div class="ns-free-tools">
	<div class="ns-free-tools__item ns-free-tools__item--sophos-home">
		<a class="ns-free-tools__link" href="https://home.sophos.com/en-us.aspx?cmp=701j0000001eLpnAAE">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/sophos-home@2x.png" alt="Sophos Home" class="ns-free-tools__image" width="166" height="100">
			<h4 class="ns-free-tools__title">
				Sophos Home			</h4>
			<div class="ns-free-tools__sub-title">
				Protect personal PCs and Macs			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--hitman-pro">
		<a class="ns-free-tools__link" href="https://www.hitmanpro.com/en-us/hmp.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/hitman-pro@2x.png" alt="Hitman Pro" class="ns-free-tools__image" width="154" height="100">
			<h4 class="ns-free-tools__title">
				Hitman Pro			</h4>
			<div class="ns-free-tools__sub-title">
				Find and remove malware			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--intercept-x">
		<a class="ns-free-tools__link" href="https://www.sophos.com/en-us/products/free-tools/sophos-mobile-security-free-edition.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/mobile-security-android@2x.png" alt="Sophos Intercept X for Mobile" class="ns-free-tools__image" width="96" height="110">
			<h4 class="ns-free-tools__title">
				Intercept X for Mobile			</h4>
			<div class="ns-free-tools__sub-title">
				Protect Android devices			</div>
		</a>
	</div>
</div>
		</div>

			<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2013/08/06/just-when-you-thought-it-was-safe-to-go-back-in-the-water-closet/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> Just when you thought it was safe to go back in the water (closet)!</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2013/08/07/daily-mail-readers-wince-as-mail-online-slices-and-dices-their-data/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Daily Mail readers wince as Mail Online slices and dices their data</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	
	</main><!-- #main -->

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<section class="comments-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

			
<div id="comments" class="comments-area">

			<h2 class="comments-title">
			11 comments on &ldquo;<span>OpenX ad servers &#8220;pre-compromised&#8221; &#8211; official distro contained remote code backdoor</span>&rdquo;		</h2>

		<ol class="comment-list">
					<li id="comment-230354" class="comment even thread-even depth-1 parent">
			<article id="div-comment-230354" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/0be4d66c3780c06ba01a236fe1117696?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0be4d66c3780c06ba01a236fe1117696?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Duncan</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/#comment-230354"><time datetime="2013-08-07T12:53:45+01:00">August 7, 2013 at 12:53 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Paul </p>
<p>Our organization recently suffered a spike in ransomware attacks that all originated from users viewing youtube videos.  I can&#039;t seem to find out if youtube uses openx or not.  Do you think the two might be related? </p>
<p>Duncan </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_230354"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_230354={"id":7238218,"unique_id":"wp-comment-230354","title":"Hi%20Paul%20%20Our%20organization%20recently%20suffered%20a%20spike%20in%20ransomware%20attacks%20that%20all%20originated%20from%20users%20viewing%20youtube%20videos.%20%20I%20can%26%23039%3Bt%20seem%20to%20find%20out%20if%20youtube%20uses%20openx%20or%20not.%20%20Do%20y%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/07\/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor\/#comment-230354","item_id":"_comm_230354"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/?replytocom=230354#respond' data-commentid="230354" data-postid="231960" data-belowelement="div-comment-230354" data-respondelement="respond" data-replyto="Reply to Duncan" aria-label='Reply to Duncan'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-230624" class="comment odd alt depth-2">
			<article id="div-comment-230624" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/88df6e6d346de9a8a7cc9264b8557db9?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/88df6e6d346de9a8a7cc9264b8557db9?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Jhuliano</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/#comment-230624"><time datetime="2013-08-07T21:27:03+01:00">August 7, 2013 at 9:27 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi! I&#039;m not Paul but I&#039;m going to try to answer this.<br />
I don&#039;t think that both events are related.<br />
Even if youtube used openX and they got hacked and started to deliver malware to users, it would get noticed and fixed pretty quickly (given the amount of people that access youtube and how Google manage their security).<br />
And also note that Google has its own platform for adds (since that is their main business), so I highly doubt they use OpenX. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_230624"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_230624={"id":7238218,"unique_id":"wp-comment-230624","title":"Hi%21%20I%26%23039%3Bm%20not%20Paul%20but%20I%26%23039%3Bm%20going%20to%20try%20to%20answer%20this.%20I%20don%26%23039%3Bt%20think%20that%20both%20events%20are%20related.%20Even%20if%20youtube%20used%20openX%20and%20they%20got%20hacked%20and%20started%20to%20deliver%20malware%20to%20u%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/07\/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor\/#comment-230624","item_id":"_comm_230624"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/?replytocom=230624#respond' data-commentid="230624" data-postid="231960" data-belowelement="div-comment-230624" data-respondelement="respond" data-replyto="Reply to Jhuliano" aria-label='Reply to Jhuliano'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-232157" class="comment even depth-2">
			<article id="div-comment-232157" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/#comment-232157"><time datetime="2013-08-10T08:01:59+01:00">August 10, 2013 at 8:01 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I doubt it. </p>
<p>How do you know that the ransomware resulted from YouTube itself? If a common video was involved, perhaps there was some other common adjunct to watching the video? (Was it a link in an email? Did the video link somewhere else? Etc.) </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_232157"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_232157={"id":7238218,"unique_id":"wp-comment-232157","title":"I%20doubt%20it.%20%20How%20do%20you%20know%20that%20the%20ransomware%20resulted%20from%20YouTube%20itself%3F%20If%20a%20common%20video%20was%20involved%2C%20perhaps%20there%20was%20some%20other%20common%20adjunct%20to%20watching%20the%20video%3F%20%28Was%20it%20a%20link%20in%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/07\/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor\/#comment-232157","item_id":"_comm_232157"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/?replytocom=232157#respond' data-commentid="232157" data-postid="231960" data-belowelement="div-comment-232157" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-230387" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-230387" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/9bfee7ea8ec9000284a080227c7afdf1?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9bfee7ea8ec9000284a080227c7afdf1?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Carson</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/#comment-230387"><time datetime="2013-08-07T13:38:21+01:00">August 7, 2013 at 1:38 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>&#8220;With the comments chopped out, the PHP remaining reads like this:&#8221;</p>
<p>Like what? I cannot see anything. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_230387"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_230387={"id":7238218,"unique_id":"wp-comment-230387","title":"%26quot%3BWith%20the%20comments%20chopped%20out%2C%20the%20PHP%20remaining%20reads%20like%20this%3A%26quot%3B%20%20Like%20what%3F%20I%20cannot%20see%20anything.%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/07\/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor\/#comment-230387","item_id":"_comm_230387"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/?replytocom=230387#respond' data-commentid="230387" data-postid="231960" data-belowelement="div-comment-230387" data-respondelement="respond" data-replyto="Reply to Carson" aria-label='Reply to Carson'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-230389" class="comment even depth-2">
			<article id="div-comment-230389" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/9bfee7ea8ec9000284a080227c7afdf1?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9bfee7ea8ec9000284a080227c7afdf1?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Carson</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/#comment-230389"><time datetime="2013-08-07T13:42:44+01:00">August 7, 2013 at 1:42 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>UPDATE:</p>
<p>After posting the comment, deceiving white spaces appeared between the paragraphs. A right click revealed it was the pictures. Why this happens I have no clue. Maybe its my browser, maybe its the HTML. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_230389"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_230389={"id":7238218,"unique_id":"wp-comment-230389","title":"UPDATE%3A%20After%20posting%20the%20comment%2C%20deceiving%20white%20spaces%20appeared%20between%20the%20paragraphs.%20A%20right%20click%20revealed%20it%20was%20the%20pictures.%20Why%20this%20happens%20I%20have%20no%20clue.%20Maybe%20its%20my%20browser%2C%20maybe%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/07\/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor\/#comment-230389","item_id":"_comm_230389"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/?replytocom=230389#respond' data-commentid="230389" data-postid="231960" data-belowelement="div-comment-230389" data-respondelement="respond" data-replyto="Reply to Carson" aria-label='Reply to Carson'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-230398" class="comment byuser comment-author-markstockley odd alt depth-2 parent">
			<article id="div-comment-230398" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/4a3accc0a742c1ee09af28a5dc893fa5?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4a3accc0a742c1ee09af28a5dc893fa5?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">markstockley</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/#comment-230398"><time datetime="2013-08-07T13:49:11+01:00">August 7, 2013 at 1:49 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Carson, </p>
<p>Some readers appear to be having trouble seeing the images embedded in this article that show the code. We don&#039;t know why but we&#039;re looking into it. In the mean time please do try a shift+refresh to see if you can reload them. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_230398"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_230398={"id":7238218,"unique_id":"wp-comment-230398","title":"Hi%20Carson%2C%20%20Some%20readers%20appear%20to%20be%20having%20trouble%20seeing%20the%20images%20embedded%20in%20this%20article%20that%20show%20the%20code.%20We%20don%26%23039%3Bt%20know%20why%20but%20we%26%23039%3Bre%20looking%20into%20it.%20In%20the%20mean%20time%20please%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/07\/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor\/#comment-230398","item_id":"_comm_230398"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/?replytocom=230398#respond' data-commentid="230398" data-postid="231960" data-belowelement="div-comment-230398" data-respondelement="respond" data-replyto="Reply to markstockley" aria-label='Reply to markstockley'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-233362" class="comment even depth-3">
			<article id="div-comment-233362" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/#comment-233362"><time datetime="2013-08-12T12:22:52+01:00">August 12, 2013 at 12:22 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hahahaha. We probably should have thought of this, but&#8230; </p>
<p>&#8230;you know when AdBlock claims on its that it &quot;can do more than blocking ads [sic]&quot;? </p>
<p>Turns out to be true. Changing just the first five chars of the image filenames from &quot;openx&quot; to &quot;op-x&quot; seems to have counter-tricked AdBlock. So you should be OK now. </p>
<p>PS. Thanks to our chum Graham Cluley for reporting this like a model customer! &quot;I have noticed that turning off AdBlock seems to fix this problem,&quot; he said. From *there*, it was easy 🙂 </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_233362"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_233362={"id":7238218,"unique_id":"wp-comment-233362","title":"Hahahaha.%20We%20probably%20should%20have%20thought%20of%20this%2C%20but...%20%20...you%20know%20when%20AdBlock%20claims%20on%20its%20that%20it%20%26quot%3Bcan%20do%20more%20than%20blocking%20ads%20%26%23091%3Bsic%26%23093%3B%26quot%3B%3F%20%20Turns%20out%20to%20be%20true.%20Changing%20just%20the%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/07\/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor\/#comment-233362","item_id":"_comm_233362"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/?replytocom=233362#respond' data-commentid="233362" data-postid="231960" data-belowelement="div-comment-233362" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-230440" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-230440" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/88df6e6d346de9a8a7cc9264b8557db9?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/88df6e6d346de9a8a7cc9264b8557db9?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Jhuliano</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/#comment-230440"><time datetime="2013-08-07T14:54:14+01:00">August 7, 2013 at 2:54 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>There is something that I don&#039;t get about this backdoor, normally PHP code wont get executed if it&#039;s inside a .JS file&#8230; You would need to set that rule in your .htaccess or in the webserver config files, I&#039;m right?<br />
If that is right, I don&#039;t think that most servers are configured that way. I know it&#039;s still a backdoor, but, maybe the hackers didn&#039;t get much out of it. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_230440"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_230440={"id":7238218,"unique_id":"wp-comment-230440","title":"There%20is%20something%20that%20I%20don%26%23039%3Bt%20get%20about%20this%20backdoor%2C%20normally%20PHP%20code%20wont%20get%20executed%20if%20it%26%23039%3Bs%20inside%20a%20.JS%20file...%20You%20would%20need%20to%20set%20that%20rule%20in%20your%20.htaccess%20or%20in%20the%20web%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/07\/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor\/#comment-230440","item_id":"_comm_230440"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/?replytocom=230440#respond' data-commentid="230440" data-postid="231960" data-belowelement="div-comment-230440" data-respondelement="respond" data-replyto="Reply to Jhuliano" aria-label='Reply to Jhuliano'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-230500" class="comment even depth-2 parent">
			<article id="div-comment-230500" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/a3012175633acf628035547bbb30a332?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a3012175633acf628035547bbb30a332?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Ben Scherrey</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/#comment-230500"><time datetime="2013-08-07T16:43:59+01:00">August 7, 2013 at 4:43 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>It&#039;s not PHP code hidden in javascript. It&#039;s something pretending to look like javascript code hidden inside obfuscated (but very executable) PHP code. PHP is a virus. Why are people still writing business code in it? </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_230500"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_230500={"id":7238218,"unique_id":"wp-comment-230500","title":"It%26%23039%3Bs%20not%20PHP%20code%20hidden%20in%20javascript.%20It%26%23039%3Bs%20something%20pretending%20to%20look%20like%20javascript%20code%20hidden%20inside%20obfuscated%20%28but%20very%20executable%29%20PHP%20code.%20PHP%20is%20a%20virus.%20Why%20are%20people%20st%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/07\/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor\/#comment-230500","item_id":"_comm_230500"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/?replytocom=230500#respond' data-commentid="230500" data-postid="231960" data-belowelement="div-comment-230500" data-respondelement="respond" data-replyto="Reply to Ben Scherrey" aria-label='Reply to Ben Scherrey'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-230554" class="comment odd alt depth-3 parent">
			<article id="div-comment-230554" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/#comment-230554"><time datetime="2013-08-07T17:44:20+01:00">August 7, 2013 at 5:44 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Actually, it&#039;s obfuscated PHP code pretending to be Javascript (those comments that vanish) *hidden in JavaScript*.  </p>
<p>I wrote that the &quot;core of the attack code is written in PHP and buried, rather unusually, in a JavaScript file,&quot; and then followed that remark with an image of *just the PHP* dug out of the surrounding JavaScript it&#039;s hidden in.  </p>
<p>I probably should have left some of the surrounding JavaScript in my image to make that clearer, or explained what I just said in the article itself.  </p>
<p>In short: the obfu-ed PHP you see above is not the entire malicious file, just a tiny part of it extracted for the article. </p>
<p>But @Jhuliano is right: this dodgy JS file is not enough *on its own* to effect the compromise, since the flowplayer-3.1.1.min.js would not (as far as I can see) be pushed through the PHP engine by default.   </p>
<p>However, as I intimated in the article, I only have the dodgy JS file, and not the rest of the 2.8.10 distro&#8230;if anyone *does* have it, perhaps you can have a (careful 🙂 look to see if there are any unusual tweaks to config files or setup scripts in there that would cause the JS to be PHPed first. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_230554"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_230554={"id":7238218,"unique_id":"wp-comment-230554","title":"Actually%2C%20it%26%23039%3Bs%20obfuscated%20PHP%20code%20pretending%20to%20be%20Javascript%20%28those%20comments%20that%20vanish%29%20%2Ahidden%20in%20JavaScript%2A.%20%20%20%20I%20wrote%20that%20the%20%26quot%3Bcore%20of%20the%20attack%20code%20is%20written%20in%20PHP%20and%20bu%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/07\/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor\/#comment-230554","item_id":"_comm_230554"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/?replytocom=230554#respond' data-commentid="230554" data-postid="231960" data-belowelement="div-comment-230554" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-230607" class="comment even depth-4">
			<article id="div-comment-230607" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/88df6e6d346de9a8a7cc9264b8557db9?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/88df6e6d346de9a8a7cc9264b8557db9?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Jhuliano</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/#comment-230607"><time datetime="2013-08-07T20:21:40+01:00">August 7, 2013 at 8:21 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks for the answer Paul.<br />
OpenX staff have just released a note in their forums: <a href="http://forum.openx.org/index.php?showtopic=503521628" rel="nofollow">http://forum.openx.org/index.php?showtopic=503521&#8230;</a><br />
As you can see in the thread they ask people to check 3 different files. Maybe the rest of the backdoor is there. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_230607"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_230607={"id":7238218,"unique_id":"wp-comment-230607","title":"Thanks%20for%20the%20answer%20Paul.%20OpenX%20staff%20have%20just%20released%20a%20note%20in%20their%20forums%3A%20%26lt%3Ba%20href%3D%26quot%3Bhttp%3A%2F%2Fforum.openx.org%2Findex.php%3Fshowtopic%3D503521628%26quot%3B%20rel%3D%26quot%3Bnofollow%26quot%3B%26gt%3Bhttp%3A%2F%2Fforum.openx.org%2Findex.php%3Fs%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/07\/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor\/#comment-230607","item_id":"_comm_230607"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/?replytocom=230607#respond' data-commentid="230607" data-postid="231960" data-belowelement="div-comment-230607" data-respondelement="respond" data-replyto="Reply to Jhuliano" aria-label='Reply to Jhuliano'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-230616" class="comment odd alt depth-3">
			<article id="div-comment-230616" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/88df6e6d346de9a8a7cc9264b8557db9?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/88df6e6d346de9a8a7cc9264b8557db9?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Jhuliano</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/#comment-230616"><time datetime="2013-08-07T21:11:45+01:00">August 7, 2013 at 9:11 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>What you are saying is the exact same thing I said, it&#039;s PHP code inside a .JS file (javascript). But it&#039;s NOT very executable, you will need to do certain configurations to make that PHP code execute.<br />
And I don&#039;t get why you think that PHP is &quot;a virus&quot;, I can do that exact same thing using .NET, Python, Java, you mention it&#8230; that has nothing to do with bad codding nor language weakness. It&#039;s just a random backdoor inserted in a open source project. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_230616"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_230616={"id":7238218,"unique_id":"wp-comment-230616","title":"What%20you%20are%20saying%20is%20the%20exact%20same%20thing%20I%20said%2C%20it%26%23039%3Bs%20PHP%20code%20inside%20a%20.JS%20file%20%28javascript%29.%20But%20it%26%23039%3Bs%20NOT%20very%20executable%2C%20you%20will%20need%20to%20do%20certain%20configurations%20to%20make%20that%20P%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2013\/08\/07\/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor\/#comment-230616","item_id":"_comm_230616"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/?replytocom=230616#respond' data-commentid="230616" data-postid="231960" data-belowelement="div-comment-230616" data-respondelement="respond" data-replyto="Reply to Jhuliano" aria-label='Reply to Jhuliano'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">What do you think? <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2013/08/07/openx-ad-servers-pre-compromised-official-distro-contained-remote-code-backdoor/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://nakedsecurity.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='231960' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="6fc9be9b78" /></p><input type="hidden" id="ak_js" name="ak_js" value="89"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->
		<div class="comments-widget-area">
					</div>
	
	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	

	<section class="recommended-panel">
	<div class="container">
	<div class="panel-content ">

		<h3 class="block-title">Recommended reads</h3>
	<div class="blocks">
		<article id="post-561067" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/03/17/serious-security-the-linux-kernel-bugs-that-surfaced-after-15-years/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/3lb.001.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Mar</span><span class="day">17</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">5</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/03/17/serious-security-the-linux-kernel-bugs-that-surfaced-after-15-years/" rel="bookmark">Serious Security: The Linux kernel bugs that surfaced after 15 years</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-544664" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/01/25/naked-security-live-dont-let-digital-jokes-turn-into-digital-disasters/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/10/nslive-1200-3.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Jan</span><span class="day">25</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">0</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/01/25/naked-security-live-dont-let-digital-jokes-turn-into-digital-disasters/" rel="bookmark">Naked Security Live &#8211; Don’t let digital jokes turn into digital disasters</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-545475" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/02/18/s3-ep20-corporate-megahacking-true-love-gone-bad-and-tax-grabs-podcast/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/02/nean-with-mic-wt-green-ivy-1200.jpg?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Feb</span><span class="day">18</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">1</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/02/18/s3-ep20-corporate-megahacking-true-love-gone-bad-and-tax-grabs-podcast/" rel="bookmark">S3 Ep20: Corporate megahacking, true love gone bad, and tax grabs [Podcast]</a></h3>	</div>
</article> <!-- .card-article -->
	</div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="footer-container">
			<a href="#" class="js-collapse-footer"><svg style="height: 20px" viewBox="0 0 132 24" class="block icon sophos"><use xlink:href="#sophos"></use></svg></a>
			<div id="collapseFooter" class="blocks">
				<div class="sophos block">
					<ul id="menu-footer-primary" class="primary menu"><li id="menu-item-306737" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306737"><a href="https://nakedsecurity.sophos.com/about/">About Naked Security</a></li>
<li id="menu-item-306754" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306754"><a href="https://www.sophos.com/en-us/company.aspx">About Sophos</a></li>
<li id="menu-item-306747" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306747"><a href="https://nakedsecurity.sophos.com/send-us-a-tip/">Send us a tip</a></li>
<li id="menu-item-323171" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323171"><a href="/cookies-and-scripts/">Cookies</a></li>
<li id="menu-item-323170" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323170"><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
<li id="menu-item-323169" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323169"><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
</ul>				</div>
										<div class="news block">
							<ul id="menu-products-column-one" class="small menu"><li id="menu-item-306998" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306998"><a href="https://www.sophos.com/en-us/products/intercept-x.aspx">Intercept X</a></li>
<li id="menu-item-440801" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440801"><a href="https://www.sophos.com/en-us/products/server-security.aspx">Intercept X for Server</a></li>
<li id="menu-item-440802" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440802"><a href="https://www.sophos.com/en-us/products/mobile-control.aspx">Intercept X for Mobile</a></li>
</ul>						</div>
											<div class="products block">
							<ul id="menu-products-column-two" class="small menu"><li id="menu-item-440803" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440803"><a href="https://www.sophos.com/en-us/products/next-gen-firewall.aspx">XG Firewall</a></li>
<li id="menu-item-440805" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440805"><a href="https://www.sophos.com/en-us/products/sophos-email.aspx">Sophos Email</a></li>
<li id="menu-item-440804" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440804"><a href="https://www.sophos.com/en-us/products/secure-wifi.aspx">Sophos Wireless</a></li>
</ul>						</div>
											<div class="threats block">
							<ul id="menu-server-protection" class="small menu"><li id="menu-item-440806" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440806"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx">Managed Threat Response</a></li>
<li id="menu-item-448404" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-448404"><a href="https://www.sophos.com/en-us/products/cloud-optix.aspx">Cloud Optix</a></li>
<li id="menu-item-440807" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440807"><a href="https://www.sophos.com/en-us/products/phish-threat.aspx">Phish Threat</a></li>
</ul>						</div>
								</div>
			<ul class="block social footer">
				<li class="twitter"><a rel="nofollow" href="https://twitter.com/NakedSecurity" title="Follow our team of security experts on Twitter"><svg style="height: 14px" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
				<li class="facebook"><a rel="nofollow" href="https://www.facebook.com/SophosSecurity" title="Join over 250,000 people in our Facebook community"><svg style="height: 14px" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
				<li class="instagram"><a rel="nofollow" href="https://www.instagram.com/nakedsecurity/" title="Follow Naked Security on Instagram"><svg style="height: 14px" viewBox="0 0 100 100" class="icon instagram"><use xlink:href="#instagram"></use></svg></a></li>
				<li class="linkedin"><a rel="nofollow" href="https://www.linkedin.com/company/5053/" title="Join the naked security discussion group on LinkedIn"><svg style="height: 14px" viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
				<li class="rss"><a rel="nofollow" href="/feed" title="Subscribe to our RSS feed"><svg style="height: 14px" viewBox="0 0 100 100" class="icon rss"><use xlink:href="#rss"></use></svg></a></li>
			</ul>

							<div class="vip-powered-wpcom">
					<span class="copyright">© 1997 - 2021 Sophos Ltd.</span>
					All rights reserved.
					Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=nakedsecurity.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>				</div>
					</div>
		<script type="text/javascript">
			window.cookieconsent_options = {
				"message":"This site uses cookies. By continuing to browse the site you are agreeing to our use of cookies.",
				"dismiss":"Got it!",
				"learnMore":"Learn More",
				"link":"/cookies-and-scripts",
				"theme":"https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/css/sophos.css"};
		</script>
	</footer><!-- #colophon -->
</div><!-- #page -->
<div id="survey-wrapper" class="mfp-hide"><div class="pd-embed" id="pd_1499706777" data-settings=""></div></div>
<script id='child-js-plugins-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"0","nextLink":""};
</script>
<script id='child-js-core-js-extra'>
var Sophos = {"ajaxurl":"https:\/\/nakedsecurity.sophos.com\/wp-admin\/admin-ajax.php","nonce":"64f6810f0c"};
</script>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJyNjkEOwjAMBD9EalKU3hBPQZAamhDbUZyo4vdEiEocOHD07ozWsGbjhStyhbogoYJKXkQZVzXj3jqICjm1e2Adou7gL8FLwY0O7FObO/fOibppCub0HCjwL6ifSFecv/ttkpr5PAOXR1DCCufuwk0KdfZERztZdxitc1N8ARFpT3A='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161173',post:'231960',tz:'0',srv:'nakedsecurity.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161173', '231960' ]);
</script>
</body>
</html>
