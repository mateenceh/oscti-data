<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="RHQeasQqjasbRt5asY6atZYbs5tr10gFBevDt2HRhW0" />
<link rel="pingback" href="https://nakedsecurity.sophos.com/xmlrpc.php">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5VK6LTK');</script>
<!-- End Google Tag Manager -->

<meta name="description" content="Colour-coded JavaScript? Paul Ducklin looks into a malware writer&#039;s poisoned-image trick that tells an interesting (and, though it hurts to say it, an amusing) story of subterfuge and guile..." />
<meta name="keywords" content="malware, web browsers, anatomy, encoding, exploit, image, javascript, obfuscation, png, vulnerability" />
<title>Anatomy of a poisoned image: colour-coded JavaScript! &#8211; Naked Security</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="I9dHFo-YhnK2MfAHn-20V4GnWrOttVUYyISGamyU41M" />
<meta name="msvalidate.01" content="7D8D1FA2892142B1543D2CBCD07FB88F" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Feed" href="https://nakedsecurity.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Comments Feed" href="https://nakedsecurity.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Anatomy of a poisoned image: colour-coded JavaScript! Comments Feed" href="https://nakedsecurity.sophos.com/2014/02/07/anatomy-of-a-poisoned-image-colour-coded-javascript/feed/" />
<link rel='stylesheet' id='all-css-0' href='https://nakedsecurity.sophos.com/_static/??-eJyVz00KwjAQhuELmUwqttCFeJY0GUw0f2QmlN6+KXbnRpcD7wPfwFqETyY0iwSGCKwnhiVk8xbBL1XXDYi3gDL6JHtwgS5MToyJgR3G7igXlynhSuKqhvEE/8QiaEbiX80xVFvJrqJm4VqPq9SxfPnYRAnt6RPBC7no/tUsP/68D/KI92Eaxtuk1Kx2dxVjDA==' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqXEWAK9AIhg='></script>
<link rel="https://api.w.org/" href="https://nakedsecurity.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://nakedsecurity.sophos.com/wp-json/wp/v2/posts/245219" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://nakedsecurity.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://nakedsecurity.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://nakedsecurity.sophos.com/2014/02/07/anatomy-of-a-poisoned-image-colour-coded-javascript/" />
<link rel='shortlink' href='https://nakedsecurity.sophos.com/?p=245219' />
<link rel="alternate" type="application/json+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2014%2F02%2F07%2Fanatomy-of-a-poisoned-image-colour-coded-javascript%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2014%2F02%2F07%2Fanatomy-of-a-poisoned-image-colour-coded-javascript%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://nakedsecurity.sophos.com/2014/02/07/anatomy-of-a-poisoned-image-colour-coded-javascript/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Anatomy of a poisoned image: colour-coded JavaScript!" />
<meta property="og:url" content="https://nakedsecurity.sophos.com/2014/02/07/anatomy-of-a-poisoned-image-colour-coded-javascript/" />
<meta property="og:description" content="Colour-coded JavaScript? Paul Ducklin looks into a malware writer&#8217;s poisoned-image trick that tells an interesting (and, though it hurts to say it, an amusing) story of subterfuge and guile&amp;#â€¦" />
<meta property="article:published_time" content="2014-02-07T20:51:33+00:00" />
<meta property="article:modified_time" content="2014-02-07T21:01:20+00:00" />
<meta property="og:site_name" content="Naked Security" />
<meta property="og:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/poisoned-img-250.png?w=250" />
<meta property="og:image:secure_url" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/poisoned-img-250.png?w=250" />
<meta property="og:image:width" content="250" />
<meta property="og:image:height" content="250" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@NakedSecurity" />
<meta name="twitter:text:title" content="Anatomy of a poisoned image: colour-coded JavaScript!" />
<meta name="twitter:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/poisoned-img-250.png?w=144" />
<meta name="twitter:card" content="summary" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=270" />
</head>
<body class="post-template-default single single-post postid-245219 single-format-standard" >
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VK6LTK"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div style="display: none">
<svg>
	<symbol id="sophos" viewBox="0 0 132 24">
		<path d="m111.82 22.176h11.64c3.267 0 4.65-0.2 5.74-0.896 1.715-1.063 2.804-3.26 2.804-5.62 0-1.928-0.658-3.89-1.647-4.888-1.288-1.33-3.035-1.828-6.271-1.828h-3.527c-1.586 0-2.754-0.067-3.412-0.365-0.794-0.367-1.256-1.165-1.256-2.161 0-1.165 0.56-2.03 1.486-2.264 0.692-0.163 1.498-0.163 3.574-0.198h10.419v-3.956h-11.473c-2.574 0-3.727 0.099-4.718 0.466-2.279 0.796-3.828 3.257-3.828 6.083 0 1.93 0.76 3.727 2.079 4.89 1.155 0.996 2.872 1.462 5.51 1.462h4.697c1.057 0 1.915 0.132 2.376 0.398 0.893 0.433 1.418 1.328 1.418 2.36 0 0.864-0.395 1.597-1.087 2.027-0.561 0.369-1.517 0.534-3.268 0.534h-11.256zm-111.35 0h11.64c3.267 0 4.652-0.2 5.741-0.896 1.714-1.063 2.803-3.26 2.803-5.62 0-1.928-0.66-3.89-1.65-4.888-1.285-1.33-3.034-1.828-6.27-1.828h-3.527c-1.584 0-2.751-0.067-3.41-0.365-0.792-0.367-1.253-1.165-1.253-2.161 0-1.165 0.56-2.03 1.484-2.264 0.693-0.163 1.496-0.163 3.574-0.198h10.42v-3.956h-11.477c-2.573 0-3.727 0.099-4.715 0.466-2.278 0.796-3.83 3.257-3.83 6.083 0 1.93 0.762 3.727 2.08 4.89 1.155 0.996 2.871 1.462 5.51 1.462h4.696c1.057 0 1.913 0.132 2.377 0.398 0.888 0.433 1.416 1.328 1.416 2.36 0 0.864-0.394 1.597-1.089 2.027-0.558 0.369-1.517 0.534-3.264 0.534h-11.256v3.956zm94.05-16.18c-0.68 1.076-1.003 2.803-1.003 5.122 0 5.088 1.747 7.405 5.63 7.405 3.822 0 5.568-2.317 5.568-7.34 0-5.092-1.715-7.373-5.568-7.373-2.102 0-3.754 0.784-4.627 2.186zm13.174-2.511c1.329 1.761 2.072 4.63 2.072 7.992 0 3.816-1.197 6.948-3.334 8.677-1.619 1.304-4.078 2.022-6.995 2.022-4.142 0-7.41-1.372-9.092-3.817-1.263-1.793-1.88-4.176-1.88-7.08 0-4.172 1.133-7.339 3.27-9.035 1.682-1.37 4.339-2.122 7.383-2.122 3.85 0 6.925 1.209 8.576 3.363zm-22.018-3.068h-4.596v8.908h-8.319v-8.908h-4.597v21.759h4.597v-8.97h8.318v8.97h4.596v-21.759zm-28.61 10.277c1.23 0 1.941-0.163 2.427-0.62 0.581-0.49 0.938-1.533 0.938-2.74 0-1.436-0.58-2.478-1.584-2.838-0.356-0.13-0.94-0.197-1.684-0.197h-6.344v6.395zm-6.247 11.481h-4.598v-21.758h10.78c3.786 0 5.114 0.39 6.538 1.991 1.264 1.37 1.942 3.163 1.942 5.088 0 2.284-0.904 4.404-2.394 5.676-1.262 1.077-2.43 1.402-4.888 1.402h-7.38zm-22.589-16.179c-0.682 1.076-1.004 2.803-1.004 5.122 0 5.088 1.748 7.405 5.634 7.405 3.818 0 5.568-2.317 5.568-7.34 0-5.092-1.716-7.373-5.568-7.373-2.106 0-3.757 0.784-4.63 2.186zm13.174-2.511c1.328 1.761 2.073 4.63 2.073 7.992 0 3.816-1.2 6.948-3.335 8.677-1.618 1.304-4.079 2.022-6.993 2.022-4.144 0-7.413-1.372-9.096-3.817-1.264-1.793-1.878-4.176-1.878-7.08 0-4.172 1.133-7.339 3.272-9.035 1.681-1.37 4.337-2.122 7.38-2.122 3.851 0 6.93 1.209 8.578 3.363z"></path>
	</symbol>
	<symbol id="twitter" viewBox="0 0 24 24">
 		<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path>
 	</symbol>
	<symbol id="facebook" viewBox="0 0 24 24">
 		<path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path>
 	</symbol>
	<symbol id="instagram" viewBox="0 0 24 24">
		<path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path>
	</symbol>
	<symbol id="linkedin" viewBox="0 0 24 24">
		<path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"></path>
	</symbol>
	<symbol id="rss" viewBox="0 0 24 24">
		<path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"></path>
	</symbol>
	<symbol id="reddit" viewBox="0 0 24 24">
		<path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"></path>
	</symbol>
</svg>
</div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header variation variation-3" role="banner">
		<div class="header-container">
			<div class="site-branding">
				<div class="site-title">
					<a title="Naked Security" href="https://nakedsecurity.sophos.com/" rel="home"><img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/naked-security-logo-white@2x.png"></a>
					by
					<a title="sophos.com" href="https://www.sophos.com"><svg viewBox="0 0 132 24" class="icon sophos"><use xlink:href="#sophos"></use></svg></a>
				</div>
			</div><!-- .site-branding -->
			<nav id="site-navigation" class="main-navigation" role="navigation">
				<div class="container">
					<ul id="menu-variation-two" class="exit-links menu"><li id="menu-item-436509" class="products menu-item menu-item-type-custom menu-item-object-custom menu-item-436509"><a href="#">Products</a></li>
<li id="menu-item-436515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436515"><a href="https://www.sophos.com/en-us/products/free-tools.aspx">Free Tools</a></li>
<li id="menu-item-436531" class="search-toggle menu-item menu-item-type-custom menu-item-object-custom menu-item-436531"><a href="#">Search</a></li>
<li id="menu-item-436532" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436532"><a href="https://home.sophos.com/en-us.aspx">Free Sophos Home</a></li>
</ul>				</div>
			</nav><!-- #site-navigation -->
			<div class="site-search-block">
	<form target="_top" role="search" class="search-form" method="get" action="https://nakedsecurity.sophos.com/">
        <fieldset>
            <div class="field">
				<input type="search" value="" name="s" class="search-field" placeholder="Search naked security...">
            </div>
            <div class="submit">
				<button type="submit" class="search-submit button">Go</button>
            </div>
        </fieldset>
    </form>
</div>
		</div><!-- .container -->
	</header>

	<div class="responsive-flyout-panel small-12 column active" style="opacity: 1; display: none;">
		<div class="modal-filler"></div>
	    <div class="productNavBox">
	        <div class="productNavContainer">
	            <div class="row prodRow">
	                <div class="prodListBox column large-9">
	                    <div class="row margin-0 highlightProduct">
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/next-gen-firewall.aspx"><img src="https://www.sophos.com/medialibrary/2F4785DE8C3F43ECBD699A18F332FEEB.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">XG Firewall</div>
	                                	<div class="menu-section-subtitle">Next-Gen Firewall</div>
									</div>
	                            </a>
	                        </div>
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/intercept-x.aspx"><img src="https://www.sophos.com/medialibrary/27111765D65A45D49A232925D2CE428B.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">Intercept X</div>
	                                	<div class="menu-section-subtitle">Next-Gen Endpoint</div>
									</div>
	                            </a>
	                        </div>
	                    </div>
	                    <div class="productList">
	                        <ul>
								<li>
									<a href="https://www.sophos.com/en-us/products/cloud-optix.aspx"><img src="https://www.sophos.com/medialibrary/SophosNext/Images/Products/Icons/sophos-cloud-optix-icon.svg">Sophos Cloud Optix</a>
								</li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-central.aspx"><img src="https://www.sophos.com/medialibrary/08EA66123F1B4DDE8FE5C9B578A7FAA7.ashx">Sophos Central</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/mobile-control.aspx"><img src="https://www.sophos.com/medialibrary/678FE994855047739F50D6C411184FA6.ashx">Sophos Mobile</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/server-security.aspx"><img src="https://www.sophos.com/medialibrary/01B80E7D7CD54EF8AC2E51C9C6EC0236.ashx">Intercept X for Server</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-wifi.aspx"><img src="https://www.sophos.com/medialibrary/BEBD9C41BB4E480498514B29B92A145A.ashx">Secure Wi-Fi</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/phish-threat.aspx"><img src="https://www.sophos.com/medialibrary/DC9D1A7BA3964B0C9DAF1F1E68806B5A.ashx">Phish Threat</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/safeguard-encryption.aspx"><img src="https://www.sophos.com/medialibrary/8F51F06B62814B108D3B2763FF018E37.ashx">SafeGuard Encryption</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-email.aspx"><img src="https://www.sophos.com/medialibrary/597ADA0AF01A4A12B2B27239D0F9992C.ashx">Secure Email</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/unified-threat-management.aspx"><img src="https://www.sophos.com/medialibrary/8CB72BF5E1AD41F7894CE5E42101B0F3.ashx">SG UTM</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-web-gateway.aspx"><img src="https://www.sophos.com/medialibrary/C586E372694547A1B207A61D87246BA7.ashx">Secure Web Gateway</a>
	                            </li>
	                        </ul>
	                    </div>
	                </div>
	                <div class="homeUserBox column large-3">
						<img src="https://www.sophos.com/medialibrary/3376DF5742A64AEE93FDB9DCA7291239.ashx">
						<div class="menu-section-title">For Home Users</div>
	                    <p>Sophos Home protects every Mac and PC in your home </p><a href="https://home.sophos.com/" target="_blank" class="greenSmallMenuBtn">Learn More</a>
					</div>
	            </div>
	            <div class="row blueRow">
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-tools.aspx"><img width="19" src="https://www.sophos.com/medialibrary/A1FF440D2BB84511B8C94D771D44E207.ashx">Free Security Tools</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-trials.aspx"><img width="20" src="https://www.sophos.com/medialibrary/FCD3410ED2C347808D9DB8AC12C62DBD.ashx">Free Trials</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/demos.aspx"><img width="18" src="https://www.sophos.com/medialibrary/50985180E5F54C94917A2A6508E24287.ashx">Product Demos</a>
	                </div>
	                <!-- <div class="column large-3 medium-6">
	                    <a href="javascript:fairfax.openLiveChatFromFlyoutLink();" class="flyout-live-chat-link"><img width="20" src="https://www.sophos.com/medialibrary/E24C5050837145F6A5C592E299BA2A0D.ashx">Live Sales Chat</a>
	                </div> -->
	            </div>
	        </div>
	    </div>
	</div>
	<script>

	jQuery(document).ready( function () {
		var productButton   = jQuery('nav .menu-item.products');
		var modalBackground = jQuery('.modal-filler');
		var flyoutMenu		= jQuery('.responsive-flyout-panel');
		var Sophos			= Sophos || {};

		Sophos.MenuTest = {};

		Sophos.MenuTest.open = function () {
				productButton.addClass('open');
				flyoutMenu.show();
				modalBackground.show();
		};

		Sophos.MenuTest.close = function () {
			productButton.removeClass('open');
			flyoutMenu.hide();
			modalBackground.hide();
		};

		Sophos.MenuTest.toggle = function () {
			if ( productButton.hasClass('open') ) {
				Sophos.MenuTest.close();
			} else {
				Sophos.MenuTest.open();
			}
		};

		productButton.click( Sophos.MenuTest.toggle );
		modalBackground.click( Sophos.MenuTest.close );
	});

	</script>

	
	<section class="about-panel">
	<div class="container">
	<div class="panel-content ">

		<div class="description"><span>Have you listened to our podcast? <a href="/podcast/">Listen now</a></span></div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	<div id="content" class="site-content">
		<div class="content-container">

</div> <!-- .container -->
</div> <!-- #content -->


	<section class="content-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

		<main id="main" class="site-main" role="main">

	
		
<article id="post-245219" class="post-245219 post type-post status-publish format-standard has-post-thumbnail hentry category-featured category-malware category-web-browsers tag-anatomy tag-encoding tag-exploit tag-image tag-javascript tag-obfuscation tag-png tag-vulnerability-2">

	<header class="entry-header">
		<h1 class="entry-title">Anatomy of a poisoned image: colour-coded JavaScript!</h1>		<div class="entry-meta">
			<div>
				
	<span class="entry-published">
		<time class="entry-date published" datetime="2014-02-07T20:51:33+00:00">07 Feb 2014</time>
	</span>

					<a href="#comments" class="comment-box">
					<span class="count">6</span>
				</a>
					
	<span class="entry-categories">
	<a href="https://nakedsecurity.sophos.com/category/security-threats/malware/">Malware</a>, <a href="https://nakedsecurity.sophos.com/category/technologies/web-browsers/">Web Browsers</a>	</span>

			</div>
	</header> <!-- .entry-header -->

    <div id="newsletter-signup" class="container top"></div>

			<div class="entry-featured-image">
			<img width="250" height="250" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/poisoned-img-250.png?w=250&amp;h=250&amp;crop=1" class="attachment-hero-thumbnail size-hero-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/poisoned-img-250.png 250w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/poisoned-img-250.png?resize=150,150 150w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/poisoned-img-250.png?resize=225,225 225w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/poisoned-img-250.png?resize=70,70 70w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/poisoned-img-250.png?resize=32,32 32w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/poisoned-img-250.png?resize=50,50 50w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/poisoned-img-250.png?resize=64,64 64w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/poisoned-img-250.png?resize=96,96 96w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/poisoned-img-250.png?resize=128,128 128w" sizes="(max-width: 250px) 100vw, 250px" />					</div> <!-- .entry-featured-image -->
		
		<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2014/02/07/will-passports-of-the-future-incorporate-our-body-smell/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> Will passports of the future incorporate our body smell?</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2014/02/08/the-spampionship-the-pwn2own-unicorn-and-how-target-was-breached-60-sec-security-video/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> The Spampionship, the PWN2OWN unicorn, and how Target was breached &#8211; 60 Sec Security [VIDEO]</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	<div class="entry-content">
		<div class="entry-prefix">
			<div class="entry-author">
				
	
					<span class="by">by</span>
			<a href="https://nakedsecurity.sophos.com/author/paul-ducklin/" title="Posts by Paul Ducklin" class="author url fn" rel="author">Paul Ducklin</a>		
	
				</div>
			<div class="entry-sharing">
				
	<ul class="block social share">
		<li class="facebook"><a href="https://www.facebook.com/share.php?u=https%3A%2F%2Fnakedsecurity.sophos.com%2F2014%2F02%2F07%2Fanatomy-of-a-poisoned-image-colour-coded-javascript%2F&title=Anatomy+of+a+poisoned+image%3A+colour-coded+JavaScript%21" data-title="Anatomy of a poisoned image: colour-coded JavaScript!" title="Share on Facebook"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
		<li class="twitter"><a href="https://twitter.com/intent/tweet?text=Anatomy+of+a+poisoned+image%3A+colour-coded+JavaScript%21+https%3A%2F%2Fnakedsecurity.sophos.com%2F%3Fp%3D245219" data-title="Anatomy of a poisoned image: colour-coded JavaScript!" title="Share on Twitter"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
		<li class="linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2014%2F02%2F07%2Fanatomy-of-a-poisoned-image-colour-coded-javascript%2F&title=Anatomy+of+a+poisoned+image%3A+colour-coded+JavaScript%21" data-title="Anatomy of a poisoned image: colour-coded JavaScript!" title="Share on LinkedIn"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
		<li class="reddit"><a href="https://reddit.com/submit/?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2014%2F02%2F07%2Fanatomy-of-a-poisoned-image-colour-coded-javascript%2F&title=Anatomy+of+a+poisoned+image%3A+colour-coded+JavaScript%21" title="Share on Reddit"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon reddit"><use xlink:href="#reddit"></use></svg></a></li>

			</ul>

				</div>
		</div>
		<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/02/poisoned-img-170.png" width="170" height="170" align="right" hspace="10"></img>You may have read recently about a newly-discovered attack that <a href="http://www.theregister.co.uk/2014/02/05/iframe_attack_injects_code_via_pngs/" rel="nofollow">involves injecting code</a> into your browser using poisoned image files.</p>
<p>Code-carrying image files are usually a serious security concern, especially if they involve deliberately malformed content that was criminally crafted to trip up your browser, or PDF reader, RTF viewer, video player, and so forth.</p>
<p>A well-known example from late in 2013 was a <a href="http://nakedsecurity.sophos.com/2013/11/06/microsoft-warns-windows-users-of-zero-day-danger-from-booby-trapped-image-files/">TIFF handling vulnerability</a> in Microsoft Windows.</p>
<p>This TIFF exploit was used by criminals, who lured you to open an innocent-looking document file containing a booby-trapped TIFF image; crashed Microsoft Office; grabbed control of your CPU; and tricked your computer into running executable code without any official popups or warnings.</p>
<p>An attack of that sort is known as a <a href="http://nakedsecurity.sophos.com/2013/09/18/sophos-techknow-understanding-vulnerabilties-podcast/">remote code execution exploit</a>, or RCE.</p>
<p>RCEs usually rely not only on remotely delivered content that is deliberately and criminally unusual, but also on software behaviour that <a href="http://nakedsecurity.sophos.com/2013/10/11/anatomy-of-an-exploit-ie-zero-day-part-1/">isn&#8217;t supposed to happen</a>.</p>
<p>Fortunately, this latest poisoned code injection isn&#8217;t anywhere near as dangerous as the TIFF hole: it doesn&#8217;t <a href="http://nakedsecurity.sophos.com/2013/09/18/sophos-techknow-understanding-vulnerabilties-podcast/">exploit a vulnerability</a> that allows it to take over without warning.</p>
<p>But it does tell an interesting, even amusing, story of subterfuge and guile, so here you are.</p>
<h4>The start of the attack</h4>
<p>The first stage of the attack is some unwanted JavaScript, tacked on the end of a 9000-line JavaScript file downloaded as<tt> jquery.js</tt>.</p>
<p>In any server logs, the presence of<tt> jquery.js </tt>is unlikely to ring any immediate alarms: it is a <a href="http://jquery.com/" rel="nofollow">widely-used Javascript programming library</a> that is free and open source.</p>
<p>Indeed, for the first 8981 lines, the file <strong>is</strong> <tt> jquery.js</tt> &#8211; the official, unmodified, uncompressed file from version 1.6.2. </p>
<p>(As you can see from the datestamp, the crooks are often many versions and several years behind, too.)</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/02/jquery-orig-500.png" width="500" height="376" style="margin:0;padding:0;"></img></p>
<p>The malicious addition comes right at the end.</p>
<p>You&#8217;ll notice a pair of functions that stand out rather obviously, at least to a security researcher:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/02/jquery-crooked-500.png" width="500" height="554" style="margin:0;padding:0;"></img></p>
<p>Even at a glance, you can make an educated guess that the<tt> loadFile() </tt> function is there to fetch an image and then to pass some part of it to JavaScript&#8217;s<tt> eval() </tt> function.</p>
<p>Fetching images is unexceptionable behaviour for a JavaScript function, but using an image as input to <tt> eval() </tt> is both unusual and suspicious.</p>
<p style='background-color:#e8e8e8;font-size:80%;padding:.71em;padding-left:2em;text-indent:-1.29em;'>&rarr; The<tt> eval() </tt> function contributes both to the flexibility and the danger of JavaScript: it takes a text string, compiles it, and runs it as if that string had been an original part of the JavaScript code that was just downloaded. Crooks love<tt> eval() </tt> because it means that the code they send to your browser isn&#8217;t the code they ultimately intend to run: this helps them hide away their malware in the hope that it will only ever exist in its final, malevolent form inside your browser. </p>
<p>JavaScript-based malware often uses various text encodings (e.g. hexadecimal) and scrambling techniques (e.g. ROT13) to disguise the code it will eventually pass to<tt> eval()</tt>.</p>
<p>String obfuscation is especially handy for disguising the presence of suspicious URLs in the malicious code.</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/02/uri-scrambling-500.png" width="500" height="100" style="margin:0;padding:0;"></img></p>
<p>In the &#8220;poisoned image&#8221; approach we&#8217;re studying here, however, the string isn&#8217;t encoded as another string &#8211; it&#8217;s encoded into a series of coloured pixels!</p>
<p>Here&#8217;s how the crooks did it.</p>
<h4>The initial image</h4>
<p>The image that is fetched by the<tt> loadFile() </tt> function above is 17&#215;17 pixels.</p>
<p>Magnified 20 times, it looks like this:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/02/raw-img-500.png" width="500" height="346" style="margin:0;padding:0;"></img></p>
<p>Looking at the image doesn&#8217;t give much away.</p>
<p>If we open the image file in a hex editor, there&#8217;s still nothing obvious to see:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/02/png-idat-500.png" width="500" height="389" style="margin:0;padding:0;"></img></p>
<p>PNG files are stored as a series of data sections, the most important of which is<tt> IDAT</tt>, the actual image data.</p>
<p>The raw data (highlighted in blue above) in the<tt> IDAT </tt>section is compressed, disguising still further any patterns that might otherwise be obvious.</p>
<p>But if we convert the image to a raw RGB file, in which each pixel is represented by three bytes denoting the amount of red, green and blue it contains, things start to get interesting:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/02/rgb-ascii-500.png" width="500" height="96" style="margin:0;padding:0;"></img></p>
<p>Each pixel has the same value for red, green and blue, as we&#8217;d expect for a greyscale image.</p>
<p>And the majority of those greyscale values map into the range in the ASCII chart reserved for digits and letters:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/02/ascii-chart-500.png" width="500" height="306" style="margin:0;padding:0;"></img></p>
<p>We can also see the stand-out values 0x20 (space, annotated in pink) and 0x0D-followed-by-0x0A (the carriage return-line feed combination used on Windows to denote the end of a line of text, annotated in green).</p>
<h4>The hidden source code</h4>
<p>With a little bit of colourisation and a slight tweak to the contrast to aid in clarity, the image now clearly reveals itself as a colour-coded matrix of JavaScript source code:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/02/code-img-500.png" width="500" height="346" style="margin:0;padding:0;"></img></p>
<p>The darker regions in the image correspond to the lower values in the ASCII chart, namely the digits and punctuation marks.</p>
<p>Notice that the JavaScript code that unpacks the PNG file and extracts the colour-coded source code doesn&#8217;t need to know how to parse the PNG file format to find the<tt> IDAT </tt> section, and doesn&#8217;t need to know how to decompress the image data.</p>
<p>It relies on the browser to render the image into an HTML5 canvas, which transparently (if you will pardon the pun) deals with decoding and decompressing the raw image file.</p>
<p>The source code is then sucked back in, pixel by pixel, from the rendered version of the image.</p>
<p>Indeed, the malware could switch to a different file format, such as JPEG or GIF, without any additional code required in the bogus<tt> jquery.js </tt>file.</p>
<h4>The invisible components</h4>
<p>As you can see from the code listing above, even a keen-eyed user won&#8217;t spot the 17&#215;17 pixel greyscale-image-that-isn&#8217;t, because it is rendered 10,000 pixels off to the left of the window:</p>
<pre style='font-size:85%;'>
oImg.style.left = "-10000px";
</pre>
<p>The code that&#8217;s extracted from the invisible image and submitted to <tt> eval() </tt> creates a similarly out-of-shot IFRAME:</p>
<pre style='font-size:85%;'>
elm.style.left = '-1000px';
elm.style.top = '-1000px';
</pre>
<p>The invisible IFRAME is then populated with an HTML page that consists only of a SCRIPT tag that pulls in yet more JavaScript.</p>
<p>This script, in turn, produces yet another IFRAME, once again positioned invisibly:</p>
<pre style='font-size:85%;'>
document.write("&lt;iframe style=&#039;position:absolute; 
                top: -200px;&#039; src=...&quot;);
</pre>
<p>At this point, at least in our experiments, things ended in an amusingly ironic anticlimax.</p>
<p>The final webpage we reached, after all this jiggery-pokery, was this:</p>
<pre style='font-size:85%;'>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;
</pre>
<p>That&#8217;s an empty page, so even if it were visible, our colourful journey would end in nothing:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/02/empty-5001.png" width="500" height="306" style="margin:0;padding:0;"></img></p>
<h4>A final warning</h4>
<p>Of course, the cybercriminals could quickly and easily vary the web trajectory followed by the image-rendering trick in the bogus<tt> jquery.js </tt> file.</p>
<p>They could change the image itself or the location and contents of any of the IFRAMEs that are subsequently fetched, so we can&#8217;t promise that things will end with the same sort of wry smile in your case&#8230;</p>
<p style='padding-bottom:.8em;padding-top:.8em;'></p>
<div style='background-color:#e8e8e8;padding:.8em 2em .8em .8em;margin-bottom:1em;'>
<p><strong>Note.</strong> Sophos products detect and block the files in the attack described above as <strong>Troj/JSRedir-NG</strong>.
</div>
<p style="font-size:85%;"><em>Images of <a href="http://www.shutterstock.com/pic.mhtml?id=157587731" rel="nofollow">image icon</a> and <a href="http://www.shutterstock.com/pic.mhtml?id=152131793" rel="nofollow">gas mask</a> courtesy of <a href="http://www.shutterstock.com/" rel="nofollow">Shutterstock</a>.</em></p>
			</div> <!-- .entry-content -->
	<ul class="block social follow">
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon twitter"><use xlink:href="#twitter"></use></svg>
			<p>Follow <strong><a href="https://twitter.com/nakedsecurity">@NakedSecurity on Twitter</a></strong> for the latest computer security news.</p>
		</li>
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon instagram"><use xlink:href="#instagram"></use></svg>
			<p>Follow <strong><a href="https://www.instagram.com/nakedsecurity/">@NakedSecurity on Instagram</a></strong> for exclusive pics, gifs, vids and LOLs!</p>
		</li>
	</ul>
</article><!-- #post-## -->

		<div class="free-tools-block">
			<h2 class="block-title">Free tools</h2>

<div class="ns-free-tools">
	<div class="ns-free-tools__item ns-free-tools__item--sophos-home">
		<a class="ns-free-tools__link" href="https://home.sophos.com/en-us.aspx?cmp=701j0000001eLpnAAE">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/sophos-home@2x.png" alt="Sophos Home" class="ns-free-tools__image" width="166" height="100">
			<h4 class="ns-free-tools__title">
				Sophos Home			</h4>
			<div class="ns-free-tools__sub-title">
				Protect personal PCs and Macs			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--hitman-pro">
		<a class="ns-free-tools__link" href="https://www.hitmanpro.com/en-us/hmp.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/hitman-pro@2x.png" alt="Hitman Pro" class="ns-free-tools__image" width="154" height="100">
			<h4 class="ns-free-tools__title">
				Hitman Pro			</h4>
			<div class="ns-free-tools__sub-title">
				Find and remove malware			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--intercept-x">
		<a class="ns-free-tools__link" href="https://www.sophos.com/en-us/products/free-tools/sophos-mobile-security-free-edition.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/mobile-security-android@2x.png" alt="Sophos Intercept X for Mobile" class="ns-free-tools__image" width="96" height="110">
			<h4 class="ns-free-tools__title">
				Intercept X for Mobile			</h4>
			<div class="ns-free-tools__sub-title">
				Protect Android devices			</div>
		</a>
	</div>
</div>
		</div>

			<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2014/02/07/will-passports-of-the-future-incorporate-our-body-smell/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> Will passports of the future incorporate our body smell?</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2014/02/08/the-spampionship-the-pwn2own-unicorn-and-how-target-was-breached-60-sec-security-video/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> The Spampionship, the PWN2OWN unicorn, and how Target was breached &#8211; 60 Sec Security [VIDEO]</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	
	</main><!-- #main -->

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<section class="comments-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

			
<div id="comments" class="comments-area">

			<h2 class="comments-title">
			6 comments on &ldquo;<span>Anatomy of a poisoned image: colour-coded JavaScript!</span>&rdquo;		</h2>

		<ol class="comment-list">
					<li id="comment-1807522" class="comment even thread-even depth-1">
			<article id="div-comment-1807522" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/ab713ec474fd4b6bdd50b6b947528e41?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ab713ec474fd4b6bdd50b6b947528e41?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Pete Beck (@petebeck1)</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/07/anatomy-of-a-poisoned-image-colour-coded-javascript/#comment-1807522"><time datetime="2014-02-08T08:06:21+00:00">February 8, 2014 at 8:06 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>This technique&#8217;s been around for several years in the demo scene community. Surprised it&#8217;s taken this long to catch on with malware authors to be honest!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1807522"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1807522={"id":7238218,"unique_id":"wp-comment-1807522","title":"This%20technique%26%23039%3Bs%20been%20around%20for%20several%20years%20in%20the%20demo%20scene%20community.%20Surprised%20it%26%23039%3Bs%20taken%20this%20long%20to%20catch%20on%20with%20malware%20authors%20to%20be%20honest%21%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/07\/anatomy-of-a-poisoned-image-colour-coded-javascript\/#comment-1807522","item_id":"_comm_1807522"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/07/anatomy-of-a-poisoned-image-colour-coded-javascript/?replytocom=1807522#respond' data-commentid="1807522" data-postid="245219" data-belowelement="div-comment-1807522" data-respondelement="respond" data-replyto="Reply to Pete Beck (@petebeck1)" aria-label='Reply to Pete Beck (@petebeck1)'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-1819294" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-1819294" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/d91ff21c3f59527d7454c17a6fb99f0b?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d91ff21c3f59527d7454c17a6fb99f0b?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paco Hope</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/07/anatomy-of-a-poisoned-image-colour-coded-javascript/#comment-1819294"><time datetime="2014-02-09T12:59:43+00:00">February 9, 2014 at 12:59 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>The security researcher didn&#8217;t get the payload even when they knew what server to request it from. If there is an ironic anti-climax it is that they couldn&#8217;t explain why that would be the case. They assume that the response they, as security researchers, receive is the same as the response a target victim would receive. I think that is naÃ¯ve.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1819294"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1819294={"id":7238218,"unique_id":"wp-comment-1819294","title":"The%20security%20researcher%20didn%26%23039%3Bt%20get%20the%20payload%20even%20when%20they%20knew%20what%20server%20to%20request%20it%20from.%20If%20there%20is%20an%20ironic%20anti-climax%20it%20is%20that%20they%20couldn%26%23039%3Bt%20explain%20why%20that%20would%20be%20the%20case.%20T%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/07\/anatomy-of-a-poisoned-image-colour-coded-javascript\/#comment-1819294","item_id":"_comm_1819294"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/07/anatomy-of-a-poisoned-image-colour-coded-javascript/?replytocom=1819294#respond' data-commentid="1819294" data-postid="245219" data-belowelement="div-comment-1819294" data-respondelement="respond" data-replyto="Reply to Paco Hope" aria-label='Reply to Paco Hope'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1820612" class="comment byuser comment-author-pducklin bypostauthor even depth-2 parent">
			<article id="div-comment-1820612" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/07/anatomy-of-a-poisoned-image-colour-coded-javascript/#comment-1820612"><time datetime="2014-02-09T16:30:47+00:00">February 9, 2014 at 4:30 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Er, the security researcher, who was I, *did* get the payload. It was a blank page &#8211; but that page *was* served up. </p>
<p>There was no special security researcher magic by which I &#8220;knew what server to request it from.&#8221; I just let my browsing software follow the chain of links provided, starting with the link to the PNG file in the doctored JavaScript. Any user running that JavaScript would have the same &#8220;knowledge.&#8221;</p>
<p>There are many explanations why the payload might have ended up unmalevolent, and they are interesting reasons, but not directly relevant here, so I didn&#8217;t delve into them in the article.</p>
<p>(For example: the crooks could have given up or been between campaigns; the malware server might have been cleaned up by someone else; the server might have been set to ignore visits from my part of the world; I might have had the wrong sort of User-Agent string set; I might have cleared or never received a browser cookie from earlier on in the sequence.)</p>
<p>And the security researcher did *not* assume, naively or otherwise, that the result he received &#8220;is the same as the response a target victim would receive.&#8221; </p>
<p>In fact, he very carefully ended the article with a short section subheaded &#8220;A final warning&#8221; to advise that the response you receive might, indeed, be completely different to what he observed&#8230; ðŸ™‚</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1820612"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1820612={"id":7238218,"unique_id":"wp-comment-1820612","title":"Er%2C%20the%20security%20researcher%2C%20who%20was%20I%2C%20%2Adid%2A%20get%20the%20payload.%20It%20was%20a%20blank%20page%20-%20but%20that%20page%20%2Awas%2A%20served%20up.%20There%20was%20no%20special%20security%20researcher%20magic%20by%20which%20I%20%26quot%3Bknew%20what%20server%20to%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/07\/anatomy-of-a-poisoned-image-colour-coded-javascript\/#comment-1820612","item_id":"_comm_1820612"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/07/anatomy-of-a-poisoned-image-colour-coded-javascript/?replytocom=1820612#respond' data-commentid="1820612" data-postid="245219" data-belowelement="div-comment-1820612" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1842490" class="comment odd alt depth-3">
			<article id="div-comment-1842490" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/86c08cd2303e03cfe5068f3e78e82802?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/86c08cd2303e03cfe5068f3e78e82802?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Mr Glass</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/07/anatomy-of-a-poisoned-image-colour-coded-javascript/#comment-1842490"><time datetime="2014-02-11T11:18:57+00:00">February 11, 2014 at 11:18 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I&#8217;ve encountered these &#8216;blank page payloads&#8217; before. They are often part of a cookie bomb attack. If you don&#8217;t have the corresponding cookie set you don&#8217;t get the payload. This makes it much extremely difficult to determine the type of payload that would have been delivered. </p>
<p>The cookie data provides info about what security hole to exploit in which browser on which platform. These tandem attacks, where the malicious code that tests the environment for exploitable weaknesses is not in the same page, or even on the same server, make it very difficult to trace all the participating websites involved.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1842490"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1842490={"id":7238218,"unique_id":"wp-comment-1842490","title":"I%26%23039%3Bve%20encountered%20these%20%26%23039%3Bblank%20page%20payloads%26%23039%3B%20before.%20They%20are%20often%20part%20of%20a%20cookie%20bomb%20attack.%20If%20you%20don%26%23039%3Bt%20have%20the%20corresponding%20cookie%20set%20you%20don%26%23039%3Bt%20get%20the%20payload.%20This%20makes%20it%20much%20extr%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/07\/anatomy-of-a-poisoned-image-colour-coded-javascript\/#comment-1842490","item_id":"_comm_1842490"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/07/anatomy-of-a-poisoned-image-colour-coded-javascript/?replytocom=1842490#respond' data-commentid="1842490" data-postid="245219" data-belowelement="div-comment-1842490" data-respondelement="respond" data-replyto="Reply to Mr Glass" aria-label='Reply to Mr Glass'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-1833354" class="comment even thread-even depth-1">
			<article id="div-comment-1833354" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/521ecfab78ba8920da2942e4e3c10db7?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/521ecfab78ba8920da2942e4e3c10db7?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Anonymous</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/07/anatomy-of-a-poisoned-image-colour-coded-javascript/#comment-1833354"><time datetime="2014-02-10T18:58:29+00:00">February 10, 2014 at 6:58 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>&#8230; And another good reason <b>not</b> to allow your browsers to accept iFrames ðŸ™‚ .</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1833354"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1833354={"id":7238218,"unique_id":"wp-comment-1833354","title":"...%20And%20another%20good%20reason%20%26lt%3Bb%26gt%3Bnot%26lt%3B%2Fb%26gt%3B%20to%20allow%20your%20browsers%20to%20accept%20iFrames%20%3A-%29%20.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/07\/anatomy-of-a-poisoned-image-colour-coded-javascript\/#comment-1833354","item_id":"_comm_1833354"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/07/anatomy-of-a-poisoned-image-colour-coded-javascript/?replytocom=1833354#respond' data-commentid="1833354" data-postid="245219" data-belowelement="div-comment-1833354" data-respondelement="respond" data-replyto="Reply to " aria-label='Reply to '>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-1853736" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-1853736" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/aae9e45052caab7d92b7a32b89a4ab22?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/aae9e45052caab7d92b7a32b89a4ab22?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">petersucuri</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/07/anatomy-of-a-poisoned-image-colour-coded-javascript/#comment-1853736"><time datetime="2014-02-12T09:47:56+00:00">February 12, 2014 at 9:47 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hey Paul, nice in-depth analysis! Maybe worth of mentioning our original Sucuri blogpost related to this iframe? Anyway, I indeed enjoyed the colours ðŸ™‚</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1853736"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1853736={"id":7238218,"unique_id":"wp-comment-1853736","title":"Hey%20Paul%2C%20nice%20in-depth%20analysis%21%20Maybe%20worth%20of%20mentioning%20our%20original%20Sucuri%20blogpost%20related%20to%20this%20iframe%3F%20Anyway%2C%20I%20indeed%20enjoyed%20the%20colours%20%3A%29%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/07\/anatomy-of-a-poisoned-image-colour-coded-javascript\/#comment-1853736","item_id":"_comm_1853736"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/07/anatomy-of-a-poisoned-image-colour-coded-javascript/?replytocom=1853736#respond' data-commentid="1853736" data-postid="245219" data-belowelement="div-comment-1853736" data-respondelement="respond" data-replyto="Reply to petersucuri" aria-label='Reply to petersucuri'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">What do you think? <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2014/02/07/anatomy-of-a-poisoned-image-colour-coded-javascript/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://nakedsecurity.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='245219' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="361f7e7f1b" /></p><input type="hidden" id="ak_js" name="ak_js" value="129"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->
		<div class="comments-widget-area">
					</div>
	
	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	

	<section class="recommended-panel">
	<div class="container">
	<div class="panel-content ">

		<h3 class="block-title">Recommended reads</h3>
	<div class="blocks">
		<article id="post-545323" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/02/15/naked-security-when-is-a-bug-bounty-not-a-bug-bounty/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/10/nslive-1200-3.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Feb</span><span class="day">15</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">0</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/02/15/naked-security-when-is-a-bug-bounty-not-a-bug-bounty/" rel="bookmark">Naked Security Live &#8211; When is a bug bounty not a bug bounty?</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-542584" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2020/12/24/s3-ep12-a-chat-with-social-engineering-hacker-rachel-tobac-podcast/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/10/nean-with-mic-wt-purply-1200.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Dec</span><span class="day">24</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">3</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2020/12/24/s3-ep12-a-chat-with-social-engineering-hacker-rachel-tobac-podcast/" rel="bookmark">S3 Ep12: A chat with social engineering hacker Rachel Tobac [Podcast]</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-544685" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/01/26/ghost-hack-criminals-use-deceased-employees-account-to-wreak-havoc/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/01/gs-1200.jpg?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Jan</span><span class="day">26</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">4</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/01/26/ghost-hack-criminals-use-deceased-employees-account-to-wreak-havoc/" rel="bookmark">Ghost hack &#8211; criminals use deceased employee&#8217;s account to wreak havoc</a></h3>	</div>
</article> <!-- .card-article -->
	</div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="footer-container">
			<a href="#" class="js-collapse-footer"><svg style="height: 20px" viewBox="0 0 132 24" class="block icon sophos"><use xlink:href="#sophos"></use></svg></a>
			<div id="collapseFooter" class="blocks">
				<div class="sophos block">
					<ul id="menu-footer-primary" class="primary menu"><li id="menu-item-306737" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306737"><a href="https://nakedsecurity.sophos.com/about/">About Naked Security</a></li>
<li id="menu-item-306754" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306754"><a href="https://www.sophos.com/en-us/company.aspx">About Sophos</a></li>
<li id="menu-item-306747" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306747"><a href="https://nakedsecurity.sophos.com/send-us-a-tip/">Send us a tip</a></li>
<li id="menu-item-323171" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323171"><a href="/cookies-and-scripts/">Cookies</a></li>
<li id="menu-item-323170" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323170"><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
<li id="menu-item-323169" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323169"><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
</ul>				</div>
										<div class="news block">
							<ul id="menu-products-column-one" class="small menu"><li id="menu-item-306998" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306998"><a href="https://www.sophos.com/en-us/products/intercept-x.aspx">Intercept X</a></li>
<li id="menu-item-440801" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440801"><a href="https://www.sophos.com/en-us/products/server-security.aspx">Intercept X for Server</a></li>
<li id="menu-item-440802" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440802"><a href="https://www.sophos.com/en-us/products/mobile-control.aspx">Intercept X for Mobile</a></li>
</ul>						</div>
											<div class="products block">
							<ul id="menu-products-column-two" class="small menu"><li id="menu-item-440803" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440803"><a href="https://www.sophos.com/en-us/products/next-gen-firewall.aspx">XG Firewall</a></li>
<li id="menu-item-440805" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440805"><a href="https://www.sophos.com/en-us/products/sophos-email.aspx">Sophos Email</a></li>
<li id="menu-item-440804" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440804"><a href="https://www.sophos.com/en-us/products/secure-wifi.aspx">Sophos Wireless</a></li>
</ul>						</div>
											<div class="threats block">
							<ul id="menu-server-protection" class="small menu"><li id="menu-item-440806" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440806"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx">Managed Threat Response</a></li>
<li id="menu-item-448404" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-448404"><a href="https://www.sophos.com/en-us/products/cloud-optix.aspx">Cloud Optix</a></li>
<li id="menu-item-440807" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440807"><a href="https://www.sophos.com/en-us/products/phish-threat.aspx">Phish Threat</a></li>
</ul>						</div>
								</div>
			<ul class="block social footer">
				<li class="twitter"><a rel="nofollow" href="https://twitter.com/NakedSecurity" title="Follow our team of security experts on Twitter"><svg style="height: 14px" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
				<li class="facebook"><a rel="nofollow" href="https://www.facebook.com/SophosSecurity" title="Join over 250,000 people in our Facebook community"><svg style="height: 14px" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
				<li class="instagram"><a rel="nofollow" href="https://www.instagram.com/nakedsecurity/" title="Follow Naked Security on Instagram"><svg style="height: 14px" viewBox="0 0 100 100" class="icon instagram"><use xlink:href="#instagram"></use></svg></a></li>
				<li class="linkedin"><a rel="nofollow" href="https://www.linkedin.com/company/5053/" title="Join the naked security discussion group on LinkedIn"><svg style="height: 14px" viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
				<li class="rss"><a rel="nofollow" href="/feed" title="Subscribe to our RSS feed"><svg style="height: 14px" viewBox="0 0 100 100" class="icon rss"><use xlink:href="#rss"></use></svg></a></li>
			</ul>

							<div class="vip-powered-wpcom">
					<span class="copyright">Â© 1997 - 2021 Sophos Ltd.</span>
					All rights reserved.
					Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=nakedsecurity.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>				</div>
					</div>
		<script type="text/javascript">
			window.cookieconsent_options = {
				"message":"This site uses cookies. By continuing to browse the site you are agreeing to our use of cookies.",
				"dismiss":"Got it!",
				"learnMore":"Learn More",
				"link":"/cookies-and-scripts",
				"theme":"https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/css/sophos.css"};
		</script>
	</footer><!-- #colophon -->
</div><!-- #page -->
<div id="survey-wrapper" class="mfp-hide"><div class="pd-embed" id="pd_1499706777" data-settings=""></div></div>
<script id='child-js-plugins-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"0","nextLink":""};
</script>
<script id='child-js-core-js-extra'>
var Sophos = {"ajaxurl":"https:\/\/nakedsecurity.sophos.com\/wp-admin\/admin-ajax.php","nonce":"64f6810f0c"};
</script>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJyNjkEKwjAQRS9kOonYggvxKGLT0SZmJiGTULx9Q7HgwoXL+f89/sCSlI1ckAuUGQkFJKY5CuMi6qhND14ghfp0LJ2XA/wl2Jhxpx3bUKfGbTlRM1XGFN4dOf4FtRNpxOm73yepqs8zcH85ISxway48YqbGXuliBtOfBq3P2q8Rb09t'></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161173',post:'245219',tz:'0',srv:'nakedsecurity.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161173', '245219' ]);
</script>
</body>
</html>
