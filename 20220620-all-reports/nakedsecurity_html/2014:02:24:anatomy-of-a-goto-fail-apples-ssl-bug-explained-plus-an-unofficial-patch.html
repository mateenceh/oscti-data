<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="RHQeasQqjasbRt5asY6atZYbs5tr10gFBevDt2HRhW0" />
<link rel="pingback" href="https://nakedsecurity.sophos.com/xmlrpc.php">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5VK6LTK');</script>
<!-- End Google Tag Manager -->

<meta name="description" content="Apple just patched an SSL/TLS bug in iOS - but the flaw is not yet fixed in OS X. Paul Ducklin comes to the rescue with explanations, mitigations, and even an unofficial patch! (For educational purposes only, you understand.)" />
<meta name="keywords" content="apple, apple safari, ios, os x, vulnerability, apple, bypass, cve-2014-1266, hack, handshake, ios, man in the middle, mitm, os x, patch, ssl, tls" />
<title>Anatomy of a &#8220;goto fail&#8221; &#8211; Apple&#8217;s SSL bug explained, plus an unofficial patch for OS X! &#8211; Naked Security</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="I9dHFo-YhnK2MfAHn-20V4GnWrOttVUYyISGamyU41M" />
<meta name="msvalidate.01" content="7D8D1FA2892142B1543D2CBCD07FB88F" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Feed" href="https://nakedsecurity.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Comments Feed" href="https://nakedsecurity.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Anatomy of a &#8220;goto fail&#8221; &#8211; Apple&#8217;s SSL bug explained, plus an unofficial patch for OS X! Comments Feed" href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/feed/" />
<link rel='stylesheet' id='all-css-0' href='https://nakedsecurity.sophos.com/_static/??-eJyVz00OwiAQhuELCSM1mLgwnoXCRFD+wgxpevvS2J0bXU7yPsk3sFQRso3dIYElAheIYY7FvkUMczNtBeI1okwhyxGcYAhbMmNmYI9pOCrVF8q4kJjOSh/gn1hEw0j8q9mHGifZNzQsfB9xkybVL5+6qLE/QyZ4IVczvrrJjz/unTzSXV2VvkxKa70BdwtjDg==' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqWkWAK9EIho='></script>
<link rel="https://api.w.org/" href="https://nakedsecurity.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://nakedsecurity.sophos.com/wp-json/wp/v2/posts/247778" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://nakedsecurity.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://nakedsecurity.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/" />
<link rel='shortlink' href='https://nakedsecurity.sophos.com/?p=247778' />
<link rel="alternate" type="application/json+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2014%2F02%2F24%2Fanatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2014%2F02%2F24%2Fanatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Anatomy of a &#8220;goto fail&#8221; &#8211; Apple&#8217;s SSL bug explained, plus an unofficial patch for OS X!" />
<meta property="og:url" content="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/" />
<meta property="og:description" content="Apple just patched an SSL/TLS bug in iOS &#8211; but the flaw is not yet fixed in OS X. Paul Ducklin comes to the rescue with explanations, mitigations, and even an unofficial patch! (For education…" />
<meta property="article:published_time" content="2014-02-24T13:52:06+00:00" />
<meta property="article:modified_time" content="2018-05-27T09:16:36+00:00" />
<meta property="og:site_name" content="Naked Security" />
<meta property="og:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/gotofail-250.png?w=250" />
<meta property="og:image:secure_url" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/gotofail-250.png?w=250" />
<meta property="og:image:width" content="250" />
<meta property="og:image:height" content="250" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@NakedSecurity" />
<meta name="twitter:text:title" content="Anatomy of a &#8220;goto fail&#8221; &#8211; Apple&#8217;s SSL bug explained, plus an unofficial patch for OS X!" />
<meta name="twitter:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/gotofail-250.png?w=144" />
<meta name="twitter:card" content="summary" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=270" />
</head>
<body class="post-template-default single single-post postid-247778 single-format-standard" >
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VK6LTK"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div style="display: none">
<svg>
	<symbol id="sophos" viewBox="0 0 132 24">
		<path d="m111.82 22.176h11.64c3.267 0 4.65-0.2 5.74-0.896 1.715-1.063 2.804-3.26 2.804-5.62 0-1.928-0.658-3.89-1.647-4.888-1.288-1.33-3.035-1.828-6.271-1.828h-3.527c-1.586 0-2.754-0.067-3.412-0.365-0.794-0.367-1.256-1.165-1.256-2.161 0-1.165 0.56-2.03 1.486-2.264 0.692-0.163 1.498-0.163 3.574-0.198h10.419v-3.956h-11.473c-2.574 0-3.727 0.099-4.718 0.466-2.279 0.796-3.828 3.257-3.828 6.083 0 1.93 0.76 3.727 2.079 4.89 1.155 0.996 2.872 1.462 5.51 1.462h4.697c1.057 0 1.915 0.132 2.376 0.398 0.893 0.433 1.418 1.328 1.418 2.36 0 0.864-0.395 1.597-1.087 2.027-0.561 0.369-1.517 0.534-3.268 0.534h-11.256zm-111.35 0h11.64c3.267 0 4.652-0.2 5.741-0.896 1.714-1.063 2.803-3.26 2.803-5.62 0-1.928-0.66-3.89-1.65-4.888-1.285-1.33-3.034-1.828-6.27-1.828h-3.527c-1.584 0-2.751-0.067-3.41-0.365-0.792-0.367-1.253-1.165-1.253-2.161 0-1.165 0.56-2.03 1.484-2.264 0.693-0.163 1.496-0.163 3.574-0.198h10.42v-3.956h-11.477c-2.573 0-3.727 0.099-4.715 0.466-2.278 0.796-3.83 3.257-3.83 6.083 0 1.93 0.762 3.727 2.08 4.89 1.155 0.996 2.871 1.462 5.51 1.462h4.696c1.057 0 1.913 0.132 2.377 0.398 0.888 0.433 1.416 1.328 1.416 2.36 0 0.864-0.394 1.597-1.089 2.027-0.558 0.369-1.517 0.534-3.264 0.534h-11.256v3.956zm94.05-16.18c-0.68 1.076-1.003 2.803-1.003 5.122 0 5.088 1.747 7.405 5.63 7.405 3.822 0 5.568-2.317 5.568-7.34 0-5.092-1.715-7.373-5.568-7.373-2.102 0-3.754 0.784-4.627 2.186zm13.174-2.511c1.329 1.761 2.072 4.63 2.072 7.992 0 3.816-1.197 6.948-3.334 8.677-1.619 1.304-4.078 2.022-6.995 2.022-4.142 0-7.41-1.372-9.092-3.817-1.263-1.793-1.88-4.176-1.88-7.08 0-4.172 1.133-7.339 3.27-9.035 1.682-1.37 4.339-2.122 7.383-2.122 3.85 0 6.925 1.209 8.576 3.363zm-22.018-3.068h-4.596v8.908h-8.319v-8.908h-4.597v21.759h4.597v-8.97h8.318v8.97h4.596v-21.759zm-28.61 10.277c1.23 0 1.941-0.163 2.427-0.62 0.581-0.49 0.938-1.533 0.938-2.74 0-1.436-0.58-2.478-1.584-2.838-0.356-0.13-0.94-0.197-1.684-0.197h-6.344v6.395zm-6.247 11.481h-4.598v-21.758h10.78c3.786 0 5.114 0.39 6.538 1.991 1.264 1.37 1.942 3.163 1.942 5.088 0 2.284-0.904 4.404-2.394 5.676-1.262 1.077-2.43 1.402-4.888 1.402h-7.38zm-22.589-16.179c-0.682 1.076-1.004 2.803-1.004 5.122 0 5.088 1.748 7.405 5.634 7.405 3.818 0 5.568-2.317 5.568-7.34 0-5.092-1.716-7.373-5.568-7.373-2.106 0-3.757 0.784-4.63 2.186zm13.174-2.511c1.328 1.761 2.073 4.63 2.073 7.992 0 3.816-1.2 6.948-3.335 8.677-1.618 1.304-4.079 2.022-6.993 2.022-4.144 0-7.413-1.372-9.096-3.817-1.264-1.793-1.878-4.176-1.878-7.08 0-4.172 1.133-7.339 3.272-9.035 1.681-1.37 4.337-2.122 7.38-2.122 3.851 0 6.93 1.209 8.578 3.363z"></path>
	</symbol>
	<symbol id="twitter" viewBox="0 0 24 24">
 		<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path>
 	</symbol>
	<symbol id="facebook" viewBox="0 0 24 24">
 		<path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path>
 	</symbol>
	<symbol id="instagram" viewBox="0 0 24 24">
		<path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path>
	</symbol>
	<symbol id="linkedin" viewBox="0 0 24 24">
		<path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"></path>
	</symbol>
	<symbol id="rss" viewBox="0 0 24 24">
		<path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"></path>
	</symbol>
	<symbol id="reddit" viewBox="0 0 24 24">
		<path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"></path>
	</symbol>
</svg>
</div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header variation variation-3" role="banner">
		<div class="header-container">
			<div class="site-branding">
				<div class="site-title">
					<a title="Naked Security" href="https://nakedsecurity.sophos.com/" rel="home"><img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/naked-security-logo-white@2x.png"></a>
					by
					<a title="sophos.com" href="https://www.sophos.com"><svg viewBox="0 0 132 24" class="icon sophos"><use xlink:href="#sophos"></use></svg></a>
				</div>
			</div><!-- .site-branding -->
			<nav id="site-navigation" class="main-navigation" role="navigation">
				<div class="container">
					<ul id="menu-variation-two" class="exit-links menu"><li id="menu-item-436509" class="products menu-item menu-item-type-custom menu-item-object-custom menu-item-436509"><a href="#">Products</a></li>
<li id="menu-item-436515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436515"><a href="https://www.sophos.com/en-us/products/free-tools.aspx">Free Tools</a></li>
<li id="menu-item-436531" class="search-toggle menu-item menu-item-type-custom menu-item-object-custom menu-item-436531"><a href="#">Search</a></li>
<li id="menu-item-436532" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436532"><a href="https://home.sophos.com/en-us.aspx">Free Sophos Home</a></li>
</ul>				</div>
			</nav><!-- #site-navigation -->
			<div class="site-search-block">
	<form target="_top" role="search" class="search-form" method="get" action="https://nakedsecurity.sophos.com/">
        <fieldset>
            <div class="field">
				<input type="search" value="" name="s" class="search-field" placeholder="Search naked security...">
            </div>
            <div class="submit">
				<button type="submit" class="search-submit button">Go</button>
            </div>
        </fieldset>
    </form>
</div>
		</div><!-- .container -->
	</header>

	<div class="responsive-flyout-panel small-12 column active" style="opacity: 1; display: none;">
		<div class="modal-filler"></div>
	    <div class="productNavBox">
	        <div class="productNavContainer">
	            <div class="row prodRow">
	                <div class="prodListBox column large-9">
	                    <div class="row margin-0 highlightProduct">
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/next-gen-firewall.aspx"><img src="https://www.sophos.com/medialibrary/2F4785DE8C3F43ECBD699A18F332FEEB.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">XG Firewall</div>
	                                	<div class="menu-section-subtitle">Next-Gen Firewall</div>
									</div>
	                            </a>
	                        </div>
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/intercept-x.aspx"><img src="https://www.sophos.com/medialibrary/27111765D65A45D49A232925D2CE428B.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">Intercept X</div>
	                                	<div class="menu-section-subtitle">Next-Gen Endpoint</div>
									</div>
	                            </a>
	                        </div>
	                    </div>
	                    <div class="productList">
	                        <ul>
								<li>
									<a href="https://www.sophos.com/en-us/products/cloud-optix.aspx"><img src="https://www.sophos.com/medialibrary/SophosNext/Images/Products/Icons/sophos-cloud-optix-icon.svg">Sophos Cloud Optix</a>
								</li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-central.aspx"><img src="https://www.sophos.com/medialibrary/08EA66123F1B4DDE8FE5C9B578A7FAA7.ashx">Sophos Central</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/mobile-control.aspx"><img src="https://www.sophos.com/medialibrary/678FE994855047739F50D6C411184FA6.ashx">Sophos Mobile</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/server-security.aspx"><img src="https://www.sophos.com/medialibrary/01B80E7D7CD54EF8AC2E51C9C6EC0236.ashx">Intercept X for Server</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-wifi.aspx"><img src="https://www.sophos.com/medialibrary/BEBD9C41BB4E480498514B29B92A145A.ashx">Secure Wi-Fi</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/phish-threat.aspx"><img src="https://www.sophos.com/medialibrary/DC9D1A7BA3964B0C9DAF1F1E68806B5A.ashx">Phish Threat</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/safeguard-encryption.aspx"><img src="https://www.sophos.com/medialibrary/8F51F06B62814B108D3B2763FF018E37.ashx">SafeGuard Encryption</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-email.aspx"><img src="https://www.sophos.com/medialibrary/597ADA0AF01A4A12B2B27239D0F9992C.ashx">Secure Email</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/unified-threat-management.aspx"><img src="https://www.sophos.com/medialibrary/8CB72BF5E1AD41F7894CE5E42101B0F3.ashx">SG UTM</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-web-gateway.aspx"><img src="https://www.sophos.com/medialibrary/C586E372694547A1B207A61D87246BA7.ashx">Secure Web Gateway</a>
	                            </li>
	                        </ul>
	                    </div>
	                </div>
	                <div class="homeUserBox column large-3">
						<img src="https://www.sophos.com/medialibrary/3376DF5742A64AEE93FDB9DCA7291239.ashx">
						<div class="menu-section-title">For Home Users</div>
	                    <p>Sophos Home protects every Mac and PC in your home </p><a href="https://home.sophos.com/" target="_blank" class="greenSmallMenuBtn">Learn More</a>
					</div>
	            </div>
	            <div class="row blueRow">
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-tools.aspx"><img width="19" src="https://www.sophos.com/medialibrary/A1FF440D2BB84511B8C94D771D44E207.ashx">Free Security Tools</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-trials.aspx"><img width="20" src="https://www.sophos.com/medialibrary/FCD3410ED2C347808D9DB8AC12C62DBD.ashx">Free Trials</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/demos.aspx"><img width="18" src="https://www.sophos.com/medialibrary/50985180E5F54C94917A2A6508E24287.ashx">Product Demos</a>
	                </div>
	                <!-- <div class="column large-3 medium-6">
	                    <a href="javascript:fairfax.openLiveChatFromFlyoutLink();" class="flyout-live-chat-link"><img width="20" src="https://www.sophos.com/medialibrary/E24C5050837145F6A5C592E299BA2A0D.ashx">Live Sales Chat</a>
	                </div> -->
	            </div>
	        </div>
	    </div>
	</div>
	<script>

	jQuery(document).ready( function () {
		var productButton   = jQuery('nav .menu-item.products');
		var modalBackground = jQuery('.modal-filler');
		var flyoutMenu		= jQuery('.responsive-flyout-panel');
		var Sophos			= Sophos || {};

		Sophos.MenuTest = {};

		Sophos.MenuTest.open = function () {
				productButton.addClass('open');
				flyoutMenu.show();
				modalBackground.show();
		};

		Sophos.MenuTest.close = function () {
			productButton.removeClass('open');
			flyoutMenu.hide();
			modalBackground.hide();
		};

		Sophos.MenuTest.toggle = function () {
			if ( productButton.hasClass('open') ) {
				Sophos.MenuTest.close();
			} else {
				Sophos.MenuTest.open();
			}
		};

		productButton.click( Sophos.MenuTest.toggle );
		modalBackground.click( Sophos.MenuTest.close );
	});

	</script>

	
	<section class="about-panel">
	<div class="container">
	<div class="panel-content ">

		<div class="description"><span>Have you listened to our podcast? <a href="/podcast/">Listen now</a></span></div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	<div id="content" class="site-content">
		<div class="content-container">

</div> <!-- .container -->
</div> <!-- #content -->


	<section class="content-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

		<main id="main" class="site-main" role="main">

	
		
<article id="post-247778" class="post-247778 post type-post status-publish format-standard has-post-thumbnail hentry category-apple category-apple-safari category-featured category-ios-mobile category-os-x category-vulnerability tag-apple tag-bypass tag-cve-2014-1266 tag-hack tag-handshake tag-ios tag-man-in-the-middle tag-mitm tag-os-x tag-patch tag-ssl tag-tls">

	<header class="entry-header">
		<h1 class="entry-title">Anatomy of a &#8220;goto fail&#8221; &#8211; Apple&#8217;s SSL bug explained, plus an unofficial patch for OS X!</h1>		<div class="entry-meta">
			<div>
				
	<span class="entry-published">
		<time class="entry-date published" datetime="2014-02-24T13:52:06+00:00">24 Feb 2014</time>
	</span>

					<a href="#comments" class="comment-box">
					<span class="count">61</span>
				</a>
					
	<span class="entry-categories">
	<a href="https://nakedsecurity.sophos.com/category/organisations/apple/">Apple</a>, <a href="https://nakedsecurity.sophos.com/category/technologies/web-browsers/apple-safari/">Apple Safari</a>, <a href="https://nakedsecurity.sophos.com/category/technologies/operating-systems/mobile/ios-mobile/">iOS</a>, <a href="https://nakedsecurity.sophos.com/category/technologies/operating-systems/os-x/">OS X</a>, <a href="https://nakedsecurity.sophos.com/category/security-threats/vulnerability/">Vulnerability</a>	</span>

			</div>
	</header> <!-- .entry-header -->

    <div id="newsletter-signup" class="container top"></div>

			<div class="entry-featured-image">
			<img width="250" height="250" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/gotofail-250.png?w=250&amp;h=250&amp;crop=1" class="attachment-hero-thumbnail size-hero-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/gotofail-250.png 250w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/gotofail-250.png?resize=150,150 150w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/gotofail-250.png?resize=225,225 225w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/gotofail-250.png?resize=70,70 70w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/gotofail-250.png?resize=32,32 32w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/gotofail-250.png?resize=50,50 50w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/gotofail-250.png?resize=64,64 64w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/gotofail-250.png?resize=96,96 96w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/02/gotofail-250.png?resize=128,128 128w" sizes="(max-width: 250px) 100vw, 250px" />					</div> <!-- .entry-featured-image -->
		
		<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2014/02/24/south-korea-concocting-stuxnet-like-virus-to-infect-enemies/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> South Korea concocting Stuxnet-like virus to infect enemies</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2014/02/24/neiman-marcus-hackers-set-off-60000-alarms-over-3-months/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Neiman Marcus hackers set off 60,000 alarms over 3 months</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	<div class="entry-content">
		<div class="entry-prefix">
			<div class="entry-author">
				
	
					<span class="by">by</span>
			<a href="https://nakedsecurity.sophos.com/author/paul-ducklin/" title="Posts by Paul Ducklin" class="author url fn" rel="author">Paul Ducklin</a>		
	
				</div>
			<div class="entry-sharing">
				
	<ul class="block social share">
		<li class="facebook"><a href="https://www.facebook.com/share.php?u=https%3A%2F%2Fnakedsecurity.sophos.com%2F2014%2F02%2F24%2Fanatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch%2F&title=Anatomy+of+a+%E2%80%9Cgoto+fail%E2%80%9D+%E2%80%93+Apple%E2%80%99s+SSL+bug+explained%2C+plus+an+unofficial+patch+for+OS+X%21" data-title="Anatomy of a “goto fail” – Apple’s SSL bug explained, plus an unofficial patch for OS X!" title="Share on Facebook"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
		<li class="twitter"><a href="https://twitter.com/intent/tweet?text=Anatomy+of+a+%E2%80%9Cgoto+fail%E2%80%9D+%E2%80%93+Apple%E2%80%99s+SSL+bug+explained%2C+plus+an+unofficial+patch+for+OS+X%21+https%3A%2F%2Fnakedsecurity.sophos.com%2F%3Fp%3D247778" data-title="Anatomy of a &#8220;goto fail&#8221; &#8211; Apple&#8217;s SSL bug explained, plus an unofficial patch for OS X!" title="Share on Twitter"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
		<li class="linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2014%2F02%2F24%2Fanatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch%2F&title=Anatomy+of+a+%E2%80%9Cgoto+fail%E2%80%9D+%E2%80%93+Apple%E2%80%99s+SSL+bug+explained%2C+plus+an+unofficial+patch+for+OS+X%21" data-title="Anatomy of a “goto fail” – Apple’s SSL bug explained, plus an unofficial patch for OS X!" title="Share on LinkedIn"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
		<li class="reddit"><a href="https://reddit.com/submit/?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2014%2F02%2F24%2Fanatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch%2F&title=Anatomy+of+a+%E2%80%9Cgoto+fail%E2%80%9D+%E2%80%93+Apple%E2%80%99s+SSL+bug+explained%2C+plus+an+unofficial+patch+for+OS+X%21" title="Share on Reddit"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon reddit"><use xlink:href="#reddit"></use></svg></a></li>

			</ul>

				</div>
		</div>
		<p>At the end of last week, Apple published <a href="http://support.apple.com/kb/HT6147" rel="nofollow">iOS 7.0.6</a>, a security update for its mobile devices.</p>
<p>The update was a patch to protect iPhones, iPads and iPods against what Apple described as a &#8220;data security&#8221; problem:</p>
<p><a href="http://support.apple.com/kb/HT6147" rel="nofollow"><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/02/apple-ios706-5001.png" width="500" height="322" style="margin:0;padding:0;"></img></a></p>
<blockquote><p><tt>Impact: An attacker with a privileged network position may capture or modify data in sessions protected by SSL/TLS</tt></p>
<p><tt>Description: Secure Transport failed to validate the authenticity of the connection. This issue was addressed by restoring missing validation steps.</tt></p>
<p><tt>CVE-ID CVE-2014-1266</tt></p></blockquote>
<p>Apple didn&#8217;t say exactly what it meant by &#8220;a privileged network position,&#8221; or by &#8220;the authenticity of the connection,&#8221; but the smart money &#8211; and my own &#8211; was on what&#8217;s known as a Man-in-the-Middle attack, or a MitM.</p>
<p>MiTM attacks against unencrypted websites are fairly easy.</p>
<p>If you run a dodgy wireless access point, for example, you can trick users who think they are visiting, say,<tt> http&#058;//example.com/ </tt>into visting a fake site of your choice, because you can redirect their network traffic.</p>
<p>You can then fetch the content they expect from the real site (you are the MitM, after all), feed it back to them with tweaks, modifications and malware, and they may be none the wiser.</p>
<p>But if they visit<tt> https&#058;//example.com/ </tt>then it&#8217;s much harder to trick them, because your MitM site can&#8217;t provide the HTTPS certificate that the official site can.</p>
<p>More precisely, a MitM site can send someone else&#8217;s certificate, but it almost certainly can&#8217;t produce any cryptographic &#8220;proof&#8221; that it has possession of the private key that the certificate is meant to validate.</p>
<p>So your visitors end up with a certificate warning that gives away your trickery.</p>
<p>At least, your visitors get a warning if the application they are using actually notices and reports the certificate problem.</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/01/https-warning-500.png" width="500" height="227" style="margin:0;padding:0;"></img></p>
<p style='background-color:#e8e8e8;font-size:80%;padding:.71em;padding-left:2em;text-indent:-1.29em;'>&rarr; Recent research suggested that about <a href="http://nakedsecurity.sophos.com/2014/01/10/just-how-secure-is-that-mobile-banking-app/">40% of mobile banking apps</a> do not check HTTPS certificates properly, or at least do not warn if an invalid certificate is presented. This led us to advise our readers to stick to their desktops or laptops for internet banking. Certificate warnings are important.</p>
<h4>What was wrong with Apple&#8217;s SSL code?</h4>
<p>Apple&#8217;s reluctance to give away too much is perhaps understandable in this case, but the result was to send experts scurrying off to fill in the blanks in <a href="http://support.apple.com/kb/HT6147" rel="nofollow">HT6147</a>, the only official detail about this risky-sounding bug.</p>
<p>The problem <a href="https://www.imperialviolet.org/" rel="nofollow">soon came to light</a>, in a file called<tt> <a href="http://opensource.apple.com/source/Security/Security-55471/libsecurity_ssl/lib/sslKeyExchange.c" rel="nofollow">sslKeyExchange.c</a> </tt>in version 55741 of the source code for <a href="http://opensource.apple.com/source/Security/Security-55471/libsecurity_ssl/lib/SecureTransport.h" rel="nofollow">SecureTransport</a>, Apple&#8217;s offical SSL/TLS library.</p>
<p>The buggy codepath into this file comes as a sequence of C function calls, starting off in SecureTransport&#8217;s<tt> <a href="http://opensource.apple.com/source/Security/Security-55471/libsecurity_ssl/lib/sslHandshake.c" rel="nofollow">sslHandshake.c</a></tt>.</p>
<p>The bad news is that the bug applies to both iOS and OS X, and although the bug was patched in iOS, it is not yet fixed in OS X.</p>
<p>If you&#8217;d like to follow along, you need to make your way through these function calls:</p>
<pre style="font-size:80%;">
SSLProcessHandshakeRecord()   
  -&gt; SSLProcessHandshakeMessage()  
</pre>
<p>The<tt> ProcessHandshakeMessage </tt>function deals with a range of different parts of the SSL handshake, such as:</p>
<pre style="font-size:80%;">
    -&gt; SSLProcessClientHello()
    -&gt; SSLProcessServerHello()
    -&gt; SSLProcessCertificate()
    -&gt; SSLProcessServerKeyExchange()
</pre>
<p>This last function is called for certain sorts of TLS connection, notably where <a href="https://nakedsecurity.sophos.com/2013/11/24/twitter-joins-the-forward-secrecy-club-for-added-resistance-to-surveillance/" rel="nofollow">forward secrecy</a> is involved.</p>
<p>That&#8217;s where the server doesn&#8217;t just use its regular public/private keypair to secure the transaction, but also generates a so-called ephemeral, or one-off, keypair that is used as well.</p>
<p style='background-color:#e8e8e8;font-size:80%;padding:.71em;padding-left:2em;text-indent:-1.29em;'>&rarr; The idea of forward secrecy is that if the server throws away the ephemeral keys after each session, then you can&#8217;t decrypt sniffed traffic from those sessions in the future, even if you acquire the server&#8217;s regular private key by fair means (e.g. a subpoena) or foul (e.g. by bribery or cybertheft).</p>
<p>Now the C code proceeds as follows:</p>
<pre style="font-size:80%;">

SSLProcessServerKeyExchange() 
  -&gt; SSLDecodeSignedServerKeyExchange()
     -&gt; SSLDecodeXXKeyParams()
     IF TLS 1.2 -&gt; SSLVerifySignedServerKeyExchangeTls12()
     OTHERWISE  -&gt; SSLVerifySignedServerKeyExchange()
</pre>
<p>And the<tt>SSLVerifySignedServerKeyExchange </tt>function, found in the<tt> <a href="http://opensource.apple.com/source/Security/Security-55471/libsecurity_ssl/lib/sslKeyExchange.c" rel="nofollow">sslKeyExchange.c</a> </tt>file mentioned above, does this:</p>
<pre style="font-size:71%;">
. . .
hashOut.data = hashes + SSL_MD5_DIGEST_LEN;
hashOut.length = SSL_SHA1_DIGEST_LEN;
if ((err = SSLFreeBuffer(&amp;hashCtx)) != 0)
    goto fail;
if ((err = ReadyHash(&amp;SSLHashSHA1, &amp;hashCtx)) != 0)
    goto fail;
if ((err = SSLHashSHA1.update(&amp;hashCtx, &amp;clientRandom)) != 0)
    goto fail;
if ((err = SSLHashSHA1.update(&amp;hashCtx, &amp;serverRandom)) != 0)
    goto fail;
if ((err = SSLHashSHA1.update(&amp;hashCtx, &amp;signedParams)) != 0)
    goto fail;
    goto fail;  /* MISTAKE! THIS LINE SHOULD NOT BE HERE */
if ((err = SSLHashSHA1.final(&amp;hashCtx, &amp;hashOut)) != 0)
    goto fail;

err = sslRawVerify(...);
. . .
</pre>
<p>You don&#8217;t really need an knowledge of C, or even of programming, to understand the error here.</p>
<p>The programmer is supposed to calculate a cryptographic checksum of three data items &#8211; the three calls to<tt> SSLHash&shy;SHA1.update()</tt> &#8211; and then to call the all-important function<tt> sslRawVerify()</tt>.</p>
<p>If<tt> sslRawVerify() </tt> succeeds, then<tt> err </tt>ends up with the value zero, which means &#8220;no error&#8221;, and that&#8217;s what the<tt> SSLVerify&shy;Signed&shy;ServerKey&shy;Exchange </tt>function returns to say, &#8220;All good.&#8221;</p>
<p>But in the middle of this code fragment, you can see that the programmer has accidentally (no conspiracy theories, please!) repeated the line<tt> goto fail;</tt>.</p>
<p>The first<tt> goto fail </tt> happens if the<tt> if </tt>statement succeeds, i.e. if there has been a problem and therefore<tt> err </tt>is non-zero.</p>
<p>This causes an immediate &#8220;bail with error,&#8221; and the entire TLS connection fails.</p>
<p>But because of the pecadilloes of C, the second<tt> goto fail</tt>, which shouldn&#8217;t be there, always happens if the first one doesn&#8217;t, i.e. if<tt> err </tt>is zero and there is actually no error to report.</p>
<p>The result is that the code leaps over the vital call to<tt> sslRawVerify()</tt>, and exits the function.</p>
<p>This causes an immediate &#8220;exit and report success&#8221;, and the TLS connection succeeds, <em>even though the verification process hasn&#8217;t actually taken place</em>.</p>
<h4>What an attacker can do</h4>
<p>An attacker now has a way to trick users of OS X 10.9 into accepting SSL/TLS certificates that ought to be rejected, though admittedly there are several steps, and he needs to:</p>
<ul>
<li>Trick you into visting an imposter HTTPS site, e.g. by using a poisoned public Wi-Fi access point.
<li>Force your browser (or other software) into using forward secrecy, possible because the server decides what encryption algorithms it will support.
<li>Force your browser (or other software) into using TLS 1.1, possible because the server decides what TLS versions it will allow.
<li>Supply a legitimate-looking TLS certificate with a mismatched private key.
</ul>
<p>Safari on OS X is definitely affected, because it makes use of the buggy version of SecureTransport.</p>
<p>You can work out if a application is affected by this bug by using Apple&#8217;s<tt> otool </tt>program, which is a handy utility for digging version details out of program files and code libraries.</p>
<p>You use the<tt> -L </tt>option, which displays the names and version numbers of the shared libraries that a program uses:</p>
<p><img src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/02/otool-2-500.png" height="94" style="margin:0;padding:0;"></img></p>
<p>That&#8217;s only a start, since the Safari app is just a wrapper for the Safari.framework, which we need run through <tt> otool </tt>in its turn:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/02/otool-1-500.png" width="500" height="95" style="margin:0;padding:0;"></img></p>
<p>Other popular apps that link to the buggy library include, in no particular order: Mail, Numbers, Keynote, Pages, Preview and Calendar.</p>
<p>Clearly, not all of these apps put you in quite the same immediate danger as Safari, but the list presents a good reminder of why shared libraries are both a blessing (one patch fixes the lot) and a curse (one bug affects them all).</p>
<p>Popular apps in which encryption is important but that don&#8217;t seem to use the buggy library include: Firefox, Chromium (and Chrome), Thunderbird and Skype.</p>
<h4>What to do?</h4>
<p>The good news is that Apple has broken its usual code of silence, by which it &#8220;does not disclose, discuss, or confirm security issues until a full investigation has occurred and any necessary patches or releases are available.&#8221;</p>
<p>Reuters reports that an official Apple spokesperson, Trudy Muller, has <a href="http://www.reuters.com/article/2014/02/22/us-apple-encryption-idUSBREA1L10220140222" rel="nofollow">gone on the record</a> to say, &#8220;We are aware of this issue and already have a software fix that will be released very soon.&#8221;</p>
<p>Sadly, she didn&#8217;t define &#8220;very soon,&#8221; but you should watch for this patch and apply it as soon as you can.</p>
<p style='background-color:#e8e8e8;font-size:80%;padding:.71em;padding-left:2em;text-indent:-1.29em;'>&rarr; When you update, be sure to follow the advice below about avoiding insecure networks. The<tt> Software Update </tt>app uses the buggy Security library!</p>
<p>We suggest that you try any or all of the following:</p>
<p style="background-color:#e8e8e8;text-align:center;padding:.8em;"><strong>Avoid insecure networks</strong></p>
<p>Connecting to other people&#8217;s Wi-fi networks, even if they are password protected, can be dangerous.</p>
<p>Even if you trust the person who runs the network &#8211; a family member or a friend, perhaps &#8211; you also need to trust that they have kept their access point secure from everyone else.</p>
<p>If you are using your computer for business, consider asking your employer to set you up as part of the <a href="http://www.sophos.com/en-us/products/secure-vpn.aspx">company&#8217;s VPN</a> (virtual private network), if you have one.</p>
<p>This limits your freedom and flexibility very slightly, but makes you a lot more secure.</p>
<p>With a VPN, you use other people&#8217;s insecure networks only to <a href="http://www.sophos.com/en-us/products/secure-vpn.aspx">create an encrypted data path</a> back into the company network, from where you access the internet as if you were an insider.</p>
<p style="background-color:#e8e8e8;text-align:center;padding:.8em;"><strong>Use a web filtering product that can scan HTTPS traffic</strong></p>
<p>Products like the Sophos Web Appliance and <a href="http://www.sophos.com/en-us/products/unified-threat-management.aspx">Sophos UTM</a> can inspect HTTPS traffic &#8211; ironically by decrypting and re-encrypting it, but without any certificate shenanigans like a man-in-the-middle crook might try.</p>
<p>Because the Sophos web filtering products do not use Apple&#8217;s libraries, or even Apple&#8217;s operating system, they are not vulnerable to the certificate trickery described above, so certificate validation will fail, as it should.</p>
<p style="background-color:#e8e8e8;text-align:center;padding:.8em;"><strong>Switch to an alternative browser</strong></p>
<p>Alternative browsers such as Firefox and Chromium (as well as Chrome) use their own SSL/TLS libraries as a way of making the applications easier to support on multiple operating systems.</p>
<p>In this case, that has the effect of immunising them against the bug in Apple&#8217;s SecureTransport library.</p>
<p>You can switch back to Safari after Apple&#8217;s patch is out.</p>
<p style="background-color:#e8e8e8;text-align:center;padding:.8em;"><strong>Try this completely unofficial patch!</strong></p>
<p>(Only kidding. You wouldn&#8217;t dream of applying a little-tested hack to an important system library, would you?)</p>
<p><a href="http://nakedsecurity.sophos.com/unofficial-patch-for-the-apple-securetransport-55741-bug">This patch</a> exists only:</p>
<ul>
<li>To demonstrate that emergency &#8220;fixes&#8221; don&#8217;t always fix, but often can only work around problems.
<li>To show what C code looks like when compiled to assembler.
<li>To give some insight into how unauthorised hacks, for good and bad, can be achieved.
<li>To introduce the OS X<tt> codesign </tt>utility and Apple&#8217;s code signing protection.
<li>For fun.
</ul>
<p>By all means <a href="http://nakedsecurity.sophos.com/unofficial-patch-for-the-apple-securetransport-55741-bug">take a look</a> &#8211; but for <a href="http://nakedsecurity.sophos.com/unofficial-patch-for-the-apple-securetransport-55741-bug">research purposes only</a>, of course.</p>
<p style='padding-bottom:.8em;padding-top:.8em;'></p>
			</div> <!-- .entry-content -->
	<ul class="block social follow">
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon twitter"><use xlink:href="#twitter"></use></svg>
			<p>Follow <strong><a href="https://twitter.com/nakedsecurity">@NakedSecurity on Twitter</a></strong> for the latest computer security news.</p>
		</li>
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon instagram"><use xlink:href="#instagram"></use></svg>
			<p>Follow <strong><a href="https://www.instagram.com/nakedsecurity/">@NakedSecurity on Instagram</a></strong> for exclusive pics, gifs, vids and LOLs!</p>
		</li>
	</ul>
</article><!-- #post-## -->

		<div class="free-tools-block">
			<h2 class="block-title">Free tools</h2>

<div class="ns-free-tools">
	<div class="ns-free-tools__item ns-free-tools__item--sophos-home">
		<a class="ns-free-tools__link" href="https://home.sophos.com/en-us.aspx?cmp=701j0000001eLpnAAE">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/sophos-home@2x.png" alt="Sophos Home" class="ns-free-tools__image" width="166" height="100">
			<h4 class="ns-free-tools__title">
				Sophos Home			</h4>
			<div class="ns-free-tools__sub-title">
				Protect personal PCs and Macs			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--hitman-pro">
		<a class="ns-free-tools__link" href="https://www.hitmanpro.com/en-us/hmp.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/hitman-pro@2x.png" alt="Hitman Pro" class="ns-free-tools__image" width="154" height="100">
			<h4 class="ns-free-tools__title">
				Hitman Pro			</h4>
			<div class="ns-free-tools__sub-title">
				Find and remove malware			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--intercept-x">
		<a class="ns-free-tools__link" href="https://www.sophos.com/en-us/products/free-tools/sophos-mobile-security-free-edition.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/mobile-security-android@2x.png" alt="Sophos Intercept X for Mobile" class="ns-free-tools__image" width="96" height="110">
			<h4 class="ns-free-tools__title">
				Intercept X for Mobile			</h4>
			<div class="ns-free-tools__sub-title">
				Protect Android devices			</div>
		</a>
	</div>
</div>
		</div>

			<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2014/02/24/south-korea-concocting-stuxnet-like-virus-to-infect-enemies/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> South Korea concocting Stuxnet-like virus to infect enemies</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2014/02/24/neiman-marcus-hackers-set-off-60000-alarms-over-3-months/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Neiman Marcus hackers set off 60,000 alarms over 3 months</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	
	</main><!-- #main -->

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<section class="comments-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

			
<div id="comments" class="comments-area">

			<h2 class="comments-title">
			61 comments on &ldquo;<span>Anatomy of a &#8220;goto fail&#8221; &#8211; Apple&#8217;s SSL bug explained, plus an unofficial patch for OS X!</span>&rdquo;		</h2>

		<ol class="comment-list">
					<li id="comment-1984326" class="comment even thread-even depth-1 parent">
			<article id="div-comment-1984326" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/cc262391460a40fa69d90d081021c60a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/cc262391460a40fa69d90d081021c60a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Victor L-S</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1984326"><time datetime="2014-02-24T14:41:06+00:00">February 24, 2014 at 2:41 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Enjoyed the details and your patch (for research purposes only).</p>
<p>Where did you learn your assembler?</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1984326"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1984326={"id":7238218,"unique_id":"wp-comment-1984326","title":"Enjoyed%20the%20details%20and%20your%20patch%20%28for%20research%20purposes%20only%29.Where%20did%20you%20learn%20your%20assembler%3F%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1984326","item_id":"_comm_1984326"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1984326#respond' data-commentid="1984326" data-postid="247778" data-belowelement="div-comment-1984326" data-respondelement="respond" data-replyto="Reply to Victor L-S" aria-label='Reply to Victor L-S'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1986396" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2">
			<article id="div-comment-1986396" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1986396"><time datetime="2014-02-24T20:24:39+00:00">February 24, 2014 at 8:24 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Back in the day, you wrote in assembler to save space and time. Or because the compiler was untrustworthy 🙂</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1986396"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1986396={"id":7238218,"unique_id":"wp-comment-1986396","title":"Back%20in%20the%20day%2C%20you%20wrote%20in%20assembler%20to%20save%20space%20and%20time.%20Or%20because%20the%20compiler%20was%20untrustworthy%20%3A-%29%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1986396","item_id":"_comm_1986396"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1986396#respond' data-commentid="1986396" data-postid="247778" data-belowelement="div-comment-1986396" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-1984422" class="comment even thread-odd thread-alt depth-1 parent">
			<article id="div-comment-1984422" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/b066dc49998f4ce48e993131f620009e?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b066dc49998f4ce48e993131f620009e?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">John Smith</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1984422"><time datetime="2014-02-24T14:53:39+00:00">February 24, 2014 at 2:53 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Would a third party app or web browser (e.g. mercury or a banking app) rely on the flawed apple code in IOS ?</p>
<p>Frankly still not keen on upgrading to IOS7, but may be forced by this.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1984422"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1984422={"id":7238218,"unique_id":"wp-comment-1984422","title":"Would%20a%20third%20party%20app%20or%20web%20browser%20%28e.g.%20mercury%20or%20a%20banking%20app%29%20rely%20on%20the%20flawed%20apple%20code%20in%20IOS%20%3FFrankly%20still%20not%20keen%20on%20upgrading%20to%20IOS7%2C%20but%20may%20be%20forced%20by%20this.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1984422","item_id":"_comm_1984422"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1984422#respond' data-commentid="1984422" data-postid="247778" data-belowelement="div-comment-1984422" data-respondelement="respond" data-replyto="Reply to John Smith" aria-label='Reply to John Smith'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1984936" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2">
			<article id="div-comment-1984936" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1984936"><time datetime="2014-02-24T16:01:27+00:00">February 24, 2014 at 4:01 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>You should assume that third party apps on iOS are affected. IIRC, iOS 6 is also affected, and there is an update.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1984936"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1984936={"id":7238218,"unique_id":"wp-comment-1984936","title":"You%20should%20assume%20that%20third%20party%20apps%20on%20iOS%20are%20affected.%20IIRC%2C%20iOS%206%20is%20also%20affected%2C%20and%20there%20is%20an%20update.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1984936","item_id":"_comm_1984936"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1984936#respond' data-commentid="1984936" data-postid="247778" data-belowelement="div-comment-1984936" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-1984470" class="comment even thread-even depth-1 parent">
			<article id="div-comment-1984470" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/1e41c58e98f24908060130e58333e07a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1e41c58e98f24908060130e58333e07a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">LonerVamp</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1984470"><time datetime="2014-02-24T14:59:31+00:00">February 24, 2014 at 2:59 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Heh, no conspiracy theories? 🙂 If a mistake, that&#8217;s a pretty conveniently sweet mistake for anyone with an interest in being able to eavesdrop on SSL connections. If a rogue developer, that&#8217;s a pretty strange way to insert your little bug, instead of trying to do some remote code executes or backdoors. And it&#8217;s something that even basic code reviews should pick up on. If a mistake and code reviews missed it, then what else has been missed?</p>
<p>Just sayin&#8217; this is *very* convenient. I could certainly see some agency/gov demanding that Apple include something to allow eavesdropping, and Apple/devs just doing the most obvious and basic thing to satisfy the demand. Sort of like a kid being asked to clean his room, and he drags feet and shoves everything under into the closet, doing the bare minimum and only exactly as requested by someone who maybe didn&#8217;t know better how to do this and hide it. I can totally see a dev team not liking this, doing exactly what is asked, knowing it&#8217;s shoddy.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1984470"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1984470={"id":7238218,"unique_id":"wp-comment-1984470","title":"Heh%2C%20no%20conspiracy%20theories%3F%20%3A%29%20If%20a%20mistake%2C%20that%26%23039%3Bs%20a%20pretty%20conveniently%20sweet%20mistake%20for%20anyone%20with%20an%20interest%20in%20being%20able%20to%20eavesdrop%20on%20SSL%20connections.%20If%20a%20rogue%20developer%2C%20that%26%23039%3Bs%20a%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1984470","item_id":"_comm_1984470"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1984470#respond' data-commentid="1984470" data-postid="247778" data-belowelement="div-comment-1984470" data-respondelement="respond" data-replyto="Reply to LonerVamp" aria-label='Reply to LonerVamp'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1984979" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2 parent">
			<article id="div-comment-1984979" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1984979"><time datetime="2014-02-24T16:10:02+00:00">February 24, 2014 at 4:10 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Personally, I&#8217;d write the code differently so that the function didn&#8217;t return whatever the last value of err was, but used non-zero err values to set, say, a separate variable retval, and I&#8217;d make the default value of retval something like ERR_INCOMPLETE. </p>
<p>Also, I *always* use squiggly brackets (braces) after if()s even if they are not necessary, as my opinion is that code written that way is easier to read. Actually, that&#8217;s not an opinion. It&#8217;s a fact, but I&#8217;ll pretend it&#8217;s an opinion.</p>
<p>E.g.</p>
<pre>
int retval = ERR_INCOMPLETE;

if ((err=hashfunc()) != 0) {
   retval = ERR_HASHBROKE;
   goto fail;
}
</pre>
<p>That way I have to set retval to ERR_NONE myself if I want my &#8220;return retval&#8221; to signal success.</p>
<p>I think your conspiracy theory is a long bow &#8211; did you look at the code style overall?</p>
<p>As for code reviews picking it up &#8211; it was in Apple&#8217;s open source repository for months (&#8220;with many eyes, all bugs are shallow&#8221;, eh?) and no-one saw.</p>
<p>It happens.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1984979"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1984979={"id":7238218,"unique_id":"wp-comment-1984979","title":"Personally%2C%20I%26%23039%3Bd%20write%20the%20code%20differently%20so%20that%20the%20function%20didn%26%23039%3Bt%20return%20whatever%20the%20last%20value%20of%20err%20was%2C%20but%20used%20non-zero%20err%20values%20to%20set%2C%20say%2C%20a%20separate%20variable%20retval%2C%20and%20I%26%23039%3Bd%20mak%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1984979","item_id":"_comm_1984979"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1984979#respond' data-commentid="1984979" data-postid="247778" data-belowelement="div-comment-1984979" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1985158" class="comment even depth-3 parent">
			<article id="div-comment-1985158" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/73c10e848d46d8d539d51cababe33878?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/73c10e848d46d8d539d51cababe33878?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1985158"><time datetime="2014-02-24T16:46:09+00:00">February 24, 2014 at 4:46 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Haha &#8211; but what would you do if you wanted it to look like an accident..? 😛</p>
<p>And why did it take so long for you guys to post about this? I had to find out from elsewhere!!!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1985158"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1985158={"id":7238218,"unique_id":"wp-comment-1985158","title":"Haha%20-%20but%20what%20would%20you%20do%20if%20you%20wanted%20it%20to%20look%20like%20an%20accident..%3F%20%3APAnd%20why%20did%20it%20take%20so%20long%20for%20you%20guys%20to%20post%20about%20this%3F%20I%20had%20to%20find%20out%20from%20elsewhere%21%21%21%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1985158","item_id":"_comm_1985158"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1985158#respond' data-commentid="1985158" data-postid="247778" data-belowelement="div-comment-1985158" data-respondelement="respond" data-replyto="Reply to Paul" aria-label='Reply to Paul'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1985879" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-4">
			<article id="div-comment-1985879" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1985879"><time datetime="2014-02-24T18:54:19+00:00">February 24, 2014 at 6:54 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>It didn&#8217;t take us &#8220;so long.&#8221; The news only broke over the weekend, and because most of the articles that came out quickly were just news and opinion, we figured we&#8217;d put some effort into the advice and research angle. </p>
<p>You may have found out from elsewhere (e.g from Apple), but then what? I suppose those early articles  told you that you might be *in* danger&#8230;but I betcha they didn&#8217;t offer a patch to get you *out* of danger 🙂</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1985879"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1985879={"id":7238218,"unique_id":"wp-comment-1985879","title":"It%20didn%26%23039%3Bt%20take%20us%20%26quot%3Bso%20long.%26quot%3B%20The%20news%20only%20broke%20over%20the%20weekend%2C%20and%20because%20most%20of%20the%20articles%20that%20came%20out%20quickly%20were%20just%20news%20and%20opinion%2C%20we%20figured%20we%26%23039%3Bd%20put%20some%20effort%20into%20the%20advi%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1985879","item_id":"_comm_1985879"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1985879#respond' data-commentid="1985879" data-postid="247778" data-belowelement="div-comment-1985879" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-1985236" class="comment even depth-3 parent">
			<article id="div-comment-1985236" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/cc262391460a40fa69d90d081021c60a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/cc262391460a40fa69d90d081021c60a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Victor L-S</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1985236"><time datetime="2014-02-24T16:59:05+00:00">February 24, 2014 at 4:59 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Do you think that proper code testing would have revealed this?</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1985236"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1985236={"id":7238218,"unique_id":"wp-comment-1985236","title":"Do%20you%20think%20that%20proper%20code%20testing%20would%20have%20revealed%20this%3F%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1985236","item_id":"_comm_1985236"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1985236#respond' data-commentid="1985236" data-postid="247778" data-belowelement="div-comment-1985236" data-respondelement="respond" data-replyto="Reply to Victor L-S" aria-label='Reply to Victor L-S'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1986007" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-4 parent">
			<article id="div-comment-1986007" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1986007"><time datetime="2014-02-24T19:18:26+00:00">February 24, 2014 at 7:18 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Of course so&#8230;if you define &#8220;proper testing&#8221; as &#8220;testing that catches this kind of bug&#8221; 🙂</p>
<p>In an ideal world, the code could have been written in a slightly different style so that the forward jumps (goto fail) were much less likely to have resulted in &#8220;accidental success&#8221; being returned; the layout of the code could have been clearer; the compiler could have been used to warn more stringently about unused code (the skipped-over part); a different language could have been used that makes error handling easier and safer; the coder could have insisted on devising test cases that ensured more combinations of TLS version and encryption mode; and a code reviewer could simply have spotted the repeated line &#8211; after all, it sure looks obvious *once you know it&#8217;s there*!</p>
<p>This was in Apple&#8217;s open source code for months, and no-one noticed (no-one who reported it, anyway). And in the real world, for the bad code to be noticed at all during routine work, you&#8217;d need a site that did support forward secrecy but did not support TLS 1.2 &#8211; sounds an unusual sort of progressive/regressive combination to me.</p>
<p>My personal feeling is that a lot of coders will be *thinking*, &#8220;There but for the grace of God go I, &#8221; even if they are *saying,* &#8220;Oooer, yucky code.&#8221;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1986007"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1986007={"id":7238218,"unique_id":"wp-comment-1986007","title":"Of%20course%20so...if%20you%20define%20%26quot%3Bproper%20testing%26quot%3B%20as%20%26quot%3Btesting%20that%20catches%20this%20kind%20of%20bug%26quot%3B%20%3A-%29In%20an%20ideal%20world%2C%20the%20code%20could%20have%20been%20written%20in%20a%20slightly%20different%20style%20so%20that%20the%20forward%20j%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1986007","item_id":"_comm_1986007"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1986007#respond' data-commentid="1986007" data-postid="247778" data-belowelement="div-comment-1986007" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1990101" class="comment even depth-5 parent">
			<article id="div-comment-1990101" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/74378734065809b03499737eb44c336c?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/74378734065809b03499737eb44c336c?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Robert</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1990101"><time datetime="2014-02-25T04:10:18+00:00">February 25, 2014 at 4:10 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Surely simple code coverage test should have revealed that the finalise and verify lines never get executed?</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1990101"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1990101={"id":7238218,"unique_id":"wp-comment-1990101","title":"Surely%20simple%20code%20coverage%20test%20should%20have%20revealed%20that%20the%20finalise%20and%20verify%20lines%20never%20get%20executed%3F%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1990101","item_id":"_comm_1990101"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1990101#respond' data-commentid="1990101" data-postid="247778" data-belowelement="div-comment-1990101" data-respondelement="respond" data-replyto="Reply to Robert" aria-label='Reply to Robert'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1990233" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-6 parent">
			<article id="div-comment-1990233" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1990233"><time datetime="2014-02-25T04:27:42+00:00">February 25, 2014 at 4:27 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Coverage tests are rarely &#8220;simple,&#8221; at least for the last gaps in the code. </p>
<p>If you&#8217;re looking for &#8220;simple,&#8221; then just noticing the weird-looking error in a review might have been a better way 🙂</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1990233"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1990233={"id":7238218,"unique_id":"wp-comment-1990233","title":"Coverage%20tests%20are%20rarely%20%26quot%3Bsimple%2C%26quot%3B%20at%20least%20for%20the%20last%20gaps%20in%20the%20code.%20If%20you%26%23039%3Bre%20looking%20for%20%26quot%3Bsimple%2C%26quot%3B%20then%20just%20noticing%20the%20weird-looking%20error%20in%20a%20review%20might%20have%20been%20a%20better%20way%20%3A-%29%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1990233","item_id":"_comm_1990233"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1990233#respond' data-commentid="1990233" data-postid="247778" data-belowelement="div-comment-1990233" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-2025626" class="comment even depth-7 parent">
			<article id="div-comment-2025626" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/74378734065809b03499737eb44c336c?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/74378734065809b03499737eb44c336c?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Robert</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-2025626"><time datetime="2014-02-28T18:57:43+00:00">February 28, 2014 at 6:57 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Note to self: stop overusing the word simple</p>
<p>Coverage tests may require some time and investment to set up, but for security related code I would have thought it important to make that effort. I still think this could and should have been caught by a code coverage test.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_2025626"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_2025626={"id":7238218,"unique_id":"wp-comment-2025626","title":"Note%20to%20self%3A%20stop%20overusing%20the%20word%20simpleCoverage%20tests%20may%20require%20some%20time%20and%20investment%20to%20set%20up%2C%20but%20for%20security%20related%20code%20I%20would%20have%20thought%20it%20important%20to%20make%20that%20effort.%20I%20s%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-2025626","item_id":"_comm_2025626"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=2025626#respond' data-commentid="2025626" data-postid="247778" data-belowelement="div-comment-2025626" data-respondelement="respond" data-replyto="Reply to Robert" aria-label='Reply to Robert'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-2025770" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-8">
			<article id="div-comment-2025770" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-2025770"><time datetime="2014-02-28T19:33:04+00:00">February 28, 2014 at 7:33 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>On that, we agree. This is TLS, after all, and because the coder has gone to the trouble of splitting out the TLS1.2 and TLS-other verification into two functions&#8230;yep, they should both be properly tested, and a coverage test would show the lack of completeness in the functionality test.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_2025770"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_2025770={"id":7238218,"unique_id":"wp-comment-2025770","title":"On%20that%2C%20we%20agree.%20This%20is%20TLS%2C%20after%20all%2C%20and%20because%20the%20coder%20has%20gone%20to%20the%20trouble%20of%20splitting%20out%20the%20TLS1.2%20and%20TLS-other%20verification%20into%20two%20functions...yep%2C%20they%20should%20both%20be%20prope%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-2025770","item_id":"_comm_2025770"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=2025770#respond' data-commentid="2025770" data-postid="247778" data-belowelement="div-comment-2025770" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-2006651" class="comment even depth-5">
			<article id="div-comment-2006651" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/cc262391460a40fa69d90d081021c60a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/cc262391460a40fa69d90d081021c60a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Victor L-S</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-2006651"><time datetime="2014-02-26T19:36:28+00:00">February 26, 2014 at 7:36 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I&#8217;ll toss in one more &#8220;barn door closed&#8221; comment. One thing I do treasure is a competent code formatter. Given that, the code might have appeared as&#8230;</p>
<pre>
if ((err = SSLHashSHA1.update(&amp;hashCtx, &amp;serverRandom)) != 0)
    goto fail;
if ((err = SSLHashSHA1.update(&amp;hashCtx, &amp;signedParams)) != 0)
    goto fail;
goto fail;  /* MISTAKE! THIS LINE SHOULD NOT BE HERE */
if ((err = SSLHashSHA1.final(&amp;hashCtx, &amp;hashOut)) != 0)
    goto fail;
</pre>
<p>making error identification easier.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_2006651"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_2006651={"id":7238218,"unique_id":"wp-comment-2006651","title":"I%26%23039%3Bll%20toss%20in%20one%20more%20%26quot%3Bbarn%20door%20closed%26quot%3B%20comment.%20One%20thing%20I%20do%20treasure%20is%20a%20competent%20code%20formatter.%20Given%20that%2C%20the%20code%20might%20have%20appeared%20as...%26lt%3Bpre%26gt%3Bif%20%28%28err%20%3D%20SSLHashSHA1.update%28%26amp%3Bhash%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-2006651","item_id":"_comm_2006651"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=2006651#respond' data-commentid="2006651" data-postid="247778" data-belowelement="div-comment-2006651" data-respondelement="respond" data-replyto="Reply to Victor L-S" aria-label='Reply to Victor L-S'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-1996780" class="comment odd alt depth-3 parent">
			<article id="div-comment-1996780" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/488c2dcaa43806d49cac768901604ab5?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/488c2dcaa43806d49cac768901604ab5?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Steven Fisher</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1996780"><time datetime="2014-02-25T19:09:29+00:00">February 25, 2014 at 7:09 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Back when I used C heavily and followed the goto as exceptions pattern, my solution was to have a flag for completion. I&#8217;d default it to 0, and set it only on success.</p>
<p>      int complete = 0;<br />
      int err;</p>
<p>      if ((err=hashfunc()) != 0) {<br />
       goto fail;<br />
      }</p>
<p>      complete = 1;<br />
    fail:<br />
      if ((complete == 0) &amp;&amp; (err == none)) err = unknown;<br />
      // rest of error handling</p>
<p>I like this approach a bit more as it&#8217;s more explicit, but of course either would work perfectly well.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1996780"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1996780={"id":7238218,"unique_id":"wp-comment-1996780","title":"Back%20when%20I%20used%20C%20heavily%20and%20followed%20the%20goto%20as%20exceptions%20pattern%2C%20my%20solution%20was%20to%20have%20a%20flag%20for%20completion.%20I%26%23039%3Bd%20default%20it%20to%200%2C%20and%20set%20it%20only%20on%20success.%20%20%20%20%20%20int%20complete%20%3D%200%3B%20%20%20%20%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1996780","item_id":"_comm_1996780"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1996780#respond' data-commentid="1996780" data-postid="247778" data-belowelement="div-comment-1996780" data-respondelement="respond" data-replyto="Reply to Steven Fisher" aria-label='Reply to Steven Fisher'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1998424" class="comment byuser comment-author-pducklin bypostauthor even depth-4">
			<article id="div-comment-1998424" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1998424"><time datetime="2014-02-26T00:09:50+00:00">February 26, 2014 at 12:09 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>In my example, retval serves the same purpose as complete&#8230;if you only ever let it take the ERR_NONE value when you are explicitly done-and-succeeded.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1998424"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1998424={"id":7238218,"unique_id":"wp-comment-1998424","title":"In%20my%20example%2C%20retval%20serves%20the%20same%20purpose%20as%20complete...if%20you%20only%20ever%20let%20it%20take%20the%20ERR_NONE%20value%20when%20you%20are%20explicitly%20done-and-succeeded.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1998424","item_id":"_comm_1998424"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1998424#respond' data-commentid="1998424" data-postid="247778" data-belowelement="div-comment-1998424" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-2007248" class="comment odd alt depth-3 parent">
			<article id="div-comment-2007248" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/301817725d79f38c673b578f14cbac50?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/301817725d79f38c673b578f14cbac50?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">dgrb</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-2007248"><time datetime="2014-02-26T21:32:34+00:00">February 26, 2014 at 9:32 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>&#8220;Also, I *always* use squiggly brackets (braces) after if()s even if they are not necessary, as my opinion is that code written that way is easier to read. Actually, that&#8217;s not an opinion. It&#8217;s a fact, but I&#8217;ll pretend it&#8217;s an opinion.&#8221;</p>
<p>Not only that, but it prevents accidentally adding another indented statement thinking it&#8217;s part of the if.</p>
<p>I *always* tell my students that they should *never*  leave out the curly brackets when programming in C, which is the only language I&#8217;m prepared to use with {}s. Any later language &#8211; yes, I&#8217;m talking to your Java &#8211; should not use them, they are SO 1970s.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_2007248"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_2007248={"id":7238218,"unique_id":"wp-comment-2007248","title":"%26quot%3BAlso%2C%20I%20%2Aalways%2A%20use%20squiggly%20brackets%20%28braces%29%20after%20if%28%29s%20even%20if%20they%20are%20not%20necessary%2C%20as%20my%20opinion%20is%20that%20code%20written%20that%20way%20is%20easier%20to%20read.%20Actually%2C%20that%26%23039%3Bs%20not%20an%20opinion.%20It%26%23039%3Bs%20a%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-2007248","item_id":"_comm_2007248"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=2007248#respond' data-commentid="2007248" data-postid="247778" data-belowelement="div-comment-2007248" data-respondelement="respond" data-replyto="Reply to dgrb" aria-label='Reply to dgrb'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-2011578" class="comment byuser comment-author-pducklin bypostauthor even depth-4">
			<article id="div-comment-2011578" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-2011578"><time datetime="2014-02-27T07:42:57+00:00">February 27, 2014 at 7:42 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Well, the inventors of the &#8220;Go&#8221; language &#8211; including Ken Thompson, the inventor of B, that became C &#8211; decided that the &#8220;strong guidelines&#8221; in the K&amp;R book (braces on the same line and always used) should be mandated by the language.</p>
<p>They weren&#8217;t so sure about using braces at all &#8211; they&#8217;re SO 1970s &#8211; but decided they should, because it would cause a level of comfort likely to avoid silly complaints.</p>
<p>(I have seen loads of people refuse to use Lua, an excellent language embedded in many popular tools, like Nmap, Wireshark and WoW, because it expects you to write &#8220;if condition then dothis() else dothat() end&#8221; and they think THAT looks so 1970s&#8230;remember Pascal 🙂</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_2011578"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_2011578={"id":7238218,"unique_id":"wp-comment-2011578","title":"Well%2C%20the%20inventors%20of%20the%20%26quot%3BGo%26quot%3B%20language%20-%20including%20Ken%20Thompson%2C%20the%20inventor%20of%20B%2C%20that%20became%20C%20-%20decided%20that%20the%20%26quot%3Bstrong%20guidelines%26quot%3B%20in%20the%20K%26amp%3BR%20book%20%28braces%20on%20the%20same%20line%20and%20always%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-2011578","item_id":"_comm_2011578"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=2011578#respond' data-commentid="2011578" data-postid="247778" data-belowelement="div-comment-2011578" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-1984487" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-1984487" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/1e41c58e98f24908060130e58333e07a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1e41c58e98f24908060130e58333e07a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">LonerVamp</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1984487"><time datetime="2014-02-24T15:01:22+00:00">February 24, 2014 at 3:01 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Also, by the way, while the patch for iOS is out, OS X is also affected and currently not patched.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1984487"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1984487={"id":7238218,"unique_id":"wp-comment-1984487","title":"Also%2C%20by%20the%20way%2C%20while%20the%20patch%20for%20iOS%20is%20out%2C%20OS%20X%20is%20also%20affected%20and%20currently%20not%20patched.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1984487","item_id":"_comm_1984487"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1984487#respond' data-commentid="1984487" data-postid="247778" data-belowelement="div-comment-1984487" data-respondelement="respond" data-replyto="Reply to LonerVamp" aria-label='Reply to LonerVamp'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1984907" class="comment byuser comment-author-pducklin bypostauthor even depth-2 parent">
			<article id="div-comment-1984907" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1984907"><time datetime="2014-02-24T15:56:07+00:00">February 24, 2014 at 3:56 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hmmm. I thought the article made that fairly clear&#8230;but perhaps I should add the text from the main page of Naked Security into the article to make it clearer? (Not everyone comes from the main page, of course, where I wrote &#8220;Apple just patched an SSL/TLS bug in iOS &#8211; but the flaw is not yet fixed in OS X.&#8221;</p>
<p>Thanks.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1984907"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1984907={"id":7238218,"unique_id":"wp-comment-1984907","title":"Hmmm.%20I%20thought%20the%20article%20made%20that%20fairly%20clear...but%20perhaps%20I%20should%20add%20the%20text%20from%20the%20main%20page%20of%20Naked%20Security%20into%20the%20article%20to%20make%20it%20clearer%3F%20%28Not%20everyone%20comes%20from%20the%20main%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1984907","item_id":"_comm_1984907"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1984907#respond' data-commentid="1984907" data-postid="247778" data-belowelement="div-comment-1984907" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1986432" class="comment odd alt depth-3 parent">
			<article id="div-comment-1986432" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/1e41c58e98f24908060130e58333e07a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1e41c58e98f24908060130e58333e07a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">LonerVamp</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1986432"><time datetime="2014-02-24T20:31:44+00:00">February 24, 2014 at 8:31 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Oops, sorry about that. I typically come in from the daily email. 🙂</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1986432"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1986432={"id":7238218,"unique_id":"wp-comment-1986432","title":"Oops%2C%20sorry%20about%20that.%20I%20typically%20come%20in%20from%20the%20daily%20email.%20%3A%29%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1986432","item_id":"_comm_1986432"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1986432#respond' data-commentid="1986432" data-postid="247778" data-belowelement="div-comment-1986432" data-respondelement="respond" data-replyto="Reply to LonerVamp" aria-label='Reply to LonerVamp'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1986489" class="comment byuser comment-author-pducklin bypostauthor even depth-4">
			<article id="div-comment-1986489" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1986489"><time datetime="2014-02-24T20:42:59+00:00">February 24, 2014 at 8:42 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>No need to apologise &#8211; I added in a piece to make that point in the article itself. It was a good idea. I also put &#8220;OS X&#8221; in the headline.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1986489"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1986489={"id":7238218,"unique_id":"wp-comment-1986489","title":"No%20need%20to%20apologise%20-%20I%20added%20in%20a%20piece%20to%20make%20that%20point%20in%20the%20article%20itself.%20It%20was%20a%20good%20idea.%20I%20also%20put%20%26quot%3BOS%20X%26quot%3B%20in%20the%20headline.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1986489","item_id":"_comm_1986489"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1986489#respond' data-commentid="1986489" data-postid="247778" data-belowelement="div-comment-1986489" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-1984957" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-1984957" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/ba5af5791de0a02f88677808f4e62b07?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ba5af5791de0a02f88677808f4e62b07?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Antoine Bajolet</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1984957"><time datetime="2014-02-24T16:05:46+00:00">February 24, 2014 at 4:05 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>With an old background of software coding, this kind of code mistake is easily avoided by expicitely write all braces in conditional tests or loops</p>
<p>If instead :</p>
<pre>
if ((err = SSLHashSHA1.update(...)) != 0)
    goto fail;
    goto fail;
</pre>
<p>It was writen :</p>
<pre>
if ((err = SSLHashSHA1.update(...)) != 0) {
    goto fail;
    goto fail;
}
</pre>
<p>It would be dead code, but no bug.</p>
<p>In terms of code reliability or security, short notations are *always* a bad idea.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1984957"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1984957={"id":7238218,"unique_id":"wp-comment-1984957","title":"With%20an%20old%20background%20of%20software%20coding%2C%20this%20kind%20of%20code%20mistake%20is%20easily%20avoided%20by%20expicitely%20write%20all%20braces%20in%20conditional%20tests%20or%20loopsIf%20instead%20%3A%26lt%3Bpre%26gt%3Bif%20%28%28err%20%3D%20SSLHashSHA1.update%28.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1984957","item_id":"_comm_1984957"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1984957#respond' data-commentid="1984957" data-postid="247778" data-belowelement="div-comment-1984957" data-respondelement="respond" data-replyto="Reply to Antoine Bajolet" aria-label='Reply to Antoine Bajolet'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1994311" class="comment even depth-2">
			<article id="div-comment-1994311" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/fee3ec04e4a3777d42d86df719d688f9?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/fee3ec04e4a3777d42d86df719d688f9?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">m</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1994311"><time datetime="2014-02-25T13:20:33+00:00">February 25, 2014 at 1:20 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Even more: That label &#8216;fail&#8217; should not have been called that, if jumping through it can proceed successfully. The name &#8216;fail&#8217; wrongly suggests that<br />
any jump there would raise a failure. Sure, the second goto would still have been an error if jumping to &#8216;fail&#8217; always ended in an error being raised/processing stopped, but the result would not have been as bad (and likely been found much earlier).</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1994311"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1994311={"id":7238218,"unique_id":"wp-comment-1994311","title":"Even%20more%3A%20That%20label%20%26%23039%3Bfail%26%23039%3B%20should%20not%20have%20been%20called%20that%2C%20if%20jumping%20through%20it%20can%20proceed%20successfully.%20The%20name%20%26%23039%3Bfail%26%23039%3B%20wrongly%20suggests%20thatany%20jump%20there%20would%20raise%20a%20failure.%20Sure%2C%20the%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1994311","item_id":"_comm_1994311"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1994311#respond' data-commentid="1994311" data-postid="247778" data-belowelement="div-comment-1994311" data-respondelement="respond" data-replyto="Reply to m" aria-label='Reply to m'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-1986302" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-1986302" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/386da59eb0cfd118e904d0cdbce1a694?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/386da59eb0cfd118e904d0cdbce1a694?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Vito</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1986302"><time datetime="2014-02-24T20:09:00+00:00">February 24, 2014 at 8:09 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>&#8220;An attacker now has a way to trick users of OS X 10.9 into accepting SSL/TLS certificates that ought to be rejected&#8230;&#8221;</p>
<p>The mention of *only* OS X 10.9 causes me to infer that other versions of OS X are not affected, but the article (excellent, by the way) doesn&#8217;t say so explicitly. Is it indeed true that only OS X 10.9 is vulnerable on non-iOS systems?</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1986302"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1986302={"id":7238218,"unique_id":"wp-comment-1986302","title":"%26quot%3BAn%20attacker%20now%20has%20a%20way%20to%20trick%20users%20of%20OS%20X%2010.9%20into%20accepting%20SSL%2FTLS%20certificates%20that%20ought%20to%20be%20rejected...%26quot%3BThe%20mention%20of%20%2Aonly%2A%20OS%20X%2010.9%20causes%20me%20to%20infer%20that%20other%20versions%20of%20O%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1986302","item_id":"_comm_1986302"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1986302#respond' data-commentid="1986302" data-postid="247778" data-belowelement="div-comment-1986302" data-respondelement="respond" data-replyto="Reply to Vito" aria-label='Reply to Vito'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1986458" class="comment byuser comment-author-pducklin bypostauthor even depth-2 parent">
			<article id="div-comment-1986458" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1986458"><time datetime="2014-02-24T20:36:06+00:00">February 24, 2014 at 8:36 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Errrr, I have to admit &#8211; I don&#8217;t know. </p>
<p>Perhaps a reader who is running the last version of 10.8 that came out can use &#8220;otool&#8221; on his or her copy of:</p>
<p>/System/Library/Frameworks/Security.framework/Versions/Current/Security </p>
<p>and see what version it is? Then we can check that version in Apple&#8217;s source code repository and we shall know if it has this bug or not.</p>
<p>The reason I didn&#8217;t mention 10.8 is that Apple no longer supports it. At least from a security point of view: if you are still running 10.8, you have *much* more to worry about that this bug. </p>
<p>You know how XP will fall off a cliff in April after its last update? That&#8217;s what already happened to 10.8 after Mavericks came out&#8230;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1986458"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1986458={"id":7238218,"unique_id":"wp-comment-1986458","title":"Errrr%2C%20I%20have%20to%20admit%20-%20I%20don%26%23039%3Bt%20know.%20Perhaps%20a%20reader%20who%20is%20running%20the%20last%20version%20of%2010.8%20that%20came%20out%20can%20use%20%26quot%3Botool%26quot%3B%20on%20his%20or%20her%20copy%20of%3A%2FSystem%2FLibrary%2FFrameworks%2FSecurity.framework%2FV%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1986458","item_id":"_comm_1986458"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1986458#respond' data-commentid="1986458" data-postid="247778" data-belowelement="div-comment-1986458" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1995746" class="comment odd alt depth-3 parent">
			<article id="div-comment-1995746" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/386da59eb0cfd118e904d0cdbce1a694?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/386da59eb0cfd118e904d0cdbce1a694?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Vito</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1995746"><time datetime="2014-02-25T16:31:33+00:00">February 25, 2014 at 4:31 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Alas, it appears that otool doesn&#8217;t exist in Mountain Lion. (I’m running OS X 10.8.5.) Here&#8217;s what happened when I tried it:</p>
<p>$ otool -L /System/Library/Frameworks/Security.framework/Versions/Current/Security<br />
-bash: otool: command not found</p>
<p>I found a post on StackExchange stating that in Mountain Lion Apple moved the command line utilities. They have to be installed from inside Xcode (a 2.04 GB download). Fortunately, they can also be downloaded and installed separately. They’re available as a separate 96.50 MB package called “Command Line Tools (OS X Mountain Lion) for Xcode &#8211; October 2013” at the following URL:</p>
<p>https://developer.apple.com/downloads/index.action (Apple Developer account needed)</p>
<p>After installing the Command Line Tools, I get the following result:</p>
<p>$ otool -L /System/Library/Frameworks/Security.framework/Versions/Current/Security<br />
/System/Library/Frameworks/Security.framework/Versions/Current/Security:<br />
	/System/Library/Frameworks/Security.framework/Versions/A/Security (compatibility version 1.0.0, current version 55179.13.0)<br />
	/usr/lib/system/libcorecrypto.dylib (compatibility version 1.0.0, current version 1.0.0)<br />
	/usr/lib/libbsm.0.dylib (compatibility version 1.0.0, current version 1.0.0)<br />
	/usr/lib/libobjc.A.dylib (compatibility version 1.0.0, current version 228.0.0)<br />
	/usr/lib/libauto.dylib (compatibility version 1.0.0, current version 1.0.0)<br />
	/usr/lib/libxar.1.dylib (compatibility version 1.0.0, current version 1.0.0)<br />
	/usr/lib/libz.1.dylib (compatibility version 1.0.0, current version 1.2.5)<br />
	/usr/lib/libstdc++.6.dylib (compatibility version 7.0.0, current version 56.0.0)<br />
	/usr/lib/libsqlite3.dylib (compatibility version 9.0.0, current version 9.6.0)<br />
	/usr/lib/libpam.2.dylib (compatibility version 3.0.0, current version 3.0.0)<br />
	/System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation (compatibility version 150.0.0, current version 744.19.0)<br />
	/usr/lib/libOpenScriptingUtil.dylib (compatibility version 1.0.0, current version 1.0.0)<br />
	/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 169.3.0)</p>
<p>My ability to interpret the result is approximately zero, but there it is.<br />
___</p>
<p>I wasn’t aware that it had become “official” that Apple no longer supports Mountain Lion, but then I suppose it’s typical that they’d make no formal announcement. If they did, I missed it.</p>
<p>Anyhow, some of us don’t have the option of using Mavericks&#8230;at least not yet. For my part, I run many applications and plugins that Mavericks has broken. In fact, I only recently “upgraded” (I use the term metaphorically) from Snow Leopard where everything worked perfectly&#8230;er, except continuing support for that version of OS X. (sigh) </p>
<p>I suppose that eventually everything will work in Mavericks, but until then Apple has forced users like me to make a choice between security and productivity. (I believe the technical description for that condition is, “It sucks.”) </p>
<p>In the meantime, staying productive is not optional. All I can do is keep everything else patched and updated, run Sophos AntiVirus for Mac, follow the advice I read in NakedSecurity, back up regularly, and otherwise follow best security practices.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1995746"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1995746={"id":7238218,"unique_id":"wp-comment-1995746","title":"Alas%2C%20it%20appears%20that%20otool%20doesn%26%23039%3Bt%20exist%20in%20Mountain%20Lion.%20%28Im%20running%20OS%20X%2010.8.5.%29%20Here%26%23039%3Bs%20what%20happened%20when%20I%20tried%20it%3A%24%20otool%20-L%20%2FSystem%2FLibrary%2FFrameworks%2FSecurity.framework%2FVersions%2FCurren%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1995746","item_id":"_comm_1995746"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1995746#respond' data-commentid="1995746" data-postid="247778" data-belowelement="div-comment-1995746" data-respondelement="respond" data-replyto="Reply to Vito" aria-label='Reply to Vito'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1998441" class="comment byuser comment-author-pducklin bypostauthor even depth-4">
			<article id="div-comment-1998441" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1998441"><time datetime="2014-02-26T00:12:13+00:00">February 26, 2014 at 12:12 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Looks like they just &#8220;announced&#8221; support for ML by publishing a security update for it. Better late than never.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1998441"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1998441={"id":7238218,"unique_id":"wp-comment-1998441","title":"Looks%20like%20they%20just%20%26quot%3Bannounced%26quot%3B%20support%20for%20ML%20by%20publishing%20a%20security%20update%20for%20it.%20Better%20late%20than%20never.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1998441","item_id":"_comm_1998441"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1998441#respond' data-commentid="1998441" data-postid="247778" data-belowelement="div-comment-1998441" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-1996089" class="comment odd alt depth-3 parent">
			<article id="div-comment-1996089" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/4a3c45bfa4a1ba2673124653e867d68e?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4a3c45bfa4a1ba2673124653e867d68e?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Tim Klein</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1996089"><time datetime="2014-02-25T17:23:37+00:00">February 25, 2014 at 5:23 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>From my Mac running 10.8.5, here&#8217;s the output of otool -L:</p>
<p>	/System/Library/Frameworks/Security.framework/Versions/A/Security (compatibility version 1.0.0, current version 55179.13.0)<br />
	/usr/lib/system/libcorecrypto.dylib (compatibility version 1.0.0, current version 1.0.0)<br />
	/usr/lib/libbsm.0.dylib (compatibility version 1.0.0, current version 1.0.0)<br />
	/usr/lib/libobjc.A.dylib (compatibility version 1.0.0, current version 228.0.0)<br />
	/usr/lib/libauto.dylib (compatibility version 1.0.0, current version 1.0.0)<br />
	/usr/lib/libxar.1.dylib (compatibility version 1.0.0, current version 1.0.0)<br />
	/usr/lib/libz.1.dylib (compatibility version 1.0.0, current version 1.2.5)<br />
	/usr/lib/libstdc++.6.dylib (compatibility version 7.0.0, current version 56.0.0)<br />
	/usr/lib/libsqlite3.dylib (compatibility version 9.0.0, current version 9.6.0)<br />
	/usr/lib/libpam.2.dylib (compatibility version 3.0.0, current version 3.0.0)<br />
	/System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation (compatibility version 150.0.0, current version 744.19.0)<br />
	/usr/lib/libOpenScriptingUtil.dylib (compatibility version 1.0.0, current version 1.0.0)<br />
	/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 169.3.0)</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1996089"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1996089={"id":7238218,"unique_id":"wp-comment-1996089","title":"From%20my%20Mac%20running%2010.8.5%2C%20here%26%23039%3Bs%20the%20output%20of%20otool%20-L%3A%2FSystem%2FLibrary%2FFrameworks%2FSecurity.framework%2FVersions%2FA%2FSecurity%20%28compatibility%20version%201.0.0%2C%20current%20version%2055179.13.0%29%2Fusr%2Flib%2Fsyste%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1996089","item_id":"_comm_1996089"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1996089#respond' data-commentid="1996089" data-postid="247778" data-belowelement="div-comment-1996089" data-respondelement="respond" data-replyto="Reply to Tim Klein" aria-label='Reply to Tim Klein'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1998427" class="comment byuser comment-author-pducklin bypostauthor even depth-4">
			<article id="div-comment-1998427" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1998427"><time datetime="2014-02-26T00:10:43+00:00">February 26, 2014 at 12:10 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Looks like you&#8217;re in the clear &#8211; though Apple just published an update for you anyway. (About time!)</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1998427"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1998427={"id":7238218,"unique_id":"wp-comment-1998427","title":"Looks%20like%20you%26%23039%3Bre%20in%20the%20clear%20-%20though%20Apple%20just%20published%20an%20update%20for%20you%20anyway.%20%28About%20time%21%29%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1998427","item_id":"_comm_1998427"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1998427#respond' data-commentid="1998427" data-postid="247778" data-belowelement="div-comment-1998427" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-1997375" class="comment odd alt depth-3 parent">
			<article id="div-comment-1997375" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/386da59eb0cfd118e904d0cdbce1a694?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/386da59eb0cfd118e904d0cdbce1a694?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Vito</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1997375"><time datetime="2014-02-25T20:57:34+00:00">February 25, 2014 at 8:57 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Update: 2014-02-25</p>
<p>I&#8217;ve found a couple of sources (on ZDNet) that claim the vulnerability is NOT present in OS X 10.8.5, or in versions of iOS earlier than v6.</p>
<p>Reportedly, OS X Update 10.9.2 (released today, 2014-02-25) fixes the problem, although Apple&#8217;s own Knowledge Base article on the 10.9.2 update (http://support.apple.com/kb/HT6114) makes no mention of it.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1997375"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1997375={"id":7238218,"unique_id":"wp-comment-1997375","title":"Update%3A%202014-02-25I%26%23039%3Bve%20found%20a%20couple%20of%20sources%20%28on%20ZDNet%29%20that%20claim%20the%20vulnerability%20is%20NOT%20present%20in%20OS%20X%2010.8.5%2C%20or%20in%20versions%20of%20iOS%20earlier%20than%20v6.Reportedly%2C%20OS%20X%20Update%2010.9.2%20%28relea%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1997375","item_id":"_comm_1997375"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1997375#respond' data-commentid="1997375" data-postid="247778" data-belowelement="div-comment-1997375" data-respondelement="respond" data-replyto="Reply to Vito" aria-label='Reply to Vito'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1998401" class="comment byuser comment-author-pducklin bypostauthor even depth-4">
			<article id="div-comment-1998401" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1998401"><time datetime="2014-02-26T00:07:06+00:00">February 26, 2014 at 12:07 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I&#8217;m writing that up as we speak (2014-02-26T00:05Z) &#8211; the Combo Update download page, which I used to download the update for my own use, does mention that the &#8220;SSL cert validation&#8221; problem is gone.</p>
<p>And I decompiled the SecurityTransport library again *after* updating &#8211; the code looks right now. (The call to sslRawVerify() is there!)</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1998401"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1998401={"id":7238218,"unique_id":"wp-comment-1998401","title":"I%26%23039%3Bm%20writing%20that%20up%20as%20we%20speak%20%282014-02-26T00%3A05Z%29%20-%20the%20Combo%20Update%20download%20page%2C%20which%20I%20used%20to%20download%20the%20update%20for%20my%20own%20use%2C%20does%20mention%20that%20the%20%26quot%3BSSL%20cert%20validation%26quot%3B%20problem%20is%20go%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1998401","item_id":"_comm_1998401"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1998401#respond' data-commentid="1998401" data-postid="247778" data-belowelement="div-comment-1998401" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-1997664" class="comment odd alt depth-3 parent">
			<article id="div-comment-1997664" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/386da59eb0cfd118e904d0cdbce1a694?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/386da59eb0cfd118e904d0cdbce1a694?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Vito</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1997664"><time datetime="2014-02-25T21:51:24+00:00">February 25, 2014 at 9:51 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Another update: 2014-02-25</p>
<p>Folks who are still using Lion or Mountain Lion will be relieved to know that Apple evidently has NOT dropped support for those earlier versions of OS X. There are new 2014-001 security updates for OS X 10.7 and 10.8 on the Apple Downloads page as of today:</p>
<p>http://support.apple.com/downloads/</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1997664"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1997664={"id":7238218,"unique_id":"wp-comment-1997664","title":"Another%20update%3A%202014-02-25Folks%20who%20are%20still%20using%20Lion%20or%20Mountain%20Lion%20will%20be%20relieved%20to%20know%20that%20Apple%20evidently%20has%20NOT%20dropped%20support%20for%20those%20earlier%20versions%20of%20OS%20X.%20There%20are%20new%202%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1997664","item_id":"_comm_1997664"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1997664#respond' data-commentid="1997664" data-postid="247778" data-belowelement="div-comment-1997664" data-respondelement="respond" data-replyto="Reply to Vito" aria-label='Reply to Vito'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1998382" class="comment byuser comment-author-pducklin bypostauthor even depth-4 parent">
			<article id="div-comment-1998382" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1998382"><time datetime="2014-02-26T00:04:47+00:00">February 26, 2014 at 12:04 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>True! Strange way to announce continued support, but there you have it&#8230;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1998382"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1998382={"id":7238218,"unique_id":"wp-comment-1998382","title":"True%21%20Strange%20way%20to%20announce%20continued%20support%2C%20but%20there%20you%20have%20it...%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1998382","item_id":"_comm_1998382"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1998382#respond' data-commentid="1998382" data-postid="247778" data-belowelement="div-comment-1998382" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-2006036" class="comment odd alt depth-5 parent">
			<article id="div-comment-2006036" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/386da59eb0cfd118e904d0cdbce1a694?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/386da59eb0cfd118e904d0cdbce1a694?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Vito</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-2006036"><time datetime="2014-02-26T17:48:53+00:00">February 26, 2014 at 5:48 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>&#8220;Strange way to announce continued support&#8230;&#8221;</p>
<p>That line gave me a cynical chuckle. You&#8217;d think the norm would be that continued support would be a given until there&#8217;s an explicit announcement that support for an OS will be DIScontinued. But no. &#8220;Hey&#8230;it&#8217;s Apple!&#8221; might well be a metaphor for the unexpected. 😉</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_2006036"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_2006036={"id":7238218,"unique_id":"wp-comment-2006036","title":"%26quot%3BStrange%20way%20to%20announce%20continued%20support...%26quot%3BThat%20line%20gave%20me%20a%20cynical%20chuckle.%20You%26%23039%3Bd%20think%20the%20norm%20would%20be%20that%20continued%20support%20would%20be%20a%20given%20until%20there%26%23039%3Bs%20an%20explicit%20announcement%20tha%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-2006036","item_id":"_comm_2006036"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=2006036#respond' data-commentid="2006036" data-postid="247778" data-belowelement="div-comment-2006036" data-respondelement="respond" data-replyto="Reply to Vito" aria-label='Reply to Vito'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-2006599" class="comment byuser comment-author-pducklin bypostauthor even depth-6">
			<article id="div-comment-2006599" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-2006599"><time datetime="2014-02-26T19:27:58+00:00">February 26, 2014 at 7:27 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>There was no 10.8 or 10.7 update when 10.9.1 came out, and when lots of people wondered what that implied, Apple hid behind the &#8220;we don&#8217;t comment on security unless we just published an update.&#8221;</p>
<p>In my book, if people openly ask, &#8220;Will there be any more security updates&#8221; and you don&#8217;t even say, &#8220;Unknown at this stage,&#8221; then those asking should take that as a &#8220;No&#8221;.</p>
<p>Until the 2014-001 updates yesterday, Lion and Mountain Lion users had both absence of evidence *and* evidence of absence of continued support 🙂</p>
<p>(Why you wouldn&#8217;t want to upgrade to Mavericks is a giant mystery to me. I sort of understand the people who say, &#8220;The update broke my legacy software,&#8221; but they might as well say, &#8220;My legacy software is holding me back. Time to find something new.&#8221; I had two apps that wouldn&#8217;t work in Mavericks, IIRC one paid and one free. I binned them and in a well-spent hour, found free replacements that were smaller, faster, better &#8211; result! 🙂</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_2006599"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_2006599={"id":7238218,"unique_id":"wp-comment-2006599","title":"There%20was%20no%2010.8%20or%2010.7%20update%20when%2010.9.1%20came%20out%2C%20and%20when%20lots%20of%20people%20wondered%20what%20that%20implied%2C%20Apple%20hid%20behind%20the%20%26quot%3Bwe%20don%26%23039%3Bt%20comment%20on%20security%20unless%20we%20just%20published%20an%20update.%26quot%3BI%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-2006599","item_id":"_comm_2006599"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=2006599#respond' data-commentid="2006599" data-postid="247778" data-belowelement="div-comment-2006599" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-1986836" class="comment odd alt thread-even depth-1">
			<article id="div-comment-1986836" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/7a96a6c2eb17f497656b2c7ab4921e65?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7a96a6c2eb17f497656b2c7ab4921e65?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Huub</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1986836"><time datetime="2014-02-24T21:47:01+00:00">February 24, 2014 at 9:47 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I would be interested in peek into the version control system: who was the first to check in the code version with the double goto? when?&#8230;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1986836"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1986836={"id":7238218,"unique_id":"wp-comment-1986836","title":"I%20would%20be%20interested%20in%20peek%20into%20the%20version%20control%20system%3A%20who%20was%20the%20first%20to%20check%20in%20the%20code%20version%20with%20the%20double%20goto%3F%20when%3F...%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1986836","item_id":"_comm_1986836"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1986836#respond' data-commentid="1986836" data-postid="247778" data-belowelement="div-comment-1986836" data-respondelement="respond" data-replyto="Reply to Huub" aria-label='Reply to Huub'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-1987098" class="comment even thread-odd thread-alt depth-1 parent">
			<article id="div-comment-1987098" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/c6217f85c61cd9a1da7a6c5b690ea022?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c6217f85c61cd9a1da7a6c5b690ea022?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Cuba Roger</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1987098"><time datetime="2014-02-24T22:37:38+00:00">February 24, 2014 at 10:37 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Could there be a missing, obsolete<br />
&#8221; if ((err =&#8230;. &#8221;<br />
between the two goto fail:&#8217;s? So the programmer deleted one line instead of two. That would be a more likely mistake to make.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1987098"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1987098={"id":7238218,"unique_id":"wp-comment-1987098","title":"Could%20there%20be%20a%20missing%2C%20obsolete%26quot%3B%20if%20%28%28err%20%3D....%20%26quot%3Bbetween%20the%20two%20goto%20fail%3A%26%23039%3Bs%3F%20So%20the%20programmer%20deleted%20one%20line%20instead%20of%20two.%20That%20would%20be%20a%20more%20likely%20mistake%20to%20make.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1987098","item_id":"_comm_1987098"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1987098#respond' data-commentid="1987098" data-postid="247778" data-belowelement="div-comment-1987098" data-respondelement="respond" data-replyto="Reply to Cuba Roger" aria-label='Reply to Cuba Roger'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1992388" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2">
			<article id="div-comment-1992388" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1992388"><time datetime="2014-02-25T09:19:05+00:00">February 25, 2014 at 9:19 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Good reason to use squiggly brackets (a.k.a. braces) if so 🙂</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1992388"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1992388={"id":7238218,"unique_id":"wp-comment-1992388","title":"Good%20reason%20to%20use%20squiggly%20brackets%20%28a.k.a.%20braces%29%20if%20so%20%3A-%29%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1992388","item_id":"_comm_1992388"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1992388#respond' data-commentid="1992388" data-postid="247778" data-belowelement="div-comment-1992388" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-1990713" class="comment even thread-even depth-1 parent">
			<article id="div-comment-1990713" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/d331ff248ec639a38aedfa2d67a0b83f?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d331ff248ec639a38aedfa2d67a0b83f?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Patrick</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1990713"><time datetime="2014-02-25T05:48:52+00:00">February 25, 2014 at 5:48 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I just don&#8217;t understand it&#8230;</p>
<p>I get that the IF triggers the first &#8220;goto fail&#8221; which only happens when an error in the validation process occurs. But the second &#8220;goto fail&#8221; is always exectuted because it&#8217;s not part of the IF anymore.</p>
<p>But why doesn&#8217;t it always see the certificate as invalid? I mean, it ALWAYS skips to the fail part. Fail = Website not valid.<br />
 I don&#8217;t understand that part&#8230;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1990713"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1990713={"id":7238218,"unique_id":"wp-comment-1990713","title":"I%20just%20don%26%23039%3Bt%20understand%20it...I%20get%20that%20the%20IF%20triggers%20the%20first%20%26quot%3Bgoto%20fail%26quot%3B%20which%20only%20happens%20when%20an%20error%20in%20the%20validation%20process%20occurs.%20But%20the%20second%20%26quot%3Bgoto%20fail%26quot%3B%20is%20always%20exectuted%20bec%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1990713","item_id":"_comm_1990713"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1990713#respond' data-commentid="1990713" data-postid="247778" data-belowelement="div-comment-1990713" data-respondelement="respond" data-replyto="Reply to Patrick" aria-label='Reply to Patrick'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1992356" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2 parent">
			<article id="div-comment-1992356" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1992356"><time datetime="2014-02-25T09:15:08+00:00">February 25, 2014 at 9:15 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>It&#8217;s explained in the article (and the coding style is touched on in one of the comments). Sadly, &#8220;goto fail&#8221; doesn&#8217;t mean &#8220;the website is invalid.&#8221; It means simply &#8220;exit early, returning whatever error code you have in the variable err right now&#8221;.</p>
<p>In other words, the way the code is written, &#8220;goto fail&#8221; only causes the function to report the certificate as invalid *if the value of err is non-zero*.</p>
<p>So if you inadvertently &#8220;goto fail&#8221; when there hasn&#8217;t just been an error, you end up skipping over the validation function, but returning zero (i.e. reporting success) anyway.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1992356"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1992356={"id":7238218,"unique_id":"wp-comment-1992356","title":"It%26%23039%3Bs%20explained%20in%20the%20article%20%28and%20the%20coding%20style%20is%20touched%20on%20in%20one%20of%20the%20comments%29.%20Sadly%2C%20%26quot%3Bgoto%20fail%26quot%3B%20doesn%26%23039%3Bt%20mean%20%26quot%3Bthe%20website%20is%20invalid.%26quot%3B%20It%20means%20simply%20%26quot%3Bexit%20early%2C%20returning%20whateve%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1992356","item_id":"_comm_1992356"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1992356#respond' data-commentid="1992356" data-postid="247778" data-belowelement="div-comment-1992356" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1994332" class="comment even depth-3 parent">
			<article id="div-comment-1994332" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/fee3ec04e4a3777d42d86df719d688f9?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/fee3ec04e4a3777d42d86df719d688f9?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">m</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1994332"><time datetime="2014-02-25T13:23:31+00:00">February 25, 2014 at 1:23 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>and which is why that label is wrongly named, contributing to the bug.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1994332"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1994332={"id":7238218,"unique_id":"wp-comment-1994332","title":"and%20which%20is%20why%20that%20label%20is%20wrongly%20named%2C%20contributing%20to%20the%20bug.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1994332","item_id":"_comm_1994332"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1994332#respond' data-commentid="1994332" data-postid="247778" data-belowelement="div-comment-1994332" data-respondelement="respond" data-replyto="Reply to m" aria-label='Reply to m'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1994952" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-4">
			<article id="div-comment-1994952" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1994952"><time datetime="2014-02-25T14:56:12+00:00">February 25, 2014 at 2:56 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Agreed. It makes those &#8220;goto fails&#8221; feel as though the worst they can do is to reject a good certificate (fail closed), not to let a crook do his worst (fail open). </p>
<p>Identifier names in code shouldn&#8217;t influence code reviewers&#8230;but they do.</p>
<p>Ironically, perhaps (check the linked-to Patch article) the bug is actually more obvious in the decompiled assembler code than in the C source.</p>
<p>The compiler has noticed that the code turns into:</p>
<pre>
if true then fail else verify end
</pre>
<p>and so the conditional jump to fail actually vanishes, and so &#8211; rather obviously &#8211; does the call to sslRawVerify().</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1994952"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1994952={"id":7238218,"unique_id":"wp-comment-1994952","title":"Agreed.%20It%20makes%20those%20%26quot%3Bgoto%20fails%26quot%3B%20feel%20as%20though%20the%20worst%20they%20can%20do%20is%20to%20reject%20a%20good%20certificate%20%28fail%20closed%29%2C%20not%20to%20let%20a%20crook%20do%20his%20worst%20%28fail%20open%29.%20Identifier%20names%20in%20code%20shoul%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1994952","item_id":"_comm_1994952"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1994952#respond' data-commentid="1994952" data-postid="247778" data-belowelement="div-comment-1994952" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-1994446" class="comment even thread-odd thread-alt depth-1 parent">
			<article id="div-comment-1994446" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/ceea82f0fb21cc9662340699da9bd3ac?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ceea82f0fb21cc9662340699da9bd3ac?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">blake</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1994446"><time datetime="2014-02-25T13:45:37+00:00">February 25, 2014 at 1:45 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>This may be appropriate 🙂   http://xkcd.com/292/</p>
<p>I remember my college C programming lessons from long ago (20+ years). You would get severely marked down at the slightest hint of a goto in your code&#8230;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1994446"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1994446={"id":7238218,"unique_id":"wp-comment-1994446","title":"This%20may%20be%20appropriate%20%3A%29%20%20%20http%3A%2F%2Fxkcd.com%2F292%2FI%20remember%20my%20college%20C%20programming%20lessons%20from%20long%20ago%20%2820%2B%20years%29.%20You%20would%20get%20severely%20marked%20down%20at%20the%20slightest%20hint%20of%20a%20goto%20in%20your%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1994446","item_id":"_comm_1994446"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1994446#respond' data-commentid="1994446" data-postid="247778" data-belowelement="div-comment-1994446" data-respondelement="respond" data-replyto="Reply to blake" aria-label='Reply to blake'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1994961" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2 parent">
			<article id="div-comment-1994961" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1994961"><time datetime="2014-02-25T14:57:07+00:00">February 25, 2014 at 2:57 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Gotos can be very useful for &#8220;bail on error&#8221; in C. (Sort of home-made finalisation.)</p>
<p>Problem here is that the label &#8220;fail&#8221; *isn&#8217;t*. You can reach &#8220;fail&#8221; and still return success. Bloke could have coded it differently, not least because &#8220;goto fail&#8221; implies a fail-safety that doesn&#8217;t exist. See comments from @m above&#8230;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1994961"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1994961={"id":7238218,"unique_id":"wp-comment-1994961","title":"Gotos%20can%20be%20very%20useful%20for%20%26quot%3Bbail%20on%20error%26quot%3B%20in%20C.%20%28Sort%20of%20home-made%20finalisation.%29Problem%20here%20is%20that%20the%20label%20%26quot%3Bfail%26quot%3B%20%2Aisn%26%23039%3Bt%2A.%20You%20can%20reach%20%26quot%3Bfail%26quot%3B%20and%20still%20return%20success.%20Bloke%20could%20have%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1994961","item_id":"_comm_1994961"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1994961#respond' data-commentid="1994961" data-postid="247778" data-belowelement="div-comment-1994961" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1995221" class="comment byuser comment-author-pducklin bypostauthor even depth-3">
			<article id="div-comment-1995221" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1995221"><time datetime="2014-02-25T15:31:03+00:00">February 25, 2014 at 3:31 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I mean something like this:</p>
<pre>
  int retval = ERR_CODEBUG;
  . . .
  if (error1()) {
      retval = ERR_HASHBROKE;
      goto finish;
   }
   if (error2()) {
      retval = ERR_VERIFYFAIL;
      goto finish;
   }
   . . .
   /* By this point, everything worked */
allgood:
   retval = ERR_NONE; /* Only place for this */
   goto finish;

finish:
   cleanupA();
   cleanupB();
   . . .
   return retval;
</pre>
<p>I would put that redundant final &#8220;goto finish&#8221; in, too 🙂</p>
<p>This style also forces you to map the error codes returned along the way (&#8220;err&#8221; in the article example) into your own set of legal &#8220;retval&#8221; values before doing the &#8220;goto finish&#8221;, thus avoiding potential ambiguity &#8211; does a final return value of &#8220;2&#8221; mean &#8220;network socket timeout error&#8221; from the networking library, or &#8220;hash function ran out of memory&#8221; from the crypto library?</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1995221"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1995221={"id":7238218,"unique_id":"wp-comment-1995221","title":"I%20mean%20something%20like%20this%3A%26lt%3Bpre%26gt%3B%20%20int%20retval%20%3D%20ERR_CODEBUG%3B%20%20.%20.%20.%20%20if%20%28error1%28%29%29%20%7B%20%20%20%20%20%20retval%20%3D%20ERR_HASHBROKE%3B%20%20%20%20%20%20goto%20finish%3B%20%20%20%7D%20%20%20if%20%28error2%28%29%29%20%7B%20%20%20%20%20%20retval%20%3D%20ERR_VERIFYFAIL%3B%20%20%20%20%20%20goto%20fi%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1995221","item_id":"_comm_1995221"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1995221#respond' data-commentid="1995221" data-postid="247778" data-belowelement="div-comment-1995221" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-1994966" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-1994966" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/1e3690bded8279c047afbb7ab8932ad5?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1e3690bded8279c047afbb7ab8932ad5?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">2072</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1994966"><time datetime="2014-02-25T14:57:57+00:00">February 25, 2014 at 2:57 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Any decent compiler would raise a warning about never executed code here. Though not paying attention to compiler warnings goes along with the coding style of this library&#8230;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1994966"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1994966={"id":7238218,"unique_id":"wp-comment-1994966","title":"Any%20decent%20compiler%20would%20raise%20a%20warning%20about%20never%20executed%20code%20here.%20Though%20not%20paying%20attention%20to%20compiler%20warnings%20goes%20along%20with%20the%20coding%20style%20of%20this%20library...%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1994966","item_id":"_comm_1994966"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1994966#respond' data-commentid="1994966" data-postid="247778" data-belowelement="div-comment-1994966" data-respondelement="respond" data-replyto="Reply to 2072" aria-label='Reply to 2072'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1995156" class="comment byuser comment-author-pducklin bypostauthor even depth-2 parent">
			<article id="div-comment-1995156" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1995156"><time datetime="2014-02-25T15:23:08+00:00">February 25, 2014 at 3:23 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Actually, Adam Langley, the chap who created the handy test site I link to on the Unofficial Patch page [q.v.], tested your assumption and wrote it up. (There&#8217;s a link to his article in this one &#8211; click on the text that says &#8220;soon came to light.&#8221;)</p>
<p>IIRC he found that both the GCC and Clang compilers, when used with -Wall, an option nominally meaning &#8220;turn on all compiler warnings&#8221;, did *not* warn about the dead code. </p>
<p>He reports that you can add -Wunreachable-code to make Clang complain. But if this is an option that isn&#8217;t included by default in &#8220;all warnings&#8221; mode (strange semantics for &#8220;all&#8221; 🙂 then you can imagine that it probably produces sheds full of need-to-be-ignored messages in real life.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1995156"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1995156={"id":7238218,"unique_id":"wp-comment-1995156","title":"Actually%2C%20Adam%20Langley%2C%20the%20chap%20who%20created%20the%20handy%20test%20site%20I%20link%20to%20on%20the%20Unofficial%20Patch%20page%20%26%23091%3Bq.v.%26%23093%3B%2C%20tested%20your%20assumption%20and%20wrote%20it%20up.%20%28There%26%23039%3Bs%20a%20link%20to%20his%20article%20in%20this%20one%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1995156","item_id":"_comm_1995156"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1995156#respond' data-commentid="1995156" data-postid="247778" data-belowelement="div-comment-1995156" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-1996884" class="comment odd alt depth-3">
			<article id="div-comment-1996884" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/1e3690bded8279c047afbb7ab8932ad5?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1e3690bded8279c047afbb7ab8932ad5?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">2072</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1996884"><time datetime="2014-02-25T19:25:34+00:00">February 25, 2014 at 7:25 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks for your answer, it&#8217;s been many years since I coded in C but I remembered getting such warnings myself&#8230; After some research, i found out that GCC&#8217;s team has disabled these warnings because they were &#8220;unstable&#8221;: http://gcc.gnu.org/ml/gcc-help/2011-05/msg00360.html and yielded different warnings depending on the optimisation levels.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1996884"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1996884={"id":7238218,"unique_id":"wp-comment-1996884","title":"Thanks%20for%20your%20answer%2C%20it%26%23039%3Bs%20been%20many%20years%20since%20I%20coded%20in%20C%20but%20I%20remembered%20getting%20such%20warnings%20myself...%20After%20some%20research%2C%20i%20found%20out%20that%20GCC%26%23039%3Bs%20team%20has%20disabled%20these%20warnings%20becau%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1996884","item_id":"_comm_1996884"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1996884#respond' data-commentid="1996884" data-postid="247778" data-belowelement="div-comment-1996884" data-respondelement="respond" data-replyto="Reply to 2072" aria-label='Reply to 2072'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-1999342" class="comment even thread-odd thread-alt depth-1 parent">
			<article id="div-comment-1999342" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/9f5e1d08246d1156bbd0ae3e124a8403?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9f5e1d08246d1156bbd0ae3e124a8403?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">DJ</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-1999342"><time datetime="2014-02-26T01:57:19+00:00">February 26, 2014 at 1:57 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Using a VPN is not going to protect you. The built-in VPN on OS X and iOS uses the same flawed crypto library. On OS X, you can use third-party VPNs which implement their own crypto libraries. Even this does not completely protect you, since someone can still do a man-in-the-middle attack on your VPN endpoint.</p>
<p>On iOS, a VPN will not protect you at all, since all VPNs on iOS are required to use the built-in system libraries (App Store rule). Similarly, Chrome on iOS does not protect you, since all browsers on iOS are required to use the built-in system browser engine.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_1999342"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_1999342={"id":7238218,"unique_id":"wp-comment-1999342","title":"Using%20a%20VPN%20is%20not%20going%20to%20protect%20you.%20The%20built-in%20VPN%20on%20OS%20X%20and%20iOS%20uses%20the%20same%20flawed%20crypto%20library.%20On%20OS%20X%2C%20you%20can%20use%20third-party%20VPNs%20which%20implement%20their%20own%20crypto%20libraries.%20Ev%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-1999342","item_id":"_comm_1999342"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=1999342#respond' data-commentid="1999342" data-postid="247778" data-belowelement="div-comment-1999342" data-respondelement="respond" data-replyto="Reply to DJ" aria-label='Reply to DJ'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-2001860" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2">
			<article id="div-comment-2001860" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-2001860"><time datetime="2014-02-26T07:20:26+00:00">February 26, 2014 at 7:20 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I probably should have said, &#8220;Not using the built-in VPN.&#8221; Sorry. </p>
<p>And although it is true that &#8220;someone can still do a man-in-the-middle attack on your VPN&#8221; if you avoid the OS X one, that&#8217;s a truism&#8230;but they&#8217;d need some other way (not this flaw) to achive that result.</p>
<p>As for subverting iOS with this flaw &#8211; iOS was already patched when I wrote this article. That&#8217;s why it&#8217;s about securing OS X, which wasn&#8217;t patched when I wrote the piece.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_2001860"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_2001860={"id":7238218,"unique_id":"wp-comment-2001860","title":"I%20probably%20should%20have%20said%2C%20%26quot%3BNot%20using%20the%20built-in%20VPN.%26quot%3B%20Sorry.%20And%20although%20it%20is%20true%20that%20%26quot%3Bsomeone%20can%20still%20do%20a%20man-in-the-middle%20attack%20on%20your%20VPN%26quot%3B%20if%20you%20avoid%20the%20OS%20X%20one%2C%20that%26%23039%3Bs%20a%20tr%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-2001860","item_id":"_comm_2001860"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=2001860#respond' data-commentid="2001860" data-postid="247778" data-belowelement="div-comment-2001860" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-2001039" class="comment even thread-even depth-1 parent">
			<article id="div-comment-2001039" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/d556b7004db2a250a9397331fba5f1b6?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d556b7004db2a250a9397331fba5f1b6?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">JK</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-2001039"><time datetime="2014-02-26T05:21:19+00:00">February 26, 2014 at 5:21 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Is this Apple&#8217;s way of absolutely making me update to IOS7&#8230;..I have been holding off updating from 6 my iPhone 5 and I really dislike the new look and feel of 7&#8230;&#8230;Just sayin&#8217;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_2001039"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_2001039={"id":7238218,"unique_id":"wp-comment-2001039","title":"Is%20this%20Apple%26%23039%3Bs%20way%20of%20absolutely%20making%20me%20update%20to%20IOS7.....I%20have%20been%20holding%20off%20updating%20from%206%20my%20iPhone%205%20and%20I%20really%20dislike%20the%20new%20look%20and%20feel%20of%207......Just%20sayin%26%23039%3B%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-2001039","item_id":"_comm_2001039"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=2001039#respond' data-commentid="2001039" data-postid="247778" data-belowelement="div-comment-2001039" data-respondelement="respond" data-replyto="Reply to JK" aria-label='Reply to JK'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-2001837" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2 parent">
			<article id="div-comment-2001837" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-2001837"><time datetime="2014-02-26T07:12:37+00:00">February 26, 2014 at 7:12 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>There is an update for iOS 6 as well. </p>
<p>Head to the HT1222 page: http://support.apple.com/kb/HT1222</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_2001837"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_2001837={"id":7238218,"unique_id":"wp-comment-2001837","title":"There%20is%20an%20update%20for%20iOS%206%20as%20well.%20Head%20to%20the%20HT1222%20page%3A%20http%3A%2F%2Fsupport.apple.com%2Fkb%2FHT1222%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-2001837","item_id":"_comm_2001837"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=2001837#respond' data-commentid="2001837" data-postid="247778" data-belowelement="div-comment-2001837" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-2006282" class="comment even depth-3">
			<article id="div-comment-2006282" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/b066dc49998f4ce48e993131f620009e?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b066dc49998f4ce48e993131f620009e?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">John Smith</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-2006282"><time datetime="2014-02-26T18:35:08+00:00">February 26, 2014 at 6:35 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Unfortunately if he has an iPhone 5 it will update to IOS 7.0.4 </p>
<p>Only choice is downgrade from IOS 6 to IOS 7 &#8230; or live with unpatched SSL risk.</p>
<p>Love to hear if anyone has a third option.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_2006282"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_2006282={"id":7238218,"unique_id":"wp-comment-2006282","title":"Unfortunately%20if%20he%20has%20an%20iPhone%205%20it%20will%20update%20to%20IOS%207.0.4%20Only%20choice%20is%20downgrade%20from%20IOS%206%20to%20IOS%207%20...%20or%20live%20with%20unpatched%20SSL%20risk.Love%20to%20hear%20if%20anyone%20has%20a%20third%20option.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-2006282","item_id":"_comm_2006282"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=2006282#respond' data-commentid="2006282" data-postid="247778" data-belowelement="div-comment-2006282" data-respondelement="respond" data-replyto="Reply to John Smith" aria-label='Reply to John Smith'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-2006062" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-2006062" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/0abf2b89a66181f9cfcdc78649ced96a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0abf2b89a66181f9cfcdc78649ced96a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">toto</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-2006062"><time datetime="2014-02-26T17:54:05+00:00">February 26, 2014 at 5:54 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Using goto in C is just a proof of incompetency &#8230; since at school they said: &#8220;goto statement exists in C (and C++), but please, never use it!&#8221; ;<br />
For me it is a statement for BASIC (e.g on a commodore 64) and nothing else.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_2006062"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_2006062={"id":7238218,"unique_id":"wp-comment-2006062","title":"Using%20goto%20in%20C%20is%20just%20a%20proof%20of%20incompetency%20...%20since%20at%20school%20they%20said%3A%20%26quot%3Bgoto%20statement%20exists%20in%20C%20%28and%20C%2B%2B%29%2C%20but%20please%2C%20never%20use%20it%21%26quot%3B%20%3B%20For%20me%20it%20is%20a%20statement%20for%20BASIC%20%28e.g%20on%20a%20com%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-2006062","item_id":"_comm_2006062"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=2006062#respond' data-commentid="2006062" data-postid="247778" data-belowelement="div-comment-2006062" data-respondelement="respond" data-replyto="Reply to toto" aria-label='Reply to toto'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-2006526" class="comment byuser comment-author-pducklin bypostauthor even depth-2">
			<article id="div-comment-2006526" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-2006526"><time datetime="2014-02-26T19:19:15+00:00">February 26, 2014 at 7:19 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I&#8217;ll disagree. There are places &#8211; like error handling &#8211; where forward gotos can result in perfectly safe and readable code. So you can have a guideline that says, &#8220;If you can avoid using goto, please do.&#8221; But a rule that says &#8220;you&#8217;re incompetent if you use goto in C&#8221; is like saying &#8220;it is grammatically incorrect in English to start a sentence with &#8216;but&#8217;.&#8221;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_2006526"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_2006526={"id":7238218,"unique_id":"wp-comment-2006526","title":"I%26%23039%3Bll%20disagree.%20There%20are%20places%20-%20like%20error%20handling%20-%20where%20forward%20gotos%20can%20result%20in%20perfectly%20safe%20and%20readable%20code.%20So%20you%20can%20have%20a%20guideline%20that%20says%2C%20%26quot%3BIf%20you%20can%20avoid%20using%20goto%2C%20pl%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-2006526","item_id":"_comm_2006526"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=2006526#respond' data-commentid="2006526" data-postid="247778" data-belowelement="div-comment-2006526" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-2020592" class="comment odd alt depth-2">
			<article id="div-comment-2020592" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Gerard</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-2020592"><time datetime="2014-02-28T06:45:14+00:00">February 28, 2014 at 6:45 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>You can&#8217;t see the need for goto in C unless you need to build some solid error handling in your program.<br />
When a function needs to allocate resources and test multiple exit conditions, you can :</p>
<p>use nested &#8220;if/then/else&#8221; ( unreadable as soon as more than a few test conditions)</p>
<p>use sequential &#8220;if&#8221;, and for each test failure, duplicate the cleanup code and use a return. Duplicated identical code and several returns in a function are poor coding style and hard to maintain.</p>
<p>use a goto to reach the function cleanup followed by the &#8216;return&#8217;.</p>
<p>In short, goto is the clean way, in C, to keep readability and proper cleanup when handling &#8216;exceptions&#8217;.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_2020592"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_2020592={"id":7238218,"unique_id":"wp-comment-2020592","title":"You%20can%26%23039%3Bt%20see%20the%20need%20for%20goto%20in%20C%20unless%20you%20need%20to%20build%20some%20solid%20error%20handling%20in%20your%20program.%20When%20a%20function%20needs%20to%20allocate%20resources%20and%20test%20multiple%20exit%20conditions%2C%20you%20can%20%3Aus%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-2020592","item_id":"_comm_2020592"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=2020592#respond' data-commentid="2020592" data-postid="247778" data-belowelement="div-comment-2020592" data-respondelement="respond" data-replyto="Reply to Gerard" aria-label='Reply to Gerard'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-2020813" class="comment even thread-even depth-1">
			<article id="div-comment-2020813" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/7fc22f42efa5fdc448b5da63284fc9ed?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7fc22f42efa5fdc448b5da63284fc9ed?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">AK</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-2020813"><time datetime="2014-02-28T07:22:22+00:00">February 28, 2014 at 7:22 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks for the detailed dissection of this problem!  Usually, I am frustrated by reports on Mac OS X security problems because they rarely indicate how old the problem is.  I am always left wondering whether my old machines running older OSes are affected or not.</p>
<p>In this instance, I was able to use the detailed info you provided to actually compare the source code for older versions of Security.framework to the code you displayed to verify that they are NOT affected.  In my case, Mac OS X 10.5.8 uses version 26935.0.0 of Security.framework.  I could only find versions 24739 and 28425 on Apple&#8217;s open source site, but they were identical and both predate a rewrite that must have introduced the bug.</p>
<p>http://opensource.apple.com/source/libsecurity_ssl/libsecurity_ssl-28425/lib/sslKeyExchange.cpp</p>
<p>It is interesting to compare versions 28425 and 55471: the file was changed from &#8220;mixed C/C++&#8221; to just C at some point and the code in that block is almost identical in both versions (ignoring added &amp; operators in the C version) except for a deleted line</p>
<p>    if ((err = SSLFreeBuffer(hashCtx, ctx)) != 0)</p>
<p>near the end and the reordering of two lines including that one spurious &#8220;goto fail;&#8221; line.  When I do a &#8220;diff&#8221; in TextWrangler between the two versions, the lines get mismatched in a way that suggests to me that the bug may have been the result of a careless RCS merge.</p>
<p>The &#8220;FIXME&#8221; and &#8220;TODO&#8221; comments throughout the files are perhaps interesting as well &#8230;</p>
<p>Anyways, thanks again.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_2020813"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_2020813={"id":7238218,"unique_id":"wp-comment-2020813","title":"Thanks%20for%20the%20detailed%20dissection%20of%20this%20problem%21%20%20Usually%2C%20I%20am%20frustrated%20by%20reports%20on%20Mac%20OS%20X%20security%20problems%20because%20they%20rarely%20indicate%20how%20old%20the%20problem%20is.%20%20I%20am%20always%20left%20wonde%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-2020813","item_id":"_comm_2020813"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=2020813#respond' data-commentid="2020813" data-postid="247778" data-belowelement="div-comment-2020813" data-respondelement="respond" data-replyto="Reply to AK" aria-label='Reply to AK'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-2064045" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-2064045" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/6199e2467af0fee8529f84f8fdbf9f61?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6199e2467af0fee8529f84f8fdbf9f61?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Mani's</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-2064045"><time datetime="2014-03-04T18:20:04+00:00">March 4, 2014 at 6:20 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks for interesting article and techie comments.</p>
<p>One question which is striking from the day I came to know that iOS has security flaw..<br />
&#8211;&gt; How to check whether my apps or third party apps are impacted because of this bug in security frameworks&#8230;?</p>
<p>fyi.. My apps are connecting to server over Https connection</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_2064045"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_2064045={"id":7238218,"unique_id":"wp-comment-2064045","title":"Thanks%20for%20interesting%20article%20and%20techie%20comments.One%20question%20which%20is%20striking%20from%20the%20day%20I%20came%20to%20know%20that%20iOS%20has%20security%20flaw..%20--%26gt%3B%20How%20to%20check%20whether%20my%20apps%20or%20third%20party%20apps%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-2064045","item_id":"_comm_2064045"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=2064045#respond' data-commentid="2064045" data-postid="247778" data-belowelement="div-comment-2064045" data-respondelement="respond" data-replyto="Reply to Mani&#039;s" aria-label='Reply to Mani&#039;s'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-2064743" class="comment byuser comment-author-pducklin bypostauthor even depth-2">
			<article id="div-comment-2064743" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#comment-2064743"><time datetime="2014-03-04T20:05:49+00:00">March 4, 2014 at 8:05 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Since your app almost certainly uses the SecureTransport library (assuming it simply makes an HTTPS connection), you should assume it is affected. You could add some additional code &#8211; like some sort of certifcate pinning, where your app has its own list of SSL certificates it will accept &#8211; or just warn your users to upgrade&#8230;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_2064743"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_2064743={"id":7238218,"unique_id":"wp-comment-2064743","title":"Since%20your%20app%20almost%20certainly%20uses%20the%20SecureTransport%20library%20%28assuming%20it%20simply%20makes%20an%20HTTPS%20connection%29%2C%20you%20should%20assume%20it%20is%20affected.%20You%20could%20add%20some%20additional%20code%20-%20like%20some%20s%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/02\/24\/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch\/#comment-2064743","item_id":"_comm_2064743"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/?replytocom=2064743#respond' data-commentid="2064743" data-postid="247778" data-belowelement="div-comment-2064743" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">What do you think? <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://nakedsecurity.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='247778' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="1f2d5d23d3" /></p><input type="hidden" id="ak_js" name="ak_js" value="152"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->
		<div class="comments-widget-area">
					</div>
	
	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	

	<section class="recommended-panel">
	<div class="container">
	<div class="panel-content ">

		<h3 class="block-title">Recommended reads</h3>
	<div class="blocks">
		<article id="post-549522" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/03/03/how-not-to-jailbreak-your-iphone/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/hands-1200.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Mar</span><span class="day">03</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">0</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/03/03/how-not-to-jailbreak-your-iphone/" rel="bookmark">How (NOT?!) to jailbreak your iPhone</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-544534" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/01/14/europol-announces-bust-of-worlds-biggest-dark-web-marketplace/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/01/dw-1200.jpg?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Jan</span><span class="day">14</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">11</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/01/14/europol-announces-bust-of-worlds-biggest-dark-web-marketplace/" rel="bookmark">Europol announces bust of &#8220;world&#8217;s biggest&#8221; dark web marketplace</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-544664" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/01/25/naked-security-live-dont-let-digital-jokes-turn-into-digital-disasters/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/10/nslive-1200-3.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Jan</span><span class="day">25</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">0</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/01/25/naked-security-live-dont-let-digital-jokes-turn-into-digital-disasters/" rel="bookmark">Naked Security Live &#8211; Don’t let digital jokes turn into digital disasters</a></h3>	</div>
</article> <!-- .card-article -->
	</div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="footer-container">
			<a href="#" class="js-collapse-footer"><svg style="height: 20px" viewBox="0 0 132 24" class="block icon sophos"><use xlink:href="#sophos"></use></svg></a>
			<div id="collapseFooter" class="blocks">
				<div class="sophos block">
					<ul id="menu-footer-primary" class="primary menu"><li id="menu-item-306737" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306737"><a href="https://nakedsecurity.sophos.com/about/">About Naked Security</a></li>
<li id="menu-item-306754" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306754"><a href="https://www.sophos.com/en-us/company.aspx">About Sophos</a></li>
<li id="menu-item-306747" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306747"><a href="https://nakedsecurity.sophos.com/send-us-a-tip/">Send us a tip</a></li>
<li id="menu-item-323171" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323171"><a href="/cookies-and-scripts/">Cookies</a></li>
<li id="menu-item-323170" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323170"><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
<li id="menu-item-323169" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323169"><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
</ul>				</div>
										<div class="news block">
							<ul id="menu-products-column-one" class="small menu"><li id="menu-item-306998" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306998"><a href="https://www.sophos.com/en-us/products/intercept-x.aspx">Intercept X</a></li>
<li id="menu-item-440801" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440801"><a href="https://www.sophos.com/en-us/products/server-security.aspx">Intercept X for Server</a></li>
<li id="menu-item-440802" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440802"><a href="https://www.sophos.com/en-us/products/mobile-control.aspx">Intercept X for Mobile</a></li>
</ul>						</div>
											<div class="products block">
							<ul id="menu-products-column-two" class="small menu"><li id="menu-item-440803" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440803"><a href="https://www.sophos.com/en-us/products/next-gen-firewall.aspx">XG Firewall</a></li>
<li id="menu-item-440805" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440805"><a href="https://www.sophos.com/en-us/products/sophos-email.aspx">Sophos Email</a></li>
<li id="menu-item-440804" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440804"><a href="https://www.sophos.com/en-us/products/secure-wifi.aspx">Sophos Wireless</a></li>
</ul>						</div>
											<div class="threats block">
							<ul id="menu-server-protection" class="small menu"><li id="menu-item-440806" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440806"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx">Managed Threat Response</a></li>
<li id="menu-item-448404" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-448404"><a href="https://www.sophos.com/en-us/products/cloud-optix.aspx">Cloud Optix</a></li>
<li id="menu-item-440807" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440807"><a href="https://www.sophos.com/en-us/products/phish-threat.aspx">Phish Threat</a></li>
</ul>						</div>
								</div>
			<ul class="block social footer">
				<li class="twitter"><a rel="nofollow" href="https://twitter.com/NakedSecurity" title="Follow our team of security experts on Twitter"><svg style="height: 14px" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
				<li class="facebook"><a rel="nofollow" href="https://www.facebook.com/SophosSecurity" title="Join over 250,000 people in our Facebook community"><svg style="height: 14px" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
				<li class="instagram"><a rel="nofollow" href="https://www.instagram.com/nakedsecurity/" title="Follow Naked Security on Instagram"><svg style="height: 14px" viewBox="0 0 100 100" class="icon instagram"><use xlink:href="#instagram"></use></svg></a></li>
				<li class="linkedin"><a rel="nofollow" href="https://www.linkedin.com/company/5053/" title="Join the naked security discussion group on LinkedIn"><svg style="height: 14px" viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
				<li class="rss"><a rel="nofollow" href="/feed" title="Subscribe to our RSS feed"><svg style="height: 14px" viewBox="0 0 100 100" class="icon rss"><use xlink:href="#rss"></use></svg></a></li>
			</ul>

							<div class="vip-powered-wpcom">
					<span class="copyright">© 1997 - 2021 Sophos Ltd.</span>
					All rights reserved.
					Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=nakedsecurity.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>				</div>
					</div>
		<script type="text/javascript">
			window.cookieconsent_options = {
				"message":"This site uses cookies. By continuing to browse the site you are agreeing to our use of cookies.",
				"dismiss":"Got it!",
				"learnMore":"Learn More",
				"link":"/cookies-and-scripts",
				"theme":"https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/css/sophos.css"};
		</script>
	</footer><!-- #colophon -->
</div><!-- #page -->
<div id="survey-wrapper" class="mfp-hide"><div class="pd-embed" id="pd_1499706777" data-settings=""></div></div>
<script id='child-js-plugins-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"0","nextLink":""};
</script>
<script id='child-js-core-js-extra'>
var Sophos = {"ajaxurl":"https:\/\/nakedsecurity.sophos.com\/wp-admin\/admin-ajax.php","nonce":"64f6810f0c"};
</script>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJyNjkEOwjAMBD9EalKU3hBPQZAamhDbUZyo4vdEiEocOHD07ozWsGbjhStyhbogoYJKXkQZVzXj3jqICjm1e2Adou7gL8FLwY0O7FObO/fOibppCub0HCjwL6ifSFecv/ttkpr5PAOXR1DCCufuwk0KdfZERztZdxitc1N8ARFpT3A='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161173',post:'247778',tz:'0',srv:'nakedsecurity.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161173', '247778' ]);
</script>
</body>
</html>
