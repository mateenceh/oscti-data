<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="RHQeasQqjasbRt5asY6atZYbs5tr10gFBevDt2HRhW0" />
<link rel="pingback" href="https://nakedsecurity.sophos.com/xmlrpc.php">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5VK6LTK');</script>
<!-- End Google Tag Manager -->

<meta name="description" content="Here&#039;s a cautionary tale about a bug, courtesy of IBM. Not that IBM had the bug, just to be clear: Google had the bug, and IBM researchers spotted it." />
<meta name="keywords" content="android, google, vulnerability, anatomy, android, buffer overflow, exploit, google, ibm, vulnerability" />
<title>Anatomy of a buffer overflow &#8211; Google&#8217;s &#8220;KeyStore&#8221; security module for Android &#8211; Naked Security</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="I9dHFo-YhnK2MfAHn-20V4GnWrOttVUYyISGamyU41M" />
<meta name="msvalidate.01" content="7D8D1FA2892142B1543D2CBCD07FB88F" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Feed" href="https://nakedsecurity.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Comments Feed" href="https://nakedsecurity.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Anatomy of a buffer overflow &#8211; Google&#8217;s &#8220;KeyStore&#8221; security module for Android Comments Feed" href="https://nakedsecurity.sophos.com/2014/07/02/anatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android/feed/" />
<link rel='stylesheet' id='all-css-0' href='https://nakedsecurity.sophos.com/_static/??-eJyVz00OwiAQhuELCSM1mLgwnoXCRFD+wgxpevvS2J0bXU7yPsk3sFQRso3dIYElAheIYY7FvkUMczNtBeI1okwhyxGcYAhbMmNmYI9pOCrVF8q4kJjOSh/gn1hEw0j8q9mHGifZNzQsfB9xkybVL5+6qLE/QyZ4IVczvrrJjz/unTzSXV2VvkxKa70BdwtjDg==' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqWkWAK9EIho='></script>
<link rel="https://api.w.org/" href="https://nakedsecurity.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://nakedsecurity.sophos.com/wp-json/wp/v2/posts/264109" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://nakedsecurity.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://nakedsecurity.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://nakedsecurity.sophos.com/2014/07/02/anatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android/" />
<link rel='shortlink' href='https://nakedsecurity.sophos.com/?p=264109' />
<link rel="alternate" type="application/json+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2014%2F07%2F02%2Fanatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2014%2F07%2F02%2Fanatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://nakedsecurity.sophos.com/2014/07/02/anatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Anatomy of a buffer overflow &#8211; Google&#8217;s &#8220;KeyStore&#8221; security module for Android" />
<meta property="og:url" content="https://nakedsecurity.sophos.com/2014/07/02/anatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android/" />
<meta property="og:description" content="Here&#8217;s a cautionary tale about a bug, courtesy of IBM. Not that IBM had the bug, just to be clear: Google had the bug, and IBM researchers spotted it." />
<meta property="article:published_time" content="2014-07-02T10:23:44+00:00" />
<meta property="article:modified_time" content="2014-07-02T10:51:06+00:00" />
<meta property="og:site_name" content="Naked Security" />
<meta property="og:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/07/ks-250.png?w=250" />
<meta property="og:image:secure_url" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/07/ks-250.png?w=250" />
<meta property="og:image:width" content="250" />
<meta property="og:image:height" content="250" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@NakedSecurity" />
<meta name="twitter:text:title" content="Anatomy of a buffer overflow &#8211; Google&#8217;s &#8220;KeyStore&#8221; security module for Android" />
<meta name="twitter:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/07/ks-250.png?w=144" />
<meta name="twitter:card" content="summary" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=270" />
</head>
<body class="post-template-default single single-post postid-264109 single-format-standard" >
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VK6LTK"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div style="display: none">
<svg>
	<symbol id="sophos" viewBox="0 0 132 24">
		<path d="m111.82 22.176h11.64c3.267 0 4.65-0.2 5.74-0.896 1.715-1.063 2.804-3.26 2.804-5.62 0-1.928-0.658-3.89-1.647-4.888-1.288-1.33-3.035-1.828-6.271-1.828h-3.527c-1.586 0-2.754-0.067-3.412-0.365-0.794-0.367-1.256-1.165-1.256-2.161 0-1.165 0.56-2.03 1.486-2.264 0.692-0.163 1.498-0.163 3.574-0.198h10.419v-3.956h-11.473c-2.574 0-3.727 0.099-4.718 0.466-2.279 0.796-3.828 3.257-3.828 6.083 0 1.93 0.76 3.727 2.079 4.89 1.155 0.996 2.872 1.462 5.51 1.462h4.697c1.057 0 1.915 0.132 2.376 0.398 0.893 0.433 1.418 1.328 1.418 2.36 0 0.864-0.395 1.597-1.087 2.027-0.561 0.369-1.517 0.534-3.268 0.534h-11.256zm-111.35 0h11.64c3.267 0 4.652-0.2 5.741-0.896 1.714-1.063 2.803-3.26 2.803-5.62 0-1.928-0.66-3.89-1.65-4.888-1.285-1.33-3.034-1.828-6.27-1.828h-3.527c-1.584 0-2.751-0.067-3.41-0.365-0.792-0.367-1.253-1.165-1.253-2.161 0-1.165 0.56-2.03 1.484-2.264 0.693-0.163 1.496-0.163 3.574-0.198h10.42v-3.956h-11.477c-2.573 0-3.727 0.099-4.715 0.466-2.278 0.796-3.83 3.257-3.83 6.083 0 1.93 0.762 3.727 2.08 4.89 1.155 0.996 2.871 1.462 5.51 1.462h4.696c1.057 0 1.913 0.132 2.377 0.398 0.888 0.433 1.416 1.328 1.416 2.36 0 0.864-0.394 1.597-1.089 2.027-0.558 0.369-1.517 0.534-3.264 0.534h-11.256v3.956zm94.05-16.18c-0.68 1.076-1.003 2.803-1.003 5.122 0 5.088 1.747 7.405 5.63 7.405 3.822 0 5.568-2.317 5.568-7.34 0-5.092-1.715-7.373-5.568-7.373-2.102 0-3.754 0.784-4.627 2.186zm13.174-2.511c1.329 1.761 2.072 4.63 2.072 7.992 0 3.816-1.197 6.948-3.334 8.677-1.619 1.304-4.078 2.022-6.995 2.022-4.142 0-7.41-1.372-9.092-3.817-1.263-1.793-1.88-4.176-1.88-7.08 0-4.172 1.133-7.339 3.27-9.035 1.682-1.37 4.339-2.122 7.383-2.122 3.85 0 6.925 1.209 8.576 3.363zm-22.018-3.068h-4.596v8.908h-8.319v-8.908h-4.597v21.759h4.597v-8.97h8.318v8.97h4.596v-21.759zm-28.61 10.277c1.23 0 1.941-0.163 2.427-0.62 0.581-0.49 0.938-1.533 0.938-2.74 0-1.436-0.58-2.478-1.584-2.838-0.356-0.13-0.94-0.197-1.684-0.197h-6.344v6.395zm-6.247 11.481h-4.598v-21.758h10.78c3.786 0 5.114 0.39 6.538 1.991 1.264 1.37 1.942 3.163 1.942 5.088 0 2.284-0.904 4.404-2.394 5.676-1.262 1.077-2.43 1.402-4.888 1.402h-7.38zm-22.589-16.179c-0.682 1.076-1.004 2.803-1.004 5.122 0 5.088 1.748 7.405 5.634 7.405 3.818 0 5.568-2.317 5.568-7.34 0-5.092-1.716-7.373-5.568-7.373-2.106 0-3.757 0.784-4.63 2.186zm13.174-2.511c1.328 1.761 2.073 4.63 2.073 7.992 0 3.816-1.2 6.948-3.335 8.677-1.618 1.304-4.079 2.022-6.993 2.022-4.144 0-7.413-1.372-9.096-3.817-1.264-1.793-1.878-4.176-1.878-7.08 0-4.172 1.133-7.339 3.272-9.035 1.681-1.37 4.337-2.122 7.38-2.122 3.851 0 6.93 1.209 8.578 3.363z"></path>
	</symbol>
	<symbol id="twitter" viewBox="0 0 24 24">
 		<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path>
 	</symbol>
	<symbol id="facebook" viewBox="0 0 24 24">
 		<path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path>
 	</symbol>
	<symbol id="instagram" viewBox="0 0 24 24">
		<path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path>
	</symbol>
	<symbol id="linkedin" viewBox="0 0 24 24">
		<path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"></path>
	</symbol>
	<symbol id="rss" viewBox="0 0 24 24">
		<path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"></path>
	</symbol>
	<symbol id="reddit" viewBox="0 0 24 24">
		<path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"></path>
	</symbol>
</svg>
</div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header variation variation-3" role="banner">
		<div class="header-container">
			<div class="site-branding">
				<div class="site-title">
					<a title="Naked Security" href="https://nakedsecurity.sophos.com/" rel="home"><img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/naked-security-logo-white@2x.png"></a>
					by
					<a title="sophos.com" href="https://www.sophos.com"><svg viewBox="0 0 132 24" class="icon sophos"><use xlink:href="#sophos"></use></svg></a>
				</div>
			</div><!-- .site-branding -->
			<nav id="site-navigation" class="main-navigation" role="navigation">
				<div class="container">
					<ul id="menu-variation-two" class="exit-links menu"><li id="menu-item-436509" class="products menu-item menu-item-type-custom menu-item-object-custom menu-item-436509"><a href="#">Products</a></li>
<li id="menu-item-436515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436515"><a href="https://www.sophos.com/en-us/products/free-tools.aspx">Free Tools</a></li>
<li id="menu-item-436531" class="search-toggle menu-item menu-item-type-custom menu-item-object-custom menu-item-436531"><a href="#">Search</a></li>
<li id="menu-item-436532" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436532"><a href="https://home.sophos.com/en-us.aspx">Free Sophos Home</a></li>
</ul>				</div>
			</nav><!-- #site-navigation -->
			<div class="site-search-block">
	<form target="_top" role="search" class="search-form" method="get" action="https://nakedsecurity.sophos.com/">
        <fieldset>
            <div class="field">
				<input type="search" value="" name="s" class="search-field" placeholder="Search naked security...">
            </div>
            <div class="submit">
				<button type="submit" class="search-submit button">Go</button>
            </div>
        </fieldset>
    </form>
</div>
		</div><!-- .container -->
	</header>

	<div class="responsive-flyout-panel small-12 column active" style="opacity: 1; display: none;">
		<div class="modal-filler"></div>
	    <div class="productNavBox">
	        <div class="productNavContainer">
	            <div class="row prodRow">
	                <div class="prodListBox column large-9">
	                    <div class="row margin-0 highlightProduct">
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/next-gen-firewall.aspx"><img src="https://www.sophos.com/medialibrary/2F4785DE8C3F43ECBD699A18F332FEEB.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">XG Firewall</div>
	                                	<div class="menu-section-subtitle">Next-Gen Firewall</div>
									</div>
	                            </a>
	                        </div>
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/intercept-x.aspx"><img src="https://www.sophos.com/medialibrary/27111765D65A45D49A232925D2CE428B.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">Intercept X</div>
	                                	<div class="menu-section-subtitle">Next-Gen Endpoint</div>
									</div>
	                            </a>
	                        </div>
	                    </div>
	                    <div class="productList">
	                        <ul>
								<li>
									<a href="https://www.sophos.com/en-us/products/cloud-optix.aspx"><img src="https://www.sophos.com/medialibrary/SophosNext/Images/Products/Icons/sophos-cloud-optix-icon.svg">Sophos Cloud Optix</a>
								</li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-central.aspx"><img src="https://www.sophos.com/medialibrary/08EA66123F1B4DDE8FE5C9B578A7FAA7.ashx">Sophos Central</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/mobile-control.aspx"><img src="https://www.sophos.com/medialibrary/678FE994855047739F50D6C411184FA6.ashx">Sophos Mobile</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/server-security.aspx"><img src="https://www.sophos.com/medialibrary/01B80E7D7CD54EF8AC2E51C9C6EC0236.ashx">Intercept X for Server</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-wifi.aspx"><img src="https://www.sophos.com/medialibrary/BEBD9C41BB4E480498514B29B92A145A.ashx">Secure Wi-Fi</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/phish-threat.aspx"><img src="https://www.sophos.com/medialibrary/DC9D1A7BA3964B0C9DAF1F1E68806B5A.ashx">Phish Threat</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/safeguard-encryption.aspx"><img src="https://www.sophos.com/medialibrary/8F51F06B62814B108D3B2763FF018E37.ashx">SafeGuard Encryption</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-email.aspx"><img src="https://www.sophos.com/medialibrary/597ADA0AF01A4A12B2B27239D0F9992C.ashx">Secure Email</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/unified-threat-management.aspx"><img src="https://www.sophos.com/medialibrary/8CB72BF5E1AD41F7894CE5E42101B0F3.ashx">SG UTM</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-web-gateway.aspx"><img src="https://www.sophos.com/medialibrary/C586E372694547A1B207A61D87246BA7.ashx">Secure Web Gateway</a>
	                            </li>
	                        </ul>
	                    </div>
	                </div>
	                <div class="homeUserBox column large-3">
						<img src="https://www.sophos.com/medialibrary/3376DF5742A64AEE93FDB9DCA7291239.ashx">
						<div class="menu-section-title">For Home Users</div>
	                    <p>Sophos Home protects every Mac and PC in your home </p><a href="https://home.sophos.com/" target="_blank" class="greenSmallMenuBtn">Learn More</a>
					</div>
	            </div>
	            <div class="row blueRow">
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-tools.aspx"><img width="19" src="https://www.sophos.com/medialibrary/A1FF440D2BB84511B8C94D771D44E207.ashx">Free Security Tools</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-trials.aspx"><img width="20" src="https://www.sophos.com/medialibrary/FCD3410ED2C347808D9DB8AC12C62DBD.ashx">Free Trials</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/demos.aspx"><img width="18" src="https://www.sophos.com/medialibrary/50985180E5F54C94917A2A6508E24287.ashx">Product Demos</a>
	                </div>
	                <!-- <div class="column large-3 medium-6">
	                    <a href="javascript:fairfax.openLiveChatFromFlyoutLink();" class="flyout-live-chat-link"><img width="20" src="https://www.sophos.com/medialibrary/E24C5050837145F6A5C592E299BA2A0D.ashx">Live Sales Chat</a>
	                </div> -->
	            </div>
	        </div>
	    </div>
	</div>
	<script>

	jQuery(document).ready( function () {
		var productButton   = jQuery('nav .menu-item.products');
		var modalBackground = jQuery('.modal-filler');
		var flyoutMenu		= jQuery('.responsive-flyout-panel');
		var Sophos			= Sophos || {};

		Sophos.MenuTest = {};

		Sophos.MenuTest.open = function () {
				productButton.addClass('open');
				flyoutMenu.show();
				modalBackground.show();
		};

		Sophos.MenuTest.close = function () {
			productButton.removeClass('open');
			flyoutMenu.hide();
			modalBackground.hide();
		};

		Sophos.MenuTest.toggle = function () {
			if ( productButton.hasClass('open') ) {
				Sophos.MenuTest.close();
			} else {
				Sophos.MenuTest.open();
			}
		};

		productButton.click( Sophos.MenuTest.toggle );
		modalBackground.click( Sophos.MenuTest.close );
	});

	</script>

	
	<section class="about-panel">
	<div class="container">
	<div class="panel-content ">

		<div class="description"><span>Have you listened to our podcast? <a href="/podcast/">Listen now</a></span></div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	<div id="content" class="site-content">
		<div class="content-container">

</div> <!-- .container -->
</div> <!-- #content -->


	<section class="content-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

		<main id="main" class="site-main" role="main">

	
		
<article id="post-264109" class="post-264109 post type-post status-publish format-standard has-post-thumbnail hentry category-android category-featured category-google category-vulnerability tag-anatomy tag-android tag-buffer-overflow tag-exploit tag-google tag-ibm tag-vulnerability-2">

	<header class="entry-header">
		<h1 class="entry-title">Anatomy of a buffer overflow &#8211; Google&#8217;s &#8220;KeyStore&#8221; security module for Android</h1>		<div class="entry-meta">
			<div>
				
	<span class="entry-published">
		<time class="entry-date published" datetime="2014-07-02T11:23:44+01:00">02 Jul 2014</time>
	</span>

					<a href="#comments" class="comment-box">
					<span class="count">4</span>
				</a>
					
	<span class="entry-categories">
	<a href="https://nakedsecurity.sophos.com/category/technologies/operating-systems/mobile/android/">Android</a>, <a href="https://nakedsecurity.sophos.com/category/organisations/google/">Google</a>, <a href="https://nakedsecurity.sophos.com/category/security-threats/vulnerability/">Vulnerability</a>	</span>

			</div>
	</header> <!-- .entry-header -->

    <div id="newsletter-signup" class="container top"></div>

			<div class="entry-featured-image">
			<img width="250" height="250" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/07/ks-250.png?w=250&amp;h=250&amp;crop=1" class="attachment-hero-thumbnail size-hero-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/07/ks-250.png 250w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/07/ks-250.png?resize=150,150 150w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/07/ks-250.png?resize=225,225 225w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/07/ks-250.png?resize=70,70 70w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/07/ks-250.png?resize=32,32 32w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/07/ks-250.png?resize=50,50 50w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/07/ks-250.png?resize=64,64 64w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/07/ks-250.png?resize=96,96 96w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2014/07/ks-250.png?resize=128,128 128w" sizes="(max-width: 250px) 100vw, 250px" />					</div> <!-- .entry-featured-image -->
		
		<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2014/07/02/supreme-court-refuses-to-drag-google-out-of-its-street-view-privacy-wreckage/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> Supreme Court refuses to drag Google out of its Street View privacy wreckage</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2014/07/02/did-facebooks-emotion-experiment-break-the-law-ico-probes/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Did Facebook&#8217;s emotion experiment break the law? ICO probes</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	<div class="entry-content">
		<div class="entry-prefix">
			<div class="entry-author">
				
	
					<span class="by">by</span>
			<a href="https://nakedsecurity.sophos.com/author/paul-ducklin/" title="Posts by Paul Ducklin" class="author url fn" rel="author">Paul Ducklin</a>		
	
				</div>
			<div class="entry-sharing">
				
	<ul class="block social share">
		<li class="facebook"><a href="https://www.facebook.com/share.php?u=https%3A%2F%2Fnakedsecurity.sophos.com%2F2014%2F07%2F02%2Fanatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android%2F&title=Anatomy+of+a+buffer+overflow+%E2%80%93+Google%E2%80%99s+%E2%80%9CKeyStore%E2%80%9D+security+module+for+Android" data-title="Anatomy of a buffer overflow – Google’s “KeyStore” security module for Android" title="Share on Facebook"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
		<li class="twitter"><a href="https://twitter.com/intent/tweet?text=Anatomy+of+a+buffer+overflow+%E2%80%93+Google%E2%80%99s+%E2%80%9CKeyStore%E2%80%9D+security+module+for+Android+https%3A%2F%2Fnakedsecurity.sophos.com%2F%3Fp%3D264109" data-title="Anatomy of a buffer overflow &#8211; Google&#8217;s &#8220;KeyStore&#8221; security module for Android" title="Share on Twitter"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
		<li class="linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2014%2F07%2F02%2Fanatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android%2F&title=Anatomy+of+a+buffer+overflow+%E2%80%93+Google%E2%80%99s+%E2%80%9CKeyStore%E2%80%9D+security+module+for+Android" data-title="Anatomy of a buffer overflow – Google’s “KeyStore” security module for Android" title="Share on LinkedIn"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
		<li class="reddit"><a href="https://reddit.com/submit/?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2014%2F07%2F02%2Fanatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android%2F&title=Anatomy+of+a+buffer+overflow+%E2%80%93+Google%E2%80%99s+%E2%80%9CKeyStore%E2%80%9D+security+module+for+Android" title="Share on Reddit"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon reddit"><use xlink:href="#reddit"></use></svg></a></li>

			</ul>

				</div>
		</div>
		<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/07/ks-170.png" width="170" height="170" align="right" hspace="
10"></img>Here&#8217;s a cautionary tale about a bug, courtesy of IBM.</p>
<p>Not that IBM had the bug, just to be clear: Google had the bug, and <a href="http://securityintelligence.com/android-keystore-stack-buffer-overflow-to-keep-things-simple-buffers-are-always-larger-than-needed" rel="nofollow">IBM researchers spotted it</a>.</p>
<p>Just like Google&#8217;s <a href="http://nakedsecurity.sophos.com/2013/07/10/anatomy-of-a-security-hole-googles-android-master-key-debacle-explained/">serial SNAFUs</a> in the <a href="http://nakedsecurity.sophos.com/2013/07/17/anatomy-of-another-android-hole-chinese-researchers-claim-new-code-verification-bypass/">Android</a> cryptographic <a href="http://nakedsecurity.sophos.com/2013/11/06/anatomy-of-a-file-format-problem-yet-another-code-verification-bypass-in-android/">verifier</a> last year, this bug has the added interest of irony, because it was found in a security-related part of Android called <em>KeyStore</em>.</p>
<p><a href="http://www.slideshare.net/ibmsecurity/android-keystorestackbufferoverflow"><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/07/ks-paper-500.png" alt="Click to read the IBM paper..." title="Click to read the IBM paper..." width="500" height="226" style="margin:0;padding:0;margin-top:.6em;margin-bottom:.6em;"></img></a></p>
<h4>Why KeyStore?</h4>
<p>If you&#8217;ve ever wondered how Android apps keep things like cryptographic keys secure, then you have wondered wisely.</p>
<p>After all, mobile apps form an ecosystem that has given rise to some egregiously insecure behaviour &#8211; behaviour not by you, the user, but by the suppliers of the software themselves.</p>
<p>Snapchat, for example, claimed that your risqué photos would vanish after their first viewing, but didn&#8217;t even <a href="http://nakedsecurity.sophos.com/2013/05/10/snapchat-images-that-have-disappeared-forever-stay-right-on-your-phone/">bother to delete the image</a> files from the from the recipient&#8217;s phone, and that&#8217;s before you even consider how bogus the company&#8217;s claim was in the first place.</p>
<p>WhatsApp bravely tried to add a layer of encryption to your messages, but managed to invent a <a href="http://nakedsecurity.sophos.com/2013/10/10/whatsapp-mobile-messaging-app-in-the-firing-line-again-over-cryptographic-blunder/">flawed cryptosystem</a> that amounted to a one-time pad used twice. (It&#8217;s not called a one-time pad for nothing!)</p>
<p>And a survey from January 2014 showed that 40% of online banking apps &#8211; software officially promoted by financial institutions for secure mobile banking &#8211; didn&#8217;t bother to check HTTPS certificates and so could be <a href="http://nakedsecurity.sophos.com/2014/01/10/just-how-secure-is-that-mobile-banking-app/">fooled by Man in the Middle</a> (MitM) phishing crooks at any internet-enabled coffee shop.</p>
<p>So, at least as far as the secure storage of cryptographic keys was concerned, Google decided to introduce a standardised way for apps to store credentials, in the hope of adding some order to the mobile cryptographic chaos.</p>
<p>Better yet, the KeyStore implementation, significantly <a href="http://nelenkov.blogspot.com/2013/08/credential-storage-enhancements-android-43.html">enhanced in Android 4.3</a>, automatically ensures that each app&#8217;s KeyStore data is strongly encrypted with its own unique key as well as a key derived from your lockscreen passcode, and uses special-purpose hardware for key storage if it is available (as it is on the Nexus 7, for example). </p>
<p>So far, so good.</p>
<h4>The KeyStore implementation</h4>
<p>When you start looking at the main KeyStore source code file,<tt> keystore.cpp</tt>, you&#8217;ll soon notice this comment:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/07/ks-comment-500.png" width="500" height="105" style="margin:0;padding:0;margin-top:0;margin-bottom:.6em;"></img></p>
<blockquote><p><tt>To keep things simple, buffers are always larger than the maximum space we needed, so boundary checks on buffers are omitted.</tt></p></blockquote>
<p>Your eyes may have popped open there: if boundary checks on buffers have deliberately been omitted, then if the coder has slipped up even once so that a buffer overflow is possible after all, you can be certain that it won&#8217;t be detected, let alone stopped.</p>
<p>The code is written in C++, but there are plenty of C-style strings in there, including strings allocated on the stack, which in C code is done like this:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/07/ks-getkey-5001.png" width="500" height="101" style="margin:0;padding:0;margin-top:0;margin-bottom:.6em;"></img></p>
<p>Don&#8217;t worry if you aren&#8217;t fluent in C; all you need to know is that this code snippet takes a<tt> keyName </tt>(and the<tt> uid</tt>, or user ID, that is unique to the app requesting the key) and converts it into a<tt> filename </tt>by which it will be represented in the KeyStore system.</p>
<p>It does so by performing some sort of manipulation, determined by the<tt> encode_key_for_uid() </tt>function, that reads data bytes out of the memory buffer called<tt> keyName </tt>and saves them into the new variable<tt> filename</tt>, which is defined by the line:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/07/ks-buff-500.png" width="500" height="55" style="margin:0;padding:0;margin-top:0;margin-bottom:.6em;"></img></p>
<p>That&#8217;s C&#8217;s way of saying, &#8220;reserve me a buffer of characters (bytes) on the stack that is<tt> NAME_MAX </tt>bytes long.&#8221;</p>
<p><tt>NAME_MAX</tt>, as it happens, is set elsewhere in the Android code to 255, the longest filename that&#8217;s allowed, because there is no point in trying to create a file with a longer name.</p>
<h4>Alarm bell ringing</h4>
<p>You may hear an alarm bell ringing in your head already.</p>
<p>The keep-calm-and-carry-on comment above assures us that buffers are always <em>larger</em> that the maximum space we need, so that watching out for overflows is an irrelevancy.</p>
<p>So that&#8217;s one promise as good as broken by the programmer already, albeit only in a pedantic sense, because<tt> filename </tt>is <em>exactly</em> as big as the maximum length of a filename, not &#8220;always larger.&#8221;</p>
<p>And you&#8217;ll also notice that the programmer doesn&#8217;t tell the <tt> encode_key_for_uid() </tt>function how big the<tt> filename </tt>buffer is.</p>
<p>In C, strings like<tt> filename </tt>really are just plain, unadorned and unannotated arrays of bytes; they don&#8217;t include a record of how many bytes they are allowed to hold.</p>
<p>This is why buffer overflows are easy mistakes to make in C: when you copy<tt> num </tt>bytes from string<tt> src </tt>to string<tt> dest</tt>, string<tt> src </tt> doesn&#8217;t &#8220;know&#8221; whether it actually contains<tt> num </tt> bytes for you to read from, and string<tt> dst </tt> doesn&#8217;t &#8220;know&#8221; whether it has<tt> num </tt>bytes of space for you to write to.</p>
<p>You have to keep track of how much memory is allocated to each string yourself.</p>
<h4>Is<tt> filename </tt>big enough?</h4>
<p>And that raises the worrying question, &#8220;Is<tt> filename </tt>actually big enough for the data from<tt> keyName </tt>that is about to be copied into it?&#8221;</p>
<p>Our first stop is to dive into <tt> encode_key_for_uid() </tt>and see what it does:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/07/ks-export1-500.png" width="500" height="130" style="margin:0;padding:0;margin-top:0;margin-bottom:.6em;"></img></p>
<p>Again, don&#8217;t worry if you don&#8217;t know C; this code writes the numeric user ID of the calling app (<tt>uid</tt>), as a text string of decimal digits followed by an underscore, into the<tt> out </tt>parameter, which you will remember from above is our<tt> filename </tt> buffer of 255 bytes.</p>
<p>Because an Android user ID is stored in 32 bits, it can never be larger than 2<sup>32</sup>-1, which is about 4 &times; 10<sup>9</sup>, or 10 decimal digits. </p>
<p>So at most 12 bytes (10 digits, an underscore, and a zero-byte, or NUL, used to terminate a C text string) will be written into our<tt> filename </tt>buffer, which is 255 bytes long.</p>
<p>Note that the programmer tried to do the right thing here, by using the function<tt> snprintf()</tt>, which is slightly cryptic shorthand for &#8220;do a formatted print of at most N bytes into a string buffer.&#8221;</p>
<p>The coder has deliberately set a cap of 255 bytes on the maximum number of bytes to write, even though he knows he&#8217;s well within the limit, and despite saying at the start that boundary checks were unnecessary and had been omitted.</p>
<p style='background-color:#e8e8e8;font-size:80%;padding:.71em;margin-top:1em;margin-bottom:1em;'>This code is poor despite the use of<tt> snprintf()</tt>. The programmer has stated the length of<tt> filename </tt> explicitly both in the <em>calling</em> function, where he defined it (i.e. where it actually acquires its 255 bytes of memory), and in the <em>called</em> function. So if ever you should later change the size of the buffer where it is defined, you&#8217;ll need to dig into every place where the buffer is used and change the size as well. If you forget, you will introduce a bug. The coder should have passed the value<tt> sizeof filename</tt> into the called function instead.</p>
<p>Next, we dive further, entering the<tt> encode_key() </tt> function, which copies more bytes into<tt> filename</tt>.</p>
<p>This time, it doesn&#8217;t bother to check whether there is enough space:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/07/ks-export2-5001.png" width="500" height="265" style="margin:0;padding:0;margin-top:0;margin-bottom:.6em;"></img></p>
<p>This function shovels bytes from the<tt> in </tt>string, which is our<tt> keyName</tt>, into the<tt> out </tt>string, our<tt> filename</tt>, until there are no more to be copied.</p>
<p style='background-color:#e8e8e8;font-size:80%;padding:.71em;margin-top:1em;margin-bottom:1em;'>Regular printable characters (1) are copied unchanged, but (2) if the input byte would be an illegal or unprintable filename character, the algorithm (3) encodes it into two characters that are safe for use in a filename. This is already a worrying detail considering that the code assumes all buffers are big enough. Our 255-byte<tt> filename </tt>buffer could, in theory, be overflowed by a maliciously chosen<tt> keyName </tt>of just 128 bytes, if each input byte were deliberately chosen so that it encoded into two output bytes. Finally, a (4) NUL character is added to terminate the string &#8211; an extra byte for which the programmer forgot to reserve space at numerous places in the code. (See below.)</p>
<h4>What if<tt> keyName </tt>is too long?</h4>
<p>As you can imagine, at this point the IBM researchers wondered, &#8220;What happens if<tt> keyName </tt>is too long to fit?&#8221;</p>
<p>The programmer promised us that all buffers would be big enough, but a search of the code shows that this is untrue.</p>
<p>The<tt> filename </tt>buffer is hard-wired at 255 characters, while the<tt> keyName </tt>parameter is passed in from an app and can be any size (and contain any byte sequence) the calling app wants.</p>
<p>So we have a buffer overflow on the stack that can be precisely controlled by a malicious app.</p>
<p>There&#8217;s no guarantee that this vulnerability could ever be exploited for more than a denial of service attack (crashing the KeyStore system), but it&#8217;s a vulnerability neverthless.</p>
<p>Google fixed it in Android 4.4, but not very thoroughly: the code still relies on the assumption that &#8220;buffers are always larger than the maximum space we needed, so boundary checks on buffers are omitted.&#8221;</p>
<p>Interestingly, Google also spotted many other places where the coder had forgotten about the NUL byte that terminates C strings and incorrectly allocated buffers that were exactly one byte too small for their output, apparently without causing any errors to show up in testing.</p>
<p>These flaws were fixed with liberal use of<tt> + 1</tt>, like this:</p>
<p><img loading="lazy" src="http://news-sophos.go-vip.net/wp-content/uploads/sites/2/2014/07/ks-oneoff-500.png" width="500" height="116" style="margin:0;padding:0;margin-top:0;margin-bottom:.6em;"></img> </p>
<h4>Advice for C programmers</h4>
<p>Try these tips:</p>
<ul>
<li>Avoid allocating string buffers on the stack. Unlike heap overflows, it&#8217;s much easier for a hacker to predict what other variables might be overwritten if an overflow should happen.
<li>Always keep track of string sizes, and check that there is space before writing to a buffer. Even you feel certain that your checks are redundant, put them in. If nothing else, it makes your code safer against future changes, and easier for others to understand.
<li>Never tell yourself that &#8220;buffers are always larger than the maximum space we need,&#8221; especially if you allow them to be filled from input buffers of unlimited size passed in by an app that uses your code.
<li>Don&#8217;t let code through review or QA if it makes claims like &#8220;boundary checks on buffers are omitted as unnecessary.&#8221; They probably <em>are</em> necessary, and even if they aren&#8217;t, they are always desirable.
</ul>
<p>In short: write your code under the assumption that it will be reviewed by another programmer who is <strong>meticulous, severe and pedantic</strong>; and that it will be called by a crook who is <strong>devious, motivated and persistent</strong>.</p>
<p>By all means expect the best, but never forget to prepare for the worst.</p>
<p style='padding-bottom:.8em;padding-top:.8em;'></p>
			</div> <!-- .entry-content -->
	<ul class="block social follow">
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon twitter"><use xlink:href="#twitter"></use></svg>
			<p>Follow <strong><a href="https://twitter.com/nakedsecurity">@NakedSecurity on Twitter</a></strong> for the latest computer security news.</p>
		</li>
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon instagram"><use xlink:href="#instagram"></use></svg>
			<p>Follow <strong><a href="https://www.instagram.com/nakedsecurity/">@NakedSecurity on Instagram</a></strong> for exclusive pics, gifs, vids and LOLs!</p>
		</li>
	</ul>
</article><!-- #post-## -->

		<div class="free-tools-block">
			<h2 class="block-title">Free tools</h2>

<div class="ns-free-tools">
	<div class="ns-free-tools__item ns-free-tools__item--sophos-home">
		<a class="ns-free-tools__link" href="https://home.sophos.com/en-us.aspx?cmp=701j0000001eLpnAAE">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/sophos-home@2x.png" alt="Sophos Home" class="ns-free-tools__image" width="166" height="100">
			<h4 class="ns-free-tools__title">
				Sophos Home			</h4>
			<div class="ns-free-tools__sub-title">
				Protect personal PCs and Macs			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--hitman-pro">
		<a class="ns-free-tools__link" href="https://www.hitmanpro.com/en-us/hmp.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/hitman-pro@2x.png" alt="Hitman Pro" class="ns-free-tools__image" width="154" height="100">
			<h4 class="ns-free-tools__title">
				Hitman Pro			</h4>
			<div class="ns-free-tools__sub-title">
				Find and remove malware			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--intercept-x">
		<a class="ns-free-tools__link" href="https://www.sophos.com/en-us/products/free-tools/sophos-mobile-security-free-edition.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/mobile-security-android@2x.png" alt="Sophos Intercept X for Mobile" class="ns-free-tools__image" width="96" height="110">
			<h4 class="ns-free-tools__title">
				Intercept X for Mobile			</h4>
			<div class="ns-free-tools__sub-title">
				Protect Android devices			</div>
		</a>
	</div>
</div>
		</div>

			<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2014/07/02/supreme-court-refuses-to-drag-google-out-of-its-street-view-privacy-wreckage/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> Supreme Court refuses to drag Google out of its Street View privacy wreckage</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2014/07/02/did-facebooks-emotion-experiment-break-the-law-ico-probes/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Did Facebook&#8217;s emotion experiment break the law? ICO probes</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	
	</main><!-- #main -->

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<section class="comments-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

			
<div id="comments" class="comments-area">

			<h2 class="comments-title">
			4 comments on &ldquo;<span>Anatomy of a buffer overflow &#8211; Google&#8217;s &#8220;KeyStore&#8221; security module for Android</span>&rdquo;		</h2>

		<ol class="comment-list">
					<li id="comment-3045889" class="comment even thread-even depth-1">
			<article id="div-comment-3045889" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/f2ce1fd67c0f1ef907e1f80e802e183b?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f2ce1fd67c0f1ef907e1f80e802e183b?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">blackjackshellac</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/07/02/anatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android/#comment-3045889"><time datetime="2014-07-02T12:33:44+01:00">July 2, 2014 at 12:33 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Comments: Why is this string being allocated on the stack?  Why is the length of the string not parametrized in the subsequent function calls?  Strings in C are not objects, their length always has to be passed with them.  Jesus christ, what is this, 1996?</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_3045889"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_3045889={"id":7238218,"unique_id":"wp-comment-3045889","title":"Comments%3A%20Why%20is%20this%20string%20being%20allocated%20on%20the%20stack%3F%20%20Why%20is%20the%20length%20of%20the%20string%20not%20parametrized%20in%20the%20subsequent%20function%20calls%3F%20%20Strings%20in%20C%20are%20not%20objects%2C%20their%20length%20always%20h%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/07\/02\/anatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android\/#comment-3045889","item_id":"_comm_3045889"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/07/02/anatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android/?replytocom=3045889#respond' data-commentid="3045889" data-postid="264109" data-belowelement="div-comment-3045889" data-respondelement="respond" data-replyto="Reply to blackjackshellac" aria-label='Reply to blackjackshellac'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-3046659" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-3046659" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/f99062602b5372db84cb1959cdf4cd1c?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f99062602b5372db84cb1959cdf4cd1c?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Bob</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/07/02/anatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android/#comment-3046659"><time datetime="2014-07-02T17:27:56+01:00">July 2, 2014 at 5:27 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I don&#8217;t know whether to laugh or cry &#8211; probably cry.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_3046659"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_3046659={"id":7238218,"unique_id":"wp-comment-3046659","title":"I%20don%26%23039%3Bt%20know%20whether%20to%20laugh%20or%20cry%20-%20probably%20cry.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/07\/02\/anatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android\/#comment-3046659","item_id":"_comm_3046659"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/07/02/anatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android/?replytocom=3046659#respond' data-commentid="3046659" data-postid="264109" data-belowelement="div-comment-3046659" data-respondelement="respond" data-replyto="Reply to Bob" aria-label='Reply to Bob'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-3047049" class="comment byuser comment-author-pducklin bypostauthor even depth-2">
			<article id="div-comment-3047049" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/07/02/anatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android/#comment-3047049"><time datetime="2014-07-02T19:24:58+01:00">July 2, 2014 at 7:24 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Maybe you could just do one of those smiles that segues into a grimace?</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_3047049"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_3047049={"id":7238218,"unique_id":"wp-comment-3047049","title":"Maybe%20you%20could%20just%20do%20one%20of%20those%20smiles%20that%20segues%20into%20a%20grimace%3F%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/07\/02\/anatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android\/#comment-3047049","item_id":"_comm_3047049"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/07/02/anatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android/?replytocom=3047049#respond' data-commentid="3047049" data-postid="264109" data-belowelement="div-comment-3047049" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-3050300" class="comment odd alt thread-even depth-1">
			<article id="div-comment-3050300" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/cc262391460a40fa69d90d081021c60a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/cc262391460a40fa69d90d081021c60a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">VL-S</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2014/07/02/anatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android/#comment-3050300"><time datetime="2014-07-03T13:29:16+01:00">July 3, 2014 at 1:29 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Just a question about revisions. By 4.4 do you mean 4.4.n. I ask this because my Nexus just updated from 4.4.3 to 4.4.4.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_3050300"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_3050300={"id":7238218,"unique_id":"wp-comment-3050300","title":"Just%20a%20question%20about%20revisions.%20By%204.4%20do%20you%20mean%204.4.n.%20I%20ask%20this%20because%20my%20Nexus%20just%20updated%20from%204.4.3%20to%204.4.4.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2014\/07\/02\/anatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android\/#comment-3050300","item_id":"_comm_3050300"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2014/07/02/anatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android/?replytocom=3050300#respond' data-commentid="3050300" data-postid="264109" data-belowelement="div-comment-3050300" data-respondelement="respond" data-replyto="Reply to VL-S" aria-label='Reply to VL-S'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">What do you think? <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2014/07/02/anatomy-of-a-buffer-overflow-googles-keystore-security-module-for-android/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://nakedsecurity.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='264109' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="300ae7f702" /></p><input type="hidden" id="ak_js" name="ak_js" value="101"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->
		<div class="comments-widget-area">
					</div>
	
	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	

	<section class="recommended-panel">
	<div class="container">
	<div class="panel-content ">

		<h3 class="block-title">Recommended reads</h3>
	<div class="blocks">
		<article id="post-561003" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/03/11/s3-ep23-hafnium-happenings-i-see-you-and-pythonic-poison-podcast/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/nean-with-mic-wt-orangey-1200.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Mar</span><span class="day">11</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">1</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/03/11/s3-ep23-hafnium-happenings-i-see-you-and-pythonic-poison-podcast/" rel="bookmark">S3 Ep23: Hafnium happenings, I see you, and Pythonic poison [Podcast]</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-561053" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/03/15/s3-ep-23-5-an-interview-with-cybersecurity-expert-john-noble-cbe/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/jncbe.001.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Mar</span><span class="day">15</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">2</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/03/15/s3-ep-23-5-an-interview-with-cybersecurity-expert-john-noble-cbe/" rel="bookmark">S3 Ep 23.5: An interview with cybersecurity expert John Noble CBE [Podcast]</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-545207" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/02/11/s3-ep19-chrome-zero-day-coffee-hacking-and-perl-com-stolen-podcast/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/02/nean-with-mic-wt-coffee-1200-1.jpg?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Feb</span><span class="day">11</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">0</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/02/11/s3-ep19-chrome-zero-day-coffee-hacking-and-perl-com-stolen-podcast/" rel="bookmark">S3 Ep19: Chrome zero-day, coffee hacking and Perl.com stolen [Podcast]</a></h3>	</div>
</article> <!-- .card-article -->
	</div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="footer-container">
			<a href="#" class="js-collapse-footer"><svg style="height: 20px" viewBox="0 0 132 24" class="block icon sophos"><use xlink:href="#sophos"></use></svg></a>
			<div id="collapseFooter" class="blocks">
				<div class="sophos block">
					<ul id="menu-footer-primary" class="primary menu"><li id="menu-item-306737" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306737"><a href="https://nakedsecurity.sophos.com/about/">About Naked Security</a></li>
<li id="menu-item-306754" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306754"><a href="https://www.sophos.com/en-us/company.aspx">About Sophos</a></li>
<li id="menu-item-306747" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306747"><a href="https://nakedsecurity.sophos.com/send-us-a-tip/">Send us a tip</a></li>
<li id="menu-item-323171" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323171"><a href="/cookies-and-scripts/">Cookies</a></li>
<li id="menu-item-323170" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323170"><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
<li id="menu-item-323169" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323169"><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
</ul>				</div>
										<div class="news block">
							<ul id="menu-products-column-one" class="small menu"><li id="menu-item-306998" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306998"><a href="https://www.sophos.com/en-us/products/intercept-x.aspx">Intercept X</a></li>
<li id="menu-item-440801" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440801"><a href="https://www.sophos.com/en-us/products/server-security.aspx">Intercept X for Server</a></li>
<li id="menu-item-440802" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440802"><a href="https://www.sophos.com/en-us/products/mobile-control.aspx">Intercept X for Mobile</a></li>
</ul>						</div>
											<div class="products block">
							<ul id="menu-products-column-two" class="small menu"><li id="menu-item-440803" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440803"><a href="https://www.sophos.com/en-us/products/next-gen-firewall.aspx">XG Firewall</a></li>
<li id="menu-item-440805" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440805"><a href="https://www.sophos.com/en-us/products/sophos-email.aspx">Sophos Email</a></li>
<li id="menu-item-440804" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440804"><a href="https://www.sophos.com/en-us/products/secure-wifi.aspx">Sophos Wireless</a></li>
</ul>						</div>
											<div class="threats block">
							<ul id="menu-server-protection" class="small menu"><li id="menu-item-440806" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440806"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx">Managed Threat Response</a></li>
<li id="menu-item-448404" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-448404"><a href="https://www.sophos.com/en-us/products/cloud-optix.aspx">Cloud Optix</a></li>
<li id="menu-item-440807" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440807"><a href="https://www.sophos.com/en-us/products/phish-threat.aspx">Phish Threat</a></li>
</ul>						</div>
								</div>
			<ul class="block social footer">
				<li class="twitter"><a rel="nofollow" href="https://twitter.com/NakedSecurity" title="Follow our team of security experts on Twitter"><svg style="height: 14px" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
				<li class="facebook"><a rel="nofollow" href="https://www.facebook.com/SophosSecurity" title="Join over 250,000 people in our Facebook community"><svg style="height: 14px" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
				<li class="instagram"><a rel="nofollow" href="https://www.instagram.com/nakedsecurity/" title="Follow Naked Security on Instagram"><svg style="height: 14px" viewBox="0 0 100 100" class="icon instagram"><use xlink:href="#instagram"></use></svg></a></li>
				<li class="linkedin"><a rel="nofollow" href="https://www.linkedin.com/company/5053/" title="Join the naked security discussion group on LinkedIn"><svg style="height: 14px" viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
				<li class="rss"><a rel="nofollow" href="/feed" title="Subscribe to our RSS feed"><svg style="height: 14px" viewBox="0 0 100 100" class="icon rss"><use xlink:href="#rss"></use></svg></a></li>
			</ul>

							<div class="vip-powered-wpcom">
					<span class="copyright">© 1997 - 2021 Sophos Ltd.</span>
					All rights reserved.
					Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=nakedsecurity.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>				</div>
					</div>
		<script type="text/javascript">
			window.cookieconsent_options = {
				"message":"This site uses cookies. By continuing to browse the site you are agreeing to our use of cookies.",
				"dismiss":"Got it!",
				"learnMore":"Learn More",
				"link":"/cookies-and-scripts",
				"theme":"https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/css/sophos.css"};
		</script>
	</footer><!-- #colophon -->
</div><!-- #page -->
<div id="survey-wrapper" class="mfp-hide"><div class="pd-embed" id="pd_1499706777" data-settings=""></div></div>
<script id='child-js-plugins-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"0","nextLink":""};
</script>
<script id='child-js-core-js-extra'>
var Sophos = {"ajaxurl":"https:\/\/nakedsecurity.sophos.com\/wp-admin\/admin-ajax.php","nonce":"64f6810f0c"};
</script>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJyNjkEOwjAMBD9EalKU3hBPQZAamhDbUZyo4vdEiEocOHD07ozWsGbjhStyhbogoYJKXkQZVzXj3jqICjm1e2Adou7gL8FLwY0O7FObO/fOibppCub0HCjwL6ifSFecv/ttkpr5PAOXR1DCCufuwk0KdfZERztZdxitc1N8ARFpT3A='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161173',post:'264109',tz:'0',srv:'nakedsecurity.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161173', '264109' ]);
</script>
</body>
</html>
