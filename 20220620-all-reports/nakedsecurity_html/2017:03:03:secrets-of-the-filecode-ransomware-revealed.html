<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="RHQeasQqjasbRt5asY6atZYbs5tr10gFBevDt2HRhW0" />
<link rel="pingback" href="https://nakedsecurity.sophos.com/xmlrpc.php">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5VK6LTK');</script>
<!-- End Google Tag Manager -->

<meta name="description" content="Cryptography can be fun! Our resident cryptosplainer Paul Ducklin shows how to recover from the Filecode ransomware without paying up." />
<meta name="keywords" content="cryptography, ransomware, cracking, cryptography, macos, os x, ransomware" />
<title>Secrets of the Filecode ransomware revealed &#8211; Naked Security</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="I9dHFo-YhnK2MfAHn-20V4GnWrOttVUYyISGamyU41M" />
<meta name="msvalidate.01" content="7D8D1FA2892142B1543D2CBCD07FB88F" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Feed" href="https://nakedsecurity.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Comments Feed" href="https://nakedsecurity.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Secrets of the Filecode ransomware revealed Comments Feed" href="https://nakedsecurity.sophos.com/2017/03/03/secrets-of-the-filecode-ransomware-revealed/feed/" />
<link rel='stylesheet' id='all-css-0' href='https://nakedsecurity.sophos.com/_static/??-eJyVz00KwjAQhuELmUwjptCFeJY0HUw0f2QmlN6+KXbnRpcD7wPfwFqETza0BQksESyeGOaQ7VsEP1dTNyDeAsrok+zBBbqwOTEmBnYYu6NcXKaEK4nroPQJ/olFMIzEv5pjqFkku4qGhWs9rtLE8uVjEyW0p08EL+Ri+leT/PjzPsgj3tWo9G0ctJp2dx1jEg==' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpmWEWAK8/Ihc='></script>
<link rel="https://api.w.org/" href="https://nakedsecurity.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://nakedsecurity.sophos.com/wp-json/wp/v2/posts/363253" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://nakedsecurity.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://nakedsecurity.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://nakedsecurity.sophos.com/2017/03/03/secrets-of-the-filecode-ransomware-revealed/" />
<link rel='shortlink' href='https://nakedsecurity.sophos.com/?p=363253' />
<link rel="alternate" type="application/json+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2017%2F03%2F03%2Fsecrets-of-the-filecode-ransomware-revealed%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2017%2F03%2F03%2Fsecrets-of-the-filecode-ransomware-revealed%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://nakedsecurity.sophos.com/2017/03/03/secrets-of-the-filecode-ransomware-revealed/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Secrets of the Filecode ransomware revealed" />
<meta property="og:url" content="https://nakedsecurity.sophos.com/2017/03/03/secrets-of-the-filecode-ransomware-revealed/" />
<meta property="og:description" content="Cryptography can be fun! Our resident cryptosplainer Paul Ducklin shows how to recover from the Filecode ransomware without paying up." />
<meta property="article:published_time" content="2017-03-03T17:02:40+00:00" />
<meta property="article:modified_time" content="2017-03-03T17:02:40+00:00" />
<meta property="og:site_name" content="Naked Security" />
<meta property="og:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2017/03/fc-pixels-1200.jpg?w=775" />
<meta property="og:image:secure_url" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2017/03/fc-pixels-1200.jpg?w=775" />
<meta property="og:image:width" content="775" />
<meta property="og:image:height" content="405" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@NakedSecurity" />
<meta name="twitter:text:title" content="Secrets of the Filecode ransomware revealed" />
<meta name="twitter:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2017/03/fc-pixels-1200.jpg?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=270" />
</head>
<body class="post-template-default single single-post postid-363253 single-format-standard" >
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VK6LTK"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div style="display: none">
<svg>
	<symbol id="sophos" viewBox="0 0 132 24">
		<path d="m111.82 22.176h11.64c3.267 0 4.65-0.2 5.74-0.896 1.715-1.063 2.804-3.26 2.804-5.62 0-1.928-0.658-3.89-1.647-4.888-1.288-1.33-3.035-1.828-6.271-1.828h-3.527c-1.586 0-2.754-0.067-3.412-0.365-0.794-0.367-1.256-1.165-1.256-2.161 0-1.165 0.56-2.03 1.486-2.264 0.692-0.163 1.498-0.163 3.574-0.198h10.419v-3.956h-11.473c-2.574 0-3.727 0.099-4.718 0.466-2.279 0.796-3.828 3.257-3.828 6.083 0 1.93 0.76 3.727 2.079 4.89 1.155 0.996 2.872 1.462 5.51 1.462h4.697c1.057 0 1.915 0.132 2.376 0.398 0.893 0.433 1.418 1.328 1.418 2.36 0 0.864-0.395 1.597-1.087 2.027-0.561 0.369-1.517 0.534-3.268 0.534h-11.256zm-111.35 0h11.64c3.267 0 4.652-0.2 5.741-0.896 1.714-1.063 2.803-3.26 2.803-5.62 0-1.928-0.66-3.89-1.65-4.888-1.285-1.33-3.034-1.828-6.27-1.828h-3.527c-1.584 0-2.751-0.067-3.41-0.365-0.792-0.367-1.253-1.165-1.253-2.161 0-1.165 0.56-2.03 1.484-2.264 0.693-0.163 1.496-0.163 3.574-0.198h10.42v-3.956h-11.477c-2.573 0-3.727 0.099-4.715 0.466-2.278 0.796-3.83 3.257-3.83 6.083 0 1.93 0.762 3.727 2.08 4.89 1.155 0.996 2.871 1.462 5.51 1.462h4.696c1.057 0 1.913 0.132 2.377 0.398 0.888 0.433 1.416 1.328 1.416 2.36 0 0.864-0.394 1.597-1.089 2.027-0.558 0.369-1.517 0.534-3.264 0.534h-11.256v3.956zm94.05-16.18c-0.68 1.076-1.003 2.803-1.003 5.122 0 5.088 1.747 7.405 5.63 7.405 3.822 0 5.568-2.317 5.568-7.34 0-5.092-1.715-7.373-5.568-7.373-2.102 0-3.754 0.784-4.627 2.186zm13.174-2.511c1.329 1.761 2.072 4.63 2.072 7.992 0 3.816-1.197 6.948-3.334 8.677-1.619 1.304-4.078 2.022-6.995 2.022-4.142 0-7.41-1.372-9.092-3.817-1.263-1.793-1.88-4.176-1.88-7.08 0-4.172 1.133-7.339 3.27-9.035 1.682-1.37 4.339-2.122 7.383-2.122 3.85 0 6.925 1.209 8.576 3.363zm-22.018-3.068h-4.596v8.908h-8.319v-8.908h-4.597v21.759h4.597v-8.97h8.318v8.97h4.596v-21.759zm-28.61 10.277c1.23 0 1.941-0.163 2.427-0.62 0.581-0.49 0.938-1.533 0.938-2.74 0-1.436-0.58-2.478-1.584-2.838-0.356-0.13-0.94-0.197-1.684-0.197h-6.344v6.395zm-6.247 11.481h-4.598v-21.758h10.78c3.786 0 5.114 0.39 6.538 1.991 1.264 1.37 1.942 3.163 1.942 5.088 0 2.284-0.904 4.404-2.394 5.676-1.262 1.077-2.43 1.402-4.888 1.402h-7.38zm-22.589-16.179c-0.682 1.076-1.004 2.803-1.004 5.122 0 5.088 1.748 7.405 5.634 7.405 3.818 0 5.568-2.317 5.568-7.34 0-5.092-1.716-7.373-5.568-7.373-2.106 0-3.757 0.784-4.63 2.186zm13.174-2.511c1.328 1.761 2.073 4.63 2.073 7.992 0 3.816-1.2 6.948-3.335 8.677-1.618 1.304-4.079 2.022-6.993 2.022-4.144 0-7.413-1.372-9.096-3.817-1.264-1.793-1.878-4.176-1.878-7.08 0-4.172 1.133-7.339 3.272-9.035 1.681-1.37 4.337-2.122 7.38-2.122 3.851 0 6.93 1.209 8.578 3.363z"></path>
	</symbol>
	<symbol id="twitter" viewBox="0 0 24 24">
 		<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path>
 	</symbol>
	<symbol id="facebook" viewBox="0 0 24 24">
 		<path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path>
 	</symbol>
	<symbol id="instagram" viewBox="0 0 24 24">
		<path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path>
	</symbol>
	<symbol id="linkedin" viewBox="0 0 24 24">
		<path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"></path>
	</symbol>
	<symbol id="rss" viewBox="0 0 24 24">
		<path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"></path>
	</symbol>
	<symbol id="reddit" viewBox="0 0 24 24">
		<path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"></path>
	</symbol>
</svg>
</div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header variation variation-3" role="banner">
		<div class="header-container">
			<div class="site-branding">
				<div class="site-title">
					<a title="Naked Security" href="https://nakedsecurity.sophos.com/" rel="home"><img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/naked-security-logo-white@2x.png"></a>
					by
					<a title="sophos.com" href="https://www.sophos.com"><svg viewBox="0 0 132 24" class="icon sophos"><use xlink:href="#sophos"></use></svg></a>
				</div>
			</div><!-- .site-branding -->
			<nav id="site-navigation" class="main-navigation" role="navigation">
				<div class="container">
					<ul id="menu-variation-two" class="exit-links menu"><li id="menu-item-436509" class="products menu-item menu-item-type-custom menu-item-object-custom menu-item-436509"><a href="#">Products</a></li>
<li id="menu-item-436515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436515"><a href="https://www.sophos.com/en-us/products/free-tools.aspx">Free Tools</a></li>
<li id="menu-item-436531" class="search-toggle menu-item menu-item-type-custom menu-item-object-custom menu-item-436531"><a href="#">Search</a></li>
<li id="menu-item-436532" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436532"><a href="https://home.sophos.com/en-us.aspx">Free Sophos Home</a></li>
</ul>				</div>
			</nav><!-- #site-navigation -->
			<div class="site-search-block">
	<form target="_top" role="search" class="search-form" method="get" action="https://nakedsecurity.sophos.com/">
        <fieldset>
            <div class="field">
				<input type="search" value="" name="s" class="search-field" placeholder="Search naked security...">
            </div>
            <div class="submit">
				<button type="submit" class="search-submit button">Go</button>
            </div>
        </fieldset>
    </form>
</div>
		</div><!-- .container -->
	</header>

	<div class="responsive-flyout-panel small-12 column active" style="opacity: 1; display: none;">
		<div class="modal-filler"></div>
	    <div class="productNavBox">
	        <div class="productNavContainer">
	            <div class="row prodRow">
	                <div class="prodListBox column large-9">
	                    <div class="row margin-0 highlightProduct">
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/next-gen-firewall.aspx"><img src="https://www.sophos.com/medialibrary/2F4785DE8C3F43ECBD699A18F332FEEB.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">XG Firewall</div>
	                                	<div class="menu-section-subtitle">Next-Gen Firewall</div>
									</div>
	                            </a>
	                        </div>
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/intercept-x.aspx"><img src="https://www.sophos.com/medialibrary/27111765D65A45D49A232925D2CE428B.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">Intercept X</div>
	                                	<div class="menu-section-subtitle">Next-Gen Endpoint</div>
									</div>
	                            </a>
	                        </div>
	                    </div>
	                    <div class="productList">
	                        <ul>
								<li>
									<a href="https://www.sophos.com/en-us/products/cloud-optix.aspx"><img src="https://www.sophos.com/medialibrary/SophosNext/Images/Products/Icons/sophos-cloud-optix-icon.svg">Sophos Cloud Optix</a>
								</li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-central.aspx"><img src="https://www.sophos.com/medialibrary/08EA66123F1B4DDE8FE5C9B578A7FAA7.ashx">Sophos Central</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/mobile-control.aspx"><img src="https://www.sophos.com/medialibrary/678FE994855047739F50D6C411184FA6.ashx">Sophos Mobile</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/server-security.aspx"><img src="https://www.sophos.com/medialibrary/01B80E7D7CD54EF8AC2E51C9C6EC0236.ashx">Intercept X for Server</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-wifi.aspx"><img src="https://www.sophos.com/medialibrary/BEBD9C41BB4E480498514B29B92A145A.ashx">Secure Wi-Fi</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/phish-threat.aspx"><img src="https://www.sophos.com/medialibrary/DC9D1A7BA3964B0C9DAF1F1E68806B5A.ashx">Phish Threat</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/safeguard-encryption.aspx"><img src="https://www.sophos.com/medialibrary/8F51F06B62814B108D3B2763FF018E37.ashx">SafeGuard Encryption</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-email.aspx"><img src="https://www.sophos.com/medialibrary/597ADA0AF01A4A12B2B27239D0F9992C.ashx">Secure Email</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/unified-threat-management.aspx"><img src="https://www.sophos.com/medialibrary/8CB72BF5E1AD41F7894CE5E42101B0F3.ashx">SG UTM</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-web-gateway.aspx"><img src="https://www.sophos.com/medialibrary/C586E372694547A1B207A61D87246BA7.ashx">Secure Web Gateway</a>
	                            </li>
	                        </ul>
	                    </div>
	                </div>
	                <div class="homeUserBox column large-3">
						<img src="https://www.sophos.com/medialibrary/3376DF5742A64AEE93FDB9DCA7291239.ashx">
						<div class="menu-section-title">For Home Users</div>
	                    <p>Sophos Home protects every Mac and PC in your home </p><a href="https://home.sophos.com/" target="_blank" class="greenSmallMenuBtn">Learn More</a>
					</div>
	            </div>
	            <div class="row blueRow">
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-tools.aspx"><img width="19" src="https://www.sophos.com/medialibrary/A1FF440D2BB84511B8C94D771D44E207.ashx">Free Security Tools</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-trials.aspx"><img width="20" src="https://www.sophos.com/medialibrary/FCD3410ED2C347808D9DB8AC12C62DBD.ashx">Free Trials</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/demos.aspx"><img width="18" src="https://www.sophos.com/medialibrary/50985180E5F54C94917A2A6508E24287.ashx">Product Demos</a>
	                </div>
	                <!-- <div class="column large-3 medium-6">
	                    <a href="javascript:fairfax.openLiveChatFromFlyoutLink();" class="flyout-live-chat-link"><img width="20" src="https://www.sophos.com/medialibrary/E24C5050837145F6A5C592E299BA2A0D.ashx">Live Sales Chat</a>
	                </div> -->
	            </div>
	        </div>
	    </div>
	</div>
	<script>

	jQuery(document).ready( function () {
		var productButton   = jQuery('nav .menu-item.products');
		var modalBackground = jQuery('.modal-filler');
		var flyoutMenu		= jQuery('.responsive-flyout-panel');
		var Sophos			= Sophos || {};

		Sophos.MenuTest = {};

		Sophos.MenuTest.open = function () {
				productButton.addClass('open');
				flyoutMenu.show();
				modalBackground.show();
		};

		Sophos.MenuTest.close = function () {
			productButton.removeClass('open');
			flyoutMenu.hide();
			modalBackground.hide();
		};

		Sophos.MenuTest.toggle = function () {
			if ( productButton.hasClass('open') ) {
				Sophos.MenuTest.close();
			} else {
				Sophos.MenuTest.open();
			}
		};

		productButton.click( Sophos.MenuTest.toggle );
		modalBackground.click( Sophos.MenuTest.close );
	});

	</script>

	
	<section class="about-panel">
	<div class="container">
	<div class="panel-content ">

		<div class="description"><span>Have you listened to our podcast? <a href="/podcast/">Listen now</a></span></div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	<div id="content" class="site-content">
		<div class="content-container">

</div> <!-- .container -->
</div> <!-- #content -->


	<section class="content-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

		<main id="main" class="site-main" role="main">

	
		
<article id="post-363253" class="post-363253 post type-post status-publish format-standard has-post-thumbnail hentry category-cryptography category-featured category-ransomware-malware tag-cracking tag-cryptography tag-macos tag-os-x tag-ransomware">

	<header class="entry-header">
		<h1 class="entry-title">Secrets of the Filecode ransomware revealed</h1>		<div class="entry-meta">
			<div>
				
	<span class="entry-published">
		<time class="entry-date published" datetime="2017-03-03T17:02:40+00:00">03 Mar 2017</time>
	</span>

					<a href="#comments" class="comment-box">
					<span class="count">3</span>
				</a>
					
	<span class="entry-categories">
	<a href="https://nakedsecurity.sophos.com/category/cryptography/">Cryptography</a>, <a href="https://nakedsecurity.sophos.com/category/security-threats/malware/ransomware-malware/">Ransomware</a>	</span>

			</div>
	</header> <!-- .entry-header -->

    <div id="newsletter-signup" class="container top"></div>

			<div class="entry-featured-image">
			<img width="780" height="408" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2017/03/fc-pixels-1200.jpg?w=780&amp;h=408&amp;crop=1" class="attachment-hero-thumbnail size-hero-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2017/03/fc-pixels-1200.jpg 1200w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2017/03/fc-pixels-1200.jpg?resize=300,157 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2017/03/fc-pixels-1200.jpg?resize=768,401 768w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2017/03/fc-pixels-1200.jpg?resize=1024,535 1024w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2017/03/fc-pixels-1200.jpg?resize=780,408 780w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2017/03/fc-pixels-1200.jpg?resize=100,52 100w" sizes="(max-width: 780px) 100vw, 780px" />					</div> <!-- .entry-featured-image -->
		
		<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2017/03/03/apple-pushing-two-factor-authentication-for-ios-10-3-users/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> Apple pushing two-factor authentication for iOS 10.3 users</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2017/03/03/amazon-mega-outage-caused-by-single-command-line-error/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Amazon mega-outage caused by single command line error</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	<div class="entry-content">
		<div class="entry-prefix">
			<div class="entry-author">
				
	
					<span class="by">by</span>
			<a href="https://nakedsecurity.sophos.com/author/paul-ducklin/" title="Posts by Paul Ducklin" class="author url fn" rel="author">Paul Ducklin</a>		
	
				</div>
			<div class="entry-sharing">
				
	<ul class="block social share">
		<li class="facebook"><a href="https://www.facebook.com/share.php?u=https%3A%2F%2Fnakedsecurity.sophos.com%2F2017%2F03%2F03%2Fsecrets-of-the-filecode-ransomware-revealed%2F&title=Secrets+of+the+Filecode+ransomware+revealed" data-title="Secrets of the Filecode ransomware revealed" title="Share on Facebook"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
		<li class="twitter"><a href="https://twitter.com/intent/tweet?text=Secrets+of+the+Filecode+ransomware+revealed+https%3A%2F%2Fnakedsecurity.sophos.com%2F%3Fp%3D363253" data-title="Secrets of the Filecode ransomware revealed" title="Share on Twitter"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
		<li class="linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2017%2F03%2F03%2Fsecrets-of-the-filecode-ransomware-revealed%2F&title=Secrets+of+the+Filecode+ransomware+revealed" data-title="Secrets of the Filecode ransomware revealed" title="Share on LinkedIn"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
		<li class="reddit"><a href="https://reddit.com/submit/?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2017%2F03%2F03%2Fsecrets-of-the-filecode-ransomware-revealed%2F&title=Secrets+of+the+Filecode+ransomware+revealed" title="Share on Reddit"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon reddit"><use xlink:href="#reddit"></use></svg></a></li>

			</ul>

				</div>
		</div>
		<p>Earlier this week we wrote about <strong>OSX/Filecode</strong>, a <a href="https://nakedsecurity.sophos.com/2017/02/28/filecode-ransomware-attacks-your-mac-how-to-recover-for-free/">Mac ransomware family</a> that follows a path of digital extortion that is well-known to Windows users.</p>
<p>Generally speaking, ransomware hits when you download a file, or are tricked into running an attachment, that claims to be one thing, anywhere from a fake invoice to a software crack&#8230;</p>
<p>&#8230;but turns out to be quite another.</p>
<aside id="sophos_ad-3" class="widget sophos-inline-ad sophos_widget_ad">				<style></style>
				<div class="sophos_widget_ad"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx" class="s-ad-threat-hunter__link-wrapper">
  <div class="s-ad-threat-hunter">
    <div class="s-ad-threat-hunter__title">
      OTHERS STOP AT NOTIFICATION. WE TAKE ACTION
    </div>
    <div class="s-ad-threat-hunter__text">
      Get 24/7 managed threat hunting, detection, and response delivered by
      Sophos experts
    </div>
    <div class="s-ad-threat-hunter__action">
      <span class="s-button s-button--bright-green"> Learn&nbsp;more </span>
    </div>
  </div>
</a></div>
			</aside>
<p><strong>Filecode</strong> <a href="https://nakedsecurity.sophos.com/2017/02/28/filecode-ransomware-attacks-your-mac-how-to-recover-for-free/">pretends to be a cracking tool</a>.</p>
<p>The malware pops up a dialog to say that it &#8220;may take up to 10 minutes&#8221; to do its job, which is supposedly to hack Adobe Premiere or Office 2016 so you can keep on using it without paying the licensing fees:</p>
<p><img loading="lazy" src="https://news-sophos.go-vip.net/wp-content/uploads/sites/2/2017/02/filecode-after-768.png" width="768" height="578" class="aligncenter wp-image-362965" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2017/02/filecode-after-768.png 768w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2017/02/filecode-after-768.png?resize=300,226 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2017/02/filecode-after-768.png?resize=93,70 93w" sizes="(max-width: 768px) 100vw, 768px" /></p>
<p>Software cracks of this sort do exist, and some of them may even work, but figuring out when you can trust shady software from shady corners of the internet that you downloaded for your own shady purpose&#8230;</p>
<p>&#8230;is always going to be a hard task.</p>
<p>The good news is that Filecode doesn&#8217;t contain any software cracking code that might get you in trouble with the piracy police.</p>
<p>The bad news is that it is entirely focused on scrambling your data, using a randomly-generated 25-character encryption key that exists only in memory while the malware runs.</p>
<p>After that, the malware author gives you instructions on how to pay him a ransom, in return for which he&#8217;ll unscramble the data for you.</p>
<p>This raises two questions. </p>
<p>If the decryption key is lost after the malware finishes running, how can the crook possibly recover your files?</p>
<p>And if he can do it, what&#8217;s to stop you following the same process and recovering them for yourself for free?</p>
<p>Most ransomware creators deal with these decryption issues in one of these ways:</p>
<ol>
<li> <strong>Call home first to a web server that generates an random encryption key on demand.</strong> This way, the crooks have a guaranteed record of the decryption key that matches your computer, but you don&#8217;t. The generated key is what they sell back to you later. If your network security software blocks the call-home request, the ransomware is stalled and can&#8217;t run at all.
<li> <strong>Generate a random key locally and use it in memory only, but call home during or immediately after the encryption process to backup the key remotely.</strong> If you block the call-home request in cases like this, the ransomware runs but the key is lost.
<li> <strong>Generate a random key locally, use it, and save it locally after encrypting it again with a public key.</strong> As long as the crooks keep the corresponding private key to themselves, they alone can decrypt the decryption key that you need. (It&#8217;s OK if you need to read that twice.)
</ol>
<p style="background-color:#e8e8e8;font-size:80%;padding:1em 2em;margin:2em 0;">Approach (3) works because of the difference between <em>symmetric</em> and <em>asymmetric</em> encryption. Symmetric, or <em>secret-key</em>, cryptography uses the same key to lock and unlock data, and it is usually used for protecting large quantities of data such as disks and files. But if you want to share symmetrically-encrypted data across the internet, you need a secure way to share the secret key first. Asymmetric, or <em>public-key</em>, cryptography uses a different key to lock and unlock, making it an excellent tool for sharing data securely over a network. You share your public key with everyone so they can lock data to send it to you; you keep your private key private so you&#8217;re the only one who can unlock the data at the other end. That way, it can&#8217;t be snooped or modified in transit. But public-key cryptography is far too slow for encrypting files and disks, so a hybrid approach is used: encrypt the data with a random symmetric key, and encrypt the symmetric key with the public key. Now, only the holder of the private key can unlock the symmetric key, so only the holder of the private key can unlock the symmetrically-encrypted data. </p>
<p>Filecode, however, doesn&#8217;t use any of these methods.</p>
<p>The malware uses the <code>zip</code> program to encrypt all your files with a randomly-chosen 25-character password, and throws the key away.</p>
<p>The crook then tells you to pay him 0.25 bitcoins (BTC 0.25 was about $300 at the end of February 2017), hook your computer up to the internet so he can access it remotely, and contact him by email to let him know you&#8217;re ready.</p>
<p>He says that, within 24 hours (or within 10 minutes if you pay the premium fee of BTC 0.45 instead) he&#8217;ll connect into your Mac and recover your files:</p>
<p><img loading="lazy" src="https://news-sophos.go-vip.net/wp-content/uploads/sites/2/2017/02/filecode-readme-640.png" width="640" height="530" class="aligncenter size-full wp-image-362962" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2017/02/filecode-readme-640.png 640w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2017/02/filecode-readme-640.png?resize=300,248 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2017/02/filecode-readme-640.png?resize=85,70 85w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>So, if the crook can recover your data from first principles by cracking the now-forgotten password, why can&#8217;t you?</p>
<p>The answer is, &#8220;You can,&#8221; and here&#8217;s how we did it on our test Mac.</p>
<h2>Secrets revealed</h2>
<p>The encryption used by default in <code>zip</code> files comes from the original PKZIP software, named after the late Phil Katz, who wrote it and started PKWARE, the company that sold it.</p>
<p>But the <a href="https://www.pkware.com/documents/casestudies/APPNOTE.TXT" rel="nofollow">PKZIP cipher</a> (officially denoted &#8220;traditional PKWARE encryption&#8221;, but we&#8217;ll call it just <em>zipcrypt</em> from now on) was designed by a programmer, not by a cryptographer.</p>
<p>Zipcrypt simply doesn&#8217;t mix things up well enough to be secure.</p>
<p>Internally, the algorithm uses three 32-bit key values, <code>key0</code>, <code>key1</code> and <code>key2</code>, that are repeatedly mixed together so that each key changes after every byte is encrypted; the byte you&#8217;ve just encrypted is added into the mix as well:</p>
<pre>function update_keys(newbyte)
   key0 = crc32(key0,newbyte)          --mix the new byte into a running CRC-32
   key1 = key1 + low8bitsof(key0)      --add the bottom byte of key0 into key1
   key1 = key1 * 134775813 + 1         --apply linear congruential PRNG to key1
   key2 = crc32(key2,top8bitsof(key1)) --mix the top byte of key1 into a running CRC-32
end
</pre>
<p>Don&#8217;t worry if you aren&#8217;t a programmer or don&#8217;t understand the notation above.</p>
<p>What&#8217;s important is that at each byte-sized encryption step:</p>
<ul>
<li> <code>key0</code> is updated by mixing up its current value with the plaintext character you just encrypted. The mixing algorithm is the <a href="https://nakedsecurity.sophos.com/2017/02/23/bang-sha-1-collides-at-38762cf7f55934b34d179ae6a4c80cadccbb7f0a/">CRC-32 checksum algorithm</a>.
<li> <code>key1</code> is updated by adding in one byte from the updated <code>key0</code> and then mixing up the value using a simple pseudo-random number generator (PRNG). This is the same pseudo-random code used by the old Turbo Pascal and early versions of Borland Delphi.
<li> <code>key2</code> is updated by mixing up its current value with one byte of the update <code>key1</code>, using CRC-32.
</ul>
<p style="margin-top:1.5em;">To encrypt a byte, you XOR it with a cipher-stream byte that is computed from the bottom 16 bits of <code>key2</code>, like this:</p>
<pre>function encrypt_byte(newbyte)
   local cipherbyte
   cipherbyte = bottom16bitsof(key2)             -- take 16 bits from key2
   cipherbyte = cipherbyte OR 2                  -- set the second-bottom bit to 1
                                                 -- (this ensures temp is never zero) 
   cipherbyte = cipherbyte * (cipherbyte XOR 1)  -- mix together the 16 bits of temp
   cipherbyte = secondtobottombyteof(cipherbyte) -- take the top 8 of the bottom 16 bits
   return newbyte XOR cipherbyte                 -- XOR this cipher byte into the stream
end
</pre>
<p>With three 32-bit internal keys that produce one XOR key-byte at a time, zipcrypt is technically a stream cipher with a 96-bit key (3&times;32 = 96), which means there are 2<sup>96</sup> keys if you want to try them all in a brute-force attack.</p>
<h2>At first glance</h2>
<p>How secure is zipcrypt?</p>
<p>At first glance, you might think that this algorithm doesn&#8217;t do anywhere near as much mixing-mincing-shredding-and-liquidising as you&#8217;d expect, at least if you compare it with cryptographic algorithms that work on bigger blocks of data, such as AES or <a href="https://nakedsecurity.sophos.com/2012/10/04/sha-3-hash-competition-concludes-keccak/">SHA-3</a>.</p>
<p>There also doesn&#8217;t seem to be much of what is often referred to as <em>avalanche</em> or <em>diffusion</em> between the three internal key values, with just 8 bits of new data percolating into each key value at every step.</p>
<p>For example, <code>key0</code> never incorpoates bits from <code>key1</code> or <code>key2</code>, nor <code>key1</code> from <code>key2</code>, and so on, and the new bits that come into <code>key0</code> from the current plaintext byte take two more encryption cycles to have any effect on <code>key2</code>.</p>
<p>You might also be concerned that the core &#8220;mixing&#8221; algorithms that were chosen as randomisers, CRC-32 and the Turbo Pascal PRNG, were <a href="https://nakedsecurity.sophos.com/2017/02/23/bang-sha-1-collides-at-38762cf7f55934b34d179ae6a4c80cadccbb7f0a/">not designed for cryptographic use</a>, but rather for speed and simplicity.</p>
<p>Indeed, the problem with both CRC-32 the the PRNG used by zipcrypt is that if at any point you can figure out where you are in the cycle of random numbers they&#8217;ve just produced, you can figure out what comes next and thus reconstruct the random sequence from then on, no matter how secretly the algorithm was initialised, or <em>seeded</em>, in the first place.</p>
<p>And if you think that there might therefore be cryptographic chinks in the internals of zipcrypt, you&#8217;d be right, as two well-known names in the cryptographic community, Eli Biham and Paul Kocher, found in the mid-1990s.</p>
<p>Their paper, <em><a href="ftp://utopia.hacktic.nl/pub/crypto/cracking/pkzip.ps.gz" rel="nofollow">A known plaintext attack on the PKZIP cipher</a></em>, documents how they uncovered a way to compare a known plaintext file with its zipcrypt ciphertext equivalent, and from there to work backwards to figure out the starting values of <code>key0</code>, <code>key1</code> and <code>key2</code> that were used to encrypt it. </p>
<p>Any other encrypted files in the same ZIP archive, or any other ZIP files using the same password, can then be decrypted without any further effort.</p>
<p>Note that this means you don&#8217;t need to figure out the actual password used in the first place, which is itself churned through the zipcrypt algorithm as many times as there are characters in the password to produce the three starting values for <code>key0</code>, <code>key1</code> and <code>key2</code>.</p>
<p>That&#8217;s just as well, because the Filecode malware chooses a 25-character password from the characters <code>A-Za-z0-9</code> for a total of 62 characters and thus 62<sup>25</sup> possible passwords, or close to one billion billion billion billion billion.</p>
<p>You don&#8217;t even need to try out all 2<sup>96</sup> possible combinations of <code>key0</code>, <code>key1</code> and <code>key2</code>, which is getting on for one million million million million million.</p>
<p>In fact, with a handy utility that also dates back to the 1990s, <a href="https://www.unix-ag.uni-kl.de/~conrad/krypto/pkcrack.html" rel="bofollow">PKCRACK</a>, we did the job in 42 seconds.</p>
<h2>Cracking the keys</h2>
<p>After the malware had finished running on our test Mac, all our files had been ZIPped with a password and renamed to have the extension <code>.crypt</code>:</p>
<pre>/Users/duck/Desktop/letterlegal5.doc.crypt
/Users/duck/Desktop/lorem_document_PDF.pdf.crypt
/Users/duck/Desktop/shattered-1200.jpg.crypt
/Users/duck/Desktop/wt-tmpdkhvbs-500.png.crypt
/Users/duck/Desktop/YankeeHotelFoxtrot.mp3.crypt
/Users/duck/Documents/.localized.crypt
/Users/duck/Documents/2003-example-spreadsheet.xls.crypt
/Users/duck/Documents/2014_04_a4_format.doc.crypt
/Users/duck/Documents/Document-English.docx.crypt
/Users/duck/Documents/Large Spreadsheet Sales (Excel).xls.crypt
/Users/duck/Documents/officialformat.doc.crypt
/Users/duck/Documents/Thesis-and-Dissertation-Templete.doc.crypt
/Users/duck/Music/Webdriver_Torso.mp3.crypt
/Users/duck/Music/YankeeHotelFoxtrot.mp3.crypt
/Users/duck/Pictures/corplogo.png.crypt
/Users/duck/Pictures/shattered-1200.jpg.crypt
/Users/duck/Pictures/wt-tmpdkhvbs-500.png.crypt
</pre>
<p>We needed just one file for which we had a backup copy of the original, so we chose a logo file we could find again online: <code>corplogo.png</code>.</p>
<p>By ZIPping up the plaintext version of the file using the same compression options as the malware, we then had a corresponding set of plaintext and ciphertext ZIP files, both containing a file called <code>corplogo.png</code>:</p>
<pre>duck@testmac:~/Temp$ zip -0 corplogo.png.plain.zip corplogo.png
  adding: corplogo.png (stored 0%)
duck@testmac:~/Temp$ ls -l corplogo*
-rw-r--r--  1 duck  staff  7189 28 Feb 10:00 corplogo.png        --plaintext original file 
-rw-r--r--  1 duck  staff  7435 13 Feb  2010 corplogo.png.crypt  --encrypted ransomware ZIP 
-rw-r--r--  1 duck  staff  7365 28 Feb 11:47 corplogo.plain.zip  --plain ZIP created above
duck@testmac:~/Temp$ 
</pre>
<p style="background-color:#e8e8e8;font-size:80%;padding:1em 2em;margin:2em 0;">The malware uses the <code>zip -0</code> option for &#8220;no compression&#8217;, presumably to make the scrambling process faster, because compressing files can be very slow. That&#8217;s why we did a matching <code>zip -0</code> above. The unusual timestamp on the ZIP file <code>corplogo.png.crypt</code> (2010-02-13) is deliberately set by the malware. We don&#8217;t know what significance this date has, except perhaps to be unusual.</p>
<p>Then, we set PKCRACK to work. </p>
<p>The options it needs are: the name of the encrypted ZIP; the unencrypted ZIP to compare it to; the name of the corresponding file in each archive; and a new name for its own decrypted version of the ZIP so we could check that the process succeed:</p>
<pre>duck@testmac:~/Temp$ pkcrack -C corplogo.png.crypt -P corplogo.png.plain.zip \
                                  -c Users//duck/Pictures/corplogo.png  -p corplogo.png \
                                  -d corplogo.png.decrpyt
Files read. Starting stage 1 on Tue Feb 28 11:50:05 2017
Generating 1st generation of possible key2_7200 values...done.
Found 4128994 possible key2-values.
Now we're trying to reduce these...
Lowest number: 969 values at offset 4095
Lowest number: 952 values at offset 4076
[. . .]
Lowest number: 487 values at offset 399
Done. Left with 487 possible Values. bestOffset is 399.
Stage 1 completed. Starting stage 2 on Tue Feb 28 11:50:22 2017
Ta-daaaaa! key0=<strong>ac5d37ee</strong>, key1=<strong>b7c718ab</strong>, key2=<strong>3bc7973b</strong>
[. . .]
Stage 2 completed. Starting zipdecrypt on Tue Feb 28 11:50:47 2017
Decrypting Users//duck/Pictures/corplogo.png (c407e43e418b6e49cbc43e75)... OK!
Finished on Tue Feb 28 11:50:47 2017
</pre>
<p>42 seconds later, and PKCRACK was done, giving us the 96 bits of key material that we needed to unlock all our other files.</p>
<p style="background-color:#e8e8e8;font-size:80%;padding:1em 2em;margin:2em 0;">The double-slash in the filename <code>Users//duck/Pictures/corplogo.png</code> in the PKCRACK command line above is needed to match the way the malware creates its encrypted archives. Unix filenames can have one or more slashes to separate each directory name in a path, so that path/file.txt and path//file.txt refer to the same filesystem object. You can check the names of files inside an encrypted ZIP file using <code>unzip -l</code>, because only the file contents are encrypted &#8211; that&#8217;s how we spotted the extra slash after the first part of the directory path.</p>
<p>We UNZIPped the decrypted ZIP generated by PKCRACK, just to make sure we were on the right track:</p>
<pre>duck@testmac:~/Temp$ unzip -j corplogo.png.decrpyt 
Archive:  corplogo.png.decrpyt
replace corplogo.png? [y]es, [n]o, [A]ll, [N]one, [r]ename: r
new name: corplogo.recovered.png
 extracting: corplogo.recovered.png  
duck@testmac:~/Temp$ shasum -a 256 corplogo.recovered.png corplogo.png
7190c9d479e6c344fcd6ebcf2455ec8d9d00d10a09386cd56308b39d70c7ccec  corplogo.recovered.png
7190c9d479e6c344fcd6ebcf2455ec8d9d00d10a09386cd56308b39d70c7ccec  corplogo.png
duck@testmac:~/Temp$
</pre>
<p>The logo file we extracted from the unscrambled ZIP file matched the original copy, so we carried on.</p>
<p>Next, we used PKCRACK&#8217;s special <code>zipdecrypt</code> tool to convert all our other files &#8211; that&#8217;s like a special version of <code>unzip</code> that takes in raw values for <code>key0</code>, <code>key1</code> and <code>key2</code> where <code>unzip</code> would require you to put in the original password:</p>
<pre>duck@testmac:~/Temp$ for f in *.crypt; do zipdecrypt ac5d37ee b7c718ab 3bc7973b "$f" "$f.recovered"; done
Decrypting Users//duck/Desktop/letterlegal5.doc.crypt (02e59dba51ca8cd8daa8c8f3)... OK!
Decrypting Users//duck/Desktop/lorem_document_PDF.pdf.crypt (01c51007238cccd0d7ac6d86)... OK!
Decrypting Users//duck/Desktop/shattered-1200.jpg.crypt (4891b0abcdda0c17614c5804)... OK!
Decrypting Users//duck/Desktop/wt-tmpdkhvbs-500.png.crypt (ec5f2177ef15d77e5aee108f)... OK!
Decrypting Users//duck/Desktop/YankeeHotelFoxtrot.mp3.crypt (d350f0eb554eeec6d1322382)... OK!
Decrypting Users//duck/Documents/.localized.crypt (108efd41d240b1005e7281c6)... OK!
Decrypting Users//duck/Documents/2003-example-spreadsheet.xls.crypt (f0f93d9533d8f6c660c2a2cd)... OK!
Decrypting Users//duck/Documents/2014_04_a4_format.doc.crypt (3ba2cc77598e2536e2a28208)... OK!
Decrypting Users//duck/Documents/Document-English.docx.crypt (f2e63ab43578659571be7b02)... OK!
Decrypting Users//duck/Documents/Large Spreadsheet Sales (Excel).xls.crypt (c9e2ce71ce5e9d4602cdc7a5)... OK!
Decrypting Users//duck/Documents/officialformat.doc.crypt (b125ea6bca507020b8401ac5)... OK!
Decrypting Users//duck/Documents/Thesis-and-Dissertation-Templete.doc.crypt (1c65a78878f3c52dcd5622bc)... OK!
Decrypting Users//duck/Music/Webdriver_Torso.mp3.crypt (139aa20cbb6edcb9c86af6ea)... OK!
Decrypting Users//duck/Music/YankeeHotelFoxtrot.mp3.crypt (3c50baedc1735187809a2591)... OK!
Decrypting Users//duck/Pictures/corplogo.png.crypt (c407e43e418b6e49cbc43e75)... OK!
Decrypting Users//duck/Pictures/shattered-1200.jpg.crypt (3c50baedc1735187809a2591)... OK!
Decrypting Users//duck/Pictures/wt-tmpdkhvbs-500.png.crypt (dee3bd6d201fd31b1ca377a3)... OK!
duck@testmac:~/Temp$
</pre>
<p>The last step was unzip all the now-decrypted ZIP files, and that was that:</p>
<pre>duck@testmac:~/Temp$ for f in *.recovered; do unzip -d / "$f"; done
Archive:  Users/duck/Desktop/letterlegal5.doc.crypt.recovered
 extracting: Users/duck/Desktop/letterlegal5.doc
Archive:  Users/duck/Desktop/lorem_document_PDF.pdf.crypt.recovered
 extracting: Users/duck/Desktop/lorem_document_PDF.pdf
Archive:  Users/duck/Desktop/shattered-1200.jpg.crypt.recovered
 extracting: Users/duck/Desktop/shattered-1200.jpg
Archive:  Users/duck/Desktop/wt-tmpdkhvbs-500.png.crypt.recovered
 extracting: Users/duck/Desktop/wt-tmpdkhvbs-500.png
Archive:  Users/duck/Desktop/YankeeHotelFoxtrot.mp3.crypt.recovered
 extracting: Users/duck/Desktop/YankeeHotelFoxtrot.mp3
Archive:  Users/duck/Documents/.localized.crypt.recovered
 extracting: Users/duck/Documents/.localized
Archive:  Users/duck/Documents/2003-example-spreadsheet.xls.crypt.recovered
 extracting: Users/duck/Documents/2003-example-spreadsheet.xls
Archive:  Users/duck/Documents/2014_04_a4_format.doc.crypt.recovered
 extracting: Users/duck/Documents/2014_04_a4_format.doc
Archive:  Users/duck/Documents/Document-English.docx.crypt.recovered
 extracting: Users/duck/Documents/Document-English.docx
Archive:  Users/duck/Documents/Large Spreadsheet Sales.crypt.recovered
 extracting: Users/duck/Documents/Large Spreadsheet Sales
Archive:  Users/duck/Documents/officialformat.doc.crypt.recovered
 extracting: Users/duck/Documents/officialformat.doc
Archive:  Users/duck/Documents/Thesis-and-Dissertation-Templete.doc.crypt.recovered
 extracting: Users/duck/Documents/Thesis-and-Dissertation-Templete.doc
Archive:  Users/duck/Music/Webdriver_Torso.mp3.crypt.recovered
 extracting: Users/duck/Music/Webdriver_Torso.mp3
Archive:  Users/duck/Music/YankeeHotelFoxtrot.mp3.crypt.recovered
 extracting: Users/duck/Music/YankeeHotelFoxtrot.mp3
Archive:  Users/duck/Pictures/corplogo.png.crypt.recovered
 extracting: Users/duck/Pictures/corplogo.png
Archive:  Users/duck/Pictures/shattered-1200.jpg.crypt.recovered
 extracting: Users/duck/Pictures/shattered-1200.jpg
Archive:  Users/duck/Pictures/wt-tmpdkhvbs-500.png.crypt.recovered
 extracting: Users/duck/Pictures/wt-tmpdkhvbs-500.png
duck@testmac:~/Temp$
</pre>
<p style="background-color:#e8e8e8;font-size:80%;padding:1em 2em;margin:2em 0;">The malware zips up the original files with their full paths, so we used <code>unzip -d /</code> for our unzipping command above so that the files would be created relative to the root directory, thus ending up back in the directory tree <code>/Users/duck</code> where they started out. Note that the leading <code>/</code> is left out of the names inside the archive to stop you unzipping them into absolute locations by mistake, where you might overwrite system files unexpectedly. It&#8217;s a good idea to verify the filenames in an archive before using <code>-d /</code>, in case there are files such as <code>bin/bash</code> or <code>usr/bin/vi</code> sneakily included in there that would replace core apps on your Mac.</p>
<h2>$530 saved in 10 minutes</h2>
<p>The whole process took about 10 minutes, including downloading the macOS command line compiler tools from Apple and compiling our own copy of PKCRACK, just to make sure we could do it from scratch.</p>
<p>It would have cost us $530 (BTC 0.45) to &#8220;hire&#8221; the Filecode criminal to do the same job, assuming he were awake, and competent&#8230;</p>
<p>&#8230;and trustworthy.</p>
<p>We know what we think of his rating on the last score.</p>
<p><br />
</p>
			</div> <!-- .entry-content -->
	<ul class="block social follow">
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon twitter"><use xlink:href="#twitter"></use></svg>
			<p>Follow <strong><a href="https://twitter.com/nakedsecurity">@NakedSecurity on Twitter</a></strong> for the latest computer security news.</p>
		</li>
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon instagram"><use xlink:href="#instagram"></use></svg>
			<p>Follow <strong><a href="https://www.instagram.com/nakedsecurity/">@NakedSecurity on Instagram</a></strong> for exclusive pics, gifs, vids and LOLs!</p>
		</li>
	</ul>
</article><!-- #post-## -->

		<div class="free-tools-block">
			<h2 class="block-title">Free tools</h2>

<div class="ns-free-tools">
	<div class="ns-free-tools__item ns-free-tools__item--sophos-home">
		<a class="ns-free-tools__link" href="https://home.sophos.com/en-us.aspx?cmp=701j0000001eLpnAAE">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/sophos-home@2x.png" alt="Sophos Home" class="ns-free-tools__image" width="166" height="100">
			<h4 class="ns-free-tools__title">
				Sophos Home			</h4>
			<div class="ns-free-tools__sub-title">
				Protect personal PCs and Macs			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--hitman-pro">
		<a class="ns-free-tools__link" href="https://www.hitmanpro.com/en-us/hmp.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/hitman-pro@2x.png" alt="Hitman Pro" class="ns-free-tools__image" width="154" height="100">
			<h4 class="ns-free-tools__title">
				Hitman Pro			</h4>
			<div class="ns-free-tools__sub-title">
				Find and remove malware			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--intercept-x">
		<a class="ns-free-tools__link" href="https://www.sophos.com/en-us/products/free-tools/sophos-mobile-security-free-edition.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/mobile-security-android@2x.png" alt="Sophos Intercept X for Mobile" class="ns-free-tools__image" width="96" height="110">
			<h4 class="ns-free-tools__title">
				Intercept X for Mobile			</h4>
			<div class="ns-free-tools__sub-title">
				Protect Android devices			</div>
		</a>
	</div>
</div>
		</div>

			<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2017/03/03/apple-pushing-two-factor-authentication-for-ios-10-3-users/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> Apple pushing two-factor authentication for iOS 10.3 users</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2017/03/03/amazon-mega-outage-caused-by-single-command-line-error/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Amazon mega-outage caused by single command line error</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	
	</main><!-- #main -->

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<section class="comments-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

			
<div id="comments" class="comments-area">

			<h2 class="comments-title">
			3 comments on &ldquo;<span>Secrets of the Filecode ransomware revealed</span>&rdquo;		</h2>

		<ol class="comment-list">
					<li id="comment-4698784" class="comment even thread-even depth-1">
			<article id="div-comment-4698784" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/a5dadf5da153b13ec1028b9ae4c4b6a3?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a5dadf5da153b13ec1028b9ae4c4b6a3?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">FreedomISaMYTH</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2017/03/03/secrets-of-the-filecode-ransomware-revealed/#comment-4698784"><time datetime="2017-03-03T17:15:28+00:00">March 3, 2017 at 5:15 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>thanks as always duck!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_4698784"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_4698784={"id":7238218,"unique_id":"wp-comment-4698784","title":"thanks%20as%20always%20duck%21%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2017\/03\/03\/secrets-of-the-filecode-ransomware-revealed\/#comment-4698784","item_id":"_comm_4698784"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2017/03/03/secrets-of-the-filecode-ransomware-revealed/?replytocom=4698784#respond' data-commentid="4698784" data-postid="363253" data-belowelement="div-comment-4698784" data-respondelement="respond" data-replyto="Reply to FreedomISaMYTH" aria-label='Reply to FreedomISaMYTH'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-4698945" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-4698945" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/76429d78cc1eb7ef2d1d2e5c41e7efa0?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/76429d78cc1eb7ef2d1d2e5c41e7efa0?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Danny Agro</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2017/03/03/secrets-of-the-filecode-ransomware-revealed/#comment-4698945"><time datetime="2017-03-03T20:31:16+00:00">March 3, 2017 at 8:31 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Yes, it&#8217;s good to read your articles, Paul, and hopefully you&#8217;ll be writing more regularly in future &#8211; not that your coleagues are at all bad, of course!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_4698945"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_4698945={"id":7238218,"unique_id":"wp-comment-4698945","title":"Yes%2C%20it%26%23039%3Bs%20good%20to%20read%20your%20articles%2C%20Paul%2C%20and%20hopefully%20you%26%23039%3Bll%20be%20writing%20more%20regularly%20in%20future%20-%20not%20that%20your%20coleagues%20are%20at%20all%20bad%2C%20of%20course%21%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2017\/03\/03\/secrets-of-the-filecode-ransomware-revealed\/#comment-4698945","item_id":"_comm_4698945"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2017/03/03/secrets-of-the-filecode-ransomware-revealed/?replytocom=4698945#respond' data-commentid="4698945" data-postid="363253" data-belowelement="div-comment-4698945" data-respondelement="respond" data-replyto="Reply to Danny Agro" aria-label='Reply to Danny Agro'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-4698967" class="comment byuser comment-author-pducklin bypostauthor even depth-2">
			<article id="div-comment-4698967" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2017/03/03/secrets-of-the-filecode-ransomware-revealed/#comment-4698967"><time datetime="2017-03-03T22:01:41+00:00">March 3, 2017 at 10:01 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks for the kind words.</p>
<p>I had a side project in February so I wrote a bit less than usual last month&#8230;but I haven&#8217;t gone anywhere 🙂</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_4698967"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_4698967={"id":7238218,"unique_id":"wp-comment-4698967","title":"Thanks%20for%20the%20kind%20words.I%20had%20a%20side%20project%20in%20February%20so%20I%20wrote%20a%20bit%20less%20than%20usual%20last%20month...but%20I%20haven%26%23039%3Bt%20gone%20anywhere%20%3A-%29%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2017\/03\/03\/secrets-of-the-filecode-ransomware-revealed\/#comment-4698967","item_id":"_comm_4698967"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2017/03/03/secrets-of-the-filecode-ransomware-revealed/?replytocom=4698967#respond' data-commentid="4698967" data-postid="363253" data-belowelement="div-comment-4698967" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">What do you think? <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2017/03/03/secrets-of-the-filecode-ransomware-revealed/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://nakedsecurity.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='363253' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="8e1eb42c42" /></p><input type="hidden" id="ak_js" name="ak_js" value="191"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->
		<div class="comments-widget-area">
					</div>
	
	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	

	<section class="recommended-panel">
	<div class="container">
	<div class="panel-content ">

		<h3 class="block-title">Recommended reads</h3>
	<div class="blocks">
		<article id="post-544740" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/01/28/cybersecurity-tips-for-university-students/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/01/c4s-1200.jpg?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Jan</span><span class="day">28</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Harriet Stone	
	</div>
			<div class="comment-box">
				<span class="count">3</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/01/28/cybersecurity-tips-for-university-students/" rel="bookmark">Cybersecurity tips for university students</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-563309" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/03/18/s3-ep24-how-not-to-get-snooped-scammed-or-hoaxed-podcast/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/nean-with-mic-wt-paleish-green-1200.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Mar</span><span class="day">18</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">3</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/03/18/s3-ep24-how-not-to-get-snooped-scammed-or-hoaxed-podcast/" rel="bookmark">S3 Ep24: How not to get snooped, scammed or hoaxed [Podcast]</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-544714" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/01/27/apple-critical-patches-fix-in-the-wild-iphone-exploits-update-now/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/01/appleupd-1200.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Jan</span><span class="day">27</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">7</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/01/27/apple-critical-patches-fix-in-the-wild-iphone-exploits-update-now/" rel="bookmark">Apple critical patches fix in-the-wild iPhone exploits &#8211; update now!</a></h3>	</div>
</article> <!-- .card-article -->
	</div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="footer-container">
			<a href="#" class="js-collapse-footer"><svg style="height: 20px" viewBox="0 0 132 24" class="block icon sophos"><use xlink:href="#sophos"></use></svg></a>
			<div id="collapseFooter" class="blocks">
				<div class="sophos block">
					<ul id="menu-footer-primary" class="primary menu"><li id="menu-item-306737" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306737"><a href="https://nakedsecurity.sophos.com/about/">About Naked Security</a></li>
<li id="menu-item-306754" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306754"><a href="https://www.sophos.com/en-us/company.aspx">About Sophos</a></li>
<li id="menu-item-306747" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306747"><a href="https://nakedsecurity.sophos.com/send-us-a-tip/">Send us a tip</a></li>
<li id="menu-item-323171" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323171"><a href="/cookies-and-scripts/">Cookies</a></li>
<li id="menu-item-323170" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323170"><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
<li id="menu-item-323169" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323169"><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
</ul>				</div>
										<div class="news block">
							<ul id="menu-products-column-one" class="small menu"><li id="menu-item-306998" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306998"><a href="https://www.sophos.com/en-us/products/intercept-x.aspx">Intercept X</a></li>
<li id="menu-item-440801" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440801"><a href="https://www.sophos.com/en-us/products/server-security.aspx">Intercept X for Server</a></li>
<li id="menu-item-440802" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440802"><a href="https://www.sophos.com/en-us/products/mobile-control.aspx">Intercept X for Mobile</a></li>
</ul>						</div>
											<div class="products block">
							<ul id="menu-products-column-two" class="small menu"><li id="menu-item-440803" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440803"><a href="https://www.sophos.com/en-us/products/next-gen-firewall.aspx">XG Firewall</a></li>
<li id="menu-item-440805" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440805"><a href="https://www.sophos.com/en-us/products/sophos-email.aspx">Sophos Email</a></li>
<li id="menu-item-440804" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440804"><a href="https://www.sophos.com/en-us/products/secure-wifi.aspx">Sophos Wireless</a></li>
</ul>						</div>
											<div class="threats block">
							<ul id="menu-server-protection" class="small menu"><li id="menu-item-440806" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440806"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx">Managed Threat Response</a></li>
<li id="menu-item-448404" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-448404"><a href="https://www.sophos.com/en-us/products/cloud-optix.aspx">Cloud Optix</a></li>
<li id="menu-item-440807" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440807"><a href="https://www.sophos.com/en-us/products/phish-threat.aspx">Phish Threat</a></li>
</ul>						</div>
								</div>
			<ul class="block social footer">
				<li class="twitter"><a rel="nofollow" href="https://twitter.com/NakedSecurity" title="Follow our team of security experts on Twitter"><svg style="height: 14px" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
				<li class="facebook"><a rel="nofollow" href="https://www.facebook.com/SophosSecurity" title="Join over 250,000 people in our Facebook community"><svg style="height: 14px" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
				<li class="instagram"><a rel="nofollow" href="https://www.instagram.com/nakedsecurity/" title="Follow Naked Security on Instagram"><svg style="height: 14px" viewBox="0 0 100 100" class="icon instagram"><use xlink:href="#instagram"></use></svg></a></li>
				<li class="linkedin"><a rel="nofollow" href="https://www.linkedin.com/company/5053/" title="Join the naked security discussion group on LinkedIn"><svg style="height: 14px" viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
				<li class="rss"><a rel="nofollow" href="/feed" title="Subscribe to our RSS feed"><svg style="height: 14px" viewBox="0 0 100 100" class="icon rss"><use xlink:href="#rss"></use></svg></a></li>
			</ul>

							<div class="vip-powered-wpcom">
					<span class="copyright">© 1997 - 2021 Sophos Ltd.</span>
					All rights reserved.
					Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=nakedsecurity.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>				</div>
					</div>
		<script type="text/javascript">
			window.cookieconsent_options = {
				"message":"This site uses cookies. By continuing to browse the site you are agreeing to our use of cookies.",
				"dismiss":"Got it!",
				"learnMore":"Learn More",
				"link":"/cookies-and-scripts",
				"theme":"https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/css/sophos.css"};
		</script>
	</footer><!-- #colophon -->
</div><!-- #page -->
<div id="survey-wrapper" class="mfp-hide"><div class="pd-embed" id="pd_1499706777" data-settings=""></div></div>
<script id='child-js-plugins-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"0","nextLink":""};
</script>
<script id='child-js-core-js-extra'>
var Sophos = {"ajaxurl":"https:\/\/nakedsecurity.sophos.com\/wp-admin\/admin-ajax.php","nonce":"64f6810f0c"};
</script>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJyNjkEKwjAQRS9kOo2YggvxKGLT0SZmJiGTULx9Q7HgwoXL+f89/sCSlI1ckAuUGQkFJKY5CuMi6thrA14ghfp0LJ2XA/wl2Jhxpx3bUKfGbTlRM1XGFN4dOf4FtRNpxOm73yepqs8zcH85ISxway48YqbGXumiB21OQ2/02a8RfU9z'></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161173',post:'363253',tz:'0',srv:'nakedsecurity.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161173', '363253' ]);
</script>
</body>
</html>
