<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="RHQeasQqjasbRt5asY6atZYbs5tr10gFBevDt2HRhW0" />
<link rel="pingback" href="https://nakedsecurity.sophos.com/xmlrpc.php">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5VK6LTK');</script>
<!-- End Google Tag Manager -->

<meta name="description" content="It&#039;s been dubbed ReDos, for Regular Expression Denial of Service - where a few rogue HTTP requests could clog your whole site." />
<meta name="keywords" content=", apache, denial of service, javascript, redos, serious security" />
<title>Serious Security: How to stop dodgy HTTP headers clogging your website &#8211; Naked Security</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="I9dHFo-YhnK2MfAHn-20V4GnWrOttVUYyISGamyU41M" />
<meta name="msvalidate.01" content="7D8D1FA2892142B1543D2CBCD07FB88F" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Feed" href="https://nakedsecurity.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Comments Feed" href="https://nakedsecurity.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Serious Security: How to stop dodgy HTTP headers clogging your website Comments Feed" href="https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/feed/" />
<link rel='stylesheet' id='all-css-0' href='https://nakedsecurity.sophos.com/_static/??-eJyVz00OwiAQhuELCSM1mLgwnoXCRFD+wgxpevvS2J0bXU7yPsk3sFQRso3dIYElAheIYY7FvkUMczNtBeI1okwhyxGcYAhbMmNmYI9pOCrVF8q4kJjOSh/gn1hEw0j8q9mHGifZNzQsfB9xkybVL5+6qLE/QyZ4IVczvrrJjz/unTzSXV2VvkxKa70BdwtjDg==' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqWkWAK9EIho='></script>
<link rel="https://api.w.org/" href="https://nakedsecurity.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://nakedsecurity.sophos.com/wp-json/wp/v2/posts/414833" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://nakedsecurity.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://nakedsecurity.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/" />
<link rel='shortlink' href='https://nakedsecurity.sophos.com/?p=414833' />
<link rel="alternate" type="application/json+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2018%2F08%2F21%2Fserious-security-how-to-stop-dodgy-http-headers-clogging-your-website%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2018%2F08%2F21%2Fserious-security-how-to-stop-dodgy-http-headers-clogging-your-website%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Serious Security: How to stop dodgy HTTP headers clogging your website" />
<meta property="og:url" content="https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/" />
<meta property="og:description" content="It&#8217;s been dubbed ReDos, for Regular Expression Denial of Service &#8211; where a few rogue HTTP requests could clog your whole site." />
<meta property="article:published_time" content="2018-08-21T18:28:07+00:00" />
<meta property="article:modified_time" content="2018-08-22T15:19:36+00:00" />
<meta property="og:site_name" content="Naked Security" />
<meta property="og:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/re.png?w=775" />
<meta property="og:image:secure_url" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/re.png?w=775" />
<meta property="og:image:width" content="775" />
<meta property="og:image:height" content="405" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@NakedSecurity" />
<meta name="twitter:text:title" content="Serious Security: How to stop dodgy HTTP headers clogging your website" />
<meta name="twitter:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/re.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=270" />
</head>
<body class="post-template-default single single-post postid-414833 single-format-standard" >
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VK6LTK"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div style="display: none">
<svg>
	<symbol id="sophos" viewBox="0 0 132 24">
		<path d="m111.82 22.176h11.64c3.267 0 4.65-0.2 5.74-0.896 1.715-1.063 2.804-3.26 2.804-5.62 0-1.928-0.658-3.89-1.647-4.888-1.288-1.33-3.035-1.828-6.271-1.828h-3.527c-1.586 0-2.754-0.067-3.412-0.365-0.794-0.367-1.256-1.165-1.256-2.161 0-1.165 0.56-2.03 1.486-2.264 0.692-0.163 1.498-0.163 3.574-0.198h10.419v-3.956h-11.473c-2.574 0-3.727 0.099-4.718 0.466-2.279 0.796-3.828 3.257-3.828 6.083 0 1.93 0.76 3.727 2.079 4.89 1.155 0.996 2.872 1.462 5.51 1.462h4.697c1.057 0 1.915 0.132 2.376 0.398 0.893 0.433 1.418 1.328 1.418 2.36 0 0.864-0.395 1.597-1.087 2.027-0.561 0.369-1.517 0.534-3.268 0.534h-11.256zm-111.35 0h11.64c3.267 0 4.652-0.2 5.741-0.896 1.714-1.063 2.803-3.26 2.803-5.62 0-1.928-0.66-3.89-1.65-4.888-1.285-1.33-3.034-1.828-6.27-1.828h-3.527c-1.584 0-2.751-0.067-3.41-0.365-0.792-0.367-1.253-1.165-1.253-2.161 0-1.165 0.56-2.03 1.484-2.264 0.693-0.163 1.496-0.163 3.574-0.198h10.42v-3.956h-11.477c-2.573 0-3.727 0.099-4.715 0.466-2.278 0.796-3.83 3.257-3.83 6.083 0 1.93 0.762 3.727 2.08 4.89 1.155 0.996 2.871 1.462 5.51 1.462h4.696c1.057 0 1.913 0.132 2.377 0.398 0.888 0.433 1.416 1.328 1.416 2.36 0 0.864-0.394 1.597-1.089 2.027-0.558 0.369-1.517 0.534-3.264 0.534h-11.256v3.956zm94.05-16.18c-0.68 1.076-1.003 2.803-1.003 5.122 0 5.088 1.747 7.405 5.63 7.405 3.822 0 5.568-2.317 5.568-7.34 0-5.092-1.715-7.373-5.568-7.373-2.102 0-3.754 0.784-4.627 2.186zm13.174-2.511c1.329 1.761 2.072 4.63 2.072 7.992 0 3.816-1.197 6.948-3.334 8.677-1.619 1.304-4.078 2.022-6.995 2.022-4.142 0-7.41-1.372-9.092-3.817-1.263-1.793-1.88-4.176-1.88-7.08 0-4.172 1.133-7.339 3.27-9.035 1.682-1.37 4.339-2.122 7.383-2.122 3.85 0 6.925 1.209 8.576 3.363zm-22.018-3.068h-4.596v8.908h-8.319v-8.908h-4.597v21.759h4.597v-8.97h8.318v8.97h4.596v-21.759zm-28.61 10.277c1.23 0 1.941-0.163 2.427-0.62 0.581-0.49 0.938-1.533 0.938-2.74 0-1.436-0.58-2.478-1.584-2.838-0.356-0.13-0.94-0.197-1.684-0.197h-6.344v6.395zm-6.247 11.481h-4.598v-21.758h10.78c3.786 0 5.114 0.39 6.538 1.991 1.264 1.37 1.942 3.163 1.942 5.088 0 2.284-0.904 4.404-2.394 5.676-1.262 1.077-2.43 1.402-4.888 1.402h-7.38zm-22.589-16.179c-0.682 1.076-1.004 2.803-1.004 5.122 0 5.088 1.748 7.405 5.634 7.405 3.818 0 5.568-2.317 5.568-7.34 0-5.092-1.716-7.373-5.568-7.373-2.106 0-3.757 0.784-4.63 2.186zm13.174-2.511c1.328 1.761 2.073 4.63 2.073 7.992 0 3.816-1.2 6.948-3.335 8.677-1.618 1.304-4.079 2.022-6.993 2.022-4.144 0-7.413-1.372-9.096-3.817-1.264-1.793-1.878-4.176-1.878-7.08 0-4.172 1.133-7.339 3.272-9.035 1.681-1.37 4.337-2.122 7.38-2.122 3.851 0 6.93 1.209 8.578 3.363z"></path>
	</symbol>
	<symbol id="twitter" viewBox="0 0 24 24">
 		<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path>
 	</symbol>
	<symbol id="facebook" viewBox="0 0 24 24">
 		<path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path>
 	</symbol>
	<symbol id="instagram" viewBox="0 0 24 24">
		<path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path>
	</symbol>
	<symbol id="linkedin" viewBox="0 0 24 24">
		<path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"></path>
	</symbol>
	<symbol id="rss" viewBox="0 0 24 24">
		<path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"></path>
	</symbol>
	<symbol id="reddit" viewBox="0 0 24 24">
		<path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"></path>
	</symbol>
</svg>
</div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header variation variation-3" role="banner">
		<div class="header-container">
			<div class="site-branding">
				<div class="site-title">
					<a title="Naked Security" href="https://nakedsecurity.sophos.com/" rel="home"><img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/naked-security-logo-white@2x.png"></a>
					by
					<a title="sophos.com" href="https://www.sophos.com"><svg viewBox="0 0 132 24" class="icon sophos"><use xlink:href="#sophos"></use></svg></a>
				</div>
			</div><!-- .site-branding -->
			<nav id="site-navigation" class="main-navigation" role="navigation">
				<div class="container">
					<ul id="menu-variation-two" class="exit-links menu"><li id="menu-item-436509" class="products menu-item menu-item-type-custom menu-item-object-custom menu-item-436509"><a href="#">Products</a></li>
<li id="menu-item-436515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436515"><a href="https://www.sophos.com/en-us/products/free-tools.aspx">Free Tools</a></li>
<li id="menu-item-436531" class="search-toggle menu-item menu-item-type-custom menu-item-object-custom menu-item-436531"><a href="#">Search</a></li>
<li id="menu-item-436532" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436532"><a href="https://home.sophos.com/en-us.aspx">Free Sophos Home</a></li>
</ul>				</div>
			</nav><!-- #site-navigation -->
			<div class="site-search-block">
	<form target="_top" role="search" class="search-form" method="get" action="https://nakedsecurity.sophos.com/">
        <fieldset>
            <div class="field">
				<input type="search" value="" name="s" class="search-field" placeholder="Search naked security...">
            </div>
            <div class="submit">
				<button type="submit" class="search-submit button">Go</button>
            </div>
        </fieldset>
    </form>
</div>
		</div><!-- .container -->
	</header>

	<div class="responsive-flyout-panel small-12 column active" style="opacity: 1; display: none;">
		<div class="modal-filler"></div>
	    <div class="productNavBox">
	        <div class="productNavContainer">
	            <div class="row prodRow">
	                <div class="prodListBox column large-9">
	                    <div class="row margin-0 highlightProduct">
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/next-gen-firewall.aspx"><img src="https://www.sophos.com/medialibrary/2F4785DE8C3F43ECBD699A18F332FEEB.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">XG Firewall</div>
	                                	<div class="menu-section-subtitle">Next-Gen Firewall</div>
									</div>
	                            </a>
	                        </div>
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/intercept-x.aspx"><img src="https://www.sophos.com/medialibrary/27111765D65A45D49A232925D2CE428B.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">Intercept X</div>
	                                	<div class="menu-section-subtitle">Next-Gen Endpoint</div>
									</div>
	                            </a>
	                        </div>
	                    </div>
	                    <div class="productList">
	                        <ul>
								<li>
									<a href="https://www.sophos.com/en-us/products/cloud-optix.aspx"><img src="https://www.sophos.com/medialibrary/SophosNext/Images/Products/Icons/sophos-cloud-optix-icon.svg">Sophos Cloud Optix</a>
								</li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-central.aspx"><img src="https://www.sophos.com/medialibrary/08EA66123F1B4DDE8FE5C9B578A7FAA7.ashx">Sophos Central</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/mobile-control.aspx"><img src="https://www.sophos.com/medialibrary/678FE994855047739F50D6C411184FA6.ashx">Sophos Mobile</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/server-security.aspx"><img src="https://www.sophos.com/medialibrary/01B80E7D7CD54EF8AC2E51C9C6EC0236.ashx">Intercept X for Server</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-wifi.aspx"><img src="https://www.sophos.com/medialibrary/BEBD9C41BB4E480498514B29B92A145A.ashx">Secure Wi-Fi</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/phish-threat.aspx"><img src="https://www.sophos.com/medialibrary/DC9D1A7BA3964B0C9DAF1F1E68806B5A.ashx">Phish Threat</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/safeguard-encryption.aspx"><img src="https://www.sophos.com/medialibrary/8F51F06B62814B108D3B2763FF018E37.ashx">SafeGuard Encryption</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-email.aspx"><img src="https://www.sophos.com/medialibrary/597ADA0AF01A4A12B2B27239D0F9992C.ashx">Secure Email</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/unified-threat-management.aspx"><img src="https://www.sophos.com/medialibrary/8CB72BF5E1AD41F7894CE5E42101B0F3.ashx">SG UTM</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-web-gateway.aspx"><img src="https://www.sophos.com/medialibrary/C586E372694547A1B207A61D87246BA7.ashx">Secure Web Gateway</a>
	                            </li>
	                        </ul>
	                    </div>
	                </div>
	                <div class="homeUserBox column large-3">
						<img src="https://www.sophos.com/medialibrary/3376DF5742A64AEE93FDB9DCA7291239.ashx">
						<div class="menu-section-title">For Home Users</div>
	                    <p>Sophos Home protects every Mac and PC in your home </p><a href="https://home.sophos.com/" target="_blank" class="greenSmallMenuBtn">Learn More</a>
					</div>
	            </div>
	            <div class="row blueRow">
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-tools.aspx"><img width="19" src="https://www.sophos.com/medialibrary/A1FF440D2BB84511B8C94D771D44E207.ashx">Free Security Tools</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-trials.aspx"><img width="20" src="https://www.sophos.com/medialibrary/FCD3410ED2C347808D9DB8AC12C62DBD.ashx">Free Trials</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/demos.aspx"><img width="18" src="https://www.sophos.com/medialibrary/50985180E5F54C94917A2A6508E24287.ashx">Product Demos</a>
	                </div>
	                <!-- <div class="column large-3 medium-6">
	                    <a href="javascript:fairfax.openLiveChatFromFlyoutLink();" class="flyout-live-chat-link"><img width="20" src="https://www.sophos.com/medialibrary/E24C5050837145F6A5C592E299BA2A0D.ashx">Live Sales Chat</a>
	                </div> -->
	            </div>
	        </div>
	    </div>
	</div>
	<script>

	jQuery(document).ready( function () {
		var productButton   = jQuery('nav .menu-item.products');
		var modalBackground = jQuery('.modal-filler');
		var flyoutMenu		= jQuery('.responsive-flyout-panel');
		var Sophos			= Sophos || {};

		Sophos.MenuTest = {};

		Sophos.MenuTest.open = function () {
				productButton.addClass('open');
				flyoutMenu.show();
				modalBackground.show();
		};

		Sophos.MenuTest.close = function () {
			productButton.removeClass('open');
			flyoutMenu.hide();
			modalBackground.hide();
		};

		Sophos.MenuTest.toggle = function () {
			if ( productButton.hasClass('open') ) {
				Sophos.MenuTest.close();
			} else {
				Sophos.MenuTest.open();
			}
		};

		productButton.click( Sophos.MenuTest.toggle );
		modalBackground.click( Sophos.MenuTest.close );
	});

	</script>

	
	<section class="about-panel">
	<div class="container">
	<div class="panel-content ">

		<div class="description"><span>Have you listened to our podcast? <a href="/podcast/">Listen now</a></span></div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	<div id="content" class="site-content">
		<div class="content-container">

</div> <!-- .container -->
</div> <!-- #content -->


	<section class="content-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

		<main id="main" class="site-main" role="main">

	
		
<article id="post-414833" class="post-414833 post type-post status-publish format-standard has-post-thumbnail hentry category-featured tag-apache tag-denial-of-service tag-javascript tag-redos tag-serious-security">

	<header class="entry-header">
		<h1 class="entry-title">Serious Security: How to stop dodgy HTTP headers clogging your website</h1>		<div class="entry-meta">
			<div>
				
	<span class="entry-published">
		<time class="entry-date published" datetime="2018-08-21T19:28:07+01:00">21 Aug 2018</time>
	</span>

					<a href="#comments" class="comment-box">
					<span class="count">10</span>
				</a>
					
	<span class="entry-categories">
		</span>

			</div>
	</header> <!-- .entry-header -->

    <div id="newsletter-signup" class="container top"></div>

			<div class="entry-featured-image">
			<img width="780" height="408" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/re.png?w=780&amp;h=408&amp;crop=1" class="attachment-hero-thumbnail size-hero-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/re.png 1200w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/re.png?resize=300,157 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/re.png?resize=768,401 768w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/re.png?resize=1024,535 1024w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/re.png?resize=780,408 780w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/re.png?resize=100,52 100w" sizes="(max-width: 780px) 100vw, 780px" />					</div> <!-- .entry-featured-image -->
		
		<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2018/08/21/whatsapp-urges-android-users-to-manually-backup-their-chats/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> WhatsApp urges Android users to manually backup their chats</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2018/08/22/microsoft-disrupts-fancy-bear-election-meddlers/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Microsoft disrupts Fancy Bear election meddlers</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	<div class="entry-content">
		<div class="entry-prefix">
			<div class="entry-author">
				
	
					<span class="by">by</span>
			<a href="https://nakedsecurity.sophos.com/author/paul-ducklin/" title="Posts by Paul Ducklin" class="author url fn" rel="author">Paul Ducklin</a>		
	
				</div>
			<div class="entry-sharing">
				
	<ul class="block social share">
		<li class="facebook"><a href="https://www.facebook.com/share.php?u=https%3A%2F%2Fnakedsecurity.sophos.com%2F2018%2F08%2F21%2Fserious-security-how-to-stop-dodgy-http-headers-clogging-your-website%2F&title=Serious+Security%3A+How+to+stop+dodgy+HTTP+headers+clogging+your+website" data-title="Serious Security: How to stop dodgy HTTP headers clogging your website" title="Share on Facebook"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
		<li class="twitter"><a href="https://twitter.com/intent/tweet?text=Serious+Security%3A+How+to+stop+dodgy+HTTP+headers+clogging+your+website+https%3A%2F%2Fnakedsecurity.sophos.com%2F%3Fp%3D414833" data-title="Serious Security: How to stop dodgy HTTP headers clogging your website" title="Share on Twitter"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
		<li class="linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2018%2F08%2F21%2Fserious-security-how-to-stop-dodgy-http-headers-clogging-your-website%2F&title=Serious+Security%3A+How+to+stop+dodgy+HTTP+headers+clogging+your+website" data-title="Serious Security: How to stop dodgy HTTP headers clogging your website" title="Share on LinkedIn"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
		<li class="reddit"><a href="https://reddit.com/submit/?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2018%2F08%2F21%2Fserious-security-how-to-stop-dodgy-http-headers-clogging-your-website%2F&title=Serious+Security%3A+How+to+stop+dodgy+HTTP+headers+clogging+your+website" title="Share on Reddit"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon reddit"><use xlink:href="#reddit"></use></svg></a></li>

			</ul>

				</div>
		</div>
		<p>You&#8217;re in a long queue at the station and your train is due soon, but there are four ticket windows open and things are moving quickly and smoothly.</p>
<p>You&#8217;ll have plenty of time to buy your ticket, saunter to the platform and be off on your journey.</p>
<p>But then one of the ticket officials puts up a POSITION CLOSED sign and goes off shift; IT arrives to service the credit card machine at the second window; the third window gets a paper jam&#8230;</p>
<p>&#8230;and you hear the customer at the last working window say, &#8220;I&#8217;ve changed my mind &#8211; I don&#8217;t want to travel via Central London after all, so I&#8217;d like to cancel these tickets I just bought and find a cheaper route.&#8221;</p>
<p>A delay that would have been little more than a irritation at any other time ends up causing a Denial of Service attack on your travel.</p>
<p>It won’t take you an extra hour to buy your ticket, but it will take you an extra hour to wait for the next train after you&#8217;ve narrowly missed the one you thought you&#8217;d timed perfectly.</p>
<p>If this has ever happened to you, you&#8217;ll appreciate this research paper from at the recent USENIX 2018 conference: <a href="https://www.usenix.org/system/files/conference/usenixsecurity18/sec18-staicu.pdf" rel="nofollow"><strong>Freezing the Web: A Study of ReDoS Vulnerabilities in JavaScript-based Web Servers.</strong></a></p>
<p><a href="https://www.usenix.org/system/files/conference/usenixsecurity18/sec18-staicu.pdf" rel="nofollow"><img loading="lazy" src="https://news-sophos.go-vip.net/wp-content/uploads/sites/2/2018/08/redos-paper-626.png" alt="" width="626" height="276" class="aligncenter size-full wp-image-414842" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/redos-paper-626.png 626w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/redos-paper-626.png?resize=300,132 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/redos-paper-626.png?resize=100,44 100w" sizes="(max-width: 626px) 100vw, 626px" /></a></p>
<aside id="sophos_ad-3" class="widget sophos-inline-ad sophos_widget_ad">				<style></style>
				<div class="sophos_widget_ad"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx" class="s-ad-threat-hunter__link-wrapper">
  <div class="s-ad-threat-hunter">
    <div class="s-ad-threat-hunter__title">
      OTHERS STOP AT NOTIFICATION. WE TAKE ACTION
    </div>
    <div class="s-ad-threat-hunter__text">
      Get 24/7 managed threat hunting, detection, and response delivered by
      Sophos experts
    </div>
    <div class="s-ad-threat-hunter__action">
      <span class="s-button s-button--bright-green"> Learn&nbsp;more </span>
    </div>
  </div>
</a></div>
			</aside>
<p>The connection between missed trains and frozen websites might not immediately be obvious, so let&#8217;s explain.</p>
<p>Old-school (OK, old-school-ish) web servers like Apache typically use a separate process or thread to handle each connection that arrives. </p>
<p style="background-color:#e8e8e8;font-size:80%;padding:1em 2em;margin:2em 0;">Processes and threads aren&#8217;t quite the same &#8211; typically a process is a running app in its own right; each process can then subdivided into a number of sub-applications called threads, sometimes referred to as <i>lightweight processes</i>. Nevertheless, you can think of a both processes and threads as programs &#8211; they&#8217;re created, launched, scheduled, managed and killed off by the operating system. This means there&#8217;s quite a lot of overhead in starting, switching and stopping them &#8211; load that can really get in the way on a busy web server that&#8217;s handling hundreds or thousands of short-lived connections every second.</p>
<p>In our station ticket office analogy, a multi-process or multi-threaded web server wheels out your very own temporary ticket window when you arrive, and you&#8217;re assigned to it regardless of what&#8217;s going on at other ticket windows.</p>
<p>Under modest load, this works really well, because you&#8217;re insulated from the effects of being mixed in with other travellers, some of whom might ask questions that unexpectedly take a long time to answer and hold everyone up.</p>
<p>But under heavy load, the the multi-process model starts to get sluggish &#8211; the server and operating system take longer building separate ticket windows for everyone than they do issuing tickets, so everyone waits longer than necessary.</p>
<h2>React to traffic, not to connections</h2>
<p>Many modern web servers, therefore, notably those written in JavaScript using progamming environments such as <code>Node.js</code>, are <em>event-driven</em> rather than <em>connection-driven</em>.</p>
<p>Loosely speaking, the system assigns one process to handle all the network traffic, working on any user&#8217;s outstanding transactions only when there&#8217;s something new to go on.</p>
<p>This model is more like the waiting area in a burger joint or a fish-and-chip shop, where you place your order on arrival; when it&#8217;s ready, someone calls your number so you can collect your food and leave.</p>
<p>While you&#8217;re waiting, there&#8217;s no point in having a member of staff assigned specially to look after you, or a cash register already allocated to you but tied up until it&#8217;s your time to pay. </p>
<p>The staff in a burger bar or chip shop might as well ignore you while you&#8217;re waiting &#8211; you&#8217;ll be waiting anyway, after all &#8211; and get on undistracted with other work.</p>
<p>As long as they alert you promptly enough when your order is ready, overall efficiency will typically be higher and therefore everyone&#8217;s overall waiting time will be shorter.</p>
<p>That’s the theory, anyway.</p>
<h2>When things lock up</h2>
<p>The event-driven model does have one weak spot: it can clog up disastrously if even a few key steps in the process take longer than anticipated.</p>
<p>That&#8217;s a bit like seeing your burger congealing slowly and sadly behind the counter if you&#8217;re order number 32 but the person who calls out the orders is side-tracked trying to sort out an argument with customer 31.</p>
<p>In other words, event-driven servers can be highly efficient&#8230;</p>
<p>&#8230;provided that they don&#8217;t get bogged down dealing with unusual or unexpected events.</p>
<p>And that&#8217;s what our researchers went looking for: routine content-handling code in JavaScript web servers that handled unexpected data badly.</p>
<h2>Deconstructing web requests</h2>
<p>As you can imagine, web servers need to do a lot of text-based pattern matching in order to deconstruct incoming web requests, which might look like this:</p>
<pre>   GET /products/info.html HTTP/1.1
   Host: example.com
   User-Agent: Mozilla/5.0
   Accept-Language: en;q=0.5
</pre>
<p>The jargon term for pulling text input apart into its important components is <i>parsing</i>.</p>
<p>In the web request above:</p>
<ul>
<li> The request needs to be sliced into lines at each line-end marker or carriage return.
<li> The <code>GET</code> line needs to be chopped up at each space character.
<li> The header lines need to be teased apart either side of the colon.
<li> The <code>Accept-language</code> header then needs splitting up at the semicolon.
<li> The setting <code>q=0.5</code> need to be broken into &#8220;key=value&#8221; form at the equals sign. (Q is HTTP header shorthand for &#8216;quality&#8217;, although here it rather meaninglessly denotes &#8216;preference&#8217;.)
</ul>
<p>In many modern programming languages, notably JavaScript, the go-to technique for text matching is a tool called the <em>Regular Expression</em>, or RE for short.</p>
<p>That&#8217;s where the cool-sounding threat name <strong>ReDoS</strong> in the paper title comes from: it means <em>Denial of Service </em>(bogging down the server)<em> through Regular Expressions</em>.</p>
<h2>Text matching made simple</h2>
<p>Let&#8217;s look at the problem of taking the text string <code>q=0.5</code> and splitting it up into <code>q</code> and <code>0.5</code>, so we can interpret its meaning. </p>
<p>The old-school way of doing it, familiar to anyone who&#8217;s used BASIC, would be to code it by hand, starting with something like this:</p>
<pre>   POS = FIND(STR$,'=')
</pre>
<p>We&#8217;re assuming that that FIND looks for the position of the first &#8216;=&#8217; character sign in the text variable STR$, and returns its position, from 1 (the offset of the first character) to LEN(STR$), the length of the string (the offset of the last character).</p>
<p>If FIND comes back with zero, it means it found nothing; otherwise, it tells us where the match happened, so we know where to split the input into the key (the left-hand side) and the value (the right-hand side).</p>
<p>We need to take (POS-1) characters from the left of the equals sign for the key; for the value, we take POS characters less than the length of the string from the right hand end:</p>
<pre>POS = FIND(STR$,"=")                 : REM Look for an equals
IF POS &gt; 0 THEN                      : REM If there is one...
   KEY$ = LEFT$(STR$,POS-1)          : REM ...chop from the left
   VAL$ = RIGHT$(STR$,LEN(STR$)-POS) : REM ...and to the right
END
</pre>
<p><img loading="lazy" src="https://news-sophos.go-vip.net/wp-content/uploads/sites/2/2018/08/redos-posloop-640.png" width="640" height="246" class="aligncenter size-full wp-image-414917" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/redos-posloop-640.png 640w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/redos-posloop-640.png?resize=300,115 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/redos-posloop-640.png?resize=100,38 100w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>That code is fairly easy to understand, and very efficient, because it precisely encodes the simple algorithm of &#8220;look for the splitting point and then do the chopping&#8221;.</p>
<p>But it&#8217;s a bit of a pain to have to spell out the process of matching the pattern instead of just being able to express a pattern and let a matching utility do the work, which is what you can do with regular expressions.</p>
<p>Here&#8217;s an RE that could be used, not correctly but effectively enough, in place of the hard-wired code above: <code>(.+)=(.+)</code>.</p>
<p>REs look cryptic, because of the weird and confusing way they use characters as abbreviations &#8211; indeed, their cryptic look makes them easy to get wrong:</p>
<p><img loading="lazy" src="https://news-sophos.go-vip.net/wp-content/uploads/sites/2/2018/08/redos-re-6401.png" width="640" height="509" class="aligncenter size-full wp-image-414918" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/redos-re-6401.png 640w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/redos-re-6401.png?resize=300,239 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/redos-re-6401.png?resize=88,70 88w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<h2>Easy to get wrong</h2>
<p>Once you get used to REs, however, they&#8217;re hard to wean yourself off, because they&#8217;re simple and, well, expressive.</p>
<p>In a contemporary programming language, you might be able to replace something like this, where <code>str.find</code> matches a character and <code>str.sub</code> explicitly extracts a substring&#8230;</p>
<pre>   pos = str.find('=')
   if pos then
       key = str.sub(1,pos-1)
       val = str.sub(pos+1)
   else
       key = nil
   end
</pre>
<p>&#8230;with the rather more elegant-looking, and more easily tweaked, use of an RE-matching library:</p>
<pre>   key,val = str.match('(.+)=(.+)')
</pre>
<p>The problem, as the researchers of the ReDoS paper point out, is that REs like the one above do the job you want, and easily pass software acceptance tests, yet do their job wrongly.</p>
<p>The problem is that the RE above matches <em>anywhere</em> in the input text, and the <code>str.match</code> function tries as hard as it can to find a match &#8211; a time-consuming side-effect that you probably won&#8217;t notice until:</p>
<ul>
<li> The input is longer than a few thousand characters.
<li> The input does NOT contain an equals sign anywhere.
</ul>
<p>Note that the only character this RE has to latch onto explicitly is an equals sign.</p>
<p>If there isn&#8217;t an equals sign, the RE will try to match its pattern starting at offset 1 in the input string, but will fail; the matcher will then try again from offset 2, and fail again; then from the third character along; and so on.</p>
<p>As a result, it will test out its pattern against characters 1 to LEN in the input; then redundantly against characters 2 to LEN, which will fail again; and so on until there are fewer than three characters left. (The RE can&#8217;t match fewer than three characters &#8211; the pattern calls for at least one before the equals, the equals itself, and at least one after it.)</p>
<p>If there are LEN characters in the input, the matching function ends up running LEN times, against an average of LEN/2 characters, which is proportional to the square of LEN, causing a massive crunch in performance as LEN increases.</p>
<p>You need to tell the RE matcher to lock the match to the start of the input so that it only goes through the input data once. </p>
<p>For that, you can use the special RE characters <code>^</code>, which means &#8220;match only at the very start&#8221;, and <code>$</code>, which means &#8220;match only the the very end&#8221;.</p>
<p>This is known as <em>anchoring</em> the search.</p>
<p>The difference in performance is enormous, and gets quadratically worse for the unanchored match as the input gets longer.</p>
<p>Note that in the graphs below, the axis showing the linear performance of the anchored match tops out at 2/1000ths of second for a 100K input string, while the quadratically performing unanchored match takes more than one full second for the same job.</p>
<p>That&#8217;s 500 times slower because of the missing lockdown character <code>^</code> at the start of the RE, with the discrepancy getting worse at an ever increasing rate as the input size increases further:</p>
<p><img loading="lazy" src="https://news-sophos.go-vip.net/wp-content/uploads/sites/2/2018/08/redos-match-640.png" width="640" height="544" class="aligncenter size-full wp-image-414838" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/redos-match-640.png 640w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/redos-match-640.png?resize=300,255 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/redos-match-640.png?resize=82,70 82w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p><img loading="lazy" src="https://news-sophos.go-vip.net/wp-content/uploads/sites/2/2018/08/redos-match-squared-640.png" width="640" height="565" class="aligncenter size-full wp-image-414839" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/redos-match-squared-640.png 640w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/redos-match-squared-640.png?resize=300,265 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/redos-match-squared-640.png?resize=79,70 79w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<h2>What to do?</h2>
<p>The ReDoS paper isn&#8217;t terribly bad news, but it is a potent reminder that code that looks right, and that actually works, may fail badly in real life.</p>
<p>In particular, clogging up an event-driven web server with pathologically devised HTTP headers &#8211; parsing that is performed as matter of routine for every incoming request &#8211; could make an otherwise-secure server easy to &#8220;freeze&#8221; with a ReDoS attack.</p>
<p>The researchers discovered numerous examples of real-world code that could, in theory, very easily be brought to its knees because of an overly casual use of regular expressions to pre-process web headers.</p>
<p>If you can figure out a malformed header that a badly-chosen string matching RE will choke on, you’ve got the raw material for a ReDoS.</p>
<p>In some cases, the risky REs &#8211; the possible causes of a ReDoS &#8211; were not unique to one company&#8217;s customised code, but were inherited from a standard programming library.</p>
<p>Fortunately, the problems are easily fixed:</p>
<ul>
<li> <strong>Review pattern matching code carefully.</strong> Performance is important, especially when it can be affected by untrusted data sent in from outside.
<li> <strong>Include pathological samples in your test set.</strong> Don&#8217;t test pattern matching only for its accept/reject capabilities &#8211; test that it can accept or reject input within well-defined time limits.
<li> <strong>Limit how much long any pattern matching function can run.</strong>  The researchers found at least one server-side RE than ran in a time that was <em>exponential</em> with the length of the input &#8211; that&#8217;s way more dramatic and risky than the quadratic performance we showed above.
<li> <strong>Treat patterns that perform badly as a sign of trouble.</strong> Complex REs that occasionally run for ages are more likely to match where they shouldn&#8217;t &#8211; what&#8217;s known as a false positive. The longer an RE runs, the harder it&#8217;s trying to find a match and the more time it has to find an unanticipated one.
<li> <strong>Read the ReDoS paper.</strong> Some of the <a href="https://www.usenix.org/system/files/conference/usenixsecurity18/sec18-staicu.pdf" rel="nofollow">problematic REs</a> found in real-world use come from standard libraries, so it&#8217;s not just your own code that&#8217;s at risk &#8211; learn how to spot trouble before it happens.
<li> <strong>Divide and conquer.</strong> A series of simple, easy-to-understand checks is much easier to test and to maintain than a mega-complex super-combination RE that tries to pack multiple tests into one arcane formula.
</ul>
<p><img loading="lazy" src="https://news-sophos.go-vip.net/wp-content/uploads/sites/2/2018/08/redos-wacky-re-6402.png" width="640" height="180" class="aligncenter size-full wp-image-414919" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/redos-wacky-re-6402.png 640w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/redos-wacky-re-6402.png?resize=300,84 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2018/08/redos-wacky-re-6402.png?resize=100,28 100w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p><br />
</p>
			</div> <!-- .entry-content -->
	<ul class="block social follow">
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon twitter"><use xlink:href="#twitter"></use></svg>
			<p>Follow <strong><a href="https://twitter.com/nakedsecurity">@NakedSecurity on Twitter</a></strong> for the latest computer security news.</p>
		</li>
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon instagram"><use xlink:href="#instagram"></use></svg>
			<p>Follow <strong><a href="https://www.instagram.com/nakedsecurity/">@NakedSecurity on Instagram</a></strong> for exclusive pics, gifs, vids and LOLs!</p>
		</li>
	</ul>
</article><!-- #post-## -->

		<div class="free-tools-block">
			<h2 class="block-title">Free tools</h2>

<div class="ns-free-tools">
	<div class="ns-free-tools__item ns-free-tools__item--sophos-home">
		<a class="ns-free-tools__link" href="https://home.sophos.com/en-us.aspx?cmp=701j0000001eLpnAAE">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/sophos-home@2x.png" alt="Sophos Home" class="ns-free-tools__image" width="166" height="100">
			<h4 class="ns-free-tools__title">
				Sophos Home			</h4>
			<div class="ns-free-tools__sub-title">
				Protect personal PCs and Macs			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--hitman-pro">
		<a class="ns-free-tools__link" href="https://www.hitmanpro.com/en-us/hmp.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/hitman-pro@2x.png" alt="Hitman Pro" class="ns-free-tools__image" width="154" height="100">
			<h4 class="ns-free-tools__title">
				Hitman Pro			</h4>
			<div class="ns-free-tools__sub-title">
				Find and remove malware			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--intercept-x">
		<a class="ns-free-tools__link" href="https://www.sophos.com/en-us/products/free-tools/sophos-mobile-security-free-edition.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/mobile-security-android@2x.png" alt="Sophos Intercept X for Mobile" class="ns-free-tools__image" width="96" height="110">
			<h4 class="ns-free-tools__title">
				Intercept X for Mobile			</h4>
			<div class="ns-free-tools__sub-title">
				Protect Android devices			</div>
		</a>
	</div>
</div>
		</div>

			<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2018/08/21/whatsapp-urges-android-users-to-manually-backup-their-chats/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> WhatsApp urges Android users to manually backup their chats</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2018/08/22/microsoft-disrupts-fancy-bear-election-meddlers/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Microsoft disrupts Fancy Bear election meddlers</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	
	</main><!-- #main -->

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<section class="comments-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

			
<div id="comments" class="comments-area">

			<h2 class="comments-title">
			10 comments on &ldquo;<span>Serious Security: How to stop dodgy HTTP headers clogging your website</span>&rdquo;		</h2>

		<ol class="comment-list">
					<li id="comment-5214659" class="comment even thread-even depth-1 parent">
			<article id="div-comment-5214659" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/4dcc0faee302d28daa211c98159ace9a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4dcc0faee302d28daa211c98159ace9a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Bryan</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/#comment-5214659"><time datetime="2018-08-21T21:57:47+01:00">August 21, 2018 at 9:57 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Excellent analogies Duck (and RE expos). Thanks!</p>
<p>PS: small typo in<br />
<i>it tells us were the match happened</i></p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_5214659"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_5214659={"id":7238218,"unique_id":"wp-comment-5214659","title":"Excellent%20analogies%20Duck%20%28and%20RE%20expos%29.%20Thanks%21PS%3A%20small%20typo%20in%20%26lt%3Bi%26gt%3Bit%20tells%20us%20were%20the%20match%20happened%26lt%3B%2Fi%26gt%3B%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2018\/08\/21\/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website\/#comment-5214659","item_id":"_comm_5214659"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/?replytocom=5214659#respond' data-commentid="5214659" data-postid="414833" data-belowelement="div-comment-5214659" data-respondelement="respond" data-replyto="Reply to Bryan" aria-label='Reply to Bryan'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-5214809" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2">
			<article id="div-comment-5214809" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/#comment-5214809"><time datetime="2018-08-21T22:42:31+01:00">August 21, 2018 at 10:42 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Fixed, thanks.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_5214809"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_5214809={"id":7238218,"unique_id":"wp-comment-5214809","title":"Fixed%2C%20thanks.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2018\/08\/21\/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website\/#comment-5214809","item_id":"_comm_5214809"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/?replytocom=5214809#respond' data-commentid="5214809" data-postid="414833" data-belowelement="div-comment-5214809" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-5214819" class="comment even thread-odd thread-alt depth-1 parent">
			<article id="div-comment-5214819" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/4dcc0faee302d28daa211c98159ace9a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4dcc0faee302d28daa211c98159ace9a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Bryan</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/#comment-5214819"><time datetime="2018-08-21T22:47:20+01:00">August 21, 2018 at 10:47 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>That regex at the end had me confused; was wondering if the ReDoS researchers got their code by first breaking into web servers&#8211;but then I clicked the link, and (if I skimmed correctly) these are publicly-available and widely-used modules and not specimens captured in the wild.</p>
<p>Now it (the regexp) only has me confused for checking case-insensitive &#8220;crawl&#8221; and &#8220;spider&#8221; without devoting the same scrutiny to &#8220;scrape&#8221; or &#8220;bot.&#8221;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_5214819"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_5214819={"id":7238218,"unique_id":"wp-comment-5214819","title":"That%20regex%20at%20the%20end%20had%20me%20confused%3B%20was%20wondering%20if%20the%20ReDoS%20researchers%20got%20their%20code%20by%20first%20breaking%20into%20web%20servers--but%20then%20I%20clicked%20the%20link%2C%20and%20%28if%20I%20skimmed%20correctly%29%20these%20ar%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2018\/08\/21\/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website\/#comment-5214819","item_id":"_comm_5214819"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/?replytocom=5214819#respond' data-commentid="5214819" data-postid="414833" data-belowelement="div-comment-5214819" data-respondelement="respond" data-replyto="Reply to Bryan" aria-label='Reply to Bryan'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-5214857" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2 parent">
			<article id="div-comment-5214857" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/#comment-5214857"><time datetime="2018-08-21T23:07:17+01:00">August 21, 2018 at 11:07 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>They didn’t hack into running sites, but instead crawled through publicly available code.</p>
<p>When I wrote “in the wild” I didn’t mean to imply they’d broken into sites to inspect the actual code running at that moment :&#045;)</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_5214857"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_5214857={"id":7238218,"unique_id":"wp-comment-5214857","title":"They%20didnt%20hack%20into%20running%20sites%2C%20but%20instead%20crawled%20through%20publicly%20available%20code.When%20I%20wrote%20in%20the%20wild%20I%20didnt%20mean%20to%20imply%20theyd%20broken%20into%20sites%20to%20inspect%20the%20actual%20code%20running%20a%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2018\/08\/21\/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website\/#comment-5214857","item_id":"_comm_5214857"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/?replytocom=5214857#respond' data-commentid="5214857" data-postid="414833" data-belowelement="div-comment-5214857" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-5214869" class="comment even depth-3 parent">
			<article id="div-comment-5214869" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/4dcc0faee302d28daa211c98159ace9a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4dcc0faee302d28daa211c98159ace9a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Bryan</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/#comment-5214869"><time datetime="2018-08-21T23:28:58+01:00">August 21, 2018 at 11:28 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Yeah, I was about 85% confident I&#8217;d gleaned that properly from the linked PDF.</p>
<p>I didn&#8217;t see &#8220;in the wild&#8221; in your article (a search just now didn&#8217;t find it either).  I merely assumed until better judgment second guessed it&#8211;reading for content isn&#8217;t my best attribute today.<br />
:,)</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_5214869"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_5214869={"id":7238218,"unique_id":"wp-comment-5214869","title":"Yeah%2C%20I%20was%20about%2085%25%20confident%20I%26%23039%3Bd%20gleaned%20that%20properly%20from%20the%20linked%20PDF.I%20didn%26%23039%3Bt%20see%20%26quot%3Bin%20the%20wild%26quot%3B%20in%20your%20article%20%28a%20search%20just%20now%20didn%26%23039%3Bt%20find%20it%20either%29.%20%20I%20merely%20assumed%20until%20better%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2018\/08\/21\/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website\/#comment-5214869","item_id":"_comm_5214869"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/?replytocom=5214869#respond' data-commentid="5214869" data-postid="414833" data-belowelement="div-comment-5214869" data-respondelement="respond" data-replyto="Reply to Bryan" aria-label='Reply to Bryan'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-5214871" class="comment odd alt depth-4 parent">
			<article id="div-comment-5214871" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/4dcc0faee302d28daa211c98159ace9a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4dcc0faee302d28daa211c98159ace9a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Bryan</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/#comment-5214871"><time datetime="2018-08-21T23:30:19+01:00">August 21, 2018 at 11:30 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Still a great article.  I expect people who are unfamiliar with regexes will still be able to follow.  Very well done, clearly described.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_5214871"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_5214871={"id":7238218,"unique_id":"wp-comment-5214871","title":"Still%20a%20great%20article.%20%20I%20expect%20people%20who%20are%20unfamiliar%20with%20regexes%20will%20still%20be%20able%20to%20follow.%20%20Very%20well%20done%2C%20clearly%20described.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2018\/08\/21\/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website\/#comment-5214871","item_id":"_comm_5214871"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/?replytocom=5214871#respond' data-commentid="5214871" data-postid="414833" data-belowelement="div-comment-5214871" data-respondelement="respond" data-replyto="Reply to Bryan" aria-label='Reply to Bryan'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-5214881" class="comment byuser comment-author-pducklin bypostauthor even depth-5">
			<article id="div-comment-5214881" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/#comment-5214881"><time datetime="2018-08-21T23:40:35+01:00">August 21, 2018 at 11:40 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks, we appreciate the kind words! (Especially when we draw our bosses’ attention to them :&#045;)</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_5214881"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_5214881={"id":7238218,"unique_id":"wp-comment-5214881","title":"Thanks%2C%20we%20appreciate%20the%20kind%20words%21%20%28Especially%20when%20we%20draw%20our%20bosses%20attention%20to%20them%20%3A%26%23045%3B%29%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2018\/08\/21\/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website\/#comment-5214881","item_id":"_comm_5214881"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/?replytocom=5214881#respond' data-commentid="5214881" data-postid="414833" data-belowelement="div-comment-5214881" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-5214880" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-4">
			<article id="div-comment-5214880" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/#comment-5214880"><time datetime="2018-08-21T23:40:04+01:00">August 21, 2018 at 11:40 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I reworded it a bit to make it clear that where they found regrettable REs it was by looking for them where they were supposed to be found, not by sneaking a peek behind anyone’s curtains on closed servers. </p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_5214880"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_5214880={"id":7238218,"unique_id":"wp-comment-5214880","title":"I%20reworded%20it%20a%20bit%20to%20make%20it%20clear%20that%20where%20they%20found%20regrettable%20REs%20it%20was%20by%20looking%20for%20them%20where%20they%20were%20supposed%20to%20be%20found%2C%20not%20by%20sneaking%20a%20peek%20behind%20anyones%20curtains%20on%20close%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2018\/08\/21\/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website\/#comment-5214880","item_id":"_comm_5214880"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/?replytocom=5214880#respond' data-commentid="5214880" data-postid="414833" data-belowelement="div-comment-5214880" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-5216939" class="comment even thread-even depth-1 parent">
			<article id="div-comment-5216939" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/065431ad6ec18e453a2fcc294447dc67?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/065431ad6ec18e453a2fcc294447dc67?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">James Beckett (@hackery)</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/#comment-5216939"><time datetime="2018-08-22T14:05:56+01:00">August 22, 2018 at 2:05 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Is this specifically a Javascript / NodeJS implementation issue of pathological performance cases? The paper doesn&#8217;t seem to draw any comparisons (sic) to libc, Perl/Python etc. Backtracking isn&#8217;t used by all regex engines. <em>Regular Expression Matching Can Be Simple And Fast<br />
(but is slow in Java, Perl, PHP, Python, Ruby, &#8230;)</em> by Russ Cox is one paper that explores some issues around the different performance characteristics of automata design for regex evaluation.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_5216939"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_5216939={"id":7238218,"unique_id":"wp-comment-5216939","title":"Is%20this%20specifically%20a%20Javascript%20%2F%20NodeJS%20implementation%20issue%20of%20pathological%20performance%20cases%3F%20The%20paper%20doesn%26%23039%3Bt%20seem%20to%20draw%20any%20comparisons%20%28sic%29%20to%20libc%2C%20Perl%2FPython%20etc.%20Backtracking%20isn%26%23039%3B%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2018\/08\/21\/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website\/#comment-5216939","item_id":"_comm_5216939"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/?replytocom=5216939#respond' data-commentid="5216939" data-postid="414833" data-belowelement="div-comment-5216939" data-respondelement="respond" data-replyto="Reply to James Beckett (@hackery)" aria-label='Reply to James Beckett (@hackery)'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-5217181" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2">
			<article id="div-comment-5217181" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/#comment-5217181"><time datetime="2018-08-22T17:08:10+01:00">August 22, 2018 at 5:08 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>The ReDoS paper does indeed focus specifically on JavaScript&#8217;s execution model as exposed in server-side implementations such as Node.js, and on the JavaScript RE engine. As the paper specifically says, it presents &#8220;the first comprehensive study of ReDoS vulnerabilities  in  JavaScript-based web servers.&#8221;</p>
<p> I suspect I may have oversimplified the issues here by focusing on anchored versus unanchored searches, when (as you say) there are also issues in how a regexp engine is implemented in the first place. Technically, it seems to boil down to whether you use recursive backtracking to recover from false starts while trying a match, or use an implementation based on finite automatons. For the curious, I&#8217;ll include a link to the paper you mention, which is a fascinating read (thanks for the reference!):</p>
<p>https://swtch.com/~rsc/regexp/regexp1.html</p>
<p>The article got rather carried away (by which I guess I mean *I* got carried away) with REs, but the problem of how to divide-and-conquer your server-side event-driven network code so it doesn&#8217;t have places where a delay can tie things up badly &#8211; in other words, how to limit the length of time the burger counter guy is allowed to spend locked in argument with customer 31 while customer 32 waits helplessly by &#8211; is an equally important lesson in all of this.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_5217181"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_5217181={"id":7238218,"unique_id":"wp-comment-5217181","title":"The%20ReDoS%20paper%20does%20indeed%20focus%20specifically%20on%20JavaScript%26%23039%3Bs%20execution%20model%20as%20exposed%20in%20server-side%20implementations%20such%20as%20Node.js%2C%20and%20on%20the%20JavaScript%20RE%20engine.%20As%20the%20paper%20specificall%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2018\/08\/21\/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website\/#comment-5217181","item_id":"_comm_5217181"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/?replytocom=5217181#respond' data-commentid="5217181" data-postid="414833" data-belowelement="div-comment-5217181" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">What do you think? <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2018/08/21/serious-security-how-to-stop-dodgy-http-headers-clogging-your-website/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://nakedsecurity.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='414833' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="8322c66600" /></p><input type="hidden" id="ak_js" name="ak_js" value="40"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->
		<div class="comments-widget-area">
					</div>
	
	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	

	<section class="recommended-panel">
	<div class="container">
	<div class="panel-content ">

		<h3 class="block-title">Recommended reads</h3>
	<div class="blocks">
		<article id="post-544767" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/01/29/the-mystery-of-the-missing-perl-webite/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/01/perl-1200.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Jan</span><span class="day">29</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">9</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/01/29/the-mystery-of-the-missing-perl-webite/" rel="bookmark">The mystery of the missing Perl website</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-547343" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/02/22/nvidia-announces-official-anti-cryptomining-software-drivers/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/02/mr-1200.jpg?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Feb</span><span class="day">22</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">33</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/02/22/nvidia-announces-official-anti-cryptomining-software-drivers/" rel="bookmark">Nvidia announces official &#8220;anti-cryptomining&#8221; software drivers</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-544993" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/02/03/what-should-you-say-if-you-have-a-data-breach-catch-up-with-jason-nurse-at-sophos-evolve/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/02/jason-1200.jpg?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Feb</span><span class="day">03</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Sally Adam	
	</div>
			<div class="comment-box">
				<span class="count">2</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/02/03/what-should-you-say-if-you-have-a-data-breach-catch-up-with-jason-nurse-at-sophos-evolve/" rel="bookmark">What should you say if you have a data breach? Catch up with Jason Nurse at Sophos Evolve</a></h3>	</div>
</article> <!-- .card-article -->
	</div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="footer-container">
			<a href="#" class="js-collapse-footer"><svg style="height: 20px" viewBox="0 0 132 24" class="block icon sophos"><use xlink:href="#sophos"></use></svg></a>
			<div id="collapseFooter" class="blocks">
				<div class="sophos block">
					<ul id="menu-footer-primary" class="primary menu"><li id="menu-item-306737" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306737"><a href="https://nakedsecurity.sophos.com/about/">About Naked Security</a></li>
<li id="menu-item-306754" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306754"><a href="https://www.sophos.com/en-us/company.aspx">About Sophos</a></li>
<li id="menu-item-306747" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306747"><a href="https://nakedsecurity.sophos.com/send-us-a-tip/">Send us a tip</a></li>
<li id="menu-item-323171" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323171"><a href="/cookies-and-scripts/">Cookies</a></li>
<li id="menu-item-323170" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323170"><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
<li id="menu-item-323169" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323169"><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
</ul>				</div>
										<div class="news block">
							<ul id="menu-products-column-one" class="small menu"><li id="menu-item-306998" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306998"><a href="https://www.sophos.com/en-us/products/intercept-x.aspx">Intercept X</a></li>
<li id="menu-item-440801" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440801"><a href="https://www.sophos.com/en-us/products/server-security.aspx">Intercept X for Server</a></li>
<li id="menu-item-440802" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440802"><a href="https://www.sophos.com/en-us/products/mobile-control.aspx">Intercept X for Mobile</a></li>
</ul>						</div>
											<div class="products block">
							<ul id="menu-products-column-two" class="small menu"><li id="menu-item-440803" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440803"><a href="https://www.sophos.com/en-us/products/next-gen-firewall.aspx">XG Firewall</a></li>
<li id="menu-item-440805" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440805"><a href="https://www.sophos.com/en-us/products/sophos-email.aspx">Sophos Email</a></li>
<li id="menu-item-440804" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440804"><a href="https://www.sophos.com/en-us/products/secure-wifi.aspx">Sophos Wireless</a></li>
</ul>						</div>
											<div class="threats block">
							<ul id="menu-server-protection" class="small menu"><li id="menu-item-440806" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440806"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx">Managed Threat Response</a></li>
<li id="menu-item-448404" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-448404"><a href="https://www.sophos.com/en-us/products/cloud-optix.aspx">Cloud Optix</a></li>
<li id="menu-item-440807" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440807"><a href="https://www.sophos.com/en-us/products/phish-threat.aspx">Phish Threat</a></li>
</ul>						</div>
								</div>
			<ul class="block social footer">
				<li class="twitter"><a rel="nofollow" href="https://twitter.com/NakedSecurity" title="Follow our team of security experts on Twitter"><svg style="height: 14px" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
				<li class="facebook"><a rel="nofollow" href="https://www.facebook.com/SophosSecurity" title="Join over 250,000 people in our Facebook community"><svg style="height: 14px" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
				<li class="instagram"><a rel="nofollow" href="https://www.instagram.com/nakedsecurity/" title="Follow Naked Security on Instagram"><svg style="height: 14px" viewBox="0 0 100 100" class="icon instagram"><use xlink:href="#instagram"></use></svg></a></li>
				<li class="linkedin"><a rel="nofollow" href="https://www.linkedin.com/company/5053/" title="Join the naked security discussion group on LinkedIn"><svg style="height: 14px" viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
				<li class="rss"><a rel="nofollow" href="/feed" title="Subscribe to our RSS feed"><svg style="height: 14px" viewBox="0 0 100 100" class="icon rss"><use xlink:href="#rss"></use></svg></a></li>
			</ul>

							<div class="vip-powered-wpcom">
					<span class="copyright">© 1997 - 2021 Sophos Ltd.</span>
					All rights reserved.
					Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=nakedsecurity.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>				</div>
					</div>
		<script type="text/javascript">
			window.cookieconsent_options = {
				"message":"This site uses cookies. By continuing to browse the site you are agreeing to our use of cookies.",
				"dismiss":"Got it!",
				"learnMore":"Learn More",
				"link":"/cookies-and-scripts",
				"theme":"https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/css/sophos.css"};
		</script>
	</footer><!-- #colophon -->
</div><!-- #page -->
<div id="survey-wrapper" class="mfp-hide"><div class="pd-embed" id="pd_1499706777" data-settings=""></div></div>
<script id='child-js-plugins-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"0","nextLink":""};
</script>
<script id='child-js-core-js-extra'>
var Sophos = {"ajaxurl":"https:\/\/nakedsecurity.sophos.com\/wp-admin\/admin-ajax.php","nonce":"64f6810f0c"};
</script>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJyNjkEOwjAMBD9EalKU3hBPQZAamhDbUZyo4vdEiEocOHD07ozWsGbjhStyhbogoYJKXkQZVzXj3jqICjm1e2Adou7gL8FLwY0O7FObO/fOibppCub0HCjwL6ifSFecv/ttkpr5PAOXR1DCCufuwk0KdfZERztZdxitc1N8ARFpT3A='></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161173',post:'414833',tz:'0',srv:'nakedsecurity.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161173', '414833' ]);
</script>
</body>
</html>
