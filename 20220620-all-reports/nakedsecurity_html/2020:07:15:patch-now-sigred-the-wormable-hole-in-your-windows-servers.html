<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="RHQeasQqjasbRt5asY6atZYbs5tr10gFBevDt2HRhW0" />
<link rel="pingback" href="https://nakedsecurity.sophos.com/xmlrpc.php">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5VK6LTK');</script>
<!-- End Google Tag Manager -->

<meta name="description" content="The bug can definitely crash your Windows DNS servers, and it could end up being used for much worse than that. Please patch now!" />
<meta name="keywords" content="microsoft, vulnerability, bwain, exploit, microsoft, sigred, vulnerability, windows, worm" />
<title>Patch now! SIGRED &#8211; the wormable hole in your Windows servers &#8211; Naked Security</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="I9dHFo-YhnK2MfAHn-20V4GnWrOttVUYyISGamyU41M" />
<meta name="msvalidate.01" content="7D8D1FA2892142B1543D2CBCD07FB88F" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Feed" href="https://nakedsecurity.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Comments Feed" href="https://nakedsecurity.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Patch now! SIGRED &#8211; the wormable hole in your Windows servers Comments Feed" href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/feed/" />
<link rel='stylesheet' id='all-css-0' href='https://nakedsecurity.sophos.com/_static/??-eJyVz00KwjAQhuELmUwjptCFeJY0HUw0f2QmlN6+KXbnRpcD7wPfwFqETza0BQksESyeGOaQ7VsEP1dTNyDeAsrok+zBBbqwOTEmBnYYu6NcXKaEK4nroPQJ/olFMIzEv5pjqFkku4qGhWs9rtLE8uVjEyW0p08EL+Ri+leT/PjzPsgj3tWo9G0ctJp2dx1jEg==' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpmWEWAK8/Ihc='></script>
<link rel="https://api.w.org/" href="https://nakedsecurity.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://nakedsecurity.sophos.com/wp-json/wp/v2/posts/518029" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://nakedsecurity.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://nakedsecurity.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/" />
<link rel='shortlink' href='https://nakedsecurity.sophos.com/?p=518029' />
<link rel="alternate" type="application/json+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2020%2F07%2F15%2Fpatch-now-sigred-the-wormable-hole-in-your-windows-servers%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2020%2F07%2F15%2Fpatch-now-sigred-the-wormable-hole-in-your-windows-servers%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Patch now! SIGRED &#8211; the wormable hole in your Windows servers" />
<meta property="og:url" content="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/" />
<meta property="og:description" content="The bug can definitely crash your Windows DNS servers, and it could end up being used for much worse than that. Please patch now!" />
<meta property="article:published_time" content="2020-07-15T18:56:16+00:00" />
<meta property="article:modified_time" content="2020-07-16T14:46:34+00:00" />
<meta property="og:site_name" content="Naked Security" />
<meta property="og:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-1200.png?w=775" />
<meta property="og:image:secure_url" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-1200.png?w=775" />
<meta property="og:image:width" content="775" />
<meta property="og:image:height" content="405" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:creator" content="@NakedSecurity" />
<meta name="twitter:site" content="@NakedSecurity" />
<meta name="twitter:text:title" content="Patch now! SIGRED &#8211; the wormable hole in your Windows servers" />
<meta name="twitter:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-1200.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=270" />
</head>
<body class="post-template-default single single-post postid-518029 single-format-standard" >
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VK6LTK"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div style="display: none">
<svg>
	<symbol id="sophos" viewBox="0 0 132 24">
		<path d="m111.82 22.176h11.64c3.267 0 4.65-0.2 5.74-0.896 1.715-1.063 2.804-3.26 2.804-5.62 0-1.928-0.658-3.89-1.647-4.888-1.288-1.33-3.035-1.828-6.271-1.828h-3.527c-1.586 0-2.754-0.067-3.412-0.365-0.794-0.367-1.256-1.165-1.256-2.161 0-1.165 0.56-2.03 1.486-2.264 0.692-0.163 1.498-0.163 3.574-0.198h10.419v-3.956h-11.473c-2.574 0-3.727 0.099-4.718 0.466-2.279 0.796-3.828 3.257-3.828 6.083 0 1.93 0.76 3.727 2.079 4.89 1.155 0.996 2.872 1.462 5.51 1.462h4.697c1.057 0 1.915 0.132 2.376 0.398 0.893 0.433 1.418 1.328 1.418 2.36 0 0.864-0.395 1.597-1.087 2.027-0.561 0.369-1.517 0.534-3.268 0.534h-11.256zm-111.35 0h11.64c3.267 0 4.652-0.2 5.741-0.896 1.714-1.063 2.803-3.26 2.803-5.62 0-1.928-0.66-3.89-1.65-4.888-1.285-1.33-3.034-1.828-6.27-1.828h-3.527c-1.584 0-2.751-0.067-3.41-0.365-0.792-0.367-1.253-1.165-1.253-2.161 0-1.165 0.56-2.03 1.484-2.264 0.693-0.163 1.496-0.163 3.574-0.198h10.42v-3.956h-11.477c-2.573 0-3.727 0.099-4.715 0.466-2.278 0.796-3.83 3.257-3.83 6.083 0 1.93 0.762 3.727 2.08 4.89 1.155 0.996 2.871 1.462 5.51 1.462h4.696c1.057 0 1.913 0.132 2.377 0.398 0.888 0.433 1.416 1.328 1.416 2.36 0 0.864-0.394 1.597-1.089 2.027-0.558 0.369-1.517 0.534-3.264 0.534h-11.256v3.956zm94.05-16.18c-0.68 1.076-1.003 2.803-1.003 5.122 0 5.088 1.747 7.405 5.63 7.405 3.822 0 5.568-2.317 5.568-7.34 0-5.092-1.715-7.373-5.568-7.373-2.102 0-3.754 0.784-4.627 2.186zm13.174-2.511c1.329 1.761 2.072 4.63 2.072 7.992 0 3.816-1.197 6.948-3.334 8.677-1.619 1.304-4.078 2.022-6.995 2.022-4.142 0-7.41-1.372-9.092-3.817-1.263-1.793-1.88-4.176-1.88-7.08 0-4.172 1.133-7.339 3.27-9.035 1.682-1.37 4.339-2.122 7.383-2.122 3.85 0 6.925 1.209 8.576 3.363zm-22.018-3.068h-4.596v8.908h-8.319v-8.908h-4.597v21.759h4.597v-8.97h8.318v8.97h4.596v-21.759zm-28.61 10.277c1.23 0 1.941-0.163 2.427-0.62 0.581-0.49 0.938-1.533 0.938-2.74 0-1.436-0.58-2.478-1.584-2.838-0.356-0.13-0.94-0.197-1.684-0.197h-6.344v6.395zm-6.247 11.481h-4.598v-21.758h10.78c3.786 0 5.114 0.39 6.538 1.991 1.264 1.37 1.942 3.163 1.942 5.088 0 2.284-0.904 4.404-2.394 5.676-1.262 1.077-2.43 1.402-4.888 1.402h-7.38zm-22.589-16.179c-0.682 1.076-1.004 2.803-1.004 5.122 0 5.088 1.748 7.405 5.634 7.405 3.818 0 5.568-2.317 5.568-7.34 0-5.092-1.716-7.373-5.568-7.373-2.106 0-3.757 0.784-4.63 2.186zm13.174-2.511c1.328 1.761 2.073 4.63 2.073 7.992 0 3.816-1.2 6.948-3.335 8.677-1.618 1.304-4.079 2.022-6.993 2.022-4.144 0-7.413-1.372-9.096-3.817-1.264-1.793-1.878-4.176-1.878-7.08 0-4.172 1.133-7.339 3.272-9.035 1.681-1.37 4.337-2.122 7.38-2.122 3.851 0 6.93 1.209 8.578 3.363z"></path>
	</symbol>
	<symbol id="twitter" viewBox="0 0 24 24">
 		<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path>
 	</symbol>
	<symbol id="facebook" viewBox="0 0 24 24">
 		<path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path>
 	</symbol>
	<symbol id="instagram" viewBox="0 0 24 24">
		<path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path>
	</symbol>
	<symbol id="linkedin" viewBox="0 0 24 24">
		<path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"></path>
	</symbol>
	<symbol id="rss" viewBox="0 0 24 24">
		<path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"></path>
	</symbol>
	<symbol id="reddit" viewBox="0 0 24 24">
		<path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"></path>
	</symbol>
</svg>
</div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header variation variation-3" role="banner">
		<div class="header-container">
			<div class="site-branding">
				<div class="site-title">
					<a title="Naked Security" href="https://nakedsecurity.sophos.com/" rel="home"><img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/naked-security-logo-white@2x.png"></a>
					by
					<a title="sophos.com" href="https://www.sophos.com"><svg viewBox="0 0 132 24" class="icon sophos"><use xlink:href="#sophos"></use></svg></a>
				</div>
			</div><!-- .site-branding -->
			<nav id="site-navigation" class="main-navigation" role="navigation">
				<div class="container">
					<ul id="menu-variation-two" class="exit-links menu"><li id="menu-item-436509" class="products menu-item menu-item-type-custom menu-item-object-custom menu-item-436509"><a href="#">Products</a></li>
<li id="menu-item-436515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436515"><a href="https://www.sophos.com/en-us/products/free-tools.aspx">Free Tools</a></li>
<li id="menu-item-436531" class="search-toggle menu-item menu-item-type-custom menu-item-object-custom menu-item-436531"><a href="#">Search</a></li>
<li id="menu-item-436532" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436532"><a href="https://home.sophos.com/en-us.aspx">Free Sophos Home</a></li>
</ul>				</div>
			</nav><!-- #site-navigation -->
			<div class="site-search-block">
	<form target="_top" role="search" class="search-form" method="get" action="https://nakedsecurity.sophos.com/">
        <fieldset>
            <div class="field">
				<input type="search" value="" name="s" class="search-field" placeholder="Search naked security...">
            </div>
            <div class="submit">
				<button type="submit" class="search-submit button">Go</button>
            </div>
        </fieldset>
    </form>
</div>
		</div><!-- .container -->
	</header>

	<div class="responsive-flyout-panel small-12 column active" style="opacity: 1; display: none;">
		<div class="modal-filler"></div>
	    <div class="productNavBox">
	        <div class="productNavContainer">
	            <div class="row prodRow">
	                <div class="prodListBox column large-9">
	                    <div class="row margin-0 highlightProduct">
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/next-gen-firewall.aspx"><img src="https://www.sophos.com/medialibrary/2F4785DE8C3F43ECBD699A18F332FEEB.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">XG Firewall</div>
	                                	<div class="menu-section-subtitle">Next-Gen Firewall</div>
									</div>
	                            </a>
	                        </div>
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/intercept-x.aspx"><img src="https://www.sophos.com/medialibrary/27111765D65A45D49A232925D2CE428B.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">Intercept X</div>
	                                	<div class="menu-section-subtitle">Next-Gen Endpoint</div>
									</div>
	                            </a>
	                        </div>
	                    </div>
	                    <div class="productList">
	                        <ul>
								<li>
									<a href="https://www.sophos.com/en-us/products/cloud-optix.aspx"><img src="https://www.sophos.com/medialibrary/SophosNext/Images/Products/Icons/sophos-cloud-optix-icon.svg">Sophos Cloud Optix</a>
								</li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-central.aspx"><img src="https://www.sophos.com/medialibrary/08EA66123F1B4DDE8FE5C9B578A7FAA7.ashx">Sophos Central</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/mobile-control.aspx"><img src="https://www.sophos.com/medialibrary/678FE994855047739F50D6C411184FA6.ashx">Sophos Mobile</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/server-security.aspx"><img src="https://www.sophos.com/medialibrary/01B80E7D7CD54EF8AC2E51C9C6EC0236.ashx">Intercept X for Server</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-wifi.aspx"><img src="https://www.sophos.com/medialibrary/BEBD9C41BB4E480498514B29B92A145A.ashx">Secure Wi-Fi</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/phish-threat.aspx"><img src="https://www.sophos.com/medialibrary/DC9D1A7BA3964B0C9DAF1F1E68806B5A.ashx">Phish Threat</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/safeguard-encryption.aspx"><img src="https://www.sophos.com/medialibrary/8F51F06B62814B108D3B2763FF018E37.ashx">SafeGuard Encryption</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-email.aspx"><img src="https://www.sophos.com/medialibrary/597ADA0AF01A4A12B2B27239D0F9992C.ashx">Secure Email</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/unified-threat-management.aspx"><img src="https://www.sophos.com/medialibrary/8CB72BF5E1AD41F7894CE5E42101B0F3.ashx">SG UTM</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-web-gateway.aspx"><img src="https://www.sophos.com/medialibrary/C586E372694547A1B207A61D87246BA7.ashx">Secure Web Gateway</a>
	                            </li>
	                        </ul>
	                    </div>
	                </div>
	                <div class="homeUserBox column large-3">
						<img src="https://www.sophos.com/medialibrary/3376DF5742A64AEE93FDB9DCA7291239.ashx">
						<div class="menu-section-title">For Home Users</div>
	                    <p>Sophos Home protects every Mac and PC in your home </p><a href="https://home.sophos.com/" target="_blank" class="greenSmallMenuBtn">Learn More</a>
					</div>
	            </div>
	            <div class="row blueRow">
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-tools.aspx"><img width="19" src="https://www.sophos.com/medialibrary/A1FF440D2BB84511B8C94D771D44E207.ashx">Free Security Tools</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-trials.aspx"><img width="20" src="https://www.sophos.com/medialibrary/FCD3410ED2C347808D9DB8AC12C62DBD.ashx">Free Trials</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/demos.aspx"><img width="18" src="https://www.sophos.com/medialibrary/50985180E5F54C94917A2A6508E24287.ashx">Product Demos</a>
	                </div>
	                <!-- <div class="column large-3 medium-6">
	                    <a href="javascript:fairfax.openLiveChatFromFlyoutLink();" class="flyout-live-chat-link"><img width="20" src="https://www.sophos.com/medialibrary/E24C5050837145F6A5C592E299BA2A0D.ashx">Live Sales Chat</a>
	                </div> -->
	            </div>
	        </div>
	    </div>
	</div>
	<script>

	jQuery(document).ready( function () {
		var productButton   = jQuery('nav .menu-item.products');
		var modalBackground = jQuery('.modal-filler');
		var flyoutMenu		= jQuery('.responsive-flyout-panel');
		var Sophos			= Sophos || {};

		Sophos.MenuTest = {};

		Sophos.MenuTest.open = function () {
				productButton.addClass('open');
				flyoutMenu.show();
				modalBackground.show();
		};

		Sophos.MenuTest.close = function () {
			productButton.removeClass('open');
			flyoutMenu.hide();
			modalBackground.hide();
		};

		Sophos.MenuTest.toggle = function () {
			if ( productButton.hasClass('open') ) {
				Sophos.MenuTest.close();
			} else {
				Sophos.MenuTest.open();
			}
		};

		productButton.click( Sophos.MenuTest.toggle );
		modalBackground.click( Sophos.MenuTest.close );
	});

	</script>

	
	<section class="about-panel">
	<div class="container">
	<div class="panel-content ">

		<div class="description"><span>Have you listened to our podcast? <a href="/podcast/">Listen now</a></span></div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	<div id="content" class="site-content">
		<div class="content-container">

</div> <!-- .container -->
</div> <!-- #content -->


	<section class="content-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

		<main id="main" class="site-main" role="main">

	
		
<article id="post-518029" class="post-518029 post type-post status-publish format-standard has-post-thumbnail hentry category-featured category-microsoft category-vulnerability tag-bwain tag-exploit tag-microsoft tag-sigred tag-vulnerability-2 tag-windows tag-worm">

	<header class="entry-header">
		<h1 class="entry-title">Patch now! SIGRED &#8211; the wormable hole in your Windows servers</h1>		<div class="entry-meta">
			<div>
				
	<span class="entry-published">
		<time class="entry-date published" datetime="2020-07-15T19:56:16+01:00">15 Jul 2020</time>
	</span>

					<a href="#comments" class="comment-box">
					<span class="count">26</span>
				</a>
					
	<span class="entry-categories">
	<a href="https://nakedsecurity.sophos.com/category/organisations/microsoft/">Microsoft</a>, <a href="https://nakedsecurity.sophos.com/category/security-threats/vulnerability/">Vulnerability</a>	</span>

			</div>
	</header> <!-- .entry-header -->

    <div id="newsletter-signup" class="container top"></div>

			<div class="entry-featured-image">
			<img width="780" height="408" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-1200.png?w=780&amp;h=408&amp;crop=1" class="attachment-hero-thumbnail size-hero-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-1200.png 1200w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-1200.png?resize=300,157 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-1200.png?resize=768,401 768w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-1200.png?resize=1024,535 1024w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-1200.png?resize=780,408 780w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-1200.png?resize=100,52 100w" sizes="(max-width: 780px) 100vw, 780px" />					</div> <!-- .entry-featured-image -->
		
		<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2020/07/14/raticate-malware-gang-goes-commercial/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> RATicate malware gang goes commercial</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2020/07/16/twitter-limits-tweeting-as-prominent-accounts-spam-out-cryptocoin-scams/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Twitter limits tweeting as prominent accounts spam out cryptocoin scams</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	<div class="entry-content">
		<div class="entry-prefix">
			<div class="entry-author">
				
	
					<span class="by">by</span>
			<a href="https://nakedsecurity.sophos.com/author/paul-ducklin/" title="Posts by Paul Ducklin" class="author url fn" rel="author">Paul Ducklin</a>		
	
				</div>
			<div class="entry-sharing">
				
	<ul class="block social share">
		<li class="facebook"><a href="https://www.facebook.com/share.php?u=https%3A%2F%2Fnakedsecurity.sophos.com%2F2020%2F07%2F15%2Fpatch-now-sigred-the-wormable-hole-in-your-windows-servers%2F&title=Patch+now%21+SIGRED+%E2%80%93+the+wormable+hole+in+your+Windows+servers" data-title="Patch now! SIGRED – the wormable hole in your Windows servers" title="Share on Facebook"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
		<li class="twitter"><a href="https://twitter.com/intent/tweet?text=Patch+now%21+SIGRED+%E2%80%93+the+wormable+hole+in+your+Windows+servers+https%3A%2F%2Fnakedsecurity.sophos.com%2F%3Fp%3D518029" data-title="Patch now! SIGRED &#8211; the wormable hole in your Windows servers" title="Share on Twitter"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
		<li class="linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2020%2F07%2F15%2Fpatch-now-sigred-the-wormable-hole-in-your-windows-servers%2F&title=Patch+now%21+SIGRED+%E2%80%93+the+wormable+hole+in+your+Windows+servers" data-title="Patch now! SIGRED – the wormable hole in your Windows servers" title="Share on LinkedIn"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
		<li class="reddit"><a href="https://reddit.com/submit/?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2020%2F07%2F15%2Fpatch-now-sigred-the-wormable-hole-in-your-windows-servers%2F&title=Patch+now%21+SIGRED+%E2%80%93+the+wormable+hole+in+your+Windows+servers" title="Share on Reddit"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon reddit"><use xlink:href="#reddit"></use></svg></a></li>

			</ul>

				</div>
		</div>
		<p>Yesterday was Patch Tuesday, and with <a href="https://news.sophos.com/en-us/2020/07/14/its-always-dns-including-on-july-2020s-patch-tuesday/">123 bugs fixed</a>, including 20 in the &#8220;critical&#8221; category, we&#8217;re saying what we always do, namely, &#8220;Patch early, patch often.&#8221;</p>
<p>As often happens, however, one BWAIN (that&#8217;s shorthand for <em>Bug With An Impressive Name</em>) that was patched in the Windows DNS server is flying high in the headlines because Microsoft itself has come <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350" rel="follow">straight out and said</a>:</p>
<blockquote><p>
We consider this to be a wormable vulnerability, meaning that it has the potential to spread via malware between vulnerable computers without user interaction. DNS is a foundational networking component and commonly installed on Domain Controllers, so a compromise could lead to significant service interruptions and the compromise of high level domain accounts.</p></blockquote>
<p>The vulnerability turned out to be a long-standing bug that needing fixing in <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350" rel="nofollow">every supported version</a> of Windows Server from 2008 to the present day. </p>
<p>The bug has been dramatically dubbed <strong>SIGRed</strong>, presumably in a cheeky historical nod to the Code Red worm of 2001, but it&#8217;s more officially known as <strong>CVE-2020-1350</strong>, and it has been given a CVSS Base Score of 10.0.</p>
<p>CVSS stands for <em>Common Vulnerability Scoring System</em>, and it&#8217;s a cybsecurity bug measurement system promoted by the US government&#8217;s National Institute of Standards and Technology (NIST) that tries to reduce bug severities to a <a href="https://nvd.nist.gov/vuln-metrics/cvss" rel="nofollow">single, dimensionless number</a> between zero and 10.</p>
<p>In truth, this reductionist approach isn&#8217;t always helpful &#8211; an A-grade washing machine that you use excessively because &#8220;the label says it&#8217;s green&#8221; is much worse for the environment in the long run than an E-grade light bulb you turn on occasionally for the cool effect it produces&#8230;</p>
<p>&#8230;but in this case, we&#8217;re prepared to say that a CVSS score of 10.0, where the absolute maximum is 10.0, is something that really does scream, &#8220;Patch now.&#8221;</p>
<p>The good news for most of us, at least in terms of patching, is that this vulnerability only affects Windows servers, because the bug is in the Windows DNS server code, not in the Windows DNS client code.</p>
<p>The bad news for many of us, of course, is that this vulnerability affects Windows servers.</p>
<p>If you&#8217;re hooked up &#8211; whether at the office or from home &#8211; to a company network that relies on Windows, crooks who find a way to exploit this bug could directly or indirectly put you at risk, even if you&#8217;re not running Windows yourself, by hacking into the core of the network.</p>
<aside id="sophos_ad-3" class="widget sophos-inline-ad sophos_widget_ad">				<style></style>
				<div class="sophos_widget_ad"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx" class="s-ad-threat-hunter__link-wrapper">
  <div class="s-ad-threat-hunter">
    <div class="s-ad-threat-hunter__title">
      OTHERS STOP AT NOTIFICATION. WE TAKE ACTION
    </div>
    <div class="s-ad-threat-hunter__text">
      Get 24/7 managed threat hunting, detection, and response delivered by
      Sophos experts
    </div>
    <div class="s-ad-threat-hunter__action">
      <span class="s-button s-button--bright-green"> Learn&nbsp;more </span>
    </div>
  </div>
</a></div>
			</aside>
<h2>The bug and where to find it</h2>
<p>As you probably know, DNS is short for <em>Domain Name System</em>, and it&#8217;s a distributed, global database that converts human-friendly computer names such as <code>nakedsecurity.sophos.com</code> into network numbers that computers can use, such as <code>192.0.66.200</code>. (At least, that&#8217;s what the name-to-number mapping was for us at 2020-07-15T12:00Z.)</p>
<p>Loosely speaking, there are two broad classes of DNS software: <i>clients</i> that send out requests asking questions such as &#8220;where is <code>nakedsecurity</code> to be found?&#8221;, and <i>servers</i> that work out the answers to those requests and send back the responses.</p>
<p>Interestingly, the CVE-2020-1350 bug exists in a part of the Windows DNS software that listens for DNS responses coming back, rather than in the part that listens for DNS questions sent out the first place.</p>
<p>In other words, you&#8217;re probably thinking that this bug would have to be in the client code, and would therefore affect every Windows computer on the network &#8211; after all, DNS servers are there to receive <em>requests</em>, while it&#8217;s DNS clients that receive <em>responses</em>.</p>
<p>But DNS servers often need to perform client-like functions, for example by passing on requests that they can&#8217;t answer themselves to other servers that can, reading in the replies and reformatting them to reply to the original client request that came in.</p>
<p>So many, if not most, DNS servers &#8211; including the Windows DNS server &#8211; have code built into them that not only listens for requests but also processes reponses from other servers.</p>
<p>This bug, according to the Check Point researchers who discovered it, is <a href="https://research.checkpoint.com/2020/resolving-your-way-into-domain-adsmin-exploiting-a-17-year-old-bug-in-windows-dns-servers/" rel="nofollow">unique</a> to the Windows DNS server software (<code>dns.exe</code>) because the Windows DNS server and client programs don&#8217;t seem to share any code.</p>
<p style="background-color:#e8e8e8;font-size:80%;padding:1em 2em;margin:2em 0">Having completely different implementations of the make-requests-and-process-replies code in the Windows DNS server program and the Windows DNS client software may sound unusual, but it is not surprising. DNS servers typically need to handle a much broader set of possible DNS requests and replies than pure-play DNS clients, notably for exchanging data with other DNS servers. </p>
<h2>How it works</h2>
<p>If you&#8217;re interested in the innermost technical details of CVE-2020-1350, the researchers who discovered it have <a href="https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin-exploiting-a-17-year-old-bug-in-windows-dns-servers/" rel="nofollow">dug into it</a> in some detail.</p>
<p>However, unless you already have a basic understanding of the low-level layout of DNS network traffic, as well as some experience in reverse engineering, you might find the deep-dive version rather hard to follow.</p>
<p>So we&#8217;ll try to explain what went wrong here, sticking to plain English.</p>
<p>DNS network traffic follows an old and <a href="https://tools.ietf.org/html/rfc883" rel="nofollow">parsimonious format</a> dating back to the early 1980s, revised in the venerable document known as <a href="https://tools.ietf.org/html/rfc1035" rel="nofollow">RFC 1035: DOMAIN NAMES &#8211; IMPLEMENTATION AND SPECIFICATION</a> from 1987.</p>
<p>Back then, memory space and network bandwidth were in short supply &#8211; modems typically ran at 1200bits/sec or 2400bits/sec, and even a fully-loaded IBM PC-XT had at most 640KB of directly usable system memory.</p>
<p>Data wasn&#8217;t exchanged in expressive, self-documenting formats such as JSON, as it often is today, but instead packed as tightly as possible into small, dense binary gobbets.</p>
<p>Today, you might encode various on/off settings into a comfortable but bulky JSON representation such as <code>{"compress":true, "retry":true, "log":true, "urgent":false}</code>, but in the 1980s you would pack these settings into a single byte, using one bit each.</p>
<p>The recipient would have to know in advance which byte contained these settings, and which bit position in the byte stood for each of them.</p>
<p>Likewise, today, we might send a chunk of data as a named JSON string, and let the recipient decode it, allocate memory as it goes along, and work out the final size of the data for itself, as in the JSON expression <code>{"data":"ROz\u0002X-TT\u0000\u0000"}</code>.</p>
<p>But in DNS replies, every byte mattered &#8211; in fact, DNS was designed with the assumption that almost all common requests and replies would fit into 512 bytes (minus 12 bytes of header data), with a special but slower transmission method defined for longer replies, formatted as two bytes denoting the data length followed by that many bytes of data.</p>
<p>The biggest number you can fit into two bytes, or 16 bits, is 2<sup>16</sup>-1, which is 0xFFFF in hexadecimal or 65,535 in decimal, so DNS replies max out at that size.</p>
<p>There are many sorts of DNS reply, known in the jargon as RRs, short for <em>Resource Records</em>, denoted using 16-bit numbers referred to as TYPEs, each of which is known by a mnemonic name, for example:</p>
<pre style="white-space:pre-wrap;line-height:1.7">
Number      Known as     What it tells you
-------     --------     -----------------------------------------------
Type  1     A            IP address of this domain name
Type  2     NS           The official DNS server for this domain
Type 15     MX           Where to send mail for this domain
Type 16     TXT          Text strings giving special info (e.g. SPF data)
</pre>
<p>Most RR types include numerous data fields, packed together in a binary lump as tightly as possible, and one field type that is common across many RRs is known as a <code>NAME</code>, a text string that is encoded as a single byte denoting its length (thus maxing out at 0xFF or 255 bytes), followed by the <code>NAME</code> data.</p>
<p>You can probably guess where this is going by now.</p>
<h2>What happened?</h2>
<p>When DNS was extended in the 1990s to support digital signatures in order to make it hard for crooks to inject fraudulent requests and replies into the heart of the sytem, a new RR type with the number 24 and the mnemonic code <code>SIG</code> (short for <em>signature</em>) <a href="https://tools.ietf.org/html/rfc2535" rel="nofollow">was defined</a>.</p>
<p>That record type didn&#8217;t last long, soon <a href="https://tools.ietf.org/html/rfc4034" rel="nofollow">being superseded</a> by record type 40, known as <code>RRSIG</code> (the <code>RR-</code> prefix is tautological, givem that it is an RR by definition, but the text string <code>SIG</code> had obviously already been used).</p>
<p><code>RRSIG</code> records have the same format as <code>SIG</code> records, but are subject to different rules about how the data in them gets formatted.</p>
<p>At this point, we can only guess at what happened &#8211; but we suspect that someone at Microsoft copied some or all of the code that was used to process <code>SIG</code> replies, used it to help build the code that would handle the new-fangled <code>RRSIG</code> replies, made numerous changes, bug fixes, improvmements and extensions, as programmers do with good reason&#8230;</p>
<p>&#8230;while the original code to handle <code>SIG</code> replies sat there unloved, untouched and, in fairness, almost totally unusued, given that <code>SIG</code> records probably never turned up in real-world traffic any more.</p>
<h2>Integer overflow &#8211; from years ago</h2>
<p>Anyway, as the Check Point researchers discovered while on a spelunking expedition, the code that handles <code>SIG</code> records seemed to make the following assumptions:</p>
<ul>
<li>The largest amount of data that can possibly appear in a DNS reply is 65,535 bytes.
<li>Therefore the maximum amount of memory that will be needed to store that data when it&#8217;s unravelled is 65,535 bytes.
<li>Therefore an <code>unsigned short int</code> (a 16-bit number) gives enough numeric precision for the length calculations.
</ul>
<p>Unfortunately, <code>SIG</code> records include a <code>NAME</code> field that can be transmitted in compressed form, using DNS&#8217;s rudimentary compression algorithm, so that a <code>NAME</code> string that ultimately requires as much as 255 bytes of storage when extracted may take up as little as two bytes in the DNS reply itself.</p>
<p><code>SIG</code> records also include a field for the digital signature data itself, which can be of arbitrary length, so it&#8217;s easy to construct a booby-trapped reply such that the total amount of data sent in the actual reply is right on the 65,535 byte limit. </p>
<p>But the code used a 16-bit integer value when calculating how much memory it would need after decompression &#8211; so if you imagine the code being confronted with 65,535 bytes of raw data in the response plus (say) another 40 bytes extra denoted by an attacker using a cunningly-crafted compressed <code>NAME</code> field&#8230; </p>
<p>&#8230;it would compute the sum as 65,535+40 but wrap around back to 39, in the same way that when you wind an analog clock forward 3 hours from 11 o&#8217;clock, you wrap around at 12 and end up with 11+3 = 2 o&#8217;clock, not at 11+3 = 14 o&#8217;clock as you might expect on a digital timepiece or a railway timetable.</p>
<p>The DNS server would then incorrectly allocate just 39 bytes of memory for its <code>SIG</code> record, but immediately try to shovel 65,535+40 bytes into the hopelessly undersized memory buffer, thus crashing the DNS server.</p>
<h2>Only one bug?</h2>
<p>Other parts of the Windows DNS server code process similar types of RR data, and you might therefore expect this bug to be repeated elsewhere in the code, notably in the section where newer-style <code>RRSIG</code> records are handled.</p>
<p>But even though the researchers went looking to see if they could find other instances of this problem, or something like it, they came up empty.</p>
<p>Indeed, they reported that some similar parts of the code explicitly checked for an integer overflow, so we&#8217;re therefore willing to guess that the bug survived in the <code>SIG</code> reply handler simply because of code rot.</p>
<p>We suspect that because <code>SIG</code> records never showed up in real-life DNS traffic, the bug was never triggered, so the incorrect code attracted neither interest nor suspicion, languishing there unseen and unpatched.</p>
<p>Until now.</p>
<p>Interestingly, one reason why the <code>RRSIG</code> code might not have inherited this bug, even if it started off as a copy-and-paste of the <code>SIG</code> handler, is that the specification for <code>RRSIG</code> resource records explicitly states that compression of the NAME field is not permitted.</p>
<p>Even if the <code>RRSIG</code> code started life with a possible integer overflow that no one noticed, modifying the code to enforce the new &#8220;no compression allowed&#8221; rule would have sidestepped the bug anyway by making it impossible to create the condition needed to trigger it.</p>
<p><img loading="lazy" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-rules-640.png" alt="" width="640" height="412" class="aligncenter size-full wp-image-518035" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-rules-640.png 640w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-rules-640.png?resize=300,193 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-rules-640.png?resize=100,64 100w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<h2>Is it exploitable?</h2>
<p>So far as know, no one has yet figured out how to exploit this bug beyond merely crashing the Windows DNS server.</p>
<p>Check Point admitted that it wasn&#8217;t able to get further than that, saying:</p>
<blockquote><p>Due to time constraints, we did not continue to pursue the exploitation of the bug  [&#8230;], but we do believe that a determined attacker will be able to exploit it. Successful exploitation of this vulnerability would have a severe impact, as you can often find unpatched Windows Domain environments, especially Domain Controllers. In addition, some Internet Service Providers (ISPs) may even have set up their public DNS servers as WinDNS.</p></blockquote>
<p>In Microsoft&#8217;s words:</p>
<blockquote><p>An attacker who successfully exploited the vulnerability could run arbitrary code in the context of the Local System Account. Windows servers that are configured as DNS servers are at risk from this vulnerability.</p></blockquote>
<p>So, given that Microsoft is calling this a &#8220;wormable vulnerablity&#8221;, we reiterate our earlier warning to <strong>patch now</strong>.</p>
<h2>Just in case&#8230;</h2>
<p>If you can&#8217;t or don&#8217;t want to apply the patch just yet, Microsoft has come up with <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350" rel="nofollow">a workaround to suppress the bug</a>:</p>
<pre>
  In the registry, locate the key:
      HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\DNS\Parameters 
  Find (or create if not present) the DWORD value called:
      TcpReceivePacketSize 
  Set the value data to:
      FF00 (hexadecimal) or 65280 (decimal)

  Then restart the DNS server.
</pre>
<figure id="attachment_518037" aria-describedby="caption-attachment-518037" style="width: 640px" class="wp-caption aligncenter"><img loading="lazy" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-regedit-640.png" alt="" width="640" height="500" class="size-full wp-image-518037" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-regedit-640.png 640w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-regedit-640.png?resize=300,234 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-regedit-640.png?resize=90,70 90w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-518037" class="wp-caption-text">Where to go and what to add in the Windows registry.</figcaption></figure>
<figure id="attachment_518070" aria-describedby="caption-attachment-518070" style="width: 640px" class="wp-caption aligncenter"><img loading="lazy" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-restart-640.png" alt="" width="640" height="424" class="size-full wp-image-518070" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-restart-640.png 640w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-restart-640.png?resize=300,199 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-restart-640.png?resize=100,66 100w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-518070" class="wp-caption-text">Right click on DNS Server in the Services app and choose Restart.</figcaption></figure>
<p>We&#8217;re assuming this workaround protects you because 65,535-65,280 = 255, and 255 is the maximum length that a NAME field in a <code>SIG</code> record is supposed to have, even after decompression.</p>
<p>So if the DNS server rejects all incoming replies bigger than 65,280 bytes, the integer wrap-around condition will never be reached &#8211; there will is always enough space for any compressed <code>NAME</code> data to grow up 255 bytes longer, thus preventing the crash even in the face of a booby-trapped reply.</p>
<p>If you&#8217;re not sure whether Windows DNS Server is running or not on a computer you look after, you can use the command <code>sc query dns</code> at an Administrator command prompt to find out:</p>
<figure id="attachment_518071" aria-describedby="caption-attachment-518071" style="width: 640px" class="wp-caption aligncenter"><img loading="lazy" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-scquery.png" alt="" width="640" height="477" class="size-full wp-image-518071" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-scquery.png 640w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-scquery.png?resize=300,224 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/sigred-scquery.png?resize=94,70 94w" sizes="(max-width: 640px) 100vw, 640px" /><figcaption id="caption-attachment-518071" class="wp-caption-text"><em>Above.</em> Output of <code>sc query</code> if DNS Server is not installed.<br /><em>Below.</em> Output of <code>sc query</code> if DNS Server is running.</figcaption></figure>
<hr style='margin-top:2em'>
			</div> <!-- .entry-content -->
	<ul class="block social follow">
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon twitter"><use xlink:href="#twitter"></use></svg>
			<p>Follow <strong><a href="https://twitter.com/nakedsecurity">@NakedSecurity on Twitter</a></strong> for the latest computer security news.</p>
		</li>
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon instagram"><use xlink:href="#instagram"></use></svg>
			<p>Follow <strong><a href="https://www.instagram.com/nakedsecurity/">@NakedSecurity on Instagram</a></strong> for exclusive pics, gifs, vids and LOLs!</p>
		</li>
	</ul>
</article><!-- #post-## -->

		<div class="free-tools-block">
			<h2 class="block-title">Free tools</h2>

<div class="ns-free-tools">
	<div class="ns-free-tools__item ns-free-tools__item--sophos-home">
		<a class="ns-free-tools__link" href="https://home.sophos.com/en-us.aspx?cmp=701j0000001eLpnAAE">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/sophos-home@2x.png" alt="Sophos Home" class="ns-free-tools__image" width="166" height="100">
			<h4 class="ns-free-tools__title">
				Sophos Home			</h4>
			<div class="ns-free-tools__sub-title">
				Protect personal PCs and Macs			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--hitman-pro">
		<a class="ns-free-tools__link" href="https://www.hitmanpro.com/en-us/hmp.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/hitman-pro@2x.png" alt="Hitman Pro" class="ns-free-tools__image" width="154" height="100">
			<h4 class="ns-free-tools__title">
				Hitman Pro			</h4>
			<div class="ns-free-tools__sub-title">
				Find and remove malware			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--intercept-x">
		<a class="ns-free-tools__link" href="https://www.sophos.com/en-us/products/free-tools/sophos-mobile-security-free-edition.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/mobile-security-android@2x.png" alt="Sophos Intercept X for Mobile" class="ns-free-tools__image" width="96" height="110">
			<h4 class="ns-free-tools__title">
				Intercept X for Mobile			</h4>
			<div class="ns-free-tools__sub-title">
				Protect Android devices			</div>
		</a>
	</div>
</div>
		</div>

			<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2020/07/14/raticate-malware-gang-goes-commercial/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> RATicate malware gang goes commercial</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2020/07/16/twitter-limits-tweeting-as-prominent-accounts-spam-out-cryptocoin-scams/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Twitter limits tweeting as prominent accounts spam out cryptocoin scams</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	
	</main><!-- #main -->

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<section class="comments-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

			
<div id="comments" class="comments-area">

			<h2 class="comments-title">
			26 comments on &ldquo;<span>Patch now! SIGRED &#8211; the wormable hole in your Windows servers</span>&rdquo;		</h2>

		<ol class="comment-list">
					<li id="comment-6191093" class="comment even thread-even depth-1 parent">
			<article id="div-comment-6191093" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/431be81327a0d6bce549209f3545db08?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/431be81327a0d6bce549209f3545db08?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">SusanTechy</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6191093"><time datetime="2020-07-15T21:08:23+01:00">July 15, 2020 at 9:08 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>You &#8220;accidentally&#8221; forgot to tell anyone WHICH version of Windows Server has this problem.</p>
<p>Gee, thanks!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6191093"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6191093={"id":7238218,"unique_id":"wp-comment-6191093","title":"You%20%26quot%3Baccidentally%26quot%3B%20forgot%20to%20tell%20anyone%20WHICH%20version%20of%20Windows%20Server%20has%20this%20problem.Gee%2C%20thanks%21%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6191093","item_id":"_comm_6191093"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6191093#respond' data-commentid="6191093" data-postid="518029" data-belowelement="div-comment-6191093" data-respondelement="respond" data-replyto="Reply to SusanTechy" aria-label='Reply to SusanTechy'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6191096" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2">
			<article id="div-comment-6191096" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6191096"><time datetime="2020-07-15T21:38:23+01:00">July 15, 2020 at 9:38 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I did link twice to Microsoft&#8217;s own CVE-2020-1350 page in the article, and I assumed that the fact that this bug has been around for years implied that this affects &#8220;Windows Server&#8221; in the widest possible sense of that phrase, but I shall add a note to the article to make it clear to click on the Microsoft links to see the official list.</p>
<p>FWIW, the bug exists in pretty much every supported Windows server version that there is, including Server Core installs. So we&#8217;re talking about  2008, 2008R2, 2012, 2012R2, 2016, 2019 and all the recent versions with the new &#8220;Version XXXX&#8221; numbers in YYMM format that are annoyingly confusig because YYYYMM or YYYY.MM would have been way clearer, viz. Version 1903, Version 1909 and Version 2004.</p>
<p>HtH.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6191096"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6191096={"id":7238218,"unique_id":"wp-comment-6191096","title":"I%20did%20link%20twice%20to%20Microsoft%26%23039%3Bs%20own%20CVE-2020-1350%20page%20in%20the%20article%2C%20and%20I%20assumed%20that%20the%20fact%20that%20this%20bug%20has%20been%20around%20for%20years%20implied%20that%20this%20affects%20%26quot%3BWindows%20Server%26quot%3B%20in%20the%20widest%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6191096","item_id":"_comm_6191096"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6191096#respond' data-commentid="6191096" data-postid="518029" data-belowelement="div-comment-6191096" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6191136" class="comment even thread-odd thread-alt depth-1 parent">
			<article id="div-comment-6191136" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/ed3c6be89b9f686acb7c27edfb92d0d1?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ed3c6be89b9f686acb7c27edfb92d0d1?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Steve</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6191136"><time datetime="2020-07-16T00:28:45+01:00">July 16, 2020 at 12:28 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Great article (as usual), very well written.  Thanks!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6191136"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6191136={"id":7238218,"unique_id":"wp-comment-6191136","title":"Great%20article%20%28as%20usual%29%2C%20very%20well%20written.%20%20Thanks%21%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6191136","item_id":"_comm_6191136"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6191136#respond' data-commentid="6191136" data-postid="518029" data-belowelement="div-comment-6191136" data-respondelement="respond" data-replyto="Reply to Steve" aria-label='Reply to Steve'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6191138" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2">
			<article id="div-comment-6191138" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6191138"><time datetime="2020-07-16T00:32:20+01:00">July 16, 2020 at 12:32 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks for your kind words &#8211; appreciate the feedack!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6191138"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6191138={"id":7238218,"unique_id":"wp-comment-6191138","title":"Thanks%20for%20your%20kind%20words%20-%20appreciate%20the%20feedack%21%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6191138","item_id":"_comm_6191138"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6191138#respond' data-commentid="6191138" data-postid="518029" data-belowelement="div-comment-6191138" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6194924" class="comment even thread-even depth-1">
			<article id="div-comment-6194924" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Ron</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6194924"><time datetime="2020-07-16T04:34:54+01:00">July 16, 2020 at 4:34 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks for the great read and content. Always a great source of information!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6194924"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6194924={"id":7238218,"unique_id":"wp-comment-6194924","title":"Thanks%20for%20the%20great%20read%20and%20content.%20Always%20a%20great%20source%20of%20information%21%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6194924","item_id":"_comm_6194924"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6194924#respond' data-commentid="6194924" data-postid="518029" data-belowelement="div-comment-6194924" data-respondelement="respond" data-replyto="Reply to Ron" aria-label='Reply to Ron'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-6194990" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-6194990" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/2b96c5ce8ed8e0f1017211a551370f44?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2b96c5ce8ed8e0f1017211a551370f44?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">richard</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6194990"><time datetime="2020-07-16T08:04:16+01:00">July 16, 2020 at 8:04 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks Paul for such a great article. So Microsoft don&#8217;t have a patch yet? You need to implment a workaround? (July 2020).</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6194990"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6194990={"id":7238218,"unique_id":"wp-comment-6194990","title":"Thanks%20Paul%20for%20such%20a%20great%20article.%20So%20Microsoft%20don%26%23039%3Bt%20have%20a%20patch%20yet%3F%20You%20need%20to%20implment%20a%20workaround%3F%20%28July%202020%29.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6194990","item_id":"_comm_6194990"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6194990#respond' data-commentid="6194990" data-postid="518029" data-belowelement="div-comment-6194990" data-respondelement="respond" data-replyto="Reply to richard" aria-label='Reply to richard'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6195033" class="comment byuser comment-author-pducklin bypostauthor even depth-2">
			<article id="div-comment-6195033" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6195033"><time datetime="2020-07-16T10:33:26+01:00">July 16, 2020 at 10:33 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>No, as the article says, the workaround is only there in case you are the sort of company that uses what are called &#8220;change windows&#8221; &#8211; where you only ever make changes such as patches and reboots only on certain days, e.g. Saturdays,  or not at certain times, e.g. in the month that is at the end of the financial year. I have reworded the last section to make it more obvious that the workaround is not the only solution available.</p>
<p>(The headline &#8220;Patch now!&#8221; is a bit of a giveaway that there is a patch out :&#045;)</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6195033"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6195033={"id":7238218,"unique_id":"wp-comment-6195033","title":"No%2C%20as%20the%20article%20says%2C%20the%20workaround%20is%20only%20there%20in%20case%20you%20are%20the%20sort%20of%20company%20that%20uses%20what%20are%20called%20%26quot%3Bchange%20windows%26quot%3B%20-%20where%20you%20only%20ever%20make%20changes%20such%20as%20patches%20and%20reboots%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6195033","item_id":"_comm_6195033"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6195033#respond' data-commentid="6195033" data-postid="518029" data-belowelement="div-comment-6195033" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6195140" class="comment odd alt thread-even depth-1">
			<article id="div-comment-6195140" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/34d26a32fa61d08ecaa009a645f3107d?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/34d26a32fa61d08ecaa009a645f3107d?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Nurse</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6195140"><time datetime="2020-07-16T18:20:05+01:00">July 16, 2020 at 6:20 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>all you need to pull this off is some JavaScript on a webpage, crazy. I&#8217;ve got my updates out the way!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6195140"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6195140={"id":7238218,"unique_id":"wp-comment-6195140","title":"all%20you%20need%20to%20pull%20this%20off%20is%20some%20JavaScript%20on%20a%20webpage%2C%20crazy.%20I%26%23039%3Bve%20got%20my%20updates%20out%20the%20way%21%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6195140","item_id":"_comm_6195140"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6195140#respond' data-commentid="6195140" data-postid="518029" data-belowelement="div-comment-6195140" data-respondelement="respond" data-replyto="Reply to Paul Nurse" aria-label='Reply to Paul Nurse'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-6195155" class="comment even thread-odd thread-alt depth-1 parent">
			<article id="div-comment-6195155" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/7506b52cffc2028eaff056da4dc8b2ab?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7506b52cffc2028eaff056da4dc8b2ab?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Chad Kelley</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6195155"><time datetime="2020-07-16T19:15:15+01:00">July 16, 2020 at 7:15 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>As I read your article I was trying to determine if public facing Microsoft DNS servers are mainly at risk? Or if even those DNS servers that sit behind firewalls &amp; are used strictly for internal Active Directory name resolution can have the SIG bug exploited using crafted web pages when a Microsoft client PC browses the Internet &amp; the internal DNS servers listen to forward requests out? Initially I was under the impression the answer was &#8220;no&#8221;, but not sure after reading that?</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6195155"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6195155={"id":7238218,"unique_id":"wp-comment-6195155","title":"As%20I%20read%20your%20article%20I%20was%20trying%20to%20determine%20if%20public%20facing%20Microsoft%20DNS%20servers%20are%20mainly%20at%20risk%3F%20Or%20if%20even%20those%20DNS%20servers%20that%20sit%20behind%20firewalls%20%26amp%3B%20are%20used%20strictly%20for%20inte%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6195155","item_id":"_comm_6195155"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6195155#respond' data-commentid="6195155" data-postid="518029" data-belowelement="div-comment-6195155" data-respondelement="respond" data-replyto="Reply to Chad Kelley" aria-label='Reply to Chad Kelley'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6195165" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2 parent">
			<article id="div-comment-6195165" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6195165"><time datetime="2020-07-16T20:12:47+01:00">July 16, 2020 at 8:12 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>The server gets attacked by receiving a DNS reply that is booby-trapped, so that can in theory happen to a server on your LAN (rather than outside or in the DMZ) if it&#8217;s allowed to make requests of its own to external DNS servers rather than going through an intermediate DNS server at your own network edge. In other words, if someone on your LAN can get an unpatched Windows DNS server to look up a domain of their choice, and they control the authoritative name server for that domain, they could stuff a redundant but booby-trapped SIG record into the reply and the poisoned DNS reply packet would be consumed by your server. </p>
<p>If the Windows DNS server itself always uses an upstream server to its external lookups &#8211; a DNS server on your firewall, for example, that does some sort of DNS-based filtering &#8211; and the firewall DNS server doesn&#8217;t blindly proxy the entire DNS reply back, you ought to be OK, assuming that the firewall is Linux or Unix based and therefore itself not vulnerable</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6195165"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6195165={"id":7238218,"unique_id":"wp-comment-6195165","title":"The%20server%20gets%20attacked%20by%20receiving%20a%20DNS%20reply%20that%20is%20booby-trapped%2C%20so%20that%20can%20in%20theory%20happen%20to%20a%20server%20on%20your%20LAN%20%28rather%20than%20outside%20or%20in%20the%20DMZ%29%20if%20it%26%23039%3Bs%20allowed%20to%20make%20requests%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6195165","item_id":"_comm_6195165"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6195165#respond' data-commentid="6195165" data-postid="518029" data-belowelement="div-comment-6195165" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6195181" class="comment even depth-3">
			<article id="div-comment-6195181" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/7506b52cffc2028eaff056da4dc8b2ab?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7506b52cffc2028eaff056da4dc8b2ab?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Chad Kelley</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6195181"><time datetime="2020-07-16T21:30:55+01:00">July 16, 2020 at 9:30 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks Paul for the clarification.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6195181"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6195181={"id":7238218,"unique_id":"wp-comment-6195181","title":"Thanks%20Paul%20for%20the%20clarification.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6195181","item_id":"_comm_6195181"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6195181#respond' data-commentid="6195181" data-postid="518029" data-belowelement="div-comment-6195181" data-respondelement="respond" data-replyto="Reply to Chad Kelley" aria-label='Reply to Chad Kelley'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6195172" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-6195172" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/01eb799c93e3da70a78723dc66a21b25?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/01eb799c93e3da70a78723dc66a21b25?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Josh</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6195172"><time datetime="2020-07-16T21:01:23+01:00">July 16, 2020 at 9:01 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>thanks for the content. as a follow up &#8211; how can you tell if your DNS server&#8217;s been compromised? if compromised, is there a known fix? or will the registry patch fix it?</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6195172"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6195172={"id":7238218,"unique_id":"wp-comment-6195172","title":"thanks%20for%20the%20content.%20as%20a%20follow%20up%20-%20how%20can%20you%20tell%20if%20your%20DNS%20server%26%23039%3Bs%20been%20compromised%3F%20if%20compromised%2C%20is%20there%20a%20known%20fix%3F%20or%20will%20the%20registry%20patch%20fix%20it%3F%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6195172","item_id":"_comm_6195172"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6195172#respond' data-commentid="6195172" data-postid="518029" data-belowelement="div-comment-6195172" data-respondelement="respond" data-replyto="Reply to Josh" aria-label='Reply to Josh'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6195178" class="comment byuser comment-author-pducklin bypostauthor even depth-2 parent">
			<article id="div-comment-6195178" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6195178"><time datetime="2020-07-16T21:16:49+01:00">July 16, 2020 at 9:16 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>That&#8217;s a very broad question: &#8220;How do you know if your server&#8217;s been compromised?&#8221; If you are worried abuse about this particular bug, I think the risk is very small because &#8211; as far as we know &#8211; it was responsibly disclosed, the patch is out, and we have seen no signs of any crooks having yet worked backwards from the patch and the Check Point article to a working exploit. As for &#8220;how you you tell if a computer already has malware on it&#8221;, a good place to start is to scan it with a bang-up-to-date malware scanner; also, check your network, domain and syste, logs for unusual activity such as the creation of new accounts, the installation of unexpected software, the use of unusual or unexpected sysadmin tools, and so forth. (There&#8217;s a link to our various free scanning tools at the bottom of the article. But bear in mind that fully scanning all files on a large server may take a while!)</p>
<p>The registry modification described above won&#8217;t uncompromise a server that has already been hacked (by this or any other trick), and it&#8217;s important not to think of the registry change as &#8220;a patch&#8221; &#8211; it&#8217;s a temporary workaround until you can get the patch installed&#8230;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6195178"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6195178={"id":7238218,"unique_id":"wp-comment-6195178","title":"That%26%23039%3Bs%20a%20very%20broad%20question%3A%20%26quot%3BHow%20do%20you%20know%20if%20your%20server%26%23039%3Bs%20been%20compromised%3F%26quot%3B%20If%20you%20are%20worried%20abuse%20about%20this%20particular%20bug%2C%20I%20think%20the%20risk%20is%20very%20small%20because%20-%20as%20far%20as%20we%20know%20-%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6195178","item_id":"_comm_6195178"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6195178#respond' data-commentid="6195178" data-postid="518029" data-belowelement="div-comment-6195178" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6195184" class="comment odd alt depth-3">
			<article id="div-comment-6195184" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/01eb799c93e3da70a78723dc66a21b25?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/01eb799c93e3da70a78723dc66a21b25?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Josh</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6195184"><time datetime="2020-07-16T21:54:35+01:00">July 16, 2020 at 9:54 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I misspoke regarding the workaround/modification &#8211; calling it a patch. thanks for the correction. The reason i ask is that our DNS was not working this morning for about 4 hours. We have a 2012R2 host server, hosting 2 VM servers. though we&#8217;re now back up running, i couldn&#8217;t ignore the coincidence. I could remote into the office, but users couldn&#8217;t resolve dns going out. Again, it seems resolved, but with this new exploit, I haven&#8217;t been able to find info yet on how to determine if we were affected &#8211; many intrusions are &#8220;findable&#8221; if you know what to look for (registry changes, changes to hosts file, etc) &#8211; thanks again</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6195184"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6195184={"id":7238218,"unique_id":"wp-comment-6195184","title":"I%20misspoke%20regarding%20the%20workaround%2Fmodification%20-%20calling%20it%20a%20patch.%20thanks%20for%20the%20correction.%20The%20reason%20i%20ask%20is%20that%20our%20DNS%20was%20not%20working%20this%20morning%20for%20about%204%20hours.%20We%20have%20a%202012R2%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6195184","item_id":"_comm_6195184"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6195184#respond' data-commentid="6195184" data-postid="518029" data-belowelement="div-comment-6195184" data-respondelement="respond" data-replyto="Reply to Josh" aria-label='Reply to Josh'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6195193" class="comment even thread-odd thread-alt depth-1 parent">
			<article id="div-comment-6195193" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Dee</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6195193"><time datetime="2020-07-16T22:41:12+01:00">July 16, 2020 at 10:41 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>The registry value should be 0xFF00 not FF00. Great article  though.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6195193"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6195193={"id":7238218,"unique_id":"wp-comment-6195193","title":"The%20registry%20value%20should%20be%200xFF00%20not%20FF00.%20Great%20article%20%20though.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6195193","item_id":"_comm_6195193"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6195193#respond' data-commentid="6195193" data-postid="518029" data-belowelement="div-comment-6195193" data-respondelement="respond" data-replyto="Reply to Dee" aria-label='Reply to Dee'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6195224" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2">
			<article id="div-comment-6195224" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6195224"><time datetime="2020-07-17T00:43:27+01:00">July 17, 2020 at 12:43 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Actually, you select the base you want to use with the radio button in the Regedit dialog box shown in the screenshot. I chose <code>(*) Decimal</code> in that image and typed in <code>65280</code>, but if you choose <code>(*) Hexadecimal</code> then you just type in <code>FF00</code>. The dialog already knows to expect a value in hex, so the &#8220;0x&#8221; at the start is not only redundant but also impossible to type in &#8211; the dialog box only accepts the keystrokes <code>0-9</code> in Decimal mode and <code>0-9A-Fa-f</code> in Hexadecimal mode, so pressing <code>x</code> does nothing.</p>
<p>Once you have typed in FF00 then the data will display in the GUI as &#8220;0x0000ff00 (65280)&#8221;, but you really do enter it without the &#8220;x&#8221;. (Truly &#8211; I just fired up my VM and checked it again to make double-sure :&#045;)</p>
<p>Thanks for the fedeback, BTW, it&#8217;s much appreciated.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6195224"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6195224={"id":7238218,"unique_id":"wp-comment-6195224","title":"Actually%2C%20you%20select%20the%20base%20you%20want%20to%20use%20with%20the%20radio%20button%20in%20the%20Regedit%20dialog%20box%20shown%20in%20the%20screenshot.%20I%20chose%20%26lt%3Bcode%26gt%3B%28%2A%29%20Decimal%26lt%3B%2Fcode%26gt%3B%20in%20that%20image%20and%20typed%20in%20%26lt%3Bcode%26gt%3B65280%26lt%3B%2Fcod%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6195224","item_id":"_comm_6195224"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6195224#respond' data-commentid="6195224" data-postid="518029" data-belowelement="div-comment-6195224" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6195443" class="comment even thread-even depth-1 parent">
			<article id="div-comment-6195443" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/a9f491aa19d8ca2c323d1401f0c701a7?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a9f491aa19d8ca2c323d1401f0c701a7?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">barack</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6195443"><time datetime="2020-07-17T18:48:48+01:00">July 17, 2020 at 6:48 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>hey Paul, what if the server is not running windows DNS Server service? does this vulnerability affect it in any way?</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6195443"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6195443={"id":7238218,"unique_id":"wp-comment-6195443","title":"hey%20Paul%2C%20what%20if%20the%20server%20is%20not%20running%20windows%20DNS%20Server%20service%3F%20does%20this%20vulnerability%20affect%20it%20in%20any%20way%3F%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6195443","item_id":"_comm_6195443"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6195443#respond' data-commentid="6195443" data-postid="518029" data-belowelement="div-comment-6195443" data-respondelement="respond" data-replyto="Reply to barack" aria-label='Reply to barack'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6195451" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2 parent">
			<article id="div-comment-6195451" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6195451"><time datetime="2020-07-17T19:30:18+01:00">July 17, 2020 at 7:30 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>This vulnerability depends on the Windows DNS Server running and listening on TCP port 53 (the bug can&#8217;t be triggered by UDP-based DNS traffic).</p>
<p>If DNS Sever isn&#8217;t installed, you aren&#8217;t at risk and there is nothing to patch. If it is installed but the service is not running, you aren&#8217;t at risk but you should make sure you have the patch anyway&#8230; </p>
<p>&#8230;just in case someone turns it on in the future.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6195451"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6195451={"id":7238218,"unique_id":"wp-comment-6195451","title":"This%20vulnerability%20depends%20on%20the%20Windows%20DNS%20Server%20running%20and%20listening%20on%20TCP%20port%2053%20%28the%20bug%20can%26%23039%3Bt%20be%20triggered%20by%20UDP-based%20DNS%20traffic%29.If%20DNS%20Sever%20isn%26%23039%3Bt%20installed%2C%20you%20aren%26%23039%3Bt%20at%20risk%20an%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6195451","item_id":"_comm_6195451"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6195451#respond' data-commentid="6195451" data-postid="518029" data-belowelement="div-comment-6195451" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6195551" class="comment even depth-3 parent">
			<article id="div-comment-6195551" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/346a3cea20e72c4246d9993c07a65a56?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/346a3cea20e72c4246d9993c07a65a56?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">barack</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6195551"><time datetime="2020-07-18T06:20:00+01:00">July 18, 2020 at 6:20 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>thank you , you and this article are the best on the net, and i read them all really (2 pages of google) most are just copy paste, other just click baits.<br />
Keep it up, rare to find a real author that really knows what he s writing about nowadays.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6195551"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6195551={"id":7238218,"unique_id":"wp-comment-6195551","title":"thank%20you%20%2C%20you%20and%20this%20article%20are%20the%20best%20on%20the%20net%2C%20and%20i%20read%20them%20all%20really%20%282%20pages%20of%20google%29%20most%20are%20just%20copy%20paste%2C%20other%20just%20click%20baits.%20Keep%20it%20up%2C%20rare%20to%20find%20a%20real%20author%20t%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6195551","item_id":"_comm_6195551"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6195551#respond' data-commentid="6195551" data-postid="518029" data-belowelement="div-comment-6195551" data-respondelement="respond" data-replyto="Reply to barack" aria-label='Reply to barack'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6195630" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-4">
			<article id="div-comment-6195630" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6195630"><time datetime="2020-07-18T12:47:45+01:00">July 18, 2020 at 12:47 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks, I appreciate your kind words!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6195630"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6195630={"id":7238218,"unique_id":"wp-comment-6195630","title":"Thanks%2C%20I%20appreciate%20your%20kind%20words%21%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6195630","item_id":"_comm_6195630"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6195630#respond' data-commentid="6195630" data-postid="518029" data-belowelement="div-comment-6195630" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6195989" class="comment even thread-odd thread-alt depth-1 parent">
			<article id="div-comment-6195989" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/4a2cb15e9445c102c0946284518ecbb2?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4a2cb15e9445c102c0946284518ecbb2?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Brian Hampson</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6195989"><time datetime="2020-07-19T18:34:12+01:00">July 19, 2020 at 6:34 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Just a quick note &#8211; the 2008R2 patch doesn&#8217;t apply successfully (at least for non-ESU people) so most of us that are running 2008R2 servers are S.O.L. on the patch.  Regedit, it is&#8230;.  🙁</p>
<p>https://www.reddit.com/r/sysadmin/comments/hru0ra/anyone_having_issue_installing_the_patch_for_the/</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6195989"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6195989={"id":7238218,"unique_id":"wp-comment-6195989","title":"Just%20a%20quick%20note%20-%20the%202008R2%20patch%20doesn%26%23039%3Bt%20apply%20successfully%20%28at%20least%20for%20non-ESU%20people%29%20so%20most%20of%20us%20that%20are%20running%202008R2%20servers%20are%20S.O.L.%20on%20the%20patch.%20%20Regedit%2C%20it%20is....%20%20%3A%28https%3A%2F%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6195989","item_id":"_comm_6195989"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6195989#respond' data-commentid="6195989" data-postid="518029" data-belowelement="div-comment-6195989" data-respondelement="respond" data-replyto="Reply to Brian Hampson" aria-label='Reply to Brian Hampson'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6199773" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2 parent">
			<article id="div-comment-6199773" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6199773"><time datetime="2020-07-20T00:52:53+01:00">July 20, 2020 at 12:52 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>AFAIK, support and updates  for Windows Server 2008R2 ended more than six months ago. As you say, if you don&#8217;t have an exended support licence then there isn&#8217;t an update for you (indeed, you probably haven&#8217;t had any other updates either, from February 2020 Patch Tuesday onwards).</p>
<p>I guess you will have to: [a] pay for extended support, [b] upgrade to a newer version of Windows Server, [c] switch away from Windows (there are several free options available), or [d] use the Regedit workaround and leave it in place permanently.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6199773"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6199773={"id":7238218,"unique_id":"wp-comment-6199773","title":"AFAIK%2C%20support%20and%20updates%20%20for%20Windows%20Server%202008R2%20ended%20more%20than%20six%20months%20ago.%20As%20you%20say%2C%20if%20you%20don%26%23039%3Bt%20have%20an%20exended%20support%20licence%20then%20there%20isn%26%23039%3Bt%20an%20update%20for%20you%20%28indeed%2C%20you%20prob%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6199773","item_id":"_comm_6199773"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6199773#respond' data-commentid="6199773" data-postid="518029" data-belowelement="div-comment-6199773" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6199948" class="comment even depth-3 parent">
			<article id="div-comment-6199948" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/4a2cb15e9445c102c0946284518ecbb2?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4a2cb15e9445c102c0946284518ecbb2?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Brian Hampson</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6199948"><time datetime="2020-07-20T13:49:31+01:00">July 20, 2020 at 1:49 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Well, this critical flaw has been around for 17 years and as they put it, IS HIGHLY WORMABLE.  It&#8217;s not like they didn&#8217;t set a precedent by putting out a patch for Eternal_Blue for XP after _IT_ was dropped from support&#8230;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6199948"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6199948={"id":7238218,"unique_id":"wp-comment-6199948","title":"Well%2C%20this%20critical%20flaw%20has%20been%20around%20for%2017%20years%20and%20as%20they%20put%20it%2C%20IS%20HIGHLY%20WORMABLE.%20%20It%26%23039%3Bs%20not%20like%20they%20didn%26%23039%3Bt%20set%20a%20precedent%20by%20putting%20out%20a%20patch%20for%20Eternal_Blue%20for%20XP%20after%20_IT_%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6199948","item_id":"_comm_6199948"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6199948#respond' data-commentid="6199948" data-postid="518029" data-belowelement="div-comment-6199948" data-respondelement="respond" data-replyto="Reply to Brian Hampson" aria-label='Reply to Brian Hampson'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6200006" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-4">
			<article id="div-comment-6200006" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6200006"><time datetime="2020-07-20T18:27:47+01:00">July 20, 2020 at 6:27 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>To be fair, Microsoft didn&#8217;t shout that it was HIGHLY WORMABLE &#8211; they said, a bit more calmly, that they considered it a wormable vulnerability. (ETERNALBLUE was already exploitable; the exploit code was known to be in circulation; and the exploit could be applied against pretty much and Windows computer, not only against Windows servers running DNS.) Given that this [a] is not yet a hackable hole [b] is only to be found on a subset of Windows server, already a small subset of all Windows computers out there [c] can be remediated by an easily-applied workarond supplied by Microsoft&#8230;</p>
<p>&#8230;well, I get your point, but suggesting that Microsoft is duty bound to patch out-of-support systems for free just because it has done so once or twice before in tricky cases is IMO bit unfair.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6200006"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6200006={"id":7238218,"unique_id":"wp-comment-6200006","title":"To%20be%20fair%2C%20Microsoft%20didn%26%23039%3Bt%20shout%20that%20it%20was%20HIGHLY%20WORMABLE%20-%20they%20said%2C%20a%20bit%20more%20calmly%2C%20that%20they%20considered%20it%20a%20wormable%20vulnerability.%20%28ETERNALBLUE%20was%20already%20exploitable%3B%20the%20exploit%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6200006","item_id":"_comm_6200006"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6200006#respond' data-commentid="6200006" data-postid="518029" data-belowelement="div-comment-6200006" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6204265" class="comment even thread-even depth-1 parent">
			<article id="div-comment-6204265" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/a65ba69e7e8ce5f448d38e4d6bba2f22?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a65ba69e7e8ce5f448d38e4d6bba2f22?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">A Admin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6204265"><time datetime="2020-07-22T10:24:12+01:00">July 22, 2020 at 10:24 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanx Paul, great Article.</p>
<p>Short Question: If my Windows servers use a Sophos UTM 9.x as a DNS forwarder, will they protect me because they are running on linux, or will the ips protection find the possible DNS Attack ?</p>
<p>Best regards!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6204265"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6204265={"id":7238218,"unique_id":"wp-comment-6204265","title":"Thanx%20Paul%2C%20great%20Article.Short%20Question%3A%20If%20my%20Windows%20servers%20use%20a%20Sophos%20UTM%209.x%20as%20a%20DNS%20forwarder%2C%20will%20they%20protect%20me%20because%20they%20are%20running%20on%20linux%2C%20or%20will%20the%20ips%20protection%20find%20th%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6204265","item_id":"_comm_6204265"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6204265#respond' data-commentid="6204265" data-postid="518029" data-belowelement="div-comment-6204265" data-respondelement="respond" data-replyto="Reply to A Admin" aria-label='Reply to A Admin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6207569" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2">
			<article id="div-comment-6207569" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#comment-6207569"><time datetime="2020-07-22T21:14:42+01:00">July 22, 2020 at 9:14 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>You will need to confirm with Support, but I think that, if your Windows servers are set up so they only ever make outgoing DNS requests to the UTM, and receive replies from the UTM, then the UTM&#8217;s replies &#8211; which are replies to replies &#8211; should be safe, while any booby-trapped replies sent to the UTM will fail because it&#8217;s not running Windows DNS Server.</p>
<p>We also have some IPS rules that can spot booby-trapped replies anyway (see the SophosLabs article for details), so I would like to think that the UTM would simply eat a dodgy DNS packet and not consider it any further&#8230;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6207569"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6207569={"id":7238218,"unique_id":"wp-comment-6207569","title":"You%20will%20need%20to%20confirm%20with%20Support%2C%20but%20I%20think%20that%2C%20if%20your%20Windows%20servers%20are%20set%20up%20so%20they%20only%20ever%20make%20outgoing%20DNS%20requests%20to%20the%20UTM%2C%20and%20receive%20replies%20from%20the%20UTM%2C%20then%20the%20UTM%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2020\/07\/15\/patch-now-sigred-the-wormable-hole-in-your-windows-servers\/#comment-6207569","item_id":"_comm_6207569"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/?replytocom=6207569#respond' data-commentid="6207569" data-postid="518029" data-belowelement="div-comment-6207569" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">What do you think? <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2020/07/15/patch-now-sigred-the-wormable-hole-in-your-windows-servers/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://nakedsecurity.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='518029' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="e53f6b416e" /></p><input type="hidden" id="ak_js" name="ak_js" value="29"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->
		<div class="comments-widget-area">
					</div>
	
	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	

	<section class="recommended-panel">
	<div class="container">
	<div class="panel-content ">

		<h3 class="block-title">Recommended reads</h3>
	<div class="blocks">
		<article id="post-545283" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/02/15/egregor-ransomware-criminals-allegedly-busted-in-ukraine/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/02/egreg-1200.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Feb</span><span class="day">15</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">0</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/02/15/egregor-ransomware-criminals-allegedly-busted-in-ukraine/" rel="bookmark">Egregor ransomware criminals allegedly busted in Ukraine</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-561067" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/03/17/serious-security-the-linux-kernel-bugs-that-surfaced-after-15-years/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/3lb.001.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Mar</span><span class="day">17</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">5</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/03/17/serious-security-the-linux-kernel-bugs-that-surfaced-after-15-years/" rel="bookmark">Serious Security: The Linux kernel bugs that surfaced after 15 years</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-544993" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/02/03/what-should-you-say-if-you-have-a-data-breach-catch-up-with-jason-nurse-at-sophos-evolve/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/02/jason-1200.jpg?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Feb</span><span class="day">03</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Sally Adam	
	</div>
			<div class="comment-box">
				<span class="count">2</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/02/03/what-should-you-say-if-you-have-a-data-breach-catch-up-with-jason-nurse-at-sophos-evolve/" rel="bookmark">What should you say if you have a data breach? Catch up with Jason Nurse at Sophos Evolve</a></h3>	</div>
</article> <!-- .card-article -->
	</div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="footer-container">
			<a href="#" class="js-collapse-footer"><svg style="height: 20px" viewBox="0 0 132 24" class="block icon sophos"><use xlink:href="#sophos"></use></svg></a>
			<div id="collapseFooter" class="blocks">
				<div class="sophos block">
					<ul id="menu-footer-primary" class="primary menu"><li id="menu-item-306737" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306737"><a href="https://nakedsecurity.sophos.com/about/">About Naked Security</a></li>
<li id="menu-item-306754" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306754"><a href="https://www.sophos.com/en-us/company.aspx">About Sophos</a></li>
<li id="menu-item-306747" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306747"><a href="https://nakedsecurity.sophos.com/send-us-a-tip/">Send us a tip</a></li>
<li id="menu-item-323171" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323171"><a href="/cookies-and-scripts/">Cookies</a></li>
<li id="menu-item-323170" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323170"><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
<li id="menu-item-323169" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323169"><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
</ul>				</div>
										<div class="news block">
							<ul id="menu-products-column-one" class="small menu"><li id="menu-item-306998" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306998"><a href="https://www.sophos.com/en-us/products/intercept-x.aspx">Intercept X</a></li>
<li id="menu-item-440801" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440801"><a href="https://www.sophos.com/en-us/products/server-security.aspx">Intercept X for Server</a></li>
<li id="menu-item-440802" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440802"><a href="https://www.sophos.com/en-us/products/mobile-control.aspx">Intercept X for Mobile</a></li>
</ul>						</div>
											<div class="products block">
							<ul id="menu-products-column-two" class="small menu"><li id="menu-item-440803" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440803"><a href="https://www.sophos.com/en-us/products/next-gen-firewall.aspx">XG Firewall</a></li>
<li id="menu-item-440805" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440805"><a href="https://www.sophos.com/en-us/products/sophos-email.aspx">Sophos Email</a></li>
<li id="menu-item-440804" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440804"><a href="https://www.sophos.com/en-us/products/secure-wifi.aspx">Sophos Wireless</a></li>
</ul>						</div>
											<div class="threats block">
							<ul id="menu-server-protection" class="small menu"><li id="menu-item-440806" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440806"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx">Managed Threat Response</a></li>
<li id="menu-item-448404" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-448404"><a href="https://www.sophos.com/en-us/products/cloud-optix.aspx">Cloud Optix</a></li>
<li id="menu-item-440807" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440807"><a href="https://www.sophos.com/en-us/products/phish-threat.aspx">Phish Threat</a></li>
</ul>						</div>
								</div>
			<ul class="block social footer">
				<li class="twitter"><a rel="nofollow" href="https://twitter.com/NakedSecurity" title="Follow our team of security experts on Twitter"><svg style="height: 14px" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
				<li class="facebook"><a rel="nofollow" href="https://www.facebook.com/SophosSecurity" title="Join over 250,000 people in our Facebook community"><svg style="height: 14px" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
				<li class="instagram"><a rel="nofollow" href="https://www.instagram.com/nakedsecurity/" title="Follow Naked Security on Instagram"><svg style="height: 14px" viewBox="0 0 100 100" class="icon instagram"><use xlink:href="#instagram"></use></svg></a></li>
				<li class="linkedin"><a rel="nofollow" href="https://www.linkedin.com/company/5053/" title="Join the naked security discussion group on LinkedIn"><svg style="height: 14px" viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
				<li class="rss"><a rel="nofollow" href="/feed" title="Subscribe to our RSS feed"><svg style="height: 14px" viewBox="0 0 100 100" class="icon rss"><use xlink:href="#rss"></use></svg></a></li>
			</ul>

							<div class="vip-powered-wpcom">
					<span class="copyright">© 1997 - 2021 Sophos Ltd.</span>
					All rights reserved.
					Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=nakedsecurity.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>				</div>
					</div>
		<script type="text/javascript">
			window.cookieconsent_options = {
				"message":"This site uses cookies. By continuing to browse the site you are agreeing to our use of cookies.",
				"dismiss":"Got it!",
				"learnMore":"Learn More",
				"link":"/cookies-and-scripts",
				"theme":"https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/css/sophos.css"};
		</script>
	</footer><!-- #colophon -->
</div><!-- #page -->
<div id="survey-wrapper" class="mfp-hide"><div class="pd-embed" id="pd_1499706777" data-settings=""></div></div>
<script id='child-js-plugins-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"0","nextLink":""};
</script>
<script id='child-js-core-js-extra'>
var Sophos = {"ajaxurl":"https:\/\/nakedsecurity.sophos.com\/wp-admin\/admin-ajax.php","nonce":"64f6810f0c"};
</script>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJyNjkEKwjAQRS9kOo2YggvxKGLT0SZmJiGTULx9Q7HgwoXL+f89/sCSlI1ckAuUGQkFJKY5CuMi6thrA14ghfp0LJ2XA/wl2Jhxpx3bUKfGbTlRM1XGFN4dOf4FtRNpxOm73yepqs8zcH85ISxway48YqbGXumiB21OQ2/02a8RfU9z'></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161173',post:'518029',tz:'0',srv:'nakedsecurity.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161173', '518029' ]);
</script>
</body>
</html>
