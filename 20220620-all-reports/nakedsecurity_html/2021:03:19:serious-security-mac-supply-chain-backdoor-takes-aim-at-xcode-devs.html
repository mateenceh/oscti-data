<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="RHQeasQqjasbRt5asY6atZYbs5tr10gFBevDt2HRhW0" />
<link rel="pingback" href="https://nakedsecurity.sophos.com/xmlrpc.php">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5VK6LTK');</script>
<!-- End Google Tag Manager -->

<meta name="description" content="Just one tiny line of script in your Xcode project - and you&#039;ve been pwned!" />
<meta name="keywords" content="apple, malware, os x, ios, mac, macos, malware, reverse shell, xcode, xcodeghost, xcodespy" />
<title>Serious Security: Mac &#8220;XcodeSpy&#8221; backdoor takes aim at Xcode devs &#8211; Naked Security</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="I9dHFo-YhnK2MfAHn-20V4GnWrOttVUYyISGamyU41M" />
<meta name="msvalidate.01" content="7D8D1FA2892142B1543D2CBCD07FB88F" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Feed" href="https://nakedsecurity.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Comments Feed" href="https://nakedsecurity.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Serious Security: Mac &#8220;XcodeSpy&#8221; backdoor takes aim at Xcode devs Comments Feed" href="https://nakedsecurity.sophos.com/2021/03/19/serious-security-mac-supply-chain-backdoor-takes-aim-at-xcode-devs/feed/" />
<link rel='stylesheet' id='all-css-0' href='https://nakedsecurity.sophos.com/_static/??-eJyVz00KwjAQhuELmUwqttCFeJY0GUw0f2QmlN6+KXbnRpcD7wPfwFqETyY0iwSGCKwnhiVk8xbBL1XXDYi3gDL6JHtwgS5MToyJgR3G7igXlynhSuKqhvEE/8QiaEbiX80xVFvJrqJm4VqPq9SxfPnYRAnt6RPBC7no/tUsP/68D/KI92Eaxtuk1Kx2dxVjDA==' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZoamxkaGpqXEWAK9AIhg='></script>
<link rel="https://api.w.org/" href="https://nakedsecurity.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://nakedsecurity.sophos.com/wp-json/wp/v2/posts/563319" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://nakedsecurity.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://nakedsecurity.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7" />
<link rel="canonical" href="https://nakedsecurity.sophos.com/2021/03/19/serious-security-mac-supply-chain-backdoor-takes-aim-at-xcode-devs/" />
<link rel='shortlink' href='https://nakedsecurity.sophos.com/?p=563319' />
<link rel="alternate" type="application/json+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2021%2F03%2F19%2Fserious-security-mac-supply-chain-backdoor-takes-aim-at-xcode-devs%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2021%2F03%2F19%2Fserious-security-mac-supply-chain-backdoor-takes-aim-at-xcode-devs%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://nakedsecurity.sophos.com/2021/03/19/serious-security-mac-supply-chain-backdoor-takes-aim-at-xcode-devs/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Serious Security: Mac &#8220;XcodeSpy&#8221; backdoor takes aim at Xcode devs" />
<meta property="og:url" content="https://nakedsecurity.sophos.com/2021/03/19/serious-security-mac-supply-chain-backdoor-takes-aim-at-xcode-devs/" />
<meta property="og:description" content="Just one tiny line of script in your Xcode project &#8211; and you&#8217;ve been pwned!" />
<meta property="article:published_time" content="2021-03-19T19:16:06+00:00" />
<meta property="article:modified_time" content="2021-03-22T16:17:02+00:00" />
<meta property="og:site_name" content="Naked Security" />
<meta property="og:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-xcode-1200.jpg?w=775" />
<meta property="og:image:secure_url" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-xcode-1200.jpg?w=775" />
<meta property="og:image:width" content="775" />
<meta property="og:image:height" content="405" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:creator" content="@NakedSecurity" />
<meta name="twitter:site" content="@NakedSecurity" />
<meta name="twitter:text:title" content="Serious Security: Mac &#8220;XcodeSpy&#8221; backdoor takes aim at Xcode devs" />
<meta name="twitter:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-xcode-1200.jpg?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=270" />
</head>
<body class="post-template-default single single-post postid-563319 single-format-standard" >
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VK6LTK"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div style="display: none">
<svg>
	<symbol id="sophos" viewBox="0 0 132 24">
		<path d="m111.82 22.176h11.64c3.267 0 4.65-0.2 5.74-0.896 1.715-1.063 2.804-3.26 2.804-5.62 0-1.928-0.658-3.89-1.647-4.888-1.288-1.33-3.035-1.828-6.271-1.828h-3.527c-1.586 0-2.754-0.067-3.412-0.365-0.794-0.367-1.256-1.165-1.256-2.161 0-1.165 0.56-2.03 1.486-2.264 0.692-0.163 1.498-0.163 3.574-0.198h10.419v-3.956h-11.473c-2.574 0-3.727 0.099-4.718 0.466-2.279 0.796-3.828 3.257-3.828 6.083 0 1.93 0.76 3.727 2.079 4.89 1.155 0.996 2.872 1.462 5.51 1.462h4.697c1.057 0 1.915 0.132 2.376 0.398 0.893 0.433 1.418 1.328 1.418 2.36 0 0.864-0.395 1.597-1.087 2.027-0.561 0.369-1.517 0.534-3.268 0.534h-11.256zm-111.35 0h11.64c3.267 0 4.652-0.2 5.741-0.896 1.714-1.063 2.803-3.26 2.803-5.62 0-1.928-0.66-3.89-1.65-4.888-1.285-1.33-3.034-1.828-6.27-1.828h-3.527c-1.584 0-2.751-0.067-3.41-0.365-0.792-0.367-1.253-1.165-1.253-2.161 0-1.165 0.56-2.03 1.484-2.264 0.693-0.163 1.496-0.163 3.574-0.198h10.42v-3.956h-11.477c-2.573 0-3.727 0.099-4.715 0.466-2.278 0.796-3.83 3.257-3.83 6.083 0 1.93 0.762 3.727 2.08 4.89 1.155 0.996 2.871 1.462 5.51 1.462h4.696c1.057 0 1.913 0.132 2.377 0.398 0.888 0.433 1.416 1.328 1.416 2.36 0 0.864-0.394 1.597-1.089 2.027-0.558 0.369-1.517 0.534-3.264 0.534h-11.256v3.956zm94.05-16.18c-0.68 1.076-1.003 2.803-1.003 5.122 0 5.088 1.747 7.405 5.63 7.405 3.822 0 5.568-2.317 5.568-7.34 0-5.092-1.715-7.373-5.568-7.373-2.102 0-3.754 0.784-4.627 2.186zm13.174-2.511c1.329 1.761 2.072 4.63 2.072 7.992 0 3.816-1.197 6.948-3.334 8.677-1.619 1.304-4.078 2.022-6.995 2.022-4.142 0-7.41-1.372-9.092-3.817-1.263-1.793-1.88-4.176-1.88-7.08 0-4.172 1.133-7.339 3.27-9.035 1.682-1.37 4.339-2.122 7.383-2.122 3.85 0 6.925 1.209 8.576 3.363zm-22.018-3.068h-4.596v8.908h-8.319v-8.908h-4.597v21.759h4.597v-8.97h8.318v8.97h4.596v-21.759zm-28.61 10.277c1.23 0 1.941-0.163 2.427-0.62 0.581-0.49 0.938-1.533 0.938-2.74 0-1.436-0.58-2.478-1.584-2.838-0.356-0.13-0.94-0.197-1.684-0.197h-6.344v6.395zm-6.247 11.481h-4.598v-21.758h10.78c3.786 0 5.114 0.39 6.538 1.991 1.264 1.37 1.942 3.163 1.942 5.088 0 2.284-0.904 4.404-2.394 5.676-1.262 1.077-2.43 1.402-4.888 1.402h-7.38zm-22.589-16.179c-0.682 1.076-1.004 2.803-1.004 5.122 0 5.088 1.748 7.405 5.634 7.405 3.818 0 5.568-2.317 5.568-7.34 0-5.092-1.716-7.373-5.568-7.373-2.106 0-3.757 0.784-4.63 2.186zm13.174-2.511c1.328 1.761 2.073 4.63 2.073 7.992 0 3.816-1.2 6.948-3.335 8.677-1.618 1.304-4.079 2.022-6.993 2.022-4.144 0-7.413-1.372-9.096-3.817-1.264-1.793-1.878-4.176-1.878-7.08 0-4.172 1.133-7.339 3.272-9.035 1.681-1.37 4.337-2.122 7.38-2.122 3.851 0 6.93 1.209 8.578 3.363z"></path>
	</symbol>
	<symbol id="twitter" viewBox="0 0 24 24">
 		<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path>
 	</symbol>
	<symbol id="facebook" viewBox="0 0 24 24">
 		<path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path>
 	</symbol>
	<symbol id="instagram" viewBox="0 0 24 24">
		<path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path>
	</symbol>
	<symbol id="linkedin" viewBox="0 0 24 24">
		<path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"></path>
	</symbol>
	<symbol id="rss" viewBox="0 0 24 24">
		<path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"></path>
	</symbol>
	<symbol id="reddit" viewBox="0 0 24 24">
		<path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"></path>
	</symbol>
</svg>
</div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header variation variation-3" role="banner">
		<div class="header-container">
			<div class="site-branding">
				<div class="site-title">
					<a title="Naked Security" href="https://nakedsecurity.sophos.com/" rel="home"><img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/naked-security-logo-white@2x.png"></a>
					by
					<a title="sophos.com" href="https://www.sophos.com"><svg viewBox="0 0 132 24" class="icon sophos"><use xlink:href="#sophos"></use></svg></a>
				</div>
			</div><!-- .site-branding -->
			<nav id="site-navigation" class="main-navigation" role="navigation">
				<div class="container">
					<ul id="menu-variation-two" class="exit-links menu"><li id="menu-item-436509" class="products menu-item menu-item-type-custom menu-item-object-custom menu-item-436509"><a href="#">Products</a></li>
<li id="menu-item-436515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436515"><a href="https://www.sophos.com/en-us/products/free-tools.aspx">Free Tools</a></li>
<li id="menu-item-436531" class="search-toggle menu-item menu-item-type-custom menu-item-object-custom menu-item-436531"><a href="#">Search</a></li>
<li id="menu-item-436532" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436532"><a href="https://home.sophos.com/en-us.aspx">Free Sophos Home</a></li>
</ul>				</div>
			</nav><!-- #site-navigation -->
			<div class="site-search-block">
	<form target="_top" role="search" class="search-form" method="get" action="https://nakedsecurity.sophos.com/">
        <fieldset>
            <div class="field">
				<input type="search" value="" name="s" class="search-field" placeholder="Search naked security...">
            </div>
            <div class="submit">
				<button type="submit" class="search-submit button">Go</button>
            </div>
        </fieldset>
    </form>
</div>
		</div><!-- .container -->
	</header>

	<div class="responsive-flyout-panel small-12 column active" style="opacity: 1; display: none;">
		<div class="modal-filler"></div>
	    <div class="productNavBox">
	        <div class="productNavContainer">
	            <div class="row prodRow">
	                <div class="prodListBox column large-9">
	                    <div class="row margin-0 highlightProduct">
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/next-gen-firewall.aspx"><img src="https://www.sophos.com/medialibrary/2F4785DE8C3F43ECBD699A18F332FEEB.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">XG Firewall</div>
	                                	<div class="menu-section-subtitle">Next-Gen Firewall</div>
									</div>
	                            </a>
	                        </div>
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/intercept-x.aspx"><img src="https://www.sophos.com/medialibrary/27111765D65A45D49A232925D2CE428B.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">Intercept X</div>
	                                	<div class="menu-section-subtitle">Next-Gen Endpoint</div>
									</div>
	                            </a>
	                        </div>
	                    </div>
	                    <div class="productList">
	                        <ul>
								<li>
									<a href="https://www.sophos.com/en-us/products/cloud-optix.aspx"><img src="https://www.sophos.com/medialibrary/SophosNext/Images/Products/Icons/sophos-cloud-optix-icon.svg">Sophos Cloud Optix</a>
								</li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-central.aspx"><img src="https://www.sophos.com/medialibrary/08EA66123F1B4DDE8FE5C9B578A7FAA7.ashx">Sophos Central</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/mobile-control.aspx"><img src="https://www.sophos.com/medialibrary/678FE994855047739F50D6C411184FA6.ashx">Sophos Mobile</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/server-security.aspx"><img src="https://www.sophos.com/medialibrary/01B80E7D7CD54EF8AC2E51C9C6EC0236.ashx">Intercept X for Server</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-wifi.aspx"><img src="https://www.sophos.com/medialibrary/BEBD9C41BB4E480498514B29B92A145A.ashx">Secure Wi-Fi</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/phish-threat.aspx"><img src="https://www.sophos.com/medialibrary/DC9D1A7BA3964B0C9DAF1F1E68806B5A.ashx">Phish Threat</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/safeguard-encryption.aspx"><img src="https://www.sophos.com/medialibrary/8F51F06B62814B108D3B2763FF018E37.ashx">SafeGuard Encryption</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-email.aspx"><img src="https://www.sophos.com/medialibrary/597ADA0AF01A4A12B2B27239D0F9992C.ashx">Secure Email</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/unified-threat-management.aspx"><img src="https://www.sophos.com/medialibrary/8CB72BF5E1AD41F7894CE5E42101B0F3.ashx">SG UTM</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-web-gateway.aspx"><img src="https://www.sophos.com/medialibrary/C586E372694547A1B207A61D87246BA7.ashx">Secure Web Gateway</a>
	                            </li>
	                        </ul>
	                    </div>
	                </div>
	                <div class="homeUserBox column large-3">
						<img src="https://www.sophos.com/medialibrary/3376DF5742A64AEE93FDB9DCA7291239.ashx">
						<div class="menu-section-title">For Home Users</div>
	                    <p>Sophos Home protects every Mac and PC in your home </p><a href="https://home.sophos.com/" target="_blank" class="greenSmallMenuBtn">Learn More</a>
					</div>
	            </div>
	            <div class="row blueRow">
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-tools.aspx"><img width="19" src="https://www.sophos.com/medialibrary/A1FF440D2BB84511B8C94D771D44E207.ashx">Free Security Tools</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-trials.aspx"><img width="20" src="https://www.sophos.com/medialibrary/FCD3410ED2C347808D9DB8AC12C62DBD.ashx">Free Trials</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/demos.aspx"><img width="18" src="https://www.sophos.com/medialibrary/50985180E5F54C94917A2A6508E24287.ashx">Product Demos</a>
	                </div>
	                <!-- <div class="column large-3 medium-6">
	                    <a href="javascript:fairfax.openLiveChatFromFlyoutLink();" class="flyout-live-chat-link"><img width="20" src="https://www.sophos.com/medialibrary/E24C5050837145F6A5C592E299BA2A0D.ashx">Live Sales Chat</a>
	                </div> -->
	            </div>
	        </div>
	    </div>
	</div>
	<script>

	jQuery(document).ready( function () {
		var productButton   = jQuery('nav .menu-item.products');
		var modalBackground = jQuery('.modal-filler');
		var flyoutMenu		= jQuery('.responsive-flyout-panel');
		var Sophos			= Sophos || {};

		Sophos.MenuTest = {};

		Sophos.MenuTest.open = function () {
				productButton.addClass('open');
				flyoutMenu.show();
				modalBackground.show();
		};

		Sophos.MenuTest.close = function () {
			productButton.removeClass('open');
			flyoutMenu.hide();
			modalBackground.hide();
		};

		Sophos.MenuTest.toggle = function () {
			if ( productButton.hasClass('open') ) {
				Sophos.MenuTest.close();
			} else {
				Sophos.MenuTest.open();
			}
		};

		productButton.click( Sophos.MenuTest.toggle );
		modalBackground.click( Sophos.MenuTest.close );
	});

	</script>

	
	<section class="about-panel">
	<div class="container">
	<div class="panel-content ">

		<div class="description"><span>Have you listened to our podcast? <a href="/podcast/">Listen now</a></span></div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	<div id="content" class="site-content">
		<div class="content-container">

</div> <!-- .container -->
</div> <!-- #content -->


	<section class="content-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

		<main id="main" class="site-main" role="main">

	
		
<article id="post-563319" class="post-563319 post type-post status-publish format-standard has-post-thumbnail hentry category-apple category-featured category-malware category-os-x tag-ios tag-mac tag-macos tag-malware-2 tag-reverse-shell tag-xcode tag-xcodeghost tag-xcodespy">

	<header class="entry-header">
		<h1 class="entry-title">Serious Security: Mac &#8220;XcodeSpy&#8221; backdoor takes aim at Xcode devs</h1>		<div class="entry-meta">
			<div>
				
	<span class="entry-published">
		<time class="entry-date published" datetime="2021-03-19T19:16:06+00:00">19 Mar 2021</time>
	</span>

					<a href="#comments" class="comment-box">
					<span class="count">0</span>
				</a>
					
	<span class="entry-categories">
	<a href="https://nakedsecurity.sophos.com/category/organisations/apple/">Apple</a>, <a href="https://nakedsecurity.sophos.com/category/security-threats/malware/">Malware</a>, <a href="https://nakedsecurity.sophos.com/category/technologies/operating-systems/os-x/">OS X</a>	</span>

			</div>
	</header> <!-- .entry-header -->

    <div id="newsletter-signup" class="container top"></div>

			<div class="entry-featured-image">
			<img width="780" height="408" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-xcode-1200.jpg?w=780&amp;h=408&amp;crop=1" class="attachment-hero-thumbnail size-hero-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-xcode-1200.jpg 1200w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-xcode-1200.jpg?resize=300,157 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-xcode-1200.jpg?resize=768,401 768w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-xcode-1200.jpg?resize=1024,535 1024w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-xcode-1200.jpg?resize=780,408 780w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-xcode-1200.jpg?resize=100,52 100w" sizes="(max-width: 780px) 100vw, 780px" />					</div> <!-- .entry-featured-image -->
		
		<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2021/03/18/s3-ep24-how-not-to-get-snooped-scammed-or-hoaxed-podcast/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> S3 Ep24: How not to get snooped, scammed or hoaxed [Podcast]</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2021/03/22/instagram-scams-and-how-to-avoid-them/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Instagram scams and how to avoid them</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	<div class="entry-content">
		<div class="entry-prefix">
			<div class="entry-author">
				
	
					<span class="by">by</span>
			<a href="https://nakedsecurity.sophos.com/author/paul-ducklin/" title="Posts by Paul Ducklin" class="author url fn" rel="author">Paul Ducklin</a>		
	
				</div>
			<div class="entry-sharing">
				
	<ul class="block social share">
		<li class="facebook"><a href="https://www.facebook.com/share.php?u=https%3A%2F%2Fnakedsecurity.sophos.com%2F2021%2F03%2F19%2Fserious-security-mac-supply-chain-backdoor-takes-aim-at-xcode-devs%2F&title=Serious+Security%3A+Mac+%E2%80%9CXcodeSpy%E2%80%9D+backdoor+takes+aim+at+Xcode+devs" data-title="Serious Security: Mac “XcodeSpy” backdoor takes aim at Xcode devs" title="Share on Facebook"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
		<li class="twitter"><a href="https://twitter.com/intent/tweet?text=Serious+Security%3A+Mac+%E2%80%9CXcodeSpy%E2%80%9D+backdoor+takes+aim+at+Xcode+devs+https%3A%2F%2Fnakedsecurity.sophos.com%2F%3Fp%3D563319" data-title="Serious Security: Mac &#8220;XcodeSpy&#8221; backdoor takes aim at Xcode devs" title="Share on Twitter"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
		<li class="linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2021%2F03%2F19%2Fserious-security-mac-supply-chain-backdoor-takes-aim-at-xcode-devs%2F&title=Serious+Security%3A+Mac+%E2%80%9CXcodeSpy%E2%80%9D+backdoor+takes+aim+at+Xcode+devs" data-title="Serious Security: Mac “XcodeSpy” backdoor takes aim at Xcode devs" title="Share on LinkedIn"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
		<li class="reddit"><a href="https://reddit.com/submit/?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2021%2F03%2F19%2Fserious-security-mac-supply-chain-backdoor-takes-aim-at-xcode-devs%2F&title=Serious+Security%3A+Mac+%E2%80%9CXcodeSpy%E2%80%9D+backdoor+takes+aim+at+Xcode+devs" title="Share on Reddit"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon reddit"><use xlink:href="#reddit"></use></svg></a></li>

			</ul>

				</div>
		</div>
		<p>Remember <a href="https://nakedsecurity.sophos.com/2015/09/22/apples-app-store-hit-by-the-xcodeghost-of-malware-present/">XcodeGhost</a>?</p>
<p>It was a pirated and malware-tainted version of Apple&#8217;s XCode development app that worked in a devious way.</p>
<p>You may be wondering, as we did back in 2015, why anyone would download and use a pirated version of <em>Xcode.app</em> when the official version is available as a free download anyway.</p>
<p>Nevertheless, this redistributed version of Xcode seems to have been popular in China at the time&nbsp;&#8211; perhaps simply because it was easier to acquire the &#8220;product&#8221;, which is a multi-gigabyte download, directly from fast servers inside China.</p>
<p>The hacked version of Xcode would add malware into iOS apps when they were compiled on an infected system, without infecting the source code of the app itself.</p>
<p>The implanted malware was buried in places that looked like Apple-supplied library code, with the result that Apple let many of these booby-trapped apps into the App Store, presumably because the components compiled from the vendor’s own source code were fine.</p>
<p>As we <a href="https://nakedsecurity.sophos.com/2015/09/22/apples-app-store-hit-by-the-xcodeghost-of-malware-present/">said at the time</a>, &#8220;<i>developers with sloppy security practices, such as using illegally-acquired software of unvetted origin for production builds, turned into iOS malware generation factories for the crooks behind XcodeGhost.</i>&#8221;</p>
<p>As you probably know, this sort of security problem is now commonly known as a <i><a href="https://news.sophos.com/en-us/2021/02/11/supply-chain-security-three-important-focus-areas-for-immediate-and-measurable-results/">supply chain attack</a></i>, in which a product or service that you assumed you could trust turned out to have had malware inserted along the way.</p>
<div style='text-align:center'>
<blockquote class="wp-embedded-content" data-secret="LEAUSoPvPU"><p><a href="https://nakedsecurity.sophos.com/2015/09/22/apples-app-store-hit-by-the-xcodeghost-of-malware-present/">Apple&#8217;s App Store hit by the XcodeGhost of malware present</a></p></blockquote>
<p><iframe loading="lazy" class="wp-embedded-content" sandbox="allow-scripts" security="restricted" style="position: absolute; clip: rect(1px, 1px, 1px, 1px);" title="&#8220;Apple&#8217;s App Store hit by the XcodeGhost of malware present&#8221; &#8212; Naked Security" src="https://nakedsecurity.sophos.com/2015/09/22/apples-app-store-hit-by-the-xcodeghost-of-malware-present/embed/#?secret=LEAUSoPvPU" data-secret="LEAUSoPvPU" width="600" height="338" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe>
</div>
<aside id="sophos_ad-3" class="widget sophos-inline-ad sophos_widget_ad">				<style></style>
				<div class="sophos_widget_ad"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx" class="s-ad-threat-hunter__link-wrapper">
  <div class="s-ad-threat-hunter">
    <div class="s-ad-threat-hunter__title">
      OTHERS STOP AT NOTIFICATION. WE TAKE ACTION
    </div>
    <div class="s-ad-threat-hunter__text">
      Get 24/7 managed threat hunting, detection, and response delivered by
      Sophos experts
    </div>
    <div class="s-ad-threat-hunter__action">
      <span class="s-button s-button--bright-green"> Learn&nbsp;more </span>
    </div>
  </div>
</a></div>
			</aside>
<h2>Meet &#8220;XcodeSpy&#8221;</h2>
<p>Well, researchers at SentinelOne have just written up <a href="https://labs.sentinelone.com/new-macos-malware-xcodespy-targets-xcode-developers-with-eggshell-backdoor/" rel="nofollow">another supply chain attack</a> they&#8217;ve discovered that is directly targeting incautious Xcode developers, and they&#8217;re calling this one <strong>XcodeSpy</strong>.</p>
<p>It&#8217;s much smaller and simpler than XcodeGhost, and this time it doesn&#8217;t infect programs that you compile, although it still does its dirty work at compile time.</p>
<p>The malware is delivered in the form of a booby-trapped version of a legitimate Xcode project that the crooks used as a cover name for their malware.</p>
<p>The &#8220;donor&#8221; project that was ripped off to act as a carrier was an open-source library called <em>TabBarInteraction</em> created by a GitHub user going by the name of Potato04.</p>
<p>We don&#8217;t know why the unfortunate Potato04 was chosen by the crooks, and we don&#8217;t know if any other projects were targeted &#8211; for all we know, this may have been some sort of test-run using a project that the attackers guessed their victims were using at the time.</p>
<p>Interestingly, the crooks stripped out all the useful code in the project, but inserted executable script code into the <code>PBXShellScriptBuildPhase</code> part of the <code>project.pbxpoject</code> file:</p>
<p><img loading="lazy" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-added-768.png" alt="" width="768" height="374" class="aligncenter size-full wp-image-563321" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-added-768.png 768w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-added-768.png?resize=300,146 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-added-768.png?resize=412,200 412w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-added-768.png?resize=100,49 100w" sizes="(max-width: 768px) 100vw, 768px" /></p>
<p>As the name suggests, this script gets called as a side-effect of building the project, so the malicious code doesn&#8217;t end up in the software that is supposed to be created by the build.</p>
<p>However, the rogue shell script runs alongside all the other tasks such as compiling and linking that happen when developers click the <code>[Build]</code> button, effectively giving it a chance to hide in plain sight.</p>
<p>That&#8217;s because most project builds involve reading, creating, writing and manipulating dozens, hundreds or even thousands of files, as anyone who has ever compiled their own Linux kernel will know, so it&#8217;s a handy time for unexpected code to run unnoticed in the melee of system activity.</p>
<p style="background-color:#e8e8e8;font-size:80%;padding:1em 2em;margin:2em 0">Most build logs get searched for things that were supposed to work but didn&#8217;t. Commands that weren&#8217;t supposed to happen at all but worked just fine are easily overlooked, meaning that build-time malware that doesn&#8217;t draw any attention to itself could go unnoticed for ages.</p>
<h2>The malware unravelled</h2>
<p>The script code that the crooks added into the project file was inserted as follows:</p>
<p><img loading="lazy" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-shell-768.png" alt="" width="768" height="494" class="aligncenter size-full wp-image-563385" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-shell-768.png 768w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-shell-768.png?resize=300,193 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-shell-768.png?resize=100,64 100w" sizes="(max-width: 768px) 100vw, 768px" /></p>
<p style='margin-top:2em'>Extracting the executable script code from the project file, we can see that it first sets a series of Bash shell variables, each of which contributes a few characters to the final malware string:</p>
<p><img loading="lazy" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-vars-640.png" alt="" width="640" height="118" class="aligncenter size-full wp-image-563338" /></p>
<p style='margin-top:2em'>Next, the malicious script stitches the above short fragments together in a different order, and runs them as a new command, using the Bash function <code>eval</code>, short for <em>evaluate-and-execute</em>:</p>
<p><img loading="lazy" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-eval-640.png" alt="" width="640" height="50" class="aligncenter size-full wp-image-563324" /></p>
<p style='margin-top:2em'>In the code above, you need to know that the Bash code <code>odb</code> would mean &#8220;use the raw text <em>odb</em> at this point&#8221;, whereas <code>$odb</code> means &#8220;replace this text with the value of the variable <em>odb</em> instead&#8221;.</p>
<p>The ultimate outcome of this unscrambling process is that the <code>eval</code> above acts as though you typed in the following two lines at a Bash command prompt:</p>
<p><img loading="lazy" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-lines-640.png" alt="" width="640" height="68" class="aligncenter size-full wp-image-563325" /></p>
<p style='margin-top:2em'>The second command line shown above is one of the most compact ways of getting what&#8217;s called a <i>reverse shell</i> on a Linux or Unix system.</p>
<p>Simply put, it runs a new copy of the Bash shell, but instead of connecting its input and output to the console so you can type in commands on the keyboard and see the output in your terminal window&#8230;</p>
<p>&#8230;it connects <em>outwards</em> to the server name given, using TCP port 443, and hooks up the TCP network connection to the input and output of the Bash shell.</p>
<p>Outbound connections to port 443 are typically secure web connections, such as when you browse to a URL starting <code>https://</code>, so they are often considered unexceptionable by firewalls.</p>
<p>The result of this outward connection attempt is that if there&#8217;s a suitable program listening on port 443 at the specified remote location, that program will accept the connection and instantly get remote access to a Bash command prompt on your computer.</p>
<p>In the <a href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-shell.gif">example below</a>, we set up a listening process using <code>ncat</code> on a Linux laptop, and made a reverse shell connection outwards from a Mac:</p>
<figure id="attachment_563326" aria-describedby="caption-attachment-563326" style="width: 758px" class="wp-caption aligncenter"><img loading="lazy" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-shell-1.gif" alt="" width="758" height="300" class="size-full wp-image-563326" /><figcaption id="caption-attachment-563326" class="wp-caption-text">Left. Linux computer listening for shell connections.<br />Right. Mac computer getting &#8220;pwned&#8221; by reverse shell.</figcaption></figure>
<p>Here, we added the option <code>-i</code> after the command <code>bash</code> to get a visible prompt to appear, but that&#8217;s a detail that the crooks don&#8217;t need to worry about.</p>
<h2>What next?</h2>
<p>When a reverse shell connection arrives at the crook&#8217;s computer, it&#8217;s  as though they just logged <em>into</em> your computer, except that the connection came <em>outwards</em>, so there was in fact no &#8220;logging in&#8221;, no inbound firewall connection rules to bypass, no username needed, and no password required.</p>
<p>At this point, the crooks can pretty much do to your Mac anything that you could do yourself, given that they have a remote shell running under your account. (You can see this in the animation above when we run the command <code>whoami</code> after the Mac&#8217;s reverse shell has called home.)</p>
<p>Even if the remote shell is only open briefly, that&#8217;s almost always enough time for the crooks to upload and launch yet more malware on your computer, giving them a beachhead to get back into your system at will, even after the initial remote shell has exited.</p>
<p>According to <a href="https://labs.sentinelone.com/new-macos-malware-xcodespy-targets-xcode-developers-with-eggshell-backdoor/" rel="nofollow">SentinelOne</a>, the call-home server used in the script above isn&#8217;t actively listening for reverse shell connections any more, although we found that the domain itself is still online, currently advertising itself as a forthcoming site for &#8220;fulls&#8221;:</p>
<p><img loading="lazy" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-fullz-540.png" alt="" width="540" height="314" class="aligncenter size-full wp-image-563345" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-fullz-540.png 540w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-fullz-540.png?resize=300,174 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/03/code-fullz-540.png?resize=100,58 100w" sizes="(max-width: 540px) 100vw, 540px" /></p>
<p style="background-color:#e8e8e8;font-size:80%;padding:1em 2em;margin:2em 0"><em>Fulls</em>, also written <em>fullz</em>, is <a href="https://nakedsecurity.sophos.com/2012/11/05/credit-card-fraud-want-to-join-the-party/">cybercrime argot</a> for stolen records of personally identifiable information that are considered complete. For an individual, this might include name, address, telephone number, bank account details, SSN, DOB, employment details, and more. For a credit card, it would typically include everything needed to make an online payment, including expiry date and CVV. </p>
<div style='text-align:center'>
<blockquote class="wp-embedded-content" data-secret="QcEPvBzMuf"><p><a href="https://nakedsecurity.sophos.com/2012/11/05/credit-card-fraud-want-to-join-the-party/">Credit card fraud &#8211; want to join the party?</a></p></blockquote>
<p><iframe loading="lazy" class="wp-embedded-content" sandbox="allow-scripts" security="restricted" style="position: absolute; clip: rect(1px, 1px, 1px, 1px);" title="&#8220;Credit card fraud &#8211; want to join the party?&#8221; &#8212; Naked Security" src="https://nakedsecurity.sophos.com/2012/11/05/credit-card-fraud-want-to-join-the-party/embed/#?secret=QcEPvBzMuf" data-secret="QcEPvBzMuf" width="600" height="338" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe>
</div>
<h2>Watch out for EggShell</h2>
<p>As you saw above, the first line in the implanted shell script created a file called <code>.tag</code> in the Mac&#8217;s temporary folder. </p>
<p>That hidden file (on Unix and Linux systems, filenames that start with a dot are not visible by default) is dedicated to the single task of running a mysteriously named command <code>mdbcmd</code>, which we&#8217;re assuming the crooks would have uploaded automatically as soon a remote shell connection arrived.</p>
<p>At this point, we can only guess at what the crooks had in mind here, although SentinelOne has made an educated conjecture, based on finding two other malware files from other sources that contained the same string <code>/private/tmp/.tag</code> that appears in the XcodeSpy script.</p>
<p>Both were samples of a notorious Mac backdoor known as EggShell. (These samples, along with this malicious project file, are detected by Sophos as <strong>OSX/EggShell-A</strong>.)</p>
<p>The original EggShell code is an open source project that describes itself as a &#8220;<em>post exploitation surveillance tool [that] gives you a command line session with extra functionality between you and a target machine,</em>&#8221; so an attacker using EggShell doesn&#8217;t need to run a whole series of complex commands by hand:</p>
<blockquote><p>EggShell gives you the power and convenience of uploading/downloading files, tab completion, taking pictures, location tracking, shell command execution, persistence, escalating privileges, password retrieval, and much more.</p></blockquote>
<p>As the original author wrly notes, EggShell is &#8220;<em>a proof of concept, intended for use on machines you own,</em>&#8221; though there are plenty of cybercriminals who have not adhered to that advice.</p>
<h2>What to do?</h2>
<ul>
<li><strong>Don’t blindly download new packages or package updates into your own development or build systems.</strong> Test and review everything you download before you approve it for use. Packages may include build-time scripts, as in this case, as well as <a href="https://nakedsecurity.sophos.com/2021/03/07/poison-packages-supply-chain-risks-user-hits-python-community-with-4000-fake-modules/">update-time scripts</a> that run only when you do the update. For these reasons, a software project can be infected (and infectious) even if the source code in the project itself is clean.
<li><strong>Learn more about remote shells and how they put your ecosystem at risk.</strong> Of particular recent interest are webshells, a way for crooks to run malicious scripts via your web server, notoriously abused in the so-called <a href="https://nakedsecurity.sophos.com/2021/03/09/serious-security-webshells-explained-in-the-aftermath-of-hafnium-attacks/">HAFNIUM attacks</a> that started in February 2021. You can read more about remote shells and how to defend against them on <a href="https://nakedsecurity.sophos.com/2021/03/09/serious-security-webshells-explained-in-the-aftermath-of-hafnium-attacks/">Naked Security</a>, on our sister website <a href="https://news.sophos.com/en-us/2021/03/05/hafnium-advice-about-the-new-nation-state-attack/">Sophos News</a>, or even consult the NSA, which maintains a <a href="https://github.com/nsacyber/Mitigating-Web-Shells" rel="nofollow">GitHub repository</a> of tools and information on the subject.
<li><strong>Consider filtering traffic using port 443 if you have a firewall that can reliably do so.</strong> Not all organisations are comfortable intercepting and examining encrypted HTTPS traffic, but products such as the <a href="https://www.sophos.com/en-us/products/next-gen-firewall.aspx">Sophos Firewall</a> allow you to exempt low-risk sites where uninterrupted encryption is important. This means you can maintain the end-to-end sanctity of connections to sites such as online banking, webmail and messaging services, and focus your attention instead on low-reputation or unknown sites where encryption could be shielding malicious content. Sites that use port 443 as a loophole for unencrypted connections, as in this case, or that aren&#8217;t using HTTPS safely, can be blocked up front before they even complete their connection.
<ul>
<hr style='margin-top:2em'>
<p style="background-color:#e8e8e8;font-size:80%;padding:1em 2em;margin:2em 0">Sophos products report the malicious project file described here, as well the EggShell backdoors listed in SentinelOne&#8217;s report, as <strong>OSX/EggShell-A</strong>, if you would like to check your logs. The call-home sites in this case are identified by Sophos web filtering products at connection time under the general category <strong>PROD_COMMAND&shy;_AND_CONTROL</strong> and under the security category <strong>SEC_MALWARE&shy;_CALLHOME</strong>.<br />If you are interested in real-time malware and web filtering and how you can build it into your own products and services, you might like to look at the <a href="https://api.labs.sophos.com/doc/index.html">SophosLabs Intelix APIs</a>.</p>
<hr style='margin-top:2em'>
			</div> <!-- .entry-content -->
	<ul class="block social follow">
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon twitter"><use xlink:href="#twitter"></use></svg>
			<p>Follow <strong><a href="https://twitter.com/nakedsecurity">@NakedSecurity on Twitter</a></strong> for the latest computer security news.</p>
		</li>
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon instagram"><use xlink:href="#instagram"></use></svg>
			<p>Follow <strong><a href="https://www.instagram.com/nakedsecurity/">@NakedSecurity on Instagram</a></strong> for exclusive pics, gifs, vids and LOLs!</p>
		</li>
	</ul>
</article><!-- #post-## -->

		<div class="free-tools-block">
			<h2 class="block-title">Free tools</h2>

<div class="ns-free-tools">
	<div class="ns-free-tools__item ns-free-tools__item--sophos-home">
		<a class="ns-free-tools__link" href="https://home.sophos.com/en-us.aspx?cmp=701j0000001eLpnAAE">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/sophos-home@2x.png" alt="Sophos Home" class="ns-free-tools__image" width="166" height="100">
			<h4 class="ns-free-tools__title">
				Sophos Home			</h4>
			<div class="ns-free-tools__sub-title">
				Protect personal PCs and Macs			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--hitman-pro">
		<a class="ns-free-tools__link" href="https://www.hitmanpro.com/en-us/hmp.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/hitman-pro@2x.png" alt="Hitman Pro" class="ns-free-tools__image" width="154" height="100">
			<h4 class="ns-free-tools__title">
				Hitman Pro			</h4>
			<div class="ns-free-tools__sub-title">
				Find and remove malware			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--intercept-x">
		<a class="ns-free-tools__link" href="https://www.sophos.com/en-us/products/free-tools/sophos-mobile-security-free-edition.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/mobile-security-android@2x.png" alt="Sophos Intercept X for Mobile" class="ns-free-tools__image" width="96" height="110">
			<h4 class="ns-free-tools__title">
				Intercept X for Mobile			</h4>
			<div class="ns-free-tools__sub-title">
				Protect Android devices			</div>
		</a>
	</div>
</div>
		</div>

			<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2021/03/18/s3-ep24-how-not-to-get-snooped-scammed-or-hoaxed-podcast/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> S3 Ep24: How not to get snooped, scammed or hoaxed [Podcast]</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2021/03/22/instagram-scams-and-how-to-avoid-them/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Instagram scams and how to avoid them</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	
	</main><!-- #main -->

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<section class="comments-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

			
<div id="comments" class="comments-area">

	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">What do you think? <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2021/03/19/serious-security-mac-supply-chain-backdoor-takes-aim-at-xcode-devs/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://nakedsecurity.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='563319' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="f4e4e6502f" /></p><input type="hidden" id="ak_js" name="ak_js" value="110"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->
		<div class="comments-widget-area">
					</div>
	
	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	

	<section class="recommended-panel">
	<div class="container">
	<div class="panel-content ">

		<h3 class="block-title">Recommended reads</h3>
	<div class="blocks">
		<article id="post-544993" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/02/03/what-should-you-say-if-you-have-a-data-breach-catch-up-with-jason-nurse-at-sophos-evolve/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/02/jason-1200.jpg?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Feb</span><span class="day">03</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Sally Adam	
	</div>
			<div class="comment-box">
				<span class="count">2</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/02/03/what-should-you-say-if-you-have-a-data-breach-catch-up-with-jason-nurse-at-sophos-evolve/" rel="bookmark">What should you say if you have a data breach? Catch up with Jason Nurse at Sophos Evolve</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-544714" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/01/27/apple-critical-patches-fix-in-the-wild-iphone-exploits-update-now/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/01/appleupd-1200.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Jan</span><span class="day">27</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">7</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/01/27/apple-critical-patches-fix-in-the-wild-iphone-exploits-update-now/" rel="bookmark">Apple critical patches fix in-the-wild iPhone exploits &#8211; update now!</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-544987" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/02/01/naked-security-live-what-if-my-password-manager-gets-hacked/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/10/nslive-1200-3.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Feb</span><span class="day">01</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">30</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/02/01/naked-security-live-what-if-my-password-manager-gets-hacked/" rel="bookmark">Naked Security Live &#8211; What if my password manager gets hacked?</a></h3>	</div>
</article> <!-- .card-article -->
	</div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="footer-container">
			<a href="#" class="js-collapse-footer"><svg style="height: 20px" viewBox="0 0 132 24" class="block icon sophos"><use xlink:href="#sophos"></use></svg></a>
			<div id="collapseFooter" class="blocks">
				<div class="sophos block">
					<ul id="menu-footer-primary" class="primary menu"><li id="menu-item-306737" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306737"><a href="https://nakedsecurity.sophos.com/about/">About Naked Security</a></li>
<li id="menu-item-306754" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306754"><a href="https://www.sophos.com/en-us/company.aspx">About Sophos</a></li>
<li id="menu-item-306747" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306747"><a href="https://nakedsecurity.sophos.com/send-us-a-tip/">Send us a tip</a></li>
<li id="menu-item-323171" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323171"><a href="/cookies-and-scripts/">Cookies</a></li>
<li id="menu-item-323170" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323170"><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
<li id="menu-item-323169" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323169"><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
</ul>				</div>
										<div class="news block">
							<ul id="menu-products-column-one" class="small menu"><li id="menu-item-306998" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306998"><a href="https://www.sophos.com/en-us/products/intercept-x.aspx">Intercept X</a></li>
<li id="menu-item-440801" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440801"><a href="https://www.sophos.com/en-us/products/server-security.aspx">Intercept X for Server</a></li>
<li id="menu-item-440802" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440802"><a href="https://www.sophos.com/en-us/products/mobile-control.aspx">Intercept X for Mobile</a></li>
</ul>						</div>
											<div class="products block">
							<ul id="menu-products-column-two" class="small menu"><li id="menu-item-440803" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440803"><a href="https://www.sophos.com/en-us/products/next-gen-firewall.aspx">XG Firewall</a></li>
<li id="menu-item-440805" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440805"><a href="https://www.sophos.com/en-us/products/sophos-email.aspx">Sophos Email</a></li>
<li id="menu-item-440804" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440804"><a href="https://www.sophos.com/en-us/products/secure-wifi.aspx">Sophos Wireless</a></li>
</ul>						</div>
											<div class="threats block">
							<ul id="menu-server-protection" class="small menu"><li id="menu-item-440806" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440806"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx">Managed Threat Response</a></li>
<li id="menu-item-448404" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-448404"><a href="https://www.sophos.com/en-us/products/cloud-optix.aspx">Cloud Optix</a></li>
<li id="menu-item-440807" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440807"><a href="https://www.sophos.com/en-us/products/phish-threat.aspx">Phish Threat</a></li>
</ul>						</div>
								</div>
			<ul class="block social footer">
				<li class="twitter"><a rel="nofollow" href="https://twitter.com/NakedSecurity" title="Follow our team of security experts on Twitter"><svg style="height: 14px" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
				<li class="facebook"><a rel="nofollow" href="https://www.facebook.com/SophosSecurity" title="Join over 250,000 people in our Facebook community"><svg style="height: 14px" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
				<li class="instagram"><a rel="nofollow" href="https://www.instagram.com/nakedsecurity/" title="Follow Naked Security on Instagram"><svg style="height: 14px" viewBox="0 0 100 100" class="icon instagram"><use xlink:href="#instagram"></use></svg></a></li>
				<li class="linkedin"><a rel="nofollow" href="https://www.linkedin.com/company/5053/" title="Join the naked security discussion group on LinkedIn"><svg style="height: 14px" viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
				<li class="rss"><a rel="nofollow" href="/feed" title="Subscribe to our RSS feed"><svg style="height: 14px" viewBox="0 0 100 100" class="icon rss"><use xlink:href="#rss"></use></svg></a></li>
			</ul>

							<div class="vip-powered-wpcom">
					<span class="copyright">© 1997 - 2021 Sophos Ltd.</span>
					All rights reserved.
					Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=nakedsecurity.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>				</div>
					</div>
		<script type="text/javascript">
			window.cookieconsent_options = {
				"message":"This site uses cookies. By continuing to browse the site you are agreeing to our use of cookies.",
				"dismiss":"Got it!",
				"learnMore":"Learn More",
				"link":"/cookies-and-scripts",
				"theme":"https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/css/sophos.css"};
		</script>
	</footer><!-- #colophon -->
</div><!-- #page -->
<div id="survey-wrapper" class="mfp-hide"><div class="pd-embed" id="pd_1499706777" data-settings=""></div></div>
<script id='child-js-plugins-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"0","nextLink":""};
</script>
<script id='child-js-core-js-extra'>
var Sophos = {"ajaxurl":"https:\/\/nakedsecurity.sophos.com\/wp-admin\/admin-ajax.php","nonce":"5bbcbbfa6a"};
</script>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJyNjkEKwjAQRS9kOonYggvxKGLT0SZmJiGTULx9Q7HgwoXL+f89/sCSlI1ckAuUGQkFJKY5CuMi6qhND14ghfp0LJ2XA/wl2Jhxpx3bUKfGbTlRM1XGFN4dOf4FtRNpxOm73yepqs8zcH85ISxway48YqbGXuliBtOfBq3P2q8Rb09t'></script>
<script src='https://stats.wp.com/e-202112.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.5.2',blog:'166161173',post:'563319',tz:'0',srv:'nakedsecurity.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161173', '563319' ]);
</script>
</body>
</html>
