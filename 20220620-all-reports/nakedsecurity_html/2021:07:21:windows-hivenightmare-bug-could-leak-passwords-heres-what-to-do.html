<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="RHQeasQqjasbRt5asY6atZYbs5tr10gFBevDt2HRhW0" />
<link rel="pingback" href="https://nakedsecurity.sophos.com/xmlrpc.php">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5VK6LTK');</script>
<!-- End Google Tag Manager -->

<meta name="description" content="Windows &quot;hives&quot; contain registry data, some of it secret. The nightmare is that these files aren&#039;t properly protected against snooping." />
<meta name="keywords" content="microsoft, vulnerability, windows, cve-2021-36934, hivenightmare, serioussam, vulnerability" />
<title>Windows &#8220;HiveNightmare&#8221; bug could leak passwords &#8211; here&#8217;s what to do! &#8211; Naked Security</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="I9dHFo-YhnK2MfAHn-20V4GnWrOttVUYyISGamyU41M" />
<meta name="msvalidate.01" content="7D8D1FA2892142B1543D2CBCD07FB88F" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Feed" href="https://nakedsecurity.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Comments Feed" href="https://nakedsecurity.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Windows &#8220;HiveNightmare&#8221; bug could leak passwords &#8211; here&#8217;s what to do! Comments Feed" href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/feed/" />
<link rel='stylesheet' id='all-css-0' href='https://nakedsecurity.sophos.com/_static/??-eJyVkEEOgzAMBD/UJIUKVA5V32KCBWmdEMVGiN83VBxAvdDjamcke80clQuWpg7ZWGbTORbT0mjfilybIC2GZSHU3gWdgYvZGy82HjsHSOgxyCFEggWTIuzBLuf03O3zQbJjkJWRIXdseIzDyAFnVuW1qLYj/4EVgSDLWWcdBzotQ0IQNUwZThp8/PH9pCJNvQv5P5QIeclGN19/y6vy9I+iLut7Xd2q+gO1CY89' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZkZmFgbGloWEWAK9yIh0='></script>
<link rel="https://api.w.org/" href="https://nakedsecurity.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://nakedsecurity.sophos.com/wp-json/wp/v2/posts/596510" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://nakedsecurity.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://nakedsecurity.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.8" />
<link rel="canonical" href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/" />
<link rel='shortlink' href='https://nakedsecurity.sophos.com/?p=596510' />
<link rel="alternate" type="application/json+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2021%2F07%2F21%2Fwindows-hivenightmare-bug-could-leak-passwords-heres-what-to-do%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2021%2F07%2F21%2Fwindows-hivenightmare-bug-could-leak-passwords-heres-what-to-do%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style>
		<link rel="amphtml" href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Windows &#8220;HiveNightmare&#8221; bug could leak passwords &#8211; here&#8217;s what to do!" />
<meta property="og:url" content="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/" />
<meta property="og:description" content="Windows &#8220;hives&#8221; contain registry data, some of it secret. The nightmare is that these files aren&#8217;t properly protected against snooping." />
<meta property="article:published_time" content="2021-07-21T18:58:01+00:00" />
<meta property="article:modified_time" content="2021-07-22T16:01:58+00:00" />
<meta property="og:site_name" content="Naked Security" />
<meta property="og:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/07/hive-1220.jpg?w=775" />
<meta property="og:image:secure_url" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/07/hive-1220.jpg?w=775" />
<meta property="og:image:width" content="775" />
<meta property="og:image:height" content="405" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:creator" content="@NakedSecurity" />
<meta name="twitter:site" content="@NakedSecurity" />
<meta name="twitter:text:title" content="Windows &#8220;HiveNightmare&#8221; bug could leak passwords &#8211; here&#8217;s what to do!" />
<meta name="twitter:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/07/hive-1220.jpg?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=270" />
</head>
<body class="post-template-default single single-post postid-596510 single-format-standard" >
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VK6LTK"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div style="display: none">
<svg>
	<symbol id="sophos" viewBox="0 0 132 24">
		<path d="m111.82 22.176h11.64c3.267 0 4.65-0.2 5.74-0.896 1.715-1.063 2.804-3.26 2.804-5.62 0-1.928-0.658-3.89-1.647-4.888-1.288-1.33-3.035-1.828-6.271-1.828h-3.527c-1.586 0-2.754-0.067-3.412-0.365-0.794-0.367-1.256-1.165-1.256-2.161 0-1.165 0.56-2.03 1.486-2.264 0.692-0.163 1.498-0.163 3.574-0.198h10.419v-3.956h-11.473c-2.574 0-3.727 0.099-4.718 0.466-2.279 0.796-3.828 3.257-3.828 6.083 0 1.93 0.76 3.727 2.079 4.89 1.155 0.996 2.872 1.462 5.51 1.462h4.697c1.057 0 1.915 0.132 2.376 0.398 0.893 0.433 1.418 1.328 1.418 2.36 0 0.864-0.395 1.597-1.087 2.027-0.561 0.369-1.517 0.534-3.268 0.534h-11.256zm-111.35 0h11.64c3.267 0 4.652-0.2 5.741-0.896 1.714-1.063 2.803-3.26 2.803-5.62 0-1.928-0.66-3.89-1.65-4.888-1.285-1.33-3.034-1.828-6.27-1.828h-3.527c-1.584 0-2.751-0.067-3.41-0.365-0.792-0.367-1.253-1.165-1.253-2.161 0-1.165 0.56-2.03 1.484-2.264 0.693-0.163 1.496-0.163 3.574-0.198h10.42v-3.956h-11.477c-2.573 0-3.727 0.099-4.715 0.466-2.278 0.796-3.83 3.257-3.83 6.083 0 1.93 0.762 3.727 2.08 4.89 1.155 0.996 2.871 1.462 5.51 1.462h4.696c1.057 0 1.913 0.132 2.377 0.398 0.888 0.433 1.416 1.328 1.416 2.36 0 0.864-0.394 1.597-1.089 2.027-0.558 0.369-1.517 0.534-3.264 0.534h-11.256v3.956zm94.05-16.18c-0.68 1.076-1.003 2.803-1.003 5.122 0 5.088 1.747 7.405 5.63 7.405 3.822 0 5.568-2.317 5.568-7.34 0-5.092-1.715-7.373-5.568-7.373-2.102 0-3.754 0.784-4.627 2.186zm13.174-2.511c1.329 1.761 2.072 4.63 2.072 7.992 0 3.816-1.197 6.948-3.334 8.677-1.619 1.304-4.078 2.022-6.995 2.022-4.142 0-7.41-1.372-9.092-3.817-1.263-1.793-1.88-4.176-1.88-7.08 0-4.172 1.133-7.339 3.27-9.035 1.682-1.37 4.339-2.122 7.383-2.122 3.85 0 6.925 1.209 8.576 3.363zm-22.018-3.068h-4.596v8.908h-8.319v-8.908h-4.597v21.759h4.597v-8.97h8.318v8.97h4.596v-21.759zm-28.61 10.277c1.23 0 1.941-0.163 2.427-0.62 0.581-0.49 0.938-1.533 0.938-2.74 0-1.436-0.58-2.478-1.584-2.838-0.356-0.13-0.94-0.197-1.684-0.197h-6.344v6.395zm-6.247 11.481h-4.598v-21.758h10.78c3.786 0 5.114 0.39 6.538 1.991 1.264 1.37 1.942 3.163 1.942 5.088 0 2.284-0.904 4.404-2.394 5.676-1.262 1.077-2.43 1.402-4.888 1.402h-7.38zm-22.589-16.179c-0.682 1.076-1.004 2.803-1.004 5.122 0 5.088 1.748 7.405 5.634 7.405 3.818 0 5.568-2.317 5.568-7.34 0-5.092-1.716-7.373-5.568-7.373-2.106 0-3.757 0.784-4.63 2.186zm13.174-2.511c1.328 1.761 2.073 4.63 2.073 7.992 0 3.816-1.2 6.948-3.335 8.677-1.618 1.304-4.079 2.022-6.993 2.022-4.144 0-7.413-1.372-9.096-3.817-1.264-1.793-1.878-4.176-1.878-7.08 0-4.172 1.133-7.339 3.272-9.035 1.681-1.37 4.337-2.122 7.38-2.122 3.851 0 6.93 1.209 8.578 3.363z"></path>
	</symbol>
	<symbol id="twitter" viewBox="0 0 24 24">
 		<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path>
 	</symbol>
	<symbol id="facebook" viewBox="0 0 24 24">
 		<path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path>
 	</symbol>
	<symbol id="instagram" viewBox="0 0 24 24">
		<path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path>
	</symbol>
	<symbol id="linkedin" viewBox="0 0 24 24">
		<path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"></path>
	</symbol>
	<symbol id="rss" viewBox="0 0 24 24">
		<path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"></path>
	</symbol>
	<symbol id="reddit" viewBox="0 0 24 24">
		<path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"></path>
	</symbol>
</svg>
</div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header variation variation-3" role="banner">
		<div class="header-container">
			<div class="site-branding">
				<div class="site-title">
					<a title="Naked Security" href="https://nakedsecurity.sophos.com/" rel="home"><img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/naked-security-logo-white@2x.png"></a>
					by
					<a title="sophos.com" href="https://www.sophos.com"><svg viewBox="0 0 132 24" class="icon sophos"><use xlink:href="#sophos"></use></svg></a>
				</div>
			</div><!-- .site-branding -->
			<nav id="site-navigation" class="main-navigation" role="navigation">
				<div class="container">
					<ul id="menu-variation-two" class="exit-links menu"><li id="menu-item-436509" class="products menu-item menu-item-type-custom menu-item-object-custom menu-item-436509"><a href="#">Products</a></li>
<li id="menu-item-436515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436515"><a href="https://www.sophos.com/en-us/products/free-tools.aspx">Free Tools</a></li>
<li id="menu-item-436531" class="search-toggle menu-item menu-item-type-custom menu-item-object-custom menu-item-436531"><a href="#">Search</a></li>
<li id="menu-item-436532" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436532"><a href="https://home.sophos.com/en-us.aspx">Free Sophos Home</a></li>
</ul>				</div>
			</nav><!-- #site-navigation -->
			<div class="site-search-block">
	<form target="_top" role="search" class="search-form" method="get" action="https://nakedsecurity.sophos.com/">
        <fieldset>
            <div class="field">
				<input type="search" value="" name="s" class="search-field" placeholder="Search naked security...">
            </div>
            <div class="submit">
				<button type="submit" class="search-submit button">Go</button>
            </div>
        </fieldset>
    </form>
</div>
		</div><!-- .container -->
	</header>

	<div class="responsive-flyout-panel small-12 column active" style="opacity: 1; display: none;">
		<div class="modal-filler"></div>
	    <div class="productNavBox">
	        <div class="productNavContainer">
	            <div class="row prodRow">
	                <div class="prodListBox column large-9">
	                    <div class="row margin-0 highlightProduct">
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/next-gen-firewall.aspx"><img src="https://www.sophos.com/medialibrary/2F4785DE8C3F43ECBD699A18F332FEEB.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">XG Firewall</div>
	                                	<div class="menu-section-subtitle">Next-Gen Firewall</div>
									</div>
	                            </a>
	                        </div>
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/intercept-x.aspx"><img src="https://www.sophos.com/medialibrary/27111765D65A45D49A232925D2CE428B.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">Intercept X</div>
	                                	<div class="menu-section-subtitle">Next-Gen Endpoint</div>
									</div>
	                            </a>
	                        </div>
	                    </div>
	                    <div class="productList">
	                        <ul>
								<li>
									<a href="https://www.sophos.com/en-us/products/cloud-optix.aspx"><img src="https://www.sophos.com/medialibrary/SophosNext/Images/Products/Icons/sophos-cloud-optix-icon.svg">Sophos Cloud Optix</a>
								</li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-central.aspx"><img src="https://www.sophos.com/medialibrary/08EA66123F1B4DDE8FE5C9B578A7FAA7.ashx">Sophos Central</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/mobile-control.aspx"><img src="https://www.sophos.com/medialibrary/678FE994855047739F50D6C411184FA6.ashx">Sophos Mobile</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/server-security.aspx"><img src="https://www.sophos.com/medialibrary/01B80E7D7CD54EF8AC2E51C9C6EC0236.ashx">Intercept X for Server</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-wifi.aspx"><img src="https://www.sophos.com/medialibrary/BEBD9C41BB4E480498514B29B92A145A.ashx">Secure Wi-Fi</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/phish-threat.aspx"><img src="https://www.sophos.com/medialibrary/DC9D1A7BA3964B0C9DAF1F1E68806B5A.ashx">Phish Threat</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/safeguard-encryption.aspx"><img src="https://www.sophos.com/medialibrary/8F51F06B62814B108D3B2763FF018E37.ashx">SafeGuard Encryption</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-email.aspx"><img src="https://www.sophos.com/medialibrary/597ADA0AF01A4A12B2B27239D0F9992C.ashx">Secure Email</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/unified-threat-management.aspx"><img src="https://www.sophos.com/medialibrary/8CB72BF5E1AD41F7894CE5E42101B0F3.ashx">SG UTM</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-web-gateway.aspx"><img src="https://www.sophos.com/medialibrary/C586E372694547A1B207A61D87246BA7.ashx">Secure Web Gateway</a>
	                            </li>
	                        </ul>
	                    </div>
	                </div>
	                <div class="homeUserBox column large-3">
						<img src="https://www.sophos.com/medialibrary/3376DF5742A64AEE93FDB9DCA7291239.ashx">
						<div class="menu-section-title">For Home Users</div>
	                    <p>Sophos Home protects every Mac and PC in your home </p><a href="https://home.sophos.com/" target="_blank" class="greenSmallMenuBtn">Learn More</a>
					</div>
	            </div>
	            <div class="row blueRow">
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-tools.aspx"><img width="19" src="https://www.sophos.com/medialibrary/A1FF440D2BB84511B8C94D771D44E207.ashx">Free Security Tools</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-trials.aspx"><img width="20" src="https://www.sophos.com/medialibrary/FCD3410ED2C347808D9DB8AC12C62DBD.ashx">Free Trials</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/demos.aspx"><img width="18" src="https://www.sophos.com/medialibrary/50985180E5F54C94917A2A6508E24287.ashx">Product Demos</a>
	                </div>
	                <!-- <div class="column large-3 medium-6">
	                    <a href="javascript:fairfax.openLiveChatFromFlyoutLink();" class="flyout-live-chat-link"><img width="20" src="https://www.sophos.com/medialibrary/E24C5050837145F6A5C592E299BA2A0D.ashx">Live Sales Chat</a>
	                </div> -->
	            </div>
	        </div>
	    </div>
	</div>
	<script>

	jQuery(document).ready( function () {
		var productButton   = jQuery('nav .menu-item.products');
		var modalBackground = jQuery('.modal-filler');
		var flyoutMenu		= jQuery('.responsive-flyout-panel');
		var Sophos			= Sophos || {};

		Sophos.MenuTest = {};

		Sophos.MenuTest.open = function () {
				productButton.addClass('open');
				flyoutMenu.show();
				modalBackground.show();
		};

		Sophos.MenuTest.close = function () {
			productButton.removeClass('open');
			flyoutMenu.hide();
			modalBackground.hide();
		};

		Sophos.MenuTest.toggle = function () {
			if ( productButton.hasClass('open') ) {
				Sophos.MenuTest.close();
			} else {
				Sophos.MenuTest.open();
			}
		};

		productButton.click( Sophos.MenuTest.toggle );
		modalBackground.click( Sophos.MenuTest.close );
	});

	</script>

	
	<section class="about-panel">
	<div class="container">
	<div class="panel-content ">

		<div class="description"><span>Have you listened to our podcast? <a href="/podcast/">Listen now</a></span></div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	<div id="content" class="site-content">
		<div class="content-container">

</div> <!-- .container -->
</div> <!-- #content -->


	<section class="content-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

		<main id="main" class="site-main" role="main">

	
		
<article id="post-596510" class="post-596510 post type-post status-publish format-standard has-post-thumbnail hentry category-featured category-microsoft category-vulnerability category-windows tag-cve-2021-36934 tag-hivenightmare tag-serioussam tag-vulnerability-2">

	<header class="entry-header">
		<h1 class="entry-title">Windows &#8220;HiveNightmare&#8221; bug could leak passwords &#8211; here&#8217;s what to do!</h1>		<div class="entry-meta">
			<div>
				
	<span class="entry-published">
		<time class="entry-date published" datetime="2021-07-21T19:58:01+01:00">21 Jul 2021</time>
	</span>

					<a href="#comments" class="comment-box">
					<span class="count">18</span>
				</a>
					
	<span class="entry-categories">
	<a href="https://nakedsecurity.sophos.com/category/organisations/microsoft/">Microsoft</a>, <a href="https://nakedsecurity.sophos.com/category/security-threats/vulnerability/">Vulnerability</a>, <a href="https://nakedsecurity.sophos.com/category/technologies/operating-systems/windows/">Windows</a>	</span>

			</div>
	</header> <!-- .entry-header -->

    <div id="newsletter-signup" class="container top"></div>

			<div class="entry-featured-image">
			<img width="780" height="408" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/07/hive-1220.jpg?w=780&amp;h=408&amp;crop=1" class="attachment-hero-thumbnail size-hero-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/07/hive-1220.jpg 1200w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/07/hive-1220.jpg?resize=300,157 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/07/hive-1220.jpg?resize=768,401 768w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/07/hive-1220.jpg?resize=1024,535 1024w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/07/hive-1220.jpg?resize=780,408 780w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/07/hive-1220.jpg?resize=100,52 100w" sizes="(max-width: 780px) 100vw, 780px" />					</div> <!-- .entry-featured-image -->
		
		<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2021/07/20/apple-iphone-patches-are-out-no-news-if-recent-wi-fi-bug-is-fixed/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> Apple iPhone patches are out &#8211; no news if recent Wi-Fi bug is fixed</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2021/07/22/s3-ep42-viruses-nightmares-patches-rewards-and-scammers-podcast/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> S3 Ep42: Viruses, Nightmares, patches, rewards and scammers [Podcast]</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	<div class="entry-content">
		<div class="entry-prefix">
			<div class="entry-author">
				
	
					<span class="by">by</span>
			<a href="https://nakedsecurity.sophos.com/author/paul-ducklin/" title="Posts by Paul Ducklin" class="author url fn" rel="author">Paul Ducklin</a>		
	
				</div>
			<div class="entry-sharing">
				
	<ul class="block social share">
		<li class="facebook"><a href="https://www.facebook.com/share.php?u=https%3A%2F%2Fnakedsecurity.sophos.com%2F2021%2F07%2F21%2Fwindows-hivenightmare-bug-could-leak-passwords-heres-what-to-do%2F&title=Windows+%E2%80%9CHiveNightmare%E2%80%9D+bug+could+leak+passwords+%E2%80%93+here%E2%80%99s+what+to+do%21" data-title="Windows “HiveNightmare” bug could leak passwords – here’s what to do!" title="Share on Facebook"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
		<li class="twitter"><a href="https://twitter.com/intent/tweet?text=Windows+%E2%80%9CHiveNightmare%E2%80%9D+bug+could+leak+passwords+%E2%80%93+here%E2%80%99s+what+to+do%21+https%3A%2F%2Fnakedsecurity.sophos.com%2F%3Fp%3D596510" data-title="Windows &#8220;HiveNightmare&#8221; bug could leak passwords &#8211; here&#8217;s what to do!" title="Share on Twitter"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
		<li class="linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2021%2F07%2F21%2Fwindows-hivenightmare-bug-could-leak-passwords-heres-what-to-do%2F&title=Windows+%E2%80%9CHiveNightmare%E2%80%9D+bug+could+leak+passwords+%E2%80%93+here%E2%80%99s+what+to+do%21" data-title="Windows “HiveNightmare” bug could leak passwords – here’s what to do!" title="Share on LinkedIn"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
		<li class="reddit"><a href="https://reddit.com/submit/?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2021%2F07%2F21%2Fwindows-hivenightmare-bug-could-leak-passwords-heres-what-to-do%2F&title=Windows+%E2%80%9CHiveNightmare%E2%80%9D+bug+could+leak+passwords+%E2%80%93+here%E2%80%99s+what+to+do%21" title="Share on Reddit"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon reddit"><use xlink:href="#reddit"></use></svg></a></li>

			</ul>

				</div>
		</div>
		<p>As if one Windows Nightmare dogging all our printers were not enough&#8230;</p>
<p>&#8230;here&#8217;s <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36934" rel="nofollow">another bug</a>, disclosed by Microsoft on 2021-07-20, that could expose critical secrets from the Windows registry.</p>
<p>Denoted <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36934" rel="nofollow">CVE-2021-36934</a>, this one has variously been nicknamed <strong>HiveNightmare</strong> and <strong>SeriousSAM</strong>.</p>
<p>The moniker <strong>HiveNightmare</strong> comes from the fact that Windows stores its registry data in a small number of proprietary database files, known in Microsoft jargon as <em>hives</em> or <em>hive files</em>.</p>
<p>These hive files include a trio called <code>SAM</code>, <code>SECURITY</code> and <code>SYSTEM</code>, which between them include secret data including passwords and security tokens that regular users aren&#8217;t supposed to be able to access.</p>
<p>They&#8217;re kept in a special, and supposedly secure, folder under the Windows directory called <code>C:\Windows\System32\config</code>, as you see here:</p>
<pre style='line-height:1.7em'>
C:\Windows\System32\config&gt; dir
[. . .]
Directory of C:\Windows\System32\config
[. . .]
21/07/2021  12:57           524,288 BBI
25/06/2021  06:21            28,672 BCD-Template
21/07/2021  14:45        32,768,000 COMPONENTS
21/07/2021  12:57           786,432 DEFAULT
21/07/2021  12:32         4,194,304 DRIVERS
[. . .]
21/07/2021  12:57            65,536 SAM       &lt;--some system secrets included
21/07/2021  12:57            32,768 SECURITY  &lt;--some system secrets included
21/07/2021  12:57        87,556,096 SOFTWARE
21/07/2021  12:57        11,272,192 SYSTEM    &lt;--some system secrets included
[. . .]
</pre>
<p style='margin-top:2em'>The moniker <strong>SeriousSAM</strong> comes from the filename <code>SAM</code>, which is short for <em>Security Account Manager</em>, a name that sounds as serious as the file&#8217;s content&#8217;s are.</p>
<p>If you have ever used password cracking or hacking tools (or found evidence of them on your network after detecting an active attack), you&#8217;ll know that the SAM database is where many cybercriminals start digging in order to try to get hold of administrator credentials to move around your network.</p>
<p>Fortunately, you need to have Administrator access already in order to get at the SAM data in memory, and you can&#8217;t get at the SAM registry hive on disk while Windows is running even if you are an Administrator, because the SAM file shown above is locked for the exclusive use of the operating system.</p>
<p>So far, so good.</p>
<aside id="sophos_ad-3" class="widget sophos-inline-ad sophos_widget_ad">				<style></style>
				<div class="sophos_widget_ad"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx" class="s-ad-threat-hunter__link-wrapper">
  <div class="s-ad-threat-hunter">
    <div class="s-ad-threat-hunter__title">
      OTHERS STOP AT NOTIFICATION. WE TAKE ACTION
    </div>
    <div class="s-ad-threat-hunter__text">
      Get 24/7 managed threat hunting, detection, and response delivered by
      Sophos experts
    </div>
    <div class="s-ad-threat-hunter__action">
      <span class="s-button s-button--bright-green"> Learn&nbsp;more </span>
    </div>
  </div>
</a></div>
			</aside>
<h2>Who can see what?</h2>
<p>We wrote a tiny C program that you can use to get an &#8220;accessibility indicator&#8221; for any file on the system &#8211; it simply tries to open the filename or filenames you put on the command line, and reports the Windows error code if the file couldn&#8217;t be opened up for read access. </p>
<p>(The code below is in the public domain so you can do what you like with it, but you use it at your own risk.)</p>
<p>You don&#8217;t even need the Windows header files to compile it;  you just need to tell your compiler or linker that it needs <code>kernel32.dll</code> and <code>msvcrt.dll</code>:</p>
<pre style='line-height:1.7em'>
/* --- CHKIT.C --- */

void     *CreateFileA(char *name,unsigned mode,unsigned share,void *sec,unsigned disp,unsigned attr,void *tmpl);
int      CloseHandle(void *hnd);
unsigned GetLastError(void);
int      printf(char *fmt, ...);

int main(int argc, char **argv) {
   for (int i = 1; i &lt; argc; i++) {
      printf(&quot;Opening file [%s]\n&quot;,argv[i]);
      void *hnd = CreateFileA(argv[i],0x80000000L,0,0,3,0x80,0);
      if ((long int)hnd == -1) {
         printf(&quot;Failed (GetLastError=0x%08X)\n&quot;,GetLastError());
      } else {
         printf(&quot;Worked (handle=%ld)\n&quot;,(long int)hnd);
         CloseHandle(hnd);
      }
   }
   return 0;
}
</pre>
<p style='margin-top:2em'>From an elevated command prompt (one that is running with Administrator privilege), we get the following result:</p>
<pre style='line-height:1.7em'>
C:\Users\duck&gt; chkit C:\Windows\System32\config\SAM C:\Windows\System32\config\SYSTEM C:\Windows\System32\config\SECURITY
Opening file [C:\Windows\System32\config\SAM]
Failed (GetLastError=0x00000020)
Opening file [C:\Windows\System32\config\SYSTEM]
Failed (GetLastError=0x00000020)
Opening file [C:\Windows\System32\config\SECURITY]
Failed (GetLastError=0x00000020)
</pre>
<p style='margin-top:2em'>Error 0x20 stands for <code>ERROR_SHARING_VIOLATION</code>, described officially by Microsoft as &#8220;<em>The process cannot access the file because it is being used by another process.</em>&#8221;</p>
<p>So far, still good.</p>
<p>Let&#8217;s try again from a non-elevated command prompt, where we&#8217;re running as a regular user:</p>
<pre style='line-height:1.7em'>
C:\Users\duck&gt; chkit C:\Windows\System32\config\SAM
Opening file [C:\Windows\System32\config\SAM]
Failed (GetLastError=0x00000020)
</pre>
<p style='margin-top:2em'>Ooooer! That can&#8217;t be right!</p>
<p>We should have received Error 0x05, short for the self-explanatory <code>ERROR_ACCESS_DENIED</code>, right away.</p>
<p>Seeing Error 0x20 means that the program was allowed to have a go at opening the file, and failed at that point, instead of being blocked from even trying to access the file in the first place.</p>
<p>And if we look at the ACL (access control list) for the SAM hive file, for instance, using the <code>ICACLS</code> utility, we see that this behaviour is down to a security blunder:</p>
<pre style='line-height:1.7em'>
C:\Windows\System32&gt; icacls config\SAM
config\SAM BUILTIN\Administrators:(I)(F)
           NT AUTHORITY\SYSTEM:(I)(F)
           BUILTIN\Users:(I)(RX)    &lt;-- this is wrong - regular users should not have read access!
           APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES:(I)(RX)
           APPLICATION PACKAGE AUTHORITY\ALL RESTRICTED APPLICATION PACKAGES:(I)(RX)

Successfully processed 1 files; Failed processing 0 files
</pre>
<p style='margin-top:2em'>In other words, the SAM registry data (and the <code>SECURITY</code> and <code>SYSTEM</code> hive files, too) are protected at runtime against access by regular users because the files are in use elsewhere, not because the files are off-limits to regular users from the outset.</p>
<p>We need to fix that vulnerability, and Microsoft&#8217;s official workaround is to restrict the access control lists (ACLs) on everything in and below the <code>CONFIG</code> directory.</p>
<p>You need to be Administrator, and to make the following security change:</p>
<pre style='line-height:1.7em'>
C:\Users\duck&gt; icacls %windir%\system32\config\*.* /inheritance:e
processed file: C:\Windows\system32\config\BBI
[. . .]
processed file: C:\Windows\system32\config\SAM
[. . .]
processed file: C:\Windows\system32\config\SECURITY
[. . .]
processed file: C:\Windows\system32\config\SYSTEM
[. . .]
Successfully processed 45 files; Failed processing 0 files
</pre>
<p style='margin-top:2em'>Now, the ACL for the <code>SAM</code> file that we checked above looks much healthier:</p>
<pre style='line-height:1.7em'>
C:\Windows\System32&gt; icacls config\SAM
config\SAM NT AUTHORITY\SYSTEM:(I)(F)
           BUILTIN\Administrators:(I)(F)

Successfully processed 1 files; Failed processing 0 files
</pre>
<p style='margin-top:2em'>Also, if we try to open the live <code>SAM</code> registry hive file again from a non-Administrator command promtp, we no longer get Error 0x20.</p>
<p>We now get the more security-conscious Error 0x05, telling us <code>ACCESS_DENIED</code>:</p>
<pre style='line-height:1.7em'>
C:\Users\duck&gt; chkit C:\Windows\System32\config\SAM
Opening file [C:\Windows\System32\config\SAM]
Failed (GetLastError=0x00000005)
</pre>
<h2>Still not done!</h2>
<p>But that alone is not enough.</p>
<p>If you have any <em>system restore points</em> (also known as <em>Volume Shadow Copies</em>) on your computer, those restore points <b>include copies of your original <code>SAM</code>, <code>SECURITY</code> and <code>SYSTEM</code> registry hive file <b>with the old and insecure access control settings</b>.</p>
<p>In other words, any unprivileged user could just read out data such as your Windows access control secrets or password hashes from the shadow copies instead.</p>
<p>By the way, you may have one or more shadow copies on your computer even if you didn&#8217;t go to the System Protection menu yourself and click the <code>[Create]</code> button to generate one.</p>
<p>(A restore point is like an online snapshot or temporary backup that you can use to &#8220;rewind&#8221; your hard disk&#8217;s contents and recover an older version of your system if something breaks, for example after an update that didn&#8217;t work out.)</p>
<p>Restore points may have been made by IT at various times; also, system upgrades and even some security software may create restore points automatically for their own use.</p>
<p>You can check for the presence of shadow copies on your computer using the Volume Shadow Copy Service administrative command-line tool, <code>vssadmin</code>.</p>
<p>We&#8217;ve got one shadow copy (we created it on purpose for this article), as you can see here:</p>
<pre style='line-height:1.7em'>
C:\Users\duck&gt; vssadmin list shadows

vssadmin 1.1 - Volume Shadow Copy Service administrative command-line tool
(C) Copyright 2001-2013 Microsoft Corp.

Contents of shadow copy set ID: {. . .}
   Contained 1 shadow copies at creation time: 21/07/2021 14:58:05
      Shadow Copy ID: {. . .}
         Original Volume: (C:)\\?\Volume{. . .}\
         Shadow Copy Volume: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2  &lt;--this is the directory tree where the shadow file copies can be found
         Originating Machine: W10
         Service Machine: W10
         Provider: 'Microsoft Software Shadow Copy provider 1.0'
         Type: ClientAccessibleWriters
         Attributes: Persistent, Client-accessible, No auto release, Differential, Auto recovered
</pre>
<p style='margin-top:2em'>What this output tells us is that copies of the registry hive files, at the moment we created the restore point/shadow copy, can be found in this shadow directory:</p>
<pre style='line-height:1.7em'>
\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\Windows\System32\config
</pre>
<p style='margin-top:2em'>You simply take the root directory name of the shadow copy volume and add the original Windows filename to it, minus the drive letter, of course.</p>
<p>(In case you were wondering, the weird-looking prefix <code>\\?\</code> above tells Windows to treat this as a &#8220;wide&#8221; filename, by using two bytes for each character, even though it&#8217;s written as a regular ASCII text string with one byte per character. This allows filenames up to 32KB long instead of the usual ASCII filename limit of 260 characters.)</p>
<p>So, let&#8217;s try the <code>chkit</code> program on the shadow copies of the registry hive files, instead of on the live copies that gave us <code>SHARING_VIOLATION</code> and then <code>ACCESS_DENIED</code> errors above.</p>
<p>Using a non-Administrator command prompt, we get:</p>
<pre style='line-height:1.7em'>
C:\Users\duck&gt; chkit \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\Windows\System32\config\SAM
Opening file [\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\Windows\System32\config\SAM]
Worked (handle=136)
</pre>
<p style='margin-top:2em'>Simply put, we were able to get access to the SAM file (and likewise to other registry hive backups in the shadow copy directory) <strong>even though [a] the system was running and [b] we didn&#8217;t have Administrator powers</strong>.</p>
<h2>What to do?</h2>
<p>Microsoft&#8217;s <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36934" rel="nofollow">official workaround</a> is fairly easy:</p>
<ul>
<li><strong>Reset the ACLs on the live registry hive files using the ICACLS command</strong>, as shown above. This protects your system from now on.
<li><strong>Remove all existing restore points or shadow copies.</strong> This ensures no wrongly-secured files are left behind in a shadow copy directory.
<li><strong>Recreate a new restore point</strong>, if needed.
</ul>
<p>Of course, as Microsoft <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36934" rel="nofollow">wryly notes</a>, &#8220;<em>Deleting shadow copies could impact restore operations, including the ability to restore data with third-party backup applications.</em>&#8221;</p>
<p>That&#8217;s one reason why ransomware crooks almost always delete all your restore points just before they trash your network, to make recovery slower and harder.</p>
<p>In case you&#8217;re wondering, the quick way to zap all your restore points is to use the following command as an Administrator:</p>
<pre style='line-height:1.7em'>
C:\Users\duck&gt; vssadmin delete shadows /all
vssadmin 1.1 - Volume Shadow Copy Service administrative command-line tool
(C) Copyright 2001-2013 Microsoft Corp.

Do you really want to delete 1 shadow copies (Y/N): [N]? y

Successfully deleted 1 shadow copies.
</pre>
<p style='margin-top:2em'>In theory, we suspect that you could write a script or program to locate any insecure registry hive backups inside any of your shadow copy directories, and then set the ACLs on those individual files, thus leaving the rest of the restore point intact.</p>
<p>But we&#8217;ve not tried doing that, and we&#8217;re not sure if a restore point would still work properly if you modified its contents &#8220;unofficially&#8221; in this way, so we&#8217;re not going to recommend it.</p>
<hr style='margin:top'>
			</div> <!-- .entry-content -->
	<ul class="block social follow">
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon twitter"><use xlink:href="#twitter"></use></svg>
			<p>Follow <strong><a href="https://twitter.com/nakedsecurity">@NakedSecurity on Twitter</a></strong> for the latest computer security news.</p>
		</li>
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon instagram"><use xlink:href="#instagram"></use></svg>
			<p>Follow <strong><a href="https://www.instagram.com/nakedsecurity/">@NakedSecurity on Instagram</a></strong> for exclusive pics, gifs, vids and LOLs!</p>
		</li>
	</ul>
</article><!-- #post-## -->

		<div class="free-tools-block">
			<h2 class="block-title">Free tools</h2>

<div class="ns-free-tools">
	<div class="ns-free-tools__item ns-free-tools__item--sophos-home">
		<a class="ns-free-tools__link" href="https://home.sophos.com/en-us.aspx?cmp=701j0000001eLpnAAE">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/sophos-home@2x.png" alt="Sophos Home" class="ns-free-tools__image" width="166" height="100">
			<h4 class="ns-free-tools__title">
				Sophos Home			</h4>
			<div class="ns-free-tools__sub-title">
				Protect personal PCs and Macs			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--hitman-pro">
		<a class="ns-free-tools__link" href="https://www.hitmanpro.com/en-us/hmp.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/hitman-pro@2x.png" alt="Hitman Pro" class="ns-free-tools__image" width="154" height="100">
			<h4 class="ns-free-tools__title">
				Hitman Pro			</h4>
			<div class="ns-free-tools__sub-title">
				Find and remove malware			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--intercept-x">
		<a class="ns-free-tools__link" href="https://www.sophos.com/en-us/products/free-tools/sophos-mobile-security-free-edition.aspx">
			<img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/free-tools/mobile-security-android@2x.png" alt="Sophos Intercept X for Mobile" class="ns-free-tools__image" width="96" height="110">
			<h4 class="ns-free-tools__title">
				Intercept X for Mobile			</h4>
			<div class="ns-free-tools__sub-title">
				Protect Android devices			</div>
		</a>
	</div>
</div>
		</div>

			<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2021/07/20/apple-iphone-patches-are-out-no-news-if-recent-wi-fi-bug-is-fixed/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> Apple iPhone patches are out &#8211; no news if recent Wi-Fi bug is fixed</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2021/07/22/s3-ep42-viruses-nightmares-patches-rewards-and-scammers-podcast/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> S3 Ep42: Viruses, Nightmares, patches, rewards and scammers [Podcast]</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	
	</main><!-- #main -->

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<section class="comments-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

			
<div id="comments" class="comments-area">

			<h2 class="comments-title">
			18 comments on &ldquo;<span>Windows &#8220;HiveNightmare&#8221; bug could leak passwords &#8211; here&#8217;s what to do!</span>&rdquo;		</h2>

		<ol class="comment-list">
					<li id="comment-6320503" class="comment even thread-even depth-1 parent">
			<article id="div-comment-6320503" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/cb0a9863e0a7fd4d4e78e553b094cdae?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/cb0a9863e0a7fd4d4e78e553b094cdae?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">George</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/#comment-6320503"><time datetime="2021-07-21T18:13:08+01:00">July 21, 2021 at 6:13 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thank you Mr. Ducklin for your invaluable warnings.<br />
I am always curious whether theses flaws need to be addressed by home users of W10 etc, and what is the vector for getting infected?<br />
Thanks again.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6320503"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6320503={"id":7238218,"unique_id":"wp-comment-6320503","title":"Thank%20you%20Mr.%20Ducklin%20for%20your%20invaluable%20warnings.I%20am%20always%20curious%20whether%20theses%20flaws%20need%20to%20be%20addressed%20by%20home%20users%20of%20W10%20etc%2C%20and%20what%20is%20the%20vector%20for%20getting%20infected%3FThanks%20again%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/07\/21\/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do\/#comment-6320503","item_id":"_comm_6320503"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/?replytocom=6320503#respond' data-commentid="6320503" data-postid="596510" data-belowelement="div-comment-6320503" data-respondelement="respond" data-replyto="Reply to George" aria-label='Reply to George'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6320512" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2 parent">
			<article id="div-comment-6320512" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/#comment-6320512"><time datetime="2021-07-21T18:58:33+01:00">July 21, 2021 at 6:58 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>You might as well address this one on your home computer if you can&#8230; this isn&#8217;t so much a vector for getting infected (where crooks could implant malware in the first place), but it&#8217;s a nasty trick by which a crook who has already got a foothold on your computer by some other means (e.g. phishing, browser bug, rogue attachment) might grant themselves the keys to the whole castle and therefore make a bad attack much worse, or extend their criminal reach from your laptop to other users or devices on your network.</p>
<p>A castle doesn&#8217;t have to be large and extensive to be valuable and important!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6320512"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6320512={"id":7238218,"unique_id":"wp-comment-6320512","title":"You%20might%20as%20well%20address%20this%20one%20on%20your%20home%20computer%20if%20you%20can...%20this%20isn%26%23039%3Bt%20so%20much%20a%20vector%20for%20getting%20infected%20%28where%20crooks%20could%20implant%20malware%20in%20the%20first%20place%29%2C%20but%20it%26%23039%3Bs%20a%20nasty%20t%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/07\/21\/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do\/#comment-6320512","item_id":"_comm_6320512"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/?replytocom=6320512#respond' data-commentid="6320512" data-postid="596510" data-belowelement="div-comment-6320512" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6320540" class="comment even depth-3">
			<article id="div-comment-6320540" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/cb0a9863e0a7fd4d4e78e553b094cdae?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/cb0a9863e0a7fd4d4e78e553b094cdae?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">George</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/#comment-6320540"><time datetime="2021-07-21T21:46:41+01:00">July 21, 2021 at 9:46 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thank you!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6320540"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6320540={"id":7238218,"unique_id":"wp-comment-6320540","title":"Thank%20you%21%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/07\/21\/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do\/#comment-6320540","item_id":"_comm_6320540"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/?replytocom=6320540#respond' data-commentid="6320540" data-postid="596510" data-belowelement="div-comment-6320540" data-respondelement="respond" data-replyto="Reply to George" aria-label='Reply to George'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6320514" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-6320514" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/0f680abd651ff2e454d715b053aab930?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0f680abd651ff2e454d715b053aab930?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Rhonda Caywood</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/#comment-6320514"><time datetime="2021-07-21T19:01:50+01:00">July 21, 2021 at 7:01 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I think Microsoft cannot produce a clean product. I do have a question. If I understand correctly and I probably don&#8217;t is Hive backing up all files on my computer or just registry files? I am a home user, Windows 10 V 20H2.<br />
The reason I ask, I have had to copy my files then download new files a couple of years ago when Microsoft Support (non-support) downloaded Windows 10 and Office 365 to my existing computer. Problems from day 1 and they haven&#8217;t gone away yet and it&#8217;s been two years.<br />
I&#8217;m just wondering if this program could be beneficial for me in terms of a way to back up my files again. The external hard drive gave out and I didn&#8217;t know for how long, I don&#8217;t know? Having numerous problems updating and installing Windows updates. I dread calling MS Support, I really don&#8217;t want to. Anyway, that is my question, and remember I am not an IT person who uses the computereze language so this may be an out in left field question.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6320514"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6320514={"id":7238218,"unique_id":"wp-comment-6320514","title":"I%20think%20Microsoft%20cannot%20produce%20a%20clean%20product.%20I%20do%20have%20a%20question.%20If%20I%20understand%20correctly%20and%20I%20probably%20don%26%23039%3Bt%20is%20Hive%20backing%20up%20all%20files%20on%20my%20computer%20or%20just%20registry%20files%3F%20I%20am%20a%20h%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/07\/21\/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do\/#comment-6320514","item_id":"_comm_6320514"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/?replytocom=6320514#respond' data-commentid="6320514" data-postid="596510" data-belowelement="div-comment-6320514" data-respondelement="respond" data-replyto="Reply to Rhonda Caywood" aria-label='Reply to Rhonda Caywood'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6320526" class="comment byuser comment-author-pducklin bypostauthor even depth-2">
			<article id="div-comment-6320526" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/#comment-6320526"><time datetime="2021-07-21T20:02:27+01:00">July 21, 2021 at 8:02 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>System restore points aren&#8217;t offline backups like the ones you might make to an external drive. They backup large parts of your system onto the local drive so you can &#8220;unroll&#8221; or &#8220;rewind&#8221; to known-good points, for example after a failed update.</p>
<p>The problem with relying on restore points as a general backup method is that you can&#8217;t unplug them and keep them safe in the cupboard in case you need to restore your data to a completely different computer (e.g. if your usual one gets lost, damaged or stolen), and the files are sitting there along with all your other files where criminals who want to do you harm can delete them deliberately. Ransomware criminals, notably, wipe out your restore points before scrambling your files, thus making recovery that bit harder.</p>
<p>If you are serious about protectinng your most critical data, I recommend not relying on &#8220;online/on-computer&#8221; backups. There&#8217;s a 3-2-1 rule that says to aim for 3 copies of your data at any time (the live one and two backup copies), using 2 different technologies (e.g. cloud and removable drive) so that if one turns out to have a bug or problem the other is unlikely to share it, and keep 1 of them offline and ideally offsite (if you have backup software that lets you encrypt your backups then you could just consider leaving a USB disk at a friend&#8217;s house, and keeping a drive for them in return).</p>
<p>I am not an expert in non-business-grade Windows backup utilities &#8211; it&#8217;s best to find a trustworthy friend and ask them to share their experiences &#8211; so I can&#8217;t really advise. Mac users may pay a bit more for Apple&#8217;s laptop products, but they all come with FileVault (can encrypt both local and removable drives) and Time Machine (easy-to-use backup utility) built in. On Windows, the non-Enterprise versions don&#8217;t have the same features as the Enterprise ones&#8230;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6320526"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6320526={"id":7238218,"unique_id":"wp-comment-6320526","title":"System%20restore%20points%20aren%26%23039%3Bt%20offline%20backups%20like%20the%20ones%20you%20might%20make%20to%20an%20external%20drive.%20They%20backup%20large%20parts%20of%20your%20system%20onto%20the%20local%20drive%20so%20you%20can%20%26quot%3Bunroll%26quot%3B%20or%20%26quot%3Brewind%26quot%3B%20to%20know%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/07\/21\/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do\/#comment-6320526","item_id":"_comm_6320526"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/?replytocom=6320526#respond' data-commentid="6320526" data-postid="596510" data-belowelement="div-comment-6320526" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6320587" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-6320587" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/518526723335490b0dc5c798e8f6d731?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/518526723335490b0dc5c798e8f6d731?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Alan Leghart</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/#comment-6320587"><time datetime="2021-07-22T02:42:11+01:00">July 22, 2021 at 2:42 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Important to note that trying to delete VSS shadow copies may be blocked by anti-ransomware security software.  It&#8217;s good, expected behavior.  That&#8217;s why Microsoft does not list the command in their notice&#8230;YMMV if it&#8217;s allowed, and how to execute.<br />
    It&#8217;s probably something worth significant debate before scripting and deploying.  It would cause chaos on file servers that expose shadow copies to users for self-service restore.<br />
   Test, pilot, communicate.  Anyone monitoring that pane of glass will surely spit their [insert beverage here] when 1,000 detections of ransomware are triggered by a hastily-scripted remediation.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6320587"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6320587={"id":7238218,"unique_id":"wp-comment-6320587","title":"Important%20to%20note%20that%20trying%20to%20delete%20VSS%20shadow%20copies%20may%20be%20blocked%20by%20anti-ransomware%20security%20software.%20%20It%26%23039%3Bs%20good%2C%20expected%20behavior.%20%20That%26%23039%3Bs%20why%20Microsoft%20does%20not%20list%20the%20command%20in%20th%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/07\/21\/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do\/#comment-6320587","item_id":"_comm_6320587"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/?replytocom=6320587#respond' data-commentid="6320587" data-postid="596510" data-belowelement="div-comment-6320587" data-respondelement="respond" data-replyto="Reply to Alan Leghart" aria-label='Reply to Alan Leghart'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6320645" class="comment byuser comment-author-pducklin bypostauthor even depth-2">
			<article id="div-comment-6320645" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/#comment-6320645"><time datetime="2021-07-22T10:23:34+01:00">July 22, 2021 at 10:23 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Technically, they wouldn’t be “ransomware detections”, so you’d hope that anyone who had set up an alarm to trigger on shadow copy deletes would know to expect that alarm when actually doing one. </p>
<p>As we said in the article, there is almost certainly a better way of dealing with a few incorrect shadow copy file ACLs than deleting the whole shadow copy&#8230; but we don’t know exactly how those ACLs are recorded in the shadow copies, or how they are regenerated when a shadow copy is restored, so fiddling directly with individual items in the shadow copy directory tree could be the start of real trouble if you later restore and rely upon that data.</p>
<p>Presumably, Microsoft will come up with an automatic “permission fixer” tool when this bug is formally addressed&#8230;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6320645"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6320645={"id":7238218,"unique_id":"wp-comment-6320645","title":"Technically%2C%20they%20wouldnt%20be%20ransomware%20detections%2C%20so%20youd%20hope%20that%20anyone%20who%20had%20set%20up%20an%20alarm%20to%20trigger%20on%20shadow%20copy%20deletes%20would%20know%20to%20expect%20that%20alarm%20when%20actually%20doing%20one.%20As%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/07\/21\/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do\/#comment-6320645","item_id":"_comm_6320645"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/?replytocom=6320645#respond' data-commentid="6320645" data-postid="596510" data-belowelement="div-comment-6320645" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6320622" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-6320622" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/d5792fccc08a4f1d17f5b25fea568ec5?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d5792fccc08a4f1d17f5b25fea568ec5?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Ian Young</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/#comment-6320622"><time datetime="2021-07-22T08:16:06+01:00">July 22, 2021 at 8:16 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Paul,<br />
An interesting article, with an easy to use instructions. Thank you. Are there any know exploits of this?<br />
Cheers Ian</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6320622"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6320622={"id":7238218,"unique_id":"wp-comment-6320622","title":"Hi%20Paul%2CAn%20interesting%20article%2C%20with%20an%20easy%20to%20use%20instructions.%20Thank%20you.%20Are%20there%20any%20know%20exploits%20of%20this%3F%20Cheers%20Ian%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/07\/21\/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do\/#comment-6320622","item_id":"_comm_6320622"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/?replytocom=6320622#respond' data-commentid="6320622" data-postid="596510" data-belowelement="div-comment-6320622" data-respondelement="respond" data-replyto="Reply to Ian Young" aria-label='Reply to Ian Young'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6320647" class="comment byuser comment-author-pducklin bypostauthor even depth-2">
			<article id="div-comment-6320647" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/#comment-6320647"><time datetime="2021-07-22T10:36:36+01:00">July 22, 2021 at 10:36 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Microsoft’s bulletin (linked to above) currently [2021-07-22T09:30Z] says “Exploitation &#8211; No”, which I think is shorthand for “Seen in the wild in use by actual cybercrooks? Not so far.”</p>
<p>However, this is trivial to exploit, and there is at least one “proof-of-concept” exploit tool floating around that will search for and extract hidden registry hives for you automatically if it can.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6320647"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6320647={"id":7238218,"unique_id":"wp-comment-6320647","title":"Microsofts%20bulletin%20%28linked%20to%20above%29%20currently%20%26%23091%3B2021-07-22T09%3A30Z%26%23093%3B%20says%20Exploitation%20-%20No%2C%20which%20I%20think%20is%20shorthand%20for%20Seen%20in%20the%20wild%20in%20use%20by%20actual%20cybercrooks%3F%20Not%20so%20far.However%2C%20this%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/07\/21\/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do\/#comment-6320647","item_id":"_comm_6320647"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/?replytocom=6320647#respond' data-commentid="6320647" data-postid="596510" data-belowelement="div-comment-6320647" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6320633" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-6320633" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/c7e43b06500cbc34a9600eb8affe49c6?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c7e43b06500cbc34a9600eb8affe49c6?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Tom Bartlett</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/#comment-6320633"><time datetime="2021-07-22T09:12:13+01:00">July 22, 2021 at 9:12 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Any news if MS are planning to address this in a future windows update?</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6320633"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6320633={"id":7238218,"unique_id":"wp-comment-6320633","title":"Any%20news%20if%20MS%20are%20planning%20to%20address%20this%20in%20a%20future%20windows%20update%3F%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/07\/21\/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do\/#comment-6320633","item_id":"_comm_6320633"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/?replytocom=6320633#respond' data-commentid="6320633" data-postid="596510" data-belowelement="div-comment-6320633" data-respondelement="respond" data-replyto="Reply to Tom Bartlett" aria-label='Reply to Tom Bartlett'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6320648" class="comment byuser comment-author-pducklin bypostauthor even depth-2">
			<article id="div-comment-6320648" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/#comment-6320648"><time datetime="2021-07-22T10:44:34+01:00">July 22, 2021 at 10:44 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>The fact that it has a CVE and has already been documented as a security flaw suggests that the answer is “Yes”. </p>
<p>Fixing the root cause (wrong permissions of some files under %windir% is easy); I assume that it should be equally easy for Microsoft to retrospectively “Fox” the file metadata in local shadow copies without breaking anything.</p>
<p>(Directly messing with the shadow copy files yourself is *possible* but you run the risk of creating corrupted shadow copies that won’t restore properly&#8230; imagine the harm that could be done if you ended up with a shadow copy that would restore everything to a previous state *except* the SAM file, leaving you with old data but new security hashes etc. You could end up with some really subtle and hard-to-track down reliability problems!)</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6320648"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6320648={"id":7238218,"unique_id":"wp-comment-6320648","title":"The%20fact%20that%20it%20has%20a%20CVE%20and%20has%20already%20been%20documented%20as%20a%20security%20flaw%20suggests%20that%20the%20answer%20is%20Yes.%20Fixing%20the%20root%20cause%20%28wrong%20permissions%20of%20some%20files%20under%20%25windir%25%20is%20easy%29%3B%20I%20as%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/07\/21\/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do\/#comment-6320648","item_id":"_comm_6320648"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/?replytocom=6320648#respond' data-commentid="6320648" data-postid="596510" data-belowelement="div-comment-6320648" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6320637" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-6320637" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Anonymous IT Manager Coward</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/#comment-6320637"><time datetime="2021-07-22T09:51:47+01:00">July 22, 2021 at 9:51 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Paul,</p>
<p>I don&#8217;t have time to write a script, but we have 75 or so Domain Machines to sanitise, and the same number again of off domain laptops&#8230;</p>
<p>Do you know of any tools that could automate the work of sanitsing all these machines?</p>
<p>Failing that, is access to these files something that Sophos will detect and protect against?</p>
<p>Thanks!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6320637"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6320637={"id":7238218,"unique_id":"wp-comment-6320637","title":"Hi%20Paul%2CI%20don%26%23039%3Bt%20have%20time%20to%20write%20a%20script%2C%20but%20we%20have%2075%20or%20so%20Domain%20Machines%20to%20sanitise%2C%20and%20the%20same%20number%20again%20of%20off%20domain%20laptops...Do%20you%20know%20of%20any%20tools%20that%20could%20automate%20the%20w%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/07\/21\/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do\/#comment-6320637","item_id":"_comm_6320637"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/?replytocom=6320637#respond' data-commentid="6320637" data-postid="596510" data-belowelement="div-comment-6320637" data-respondelement="respond" data-replyto="Reply to Anonymous IT Manager Coward" aria-label='Reply to Anonymous IT Manager Coward'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6320650" class="comment byuser comment-author-pducklin bypostauthor even depth-2">
			<article id="div-comment-6320650" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/#comment-6320650"><time datetime="2021-07-22T10:55:31+01:00">July 22, 2021 at 10:55 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>It’s tricky for third party software to “detect and protect” against this at all, let alone reliably, because it’s not like (say) a buffer overflow where a program is being forced to do something that is never supposed to happen. (There’s also the risk that actively trying to block, say, non-admins from reading out files from shadow copies could introduce subtle and troublesome problems of its own. Blocking dangerous programs from running, or completely denying access to booby-trapped documents, is all very well&#8230; but potentially getting in the way of otherwise innocent behaviour could cause more trouble than it solves :&#045;)</p>
<p>If you are willing to sacrifice all your shadow copies then you could just use a tool like PSEXEC (from Microsoft Sysinternals) to automate running the relevant commands across your network, but how to do that with literally no scripting I don’t know.</p>
<p>Any readers out there who can help with a way to automate this using a standard Microsoft tool?</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6320650"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6320650={"id":7238218,"unique_id":"wp-comment-6320650","title":"Its%20tricky%20for%20third%20party%20software%20to%20detect%20and%20protect%20against%20this%20at%20all%2C%20let%20alone%20reliably%2C%20because%20its%20not%20like%20%28say%29%20a%20buffer%20overflow%20where%20a%20program%20is%20being%20forced%20to%20do%20something%20tha%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/07\/21\/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do\/#comment-6320650","item_id":"_comm_6320650"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/?replytocom=6320650#respond' data-commentid="6320650" data-postid="596510" data-belowelement="div-comment-6320650" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6320657" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-6320657" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Anonymous IT Manager Coward</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/#comment-6320657"><time datetime="2021-07-22T11:44:22+01:00">July 22, 2021 at 11:44 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks Paul,</p>
<p>OK, how about if I stick </p>
<p>    @echo off<br />
    icacls %windir%\system32\config\*.* /inheritance:e<br />
    vssadmin delete shadows /all /quiet</p>
<p>in a batch file on a public share, and then create a GPO for the workstations OU to push out scheduled task, set to run once, to run the batch file above, using highest privileges?</p>
<p>That should work, wouldn&#8217;t you think?</p>
<p>Thanks.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6320657"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6320657={"id":7238218,"unique_id":"wp-comment-6320657","title":"Thanks%20Paul%2COK%2C%20how%20about%20if%20I%20stick%20%20%20%20%20%40echo%20off%20%20%20%20icacls%20%25windir%25system32config%2A.%2A%20%2Finheritance%3Ae%20%20%20%20vssadmin%20delete%20shadows%20%2Fall%20%2Fquietin%20a%20batch%20file%20on%20a%20public%20share%2C%20and%20then%20create%20a%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/07\/21\/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do\/#comment-6320657","item_id":"_comm_6320657"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/?replytocom=6320657#respond' data-commentid="6320657" data-postid="596510" data-belowelement="div-comment-6320657" data-respondelement="respond" data-replyto="Reply to Anonymous IT Manager Coward" aria-label='Reply to Anonymous IT Manager Coward'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6320682" class="comment byuser comment-author-pducklin bypostauthor even depth-2">
			<article id="div-comment-6320682" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/#comment-6320682"><time datetime="2021-07-22T14:41:14+01:00">July 22, 2021 at 2:41 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>The main thing about doing that is: are you sure you are happy with it/is it a safe thing to do given your existing backup and security procedures/will anyone else in the company will have a conniption about losing all their restore points from every computer&#8230;</p>
<p>Ransomware crooks almost always delete your shadow copies to *reduce* security before activating the finale of their attack&#8230; so there is certain irony in deleting your own shadow copies to *increase* security in case of at attack. Just make sure that [a] it is safe for your and [b] you won&#8217;t needlessly create anxiety amongst your users when that sort of thing is best avoided.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6320682"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6320682={"id":7238218,"unique_id":"wp-comment-6320682","title":"The%20main%20thing%20about%20doing%20that%20is%3A%20are%20you%20sure%20you%20are%20happy%20with%20it%2Fis%20it%20a%20safe%20thing%20to%20do%20given%20your%20existing%20backup%20and%20security%20procedures%2Fwill%20anyone%20else%20in%20the%20company%20will%20have%20a%20conn%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/07\/21\/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do\/#comment-6320682","item_id":"_comm_6320682"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/?replytocom=6320682#respond' data-commentid="6320682" data-postid="596510" data-belowelement="div-comment-6320682" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6320711" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-6320711" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/d6fbe92a62cbb08547a6e97ca960f55f?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d6fbe92a62cbb08547a6e97ca960f55f?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Tom</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/#comment-6320711"><time datetime="2021-07-22T18:12:43+01:00">July 22, 2021 at 6:12 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I get the feeling that Windows is just not the most secure OS,</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6320711"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6320711={"id":7238218,"unique_id":"wp-comment-6320711","title":"I%20get%20the%20feeling%20that%20Windows%20is%20just%20not%20the%20most%20secure%20OS%2C%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/07\/21\/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do\/#comment-6320711","item_id":"_comm_6320711"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/?replytocom=6320711#respond' data-commentid="6320711" data-postid="596510" data-belowelement="div-comment-6320711" data-respondelement="respond" data-replyto="Reply to Tom" aria-label='Reply to Tom'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6320719" class="comment byuser comment-author-pducklin bypostauthor even depth-2 parent">
			<article id="div-comment-6320719" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/#comment-6320719"><time datetime="2021-07-22T19:37:26+01:00">July 22, 2021 at 7:37 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Maybe it’s just getting a lot of exuberantly negative publicity right now? Apple just patched dozens of bugs in its latest update; Linux just dealt with a similar sort of “EoP” bug&#8230; hard to say whether any one of them really deserves the title “first (or last) amongst equals”&#8230;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6320719"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6320719={"id":7238218,"unique_id":"wp-comment-6320719","title":"Maybe%20its%20just%20getting%20a%20lot%20of%20exuberantly%20negative%20publicity%20right%20now%3F%20Apple%20just%20patched%20dozens%20of%20bugs%20in%20its%20latest%20update%3B%20Linux%20just%20dealt%20with%20a%20similar%20sort%20of%20EoP%20bug...%20hard%20to%20say%20wh%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/07\/21\/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do\/#comment-6320719","item_id":"_comm_6320719"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/?replytocom=6320719#respond' data-commentid="6320719" data-postid="596510" data-belowelement="div-comment-6320719" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6320734" class="comment odd alt depth-3">
			<article id="div-comment-6320734" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/e3adda6e8ee311ea8372deb189b2b89f?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e3adda6e8ee311ea8372deb189b2b89f?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">SquirrelyDan</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/#comment-6320734"><time datetime="2021-07-22T21:25:19+01:00">July 22, 2021 at 9:25 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>That&#8217;s what I appreciates about you, you are so even keeled and keep it in perspective</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6320734"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6320734={"id":7238218,"unique_id":"wp-comment-6320734","title":"That%26%23039%3Bs%20what%20I%20appreciates%20about%20you%2C%20you%20are%20so%20even%20keeled%20and%20keep%20it%20in%20perspective%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/07\/21\/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do\/#comment-6320734","item_id":"_comm_6320734"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/?replytocom=6320734#respond' data-commentid="6320734" data-postid="596510" data-belowelement="div-comment-6320734" data-respondelement="respond" data-replyto="Reply to SquirrelyDan" aria-label='Reply to SquirrelyDan'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">What do you think? <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2021/07/21/windows-hivenightmare-bug-could-leak-passwords-heres-what-to-do/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://nakedsecurity.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='596510' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="cbdaddd923" /></p><input type="hidden" id="ak_js" name="ak_js" value="15"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->
		<div class="comments-widget-area">
					</div>
	
	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	

	<section class="recommended-panel">
	<div class="container">
	<div class="panel-content ">

		<h3 class="block-title">Recommended reads</h3>
	<div class="blocks">
		<article id="post-582311" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/05/11/apple-airtag-jailbroken-already-hacked-in-rickroll-attack/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/05/airtag-1200.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">May</span><span class="day">11</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">9</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/05/11/apple-airtag-jailbroken-already-hacked-in-rickroll-attack/" rel="bookmark">Apple AirTag jailbroken already &#8211; hacked in rickroll attack</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-596298" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/07/14/home-delivery-scams-get-smarter-dont-get-caught-out/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/07/hd-1200-2.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Jul</span><span class="day">14</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">15</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/07/14/home-delivery-scams-get-smarter-dont-get-caught-out/" rel="bookmark">Home delivery scams get smarter &#8211; don&#8217;t get caught out</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-578848" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/04/28/gamers-update-nvidia-patches-gpu-driver-kernel-escalation-bugs/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/04/nvidia-1200-1.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Apr</span><span class="day">28</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">2</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/04/28/gamers-update-nvidia-patches-gpu-driver-kernel-escalation-bugs/" rel="bookmark">Gamers update! Nvidia patches GPU driver kernel escalation bugs</a></h3>	</div>
</article> <!-- .card-article -->
	</div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="footer-container">
			<a href="#" class="js-collapse-footer"><svg style="height: 20px" viewBox="0 0 132 24" class="block icon sophos"><use xlink:href="#sophos"></use></svg></a>
			<div id="collapseFooter" class="blocks">
				<div class="sophos block">
					<ul id="menu-footer-primary" class="primary menu"><li id="menu-item-306737" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306737"><a href="https://nakedsecurity.sophos.com/about/">About Naked Security</a></li>
<li id="menu-item-306754" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306754"><a href="https://www.sophos.com/en-us/company.aspx">About Sophos</a></li>
<li id="menu-item-306747" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306747"><a href="https://nakedsecurity.sophos.com/send-us-a-tip/">Send us a tip</a></li>
<li id="menu-item-323171" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323171"><a href="/cookies-and-scripts/">Cookies</a></li>
<li id="menu-item-323170" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323170"><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
<li id="menu-item-323169" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323169"><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
</ul>				</div>
										<div class="news block">
							<ul id="menu-products-column-one" class="small menu"><li id="menu-item-306998" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306998"><a href="https://www.sophos.com/en-us/products/intercept-x.aspx">Intercept X</a></li>
<li id="menu-item-440801" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440801"><a href="https://www.sophos.com/en-us/products/server-security.aspx">Intercept X for Server</a></li>
<li id="menu-item-440802" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440802"><a href="https://www.sophos.com/en-us/products/mobile-control.aspx">Intercept X for Mobile</a></li>
</ul>						</div>
											<div class="products block">
							<ul id="menu-products-column-two" class="small menu"><li id="menu-item-440803" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440803"><a href="https://www.sophos.com/en-us/products/next-gen-firewall.aspx">XG Firewall</a></li>
<li id="menu-item-440805" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440805"><a href="https://www.sophos.com/en-us/products/sophos-email.aspx">Sophos Email</a></li>
<li id="menu-item-440804" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440804"><a href="https://www.sophos.com/en-us/products/secure-wifi.aspx">Sophos Wireless</a></li>
</ul>						</div>
											<div class="threats block">
							<ul id="menu-server-protection" class="small menu"><li id="menu-item-440806" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440806"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx">Managed Threat Response</a></li>
<li id="menu-item-448404" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-448404"><a href="https://www.sophos.com/en-us/products/cloud-optix.aspx">Cloud Optix</a></li>
<li id="menu-item-440807" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440807"><a href="https://www.sophos.com/en-us/products/phish-threat.aspx">Phish Threat</a></li>
</ul>						</div>
								</div>
			<ul class="block social footer">
				<li class="twitter"><a rel="nofollow" href="https://twitter.com/NakedSecurity" title="Follow our team of security experts on Twitter"><svg style="height: 14px" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
				<li class="facebook"><a rel="nofollow" href="https://www.facebook.com/SophosSecurity" title="Join over 250,000 people in our Facebook community"><svg style="height: 14px" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
				<li class="instagram"><a rel="nofollow" href="https://www.instagram.com/nakedsecurity/" title="Follow Naked Security on Instagram"><svg style="height: 14px" viewBox="0 0 100 100" class="icon instagram"><use xlink:href="#instagram"></use></svg></a></li>
				<li class="linkedin"><a rel="nofollow" href="https://www.linkedin.com/company/5053/" title="Join the naked security discussion group on LinkedIn"><svg style="height: 14px" viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
				<li class="rss"><a rel="nofollow" href="/feed" title="Subscribe to our RSS feed"><svg style="height: 14px" viewBox="0 0 100 100" class="icon rss"><use xlink:href="#rss"></use></svg></a></li>
			</ul>

							<div class="vip-powered-wpcom">
					<span class="copyright">© 1997 - 2021 Sophos Ltd.</span>
					All rights reserved.
					Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=nakedsecurity.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>				</div>
					</div>
		<script type="text/javascript">
			window.cookieconsent_options = {
				"message":"This site uses cookies. By continuing to browse the site you are agreeing to our use of cookies.",
				"dismiss":"Got it!",
				"learnMore":"Learn More",
				"link":"/cookies-and-scripts",
				"theme":"https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/css/sophos.css"};
		</script>
	</footer><!-- #colophon -->
</div><!-- #page -->
<div id="survey-wrapper" class="mfp-hide"><div class="pd-embed" id="pd_1499706777" data-settings=""></div></div>
<script id='child-js-plugins-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"0","nextLink":""};
</script>
<script id='child-js-core-js-extra'>
var Sophos = {"ajaxurl":"https:\/\/nakedsecurity.sophos.com\/wp-admin\/admin-ajax.php","nonce":"7bf72ba31d"};
</script>
<script type='text/javascript' src='https://nakedsecurity.sophos.com/_static/??-eJyNjkEOwiAQRS8kHamBuDEexVg6WpAZCANpvL3E2MSFC5fz/3v5A2tWLnFFrlAXJBSQlJckjKuoca8NBIEc292zDEF28JfgUsGN9uximzv3zom6qQrm+BzI8y+on0gTzt/9NklNfZ6B68MLYYVLd+GWCnX2TCdtR3u05qBNeAERs094'></script>
<script src='https://stats.wp.com/e-202129.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.9.1',blog:'166161173',post:'596510',tz:'1',srv:'nakedsecurity.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161173', '596510' ]);
</script>
</body>
</html>
