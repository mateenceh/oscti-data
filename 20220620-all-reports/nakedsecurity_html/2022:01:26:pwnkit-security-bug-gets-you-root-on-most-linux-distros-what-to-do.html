<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="RHQeasQqjasbRt5asY6atZYbs5tr10gFBevDt2HRhW0" />
<link rel="pingback" href="https://nakedsecurity.sophos.com/xmlrpc.php">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5VK6LTK');</script>
<!-- End Google Tag Manager -->

<meta name="description" content="An elevation of privilege bug that could let a &quot;mostly harmless&quot; user give themselves an instant root shell" />
<meta name="keywords" content="linux, vulnerability, cve-2021-4034, eop, linux, pkexec, pwnkit" />
<title>&#8220;PwnKit&#8221; security bug gets you root on most Linux distros &#8211; what to do &#8211; Naked Security</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="I9dHFo-YhnK2MfAHn-20V4GnWrOttVUYyISGamyU41M" />
<meta name="msvalidate.01" content="7D8D1FA2892142B1543D2CBCD07FB88F" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Feed" href="https://nakedsecurity.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Comments Feed" href="https://nakedsecurity.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; &#8220;PwnKit&#8221; security bug gets you root on most Linux distros &#8211; what to do Comments Feed" href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/feed/" />
<link rel='stylesheet' id='all-css-0' href='https://nakedsecurity.sophos.com/_static/??-eJyNy0EKgCAQheELZYNRuYrOYjrE1GjhGOHtaxPUruXPex+cu6Lo+PAo4ETAk2SYeHOrYpqSTQUkF8Y6UKzvQwVvsQgE9GSRMWDMn9jZFkyKcbau/OP39u4HjWHQfWt63bWNuQCHokGs' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='global-styles-inline-css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel='stylesheet' id='all-css-2' href='https://nakedsecurity.sophos.com/_static/??-eJyNjEsOwjAMBS+E46aifBaIs1jBIkA+Vu2o4vaEih2b6u1GMw8XgVCLcTG0yJkVtUqsWnhRGAc/odo7sQuqO9woQyJjta1N15BuzuLMZBBbl2dHWf763EBSuz+K4pNNKLzAD+64HvzAt7nmiz/s+/x4On8AdfZQfw==' type='text/css' media='all' />
<script type="text/javascript" src="https://nakedsecurity.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZibmZoamJkXkWAK+JIiM=" ></script><link rel="https://api.w.org/" href="https://nakedsecurity.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://nakedsecurity.sophos.com/wp-json/wp/v2/posts/669123" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://nakedsecurity.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://nakedsecurity.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.9.2" />
<link rel="canonical" href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/" />
<link rel='shortlink' href='https://nakedsecurity.sophos.com/?p=669123' />
<link rel="alternate" type="application/json+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2022%2F01%2F26%2Fpwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2022%2F01%2F26%2Fpwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style>
	<link rel="amphtml" href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="&#8220;PwnKit&#8221; security bug gets you root on most Linux distros &#8211; what to do" />
<meta property="og:url" content="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/" />
<meta property="og:description" content="An elevation of privilege bug that could let a &#8220;mostly harmless&#8221; user give themselves a instant root shell" />
<meta property="article:published_time" content="2022-01-26T19:58:32+00:00" />
<meta property="article:modified_time" content="2022-01-31T15:23:17+00:00" />
<meta property="og:site_name" content="Naked Security" />
<meta property="og:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/01/pwnkit-1200.png?w=775" />
<meta property="og:image:secure_url" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/01/pwnkit-1200.png?w=775" />
<meta property="og:image:width" content="775" />
<meta property="og:image:height" content="405" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:creator" content="@NakedSecurity" />
<meta name="twitter:site" content="@NakedSecurity" />
<meta name="twitter:text:title" content="&#8220;PwnKit&#8221; security bug gets you root on most Linux distros &#8211; what to do" />
<meta name="twitter:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/01/pwnkit-1200.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:admins" content="28552295016" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=270" />
</head>
<body class="post-template-default single single-post postid-669123 single-format-standard" >
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VK6LTK"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div style="display: none">
<svg>
	<symbol id="sophos" viewBox="0 0 132 24">
		<path d="m111.82 22.176h11.64c3.267 0 4.65-0.2 5.74-0.896 1.715-1.063 2.804-3.26 2.804-5.62 0-1.928-0.658-3.89-1.647-4.888-1.288-1.33-3.035-1.828-6.271-1.828h-3.527c-1.586 0-2.754-0.067-3.412-0.365-0.794-0.367-1.256-1.165-1.256-2.161 0-1.165 0.56-2.03 1.486-2.264 0.692-0.163 1.498-0.163 3.574-0.198h10.419v-3.956h-11.473c-2.574 0-3.727 0.099-4.718 0.466-2.279 0.796-3.828 3.257-3.828 6.083 0 1.93 0.76 3.727 2.079 4.89 1.155 0.996 2.872 1.462 5.51 1.462h4.697c1.057 0 1.915 0.132 2.376 0.398 0.893 0.433 1.418 1.328 1.418 2.36 0 0.864-0.395 1.597-1.087 2.027-0.561 0.369-1.517 0.534-3.268 0.534h-11.256zm-111.35 0h11.64c3.267 0 4.652-0.2 5.741-0.896 1.714-1.063 2.803-3.26 2.803-5.62 0-1.928-0.66-3.89-1.65-4.888-1.285-1.33-3.034-1.828-6.27-1.828h-3.527c-1.584 0-2.751-0.067-3.41-0.365-0.792-0.367-1.253-1.165-1.253-2.161 0-1.165 0.56-2.03 1.484-2.264 0.693-0.163 1.496-0.163 3.574-0.198h10.42v-3.956h-11.477c-2.573 0-3.727 0.099-4.715 0.466-2.278 0.796-3.83 3.257-3.83 6.083 0 1.93 0.762 3.727 2.08 4.89 1.155 0.996 2.871 1.462 5.51 1.462h4.696c1.057 0 1.913 0.132 2.377 0.398 0.888 0.433 1.416 1.328 1.416 2.36 0 0.864-0.394 1.597-1.089 2.027-0.558 0.369-1.517 0.534-3.264 0.534h-11.256v3.956zm94.05-16.18c-0.68 1.076-1.003 2.803-1.003 5.122 0 5.088 1.747 7.405 5.63 7.405 3.822 0 5.568-2.317 5.568-7.34 0-5.092-1.715-7.373-5.568-7.373-2.102 0-3.754 0.784-4.627 2.186zm13.174-2.511c1.329 1.761 2.072 4.63 2.072 7.992 0 3.816-1.197 6.948-3.334 8.677-1.619 1.304-4.078 2.022-6.995 2.022-4.142 0-7.41-1.372-9.092-3.817-1.263-1.793-1.88-4.176-1.88-7.08 0-4.172 1.133-7.339 3.27-9.035 1.682-1.37 4.339-2.122 7.383-2.122 3.85 0 6.925 1.209 8.576 3.363zm-22.018-3.068h-4.596v8.908h-8.319v-8.908h-4.597v21.759h4.597v-8.97h8.318v8.97h4.596v-21.759zm-28.61 10.277c1.23 0 1.941-0.163 2.427-0.62 0.581-0.49 0.938-1.533 0.938-2.74 0-1.436-0.58-2.478-1.584-2.838-0.356-0.13-0.94-0.197-1.684-0.197h-6.344v6.395zm-6.247 11.481h-4.598v-21.758h10.78c3.786 0 5.114 0.39 6.538 1.991 1.264 1.37 1.942 3.163 1.942 5.088 0 2.284-0.904 4.404-2.394 5.676-1.262 1.077-2.43 1.402-4.888 1.402h-7.38zm-22.589-16.179c-0.682 1.076-1.004 2.803-1.004 5.122 0 5.088 1.748 7.405 5.634 7.405 3.818 0 5.568-2.317 5.568-7.34 0-5.092-1.716-7.373-5.568-7.373-2.106 0-3.757 0.784-4.63 2.186zm13.174-2.511c1.328 1.761 2.073 4.63 2.073 7.992 0 3.816-1.2 6.948-3.335 8.677-1.618 1.304-4.079 2.022-6.993 2.022-4.144 0-7.413-1.372-9.096-3.817-1.264-1.793-1.878-4.176-1.878-7.08 0-4.172 1.133-7.339 3.272-9.035 1.681-1.37 4.337-2.122 7.38-2.122 3.851 0 6.93 1.209 8.578 3.363z"></path>
	</symbol>
	<symbol id="twitter" viewBox="0 0 24 24">
 		<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path>
 	</symbol>
	<symbol id="facebook" viewBox="0 0 24 24">
 		<path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path>
 	</symbol>
	<symbol id="instagram" viewBox="0 0 24 24">
		<path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path>
	</symbol>
	<symbol id="linkedin" viewBox="0 0 24 24">
		<path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"></path>
	</symbol>
	<symbol id="rss" viewBox="0 0 24 24">
		<path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"></path>
	</symbol>
	<symbol id="reddit" viewBox="0 0 24 24">
		<path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"></path>
	</symbol>
</svg>
</div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header variation variation-3" role="banner">
		<div class="header-container">
			<div class="site-branding">
				<div class="site-title">
					<a title="Naked Security" href="https://nakedsecurity.sophos.com/" rel="home"><img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/naked-security-logo-white@2x.png"></a>
					by
					<a title="sophos.com" href="https://www.sophos.com"><svg viewBox="0 0 132 24" class="icon sophos"><use xlink:href="#sophos"></use></svg></a>
				</div>
			</div><!-- .site-branding -->
			<nav id="site-navigation" class="main-navigation" role="navigation">
				<div class="container">
					<ul id="menu-variation-two" class="exit-links menu"><li id="menu-item-436509" class="products menu-item menu-item-type-custom menu-item-object-custom menu-item-436509"><a href="#">Products</a></li>
<li id="menu-item-436515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436515"><a href="https://www.sophos.com/en-us/products/free-tools.aspx">Free Tools</a></li>
<li id="menu-item-436531" class="search-toggle menu-item menu-item-type-custom menu-item-object-custom menu-item-436531"><a href="#">Search</a></li>
<li id="menu-item-436532" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436532"><a href="https://home.sophos.com/en-us.aspx">Free Sophos Home</a></li>
</ul>				</div>
			</nav><!-- #site-navigation -->
			<div class="site-search-block">
	<form target="_top" role="search" class="search-form" method="get" action="https://nakedsecurity.sophos.com/">
        <fieldset>
            <div class="field">
				<input type="search" value="" name="s" class="search-field" placeholder="Search naked security...">
            </div>
            <div class="submit">
				<button type="submit" class="search-submit button">Go</button>
            </div>
        </fieldset>
    </form>
</div>
		</div><!-- .container -->
	</header>

	<div class="responsive-flyout-panel small-12 column active" style="opacity: 1; display: none;">
		<div class="modal-filler"></div>
	    <div class="productNavBox">
	        <div class="productNavContainer">
	            <div class="row prodRow">
	                <div class="prodListBox column large-9">
	                    <div class="row margin-0 highlightProduct">
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/next-gen-firewall.aspx"><img src="https://www.sophos.com/medialibrary/2F4785DE8C3F43ECBD699A18F332FEEB.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">XG Firewall</div>
	                                	<div class="menu-section-subtitle">Next-Gen Firewall</div>
									</div>
	                            </a>
	                        </div>
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/intercept-x.aspx"><img src="https://www.sophos.com/medialibrary/27111765D65A45D49A232925D2CE428B.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">Intercept X</div>
	                                	<div class="menu-section-subtitle">Next-Gen Endpoint</div>
									</div>
	                            </a>
	                        </div>
	                    </div>
	                    <div class="productList">
	                        <ul>
								<li>
									<a href="https://www.sophos.com/en-us/products/cloud-optix.aspx"><img src="https://www.sophos.com/medialibrary/SophosNext/Images/Products/Icons/sophos-cloud-optix-icon.svg">Sophos Cloud Optix</a>
								</li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-central.aspx"><img src="https://www.sophos.com/medialibrary/08EA66123F1B4DDE8FE5C9B578A7FAA7.ashx">Sophos Central</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/mobile-control.aspx"><img src="https://www.sophos.com/medialibrary/678FE994855047739F50D6C411184FA6.ashx">Sophos Mobile</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/server-security.aspx"><img src="https://www.sophos.com/medialibrary/01B80E7D7CD54EF8AC2E51C9C6EC0236.ashx">Intercept X for Server</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-wifi.aspx"><img src="https://www.sophos.com/medialibrary/BEBD9C41BB4E480498514B29B92A145A.ashx">Secure Wi-Fi</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/phish-threat.aspx"><img src="https://www.sophos.com/medialibrary/DC9D1A7BA3964B0C9DAF1F1E68806B5A.ashx">Phish Threat</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/safeguard-encryption.aspx"><img src="https://www.sophos.com/medialibrary/8F51F06B62814B108D3B2763FF018E37.ashx">SafeGuard Encryption</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-email.aspx"><img src="https://www.sophos.com/medialibrary/597ADA0AF01A4A12B2B27239D0F9992C.ashx">Secure Email</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/unified-threat-management.aspx"><img src="https://www.sophos.com/medialibrary/8CB72BF5E1AD41F7894CE5E42101B0F3.ashx">SG UTM</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-web-gateway.aspx"><img src="https://www.sophos.com/medialibrary/C586E372694547A1B207A61D87246BA7.ashx">Secure Web Gateway</a>
	                            </li>
	                        </ul>
	                    </div>
	                </div>
	                <div class="homeUserBox column large-3">
						<img src="https://www.sophos.com/medialibrary/3376DF5742A64AEE93FDB9DCA7291239.ashx">
						<div class="menu-section-title">For Home Users</div>
	                    <p>Sophos Home protects every Mac and PC in your home </p><a href="https://home.sophos.com/" target="_blank" class="greenSmallMenuBtn">Learn More</a>
					</div>
	            </div>
	            <div class="row blueRow">
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-tools.aspx"><img width="19" src="https://www.sophos.com/medialibrary/A1FF440D2BB84511B8C94D771D44E207.ashx">Free Security Tools</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-trials.aspx"><img width="20" src="https://www.sophos.com/medialibrary/FCD3410ED2C347808D9DB8AC12C62DBD.ashx">Free Trials</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/demos.aspx"><img width="18" src="https://www.sophos.com/medialibrary/50985180E5F54C94917A2A6508E24287.ashx">Product Demos</a>
	                </div>
	                <!-- <div class="column large-3 medium-6">
	                    <a href="javascript:fairfax.openLiveChatFromFlyoutLink();" class="flyout-live-chat-link"><img width="20" src="https://www.sophos.com/medialibrary/E24C5050837145F6A5C592E299BA2A0D.ashx">Live Sales Chat</a>
	                </div> -->
	            </div>
	        </div>
	    </div>
	</div>
	<script>

	jQuery(document).ready( function () {
		var productButton   = jQuery('nav .menu-item.products');
		var modalBackground = jQuery('.modal-filler');
		var flyoutMenu		= jQuery('.responsive-flyout-panel');
		var Sophos			= Sophos || {};

		Sophos.MenuTest = {};

		Sophos.MenuTest.open = function () {
				productButton.addClass('open');
				flyoutMenu.show();
				modalBackground.show();
		};

		Sophos.MenuTest.close = function () {
			productButton.removeClass('open');
			flyoutMenu.hide();
			modalBackground.hide();
		};

		Sophos.MenuTest.toggle = function () {
			if ( productButton.hasClass('open') ) {
				Sophos.MenuTest.close();
			} else {
				Sophos.MenuTest.open();
			}
		};

		productButton.click( Sophos.MenuTest.toggle );
		modalBackground.click( Sophos.MenuTest.close );
	});

	</script>

	
	<section class="about-panel">
	<div class="container">
	<div class="panel-content ">

		<div class="description"><span>Have you listened to our podcast? <a href="/podcast/">Listen now</a></span></div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	<div id="content" class="site-content">
		<div class="content-container">

</div> <!-- .container -->
</div> <!-- #content -->


	<section class="content-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

		<main id="main" class="site-main" role="main">

	
		
<article id="post-669123" class="post-669123 post type-post status-publish format-standard has-post-thumbnail hentry category-featured category-linux category-vulnerability tag-cve-2021-4034 tag-eop tag-linux tag-pkexec tag-pwnkit">

	<header class="entry-header">
		<h1 class="entry-title">&#8220;PwnKit&#8221; security bug gets you root on most Linux distros &#8211; what to do</h1>		<div class="entry-meta">
			<div>
				
	<span class="entry-published">
		<time class="entry-date published" datetime="2022-01-26T19:58:32+00:00">26 Jan 2022</time>
	</span>

					<a href="#comments" class="comment-box">
					<span class="count">19</span>
				</a>
					
	<span class="entry-categories">
	<a href="https://nakedsecurity.sophos.com/category/technologies/operating-systems/linux/">Linux</a>, <a href="https://nakedsecurity.sophos.com/category/security-threats/vulnerability/">Vulnerability</a>	</span>

			</div>
	</header> <!-- .entry-header -->

    <div id="newsletter-signup" class="container top"></div>

			<div class="entry-featured-image">
			<img width="780" height="408" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/01/pwnkit-1200.png?w=780&amp;h=408&amp;crop=1" class="attachment-hero-thumbnail size-hero-thumbnail wp-post-image" alt="" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/01/pwnkit-1200.png 1200w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/01/pwnkit-1200.png?resize=300,157 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/01/pwnkit-1200.png?resize=768,401 768w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/01/pwnkit-1200.png?resize=1024,535 1024w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/01/pwnkit-1200.png?resize=780,408 780w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/01/pwnkit-1200.png?resize=100,52 100w" sizes="(max-width: 780px) 100vw, 780px" />					</div> <!-- .entry-featured-image -->
		
		<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2022/01/25/tax-scam-emails-are-alive-and-well-as-us-tax-season-starts/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> Tax scam emails are alive and well as US tax season starts</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2022/01/27/s3-ep67-tax-scams-carder-busts-and-crypto-capers-podcast-transcript/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> S3 Ep67: Tax scams, carder busts and crypto capers [Podcast + Transcript]</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	<div class="entry-content">
		<div class="entry-prefix">
			<div class="entry-author">
				
	
					<span class="by">by</span>
			<a href="https://nakedsecurity.sophos.com/author/paul-ducklin/" title="Posts by Paul Ducklin" class="author url fn" rel="author">Paul Ducklin</a>		
	
				</div>
			<div class="entry-sharing">
				
	<ul class="block social share">
		<li class="facebook"><a href="https://www.facebook.com/share.php?u=https%3A%2F%2Fnakedsecurity.sophos.com%2F2022%2F01%2F26%2Fpwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do%2F&title=%E2%80%9CPwnKit%E2%80%9D+security+bug+gets+you+root+on+most+Linux+distros+%E2%80%93+what+to+do" data-title="“PwnKit” security bug gets you root on most Linux distros – what to do" title="Share on Facebook"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
		<li class="twitter"><a href="https://twitter.com/intent/tweet?text=%E2%80%9CPwnKit%E2%80%9D+security+bug+gets+you+root+on+most+Linux+distros+%E2%80%93+what+to+do+https%3A%2F%2Fnakedsecurity.sophos.com%2F%3Fp%3D669123" data-title="&#8220;PwnKit&#8221; security bug gets you root on most Linux distros &#8211; what to do" title="Share on Twitter"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
		<li class="linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2022%2F01%2F26%2Fpwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do%2F&title=%E2%80%9CPwnKit%E2%80%9D+security+bug+gets+you+root+on+most+Linux+distros+%E2%80%93+what+to+do" data-title="“PwnKit” security bug gets you root on most Linux distros – what to do" title="Share on LinkedIn"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
		<li class="reddit"><a href="https://reddit.com/submit/?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2022%2F01%2F26%2Fpwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do%2F&title=%E2%80%9CPwnKit%E2%80%9D+security+bug+gets+you+root+on+most+Linux+distros+%E2%80%93+what+to+do" title="Share on Reddit"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon reddit"><use xlink:href="#reddit"></use></svg></a></li>

			</ul>

				</div>
		</div>
		<p>Researchers at Qualys have <a href="https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt" rel="nofollow">revealed a now-patched security hole</a> in a very widely used Linux security toolkit that&#8217;s included in almost every Linux distro out there.</p>
<p>The bug is officially known as CVE-2021-4034, but Qualys has given it a funky name, a logo and a web page of its own, dubbing it <strong>PwnKit</strong>.</p>
<p>The buggy code forms part of the Linux <em>Polkit</em> system, a popular way of allowing regular apps, which don&#8217;t run with any special privileges, to interact safely with other software or system services that need or have administrative superpowers.</p>
<p>For example, if you have a file manager that lets you take care of removable USB disks, the file manager will often need to negotiate with the operating system to ensure that you&#8217;re properly authorised to access those devices.</p>
<p>If you decide you want to wipe and reformat the disk, you might need root-level access to do so, and the Polkit system will help the file manager to negotiate those access rights temporarily, typically popping up a password dialog to verify your credentials.</p>
<p>If you&#8217;re a regular Linux user, you&#8217;ve probably seen Polkit-driven dialogs &#8211; indeed the text-based Polkit <code>man</code> page gives an old-school ASCII-art rendition of the way they typically look:</p>
<p><img loading="lazy" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/01/pwnkit-popup-640.png" alt="" width="640" height="253" class="aligncenter size-full wp-image-669124" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/01/pwnkit-popup-640.png 640w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/01/pwnkit-popup-640.png?resize=300,119 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/01/pwnkit-popup-640.png?resize=100,40 100w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<aside id="sophos_ad-3" class="widget sophos-inline-ad sophos_widget_ad">				<style></style>
				<div class="sophos_widget_ad"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx" class="s-ad-threat-hunter__link-wrapper">
  <div class="s-ad-threat-hunter">
    <div class="s-ad-threat-hunter__title">
      OTHERS STOP AT NOTIFICATION. WE TAKE ACTION
    </div>
    <div class="s-ad-threat-hunter__text">
      Get 24/7 managed threat hunting, detection, and response delivered by
      Sophos experts
    </div>
    <div class="s-ad-threat-hunter__action">
      <span class="s-button s-button--bright-green"> Learn&nbsp;more </span>
    </div>
  </div>
</a></div>
			</aside>
<h2>Polkit as an alternative sudo</h2>
<p>What you might not know about Polkit is that, although it&#8217;s geared towards adding secure on-demand authentication for graphical apps, it comes with a handy command-line tool called <code>pkexec</code>, short for <em>Polkit Execute</em>.</p>
<p>Simply put, <code>pkexec</code> is a bit like the well-known <code>sudo</code> utility, where sudo is short for <em>Set UID and Do a Command</em>, inasmuch as it allows you to switch temporarily to a different user ID, typically <code>root</code>, or UID 0, the all-powerful superuser account.</p>
<p>In fact, you use <code>pkexec</code> in much the same way as you do <code>sudo</code>, adding <code>pkexec</code> to the start of a command line that you don&#8217;t have the right to run in order to get <code>pkexec</code> to launch it for you, assuming that Polkit thinks you&#8217;re authorised to do so:</p>
<pre style='line-height:1.7em'>
# Regular users are locked out of the Polkit configuration directory...

$ ls -l /etc/polkit-1/rules.d/
/bin/ls: cannot open directory '/etc/polkit-1/rules.d/': Permission denied

# Using an account that hasn't been authorised to run "root level"
# commands via the Polkit configuration files...

$ pkexec ls -l /etc/polkit-1/rules.d/
==== AUTHENTICATING FOR org.freedesktop.policykit.exec ====
Authentication is needed to run `/usr/bin/ls' as the super user
Authenticating as: root
Password: 
polkit-agent-helper-1: pam_authenticate failed: Authentication failure
==== AUTHENTICATION FAILED ====
Error executing command as another user: Not authorized

This incident has been reported.

# After adding a Polkit rule to permit our account to do "root" stuff,
# we get automatic, temporary authorisation to run as the root user...

$ pkexec ls -l /etc/polkit-1/rules.d/
total 20
-rw-r--r-- 1 root root 360 Dec 31  2021 10-enable-powerdevil-discrete-gpu.rules
-rw-r--r-- 1 root root 512 Dec 31  2021 10-enable-session-power.rules
-rw-r--r-- 1 root root 812 Dec 31  2021 10-enable-upower-suspend.rules
-rw-r--r-- 1 root root 132 Dec 31  2021 10-org.freedesktop.NetworkManager.rules
-rw-r--r-- 1 root root 404 Dec 31  2021 20-plugdev-group-mount-override.rules
-rw-r--r-- 1 root root 542 Dec 31  2021 30-blueman-netdev-allow-access.rules

# And if we put no command and no username on the command line, pkexec
# assumes that we want a shell, so it runs our preferred shell (bash),
# making us root (UID 0) until we exit back to the parent shell...

$ pkexec 
bash-5.1# id
uid=0(root) gid=0(root) groups=0(root),...
exit
$ id
uid=1042(duck) gid=1042(duck) groups=1042(duck),...
</pre>
<p style='margin-top:2em'>As well as checking its access control rules (alluded to in the file listing above), <code>pkexec</code> also performs a range of other &#8220;security hardening&#8221; operations before it runs your chosen command with added privileges.</p>
<p>For example, consider this program, which prints out a list of its own command line arguments and environment variables:</p>
<pre class="brush: cpp; title: ; notranslate" title="">
/*----------------------------ENVP.C---------------------------*/

#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

void showlist(char* name, char* list[]) {
   int i = 0;
   while (1) {
      /* Print both the address where the pointer    */
      /* is stored and the address that it points to */

      printf(&quot;%s %2d @ %p [%p]&quot;,name,i,list,*list);

      /* If the pointer isn't NULL then print the    */
      /* string that it actually points to as well   */

      if (*list != NULL) { printf(&quot; -&gt; %s&quot;,*list); }
      printf(&quot;\n&quot;);

      /* List ends with NULL, so exit if we're there */

      if (*list == NULL) { break; }

      /* Otherwise move on to the next item in list  */

      list++; 
      i = i+1;
   } 
}

/* Command-line C programs almost all start with a boilerplate */
/* function called main(), to which the runtime library        */
/* supplies an argument count, the arguments given, and the    */
/* environment variables of the process.                       */
/* argv[] lists the arguments; envp[] lists the env. variables */
      
int main(int argc, char* argv[], char* envp[]) {
   showlist(&quot;argv&quot;,argv);
   showlist(&quot;envp&quot;,envp);
   return 0;
}
</pre>
<p style='margin-top:2em'>If you compile this progam and run it, you&#8217;ll see something like this, with a laundry list of environment variables that reflect your own preferences and settings:</p>
<pre style='line-height:1.7em'>
$ LD_LIBRARY_PATH=risky-variable GCONV_PATH=more-risk ./envp first second
argv  0 @ 0x7fff2ec882c8 [0x7fff2ec895b8] -&gt; ./envp
argv  1 @ 0x7fff2ec882d0 [0x7fff2ec895bf] -&gt; first
argv  2 @ 0x7fff2ec882d8 [0x7fff2ec895c5] -&gt; second
argv  3 @ 0x7fff2ec882e0 [(nil)]
envp  0 @ 0x7fff2ec882e8 [0x7fff2ec895cc] -&gt; GCONV_PATH=more-risk
envp  1 @ 0x7fff2ec882f0 [0x7fff2ec895e1] -&gt; LD_LIBRARY_PATH=risky-variable
envp  2 @ 0x7fff2ec882f8 [0x7fff2ec89600] -&gt; SHELL=/bin/bash
envp  3 @ 0x7fff2ec88300 [0x7fff2ec89610] -&gt; WINDOWID=25165830
envp  4 @ 0x7fff2ec88308 [0x7fff2ec89622] -&gt; COLORTERM=rxvt-xpm
[...]
envp 38 @ 0x7fff2ec88418 [0x7fff2ec89f07] -&gt; PATH=/opt/redacted/bin:/home/duck/...
envp 39 @ 0x7fff2ec88420 [0x7fff2ec89fb9] -&gt; MAIL=/var/mail/duck
envp 40 @ 0x7fff2ec88428 [0x7fff2ec89fcd] -&gt; OLDPWD=/home/duck
envp 41 @ 0x7fff2ec88430 [0x7fff2ec89fe8] -&gt; _=./envp
envp 42 @ 0x7fff2ec88438 [(nil)]
</pre>
<p style='margin-top:2em'>Note two things:</p>
<ul>
<li><strong>The pointer arrays for the arguments and environment variables are contiguous in memory.</strong> The NULL pointer at the end of the argument array, shown at memory address 0x7fff2ec882e0 as <code>[(nil)]</code>, is followed immediately by the pointer to the first environment string (<code>GCONV_PATH</code>) at 0x7fff2ec882e8. Pointers are 8 bytes each on 64-bit Linux, and the <code>argv</code> and <code>envp</code> pointer lists run from 0x7fff2ec882c8 to 0x7fff2ec88438 in contiguous steps of 8 bytes each time. There is no unused memry between <code>argc[]</code> and <code>envp[]</code>.
<li><strong>Both the <code>argv</code> list and the <code>envp</code> list are entirely under your control.</strong> You get to choose the arguments and to set any environment variables you like, including adding ones on the command line to use when running this command only. Some environment variables, such as <code>LD_PRELOAD</code> and <code>LD_LIBRARY_PATH</code>, can be used to modify the behaviour of the program you&#8217;re executing, including quietly and automatically loading additional commands or executable modules.
</ul>
<p>Let&#8217;s run the command again as root, by using <code>pkexec</code>:</p>
<pre style='line-height:1.7em'>
$ LD_LIBRARY_PATH=risky-variable GCONV_PATH=more-risk pkexec ./envp first second
argv  0 @ 0x7ffdf900fc98 [0x7ffdf9010eec] -&gt; /home/duck/Articles/pwnkit/./envp
argv  1 @ 0x7ffdf900fca0 [0x7ffdf9010f0e] -&gt; first
argv  2 @ 0x7ffdf900fca8 [0x7ffdf9010f14] -&gt; second
argv  3 @ 0x7ffdf900fcb0 [(nil)]
envp  0 @ 0x7ffdf900fcb8 [0x7ffdf9010f1b] -&gt; SHELL=/bin/bash
envp  1 @ 0x7ffdf900fcc0 [0x7ffdf9010f2b] -&gt; LANG=en_US.UTF-8
envp  2 @ 0x7ffdf900fcc8 [0x7ffdf9010f3c] -&gt; LC_COLLATE=C
envp  3 @ 0x7ffdf900fcd0 [0x7ffdf9010f49] -&gt; TERM=rxvt-unicode-256color
envp  4 @ 0x7ffdf900fcd8 [0x7ffdf9010f64] -&gt; COLORTERM=rxvt-xpm
envp  5 @ 0x7ffdf900fce0 [0x7ffdf9010f77] -&gt; PATH=/usr/sbin:/usr/bin:/sbin:/bin:/root/bin
envp  6 @ 0x7ffdf900fce8 [0x7ffdf9010fa4] -&gt; LOGNAME=root
envp  7 @ 0x7ffdf900fcf0 [0x7ffdf9010fb1] -&gt; USER=root
envp  8 @ 0x7ffdf900fcf8 [0x7ffdf9010fbb] -&gt; HOME=/root
envp  9 @ 0x7ffdf900fd00 [0x7ffdf9010fc6] -&gt; PKEXEC_UID=1000
envp 10 @ 0x7ffdf900fd08 [(nil)]
</pre>
<p style='margin-top:2em'>This time, you will notice that:</p>
<ul>
<li><strong>The command name (<code>argv[0]</code>) has been converted to a full pathname.</strong> The <code>pkexec</code> program does this right at the outset, to avoid ambiguity when the program runs with superuser powers. Note that this conversion happens before the underlying <em>Polkit</em> system intervenes to check whether you&#8217;re allowed to run the chosen program, and thus before any password prompts appear.
<li><strong>The list of environment variables has been trimmed and adjusted for security reasons</strong>. In particular, the operating system itself automatically prunes several known-bad environment variables from any program, such as <code>pkexec</code>, that has the privilege to promote other software to run as root. (In technical jargon, this means any program with the <code>setuid</code> bit set, of which <code>pkexec</code> is an example.)
</ul>
<h2>Beware the buffer overflow</h2>
<p>So far, so good.</p>
<p>Except that Qualys discovered that if you deliberately launch the <code>pkexec</code> program in such a way that the value of its own <code>argv[0]</code> parameter (by convention, set to the name of the program itself) is blanked out and set to NULL&#8230;</p>
<p>&#8230;then in the process of converting the command name you want to run (./envp above) into a full pathname (<code>/home/duck/Articles/pwnkit/./envp</code>), the <code>pkexec</code> startup code will perform a buffer overflow.</p>
<p>For security reasons, <code>pkexec</code> ought to detect that it was unusually launched with no command line arguments at all, not even its own name, and refuse to run.</p>
<p>Instead, <code>pkexec</code> blindly looks at what it thinks is <code>argv[1]</code> (usually, this would be the name of the command you are asking it to run as root), and tries to find that program on your path.</p>
<p>But if <code>argv[0]</code> was already NULL, then there are no command line arguments, and what <code>pkexec</code> thinks is <code>argv[1]</code> is actually <code>envp[0]</code>, the first environment variable, because the <code>argv[]</code> and <code>envp[]</code> arrays are directly adjacent in memory.</p>
<p>So, if you set your first environment variable to be the name of a program that can be found on your <code>PATH</code>, and then run <code>pkexec</code> with no command arguments at all, not even <code>argv[0]</code>, then the program will combine your path with value of the environment variable it mistakenly thinks is the name of the program you want to run&#8230;</p>
<p>&#8230;and write that &#8220;more secure&#8221; version of the &#8220;filename&#8221; back into what it thinks is <code>argv[1]</code>, ready to run the chosen program via its full pathname, rather than a relative one.</p>
<p>Unfortunately, the modifed string written into <code>argv[1]</code> actually ends up in <code>envp[0]</code>, which means that a rogue user could, in theory, exploit this argv-to-envp buffer misaligment to <b>reintroduce dangerous environment variables that the operating system itself had already taken the trouble to expunge from memory</b>.</p>
<h2>Full elevation of privilege</h2>
<p>To cut a long story short, Qualys researchers discovered a way to use a dangerously &#8220;reintroduced&#8221; environment variable of this sort to trick <code>pkexec</code> into running a program of their choice <b>before the program got as far as verifying whether their account was entitled to use <code>pkexec</code> at all</b>.</p>
<p>Because <code>pkexec</code> is a &#8220;setuid-root&#8221; program (this means that when you launch it, it magically runs as <code>root</code> rather than under your own account), any subprogram you can coerce it into launching will inherit superuser privileges.</p>
<p>This means that any user who already has access to your system, even if they&#8217;re logged in under an account with almost no power at all, could, in theory, use <code>pkexec</code> to promote themselves instantly to user ID 0: the <code>root</code>, or superuser, account.</p>
<p>The researchers wisely didn&#8217;t provide working proof-of-concept code, although as they wryly point out:</p>
<blockquote><p>We will not publish our exploit immediately; however, please note that this vulnerability is trivially exploitable, and other researchers might publish their exploits shortly after the patches are available.</p></blockquote>
<h2>What to do?</h2>
<ul>
<li><strong>Patch early, patch often.</strong> Many, if not most, Linux distros should have an update out already. You can (safely) run <code>pkexec --version</code> to check the version you&#8217;ve got. You want <strong>0.120</strong> or later.
<li><strong>If you can&#8217;t patch, consider demoting <code>pkexec</code> from its superpower privilege.</strong> If you remove the <code>setuid</code> bit from the <code>pkexec</code> executable file then this bug will no longer be exploitable, because <code>pkexec</code> won&#8217;t automatically launch with superuser powers. Anyone trying to exploit the bug would simply end up with the same privilege that they already had.
</ul>
<hr style='margin-top:2em'>
<p style='background-color: #0d69ba;padding: 0.5em;text-align: center;color: white;font-size: 90%;margin-top:2em'><strong>FIND AND FIX PKEXEC &#8211; HOW TO USE THE WORKAROUND</strong></p>
<p><em>Finding </em><code>pkexec</code><em> on your path:</em></p>
<pre>
$ which pkexec
/usr/bin/pkexec   &lt;---probable location on most distros
</pre>
<p style='margin-top:2em'><em>Checking the version you have.</em> Below 0.120 and you are probably vulnerable, at least on Linux:</p>
<pre>
$ /usr/bin/pkexec --version
pkexec version 0.120    &lt;-- our distro already has the updated Polkit package
</pre>
<p style='margin-top:2em'><em>Checking the file mode bits.</em> Note that the letter <code>s</code> in the first column stands for <code>setuid</code>, and means that when the file runs, it will automatically execute under the account name listed in column three as the owner of the file; in this case, that means <code>root</code>. In terminals with colour support, you may see the filename emphasised with a bright red background:</p>
<pre>
$ ls -l /usr/bin/pkexec
-rwsr-xr-x 1 root root 35544 2022-01-26 02:16 /usr/bin/pkexec*
</pre>
<p style='margin-top:2em'><em>Changing the </em><code>setuid</code><em> bit</em>. Note how, after demoting the file by &#8220;subtracting&#8221; the letter <code>s</code> from the mode bits, the first column no longer contains an S-for-setuid marker. On a colour terminal, the dramatic red background will disappear too:</p>
<pre>
$ sudo chmod -s /usr/bin/pkexec 
Password: ***************
$ ls -l /usr/bin/pkexec
-rwxr-xr-x 1 root root 35544 2022-01-26 02:16 /usr/bin/pkexec*   &lt;-- setuid bit removed
</pre>
<p style='margin-top:2em'><em>Turning </em><code>setuid</code><em> back on</em>. If you need to re-enable the root-acquiring powers of <code>pkexec</code> before getting the latest update, or if updating the Polkit package doesn&#8217;t restore the <code>setuid</code> bit automatically, you can use the <code>chmod +s ...</code> command (in a similar way to how you used <code>-s</code> above) in order to &#8220;add back&#8221; the letter <code>s</code> to the mode bits:</p>
<pre>
$ sudo chmod u+s /usr/bin/pkexec 
Password: ***************
$ ls -l /usr/bin/pkexec
-rwsr-xr-x 1 root root 35544 2022-01-26 02:16 /usr/bin/pkexec*   &lt;-- setuid bit restored for file user
</pre>
<hr style='margin-top:2em'>
			</div> <!-- .entry-content -->
	<ul class="block social follow">
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon twitter"><use xlink:href="#twitter"></use></svg>
			<p>Follow <strong><a href="https://twitter.com/nakedsecurity">@NakedSecurity on Twitter</a></strong> for the latest computer security news.</p>
		</li>
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon instagram"><use xlink:href="#instagram"></use></svg>
			<p>Follow <strong><a href="https://www.instagram.com/nakedsecurity/">@NakedSecurity on Instagram</a></strong> for exclusive pics, gifs, vids and LOLs!</p>
		</li>
	</ul>
</article><!-- #post-## -->

		<div class="free-tools-block">
			<h2 class="block-title">Free tools</h2>

<div class="ns-free-tools">
	<div class="ns-free-tools__item ns-free-tools__item--sophos-home">
		<a class="ns-free-tools__link" href="https://www.sophos.com/en-us/products/free-tools/sophos-xg-firewall-home-edition.aspx">
			<figure class="ns-free-tools__image">
				<svg width="40" height="40" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M25.833 32.023H9.167a.417.417 0 0 0-.417.417v6.25c0 .23.187.417.417.417h16.666c.23 0 .417-.187.417-.417v-6.25a.417.417 0 0 0-.417-.417ZM1.25 32.023a.416.416 0 0 0-.417.417v5A1.667 1.667 0 0 0 2.5 39.107h3.333a.416.416 0 0 0 .417-.417v-6.25a.417.417 0 0 0-.417-.417H1.25ZM38.75 29.523a.416.416 0 0 0 .417-.416v-5A1.667 1.667 0 0 0 37.5 22.44H20a.416.416 0 0 0-.417.417v6.25a.416.416 0 0 0 .417.416h18.75ZM28.75 38.69a.417.417 0 0 0 .417.417H37.5a1.666 1.666 0 0 0 1.667-1.667v-5a.416.416 0 0 0-.417-.417h-9.583a.417.417 0 0 0-.417.417v6.25ZM16.667 29.523a.417.417 0 0 0 .416-.416v-6.25a.417.417 0 0 0-.416-.417H2.5a1.667 1.667 0 0 0-1.667 1.667v5a.417.417 0 0 0 .417.416h15.417ZM29.38 7.883h-.435l-2.622 3.284a.417.417 0 0 1-.728-.152c-.809-2.964-.737-6.1.207-9.023a.832.832 0 0 0-.909-1.084 15.864 15.864 0 0 0-11.525 7.667.417.417 0 0 1-.489.186.421.421 0 0 1-.16-.094l-1.834-1.779a.832.832 0 0 0-1.217.059 12.458 12.458 0 0 0-2.356 11.87.415.415 0 0 0 .396.288h5.549a.416.416 0 0 0 .41-.342 8.858 8.858 0 0 1 4.428-6.22.833.833 0 0 1 1.215.97 6.572 6.572 0 0 0 .43 4.834.42.42 0 0 0 .353.226 2.149 2.149 0 0 0 1.805-1.105.832.832 0 0 1 1.272-.181c.47.44.845.972 1.1 1.563a.419.419 0 0 0 .382.248h5.965a.418.418 0 0 0 .396-.288A12.47 12.47 0 0 0 29.38 7.875v.008Z" fill="#000"/>
				</svg>
			</figure>
			<h4 class="ns-free-tools__title">
				Sophos Firewall Home Edition			</h4>
			<div class="ns-free-tools__sub-title">
				Boost your home network security.			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--hitman-pro">
		<a class="ns-free-tools__link" href="https://www.sophos.com/en-us/products/free-tools/virus-removal-tool.aspx">
			<figure class="ns-free-tools__image">
				<svg width="40" height="40" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M10.833 36.667H3.75a.416.416 0 0 1-.417-.417v-7.083a1.666 1.666 0 1 0-3.333 0v7.5A3.333 3.333 0 0 0 3.333 40h7.5a1.666 1.666 0 1 0 0-3.333ZM1.667 12.5a1.667 1.667 0 0 0 1.666-1.667V3.75a.417.417 0 0 1 .417-.417h7.083a1.666 1.666 0 1 0 0-3.333h-7.5A3.333 3.333 0 0 0 0 3.333v7.5A1.666 1.666 0 0 0 1.667 12.5ZM38.333 27.5a1.667 1.667 0 0 0-1.666 1.667v7.083a.416.416 0 0 1-.417.417h-7.083a1.667 1.667 0 1 0 0 3.333h7.5A3.333 3.333 0 0 0 40 36.667v-7.5a1.666 1.666 0 0 0-1.667-1.667ZM36.667 0h-7.5a1.666 1.666 0 1 0 0 3.333h7.083a.417.417 0 0 1 .417.417v7.083a1.667 1.667 0 1 0 3.333 0v-7.5A3.333 3.333 0 0 0 36.667 0ZM20 22.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Z" fill="#000"/>
					<path d="M8.07 18.762a1.855 1.855 0 0 0 0 2.473c2.833 3.137 7.438 6.334 11.982 6.264 4.54.076 9.14-3.127 11.98-6.264a1.853 1.853 0 0 0 0-2.473c-2.9-3.204-7.515-6.334-11.977-6.26-4.468-.075-9.085 3.056-11.985 6.26ZM24.167 20a4.167 4.167 0 1 1-8.334 0 4.167 4.167 0 0 1 8.334 0ZM20 7.5a1.667 1.667 0 0 0 1.667-1.667v-2.5a1.667 1.667 0 0 0-3.334 0v2.5A1.667 1.667 0 0 0 20 7.5ZM20 32.5a1.667 1.667 0 0 0-1.667 1.667v2.5a1.667 1.667 0 0 0 3.334 0v-2.5A1.667 1.667 0 0 0 20 32.5ZM38.333 18.333h-2.5a1.666 1.666 0 1 0 0 3.334h2.5a1.667 1.667 0 0 0 0-3.334ZM1.667 21.667h2.5a1.667 1.667 0 1 0 0-3.334h-2.5a1.666 1.666 0 1 0 0 3.334Z" fill="#000"/>
				</svg>
			</figure>
			<h4 class="ns-free-tools__title">
				Sophos Scan &amp; Clean			</h4>
			<div class="ns-free-tools__sub-title">
				Free second-opinion scanner for PCs.			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--intercept-x">
		<a class="ns-free-tools__link" href="https://aws.amazon.com/marketplace/pp/prodview-7silxvfxce4zq?qid=1599237395672&sr=0-1&ref_=srh_res_product_title">
			<figure class="ns-free-tools__image">
				<svg width="40" height="40" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M3.241 24.179a1.698 1.698 0 0 0 2.362-.57 1.68 1.68 0 0 0 .234-.859 1.564 1.564 0 0 0-.758-1.342 3.706 3.706 0 0 1-.676-.52 3.932 3.932 0 0 1-1.065-2.96A4.28 4.28 0 0 1 4.6 14.894a4.321 4.321 0 0 1 3.938-1.165 1.674 1.674 0 0 0 1.831-.898c.108-.22.165-.46.169-.703.14-9.544 13.83-12.215 18.03-3.393a1.618 1.618 0 0 0 1.569.948 6.19 6.19 0 0 1 4.985 2.146 6.398 6.398 0 0 1 1.527 4.607 5.684 5.684 0 0 1-1.965 4.121 1.581 1.581 0 0 0-.52 1.198 1.641 1.641 0 0 0 .939 1.495 1.66 1.66 0 0 0 1.759-.206 8.952 8.952 0 0 0 2.327-3.084 8.914 8.914 0 0 0 .807-3.773 9.536 9.536 0 0 0-2.407-6.604 9.617 9.617 0 0 0-6.29-3.184.418.418 0 0 1-.317-.199 12.786 12.786 0 0 0-5.593-5.014 12.856 12.856 0 0 0-7.456-1.02 12.827 12.827 0 0 0-6.744 3.326 12.735 12.735 0 0 0-3.702 6.524.416.416 0 0 1-.378.332 7.758 7.758 0 0 0-3.491 1.122 7.717 7.717 0 0 0-2.58 2.597 7.405 7.405 0 0 0-1.033 4.06 7.084 7.084 0 0 0 2.058 5.126c.358.35.753.66 1.178.926Z" fill="#000"/>
					<path d="m17.818 39.424.921.35a3.44 3.44 0 0 0 2.451 0l.922-.35c5.134-1.947 8.72-6.587 8.72-11.28v-5.636a2.556 2.556 0 0 0-1.547-2.35 27.468 27.468 0 0 0-9.32-1.725c-3.162.026-6.293.61-9.249 1.726-.46.199-.85.527-1.125.945a2.555 2.555 0 0 0-.421 1.404v5.624a12.765 12.765 0 0 0 2.607 6.95 12.852 12.852 0 0 0 6.041 4.342Zm-2.816-10.629c-.332 0-.65-.13-.884-.364a1.242 1.242 0 0 1 .884-2.124h3.332a.418.418 0 0 0 .417-.415v-3.318c0-.33.132-.646.366-.88a1.253 1.253 0 0 1 1.767 0c.235.234.366.55.366.88v3.318a.414.414 0 0 0 .417.415H25c.331 0 .649.13.883.364A1.241 1.241 0 0 1 25 28.795h-3.333a.417.417 0 0 0-.417.415v3.318c0 .33-.131.646-.366.88a1.253 1.253 0 0 1-1.767 0 1.241 1.241 0 0 1-.366-.88V29.21a.414.414 0 0 0-.417-.415h-3.332Z" fill="#000"/>
				</svg>
			</figure>
			<h4 class="ns-free-tools__title">
				Sophos Cloud Optix			</h4>
			<div class="ns-free-tools__sub-title">
				Monitor 25 cloud assets for free.			</div>
		</a>
	</div>
</div>
		</div>

			<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2022/01/25/tax-scam-emails-are-alive-and-well-as-us-tax-season-starts/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> Tax scam emails are alive and well as US tax season starts</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2022/01/27/s3-ep67-tax-scams-carder-busts-and-crypto-capers-podcast-transcript/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> S3 Ep67: Tax scams, carder busts and crypto capers [Podcast + Transcript]</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	
	</main><!-- #main -->

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<section class="comments-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

			
<div id="comments" class="comments-area">

			<h2 class="comments-title">
			19 comments on &ldquo;<span>&#8220;PwnKit&#8221; security bug gets you root on most Linux distros &#8211; what to do</span>&rdquo;		</h2>

		<ol class="comment-list">
					<li id="comment-6383242" class="comment even thread-even depth-1 parent">
			<article id="div-comment-6383242" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/52b3f0c7327ea34687c12215c7340b7a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/52b3f0c7327ea34687c12215c7340b7a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Raymond E Rogers</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/#comment-6383242"><time datetime="2022-01-26T22:09:51+00:00">January 26, 2022 at 10:09 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Sigh, so I set the suid off; now synaptic icons don&#8217;t work.  Although the command line call works 🙂<br />
Does anybody know why the icons are<br />
&#8220;synaptic-pkexec&#8221;<br />
execution commands.<br />
Is this going to affect many more icons?<br />
Ray</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6383242"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6383242={"id":7238218,"unique_id":"wp-comment-6383242","title":"Sigh%2C%20so%20I%20set%20the%20suid%20off%3B%20now%20synaptic%20icons%20don%26%23039%3Bt%20work.%20%20Although%20the%20command%20line%20call%20works%20%3A%29Does%20anybody%20know%20why%20the%20icons%20are%20%26quot%3Bsynaptic-pkexec%26quot%3B%20execution%20commands.Is%20this%20going%20to%20affec%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/01\/26\/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do\/#comment-6383242","item_id":"_comm_6383242"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/?replytocom=6383242#respond' data-commentid="6383242" data-postid="669123" data-belowelement="div-comment-6383242" data-respondelement="respond" data-replyto="Reply to Raymond E Rogers" aria-label='Reply to Raymond E Rogers'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6383247" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2 parent">
			<article id="div-comment-6383247" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/#comment-6383247"><time datetime="2022-01-26T22:38:10+00:00">January 26, 2022 at 10:38 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I guess those icons are shortcuts (is that the Debianesque word?) that rely on pkexec to negotiate root access for doing updates, because the actual update process itself (rather obviously) demands root-level powers given that you&#8217;re fiddling with system files, configuration data and even the kernel itself. </p>
<p>I assume that if you have done an update via the command line (where you will almost certainly use sudo, which will work, rather than pkexec, which will not), then you will have acquired the latest version of the Polkit tools (so that &#8216;pkexec &#8211;version&#8217; returns 0.120). </p>
<p>If so, you can turn setuid back on with &#8216;chmod +s &#8230;&#8217; in place of the &#8216;chmod -s &#8230;&#8217; above. </p>
<p>Perhaps I should add that last detail to the article to make it clear how to &#8220;rescind&#8221; the workaround after you&#8217;ve correctly update?</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6383247"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6383247={"id":7238218,"unique_id":"wp-comment-6383247","title":"I%20guess%20those%20icons%20are%20shortcuts%20%28is%20that%20the%20Debianesque%20word%3F%29%20that%20rely%20on%20pkexec%20to%20negotiate%20root%20access%20for%20doing%20updates%2C%20because%20the%20actual%20update%20process%20itself%20%28rather%20obviously%29%20deman%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/01\/26\/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do\/#comment-6383247","item_id":"_comm_6383247"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/?replytocom=6383247#respond' data-commentid="6383247" data-postid="669123" data-belowelement="div-comment-6383247" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6383250" class="comment byuser comment-author-pducklin bypostauthor even depth-3 parent">
			<article id="div-comment-6383250" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/#comment-6383250"><time datetime="2022-01-26T22:48:20+00:00">January 26, 2022 at 10:48 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Done. Added in a section for &#8220;Turning setuid back on&#8221; at the end of the article. HtH.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6383250"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6383250={"id":7238218,"unique_id":"wp-comment-6383250","title":"Done.%20Added%20in%20a%20section%20for%20%26quot%3BTurning%20setuid%20back%20on%26quot%3B%20at%20the%20end%20of%20the%20article.%20HtH.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/01\/26\/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do\/#comment-6383250","item_id":"_comm_6383250"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/?replytocom=6383250#respond' data-commentid="6383250" data-postid="669123" data-belowelement="div-comment-6383250" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6383934" class="comment odd alt depth-4 parent">
			<article id="div-comment-6383934" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Mo</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/#comment-6383934"><time datetime="2022-01-31T15:20:56+00:00">January 31, 2022 at 3:20 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Umm, that command doesn&#8217;t restore it to the original permissions, though. You would need `sudo chmod u+s /usr/bin/pkexec` to do that, otherwise the group will also get setuid permissions.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6383934"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6383934={"id":7238218,"unique_id":"wp-comment-6383934","title":"Umm%2C%20that%20command%20doesn%26%23039%3Bt%20restore%20it%20to%20the%20original%20permissions%2C%20though.%20You%20would%20need%20%60sudo%20chmod%20u%2Bs%20%2Fusr%2Fbin%2Fpkexec%60%20to%20do%20that%2C%20otherwise%20the%20group%20will%20also%20get%20setuid%20permissions.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/01\/26\/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do\/#comment-6383934","item_id":"_comm_6383934"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/?replytocom=6383934#respond' data-commentid="6383934" data-postid="669123" data-belowelement="div-comment-6383934" data-respondelement="respond" data-replyto="Reply to Mo" aria-label='Reply to Mo'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6383935" class="comment byuser comment-author-pducklin bypostauthor even depth-5 parent">
			<article id="div-comment-6383935" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/#comment-6383935"><time datetime="2022-01-31T15:22:35+00:00">January 31, 2022 at 3:22 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Oops, fixing now!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6383935"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6383935={"id":7238218,"unique_id":"wp-comment-6383935","title":"Oops%2C%20fixing%20now%21%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/01\/26\/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do\/#comment-6383935","item_id":"_comm_6383935"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/?replytocom=6383935#respond' data-commentid="6383935" data-postid="669123" data-belowelement="div-comment-6383935" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6383936" class="comment odd alt depth-6 parent">
			<article id="div-comment-6383936" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Mo</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/#comment-6383936"><time datetime="2022-01-31T15:25:26+00:00">January 31, 2022 at 3:25 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Great, thx for the quick response! I&#8217;ve changed my downvote to an upvote 🙂<br />
And thx for writing the article, very informative!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6383936"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6383936={"id":7238218,"unique_id":"wp-comment-6383936","title":"Great%2C%20thx%20for%20the%20quick%20response%21%20I%26%23039%3Bve%20changed%20my%20downvote%20to%20an%20upvote%20%3A%29%20And%20thx%20for%20writing%20the%20article%2C%20very%20informative%21%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/01\/26\/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do\/#comment-6383936","item_id":"_comm_6383936"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/?replytocom=6383936#respond' data-commentid="6383936" data-postid="669123" data-belowelement="div-comment-6383936" data-respondelement="respond" data-replyto="Reply to Mo" aria-label='Reply to Mo'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6383947" class="comment byuser comment-author-pducklin bypostauthor even depth-7">
			<article id="div-comment-6383947" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/#comment-6383947"><time datetime="2022-01-31T17:06:31+00:00">January 31, 2022 at 5:06 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks. Might be worth doing a &#8220;Serious Security&#8221; article on setuid(), setgid() and friends (and on Windows impersonation), not least to remind people that setuid() is at least as important for switching to a *lesser* account. </p>
<p>Lots of people think that &#8220;sudo&#8221; is short for &#8220;superuser do&#8221;, as in which is admittedly how it is usually used (as in XKCD&#8217;s infamous &#8216;sudo make&#8217; cartoon https://xkcd.com/149/ :&#045;), rather than simply a command-line interface to the general-purpose system call that changes user ID.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6383947"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6383947={"id":7238218,"unique_id":"wp-comment-6383947","title":"Thanks.%20Might%20be%20worth%20doing%20a%20%26quot%3BSerious%20Security%26quot%3B%20article%20on%20setuid%28%29%2C%20setgid%28%29%20and%20friends%20%28and%20on%20Windows%20impersonation%29%2C%20not%20least%20to%20remind%20people%20that%20setuid%28%29%20is%20at%20least%20as%20important%20for%20s%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/01\/26\/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do\/#comment-6383947","item_id":"_comm_6383947"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/?replytocom=6383947#respond' data-commentid="6383947" data-postid="669123" data-belowelement="div-comment-6383947" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6383337" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-6383337" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Anonymous</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/#comment-6383337"><time datetime="2022-01-27T13:56:39+00:00">January 27, 2022 at 1:56 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks Paul, Fedora just updated with 0.120 today. Now to tackle all those IoT&#8217;s&#8230;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6383337"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6383337={"id":7238218,"unique_id":"wp-comment-6383337","title":"Thanks%20Paul%2C%20Fedora%20just%20updated%20with%200.120%20today.%20Now%20to%20tackle%20all%20those%20IoT%26%23039%3Bs...%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/01\/26\/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do\/#comment-6383337","item_id":"_comm_6383337"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/?replytocom=6383337#respond' data-commentid="6383337" data-postid="669123" data-belowelement="div-comment-6383337" data-respondelement="respond" data-replyto="Reply to Anonymous" aria-label='Reply to Anonymous'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-6383340" class="comment even thread-even depth-1 parent">
			<article id="div-comment-6383340" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Anonymous</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/#comment-6383340"><time datetime="2022-01-27T14:29:07+00:00">January 27, 2022 at 2:29 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>For Ubuntu, the patched version seems to be 0.105 according to<br />
https://ubuntu.com/security/notices/USN-5252-1</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6383340"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6383340={"id":7238218,"unique_id":"wp-comment-6383340","title":"For%20Ubuntu%2C%20the%20patched%20version%20seems%20to%20be%200.105%20according%20tohttps%3A%2F%2Fubuntu.com%2Fsecurity%2Fnotices%2FUSN-5252-1%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/01\/26\/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do\/#comment-6383340","item_id":"_comm_6383340"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/?replytocom=6383340#respond' data-commentid="6383340" data-postid="669123" data-belowelement="div-comment-6383340" data-respondelement="respond" data-replyto="Reply to Anonymous" aria-label='Reply to Anonymous'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6383347" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2">
			<article id="div-comment-6383347" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/#comment-6383347"><time datetime="2022-01-27T15:04:30+00:00">January 27, 2022 at 3:04 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I assume they packported the changes needed to detect NULL in argv[0] (and a couple of other changes added to improve error handling).</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6383347"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6383347={"id":7238218,"unique_id":"wp-comment-6383347","title":"I%20assume%20they%20packported%20the%20changes%20needed%20to%20detect%20NULL%20in%20argv%26%23091%3B0%26%23093%3B%20%28and%20a%20couple%20of%20other%20changes%20added%20to%20improve%20error%20handling%29.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/01\/26\/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do\/#comment-6383347","item_id":"_comm_6383347"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/?replytocom=6383347#respond' data-commentid="6383347" data-postid="669123" data-belowelement="div-comment-6383347" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6383343" class="comment even thread-odd thread-alt depth-1 parent">
			<article id="div-comment-6383343" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/52b3f0c7327ea34687c12215c7340b7a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/52b3f0c7327ea34687c12215c7340b7a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Raymond E Rogers</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/#comment-6383343"><time datetime="2022-01-27T14:41:42+00:00">January 27, 2022 at 2:41 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks Paul:   Ubuntu-mate hasn&#8217;t officially upgraded to 1.200 yet.  I will wait for a week or so; if not upgraded, I will hunt around for the upgrade.   I _prefer_   upgrading through &#8220;normal&#8221; channels (it seems to cut down on the sysadmin time)  but make exceptions.<br />
BTW: I have had several occasions where updates were blocked by Sophos running.  Is there a reporting channel or interest in these occasions?  So far, turning off Sophos temporarily has worked okay; but I am always leery.  They are usually configuration files.<br />
Ray</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6383343"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6383343={"id":7238218,"unique_id":"wp-comment-6383343","title":"Thanks%20Paul%3A%20%20%20Ubuntu-mate%20hasn%26%23039%3Bt%20officially%20upgraded%20to%201.200%20yet.%20%20I%20will%20wait%20for%20a%20week%20or%20so%3B%20if%20not%20upgraded%2C%20I%20will%20hunt%20around%20for%20the%20upgrade.%20%20%20I%20_prefer_%20%20%20upgrading%20through%20%26quot%3Bnormal%26quot%3B%20c%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/01\/26\/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do\/#comment-6383343","item_id":"_comm_6383343"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/?replytocom=6383343#respond' data-commentid="6383343" data-postid="669123" data-belowelement="div-comment-6383343" data-respondelement="respond" data-replyto="Reply to Raymond E Rogers" aria-label='Reply to Raymond E Rogers'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6383348" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2 parent">
			<article id="div-comment-6383348" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/#comment-6383348"><time datetime="2022-01-27T15:09:35+00:00">January 27, 2022 at 3:09 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I&#8217;m interested in hearing what aspects of which sort of updates were blocked&#8230; you can email me if you like. That&#8217;s not an official reporting channel &#8211; for that you will need to talk to your usual support person or account manager if you have one &#8211; but if you like I can pass on any findings if we uncover anythjing useful. (By which I mean that I am interested in hearing about this, but you are welcome to talk directly to the support people at the same time if you like&#8230;)</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6383348"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6383348={"id":7238218,"unique_id":"wp-comment-6383348","title":"I%26%23039%3Bm%20interested%20in%20hearing%20what%20aspects%20of%20which%20sort%20of%20updates%20were%20blocked...%20you%20can%20email%20me%20if%20you%20like.%20That%26%23039%3Bs%20not%20an%20official%20reporting%20channel%20-%20for%20that%20you%20will%20need%20to%20talk%20to%20your%20usu%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/01\/26\/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do\/#comment-6383348","item_id":"_comm_6383348"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/?replytocom=6383348#respond' data-commentid="6383348" data-postid="669123" data-belowelement="div-comment-6383348" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6383349" class="comment byuser comment-author-pducklin bypostauthor even depth-3">
			<article id="div-comment-6383349" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/#comment-6383349"><time datetime="2022-01-27T15:12:53+00:00">January 27, 2022 at 3:12 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>PS. As an earlier commenter mentioned, it looks as though Ubuntu isn&#8217;t getting 0.120 but has &#8220;backpatched&#8221; the fixes to 0.105, giving it a sub-version ID, something like 0.105-31 (sub-number seems to depend on which release of Ubuntu you have). Confusing, to be sure, but it means you may already have the patch. However, without doenload the source code, it&#8217;s hard to be sure what changed :&#045;)</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6383349"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6383349={"id":7238218,"unique_id":"wp-comment-6383349","title":"PS.%20As%20an%20earlier%20commenter%20mentioned%2C%20it%20looks%20as%20though%20Ubuntu%20isn%26%23039%3Bt%20getting%200.120%20but%20has%20%26quot%3Bbackpatched%26quot%3B%20the%20fixes%20to%200.105%2C%20giving%20it%20a%20sub-version%20ID%2C%20something%20like%200.105-31%20%28sub-number%20seem%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/01\/26\/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do\/#comment-6383349","item_id":"_comm_6383349"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/?replytocom=6383349#respond' data-commentid="6383349" data-postid="669123" data-belowelement="div-comment-6383349" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-6383398" class="comment odd alt depth-3">
			<article id="div-comment-6383398" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/52b3f0c7327ea34687c12215c7340b7a?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/52b3f0c7327ea34687c12215c7340b7a?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Raymond E Rogers</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/#comment-6383398"><time datetime="2022-01-27T21:49:31+00:00">January 27, 2022 at 9:49 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>On Ubuntu Mate impish<br />
sudo /usr/bin/pkexec &#8211;version<br />
 just gives<br />
pkexec version 0.105<br />
I have to go to the package level<br />
apt list policykit-1<br />
policykit-1/impish-updates,impish-security,now 0.105-31ubuntu0.1 amd64 [installed,automatic]<br />
I googled into history and found several CVE&#8217;s.  It&#8217;s looks as though they don&#8217;t have good control of the code.  I think I will leave the suid off for a while and see if that causes problems (and keep my opinions to myself).<br />
https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=polkit<br />
I will email you when I have a couple of premission denied.  They are pretty consistant.<br />
Thanks<br />
Ray</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6383398"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6383398={"id":7238218,"unique_id":"wp-comment-6383398","title":"On%20Ubuntu%20Mate%20impish%20sudo%20%2Fusr%2Fbin%2Fpkexec%20--version%20just%20givespkexec%20version%200.105I%20have%20to%20go%20to%20the%20package%20levelapt%20list%20policykit-1policykit-1%2Fimpish-updates%2Cimpish-security%2Cnow%200.105-31ubun%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/01\/26\/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do\/#comment-6383398","item_id":"_comm_6383398"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/?replytocom=6383398#respond' data-commentid="6383398" data-postid="669123" data-belowelement="div-comment-6383398" data-respondelement="respond" data-replyto="Reply to Raymond E Rogers" aria-label='Reply to Raymond E Rogers'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-6384253" class="comment even depth-3 parent">
			<article id="div-comment-6384253" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/7f073c130387aca1739950c583809cf6?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7f073c130387aca1739950c583809cf6?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Raymond E Rogers</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/#comment-6384253"><time datetime="2022-02-02T15:37:04+00:00">February 2, 2022 at 3:37 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>My latest kernel upgrade had a block, I can open up a Dropbox folder or email you the messages.  How do I email you?  BTW: there are no system particulars since the blocking has been going on for years; but I will add the current system particulars if wanted.<br />
BTW: The Sophos site relating to migration (? some pages yes/no) of free home Linux is incoherent.   Some pages show it being supported out to some time in 2022 and other pages have updates cancelled after Dec 2021 (or in  another case Jan 10 2022).  I tried going through sales support and got nowhere.<br />
Where do I get the &#8220;true&#8221; policy?</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6384253"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6384253={"id":7238218,"unique_id":"wp-comment-6384253","title":"My%20latest%20kernel%20upgrade%20had%20a%20block%2C%20I%20can%20open%20up%20a%20Dropbox%20folder%20or%20email%20you%20the%20messages.%20%20How%20do%20I%20email%20you%3F%20%20BTW%3A%20there%20are%20no%20system%20particulars%20since%20the%20blocking%20has%20been%20going%20on%20for%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/01\/26\/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do\/#comment-6384253","item_id":"_comm_6384253"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/?replytocom=6384253#respond' data-commentid="6384253" data-postid="669123" data-belowelement="div-comment-6384253" data-respondelement="respond" data-replyto="Reply to Raymond E Rogers" aria-label='Reply to Raymond E Rogers'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6384267" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-4">
			<article id="div-comment-6384267" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/#comment-6384267"><time datetime="2022-02-02T16:36:56+00:00">February 2, 2022 at 4:36 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>There isn&#8217;t a Sophos Free Anti-Virus for Linux any more, I&#8217;m afraid. (The new version can&#8217;t be used in a standalone way like the old one; it is based on Sophos Central and there isn&#8217;t [2022-02-02] a free Sophos Central setup.)</p>
<p>IIRC, you can keep using the old version if you already have it installed, but you can no longer acquire the installer, so &#8220;new free licences&#8221; are not possible. As for when the free updates end&#8230; I am not sure. I will report your confusion and try to find out, not least because I would like to know myelf :&#045;)</p>
<p>As for emailing me, you can just use tips@sophos.com. (I am usually the first to see those emails, but it&#8217;s worth specifically mentioning somewhere in the message that it&#8217;s meant for me.)</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6384267"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6384267={"id":7238218,"unique_id":"wp-comment-6384267","title":"There%20isn%26%23039%3Bt%20a%20Sophos%20Free%20Anti-Virus%20for%20Linux%20any%20more%2C%20I%26%23039%3Bm%20afraid.%20%28The%20new%20version%20can%26%23039%3Bt%20be%20used%20in%20a%20standalone%20way%20like%20the%20old%20one%3B%20it%20is%20based%20on%20Sophos%20Central%20and%20there%20isn%26%23039%3Bt%20%26%23091%3B2022-02-02%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/01\/26\/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do\/#comment-6384267","item_id":"_comm_6384267"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/?replytocom=6384267#respond' data-commentid="6384267" data-postid="669123" data-belowelement="div-comment-6384267" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6383397" class="comment even thread-even depth-1 parent">
			<article id="div-comment-6383397" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/982e43a1dca931af2731781b9267d4d1?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/982e43a1dca931af2731781b9267d4d1?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Kyle</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/#comment-6383397"><time datetime="2022-01-27T20:46:46+00:00">January 27, 2022 at 8:46 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I don&#8217;t (fully) blame pkexec, here. As per POSIX, the Linux kernel *should* disallow things running without argv[0], but up to now didn&#8217;t. It truly is a reasonable assumption. A lot of applications can be broken this way. IMO this is a kernel bug.</p>
<p>I see a Linux kernel patch has been released to address this: https://lore.kernel.org/lkml/20220126043947.10058-1-ariadne@dereferenced.org/T/</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6383397"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6383397={"id":7238218,"unique_id":"wp-comment-6383397","title":"I%20don%26%23039%3Bt%20%28fully%29%20blame%20pkexec%2C%20here.%20As%20per%20POSIX%2C%20the%20Linux%20kernel%20%2Ashould%2A%20disallow%20things%20running%20without%20argv%26%23091%3B0%26%23093%3B%2C%20but%20up%20to%20now%20didn%26%23039%3Bt.%20It%20truly%20is%20a%20reasonable%20assumption.%20A%20lot%20of%20applicatio%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/01\/26\/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do\/#comment-6383397","item_id":"_comm_6383397"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/?replytocom=6383397#respond' data-commentid="6383397" data-postid="669123" data-belowelement="div-comment-6383397" data-respondelement="respond" data-replyto="Reply to Kyle" aria-label='Reply to Kyle'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6383404" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2">
			<article id="div-comment-6383404" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/#comment-6383404"><time datetime="2022-01-27T22:40:37+00:00">January 27, 2022 at 10:40 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Simple patch! EFAULT (bad address) if argc &lt; 1, easy!</p>
<p>The Linux Programmer&#039;s Manual (a.k.a. &#039;man execve&#039;) says simply, &quot;By convention [&#8230;] argv[0] should contain the filename associated with the file being executed. The argv array must be terminated by a NULL pointer. (Thus [&#8230;] argv[argc] will be NULL.&quot;</p>
<p>Note the words SHOULD, MUST and WILL &#8211; even after patch goes through I would recommend that code along the lines of &#039;for (i=1; argv[i]; i++) { &#8230; }&#039; should be avoided. After all, if argv[] and envp[] were not contiguous, an exploit of this sort would not be possible but there would still be a buffer read overflow. Even &#039;for (i=1; i&lt;argc &amp;&amp; argv[i]; i++) { &#8230; }&#039; would be better&#8230;</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6383404"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6383404={"id":7238218,"unique_id":"wp-comment-6383404","title":"Simple%20patch%21%20EFAULT%20%28bad%20address%29%20if%20argc%20%26lt%3B%201%2C%20easy%21The%20Linux%20Programmer%26%23039%3Bs%20Manual%20%28a.k.a.%20%26%23039%3Bman%20execve%26%23039%3B%29%20says%20simply%2C%20%26quot%3BBy%20convention%20%26%23091%3B...%26%23093%3B%20argv%26%23091%3B0%26%23093%3B%20should%20contain%20the%20filena%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/01\/26\/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do\/#comment-6383404","item_id":"_comm_6383404"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/?replytocom=6383404#respond' data-commentid="6383404" data-postid="669123" data-belowelement="div-comment-6383404" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6385764" class="comment even thread-odd thread-alt depth-1">
			<article id="div-comment-6385764" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/c7d65f704ecde3d1b63c2b20c11c71b0?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c7d65f704ecde3d1b63c2b20c11c71b0?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Mark R.</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/#comment-6385764"><time datetime="2022-02-11T21:56:18+00:00">February 11, 2022 at 9:56 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Does anyone have a suggestion on how to determine if any applications on my system are using pkexec (short of watching what breaks after changing the setuid bit)?  And, if so, which applications are using it?  I don&#8217;t think searching all the source code is practical.  Not to mention, what if it&#8217;s used by a third party for which I don&#8217;t have the source code.  For example, is there a way to get Linux to audit an executable and write to syslog every time it is accessed?  Just a thought.</p>
<p>Thanks in advance for any suggestions.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6385764"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6385764={"id":7238218,"unique_id":"wp-comment-6385764","title":"Does%20anyone%20have%20a%20suggestion%20on%20how%20to%20determine%20if%20any%20applications%20on%20my%20system%20are%20using%20pkexec%20%28short%20of%20watching%20what%20breaks%20after%20changing%20the%20setuid%20bit%29%3F%20%20And%2C%20if%20so%2C%20which%20applications%20%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/01\/26\/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do\/#comment-6385764","item_id":"_comm_6385764"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/?replytocom=6385764#respond' data-commentid="6385764" data-postid="669123" data-belowelement="div-comment-6385764" data-respondelement="respond" data-replyto="Reply to Mark R." aria-label='Reply to Mark R.'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">What do you think? <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2022/01/26/pwnkit-security-bug-gets-you-root-on-most-linux-distros-what-to-do/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://nakedsecurity.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comment <span class="required" aria-hidden="true">*</span></label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='669123' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="e927e7ea75" /></p><p style="display: none !important;"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="188"/><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
	
</div><!-- #comments -->
		<div class="comments-widget-area">
					</div>
	
	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	

	<section class="recommended-panel">
	<div class="container">
	<div class="panel-content ">

		<h3 class="block-title">Recommended reads</h3>
	<div class="blocks">
		<article id="post-676086" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2022/02/21/french-cybercriminals-using-sextortion-scams-with-no-text-or-links/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/02/faux-1200.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Feb</span><span class="day">21</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">1</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2022/02/21/french-cybercriminals-using-sextortion-scams-with-no-text-or-links/" rel="bookmark">French speakers blasted by sextortion scams with no text or links</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-659097" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2022/01/08/honda-cars-in-flashback-to-2002-cant-get-you-out-of-my-head/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/01/2002-1200.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Jan</span><span class="day">08</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">7</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2022/01/08/honda-cars-in-flashback-to-2002-cant-get-you-out-of-my-head/" rel="bookmark">Honda cars in flashback to 2002&nbsp;&#8211; &#8220;Can&#8217;t Get You Out Of My Head&#8221;</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-647654" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2021/12/23/the-cool-retro-phone-with-a-real-dial-plus-plenty-of-iot-problems/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/12/fpcp-1200.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Dec</span><span class="day">23</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">2</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2021/12/23/the-cool-retro-phone-with-a-real-dial-plus-plenty-of-iot-problems/" rel="bookmark">The cool retro phone with a REAL DIAL&#8230; plus plenty of IoT problems</a></h3>	</div>
</article> <!-- .card-article -->
	</div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="footer-container">
			<a href="#" class="js-collapse-footer"><svg style="height: 20px" viewBox="0 0 132 24" class="block icon sophos"><use xlink:href="#sophos"></use></svg></a>
			<div id="collapseFooter" class="blocks">
				<div class="sophos block">
					<ul id="menu-footer-primary" class="primary menu"><li id="menu-item-306737" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306737"><a href="https://nakedsecurity.sophos.com/about/">About Naked Security</a></li>
<li id="menu-item-306754" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306754"><a href="https://www.sophos.com/en-us/company.aspx">About Sophos</a></li>
<li id="menu-item-306747" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306747"><a href="https://nakedsecurity.sophos.com/send-us-a-tip/">Send us a tip</a></li>
<li id="menu-item-323171" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323171"><a href="/cookies-and-scripts/">Cookies</a></li>
<li id="menu-item-323170" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323170"><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
<li id="menu-item-323169" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323169"><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
</ul>				</div>
										<div class="news block">
							<ul id="menu-products-column-one" class="small menu"><li id="menu-item-306998" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306998"><a href="https://www.sophos.com/en-us/products/intercept-x.aspx">Intercept X</a></li>
<li id="menu-item-440801" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440801"><a href="https://www.sophos.com/en-us/products/server-security.aspx">Intercept X for Server</a></li>
<li id="menu-item-440802" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440802"><a href="https://www.sophos.com/en-us/products/mobile-control.aspx">Intercept X for Mobile</a></li>
</ul>						</div>
											<div class="products block">
							<ul id="menu-products-column-two" class="small menu"><li id="menu-item-440803" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440803"><a href="https://www.sophos.com/en-us/products/next-gen-firewall.aspx">XG Firewall</a></li>
<li id="menu-item-440805" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440805"><a href="https://www.sophos.com/en-us/products/sophos-email.aspx">Sophos Email</a></li>
<li id="menu-item-440804" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440804"><a href="https://www.sophos.com/en-us/products/secure-wifi.aspx">Sophos Wireless</a></li>
</ul>						</div>
											<div class="threats block">
							<ul id="menu-server-protection" class="small menu"><li id="menu-item-440806" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440806"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx">Managed Threat Response</a></li>
<li id="menu-item-448404" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-448404"><a href="https://www.sophos.com/en-us/products/cloud-optix.aspx">Cloud Optix</a></li>
<li id="menu-item-440807" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440807"><a href="https://www.sophos.com/en-us/products/phish-threat.aspx">Phish Threat</a></li>
</ul>						</div>
								</div>
			<ul class="block social footer">
				<li class="twitter"><a rel="nofollow" href="https://twitter.com/NakedSecurity" title="Follow our team of security experts on Twitter"><svg style="height: 14px" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
				<li class="facebook"><a rel="nofollow" href="https://www.facebook.com/SophosSecurity" title="Join over 250,000 people in our Facebook community"><svg style="height: 14px" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
				<li class="instagram"><a rel="nofollow" href="https://www.instagram.com/nakedsecurity/" title="Follow Naked Security on Instagram"><svg style="height: 14px" viewBox="0 0 100 100" class="icon instagram"><use xlink:href="#instagram"></use></svg></a></li>
				<li class="linkedin"><a rel="nofollow" href="https://www.linkedin.com/company/5053/" title="Join the naked security discussion group on LinkedIn"><svg style="height: 14px" viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
				<li class="rss"><a rel="nofollow" href="/feed" title="Subscribe to our RSS feed"><svg style="height: 14px" viewBox="0 0 100 100" class="icon rss"><use xlink:href="#rss"></use></svg></a></li>
			</ul>

							<div class="vip-powered-wpcom">
					<span class="copyright">© 1997 - 2022 Sophos Ltd.</span>
					All rights reserved.
					Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=nakedsecurity.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>				</div>
					</div>
		<script type="text/javascript">
			window.cookieconsent_options = {
				"message":"This site uses cookies. By continuing to browse the site you are agreeing to our use of cookies.",
				"dismiss":"Got it!",
				"learnMore":"Learn More",
				"link":"/cookies-and-scripts",
				"theme":"https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/css/sophos.css"};
		</script>
	</footer><!-- #colophon -->
</div><!-- #page -->
<div id="survey-wrapper" class="mfp-hide"><div class="pd-embed" id="pd_1499706777" data-settings=""></div></div>
<script type="text/javascript" src="https://nakedsecurity.sophos.com/_static/??-eJzTLy/QTc7PK0nNK9EvyClNz8wr1i+uzCtJrMjITM/IAeKS1CJMEWP94uSizIISoOIM5/yiVL2sYh19yo1yKioFmldQADTOPtfW0MwECA2NLE2zAI8tP6w=" ></script><script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://nakedsecurity.sophos.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.head.appendChild( corecss );
		var themecssurl = "https://nakedsecurity.sophos.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		document.head.appendChild( themecss );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

	// Infinite scroll support
	if ( typeof( jQuery ) !== 'undefined' ) {
		jQuery( function( $ ) {
			$( document.body ).on( 'post-load', function() {
				SyntaxHighlighter.highlight();
			} );
		} );
	}
</script>
<script id='child-js-plugins-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"0","nextLink":""};
</script>
<script id='child-js-core-js-extra'>
var Sophos = {"ajaxurl":"https:\/\/nakedsecurity.sophos.com\/wp-admin\/admin-ajax.php","nonce":"d5e0f490a3"};
</script>
<script type="text/javascript" src="https://nakedsecurity.sophos.com/_static/??-eJyNy0EKgCAQQNELZZNRuYoOY0MqziiOEd0+Cdq3/bwPV1Y2cUWuUB0SCkjKLgnjJWoc9AxBIMfz8Cx9kA5+DTYV/LRnG8+9ubcTtVMVzPHuyXNDG616mcyi52k04QEeXTNs" ></script><script src='https://stats.wp.com/e-202212.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:10.7',blog:'166161173',post:'669123',tz:'0',srv:'nakedsecurity.sophos.com'} ]);
	_stq.push([ 'clickTrackerInit', '166161173', '669123' ]);
</script>
</body>
</html>
