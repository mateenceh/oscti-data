<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="RHQeasQqjasbRt5asY6atZYbs5tr10gFBevDt2HRhW0" />
<link rel="pingback" href="https://nakedsecurity.sophos.com/xmlrpc.php">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5VK6LTK');</script>
<!-- End Google Tag Manager -->

<meta name="description" content="More trouble with special-purpose URLs on Windows." />
<meta name="keywords" content="microsoft, vulnerability, url, vulnerability, windows" />
<title>Yet another zero-day (sort of) in Windows &#8220;search URL&#8221; handling &#8211; Naked Security</title>
<meta name='robots' content='max-image-preview:large' />
<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="I9dHFo-YhnK2MfAHn-20V4GnWrOttVUYyISGamyU41M" />
<meta name="msvalidate.01" content="7D8D1FA2892142B1543D2CBCD07FB88F" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Feed" href="https://nakedsecurity.sophos.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Comments Feed" href="https://nakedsecurity.sophos.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Naked Security &raquo; Yet another zero-day (sort of) in Windows &#8220;search URL&#8221; handling Comments Feed" href="https://nakedsecurity.sophos.com/2022/06/02/yet-another-zero-day-sort-of-in-windows-search-url-handling/feed/" />
<link rel='stylesheet' id='all-css-0' href='https://nakedsecurity.sophos.com/_static/??-eJyNj9EOwjAIRX/IShZ1cQ/Gb+komSjtmsJi+vfOmSXbm48XOMCBd3acUKZACqgKgdWglxFfTrgvvlRQq0LHyOk4DxxgSzwVIgX2JBQp2S5k8ZWKExo81v/wubfNOwjHZMuJyWWZBk4KSr7gA0i8GmMutP7/FSlz2Si4PKqp+xktJrquvcdb017OTdeert0HN5hjCA==' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='global-styles-inline-css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel='stylesheet' id='all-css-2' href='https://nakedsecurity.sophos.com/_static/??-eJydj0sOwjAMRC+E4wZoRRaIs4RgEUp+1I4qbk+LWERig9iNPPOsGZwLuJyEkmCsUEK93hLjI7Yyn0dyAs46T+iYkeUZSC1qgw0vniItZi4+c6KZYdvp/o8wBCvE8iuzNrIXJX4iK+DrEp6UjeWLbwaOJMW6O+hOmfeDz2FlTvGoh36vzbA7mBenRGiN' type='text/css' media='all' />
<script type="text/javascript" src="https://nakedsecurity.sophos.com/_static/??-eJzTLy/QzcxLzilNSS3WzwKiwtLUokoopZebmaeXVayjj0+Rbm5melFiSSpUsX2uraGZqbGlsaWFiUUWAK+/IjA=" ></script><link rel="https://api.w.org/" href="https://nakedsecurity.sophos.com/wp-json/" /><link rel="alternate" type="application/json" href="https://nakedsecurity.sophos.com/wp-json/wp/v2/posts/724454" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://nakedsecurity.sophos.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://nakedsecurity.sophos.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 6.0" />
<link rel="canonical" href="https://nakedsecurity.sophos.com/2022/06/02/yet-another-zero-day-sort-of-in-windows-search-url-handling/" />
<link rel='shortlink' href='https://nakedsecurity.sophos.com/?p=724454' />
<link rel="alternate" type="application/json+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2022%2F06%2F02%2Fyet-another-zero-day-sort-of-in-windows-search-url-handling%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://nakedsecurity.sophos.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2022%2F06%2F02%2Fyet-another-zero-day-sort-of-in-windows-search-url-handling%2F&#038;format=xml" />
<style type='text/css'>img#wpstats{display:none}</style>
	<link rel="amphtml" href="https://nakedsecurity.sophos.com/2022/06/02/yet-another-zero-day-sort-of-in-windows-search-url-handling/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Yet another zero-day (sort of) in Windows &#8220;search URL&#8221; handling" />
<meta property="og:url" content="https://nakedsecurity.sophos.com/2022/06/02/yet-another-zero-day-sort-of-in-windows-search-url-handling/" />
<meta property="og:description" content="More trouble with special-purpose URLs on Windows." />
<meta property="article:published_time" content="2022-06-02T19:39:57+00:00" />
<meta property="article:modified_time" content="2022-06-02T21:32:25+00:00" />
<meta property="og:site_name" content="Naked Security" />
<meta property="og:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/06/srch-1200.jpg?w=775" />
<meta property="og:image:secure_url" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/06/srch-1200.jpg?w=775" />
<meta property="og:image:width" content="775" />
<meta property="og:image:height" content="406" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta property="fb:admins" content="28552295016" />
<meta name="twitter:creator" content="@NakedSecurity" />
<meta name="twitter:site" content="@NakedSecurity" />
<meta name="twitter:text:title" content="Yet another zero-day (sort of) in Windows &#8220;search URL&#8221; handling" />
<meta name="twitter:image" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/06/srch-1200.jpg?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=32" sizes="32x32" />
<link rel="icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=192" sizes="192x192" />
<link rel="apple-touch-icon" href="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=180" />
<meta name="msapplication-TileImage" content="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/03/cropped-sophos.png?w=270" />
</head>
<body class="post-template-default single single-post postid-724454 single-format-standard" >
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VK6LTK"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div style="display: none">
<svg>
	<symbol id="sophos" viewBox="0 0 132 24">
		<path d="m111.82 22.176h11.64c3.267 0 4.65-0.2 5.74-0.896 1.715-1.063 2.804-3.26 2.804-5.62 0-1.928-0.658-3.89-1.647-4.888-1.288-1.33-3.035-1.828-6.271-1.828h-3.527c-1.586 0-2.754-0.067-3.412-0.365-0.794-0.367-1.256-1.165-1.256-2.161 0-1.165 0.56-2.03 1.486-2.264 0.692-0.163 1.498-0.163 3.574-0.198h10.419v-3.956h-11.473c-2.574 0-3.727 0.099-4.718 0.466-2.279 0.796-3.828 3.257-3.828 6.083 0 1.93 0.76 3.727 2.079 4.89 1.155 0.996 2.872 1.462 5.51 1.462h4.697c1.057 0 1.915 0.132 2.376 0.398 0.893 0.433 1.418 1.328 1.418 2.36 0 0.864-0.395 1.597-1.087 2.027-0.561 0.369-1.517 0.534-3.268 0.534h-11.256zm-111.35 0h11.64c3.267 0 4.652-0.2 5.741-0.896 1.714-1.063 2.803-3.26 2.803-5.62 0-1.928-0.66-3.89-1.65-4.888-1.285-1.33-3.034-1.828-6.27-1.828h-3.527c-1.584 0-2.751-0.067-3.41-0.365-0.792-0.367-1.253-1.165-1.253-2.161 0-1.165 0.56-2.03 1.484-2.264 0.693-0.163 1.496-0.163 3.574-0.198h10.42v-3.956h-11.477c-2.573 0-3.727 0.099-4.715 0.466-2.278 0.796-3.83 3.257-3.83 6.083 0 1.93 0.762 3.727 2.08 4.89 1.155 0.996 2.871 1.462 5.51 1.462h4.696c1.057 0 1.913 0.132 2.377 0.398 0.888 0.433 1.416 1.328 1.416 2.36 0 0.864-0.394 1.597-1.089 2.027-0.558 0.369-1.517 0.534-3.264 0.534h-11.256v3.956zm94.05-16.18c-0.68 1.076-1.003 2.803-1.003 5.122 0 5.088 1.747 7.405 5.63 7.405 3.822 0 5.568-2.317 5.568-7.34 0-5.092-1.715-7.373-5.568-7.373-2.102 0-3.754 0.784-4.627 2.186zm13.174-2.511c1.329 1.761 2.072 4.63 2.072 7.992 0 3.816-1.197 6.948-3.334 8.677-1.619 1.304-4.078 2.022-6.995 2.022-4.142 0-7.41-1.372-9.092-3.817-1.263-1.793-1.88-4.176-1.88-7.08 0-4.172 1.133-7.339 3.27-9.035 1.682-1.37 4.339-2.122 7.383-2.122 3.85 0 6.925 1.209 8.576 3.363zm-22.018-3.068h-4.596v8.908h-8.319v-8.908h-4.597v21.759h4.597v-8.97h8.318v8.97h4.596v-21.759zm-28.61 10.277c1.23 0 1.941-0.163 2.427-0.62 0.581-0.49 0.938-1.533 0.938-2.74 0-1.436-0.58-2.478-1.584-2.838-0.356-0.13-0.94-0.197-1.684-0.197h-6.344v6.395zm-6.247 11.481h-4.598v-21.758h10.78c3.786 0 5.114 0.39 6.538 1.991 1.264 1.37 1.942 3.163 1.942 5.088 0 2.284-0.904 4.404-2.394 5.676-1.262 1.077-2.43 1.402-4.888 1.402h-7.38zm-22.589-16.179c-0.682 1.076-1.004 2.803-1.004 5.122 0 5.088 1.748 7.405 5.634 7.405 3.818 0 5.568-2.317 5.568-7.34 0-5.092-1.716-7.373-5.568-7.373-2.106 0-3.757 0.784-4.63 2.186zm13.174-2.511c1.328 1.761 2.073 4.63 2.073 7.992 0 3.816-1.2 6.948-3.335 8.677-1.618 1.304-4.079 2.022-6.993 2.022-4.144 0-7.413-1.372-9.096-3.817-1.264-1.793-1.878-4.176-1.878-7.08 0-4.172 1.133-7.339 3.272-9.035 1.681-1.37 4.337-2.122 7.38-2.122 3.851 0 6.93 1.209 8.578 3.363z"></path>
	</symbol>
	<symbol id="twitter" viewBox="0 0 24 24">
 		<path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path>
 	</symbol>
	<symbol id="facebook" viewBox="0 0 24 24">
 		<path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path>
 	</symbol>
	<symbol id="instagram" viewBox="0 0 24 24">
		<path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path>
	</symbol>
	<symbol id="linkedin" viewBox="0 0 24 24">
		<path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"></path>
	</symbol>
	<symbol id="rss" viewBox="0 0 24 24">
		<path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"></path>
	</symbol>
	<symbol id="reddit" viewBox="0 0 24 24">
		<path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"></path>
	</symbol>
</svg>
</div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header variation variation-3" role="banner">
		<div class="header-container">
			<div class="site-branding">
				<div class="site-title">
					<a title="Naked Security" href="https://nakedsecurity.sophos.com/" rel="home"><img src="https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/img/naked-security-logo-white@2x.png"></a>
					by
					<a title="sophos.com" href="https://www.sophos.com"><svg viewBox="0 0 132 24" class="icon sophos"><use xlink:href="#sophos"></use></svg></a>
				</div>
			</div><!-- .site-branding -->
			<nav id="site-navigation" class="main-navigation" role="navigation">
				<div class="container">
					<ul id="menu-variation-two" class="exit-links menu"><li id="menu-item-436509" class="products menu-item menu-item-type-custom menu-item-object-custom menu-item-436509"><a href="#">Products</a></li>
<li id="menu-item-436515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436515"><a href="https://www.sophos.com/en-us/products/free-tools.aspx">Free Tools</a></li>
<li id="menu-item-436531" class="search-toggle menu-item menu-item-type-custom menu-item-object-custom menu-item-436531"><a href="#">Search</a></li>
<li id="menu-item-436532" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-436532"><a href="https://home.sophos.com/en-us.aspx">Free Sophos Home</a></li>
</ul>				</div>
			</nav><!-- #site-navigation -->
			<div class="site-search-block">
	<form target="_top" role="search" class="search-form" method="get" action="https://nakedsecurity.sophos.com/">
        <fieldset>
            <div class="field">
				<input type="search" value="" name="s" class="search-field" placeholder="Search naked security...">
            </div>
            <div class="submit">
				<button type="submit" class="search-submit button">Go</button>
            </div>
        </fieldset>
    </form>
</div>
		</div><!-- .container -->
	</header>

	<div class="responsive-flyout-panel small-12 column active" style="opacity: 1; display: none;">
		<div class="modal-filler"></div>
	    <div class="productNavBox">
	        <div class="productNavContainer">
	            <div class="row prodRow">
	                <div class="prodListBox column large-9">
	                    <div class="row margin-0 highlightProduct">
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/next-gen-firewall.aspx"><img src="https://www.sophos.com/medialibrary/2F4785DE8C3F43ECBD699A18F332FEEB.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">XG Firewall</div>
	                                	<div class="menu-section-subtitle">Next-Gen Firewall</div>
									</div>
	                            </a>
	                        </div>
	                        <div class="column medium-6">
	                            <a href="https://www.sophos.com/products/intercept-x.aspx"><img src="https://www.sophos.com/medialibrary/27111765D65A45D49A232925D2CE428B.ashx">
	                                <div class="menu-section-header">
										<div class="menu-section-title">Intercept X</div>
	                                	<div class="menu-section-subtitle">Next-Gen Endpoint</div>
									</div>
	                            </a>
	                        </div>
	                    </div>
	                    <div class="productList">
	                        <ul>
								<li>
									<a href="https://www.sophos.com/en-us/products/cloud-optix.aspx"><img src="https://www.sophos.com/medialibrary/SophosNext/Images/Products/Icons/sophos-cloud-optix-icon.svg">Sophos Cloud Optix</a>
								</li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-central.aspx"><img src="https://www.sophos.com/medialibrary/08EA66123F1B4DDE8FE5C9B578A7FAA7.ashx">Sophos Central</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/mobile-control.aspx"><img src="https://www.sophos.com/medialibrary/678FE994855047739F50D6C411184FA6.ashx">Sophos Mobile</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/server-security.aspx"><img src="https://www.sophos.com/medialibrary/01B80E7D7CD54EF8AC2E51C9C6EC0236.ashx">Intercept X for Server</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-wifi.aspx"><img src="https://www.sophos.com/medialibrary/BEBD9C41BB4E480498514B29B92A145A.ashx">Secure Wi-Fi</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/phish-threat.aspx"><img src="https://www.sophos.com/medialibrary/DC9D1A7BA3964B0C9DAF1F1E68806B5A.ashx">Phish Threat</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/safeguard-encryption.aspx"><img src="https://www.sophos.com/medialibrary/8F51F06B62814B108D3B2763FF018E37.ashx">SafeGuard Encryption</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/sophos-email.aspx"><img src="https://www.sophos.com/medialibrary/597ADA0AF01A4A12B2B27239D0F9992C.ashx">Secure Email</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/unified-threat-management.aspx"><img src="https://www.sophos.com/medialibrary/8CB72BF5E1AD41F7894CE5E42101B0F3.ashx">SG UTM</a>
	                            </li>
	                            <li>
	                                <a href="https://www.sophos.com/products/secure-web-gateway.aspx"><img src="https://www.sophos.com/medialibrary/C586E372694547A1B207A61D87246BA7.ashx">Secure Web Gateway</a>
	                            </li>
	                        </ul>
	                    </div>
	                </div>
	                <div class="homeUserBox column large-3">
						<img src="https://www.sophos.com/medialibrary/3376DF5742A64AEE93FDB9DCA7291239.ashx">
						<div class="menu-section-title">For Home Users</div>
	                    <p>Sophos Home protects every Mac and PC in your home </p><a href="https://home.sophos.com/" target="_blank" class="greenSmallMenuBtn">Learn More</a>
					</div>
	            </div>
	            <div class="row blueRow">
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-tools.aspx"><img width="19" src="https://www.sophos.com/medialibrary/A1FF440D2BB84511B8C94D771D44E207.ashx">Free Security Tools</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/free-trials.aspx"><img width="20" src="https://www.sophos.com/medialibrary/FCD3410ED2C347808D9DB8AC12C62DBD.ashx">Free Trials</a>
	                </div>
	                <div class="column large-3 medium-6">
	                    <a href="https://www.sophos.com/products/demos.aspx"><img width="18" src="https://www.sophos.com/medialibrary/50985180E5F54C94917A2A6508E24287.ashx">Product Demos</a>
	                </div>
	                <!-- <div class="column large-3 medium-6">
	                    <a href="javascript:fairfax.openLiveChatFromFlyoutLink();" class="flyout-live-chat-link"><img width="20" src="https://www.sophos.com/medialibrary/E24C5050837145F6A5C592E299BA2A0D.ashx">Live Sales Chat</a>
	                </div> -->
	            </div>
	        </div>
	    </div>
	</div>
	<script>

	jQuery(document).ready( function () {
		var productButton   = jQuery('nav .menu-item.products');
		var modalBackground = jQuery('.modal-filler');
		var flyoutMenu		= jQuery('.responsive-flyout-panel');
		var Sophos			= Sophos || {};

		Sophos.MenuTest = {};

		Sophos.MenuTest.open = function () {
				productButton.addClass('open');
				flyoutMenu.show();
				modalBackground.show();
		};

		Sophos.MenuTest.close = function () {
			productButton.removeClass('open');
			flyoutMenu.hide();
			modalBackground.hide();
		};

		Sophos.MenuTest.toggle = function () {
			if ( productButton.hasClass('open') ) {
				Sophos.MenuTest.close();
			} else {
				Sophos.MenuTest.open();
			}
		};

		productButton.click( Sophos.MenuTest.toggle );
		modalBackground.click( Sophos.MenuTest.close );
	});

	</script>

	
	<section class="about-panel">
	<div class="container">
	<div class="panel-content ">

		<div class="description"><span>Have you listened to our podcast? <a href="/podcast/">Listen now</a></span></div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	<div id="content" class="site-content">
		<div class="content-container">

</div> <!-- .container -->
</div> <!-- #content -->


	<section class="content-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

		<main id="main" class="site-main" role="main">

	
		
<article id="post-724454" class="post-724454 post type-post status-publish format-standard has-post-thumbnail hentry category-featured category-microsoft category-vulnerability tag-url tag-vulnerability-2 tag-windows">

	<header class="entry-header">
		<h1 class="entry-title">Yet another zero-day (sort of) in Windows &#8220;search URL&#8221; handling</h1>		<div class="entry-meta">
			<div>
				
	<span class="entry-published">
		<time class="entry-date published" datetime="2022-06-02T20:39:57+01:00">02 Jun 2022</time>
	</span>

					<a href="#comments" class="comment-box">
					<span class="count">7</span>
				</a>
					
	<span class="entry-categories">
	<a href="https://nakedsecurity.sophos.com/category/organisations/microsoft/">Microsoft</a>, <a href="https://nakedsecurity.sophos.com/category/security-threats/vulnerability/">Vulnerability</a>	</span>

			</div>
	</header> <!-- .entry-header -->

    <div id="newsletter-signup" class="container top"></div>

			<div class="entry-featured-image">
			<img width="780" height="408" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/06/srch-1200.jpg?w=780&amp;h=408&amp;crop=1" class="attachment-hero-thumbnail size-hero-thumbnail wp-post-image" alt="" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/06/srch-1200.jpg 1200w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/06/srch-1200.jpg?resize=300,157 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/06/srch-1200.jpg?resize=768,402 768w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/06/srch-1200.jpg?resize=1024,536 1024w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/06/srch-1200.jpg?resize=780,408 780w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/06/srch-1200.jpg?resize=100,52 100w" sizes="(max-width: 780px) 100vw, 780px" />					</div> <!-- .entry-featured-image -->
		
		<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2022/06/02/s3-ep85-now-thats-what-i-call-a-microsoft-office-exploit-podcast/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> S3 Ep85: Now THAT&#8217;S what I call a Microsoft Office exploit! [Podcast]</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2022/06/03/atlassian-announces-0-day-hole-in-confluence-collab-server-update-soon/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Atlassian announces 0-day hole in Confluence Server &#8211; update soon!</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	<div class="entry-content">
		<div class="entry-prefix">
			<div class="entry-author">
				
	
					<span class="by">by</span>
			<a href="https://nakedsecurity.sophos.com/author/paul-ducklin/" title="Posts by Paul Ducklin" class="author url fn" rel="author">Paul Ducklin</a>		
	
				</div>
			<div class="entry-sharing">
				
	<ul class="block social share">
		<li class="facebook"><a href="https://www.facebook.com/share.php?u=https%3A%2F%2Fnakedsecurity.sophos.com%2F2022%2F06%2F02%2Fyet-another-zero-day-sort-of-in-windows-search-url-handling%2F&title=Yet+another+zero-day+%28sort+of%29+in+Windows+%E2%80%9Csearch+URL%E2%80%9D+handling" data-title="Yet another zero-day (sort of) in Windows “search URL” handling" title="Share on Facebook"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
		<li class="twitter"><a href="https://twitter.com/intent/tweet?text=Yet+another+zero-day+%28sort+of%29+in+Windows+%E2%80%9Csearch+URL%E2%80%9D+handling+https%3A%2F%2Fnakedsecurity.sophos.com%2F%3Fp%3D724454" data-title="Yet another zero-day (sort of) in Windows &#8220;search URL&#8221; handling" title="Share on Twitter"><svg style="height: 20px;" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
		<li class="linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2022%2F06%2F02%2Fyet-another-zero-day-sort-of-in-windows-search-url-handling%2F&title=Yet+another+zero-day+%28sort+of%29+in+Windows+%E2%80%9Csearch+URL%E2%80%9D+handling" data-title="Yet another zero-day (sort of) in Windows “search URL” handling" title="Share on LinkedIn"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
		<li class="reddit"><a href="https://reddit.com/submit/?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2022%2F06%2F02%2Fyet-another-zero-day-sort-of-in-windows-search-url-handling%2F&title=Yet+another+zero-day+%28sort+of%29+in+Windows+%E2%80%9Csearch+URL%E2%80%9D+handling" title="Share on Reddit"><svg style="height: 20px;"  viewBox="0 0 100 100" class="icon reddit"><use xlink:href="#reddit"></use></svg></a></li>

			</ul>

				</div>
		</div>
		<p>Just as the dust started to settle on the weirdly-named <a href="https://nakedsecurity.sophos.com/2022/05/31/mysterious-follina-zero-day-hole-in-office-what-to-do/">Follina</a> vulnerability&#8230;</p>
<p>&#8230; along came another zero-day Windows security hole.</p>
<p>Sort of.</p>
<p>We&#8217;re not convinced that this one is quite as dramatic or as dangerous as some of the headlines seem to suggest (which is why we carefully added the words &#8220;sort of&#8221; above), but we&#8217;re not surprised that researchers are currently looking for new ways to abuse the many proprietary URL types in Windows.</p>
<aside id="sophos_ad-3" class="widget sophos-inline-ad sophos_widget_ad">				<style></style>
				<div class="sophos_widget_ad"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx" class="s-ad-threat-hunter__link-wrapper">
  <div class="s-ad-threat-hunter">
    <div class="s-ad-threat-hunter__title">
      OTHERS STOP AT NOTIFICATION. WE TAKE ACTION
    </div>
    <div class="s-ad-threat-hunter__text">
      Get 24/7 managed threat hunting, detection, and response delivered by
      Sophos experts
    </div>
    <div class="s-ad-threat-hunter__action">
      <span class="s-button s-button--bright-green"> Learn&nbsp;more </span>
    </div>
  </div>
</a></div>
			</aside>
<h2>URL schemes revisited</h2>
<p>To recap.</p>
<p>The <em>Follina</em> bug, now more properly known as <a href="https://nakedsecurity.sophos.com/2022/05/31/mysterious-follina-zero-day-hole-in-office-what-to-do/">CVE-2022-30190</a>, hinges on a weird, non-standard URL supported by the Windows operating system.</p>
<p>Loosely speaking, most URLs are structured so they tell you, or the software you&#8217;re using, where to go, how to get there, and what to ask for when you arrive.</p>
<p>For example, the URL&#8230;</p>
<pre>
   https://example.com/ask/forthis.item
</pre>
<p>&#8230;says, <em>&#8220;Use the scheme called https: to connect to a server called <code>example.com</code> and then request a file called <code>/ask/forthis.item</code>.&#8221;</em></p>
<p>Similarly, the URL&#8230; </p>
<pre>
   file:///Users/duck/thisone.txt
</pre>
<p>&#8230;says, <em>&#8220;Look for a file on the local computer called <code>thisone.txt</code> in the directory <code>/Users/duck</code>&#8220;</em>.</p>
<p>And the URL&#8230; </p>
<pre>
   ldap://192.169.1.79:8888/Runthis
</pre>
<p>&#8230;says, <em>&#8220;Do an <a href="https://nakedsecurity.sophos.com/2021/12/20/log4shell-the-movie-a-short-safe-visual-tour-for-work-and-home/">LDAP lookup</a> via TCP port 8888 to server <code>192.168.1.79</code>, and search for an object called <code>Runthis</code>.</em></p>
<p>But Windows includes a lengthy list of proprietary URL schemes (the letters up to the first colon character), also known as <em>protocol handlers</em>, that can be used to trigger a range of non-standard activities simply by referencing the special URL.</p>
<p>The Follina bug, for example, took devious advantage of the URL scheme <code>ms-msdt:</code>, which relates to system diagnostics.</p>
<div style="text-align:center">
<blockquote class="wp-embedded-content" data-secret="HcpzNR0BSY"><p><a href="https://nakedsecurity.sophos.com/2022/05/31/mysterious-follina-zero-day-hole-in-office-what-to-do/">Mysterious &#8220;Follina&#8221; zero-day hole in Office &#8211; here&#8217;s what to do!</a></p></blockquote>
<p><iframe class="wp-embedded-content" sandbox="allow-scripts" security="restricted" style="position: absolute; clip: rect(1px, 1px, 1px, 1px);" title="&#8220;Mysterious &#8220;Follina&#8221; zero-day hole in Office &#8211; here&#8217;s what to do!&#8221; &#8212; Naked Security" src="https://nakedsecurity.sophos.com/2022/05/31/mysterious-follina-zero-day-hole-in-office-what-to-do/embed/#?secret=ZscPLAiJFI#?secret=HcpzNR0BSY" data-secret="HcpzNR0BSY" width="600" height="338" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe>
</div>
<p>This <code>ms-msdt:</code> scheme, which we assume made sense at the time it was implemented even though it seems foolhardy now, says, <em>&#8220;Run the Microsoft Support Diagnostic Tool&#8221;</em>, a program called MSDT.EXE that is meant to walk you through a series of basic steps when troubleshooting a misbehaving app.</p>
<p>But a bunch of cybercriminals discovered that you can abuse the <code>ms-msdt:</code> protocol handler by means of a URL embedding inside a document or email that&#8217;s opened by Outlook or Office.</p>
<p>With a rogue <code>ms-msdt:</code> URL, attackers can not only silently launch the MSDT.EXE app on your computer, but also feed it a bunch of rogue PowerShell script code to force you into running malware of their choice.</p>
<p>Instead of helping you troubleshoot your computer, the crooks exploit MSDT into infecting it instead.</p>
<h2>The URLs you&#8217;ve never heard of</h2>
<p>It turns out that <code>ms-msdt:</code> isn&#8217;t the only weird-and-wonderful Windows-specific URL scheme that Microsoft has dreamed up.</p>
<p>There are numerous &#8220;helper&#8221; URL schemes, standard and non-standard, hooked up to protocol handlers via entries in the Windows registry.</p>
<p>These registry keys signify that special actions should be triggered when someone tries to access the relevant URLs.</p>
<p>For example, as you know from experience, accessing an <code>https:</code> URL usually fires up your browser, if it isn&#8217;t running already.</p>
<p>And, as we explained above, visiting an <code>ms-msdt:</code> URL fires up MSDT.EXE, although we suspect that very few people knew that before the start of this week. (We didn&#8217;t&nbsp;&ndash; we&#8217;d never used or even seen a URL of that type before the Follina story broke.)</p>
<p>Well, a cybersecurity researcher known as <a href="https://twitter.com/hackerfantastic" rel="nofollow">@hackerfantastic</a> has uncovered a Windows URL scheme called  <code>search-ms:</code> that could, like <code>ms-msdt:</code>, be misused for cybercriminal treachery.</p>
<p>As we&#8217;ve already said, we&#8217;re not quite convinced this sits in what we&#8217;d call &#8220;zero-day exploit&#8221; territory, because it doesn&#8217;t lead directly to unexpected remote code execution&#8230;</p>
<p>&#8230;but we accept that it&#8217;s a close call, and that you may want to block this special URL from working in future.</p>
<h2>The &#8220;search URL&#8221; trick</h2>
<p>Simply put, <code>search-ms:</code> URLs will pop up and perform a Windows search automatically, as though you&#8217;d clicked on the magnifying glass in the task bar yourself, entered text of your choice, and waited for the result.</p>
<p>And by embedding this type of URL in a document such as a DOC or RTF file, in much the same way that the Follina trick was pulled off, an attacker can therefore lure you into opening a document, and then automatically pop up an official-looking list of search results in association with it:</p>
<blockquote class="twitter-tweet" data-width="550" data-dnt="true">
<p lang="en" dir="ltr">Microsoft Office 2019 / Windows 10 / search-ms: URI handler exploitation and post-exploitation steps to SYSTEM. <a href="https://t.co/r512uF3vQ4">pic.twitter.com/r512uF3vQ4</a></p>
<p>&mdash; hackerfantastic.crypto (@hackerfantastic) <a href="https://twitter.com/hackerfantastic/status/1531793396423176193?ref_src=twsrc%5Etfw">June 1, 2022</a></p></blockquote>
<p><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></p>
<p>The attackers who embed the special URL in the booby-trapped document get to choose, in advance, what appears in the title of the search bar, and which files to display.</p>
<p>The files that show up don&#8217;t have to be locally-stored files such as <code>C:\Users\duck\mypreso.ppt</code>, but can be remote files (UNC paths) such as <code>\\live.sysinternals.com\psshutdown.exe</code> or <code>\\example.org\dodgy.exe</code>.</p>
<p>Of course, this doesn&#8217;t automatically launch the offending files, which is why we only consider this a &#8220;sort of&#8221; zero-day.</p>
<p>You still need to choose one of the files, double-click to execute it and react to a security warning, as you see in the Twitter video above.</p>
<p>Nevertheless, this trick certainly puts you much more believably into harm&#8217;s way than an old-school email lure with suspicious-looking web links in it.</p>
<p>The window that pops up isn&#8217;t a browser or an email client.</p>
<p>Instead, it looks just like what you&#8217;d see if you did a regular search on your local computer, and doesn&#8217;t contain anything that looks like a traditional web link.</p>
<h2>What to do?</h2>
<ul>
<li><strong>Never open files without double-checking their names.</strong> Don&#8217;t assume that files turning up in a Windows search dialog are local files you can trust, especially if the search isn&#8217;t one you initiated deliberately yourself. If in doubt, leave it out!
<li><strong>Turn on the Windows option to show file extensions.</strong> Annoyingly, Windows suppresses file extensions by default, so that a file such as <code>risky.exe</code> shows up merely as <code>risky</code>. This means that a file deliberately renamed to <code>readme.txt.exe</code> ends up apparently mislabelled as the innocent-looking <code>readme.txt</code>. Open <em>File Explorer</em> and go to <em>View</em> &gt; <em>File Name Extensions</em>.
<li><strong>Remember that remote filenames aren&#8217;t as obvious as web links.</strong> Windows allows you to access files by drive letter or by UNC path. A UNC path often refers to a server name on your own network, e.g. <code>\\MAINSRV</code>, but can equally well refer to remote servers on the internet, such as <code>\\files.example.com</code> or <code>\\198.51.100.42</code>. Double-clicking on a remote file specified as a UNC path will not only download it in the background from the specified server, but also launch it automatically once it&#8217;s arrived.
<li><strong>Consider deleting the registry entry <code>HKEY_CLASSES_ROOT\search-ms</code></strong>. This is a similar mitigation to the one <a href="https://nakedsecurity.sophos.com/2022/05/31/mysterious-follina-zero-day-hole-in-office-what-to-do/">used for the Follina bug</a>, where you delete the <code>ms-msdt</code> entry instead. This breaks the magic connection between clicking on a <code>search-ms:</code> URL and the activation of the search window. After deleting the registry entry, <code>search-ms:</code> URLs have no special meaning, and therefore don&#8217;t trigger anything.
<li><strong>Watch this space.</strong> We won&#8217;t be surprised if other proprietary Windows URLs make the cybersecurity news over the next few days or weeks, pressed into service for devious or even directly destructive purposes by cybercriminals, or simply just uncovered by researchers trying to push the limits of the system as it stands.
</ul>
<hr style='margin-top:2em'>
			</div> <!-- .entry-content -->
	<ul class="block social follow">
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon twitter"><use xlink:href="#twitter"></use></svg>
			<p>Follow <strong><a href="https://twitter.com/nakedsecurity">@NakedSecurity on Twitter</a></strong> for the latest computer security news.</p>
		</li>
		<li>
			<svg style="height: 24px" viewBox="0 0 24 24" class="icon instagram"><use xlink:href="#instagram"></use></svg>
			<p>Follow <strong><a href="https://www.instagram.com/nakedsecurity/">@NakedSecurity on Instagram</a></strong> for exclusive pics, gifs, vids and LOLs!</p>
		</li>
	</ul>
</article><!-- #post-## -->

		<div class="free-tools-block">
			<h2 class="block-title">Free tools</h2>

<div class="ns-free-tools">
	<div class="ns-free-tools__item ns-free-tools__item--sophos-home">
		<a class="ns-free-tools__link" href="https://www.sophos.com/en-us/products/free-tools/sophos-xg-firewall-home-edition.aspx">
			<figure class="ns-free-tools__image">
				<svg width="40" height="40" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M25.833 32.023H9.167a.417.417 0 0 0-.417.417v6.25c0 .23.187.417.417.417h16.666c.23 0 .417-.187.417-.417v-6.25a.417.417 0 0 0-.417-.417ZM1.25 32.023a.416.416 0 0 0-.417.417v5A1.667 1.667 0 0 0 2.5 39.107h3.333a.416.416 0 0 0 .417-.417v-6.25a.417.417 0 0 0-.417-.417H1.25ZM38.75 29.523a.416.416 0 0 0 .417-.416v-5A1.667 1.667 0 0 0 37.5 22.44H20a.416.416 0 0 0-.417.417v6.25a.416.416 0 0 0 .417.416h18.75ZM28.75 38.69a.417.417 0 0 0 .417.417H37.5a1.666 1.666 0 0 0 1.667-1.667v-5a.416.416 0 0 0-.417-.417h-9.583a.417.417 0 0 0-.417.417v6.25ZM16.667 29.523a.417.417 0 0 0 .416-.416v-6.25a.417.417 0 0 0-.416-.417H2.5a1.667 1.667 0 0 0-1.667 1.667v5a.417.417 0 0 0 .417.416h15.417ZM29.38 7.883h-.435l-2.622 3.284a.417.417 0 0 1-.728-.152c-.809-2.964-.737-6.1.207-9.023a.832.832 0 0 0-.909-1.084 15.864 15.864 0 0 0-11.525 7.667.417.417 0 0 1-.489.186.421.421 0 0 1-.16-.094l-1.834-1.779a.832.832 0 0 0-1.217.059 12.458 12.458 0 0 0-2.356 11.87.415.415 0 0 0 .396.288h5.549a.416.416 0 0 0 .41-.342 8.858 8.858 0 0 1 4.428-6.22.833.833 0 0 1 1.215.97 6.572 6.572 0 0 0 .43 4.834.42.42 0 0 0 .353.226 2.149 2.149 0 0 0 1.805-1.105.832.832 0 0 1 1.272-.181c.47.44.845.972 1.1 1.563a.419.419 0 0 0 .382.248h5.965a.418.418 0 0 0 .396-.288A12.47 12.47 0 0 0 29.38 7.875v.008Z" fill="#000"/>
				</svg>
			</figure>
			<h4 class="ns-free-tools__title">
				Sophos Firewall Home Edition			</h4>
			<div class="ns-free-tools__sub-title">
				Boost your home network security.			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--hitman-pro">
		<a class="ns-free-tools__link" href="https://www.sophos.com/en-us/products/free-tools/virus-removal-tool.aspx">
			<figure class="ns-free-tools__image">
				<svg width="40" height="40" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M10.833 36.667H3.75a.416.416 0 0 1-.417-.417v-7.083a1.666 1.666 0 1 0-3.333 0v7.5A3.333 3.333 0 0 0 3.333 40h7.5a1.666 1.666 0 1 0 0-3.333ZM1.667 12.5a1.667 1.667 0 0 0 1.666-1.667V3.75a.417.417 0 0 1 .417-.417h7.083a1.666 1.666 0 1 0 0-3.333h-7.5A3.333 3.333 0 0 0 0 3.333v7.5A1.666 1.666 0 0 0 1.667 12.5ZM38.333 27.5a1.667 1.667 0 0 0-1.666 1.667v7.083a.416.416 0 0 1-.417.417h-7.083a1.667 1.667 0 1 0 0 3.333h7.5A3.333 3.333 0 0 0 40 36.667v-7.5a1.666 1.666 0 0 0-1.667-1.667ZM36.667 0h-7.5a1.666 1.666 0 1 0 0 3.333h7.083a.417.417 0 0 1 .417.417v7.083a1.667 1.667 0 1 0 3.333 0v-7.5A3.333 3.333 0 0 0 36.667 0ZM20 22.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Z" fill="#000"/>
					<path d="M8.07 18.762a1.855 1.855 0 0 0 0 2.473c2.833 3.137 7.438 6.334 11.982 6.264 4.54.076 9.14-3.127 11.98-6.264a1.853 1.853 0 0 0 0-2.473c-2.9-3.204-7.515-6.334-11.977-6.26-4.468-.075-9.085 3.056-11.985 6.26ZM24.167 20a4.167 4.167 0 1 1-8.334 0 4.167 4.167 0 0 1 8.334 0ZM20 7.5a1.667 1.667 0 0 0 1.667-1.667v-2.5a1.667 1.667 0 0 0-3.334 0v2.5A1.667 1.667 0 0 0 20 7.5ZM20 32.5a1.667 1.667 0 0 0-1.667 1.667v2.5a1.667 1.667 0 0 0 3.334 0v-2.5A1.667 1.667 0 0 0 20 32.5ZM38.333 18.333h-2.5a1.666 1.666 0 1 0 0 3.334h2.5a1.667 1.667 0 0 0 0-3.334ZM1.667 21.667h2.5a1.667 1.667 0 1 0 0-3.334h-2.5a1.666 1.666 0 1 0 0 3.334Z" fill="#000"/>
				</svg>
			</figure>
			<h4 class="ns-free-tools__title">
				Sophos Scan &amp; Clean			</h4>
			<div class="ns-free-tools__sub-title">
				Free second-opinion scanner for PCs.			</div>
		</a>
	</div>
	<div class="ns-free-tools__item ns-free-tools__item--intercept-x">
		<a class="ns-free-tools__link" href="https://aws.amazon.com/marketplace/pp/prodview-7silxvfxce4zq?qid=1599237395672&sr=0-1&ref_=srh_res_product_title">
			<figure class="ns-free-tools__image">
				<svg width="40" height="40" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M3.241 24.179a1.698 1.698 0 0 0 2.362-.57 1.68 1.68 0 0 0 .234-.859 1.564 1.564 0 0 0-.758-1.342 3.706 3.706 0 0 1-.676-.52 3.932 3.932 0 0 1-1.065-2.96A4.28 4.28 0 0 1 4.6 14.894a4.321 4.321 0 0 1 3.938-1.165 1.674 1.674 0 0 0 1.831-.898c.108-.22.165-.46.169-.703.14-9.544 13.83-12.215 18.03-3.393a1.618 1.618 0 0 0 1.569.948 6.19 6.19 0 0 1 4.985 2.146 6.398 6.398 0 0 1 1.527 4.607 5.684 5.684 0 0 1-1.965 4.121 1.581 1.581 0 0 0-.52 1.198 1.641 1.641 0 0 0 .939 1.495 1.66 1.66 0 0 0 1.759-.206 8.952 8.952 0 0 0 2.327-3.084 8.914 8.914 0 0 0 .807-3.773 9.536 9.536 0 0 0-2.407-6.604 9.617 9.617 0 0 0-6.29-3.184.418.418 0 0 1-.317-.199 12.786 12.786 0 0 0-5.593-5.014 12.856 12.856 0 0 0-7.456-1.02 12.827 12.827 0 0 0-6.744 3.326 12.735 12.735 0 0 0-3.702 6.524.416.416 0 0 1-.378.332 7.758 7.758 0 0 0-3.491 1.122 7.717 7.717 0 0 0-2.58 2.597 7.405 7.405 0 0 0-1.033 4.06 7.084 7.084 0 0 0 2.058 5.126c.358.35.753.66 1.178.926Z" fill="#000"/>
					<path d="m17.818 39.424.921.35a3.44 3.44 0 0 0 2.451 0l.922-.35c5.134-1.947 8.72-6.587 8.72-11.28v-5.636a2.556 2.556 0 0 0-1.547-2.35 27.468 27.468 0 0 0-9.32-1.725c-3.162.026-6.293.61-9.249 1.726-.46.199-.85.527-1.125.945a2.555 2.555 0 0 0-.421 1.404v5.624a12.765 12.765 0 0 0 2.607 6.95 12.852 12.852 0 0 0 6.041 4.342Zm-2.816-10.629c-.332 0-.65-.13-.884-.364a1.242 1.242 0 0 1 .884-2.124h3.332a.418.418 0 0 0 .417-.415v-3.318c0-.33.132-.646.366-.88a1.253 1.253 0 0 1 1.767 0c.235.234.366.55.366.88v3.318a.414.414 0 0 0 .417.415H25c.331 0 .649.13.883.364A1.241 1.241 0 0 1 25 28.795h-3.333a.417.417 0 0 0-.417.415v3.318c0 .33-.131.646-.366.88a1.253 1.253 0 0 1-1.767 0 1.241 1.241 0 0 1-.366-.88V29.21a.414.414 0 0 0-.417-.415h-3.332Z" fill="#000"/>
				</svg>
			</figure>
			<h4 class="ns-free-tools__title">
				Sophos Cloud Optix			</h4>
			<div class="ns-free-tools__sub-title">
				Monitor 25 cloud assets for free.			</div>
		</a>
	</div>
</div>
		</div>

			<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>

		<div class="nav-links">
			<div class="nav-previous"><a href="https://nakedsecurity.sophos.com/2022/06/02/s3-ep85-now-thats-what-i-call-a-microsoft-office-exploit-podcast/" rel="prev"><span class="nav-label">Previous</span><span class="nav-seperator">:</span><span class="nav-title"> S3 Ep85: Now THAT&#8217;S what I call a Microsoft Office exploit! [Podcast]</span></a></div><div class="nav-next"><a href="https://nakedsecurity.sophos.com/2022/06/03/atlassian-announces-0-day-hole-in-confluence-collab-server-update-soon/" rel="next"><span class="nav-label">Next</span><span class="nav-seperator">:</span><span class="nav-title"> Atlassian announces 0-day hole in Confluence Server &#8211; update soon!</span></a></div>		</div>
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	
	</main><!-- #main -->

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<section class="comments-panel">
	<div class="container">
	<div class="panel-content framed-content-area">

			
<div id="comments" class="comments-area">

			<h2 class="comments-title">
			7 comments on &ldquo;<span>Yet another zero-day (sort of) in Windows &#8220;search URL&#8221; handling</span>&rdquo;		</h2>

		<ol class="comment-list">
					<li id="comment-6407932" class="comment even thread-even depth-1">
			<article id="div-comment-6407932" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/7f3a3097e600856d48d870f8caed31a0?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7f3a3097e600856d48d870f8caed31a0?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Bill Justesen</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/06/02/yet-another-zero-day-sort-of-in-windows-search-url-handling/#comment-6407932"><time datetime="2022-06-02T19:40:21+01:00">June 2, 2022 at 7:40 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Yuck, I just went into the registry to see what other &#8216;undocumented features&#8217; are in HKEY_CLASSES_ROOT. What did I find? Job security.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6407932"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6407932={"id":7238218,"unique_id":"wp-comment-6407932","title":"Yuck%2C%20I%20just%20went%20into%20the%20registry%20to%20see%20what%20other%20%26%23039%3Bundocumented%20features%26%23039%3B%20are%20in%20HKEY_CLASSES_ROOT.%20What%20did%20I%20find%3F%20Job%20security.%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/06\/02\/yet-another-zero-day-sort-of-in-windows-search-url-handling\/#comment-6407932","item_id":"_comm_6407932"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/06/02/yet-another-zero-day-sort-of-in-windows-search-url-handling/?replytocom=6407932#respond' data-commentid="6407932" data-postid="724454" data-belowelement="div-comment-6407932" data-respondelement="respond" data-replyto="Reply to Bill Justesen" aria-label='Reply to Bill Justesen'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-6407943" class="comment odd alt thread-odd thread-alt depth-1 parent">
			<article id="div-comment-6407943" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/90e90f2bcbb04385373a39f35baa77ce?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/90e90f2bcbb04385373a39f35baa77ce?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Dave Bolt</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/06/02/yet-another-zero-day-sort-of-in-windows-search-url-handling/#comment-6407943"><time datetime="2022-06-02T20:40:40+01:00">June 2, 2022 at 8:40 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Given that Microsoft like to set Windows to hide file extensions, I suspect we could get a situation similar to the LoveLetter virus, where the target file is shown, but looks innocent.<br />
If I remember correctly, LoveLetter consisted of an email with an attached file named messageforyou.txt.scr, and the email told the unsuspecting user that it was a text file, so when they saw an attachment named messageforyou.txt (.scr hidden by Windows), they assumed it was a text file and safe to double-click to open the file to view it in Notepad. What actually happened was that the script ran and renamed every graphic file it could find &#8211; making Windows unusable.<br />
Hopefully someone can confirm my hypothesis.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6407943"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6407943={"id":7238218,"unique_id":"wp-comment-6407943","title":"Given%20that%20Microsoft%20like%20to%20set%20Windows%20to%20hide%20file%20extensions%2C%20I%20suspect%20we%20could%20get%20a%20situation%20similar%20to%20the%20LoveLetter%20virus%2C%20where%20the%20target%20file%20is%20shown%2C%20but%20looks%20innocent.If%20I%20remem%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/06\/02\/yet-another-zero-day-sort-of-in-windows-search-url-handling\/#comment-6407943","item_id":"_comm_6407943"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/06/02/yet-another-zero-day-sort-of-in-windows-search-url-handling/?replytocom=6407943#respond' data-commentid="6407943" data-postid="724454" data-belowelement="div-comment-6407943" data-respondelement="respond" data-replyto="Reply to Dave Bolt" aria-label='Reply to Dave Bolt'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6407947" class="comment byuser comment-author-pducklin bypostauthor even depth-2">
			<article id="div-comment-6407947" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/06/02/yet-another-zero-day-sort-of-in-windows-search-url-handling/#comment-6407947"><time datetime="2022-06-02T21:03:48+01:00">June 2, 2022 at 9:03 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Aaargh! I left something out of my “what to do?” advice at the end… I should have definitely have a suggestion to  “show file extensions” in there. </p>
<p>Thanks for the reminder &#8211; I am going to add that into the article right away.</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6407947"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6407947={"id":7238218,"unique_id":"wp-comment-6407947","title":"Aaargh%21%20I%20left%20something%20out%20of%20my%20what%20to%20do%3F%20advice%20at%20the%20end%20I%20should%20have%20definitely%20have%20a%20suggestion%20to%20%20show%20file%20extensions%20in%20there.%20Thanks%20for%20the%20reminder%20-%20I%20am%20going%20to%20add%20that%20int%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/06\/02\/yet-another-zero-day-sort-of-in-windows-search-url-handling\/#comment-6407947","item_id":"_comm_6407947"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/06/02/yet-another-zero-day-sort-of-in-windows-search-url-handling/?replytocom=6407947#respond' data-commentid="6407947" data-postid="724454" data-belowelement="div-comment-6407947" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-6408062" class="comment odd alt thread-even depth-1 parent">
			<article id="div-comment-6408062" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/955b7ed85ac65b711a5251e2ba013fd0?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/955b7ed85ac65b711a5251e2ba013fd0?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Kent Calero</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/06/02/yet-another-zero-day-sort-of-in-windows-search-url-handling/#comment-6408062"><time datetime="2022-06-03T09:09:10+01:00">June 3, 2022 at 9:09 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Is there a difference between URI and URL?</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6408062"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6408062={"id":7238218,"unique_id":"wp-comment-6408062","title":"Is%20there%20a%20difference%20between%20URI%20and%20URL%3F%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/06\/02\/yet-another-zero-day-sort-of-in-windows-search-url-handling\/#comment-6408062","item_id":"_comm_6408062"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/06/02/yet-another-zero-day-sort-of-in-windows-search-url-handling/?replytocom=6408062#respond' data-commentid="6408062" data-postid="724454" data-belowelement="div-comment-6408062" data-respondelement="respond" data-replyto="Reply to Kent Calero" aria-label='Reply to Kent Calero'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6408069" class="comment even depth-2">
			<article id="div-comment-6408069" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/5157f80c71c96024b168321be3486dd3?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5157f80c71c96024b168321be3486dd3?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">John</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/06/02/yet-another-zero-day-sort-of-in-windows-search-url-handling/#comment-6408069"><time datetime="2022-06-03T10:15:59+01:00">June 3, 2022 at 10:15 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Yes, there is. See also https://webmasters.stackexchange.com/questions/19101/what-is-the-difference-between-a-uri-and-a-url</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6408069"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6408069={"id":7238218,"unique_id":"wp-comment-6408069","title":"Yes%2C%20there%20is.%20See%20also%20https%3A%2F%2Fwebmasters.stackexchange.com%2Fquestions%2F19101%2Fwhat-is-the-difference-between-a-uri-and-a-url%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/06\/02\/yet-another-zero-day-sort-of-in-windows-search-url-handling\/#comment-6408069","item_id":"_comm_6408069"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/06/02/yet-another-zero-day-sort-of-in-windows-search-url-handling/?replytocom=6408069#respond' data-commentid="6408069" data-postid="724454" data-belowelement="div-comment-6408069" data-respondelement="respond" data-replyto="Reply to John" aria-label='Reply to John'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-6408070" class="comment byuser comment-author-pducklin bypostauthor odd alt depth-2 parent">
			<article id="div-comment-6408070" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/025c4bb891cbc5a1bb24a4854f823e48?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/>						<b class="fn">Paul Ducklin</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/06/02/yet-another-zero-day-sort-of-in-windows-search-url-handling/#comment-6408070"><time datetime="2022-06-03T10:21:09+01:00">June 3, 2022 at 10:21 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Yes. </p>
<p>Very loosely speaking (“loosely” because understanding the differences in detail requires untangling years’ worth of committee meetings and working group wrangling), all URLs are URIs but not all URIs are URLs, because some URIs are URNs instead.</p>
<p>UR = universal resource…</p>
<p>I = indicator, telling you either what it is or where to get one.</p>
<p>N = name, which tells you what something is.</p>
<p>L = locator, which tells you where to get one (or to learn about it).</p>
<p>So, both URNs and URLs are types of URI. If this sounds confusing, then all those working group meetings and committee arguments will have been well worth the effort :&#045;)</p>
<p>An example of a URN is an ISBN, one of those 10-digit or 13-digit codes that uniquely identifies a book. It doesn’t tell you where to buy a copy, but it does allow you to verify, when you pick up what you think is a copy, that you have the book you wanted.</p>
<p>And an example of a URL is a web address, which might tell you where to learn more about (or to buy an actual copy of) a specific book.</p>
<p>Thus the URN…</p>
<p>urn:isbn:0393310728 </p>
<p>…refers to the seminal book How To Lie With Statistics by Darryl Huff, while the URL…</p>
<p>https://openlibrary.org/books/OL1418542M/How_to_lie_with_statistics</p>
<p>…takes you to an Open Library web page about the book, which is well worth reading, even though (or perhaps especially because) it was first published almost 70 years ago.</p>
<p>In the early 2000s it was trendy to say URI instead of URL in order to pretend you knew the difference, but almost every time anyone said URI they actually meant URL. (In fact, when URI was still a cool thing to say, on 99% of the occasions people used the word they could just have said “web address” instead.)</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6408070"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6408070={"id":7238218,"unique_id":"wp-comment-6408070","title":"Yes.%20Very%20loosely%20speaking%20%28loosely%20because%20understanding%20the%20differences%20in%20detail%20requires%20untangling%20years%20worth%20of%20committee%20meetings%20and%20working%20group%20wrangling%29%2C%20all%20URLs%20are%20URIs%20but%20not%20a%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/06\/02\/yet-another-zero-day-sort-of-in-windows-search-url-handling\/#comment-6408070","item_id":"_comm_6408070"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/06/02/yet-another-zero-day-sort-of-in-windows-search-url-handling/?replytocom=6408070#respond' data-commentid="6408070" data-postid="724454" data-belowelement="div-comment-6408070" data-respondelement="respond" data-replyto="Reply to Paul Ducklin" aria-label='Reply to Paul Ducklin'>Reply</a></div>			</article><!-- .comment-body -->
		<ul class="children">
		<li id="comment-6408120" class="comment even depth-3">
			<article id="div-comment-6408120" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo avatar-default' height='50' width='50' loading='lazy'/>						<b class="fn">Maxwell</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://nakedsecurity.sophos.com/2022/06/02/yet-another-zero-day-sort-of-in-windows-search-url-handling/#comment-6408120"><time datetime="2022-06-03T15:12:10+01:00">June 3, 2022 at 3:12 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Nice!</p>
<div class="cs-rating pd-rating" id="pd_rating_holder_7238218_comm_6408120"></div>
<script type="text/javascript" charset="UTF-8"><!--//--><![CDATA[//><!--
PDRTJS_settings_7238218_comm_6408120={"id":7238218,"unique_id":"wp-comment-6408120","title":"Nice%21%E2%80%A6","permalink":"https:\/\/nakedsecurity.sophos.com\/2022\/06\/02\/yet-another-zero-day-sort-of-in-windows-search-url-handling\/#comment-6408120","item_id":"_comm_6408120"};
//--><!]]></script>
<script type="text/javascript" charset="UTF-8" src="https://polldaddy.com/js/rating/rating.js"></script>				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://nakedsecurity.sophos.com/2022/06/02/yet-another-zero-day-sort-of-in-windows-search-url-handling/?replytocom=6408120#respond' data-commentid="6408120" data-postid="724454" data-belowelement="div-comment-6408120" data-respondelement="respond" data-replyto="Reply to Maxwell" aria-label='Reply to Maxwell'>Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">What do you think? <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2022/06/02/yet-another-zero-day-sort-of-in-windows-search-url-handling/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://nakedsecurity.sophos.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-form-comment"><label for="comment">Comment <span class="required" aria-hidden="true">*</span></label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='724454' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="b3abdf6951" /></p><p style="display: none !important;"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="0"/><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
	
</div><!-- #comments -->
		<div class="comments-widget-area">
					</div>
	
	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	

	<section class="recommended-panel">
	<div class="container">
	<div class="panel-content ">

		<h3 class="block-title">Recommended reads</h3>
	<div class="blocks">
		<article id="post-714119" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2022/05/12/s3-ep82-bugs-bugs-bugs-and-colonial-pipeline-again-podcast/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2021/09/ns-1200-logo-podcast-with-mic-1.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">May</span><span class="day">12</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">0</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2022/05/12/s3-ep82-bugs-bugs-bugs-and-colonial-pipeline-again-podcast/" rel="bookmark">S3 Ep82: Bugs, bugs, bugs (and Colonial Pipeline again) [Podcast]</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-679221" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2022/03/16/russian-actors-bypass-2fa-story-what-happened-and-how-to-avoid-it/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/03/padlock-1200.jpg?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">Mar</span><span class="day">16</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">4</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2022/03/16/russian-actors-bypass-2fa-story-what-happened-and-how-to-avoid-it/" rel="bookmark">CISA warning: &#8220;Russian actors bypassed 2FA&#8221; &#8211; what happened and how to avoid it</a></h3>	</div>
</article> <!-- .card-article -->
<article id="post-714187" class="card-slide">
	<div class="card-image">
		<div class="image-pointer"></div>
		<a href="https://nakedsecurity.sophos.com/2022/05/17/apple-patches-zero-day-kernel-hole-and-much-more-update-now/"><div class="dynamic-image-frame">
		<div class="dynamic-image" style="background-image: url(https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2022/01/apple-1200.png?w=412&#038;h=200&#038;crop=1);"></div>
	</div></a>
	</div>
	<div class="card-content">
		<div class="meta-box">
			<div class="date-box">
				<span class="month">May</span><span class="day">17</span>
			</div>
 			<div class="author-box">
			<span class="by">by</span>
		Paul Ducklin	
	</div>
			<div class="comment-box">
				<span class="count">0</span>
			</div>
		</div>
		<h3 class="card-title"><a href="https://nakedsecurity.sophos.com/2022/05/17/apple-patches-zero-day-kernel-hole-and-much-more-update-now/" rel="bookmark">Apple patches zero-day kernel hole and much more &#8211; update now!</a></h3>	</div>
</article> <!-- .card-article -->
	</div>

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="footer-container">
			<a href="#" class="js-collapse-footer"><svg style="height: 20px" viewBox="0 0 132 24" class="block icon sophos"><use xlink:href="#sophos"></use></svg></a>
			<div id="collapseFooter" class="blocks">
				<div class="sophos block">
					<ul id="menu-footer-primary" class="primary menu"><li id="menu-item-306737" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306737"><a href="https://nakedsecurity.sophos.com/about/">About Naked Security</a></li>
<li id="menu-item-306754" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306754"><a href="https://www.sophos.com/en-us/company.aspx">About Sophos</a></li>
<li id="menu-item-306747" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306747"><a href="https://nakedsecurity.sophos.com/send-us-a-tip/">Send us a tip</a></li>
<li id="menu-item-323171" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323171"><a href="/cookies-and-scripts/">Cookies</a></li>
<li id="menu-item-323170" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323170"><a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx">Privacy</a></li>
<li id="menu-item-323169" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323169"><a href="https://www.sophos.com/en-us/legal.aspx">Legal</a></li>
</ul>				</div>
										<div class="news block">
							<ul id="menu-products-column-one" class="small menu"><li id="menu-item-306998" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-306998"><a href="https://www.sophos.com/en-us/products/intercept-x.aspx">Intercept X</a></li>
<li id="menu-item-440801" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440801"><a href="https://www.sophos.com/en-us/products/server-security.aspx">Intercept X for Server</a></li>
<li id="menu-item-440802" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440802"><a href="https://www.sophos.com/en-us/products/mobile-control.aspx">Intercept X for Mobile</a></li>
</ul>						</div>
											<div class="products block">
							<ul id="menu-products-column-two" class="small menu"><li id="menu-item-440803" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440803"><a href="https://www.sophos.com/en-us/products/next-gen-firewall.aspx">XG Firewall</a></li>
<li id="menu-item-440805" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440805"><a href="https://www.sophos.com/en-us/products/sophos-email.aspx">Sophos Email</a></li>
<li id="menu-item-440804" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440804"><a href="https://www.sophos.com/en-us/products/secure-wifi.aspx">Sophos Wireless</a></li>
</ul>						</div>
											<div class="threats block">
							<ul id="menu-server-protection" class="small menu"><li id="menu-item-440806" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440806"><a href="https://www.sophos.com/en-us/products/managed-threat-response.aspx">Managed Threat Response</a></li>
<li id="menu-item-448404" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-448404"><a href="https://www.sophos.com/en-us/products/cloud-optix.aspx">Cloud Optix</a></li>
<li id="menu-item-440807" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-440807"><a href="https://www.sophos.com/en-us/products/phish-threat.aspx">Phish Threat</a></li>
</ul>						</div>
								</div>
			<ul class="block social footer">
				<li class="twitter"><a rel="nofollow" href="https://twitter.com/NakedSecurity" title="Follow our team of security experts on Twitter"><svg style="height: 14px" viewBox="0 0 100 100" class="icon twitter"><use xlink:href="#twitter"></use></svg></a></li>
				<li class="facebook"><a rel="nofollow" href="https://www.facebook.com/SophosSecurity" title="Join over 250,000 people in our Facebook community"><svg style="height: 14px" viewBox="0 0 100 100" class="icon facebook"><use xlink:href="#facebook"></use></svg></a></li>
				<li class="instagram"><a rel="nofollow" href="https://www.instagram.com/nakedsecurity/" title="Follow Naked Security on Instagram"><svg style="height: 14px" viewBox="0 0 100 100" class="icon instagram"><use xlink:href="#instagram"></use></svg></a></li>
				<li class="linkedin"><a rel="nofollow" href="https://www.linkedin.com/company/5053/" title="Join the naked security discussion group on LinkedIn"><svg style="height: 14px" viewBox="0 0 100 100" class="icon linkedin"><use xlink:href="#linkedin"></use></svg></a></li>
				<li class="rss"><a rel="nofollow" href="/feed" title="Subscribe to our RSS feed"><svg style="height: 14px" viewBox="0 0 100 100" class="icon rss"><use xlink:href="#rss"></use></svg></a></li>
			</ul>

							<div class="vip-powered-wpcom">
					<span class="copyright">© 1997 - 2022 Sophos Ltd.</span>
					All rights reserved.
					Powered by <a href="https://wpvip.com/?utm_source=vip_powered_wpcom&#038;utm_medium=web&#038;utm_campaign=VIP%20Footer%20Credit&#038;utm_term=nakedsecurity.sophos.com" rel="generator nofollow" class="powered-by-wpcom">WordPress VIP</a>				</div>
					</div>
		<script type="text/javascript">
			window.cookieconsent_options = {
				"message":"This site uses cookies. By continuing to browse the site you are agreeing to our use of cookies.",
				"dismiss":"Got it!",
				"learnMore":"Learn More",
				"link":"/cookies-and-scripts",
				"theme":"https://nakedsecurity.sophos.com/wp-content/themes/sophosnews-2015/css/sophos.css"};
		</script>
	</footer><!-- #colophon -->
</div><!-- #page -->
<div id="survey-wrapper" class="mfp-hide"><div class="pd-embed" id="pd_1499706777" data-settings=""></div></div>
<script id='child-js-plugins-js-extra'>
var PG8Data = {"startPage":"1","maxPages":"0","nextLink":""};
</script>
<script id='child-js-core-js-extra'>
var Sophos = {"ajaxurl":"https:\/\/nakedsecurity.sophos.com\/wp-admin\/admin-ajax.php","nonce":"5a5d2f7263"};
</script>
<script type="text/javascript" src="https://nakedsecurity.sophos.com/_static/??-eJyNi0EOgyAQRS9UHKnVlEXTu4gThTADYTDG20uM3XXh8r//HmxJ2cgFuUBZkFBAYlqiMG6inq3uwQuksM6OpfHygFuBjRl/tmMb1ql6JyeqpcqYwt6Q439SnUgjTtf/pY8e+s505v0y/gB98T8J" ></script><script src='https://stats.wp.com/e-202222.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:10.9',blog:'166161173',post:'724454',tz:'1',srv:'nakedsecurity.sophos.com',hp:'vip'} ]);
	_stq.push([ 'clickTrackerInit', '166161173', '724454' ]);
</script>
</body>
</html>
