
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Evilgrab Delivered by Watering Hole Attack on President of Myanmar’s Website</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/evilgrab-delivered-by-watering-hole-attack-on-president-of-myanmars-website/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Unit 42 discusses details of a waterhole attack on the website of the President of Myanmar, including characteristics of the delivered Evilgrab sample."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/evilgrab-delivered-by-watering-hole-attack-on-president-of-myanmars-website/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Evilgrab Delivered by Watering Hole Attack on President of Myanmar’s Website" />
<meta property="og:description" content="Unit 42 discusses details of a waterhole attack on the website of the President of Myanmar, including characteristics of the delivered Evilgrab sample." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/evilgrab-delivered-by-watering-hole-attack-on-president-of-myanmars-website/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="Evilgrab" />
<meta property="article:tag" content="IFRAME" />
<meta property="article:tag" content="JavaScript" />
<meta property="article:tag" content="Myanmar" />
<meta property="article:tag" content="Trojan" />
<meta property="article:tag" content="Vidgrab" />
<meta property="article:tag" content="Watering Hole Attack" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2015-06-11T16:00:08+00:00" />
<meta property="article:modified_time" content="2018-11-01T09:46:51+00:00" />
<meta property="og:updated_time" content="2018-11-01T09:46:51+00:00" />
<meta property="og:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/evilgrab_1-500x10.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit 42 discusses details of a waterhole attack on the website of the President of Myanmar, including characteristics of the delivered Evilgrab sample." />
<meta name="twitter:title" content="Evilgrab Delivered by Watering Hole Attack on President of Myanmar’s Website" />
<meta name="twitter:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/evilgrab_1-500x10.png" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Evilgrab Delivered by Watering Hole Attack on President of Myanmar’s Website Comments Feed" href="https://unit42.paloaltonetworks.com/evilgrab-delivered-by-watering-hole-attack-on-president-of-myanmars-website/feed/" />
<meta property="og:likes" content="0"/>
<meta property="og:readtime" content="13"/>
<meta property="og:views" content="23,642"/>
<meta property="og:date_created" content="June 11, 2015 at 7:00 PM"/>
<meta property="og:post_length" content="3551"/>
<meta property="og:category" content="Malware"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/malware-2/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Robert Falcone"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/robertfalcone/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Evilgrab Delivered by Watering Hole Attack on President of Myanmar\u2019s Website","name":"Evilgrab Delivered by Watering Hole Attack on President of Myanmar\u2019s Website","description":"On May 12, 2015, Unit 42 observed an apparent watering hole attack, also known as a strategic website compromise (SWC), involving the President of Myanmar&#8217;s website. Visiting the main page hosted at &#8220;www.president-office.gov[.]mm&#8221; triggered the malicious content, as the threat actors injected an inline frame (IFRAME) into a JavaScript file used by Drupal for the...","url":"https:\/\/unit42.paloaltonetworks.com\/evilgrab-delivered-by-watering-hole-attack-on-president-of-myanmars-website\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/evilgrab-delivered-by-watering-hole-attack-on-president-of-myanmars-website\/","datePublished":"June 11, 2015","articleBody":"On May 12, 2015, Unit 42 observed an apparent watering hole attack, also known as a strategic website compromise (SWC), involving the President of Myanmar's website. Visiting the main page hosted at \"www.president-office.gov[.]mm\" triggered the malicious content, as the threat actors injected an inline frame (IFRAME) into a JavaScript file used by Drupal for the site's theme.\n\nUnit 42 believes threat actors chose this website to set up a watering hole in order to target and gather information on individuals in Myanmar, individuals involved in political relations with the country and\/or organizations doing business in Myanmar. Unit 42 has evidence to suggest the threat actors have had access to the website since November 2014 if not earlier.\n\nShortly after we reported the infection to the operators of the website, they took it offline. A new website containing the same content is hosted at \u201cwww.myanmarpresidentoffice.info\u201d, which has several artifacts and references to the original content hosted at \u201cpresident-office.gov.mm\u201d but does not contain the exploit code. We believe the use of the new domain may be part of their remediation process.\n\nThis blog discusses the known details of the watering hole, interesting characteristics of the delivered Evilgrab sample (AKA Vidgrab) and the threat infrastructure associated with the attack.\nChain of Compromise\nThe main page previously hosted at \"www.president-office.gov.mm\" was powered by Drupal, which loaded several Javascript files that applied a Drupal theme. One of these Javascript files loaded by the main page, named \"script.js\" and seen in Figure 1, was responsible for several of the website's features, including the cycling slides of content on the main page.\n\n\nFigure 1.\u00a0External JavaScript Used to Load Drupal Theme\nThe \"script.js\" file also contained an IFRAME (Figure 2), which Unit 42 believes threat actors injected to exploit the browsers of visitors to the website. We analyzed the content in \"script.js\", as well as the HTTP response received from the web server. One interesting thing to note is that the web server, specifically Drupal version 7, used HTTP responses that contain the \"Last-Modified\" field for caching purposes. We checked the response for the \"script.js\" file that contained the injected IFRAME and found a \"Last-Modified\" date of \"Wed, 24 Dec 2014 02:38:58 GMT\", which may suggest that the threat actor injected the IFRAME on December 24, 2014.\n\n\nFigure 2.\u00a0IFRAME Injected into Drupal JavaScript\nUnfortunately, we do not have access to the content that was hosted at this location and requests for access currently result in an HTTP 404 Not Found error. Unit 42 cannot determine which vulnerability this code may have exploited without access to the content. But regardless of the vulnerability exploited, our WildFire system detected the payload in transit and classified the file as malware.\n\nUnit 42 is aware of another malicious script hosted on the President of Myanmar's website in November 2014, a month prior to when the IFRAME described in this blog appears to have been injected. VirusTotal captured the contents hosted at the following URL[1], which hosted a VBScript[2] that exploited CVE-2014-6332 to install a downloader Trojan:\n\nhttp:\/\/www.president-office.gov[.]mm\/welcome[.]html\n\nThe downloader Trojan had the following characteristics:\n\nSHA256:b69106e06dc008e4fa1e4a0b0b58fcb1dc6d2016422a35cb3111168fd3fae577\nC2: mmslsh.tiger1234[.]com\n\nThis suggests threat actors, who may or may not be the same ones who injected the malicious IFRAME, have displayed a consistent interest in compromising visitors to this website since at least November 2014.\nPayload Installation\nOn May 12, 2015, a globally recognized organization in the oil and gas industry visited the following URL that hosted the watering hole on the President of Myanmar's website:\n\nhttp:\/\/www.president-office.gov[.]mm\/sites\/all\/modules\/browscap\/List_View.php\n\nVisiting this URL resulted in the download of a variant of the Evilgrab Trojan that has been used in past cyber espionage campaigns[3][4]. During our malware analysis efforts, we found some interesting features within this Evilgrab sample, which is denoted as version \u2018V2014-v05\u2019 that has the following attributes:\n\nFilename: newdata.exe\nMD5: 2e78e6d02aaed4f057f4dfa631ea5519\nSHA256: 10d9611e5b4ff41fc79e8907e3eb522630131b1bdc1010a0564c8780ba55c87c\nCompiled: 2015-04-30\nC2: dns.websecexp[.]com:81 (211.169.202.2)\nC2: ns.websecexp[.]com\nC2: appeur.gnway[.]cc\nMutex: 2010-3\nMutex: New2010-V3-Uninstall\n\nThis Evilgrab sample attempts to detect certain antivirus products on an infected system and will only run if it does not detect the presence of Kaspersky, TrendMicro, Symantec's Norton, ESET, or AVG antivirus products. The initial Evilgrab payload has two embedded dynamic link libraries (DLL): it uses one DLL to load the second DLL that contains the functional code. The initial payload carries out an installation process by storing both of these DLLs, as well as the path to the initial payload, in the Windows registry in encrypted form to the following registry keys:\n\n\tSoftware\\rar\\data - Functional Code DLL\n\tSoftware\\rar\\s - Loader DLL\n\tSoftware\\rar\\e - Path to Initial Payload\n\nWhile previous Evilgrab versions also installed their functional code to these registry locations, the installation process itself within the initial Evilgrab payload includes an interesting anti-analysis technique that relies on the structured exception handler (SEH) to call important functions.\n\nLet\u2019s take a step back and first describe the structured event handler, which is built into an application that includes code to handle exceptions. The SEH allows a developer to catch exceptions that occur during the execution of the application and run specific code to handle the exception instead of crashing the application. Exceptions can occur for a variety of reasons, such as attempting to divide a value by zero or attempting to access a memory segment without the proper permissions.\n\nThe initial Evilgrab payload uses the SEH to carry out the installation process, by setting up the SEH to call specific functions in the event of an exception and including code that purposefully causes an exception. Evilgrab uses the SEH and forced exceptions as an anti-analysis technique to add a level of difficulty to the malware analysis process. For example, Evilgrab uses the assembly code in Figure 3 that shows a call to a function that we named 'divBy0_invokeExceptionToCallXor58'.\n\n\nFigure 3.\u00a0Assembly Code To Call Function that Forces an Exception\nThe call to the 'divBy0_invokeExceptionToCallXor58' function has a pointer to a buffer that contains cipher text (buf_LoaderDLLInCipherText), as well as a pointer to a DWORD (dd_LoaderDLLLength) that contains the length of the buffer. In the 'divBy0_invokeExceptionToCallXor58' function, the assembly instructions in Figure 4 cause an exception by attempting to divide a value by zero by setting the value in 'ecx' to zero (xor ecx, ecx instruction) and attempting to divide the value in 'eax' with 'ecx' (idiv ecx instruction):\n\n\nFigure 4.\u00a0Assembly Code To Force an Exception by Dividing by Zero\nThis division by zero exception invokes the SEH to call a specific function to handle the exception. The exception is handled by the exception handler in Figure 5.\n\n\nFigure 5.\u00a0Evilgrab's Exception Handler Invoked After Forcing an Exception\nThe exception handler was created to handle the division by zero exception by running the function that Unit 42 named 'xorBufferBy58'. The purpose of forcing this exception is to call the 'xorBufferBy58', using the previously mentioned 'buf_codeInCipherText' and 'dd_codeLength' values as arguments.\n\nThe sample uses this technique to call functions we\u2019ve named 'createWinlogonProcessAndInjectCode' and 'launchInjectedCode'. The 'createWinlogonProcessAndInjectCode' function creates a suspended process (CREATE_SUSPENDED flag) using the %SYSTEM%\\winlogon.exe executable. It then allocates several memory sections within the winlogon.exe process using VirtualAllocEx and it writes data to these sections using WriteProcessMemory, including the compressed payload that was decrypted using the 'xorBufferBy58' function. It also writes a block of shellcode to the entry point of the winlogon.exe process to load the EvilGrab loader DLL, which is responsible for obtaining the Evilgrab functional code from the registry and executing it. When the last exception has been triggered in the initial Evilgrab payload, the SEH calls the 'launchInjectedCode' function to resume the suspended 'winlogon.exe' process to launch the Evilgrab functional code.\nEvilgrab Functionality\nEvilgrab is a fully functional remote administration tool (RAT) that allows threat actors to interact with compromised systems to exfiltrate data. The method in which this Evilgrab payload communicates with its C2 server is rather interesting. Previously publically discussed Evilgrab samples sent a beacon of \"\\x01\\x00\\x00\\x00\\x33\" to the C2 server; however, this payload issues a fake HTTP request to the C2 server in place of this beacon. It uses raw sockets to send data to and receive data from its C2 server, which allows the payload to construct custom packets. The fake HTTP request used as a beacon is as follows:\n\n\n\n&nbsp;\n\nThe first four bytes (\\xdd\\x00\\x00\\x00) are anomalous, as the HTTP protocol requires the HTTP verb (GET, POST, etc.) to be at the very beginning of the packet. The first four bytes in this packet specify the length of the following data and the remaining bytes are data sent to the C2 server. Evilgrab will use this packet structure for all correspondence with the C2 server. In addition to the anomaly in the first four bytes, the HTTP Host field in the Evilgrab request is also anomalous as it contains a full URL instead of just the hostname of the web server. The malware author put the full URL to a Windows update page in the Host field instead of including the URL portion (\/windowsupdate\/v6\/default.aspx?ln=zh-cn) after the HTTP verb and the domain (update.microsoft.com) in the Host field. The malware author chose this particular Windows update URL in an attempt to make the HTTP request look legitimate.\n\nAfter the Evilgrab payload sends out this fake HTTP request beacon, it receives the C2 server's response and checks for a specific response to confirm that the payload communicated with an Evilgrab C2 server. The payload checks the C2 server\u2019s response for the following:\n\n\nThe response shown above is also an anomalous HTTP response for several reasons. First, the Location field does not have a space before the location. Second, \"Bad Request (Invalid Verb)\" is used in an HTTP 400 Bad Request error message not an HTTP 301 message. The HTTP 400 Bad Request error would make sense, as a web server would expect the HTTP request to start with an HTTP verb but it begins with four bytes for the data length as previously mentioned. Mila at ContagioDump observed the same C2 response to Evilgrab in a delivery document exploiting CVE-2012-0158 in August 2013[5], but that sample did not use the fake HTTP request as a beacon as seen here.\n\nImmediately after receiving the appropriate C2 response to its beacon, Evilgrab sends a 4096-byte packet to the C2 server that contains the following:\n\n\\xfc\\x0f\\x00\\x00\\xa02015-05-13|(192.168.180.47)|49157|Windows7|J|A|No|0\u59290\u5c0f\u65f60\u520628\u79d2|No|V2014-v05|2052|0|50fb78a5|0|0|&lt;3987 additional bytes&gt;\n\nAgain, the first four bytes is the length of the following data, followed by a static response identifier (0xA0) and a pipe-delimited (\u2018|\u2019) string of data gathered from the compromised system. Table 1 shows each field and the description of its contents.\n\n\n\nDescription\nData Type\nExample Value\n\n\nCampaign ID\nString\n2015-05-13\n\n\nSystem IP Address\nString\n(192.168.180.47)\n\n\nTCP Port from System\nDecimal\n49157\n\n\nOperating System Version\nString\nWindows7\n\n\nFirst Letter of Hostname\nCharacter\nJ\n\n\nFirst Letter of Username\nCharacter\nA\n\n\nVideo Capture Device Connected\nString\nNo\n\n\nSystem Idle Time\nString\n0\u59290\u5c0f\u65f60\u520628\u79d2\n\n\nRemovable Drive Connected\nString\nNo\n\n\nEvilgrab Version\nString\nV2014-v05\n\n\nEvilgrab Process ID\nDecimal\n2052\n\n\nStatic Zero\nDecimal\n0\n\n\nRandom Value based initial value of 0x50FB125B repeatedly XOR by GetTickCount\nHexadecimal\n50fb78a5\n\n\nBoolean value if the keylogger is running\nHexadecimal\n0\n\n\nBoolean value that the operator sets via the 0x7e command for unknown reason.\nCharacter\n0\n\n\n\nTable 1.\u00a0Each element of the system data sent from Evilgrab to the C2 server\nThe functional Evilgrab code contains a fully featured command handler that allows an operator to interact with the infected system to carry out remote administration activities and data exfiltration. Table 2 contains a comprehensive list of the commands available within the command handler.\n\n\n\nCommand\nDescription\n\n\n0x78 \nTurns on the QQ Memory Scraper and Keylogger\n\n\n0x79 \nKills the QQ Memory Scraper and Keylogger functionality\n\n\n0x7a \nSets flags within the class. One of the flags is the hexadecimal value in the initial data sent from the host, specifically the 13th element of the pipe-delimited string\n\n\n0x7b \nUploads a specified file from the system to the C2 server\n\n\n0x7c \nCreates a file with a specified name.\n\n\n0x7d \nSends the flags that indicate whether the QQ Memory Scraper and Keylogger are running\n\n\n0x7e \nSets a boolean value within the ActiveSettings. Unknown reason, but operators may use it to note if they have been there or not.\n\n\n0x82 \nEnumerate mounted volumes of storage and their type. The drive type prefixes the volume label, and the drive type prefixes sent within the response to the C2 are: Removable F-Fixed N-remote (network) C-cdrom D-ramdisk\n\n\n0x83 \nList contents of a folder, or file, along with each files last modification time, filename and file attributes\n\n\n0x84 \nCheck to see if a specific file exists.\n\n\n0x85 \nReceive a file from the C2 and Execute it\n\n\n0x86 \nCreates a file and sets the file pointer\n\n\n0x87 \nClose handles to files created in command 0x85\n\n\n0x88 \nLoads a DLL using ShellExecuteW using the \"open\" verb.\n\n\n0x89 \nCreates a directory with a specified name\n\n\n0x8a \nDelete a specified file\n\n\n0x8b \nDelete a directory and its contents.\n\n\n0x8c \nObtains the creation, modification and access times of a file and sends them to the C2\n\n\n0x8e \nExecutes a file using Explorer's token or runs a DLL using ShellExecuteW and the open verb.\n\n\n0x8f \nMove a specified file to a specified location\n\n\n0x90 \nSteal credentials from Window's Protected Storage (PStore)\n\n\n0x92 \nCreate a reverse shell\n\n\n0x93 \nWrite string to file for an unknown purpose.\n\n\n0x94 \nSets flag v2 + 0x19\n\n\n0x98 \nEnumerates visible Windows and reports the process names to the C2\n\n\n0x99 \nSends the WM_DESTROY message to a specific Window to close it\n\n\n0x9a \nShow a specified Window and set it as the foreground\n\n\n0x9b \nShow a specified Window\n\n\n0x9c \nSet the title of a Window\n\n\n0x9d \nInteract with open window by issuing keystrokes.\n\n\n0x9f \nIssue keystroke\n\n\n0xb0 \nCompares the length of v2 + 0xB2 with the specified value.\n\n\n0xb1 \nSet a specified registry value, and responds with \"\\xa6\u6253\u5f00\u5b50\u5065\u5931\u8d25\" (Open Zijian failure) if it fails.\n\n\n0xb2 \nDelete a specified registry value, and responds with \"\\xa6\u5220\u9664\u5b50\u5065\u5931\u8d25\" (Remove Zijian failure) if it fails or \"\\xa5\u5220\u9664\u5b50\u5065\u6210\u529f\" (Remove Zijian success) if successful.\n\n\n0xb3 \nEnumerates the values within a specified registry key, and responds with \"\\xa5\u83b7\u53d6\u76ee\u6807\u4fe1\u606f\u5931\u8d25\" or \"\\xa5Failed to obtain key information\" if it is unsuccessful.\n\n\n0xb4 \nRename a specific registry key to another value, and responds with \"\\xa6\u91cd\u547d\u540d\u5b50\u5065\u5931\u8d25\" or \"\\xa6Rename Zijian failure\" if it is unsuccessful.\n\n\n0xb5 \nCreate a specific registry key, and responds with \"\\a7\u65b0\u5efa\u9879\u6210\u529f\" or \"\\a7New item successful\" if it is successful.\n\n\n0xb7 \nDeletes a specified key, and responds with \"\\xaa\u5220\u9664Key\u5931\u8d25\" (Delete key failure) if it is unsuccessful or \"\\xab\u5220\u9664Key\u6210\u529f\" (Delete Key Success) if successful.\n\n\n0xb8 \nEchoes the message 0xb8 back to the C2\n\n\n0xb9 \nList services and each service's status and boot method\n\n\n0xba \nStart or stop a service.\n\n\n0xbb \nModify the configuration of a service.\n\n\n0xbc \nCreates a service using specified name, description and binary path, and responds with \"\u521b\u5efa\u670d\u52a1 &lt;name&gt; \u6210\u529f\" (Create a service &lt;name&gt; success) if successful.\n\n\n0xbd \nDetermines available network locations (TCP and UDP) by calling the GetExtendedTcpTable and GetExtendedUdpTable API functions\n\n\n0xbe \nList running processes.\n\n\n0xbf \nTerminate a specified process\n\n\n0xc0 \nGathers system information, such as operating system version, CPU name and speed, physical memory and amount available, current process ID, as well as data saved to the clipboard.\n\n\n0xc1 \nUninstall Evilgrab.\n\n\n0xc2 \nStop Evilgrab's main thread, effectively killing Evilgrab until next reboot\n\n\n0xc3 \nSame as 0xc2 command\n\n\n0xc5 \nCreate a temporary file.\n\n\n0xe0 \nCloses an open TCP connection that matches a specified network location. This command uses the SetTcpEntry function to close a connection. This command responds \"\u5173\u95ed\u8fde\u63a5\u6210\u529f\" (Close the connection is successful).\n\n\n0xe1 \nTake a single screenshot\n\n\n0xe2 \nTake a single screenshot\n\n\n0xe3 \nStarts video capture using single screenshots.\n\n\n0xe4 \nEchoes the message 0xe4 back to the C2\n\n\n0xe5 \nStarts video capture using single screenshots.\n\n\n0xe6 \nList contents of a folder.\n\n\n0xe9 \nSets up proxy communication point between the C2 and another specified network location over a specified TCP port.\n\n\n0xea \nCloses the thread responsible for the proxy communications set up in the 0xe9 command\n\n\n0xec \nSets up the VideoInputDeviceCategory class for video capture\n\n\n0xed \nCloses a Window, appears to stop the video capture using VideoInputDeviceCategory\n\n\n0xee \nStarts video capture using the VideoInputDeviceCategory class\n\n\n0xf0 \nStarts audio capture that it sends directly to the C2\n\n\n0xf1 \nAppears to stop the audio capture\n\n\n0xf2 \nSearch for specific files and exfiltrate their contents.\n\n\n0xf5 \nStops the thread that was created in command 0xf2 to exfiltrate files by setting a specific flag (mainDataStructure[800])\n\n\n\nTable 2.\u00a0Commands available in Evilgrab command handler\nIn addition to the command handler, Evilgrab\u2019s functional code also contains the following supplemental functionality:\n\n\tPlugin Support - Evilgrab enumerates the %USERPROFILE%\\\\WindowsPlugin folder and runs all files with a \".exe\" file extension.\n\tQQ Monitoring \u2013 Evilgrab monitors for windows associated with Tencent\u2019s QQ messaging program and will scrape memory for strings to steal messages.\n\tKeylogging \u2013 Logs keystrokes to \u2018%USERPROFILE%\\users.bin\u2019.\n\nUnit 42 created a ChopShop module to parse packet captures containing communications between Evilgrab and its C2 server.\nInfrastructure Analysis\nThe Evilgrab payload delivered by the watering hole had the following hardcoded domains that it uses as C2 servers:\n\n\tdns.websecexp[.]com\n\tns.websecexp[.]com\n\tappeur.gnway[.]cc\n\nUnit 42 discovered additional infrastructure related these three domains, as seen in the chart in Figure 6.\n\n\nFigure 6.\u00a0Infrastructure related to Evilgrab C2 Servers\nUnit 42 is aware of the following additional subdomains hosted on the domain websecexp[.]com:\n\n\tusafi.websecexp[.]com\n\tusacia.websecexp[.]com\n\twebhttps.websecexp[.]com\n\tusagovdns.websecexp[.]com\n\nThe domain dns.websecexp[.]com had also been used as a C2 server for a sample of the 9002 Trojan, which is another tool used in cyber espionage campaigns. This domain resolved to the IP address 59.188.16[.]130 as far back as December 2013, which also hosted the following domains. In contrast to websecexp[.] com, this second level was registered using a service to hide the registrant information:\n\n\tceshi.mailpseonfz[.]com\n\tdns.mailpseonfz[.]com\n\nUnit 42 is aware of the ceshi.mailpseonfz[.]com domain hosting C2 services for another Evilgrab sample, as well as a sample of the 9002 Trojan. The time frame that the infrastructure above has hosted Evilgrab and 9002 C2 server spans from 2013 to 2015, which suggests the same group is reusing the same infrastructure over a period of years.\nConclusion\nThreat actors compromised the President of Myanmar's website to create a watering hole to infect visitors to the website. Based on data collected in our threat intelligence cloud, the watering hole was active and delivering a malicious payload during May 2015. Open source intelligence suggests that the site may have been a watering hole containing an exploit for CVE-2014-6332 in November 2014 as well. Setting up a watering hole on this site suggests the threat actors, possibly comprising more than one group, are looking to collect information on individuals in Myanmar, individuals involved in political relations with the country and\/or organizations doing business in Myanmar.\n\nThe May 2015 watering hole delivered a variant of the Evilgrab Trojan to visitors via an unknown vulnerability. The Evilgrab payload itself uses an interesting anti-analysis technique to increase the complexity required to analyze the Trojan. In addition, the Evilgrab payload delivered by this watering hole shares infrastructure that has hosted C2 servers for other Evilgrab payloads, as well as samples of the 9002 Trojan.\u00a0 The threat actors have used this infrastructure in attacks since at least 2013.\n\nThis watering hole attack shows threat groups\u2019 continued adoption of this attack vector, as it is much more difficult to analyze and detect than the typical spear-phishing attacks. Once a threat actor has control over the web server hosting the watering hole, the actor can control when to start and stop the delivery of the malicious content, which requires constant monitoring of traffic to the website to determine if and when the attack occurs. However, in this case the threat actors reused old infrastructure to host the C2 servers for the delivered payload, which made detection and attribution easier.\n\n[1] https:\/\/www.virustotal.com\/en\/url\/91f7d6612c79cc0b266891c447359853614546837b003836ab342b091ee1a6cc\/analysis\/\n[2] https:\/\/www.virustotal.com\/en\/file\/b8c37a1db36d702932b5db97ec150269a323b5dc76059062beff7e330f2d136d\/analysis\/\n[3] http:\/\/blog.trendmicro.com\/trendlabs-security-intelligence\/evilgrab-malware-family-used-in-targeted-attacks-in-asia\/\n[4] http:\/\/pwc.blogs.com\/files\/cto-tib-20150223-01a.pdf\n[5] http:\/\/contagiodump.blogspot.com\/2013\/09\/sandbox-miming-cve-2012-0158-in-mhtml.html\nIndicators from this report\nDomains\nusafbi.websecexp[.]com\nusacia.websecexp[.]com\nwebhttps.websecexp[.]com\nusagovdns.websecexp[.]com\nceshi.mailpseonfz[.]com\ndns.mailpseonfz[.]com\ndns.websecexp[.]com\nns.websecexp[.]com\nappeur.gnway[.]cc\nmmslsh.tiger1234[.]com\n\nSHA256 values:\nEvilGrab\n10d9611e5b4ff41fc79e8907e3eb522630131b1bdc1010a0564c8780ba55c87c\nRelated Downloader Trojan\nb69106e06dc008e4fa1e4a0b0b58fcb1dc6d2016422a35cb3111168fd3fae577","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"","width":"","height":""},"author":[{"@type":"Person","name":"Robert Falcone"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"9390","token":"7e15a0f8b3","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=9390' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fevilgrab-delivered-by-watering-hole-attack-on-president-of-myanmars-website%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fevilgrab-delivered-by-watering-hole-attack-on-president-of-myanmars-website%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-9390 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Evilgrab Delivered by Watering Hole Attack on President of Myanmar’s Website</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-9390 entry-meta">
			
			
			<span class="post-views-count">23,642</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'9390','like')"><i class="ui ui-2"></i><span class="ml-5">0</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 13</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fevilgrab-delivered-by-watering-hole-attack-on-president-of-myanmars-website%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fevilgrab-delivered-by-watering-hole-attack-on-president-of-myanmars-website%2F+-+Evilgrab+Delivered+by+Watering+Hole+Attack+on+President+of+Myanmar%E2%80%99s+Website" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fevilgrab-delivered-by-watering-hole-attack-on-president-of-myanmars-website%2F&title=Evilgrab+Delivered+by+Watering+Hole+Attack+on+President+of+Myanmar%E2%80%99s+Website&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/evilgrab-delivered-by-watering-hole-attack-on-president-of-myanmars-website/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/robertfalcone/" title="Posts by Robert Falcone" class="author url fn" rel="author">Robert Falcone</a>        </p>
        <p><time datetime="2015-06-11T16:00:08+00:00">June 11, 2015 at 7:00 PM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/malware-2/" rel="category tag">Malware</a>, <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/evilgrab/" rel="tag">Evilgrab</a>, <a href="https://unit42.paloaltonetworks.com/tag/iframe/" rel="tag">IFRAME</a>, <a href="https://unit42.paloaltonetworks.com/tag/javascript/" rel="tag">JavaScript</a>, <a href="https://unit42.paloaltonetworks.com/tag/myanmar/" rel="tag">Myanmar</a>, <a href="https://unit42.paloaltonetworks.com/tag/trojan/" rel="tag">Trojan</a>, <a href="https://unit42.paloaltonetworks.com/tag/vidgrab/" rel="tag">Vidgrab</a>, <a href="https://unit42.paloaltonetworks.com/tag/watering-hole-attack/" rel="tag">Watering Hole Attack</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                    <p>On May 12, 2015, Unit 42 observed an apparent watering hole attack, also known as a strategic website compromise (SWC), involving the President of Myanmar&#8217;s website. Visiting the main page hosted at &#8220;www.president-office.gov[.]mm&#8221; triggered the malicious content, as the threat actors injected an inline frame (IFRAME) into a JavaScript file used by Drupal for the site&#8217;s theme.</p>
<p>Unit 42 believes threat actors chose this website to set up a watering hole in order to target and gather information on individuals in Myanmar, individuals involved in political relations with the country and/or organizations doing business in Myanmar. Unit 42 has evidence to suggest the threat actors have had access to the website since November 2014 if not earlier.</p>
<p>Shortly after we reported the infection to the operators of the website, they took it offline. A new website containing the same content is hosted at “www.myanmarpresidentoffice.info”, which has several artifacts and references to the original content hosted at “president-office.gov.mm” but does not contain the exploit code. We believe the use of the new domain may be part of their remediation process.</p>
<p>This blog discusses the known details of the watering hole, interesting characteristics of the delivered Evilgrab sample (AKA Vidgrab) and the threat infrastructure associated with the attack.<span id="more-9390"></span></p>
<h3>Chain of Compromise</h3>
<p>The main page previously hosted at &#8220;www.president-office.gov.mm&#8221; was powered by Drupal, which loaded several Javascript files that applied a Drupal theme. One of these Javascript files loaded by the main page, named &#8220;script.js&#8221; and seen in Figure 1, was responsible for several of the website&#8217;s features, including the cycling slides of content on the main page.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/evilgrab_1.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9391" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/evilgrab_1-500x10.png" alt="evilgrab_1" width="500" height="10" /></a></p>
<p style="text-align: center;">Figure 1. External JavaScript Used to Load Drupal Theme</p>
<p>The &#8220;script.js&#8221; file also contained an IFRAME (Figure 2), which Unit 42 believes threat actors injected to exploit the browsers of visitors to the website. We analyzed the content in &#8220;script.js&#8221;, as well as the HTTP response received from the web server. One interesting thing to note is that the web server, specifically Drupal version 7, used HTTP responses that contain the &#8220;Last-Modified&#8221; field for caching purposes. We checked the response for the &#8220;script.js&#8221; file that contained the injected IFRAME and found a &#8220;Last-Modified&#8221; date of &#8220;Wed, 24 Dec 2014 02:38:58 GMT&#8221;, which may suggest that the threat actor injected the IFRAME on December 24, 2014.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/evilgrab_2.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9392" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/evilgrab_2-500x23.png" alt="evilgrab_2" width="500" height="23" /></a></p>
<p style="text-align: center;">Figure 2. IFRAME Injected into Drupal JavaScript</p>
<p>Unfortunately, we do not have access to the content that was hosted at this location and requests for access currently result in an HTTP 404 Not Found error. Unit 42 cannot determine which vulnerability this code may have exploited without access to the content. But regardless of the vulnerability exploited, our WildFire system detected the payload in transit and classified the file as malware.</p>
<p>Unit 42 is aware of another malicious script hosted on the President of Myanmar&#8217;s website in November 2014, a month prior to when the IFRAME described in this blog appears to have been injected. VirusTotal captured the contents hosted at the following URL[1], which hosted a VBScript[2] that exploited CVE-2014-6332 to install a downloader Trojan:</p>
<p>http://www.president-office.gov[.]mm/welcome[.]html</p>
<p>The downloader Trojan had the following characteristics:</p>
<p><strong>SHA256</strong>:b69106e06dc008e4fa1e4a0b0b58fcb1dc6d2016422a35cb3111168fd3fae577<br />
<strong>C2</strong>: mmslsh.tiger1234[.]com</p>
<p>This suggests threat actors, who may or may not be the same ones who injected the malicious IFRAME, have displayed a consistent interest in compromising visitors to this website since at least November 2014.</p>
<h3>Payload Installation</h3>
<p>On May 12, 2015, a globally recognized organization in the oil and gas industry visited the following URL that hosted the watering hole on the President of Myanmar&#8217;s website:</p>
<p>http://www.president-office.gov[.]mm/sites/all/modules/browscap/List_View.php</p>
<p>Visiting this URL resulted in the download of a variant of the Evilgrab Trojan that has been used in past cyber espionage campaigns[3][4]. During our malware analysis efforts, we found some interesting features within this Evilgrab sample, which is denoted as version ‘V2014-v05’ that has the following attributes:</p>
<p><strong>Filename</strong>: newdata.exe<br />
<strong>MD5</strong>: 2e78e6d02aaed4f057f4dfa631ea5519<br />
<strong>SHA256:</strong> 10d9611e5b4ff41fc79e8907e3eb522630131b1bdc1010a0564c8780ba55c87c<br />
<strong>Compiled</strong>: 2015-04-30<br />
<strong>C2</strong>: dns.websecexp[.]com:81 (211.169.202.2)<br />
<strong>C2</strong>: ns.websecexp[.]com<br />
<strong>C2</strong>: appeur.gnway[.]cc<br />
<strong>Mutex:</strong> 2010-3<br />
<strong>Mutex</strong>: New2010-V3-Uninstall</p>
<p>This Evilgrab sample attempts to detect certain antivirus products on an infected system and will only run if it does not detect the presence of Kaspersky, TrendMicro, Symantec&#8217;s Norton, ESET, or AVG antivirus products. The initial Evilgrab payload has two embedded dynamic link libraries (DLL): it uses one DLL to load the second DLL that contains the functional code. The initial payload carries out an installation process by storing both of these DLLs, as well as the path to the initial payload, in the Windows registry in encrypted form to the following registry keys:</p>
<ul>
<li>Software\rar\data &#8211; Functional Code DLL</li>
<li>Software\rar\s &#8211; Loader DLL</li>
<li>Software\rar\e &#8211; Path to Initial Payload</li>
</ul>
<p>While previous Evilgrab versions also installed their functional code to these registry locations, the installation process itself within the initial Evilgrab payload includes an interesting anti-analysis technique that relies on the structured exception handler (SEH) to call important functions.</p>
<p>Let’s take a step back and first describe the structured event handler, which is built into an application that includes code to handle exceptions. The SEH allows a developer to catch exceptions that occur during the execution of the application and run specific code to handle the exception instead of crashing the application. Exceptions can occur for a variety of reasons, such as attempting to divide a value by zero or attempting to access a memory segment without the proper permissions.</p>
<p>The initial Evilgrab payload uses the SEH to carry out the installation process, by setting up the SEH to call specific functions in the event of an exception and including code that purposefully causes an exception. Evilgrab uses the SEH and forced exceptions as an anti-analysis technique to add a level of difficulty to the malware analysis process. For example, Evilgrab uses the assembly code in Figure 3 that shows a call to a function that we named &#8216;divBy0_invokeExceptionToCallXor58&#8217;.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/evilgrab_3.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9393" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/evilgrab_3-500x56.png" alt="evilgrab_3" width="500" height="56" /></a></p>
<p style="text-align: center;">Figure 3. Assembly Code To Call Function that Forces an Exception</p>
<p>The call to the &#8216;divBy0_invokeExceptionToCallXor58&#8217; function has a pointer to a buffer that contains cipher text (buf_LoaderDLLInCipherText), as well as a pointer to a DWORD (dd_LoaderDLLLength) that contains the length of the buffer. In the &#8216;divBy0_invokeExceptionToCallXor58&#8217; function, the assembly instructions in Figure 4 cause an exception by attempting to divide a value by zero by setting the value in &#8216;ecx&#8217; to zero (xor ecx, ecx instruction) and attempting to divide the value in &#8216;eax&#8217; with &#8216;ecx&#8217; (idiv ecx instruction):</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/evilgrab_4.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-9394" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/evilgrab_4.png" alt="evilgrab_4" width="464" height="112" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/evilgrab_4.png 464w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/evilgrab_4-300x72.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/evilgrab_4-370x89.png 370w" sizes="(max-width: 464px) 100vw, 464px" /></a></p>
<p style="text-align: center;">Figure 4. Assembly Code To Force an Exception by Dividing by Zero</p>
<p>This division by zero exception invokes the SEH to call a specific function to handle the exception. The exception is handled by the exception handler in Figure 5.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/evilgrab_5.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9395" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/evilgrab_5-500x152.png" alt="evilgrab_5" width="500" height="152" /></a></p>
<p style="text-align: center;">Figure 5. Evilgrab&#8217;s Exception Handler Invoked After Forcing an Exception</p>
<p>The exception handler was created to handle the division by zero exception by running the function that Unit 42 named &#8216;xorBufferBy58&#8217;. The purpose of forcing this exception is to call the &#8216;xorBufferBy58&#8217;, using the previously mentioned &#8216;buf_codeInCipherText&#8217; and &#8216;dd_codeLength&#8217; values as arguments.</p>
<p>The sample uses this technique to call functions we’ve named &#8216;createWinlogonProcessAndInjectCode&#8217; and &#8216;launchInjectedCode&#8217;. The &#8216;createWinlogonProcessAndInjectCode&#8217; function creates a suspended process (CREATE_SUSPENDED flag) using the %SYSTEM%\winlogon.exe executable. It then allocates several memory sections within the winlogon.exe process using VirtualAllocEx and it writes data to these sections using WriteProcessMemory, including the compressed payload that was decrypted using the &#8216;xorBufferBy58&#8217; function. It also writes a block of shellcode to the entry point of the winlogon.exe process to load the EvilGrab loader DLL, which is responsible for obtaining the Evilgrab functional code from the registry and executing it. When the last exception has been triggered in the initial Evilgrab payload, the SEH calls the &#8216;launchInjectedCode&#8217; function to resume the suspended &#8216;winlogon.exe&#8217; process to launch the Evilgrab functional code.</p>
<h3>Evilgrab Functionality</h3>
<p>Evilgrab is a fully functional remote administration tool (RAT) that allows threat actors to interact with compromised systems to exfiltrate data. The method in which this Evilgrab payload communicates with its C2 server is rather interesting. Previously publically discussed Evilgrab samples sent a beacon of &#8220;\x01\x00\x00\x00\x33&#8221; to the C2 server; however, this payload issues a fake HTTP request to the C2 server in place of this beacon. It uses raw sockets to send data to and receive data from its C2 server, which allows the payload to construct custom packets. The fake HTTP request used as a beacon is as follows:</p>
<p><img class="aligncenter size-large wp-image-9414" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/c2_get_request-500x183.png" alt="c2_get_request" width="500" height="183" /></p>
<p>&nbsp;</p>
<p>The first four bytes (\xdd\x00\x00\x00) are anomalous, as the HTTP protocol requires the HTTP verb (GET, POST, etc.) to be at the very beginning of the packet. The first four bytes in this packet specify the length of the following data and the remaining bytes are data sent to the C2 server. Evilgrab will use this packet structure for all correspondence with the C2 server. In addition to the anomaly in the first four bytes, the HTTP Host field in the Evilgrab request is also anomalous as it contains a full URL instead of just the hostname of the web server. The malware author put the full URL to a Windows update page in the Host field instead of including the URL portion (/windowsupdate/v6/default.aspx?ln=zh-cn) after the HTTP verb and the domain (update.microsoft.com) in the Host field. The malware author chose this particular Windows update URL in an attempt to make the HTTP request look legitimate.</p>
<p>After the Evilgrab payload sends out this fake HTTP request beacon, it receives the C2 server&#8217;s response and checks for a specific response to confirm that the payload communicated with an Evilgrab C2 server. The payload checks the C2 server’s response for the following:<br />
<img class="aligncenter size-large wp-image-9413" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/c2_response-500x127.png" alt="c2_response" width="500" height="127" /></p>
<p>The response shown above is also an anomalous HTTP response for several reasons. First, the Location field does not have a space before the location. Second, &#8220;Bad Request (Invalid Verb)&#8221; is used in an HTTP 400 Bad Request error message not an HTTP 301 message. The HTTP 400 Bad Request error would make sense, as a web server would expect the HTTP request to start with an HTTP verb but it begins with four bytes for the data length as previously mentioned. Mila at ContagioDump observed the same C2 response to Evilgrab in a delivery document exploiting CVE-2012-0158 in August 2013[5], but that sample did not use the fake HTTP request as a beacon as seen here.</p>
<p>Immediately after receiving the appropriate C2 response to its beacon, Evilgrab sends a 4096-byte packet to the C2 server that contains the following:</p>
<p><em>\xfc\x0f\x00\x00\xa02015-05-13|(192.168.180.47)|49157|Windows7|J|A|No|0天0小时0分28秒|No|V2014-v05|2052|0|50fb78a5|0|0|&lt;3987 additional bytes&gt;</em></p>
<p>Again, the first four bytes is the length of the following data, followed by a static response identifier (0xA0) and a pipe-delimited (‘|’) string of data gathered from the compromised system. Table 1 shows each field and the description of its contents.</p>
<table>
<tbody>
<tr>
<td width="295"><strong>Description</strong></td>
<td width="114"><strong>Data Type</strong></td>
<td width="168"><strong>Example Value</strong></td>
</tr>
<tr>
<td width="295">Campaign ID</td>
<td width="114">String</td>
<td width="168">2015-05-13</td>
</tr>
<tr>
<td width="295">System IP Address</td>
<td width="114">String</td>
<td width="168">(192.168.180.47)</td>
</tr>
<tr>
<td width="295">TCP Port from System</td>
<td width="114">Decimal</td>
<td width="168">49157</td>
</tr>
<tr>
<td width="295">Operating System Version</td>
<td width="114">String</td>
<td width="168">Windows7</td>
</tr>
<tr>
<td width="295">First Letter of Hostname</td>
<td width="114">Character</td>
<td width="168">J</td>
</tr>
<tr>
<td width="295">First Letter of Username</td>
<td width="114">Character</td>
<td width="168">A</td>
</tr>
<tr>
<td width="295">Video Capture Device Connected</td>
<td width="114">String</td>
<td width="168">No</td>
</tr>
<tr>
<td width="295">System Idle Time</td>
<td width="114">String</td>
<td width="168">0天0小时0分28秒</td>
</tr>
<tr>
<td width="295">Removable Drive Connected</td>
<td width="114">String</td>
<td width="168">No</td>
</tr>
<tr>
<td width="295">Evilgrab Version</td>
<td width="114">String</td>
<td width="168">V2014-v05</td>
</tr>
<tr>
<td width="295">Evilgrab Process ID</td>
<td width="114">Decimal</td>
<td width="168">2052</td>
</tr>
<tr>
<td width="295">Static Zero</td>
<td width="114">Decimal</td>
<td width="168">0</td>
</tr>
<tr>
<td width="295">Random Value based initial value of 0x50FB125B repeatedly XOR by GetTickCount</td>
<td width="114">Hexadecimal</td>
<td width="168">50fb78a5</td>
</tr>
<tr>
<td width="295">Boolean value if the keylogger is running</td>
<td width="114">Hexadecimal</td>
<td width="168">0</td>
</tr>
<tr>
<td width="295">Boolean value that the operator sets via the 0x7e command for unknown reason.</td>
<td width="114">Character</td>
<td width="168">0</td>
</tr>
</tbody>
</table>
<p style="text-align: center;">Table 1. Each element of the system data sent from Evilgrab to the C2 server</p>
<p>The functional Evilgrab code contains a fully featured command handler that allows an operator to interact with the infected system to carry out remote administration activities and data exfiltration. Table 2 contains a comprehensive list of the commands available within the command handler.</p>
<table width="590">
<tbody>
<tr>
<td width="85"><strong>Command</strong></td>
<td width="505"><strong>Description</strong></td>
</tr>
<tr>
<td width="85"><strong>0x78 </strong></td>
<td width="505">Turns on the QQ Memory Scraper and Keylogger</td>
</tr>
<tr>
<td width="85"><strong>0x79 </strong></td>
<td width="505">Kills the QQ Memory Scraper and Keylogger functionality</td>
</tr>
<tr>
<td width="85"><strong>0x7a </strong></td>
<td width="505">Sets flags within the class. One of the flags is the hexadecimal value in the initial data sent from the host, specifically the 13th element of the pipe-delimited string</td>
</tr>
<tr>
<td width="85"><strong>0x7b </strong></td>
<td width="505">Uploads a specified file from the system to the C2 server</td>
</tr>
<tr>
<td width="85"><strong>0x7c </strong></td>
<td width="505">Creates a file with a specified name.</td>
</tr>
<tr>
<td width="85"><strong>0x7d </strong></td>
<td width="505">Sends the flags that indicate whether the QQ Memory Scraper and Keylogger are running</td>
</tr>
<tr>
<td width="85"><strong>0x7e </strong></td>
<td width="505">Sets a boolean value within the ActiveSettings. Unknown reason, but operators may use it to note if they have been there or not.</td>
</tr>
<tr>
<td width="85"><strong>0x82 </strong></td>
<td width="505">Enumerate mounted volumes of storage and their type. The drive type prefixes the volume label, and the drive type prefixes sent within the response to the C2 are: Removable F-Fixed N-remote (network) C-cdrom D-ramdisk</td>
</tr>
<tr>
<td width="85"><strong>0x83 </strong></td>
<td width="505">List contents of a folder, or file, along with each files last modification time, filename and file attributes</td>
</tr>
<tr>
<td width="85"><strong>0x84 </strong></td>
<td width="505">Check to see if a specific file exists.</td>
</tr>
<tr>
<td width="85"><strong>0x85 </strong></td>
<td width="505">Receive a file from the C2 and Execute it</td>
</tr>
<tr>
<td width="85"><strong>0x86 </strong></td>
<td width="505">Creates a file and sets the file pointer</td>
</tr>
<tr>
<td width="85"><strong>0x87 </strong></td>
<td width="505">Close handles to files created in command 0x85</td>
</tr>
<tr>
<td width="85"><strong>0x88 </strong></td>
<td width="505">Loads a DLL using ShellExecuteW using the &#8220;open&#8221; verb.</td>
</tr>
<tr>
<td width="85"><strong>0x89 </strong></td>
<td width="505">Creates a directory with a specified name</td>
</tr>
<tr>
<td width="85"><strong>0x8a </strong></td>
<td width="505">Delete a specified file</td>
</tr>
<tr>
<td width="85"><strong>0x8b </strong></td>
<td width="505">Delete a directory and its contents.</td>
</tr>
<tr>
<td width="85"><strong>0x8c </strong></td>
<td width="505">Obtains the creation, modification and access times of a file and sends them to the C2</td>
</tr>
<tr>
<td width="85"><strong>0x8e </strong></td>
<td width="505">Executes a file using Explorer&#8217;s token or runs a DLL using ShellExecuteW and the open verb.</td>
</tr>
<tr>
<td width="85"><strong>0x8f </strong></td>
<td width="505">Move a specified file to a specified location</td>
</tr>
<tr>
<td width="85"><strong>0x90 </strong></td>
<td width="505">Steal credentials from Window&#8217;s Protected Storage (PStore)</td>
</tr>
<tr>
<td width="85"><strong>0x92 </strong></td>
<td width="505">Create a reverse shell</td>
</tr>
<tr>
<td width="85"><strong>0x93 </strong></td>
<td width="505">Write string to file for an unknown purpose.</td>
</tr>
<tr>
<td width="85"><strong>0x94 </strong></td>
<td width="505">Sets flag v2 + 0x19</td>
</tr>
<tr>
<td width="85"><strong>0x98 </strong></td>
<td width="505">Enumerates visible Windows and reports the process names to the C2</td>
</tr>
<tr>
<td width="85"><strong>0x99 </strong></td>
<td width="505">Sends the WM_DESTROY message to a specific Window to close it</td>
</tr>
<tr>
<td width="85"><strong>0x9a </strong></td>
<td width="505">Show a specified Window and set it as the foreground</td>
</tr>
<tr>
<td width="85"><strong>0x9b </strong></td>
<td width="505">Show a specified Window</td>
</tr>
<tr>
<td width="85"><strong>0x9c </strong></td>
<td width="505">Set the title of a Window</td>
</tr>
<tr>
<td width="85"><strong>0x9d </strong></td>
<td width="505">Interact with open window by issuing keystrokes.</td>
</tr>
<tr>
<td width="85"><strong>0x9f </strong></td>
<td width="505">Issue keystroke</td>
</tr>
<tr>
<td width="85"><strong>0xb0 </strong></td>
<td width="505">Compares the length of v2 + 0xB2 with the specified value.</td>
</tr>
<tr>
<td width="85"><strong>0xb1 </strong></td>
<td width="505">Set a specified registry value, and responds with &#8220;\xa6打开子健失败&#8221; (Open Zijian failure) if it fails.</td>
</tr>
<tr>
<td width="85"><strong>0xb2 </strong></td>
<td width="505">Delete a specified registry value, and responds with &#8220;\xa6删除子健失败&#8221; (Remove Zijian failure) if it fails or &#8220;\xa5删除子健成功&#8221; (Remove Zijian success) if successful.</td>
</tr>
<tr>
<td width="85"><strong>0xb3 </strong></td>
<td width="505">Enumerates the values within a specified registry key, and responds with &#8220;\xa5获取目标信息失败&#8221; or &#8220;\xa5Failed to obtain key information&#8221; if it is unsuccessful.</td>
</tr>
<tr>
<td width="85"><strong>0xb4 </strong></td>
<td width="505">Rename a specific registry key to another value, and responds with &#8220;\xa6重命名子健失败&#8221; or &#8220;\xa6Rename Zijian failure&#8221; if it is unsuccessful.</td>
</tr>
<tr>
<td width="85"><strong>0xb5 </strong></td>
<td width="505">Create a specific registry key, and responds with &#8220;\a7新建项成功&#8221; or &#8220;\a7New item successful&#8221; if it is successful.</td>
</tr>
<tr>
<td width="85"><strong>0xb7 </strong></td>
<td width="505">Deletes a specified key, and responds with &#8220;\xaa删除Key失败&#8221; (Delete key failure) if it is unsuccessful or &#8220;\xab删除Key成功&#8221; (Delete Key Success) if successful.</td>
</tr>
<tr>
<td width="85"><strong>0xb8 </strong></td>
<td width="505">Echoes the message 0xb8 back to the C2</td>
</tr>
<tr>
<td width="85"><strong>0xb9 </strong></td>
<td width="505">List services and each service&#8217;s status and boot method</td>
</tr>
<tr>
<td width="85"><strong>0xba </strong></td>
<td width="505">Start or stop a service.</td>
</tr>
<tr>
<td width="85"><strong>0xbb </strong></td>
<td width="505">Modify the configuration of a service.</td>
</tr>
<tr>
<td width="85"><strong>0xbc </strong></td>
<td width="505">Creates a service using specified name, description and binary path, and responds with &#8220;创建服务 &lt;name&gt; 成功&#8221; (Create a service &lt;name&gt; success) if successful.</td>
</tr>
<tr>
<td width="85"><strong>0xbd </strong></td>
<td width="505">Determines available network locations (TCP and UDP) by calling the GetExtendedTcpTable and GetExtendedUdpTable API functions</td>
</tr>
<tr>
<td width="85"><strong>0xbe </strong></td>
<td width="505">List running processes.</td>
</tr>
<tr>
<td width="85"><strong>0xbf </strong></td>
<td width="505">Terminate a specified process</td>
</tr>
<tr>
<td width="85"><strong>0xc0 </strong></td>
<td width="505">Gathers system information, such as operating system version, CPU name and speed, physical memory and amount available, current process ID, as well as data saved to the clipboard.</td>
</tr>
<tr>
<td width="85"><strong>0xc1 </strong></td>
<td width="505">Uninstall Evilgrab.</td>
</tr>
<tr>
<td width="85"><strong>0xc2 </strong></td>
<td width="505">Stop Evilgrab&#8217;s main thread, effectively killing Evilgrab until next reboot</td>
</tr>
<tr>
<td width="85"><strong>0xc3 </strong></td>
<td width="505">Same as 0xc2 command</td>
</tr>
<tr>
<td width="85"><strong>0xc5 </strong></td>
<td width="505">Create a temporary file.</td>
</tr>
<tr>
<td width="85"><strong>0xe0 </strong></td>
<td width="505">Closes an open TCP connection that matches a specified network location. This command uses the SetTcpEntry function to close a connection. This command responds &#8220;关闭连接成功&#8221; (Close the connection is successful).</td>
</tr>
<tr>
<td width="85"><strong>0xe1 </strong></td>
<td width="505">Take a single screenshot</td>
</tr>
<tr>
<td width="85"><strong>0xe2 </strong></td>
<td width="505">Take a single screenshot</td>
</tr>
<tr>
<td width="85"><strong>0xe3 </strong></td>
<td width="505">Starts video capture using single screenshots.</td>
</tr>
<tr>
<td width="85"><strong>0xe4 </strong></td>
<td width="505">Echoes the message 0xe4 back to the C2</td>
</tr>
<tr>
<td width="85"><strong>0xe5 </strong></td>
<td width="505">Starts video capture using single screenshots.</td>
</tr>
<tr>
<td width="85"><strong>0xe6 </strong></td>
<td width="505">List contents of a folder.</td>
</tr>
<tr>
<td width="85"><strong>0xe9 </strong></td>
<td width="505">Sets up proxy communication point between the C2 and another specified network location over a specified TCP port.</td>
</tr>
<tr>
<td width="85"><strong>0xea </strong></td>
<td width="505">Closes the thread responsible for the proxy communications set up in the 0xe9 command</td>
</tr>
<tr>
<td width="85"><strong>0xec </strong></td>
<td width="505">Sets up the VideoInputDeviceCategory class for video capture</td>
</tr>
<tr>
<td width="85"><strong>0xed </strong></td>
<td width="505">Closes a Window, appears to stop the video capture using VideoInputDeviceCategory</td>
</tr>
<tr>
<td width="85"><strong>0xee </strong></td>
<td width="505">Starts video capture using the VideoInputDeviceCategory class</td>
</tr>
<tr>
<td width="85"><strong>0xf0 </strong></td>
<td width="505">Starts audio capture that it sends directly to the C2</td>
</tr>
<tr>
<td width="85"><strong>0xf1 </strong></td>
<td width="505">Appears to stop the audio capture</td>
</tr>
<tr>
<td width="85"><strong>0xf2 </strong></td>
<td width="505">Search for specific files and exfiltrate their contents.</td>
</tr>
<tr>
<td width="85"><strong>0xf5 </strong></td>
<td width="505">Stops the thread that was created in command 0xf2 to exfiltrate files by setting a specific flag (mainDataStructure[800])</td>
</tr>
</tbody>
</table>
<p style="text-align: center;">Table 2. Commands available in Evilgrab command handler</p>
<p>In addition to the command handler, Evilgrab’s functional code also contains the following supplemental functionality:</p>
<ul>
<li>Plugin Support &#8211; Evilgrab enumerates the %USERPROFILE%\\WindowsPlugin folder and runs all files with a &#8220;.exe&#8221; file extension.</li>
<li>QQ Monitoring – Evilgrab monitors for windows associated with Tencent’s QQ messaging program and will scrape memory for strings to steal messages.</li>
<li>Keylogging – Logs keystrokes to ‘%USERPROFILE%\users.bin’.</li>
</ul>
<p>Unit 42 created a <a href="https://github.com/pan-unit42/public_tools/blob/master/chopshop/modules/evilgrab.py">ChopShop module</a> to parse packet captures containing communications between Evilgrab and its C2 server.</p>
<h3>Infrastructure Analysis</h3>
<p>The Evilgrab payload delivered by the watering hole had the following hardcoded domains that it uses as C2 servers:</p>
<ul>
<li>dns.websecexp[.]com</li>
<li>ns.websecexp[.]com</li>
<li>appeur.gnway[.]cc</li>
</ul>
<p>Unit 42 discovered additional infrastructure related these three domains, as seen in the chart in Figure 6.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/06/evilgrab_8.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-9398" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/06/evilgrab_8-500x219.png" alt="evilgrab_8" width="500" height="219" /></a></p>
<p style="text-align: center;">Figure 6. Infrastructure related to Evilgrab C2 Servers</p>
<p>Unit 42 is aware of the following additional subdomains hosted on the domain websecexp[.]com:</p>
<ul>
<li>usafi.websecexp[.]com</li>
<li>usacia.websecexp[.]com</li>
<li>webhttps.websecexp[.]com</li>
<li>usagovdns.websecexp[.]com</li>
</ul>
<p>The domain dns.websecexp[.]com had also been used as a C2 server for a sample of the 9002 Trojan, which is another tool used in cyber espionage campaigns. This domain resolved to the IP address 59.188.16[.]130 as far back as December 2013, which also hosted the following domains. In contrast to websecexp[.] com, this second level was registered using a service to hide the registrant information:</p>
<ul>
<li>ceshi.mailpseonfz[.]com</li>
<li>dns.mailpseonfz[.]com</li>
</ul>
<p>Unit 42 is aware of the ceshi.mailpseonfz[.]com domain hosting C2 services for another Evilgrab sample, as well as a sample of the 9002 Trojan. The time frame that the infrastructure above has hosted Evilgrab and 9002 C2 server spans from 2013 to 2015, which suggests the same group is reusing the same infrastructure over a period of years.</p>
<h3>Conclusion</h3>
<p>Threat actors compromised the President of Myanmar&#8217;s website to create a watering hole to infect visitors to the website. Based on data collected in our threat intelligence cloud, the watering hole was active and delivering a malicious payload during May 2015. Open source intelligence suggests that the site may have been a watering hole containing an exploit for CVE-2014-6332 in November 2014 as well. Setting up a watering hole on this site suggests the threat actors, possibly comprising more than one group, are looking to collect information on individuals in Myanmar, individuals involved in political relations with the country and/or organizations doing business in Myanmar.</p>
<p>The May 2015 watering hole delivered a variant of the Evilgrab Trojan to visitors via an unknown vulnerability. The Evilgrab payload itself uses an interesting anti-analysis technique to increase the complexity required to analyze the Trojan. In addition, the Evilgrab payload delivered by this watering hole shares infrastructure that has hosted C2 servers for other Evilgrab payloads, as well as samples of the 9002 Trojan.  The threat actors have used this infrastructure in attacks since at least 2013.</p>
<p>This watering hole attack shows threat groups’ continued adoption of this attack vector, as it is much more difficult to analyze and detect than the typical spear-phishing attacks. Once a threat actor has control over the web server hosting the watering hole, the actor can control when to start and stop the delivery of the malicious content, which requires constant monitoring of traffic to the website to determine if and when the attack occurs. However, in this case the threat actors reused old infrastructure to host the C2 servers for the delivered payload, which made detection and attribution easier.</p>
<p>[1] https://www.virustotal.com/en/url/91f7d6612c79cc0b266891c447359853614546837b003836ab342b091ee1a6cc/analysis/<br />
[2] https://www.virustotal.com/en/file/b8c37a1db36d702932b5db97ec150269a323b5dc76059062beff7e330f2d136d/analysis/<br />
[3] http://blog.trendmicro.com/trendlabs-security-intelligence/evilgrab-malware-family-used-in-targeted-attacks-in-asia/<br />
[4] http://pwc.blogs.com/files/cto-tib-20150223-01a.pdf<br />
[5] http://contagiodump.blogspot.com/2013/09/sandbox-miming-cve-2012-0158-in-mhtml.html</p>
<h3>Indicators from this report</h3>
<p><strong>Domains<br />
</strong>usafbi.websecexp[.]com<br />
usacia.websecexp[.]com<br />
webhttps.websecexp[.]com<br />
usagovdns.websecexp[.]com<br />
ceshi.mailpseonfz[.]com<br />
dns.mailpseonfz[.]com<br />
dns.websecexp[.]com<br />
ns.websecexp[.]com<br />
appeur.gnway[.]cc<br />
mmslsh.tiger1234[.]com</p>
<p><strong>SHA256 values:<br />
</strong>EvilGrab<br />
10d9611e5b4ff41fc79e8907e3eb522630131b1bdc1010a0564c8780ba55c87c<br />
Related Downloader Trojan<br />
b69106e06dc008e4fa1e4a0b0b58fcb1dc6d2016422a35cb3111168fd3fae577</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
