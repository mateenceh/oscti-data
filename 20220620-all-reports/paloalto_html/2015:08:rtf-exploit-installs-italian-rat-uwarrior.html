
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>RTF Exploit Installs Italian RAT: uWarrior</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/rtf-exploit-installs-italian-rat-uwarrior/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Unit 42 researchers have observed a new Remote Access Tool (RAT) constructed by an unknown actor of Italian origin."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/rtf-exploit-installs-italian-rat-uwarrior/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="RTF Exploit Installs Italian RAT: uWarrior" />
<meta property="og:description" content="Unit 42 researchers have observed a new Remote Access Tool (RAT) constructed by an unknown actor of Italian origin." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/rtf-exploit-installs-italian-rat-uwarrior/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="AutoFocus" />
<meta property="article:tag" content="Remote Access Tool" />
<meta property="article:tag" content="uWarrior" />
<meta property="article:tag" content="WildFire" />
<meta property="article:section" content="Cybersecurity" />
<meta property="article:published_time" content="2015-08-24T12:02:57+00:00" />
<meta property="article:modified_time" content="2018-11-01T09:51:29+00:00" />
<meta property="og:updated_time" content="2018-11-01T09:51:29+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/08/uwarriorblogpic1.jpg" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/08/uwarriorblogpic1.jpg" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit 42 researchers have observed a new Remote Access Tool (RAT) constructed by an unknown actor of Italian origin." />
<meta name="twitter:title" content="RTF Exploit Installs Italian RAT: uWarrior" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/08/uwarriorblogpic1.jpg" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; RTF Exploit Installs Italian RAT: uWarrior Comments Feed" href="https://unit42.paloaltonetworks.com/rtf-exploit-installs-italian-rat-uwarrior/feed/" />
<meta property="og:likes" content="1"/>
<meta property="og:readtime" content="9"/>
<meta property="og:views" content="12,186"/>
<meta property="og:date_created" content="August 24, 2015 at 3:02 PM"/>
<meta property="og:post_length" content="2798"/>
<meta property="og:category" content="Cybersecurity"/>
<meta property="og:category" content="Threat Prevention"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/cybersecurity-2/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-prevention-2/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Brandon Levene"/>
<meta property="og:author" content="Robert Falcone"/>
<meta property="og:author" content="Tomer Bar"/>
<meta property="og:author" content="Tom Keigher"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/brandon-levene/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/robertfalcone/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/tomer-bar/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/tkeigher/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"RTF Exploit Installs Italian RAT: uWarrior","name":"RTF Exploit Installs Italian RAT: uWarrior","description":"Unit 42 researchers have observed a new Remote Access Tool (RAT) constructed by an unknown actor of Italian origin. This RAT, referred to as uWarrior because of embedded PDB strings, has been previously described by an independent researcher who noted a potentially unknown exploit being used against Microsoft Office. Initial research into the exploit by...","url":"https:\/\/unit42.paloaltonetworks.com\/rtf-exploit-installs-italian-rat-uwarrior\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/rtf-exploit-installs-italian-rat-uwarrior\/","datePublished":"August 24, 2015","articleBody":"Unit 42 researchers have observed a new Remote Access Tool (RAT) constructed by an unknown actor of Italian origin. This RAT, referred to as uWarrior because of embedded PDB strings, has been previously described by an independent researcher who noted a potentially unknown exploit being used against Microsoft Office.\n\nInitial research into the exploit by Unit 42 indicates that this actor has opted to include multiple exploits. One is CVE-2012-1856, reinvigorated with a novel ROP chain to bypass ASLR and deliver the uWarrior payload. The other appears to be CVE-2015-1770. The malware itself is a fully featured RAT, which uses a compressed, (optionally) encrypted, raw TCP socket and binary message protocol for command and control communications.\n\nDuring the course of our research, it became evident that this actor had not built uWarrior from scratch, but rather opted to borrow components from several off-the-shelf tools. Linkages between older RATs are explored later in this blog.\nRTF Exploitation and ASLR Bypass\nThe weaponized RTF document used by this actor contains multiple OLE objects. In this instance, we see two different exploits, as well as two methods of bypassing ASLR exploit mitigations. The first method was published in 2014 by Parvez Anwar. The method he describes involves creating an embedded OLE object which contains a ProgID for \u201cotkloadr.WRAssembly.1\u201d. This causes MSVCR71.DLL to be loaded, a library which is not compiled with \/DYNAMICBASE.\n\nWhen using OLE to perform exploitation, ActiveX objects can be used to cite specific CLSID values. This is useful to an attacker as many of these CLSID values map to DLLs on the system. Attackers can deliberately use this to load any DLL they desire into the affected application so long as it maps to a valid CLSID.\n\nThis method was actually described at Black Hat USA 2015 in the talk: \u201cAttacking Interoperability: An OLE Edition\u201d by researchers Haifei Li and Bing Sun of Intel Security.\n\nAs a result of this method, it is possible for the attacker to force the loading of less secure libraries which were not compiled with the \/DYNAMICBASE compiler flag (enables ASLR at compile time), or other libraries which further enable the corruption and manipulation of memory.\n\nFrom the RTF document, we can use oletools to extract each OLE object. Thus far, we have encountered two weaponized RTF documents.\n\nInterestingly, both documents contained identical OLE objects:\n\n\n\n7ff9ff29b79d0eb38813bfa0b0bb1c5b116d1f9e5468ae52674bb443468658d9\nobject_00000020.bin\n\n\n7f29f2dc8b60c0e5a22575d9c76fd9c3d39604d1acf5cb4d938a63095c61a72e\nobject_000000E6.bin\n\n\nfe80d59686806afe3dc48f73d54b577558a7c871da17d08d937c5d7b3564e07b\nobject_000187A1.bin\n\n\n70ea7ef3bf9966c3297a4e78024e3083013558670d051c2ca3095e2588a576d8\nobject_0002802C.bin\n\n\n\nCloser examination of each of the OLE objects reveals that two of them have compressed zip files embedded in them at an offset of 1577 bytes:\nobject_000000E6.bin:\n[+] Start search on 49201 bytes (48.0 KB)\n[+] File at 41 size=48128 (47.0 KB): Microsoft Office document\n[+] File at 1577 size=46556 (45.5 KB): ZIP archive\n[+] End of search -- offset=49201 (48.0 KB)\n\nobject_0002802C.bin:\n[+] Start search on 50737 bytes (49.5 KB)\n[+] File at 41 size=49664 (48.5 KB): Microsoft Office document\n[+] File at 1577 size=47720 (46.6 KB): ZIP archive\n[+] End of search -- offset=50737 (49.5 KB)\n\nOnce carved and unzipped, we can see a small directory structure. Within the word\/activex directory, we can see ActiveX binaries, as well as XML documents associated with them. The XML files themselves are mostly identical; duplicates of only two particularly unique ones. The contents of these two files are as follows:\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?&gt;\n&lt;ax:ocx ax:classid=\"{1EFB6596-857C-11D1-B16A-00C0F0283628}\" ax:license=\"9368265E-85FE-11d1-8BE3-0000F8754DA1\" ax:persistence=\"persistStorage\" r:id=\"rId1\" xmlns:ax=\"http:\/\/schemas.microsoft.com\/office\/2006\/activeX\" xmlns:r=\"http:\/\/schemas.openxmlformats.org\/officeDocument\/2006\/relationships\"\/&gt;\n\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?&gt;\n&lt;ax:ocx ax:classid=\"{cddbcc7c-be18-4a58-9cbf-d62a012272ce}\" ax:license=\"9368265E-85FE-11d1-8BE3-0000F8754DA1\" ax:persistence=\"persistStorage\" r:id=\"rId1\" xmlns:ax=\"http:\/\/schemas.microsoft.com\/office\/2006\/activeX\" xmlns:r=\"http:\/\/schemas.openxmlformats.org\/officeDocument\/2006\/relationships\"\/&gt;\n\nFrom this we can see that ActiveX objects are calling specific CLSIDs. From this, two relatively known exploits can likely be identified, based on both payloads, and the CLSIDs used.\n\n\n\nCLSID\nTarget Component\nPatch\nAssociated Vulnerability\n\n\n1EFB6596-857C-11D1-B16A-00C0F0283628\nMSCOMCTL TabStrip control\nMS12-060\nCVE-2012-1856\n\n\nCDDBCC7C-BE18-4A58-9CBF-D62A012272CE\nOSF.DLL (memory corruption in ActiveX use cases)\nMS15-059\nCVE-2015-1770\n\n\n\nAs a result of MSVCR71 being loaded via Parvez Anwar\u2019s method, it would appear that exploitation of CVE-2012-1856 could be re-invigorated by the use of ROP gadgets (now with non-randomized gadget addresses) located within its address space, making a VirtualProtect() call and stage 2 shellcode trivial. At this time it is unclear whether the original patch was designed to correct memory mismanagement of the affected TabStrip control, or if the components to load it were simply changed to operate with ASLR enabled to limit the vectors of introducing arbitrary code. At any rate, the ActiveX binary from OLE object 0x000000E6 has the following approximate structure:\n[Word Document Header]\n[HeapSpray of address 0x7c342404 (a RET instruction)]\n[ROP Chain of gadgets inside the MSVCR71 address space]\n[NOP Sled]\n[Stage 1 shellcode]\n\n\nFigure 1: We can see the end of the RET heap spray leading into a ROP chain and stage 1 shellcode\nKeeping in mind that (of course) the addresses are backwards due to little endian byte ordering, we can observe the following ROP chain after the ret gadget 0x7c342404, and prior to actual shellcode:\n7C3651EB\n7C3651EB\n7C372B02\n00000201\n7C344364\n00000040\n7C35A128\n7C342E9E\n7C34A40F\n7C3650DC\n7C3415A3\n7C347F97\n7C37A151\n7C378C4D\n7C345C30\n\nIn the OLE object 0x0002802C, there are more XML files containing the CVE-2012-1856 CLSID, however 2 files (activeX39.xml and activeX40.xml), contain the CLSID for CVE-2015-1770, which does in fact, cause OSF.DLL to load. Examining the ActiveX binary reveals a not-too-dissimilar structure to the first one:\n[Word Document Header]\n[HeapSpray of 0xCC byte]\n[series of 0x08 and 0x41 marker bytes]\n[stage 1 shellcode]\n\n\nFigure 2: We can observe the end of the 0xCC heap spray, the 0x08 and 0x41 memory markers as well as stage 1 code here.\nStage 2 shellcode in both cases is decoded and inserted from memory (rather than statically included in a file) and triggers a download of the uWarrior RAT itself. When executing this payload on systems with 64-bit version of Office, things may not quite go as the author intended. For example, on 64-bit systems, msvcr71.dll is part of the SysWOW64 libraries and not available in the Office15 native add-ons folder. Instead, MSVCR100.dll is loaded for those calls and the 64-bit edition of otkloadr.WRAssembly.1 is loaded as well. Furthermore this breaks many of the hard-coded addresses and ROP gadgets, landing at the following error:\n(904.bec): Access violation - code c0000005 (first chance)\nFirst chance exceptions are reported before any exception handling.\nThis exception may be expected and handled.\n*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\\Program Files\\Microsoft Office\\Office15\\wwlib.dll -\nwwlib!FMain+0x508b:\n000007fe`ee1468c7 8b18            mov     ebx,dword ptr [rax] ds:00000000`7c38bd50=????????\n\nThe address 0x7c38bd50 is a reference back into the aforementioned, msvcr71 library which is not in memory.\n\nIt is important to note that analysis of the exploitation itself is on-going and many researchers around the industry have suggested differing vulnerabilities as a root cause; however, conclusive evidence is lacking and the combination of methods and affected code is both new and complex.\nuWarrior Malware Analysis\nAfter successful exploitation, a payload is saved to the system at \u201c%AppData%\\Roaming\\TEST\\WindowsUpdate.exe\u201d and executed. The WindowsUpdate.exe application contains several artifacts that suggest that the malware author calls this Trojan uWarrior, one of which is the following debugging symbol path found in the sample:\n\nD:\\1-Visual Basic Proggetti\\UtilityWarrior\\UtilityWarrior\\obj\\Debug\\UtilityWarrior.pdb\n\nuWarrior begins by copying itself to a second location, which in this case was \u201c%AppData%\\Local\\svchost.exe\u201d and saves the path to this copied executable within the following file:\n\n%AppData%\\Roaming\\warriors.dat\n\nDuring execution, uWarrior logs its activities to a file located at \u201c%AppData%\\Local\\Temp\\bootloader.dec\u201d, however, our team is aware of other uWarrior samples saving their logs to \u201cC:\\bootloader.dec\u201d instead. We found that uWarrior has a configuration that follows the structure:\nstruct settings {\n     string Host;\n     short Port;\n     string ID;\n     bool Startup;\n     bool BlueScreenOnTermination;\n     string GUID;\n     string StartupPath;\n     bool SaveExePath;\n};\nThe settings structure found in this sample of uWarrior has the domain \u201clogin.collegefan.org\u201d set as the C2 host, and 2020 for the communications port. When communicating with the C2 server, the uWarrior Trojan uses AES to encrypt the data sent to the C2, using the key and initialization vector (IV) seen in Figure 3.\n\nuWarrior will receive commands from the C2 using this communication channel and will process the commands using a command handler.\n\n\nFigure 3 AES Encryption Key and IV used by uWarrior\nThe C2 will send numerical values that the uWarrior Trojan will parse to determine which command to carry out. Fortunately, the author of uWarrior included an enumeration (a data type in programming that maps a constant value to a defined name), which applies a human-readable string to each command's numerical value. This enumeration makes analyzing the commands available within the malware much easier. The functionality within many of the commands are handled by a helper DLL that the uWarrior will extract from its resource section named Windows_Update.UtilityWarrior.dll and load.\n\nUnit 42 analyzed the command handler to determine uWarrior\u2019s capabilities and found the following commands available:\n\n\n\nEnumValue\nCommand\nDescription\n\n\n10\nHandshake\nInstructs the Trojan to use a new key and initialization vector (IV) to encrypt network communications. The Trojan will then creates a thread that it will use in an attempt to establish communications using the new key.\n\n\n14\nShutdownClient\nExits the current instance of the Trojan.\n\n\n15\nRestartClient\nRestarts the Trojan and exits the current instance of the Trojan.\n\n\n16\nUninstallClient\nCreates a batch script with a temporary filename that deletes the Trojan and then the batch script. The script contains the following::Repeat:DEL \\\"&lt;executable path&gt;\\\"if exists \\\"&lt;executable path&gt;\\\" goto RepeatDEL \\\"&lt;batch script path&gt;\\\"\"One interesting thing to note is that there is a flag called \"BlueScreenOnTermination\", which if set in the configuration will set the Trojan's process to be system critical by calling the SetProcessIsCritical function. After the batch script deletes the files, the Trojan exits itself and causes a Windows error due to the fact the process was system critical.\n\n\n17\nRestartPC\nRestarts the system using the command line \"shutdown.exe -r -f\".\n\n\n18\nClosePC\nShuts down the system using the command line \"shutdown.exe -p -f\".\n\n\n19\nGetSoftware\nHandled by the helper DLL, which opens a specified registry key in the HKLM hive and enumerates its sub keys looking for \"DisplayName\" and gathers all software packages that do not have \"Hotfix\", \"Security Update\" or \"Update for\" within their \"DisplayName\". It responds to the C2 with a list of software packages delimited by the string \"|A|\".\n\n\n21\nunistallSoftware\nHandled by the helper DLL, which enumerates the \"Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\" registry key looking for the software package provided with the command and will uninstall it. It responds to the C2 with \"Unistall is running\" if successful or the exception if it fails.\n\n\n22\nGetDriver\nHandled by the helper DLL, which enumerates the mounted storage devices, their total size and the available space left on them. The command concatenates this information into the following structure and sends it to the C2: \"&lt;drive number&gt;|H|&lt;drive's total size&gt;\/&lt;drive's available space&gt;|Q|\". For systems with multiple mounted storage volumes, the command will concatenate the additional data following the same structure above.\n\n\n23\nGetFiles\nHandled by the helper DLL, which lists the contents of a directory of a provided path. Each folder in the directory are added to a string, which is sent to the C2 in the a format of \"&lt;folder name&gt;|G|Floader|G||G|&lt;provided path&gt;|H|\". Each file in the directory are added to a string that is sent to the C2 in the format of \"&lt;filename&gt;|G|&lt;file extension&gt;|G|&lt;file size&gt;|G|&lt;provided path&gt;|H|\".\n\n\n24\nSearchFolder\nSearches the filesystem for a specified folder. If it finds the folder, the Trojan will enumerate its contents using the same code as the \"GetFiles\" command.\n\n\n25\nRunFile\nStarts a process using a specified file. Does not respond to the C2 with any messages.\n\n\n26\nDeleteFile\nDeletes a specified file. If the command has \"E\" switch provided, it will delete a specified directory and all of its contents.\n\n\n27\nRenameFile\nRenames a specified file. If the command has \"A\" switch provided, it will rename a specified directory.\n\n\n28\nDownloadTCP\nReads a specified file and sends it to the C2 server.\n\n\n29\nUploadTCP\nWrites data provided by the C2 to a specified file.\n\n\n30\nDownloadURL\nDownloads a file from a specified URL. The C2 will provide the URL to download from in the format \"&lt;domain or IP&gt;|A|&lt;filename&gt;|A|&lt;file extension&gt;|A|&lt;path\/URL&gt;\".\n\n\n31\nRefreshLog\nSends the contents of the log file at \"C:\\bootloader.dec\" to the C2 server.\n\n\n32\nClearLog\nDeletes the log file at \"C:\\bootloader.dec\" from the system.\n\n\n36\nMonitorCounts\nUses the GetSystemMetrics API function to determine how many monitors are connected to the system.\n\n\n37\nPcBounds\nSends the height and width of a specified monitor to the C2.\n\n\n38\nShortLinkFolder\nLists the contents of a special folder based on a value between 1 and 4: 1) Lists Desktop 2) Lists %TEMP% folder 3) Lists Cookies Folder 4) Lists My Documents folder\n\n\n\nSome of the values within the previously mentioned enumeration are not within the command handler. Unit 42 found only two of these specific values and found in the malware, specifically \"Pipe\" and \"Status\", which were used in network communications to designate the type of response the Trojan was sending to the C2. It does not appear that uWarrior uses the \u201cPlugin\u201d, \u201cErSoftware\u201d, \u201cRemoteDesktop\u201d, \u201cUnblockEverything\u201d, \u201cBlockEverything\u201d values from within the enumeration, suggesting that the malware author did not remove these values from the enumeration even though their functionality was removed from the Trojan.\nNo Honor Amongst Thieves\nUnit 42 researchers' examination of uWarrior has led to the discovery of suspected progenitor samples. These samples, identified as the for-sale ctOS RAT, contain similar configuration structures and share several functions with uWarrior samples. The ctOS RAT contains a significant amount of functionality compared to the uWarrior command set, suggesting that uWarrior could be a stripped down alternative.\n\nuWarrior's configuration contains all of the same fields as ctOS, as well as an additional field (bool_2 in GStruct2 stucture in Figure 4), used to toggle whether \"warrior.dat\" should be utilized to store the path on the file system to the executable. Samples of both RATs contain a GUID field (string_2 fields in Figure 4), \"TEST\", which is used to define the path where the executable will be dropped.\n\n\nFigure 4 Comparison of uWarrior (GStruct2) and ctOS (Struct4) Configurations\nIn addition to sharing similar configurations, it appears that the uWarrior author borrowed code from the ctOS RAT. uWarrior\u2019s helper DLL (used to handle several of uWarriors functionality) has two functions that directly overlap with functions from ctOS source code, specifically one that gets the size of a specified file and the second that enumerates the mounted storage volumes.\n\nStatic analysis of ctOS and uWarrior samples reveals Italian language strings. These Italian strings are part of PDB paths and are prevalent throughout .net manifest data. This lends additional strength to the linkage between ctOS and uWarrior, as the former's control panel demos are also in Italian.\n\nPalo Alto Networks WildFire identifies the exploit files and malware used in these attacks as malicious. Palo Alto Networks AutoFocus users can view the analysis related to these files using the uWarrior tag.\nIndicators\nSample Hashes\nWindowsUpdate.exe,5dce01ec5e1bc1b4f5012e0b4bf16532206284fc8c64cfb8dcf907f45caf98fc\n\nWindows_Update.UtilityWarrior.dll,f4aa83297844eb8297711e32554e41f677cce290732171583199a57fb7a0674b\n\nammendment.doc, a6dea088c9e2c9191e4c2fc4ece7b7b7bd3f034f444362d35c8765f6ec4bd279\n\nWUPOS_update.doc, 57a5d0da72655df9c5ca9137df7210b86845eeabae488537c70e36587274937c\nFile system indicators\n%AppData%\\Local\\Temp\\bootloader.dec\n\n%AppData%\\Roaming\\warriors.dat\nNetwork indicators\nlogin.collegefan.org\n\nlogin.loginto.me\n\n63.142.245.12\n\n23.249.225.140","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"","width":"","height":""},"author":[{"@type":"Person","name":"Brandon Levene"},{"@type":"Person","name":"Robert Falcone"},{"@type":"Person","name":"Tomer Bar"},{"@type":"Person","name":"Tom Keigher"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"10031","token":"7e15a0f8b3","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=10031' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Frtf-exploit-installs-italian-rat-uwarrior%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Frtf-exploit-installs-italian-rat-uwarrior%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-10031 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">RTF Exploit Installs Italian RAT: uWarrior</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-10031 entry-meta">
			
			
			<span class="post-views-count">12,186</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'10031','like')"><i class="ui ui-2"></i><span class="ml-5">1</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 9</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Frtf-exploit-installs-italian-rat-uwarrior%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Frtf-exploit-installs-italian-rat-uwarrior%2F+-+RTF+Exploit+Installs+Italian+RAT%3A+uWarrior" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Frtf-exploit-installs-italian-rat-uwarrior%2F&title=RTF+Exploit+Installs+Italian+RAT%3A+uWarrior&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/rtf-exploit-installs-italian-rat-uwarrior/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/brandon-levene/" title="Posts by Brandon Levene" class="author url fn" rel="author">Brandon Levene</a>, <a href="https://unit42.paloaltonetworks.com/author/robertfalcone/" title="Posts by Robert Falcone" class="author url fn" rel="author">Robert Falcone</a>, <a href="https://unit42.paloaltonetworks.com/author/tomer-bar/" title="Posts by Tomer Bar" class="author url fn" rel="author">Tomer Bar</a> and <a href="https://unit42.paloaltonetworks.com/author/tkeigher/" title="Posts by Tom Keigher" class="author url fn" rel="author">Tom Keigher</a>        </p>
        <p><time datetime="2015-08-24T12:02:57+00:00">August 24, 2015 at 3:02 PM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/cybersecurity-2/" rel="category tag">Cybersecurity</a>, <a href="https://unit42.paloaltonetworks.com/category/threat-prevention-2/" rel="category tag">Threat Prevention</a>, <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/autofocus/" rel="tag">AutoFocus</a>, <a href="https://unit42.paloaltonetworks.com/tag/remote-access-tool/" rel="tag">Remote Access Tool</a>, <a href="https://unit42.paloaltonetworks.com/tag/uwarrior/" rel="tag">uWarrior</a>, <a href="https://unit42.paloaltonetworks.com/tag/wildfire/" rel="tag">WildFire</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                    <p>Unit 42 researchers have observed a new Remote Access Tool (RAT) constructed by an unknown actor of Italian origin. This RAT, referred to as uWarrior because of embedded PDB strings, has been <a href="http://blog.ropchain.com/2015/08/16/analysis-of-exploit-targeting-office-2007-2013-ms15-022/" target="_blank">previously described</a> by an independent researcher who noted a potentially unknown exploit being used against Microsoft Office.<span id="more-10031"></span></p>
<p>Initial research into the exploit by Unit 42 indicates that this actor has opted to include multiple exploits. One is CVE-2012-1856, reinvigorated with a novel ROP chain to bypass ASLR and deliver the uWarrior payload. The other appears to be CVE-2015-1770. The malware itself is a fully featured RAT, which uses a compressed, (optionally) encrypted, raw TCP socket and binary message protocol for command and control communications.</p>
<p>During the course of our research, it became evident that this actor had not built uWarrior from scratch, but rather opted to borrow components from several off-the-shelf tools. Linkages between older RATs are explored later in this blog.</p>
<h2>RTF Exploitation and ASLR Bypass</h2>
<p>The weaponized RTF document used by this actor contains multiple OLE objects. In this instance, we see two different exploits, as well as two methods of bypassing ASLR exploit mitigations. The first method was <a href="http://www.greyhathacker.net/?p=770" target="_blank">published in 2014</a> by Parvez Anwar. The method he describes involves creating an embedded OLE object which contains a ProgID for “otkloadr.WRAssembly.1”. This causes MSVCR71.DLL to be loaded, a library which is not compiled with /DYNAMICBASE.</p>
<p>When using OLE to perform exploitation, ActiveX objects can be used to cite specific CLSID values. This is useful to an attacker as many of these CLSID values map to DLLs on the system. Attackers can deliberately use this to load any DLL they desire into the affected application so long as it maps to a valid CLSID.</p>
<p>This method was actually described at Black Hat USA 2015 in the talk: “<a href="https://www.blackhat.com/docs/us-15/materials/us-15-Li-Attacking-Interoperability-An-OLE-Edition.pdf" target="_blank">Attacking Interoperability: An OLE Edition</a>” by researchers Haifei Li and Bing Sun of Intel Security.</p>
<p>As a result of this method, it is <a href="https://www.blackhat.com/docs/us-15/materials/us-15-Li-Attacking-Interoperability-An-OLE-Edition.pdf" target="_blank">possible</a> for the attacker to force the loading of less secure libraries which were not compiled with the /DYNAMICBASE compiler flag (enables ASLR at compile time), or other libraries which further enable the corruption and manipulation of memory.</p>
<p>From the RTF document, we can use <a href="http://www.decalage.info/python/oletools" target="_blank">oletools</a> to extract each OLE object. Thus far, we have encountered two weaponized RTF documents.</p>
<p>Interestingly, both documents contained identical OLE objects:</p>
<table>
<tbody>
<tr>
<td width="216">7ff9ff29b79d0eb38813bfa0b0bb1c5b116d1f9e5468ae52674bb443468658d9</td>
<td width="216">object_00000020.bin</td>
</tr>
<tr>
<td width="216">7f29f2dc8b60c0e5a22575d9c76fd9c3d39604d1acf5cb4d938a63095c61a72e</td>
<td width="216">object_000000E6.bin</td>
</tr>
<tr>
<td width="216">fe80d59686806afe3dc48f73d54b577558a7c871da17d08d937c5d7b3564e07b</td>
<td width="216">object_000187A1.bin</td>
</tr>
<tr>
<td width="216">70ea7ef3bf9966c3297a4e78024e3083013558670d051c2ca3095e2588a576d8</td>
<td width="216">object_0002802C.bin</td>
</tr>
</tbody>
</table>
<p>Closer examination of each of the OLE objects reveals that two of them have compressed zip files embedded in them at an offset of 1577 bytes:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c01cef8a643113767" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
object_000000E6.bin:
[+] Start search on 49201 bytes (48.0 KB)
[+] File at 41 size=48128 (47.0 KB): Microsoft Office document
[+] File at 1577 size=46556 (45.5 KB): ZIP archive
[+] End of search -- offset=49201 (48.0 KB)

object_0002802C.bin:
[+] Start search on 50737 bytes (49.5 KB)
[+] File at 41 size=49664 (48.5 KB): Microsoft Office document
[+] File at 1577 size=47720 (46.6 KB): ZIP archive
[+] End of search -- offset=50737 (49.5 KB)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c01cef8a643113767-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef8a643113767-2">2</div><div class="crayon-num" data-line="crayon-5f694c01cef8a643113767-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef8a643113767-4">4</div><div class="crayon-num" data-line="crayon-5f694c01cef8a643113767-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef8a643113767-6">6</div><div class="crayon-num" data-line="crayon-5f694c01cef8a643113767-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef8a643113767-8">8</div><div class="crayon-num" data-line="crayon-5f694c01cef8a643113767-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef8a643113767-10">10</div><div class="crayon-num" data-line="crayon-5f694c01cef8a643113767-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c01cef8a643113767-1"><span class="crayon-v">object_000000E6</span><span class="crayon-sy">.</span><span class="crayon-v">bin</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef8a643113767-2"><span class="crayon-sy">[</span><span class="crayon-o">+</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">Start </span><span class="crayon-e">search </span><span class="crayon-i">on</span><span class="crayon-h"> </span><span class="crayon-cn">49201</span><span class="crayon-h"> </span><span class="crayon-e">bytes</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">48.0</span><span class="crayon-h"> </span><span class="crayon-v">KB</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c01cef8a643113767-3"><span class="crayon-sy">[</span><span class="crayon-o">+</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">File </span><span class="crayon-i">at</span><span class="crayon-h"> </span><span class="crayon-cn">41</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-o">=</span><span class="crayon-cn">48128</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">47.0</span><span class="crayon-h"> </span><span class="crayon-v">KB</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Microsoft </span><span class="crayon-e">Office </span><span class="crayon-i">document</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef8a643113767-4"><span class="crayon-sy">[</span><span class="crayon-o">+</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">File </span><span class="crayon-i">at</span><span class="crayon-h"> </span><span class="crayon-cn">1577</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-o">=</span><span class="crayon-cn">46556</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">45.5</span><span class="crayon-h"> </span><span class="crayon-v">KB</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">ZIP </span><span class="crayon-i">archive</span></div><div class="crayon-line" id="crayon-5f694c01cef8a643113767-5"><span class="crayon-sy">[</span><span class="crayon-o">+</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">End</span><span class="crayon-h"> </span><span class="crayon-e">of </span><span class="crayon-v">search</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-h"> </span><span class="crayon-v">offset</span><span class="crayon-o">=</span><span class="crayon-cn">49201</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">48.0</span><span class="crayon-h"> </span><span class="crayon-v">KB</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef8a643113767-6">&nbsp;</div><div class="crayon-line" id="crayon-5f694c01cef8a643113767-7"><span class="crayon-v">object_0002802C</span><span class="crayon-sy">.</span><span class="crayon-v">bin</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef8a643113767-8"><span class="crayon-sy">[</span><span class="crayon-o">+</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">Start </span><span class="crayon-e">search </span><span class="crayon-i">on</span><span class="crayon-h"> </span><span class="crayon-cn">50737</span><span class="crayon-h"> </span><span class="crayon-e">bytes</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">49.5</span><span class="crayon-h"> </span><span class="crayon-v">KB</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c01cef8a643113767-9"><span class="crayon-sy">[</span><span class="crayon-o">+</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">File </span><span class="crayon-i">at</span><span class="crayon-h"> </span><span class="crayon-cn">41</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-o">=</span><span class="crayon-cn">49664</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">48.5</span><span class="crayon-h"> </span><span class="crayon-v">KB</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Microsoft </span><span class="crayon-e">Office </span><span class="crayon-i">document</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef8a643113767-10"><span class="crayon-sy">[</span><span class="crayon-o">+</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">File </span><span class="crayon-i">at</span><span class="crayon-h"> </span><span class="crayon-cn">1577</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-o">=</span><span class="crayon-cn">47720</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">46.6</span><span class="crayon-h"> </span><span class="crayon-v">KB</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">ZIP </span><span class="crayon-i">archive</span></div><div class="crayon-line" id="crayon-5f694c01cef8a643113767-11"><span class="crayon-sy">[</span><span class="crayon-o">+</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">End</span><span class="crayon-h"> </span><span class="crayon-e">of </span><span class="crayon-v">search</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-h"> </span><span class="crayon-v">offset</span><span class="crayon-o">=</span><span class="crayon-cn">50737</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">49.5</span><span class="crayon-h"> </span><span class="crayon-v">KB</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>Once carved and unzipped, we can see a small directory structure. Within the word/activex directory, we can see ActiveX binaries, as well as XML documents associated with them. The XML files themselves are mostly identical; duplicates of only two particularly unique ones. The contents of these two files are as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c01cef94239701066" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
&lt;ax:ocx ax:classid="{1EFB6596-857C-11D1-B16A-00C0F0283628}" ax:license="9368265E-85FE-11d1-8BE3-0000F8754DA1" ax:persistence="persistStorage" r:id="rId1" xmlns:ax="http://schemas.microsoft.com/office/2006/activeX" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"/&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c01cef94239701066-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef94239701066-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c01cef94239701066-1"><span class="crayon-ta">&lt;?</span><span class="crayon-e">xml </span><span class="crayon-i">version</span><span class="crayon-o">=</span><span class="crayon-s">"1.0"</span><span class="crayon-h"> </span><span class="crayon-i">encoding</span><span class="crayon-o">=</span><span class="crayon-s">"UTF-8"</span><span class="crayon-h"> </span><span class="crayon-i">standalone</span><span class="crayon-o">=</span><span class="crayon-s">"no"</span><span class="crayon-ta">?&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef94239701066-2"><span class="crayon-o">&lt;</span><span class="crayon-v">ax</span><span class="crayon-o">:</span><span class="crayon-e">ocx </span><span class="crayon-v">ax</span><span class="crayon-o">:</span><span class="crayon-v">classid</span><span class="crayon-o">=</span><span class="crayon-s">"{1EFB6596-857C-11D1-B16A-00C0F0283628}"</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-o">:</span><span class="crayon-v">license</span><span class="crayon-o">=</span><span class="crayon-s">"9368265E-85FE-11d1-8BE3-0000F8754DA1"</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-o">:</span><span class="crayon-v">persistence</span><span class="crayon-o">=</span><span class="crayon-s">"persistStorage"</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-o">:</span><span class="crayon-v">id</span><span class="crayon-o">=</span><span class="crayon-s">"rId1"</span><span class="crayon-h"> </span><span class="crayon-v">xmlns</span><span class="crayon-o">:</span><span class="crayon-v">ax</span><span class="crayon-o">=</span><span class="crayon-s">"http://schemas.microsoft.com/office/2006/activeX"</span><span class="crayon-h"> </span><span class="crayon-v">xmlns</span><span class="crayon-o">:</span><span class="crayon-v">r</span><span class="crayon-o">=</span><span class="crayon-s">"http://schemas.openxmlformats.org/officeDocument/2006/relationships"</span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c01cef96371393493" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
&lt;ax:ocx ax:classid="{cddbcc7c-be18-4a58-9cbf-d62a012272ce}" ax:license="9368265E-85FE-11d1-8BE3-0000F8754DA1" ax:persistence="persistStorage" r:id="rId1" xmlns:ax="http://schemas.microsoft.com/office/2006/activeX" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"/&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c01cef96371393493-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef96371393493-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c01cef96371393493-1"><span class="crayon-ta">&lt;?</span><span class="crayon-e">xml </span><span class="crayon-i">version</span><span class="crayon-o">=</span><span class="crayon-s">"1.0"</span><span class="crayon-h"> </span><span class="crayon-i">encoding</span><span class="crayon-o">=</span><span class="crayon-s">"UTF-8"</span><span class="crayon-h"> </span><span class="crayon-i">standalone</span><span class="crayon-o">=</span><span class="crayon-s">"no"</span><span class="crayon-ta">?&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef96371393493-2"><span class="crayon-o">&lt;</span><span class="crayon-v">ax</span><span class="crayon-o">:</span><span class="crayon-e">ocx </span><span class="crayon-v">ax</span><span class="crayon-o">:</span><span class="crayon-v">classid</span><span class="crayon-o">=</span><span class="crayon-s">"{cddbcc7c-be18-4a58-9cbf-d62a012272ce}"</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-o">:</span><span class="crayon-v">license</span><span class="crayon-o">=</span><span class="crayon-s">"9368265E-85FE-11d1-8BE3-0000F8754DA1"</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-o">:</span><span class="crayon-v">persistence</span><span class="crayon-o">=</span><span class="crayon-s">"persistStorage"</span><span class="crayon-h"> </span><span class="crayon-v">r</span><span class="crayon-o">:</span><span class="crayon-v">id</span><span class="crayon-o">=</span><span class="crayon-s">"rId1"</span><span class="crayon-h"> </span><span class="crayon-v">xmlns</span><span class="crayon-o">:</span><span class="crayon-v">ax</span><span class="crayon-o">=</span><span class="crayon-s">"http://schemas.microsoft.com/office/2006/activeX"</span><span class="crayon-h"> </span><span class="crayon-v">xmlns</span><span class="crayon-o">:</span><span class="crayon-v">r</span><span class="crayon-o">=</span><span class="crayon-s">"http://schemas.openxmlformats.org/officeDocument/2006/relationships"</span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>From this we can see that ActiveX objects are calling specific CLSIDs. From this, two relatively known exploits can likely be identified, based on both payloads, and the CLSIDs used.</p>
<table style="height: 178px;" width="571">
<tbody>
<tr>
<td width="140"><strong>CLSID</strong></td>
<td width="126"><strong>Target Component</strong></td>
<td width="88"><strong>Patch</strong></td>
<td width="88"><strong>Associated Vulnerability</strong></td>
</tr>
<tr>
<td width="140">1EFB6596-857C-11D1-B16A-00C0F0283628</td>
<td width="126">MSCOMCTL TabStrip control</td>
<td width="88">MS12-060</td>
<td width="88">CVE-2012-1856</td>
</tr>
<tr>
<td width="140">CDDBCC7C-BE18-4A58-9CBF-D62A012272CE</td>
<td width="126">OSF.DLL (memory corruption in ActiveX use cases)</td>
<td width="88">MS15-059</td>
<td width="88">CVE-2015-1770</td>
</tr>
</tbody>
</table>
<p>As a result of MSVCR71 being loaded via Parvez Anwar’s method, it would appear that exploitation of CVE-2012-1856 could be re-invigorated by the use of ROP gadgets (now with non-randomized gadget addresses) located within its address space, making a VirtualProtect() call and stage 2 shellcode trivial. At this time it is unclear whether the original patch was designed to correct memory mismanagement of the affected TabStrip control, or if the components to load it were simply changed to operate with ASLR enabled to limit the vectors of introducing arbitrary code. At any rate, the ActiveX binary from OLE object 0x000000E6 has the following approximate structure:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c01cef97748304974" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
[Word Document Header]
[HeapSpray of address 0x7c342404 (a RET instruction)]
[ROP Chain of gadgets inside the MSVCR71 address space]
[NOP Sled]
[Stage 1 shellcode]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c01cef97748304974-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef97748304974-2">2</div><div class="crayon-num" data-line="crayon-5f694c01cef97748304974-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef97748304974-4">4</div><div class="crayon-num" data-line="crayon-5f694c01cef97748304974-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c01cef97748304974-1"><span class="crayon-sy">[</span><span class="crayon-t">Word</span><span class="crayon-h"> </span><span class="crayon-e">Document </span><span class="crayon-v">Header</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef97748304974-2"><span class="crayon-sy">[</span><span class="crayon-e">HeapSpray </span><span class="crayon-e">of </span><span class="crayon-i">address</span><span class="crayon-h"> </span><span class="crayon-cn">0x7c342404</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-e">RET </span><span class="crayon-v">instruction</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694c01cef97748304974-3"><span class="crayon-sy">[</span><span class="crayon-e">ROP </span><span class="crayon-e">Chain </span><span class="crayon-e">of </span><span class="crayon-e">gadgets </span><span class="crayon-e">inside </span><span class="crayon-e">the </span><span class="crayon-e">MSVCR71 </span><span class="crayon-e">address </span><span class="crayon-v">space</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef97748304974-4"><span class="crayon-sy">[</span><span class="crayon-e">NOP </span><span class="crayon-v">Sled</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694c01cef97748304974-5"><span class="crayon-sy">[</span><span class="crayon-i">Stage</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-v">shellcode</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/08/uwarriorblogpic1.jpg" rel="wpdevart_lightbox"><img class="aligncenter  wp-image-10033" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/08/uwarriorblogpic1.jpg" alt="uwarriorblogpic1" width="560" height="401" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/08/uwarriorblogpic1.jpg 432w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/08/uwarriorblogpic1-300x215.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/08/uwarriorblogpic1-370x265.jpg 370w" sizes="(max-width: 560px) 100vw, 560px" /></a></p>
<p style="text-align: center;">Figure 1: We can see the end of the RET heap spray leading into a ROP chain and stage 1 shellcode</p>
<p>Keeping in mind that (of course) the addresses are backwards due to little endian byte ordering, we can observe the following ROP chain after the ret gadget 0x7c342404, and prior to actual shellcode:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c01cef99379645276" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
7C3651EB
7C3651EB
7C372B02
00000201
7C344364
00000040
7C35A128
7C342E9E
7C34A40F
7C3650DC
7C3415A3
7C347F97
7C37A151
7C378C4D
7C345C30</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c01cef99379645276-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef99379645276-2">2</div><div class="crayon-num" data-line="crayon-5f694c01cef99379645276-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef99379645276-4">4</div><div class="crayon-num" data-line="crayon-5f694c01cef99379645276-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef99379645276-6">6</div><div class="crayon-num" data-line="crayon-5f694c01cef99379645276-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef99379645276-8">8</div><div class="crayon-num" data-line="crayon-5f694c01cef99379645276-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef99379645276-10">10</div><div class="crayon-num" data-line="crayon-5f694c01cef99379645276-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef99379645276-12">12</div><div class="crayon-num" data-line="crayon-5f694c01cef99379645276-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef99379645276-14">14</div><div class="crayon-num" data-line="crayon-5f694c01cef99379645276-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c01cef99379645276-1"><span class="crayon-cn">7C3651EB</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef99379645276-2"><span class="crayon-cn">7C3651EB</span></div><div class="crayon-line" id="crayon-5f694c01cef99379645276-3"><span class="crayon-cn">7C372B02</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef99379645276-4"><span class="crayon-cn">00000201</span></div><div class="crayon-line" id="crayon-5f694c01cef99379645276-5"><span class="crayon-cn">7C344364</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef99379645276-6"><span class="crayon-cn">00000040</span></div><div class="crayon-line" id="crayon-5f694c01cef99379645276-7"><span class="crayon-cn">7C35A128</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef99379645276-8"><span class="crayon-cn">7C342E9E</span></div><div class="crayon-line" id="crayon-5f694c01cef99379645276-9"><span class="crayon-cn">7C34A40F</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef99379645276-10"><span class="crayon-cn">7C3650DC</span></div><div class="crayon-line" id="crayon-5f694c01cef99379645276-11"><span class="crayon-cn">7C3415A3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef99379645276-12"><span class="crayon-cn">7C347F97</span></div><div class="crayon-line" id="crayon-5f694c01cef99379645276-13"><span class="crayon-cn">7C37A151</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef99379645276-14"><span class="crayon-cn">7C378C4D</span></div><div class="crayon-line" id="crayon-5f694c01cef99379645276-15"><span class="crayon-cn">7C345C30</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>In the OLE object 0x0002802C, there are more XML files containing the CVE-2012-1856 CLSID, however 2 files (activeX39.xml and activeX40.xml), contain the CLSID for CVE-2015-1770, which does in fact, cause OSF.DLL to load. Examining the ActiveX binary reveals a not-too-dissimilar structure to the first one:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c01cef9b085580295" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
[Word Document Header]
[HeapSpray of 0xCC byte]
[series of 0x08 and 0x41 marker bytes]
[stage 1 shellcode]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c01cef9b085580295-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef9b085580295-2">2</div><div class="crayon-num" data-line="crayon-5f694c01cef9b085580295-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef9b085580295-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c01cef9b085580295-1"><span class="crayon-sy">[</span><span class="crayon-t">Word</span><span class="crayon-h"> </span><span class="crayon-e">Document </span><span class="crayon-v">Header</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef9b085580295-2"><span class="crayon-sy">[</span><span class="crayon-e">HeapSpray </span><span class="crayon-i">of</span><span class="crayon-h"> </span><span class="crayon-cn">0xCC</span><span class="crayon-h"> </span><span class="crayon-t">byte</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694c01cef9b085580295-3"><span class="crayon-sy">[</span><span class="crayon-e">series </span><span class="crayon-i">of</span><span class="crayon-h"> </span><span class="crayon-cn">0x08</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-cn">0x41</span><span class="crayon-h"> </span><span class="crayon-e">marker </span><span class="crayon-v">bytes</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef9b085580295-4"><span class="crayon-sy">[</span><span class="crayon-i">stage</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-v">shellcode</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/08/uwarriorblogpic2.jpg" rel="wpdevart_lightbox"><img class="aligncenter  wp-image-10034" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/08/uwarriorblogpic2.jpg" alt="uwarriorblogpic2" width="555" height="240" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/08/uwarriorblogpic2.jpg 432w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/08/uwarriorblogpic2-300x130.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/08/uwarriorblogpic2-370x160.jpg 370w" sizes="(max-width: 555px) 100vw, 555px" /></a></p>
<p style="text-align: center;">Figure 2: We can observe the end of the 0xCC heap spray, the 0x08 and 0x41 memory markers as well as stage 1 code here.</p>
<p>Stage 2 shellcode in both cases is decoded and inserted from memory (rather than statically included in a file) and triggers a download of the uWarrior RAT itself. When executing this payload on systems with 64-bit version of Office, things may not quite go as the author intended. For example, on 64-bit systems, msvcr71.dll is part of the SysWOW64 libraries and not available in the Office15 native add-ons folder. Instead, MSVCR100.dll is loaded for those calls and the 64-bit edition of otkloadr.WRAssembly.1 is loaded as well. Furthermore this breaks many of the hard-coded addresses and ROP gadgets, landing at the following error:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c01cef9d684889042" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
(904.bec): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\Program Files\Microsoft Office\Office15\wwlib.dll -
wwlib!FMain+0x508b:
000007fe`ee1468c7 8b18            mov     ebx,dword ptr [rax] ds:00000000`7c38bd50=????????</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c01cef9d684889042-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef9d684889042-2">2</div><div class="crayon-num" data-line="crayon-5f694c01cef9d684889042-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef9d684889042-4">4</div><div class="crayon-num" data-line="crayon-5f694c01cef9d684889042-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef9d684889042-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c01cef9d684889042-1"><span class="crayon-sy">(</span><span class="crayon-cn">904.bec</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Access </span><span class="crayon-v">violation</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">code </span><span class="crayon-e">c0000005</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">first </span><span class="crayon-v">chance</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef9d684889042-2"><span class="crayon-e">First </span><span class="crayon-e">chance </span><span class="crayon-e">exceptions </span><span class="crayon-e">are </span><span class="crayon-e">reported </span><span class="crayon-e">before </span><span class="crayon-e">any </span><span class="crayon-e">exception </span><span class="crayon-v">handling</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f694c01cef9d684889042-3"><span class="crayon-r">This</span><span class="crayon-h"> </span><span class="crayon-e">exception </span><span class="crayon-e">may </span><span class="crayon-e">be </span><span class="crayon-e">expected </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">handled</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef9d684889042-4"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">ERROR</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Symbol </span><span class="crayon-e">file </span><span class="crayon-e">could </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">be </span><span class="crayon-v">found</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">Defaulted </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">export </span><span class="crayon-e">symbols </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">C</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-e">Program </span><span class="crayon-v">Files</span><span class="crayon-sy">\</span><span class="crayon-e">Microsoft </span><span class="crayon-v">Office</span><span class="crayon-sy">\</span><span class="crayon-v">Office15</span><span class="crayon-sy">\</span><span class="crayon-v">wwlib</span><span class="crayon-sy">.</span><span class="crayon-v">dll</span><span class="crayon-h"> </span><span class="crayon-o">-</span></div><div class="crayon-line" id="crayon-5f694c01cef9d684889042-5"><span class="crayon-v">wwlib</span><span class="crayon-o">!</span><span class="crayon-v">FMain</span><span class="crayon-o">+</span><span class="crayon-cn">0x508b</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef9d684889042-6"><span class="crayon-cn">000007fe</span><span class="crayon-sy">`</span><span class="crayon-i">ee1468c7</span><span class="crayon-h"> </span><span class="crayon-cn">8b18</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">mov&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">ebx</span><span class="crayon-sy">,</span><span class="crayon-e">dword </span><span class="crayon-i">ptr</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">rax</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-v">ds</span><span class="crayon-o">:</span><span class="crayon-cn">00000000</span><span class="crayon-sy">`</span><span class="crayon-cn">7c38bd50</span><span class="crayon-o">=</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>The address 0x7c38bd50 is a reference back into the aforementioned, msvcr71 library which is not in memory.</p>
<p>It is important to note that analysis of the exploitation itself is on-going and many researchers around the industry have suggested differing vulnerabilities as a root cause; however, conclusive evidence is lacking and the combination of methods and affected code is both new and complex.</p>
<h2>uWarrior Malware Analysis</h2>
<p>After successful exploitation, a payload is saved to the system at “%AppData%\Roaming\TEST\WindowsUpdate.exe” and executed. The WindowsUpdate.exe application contains several artifacts that suggest that the malware author calls this Trojan uWarrior, one of which is the following debugging symbol path found in the sample:</p>
<p>D:\1-Visual Basic Proggetti\UtilityWarrior\UtilityWarrior\obj\Debug\UtilityWarrior.pdb</p>
<p>uWarrior begins by copying itself to a second location, which in this case was “%AppData%\Local\svchost.exe” and saves the path to this copied executable within the following file:</p>
<p>%AppData%\Roaming\warriors.dat</p>
<p>During execution, uWarrior logs its activities to a file located at “%AppData%\Local\Temp\bootloader.dec”, however, our team is aware of other uWarrior samples saving their logs to “C:\bootloader.dec” instead. We found that uWarrior has a configuration that follows the structure:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c01cef9f859186394" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
struct settings {
     string Host;
     short Port;
     string ID;
     bool Startup;
     bool BlueScreenOnTermination;
     string GUID;
     string StartupPath;
     bool SaveExePath;
};</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c01cef9f859186394-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef9f859186394-2">2</div><div class="crayon-num" data-line="crayon-5f694c01cef9f859186394-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef9f859186394-4">4</div><div class="crayon-num" data-line="crayon-5f694c01cef9f859186394-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef9f859186394-6">6</div><div class="crayon-num" data-line="crayon-5f694c01cef9f859186394-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef9f859186394-8">8</div><div class="crayon-num" data-line="crayon-5f694c01cef9f859186394-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c01cef9f859186394-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c01cef9f859186394-1"><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">settings</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef9f859186394-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">string</span><span class="crayon-h"> </span><span class="crayon-v">Host</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694c01cef9f859186394-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">short</span><span class="crayon-h"> </span><span class="crayon-v">Port</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef9f859186394-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">string</span><span class="crayon-h"> </span><span class="crayon-v">ID</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694c01cef9f859186394-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">bool</span><span class="crayon-h"> </span><span class="crayon-v">Startup</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef9f859186394-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">bool</span><span class="crayon-h"> </span><span class="crayon-v">BlueScreenOnTermination</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694c01cef9f859186394-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">string</span><span class="crayon-h"> </span><span class="crayon-v">GUID</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef9f859186394-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">string</span><span class="crayon-h"> </span><span class="crayon-v">StartupPath</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5f694c01cef9f859186394-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">bool</span><span class="crayon-h"> </span><span class="crayon-v">SaveExePath</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c01cef9f859186394-10"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>The settings structure found in this sample of uWarrior has the domain “login.collegefan.org” set as the C2 host, and 2020 for the communications port. When communicating with the C2 server, the uWarrior Trojan uses AES to encrypt the data sent to the C2, using the key and initialization vector (IV) seen in Figure 3.</p>
<p>uWarrior will receive commands from the C2 using this communication channel and will process the commands using a command handler.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/08/uwarriorblogpic3.jpg" rel="wpdevart_lightbox"><img class="aligncenter  wp-image-10035" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/08/uwarriorblogpic3.jpg" alt="uwarriorblogpic3" width="177" height="481" /></a></p>
<p style="text-align: center;">Figure 3 AES Encryption Key and IV used by uWarrior</p>
<p>The C2 will send numerical values that the uWarrior Trojan will parse to determine which command to carry out. Fortunately, the author of uWarrior included an enumeration (a data type in programming that maps a constant value to a defined name), which applies a human-readable string to each command&#8217;s numerical value. This enumeration makes analyzing the commands available within the malware much easier. The functionality within many of the commands are handled by a helper DLL that the uWarrior will extract from its resource section named Windows_Update.UtilityWarrior.dll and load.</p>
<p>Unit 42 analyzed the command handler to determine uWarrior’s capabilities and found the following commands available:</p>
<table style="height: 2462px;" width="174">
<tbody>
<tr>
<td width="39"><strong>EnumValue</strong></td>
<td width="103"><strong>Command</strong></td>
<td width="309"><strong>Description</strong></td>
</tr>
<tr>
<td width="39">10</td>
<td width="103">Handshake</td>
<td width="309">Instructs the Trojan to use a new key and initialization vector (IV) to encrypt network communications. The Trojan will then creates a thread that it will use in an attempt to establish communications using the new key.</td>
</tr>
<tr>
<td width="39">14</td>
<td width="103">ShutdownClient</td>
<td width="309">Exits the current instance of the Trojan.</td>
</tr>
<tr>
<td width="39">15</td>
<td width="103">RestartClient</td>
<td width="309">Restarts the Trojan and exits the current instance of the Trojan.</td>
</tr>
<tr>
<td width="39">16</td>
<td width="103">UninstallClient</td>
<td width="309">Creates a batch script with a temporary filename that deletes the Trojan and then the batch script. The script contains the following::Repeat:DEL \&#8221;&lt;executable path&gt;\&#8221;if exists \&#8221;&lt;executable path&gt;\&#8221; goto RepeatDEL \&#8221;&lt;batch script path&gt;\&#8221;&#8221;One interesting thing to note is that there is a flag called &#8220;BlueScreenOnTermination&#8221;, which if set in the configuration will set the Trojan&#8217;s process to be system critical by calling the SetProcessIsCritical function. After the batch script deletes the files, the Trojan exits itself and causes a Windows error due to the fact the process was system critical.</td>
</tr>
<tr>
<td width="39">17</td>
<td width="103">RestartPC</td>
<td width="309">Restarts the system using the command line &#8220;shutdown.exe -r -f&#8221;.</td>
</tr>
<tr>
<td width="39">18</td>
<td width="103">ClosePC</td>
<td width="309">Shuts down the system using the command line &#8220;shutdown.exe -p -f&#8221;.</td>
</tr>
<tr>
<td width="39">19</td>
<td width="103">GetSoftware</td>
<td width="309">Handled by the helper DLL, which opens a specified registry key in the HKLM hive and enumerates its sub keys looking for &#8220;DisplayName&#8221; and gathers all software packages that do not have &#8220;Hotfix&#8221;, &#8220;Security Update&#8221; or &#8220;Update for&#8221; within their &#8220;DisplayName&#8221;. It responds to the C2 with a list of software packages delimited by the string &#8220;|A|&#8221;.</td>
</tr>
<tr>
<td width="39">21</td>
<td width="103">unistallSoftware</td>
<td width="309">Handled by the helper DLL, which enumerates the &#8220;Software\Microsoft\Windows\CurrentVersion\Uninstall&#8221; registry key looking for the software package provided with the command and will uninstall it. It responds to the C2 with &#8220;Unistall is running&#8221; if successful or the exception if it fails.</td>
</tr>
<tr>
<td width="39">22</td>
<td width="103">GetDriver</td>
<td width="309">Handled by the helper DLL, which enumerates the mounted storage devices, their total size and the available space left on them. The command concatenates this information into the following structure and sends it to the C2: &#8220;&lt;drive number&gt;|H|&lt;drive&#8217;s total size&gt;/&lt;drive&#8217;s available space&gt;|Q|&#8221;. For systems with multiple mounted storage volumes, the command will concatenate the additional data following the same structure above.</td>
</tr>
<tr>
<td width="39">23</td>
<td width="103">GetFiles</td>
<td width="309">Handled by the helper DLL, which lists the contents of a directory of a provided path. Each folder in the directory are added to a string, which is sent to the C2 in the a format of &#8220;&lt;folder name&gt;|G|Floader|G||G|&lt;provided path&gt;|H|&#8221;. Each file in the directory are added to a string that is sent to the C2 in the format of &#8220;&lt;filename&gt;|G|&lt;file extension&gt;|G|&lt;file size&gt;|G|&lt;provided path&gt;|H|&#8221;.</td>
</tr>
<tr>
<td width="39">24</td>
<td width="103">SearchFolder</td>
<td width="309">Searches the filesystem for a specified folder. If it finds the folder, the Trojan will enumerate its contents using the same code as the &#8220;GetFiles&#8221; command.</td>
</tr>
<tr>
<td width="39">25</td>
<td width="103">RunFile</td>
<td width="309">Starts a process using a specified file. Does not respond to the C2 with any messages.</td>
</tr>
<tr>
<td width="39">26</td>
<td width="103">DeleteFile</td>
<td width="309">Deletes a specified file. If the command has &#8220;E&#8221; switch provided, it will delete a specified directory and all of its contents.</td>
</tr>
<tr>
<td width="39">27</td>
<td width="103">RenameFile</td>
<td width="309">Renames a specified file. If the command has &#8220;A&#8221; switch provided, it will rename a specified directory.</td>
</tr>
<tr>
<td width="39">28</td>
<td width="103">DownloadTCP</td>
<td width="309">Reads a specified file and sends it to the C2 server.</td>
</tr>
<tr>
<td width="39">29</td>
<td width="103">UploadTCP</td>
<td width="309">Writes data provided by the C2 to a specified file.</td>
</tr>
<tr>
<td width="39">30</td>
<td width="103">DownloadURL</td>
<td width="309">Downloads a file from a specified URL. The C2 will provide the URL to download from in the format &#8220;&lt;domain or IP&gt;|A|&lt;filename&gt;|A|&lt;file extension&gt;|A|&lt;path/URL&gt;&#8221;.</td>
</tr>
<tr>
<td width="39">31</td>
<td width="103">RefreshLog</td>
<td width="309">Sends the contents of the log file at &#8220;C:\bootloader.dec&#8221; to the C2 server.</td>
</tr>
<tr>
<td width="39">32</td>
<td width="103">ClearLog</td>
<td width="309">Deletes the log file at &#8220;C:\bootloader.dec&#8221; from the system.</td>
</tr>
<tr>
<td width="39">36</td>
<td width="103">MonitorCounts</td>
<td width="309">Uses the GetSystemMetrics API function to determine how many monitors are connected to the system.</td>
</tr>
<tr>
<td width="39">37</td>
<td width="103">PcBounds</td>
<td width="309">Sends the height and width of a specified monitor to the C2.</td>
</tr>
<tr>
<td width="39">38</td>
<td width="103">ShortLinkFolder</td>
<td width="309">Lists the contents of a special folder based on a value between 1 and 4: 1) Lists Desktop 2) Lists %TEMP% folder 3) Lists Cookies Folder 4) Lists My Documents folder</td>
</tr>
</tbody>
</table>
<p>Some of the values within the previously mentioned enumeration are not within the command handler. Unit 42 found only two of these specific values and found in the malware, specifically &#8220;Pipe&#8221; and &#8220;Status&#8221;, which were used in network communications to designate the type of response the Trojan was sending to the C2. It does not appear that uWarrior uses the “Plugin”, “ErSoftware”, “RemoteDesktop”, “UnblockEverything”, “BlockEverything” values from within the enumeration, suggesting that the malware author did not remove these values from the enumeration even though their functionality was removed from the Trojan.</p>
<h2>No Honor Amongst Thieves</h2>
<p>Unit 42 researchers&#8217; examination of uWarrior has led to the discovery of suspected progenitor samples. These samples, identified as the for-sale ctOS RAT, contain similar configuration structures and share several functions with uWarrior samples. The ctOS RAT contains a significant amount of functionality compared to the uWarrior command set, suggesting that uWarrior could be a stripped down alternative.</p>
<p>uWarrior&#8217;s configuration contains all of the same fields as ctOS, as well as an additional field (bool_2 in GStruct2 stucture in Figure 4), used to toggle whether &#8220;warrior.dat&#8221; should be utilized to store the path on the file system to the executable. Samples of both RATs contain a GUID field (string_2 fields in Figure 4), &#8220;TEST&#8221;, which is used to define the path where the executable will be dropped.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/08/uwarriorblogpic4.jpg" rel="wpdevart_lightbox"><img class="aligncenter  wp-image-10036" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/08/uwarriorblogpic4.jpg" alt="uwarriorblogpic4" width="508" height="124" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/08/uwarriorblogpic4.jpg 410w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/08/uwarriorblogpic4-300x73.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/08/uwarriorblogpic4-370x90.jpg 370w" sizes="(max-width: 508px) 100vw, 508px" /></a></p>
<p style="text-align: center;">Figure 4 Comparison of uWarrior (GStruct2) and ctOS (Struct4) Configurations</p>
<p>In addition to sharing similar configurations, it appears that the uWarrior author borrowed code from the ctOS RAT. uWarrior’s helper DLL (used to handle several of uWarriors functionality) has two functions that directly overlap with functions from ctOS source code, specifically one that gets the size of a specified file and the second that enumerates the mounted storage volumes.</p>
<p>Static analysis of ctOS and uWarrior samples reveals Italian language strings. These Italian strings are part of PDB paths and are prevalent throughout .net manifest data. This lends additional strength to the linkage between ctOS and uWarrior, as the former&#8217;s control panel demos are also in Italian.</p>
<p>Palo Alto Networks <a href="https://www.paloaltonetworks.com/products/technologies/wildfire.html" target="_blank">WildFire</a> identifies the exploit files and malware used in these attacks as malicious. Palo Alto Networks <a href="https://www.paloaltonetworks.com/products/platforms/subscriptions/autofocus.html" target="_blank">AutoFocus</a> users can view the analysis related to these files using the <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.uWarrior" target="_blank">uWarrior</a> tag.</p>
<h2>Indicators</h2>
<h3>Sample Hashes</h3>
<p>WindowsUpdate.exe,5dce01ec5e1bc1b4f5012e0b4bf16532206284fc8c64cfb8dcf907f45caf98fc</p>
<p>Windows_Update.UtilityWarrior.dll,f4aa83297844eb8297711e32554e41f677cce290732171583199a57fb7a0674b</p>
<p>ammendment.doc, a6dea088c9e2c9191e4c2fc4ece7b7b7bd3f034f444362d35c8765f6ec4bd279</p>
<p>WUPOS_update.doc, 57a5d0da72655df9c5ca9137df7210b86845eeabae488537c70e36587274937c</p>
<h3>File system indicators</h3>
<p>%AppData%\Local\Temp\bootloader.dec</p>
<p>%AppData%\Roaming\warriors.dat</p>
<h3>Network indicators</h3>
<p>login.collegefan.org</p>
<p>login.loginto.me</p>
<p>63.142.245.12</p>
<p>23.249.225.140</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
