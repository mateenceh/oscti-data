
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>YiSpecter: First iOS Malware That Attacks Non-jailbroken Apple iOS Devices by Abusing Private APIs</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/yispecter-first-ios-malware-attacks-non-jailbroken-ios-devices-by-abusing-private-apis/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/yispecter-first-ios-malware-attacks-non-jailbroken-ios-devices-by-abusing-private-apis/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Unit 42 recently identified a new Apple iOS malware, YiSpecter, which attacks both jailbroken and non-jailbroken iOS devices."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/yispecter-first-ios-malware-attacks-non-jailbroken-ios-devices-by-abusing-private-apis/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="YiSpecter: First iOS Malware That Attacks Non-jailbroken Apple iOS Devices by Abusing Private APIs" />
<meta property="og:description" content="Unit 42 recently identified a new Apple iOS malware, YiSpecter, which attacks both jailbroken and non-jailbroken iOS devices." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/yispecter-first-ios-malware-attacks-non-jailbroken-ios-devices-by-abusing-private-apis/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="antivirus" />
<meta property="article:tag" content="app store" />
<meta property="article:tag" content="Apple" />
<meta property="article:tag" content="China" />
<meta property="article:tag" content="iOS" />
<meta property="article:tag" content="iPhones" />
<meta property="article:tag" content="Taiwan" />
<meta property="article:tag" content="XcodeGhost" />
<meta property="article:tag" content="YiSpecter" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2015-10-05T01:00:45+00:00" />
<meta property="article:modified_time" content="2020-07-03T00:01:01+00:00" />
<meta property="og:updated_time" content="2020-07-03T00:01:01+00:00" />
<meta property="og:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter1-500x888.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit 42 recently identified a new Apple iOS malware, YiSpecter, which attacks both jailbroken and non-jailbroken iOS devices." />
<meta name="twitter:title" content="YiSpecter: First iOS Malware That Attacks Non-jailbroken Apple iOS Devices by Abusing Private APIs" />
<meta name="twitter:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter1-500x888.png" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; YiSpecter: First iOS Malware That Attacks Non-jailbroken Apple iOS Devices by Abusing Private APIs Comments Feed" href="https://unit42.paloaltonetworks.com/yispecter-first-ios-malware-attacks-non-jailbroken-ios-devices-by-abusing-private-apis/feed/" />
<meta property="og:likes" content="5"/>
<meta property="og:readtime" content="22"/>
<meta property="og:views" content="51,844"/>
<meta property="og:date_created" content="October 4, 2015 at 6:00 PM"/>
<meta property="og:post_length" content="6270"/>
<meta property="og:category" content="Malware"/>
<meta property="og:category" content="Threat Prevention"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/malware-2/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-prevention-2/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Claud Xiao"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/claud-xiao/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"YiSpecter: First iOS Malware That Attacks Non-jailbroken Apple iOS Devices by Abusing Private APIs","name":"YiSpecter: First iOS Malware That Attacks Non-jailbroken Apple iOS Devices by Abusing Private APIs","description":"This post is also available in: \u65e5\u672c\u8a9e (Japanese)Summary We recently identified a new Apple iOS malware and named it YiSpecter. YiSpecter is different from previously seen iOS malware in that it attacks both jailbroken and non-jailbroken iOS devices through unique and harmful malicious behaviors. Specifically, it\u2019s the first malware we\u2019ve seen in the wild that...","url":"https:\/\/unit42.paloaltonetworks.com\/yispecter-first-ios-malware-attacks-non-jailbroken-ios-devices-by-abusing-private-apis\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/yispecter-first-ios-malware-attacks-non-jailbroken-ios-devices-by-abusing-private-apis\/","datePublished":"October 4, 2015","articleBody":"Summary\r\nWe recently identified a new Apple iOS malware and named it YiSpecter. YiSpecter is different from previously seen iOS malware in that it attacks both jailbroken and non-jailbroken iOS devices through unique and harmful malicious behaviors. Specifically, it\u2019s the first malware we\u2019ve seen in the wild that abuses private APIs in the iOS system to implement malicious functionalities.\r\n\r\nSo far, the malware primarily affects iOS users in mainland China and Taiwan. It spreads via unusual means, including the hijacking of traffic from nationwide ISPs, an SNS worm on Windows, and an offline app installation and community promotion. Many victims have discussed YiSpecter infections of their jailbroken and non-jailbroken iPhones in online forums and have reported the activity to Apple. The malware has been in the wild for over 10 months, but out of 57 security vendors in VirusTotal, only one is detecting the malware at the time of this writing.\r\n\r\nYiSpecter consists of four different components that are signed with enterprise certificates. By abusing private APIs, these components download and install each other from a command and control (C2) server. Three of the malicious components use tricks to hide their icons from iOS\u2019s SpringBoard, which prevents the user from finding and deleting them. The components also use the same name and logos of system apps to trick iOS power users.\r\n\r\nOn infected iOS devices, YiSpecter can download, install and launch arbitrary iOS apps, replace existing apps with those it downloads, hijack other apps\u2019 execution to display advertisements, change Safari\u2019s default search engine, bookmarks and opened pages, and upload device information to the C2 server. According to victims\u2019 reports, all these behaviors have been exhibited in YiSpecter attacks in the past few months. Some other characteristics about this malware include:\r\n\r\n \tWhether an iPhone is jailbroken or not, the malware can be successfully downloaded and installed\r\n \tEven if you manually delete the malware, it will automatically re-appear\r\n \tUsing third-party tools you can find some strange additional \u201csystem apps\u201d on infected phones\r\n \tOn infected phones, in some cases when the user opens a normal app, a full screen advertisement will show\r\n\r\nYiSpecter is the latest in a line of significant malware families to target iOS devices. Previously, the malware WireLurker demonstrated the ability to infected non-jailbroken iOS devices by abusing enterprise certificates, and academic researchers have discussed how private APIs can be used to implement sensitive functionalities in iOS. However, YiSpecter is the first real world iOS malware that combines these two attack techniques and causes harm to a wider range of users. It pushes the line barrier of iOS security back another step.\r\n\r\nMoreover, recent research shows that over 100 apps in the App Store have abused private APIs and bypassed Apple\u2019s strict code review. What that means is the attacking technique of abusing private APIs can also be used separately and can affect all normal iOS users who only download apps from the App Store.\r\n\r\nPalo Alto Networks has released IPS and DNS signatures to block YiSpecter\u2019s malicious traffic. This blog also contains suggestions for how other users can manually remove YiSpecter and avoid potential similar attacks in the future. Apple has also been notified.\r\nBackground\r\nOn February 7, 2015, Qihoo 360 and Cheetah Mobile, two security companies in China, posted analysis reports separately about a Windows worm named \u201cLingdun(\u7075\u987f)\u201d. The Lingdun worm hijacked victims\u2019 QQ sessions (a popular IM program produced by Tencent) and sent malicious links to their QQ contacts. According to those reports, if a user clicked the malicious links using Android or iOS devices, an Android Adware or an iOS Adware would be installed. Qihoo 360 and Cheetah Mobile found the installed apps\u2019 main behavior is to prompt other mobile apps and classify them as Android and iOS variants of the Lingdun worm.\r\n\r\n\r\nFigure 1.\u00a0Access Lingdun's webpage with an iPhone will infect \u00a0the device with YiSpecter\r\nAfter further investigation, however, we think their analysis is incomplete and has led to an incorrect conclusion. The iOS app spread by Lingdun and the malicious components it installs have different developers, different Command and Control (C2) servers, different purposes, and different code signing certificates. Therefore, we don\u2019t believe them to be variants of the Lingdun worm but instead separate malware using the Lingdun worm to spread. Additionally, we found these iOS apps have many more malicious functions than previous disclosed. Hence we do not refer to this malware family as Lingdun and have given it the new name YiSpecter.\r\n\r\nQihoo 360 and Cheetah Mobile didn\u2019t share samples of YiSpecter with the security community nor did they disclose file hash values we could use to identify their samples. As a result, until now, no other security vendor has detected YiSpecter as malware.\r\n\r\nIn the course of our investigation, we found 23 samples of YiSpecter were submitted to VirusTotal from different countries between November 2014 and August 2015. Except for Qihoo, the 56 antivirus engines included in VirusTotal didn\u2019t detect these files (as shown in Figure 2). \u00a0Qihoo\u2019s detection result uses the meaningless name \u201cvirus.ios.hidden\u201d. It is also worth noting that all of these samples belong to YiSpecter\u2019s main apps, and its three additional malicious components were not uploaded to VirusTotal until we published this report. All of these samples are listed at the end of this report.\r\n\r\n\r\nFigure 2.\u00a0YiSpecter is not detected by nearly all AntiVirus programs\r\n\r\nUncommon Spreading Methods\r\nYiSpecter began to spread in the wild in November 2014, if not earlier. The main iOS apps of this malware have user interface and functionality that enable the watching of free porn videos online, and were advertised as \u201cprivate version\u201d or \u201cversion 5.0\u201d of a famous media player \u201cQVOD\u201d. QVOD was developed by Kuaibo(\u5feb\u64ad) and became popular in China by users who share porn videos. Kuaibo was investigated by a local police department in April 2014 and at the same time their online video playing service was terminated. After that event, the attackers behind YiSpecter began to claim their app as an alternative QVOD to attract users into installing their software.\r\n\r\nSo far we have identified four different mechanisms YiSpecter uses to infect phones.\r\nInternet Traffic Hijacking\r\nIn the past 6 years, many Chinese media organizations (including state television) have reported that local ISPs in some provinces have supported DNS hijacking and Internet traffic hijacking attacks. ISPs hijacked the traffic to display advertisements to their users. For example, when Internet users use their computers or mobile phones to browse a website, the ISP will inject JavaScript code or HTML content into the session, which results in advertisements being displayed in the returned webpage. Last year, we also observed that some ISPs replaced app download URLs with other apps. For example, if an URL ends with \u201c.apk\u201d (i.e. downloading an Android app), it will be redirected to different URL, downloading a \u201cpromoted\u201d app onto the victims\u2019 Android phones. YiSpecter, as far as we know, is the first malware that has been spread by ISPs hijacking Internet traffic.\r\n\r\nMany users based in mainland China and Taiwan have discussed their infections by YiSpecter online (we will introduce these discussions in next section.) From their discussions and reports, we found that more than half of the infections came from pop-up dialogs displayed when browsing famous news websites.\r\n\r\nFor example, Figure 3 shows a screenshot posted to Apple\u2019s official support community. It shows that when the author was browsing ITHome.com, an abnormal pop-up dialog asked him to install a \u201cQVOD Private Version\u201d player to \u201cwatch special movies\u201d.\r\n\r\n\r\nFigure 3.\u00a0Ads and pop-up dialog were injected into normal Internet traffic\r\nBased on the user\u2019s discussions, we found the problem only occurred when they were using WiFi networks in their homes; mobile networks and office networks didn\u2019t appear to be affected. Some non-jailbroken iPhone users tried to clear cookies, reset iOS, change their iCloud accounts, and block pop-ups in Safari, but these operations didn\u2019t resolve the problem. However, if they used a third party mobile browser with built-in proxy functionality to access the same webpage, the advertisements disappeared. One user even called his ISP\u2019s service phone number to complain and the problem was resolved \u2013 these advertisements never appeared again. Based on this information, we believe that ISP\u2019s traffic hijacking was used to spread the malware in these cases, and not a malicious third party.\r\nSNS Worm\r\nAccording to analysis reports by Qihoo 360 and Cheetah Mobile, YiSpecter was also spread by the Lingdun worm.\r\n\r\nLingdun uses fake VeriSign and Symantec certificates to bypass malware detection systems. Its primary goal is to download and to install additional Windows software onto a PC. Most of this additional software is benign but at least one installation was malicious. The malware fetches the current user\u2019s QQ authorization token by accessing Tencent\u2019s unified login interface, then acquires a key to access all QQ services. Specifically, it will access the QQ Discussion Group\u2019s file sharing interface to upload malicious HTML files. These HTML files have names including pornographic and sexually suggestive words and will be shared with all other QQ users in the same discussion group.\r\n\r\n\r\nFigure 4.\u00a0A malicious webpage uploaded by Lingdun worm\r\nIf other QQ users access these malicious HTML files, the webpage will determine their devices\u2019 type by User-Agent value and distinguish Windows, Linux, Android, iOS (including iPhone and iPad), and Windows Phone. If the device is Android, the session will be redirected to download an Android Adware that prompts the user to install other porn apps. If the device is an iPhone or iPad, the session will be redirected to download the YiSpecter malware (Figure 1).\r\n\r\nWe listed hash values of all public available samples of Lingdun worm at the end of this article.\r\nOffline App Installation\r\nDuring our investigation, we found that the main YiSpecter apps were also published on multiple underground app distribution websites (Figure 5).\r\n\r\nIn an underground or \u201cgray\u201d mobile app ecosystem, mobile app developers (including malware authors) will post tasks of distributing their apps to these kinds of websites. Distributors will then accept these tasks, and install the apps on other users phones to earn a promotion fee from developers. For example, some third-party mobile phone retailers and maintenance suppliers will install apps on any mobile phone they can access; and mobile malware developers also install apps to earn income from devices they have infected.\r\n\r\nFigure 5.\u00a0YiSpecter apps were listed in underground app distribution websites\r\nFrom one of these websites (Figure 5), we see that many tasks to distribute YiSpecter were created in May 2015 and July 2015. The promotion fee for one installation is between 1.80 and 2.50 RMB (about US $0.30 to $0.40.) These tasks\u2019 descriptions also showed that the YiSpecter apps have a backend system to automatically track installations, thus distributors do not need to provide screenshots to prove their successful infections.\r\nCommunity Promotion\r\nWe also found that YiSpecter\u2019s author tried to directly promote their malicious apps on social networks and in public communities. For example, in a popular Chinese online forum, we found a user posted an article in January 2015 recommending the YiSpecter apps as good replacement for QVOD player. The user\u2019s account name is \u201cHaoYi Apple Helper(\u597d\u6613\u82f9\u679c\u52a9\u624b)\u201d, which is exactly the name of another product YiSpecter\u2019s author developed. We will describe YiSpecter\u2019s author in more detail in later sections.\r\n\r\n\r\nFigure 6.\u00a0YiSpecter's author recommends the app in public forum\r\n\r\nAttacks and Victims\r\nWhile analyzing YiSpecter\u2019s code, we searched for keywords related to its distribution channels and user interface in Google, and found many victims from mainland China and Taiwan discussing their infections in online forums and social networks including Zhihu, Douban, Weiphone, CocoaChina, Baidu Zhidao and Mobile01.\r\n\r\nFor example, one malicious component in YiSpecter shows an interface containing the words \u201cCydia is detecting and protecting\u201d in Chinese (Figure 25). Google showed about 2,580 results by searching for this Chinese sentence (Figure 7).\r\n\r\n\r\nFigure 7.\u00a0Search for YiSpecter's user interface keyword\r\nBased on these search results, we found some interesting facts about the malware:\r\n\r\n \tWhether an iPhone is jailbroken or not, the malware can be successfully downloaded and installed\r\n \tEven if you manually delete the malware, it will automatically re-appear (Figure 8)\r\n \tUsing third-party tools you can find some strange additional \u201csystem apps\u201d on infected phones\r\n \tOn infected phones, in some cases when the user opens a normal app, a full screen advertisement will show\r\n\r\nWe explain the details of how this happens in the malicious behaviors analysis section below.\r\n\r\n\r\nFigure 8.\u00a0Taiwanese victim writes that the malware reappeared aafter deleting\r\n\r\nYiSpecter Components and C2 Server\r\nYiSpecter consists of four different components: various main apps that are distributed through the means described earlier, and three different malicious apps that are installed by these main apps. All samples analyzed and discussed in previous research are the various main apps, while the three malicious apps have not been revealed before.\r\nMain Apps\r\nAs far as we know, there are at least two main apps distributed in the wild thus far:\r\n\r\n \tHYQvod (bundle id: weiying.Wvod)\r\n \tDaPian (bundle id: weiying.DaPian)\r\n\r\nBoth of them were spread by one or more of the multiple ways described earlier. They include the functionality of watching videos online by consuming credits and users can get credits by installing additional iOS apps it promotes (Figure 9). But most important, it will download and install another malicious app we have named NoIcon.\r\n\r\n\r\nFigure 9.\u00a0Main app ask users install other iOS apps to earn credits\r\n\r\nNoIcon\r\nNoIcon (bundle id: com.weiying.hiddenIconLaunch) is the main malicious component of YiSpecter. It takes the following actions on an infected device:\r\n\r\n \tConnect to the command and control server using HTTP\r\n \tUpload basic device information\r\n \tRetrieve and execute remote commands\r\n \tChange the iOS default Safari configuration\r\n \tSilently install two additional malicious apps \u201cADPage\u201d and \u201cNoIconUpdate\u201d\r\n \tMonitor other installed applications and hijack their launch routine to use \u201cADPage\u201d to display advertisements\r\n\r\nAdditionally, NoIcon can be remotely controlled to download and install arbitrary iOS apps from the C2 server or uninstall any existing apps in iOS system.\r\nADPage\r\nADPage (bundle id: \u00a0com.weiying.ad) is responsible for displaying advertisements when NoIcon hijacks the execution of legitimate apps.\r\nNoIconUpdate\r\nNoIconUpdate (bundle id: com.weiying.noiconupdate) regularly checks for other components\u2019 existence, connects with the C2 server and report its installation information. It also checks for updated versions of the malware and installs them.\r\nC2 Server\r\nYiSpecter uses \u201cbb800.com\u201d as its C2 server\u2019s domain name. In VirusTotal, there are 38 records of subdomains under this domain name. Sixteen of them have been used by Android Adware for years, e.g., ad.bb800[.]com and down.bb800[.]com. Another subdomain, ty1.bb800[.]com, was used by a Windows virus Almanahe.B.\r\n\r\nYiSpecter uses these subdomains:\r\n\r\n \tiosnoico.bb800[.]com: used to upload information, download configs and commands, download malicious components (Figure 10)\r\n \tqvod.bb800[.]com: used to download main app\r\n \tqvios.od.bb800[.]com: used to download main app\r\n \tdp.bb800[.]com: used to download promoted iOS apps\r\n \tiosads.cdn.bb800[.]com: \u00a0used to download promoted iOS apps and malicious components\r\n\r\nNote that the main C2 subdomain, iosnoico.bb800[.]com, is not observed in VirusTotal and also has no results in Google searches.\r\n\r\n\r\nFigure 10.\u00a0C2 server access logs in cache in a victim's iPhone\r\nIn some online articles, YiSpecter\u2019s author posted URLs like \u201chttps:\/\/qvod.bb800[.]com\/itms-services\/jx152\u201d for readers to download its main apps. When accessing these URLs from iPhone or iPad, victims are redirected to URLs like \u201citms-services:\/\/?action=download-manifest&amp;url=https:\/\/qvod.bb800.com\/assets\/upload\/3794.plist\u201d. Here \u201citms-services:\/\/\u201d is a protocol used by iOS for enterprise app distribution (Figure 11). Through crawling these URLs, we found at least 102 versions of main apps that developed from Nov 2014 to Sep 2015.\r\n\r\n\r\nFigure 11.\u00a0PLIST file hosted by C2 server for YiSpecter's installation\r\n\r\nMalicious Behavior Analysis\r\nIn this section, we\u2019re going to describe the malicious behaviors seen in each component of YiSpecter. The samples we analyzed are listed in the Appendix and will be shared with security community for research and detection.\r\nAbusing Enterprise Certificates\r\nYiSpecter\u2019s malicious apps were signed with three iOS enterprise certificates issued by Apple so that they can be installed as enterprise apps on non-jailbroken iOS devices via in-house distribution. The \u201cmain\u201d apps used a certificate for \u201cChangzhou Wangyi Information Technology Co., Ltd.\u201d and then later used a certificate from \u201cBaiwochuangxiang Technology Co., Ltd.\u201d The three malicious components all used the same certificate belonging to \u201cBeijing Yingmob Interaction Technology co, .ltd\u201d (Figure 12).\r\n\r\n\r\nFigure 12.\u00a0NoIcon used enterprise certificate for YingMob Interaction\r\nThrough this kind of distribution, an iOS app can bypass Apple\u2019s strict code review procedures and can invoke iOS private APIs to perform sensitive operations. There is one disadvantage to using this method for installation compared to the official App Store: when these apps are executed for the first time iOS displays a dialog to notify the user that the apps are from a specific developer (Figure 13). However, many iOS users may simple click \u201cContinue\u201d and not be aware of the security implications of their choice.\r\n\r\nNote that, in Apple\u2019s just-released iOS 9, enterprise certificate security has been improved. Users now must manually set a related provisioning profile as \u201ctrusted\u201d in Settings before they can install Enterprise provisioned apps.\r\n\r\n\r\nFigure 13.\u00a0iOS displays a dialog the first time a user opens an enterprise-signed app\r\nThe enterprise distribution program was designed for companies and organizations to distribute private iOS apps internally. WireLurker and YiSpecter\u2019s usages obviously violate the license and the spirit of this program.\r\nInstalling Malicious Apps\r\nEach time a user opens the main app of YiSpecter, it will invoke the[HYOwner checkI0S8_3AndJaikbreakOrNot] function. This function checks whether the current iOS system is older than version 8.3 and then determines if NoIcon is already installed. After that it checks whether the device is jailbroken or not by attempting to access a \u201ccydia:\/\/\u201d URL.\r\n\r\nIf the infected device has an iOS version less than 8.3, and NoIcon hasn\u2019t been installed yet, whether the device is jailbroken or not, YiSpecter will invoke the function [HYAppDelegate requestNoicon:] to download the NoIcon IPA installer and PLIST manifest files (Figure 14).\r\n\r\n\r\nFigure 14.\u00a0Main app downloads NoIcon for both jailbroken or non-jailbroken devices\r\nThe main app installs NoIcon in a unique way. The app opens an HTTP server and listens on port 8080 using [HYAppDelegate createLocalHTTP Server] (Figure 15). After downloading the NoIcon\u2019s IPA and PLIST files, it will use these files\u2019 local path to construct a local HTTP URL and displays an alert dialog with meaningless title and button text to the user (Figure 16). If the user clicks the button in the dialog, the HTTP server will handle the local HTTP URL and NoIcon will be installed using the itms-service protocol. With this mechanism YiSpecter uses the infected iOS device as an enterprise apps\u2019 distribution server.\r\n\r\n\r\nFigure 15.\u00a0Main app launched a local HTTP server\r\n\r\nFigure 16.\u00a0Main app construct NoIcon installation URL and prompt alert dialog\r\nAfter NoIcon is installed, it will install two more malicious apps: ADPage and NoIconUpdate. After downloading ADPage and NoIconUpdate\u2019s IPA installer files, NoIcon did not use an HTTP server like the main app, but used iOS\u2019s private APIs defined in private framework MobileInstallation to install them (Figure 17). More specifically, NoIcon invokes the MobileInstallationInstall methods implemented in the framework to install local IPA file. It also claimed the necessary private entitlement key \u201ccom.apple.private.mobileinstall.allowedSPI\u201d which should only be used by system apps in iOS (Figure 18). Again, through enterprise distribution, YiSpecter successfully bypassed the App Store\u2019s code review process that typically would prevent an app from using these private APIs.\r\n\r\nNote that NoIcon, ADPage, and NoIconUpdate are signed with same enterprise certificate. Since user has accepted the provisioning profile when installing NoIcon, ADPage and NoIconUpdate can be installed in this way without any user notification.\r\n\r\n\r\nFigure 17.\u00a0NoIcon downloads ADPage's IPA file and installs it\r\n\r\nFigure 18.\u00a0NoIcon has private entitlement for app installation\r\n\r\nUninstalling Existing Apps\r\nNoIcon has another functionality called \u201cfakeApps\u201d. If it receives this command from the C2 server, it will uninstall the iOS app specified in the commands from current device (Figure 19). Then, it will install another downloaded app as a fake version to trick the user. This uninstallation operation is also implemented using a private API -- the MobileInstallationUninstall defined in the MobileInstallation framework.\r\n\r\n\r\nFigure 19.\u00a0NoIcon uninstall specified app in fakeApps command\r\n\r\nSelf Monitoring and Updating\r\nThe NoIconUpdate will regularly check whether all these malicious components are installed, then connect with YiSpecter\u2019s C2 server to check for updates. This is why some victims deleted the main app and NoIcon but the malware still remained on the phone.\r\n\r\n\r\nFigure 20.\u00a0NoIconUpdate checks installed components' version\r\nAdditionally, NoIconUpdate will regularly check whether NoIcon is running. If not, it will launch NoIcon immediately.\r\n\r\n\r\nFigure 21.\u00a0NoIconUpdate checks running status and launches NoIcon\r\n\r\nHiding Icon in SpringBoard\r\nNoIcon, ADPage and NoIconUpdate use a trick to hide their icons from SpringBoard (the desktop in iOS.) In their Info.plist file, the \u201cSBAppTags\u201d key contains a value of \u201chidden\u201d (Figure 22). \u00a0Any app with this characteristic will not be shown in SpringBoard, hence the user won\u2019t see its icon and its name. This mechanism is used by some preinstalled apps for testing and diagnostics on the iOS system. In February 2015, an iOS Spyware XAgent (aka PawnStorm) also used this trick.\r\n\r\n\r\nFigure 22. Part of NoIcon's Info.plist file\r\nThis icon hiding behavior is critical to YiSpecter\u2019s success. Without being able to see the icon, users not only can\u2019t discover these malicious apps, but also have no way to uninstall them (because uninstalling an iOS app requires the user to long click the app\u2019s icon in SpringBoard). This behavior is likely why YiSpecter\u2019s named the component \u201cNoIcon.\u201d\r\nPretending to be System Apps\r\nEven though icons are hidden from the SpringBoard, YiSpecter\u2019s author still has considered power users who may use third-party tools to manage iPhones or iPads. The author used special display app names and logos for these three apps to make them look like iOS system apps. The table below shows the display name and icon of three samples we analyzed. As far as we know, YiSpecter has pretended to be the Phone, Weather, Game Center, Passbook, Notes and Cydia apps. While this is a simple trick, it may be effective at fooling some users.\r\n\r\n\r\n\r\nComponent\r\nBundle ID\r\nDisplayed App Name\r\nFaked App Logo\r\n\r\n\r\nNoIcon\r\ncom.weiying.hiddenIconLaunch\r\nPassbook\r\n\r\n\r\n\r\nADPage\r\ncom.weiying.ad\r\nCydia\r\n\r\n\r\n\r\nNoIconUpdate\r\ncom.weiying.noiconupdate\r\nGame Center\r\n\r\n\r\n\r\n\r\nHijacking Other Apps Execution to Show Ads\r\nNoIcon will also regularly check which iOS app the user has open. This is implemented by using the private API function SBSCopyFrontmostApplicationDisplayIdentifier defined in the SpringBoardServices framework. NoIcon receives an allowlist of apps from C2 server and checks if the currently running app is on this list, which contains YiSpecter\u2019s components and apps built by Apple. If the app isn\u2019t in the list, NoIcon will launch the ADPage app by executing another private API function: SBSLaunchApplicationWithIdentifier.\r\n\r\n\r\nFigure 23. NoIcon compares current running app with allowlist\r\n\r\nFigure 24.\u00a0NoIcon launch ADPage to cover other apps user interface\r\nThe launched ADPage will show a full screen with words \u201cCydia is detecting and protecting\u201d in Chinese (Figure 25), then display some advertisements provided by third-party mobile ads platforms. Through this mechanism NoIcon and ADPage successfully hijacked other iOS apps\u2019 execution and show its advertisements to victims. This is the most significant behavior reported by victims, as it is disruptive to their regular use of iOS devices.\r\n\r\n\r\nFigure 25.\u00a0ADPage's full screen before displaying advertisement\r\n\r\nChanging Safari Configurations\r\nAnother feature of NoIcon allows it to change Safari browser\u2019s configurations on jailbroken devices by directly writing to local configuration and database files.\r\n\r\nIf NoIcon receives a specific command from the C2 server, it will enumerate all subdirectories in the \u201c\/var\/mobile\/Applications\u201d directory to find a \u201cPreferences\/com.apple.mobilesafari.plist\u201d file. Thus, it can identify the Safari app\u2019s home directory. \u00a0It then modifies this plist file to change Safari\u2019s default search engine to a specified one between Google, Bing, Yahoo and Baidu (Figure 26). However, in a nearby piece of code, we found that Baidu was specifically hard coded as target search engine in some situations (Figure 27).\r\n\r\n\r\nFigure 26.\u00a0NoIcon locates Safari's config file and change default search engine\r\n\r\nFigure 27.\u00a0NoIconHard-coded to change default search engine to Baidu\r\nAdditionally, NoIcon changes Safari\u2019s bookmarks database to update all existing bookmark URLs to the URL that specified by C2 server. It will also write Safari\u2019s SuspendStates.plist file to change all latest opened webpages\u2019 URLs to the specified URL.\r\n\r\nNote that all these behaviors also occurred according to victims\u2019 reports posted in online forums.\r\n\r\n\r\nFigure 28.\u00a0Change URLs in all existing bookmarks\r\n\r\nFigure 29.\u00a0Change URLs in latest opened pages\r\n\r\nCollecting and Uploading Device Information\r\nAll of the malicious YiSpecter apps collect some device information and upload it to the C2 server, including:\r\n\r\n \tA los of installed iOS apps; by invoking the private API MobileInstallationLookup;\r\n \tA list of running processes by invoking sysctl;\r\n \tThe device UUID;\r\n \tThe device MAC address, by invoking sysctl.\r\n\r\nWho\u2019s Behind YiSpecter?\r\nThere is a lot of evidences that suggests YiSpecter was developed by a company named \u201cYingMob Interaction (\u5fae\u8d62\u4e92\u52a8)\u201d. For example, three of four components are signed by YingMob Interaction\u2019s enterprise certificate. In the NoIconUpdate\u2019s code, we even found a README.md which names the company in the app\u2019s release notes. YiSpecter\u2019s C2 server has hosted some websites belonging to YingMob. For example, if we directly visit the subdomain for YiSpecter\u2019s downloading, qvod.bb800[.]com, we can find it\u2019s an \u201cWAP iOS Traffic Platform Backend Management System\u201d with copyright information of YingMob Interaction.\r\n\r\n\r\nFigure 30.\u00a0README.md in the NoIconUpdate\r\n\r\nFigure 31.\u00a0YiSpecter's C2 server page has YingMob Interaction's copyright info\r\n\r\nFigure 32.\u00a0YingMob Interaction official website\r\nYingMob Interaction\u2019s official website shows it\u2019s a Chinese mobile advertisement platform. In addition to YiSpecter we found the company also developed an iOS \u201chelper\u201d tool named \u201cHaoYi Apple Helper(\u597d\u6613\u82f9\u679c\u52a9\u624b)\u201d. The tool was later renamed to \u201cFengniao Helper(\u8702\u9e1f\u52a9\u624b)\u201d. The tool\u2019s website is http:\/\/zs.haoyi.com\/ but there\u2019s another subdomain http:\/\/zs.od.bb800.com in YiSpecter\u2019s C2 domain that is redirected to zs.haoyi.com. The helper tool says it can help users install all paid iOS apps in the App Store without jailbreaking, and it will give Apple IDs to users as presents to avoid registration in Apple. These functionalities are similar to what the iOS Trojan KeyRaider did earlier this year. Based on victims\u2019 discussions, we found that YiSpecter will frequently ask users to install this helper tool.\r\n\r\n\r\nFigure 33.\u00a0Fengniao Helper developed by YingMob Interaction\r\n\r\nRelationship between YiSpecter and XcodeGhost\r\nIn September 2015, we initially investigated an OS X and iOS malware named XcodeGhost. By infecting Xcode, this compiler malware was successfully compiled into thousands of iOS apps in the App Store and affected hundred of millions users.\r\n\r\nWhile YiSpecter and XcodeGhost both attacked non-jailbroken iOS devices, they are not related to each other. We believe that YiSpecter and XcodeGhost were developed by different attackers and there is no evidence of cooperation between the two developers so far.\r\n\r\nHowever, from technical perspective, it\u2019s still interesting to discuss potential connections between them.\r\n\r\nFirst, we explained that XcodeGhost could be remotely controlled by attackers to open arbitrary URLs, including opening a URL to ask a user to install any app signed by enterprise certificate. Hence, XcodeGhost could be another way to distribute malware like YiSpecter. In fact, not only XcodeGhost but also other legitimate iOS apps in the App Store can also do this.\r\n\r\nSecond, we explained that XcodeGhost collects system and app information and uploads it to its C2 server. People may be curious why the malware collects this data for. YiSpecter also exhibits this behavior but it also silently installs additional apps, which XcodeGhost does not.\r\n\r\nIn the underground ecosystem, when someone distributes apps for a fee they typically need some evidence to prove they were successful. For example, after YiSpecter silently installs other apps or games, the attacker could provide related devices and app information to paying developers in order to collect his or her fee. Given that XcodeGhost didn\u2019t install other apps but uploaded that information by default, we suspect that XcodeGhost may have been scamming other underground distributors by collecting the evidence of installation but not actually performing it.\r\nSecurity Risks and Related Threats\r\nThe world where only jailbroken iOS devices were threatened by malware is a thing of the past. WireLurker proved that non-jailbroken iOS devices can also be infected through abuse of the enterprise distribution mechanism. YiSpecter further shows us that this technique is being used to infect many iOS devices in the wild.\r\n\r\nThe key techniques deployed in YiSpecter are bypassing App Store reviews using enterprise distribution and abusing iOS private APIs to perform sensitive operations. This method has been discussed in some top academic conference papers in recent years (e.g., Tielei Wang et al in USENIX Security 2013, Min Zheng et al in AsiaCCS 2015, and Zhui Deng et al in CCS 2015.) However, YiSpecter is the first iOS malware in the wild that adopted this technique to launch a wide range attacks. This attack vector breaks Apple\u2019s security mechanisms and is likely to be abused in future attacks.\r\n\r\nFor years Apple has searched for privates APIs used in apps submitted to the App Store and rejected the apps found using them. However, except for enterprise distribution, there\u2019re still some ways to bypass this security check.\r\n\r\nIn the Objective-C language, invoking a method of an Objective-C object is not implemented through a virtual table as in C++. Objective-C uses a central message forwarding mechanism to handle method invoking where class name and method name are passed as string format parameters. Hence, a malware author can directly invoke the message forwarding functions such as objc_msgSend with obfuscated or encrypted class name and method name strings to use private APIs. Apple\u2019s code review is not strong enough hence apps using private APIs in this way will bypass their review and go to the App Store.\r\n\r\nIn fact, in one academic paper \u201ciRiS: Vetting Private API Abuse in iOS Applications\u201d in the coming ACM Conference on Computer and Communications Security (CCS 2015), researchers Zhui Deng et al from Purdue University successfully discovered 146 iOS apps from the App Store that abused 150 different private APIs including 25 APIs that are security critical. These occupied about 7 percent of all apps they analyzed. Note that they even found a third-party advertisement library that abused private APIs to collect private user information.\r\n\r\nThis observation is significant, because as a community, many of us have considered Apple\u2019s code review on private APIs good enough and that abusing private APIs can only be successful if combined with enterprise distribution (like in the case of the YiSpecter.) Though this research, we now know that abusing private APIs in the iOS system could be an independent attack technique and could affect all iOS users.\r\nPrevention and Removal of YiSpecter\r\nPalo Alto Networks has released IPS signatures (14861,14862,14863) via our Threat Prevention product to detect and block all malicious C2 traffic related to YiSpecter. We have also released signatures to detect the queries for the C2 domains used by the malware.\r\n\r\nWe have also reported the YiSpecter threat to Apple for them to revoke the abused enterprise certificates. (As noted above, the new iOS 9 requires users to manually set related provisioning profile as trusted in Settings before they can install Enterprise provisioned apps. This new feature is also helpful for preventing some security incidents caused by abusing enterprise certificates.)\r\n\r\nFor iOS users that are potentially infected by YiSpecter, we suggest removing it with the following steps:\r\n\r\n \tIn iOS, go to Settings -&gt; General -&gt; Profiles to remove all unknown or untrusted profiles;\r\n \tIf there\u2019s any installed apps named \u201c\u60c5\u6da9\u64ad\u653e\u5668\u201d, \u201c\u5feb\u64ad\u79c1\u5bc6\u7248\u201d or \u201c\u5feb\u64ad0\u201d, delete them;\r\n \tUse any third-party iOS management tool (e.g., iFunBox, though note that Apple\u2019s iTunes doesn\u2019t work in this step) on Windows or Mac OS X, to connect with your iPhone or iPad;\r\n \tIn the management tool, check all installed iOS apps; if there\u2019re some apps have name like Phone, Weather, Game Center, Passbook, Notes, or Cydia, delete them. (Note that this step won\u2019t affect original system apps but just delete faked malware.)\r\n\r\nOur primary security suggestion to avoid being affected by this kind iOS malware was, is and remains this: never download iOS apps from any untrusted sources, and never trust unknown developers. You should always download iOS apps from the official App Store for personal use, or download your company or organization\u2019s internal app under your IT department\u2019s guidance. Consider that even apps from the App Store can also abuse private APIs for harmful operations, and that these security habits won\u2019t prevent all similar attacks but should prevent most of them. We have also made suggestions to Apple for improving their code review procedures and urged them to improve iOS security mechanisms to defeat these potential security problems.\r\nAppendix\r\nSamples of YiSpecter\r\n57cc101ee4a9f306236d1d4fb5ccb3bb96fa76210142a5ec483a49321d2bd603\u00a0 ADPage\r\n\r\n4938b9861b7c55fbbe47d2ba04e9aff2da186e282f1e9ff0a15bbb22a5f6e0e7\u00a0 ADPage.ipa\r\n\r\nfc55c5ced1027b48885780c87980a286181d3639dfc97d03ebe04ec012a1b677\u00a0 DaPian\r\n\r\n5259854994945a165996d994e6484c1afc1c7e628cb5df2dc3750f4f9f92202e\u00a0 DaPian.ipa\r\n\r\n7714dbb85c5ebcd85cd1d93299479cff2cc82ad0ed11803c24c44106530d2e2f\u00a0 HYQvod\r\n\r\nddd16577b458a5ec21ea0f57084033435a46f61dc5482f224c1fe54f47d295bc\u00a0 HYQvod.ipa\r\n\r\n8fa135fc74583e05be208752e8ce191060b1617447815a007efac78662b425d0\u00a0 HYQvod_3.3.3\r\n\r\n526e1dc893629c00c017fbe62b53392cb26bc6b15947e7b8b7df10a62f40cbad\u00a0 HYQvod_3.3.3.ipa\r\n\r\n41176825ba0627f61981280b27689a0c5cc6bfb310a408fa623515e6239b8647\u00a0 NoIcon\r\n\r\n98e9e65d6e674620eccaf3d024af1e7b736cc889e94a698685623d146d4fb15f\u00a0 NoIcon.ipa\r\n\r\ne7f071929a4304447cf638057d9499df9970b2a3d53d328a609f191a4bc29ffd\u00a0 NoIconUpdate\r\n\r\n8873908061f9c8d563de26fe6fa671080a90a2d60f795cc0664ef686e1162955\u00a0 NoIconUpdate.ipa\r\nSamples in VirusTotal\r\n\r\n\r\n\r\nSHA-256\r\nFilename\r\nSubmit\r\nDetections\r\n\r\n\r\n382b88b654d7c5149ce8e9813accb86fd58eb1c01d66f730774f27a14d6af06c\r\nHYQvod\r\n11\/18\/14\r\n1\/55\r\n\r\n\r\n0a106551b950d312c3847889cb233cbdaaebbc55fc2d7b6deb37f493079aa419\r\nqj238_HYQvod_18.ipa\r\n11\/18\/14\r\n1\/52\r\n\r\n\r\n95c2b1fd5a9e0141e6c597771e832e6c6743713888bfad3d172c0180d650795b\r\nqj238_HYQvod_14.ipa\r\n1\/26\/15\r\n1\/56\r\n\r\n\r\n487a442fa69be5fe701662976a2f9d16f7f1dc4b03d63b9a289a6395855b42d0\r\nqvod2.4.0HYQvod_jx46.ipa\r\n1\/26\/15\r\n1\/57\r\n\r\n\r\n63b4ff014e74bd0a31b16393d145d1332e963b2e17f07396529793a4f0cf8b48\r\nqiumama_HYQvod_jx69.ipa\r\n2\/5\/15\r\n1\/56\r\n\r\n\r\nfa8594384e119908ec4ea5e0af9597251f6de76a66c30682e36ca1f1d303c7a9\r\nqiuchuanyi_HYQvod_jx48.ipa\r\n2\/26\/15\r\n1\/57\r\n\r\n\r\nf2a478eb2674b65d602204b2df8fc5e715e22596b039f235f9dfa27c03bbaa9b\r\n1420683505536.ipa\r\n2\/26\/15\r\n1\/57\r\n\r\n\r\nca59d78e9d23a737054b70385060346a8e6afc4948cd84f97826deb05168c279\r\n20150113205442561.ipa\r\n2\/26\/15\r\n0\/57\r\n\r\n\r\naf338b0d35e532644850f9f5e00b6c67d6e08609cb9ef79d48e9f435f87366d0\r\nqvod2.4.0HYQvod_6.ipa\r\n2\/26\/15\r\n1\/57\r\n\r\n\r\n17c89f5a579ecc3f97914a0fdd8ed1305a3682e09a719f91716607c3d63eabdf\r\nqvod2.4.0HYQvod_5.ipa\r\n2\/26\/15\r\n1\/57\r\n\r\n\r\n0e75378d2ee5a7b90696dd67efa0d06d619f7f29021a7f056ff5a0fe881f8d6e\r\n20150203141304735.ipa\r\n2\/26\/15\r\n0\/57\r\n\r\n\r\n55573153750d98938270d858ca220a4435ebcd1dac44388e5a59315e7811193c\r\nDaPian\r\n2\/27\/15\r\n0\/57\r\n\r\n\r\n426f279a503a19d5c253621ad98f589d853270fd0a1ec54bf08ee55c1f647964\r\nDaPian\r\n2\/27\/15\r\n0\/57\r\n\r\n\r\nf1e527fba122f91e79e790ba519c0d161cb4959bb1c89d6c20cf8a141ef8f854\r\nHYQvod\r\n4\/20\/15\r\n1\/57\r\n\r\n\r\nbcb3d4a2960e76cc169bd80ff26c7973502ef11baf0d45d52534184f055003a1\r\nHYQvod\r\n4\/20\/15\r\n1\/56\r\n\r\n\r\n5fd7b3994fc95cd72e2c76607ed00f260783e02b6fdf228e1e4616ca1e8702be\r\nHYQvod\r\n4\/20\/15\r\n1\/55\r\n\r\n\r\n0771302f113d9c64fca3988a31020afa0767d3e1b66a2e74f819fd62b80b8a5e\r\nHYQvod\r\n4\/20\/15\r\n1\/57\r\n\r\n\r\n1d5eea2236a2a44fe0ff4e17491c37f04ffa4a0af9a4b09ecc463089e3f48f14\r\nkuaibozqb.3987.ipa\r\n4\/26\/15\r\n1\/56\r\n\r\n\r\n1d5eea2236a2a44fe0ff4e17491c37f04ffa4a0af9a4b09ecc463089e3f48f14\r\nkuaibozqb.3987.ipa\r\n5\/12\/15\r\n1\/57\r\n\r\n\r\n3404bbf56d81da355636371f2e84b3b83ead7d78384c1627db67c4a59c275285\r\nUnknown\r\n6\/29\/15\r\n0\/56\r\n\r\n\r\n04f69960b2e5fbd06f746e050c7a04e4ea9de67289fd82d3a85a92963aec387a\r\nUnknown\r\n6\/29\/15\r\n0\/56\r\n\r\n\r\n363e58e1f489b6fade4975a54c02575e8832d95171b6b5646fd475d6a5f35ed9\r\nHYQvod\r\n7\/25\/15\r\n0\/56\r\n\r\n\r\nddd16577b458a5ec21ea0f57084033435a46f61dc5482f224c1fe54f47d295bc\r\n1438074603284.ipa\r\n8\/18\/15\r\n1\/56\r\n\r\n\r\n\r\nSamples of Worm.Win32.Lingdun\r\n2771276596981c0ff189c27e6869b147c3c3665fd8b94b14d68695ea6ea3d09d\u00a0 inst.exe\r\n\r\n8d113243da8992220e73a2fd02ae28d209b326b191aeef95f3c8e223c1c6db96\u00a0 leba99_setup_220041398.exe\r\n\r\n9e538a58aed94a7748df9262ae0343dea9efce8d9117e0868eb404e1098747b6\u00a0 u.exe\r\n\r\n1607cf9625d7bf4ef39f8c1383fa0b1b1edcd13939d5d49fba5cdc14a73a2d95\u00a0 ziyt.scr\r\n\r\n6bd56dd4cc6a97912531fcb8d9f79f814fd45c9e97600f170646308868b1097b\u00a0 \u4eb2\u60c5\u89c6\u9891\u79c0.exe\r\n\r\na8456f50c47b5248a93bcaebd05cb07bbf61527d5c7537767df1aaabb64bad95\u00a0 \u5929\u4f7f\u5ae9\u5973\u89c6\u9891\u5168\u96c6.msi\r\nAcknowledgements\r\nThanks CDSQ from WeipTech group for providing some samples of YiSpecter from an infected iPhone.\r\n\r\nThanks Josh Grunzweig and Bryan Lee from Palo Alto Networks for their suggestions on naming. (Finding a proper name is always so hard!)\r\n\r\nThanks Rongbo Shao and Zhaoyan Xu from Palo Alto Networks for their efforts in detecting the threat.\r\n\r\nThanks Ryan Olson from Palo Alto Networks for reviewing and revising this report.\r\n\r\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"","width":"","height":""},"author":[{"@type":"Person","name":"Claud Xiao"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"10490","token":"7e15a0f8b3","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=10490' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fyispecter-first-ios-malware-attacks-non-jailbroken-ios-devices-by-abusing-private-apis%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fyispecter-first-ios-malware-attacks-non-jailbroken-ios-devices-by-abusing-private-apis%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-10490 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">YiSpecter: First iOS Malware That Attacks Non-jailbroken Apple iOS Devices by Abusing Private APIs</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-10490 entry-meta">
			
			
			<span class="post-views-count">51,844</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'10490','like')"><i class="ui ui-2"></i><span class="ml-5">5</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 22</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fyispecter-first-ios-malware-attacks-non-jailbroken-ios-devices-by-abusing-private-apis%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fyispecter-first-ios-malware-attacks-non-jailbroken-ios-devices-by-abusing-private-apis%2F+-+YiSpecter%3A+First+iOS+Malware+That+Attacks+Non-jailbroken+Apple+iOS+Devices+by+Abusing+Private+APIs" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fyispecter-first-ios-malware-attacks-non-jailbroken-ios-devices-by-abusing-private-apis%2F&title=YiSpecter%3A+First+iOS+Malware+That+Attacks+Non-jailbroken+Apple+iOS+Devices+by+Abusing+Private+APIs&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/yispecter-first-ios-malware-attacks-non-jailbroken-ios-devices-by-abusing-private-apis/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/claud-xiao/" title="Posts by Claud Xiao" class="author url fn" rel="author">Claud Xiao</a>        </p>
        <p><time datetime="2015-10-05T01:00:45+00:00">October 4, 2015 at 6:00 PM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/malware-2/" rel="category tag">Malware</a>, <a href="https://unit42.paloaltonetworks.com/category/threat-prevention-2/" rel="category tag">Threat Prevention</a>, <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/antivirus/" rel="tag">antivirus</a>, <a href="https://unit42.paloaltonetworks.com/tag/app-store/" rel="tag">app store</a>, <a href="https://unit42.paloaltonetworks.com/tag/apple/" rel="tag">Apple</a>, <a href="https://unit42.paloaltonetworks.com/tag/china/" rel="tag">China</a>, <a href="https://unit42.paloaltonetworks.com/tag/ios/" rel="tag">iOS</a>, <a href="https://unit42.paloaltonetworks.com/tag/iphones/" rel="tag">iPhones</a>, <a href="https://unit42.paloaltonetworks.com/tag/taiwan/" rel="tag">Taiwan</a>, <a href="https://unit42.paloaltonetworks.com/tag/xcodeghost/" rel="tag">XcodeGhost</a>, <a href="https://unit42.paloaltonetworks.com/tag/yispecter/" rel="tag">YiSpecter</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/yispecter-first-ios-malware-attacks-non-jailbroken-ios-devices-by-abusing-private-apis/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><h3>Summary</h3>
<p>We recently identified a new Apple iOS malware and named it YiSpecter. YiSpecter is different from previously seen iOS malware in that it attacks both jailbroken and non-jailbroken iOS devices through unique and harmful malicious behaviors. Specifically, it’s the first malware we’ve seen in the wild that abuses private APIs in the iOS system to implement malicious functionalities.<span id="more-10490"></span></p>
<p>So far, the malware primarily affects iOS users in mainland China and Taiwan. It spreads via unusual means, including the hijacking of traffic from nationwide ISPs, an SNS worm on Windows, and an offline app installation and community promotion. Many victims have discussed YiSpecter infections of their jailbroken and non-jailbroken iPhones in online forums and have reported the activity to Apple. The malware has been in the wild for over 10 months, but out of 57 security vendors in VirusTotal, only one is detecting the malware at the time of this writing.</p>
<p>YiSpecter consists of four different components that are signed with enterprise certificates. By abusing private APIs, these components download and install each other from a command and control (C2) server. Three of the malicious components use tricks to hide their icons from iOS’s SpringBoard, which prevents the user from finding and deleting them. The components also use the same name and logos of system apps to trick iOS power users.</p>
<p>On infected iOS devices, YiSpecter can download, install and launch arbitrary iOS apps, replace existing apps with those it downloads, hijack other apps’ execution to display advertisements, change Safari’s default search engine, bookmarks and opened pages, and upload device information to the C2 server. According to victims’ reports, all these behaviors have been exhibited in YiSpecter attacks in the past few months. Some other characteristics about this malware include:</p>
<ul>
<li>Whether an iPhone is jailbroken or not, the malware can be successfully downloaded and installed</li>
<li>Even if you manually delete the malware, it will automatically re-appear</li>
<li>Using third-party tools you can find some strange additional “system apps” on infected phones</li>
<li>On infected phones, in some cases when the user opens a normal app, a full screen advertisement will show</li>
</ul>
<p>YiSpecter is the latest in a line of significant malware families to target iOS devices. Previously, <a href="http://researchcenter.paloaltonetworks.com/2014/11/wirelurker-new-era-os-x-ios-malware/" target="_blank" rel="noopener noreferrer">the malware WireLurker</a> demonstrated the ability to infected non-jailbroken iOS devices by abusing enterprise certificates, and academic researchers have discussed how private APIs can be used to implement sensitive functionalities in iOS. However, YiSpecter is the first real world iOS malware that combines these two attack techniques and causes harm to a wider range of users. It pushes the line barrier of iOS security back another step.</p>
<p>Moreover, recent research shows that over 100 apps in the App Store have abused private APIs and bypassed Apple’s strict code review. What that means is the attacking technique of abusing private APIs can also be used separately and can affect all normal iOS users who only download apps from the App Store.</p>
<p>Palo Alto Networks has released IPS and DNS signatures to block YiSpecter’s malicious traffic. This blog also contains suggestions for how other users can manually remove YiSpecter and avoid potential similar attacks in the future. Apple has also been notified.</p>
<h3>Background</h3>
<p>On February 7, 2015, <a href="http://bobao.360.cn/learning/detail/234.html">Qihoo 360</a> and <a href="http://cn.cmcm.com/news/security/2015-02-07/28.html">Cheetah Mobile</a>, two security companies in China, posted analysis reports separately about a Windows worm named “Lingdun(灵顿)”. The Lingdun worm hijacked victims’ QQ sessions (a popular IM program produced by Tencent) and sent malicious links to their QQ contacts. According to those reports, if a user clicked the malicious links using Android or iOS devices, an Android Adware or an iOS Adware would be installed. Qihoo 360 and Cheetah Mobile found the installed apps’ main behavior is to prompt other mobile apps and classify them as Android and iOS variants of the Lingdun worm.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter1.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10492" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter1-500x888.png" alt="YiSpecter1" width="500" height="888" /></a></p>
<p style="text-align: center;">Figure 1. Access Lingdun&#8217;s webpage with an iPhone will infect  the device with YiSpecter</p>
<p>After further investigation, however, we think their analysis is incomplete and has led to an incorrect conclusion. The iOS app spread by Lingdun and the malicious components it installs have different developers, different Command and Control (C2) servers, different purposes, and different code signing certificates. Therefore, we don’t believe them to be variants of the Lingdun worm but instead separate malware using the Lingdun worm to spread. Additionally, we found these iOS apps have many more malicious functions than previous disclosed. Hence we do not refer to this malware family as Lingdun and have given it the new name YiSpecter.</p>
<p>Qihoo 360 and Cheetah Mobile didn’t share samples of YiSpecter with the security community nor did they disclose file hash values we could use to identify their samples. As a result, until now, no other security vendor has detected YiSpecter as malware.</p>
<p>In the course of our investigation, we found 23 samples of YiSpecter were submitted to VirusTotal from different countries between November 2014 and August 2015. Except for Qihoo, the 56 antivirus engines included in VirusTotal didn’t detect these files (as shown in Figure 2).  Qihoo’s detection result uses the meaningless name “virus.ios.hidden”. It is also worth noting that all of these samples belong to YiSpecter’s main apps, and its three additional malicious components were not uploaded to VirusTotal until we published this report. All of these samples are listed at the end of this report.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter2.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10494" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter2-500x495.png" alt="YiSpecter2" width="500" height="495" /></a></p>
<p style="text-align: center;">Figure 2. YiSpecter is not detected by nearly all AntiVirus programs</p>
<h3>Uncommon Spreading Methods</h3>
<p>YiSpecter began to spread in the wild in November 2014, if not earlier. The main iOS apps of this malware have user interface and functionality that enable the watching of free porn videos online, and were advertised as “private version” or “version 5.0” of a famous media player “QVOD”. QVOD was developed by Kuaibo(快播) and became popular in China by users who share porn videos. <a href="http://tech.qq.com/a/20140422/016994.htm">Kuaibo was investigated by a local police department in April 2014</a> and at the same time their online video playing service was terminated. After that event, the attackers behind YiSpecter began to claim their app as an alternative QVOD to attract users into installing their software.</p>
<p>So far we have identified four different mechanisms YiSpecter uses to infect phones.</p>
<h3>Internet Traffic Hijacking</h3>
<p>In the past 6 years, <a href="https://www.google.com/webhp?sourceid=chrome-instant&amp;ion=1&amp;espv=2&amp;ie=UTF-8#newwindow=1&amp;tbm=nws&amp;q=%22%E8%BF%90%E8%90%A5%E5%95%86%E5%8A%AB%E6%8C%81%22">many Chinese media organizations (including state television) have reported</a> that local ISPs in some provinces have supported DNS hijacking and Internet traffic hijacking attacks. ISPs hijacked the traffic to display advertisements to their users. For example, when Internet users use their computers or mobile phones to browse a website, the ISP will inject JavaScript code or HTML content into the session, <a href="http://www.cctv.com/cctvsurvey/special/02/20100422/105231.shtml">which results in advertisements being displayed in the returned webpage</a>. Last year, we also observed that <a href="http://www.v2ex.com/t/145087">some ISPs replaced app download URLs with other apps.</a> For example, if an URL ends with “.apk” (i.e. downloading an Android app), it will be redirected to different URL, downloading a “promoted” app onto the victims’ Android phones. YiSpecter, as far as we know, is the first malware that has been spread by ISPs hijacking Internet traffic.</p>
<p>Many users based in mainland China and Taiwan have discussed their infections by YiSpecter online (we will introduce these discussions in next section.) From their discussions and reports, we found that more than half of the infections came from pop-up dialogs displayed when browsing famous news websites.</p>
<p>For example, Figure 3 shows a screenshot <a href="https://discussionschinese.apple.com/thread/52748">posted to Apple’s official support community</a>. It shows that when the author was browsing ITHome.com, an abnormal pop-up dialog asked him to install a “QVOD Private Version” player to “watch special movies”.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter3.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10495" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter3-500x750.png" alt="YiSpecter3" width="500" height="750" /></a></p>
<p style="text-align: center;">Figure 3. Ads and pop-up dialog were injected into normal Internet traffic</p>
<p>Based on the user’s discussions, we found the problem only occurred when they were using WiFi networks in their homes; mobile networks and office networks didn’t appear to be affected. Some non-jailbroken iPhone users tried to clear cookies, reset iOS, change their iCloud accounts, and block pop-ups in Safari, but these operations didn’t resolve the problem. However, if they used a third party mobile browser with built-in proxy functionality to access the same webpage, the advertisements disappeared. One user even <a href="http://bbs.feng.com/read-htm-tid-8167542.html">called his ISP’s service phone number to complain</a> and the problem was resolved – these advertisements never appeared again. Based on this information, we believe that ISP’s traffic hijacking was used to spread the malware in these cases, and not a malicious third party.</p>
<h4>SNS Worm</h4>
<p>According to analysis reports by Qihoo 360 and Cheetah Mobile, YiSpecter was also spread by the Lingdun worm.</p>
<p>Lingdun uses fake VeriSign and Symantec certificates to bypass malware detection systems. Its primary goal is to download and to install additional Windows software onto a PC. Most of this additional software is benign but at least one installation was malicious. The malware fetches the current user’s QQ authorization token by accessing Tencent’s unified login interface, then acquires a key to access all QQ services. Specifically, it will access the QQ Discussion Group’s file sharing interface to upload malicious HTML files. These HTML files have names including pornographic and sexually suggestive words and will be shared with all other QQ users in the same discussion group.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter4.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10496" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter4-500x250.png" alt="YiSpecter4" width="500" height="250" /></a></p>
<p style="text-align: center;">Figure 4. A malicious webpage uploaded by Lingdun worm</p>
<p>If other QQ users access these malicious HTML files, the webpage will determine their devices’ type by User-Agent value and distinguish Windows, Linux, Android, iOS (including iPhone and iPad), and Windows Phone. If the device is Android, the session will be redirected to download an Android Adware that prompts the user to install other porn apps. If the device is an iPhone or iPad, the session will be redirected to download the YiSpecter malware (Figure 1).</p>
<p>We listed hash values of all public available samples of Lingdun worm at the end of this article.</p>
<h3>Offline App Installation</h3>
<p>During our investigation, we found that the main YiSpecter apps were also published on multiple underground app distribution websites (Figure 5).</p>
<p>In an underground or “gray” mobile app ecosystem, mobile app developers (including malware authors) will post tasks of distributing their apps to these kinds of websites. Distributors will then accept these tasks, and install the apps on other users phones to earn a promotion fee from developers. For example, some third-party mobile phone retailers and maintenance suppliers will install apps on any mobile phone they can access; and mobile malware developers also install apps to earn income from devices they have infected.</p>
<p style="text-align: center;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter5.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10497" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter5-500x251.png" alt="YiSpecter5" width="500" height="251" /></a></p>
<p style="text-align: center;">Figure 5. YiSpecter apps were listed in underground app distribution websites</p>
<p>From one of these websites (Figure 5), we see that many tasks to distribute YiSpecter were created in May 2015 and July 2015. The promotion fee for one installation is between 1.80 and 2.50 RMB (about US $0.30 to $0.40.) These tasks’ descriptions also showed that the YiSpecter apps have a backend system to automatically track installations, thus distributors do not need to provide screenshots to prove their successful infections.</p>
<h4>Community Promotion</h4>
<p>We also found that YiSpecter’s author tried to directly promote their malicious apps on social networks and in public communities. For example, in a popular Chinese online forum, we found a user posted an article in January 2015 recommending the YiSpecter apps as good replacement for QVOD player. The user’s account name is “HaoYi Apple Helper(好易苹果助手)”, which is exactly the name of another product YiSpecter’s author developed. We will describe YiSpecter’s author in more detail in later sections.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter6.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10498" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter6-500x365.png" alt="YiSpecter6" width="500" height="365" /></a></p>
<p style="text-align: center;">Figure 6. YiSpecter&#8217;s author recommends the app in public forum</p>
<h3>Attacks and Victims</h3>
<p>While analyzing YiSpecter’s code, we searched for keywords related to its <a href="https://www.google.com/?gws_rd=ssl#newwindow=1&amp;q=bb800.com+site:feng.com">distribution channels</a> and <a href="https://www.google.com/?gws_rd=ssl#newwindow=1&amp;q=%22Cydia%E6%A3%80%E6%B5%8B%E4%BF%9D%E6%8A%A4%E4%B8%AD%22">user interface</a> in Google, and found many victims from mainland China and Taiwan discussing their infections in online forums and social networks including Zhihu, Douban, Weiphone, CocoaChina, Baidu Zhidao and Mobile01.</p>
<p>For example, one malicious component in YiSpecter shows an interface containing the words “Cydia is detecting and protecting” in Chinese (Figure 25). Google showed about 2,580 results by searching for this Chinese sentence (Figure 7).</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter7.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10499" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter7-500x664.png" alt="YiSpecter7" width="500" height="664" /></a></p>
<p style="text-align: center;">Figure 7. Search for YiSpecter&#8217;s user interface keyword</p>
<p>Based on these search results, we found some interesting facts about the malware:</p>
<ul>
<li>Whether an iPhone is jailbroken or not, the malware can be successfully downloaded and installed</li>
<li>Even if you manually delete the malware, it will automatically re-appear (Figure 8)</li>
<li>Using third-party tools you can find some strange additional “system apps” on infected phones</li>
<li>On infected phones, in some cases when the user opens a normal app, a full screen advertisement will show</li>
</ul>
<p>We explain the details of how this happens in the malicious behaviors analysis section below.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter8.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10500" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter8-500x440.png" alt="YiSpecter8" width="500" height="440" /></a></p>
<p style="text-align: center;">Figure 8. Taiwanese victim writes that the malware reappeared aafter deleting</p>
<h3>YiSpecter Components and C2 Server</h3>
<p>YiSpecter consists of four different components: various main apps that are distributed through the means described earlier, and three different malicious apps that are installed by these main apps. All samples analyzed and discussed in previous research are the various main apps, while the three malicious apps have not been revealed before.</p>
<h4>Main Apps</h4>
<p>As far as we know, there are at least two main apps distributed in the wild thus far:</p>
<ul>
<li>HYQvod (bundle id: weiying.Wvod)</li>
<li>DaPian (bundle id: weiying.DaPian)</li>
</ul>
<p>Both of them were spread by one or more of the multiple ways described earlier. They include the functionality of watching videos online by consuming credits and users can get credits by installing additional iOS apps it promotes (Figure 9). But most important, it will download and install another malicious app we have named NoIcon.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter9.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10501" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter9-500x888.png" alt="YiSpecter9" width="500" height="888" /></a></p>
<p style="text-align: center;">Figure 9. Main app ask users install other iOS apps to earn credits</p>
<h4>NoIcon</h4>
<p>NoIcon (bundle id: com.weiying.hiddenIconLaunch) is the main malicious component of YiSpecter. It takes the following actions on an infected device:</p>
<ul>
<li>Connect to the command and control server using HTTP</li>
<li>Upload basic device information</li>
<li>Retrieve and execute remote commands</li>
<li>Change the iOS default Safari configuration</li>
<li>Silently install two additional malicious apps “ADPage” and “NoIconUpdate”</li>
<li>Monitor other installed applications and hijack their launch routine to use “ADPage” to display advertisements</li>
</ul>
<p>Additionally, NoIcon can be remotely controlled to download and install arbitrary iOS apps from the C2 server or uninstall any existing apps in iOS system.</p>
<h4>ADPage</h4>
<p>ADPage (bundle id:  com.weiying.ad) is responsible for displaying advertisements when NoIcon hijacks the execution of legitimate apps.</p>
<h4>NoIconUpdate</h4>
<p>NoIconUpdate (bundle id: com.weiying.noiconupdate) regularly checks for other components’ existence, connects with the C2 server and report its installation information. It also checks for updated versions of the malware and installs them.</p>
<h4>C2 Server</h4>
<p>YiSpecter uses “bb800.com” as its C2 server’s domain name. In VirusTotal, there are 38 records of subdomains under this domain name. Sixteen of them have been used by Android Adware for years, e.g., ad.bb800[.]com and down.bb800[.]com. Another subdomain, ty1.bb800[.]com, was used by a Windows virus Almanahe.B.</p>
<p>YiSpecter uses these subdomains:</p>
<ul>
<li>iosnoico.bb800[.]com: used to upload information, download configs and commands, download malicious components (Figure 10)</li>
<li>qvod.bb800[.]com: used to download main app</li>
<li>qvios.od.bb800[.]com: used to download main app</li>
<li>dp.bb800[.]com: used to download promoted iOS apps</li>
<li>iosads.cdn.bb800[.]com:  used to download promoted iOS apps and malicious components</li>
</ul>
<p>Note that the main C2 subdomain, iosnoico.bb800[.]com, is not observed in VirusTotal and also has no results in Google searches.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter10.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10502" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter10-500x104.png" alt="YiSpecter10" width="500" height="104" /></a></p>
<p style="text-align: center;">Figure 10. C2 server access logs in cache in a victim&#8217;s iPhone</p>
<p>In some online articles, YiSpecter’s author posted URLs like “https://qvod.bb800[.]com/itms-services/jx152” for readers to download its main apps. When accessing these URLs from iPhone or iPad, victims are redirected to URLs like “itms-services://?action=download-manifest&amp;url=https://qvod.bb800.com/assets/upload/3794.plist”. Here “itms-services://” is a protocol used by iOS for enterprise app distribution (Figure 11). Through crawling these URLs, we found at least 102 versions of main apps that developed from Nov 2014 to Sep 2015.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter11.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10503" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter11-500x377.png" alt="YiSpecter11" width="500" height="377" /></a></p>
<p style="text-align: center;">Figure 11. PLIST file hosted by C2 server for YiSpecter&#8217;s installation</p>
<h3>Malicious Behavior Analysis</h3>
<p>In this section, we’re going to describe the malicious behaviors seen in each component of YiSpecter. The samples we analyzed are listed in the Appendix and will be shared with security community for research and detection.</p>
<h4>Abusing Enterprise Certificates</h4>
<p>YiSpecter’s malicious apps were signed with three iOS enterprise certificates issued by Apple so that they can be installed as enterprise apps on non-jailbroken iOS devices via <a href="https://developer.apple.com/library/ios/documentation/IDEs/Conceptual/AppDistributionGuide/DistributingEnterpriseProgramApps/DistributingEnterpriseProgramApps.html">in-house distribution</a>. The “main” apps used a certificate for “Changzhou Wangyi Information Technology Co., Ltd.” and then later used a certificate from “Baiwochuangxiang Technology Co., Ltd.” The three malicious components all used the same certificate belonging to “Beijing Yingmob Interaction Technology co, .ltd” (Figure 12).</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter12.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10504" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter12-500x295.png" alt="YiSpecter12" width="500" height="295" /></a></p>
<p style="text-align: center;">Figure 12. NoIcon used enterprise certificate for YingMob Interaction</p>
<p>Through this kind of distribution, an iOS app can bypass Apple’s strict code review procedures and can invoke iOS private APIs to perform sensitive operations. There is one disadvantage to using this method for installation compared to the official App Store: when these apps are executed for the first time iOS displays a dialog to notify the user that the apps are from a specific developer (Figure 13). However, many iOS users may simple click “Continue” and not be aware of the security implications of their choice.</p>
<p>Note that, in Apple’s just-released iOS 9, enterprise certificate security has been improved. Users now must manually set a related provisioning profile as “trusted” in Settings before they can install Enterprise provisioned apps.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter13.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10505" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter13-500x888.png" alt="YiSpecter13" width="500" height="888" /></a></p>
<p style="text-align: center;">Figure 13. iOS displays a dialog the first time a user opens an enterprise-signed app</p>
<p>The enterprise distribution program was designed for companies and organizations to distribute private iOS apps internally. WireLurker and YiSpecter’s usages obviously violate the license and the spirit of this program.</p>
<h4>Installing Malicious Apps</h4>
<p>Each time a user opens the main app of YiSpecter, it will invoke the[HYOwner checkI0S8_3AndJaikbreakOrNot] function. This function checks whether the current iOS system is older than version 8.3 and then determines if NoIcon is already installed. After that it checks whether the device is jailbroken or not by attempting to access a “cydia://” URL.</p>
<p>If the infected device has an iOS version less than 8.3, and NoIcon hasn’t been installed yet, whether the device is jailbroken or not, YiSpecter will invoke the function [HYAppDelegate requestNoicon:] to download the NoIcon IPA installer and PLIST manifest files (Figure 14).</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter14.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10506" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter14-500x238.png" alt="YiSpecter14" width="500" height="238" /></a></p>
<p style="text-align: center;">Figure 14. Main app downloads NoIcon for both jailbroken or non-jailbroken devices</p>
<p>The main app installs NoIcon in a unique way. The app opens an HTTP server and listens on port 8080 using [HYAppDelegate createLocalHTTP Server] (Figure 15). After downloading the NoIcon’s IPA and PLIST files, it will use these files’ local path to construct a local HTTP URL and displays an alert dialog with meaningless title and button text to the user (Figure 16). If the user clicks the button in the dialog, the HTTP server will handle the local HTTP URL and NoIcon will be installed using the itms-service protocol. With this mechanism YiSpecter uses the infected iOS device as an enterprise apps’ distribution server.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter15.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10508" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter15-500x262.png" alt="YiSpecter15" width="500" height="262" /></a></p>
<p style="text-align: center;">Figure 15. Main app launched a local HTTP server</p>
<p style="text-align: center;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter16.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10509" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter16-500x400.png" alt="YiSpecter16" width="500" height="400" /></a></p>
<p style="text-align: center;">Figure 16. Main app construct NoIcon installation URL and prompt alert dialog</p>
<p>After NoIcon is installed, it will install two more malicious apps: ADPage and NoIconUpdate. After downloading ADPage and NoIconUpdate’s IPA installer files, NoIcon did not use an HTTP server like the main app, but used iOS’s private APIs defined in private framework MobileInstallation to install them (Figure 17). More specifically, NoIcon invokes the MobileInstallationInstall methods implemented in the framework to install local IPA file. It also claimed the necessary private entitlement key “com.apple.private.mobileinstall.allowedSPI” which should only be used by system apps in iOS (Figure 18). Again, through enterprise distribution, YiSpecter successfully bypassed the App Store’s code review process that typically would prevent an app from using these private APIs.</p>
<p>Note that NoIcon, ADPage, and NoIconUpdate are signed with same enterprise certificate. Since user has accepted the provisioning profile when installing NoIcon, ADPage and NoIconUpdate can be installed in this way without any user notification.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter17.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10511" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter17-500x261.png" alt="YiSpecter17" width="500" height="261" /></a></p>
<p style="text-align: center;">Figure 17. NoIcon downloads ADPage&#8217;s IPA file and installs it</p>
<p style="text-align: center;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter18.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-10512" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter18.png" alt="YiSpecter18" width="461" height="385" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter18.png 461w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter18-300x251.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter18-370x309.png 370w" sizes="(max-width: 461px) 100vw, 461px" /></a></p>
<p style="text-align: center;">Figure 18. NoIcon has private entitlement for app installation</p>
<h4>Uninstalling Existing Apps</h4>
<p>NoIcon has another functionality called “fakeApps”. If it receives this command from the C2 server, it will uninstall the iOS app specified in the commands from current device (Figure 19). Then, it will install another downloaded app as a fake version to trick the user. This uninstallation operation is also implemented using a private API &#8212; the MobileInstallationUninstall defined in the MobileInstallation framework.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter19.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10514" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter19-500x341.png" alt="YiSpecter19" width="500" height="341" /></a></p>
<p style="text-align: center;">Figure 19. NoIcon uninstall specified app in fakeApps command</p>
<h4>Self Monitoring and Updating</h4>
<p>The NoIconUpdate will regularly check whether all these malicious components are installed, then connect with YiSpecter’s C2 server to check for updates. This is why some victims deleted the main app and NoIcon but the malware still remained on the phone.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter20.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10515" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter20-500x163.png" alt="YiSpecter20" width="500" height="163" /></a></p>
<p style="text-align: center;">Figure 20. NoIconUpdate checks installed components&#8217; version</p>
<p>Additionally, NoIconUpdate will regularly check whether NoIcon is running. If not, it will launch NoIcon immediately.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter21.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10516" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter21-500x171.png" alt="YiSpecter21" width="500" height="171" /></a></p>
<p style="text-align: center;">Figure 21. NoIconUpdate checks running status and launches NoIcon</p>
<h4>Hiding Icon in SpringBoard</h4>
<p>NoIcon, ADPage and NoIconUpdate use a trick to hide their icons from SpringBoard (the desktop in iOS.) In their Info.plist file, the “SBAppTags” key contains a value of “hidden” (Figure 22).  Any app with this characteristic will not be shown in SpringBoard, hence the user won’t see its icon and its name. This mechanism is used by some preinstalled apps for testing and diagnostics on the iOS system. In February 2015, an <a href="http://blog.fortinet.com/post/investigating-on-pawn-storm-for-iphone">iOS Spyware XAgent</a> (aka PawnStorm) also used this trick.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter22.png" rel="wpdevart_lightbox"><img class="aligncenter size-full wp-image-10517" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter22.png" alt="YiSpecter22" width="446" height="118" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter22.png 446w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter22-300x79.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter22-370x98.png 370w" sizes="(max-width: 446px) 100vw, 446px" /></a></p>
<p style="text-align: center;">Figure 22. Part of NoIcon&#8217;s Info.plist file</p>
<p>This icon hiding behavior is critical to YiSpecter’s success. Without being able to see the icon, users not only can’t discover these malicious apps, but also have no way to uninstall them (because uninstalling an iOS app requires the user to long click the app’s icon in SpringBoard). This behavior is likely why YiSpecter’s named the component “NoIcon.”</p>
<h4>Pretending to be System Apps</h4>
<p>Even though icons are hidden from the SpringBoard, YiSpecter’s author still has considered power users who may use third-party tools to manage iPhones or iPads. The author used special display app names and logos for these three apps to make them look like iOS system apps. The table below shows the display name and icon of three samples we analyzed. As far as we know, YiSpecter has pretended to be the Phone, Weather, Game Center, Passbook, Notes and Cydia apps. While this is a simple trick, it may be effective at fooling some users.</p>
<table width="684">
<tbody>
<tr>
<td width="132"><strong>Component</strong></td>
<td width="240"><strong>Bundle ID</strong></td>
<td width="174"><strong>Displayed App Name</strong></td>
<td width="138"><strong>Faked App Logo</strong></td>
</tr>
<tr>
<td width="132">NoIcon</td>
<td width="240">com.weiying.hiddenIconLaunch</td>
<td width="174">Passbook</td>
<td width="138"></td>
</tr>
<tr>
<td width="132">ADPage</td>
<td width="240">com.weiying.ad</td>
<td width="174">Cydia</td>
<td width="138"></td>
</tr>
<tr>
<td width="132">NoIconUpdate</td>
<td width="240">com.weiying.noiconupdate</td>
<td width="174">Game Center</td>
<td width="138"></td>
</tr>
</tbody>
</table>
<h4>Hijacking Other Apps Execution to Show Ads</h4>
<p>NoIcon will also regularly check which iOS app the user has open. This is implemented by using the private API function SBSCopyFrontmostApplicationDisplayIdentifier defined in the SpringBoardServices framework. NoIcon receives an allowlist of apps from C2 server and checks if the currently running app is on this list, which contains YiSpecter’s components and apps built by Apple. If the app isn’t in the list, NoIcon will launch the ADPage app by executing another private API function: SBSLaunchApplicationWithIdentifier.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter23.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10518" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter23-500x123.png" alt="YiSpecter23" width="500" height="123" /></a></p>
<p style="text-align: center;">Figure 23. NoIcon compares current running app with allowlist</p>
<p style="text-align: center;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter24.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10519" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter24-500x174.png" alt="YiSpecter24" width="500" height="174" /></a></p>
<p style="text-align: center;">Figure 24. NoIcon launch ADPage to cover other apps user interface</p>
<p>The launched ADPage will show a full screen with words “Cydia is detecting and protecting” in Chinese (Figure 25), then display some advertisements provided by third-party mobile ads platforms. Through this mechanism NoIcon and ADPage successfully hijacked other iOS apps’ execution and show its advertisements to victims. This is the most significant behavior reported by victims, as it is disruptive to their regular use of iOS devices.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter25.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10521" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter25-500x888.png" alt="YiSpecter25" width="500" height="888" /></a></p>
<p style="text-align: center;">Figure 25. ADPage&#8217;s full screen before displaying advertisement</p>
<h4>Changing Safari Configurations</h4>
<p>Another feature of NoIcon allows it to change Safari browser’s configurations on jailbroken devices by directly writing to local configuration and database files.</p>
<p>If NoIcon receives a specific command from the C2 server, it will enumerate all subdirectories in the “/var/mobile/Applications” directory to find a “Preferences/com.apple.mobilesafari.plist” file. Thus, it can identify the Safari app’s home directory.  It then modifies this plist file to change Safari’s default search engine to a specified one between Google, Bing, Yahoo and Baidu (Figure 26). However, in a nearby piece of code, we found that Baidu was specifically hard coded as target search engine in some situations (Figure 27).</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter26.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10522" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter26-500x272.png" alt="YiSpecter26" width="500" height="272" /></a></p>
<p style="text-align: center;">Figure 26. NoIcon locates Safari&#8217;s config file and change default search engine</p>
<p style="text-align: center;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter27.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10523" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter27-500x124.png" alt="YiSpecter27" width="500" height="124" /></a></p>
<p style="text-align: center;">Figure 27. NoIconHard-coded to change default search engine to Baidu</p>
<p>Additionally, NoIcon changes Safari’s bookmarks database to update all existing bookmark URLs to the URL that specified by C2 server. It will also write Safari’s SuspendStates.plist file to change all latest opened webpages’ URLs to the specified URL.</p>
<p>Note that all these behaviors also occurred according to victims’ reports posted in online forums.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter28.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10524" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter28-500x156.png" alt="YiSpecter28" width="500" height="156" /></a></p>
<p style="text-align: center;">Figure 28. Change URLs in all existing bookmarks</p>
<p style="text-align: center;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter29.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10525" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter29-500x371.png" alt="YiSpecter29" width="500" height="371" /></a></p>
<p style="text-align: center;">Figure 29. Change URLs in latest opened pages</p>
<h4>Collecting and Uploading Device Information</h4>
<p>All of the malicious YiSpecter apps collect some device information and upload it to the C2 server, including:</p>
<ul>
<li>A los of installed iOS apps; by invoking the private API MobileInstallationLookup;</li>
<li>A list of running processes by invoking sysctl;</li>
<li>The device UUID;</li>
<li>The device MAC address, by invoking sysctl.</li>
</ul>
<h3>Who’s Behind YiSpecter?</h3>
<p>There is a lot of evidences that suggests YiSpecter was developed by a company named “YingMob Interaction (微赢互动)”. For example, three of four components are signed by YingMob Interaction’s enterprise certificate. In the NoIconUpdate’s code, we even found a README.md which names the company in the app’s release notes. YiSpecter’s C2 server has hosted some websites belonging to YingMob. For example, if we directly visit the subdomain for YiSpecter’s downloading, qvod.bb800[.]com, we can find it’s an “WAP iOS Traffic Platform Backend Management System” with copyright information of YingMob Interaction.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter30.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10526" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter30-500x377.png" alt="YiSpecter30" width="500" height="377" /></a></p>
<p style="text-align: center;">Figure 30. README.md in the NoIconUpdate</p>
<p style="text-align: center;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter31.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10527" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter31-500x571.png" alt="YiSpecter31" width="500" height="571" /></a></p>
<p style="text-align: center;">Figure 31. YiSpecter&#8217;s C2 server page has YingMob Interaction&#8217;s copyright info</p>
<p style="text-align: center;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter32.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10528" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter32-500x369.png" alt="YiSpecter32" width="500" height="369" /></a></p>
<p style="text-align: center;">Figure 32. YingMob Interaction official website</p>
<p>YingMob Interaction’s <a href="http://www.yingmob.com">official website</a> shows it’s a Chinese mobile advertisement platform. In addition to YiSpecter we found the company also developed an iOS “helper” tool named “HaoYi Apple Helper(好易苹果助手)”. The tool was later renamed to “Fengniao Helper(蜂鸟助手)”. The tool’s website is <a href="http://zs.haoyi.com/">http://zs.haoyi.com/</a> but there’s another subdomain <a href="http://zs.od.bb800.com">http://zs.od.bb800.com</a> in YiSpecter’s C2 domain that is redirected to zs.haoyi.com. The helper tool says it can help users install all paid iOS apps in the App Store without jailbreaking, and it will give Apple IDs to users as presents to avoid registration in Apple. These functionalities are similar to what <a href="http://researchcenter.paloaltonetworks.com/2015/08/keyraider-ios-malware-steals-over-225000-apple-accounts-to-create-free-app-utopia/">the iOS Trojan KeyRaider</a> did earlier this year. Based on victims’ discussions, we found that YiSpecter will frequently ask users to install this helper tool.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter33.png" rel="wpdevart_lightbox"><img class="aligncenter size-large wp-image-10530" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2015/10/YiSpecter33-500x646.png" alt="YiSpecter33" width="500" height="646" /></a></p>
<p style="text-align: center;">Figure 33. Fengniao Helper developed by YingMob Interaction</p>
<h3>Relationship between YiSpecter and XcodeGhost</h3>
<p>In September 2015, we initially investigated <a href="http://researchcenter.paloaltonetworks.com/2015/09/novel-malware-xcodeghost-modifies-xcode-infects-apple-ios-apps-and-hits-app-store/">an OS X and iOS malware named XcodeGhost</a>. By infecting Xcode, this compiler malware was successfully <a href="http://researchcenter.paloaltonetworks.com/2015/09/more-details-on-the-xcodeghost-malware-and-affected-ios-apps/">compiled into thousands of iOS apps in the App Store</a> and affected hundred of millions users.</p>
<p>While YiSpecter and XcodeGhost both attacked non-jailbroken iOS devices, they are not related to each other. We believe that YiSpecter and XcodeGhost were developed by different attackers and there is no evidence of cooperation between the two developers so far.</p>
<p>However, from technical perspective, it’s still interesting to discuss potential connections between them.</p>
<p>First, we explained that <a href="http://researchcenter.paloaltonetworks.com/2015/09/update-xcodeghost-attacker-can-phish-passwords-and-open-urls-though-infected-apps/">XcodeGhost could be remotely controlled by attackers to open arbitrary URLs</a>, including opening a URL to ask a user to install any app signed by enterprise certificate. Hence, XcodeGhost could be another way to distribute malware like YiSpecter. In fact, not only XcodeGhost but also other legitimate iOS apps in the App Store can also do this.</p>
<p>Second, we explained that XcodeGhost collects system and app information and uploads it to its C2 server. People may be curious why the malware collects this data for. YiSpecter also exhibits this behavior but it also silently installs additional apps, which XcodeGhost does not.</p>
<p>In the underground ecosystem, when someone distributes apps for a fee they typically need some evidence to prove they were successful. For example, after YiSpecter silently installs other apps or games, the attacker could provide related devices and app information to paying developers in order to collect his or her fee. Given that XcodeGhost didn’t install other apps but uploaded that information by default, we suspect that XcodeGhost may have been scamming other underground distributors by collecting the evidence of installation but not actually performing it.</p>
<h3>Security Risks and Related Threats</h3>
<p>The world where only jailbroken iOS devices were threatened by malware is a thing of the past. WireLurker proved that non-jailbroken iOS devices can also be infected through abuse of the enterprise distribution mechanism. YiSpecter further shows us that this technique is being used to infect many iOS devices in the wild.</p>
<p>The key techniques deployed in YiSpecter are bypassing App Store reviews using enterprise distribution and abusing iOS private APIs to perform sensitive operations. This method has been discussed in some top academic conference papers in recent years (e.g., <a href="https://www.usenix.org/system/files/conference/usenixsecurity13/sec13-paper_wang-updated-8-23-13.pdf">Tielei Wang et al</a> in USENIX Security 2013, <a href="http://www.cse.cuhk.edu.hk/~cslui/PUBLICATION/ASIACCS15.pdf">Min Zheng et al</a> in AsiaCCS 2015, and <a href="http://www.cse.buffalo.edu/~mohaisen/classes/fall2015/cse709/docs/deng-ccs15.pdf">Zhui Deng et al</a> in CCS 2015.) However, YiSpecter is the first iOS malware in the wild that adopted this technique to launch a wide range attacks. This attack vector breaks Apple’s security mechanisms and is likely to be abused in future attacks.</p>
<p>For years <a href="http://www.macworld.com/article/1145044/private_apis.html">Apple has searched for privates APIs</a> used in apps submitted to the App Store and rejected the apps found using them. However, except for enterprise distribution, there’re still some ways to bypass this security check.</p>
<p>In the Objective-C language, invoking a method of an Objective-C object is not implemented through a virtual table as in C++. Objective-C uses a central message forwarding mechanism to handle method invoking where class name and method name are passed as string format parameters. Hence, a malware author can directly invoke the message forwarding functions such as <a href="https://developer.apple.com/library/ios/documentation/Cocoa/Reference/ObjCRuntimeRef/index.html#//apple_ref/c/func/objc_msgSend">objc_msgSend</a> with obfuscated or encrypted class name and method name strings to use private APIs. Apple’s code review is not strong enough hence apps using private APIs in this way will bypass their review and go to the App Store.</p>
<p>In fact, in one academic paper “<a href="http://www.cse.buffalo.edu/~mohaisen/classes/fall2015/cse709/docs/deng-ccs15.pdf">iRiS: Vetting Private API Abuse in iOS Applications</a>” in the coming ACM Conference on Computer and Communications Security (CCS 2015), researchers Zhui Deng et al from Purdue University successfully discovered 146 iOS apps from the App Store that abused 150 different private APIs including 25 APIs that are security critical. These occupied about 7 percent of all apps they analyzed. Note that they even found a third-party advertisement library that abused private APIs to collect private user information.</p>
<p>This observation is significant, because as a community, many of us have considered Apple’s code review on private APIs good enough and that abusing private APIs can only be successful if combined with enterprise distribution (like in the case of the YiSpecter.) Though this research, we now know that abusing private APIs in the iOS system could be an independent attack technique and could affect all iOS users.</p>
<h3>Prevention and Removal of YiSpecter</h3>
<p>Palo Alto Networks has released IPS signatures (<a href="https://threatvault.paloaltonetworks.com/Home/ThreatDetail/14861">14861</a>,<a href="https://threatvault.paloaltonetworks.com/Home/ThreatDetail/14862">14862</a>,<a href="https://threatvault.paloaltonetworks.com/Home/ThreatDetail/14863">14863</a>) via our Threat Prevention product to detect and block all malicious C2 traffic related to YiSpecter. We have also released signatures to detect the queries for the C2 domains used by the malware.</p>
<p>We have also reported the YiSpecter threat to Apple for them to revoke the abused enterprise certificates. (As noted above, the new iOS 9 requires users to manually set related provisioning profile as trusted in Settings before they can install Enterprise provisioned apps. This new feature is also helpful for preventing some security incidents caused by abusing enterprise certificates.)</p>
<p>For iOS users that are potentially infected by YiSpecter, we suggest removing it with the following steps:</p>
<ol>
<li>In iOS, go to Settings -&gt; General -&gt; Profiles to remove all unknown or untrusted profiles;</li>
<li>If there’s any installed apps named “情涩播放器”, “快播私密版” or “快播0”, delete them;</li>
<li>Use any third-party iOS management tool (e.g., iFunBox, though note that Apple’s iTunes doesn’t work in this step) on Windows or Mac OS X, to connect with your iPhone or iPad;</li>
<li>In the management tool, check all installed iOS apps; if there’re some apps have name like Phone, Weather, Game Center, Passbook, Notes, or Cydia, delete them. (Note that this step won’t affect original system apps but just delete faked malware.)</li>
</ol>
<p>Our primary security suggestion to avoid being affected by this kind iOS malware was, is and remains this: never download iOS apps from any untrusted sources, and never trust unknown developers. You should always download iOS apps from the official App Store for personal use, or download your company or organization’s internal app under your IT department’s guidance. Consider that even apps from the App Store can also abuse private APIs for harmful operations, and that these security habits won’t prevent all similar attacks but should prevent most of them. We have also made suggestions to Apple for improving their code review procedures and urged them to improve iOS security mechanisms to defeat these potential security problems.</p>
<h3>Appendix</h3>
<h4>Samples of YiSpecter</h4>
<p>57cc101ee4a9f306236d1d4fb5ccb3bb96fa76210142a5ec483a49321d2bd603  ADPage</p>
<p>4938b9861b7c55fbbe47d2ba04e9aff2da186e282f1e9ff0a15bbb22a5f6e0e7  ADPage.ipa</p>
<p>fc55c5ced1027b48885780c87980a286181d3639dfc97d03ebe04ec012a1b677  DaPian</p>
<p>5259854994945a165996d994e6484c1afc1c7e628cb5df2dc3750f4f9f92202e  DaPian.ipa</p>
<p>7714dbb85c5ebcd85cd1d93299479cff2cc82ad0ed11803c24c44106530d2e2f  HYQvod</p>
<p>ddd16577b458a5ec21ea0f57084033435a46f61dc5482f224c1fe54f47d295bc  HYQvod.ipa</p>
<p>8fa135fc74583e05be208752e8ce191060b1617447815a007efac78662b425d0  HYQvod_3.3.3</p>
<p>526e1dc893629c00c017fbe62b53392cb26bc6b15947e7b8b7df10a62f40cbad  HYQvod_3.3.3.ipa</p>
<p>41176825ba0627f61981280b27689a0c5cc6bfb310a408fa623515e6239b8647  NoIcon</p>
<p>98e9e65d6e674620eccaf3d024af1e7b736cc889e94a698685623d146d4fb15f  NoIcon.ipa</p>
<p>e7f071929a4304447cf638057d9499df9970b2a3d53d328a609f191a4bc29ffd  NoIconUpdate</p>
<p>8873908061f9c8d563de26fe6fa671080a90a2d60f795cc0664ef686e1162955  NoIconUpdate.ipa</p>
<h2>Samples in VirusTotal</h2>
<table width="145%">
<tbody>
<tr>
<td width="57%"><strong>SHA-256</strong></td>
<td width="19%"><strong>Filename</strong></td>
<td width="9%"><strong>Submit</strong></td>
<td width="13%"><strong>Detections</strong></td>
</tr>
<tr>
<td width="57%">382b88b654d7c5149ce8e9813accb86fd58eb1c01d66f730774f27a14d6af06c</td>
<td width="19%">HYQvod</td>
<td width="9%">11/18/14</td>
<td width="13%">1/55</td>
</tr>
<tr>
<td width="57%">0a106551b950d312c3847889cb233cbdaaebbc55fc2d7b6deb37f493079aa419</td>
<td width="19%">qj238_HYQvod_18.ipa</td>
<td width="9%">11/18/14</td>
<td width="13%">1/52</td>
</tr>
<tr>
<td width="57%">95c2b1fd5a9e0141e6c597771e832e6c6743713888bfad3d172c0180d650795b</td>
<td width="19%">qj238_HYQvod_14.ipa</td>
<td width="9%">1/26/15</td>
<td width="13%">1/56</td>
</tr>
<tr>
<td width="57%">487a442fa69be5fe701662976a2f9d16f7f1dc4b03d63b9a289a6395855b42d0</td>
<td width="19%">qvod2.4.0HYQvod_jx46.ipa</td>
<td width="9%">1/26/15</td>
<td width="13%">1/57</td>
</tr>
<tr>
<td width="57%">63b4ff014e74bd0a31b16393d145d1332e963b2e17f07396529793a4f0cf8b48</td>
<td width="19%">qiumama_HYQvod_jx69.ipa</td>
<td width="9%">2/5/15</td>
<td width="13%">1/56</td>
</tr>
<tr>
<td width="57%">fa8594384e119908ec4ea5e0af9597251f6de76a66c30682e36ca1f1d303c7a9</td>
<td width="19%">qiuchuanyi_HYQvod_jx48.ipa</td>
<td width="9%">2/26/15</td>
<td width="13%">1/57</td>
</tr>
<tr>
<td width="57%">f2a478eb2674b65d602204b2df8fc5e715e22596b039f235f9dfa27c03bbaa9b</td>
<td width="19%">1420683505536.ipa</td>
<td width="9%">2/26/15</td>
<td width="13%">1/57</td>
</tr>
<tr>
<td width="57%">ca59d78e9d23a737054b70385060346a8e6afc4948cd84f97826deb05168c279</td>
<td width="19%">20150113205442561.ipa</td>
<td width="9%">2/26/15</td>
<td width="13%">0/57</td>
</tr>
<tr>
<td width="57%">af338b0d35e532644850f9f5e00b6c67d6e08609cb9ef79d48e9f435f87366d0</td>
<td width="19%">qvod2.4.0HYQvod_6.ipa</td>
<td width="9%">2/26/15</td>
<td width="13%">1/57</td>
</tr>
<tr>
<td width="57%">17c89f5a579ecc3f97914a0fdd8ed1305a3682e09a719f91716607c3d63eabdf</td>
<td width="19%">qvod2.4.0HYQvod_5.ipa</td>
<td width="9%">2/26/15</td>
<td width="13%">1/57</td>
</tr>
<tr>
<td width="57%">0e75378d2ee5a7b90696dd67efa0d06d619f7f29021a7f056ff5a0fe881f8d6e</td>
<td width="19%">20150203141304735.ipa</td>
<td width="9%">2/26/15</td>
<td width="13%">0/57</td>
</tr>
<tr>
<td width="57%">55573153750d98938270d858ca220a4435ebcd1dac44388e5a59315e7811193c</td>
<td width="19%">DaPian</td>
<td width="9%">2/27/15</td>
<td width="13%">0/57</td>
</tr>
<tr>
<td width="57%">426f279a503a19d5c253621ad98f589d853270fd0a1ec54bf08ee55c1f647964</td>
<td width="19%">DaPian</td>
<td width="9%">2/27/15</td>
<td width="13%">0/57</td>
</tr>
<tr>
<td width="57%">f1e527fba122f91e79e790ba519c0d161cb4959bb1c89d6c20cf8a141ef8f854</td>
<td width="19%">HYQvod</td>
<td width="9%">4/20/15</td>
<td width="13%">1/57</td>
</tr>
<tr>
<td width="57%">bcb3d4a2960e76cc169bd80ff26c7973502ef11baf0d45d52534184f055003a1</td>
<td width="19%">HYQvod</td>
<td width="9%">4/20/15</td>
<td width="13%">1/56</td>
</tr>
<tr>
<td width="57%">5fd7b3994fc95cd72e2c76607ed00f260783e02b6fdf228e1e4616ca1e8702be</td>
<td width="19%">HYQvod</td>
<td width="9%">4/20/15</td>
<td width="13%">1/55</td>
</tr>
<tr>
<td width="57%">0771302f113d9c64fca3988a31020afa0767d3e1b66a2e74f819fd62b80b8a5e</td>
<td width="19%">HYQvod</td>
<td width="9%">4/20/15</td>
<td width="13%">1/57</td>
</tr>
<tr>
<td width="57%">1d5eea2236a2a44fe0ff4e17491c37f04ffa4a0af9a4b09ecc463089e3f48f14</td>
<td width="19%">kuaibozqb.3987.ipa</td>
<td width="9%">4/26/15</td>
<td width="13%">1/56</td>
</tr>
<tr>
<td width="57%">1d5eea2236a2a44fe0ff4e17491c37f04ffa4a0af9a4b09ecc463089e3f48f14</td>
<td width="19%">kuaibozqb.3987.ipa</td>
<td width="9%">5/12/15</td>
<td width="13%">1/57</td>
</tr>
<tr>
<td width="57%">3404bbf56d81da355636371f2e84b3b83ead7d78384c1627db67c4a59c275285</td>
<td width="19%">Unknown</td>
<td width="9%">6/29/15</td>
<td width="13%">0/56</td>
</tr>
<tr>
<td width="57%">04f69960b2e5fbd06f746e050c7a04e4ea9de67289fd82d3a85a92963aec387a</td>
<td width="19%">Unknown</td>
<td width="9%">6/29/15</td>
<td width="13%">0/56</td>
</tr>
<tr>
<td width="57%">363e58e1f489b6fade4975a54c02575e8832d95171b6b5646fd475d6a5f35ed9</td>
<td width="19%">HYQvod</td>
<td width="9%">7/25/15</td>
<td width="13%">0/56</td>
</tr>
<tr>
<td width="57%">ddd16577b458a5ec21ea0f57084033435a46f61dc5482f224c1fe54f47d295bc</td>
<td width="19%">1438074603284.ipa</td>
<td width="9%">8/18/15</td>
<td width="13%">1/56</td>
</tr>
</tbody>
</table>
<h3>Samples of Worm.Win32.Lingdun</h3>
<p>2771276596981c0ff189c27e6869b147c3c3665fd8b94b14d68695ea6ea3d09d  inst.exe</p>
<p>8d113243da8992220e73a2fd02ae28d209b326b191aeef95f3c8e223c1c6db96  leba99_setup_220041398.exe</p>
<p>9e538a58aed94a7748df9262ae0343dea9efce8d9117e0868eb404e1098747b6  u.exe</p>
<p>1607cf9625d7bf4ef39f8c1383fa0b1b1edcd13939d5d49fba5cdc14a73a2d95  ziyt.scr</p>
<p>6bd56dd4cc6a97912531fcb8d9f79f814fd45c9e97600f170646308868b1097b  亲情视频秀.exe</p>
<p>a8456f50c47b5248a93bcaebd05cb07bbf61527d5c7537767df1aaabb64bad95  天使嫩女视频全集.msi</p>
<h3>Acknowledgements</h3>
<p>Thanks CDSQ from WeipTech group for providing some samples of YiSpecter from an infected iPhone.</p>
<p>Thanks Josh Grunzweig and Bryan Lee from Palo Alto Networks for their suggestions on naming. (Finding a proper name is always so hard!)</p>
<p>Thanks Rongbo Shao and Zhaoyan Xu from Palo Alto Networks for their efforts in detecting the threat.</p>
<p>Thanks Ryan Olson from Palo Alto Networks for reviewing and revising this report.</p>
<p>&nbsp;</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
