
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>AceDeceiver: First iOS Trojan Exploiting Apple DRM Design Flaws to Infect Any iOS Device</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/acedeceiver-first-ios-trojan-exploiting-apple-drm-design-flaws-to-infect-any-ios-device/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/acedeceiver-first-ios-trojan-exploiting-apple-drm-design-flaws-to-infect-any-ios-device/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Unit 42 discovers AceDeceiver: the first iOS trojan exploiting Apple DRM design flaws to infect any iOS device."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/acedeceiver-first-ios-trojan-exploiting-apple-drm-design-flaws-to-infect-any-ios-device/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="AceDeceiver: First iOS Trojan Exploiting Apple DRM Design Flaws to Infect Any iOS Device" />
<meta property="og:description" content="Unit 42 discovers AceDeceiver: the first iOS trojan exploiting Apple DRM design flaws to infect any iOS device." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/acedeceiver-first-ios-trojan-exploiting-apple-drm-design-flaws-to-infect-any-ios-device/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="AceDeceiver" />
<meta property="article:tag" content="FairPlay" />
<meta property="article:tag" content="OS X" />
<meta property="article:tag" content="Trojan" />
<meta property="article:tag" content="ZergHelper" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2016-03-16T12:00:15+00:00" />
<meta property="og:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-1-1-500x244.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit 42 discovers AceDeceiver: the first iOS trojan exploiting Apple DRM design flaws to infect any iOS device." />
<meta name="twitter:title" content="AceDeceiver: First iOS Trojan Exploiting Apple DRM Design Flaws to Infect Any iOS Device" />
<meta name="twitter:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-1-1-500x244.png" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; AceDeceiver: First iOS Trojan Exploiting Apple DRM Design Flaws to Infect Any iOS Device Comments Feed" href="https://unit42.paloaltonetworks.com/acedeceiver-first-ios-trojan-exploiting-apple-drm-design-flaws-to-infect-any-ios-device/feed/" />
<meta property="og:likes" content="4"/>
<meta property="og:readtime" content="17"/>
<meta property="og:views" content="63,040"/>
<meta property="og:date_created" content="March 16, 2016 at 5:00 AM"/>
<meta property="og:post_length" content="4834"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Claud Xiao"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/claud-xiao/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"AceDeceiver: First iOS Trojan Exploiting Apple DRM Design Flaws to Infect Any iOS Device","name":"AceDeceiver: First iOS Trojan Exploiting Apple DRM Design Flaws to Infect Any iOS Device","description":"This post is also available in: \u65e5\u672c\u8a9e (Japanese)We\u2019ve discovered a new family of iOS malware that successfully infected non-jailbroken devices we\u2019ve named \u201cAceDeceiver\u201d. What makes AceDeceiver different from previous iOS malware is that instead of abusing enterprise certificates as some iOS malware has over the past two years, AceDeceiver manages to install itself without any...","url":"https:\/\/unit42.paloaltonetworks.com\/acedeceiver-first-ios-trojan-exploiting-apple-drm-design-flaws-to-infect-any-ios-device\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/acedeceiver-first-ios-trojan-exploiting-apple-drm-design-flaws-to-infect-any-ios-device\/","datePublished":"March 16, 2016","articleBody":"We\u2019ve discovered a new family of iOS malware that successfully infected non-jailbroken devices we\u2019ve named \u201cAceDeceiver\u201d.\n\nWhat makes AceDeceiver different from previous iOS malware is that instead of abusing enterprise certificates as some iOS malware has over the past two years, AceDeceiver manages to install itself without any enterprise certificate at all. It does so by exploiting design flaws in Apple\u2019s DRM mechanism, and even as Apple has removed AceDeceiver from App Store, it may still spread thanks to a novel attack vector.\n\nAceDeceiver is the first iOS malware we\u2019ve seen that abuses certain design flaws in Apple\u2019s DRM protection mechanism -- namely FairPlay -- to install malicious apps on iOS devices regardless of whether they are jailbroken. This technique is called \u201cFairPlay Man-In-The-Middle (MITM)\u201d and has been used since 2013 to spread pirated iOS apps, but this is the first time we\u2019ve seen it used to spread malware. (The FairPlay MITM attack technique was also presented at the USENIX Security Symposium in 2014; however, attacks using this technique are still occurring successfully.)\n\n\n\nApple allows users purchase and download iOS apps from their App Store through the iTunes client running in their computer. They then can use the computers to install the apps onto their iOS devices. iOS devices will request an authorization code for each app installed to prove the app was actually purchased. In the FairPlay MITM attack, attackers purchase an app from App Store then intercept and save the authorization code. They then developed PC software that simulates the iTunes client behaviors, and tricks iOS devices to believe the app was purchased by victim. Therefore, the user can install apps they never actually paid for, and the creator of the software can install potentially malicious apps without the user\u2019s knowledge.\n\n\nFigure 1 FairPlay MITM attack procedures\nThree different iOS apps in the AceDeceiver family were uploaded to the official App Store between July 2015 and February 2016, and all of them claimed to be wallpaper apps. These apps successfully bypassed Apple\u2019s code review at least seven times (including the first time each was uploaded and then four rounds of code updates, which require an additional review by Apple for each instance) using a method similar to that used by ZergHelper, where the app tailors its behavior based on the physical geographic region in which it\u2019s being executed. In this case, AceDeceiver only displays malicious behaviors when a user is located in China, but that would be easy for the attacker to change in any time. Apple removed these three apps from the App Store after we reported them in late February 2016. However, the attack is still viable because the FairPlay MITM attack only requires these apps to have been available in the App Store once. As long as an attacker could get a copy of authorization from Apple, the attack doesn\u2019t require current App Store availability to spread those apps.\n\nTo carry out the attack, the author created a Windows client called \u201d\u7231\u601d\u52a9\u624b (Aisi Helper)\u201d to perform the FairPlay MITM attack. Aisi Helper purports to be software that provides services for iOS devices such as system re-installation, jailbreaking, system backup, device management and system cleaning. But what it\u2019s also doing is surreptitiously installing the malicious apps on any iOS device that is connected to the PC on which Aisi Helper is installed. (Of note, only the most recent app is installed on the iOS device(s) at the time of infection, not all three at the same time.) These malicious iOS apps provide a connection to a third party app store controlled by the author for user to download iOS apps or games. It encourages users to input their Apple IDs and passwords for more features, and provided these credentials will be uploaded to AceDeceiver\u2019s C2 server after being encrypted. We also identified some earlier versions of AceDeceiver that had enterprise certificates dated March 2015.\n\nAs of this writing, it looks as though AceDeceiver only affects users in mainland China. The bigger issue, however, is that AceDeceiver is evidence of another relatively easy way for malware to infect non-jailbroken iOS devices. As a result, it\u2019s likely we\u2019ll see this start to affect more regions around the world, whether by these attackers or others who copy the attack technique. In addition, the new attack technique is more dangerous than previous ones for the following reasons:\n\n\tIt doesn\u2019t require an enterprise certificate, hence this kind of malware is not under MDM solutions\u2019 control, and its execution doesn\u2019t need user\u2019s confirmation of trusting anymore.\n\tIt hasn\u2019t been patched and even when it is, it\u2019s likely the attack would still work on older versions of iOS systems.\n\tEven though these apps have been removed from the App Store, that doesn\u2019t affect the attack. Attackers do not need the malicious apps to be always available in App Store for them to spread \u2013 they only require the apps ever available in App Store once, and require the user to install the client to his or her PC. However, ZergHelper and AceDeceiver have shown how easy it can be to bypass Apple\u2019s code review process and get malicious apps into the App Store.\n\tThe attack doesn\u2019t require victims to manually install the malicious apps; instead, it does that for them. That\u2019s why they can be only available in a few regions\u2019 App Store without affecting the success of the attack. This also makes them much harder to be discovered by Apple or by security firms researching iOS vulnerabilities.\n\tWhile the attack requires a user\u2019s PC to be infected by malware first, after that, the infection of iOS devices is completed in the background without the user\u2019s awareness. The only indication is that the new malicious app does appear as an icon in the user\u2019s home screen, so the user may notice a new app he or she won\u2019t recall downloading.\n\nOur analysis of AceDeceiver leads us to believe FairPlay MITM attack will become another popular attack vector for non-jailbroken iOS devices \u2013 and thus a threat to Apple device users worldwide. Palo Alto Networks has released IPS signatures (38914, 38915) and has updated URL filtering and Threat Prevention to protect customers from the AceDeceiver Trojan as well as the FairPlay MITM attack technique.\n\nIn the rest of this blog we will take a detailed look at AceDeceiver\u2019s method of spreading, attacking, and implementation. We will also cover how the FairPlay MITM attack works and discuss the security flaws in Apple\u2019s DRM technology.\nTimeline of the Threat\nJan 2013: FairPlay MITM attack has been used in the wild to spread pirated iOS apps.\n\nAug 2014: Researchers published paper to describe FairPlay MITM attack in the 23rd USENIX Security Symposium\n\nMar 26, 2015: AceDeceiver\u2019s enterprise certificate signed iOS apps added password stealing functionality. These apps were embedded into Aisi Helper Windows clients.\n\nJul 10, 2015: AceDeceiver\u2019s iOS app \u201c\u7231\u601d\u52a9\u624b\u201d was available in HK and NZ App Store\n\nJul 24, 2015: Aisi Helper Windows client updated to embed its App Store version iOS app\n\nNov 7, 2015: AceDeceiver\u2019s iOS app \u201cAS Wallpaper\u201d was available in US App Store\n\nJan 30, 2016: AceDeceiver\u2019s iOS app \u201ci4picture\u201d was available in US and UK App Store\n\nFeb 21, 2016: Palo Alto Networks published report on ZergHelper\n\nFeb 24, 2016: Palo Alto Networks reported the AceDeceiver issue to Apple\n\nFeb 25, 2016: AceDeceiver apps were removed from App Store\n\nFeb 26, 2016: Palo Alto Networks reported the FairPlay MITM attack issue in AceDeceiver to Apple\nBackground of AceDeceiver\nThe AceDeceiver Trojan exists in a product named \u201c\u7231\u601d\u52a9\u624b (Aisi Helper)\u201d that was developed by a company located in Shenzhen, China. AceDeceiver\u2019s C2 server also shares the same domain name with the product\u2019s official website, www.i4[.]cn. The Trojan also used third-level URLs in this domain for downloading and updating.\n\n\nFigure 2 Official website of Aisi Helper\nAisi Helper is a software program for Windows systems that claims to provide services for iOS devices such as system re-installation, jailbreaking, system backup, device management, system cleaning. When installed on a user\u2019s iOS device that is located in mainland China, it also provides access to a third-party App Store controlled by the attackers that could be used to install additional iOS apps or games to either jailbroken or non-jailbroken devices. Most of the iOS apps they provided appear to be pirated versions. Interestingly, according to ITJuzi, a Chinese business profiling website, Aisi Helper was initially released in January 2014 and at the time did not exhibit any malicious functionality. As of December 2014, it had accumulated over 15 million users and had over 6.6 million monthly active users. The malicious functionality doesn\u2019t appear to have been added until 2015.\n\nWhen a user accesses the official website from a computer, it prompts the user to install Aisi Helper\u2019s PC client, regardless of the actual operating system running on the computer. Once installed, the PC client will automatically install the most recent malicious iOS app to any connected iOS device. However, if a user accesses the website from an iPhone or an iPad, the browser will be redirected to the site\u2019s mobile version (m.i4[.]cn) and an enterprise certificate signed version of its iOS client will be recommended. During our investigation in February 2016, all Aisi Helper Windows or iOS clients downloaded from the official website contained the AceDeceiver Trojan.\n\nGiven what we now know about the functionality of AceDeceiver, the website\u2019s legal announcement seems a bit suspicious. Section 7 says that \u201cour website is not responsible for any personal data leakage, loss, theft, modification, etc. that happens as a result of a hacker's attack, computer virus intrusion, or other attack ...\u201d\n\n\nFigure 3 The product claims it doesn't responsible for personal data leakage or loss\n\nAceDeceiver Landed in the App Store Many Times\nWe found three iOS apps in the AceDeceiver family that successfully landed in the official App Store. The first app was released to the public on July 10, 2015, the second on November 7, 2015, and the third on January 30, 2016. All of them were designed to appear as legitimate wallpaper apps and each has a different name in the App Store, a different bundle identifier, and uses different developer accounts.\n\n\nFigure 4 The third malicious app of the AceDeceiver family in the App Store\n\n\n\n\nName in App Store\nVersions\nBundle ID\nRelease Date\nStores\nDeveloper\n\n\n\u58c1\u7eb8\u52a9\u624b\n6.0.x\ncom.aisi.aisiring\n2015-07-10\nHK, NZ\nfangwen huang\n\n\nAS Wallpaper\n7.0.x\ncom.aswallpaper.mito\n2015-11-07\nUS\nYuzu He\n\n\ni4picture\n7.1.x\ncom.i4.picture\n2016-01-30\nUS, UK\nliu xiaolong\n\n\n\nTable 1 Information of the three AceDeceiver apps in App Store\nNormally, Apple does a code review on all apps the first time they are submitted for inclusion in the App Store. After being released, if the developer wants to make an update to the existing iOS app, Apple requires another round of code review for the newer version. To date, we\u2019ve found that all of these apps were updated after they were accepted by the App Store. Which means, AceDeceiver successfully bypassed Apple\u2019s code review seven times.\n\n\nFigure 5 User interface for users outside of China\nWhen these apps are launched, before they show the first screen of the user interface, they will access the URL tool.verify.i4[.]cn\/toolCheck.xhtml, which is AceDeceiver\u2019s C2 server. If the URL returns \u201c0\u201d, the whole user interface of the attacker\u2019s third party app store will be shown. However, if the URL returns \u201c1\u201d or anything else but 0, the user will just be shown a wallpaper app interface, as seen in Figure 5.\nFigure 6 iOS apps access C2 to determine which user interface to show\n\nFigure 7 iOS app initial beacon to the C2\nWhen we analyzed these apps in February, this C2 would only return \u201c0\u201d if the device had an IP address from mainland China. If that wasn\u2019t part of how the apps evaded Apple\u2019s code review, it\u2019s also possible the attacker set the server to always return \u201c1\u201d when they knew the apps were under review, so that no matter where Apple\u2019s reviewers are located they would always just get some beautiful-looking picture in a wallpaper app user interface.\n\nIn addition to the location trick, AceDeceiver also made some more effort to ensure it wouldn\u2019t be discovered.\n\nFirst, the attacker chose to only submit these apps to a App Stores in select regions. Apple provides App Store services for 155 different regions around the world. Users usually can only choose to download from their local App Store, and they can\u2019t install apps that aren\u2019t available in their region. The aforementioned ZergHelper\u2019s author chose to submit it for all 155 regions, but AceDeceiver\u2019s did not. For example, the third app, \u201ci4picture\u201d, was only available in the App Store for the United States and United Kingdom when we investigated it. Because of this distribution strategy, the author likely guessed that Apple would not review the app from China. It also significantly reduced the chance that the app would be discovered by security researchers, because if anyone downloaded this from the App Store, they\u2019re generally located in a region where the malicious functions won\u2019t take place.\n\nSecond, besides different user interfaces based on IP address, according to our testing, AceDeceiver will remember a device through the information it has collected. These apps will upload a device\u2019s unique ID to the C2 server. If a device is ever used from outside of China, even if it later changed back to a mainland Chinese IP address, the malicious functionalities will still be hidden.\n\nThird, these apps will also show different names in different situations. For example, the version 6.0.4 used the same trick as ZergHelper in that, in the App Store\u2019s webpage, its name was \u201c\u58c1\u7eb8\u52a9\u624b(Wallpaper Helper)\u201d; while in iOS devices its name will become \u201c\u7231\u601d\u52a9\u624b(Aisi Helper)\u201d. We found these name differences by checking the IPA file\u2019s iTunesMetadata.plist. Later, in version 7.1.2, the app has the name \u201c\u7231\u601d\u52a9\u624b(Aisi Helper)\u201d for iOS devices that use short-form Chinese language settings, while for all other devices its name was just \u201ci4picture\u201d.\n\n\nFigure 8 Different names in iOS devices and in App Store pages\n\nFigure 9 Different names in devices using different languages\n\nThe FairPlay Man-In-The-Middle Attack\nWhen we were investigating AceDeceiver, the strangest part was that this malware\u2019s apps were not available in App Store for mainland China and yet its malicious functionalities only target users in that region. This helped us to discover its exploitation of FairPlay MITM attack. Through the attack, these apps could be installed on iOS devices in a way not needing the App Store.\n\nFigure 10 Authorize a computer in iTunes\nFairPlay is a digital rights management (DRM) technology created by Apple many years ago to protect songs for use via iTunes and on iPods. Based on the DRM, Apple users can download iOS apps to their PCs or Macs through iTunes software, and then install these apps from their computers to their devices. Before the installation, users have to \u201cauthorize the computer\u201d with the same Apple ID used to buy those apps. Apple restricted each Apple ID to only be used to authorize at most five computers. This process is what the attackers figured out how to abuse.\n\nDuring an app\u2019s installation, a key step in the authorization procedures is that the connected iPhone or iPad will send afsync.rq and afsync.rq.sig files to the computer, and the iTunes software on the computer should send correct afsync.rs and afsync.rs.sig files as response back to the iOS device. Only if the responded afsync.rs are correct can the iOS device install the app and decrypt its DRM protection (The real protocol is more complex than our description here; we have simplified it for sake of argument.)\n\n\nFigure 11 Normal authorization procedures during app installation\nHowever, this procedure has some design flaws.\n\nFirst, Apple only restricts the computer that should be authorized by the Apple ID that was used to purchase the iOS apps. There isn\u2019t any limitation about how many iOS devices those apps can be installed on.\n\nSecond, Apple allows the Apple ID being used to purchase apps to differ from the Apple ID that is actually used by the iOS devices.\n\nThird, the DRM protecting apps\u2019 installer files (IPA files) will always be the same no matter which computers it will be downloaded to, and no matter which Apple ID was used to purchase them.\n\nOverall, the problem is this: the FairPlay DRM protection is only relevant with the app itself, but is irrelevant respective to Apple ID, and is irrelevant respective to iOS device. Apple designed the protection mechanism in such a way that its security relies on computer authorization and physical connection between the computer and the device in question.\n\nThese design flaws allowed the FairPlay MITM attack. In such an attack, the attacker can authorize a computer, then purchase an iOS app from App Store (in any region) so that they could generate the correct afsync.rs response. Then, the attacker can deploy this afsync.rs as a service on the C2 server. Now, they can create client software for PC or for Mac. The client software simulates iTunes\u2019s functionalities that it connects with the iOS device and installs the iOS app. When the client received the afsync.rq from the iOS device, it could upload the file to C2 server, then get a correct afsync.rs response from C2 server, and send this response to iOS device.\n\nBy deploying authorized computer in the C2 server, and using a client software as agent in the middle, the attacker can distribute that purchased iOS app to unlimited iOS devices.\n\nFigure 12 Authorization procedures in a FairPlay MITM attack\nIt\u2019s not easy to implement FairPlay MITM attacks considering that the attacker needs to reverse the iTunes client to know the proprietary protocols\/algorithms employed by Apple. Even so, in January 2013, some media reported that this attack technique had been used in the wild to distribute pirated iOS apps. In August 2014, Tielei Wang and others from Georgia Institute of Technology published a paper, \u201cOn the Feasibility of Large-Scale Infections of iOS Devices,\u201d and presented at the 23rd USENIX Security Symposium. The paper described the attack in detail, demonstrated the attack by a proof-of-concept experiment, and evaluated how this attack approach could be used in a wide range.\n\nThree years since the January 2013 reporting, as we\u2019re analyzing AceDeceiver, we have realized Apple still hasn\u2019t fixed this complex problem. What\u2019s more, iOS devices in current and older versions may still be vulnerable the same attack.\nHow AceDeceiver Used FairPlay MITM Attack\nIn our investigation, which covered Aisi Helper Windows client\u2019s version 5.38 to the newest available version (6.15), we found the clients to contain App Store versions of AceDeceiver iOS IPA file under path \u201cfiles\/i4\/60.ipa\u201d. According to the updating logs on the official Aisi Helper website, version 5.38 was released July 24, 2015. That is just 14 days after the first of the three questionable iOS apps was available in App Store. Some more versions of the Windows client also contained a \u201cfiles\/i4\/i4.ipa\u201d which indicates enterprise certificates signed AceDeceiver iOS apps.\n\nAfter installed the Windows client, when users connect iOS devices to their their PCs and launched the client, the embedded AceDeceiver app will be automatically installed on the devices using the FairPlay MITM attack. This does not require user confirmation. In its user interface, a progress bar will be shown with a message \u201cInstalling Aisi Helper\u2026\u201d but there isn\u2019t any option to stop it or cancel it.\n\nFigure 13 Aisi Helper Windows client automatically instalsl the Trojan app\nOur analysis below is based on the version 6.12 of the Windows client. The installer was downloaded from http:\/\/d.app6.i4[.]cn\/i4tools\/v6\/i4tools_v6.12_Setup.exe in Feb 24, 2016. Its SHA-256 value is ad313d8e65e72a790332280701bc2c2d68a12efbeba1b97ce3dde62abbb81c97.\n\nAfter the Windows client is installed, in its i4Tools.exe file, function sub_4A9530 is responsible for implementing the installation and exploitation. It invokes function sub_4A8CE0 to install the IPA file, and then invokes function auth to perform FairPlay MITM.\n\nFunction sub_4A8CE0 reads the IPA file stored in \\files\\i4\\60.ipa, and then invokes am_install_app. The am_install_app function is implemented in i4m.dll file. It communicates with the com.apple.mobile.installation_proxy service to install the IPA file on the iOS device. This is a very classic method.\n\n\nFigure 14 Install the IPA file to iOS device\nThen, sub_4A9530 will invoke function auth which is also implemented in i4m.dll.\n\n\nFigure 15 Invoke function auth with C2 URL for FairPlay MITM\nThe function auth implements the FairPlay MITM attack. It receives \/AirFair\/sync\/afsync.rq from the connected iOS device, sends the file to C2 server auth3.i4[.]cn by HTTP POST (implemented in function sub_10005DB0), receives the afsync.rs from C2 server, and then sends this response back to the iOS device\u2019s \/AirFair\/sync\/afsync.rs.\n\n&nbsp;\n\n\nFigure 16 Auth function read afsync.rq file\n\nFigure 17 Send the afsync.rq to C2 server via libcurl\n\nFigure 18 Traffic of sending afsync.rq file\n\nFigure 19 Copy the afsync.rs back to iOS\n\nStealing Apple IDs and Passwords\nThe iOS apps of AceDeceiver mainly act as a third party app store if users access them from China. Note that some of the apps or games they provide in the store are also installed through a FairPlay MITM attack. In addition, these apps strongly suggest users input their Apple ID with password so that users could \u201cdirectly install free apps from the App Store, execute in-app purchase, and login to Game Center.\u201d\n\nIn the interface to input the Apple ID and password, AceDeciver provided buttons for \u201cInstructions\u201d and \u201cDisclaimer\u201d. In all these documents, they claimed they will never send the passwords to their server, but will just store them in the local device after encryption. However, we can demonstrate that this is not true. Of note, the last section of the Disclaimer also indicates that if there\u2019s any abnormal activity related to a user\u2019s Apple ID, Aisi Helper doesn\u2019t take any responsibility for it.\n\nFigure 20 iOS apps' interfaces of installing apps and input Apple ID\n\nFigure 21 Instruction and Disclaimer of Inputing Apple ID\nIn fact, we discovered all versions of AceDeceiver will upload the Apple ID and password to the C2 server. In these iOS apps, after a user inputs any Apple ID with password, the app will invoke the [LoginEntity getLoginAppleId:withPassword:block:] method to get the Apple ID and the password from interface, then invoke [UserInfo initAppleId:WithPassword]. In this method, the Apple ID and password will be encrypted by RC4 algorithm with a fixed key. The key value is itself pretty interesting:\n\n\ti4.cn\/forum.php?mod=viewthread&amp;tid=m&amp;fromuid=n\n\n\nFigure 22 Apple ID and password are encrypted by RC4 algorithm\nAfter encrypting, the Apple ID and password will be encoded by Base64 following by URL encoding, and then be set as properties appleId_RC4 and password_RC4 of an LoginEntity instance. Now [LoginEntity getLoginInfo] will be invoked. In this method, the encrypted Apple ID and password will be sent back to AceDeceiver\u2019s C2 server by URL \u201chttp:\/\/buy.app.i4[.]cn\u201d.\n\nFigure 23 The encrypted Apple ID and password are sent to C2 server\nDuring analysis, we input an invalid Apple ID: username \u201cexample@example.com\u201d with the password \u201cexample123\u201d. Through network traffic we can see below this credential was sent to and was received by the server (since it responded HTTP 200).\n\n\nFigure 24 Traffic of uploading Apple ID and password\n\nMitigate the Risk\nAll three Trojan apps of AceDeceiver were removed by Apple from App Store as of late February 2016. But even with their removal, the Aisi Helper Windows client can still install these apps to non-jailbroken iOS devices using a FairPlay MITM attack. We also reported older enterprise certificates signed versions of AceDeceiver apps to Apple. All of those known abused enterprise certificates have also since been revoked.\n\nWe suggest users who installed Aisi Helper\u2019s Windows client or iOS apps after March 2015 to remove these software and apps immediately, as well as change their Apple ID passwords. We also suggest all iOS users to enable two-factor authentication for their Apple IDs.\n\nFor enterprises, we suggest to check whether there\u2019s any iOS app installed to managed Apple devices by these bundle identifiers:\n\n\taisi.aisiring\n\taswallpaper.mito\n\ti4.picture\n\nSince AceDeceiver also spreads via enterprise certificates, we suggest that enterprises check for unknown or abnormal provision profiles as well.\n\nUntil now all known malicious traffic comes from or goes to subdomains under i4[.]cn. Enterprises could also check traffic by this domain to identify potential traffic of AceDeceiver.\nConclusion\nAceDeceiver shows yet another way attackers are getting around Apple\u2019s security measures to install malicious apps, particularly on non-jailbroken devices. Mobile is a huge growth area for malicious attackers and while Android devices have gotten the most attention for a few years now, attackers are turning increasingly to iOS devices because they are so widely popular. As of this writing, AceDeceiver is only targeting iOS devices in mainland China, but attackers could easily expand this attack to other regions around the world. And as we\u2019ve already noted, the attack technique they\u2019re exploiting will not be easy for Apple to fix.\n\nPalo Alto Networks has released a IPS signature (38915) to block AceDeceiver family\u2019s C2 traffic. The related C2 URLs are also marked as malicious by URL filtering and Threat Prevention. Palo Alto Networks WildFire recognizes all Windows clients of Aisi Helper as malicious.\n\nPalo Alto Networks has also released another IPS signature (38914) to cover the FairPlay MITM attack.\nAcknowledgements\nWe greatly thank Jen Miller-Osborn and Chad Berndtson from Palo Alto Networks for their assistance in developing this report. We also would like to thank Yi Ren, Tyler Halfpop, Yuchen Zhou and Rongbo Shao from Palo Alto Networks for their works to protect our customers from the threat.\nIOCs\nTrojan.Win32.AceDeceiver\n\nad313d8e65e72a790332280701bc2c2d68a12efbeba1b97ce3dde62abbb81c97 i4Tools_v6.12_setup.exe\n\n9231166a2114f6b1c2d6cd6a57b5836e919ee5739d8868f07425d3c22697894e i4Tools.exe\n\n78a2cdade1b0715e4f3f372e86724ee10e241ad8821c6b8caa3e84fd7e78ba7e i4m.dll\n\nTrojan.iOS.AceDeceiver (App Store version, FairPlay DRM protected)\n\n5894742146c02ba8af5390c91e4f0d2e5ad6cfaa2b916945ebb4fad633b054e3 601.ipa\n\nba07f252801120b081c45a173fb1a205fea763ed827f05fb9beb5150ae297ccb 60.ipa\n\nf7e50fdc4f20f0d25771a694eb3f3643c1842e3b14f06aaa5e8d9dab1c1851e9 60.ipa\n\nca115f8a3751e4c0fc36b001e3c74d3ac167360a4a44fd1b373b25487de05820 60.ipa\n\n3e02b30a6a920a5bdc139270b1e731a4a8d7ab313e9c8d9af9fec611710b4d09 60.ipa\n\n006c539fa6251e1d2142631c52d7c112bf5027335696eacd64794b8cf357d6d5 60.ipa\n\nfbc26c14a3ff609332644f5d9702f07ace024961b7aa2c531df2715911b1c57d bf03_710.ipa\n\nTrojan.iOS.AceDeceiver (App Store version, FairPlay DRM stripped)\n\nbc82efce99f149441a2fd730a961a0f7da58dd6c9c3b45597f5571f227a52309 com.i4.picture.ipa\n\nad7cfc29b0a9b6ade878d01084c68d0bbcde699e142652b00132317c04bcf730 aisiweb\n\nTrojan.iOS.AceDeceiver (enterprise certificate signed versions)\n\n0a8e29bd8fe0f5d4d6a8677454b1d01e97478dc4bc3666eaab6bbbf2f2e759bc\n\n1b6cf5abe2bd3d5bb84da8debd5ec563393d30995ce4afc6142dc3381ac69902\n\n352d1af3a5cef417dda688be2dd35c3f59841ea56c393a07f95a0bc5ab576448\n\n5bc7ceb48ca4951997d50425d5b34484505e4444a3e172ab846b2595104b7138\n\n5bebcacfb5c541bd6ba7530aeb2971c20adb1beddb244e4367d40cd87bfc826d\n\n63e3cc1d00abef8ad6c2029e7f9a4831ec4c48682979a7385a940fb73cfc03a6\n\n821f93bae8c067af71626ca84cdc20226df61c4c371e5eb6423d9439c8b8c25d\n\n86b8065d40c24e3702ed848ec28650b074a577f677375c094ed61a2efffce11b\n\n9a4a40625efcc6f4de419db0bec9fbdfdc379918a95fba572ee56cffc13cd074\n\na504d47fdfa630bc1c474cdbdaf0dd82a46a08e5d662ecc1bffc57f3c409690e\n\nbaa255dd7a0e52edf6e4f3082a6840800898969a3d17f2bcb6a88d0a94c5b795\n\nbc5e3be07e65f25479cee7de8615b386c489c1253659ed7ca5526f86f5116374\n\nc41e3abd97e16b3d9514583eef613105006d69dffb2231badfd500d29eb113bc\n\nd879c6d96463b81e4f2085a565418c99b559a8803ca449442464a2b6cd728d97\n\nf6cabdc408e12912c07097c9956ceda2f7033e88c2ca59d7618b9256d3724f5c\n\nC2 Domains\n\n\ttool.verify.i4[.]cn\n\tauth3.i4[.]cn\n\tbuy.app.i4[.]cn\n","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"","width":"","height":""},"author":[{"@type":"Person","name":"Claud Xiao"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"12714","token":"7e15a0f8b3","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=12714' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Facedeceiver-first-ios-trojan-exploiting-apple-drm-design-flaws-to-infect-any-ios-device%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Facedeceiver-first-ios-trojan-exploiting-apple-drm-design-flaws-to-infect-any-ios-device%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-12714 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">AceDeceiver: First iOS Trojan Exploiting Apple DRM Design Flaws to Infect Any iOS Device</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-12714 entry-meta">
			
			
			<span class="post-views-count">63,040</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'12714','like')"><i class="ui ui-2"></i><span class="ml-5">4</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 17</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Facedeceiver-first-ios-trojan-exploiting-apple-drm-design-flaws-to-infect-any-ios-device%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Facedeceiver-first-ios-trojan-exploiting-apple-drm-design-flaws-to-infect-any-ios-device%2F+-+AceDeceiver%3A+First+iOS+Trojan+Exploiting+Apple+DRM+Design+Flaws+to+Infect+Any+iOS+Device" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Facedeceiver-first-ios-trojan-exploiting-apple-drm-design-flaws-to-infect-any-ios-device%2F&title=AceDeceiver%3A+First+iOS+Trojan+Exploiting+Apple+DRM+Design+Flaws+to+Infect+Any+iOS+Device&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/acedeceiver-first-ios-trojan-exploiting-apple-drm-design-flaws-to-infect-any-ios-device/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/claud-xiao/" title="Posts by Claud Xiao" class="author url fn" rel="author">Claud Xiao</a>        </p>
        <p><time datetime="2016-03-16T12:00:15+00:00">March 16, 2016 at 5:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/acedeceiver/" rel="tag">AceDeceiver</a>, <a href="https://unit42.paloaltonetworks.com/tag/fairplay/" rel="tag">FairPlay</a>, <a href="https://unit42.paloaltonetworks.com/tag/os-x/" rel="tag">OS X</a>, <a href="https://unit42.paloaltonetworks.com/tag/trojan/" rel="tag">Trojan</a>, <a href="https://unit42.paloaltonetworks.com/tag/zerghelper/" rel="tag">ZergHelper</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/acedeceiver-first-ios-trojan-exploiting-apple-drm-design-flaws-to-infect-any-ios-device/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><p>We’ve discovered a new family of iOS malware that successfully infected non-jailbroken devices we’ve named “AceDeceiver”.</p>
<p>What makes AceDeceiver different from previous iOS malware is that instead of abusing enterprise certificates as some iOS malware has over the past two years, AceDeceiver manages to install itself without any enterprise certificate at all. It does so by exploiting design flaws in Apple’s DRM mechanism, and even as Apple has removed AceDeceiver from App Store, it may still spread thanks to a novel attack vector.</p>
<p>AceDeceiver is the first iOS malware we’ve seen that abuses certain design flaws in Apple’s DRM protection mechanism &#8212; namely FairPlay &#8212; to install malicious apps on iOS devices regardless of whether they are jailbroken. This technique is called “FairPlay Man-In-The-Middle (MITM)” and has been used since 2013 to spread pirated iOS apps, but this is the first time we’ve seen it used to spread malware. (The FairPlay MITM attack technique was also presented at the USENIX Security Symposium in 2014; however, attacks using this technique are still occurring successfully.)</p>
<p><span id="more-12714"></span></p>
<p>Apple allows users purchase and download iOS apps from their App Store through the iTunes client running in their computer. They then can use the computers to install the apps onto their iOS devices. iOS devices will request an authorization code for each app installed to prove the app was actually purchased. In the FairPlay MITM attack, attackers purchase an app from App Store then intercept and save the authorization code. They then developed PC software that simulates the iTunes client behaviors, and tricks iOS devices to believe the app was purchased by victim. Therefore, the user can install apps they never actually paid for, and the creator of the software can install potentially malicious apps without the user’s knowledge.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-1-1.png"  rel="wpdevart_lightbox attachment wp-att-12765" ><img class="aligncenter size-large wp-image-12765" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-1-1-500x244.png" alt="AceDeceiver 1" width="500" height="244" /></a></p>
<p style="text-align: center;"><em>Figure 1 FairPlay MITM attack procedures</em></p>
<p>Three different iOS apps in the AceDeceiver family were uploaded to the official App Store between July 2015 and February 2016, and all of them claimed to be wallpaper apps. These apps successfully bypassed Apple’s code review at least seven times (including the first time each was uploaded and then four rounds of code updates, which require an additional review by Apple for each instance) using a method similar to that used by<a href="http://researchcenter.paloaltonetworks.com/2016/02/pirated-ios-app-stores-client-successfully-evaded-apple-ios-code-review/"> ZergHelper</a>, where the app tailors its behavior based on the physical geographic region in which it’s being executed. In this case, AceDeceiver only displays malicious behaviors when a user is located in China, but that would be easy for the attacker to change in any time. Apple removed these three apps from the App Store after we reported them in late February 2016. However, the attack is still viable because the FairPlay MITM attack only requires these apps to have been available in the App Store once. As long as an attacker could get a copy of authorization from Apple, the attack doesn’t require current App Store availability to spread those apps.</p>
<p>To carry out the attack, the author created a Windows client called ”爱思助手 (Aisi Helper)” to perform the FairPlay MITM attack. Aisi Helper purports to be software that provides services for iOS devices such as system re-installation, jailbreaking, system backup, device management and system cleaning. But what it’s also doing is surreptitiously installing the malicious apps on any iOS device that is connected to the PC on which Aisi Helper is installed. (Of note, only the most recent app is installed on the iOS device(s) at the time of infection, not all three at the same time.) These malicious iOS apps provide a connection to a third party app store controlled by the author for user to download iOS apps or games. It encourages users to input their Apple IDs and passwords for more features, and provided these credentials will be uploaded to AceDeceiver’s C2 server after being encrypted. We also identified some earlier versions of AceDeceiver that had enterprise certificates dated March 2015.</p>
<p>As of this writing, it looks as though AceDeceiver only affects users in mainland China. The bigger issue, however, is that AceDeceiver is evidence of another relatively easy way for malware to infect non-jailbroken iOS devices. As a result, it’s likely we’ll see this start to affect more regions around the world, whether by these attackers or others who copy the attack technique. In addition, the new attack technique is more dangerous than previous ones for the following reasons:</p>
<ol>
<li>It doesn’t require an enterprise certificate, hence this kind of malware is not under MDM solutions’ control, and its execution doesn’t need user’s confirmation of trusting anymore.</li>
<li>It hasn’t been patched and even when it is, it’s likely the attack would still work on older versions of iOS systems.</li>
<li>Even though these apps have been removed from the App Store, that doesn’t affect the attack. Attackers do not need the malicious apps to be always available in App Store for them to spread – they only require the apps ever available in App Store once, and require the user to install the client to his or her PC. However, ZergHelper and AceDeceiver have shown how easy it can be to bypass Apple’s code review process and get malicious apps into the App Store.</li>
<li>The attack doesn’t require victims to manually install the malicious apps; instead, it does that for them. That’s why they can be only available in a few regions’ App Store without affecting the success of the attack. This also makes them much harder to be discovered by Apple or by security firms researching iOS vulnerabilities.</li>
<li>While the attack requires a user’s PC to be infected by malware first, after that, the infection of iOS devices is completed in the background without the user’s awareness. The only indication is that the new malicious app does appear as an icon in the user’s home screen, so the user may notice a new app he or she won’t recall downloading.</li>
</ol>
<p>Our analysis of AceDeceiver leads us to believe FairPlay MITM attack will become another popular attack vector for non-jailbroken iOS devices – and thus a threat to Apple device users worldwide. Palo Alto Networks has released IPS signatures (<a href="https://threatvault.paloaltonetworks.com/Home/ThreatDetail/38914" target="_blank">38914</a>, <a href="https://threatvault.paloaltonetworks.com/Home/ThreatDetail/38915" target="_blank">38915</a>) and has updated URL filtering and Threat Prevention to protect customers from the AceDeceiver Trojan as well as the FairPlay MITM attack technique.</p>
<p>In the rest of this blog we will take a detailed look at AceDeceiver’s method of spreading, attacking, and implementation. We will also cover how the FairPlay MITM attack works and discuss the security flaws in Apple’s DRM technology.</p>
<h2>Timeline of the Threat</h2>
<p><strong>Jan 2013:</strong> FairPlay MITM attack has been used in the wild to spread pirated iOS apps.</p>
<p><strong>Aug 2014</strong>: Researchers published paper to describe FairPlay MITM attack in the 23<sup>rd</sup> USENIX Security Symposium</p>
<p><strong>Mar 26, 2015</strong>: AceDeceiver’s enterprise certificate signed iOS apps added password stealing functionality. These apps were embedded into Aisi Helper Windows clients.</p>
<p><strong>Jul 10, 2015:</strong> AceDeceiver’s iOS app “爱思助手” was available in HK and NZ App Store</p>
<p><strong>Jul 24, 2015:</strong> Aisi Helper Windows client updated to embed its App Store version iOS app</p>
<p><strong>Nov 7, 2015</strong>: AceDeceiver’s iOS app “AS Wallpaper” was available in US App Store</p>
<p><strong>Jan 30, 2016:</strong> AceDeceiver’s iOS app “i4picture” was available in US and UK App Store</p>
<p><strong>Feb 21, 2016:</strong> Palo Alto Networks published report on ZergHelper</p>
<p><strong>Feb 24, 2016</strong>: Palo Alto Networks reported the AceDeceiver issue to Apple</p>
<p><strong>Feb 25, 2016</strong>: AceDeceiver apps were removed from App Store</p>
<p><strong>Feb 26, 2016:</strong> Palo Alto Networks reported the FairPlay MITM attack issue in AceDeceiver to Apple</p>
<h2>Background of AceDeceiver</h2>
<p>The AceDeceiver Trojan exists in a product named “爱思助手 (Aisi Helper)” that was developed by a company located in Shenzhen, China. AceDeceiver’s C2 server also shares the same domain name with the product’s official website, www.i4[.]cn. The Trojan also used third-level URLs in this domain for downloading and updating.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-2.png"  rel="wpdevart_lightbox attachment wp-att-12717" ><img class="aligncenter size-large wp-image-12717" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-2-500x285.png" alt="AceDeceiver 2" width="500" height="285" /></a></p>
<p style="text-align: center;"><em>Figure 2 Official website of Aisi Helper</em></p>
<p>Aisi Helper is a software program for Windows systems that claims to provide services for iOS devices such as system re-installation, jailbreaking, system backup, device management, system cleaning. When installed on a user’s iOS device that is located in mainland China, it also provides access to a third-party App Store controlled by the attackers that could be used to install additional iOS apps or games to either jailbroken or non-jailbroken devices. Most of the iOS apps they provided appear to be pirated versions. Interestingly, according to <a href="http://www.itjuzi.com/company/16532" target="_blank">ITJuzi</a>, a Chinese business profiling website, Aisi Helper was initially released in January 2014 and at the time did not exhibit any malicious functionality. As of December 2014, it had accumulated over 15 million users and had over 6.6 million monthly active users. The malicious functionality doesn’t appear to have been added until 2015.</p>
<p>When a user accesses the official website from a computer, it prompts the user to install Aisi Helper’s PC client, regardless of the actual operating system running on the computer. Once installed, the PC client will automatically install the most recent malicious iOS app to any connected iOS device. However, if a user accesses the website from an iPhone or an iPad, the browser will be redirected to the site’s mobile version (m.i4[.]cn) and an enterprise certificate signed version of its iOS client will be recommended. During our investigation in February 2016, all Aisi Helper Windows or iOS clients downloaded from the official website contained the AceDeceiver Trojan.</p>
<p>Given what we now know about the functionality of AceDeceiver, the website’s <a href="http://www.i4.cn/copyright.html" target="_blank">legal announcement</a> seems a bit suspicious. Section 7 says that “our website is not responsible for any personal data leakage, loss, theft, modification, etc. that happens as a result of a hacker&#8217;s attack, computer virus intrusion, or other attack &#8230;”</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-3.png"  rel="wpdevart_lightbox attachment wp-att-12718" ><img class="aligncenter size-large wp-image-12718" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-3-500x204.png" alt="AceDeceiver 3" width="500" height="204" /></a></p>
<p style="text-align: center;"><em>Figure 3 The product claims it doesn&#8217;t responsible for personal data leakage or loss</em></p>
<h2>AceDeceiver Landed in the App Store Many Times</h2>
<p>We found three iOS apps in the AceDeceiver family that successfully landed in the official App Store. The first app was released to the public on July 10, 2015, the second on November 7, 2015, and the third on January 30, 2016. All of them were designed to appear as legitimate wallpaper apps and each has a different name in the App Store, a different bundle identifier, and uses different developer accounts.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-4.png"  rel="wpdevart_lightbox attachment wp-att-12719" ><img class="aligncenter size-large wp-image-12719" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-4-500x338.png" alt="AceDeceiver 4" width="500" height="338" /></a></p>
<p style="text-align: center;"><em>Figure 4 The third malicious app of the AceDeceiver family in the App Store</em></p>
<table style="height: 205px;" width="501">
<tbody>
<tr>
<td width="94">Name in App Store</td>
<td width="53">Versions</td>
<td width="121">Bundle ID</td>
<td width="76">Release Date</td>
<td width="58">Stores</td>
<td width="94">Developer</td>
</tr>
<tr>
<td width="94">壁纸助手</td>
<td width="53">6.0.x</td>
<td width="121">com.aisi.aisiring</td>
<td width="76">2015-07-10</td>
<td width="58">HK, NZ</td>
<td width="94">fangwen huang</td>
</tr>
<tr>
<td width="94">AS Wallpaper</td>
<td width="53">7.0.x</td>
<td width="121">com.aswallpaper.mito</td>
<td width="76">2015-11-07</td>
<td width="58">US</td>
<td width="94">Yuzu He</td>
</tr>
<tr>
<td width="94">i4picture</td>
<td width="53">7.1.x</td>
<td width="121">com.i4.picture</td>
<td width="76">2016-01-30</td>
<td width="58">US, UK</td>
<td width="94">liu xiaolong</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><em>Table 1 Information of the three AceDeceiver apps in App Store</em></p>
<p>Normally, Apple does a code review on all apps the first time they are submitted for inclusion in the App Store. After being released, if the developer wants to make an update to the existing iOS app, Apple requires another round of code review for the newer version. To date, we’ve found that all of these apps were updated after they were accepted by the App Store. Which means, AceDeceiver successfully bypassed Apple’s code review seven times.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-5.png"  rel="wpdevart_lightbox attachment wp-att-12720" ><img class="aligncenter size-full wp-image-12720" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-5.png" alt="AceDeceiver 5" width="368" height="638" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-5.png 368w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-5-173x300.png 173w" sizes="(max-width: 368px) 100vw, 368px" /></a></p>
<p style="text-align: center;"><em>Figure 5 User interface for users outside of China</em></p>
<p>When these apps are launched, before they show the first screen of the user interface, they will access the URL tool.verify.i4[.]cn/toolCheck.xhtml, which is AceDeceiver’s C2 server. If the URL returns “0”, the whole user interface of the attacker’s third party app store will be shown. However, if the URL returns “1” or anything else but 0, the user will just be shown a wallpaper app interface, as seen in Figure 5.<a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-6.png"  rel="wpdevart_lightbox attachment wp-att-12721" ><img class="aligncenter size-large wp-image-12721" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-6-500x211.png" alt="AceDeceiver 6" width="500" height="211" /></a></p>
<p style="text-align: center;"><em>Figure 6 iOS apps access C2 to determine which user interface to show</em></p>
<p style="text-align: center;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-7.png"  rel="wpdevart_lightbox attachment wp-att-12722" ><img class="aligncenter size-large wp-image-12722" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-7-500x415.png" alt="AceDeceiver 7" width="500" height="415" /></a></p>
<p style="text-align: center;"><em>Figure 7 iOS app initial beacon to the C2</em></p>
<p>When we analyzed these apps in February, this C2 would only return “0” if the device had an IP address from mainland China. If that wasn’t part of how the apps evaded Apple’s code review, it’s also possible the attacker set the server to always return “1” when they knew the apps were under review, so that no matter where Apple’s reviewers are located they would always just get some beautiful-looking picture in a wallpaper app user interface.</p>
<p>In addition to the location trick, AceDeceiver also made some more effort to ensure it wouldn’t be discovered.</p>
<p>First, the attacker chose to only submit these apps to a App Stores in select regions. Apple provides App Store services for <a href="https://developer.apple.com/library/ios/documentation/LanguagesUtilities/Conceptual/iTunesConnect_Guide/Appendices/AppStoreTerritories.html" target="_blank">155 different regions</a> around the world. Users usually can only choose to download from their local App Store, and they can’t install apps that aren’t available in their region. The aforementioned ZergHelper’s author chose to submit it for all 155 regions, but AceDeceiver’s did not. For example, the third app, “i4picture”, was only available in the App Store for the United States and United Kingdom when we investigated it. Because of this distribution strategy, the author likely guessed that Apple would not review the app from China. It also significantly reduced the chance that the app would be discovered by security researchers, because if anyone downloaded this from the App Store, they’re generally located in a region where the malicious functions won’t take place.</p>
<p>Second, besides different user interfaces based on IP address, according to our testing, AceDeceiver will remember a device through the information it has collected. These apps will upload a device’s unique ID to the C2 server. If a device is ever used from outside of China, even if it later changed back to a mainland Chinese IP address, the malicious functionalities will still be hidden.</p>
<p>Third, these apps will also show different names in different situations. For example, the version 6.0.4 used the same trick as ZergHelper in that, in the App Store’s webpage, its name was “壁纸助手(Wallpaper Helper)”; while in iOS devices its name will become “爱思助手(Aisi Helper)”. We found these name differences by checking the IPA file’s iTunesMetadata.plist. Later, in version 7.1.2, the app has the name “爱思助手(Aisi Helper)” for iOS devices that use short-form Chinese language settings, while for all other devices its name was just “i4picture”.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-8.png"  rel="wpdevart_lightbox attachment wp-att-12723" ><img class="aligncenter size-full wp-image-12723" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-8.png" alt="AceDeceiver 8" width="421" height="218" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-8.png 421w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-8-300x155.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-8-370x192.png 370w" sizes="(max-width: 421px) 100vw, 421px" /></a></p>
<p style="text-align: center;"><em>Figure 8 Different names in iOS devices and in App Store pages</em></p>
<p style="text-align: left;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-9.png"  rel="wpdevart_lightbox attachment wp-att-12724" ><img class="aligncenter size-full wp-image-12724" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-9.png" alt="AceDeceiver 9" width="361" height="203" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-9.png 361w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-9-300x169.png 300w" sizes="(max-width: 361px) 100vw, 361px" /></a></p>
<p style="text-align: center;"><em>Figure 9 Different names in devices using different languages</em></p>
<h2>The FairPlay Man-In-The-Middle Attack</h2>
<p>When we were investigating AceDeceiver, the strangest part was that this malware’s apps were not available in App Store for mainland China and yet its malicious functionalities only target users in that region. This helped us to discover its exploitation of FairPlay MITM attack. Through the attack, these apps could be installed on iOS devices in a way not needing the App Store.</p>
<p style="text-align: center;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-10.png"  rel="wpdevart_lightbox attachment wp-att-12725" ><img class="aligncenter size-large wp-image-12725" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-10-500x317.png" alt="AceDeceiver 10" width="500" height="317" /></a></p>
<p style="text-align: center;"><em>Figure 10 Authorize a computer in iTunes</em></p>
<p><a href="https://developer.apple.com/streaming/fps/" target="_blank">FairPlay</a> is a digital rights management (DRM) technology created by Apple many years ago to protect songs for use via iTunes and on iPods. Based on the DRM, Apple users can download iOS apps to their PCs or Macs through iTunes software, and then install these apps from their computers to their devices. Before the installation, users have to “authorize the computer” with the same Apple ID used to buy those apps. Apple restricted each Apple ID to only be used to <a href="https://support.apple.com/en-us/HT201251" target="_blank">authorize at most five computers</a>. This process is what the attackers figured out how to abuse.</p>
<p>During an app’s installation, a key step in the authorization procedures is that the connected iPhone or iPad will send afsync.rq and afsync.rq.sig files to the computer, and the iTunes software on the computer should send correct afsync.rs and afsync.rs.sig files as response back to the iOS device. Only if the responded afsync.rs are correct can the iOS device install the app and decrypt its DRM protection (The real protocol is more complex than our description here; we have simplified it for sake of argument.)</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-11.png"  rel="wpdevart_lightbox attachment wp-att-12726" ><img class="aligncenter size-large wp-image-12726" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-11-500x102.png" alt="AceDeceiver 11" width="500" height="102" /></a></p>
<p style="text-align: center;"><em>Figure 11 Normal authorization procedures during app installation</em></p>
<p>However, this procedure has some design flaws.</p>
<p>First, Apple only restricts the computer that should be authorized by the Apple ID that was used to purchase the iOS apps. There isn’t any limitation about how many iOS devices those apps can be installed on.</p>
<p>Second, Apple allows the Apple ID being used to purchase apps to differ from the Apple ID that is actually used by the iOS devices.</p>
<p>Third, the DRM protecting apps’ installer files (IPA files) will always be the same no matter which computers it will be downloaded to, and no matter which Apple ID was used to purchase them.</p>
<p>Overall, the problem is this: the FairPlay DRM protection is only relevant with the app itself, but is irrelevant respective to Apple ID, and is irrelevant respective to iOS device. Apple designed the protection mechanism in such a way that its security relies on computer authorization and physical connection between the computer and the device in question.</p>
<p>These design flaws allowed the FairPlay MITM attack. In such an attack, the attacker can authorize a computer, then purchase an iOS app from App Store (in any region) so that they could generate the correct afsync.rs response. Then, the attacker can deploy this afsync.rs as a service on the C2 server. Now, they can create client software for PC or for Mac. The client software simulates iTunes’s functionalities that it connects with the iOS device and installs the iOS app. When the client received the afsync.rq from the iOS device, it could upload the file to C2 server, then get a correct afsync.rs response from C2 server, and send this response to iOS device.</p>
<p>By deploying authorized computer in the C2 server, and using a client software as agent in the middle, the attacker can distribute that purchased iOS app to unlimited iOS devices.</p>
<p style="text-align: left;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-12.png"  rel="wpdevart_lightbox attachment wp-att-12727" ><img class="aligncenter size-large wp-image-12727" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-12-500x275.png" alt="AceDeceiver 12" width="500" height="275" /></a></p>
<p style="text-align: center;"><em>Figure 12 Authorization procedures in a FairPlay MITM attack</em></p>
<p>It’s not easy to implement FairPlay MITM attacks considering that the attacker needs to reverse the iTunes client to know the proprietary protocols/algorithms employed by Apple. Even so, in January 2013, some <a href="http://www.pingwest.com/what-is-chinese-market-the-hell/" target="_blank">media reported</a> that this attack technique had been used in the wild to distribute pirated iOS apps. In August 2014, Tielei Wang and others from Georgia Institute of Technology published a paper, “<a href="https://www.usenix.org/conference/usenixsecurity14/technical-sessions/presentation/wang_tielei" target="_blank">On the Feasibility of Large-Scale Infections of iOS Devices</a>,” and presented at the 23<sup>rd</sup> USENIX Security Symposium. The paper described the attack in detail, demonstrated the attack by a proof-of-concept experiment, and evaluated how this attack approach could be used in a wide range.</p>
<p>Three years since the January 2013 reporting, as we’re analyzing AceDeceiver, we have realized Apple still hasn’t fixed this complex problem. What’s more, iOS devices in current and older versions may still be vulnerable the same attack.</p>
<h2>How AceDeceiver Used FairPlay MITM Attack</h2>
<p>In our investigation, which covered Aisi Helper Windows client’s version 5.38 to the newest available version (6.15), we found the clients to contain App Store versions of AceDeceiver iOS IPA file under path “files/i4/60.ipa”. According to the updating logs on the official Aisi Helper website, version 5.38 was released July 24, 2015. That is just 14 days after the first of the three questionable iOS apps was available in App Store. Some more versions of the Windows client also contained a “files/i4/i4.ipa” which indicates enterprise certificates signed AceDeceiver iOS apps.</p>
<p>After installed the Windows client, when users connect iOS devices to their their PCs and launched the client, the embedded AceDeceiver app will be automatically installed on the devices using the FairPlay MITM attack. This does not require user confirmation. In its user interface, a progress bar will be shown with a message “Installing Aisi Helper…” but there isn’t any option to stop it or cancel it.</p>
<p style="text-align: left;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-13.png"  rel="wpdevart_lightbox attachment wp-att-12728" ><img class="aligncenter size-large wp-image-12728" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-13-500x361.png" alt="AceDeceiver 13" width="500" height="361" /></a></p>
<p style="text-align: center;"><em>Figure 13 Aisi Helper Windows client automatically instalsl the Trojan app</em></p>
<p>Our analysis below is based on the version 6.12 of the Windows client. The installer was downloaded from http://d.app6.i4[.]cn/i4tools/v6/i4tools_v6.12_Setup.exe in Feb 24, 2016. Its SHA-256 value is ad313d8e65e72a790332280701bc2c2d68a12efbeba1b97ce3dde62abbb81c97.</p>
<p>After the Windows client is installed, in its i4Tools.exe file, function sub_4A9530 is responsible for implementing the installation and exploitation. It invokes function sub_4A8CE0 to install the IPA file, and then invokes function auth to perform FairPlay MITM.</p>
<p>Function sub_4A8CE0 reads the IPA file stored in \files\i4\60.ipa, and then invokes am_install_app. The am_install_app function is implemented in i4m.dll file. It communicates with the com.apple.mobile.installation_proxy service to install the IPA file on the iOS device. This is a very classic method.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-14.png"  rel="wpdevart_lightbox attachment wp-att-12729" ><img class="aligncenter size-large wp-image-12729" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-14-500x348.png" alt="AceDeceiver 14" width="500" height="348" /></a></p>
<p style="text-align: center;"><em>Figure 14 Install the IPA file to iOS device</em></p>
<p>Then, sub_4A9530 will invoke function auth which is also implemented in i4m.dll.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-15.png"  rel="wpdevart_lightbox attachment wp-att-12730" ><img class="aligncenter size-large wp-image-12730" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-15-500x386.png" alt="AceDeceiver 15" width="500" height="386" /></a></p>
<p style="text-align: center;"><em>Figure 15 Invoke function auth with C2 URL for FairPlay MITM</em></p>
<p>The function auth implements the FairPlay MITM attack. It receives /AirFair/sync/afsync.rq from the connected iOS device, sends the file to C2 server auth3.i4[.]cn by HTTP POST (implemented in function sub_10005DB0), receives the afsync.rs from C2 server, and then sends this response back to the iOS device’s /AirFair/sync/afsync.rs.</p>
<p>&nbsp;</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-16.png"  rel="wpdevart_lightbox attachment wp-att-12731" ><img class="aligncenter size-large wp-image-12731" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-16-500x190.png" alt="AceDeceiver 16" width="500" height="190" /></a></p>
<p style="text-align: center;"><em>Figure 16 Auth function read afsync.rq file</em></p>
<p style="text-align: left;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-17.png"  rel="wpdevart_lightbox attachment wp-att-12732" ><img class="aligncenter size-large wp-image-12732" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-17-500x338.png" alt="AceDeceiver 17" width="500" height="338" /></a></p>
<p style="text-align: center;"><em>Figure 17 Send the afsync.rq to C2 server via libcurl</em></p>
<p style="text-align: center;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-18.png"  rel="wpdevart_lightbox attachment wp-att-12733" ><img class="aligncenter size-large wp-image-12733" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-18-500x182.png" alt="AceDeceiver 18" width="500" height="182" /></a></p>
<p style="text-align: center;"><em>Figure 18 Traffic of sending afsync.rq file</em></p>
<p style="text-align: center;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-19.png"  rel="wpdevart_lightbox attachment wp-att-12734" ><img class="aligncenter size-large wp-image-12734" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-19-500x292.png" alt="AceDeceiver 19" width="500" height="292" /></a></p>
<p style="text-align: center;"><em>Figure 19 Copy the afsync.rs back to iOS</em></p>
<h2>Stealing Apple IDs and Passwords</h2>
<p>The iOS apps of AceDeceiver mainly act as a third party app store if users access them from China. Note that some of the apps or games they provide in the store are also installed through a FairPlay MITM attack. In addition, these apps strongly suggest users input their Apple ID with password so that users could “directly install free apps from the App Store, execute in-app purchase, and login to Game Center.”</p>
<p>In the interface to input the Apple ID and password, AceDeciver provided buttons for “Instructions” and “Disclaimer”. In all these documents, they claimed they will never send the passwords to their server, but will just store them in the local device after encryption. However, we can demonstrate that this is not true. Of note, the last section of the Disclaimer also indicates that if there’s any abnormal activity related to a user’s Apple ID, Aisi Helper doesn’t take any responsibility for it.</p>
<p style="text-align: center;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-20.png"  rel="wpdevart_lightbox attachment wp-att-12735" ><img class="aligncenter size-large wp-image-12735" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-20-500x428.png" alt="AceDeceiver 20" width="500" height="428" /></a></p>
<p style="text-align: center;"><em>Figure 20 iOS apps&#8217; interfaces of installing apps and input Apple ID</em></p>
<p style="text-align: center;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-21.png"  rel="wpdevart_lightbox attachment wp-att-12736" ><img class="aligncenter size-large wp-image-12736" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-21-500x420.png" alt="AceDeceiver 21" width="500" height="420" /></a></p>
<p style="text-align: center;"><em>Figure 21 Instruction and Disclaimer of Inputing Apple ID</em></p>
<p>In fact, we discovered all versions of AceDeceiver will upload the Apple ID and password to the C2 server. In these iOS apps, after a user inputs any Apple ID with password, the app will invoke the [LoginEntity getLoginAppleId:withPassword:block:] method to get the Apple ID and the password from interface, then invoke [UserInfo initAppleId:WithPassword]. In this method, the Apple ID and password will be encrypted by RC4 algorithm with a fixed key. The key value is itself pretty interesting:</p>
<ul>
<li>i4.cn/forum.php?mod=viewthread&amp;tid=m&amp;fromuid=n</li>
</ul>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-22.png"  rel="wpdevart_lightbox attachment wp-att-12738" ><img class="aligncenter size-large wp-image-12738" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-22-500x207.png" alt="AceDeceiver 22" width="500" height="207" /></a></p>
<p style="text-align: center;"><em>Figure 22 Apple ID and password are encrypted by RC4 algorithm</em></p>
<p>After encrypting, the Apple ID and password will be encoded by Base64 following by URL encoding, and then be set as properties appleId_RC4 and password_RC4 of an LoginEntity instance. Now [LoginEntity getLoginInfo] will be invoked. In this method, the encrypted Apple ID and password will be sent back to AceDeceiver’s C2 server by URL “http://buy.app.i4[.]cn”.<br />
<a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-23.png"  rel="wpdevart_lightbox attachment wp-att-12737" ><img class="aligncenter size-large wp-image-12737" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-23-500x304.png" alt="AceDeceiver 23" width="500" height="304" /></a></p>
<p style="text-align: center;"><em>Figure 23 The encrypted Apple ID and password are sent to C2 server</em></p>
<p>During analysis, we input an invalid Apple ID: username “example@example.com” with the password “example123”. Through network traffic we can see below this credential was sent to and was received by the server (since it responded HTTP 200).</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-24.png"  rel="wpdevart_lightbox attachment wp-att-12739" ><img class="aligncenter size-large wp-image-12739" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/03/AceDeceiver-24-500x430.png" alt="AceDeceiver 24" width="500" height="430" /></a></p>
<p style="text-align: center;"><em>Figure 24 Traffic of uploading Apple ID and password</em></p>
<h3>Mitigate the Risk</h3>
<p>All three Trojan apps of AceDeceiver were removed by Apple from App Store as of late February 2016. But even with their removal, the Aisi Helper Windows client can still install these apps to non-jailbroken iOS devices using a FairPlay MITM attack. We also reported older enterprise certificates signed versions of AceDeceiver apps to Apple. All of those known abused enterprise certificates have also since been revoked.</p>
<p>We suggest users who installed Aisi Helper’s Windows client or iOS apps after March 2015 to remove these software and apps immediately, as well as change their Apple ID passwords. We also suggest all iOS users to enable <a href="https://support.apple.com/en-us/HT204915" target="_blank">two-factor authentication for their Apple IDs</a>.</p>
<p>For enterprises, we suggest to check whether there’s any iOS app installed to managed Apple devices by these bundle identifiers:</p>
<ul>
<li>aisi.aisiring</li>
<li>aswallpaper.mito</li>
<li>i4.picture</li>
</ul>
<p>Since AceDeceiver also spreads via enterprise certificates, we suggest that enterprises check for unknown or abnormal provision profiles as well.</p>
<p>Until now all known malicious traffic comes from or goes to subdomains under i4[.]cn. Enterprises could also check traffic by this domain to identify potential traffic of AceDeceiver.</p>
<h3>Conclusion</h3>
<p>AceDeceiver shows yet another way attackers are getting around Apple’s security measures to install malicious apps, particularly on non-jailbroken devices. Mobile is a huge growth area for malicious attackers and while Android devices have gotten the most attention for a few years now, attackers are turning increasingly to iOS devices because they are so widely popular. As of this writing, AceDeceiver is only targeting iOS devices in mainland China, but attackers could easily expand this attack to other regions around the world. And as we’ve already noted, the attack technique they’re exploiting will not be easy for Apple to fix.</p>
<p>Palo Alto Networks has released <a href="https://threatvault.paloaltonetworks.com/Home/ThreatDetail/38915" target="_blank">a IPS signature (38915)</a> to block AceDeceiver family’s C2 traffic. The related C2 URLs are also marked as malicious by URL filtering and Threat Prevention. Palo Alto Networks WildFire recognizes all Windows clients of Aisi Helper as malicious.</p>
<p>Palo Alto Networks has also released <a href="https://threatvault.paloaltonetworks.com/Home/ThreatDetail/38914" target="_blank">another IPS signature (38914)</a> to cover the FairPlay MITM attack.</p>
<h2>Acknowledgements</h2>
<p>We greatly thank Jen Miller-Osborn and Chad Berndtson from Palo Alto Networks for their assistance in developing this report. We also would like to thank Yi Ren, Tyler Halfpop, Yuchen Zhou and Rongbo Shao from Palo Alto Networks for their works to protect our customers from the threat.</p>
<h2>IOCs</h2>
<p><strong>Trojan.Win32.AceDeceiver</strong></p>
<p>ad313d8e65e72a790332280701bc2c2d68a12efbeba1b97ce3dde62abbb81c97 i4Tools_v6.12_setup.exe</p>
<p>9231166a2114f6b1c2d6cd6a57b5836e919ee5739d8868f07425d3c22697894e i4Tools.exe</p>
<p>78a2cdade1b0715e4f3f372e86724ee10e241ad8821c6b8caa3e84fd7e78ba7e i4m.dll</p>
<p><strong>Trojan.iOS.AceDeceiver (App Store version, FairPlay DRM protected)</strong></p>
<p>5894742146c02ba8af5390c91e4f0d2e5ad6cfaa2b916945ebb4fad633b054e3 601.ipa</p>
<p>ba07f252801120b081c45a173fb1a205fea763ed827f05fb9beb5150ae297ccb 60.ipa</p>
<p>f7e50fdc4f20f0d25771a694eb3f3643c1842e3b14f06aaa5e8d9dab1c1851e9 60.ipa</p>
<p>ca115f8a3751e4c0fc36b001e3c74d3ac167360a4a44fd1b373b25487de05820 60.ipa</p>
<p>3e02b30a6a920a5bdc139270b1e731a4a8d7ab313e9c8d9af9fec611710b4d09 60.ipa</p>
<p>006c539fa6251e1d2142631c52d7c112bf5027335696eacd64794b8cf357d6d5 60.ipa</p>
<p>fbc26c14a3ff609332644f5d9702f07ace024961b7aa2c531df2715911b1c57d bf03_710.ipa</p>
<p><strong>Trojan.iOS.AceDeceiver (App Store version, FairPlay DRM stripped)</strong></p>
<p>bc82efce99f149441a2fd730a961a0f7da58dd6c9c3b45597f5571f227a52309 com.i4.picture.ipa</p>
<p>ad7cfc29b0a9b6ade878d01084c68d0bbcde699e142652b00132317c04bcf730 aisiweb</p>
<p><strong>Trojan.iOS.AceDeceiver (enterprise certificate signed versions)</strong></p>
<p>0a8e29bd8fe0f5d4d6a8677454b1d01e97478dc4bc3666eaab6bbbf2f2e759bc</p>
<p>1b6cf5abe2bd3d5bb84da8debd5ec563393d30995ce4afc6142dc3381ac69902</p>
<p>352d1af3a5cef417dda688be2dd35c3f59841ea56c393a07f95a0bc5ab576448</p>
<p>5bc7ceb48ca4951997d50425d5b34484505e4444a3e172ab846b2595104b7138</p>
<p>5bebcacfb5c541bd6ba7530aeb2971c20adb1beddb244e4367d40cd87bfc826d</p>
<p>63e3cc1d00abef8ad6c2029e7f9a4831ec4c48682979a7385a940fb73cfc03a6</p>
<p>821f93bae8c067af71626ca84cdc20226df61c4c371e5eb6423d9439c8b8c25d</p>
<p>86b8065d40c24e3702ed848ec28650b074a577f677375c094ed61a2efffce11b</p>
<p>9a4a40625efcc6f4de419db0bec9fbdfdc379918a95fba572ee56cffc13cd074</p>
<p>a504d47fdfa630bc1c474cdbdaf0dd82a46a08e5d662ecc1bffc57f3c409690e</p>
<p>baa255dd7a0e52edf6e4f3082a6840800898969a3d17f2bcb6a88d0a94c5b795</p>
<p>bc5e3be07e65f25479cee7de8615b386c489c1253659ed7ca5526f86f5116374</p>
<p>c41e3abd97e16b3d9514583eef613105006d69dffb2231badfd500d29eb113bc</p>
<p>d879c6d96463b81e4f2085a565418c99b559a8803ca449442464a2b6cd728d97</p>
<p>f6cabdc408e12912c07097c9956ceda2f7033e88c2ca59d7618b9256d3724f5c</p>
<p><strong>C2 Domains</strong></p>
<ul>
<li>tool.verify.i4[.]cn</li>
<li>auth3.i4[.]cn</li>
<li>buy.app.i4[.]cn</li>
</ul>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
