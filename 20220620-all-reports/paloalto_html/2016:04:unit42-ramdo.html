
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Click-Fraud Ramdo Malware Family Continues to Plague Users</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-ramdo/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/unit42-ramdo/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Unit 42 and Dell Secureworks Counter Threat Unit find click-fraud Ramdo malware family continues to plague users."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-ramdo/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Click-Fraud Ramdo Malware Family Continues to Plague Users" />
<meta property="og:description" content="Unit 42 and Dell Secureworks Counter Threat Unit find click-fraud Ramdo malware family continues to plague users." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-ramdo/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="Dell Secureworks" />
<meta property="article:tag" content="IDAPython" />
<meta property="article:tag" content="Python" />
<meta property="article:tag" content="Ramdo" />
<meta property="article:tag" content="VirtualAlloc" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2016-04-11T02:00:04+00:00" />
<meta property="article:modified_time" content="2018-11-01T10:11:52+00:00" />
<meta property="og:updated_time" content="2018-11-01T10:11:52+00:00" />
<meta property="og:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/ramdo1-500x383.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit 42 and Dell Secureworks Counter Threat Unit find click-fraud Ramdo malware family continues to plague users." />
<meta name="twitter:title" content="Click-Fraud Ramdo Malware Family Continues to Plague Users" />
<meta name="twitter:image" content="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/ramdo1-500x383.png" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Click-Fraud Ramdo Malware Family Continues to Plague Users Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-ramdo/feed/" />
<meta property="og:likes" content="0"/>
<meta property="og:readtime" content="10"/>
<meta property="og:views" content="10,173"/>
<meta property="og:date_created" content="April 11, 2016 at 5:00 AM"/>
<meta property="og:post_length" content="2496"/>
<meta property="og:category" content="Malware"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/malware-2/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Josh Grunzweig"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/joshgruznweig/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Click-Fraud Ramdo Malware Family Continues to Plague Users","name":"Click-Fraud Ramdo Malware Family Continues to Plague Users","description":"This post is also available in: \u65e5\u672c\u8a9e (Japanese)Be the first to receive the latest news, cyber threat intelligence and research from Unit 42. Subscribe Now.\u00a0 Ramdo is a family of malware that performs fraudulent website \u2018clicks.\u2019 Ramdo malware activity first surfaced in late 2013 and has since continued to infect machines worldwide, primarily through the...","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-ramdo\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-ramdo\/","datePublished":"April 11, 2016","articleBody":"Be the first to receive the latest news, cyber threat intelligence and research from Unit 42. Subscribe Now.\u00a0\n\nRamdo is a family of malware that performs fraudulent website \u2018clicks.\u2019 Ramdo malware activity first surfaced in late 2013 and has since continued to infect machines worldwide, primarily through the use of exploit kits. In this blog post, we\u2019ll take a deep dive into the technical aspects of the Ramdo malware itself, providing insight into how the malware functions, as well as techniques on how analysts can reverse-engineer this particular threat.\n\nThis research is a joint effort from Unit 42 and Dell Secureworks Counter Threat Unit. For more information about the Ramdo threat, please also refer to the published blog post from Dell Secureworks CTU.\n\nFor the remainder of this blog post, we will be dealing with the following sample, which first surfaced on January 22, 2016.\n\nMD5:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 F0E64CC571590513D0DC8D37EA23D153\nSHA1:\u00a0\u00a0\u00a0\u00a0 98D44A46E9DAD00748D0278C84B58CE36D5E8861\nSHA256:\u00a0\u00a0 B534D55F384F4A2F9F8762CCD360A7C5D3FBD9BA15B1671E4A3629EF69A4472B\nSize:\u00a0\u00a0\u00a0\u00a0 163328 Bytes\nFile Type: PE32 executable (GUI) Intel 80386, for MS Windows\nCompile:\u00a0\u00a0 2016-01-22 23:46:15\n\nMost of the Ramdo samples witnessed in the wild are obfuscated using a simple packer. As such, the sample will first be unpacked in order to analyze the underlying, un-obfuscated malware.\nUnpacking\nThe Ramdo malware is contained within a DLL. Packers will often store this DLL in an obfuscated state within an executable binary. When run, the executable will load this DLL after de-obfuscating it. Unpacking this sample is a simple matter of setting a breakpoint on calls to VirtualAlloc, and then setting a write hardware breakpoint on a byte within this newly allocated memory.\n\n\nFigure 1 Breaking on calls to VirtualAlloc\nAfter roughly two calls to VirtualAlloc, we witness the unpacked executable being written to this section. At this point it is simply a matter of dumping this memory section to disk.\n\n\nFigure 2 Dumping un-obfuscated DLL from packed dropper\nAt this point we have the unpacked version of the Ramdo DLL, which can be used for further analysis.\nAnalyzing Ramdo DLL\nOne of the first problems the analyst will encounter when reversing a Ramdo DLL is the author\u2019s use of encrypted strings and hashed functions. Functions are hashed using the following algorithm, represented in Python:\ndef hash_function(name):\n  x = 0xFFFFFFFF\n  for n in name:\n    x = ((x &gt;&gt; 8) ^ x * (x ^ ord(n))) &amp; 0xFFFFFFFF\n  return x\n\nA script has been provided that will generate a C header file containing an enumeration of these hashed function. Please note that this script must run on a Windows machine.\n\nAdditionally, strings are encrypted using a single-byte XOR key. A large array of the following data structures are used:\n\n[WORD] XOR Key\n[WORD] Length\n[DWORD] Offset to Data\n\nThis can be better visualized in the following screenshot:\n\n\nFigure 3 Array of data structures containing encrypted strings\nAn IDAPython script has been provided that will parse and decrypt these encrypted strings. Please note that the start address of the previously mentioned data structures must be set for this script to work.\n\nAfter both the obfuscated functions and encrypted strings have been reverted to their original form, analysis of the Ramdo DLL becomes much easier.\n\nThe malware initially attempts to determine if it is running within a sandbox. This is further described within the blog post written by Dell Secureworks CTU. In the event it believes it is running within a sandbox, it will enter an infinite loop.\n\nThe malware proceeds to query the victim machine\u2019s GUID via the following registry key:\n\nHKLM\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid\n\nA string of \u2018qK\u2019 is appended to this value. This data is eventually used as a RC4 key. The malware will attempt to read the following registry key. Should this key exist, the malware will decrypt this data using the RC4 algorithm and the previously mentioned key.\n\nHKCU\\SOFTWARE\\Adobe\\Acrobat Reader\\14.0\\Globals\\LastLoggedOnProvider\n\nThis registry key is used to instruct Ramdo to install itself. Should this registry key have a value of zero, it will proceed. The malware then attempts to read the following registry key:\n\nHKCU\\SOFTWARE\\Adobe\\Acrobat Reader\\14.0\\Globals\\IconUnderline\n\nShould this key not exist, it is set with a value of zero. Should this key have a value of zero, it proceeds.\n\nRamdo continues to disable tooltips by setting the following registry key to zero, thus disabling balloon tooltips from appearing on the victim machine:\n\nHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\EnableBalloonTips\n\nDisabling this setting prevents the malware from generating pop-up notifications that might otherwise notify the victim that something unusual is happening.\n\nDuring Ramdo\u2019s operations, the following mutexes are used by the malware:\n\n\tGlobal\\[machine GUID]qK-fffffffe\n\tGlobal\\[machine GUID]qK-fffffffd\n\nRamdo then copies itself (executable dropper) to the following location:\n\n%APPDATA%\\Microsoft\\btstack.dll\n\nThis file has its timestamp data modified to help hide it from defenders.\n\nThe following registry key is written to ensure that btstack.dll is loaded upon reboot:\n\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\BluetoothManage - rundll32.exe \"%appdata%\\Microsoft\\btstack.dll\",init\n\nAt this point, the malware will identify a running Microsoft Windows process and in turn identify the path to the associated executable file. This executable is spawned in a new suspended process, and the following code is injected prior to resuming the process:\n\ncall\u00a0\u00a0\u00a0\u00a0 $+5\npop\u00a0\u00a0\u00a0\u00a0 eax\nsub\u00a0\u00a0\u00a0\u00a0 eax, 0FFFFFFE6h ; EAX contains Path to btstack.dll\nmov \u00a0 \u00a0ebx, 76C0F0F2h\npush \u00a0 eax\ncall \u00a0 \u00a0 \u00a0ebx ; LoadLibraryW\nmov \u00a0 \u00a0 eax, 76C0C426h\npush \u00a0 \u00a00FFFFFFFFh\ncall \u00a0 \u00a0 \u00a0eax ; Sleep\n\nThis code will load in the previously written btstack.dll, which will load the malware into a legitimate Microsoft Windows process. Should this prove successful, the malware will exit.\n\nIn the event the malware is already running within a Microsoft Windows process, the malware proceeds to spawn a new thread that begins by setting the previously mentioned LasLoggedOnProvider registry key with the RC4 encrypted configuration data that is stored within the binary.\n\nBefore any network activity is performed, Ramdo will check to see if it is running within a virtualized environment. The CTU blog post further explains how this occurs. Should Ramdo discover it is running in a virtualized environment, the seeds used for subsequent domain name generation are altered, resulting in connections to incorrectly generated domain names.\n\nRamdo then attempts to determine if it is connected to the Internet by making a simple HTTP request. Note the lack of HTTP headers, such as a user-agent in the following request:\n\nGET \/ HTTP\/1.1\nHost: www.google.com\n\nPrior to making this request to google.com, Ramdo first checks the DNS response to ensure at least two IP addresses were returned in the query. In the event only a single IP address is returned, the malware will not continue its execution flow. Instead, it will sleep until the next iteration of its network communication loop.\n\nIf Ramdo determines it is connected to the Internet, it proceeds to generate a domain using the following algorithm. The two seeds are hardcoded within the sample. The second seed increments by one up until twenty to generate all permutations of domains used by the malware. The third value is set to zero if no virtualized environments are detected. Should a virtualized environment be detected, the generated domains are incorrect.\ndef generate_dga(s1, s2, vm_detect=0):\n  v1 = (s1 * (s2+1)) ^ (0x777 * (s1 + vm_detect))\n  v2 = v1 ^ (26 * s2 * s1)\n  domain = \"\"\n  for c in range(16):\n    v3 = (v2 % 0x1A) + 32\n    domain += chr(v3)\n    v2 += (v2 ^ (26 * v1 * c * c)) \n    v2 = v2 &amp; 0xFFFFFFFF\n\n  new_domain = \"https:\/\/\"\n  for d in domain:\n    if ord(d) == 0x10:\n      new_domain += \"-\"\n    else:\n      new_domain += chr(ord(d) + 65)\n  new_domain += \".org\"\n  return new_domain\nThe following IDAPython script can be used to identify the DGA algorithm and seeds used. It will then proceed to generate the 20 permutations of domains used by Ramdo. Note that this script is not guaranteed to work on all variants of Ramdo due to minor changes that may have been made in the DGA algorithm. The following example output from the script demonstrates what information is provided to the analyst:\n\n\nFigure 4 Output from IDAPython script\nAfter the domain has been generated, the malware will make a HTTPS POST request, such as the following:\n\nPOST \/ HTTP\/1.1\nContent-Length: 128\nHost: qgwwyeeouiouwkya[.]org\nCache-Control: no-cache\n\n[Encrypted Data]\n\nIn the above request, data is encrypted using the RSA algorithm. The following base64-encoded public key is used to encrypt this data. It should be noted that this key has changed since Microsoft initially analyzed Ramdo, indicating that Ramdo continues to evolve over time.\n\nBgIAAACkAABSU0ExAAQAAAEAAQDJ9Nl4XvlyD9PmguEaeUt2auCZm2994\nFcdY2aCGMuYvc71sqLkOyf3Q1Cp4q\/s3CXgXr5ifomWiF4D22eWsEPqoI1RyZ\n8LwYaCVD11WrwtoST4BPwMPARLvNJGvAKzcXpn1adDvprXsfGW1r3YeKP\nw6KZLPdCfvLBl3U9xTJ8lrg==\n\nThe encrypted data is formatted using the following string:\n\nv=%d&amp;w=%1d:%1d:%04d:%1d:%1d:%1d:%1d:%1d&amp;b=%s&amp;s=%d&amp;k=%d&amp;c=%d&amp;x=%d&amp;i=%d\n\nThe following variables contain the associated data:\n\nv : Suspected version of Ramdo\nw : Operating system version, build number, service pack, virtualization information\nb : Machine GUID string with 'qK' appended\ns : Static value\nk : Randomized value\nc : Config Data (ShowTabletKeyboard registry key)\nx : DGA seed\ni : Iteration of the second DGA seed\n\nThe server response begins with the following format:\n\nOK[k value from request]\\r\\n[command][data]\n\nWhere \u2018k value from request\u2019 is the decrypted \u2018k\u2019 GET parameter sent in the request by Ramdo. The server response is RC4-encrypted using the decrypted \u2018b\u2019 GET parameter sent in the request from Ramdo.\n\nThe command value can be any of the following, represented in binary form:\n\n1 : Update the LastLoggedOnUser registry key\n2 : Update the btstack.dll executable\n3 : Update the ShowTabletKeyboard registry key\n5 : Update the HangDetect and LastProgress registry key\n\nThe following example C2 response demonstrates a response with a command of five:\n\n00000000: 4F 4B 31 31 30 35 39 32 38 32 0D 0A 05 2F 30 38 OK11059282...\/08\n00000010: 2E 63 61 62 3B\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 .cab;\n\nRamdo continues to both download and extract this cabinet file, which contains a copy of the Chromium Embedded Framework (CEF). The CEF will be used by the malware to conduct click fraud.\n\nThe malware proceeds to make a subsequent request to the C2 server. The server responds in a similar fashion to the previously mentioned one. One example C2 response can be seen below:\n\n0000 4f 4b 31 35 36 37 34 31 32 34 0d 0a 03 01 00 00\u00a0\u00a0 OK15674124......\n0010 00 23 00 00 00 3c 00 00 00 05 00 00 00 06 00 00\u00a0\u00a0 .#...&lt;..........\n0020 00 73 65 61 72 63 68 2d 73 70 69 6e 6e 65 72 2e\u00a0\u00a0 .search-spinner.\n0030 63 6f 6d 3b 73 65 61 72 63 68 2d 66 69 63 74 69\u00a0\u00a0 com;search-ficti\n0040 6f 6e 2e 63 6f 6d 00 4d 6f 7a 69 6c 6c 61 2f 35\u00a0\u00a0 on.com.Mozilla\/5\n0050 2e 30 20 28 57 69 6e 64 6f 77 73 20 4e 54 20 31\u00a0\u00a0 .0 (Windows NT 1\n0060 30 2e 30 3b 20 57 4f 57 36 34 29 20 41 70 70 6c\u00a0\u00a0 0.0; WOW64) Appl\n0070 65 57 65 62 4b 69 74 2f 35 33 37 2e 33 36 20 28\u00a0\u00a0 eWebKit\/537.36 (\n0080 4b 48 54 4d 4c 2c 20 6c 69 6b 65 20 47 65 63 6b\u00a0\u00a0 KHTML, like Geck\n0090 6f 29 20 43 68 72 6f 6d 65 2f 34 31 2e 30 2e 32\u00a0\u00a0 o) Chrome\/41.0.2\n00a0 32 37 32 2e 31 31 38 20 53 61 66 61 72 69 2f 35\u00a0\u00a0 272.118 Safari\/5\n00b0 33 37 2e 33 36 20 4f 50 52 2f 32 38 2e 30 2e 31\u00a0\u00a0 37.36 OPR\/28.0.1\n00c0 37 35 30 2e 35 31 00\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 750.51.\n\nThis response not only provides the malware with a number of domains to navigate to, but also the user-agent that the CEF will use for these requests.\n\nAfter the previously downloaded cabinet file is extracted, the malware will load a series of functions from the libcef.dll library in the same manner witnessed earlier. In other words, the malware uses hashed representations of CEF function names to deter static analysis.\n\n\nFigure 5 Ramdo loading CEF functions by hash\nThe following CEF functions are loaded by the malware:\n\n\tcef_string_utf16_clear\n\tcef_string_utf16_set\n\tcef_string_utf16_cmp\n\tcef_string_utf8_to_utf16\n\tcef_string_utf8_clear\n\tcef_string_utf16_to_utf8\n\tcef_string_list_copy\n\tcef_string_userfree_utf16_free\n\tcef_shutdown\n\tcef_run_message_loop\n\tcef_quit_message_loop\n\tcef_currently_on\n\tcef_refresh_web_plugins\n\tcef_add_web_plugin_directory\n\tcef_api_hash\n\tcef_post_task\n\tcef_post_delayed_task\n\tcef_browser_host_create_browser\n\tcef_string_list_free\n\tcef_string_list_alloc\n\tcef_v8value_create_function\n\tcef_process_message_create\n\tcef_string_multimap_free\n\tcef_string_multimap_alloc\n\tcef_request_create\n\tcef_string_list_append\n\tcef_string_map_append\n\tcef_string_multimap_append\n\tcef_string_list_value\n\tcef_string_list_size\n\tcef_string_map_value\n\tcef_string_map_key\n\tcef_string_map_size\n\tcef_string_multimap_value\n\tcef_string_multimap_key\n\tcef_string_multimap_size\n\tcef_string_map_free\n\tcef_string_map_alloc\n\tcef_initialize\n\nThese listed functions will then be used by the CEF browser to navigate to the previously instructed web pages. When making requests to the specific sites, CEF will crawl all links discovered on the returned HTML. For example, given the site of \u2018search-spinner[.]com\u2019, the web page has a link to \u20182026531.adsdomain[.]org\u2019, which in turn leads to further ad-related webpages.\n\n\nFigure 6 Result of navigating to search-spinner[.]com\nAs you can surmise, the distributor of this malware can easily change these links to whatever ad-generating URLs he or she wishes. This coupled with the dynamic requests made to the C2s for the original URLs\/domains to view allow the malware distributor to easily modify their actions to maximize profits.\n\nThe link provided by search-spinner[.]com and other sites appears to change every time a user navigates to it, providing additional ad revenue for the attacker, and ensuring that a single web site is not browsed too often.\nConclusion\nOverall, Ramdo is not an overly complicated or sophisticated family of malware. It was created with a single purpose in mind\u2014to generate revenue by falsely navigating to specific ad-generating web pages.\n\nThat being said, it does employ various interesting tricks to avoid being run in sandboxed environments, or virtual environments, such as detection for vmware and virtualbox, as well as checking the DNS response of requests made to google.com. What is quite interesting is the fact that the malware does not completely stop running when running within a virtualized environment, but instead modifies the generated domains that the malware connects to. This provides not only an early warning to the attackers that a sample is being executed in such an environment, but also may lead to researchers tracing incorrect domains during analysis.\n\nFor further information on the Ramdo malware family, including telemetry and its overall threat landscape, please refer to our joint-published blog post with Dell Secureworks CTU.\n\nPalo Alto Networks customers are protected by this threat in the following ways:\n\n\tWildFire correctly detects all samples as malicious\n\tC2 domains used by Ramdo are marked malicious\n\tAutoFocus tag correctly detects Ramdo samples\n\nIndicators of Compromise\nSHA256 Hashes\nRecent hashes of Ramdo can be found here.\nDomains\nA list of discovered C2 servers can be found here.\nRegistry Keys\nHKCU\\SOFTWARE\\Adobe\\Acrobat Reader\\14.0\\Globals\\LastLoggedOnProvider\nHKCU\\SOFTWARE\\Adobe\\Acrobat Reader\\14.0\\Globals\\IconUnderline\nHKCU\\SOFTWARE\\Adobe\\Acrobat Reader\\14.0\\Globals\\HangDetect\nHKCU\\SOFTWARE\\Adobe\\Acrobat Reader\\14.0\\Globals\\LastProgress\nHKCU\\SOFTWARE\\Adobe\\Acrobat Reader\\14.0\\Globals\\ShowTabletKeyboard\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\BluetoothManage\nFile Modifications\n%APPDATA%\\Microsoft\\btstack.dll\nRelevant Links\n\n\tMSRT April 2014 \u2013 RamdoM\n\tWhat do Win32\/Redyms and TDL4 have in common?\n\tBehind the Ramdo DGA (Domain Generation Algorithm)\n","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"","width":"","height":""},"author":[{"@type":"Person","name":"Josh Grunzweig"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"12950","token":"7e15a0f8b3","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=12950' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-ramdo%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-ramdo%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-12950 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Click-Fraud Ramdo Malware Family Continues to Plague Users</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-12950 entry-meta">
			
			
			<span class="post-views-count">10,173</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'12950','like')"><i class="ui ui-2"></i><span class="ml-5">0</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 10</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-ramdo%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-ramdo%2F+-+Click-Fraud+Ramdo+Malware+Family+Continues+to+Plague+Users" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-ramdo%2F&title=Click-Fraud+Ramdo+Malware+Family+Continues+to+Plague+Users&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/unit42-ramdo/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/joshgruznweig/" title="Posts by Josh Grunzweig" class="author url fn" rel="author">Josh Grunzweig</a>        </p>
        <p><time datetime="2016-04-11T02:00:04+00:00">April 11, 2016 at 5:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/malware-2/" rel="category tag">Malware</a>, <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/dell-secureworks/" rel="tag">Dell Secureworks</a>, <a href="https://unit42.paloaltonetworks.com/tag/idapython/" rel="tag">IDAPython</a>, <a href="https://unit42.paloaltonetworks.com/tag/python/" rel="tag">Python</a>, <a href="https://unit42.paloaltonetworks.com/tag/ramdo/" rel="tag">Ramdo</a>, <a href="https://unit42.paloaltonetworks.com/tag/virtualalloc/" rel="tag">VirtualAlloc</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/unit42-ramdo/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><p><em>Be the first to receive the latest news, cyber threat intelligence and research from Unit 42. <a href="https://www.paloaltonetworks.com/threat-research">Subscribe Now</a>. </em></p>
<p>Ramdo is a family of malware that performs fraudulent website ‘clicks.’ Ramdo malware activity first surfaced in late 2013 and has since continued to infect machines worldwide, primarily through the use of exploit kits. In this blog post, we’ll take a deep dive into the technical aspects of the Ramdo malware itself, providing insight into how the malware functions, as well as techniques on how analysts can reverse-engineer this particular threat.</p>
<p>This research is a joint effort from Unit 42 and Dell Secureworks Counter Threat Unit. For more information about the Ramdo threat, please also refer to<a href="https://www.secureworks.com/blog/ramdo-click-fraud-malware" target="_blank"> the published blog post from Dell Secureworks CTU</a>.</p>
<p>For the remainder of this blog post, we will be dealing with the following sample, which first surfaced on January 22, 2016.<span id="more-12950"></span></p>
<p>MD5:       F0E64CC571590513D0DC8D37EA23D153<br />
SHA1:     98D44A46E9DAD00748D0278C84B58CE36D5E8861<br />
SHA256:   B534D55F384F4A2F9F8762CCD360A7C5D3FBD9BA15B1671E4A3629EF69A4472B<br />
Size:     163328 Bytes<br />
File Type: PE32 executable (GUI) Intel 80386, for MS Windows<br />
Compile:   2016-01-22 23:46:15</p>
<p>Most of the Ramdo samples witnessed in the wild are obfuscated using a simple packer. As such, the sample will first be unpacked in order to analyze the underlying, un-obfuscated malware.</p>
<h3>Unpacking</h3>
<p>The Ramdo malware is contained within a DLL. Packers will often store this DLL in an obfuscated state within an executable binary. When run, the executable will load this DLL after de-obfuscating it. Unpacking this sample is a simple matter of setting a breakpoint on calls to VirtualAlloc, and then setting a write hardware breakpoint on a byte within this newly allocated memory.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/ramdo1.png"  rel="wpdevart_lightbox attachment wp-att-13183" ><img class="aligncenter size-large wp-image-13183" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/ramdo1-500x383.png" alt="ramdo1" width="500" height="383" /></a></p>
<p style="text-align: center;">Figure 1 Breaking on calls to VirtualAlloc</p>
<p>After roughly two calls to VirtualAlloc, we witness the unpacked executable being written to this section. At this point it is simply a matter of dumping this memory section to disk.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/ramdo2.png"  rel="wpdevart_lightbox attachment wp-att-13184" ><img class="aligncenter size-large wp-image-13184" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/ramdo2-500x432.png" alt="ramdo2" width="500" height="432" /></a></p>
<p style="text-align: center;">Figure 2 Dumping un-obfuscated DLL from packed dropper</p>
<p>At this point we have the unpacked version of the Ramdo DLL, which can be used for further analysis.</p>
<h3>Analyzing Ramdo DLL</h3>
<p>One of the first problems the analyst will encounter when reversing a Ramdo DLL is the author’s use of encrypted strings and hashed functions. Functions are hashed using the following algorithm, represented in Python:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c3cd5aaa301263859" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def hash_function(name):
  x = 0xFFFFFFFF
  for n in name:
    x = ((x &gt;&gt; 8) ^ x * (x ^ ord(n))) &amp; 0xFFFFFFFF
  return x</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c3cd5aaa301263859-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c3cd5aaa301263859-2">2</div><div class="crayon-num" data-line="crayon-5f694c3cd5aaa301263859-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c3cd5aaa301263859-4">4</div><div class="crayon-num" data-line="crayon-5f694c3cd5aaa301263859-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c3cd5aaa301263859-1"><span class="crayon-e">def </span><span class="crayon-e">hash_function</span><span class="crayon-sy">(</span><span class="crayon-v">name</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c3cd5aaa301263859-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0xFFFFFFFF</span></div><div class="crayon-line" id="crayon-5f694c3cd5aaa301263859-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">n</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c3cd5aaa301263859-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-e ">x *</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xFFFFFFFF</span></div><div class="crayon-line" id="crayon-5f694c3cd5aaa301263859-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">x</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p><a href="https://github.com/pan-unit42/public_tools/blob/master/ramdo/generate_function_hashes.py">A script has been provided</a> that will generate a C header file containing an enumeration of these hashed function. Please note that this script must run on a Windows machine.</p>
<p>Additionally, strings are encrypted using a single-byte XOR key. A large array of the following data structures are used:</p>
<p><em>[WORD] XOR Key</em><br />
<em>[WORD] Length</em><br />
<em>[DWORD] Offset to Data</em></p>
<p>This can be better visualized in the following screenshot:</p>
<p><img class="aligncenter size-large wp-image-13185" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/ramdo3-500x187.png" alt="ramdo3" width="500" height="187" /></p>
<p style="text-align: center;">Figure 3 Array of data structures containing encrypted strings</p>
<p><a href="https://github.com/pan-unit42/public_tools/blob/master/ramdo/ida_ramdo_decrypt_strings.py">An IDAPython script has been provided</a> that will parse and decrypt these encrypted strings. Please note that the start address of the previously mentioned data structures must be set for this script to work.</p>
<p>After both the obfuscated functions and encrypted strings have been reverted to their original form, analysis of the Ramdo DLL becomes much easier.</p>
<p>The malware initially attempts to determine if it is running within a sandbox. This is further described within the blog post written by Dell Secureworks CTU. In the event it believes it is running within a sandbox, it will enter an infinite loop.</p>
<p>The malware proceeds to query the victim machine’s GUID via the following registry key:</p>
<p><em>HKLM\SOFTWARE\Microsoft\Cryptography\MachineGuid</em></p>
<p>A string of ‘qK’ is appended to this value. This data is eventually used as a RC4 key. The malware will attempt to read the following registry key. Should this key exist, the malware will decrypt this data using the RC4 algorithm and the previously mentioned key.</p>
<p><em>HKCU\SOFTWARE\Adobe\Acrobat Reader\14.0\Globals\LastLoggedOnProvider</em></p>
<p>This registry key is used to instruct Ramdo to install itself. Should this registry key have a value of zero, it will proceed. The malware then attempts to read the following registry key:</p>
<p><em>HKCU\SOFTWARE\Adobe\Acrobat Reader\14.0\Globals\IconUnderline</em></p>
<p>Should this key not exist, it is set with a value of zero. Should this key have a value of zero, it proceeds.</p>
<p>Ramdo continues to disable tooltips by setting the following registry key to zero, thus disabling balloon tooltips from appearing on the victim machine:</p>
<p><em>HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\EnableBalloonTips</em></p>
<p>Disabling this setting prevents the malware from generating pop-up notifications that might otherwise notify the victim that something unusual is happening.</p>
<p>During Ramdo’s operations, the following mutexes are used by the malware:</p>
<ul>
<li>Global\[machine GUID]qK-fffffffe</li>
<li>Global\[machine GUID]qK-fffffffd</li>
</ul>
<p>Ramdo then copies itself (executable dropper) to the following location:</p>
<p><em>%APPDATA%\Microsoft\btstack.dll</em></p>
<p>This file has its timestamp data modified to help hide it from defenders.</p>
<p>The following registry key is written to ensure that btstack.dll is loaded upon reboot:</p>
<p><em>HKCU\Software\Microsoft\Windows\CurrentVersion\Run\BluetoothManage &#8211; rundll32.exe &#8220;%appdata%\Microsoft\btstack.dll&#8221;,init</em></p>
<p>At this point, the malware will identify a running Microsoft Windows process and in turn identify the path to the associated executable file. This executable is spawned in a new suspended process, and the following code is injected prior to resuming the process:</p>
<p>call     $+5<br />
pop     eax<br />
sub     eax, 0FFFFFFE6h ; EAX contains Path to btstack.dll<br />
mov    ebx, 76C0F0F2h<br />
push   eax<br />
call      ebx ; LoadLibraryW<br />
mov     eax, 76C0C426h<br />
push    0FFFFFFFFh<br />
call      eax ; Sleep</p>
<p>This code will load in the previously written btstack.dll, which will load the malware into a legitimate Microsoft Windows process. Should this prove successful, the malware will exit.</p>
<p>In the event the malware is already running within a Microsoft Windows process, the malware proceeds to spawn a new thread that begins by setting the previously mentioned LasLoggedOnProvider registry key with the RC4 encrypted configuration data that is stored within the binary.</p>
<p>Before any network activity is performed, Ramdo will check to see if it is running within a virtualized environment. The CTU blog post further explains how this occurs. Should Ramdo discover it is running in a virtualized environment, the seeds used for subsequent domain name generation are altered, resulting in connections to incorrectly generated domain names.</p>
<p>Ramdo then attempts to determine if it is connected to the Internet by making a simple HTTP request. Note the lack of HTTP headers, such as a user-agent in the following request:</p>
<p>GET / HTTP/1.1<br />
Host: www.google.com</p>
<p>Prior to making this request to google.com, Ramdo first checks the DNS response to ensure at least two IP addresses were returned in the query. In the event only a single IP address is returned, the malware will not continue its execution flow. Instead, it will sleep until the next iteration of its network communication loop.</p>
<p>If Ramdo determines it is connected to the Internet, it proceeds to generate a domain using the following algorithm. The two seeds are hardcoded within the sample. The second seed increments by one up until twenty to generate all permutations of domains used by the malware. The third value is set to zero if no virtualized environments are detected. Should a virtualized environment be detected, the generated domains are incorrect.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c3cd5ab4750130717" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def generate_dga(s1, s2, vm_detect=0):
  v1 = (s1 * (s2+1)) ^ (0x777 * (s1 + vm_detect))
  v2 = v1 ^ (26 * s2 * s1)
  domain = ""
  for c in range(16):
    v3 = (v2 % 0x1A) + 32
    domain += chr(v3)
    v2 += (v2 ^ (26 * v1 * c * c)) 
    v2 = v2 &amp; 0xFFFFFFFF

  new_domain = "https://"
  for d in domain:
    if ord(d) == 0x10:
      new_domain += "-"
    else:
      new_domain += chr(ord(d) + 65)
  new_domain += ".org"
  return new_domain</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c3cd5ab4750130717-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c3cd5ab4750130717-2">2</div><div class="crayon-num" data-line="crayon-5f694c3cd5ab4750130717-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c3cd5ab4750130717-4">4</div><div class="crayon-num" data-line="crayon-5f694c3cd5ab4750130717-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c3cd5ab4750130717-6">6</div><div class="crayon-num" data-line="crayon-5f694c3cd5ab4750130717-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c3cd5ab4750130717-8">8</div><div class="crayon-num" data-line="crayon-5f694c3cd5ab4750130717-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c3cd5ab4750130717-10">10</div><div class="crayon-num" data-line="crayon-5f694c3cd5ab4750130717-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c3cd5ab4750130717-12">12</div><div class="crayon-num" data-line="crayon-5f694c3cd5ab4750130717-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c3cd5ab4750130717-14">14</div><div class="crayon-num" data-line="crayon-5f694c3cd5ab4750130717-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c3cd5ab4750130717-16">16</div><div class="crayon-num" data-line="crayon-5f694c3cd5ab4750130717-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c3cd5ab4750130717-18">18</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c3cd5ab4750130717-1"><span class="crayon-e">def </span><span class="crayon-e">generate_dga</span><span class="crayon-sy">(</span><span class="crayon-v">s1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vm_detect</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c3cd5ab4750130717-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">v1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">s1 *</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">s2</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0x777</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">s1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">vm_detect</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c3cd5ab4750130717-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">v2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">v1</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">26</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e ">s2 *</span><span class="crayon-h"> </span><span class="crayon-v">s1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c3cd5ab4750130717-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">domain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5f694c3cd5ab4750130717-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">16</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c3cd5ab4750130717-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">v2</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-cn">0x1A</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">32</span></div><div class="crayon-line" id="crayon-5f694c3cd5ab4750130717-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">domain</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-v">v3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c3cd5ab4750130717-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v2</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">v2</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">26</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e ">v1 *</span><span class="crayon-h"> </span><span class="crayon-e ">c *</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5f694c3cd5ab4750130717-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">v2</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xFFFFFFFF</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c3cd5ab4750130717-10">&nbsp;</div><div class="crayon-line" id="crayon-5f694c3cd5ab4750130717-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">new_domain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"https://"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c3cd5ab4750130717-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">domain</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c3cd5ab4750130717-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">d</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0x10</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c3cd5ab4750130717-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_domain</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">"-"</span></div><div class="crayon-line" id="crayon-5f694c3cd5ab4750130717-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c3cd5ab4750130717-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_domain</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">d</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c3cd5ab4750130717-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">new_domain</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">".org"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c3cd5ab4750130717-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">new_domain</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>The following IDAPython script can be used to identify the DGA algorithm and seeds used. It will then proceed to generate the 20 permutations of domains used by Ramdo. Note that this script is not guaranteed to work on all variants of Ramdo due to minor changes that may have been made in the DGA algorithm. The following example output from the script demonstrates what information is provided to the analyst:</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/ramdo4.png"  rel="wpdevart_lightbox attachment wp-att-13186" ><img class="aligncenter size-large wp-image-13186" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/ramdo4-500x299.png" alt="ramdo4" width="500" height="299" /></a></p>
<p style="text-align: center;">Figure 4 Output from IDAPython script</p>
<p>After the domain has been generated, the malware will make a HTTPS POST request, such as the following:</p>
<p><em>POST / HTTP/1.1</em><br />
<em>Content-Length: 128</em><br />
<em>Host: qgwwyeeouiouwkya[.]org</em><br />
<em>Cache-Control: no-cache</em></p>
<p><em>[Encrypted Data]</em></p>
<p>In the above request, data is encrypted using the RSA algorithm. The following base64-encoded public key is used to encrypt this data. It should be noted that this key has changed since <a href="https://blogs.technet.microsoft.com/mmpc/2014/04/02/msrt-april-2014-ramdo/">Microsoft initially analyzed Ramdo</a>, indicating that Ramdo continues to evolve over time.</p>
<p><em>BgIAAACkAABSU0ExAAQAAAEAAQDJ9Nl4XvlyD9PmguEaeUt2auCZm2994<br />
FcdY2aCGMuYvc71sqLkOyf3Q1Cp4q/s3CXgXr5ifomWiF4D22eWsEPqoI1RyZ<br />
8LwYaCVD11WrwtoST4BPwMPARLvNJGvAKzcXpn1adDvprXsfGW1r3YeKP<br />
w6KZLPdCfvLBl3U9xTJ8lrg==</em></p>
<p>The encrypted data is formatted using the following string:</p>
<p><em>v=%d&amp;w=%1d:%1d:%04d:%1d:%1d:%1d:%1d:%1d&amp;b=%s&amp;s=%d&amp;k=%d&amp;c=%d&amp;x=%d&amp;i=%d</em></p>
<p>The following variables contain the associated data:</p>
<p><em>v : Suspected version of Ramdo</em><br />
<em>w : Operating system version, build number, service pack, virtualization information</em><br />
<em>b : Machine GUID string with &#8216;qK&#8217; appended</em><br />
<em>s : Static value</em><br />
<em>k : Randomized value</em><br />
<em>c : Config Data (ShowTabletKeyboard registry key)</em><br />
<em>x : DGA seed</em><br />
<em>i : Iteration of the second DGA seed</em></p>
<p>The server response begins with the following format:</p>
<p><em>OK[k value from request]\r\n[command][data]</em></p>
<p>Where ‘k value from request’ is the decrypted ‘k’ GET parameter sent in the request by Ramdo. The server response is RC4-encrypted using the decrypted ‘b’ GET parameter sent in the request from Ramdo.</p>
<p>The command value can be any of the following, represented in binary form:</p>
<p><em>1 : Update the LastLoggedOnUser registry key</em><br />
<em>2 : Update the btstack.dll executable</em><br />
<em>3 : Update the ShowTabletKeyboard registry key</em><br />
<em>5 : Update the HangDetect and LastProgress registry key</em></p>
<p>The following example C2 response demonstrates a response with a command of five:</p>
<p>00000000: 4F 4B 31 31 30 35 39 32 38 32 0D 0A 05 2F 30 38 OK11059282&#8230;/08<br />
00000010: 2E 63 61 62 3B                                   .cab;</p>
<p>Ramdo continues to both download and extract this cabinet file, which contains a copy of the <a href="https://en.wikipedia.org/wiki/Chromium_Embedded_Framework">Chromium Embedded Framework (CEF)</a>. The CEF will be used by the malware to conduct click fraud.</p>
<p>The malware proceeds to make a subsequent request to the C2 server. The server responds in a similar fashion to the previously mentioned one. One example C2 response can be seen below:</p>
<p>0000 4f 4b 31 35 36 37 34 31 32 34 0d 0a 03 01 00 00   OK15674124&#8230;&#8230;<br />
0010 00 23 00 00 00 3c 00 00 00 05 00 00 00 06 00 00   .#&#8230;&lt;&#8230;&#8230;&#8230;.<br />
0020 00 73 65 61 72 63 68 2d 73 70 69 6e 6e 65 72 2e   .search-spinner.<br />
0030 63 6f 6d 3b 73 65 61 72 63 68 2d 66 69 63 74 69   com;search-ficti<br />
0040 6f 6e 2e 63 6f 6d 00 4d 6f 7a 69 6c 6c 61 2f 35   on.com.Mozilla/5<br />
0050 2e 30 20 28 57 69 6e 64 6f 77 73 20 4e 54 20 31   .0 (Windows NT 1<br />
0060 30 2e 30 3b 20 57 4f 57 36 34 29 20 41 70 70 6c   0.0; WOW64) Appl<br />
0070 65 57 65 62 4b 69 74 2f 35 33 37 2e 33 36 20 28   eWebKit/537.36 (<br />
0080 4b 48 54 4d 4c 2c 20 6c 69 6b 65 20 47 65 63 6b   KHTML, like Geck<br />
0090 6f 29 20 43 68 72 6f 6d 65 2f 34 31 2e 30 2e 32   o) Chrome/41.0.2<br />
00a0 32 37 32 2e 31 31 38 20 53 61 66 61 72 69 2f 35   272.118 Safari/5<br />
00b0 33 37 2e 33 36 20 4f 50 52 2f 32 38 2e 30 2e 31   37.36 OPR/28.0.1<br />
00c0 37 35 30 2e 35 31 00                             750.51.</p>
<p>This response not only provides the malware with a number of domains to navigate to, but also the user-agent that the CEF will use for these requests.</p>
<p>After the previously downloaded cabinet file is extracted, the malware will load a series of functions from the libcef.dll library in the same manner witnessed earlier. In other words, the malware uses hashed representations of CEF function names to deter static analysis.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/ramdo5.png"  rel="wpdevart_lightbox attachment wp-att-13187" ><img class="aligncenter size-large wp-image-13187" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/ramdo5-500x271.png" alt="ramdo5" width="500" height="271" /></a></p>
<p style="text-align: center;">Figure 5 Ramdo loading CEF functions by hash</p>
<p>The following CEF functions are loaded by the malware:</p>
<ul>
<li>cef_string_utf16_clear</li>
<li>cef_string_utf16_set</li>
<li>cef_string_utf16_cmp</li>
<li>cef_string_utf8_to_utf16</li>
<li>cef_string_utf8_clear</li>
<li>cef_string_utf16_to_utf8</li>
<li>cef_string_list_copy</li>
<li>cef_string_userfree_utf16_free</li>
<li>cef_shutdown</li>
<li>cef_run_message_loop</li>
<li>cef_quit_message_loop</li>
<li>cef_currently_on</li>
<li>cef_refresh_web_plugins</li>
<li>cef_add_web_plugin_directory</li>
<li>cef_api_hash</li>
<li>cef_post_task</li>
<li>cef_post_delayed_task</li>
<li>cef_browser_host_create_browser</li>
<li>cef_string_list_free</li>
<li>cef_string_list_alloc</li>
<li>cef_v8value_create_function</li>
<li>cef_process_message_create</li>
<li>cef_string_multimap_free</li>
<li>cef_string_multimap_alloc</li>
<li>cef_request_create</li>
<li>cef_string_list_append</li>
<li>cef_string_map_append</li>
<li>cef_string_multimap_append</li>
<li>cef_string_list_value</li>
<li>cef_string_list_size</li>
<li>cef_string_map_value</li>
<li>cef_string_map_key</li>
<li>cef_string_map_size</li>
<li>cef_string_multimap_value</li>
<li>cef_string_multimap_key</li>
<li>cef_string_multimap_size</li>
<li>cef_string_map_free</li>
<li>cef_string_map_alloc</li>
<li>cef_initialize</li>
</ul>
<p>These listed functions will then be used by the CEF browser to navigate to the previously instructed web pages. When making requests to the specific sites, CEF will crawl all links discovered on the returned HTML. For example, given the site of ‘search-spinner[.]com’, the web page has a link to ‘2026531.adsdomain[.]org’, which in turn leads to further ad-related webpages.</p>
<p><a href="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/ramdo6.png"  rel="wpdevart_lightbox attachment wp-att-13188" ><img class="aligncenter size-large wp-image-13188" src="http://researchcenter.paloaltonetworks.com/wp-content/uploads/2016/04/ramdo6-500x152.png" alt="ramdo6" width="500" height="152" /></a></p>
<p style="text-align: center;">Figure 6 Result of navigating to search-spinner[.]com</p>
<p>As you can surmise, the distributor of this malware can easily change these links to whatever ad-generating URLs he or she wishes. This coupled with the dynamic requests made to the C2s for the original URLs/domains to view allow the malware distributor to easily modify their actions to maximize profits.</p>
<p>The link provided by search-spinner[.]com and other sites appears to change every time a user navigates to it, providing additional ad revenue for the attacker, and ensuring that a single web site is not browsed too often.</p>
<h3>Conclusion</h3>
<p>Overall, Ramdo is not an overly complicated or sophisticated family of malware. It was created with a single purpose in mind—to generate revenue by falsely navigating to specific ad-generating web pages.</p>
<p>That being said, it does employ various interesting tricks to avoid being run in sandboxed environments, or virtual environments, such as detection for vmware and virtualbox, as well as checking the DNS response of requests made to google.com. What is quite interesting is the fact that the malware does not completely stop running when running within a virtualized environment, but instead modifies the generated domains that the malware connects to. This provides not only an early warning to the attackers that a sample is being executed in such an environment, but also may lead to researchers tracing incorrect domains during analysis.</p>
<p>For further information on the Ramdo malware family, including telemetry and its overall threat landscape, please refer to our <a href="https://www.secureworks.com/blog/ramdo-click-fraud-malware" target="_blank">joint-published blog post with Dell Secureworks CTU.</a></p>
<p><span style="line-height: 1.5;">Palo Alto Networks customers are protected by this threat in the following ways:</span></p>
<ul>
<li>WildFire correctly detects all samples as malicious</li>
<li>C2 domains used by Ramdo are marked malicious</li>
<li>AutoFocus <a href="https://autofocus.paloaltonetworks.com/#/tag/Commodity.Ramdo">tag</a> correctly detects Ramdo samples</li>
</ul>
<h3>Indicators of Compromise</h3>
<h4>SHA256 Hashes</h4>
<p>Recent hashes of Ramdo can be found <a href="https://github.com/pan-unit42/iocs/blob/master/ramdo/hashes.txt">here</a>.</p>
<h4>Domains</h4>
<p>A list of discovered C2 servers can be found <a href="https://github.com/pan-unit42/iocs/blob/master/ramdo/domains.txt">here</a>.</p>
<h4>Registry Keys</h4>
<p>HKCU\SOFTWARE\Adobe\Acrobat Reader\14.0\Globals\LastLoggedOnProvider<br />
HKCU\SOFTWARE\Adobe\Acrobat Reader\14.0\Globals\IconUnderline<br />
HKCU\SOFTWARE\Adobe\Acrobat Reader\14.0\Globals\HangDetect<br />
HKCU\SOFTWARE\Adobe\Acrobat Reader\14.0\Globals\LastProgress<br />
HKCU\SOFTWARE\Adobe\Acrobat Reader\14.0\Globals\ShowTabletKeyboard<br />
HKCU\Software\Microsoft\Windows\CurrentVersion\Run\BluetoothManage</p>
<h4>File Modifications</h4>
<p>%APPDATA%\Microsoft\btstack.dll</p>
<h4>Relevant Links</h4>
<ul>
<li><a href="https://blogs.technet.microsoft.com/mmpc/2014/04/02/msrt-april-2014-ramdo/">MSRT April 2014 – RamdoM</a></li>
<li><a href="http://www.welivesecurity.com/2013/02/04/what-do-win32redyms-and-tdl4-have-in-common/">What do Win32/Redyms and TDL4 have in common?</a></li>
<li><a href="https://www.damballa.com/behind-ramdo-dga-domain-generation-algorithm/">Behind the Ramdo DGA (Domain Generation Algorithm)</a></li>
</ul>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
