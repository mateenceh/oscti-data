
<!doctype html>
<html lang="en-US">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="preload" href="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/clearbit-autocomplete.css" as="style">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://usageanalytics.coveo.com">
  <link rel="preconnect" href="https://paloaltonetworks.tt.omtrdc.net">
  <link rel="preconnect" href="https://platform.cloud.coveo.com">
  <link rel="preconnect" href="https://assets.adobedtm.com">
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
  <!-- Adobe -->
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {opacity: 0 !important}", 3000));
</script>
<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<!-- End Adobe -->
  
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700&display=swap" rel="stylesheet">

  <!-- Typekit -->
  <!--
  <script src="//use.typekit.net/itd3sep.js"></script>
  <script>try{Typekit.load({ async: true });}catch(e){}</script>-->
  <!-- End Typekit -->

 


    


<link rel="apple-touch-icon" sizes="57x57" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/favicon-194x194.png" sizes="194x194">
<link rel="icon" type="image/png" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/manifest.json">
<link rel="mask-icon" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/safari-pinned-tab.svg" color="#8ad3de">
<link rel="shortcut icon" href="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/assets/images/icons/favicon.ico">
<meta name="msapplication-TileImage" content="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/mstile-144x144.png">
<meta name="msapplication-config" content="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/browserconfig.xml">
<meta name="msapplication-TileColor" content="#da532c">




  <!-- Start WP HEAD -->
  <link rel="alternate" hreflang="en" href="https://blog.paloaltonetworks.com/2016/09/labyrenth-capture-the-flag-ctf-threat-track-solutions/" />

	<!-- This site is optimized with the Yoast SEO plugin v14.2 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>LabyREnth Capture the Flag (CTF): Threat Track Solutions</title>
	<meta name="description" content="Now that LabyREnth Capture the Flag (CTF) challenge is closed, we’ll roll out the solutions for one challenge track per week. This week, the Threat Track." />
	<meta name="robots" content="index, follow" />
	<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<link rel="canonical" href="https://blog.paloaltonetworks.com/2016/09/labyrenth-capture-the-flag-ctf-threat-track-solutions/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="LabyREnth Capture the Flag (CTF): Threat Track Solutions" />
	<meta property="og:description" content="Now that LabyREnth Capture the Flag (CTF) challenge is closed, we’ll roll out the solutions for one challenge track per week. This week, the Threat Track." />
	<meta property="og:url" content="https://blog.paloaltonetworks.com/2016/09/labyrenth-capture-the-flag-ctf-threat-track-solutions/" />
	<meta property="og:site_name" content="Palo Alto Networks Blog" />
	<meta property="article:published_time" content="2016-09-02T00:37:34+00:00" />
	<meta property="article:modified_time" content="2016-09-02T00:57:30+00:00" />
	<meta property="og:image" content="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_1-500x289.png" />
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Palo Alto Networks Blog &raquo; Feed" href="https://blog.paloaltonetworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Palo Alto Networks Blog &raquo; Comments Feed" href="https://blog.paloaltonetworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Palo Alto Networks Blog &raquo; LabyREnth Capture the Flag (CTF): Threat Track Solutions Comments Feed" href="https://blog.paloaltonetworks.com/2016/09/labyrenth-capture-the-flag-ctf-threat-track-solutions/feed/" />
<meta property="og:date_created" content="September 1, 2016 at 5:37 PM"/>
<meta property="og:post_image" content=""/>
<meta property="og:post_id" content="18169"/>
<meta property="og:post_total_likes" content="1"/>
<meta property="og:post_length" content="6924"/>
<meta property="og:category" content="Events"/>
<meta property="og:category_link" content="https://blog.paloaltonetworks.com/category/events/"/>
<meta property="og:author" content="Richard Wartell"/>
<meta property="og:author" content="Micah Yates"/>
<meta property="og:author" content="Jeff White"/>
<meta property="og:author" content="Josh Grunzweig"/>
<meta property="og:author" content="Anthony Kasza"/>
<meta property="og:authorloginname" content="Richard Wartell"/>
<meta property="og:authorloginname" content="Micah Yates"/>
<meta property="og:authorloginname" content="Jeff White"/>
<meta property="og:authorloginname" content="Josh Grunzweig"/>
<meta property="og:authorloginname" content="Anthony Kasza"/>
<meta property="og:authorlink" content="https://blog.paloaltonetworks.com/author/richard-wartell/"/>
<meta property="og:authorlink" content="https://blog.paloaltonetworks.com/author/micah-yates/"/>
<meta property="og:authorlink" content="https://blog.paloaltonetworks.com/author/jeff-white/"/>
<meta property="og:authorlink" content="https://blog.paloaltonetworks.com/author/josh-grunzweig/"/>
<meta property="og:authorlink" content="https://blog.paloaltonetworks.com/author/anthony-kasza/"/>
<meta property="og:author_image_link" content="https://blog.paloaltonetworks.com/wp-content/uploads/2017/05/unit42_400x400.jpg"/>
<meta property="og:author_image_link" content="https://blog.paloaltonetworks.com/wp-content/uploads/2020/03/panw_master-twitter-profile-pic-400x400-1.png"/>
<meta property="og:author_image_link" content="https://blog.paloaltonetworks.com/wp-content/uploads/2017/05/unit42_400x400.jpg"/>
<meta property="og:author_image_link" content="https://blog.paloaltonetworks.com/wp-content/uploads/2017/05/unit42_400x400.jpg"/>
<meta property="og:author_image_link" content="https://blog.paloaltonetworks.com/wp-content/uploads/2017/05/unit42_400x400.jpg"/>
<meta property="og:section" content="Palo Alto Networks"/>
<meta property="og:recent_views" content="1556"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"LabyREnth Capture the Flag (CTF): Threat Track Solutions","name":"LabyREnth Capture the Flag (CTF): Threat Track Solutions","description":"Welcome back to our blog series where we reveal the\u00a0solutions\u00a0to LabyREnth, the Unit 42 Capture the Flag (CTF)\u00a0challenge. We\u2019ll be revealing the solutions to one challenge track per week. Next up, the &hellip;","url":"https:\/\/blog.paloaltonetworks.com\/2016\/09\/labyrenth-capture-the-flag-ctf-threat-track-solutions\/","mainEntityOfPage":"https:\/\/blog.paloaltonetworks.com\/2016\/09\/labyrenth-capture-the-flag-ctf-threat-track-solutions\/","datePublished":"September 1, 2016","articleBody":"Welcome back to our blog series where we reveal the\u00a0solutions\u00a0to LabyREnth, the Unit 42 Capture the Flag (CTF)\u00a0challenge. We\u2019ll be revealing the solutions to one challenge track per week. Next up, the Threat track.\r\nThreat 1 Challenge: Welcome to the well of wishes!\r\nChallenge Created By: Jeff White @noottrak\r\n\r\nFor this challenge you\u2019re provided a PCAP that has 30 HTTP GET Requests to www.dopefish.com. Inside each request is the same URL to the below image and a base64, reversed, string that decodes to \u201cNot everything is as it seems...\u201d.\r\n\r\n\r\n\r\nLooking at the actual GET requests, the URL structure is interesting as there are a few sections in the URL that remain static between the URLs so we\u2019ll go ahead and extract them all for further analysis.\r\n\r\n\r\n\r\nUsing the below command extracts each URL.\r\n\r\ntcpdump -r dopefish_labyrinth.pcap -A |grep \"GET \/\" |grep -o \"\/.*\" |sort \u2013u\r\n\r\nThe general breakdown of the URL is as follows:\r\n\r\n\/M[a-zA-Z]{3}.php?=owVXdTMzc[a-zA-Z0-9]{109}&amp;L4bry1nth_[0-9]{3,5}?NxM[a-zA-Z0-9]{134}-[0-9]{4,5}%26%71%77port%3D27500\r\n\r\nDropping the URL into an online URL parser shows that the query string being supplied to the file is the entire string after the initial \u201c?\u201d, which seems odd since there appears to be other variables in the URL.\r\n\r\n\r\n\r\nFurther analysis shows that the URL is not correctly formatted as \u201c?\u201d and \u201c=\u201d are reserved characters. When they are placed next to each other, without variables in-between, the rest of the URL becomes invalid.\r\n\r\nLooking at the query string starting with \u201c=\u201d and the above hint with a reverse base64 string beginning with the same symbol, I try to base64 decode the reversed string\u2026which works, but the output is of no use.\r\n\r\n\r\n\r\nAfter taking a closer look at the URLs, I noticed there are definite patterns that stand out in the characters, but \u201cNxM\u201d continues to repeat itself roughly every 18 characters. More importantly, the NxM pattern that is seen in the first long string and the long string directly following the \u201c&amp;L4bry1nth_[0-9]{3,5}?\u201d section of the URL. By removing this and putting the two long strings together, reversing it, and base64 decoding it, we get much more usable results.\r\n\r\n\r\n\r\n\u201c317WW317WW317WW317WW317WW317WW317WW317WW317WW317WW317WW317\r\nW317WW317WW317WW317WW317WW317WW317WW317WW317WW317WW317WW317\r\nW317WW317WW317WW317WW317WW317WW317WW317WW317WW317WW317WW317\r\nW317WW317WW\u201d\r\n\r\nContinuing to build on our previous line, we wrap it in a for loop and parse out only the two halves, reverse them, and print the result.\r\n\r\nfor i in $(tcpdump -r dopefish_labyrinth.pcap -A |grep \"GET \/\" |grep -o \"\/.*\" |sort -u |cut -d\"=\" -f2 |cut -d\"-\" -f1 |sed -e 's\/&amp;L4bry1nth_.*?\/\/g'); do echo \"=$i\" |rev |base64 -D ; done\r\n\r\n\r\n\r\nThere is a very apparent pattern in the output. The last step we take is to add one more command to our line and strip out the \u201c317\u201d, which turns out was the \u201cNxM\u201d from the URL.\r\n\r\nfor i in $(tcpdump -r dopefish_labyrinth.pcap -A |grep \"GET \/\" |grep -o \"\/.*\" |sort -u |cut -d\"=\" -f2 |cut -d\"-\" -f1 |sed -e 's\/&amp;L4bry1nth_.*?\/\/g'); do echo \"=$i\" |rev |base64 -D ; done |sed -e 's\/317\/\/g'\r\n\r\n\r\n\r\nThe key is PAN{th3D0p3fshl1v3s}.\r\nThreat 2 Challenge: The rest of us, we died with our honor.\r\nChallenge Created By: Micah Yates @m1kachu_\r\n\r\nThe hint is referring to this awesome web-comic.\r\n\r\nTo begin the challenge, we are given a file named jareth1.gif\r\n\r\n\r\n\r\nThe thumbnail makes it look like a valid gif, but is it?\r\n\r\n\r\n\r\nThe file opens and animates fine.\r\n\r\nOpening the gif with a hex editor, the header looks like a regular gif header.\r\n\r\n\r\n\r\nScroll to the bottom, and this file is missing the standard gif trailer of 0x3B. (Read more about what\u2019s in a valid gif.)\r\n\r\nThe hex values at the end are not the standard gif trailer.\r\n\r\n\r\n\r\nThere is data appended to this gif.\r\n\r\nSo what do we do with this information? One trick I like to employ with tampered image files is to do a reverse image lookup via Google. I upload the jareth1.gif file to google image search and get this back:\r\n\r\n\r\n\r\nClicking through a few of the visually similar images we find this gif. It animates the same and has the same dimensions as our jareth1.gif but a different size.\r\n\r\nWhen diffing the two gifs, we can see that the original gif ended at offset 0x3436D with a valid trailer of 0x3B. Some shellcode and malware authors like to hide data by XOR-ing it with single or multi-byte hex values. Since it appears that the 0xAA bytes are repeating at the end of the file, and some data typically contains nulls, lets XOR the entire file by 0xAA.\r\n\r\nNow let\u2019s look at the leftover data\u2019s header:\r\n\r\n\r\n\r\nBased off of the header, it appears that the hidden data is a 7zip archive. Let\u2019s save off this XOR\u2019d data to another file.\r\n\r\nOne trick I like to use is 7zip\u2019s ability to unzip files when the header is in the incorrect place. Simply use the command line or right click and select 7zip -&gt; Extract here.\r\n\r\nDecompressing that file gives us another file simply named \u201cfile\u201d.\r\n\r\nTaking a quick look at the header we see that this is an html file.\r\n\r\nRenaming it to file.html and opening it with a browser yields this glorious ASCII art of David Bowie:\r\n\r\n\r\n\r\nSo what now? There\u2019s no obfuscated javascript, just a seemingly incomprehensible mess of html. It also looks as if there is a repeating pattern of A7 A0 bookending some other data.\r\n\r\nLet\u2019s drop a section of that hex looking data into a hex editor:\r\n\r\n\r\n\r\nNone of it renders into ASCII, let\u2019s try XORing it with 2 byte 0xA7A0 to see if there\u2019s data underneath:\r\n\r\n\r\n\r\nStill nothing to work with, but it does look like it could possibly be ASCII text.\r\n\r\nLet\u2019s undo that and try again with the original single byte 0xAA:\r\n\r\n\r\n\r\nMuch better. The text renders as:\r\n\r\nWrite a YARA rule to find normal valid GIF files.\r\n\r\nUsing the template below:\r\n\r\n \treplace each \"**\" pair in $header with the appropriate 6 bytes.\r\n \treplace each \"*\" in $trailer with the appropriate regex.\r\n \treplace the \"*\" in condition with the appropriate digit.\r\n\r\nrule valid_gif : valid_gif\r\n{\r\n        strings:\r\n\r\n\t\t\t$header = { ** ** ** ** ** ** }\r\n\t\t\t$trailer = *******\r\n\t\t\t\t\r\n        condition:\r\n\t\t\t$header at * and $trailer\r\n}\r\n\r\nUsing the information about proper gif structure we write the following correct rule:\r\n\r\nrule valid_gif : valid_gif\r\n{\r\n        strings:\r\n\r\n\t\t\t$header = { 47 49 46 38 39 61 }\r\n\t\t\t$trailer = \/\\x3B$\/\r\n\t\t\t\t\r\n        condition:\r\n\t\t\t$header at 0 and $trailer\r\n}\r\n\r\nAfter reading this article about what\u2019s in a gif:\r\n\r\n \tThe header is self-explanatory.\r\n \tThe regex format is required here to make sure there is no following data after the 3B\r\n \tAnd of course the header has to be at the beginning of the file at position 0\r\n\r\nSubmitting the rule above will result in the key: PAN{848Y_wIsh3D_4w4y}\r\nThreat 3 Challenge: Matryoshkas got nothing on me.\r\nChallenge Created By: Josh Grunzweig @jgrunzweig\r\n\r\nFor this challenge, we\u2019re presented with a Python script. When you run the script, the only output you receive is this:\r\n\r\npython h0ggle.py\r\nYou fell into a pit and died... of dysentery.\r\n\r\nLooking at the script, it appears to base64 decode the data and decrypt it before passing it to exec() function. The data is rather large, with over one million characters. It\u2019s using AES for the encryption from the Crypto.Cipher suite and stepping through it with a debugger shows that it continues this iteration process where each blob of data executed contains the same code with a new blob of data.\r\n\r\n\r\n\r\nFollowing this line of logic, we can quickly script out this process. We\u2019ll write each decrypted section to a new file and include the headers necessary to run it again, so on and so forth, until we reach the end.\r\n\r\nFirst, we\u2019ll create header.txt with the following data:\r\n\r\n#!\/usr\/bin\/env python\r\n\r\nfrom Crypto.Cipher import AES as tiywynstbg\r\nimport base64 as ufjliotyds\r\nimport itertools as abtwsjxzys\r\nfrom itertools import cycle, izip\r\ndef gasfewfesafds(message, key):\r\nreturn ''.join(chr(ord(c)^ord(k)) for c,k in abtwsjxzys.izip(message, abtwsjxzys.cycle(key)))\r\n\r\nNext, we\u2019ll put together a one-liner to traverse the dark depths of Python and see where it leads.\r\n\r\ncp h0ggle.py h0ggle_1.py; for i in $(seq 1 50); do sed -e 's\/exec(\/print(\/g' h0ggle_$i.py &gt; temp; mv temp h0ggle_$i.py; python h0ggle_$i.py &gt; temp; cat header.txt temp &gt; h0ggle_$((i+1)).py; done\r\n\r\nWe run into a syntax error on file h0ggle_28.py, which shows our dysentery error message.\r\n\r\nFile \"h0ggle_28.py\", line 8\r\nYou fell into a pit and died... of dysentery.\r\n^\r\n\r\nLooking at h0ggle_27.py we can see how to safely cross the river!\r\n\r\n\r\n\r\nKey = PAN{all_dir3ctionz_l3ad_n0wh3r3}\r\nThreat 4 Challenge: The same, but different.\r\nChallenge Created By: Micah Yates @m1kachu_\r\n\r\nThe hint is referring to the previous yara challenge, Threat 2 Challenge: The rest of us, we died with our honor.\r\n\r\nTo begin the challenge, we are given 6 word docs.\r\n\r\n\r\n\r\nLet\u2019s open them all up\r\n\r\n\r\n\r\nThe files open and display the somewhat same word doc.\r\n\r\nRunning the file command on all of these files results in:\r\n\r\n3673c9d7a5b2f978d3a34001d360ac485f22ed6fa868c8304eb99273a6efb268.doc: Microsoft Word 2007+\r\n668bed5ed5d5effb3be659e8dab55c63369985064f7ee80f9365e75b34f6283d.doc: Microsoft Word 2007+\r\n7717bd124dd0c0881afd6b327ff41b420bff77d3c5ae338a31cce5cfdcb3b5d0.doc: data\r\n87f146c41082d7ba885f9433e0223b346f3032f7364bf18675b924a017994779.doc: Microsoft Word 2007+\r\nafc502de73482404cc344301c207f27c7da7b31641cd2192b3bba40f3ab6964e.doc: Composite Document File V2 Document, Little Endian, Os: Windows, Version 6.1, Code page: 1252, Author: Micah Yates, Template: Normal.dotm, Last Saved By: Micah Yates, Revision Number: 2, Name of Creating Application: Microsoft Office Word, Create Time\/Date: Wed Jul 13 17:19:00 2016, Last Saved Time\/Date: Wed Jul 13 17:19:00 2016, Number of Pages: 1, Number of Words: 146, Number of Characters: 837, Security: 0\r\nd48a2f4922bca81ce8fff8c18d788f41d2034c7999ca1ed03965d914dc06a9df.doc: Rich Text Format data, version 1, unknown character set\r\n\r\nThey\u2019re not all the same file format, but all contain the same basic content. There\u2019s a .doc, .docx, .rtf, .mhtm, .dot, and .docm file with the same plaintext inside. Simply changing their extensions to .doc allows for Word to try and open them as a standard Word .doc\r\n\r\nLet\u2019s open up the RTF (d48a2f4922bca81ce8fff8c18d788f41d2034c7999ca1ed03965d914dc06a9df.doc) in a hex editor. They\u2019re typically fairly simple to follow. The header looks fine so lets scroll down to the bottom of the file.\r\n\r\n\r\n\r\nLooks weird right? Let\u2019s take a look at the RTF file format on Wikipedia, specifically the Code Syntax:\r\n\r\nGet all that?\r\n\r\nSo the TL;DR of that section states that RTF data must be within curly braces \u201c{}\u201d. This RTF file clearly has data appended to it.\r\n\r\nRemember the hint? \u201cThe same, but different.\u201dWell it seems this challenge is similar to the Threat 2 challenge. There is unknown data appended to a legitimate looking file.\r\n\r\nLet\u2019s attack the data that seems to be repeating. The appended data looks similar to base64 encoding, but somewhat obscured. Within this appended data we have 3 sequences of data that are 48 bytes long that are repeating.\r\n\r\n\r\n\r\n\r\n\r\nTwo of them are different, and of those, one is clearly not a valid Base64. (See Wikipedia\u2019s definition of Base64.)\r\n\r\nWhen there are sequences of four repeating characters in Base64 encoded data, the underlying data typically repeats in some sort of pattern. For example: AAAAAAAAA Base64 encoded is QUFBQUFBQUFB\r\n\r\nLet\u2019s assume these two different sequences are hiding the same data, but have encoded it differently due to data position. If that\u2019s true, it looks like both sequences have also been obscured by a single byte operation. So what do we do to figure out that operation? Brute Force!\r\n\r\nLet\u2019s write a small script that performs single byte operations on the two sequences and then test it to see if they\u2019re valid Base64 characters. In short, this runs a simple one byte XOR over each byte in the sequence and checks to see if they are ASCII compatible with Base64 characters.\r\nimport sys, re\r\ndata_sequence = bytearray(open(sys.argv[1], 'rb').read())\r\n\r\ntest_output = \"\"\r\n\r\nkey = range(0,255)\r\nfor i in range(len(key)):\r\n    for j in data_sequence:\r\n        test_output+=(chr(i^j))\r\n    base64_test = test_output\r\n    test_output = \"\"\r\n    if re.match(\"(?:[A-Za-z0-9+\\\/]{8})\", base64_test):\r\n        print hex(i), base64_test\r\n\r\nI truncated the two sequences above into an 8-byte sequence of data:\r\n\r\n\r\n\r\nRunning the script over these shortened sequences, it returns 4 XOR candidates:\r\n\r\n\r\n\r\nSo we have four potential XOR values that decode valid Base64 characters.\r\n\r\nStarting with XOR-ing the appended data with 0x26 we get this:\r\n\r\n\r\n\r\nLooks pretty promising, and almost all characters are Base64 standard except there are no \u201c+\u201d characters, only \u201c-\u201c.\r\n\r\nThis looks like it may be using an alternate encoding string with \u201c-\u201c in place of \u201c+\u201d. If we try and decode with this alphabet: \u201cABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-\/\u201d, there is no data that looks promising.\r\n\r\nSome malicious Base64 encodings use alternate alphabets. Sometimes they\u2019re simple and just change up the position of the alphabet. Let\u2019s write another brute force script to rotate the position of the alphabet above, decode, and test to see if it has valid ASCII text.\r\nimport string, base64, re\r\n\r\nSTANDARD_ALPHABET = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+\/'\r\nCUSTOM_ALPHABET = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-\/'\r\nROTATED_ALPHABET = CUSTOM_ALPHABET\r\ndef is_ascii(s):\r\n    return all(ord(c) &lt; 128 for c in s)\r\ninput_str = \"vRjD3gu6ysbzqvjbihjP1gu63gW6zgvOzwnOigfG1cbQyxjDyxrD1QTNigXAihrC0xm6zwT91Qr\/zcb-\r\nyxr7l6OkvxnD1A263g7\/ihr\/1xbGyxr\/igj\/1gXRihj\/2gL7yQu6zwf90ca8k8C8ihb70xi63Q\/O0cbO0gu\r\n6zA\/M2Rq6mti6yB\/OzxmUdqCncBjP1gu6zwT9xQrJyMaUigvIyPX-\r\n1QmncBGnc8a6ica6ica62RrM0wTB2NCnc6-jdqCjcq--\r\nzA\/M2Rq6psbVicCEicCEicCEicCEicCEicCEicCEicCEicCEicCEicCEicCEihOnc6-\r\njcsrNzwnJ1Aq6psbVicCEicCEicCEicCEicCEicCEicCEicCEicCEicCEicCEicCEihOnc6-\r\njcsrO0g\/MzcaXihG6k8C6k8C6k8C6k8C6k8C6k8C6k8C6k8C6k8C6k8C6k8C6k8C65qOkcq\r\n-jcqOkica6ica6icb91QT-0xrD1QSUdqCjcq-LigXAihrCzwOncBOa\"\r\n\r\ndef alt_decode(input):\r\n  return base64.b64decode(input.translate(DECODE_TRANS))\r\n\r\nfor rotate in range(len(CUSTOM_ALPHABET)):\r\n    ROTATED_ALPHABET = CUSTOM_ALPHABET[rotate:]+CUSTOM_ALPHABET[:rotate]\r\n    DECODE_TRANS = string.maketrans(ROTATED_ALPHABET, STANDARD_ALPHABET)\r\n    if is_ascii(alt_decode(input_str)):\r\n        print rotate, ROTATED_ALPHABET\r\n        print \"***************\"\r\n        print alt_decode(input_str) \r\n\r\nSo what we did in the script was enter our data that had been XOR-ed with 0x26. We defined an alternative Base64 alphabet and then looped through all variations of that alphabet by rotating the entire alphabet by one character per loop. We then checked each output to see if it was valid ASCII, and then printed it. Running the above code returns:\r\n\r\n\r\n\r\nHere\u2019s the encoded data and clue. It appears that the decoding alphabet has been rotated by 26 characters.\r\n\r\nWould you look at that, three lines of repeating characters, all the same length: \u201c{ ** ** ** ** ** ** ** ** ** ** ** ** }\u201d\r\n\r\nSo to recap, we brute-forced a single byte XOR, then brute forced an alternate base64 alphabet that had been rotated left by 26 characters.\r\n\r\nGoing back through the other documents we find the two variations to this encoded data, and fill out the YARA rule like this:\r\nrule enc_doc : enc_doc\r\n{\r\n        strings:\r\n\t\t\r\n\t\t\t$first = { 50 74 4C 62 15 41 53 10 5F 55 44 5C }\r\n\t\t\t$second = { 4F 40 15 6B 16 5E 54 09 4F 41 43 10 }\r\n\t\t\t$third = { 4F 45 44 5E 14 67 09 69 5C 55 44 11 }\r\n\t\t\t\t\r\n        condition:\r\n\t\t\t1 of them\r\n}\r\n\r\nSubmitting the rule above will result in the key: PAN{7H1r7EEn-hOuR_71me_l1M17}\r\nThreat 5 Challenge: Hello Confetti!\r\nChallenge Created By: Anthony Kasza @anthonykasza\r\n\r\nOpening the provided \u201chello.pcap\u201d file with Wireshark and examining the protocol hierarchy within the pcap shows only UDP traffic. Wireshark believes a few of the packets are malformed real-time transport control packets while the majority of the packets are data.\r\n\r\n\r\n\r\nObserving the UDP conversations within Wireshark, only a single \u201cconnection\u201d occurred within the pcap. The connection is between port 9090 and 53321 on 127.0.0.1. The inconsistency of protocols above combined with a single connection within the trace file leads to the conclusion the protocol being used is non-standard.\r\n\r\n\r\n\r\nThe first packet in the trace contains the data \u201chello :)\u201d followed by an 0x0a. This is the only packet with a length that\u2019s not 8234 and sent from port 53321 to port 9090. The second packet contains data which starts with \u201cBZh\u201d which is the magic file header for a bzip file. Ignoring the first \u201chello\u201d packet, a bzip archive can be extracted from the trace file. Decompressing the bzip archive reveals a second pcap trace.\r\n\r\nUsing similar techniques as before, multiple FTP over IPv6 connections can be observed within the pcap. Following one of the FTP connections reveals a series of requests and responses, which all streams mimic:\r\n\r\n \tan anonymous FTP login occurs\r\n \ta series of change directory commands is issued to \/this\/is\/going\/to\/be\/so\/much\/fun\/\r\n \ta size request for a file resulting in a response of 61052\r\n \ta REST request for a specified byte offset of the file\r\n \tthe TCP connection is then reset\r\n\r\nThis series of commands is indicative of an FTP range request.\r\n\r\n\r\n\r\nReassembling the bytes of the file transferred via FTP range requests provides a tarball. Within the tarball is a third pcap trace file.\r\n\r\nAgain, observing protocols and conversations within the pcap reveals multiple HTTP connections between two end points. By observing the HTTP response codes in the connections a participant may have noticed only \u201c206 Partial Content\u201d codes. These codes are used to respond to HTTP range requests. The \u201cRange\u201d header is also included in all requests issued within the trace file.\r\n\r\n\r\n\r\nSimilar to FTP range requests, HTTP range requests can be used to request specific byte ranges for resources. Reassembling the byte ranges reveals a fourth and final packet trace file.\r\n\r\nWithin this trace file is a single TLS session between a host and Google. Within the requested SNI names of the \u201cClient Hello\u201d message of the TLS exchange additional server names (besides www.google.com) are present. This should be a big red flag to participants as this indicates the client would accept HTTP host names besides www.google.com. These SNI entries are also not ASCII characters, which also may have been a red flag.\r\n\r\n\r\n\r\nThe additional SNI entries in hexadecimal representation follow:\r\n\r\n \t61707f4a\r\n \t6801117501561d11\r\n \t7811795450435511680144117d585a54116172706162110b75\r\n \t4c\r\n\r\nKnowing previous challenge flags took the form of \u201cPAN{ FLAG }\u201d XORing the first value of the first SNI entry, 0x61, with 0x50 (\u201cP\u201d in hexadecimal) revealed the key, 0x31, used to XOR the remaining characters with. Doing so produces the key for this challenge:\r\n\r\nPAN{Y0 D0g, I Heard Y0u Like PCAPS :D}\r\n\r\nThis challenge tested the participant\u2019s knowledge of standard networking protocols and how these protocols can be (mis)used to fragment data at the application layer.\u00a0 It also tested the participant\u2019s tenacity as it was a rather long and obfuscation heavy challenge. Tools used to solve this challenge could include Wireshark, common command line utilities, Bro, and Python\u2019s dpkt module.\r\nThreat 6 Challenge: There can only be one.\r\nChallenge Created By: Micah Yates @m1kachu_\r\n\r\nThe hint is referring to the singular string required for the challenge YARA rule.\r\n\r\nWe are given the following instructions in the directions.txt file:\r\nGiven the included archive of malware samples:\r\n\r\nFind the longest, contiguous, most efficient rule to catch all of them.\r\nThe rule must use the hexadecimal format. \r\nThe rule CANNOT fire on any other samples. ONLY the 48 provided.\r\nThe wildcard (\"?\" or \"??\") is allowed but not jumps \"[1-6]\". See http:\/\/yara.readthedocs.io\/en\/latest\/writingrules.\r\nhtml#hexadecimal-strings \r\nThe samples are included in yara_samples.7z password is \"infected\"\r\n\r\nThe rule must follow this example format:\r\n\r\nrule yara_challenge\r\n{\r\n\tstrings:\r\n\t\t$yara_challenge = { de ad b? ef ?? ??}\r\n\tcondition:\r\n\t\t all of them \r\n}\r\n\r\nYou will change the contents of $yara_challenge from \"de ad b? ef ?? ??\" to a hex formatted rule that will catch all\r\n48 samples.\r\n\r\nUse this template when submitting your rule:\r\n\r\nrule yara_challenge\r\n{\r\n\tstrings:\r\n\t\t$yara_challenge = { ** ** ** ** ** ** }\r\n\tcondition:\r\n\t\t all of them \r\n}\r\n\r\n\r\nHint:\r\nThere are 52 wildcard \"?\"'s within the answer\r\n\r\nMalware samples have the following sha256 hashes:\r\n0050e14f8e6bca0b2b99708f0659e38f407debec5ab7afc71de48fb104508a60\r\n04a23b3cb2d6361df66ca94a470ffa1017a8e5cd3255ce342219765d7d4619bc\r\n104a657a127f86f7b3c0266374d3c8190089600649bfec9d022a1db5a593ff05\r\n10611281e1ccbdbb578b5d5e2b5d3bb101b137313f30488859d33efc0b0a2d49\r\n16efd909ed255628ad4da000cb7a2d1efda45ba3c549cb6c89017f92ffe3661f\r\n190759abb680efcc7e3ae3321089b43dbf3fa96a5d23a1cfb67b0eac4479bd7e\r\n1bbeca916a642737c0a0366afdf5054b4c34763f3ef182ce02fbd47330df08a5\r\n1d0d00c76353c8a1d2e33af602238244f0e0417193d7f65cfca4f4b576107071\r\n2037ffebd0249c148a7aace14bddb1e722676449a1fb2e242c54de9507aa9891\r\n383f0d2cbf8914c3ecb23ea82bff38e1c048980806e37d75e3539362d105675c\r\n3c14b486b84574dddb44e6090bea99f1635271aa9d2b34e121b9a6a7c63e20eb\r\n495a0660bbeebdf5c97066962a188b2df761f73ccd0056491a1a66a02f7d8b22\r\n4f0532e15ced95a1cebc13dd268dcbe7c609d4da237d9e46916678f288d3d9c6\r\n584da5ab12cecc1346990260edbddff27c6a8beb64fddb43e4a5e4c3c7aeafed\r\n5db8bb1cff115c3d984a560508dea374163d1579d61c64c5f8339bed21247858\r\n5dcdf2e8f1b9348bfd3330a31a70a4b5fc03dd86e45553dca9d85f74f9d8ec6c\r\n637aef27fca11245278a48f70535902570ef526ba19bcb8a675f07cdc7788993\r\n64a373487c4cc2b8b60687ecc01150b546b18be7069981c5fe5d48075190f1ff\r\n693f08996d40c0c2bdb25ae5457d44f9df694a8972a70fe989312753c7fe9ab4\r\n7c7700a4b8e19a168f7befb37155cdb133fec1fd5944e4ad57d483be40f9f5d5\r\n7d40062e8399a547f5578d462d3d864abf44a52a251f3d6dc0e3d0f2919b9b06\r\n7d5f4c2030022ca5db32716635f8b2f850fe74531d0dc1dc859e86dc9afdd411\r\n7e732e41d93b613cac1ba979d7f7c98c8603f65a50bbf6b6198f1ee396dc7174\r\n837485ae1a0d843692bac9f91ad3f3c77f576414c2f1abc477b053dbc3302939\r\n873276d9f8cbf3206408319f5579048663b30cb8f36b1a1a0a08e74a2685c688\r\n8cea8428c05a2845315cbdd64daa9bfcfc6ee49f935923786452db8b7e395662\r\n98fe63c98c8865781a7ef52b8b105dd3eeb444dfe3242468af0211eadd4076a5\r\na0d777ff492a90ec6d9eff93e38e7b35cf0ff70111b7723dc48a88ccd468d1fa\r\na4ef1ce4dd797047944605ab1d94b6e7e091949635b04ffb4cb929e1c13a93b5\r\na52762177877479859e4f88a13f605ad1e69d759019cf49dcf026781375b74a7\r\nbb4f09d5fb61d65e48bfc235657a895280ebe9c0bb20ddff112edb6ab5a6114a\r\nc8acb5eab3b6019fda9609b2badd902d7be9ebdd042e2c244018589ff1398355\r\ncc170c55c076d3c280752bfb55b25b28cc4fa56c730a2df64e636f92b737ce01\r\nd8a6e6bace789a863e537f814cca587ae697e9a5533ae43288d76f3fcad4491f\r\ndbbd5d7944b1791027762a40a70b3c74772a9d31b5c67b6519394a1705edabcc\r\ndf391f2ffc4e001b1572bb0386504a2e6bc56b0446575be4035cb617f8f0c579\r\ne03bd4b39cf7bc80a5177abe797dd896df1c97c59ede45728a245f7b912def33\r\ne6a2b6355fd513a8ce24deef488ee3cc39f5d736915965875c54f81c19e52971\r\ne96de8414e0e438184d2352be17d1f31f2f309fe5f4c7c167dd4375fa28f96b0\r\ne9af4018616e4275c6b6af5531bb988431c1454d8567cc4f6c7d2b4dc63440aa\r\ne9d191e5a9565068627795d74eb6605f3878b6c5655955f72f69dffa5076e495\r\nea96636e1c8741efac1eefb673726087261fa23c680a8556abf36ec13409253f\r\nef3b6b3060ef897724cea9ac2080b1201d08c9e6a0dad0ecf492c08441a4f604\r\nf3b82f2c80c2ea5496407200bab1cc04f3679b80c74608aa03bfae37e62f992e\r\nf48db6b5d9d34ead2dc736cd7f8af15b7b6fb3e39fe0baf5eac52e1e3967795c\r\nf6a180cc3b31693739089a9966dd1feb107bb49216f1e3ed11baab8e4f6b5226\r\nf737829e9ad9a025945ad9ce803641677ae0fe3abf43b1984a7c8ab994923178\r\nfc2751ff381d75154c76da7a42211509f7cc3fd4b50956e36e53b4f7653534d5\r\n\r\nSo lets unzip the included archive and take a look at the included files.\r\n\r\nBased off of the above conditions, it appears that the rule must be exclusive to this set of 48 files. That rules out common repeating elements of a PE file, like header, padding etc. So I\u2019m going to look at data and functionality within the binaries.\r\n\r\nMy approach to this problem would be to diff the two smallest files in the archive and see what code lines up. (If you have a paid version of IDA-Pro, you can use a free plugin, BinDiff.) We\u2019ll diff the two smallest files:\r\n\r\n \tfc2751ff381d75154c76da7a42211509f7cc3fd4b50956e36e53b4f7653534d5\r\n \te96de8414e0e438184d2352be17d1f31f2f309fe5f4c7c167dd4375fa28f96b0\r\n\r\nLet\u2019s sort the diffed files by basic block count, this will give us the longest functions in the binaries.\r\n\r\nIt looks like they\u2019re 100% the same according to bindiff. Looks promising.\r\n\r\n\r\n\r\nOpening up both files at sub_10001000 in Hex View in IDA we can see that they\u2019re practically identical.\r\n\r\n\r\n\r\nSince we\u2019re going to convert this hex to a yara rule lets open up these files in bash and convert them to text. Then do a silly grep for the beginning of the hex that matches and almost everything after that.\r\n\r\n\r\n\r\nThis gives us a nice text file with all of the similar hex bytes:\r\n\r\n\r\n\r\nThere are 48 unique lines, so it looks like we\u2019re on the right track. Next step is to write a python script to figure out the placement of those 52 wildcards.\r\n\r\n\r\n\r\nThis script checks line by line, then character by character to see if the hex text matches, if not it\u2019s replaced with a \u201c?\u201d. It then cuts off the rule after the 52nd occurrence of the \u201c?\u201d and prints out the rule:\r\n\r\n\r\n\r\nWe end up with a yara rule that catches all 48 samples:\r\nrule yara_challenge\r\n{\r\n\tstrings:\r\n\t\t$yara_challenge = { \r\n5153568B742414B9030000008BC633DB99F7F93BD375048BC6EB1683FA0175058D4602EB0C8\r\n3FA028D460174048B4424088D0C8500000000B856555555F7E98B4C241C8BC2C1E81F03D049\r\n3BCA7D065E33C05B59C3558D5601575289742414895C2428E8?E??00008BCE8B74241C8BE88B\r\nC18BFD83C404C1E902F3A58BC883E103F3A48B4C241C8B74242083F903C60429000F8C870000\r\n00B8ABAAAAAAF7E1D1EA8D04522BC8894C24108B7C242483C3048A0C2F83C703C1F90283E1\r\n3F897C24248A81?0???0?088441EFC8A4C2FFD8A442FFE83E103C1F804C1E10483E00F0BC88A8\r\n9?0???0?0884C1EFD8A442FFF8A4C2FFEC1F80683E10F83E003C1E1020BC18A80?0???0?08844\r\n1EFE8A4C2FFF83E13F4A8A81?0???0?088441EFF758B8B44241083F802754E8B4424248A0C288\r\nD7C2801C1F90283E13F8A91?0???0?08814338A04288A0F83E003C1F904C1E00483E10F0BC18\r\nA90?0???0?0885433018A0783E00F8A0C85?0???0?0884C3302C64433033DEB3883F80175368B\r\n4424248A1428C1FA0283E23F8A8A?0???0?0880C338A142883E203C1E2048A82?0???0?088443\r\n301B03D884433028844330383C30455C6043300E8?5??000083C4048BC35F5D5E5B59C390909\r\n09090909090909053568B74240C578BFE83C9FF33C0F2AEF7D1498BF98BC7250300008079054\r\n883C8FC4074065F5E33C05BC368?4 }\r\n\tcondition:\r\n\t\t all of them \r\n}\r\n\r\nSubmitting the rule above will result in the key: PAN{8oogI3_WonD3rL4nd}\r\n\r\nBONUS:\r\n\r\nIf you combine the keys from all three yara challenges, they write out a Haiku about the Labyrinth Movie.\r\nThreat 7 Challenge: There has been a breach of the Borg's drone network!\r\nChallenge Created By: Jeff White @noottrak\r\n\r\nFor this challenge, we\u2019re given a Windows PE \u201cdrone.exe\u201d and when we run it we\u2019re greeted with a Borg Cube and some text about an apparent encryption.\r\n\r\n\r\n\r\nBased on the text, it appears the URL (https:\/\/www.youtube.com\/watch?v=AyenRCJ_4Ww - the Borg montra!) and key \u201cborgdata\u201d are encrypted to form the hash \u201c374316062B033D0A3E6A746B46560377367A3328393720611641435A400C0C0B7E6E69\r\nE392C2C394E5B5B1717061B0A\u201d. Then an error occurs and another hash is displayed and the program exits.\r\n\r\nLooking at the strings for the program, a number of them immediately stand out and, after a quick trip to Google, imply that this PE was built with PyInstaller.\r\n\r\n__main__\r\n\r\n__file__\r\n\r\n%s returned %d\r\n\r\npyi-windows-manifest-filename\r\n\r\nCannot allocate memory for ARCHIVE_STATUS\r\n\r\n_MEIPASS2\r\n\r\nCannot open self %s or archive %s\r\n\r\nPATH\r\n\r\nFailed to get executable path.\r\n\r\nGetModuleFileNameW: %s\r\n\r\nFailed to convert executable path to UTF-8.\r\n\r\nPy_DontWriteBytecodeFlag\r\n\r\nCannot GetProcAddress for Py_DontWriteBytecodeFlag\r\n\r\nPy_FileSystemDefaultEncoding\r\n\r\nCannot GetProcAddress for Py_FileSystemDefaultEncoding\r\n\r\nPy_FrozenFlag\r\n\r\nCannot GetProcAddress for Py_FrozenFlag\r\n\r\nPy_IgnoreEnvironmentFlag\r\n\r\nPyInstaller is \u201ca program that packages Python programs into stand-alone executables.\u201dNow we know what we\u2019re dealing with. I decided that the quickest way to tackle this challenge would be to extract the Python script instead of trying to reverse-engineer a 9MB PE that wraps a Python script.\r\n\r\nAfter some more Google-Fu, we find PyInstaller Extractor on Sourceforge and try to run it against our binary but immediately receive a traceback.\r\n\r\nTraceback (most recent call last):\r\nFile \"pyinstxtractor11.py\", line 115, in &lt;module&gt;\r\nfd=open(name,'wb')\r\nIOError: [Errno 2] No such file or directory: ''\r\n\r\nAnalyzing the traceback and the section of code where it happened, it looks like it had issues opening a file.\r\n    #Remove trailing null bytes from name\r\n    name=name.rstrip('\\00')\r\n\r\n    bpath=os.path.dirname(name)\r\n    if bpath!='':\r\n        #Check if path exists, create if not\r\n        if os.path.exists(bpath)==False:\r\n            os.makedirs(bpath)\r\n    fd=open(name,'wb')\r\n    fd.write(buf)\r\n    fd.close()\r\n\r\nThere were also some interesting files dropped before the program had the issue, which may be useful later.\r\n\r\n\r\n\r\nTesting our assumption, we modify the script to print the \u2018name\u2019 field and can validate it\u2019s printing out the file names we saw written to disk.\r\n\r\n\r\n\r\nGiven this, we simply wrap that action in a try\/except where we specify the filename as \u201cbroke\u201d if it is empty.\r\n    try:\r\n        fd=open(name,'wb')\r\n    except:\r\n        print \"broke file\"\r\n        fd=open(\"broke\u201d,'wb')\r\nRunning it again, we see a slew of files now get written to disk.\r\n\r\n\r\n\r\nLooking at our \u201cbroke\u201d file, we see it\u2019s actually the script for the program!\r\n\r\n\r\n#!\/usr\/bin\/env python\r\nimport requests, time, sys, json, ast, logging, base64\r\nlogging.getLogger(\"scapy.runtime\").setLevel(logging.CRITICAL)\r\nfrom scapy.all import *\r\n\r\ndef AABBBC(AABBCF, AABBCE, AABBBF):\r\n    AABBCC = len(AABBCF)\/float(len(AABBCE))\r\n    if str(AABBCC).split(\".\")[1] == \"0\":\r\n        AABBCD = int(str((AABBCC)).split(\".\")[0]) * 8\r\n    else:\r\n        while str(AABBCC).split(\".\")[1] != \"0\":\r\n            AABBCF += \"@\"\r\n            AABBCC = len(AABBCF)\/float(len(AABBCE))\r\n        AABBCD = int(str((AABBCC)).split(\".\")[0]) * 8\r\n    AABBB0 = []\r\n    AABBCF = list(AABBCF)\r\n    AABBCE = list(AABBCE)\r\n    while AABBCF != []:\r\n        p_AABBCF = AABBCF[0:8]\r\n        p_AABBCE = AABBCE[0:8]\r\n        AABBB1 = []\r\n        for i in xrange(0,8):\r\n            if type(p_AABBCE[i]) == int: # [+] *** ALERT ALERT *** [+]\r\n                AABBB2 = (ord(chr(p_AABBCE[i])) ^ ord(p_AABBCF[0])) # [+] HUMANS HAVE BROKEN THROUGH [+]\r\n            else: # [+] MODULATE SHIELDS [+]\r\n                AABBB2 = (ord(p_AABBCE[i]) ^ ord(p_AABBCF[0])) # [+] *** ALERT ALERT *** [+]\r\n            AABBB0.append(AABBB2)\r\n            AABBB1.append(AABBB2)\r\n            AABBCF.pop(0)\r\n            p_AABBCF.pop(0)\r\n            AABBCE = AABBB1\r\n        AABBCE.reverse()\r\n    AABBB0.reverse()\r\n    AABBB4 = []\r\n    for i in AABBB0:\r\n        AABBB3 = hex(i)\r\n        if len(AABBB3) != 4:\r\n            AABBB4.append(\"0\" + hex(i)[2:])\r\n        else:\r\n            AABBB4.append(hex(i)[2:])\r\n    AABBB4 = \"\".join(AABBB4).upper()\r\n    return AABBB4\r\n\r\ndef AABBB7(AABBBE):\r\n    return AABBBE[::-1]\r\n\r\ndef AABBCB(AABBBE):\r\n    print \"\\t[-] *** ERROR CONNECTING ***\"\r\n    print \"\\n[+] SHUTTING DOWN DRONE [+]\\n\"\r\n    time.sleep(2)\r\n    sys.exit()\r\n\r\ndef main():\r\n    AABBBD = \"\"\"\r\n            ___________\r\n           \/-\/_\"\/-\/_\/-\/|\r\n          \/\"-\/-_\"\/-_\/\/||\r\n         \/__________\/|\/|\r\n         |\"|_'='-]:+|\/||\r\n         |-+-|.|_'-\"||\/\/\r\n         |[\".[:!+-'=|\/\/\r\n         |='!+|-:]|-|\/\r\n          ----------\r\n\"\"\"\r\n    print AABBBD\r\n    print \"[+] BORG DRONE BOOTUP STARTING [+]\"\r\n    time.sleep(2)\r\n    try:\r\n        AABBBA = json.load(open(\"borgstruct.cfg\"))\r\n        print \"\\t[-] CONFIGURATION\", str(AABBBA['key'][1]) + \".0 LOADED\"\r\n    except:\r\n        AABBBA = {\"warp\": [\"d0rw$54p\", \"lss\", \"p\/\/:ptth\", \"nimda\/\/:ptf\"],\r\n                  \"coil\": [\"r\/moc.nibets\", \"exe.1\\:c\", \"tropmmoc\"],\r\n                  \"dilithium\": [\"praw\", \"-redrocirt\", \"FfPE6AFw\/w\"],\r\n                  \"scalar\": [874, 34, 666],\r\n                  \"array\": [69, 80, 443, 25, 22, 2600, 666, 8443, 27500],\r\n                  \"LoadLibraryA\": [\"IsDebuggerPresent\", \"IsDebuggerDetected\", \"NtQueryInformationProcess\", \"GetTickCount\"],\r\n                  \"LoadLibraryB\": [\"CheckRemoteDebuggerPresent\", \"UnhandledExceptionFilter\", \"CloseHandle\", \"QueryPerformanceCounter\"],\r\n                  \"LoadLibraryC\": [\"NtGetContextThread\", \"NtSetContextThread\", \"NtClose\"],\r\n                  \"adb\": [\"0xCD\", \"0x03\"],\r\n                  \"targets\": [\"squirtle\", \"humans\", \"ferengi\", \"rick astley\"],\r\n                  \"key\": [\"borgdata\", 1, 2, 3, 4, 5, 6, 7, 8, \"startrek\", \"cloaking\"],\r\n                  \"commands\": [\"ping\", \"shutdown\", \"nslookup\"],\r\n                  \"lore\": [\"grab\", \"the\", \"flag\"]}\r\n        json.dump(AABBBA, open(\"borgstruct.cfg\", \"w\"))\r\n        print \"\\t[-] CONFIGURATION VERSION\", str(AABBBA['key'][1]) + \".0 WRITTEN\"\r\n    if AABBBA['key'][1] == 1:\r\n        print \"\\n[+] FETCHING STARTUP VALUE FROM MATRIX\"\r\n        time.sleep(2)\r\n        try:\r\n            AABBB5 = AABBB7((AABBBA['dilithium'][2]) + \"a\" + (AABBBA['coil'][0]) + \"a\" + (AABBBA['warp'][2]))\r\n            AABBB6 = requests.get(AABBB5, verify=False)\r\n        except:\r\n            AABBCB(AABBBA['LoadLibraryA'][0])\r\n        AABBCE = AABBB6.content.split(\"\\n\")[1]\r\n        print \"\\t[-] DATA =\", AABBCE\r\n    if AABBBA['key'][1] == 2: # [+] *** ALERT ALERT *** [+]\r\n        print \"\\n[+] SEND FLAG REQUEST WITH ENCRYPTED DATA AND CODE [+]\" # [+] HUMANS HAVE BROKE NEXT DEFENSE [+]\r\n        AABBCE = AABBB7((AABBBA['dilithium'][2]) + \"o\" + (AABBBA['coil'][0]) + \"o\" + (AABBBA['warp'][2])) # [+] INITIATE LOW ORBIT ION CANNON [+]\r\n        print \"\\t[-] DATA =\", AABBCE # [+] *** ALERT ALERT *** [+]\r\n    AABBCF = AABBBA['key'][0]\r\n    print \"\\t[-] INITIALIZATION KEY =\", AABBCF\r\n    if len(AABBCF) != 8:\r\n        sys.exit()\r\n    print \"\\n[+] STARTING BORG ENCRYPTION ROUTINE [+]\"\r\n    time.sleep(2)\r\n    AABBBB = AABBBC(AABBCE, AABBCF, AABBBA['array'][3])\r\n    print \"\\t[-] RESULT = \" + AABBBB\r\n    print \"\\n[+] STARTING DRONE COMMUNICATION PROTOCOLS [+]\"\r\n    time.sleep(2)\r\n    scalar_array = AABBBA['scalar'][0]\r\n    FEEDDEAD = base64.b64decode('cGFuYm9yZ2Ryb25lLmNvbQ==')\r\n    try:\r\n        AABBB8 = IP(dst=FEEDDEAD)\/TCP(dport=AABBBA['array'][5],window=scalar_array,flags=\"S\")\/AABBBB\r\n        AABBB9 = sr1(AABBB8, verbose=False)\r\n    except:\r\n        AABBCB(AABBBA['LoadLibraryB'][1])\r\n    if AABBB9[TCP].window == 666:\r\n        print \"\\t*** ERROR RECEIVED ***\"\r\n        print \"\\t[-] RETURNED = \", AABBB9[Raw]\r\n        print \"\\n[+] SHUTTING DOWN DRONE [+]\\n\"\r\n        time.sleep(2)\r\n        sys.exit()\r\n    elif AABBB9[TCP].window == 34:\r\n        print \"\\t[-] UPDATE SUCCESSFUL\"\r\n        AABBBA = ast.literal_eval(str(AABBB9[Raw]).strip(\"\\n\"))\r\n        print \"\\t[-] CONFIGURATION VERSION\", str(AABBBA['key'][1]) + \".0 WRITTEN\"\r\n        json.dump(AABBBA, open(\"borgstruct.cfg\", \"w\"))\r\n        print \"\\t[-] PROCESSING COMMANDS\"\r\n        print \"\\t[-] EXECUTING COMMAND =\", AABBBA['commands'][3], AABBBA['adb'][2], \"\/\"\r\n        time.sleep(10)\r\n        print \"\\t*** ERROR WITH COMMAND ***\"\r\n        print \"\\t[-] NEW SERVER FUNCTION ADDED - FLAG REQUEST\"\r\n        print \"\\t[-] FLAG REQUEST REQUIRED FOR CURRENT ENCRYPTED DATA\"\r\n        print \"\\n[+] SHUTTING DOWN DRONE [+]\\n\"\r\n        time.sleep(2)\r\n        sys.exit()\r\n    else:\r\n        print \"\\t[-] RETURNED = \", AABBB9[Raw], \"\\n\"\r\n\r\nif __name__ == \"__main__\":\r\n    main()\r\n\r\nLots of things going on in the script, the main ones of interest are some of the ones that immediately jump out for investigation.\r\n# Called before encryption message prints\r\nAABBBB = AABBBC(AABBCE, AABBCF, AABBBA['array'][3])\r\n# Scapy sending data to a server (part of the \u201cCOMMUNICATION PROTOCOL\u201d?)\r\nAABBB8 = IP(dst=FEEDDEAD)\/TCP(dport=AABBBA['array'][5],window=scalar_array,flags=\"S\")\/AABBBB\r\n#  Branch leads to messages about the flag\r\n    elif AABBB9[TCP].window == 34:\r\n        print \"\\t[-] NEW SERVER FUNCTION ADDED - FLAG REQUEST\"\r\n        print \"\\t[-] FLAG REQUEST REQUIRED FOR CURRENT ENCRYPTED DATA\"\r\n\r\nFirst things first, we\u2019ll take a look at the encryption function and decipher that. We set a breakpoint on the main() function and begin to step through the code to understand what it\u2019s doing.\r\n\r\n \tTries to load the file \u201cborgstruct.cfg\u201d and if that fails, it writes a dictionary to disk as that file.\r\n \tCheck if dictionary \u2018key\u2019[1] is equal to 1 and if so, puts together a string from various locations within the dictionary. This URL contains the Youtube video mentioned above.\r\n \tSets another variable to \u201cborgdata\u201d.\r\nCalls the encryption routine AABBBC(URL,\u201dborgdata\u201d,25).\r\n\r\n\r\n\r\n \tChecks if URL is divisible by 8 and, if not, pads it with \u201c@\u201d.\r\n \tSplits each variable into a list and begins the XoR the URL by key \u201cborgdata\u201d.\r\n \tOnce it has the first set of 8 ordinals it reverses them and uses this set as the next XoR key, which continues on for the full length of the URL.\r\nThis is classic cipher block chaining where each encrypted ciphertext is used as the encryption key for the next block.\r\n \tIf we let the process continue until the end, it reverses the order of the final ordinal list and then converts it to hex.\r\n\r\nSince we know the ciphertext and now we know how the key is derived, we have enough pieces of the puzzle to build a decryptor. By copying the code from the script and de-obfuscating it, we can build our reverse decryption function.\r\n#!\/usr\/bin\/env python\r\n\r\ndef decrypt(hash):\r\n    final_key = []\r\n    key = []\r\n    count = 0\r\n    while count != len(hash):\r\n        key.append(hash[count:count+2])\r\n        count += 2\r\n    key = key[::-1]\r\n    temp = []\r\n    for value in key:\r\n        ord_value = ord(value.decode(\"hex\"))\r\n        temp.append(ord_value)\r\n    count = 0\r\n    block_count = len(temp)\r\n    while block_count != 0:\r\n        cipher = []\r\n        block = temp[block_count - 8:block_count]\r\n        if block_count != 0:\r\n            for value in block:\r\n                cipher.append(value)\r\n        else:\r\n            for value in block:\r\n                cipher.append(value)\r\n        xor_key = (temp[block_count - 16:block_count - 8])[::-1]\r\n\r\n        string_key = []\r\n        count = 0\r\n        if block_count - 8  != 0:\r\n            while count != 8:\r\n                string_key.append(chr(cipher[count] ^ xor_key[count]))\r\n                count +=1\r\n        else:\r\n            string_key = [\"????????\"]\r\n        final_key.append(\"\".join(string_key))\r\n\r\n        block_count -= 8\r\n        xor_key = []\r\n    final_key = \"\".join(final_key[::-1])\r\n    return \"\".join(final_key)\r\n\r\ndef encrypt(pt, key, add_value):\r\n    pt_size = len(pt)\/float(len(key)) # Grab Key Length\r\n    if str(pt_size).split(\".\")[1] == \"0\": # Check if divisible by 8\r\n        multiply_size = int(str((pt_size)).split(\".\")[0]) * 8\r\n    else:\r\n        while str(pt_size).split(\".\")[1] != \"0\": # Pad pt to be divisible by 8\r\n            pt += \"@\"\r\n            pt_size = len(pt)\/float(len(key))\r\n        multiply_size = int(str((pt_size)).split(\".\")[0]) * 8\r\n    cipher = []\r\n    pt = list(pt) # Put plaintext and key into their respective list for processing in 8 byte chunks\r\n    key = list(key)\r\n    while pt != []: # Stop when all plaintext processed\r\n        p_pt = pt[0:8]\r\n        p_key = key[0:8]\r\n        temp_list = []\r\n        for i in xrange(0,8): # Process 8 bytes at a time\r\n            if type(p_key[i]) == int: # Second 8 bytes and on will always be integers\r\n                new_ct = (ord(chr(p_key[i])) ^ ord(p_pt[0])) # XOR each PT byte with key byte\r\n            else: # First run of XOR, assuming ASCII key\r\n                new_ct = (ord(p_key[i]) ^ ord(p_pt[0]))\r\n            cipher.append(new_ct) # Add each byte to CT list\r\n            temp_list.append(new_ct)\r\n            pt.pop(0)\r\n            p_pt.pop(0)\r\n            key = temp_list\r\n        key.reverse() # Reverse Key list each run so now Z-&gt;A on second run+ (integers)\r\n    cipher.reverse() # Reverse entire CT\r\n    cipher_text = []\r\n    for i in cipher: # Convert each integer to hex equivalent\r\n        hex_value = hex(i)\r\n        if len(hex_value) != 4: # Pad to get consistent output with leading 0's\r\n            cipher_text.append(\"0\" + hex(i)[2:])\r\n        else:\r\n            cipher_text.append(hex(i)[2:])\r\n    cipher_text = \"\".join(cipher_text).upper() # Join it into one string\r\n    return cipher_text\r\n\r\ndef main():\r\n    pt = \"https:\/\/www.youtube.com\/watch?v=AyenRCJ_4Ww\"\r\n    key = \"borgdata\"\r\n    numb = 25\r\n    enc_hash = encrypt(pt, key, numb)\r\n    dec_hash = decrypt(enc_hash)\r\n    print \"Encrypted Hash: %s\\nDecrypted Hash: %s\" % (enc_hash, dec_hash)\r\n\r\nif __name__ == \"__main__\":\r\n    main()\r\n\r\nRunning the code with the known plain text and initial key shows we get the same ciphertext shown in the initial run of the drone.exe executable, along with our known YouTube URL.\r\n\r\n\r\n\r\nNow we can take the returned value and put it through our decryptor to see what we get.\r\n\r\nThe hash \u201c405E520E4A0E6F3401584E0A4E121E00322C24793B7E6C3304594B0E41131B032C6867\r\n07A3E2A2B484553174C0E064724696363753C372F5B40550117061B0A\u201d becomes \u201c???????\r\ntwitter.com\/borgcommlink\/status\/755587712267104257@@@@@@\u201d.\r\n\r\nBrowsing to that Twitter address, we\u2019re greeted with yet another hash.\r\n\r\nThis hash decrypts to another excellent Star Trek Youtube video.\r\n\r\nLooking back at our script, we can tell that the script sends a hash to panborgdrone.com on port TCP\/2600 and based on the result of what the server sends back, either shuts down or updates its configuration with a new \u201cfunction\u201d called \u201cFLAG REQUEST\u201d. Sounds promising.\r\n\r\nLet\u2019s try editing the script and sending the hash from Borg Head.\r\n\r\n\r\n\r\nWe get a slightly different error message this time and no hash like we did originally. Instead of \u201cHIVE|MIND|HASH\u201d it\u2019s \u201cHIVE|ERROR|DATA|874\u201d. Looking at the Scapy command again, the TCP Window Size is set by variable \u201cscalar_array\u201d which pulls from the configuration dictionary.\r\n\r\n\r\n\r\nSetting the Window Size to 34 nets us a change in response from the server.\r\n\r\n\r\n\r\nLooking at the 2.0 configuration, this key and values stand out immediately.\r\n   \"datashat\" : [\r\n      \"submit\",\r\n      \"the\",\r\n      \"flag\",\r\n      \"manually\"\r\n   ],\r\nRunning the bot again with the new configuration, it loads a new URL (with quite possibly the best Star Trek video ever made) and XoR key of \u201cborgcube\u201d to generate a new hash. Placing the new hash in our send command, we get the following error \u201cHIVE|ERROR|CMD|2E\u201d, which is different than the previous \u201cERROR|DATA\u201d message we received.\r\n\r\n\r\n\r\nChanging the Window Size back to 874 didn\u2019t result in any change of the message; however, while looking through the rest of Borg Head\u2019s Tweets, we find this little gem among the memes and Borgs talking to each other.\r\n\r\n\r\nIn the background of this message is a spreadsheet with a table showing various commands (CMD) and their respective Window Size. We can see that value 874 corresponds to \u201cDRONE CHECKIN\u201d, value 34 is \u201cDRONE UPDATE\u201d, and value 824 is \u201cFLAG REQUEST\u201d!\r\n\r\nUpdating our script one last time with our new Window Size we are rewarded with our key.\r\n\r\n\r\n\r\nA Star Wars troll for all the Star Trek fans\u2026\r\n\r\n\r\n\r\nPAN{m4yTh3f0rc3beWIThyOu}","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"","width":"","height":""},"author":[{"@type":"Person","name":"Richard Wartell"},{"@type":"Person","name":"Micah Yates"},{"@type":"Person","name":"Jeff White"},{"@type":"Person","name":"Josh Grunzweig"},{"@type":"Person","name":"Anthony Kasza"}]}</script>		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/blog.paloaltonetworks.com\/wp-includes\/js\/wp-emoji-release.min.js"}};
			/*! This file is auto-generated */
			!function(e,a,t){var r,n,o,i,p=a.createElement("canvas"),s=p.getContext&&p.getContext("2d");function c(e,t){var a=String.fromCharCode;s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,e),0,0);var r=p.toDataURL();return s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,t),0,0),r===p.toDataURL()}function l(e){if(!s||!s.fillText)return!1;switch(s.textBaseline="top",s.font="600 32px Arial",e){case"flag":return!c([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])&&(!c([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!c([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]));case"emoji":return!c([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340])}return!1}function d(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(i=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},o=0;o<i.length;o++)t.supports[i[o]]=l(i[o]),t.supports.everything=t.supports.everything&&t.supports[i[o]],"flag"!==i[o]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[i[o]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(r=t.source||{}).concatemoji?d(r.concatemoji):r.wpemoji&&r.twemoji&&(d(r.twemoji),d(r.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='crayon-css'  href='https://blog.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://blog.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://blog.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://blog.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='contact-form-7-css'  href='https://blog.paloaltonetworks.com/wp-content/plugins/contact-form-7/includes/css/styles.css' type='text/css' media='all' />
<style id='contact-form-7-inline-css' type='text/css'>
.wpcf7 .wpcf7-recaptcha iframe {margin-bottom: 0;}.wpcf7 .wpcf7-recaptcha[data-align="center"] > div {margin: 0 auto;}.wpcf7 .wpcf7-recaptcha[data-align="right"] > div {margin: 0 0 0 auto;}
</style>
<link rel='stylesheet' id='dashicons-css'  href='https://blog.paloaltonetworks.com/wp-includes/css/dashicons.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://blog.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//blog.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//blog.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-menu-item-0-css'  href='//blog.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/menu-item/style.css' type='text/css' media='all' />
<link rel='stylesheet' id='sage/css-css'  href='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/styles/main.css' type='text/css' media='all' />
<script>if (document.location.protocol != "https:") {document.location = document.URL.replace(/^http:/i, "https:");}</script><script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/jquery-3.5.1.min.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/jquery-migrate-1.4.1.min.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/blog.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js'></script>
<link rel='https://api.w.org/' href='https://blog.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://blog.paloaltonetworks.com/?p=18169' />
<link rel="alternate" type="application/json+oembed" href="https://blog.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.paloaltonetworks.com%2F2016%2F09%2Flabyrenth-capture-the-flag-ctf-threat-track-solutions%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://blog.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.paloaltonetworks.com%2F2016%2F09%2Flabyrenth-capture-the-flag-ctf-threat-track-solutions%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:180,186,114,3,12,9,81,84,87,129,138,6,162;" />
  <script>var $ = jQuery;</script>
    <!-- Unit42 Scripts -->
  <script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  <!-- End Unit42 Scripts -->
<meta name="google-site-verification" content="G1onsZ_PNprWXTYsKyATpZKzp8IAJ1jlbavSwUDN5Uo" />
</head>
  <body data-rsssl=1 data-results-per-page="9" class="post-template-default single single-post postid-18169 single-format-standard labyrenth-capture-the-flag-ctf-threat-track-solutions sidebar-primary">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <input type="hidden" id="searching" value=""/><header class="container-fluid container-blog sticky-top">
     
      <div class="pan-page-alert pan-page-alert-light">
    		<div class="pan-page-alert-text"><a href="https://www.paloaltonetworks.com/our-response-to-covid-19" data-page-track-value=":en_us: title :covid19" data-page-track="true">See our response to COVID-19</a></div>
    		<button type="button" class="pan-page-alert-close" aria-label="page alert close">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1 1L6 6M6 6L11 1M6 6L1 11M6 6L11 11" stroke="#727272" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
          </button>
		  </div>
    
	
      <div class="container-xl">
        <div class="row">
          <div class="col-logo">
            <a href="https://www.paloaltonetworks.com" class="nav-logo" nav-track="true" nav-track-breadcrumb="nav:logo" aria-label="paloaltonetworks">
              <svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M59.4806 4.69592C57.6725 4.69592 55.7941 5.18876 53.4694 6.43377L54.7609 9.62741C56.7798 8.50019 58.4474 8.00735 59.6687 8.00735C61.0542 8.00735 61.6648 8.52395 61.6648 9.20483V9.25133C61.6648 9.72143 61.2887 9.97974 60.3733 10.0738L58.777 10.238C54.7847 10.6606 53.1409 12.3985 53.1409 14.7934V14.9577C53.1409 17.2359 55.0192 19.0203 57.6725 19.0203C59.4197 19.0203 60.9374 18.2826 61.8601 16.9807L62.1577 18.7857H65.7739V10.5904C65.7739 6.71584 63.5432 4.69592 59.4806 4.69592ZM59.1283 15.8969C57.7903 15.8969 57.1559 15.3803 57.1559 14.5816V14.5351C57.1559 13.8305 57.5547 13.3139 59.0105 13.1031L59.6449 13.0091C60.5717 12.8799 61.141 12.7095 61.6648 12.3923V13.4317C61.6648 15.0052 60.6781 15.8969 59.1283 15.8969Z" fill="black" class="logo-text"></path>
                <path d="M25.4785 4.78994L20.8529 0.164276L16.2272 4.78994L18.5281 7.09192L6.92834 18.6917L11.554 23.3174L16.1797 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="#FA582D" class="logo-icon"></path>
                <path d="M11.6001 0.164063L0 11.7642L4.62603 16.3902L16.2262 4.79009L11.6001 0.164063Z" fill="#FA582D" class="logo-icon"></path>
                <path d="M27.7795 7.09215L16.1793 18.6923L20.8054 23.3183L32.4055 11.7182L27.7795 7.09215Z" fill="#FA582D" class="logo-icon"></path>
                <path d="M72.2314 0H68.1223V18.7857H72.2314V0Z" fill="black" class="logo-text"></path>
                <path d="M46.2362 4.69592C44.3681 4.69592 42.8679 5.52249 42.0424 6.81709L41.7283 4.93046H38.1121V23.4806H42.2211V17.051C43.0033 18.2567 44.4828 19.0193 46.2362 19.0193C49.5238 19.0193 52.2009 16.1077 52.2009 12.0916V11.6215C52.2009 7.60853 49.5238 4.69592 46.2362 4.69592ZM47.974 11.9759C47.974 14.0888 46.8705 15.6159 45.0387 15.6159C43.2068 15.6159 42.1033 14.0898 42.1033 11.9759V11.7414C42.1033 9.62741 43.2068 8.10137 45.0387 8.10137C46.8705 8.10137 47.974 9.62741 47.974 11.7414V11.9759Z" fill="black" class="logo-text"></path>
                <path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="black" class="logo-text"></path>
                <path d="M138.709 5.54211V5.47185C138.709 5.07304 138.404 4.79097 137.864 4.79097H136.924V6.9514H137.371V6.22299H137.867L138.24 6.9514H138.733L138.274 6.09694C138.553 6.01119 138.709 5.80248 138.709 5.54211ZM137.37 5.18979H137.863C138.145 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.144 5.82418 137.863 5.82418H137.37V5.18979Z" fill="black" class="logo-text"></path>
                <path d="M137.77 3.63997C136.502 3.63997 135.539 4.60292 135.539 5.87066C135.539 7.1384 136.502 8.10135 137.77 8.10135C139.037 8.10135 140 7.1384 140 5.87066C140 4.60292 139.037 3.63997 137.77 3.63997ZM137.77 7.79552C136.666 7.79552 135.868 6.99685 135.868 5.86963C135.868 4.7424 136.666 3.94373 137.77 3.94373C138.873 3.94373 139.672 4.7424 139.672 5.86963C139.672 6.99685 138.873 7.79552 137.77 7.79552Z" fill="black" class="logo-text"></path>
                <path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="black" class="logo-text"></path>
                <path d="M116.518 15.6159C115.321 15.6159 114.875 15.029 114.875 13.7613V8.10136H119.712V4.93148H114.875V1.76057L110.766 2.3712V14.159C110.766 17.3764 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="black" class="logo-text"></path>
                <path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="black" class="logo-text"></path>
                <path d="M81.2247 4.69592C77.0216 4.69592 74.0625 7.6075 74.0625 11.6236V12.0937C74.0625 16.1087 77.0216 19.0213 81.2247 19.0213C85.4278 19.0213 88.3869 16.1097 88.3869 12.0937V11.6236C88.3858 7.60853 85.4278 4.69592 81.2247 4.69592ZM84.159 11.9759C84.159 14.0888 83.0555 15.6159 81.2236 15.6159C79.3918 15.6159 78.2883 14.0898 78.2883 11.9759V11.7414C78.2883 9.62741 79.3918 8.10137 81.2236 8.10137C83.0555 8.10137 84.159 9.62741 84.159 11.7414V11.9759Z" fill="black" class="logo-text"></path>
                <path d="M98.0448 22.1168H99.0976L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0253 23.5312H99.0109V25.4964H98.0448V22.1168Z" fill="black" class="logo-text"></path>
                <path d="M102.816 22.1168H105.771L105.81 22.9372H103.826V23.4011H105.385V24.1491H103.826V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="black" class="logo-text"></path>
                <path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="black" class="logo-text"></path>
                <path d="M110.943 22.1168H112.024L112.574 24.4632H112.628L113.342 22.1168H114.333L115.032 24.4632H115.086L115.626 22.1168H116.66L115.771 25.4964H114.443L113.826 23.4589H113.797L113.168 25.4964H111.836L110.943 22.1168Z" fill="black" class="logo-text"></path>
                <path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.258 23.8071C120.258 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.915 24.7391 120.258 24.3909 120.258 23.8071Z" fill="black" class="logo-text"></path>
                <path d="M122.364 22.1168H124.334C125.232 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.45 24.2369 125.015 24.4105L125.816 25.4974H124.668L124.045 24.6089H123.378V25.4974H122.364V22.1168ZM124.203 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.203 22.933H123.377V23.8164H124.203Z" fill="black" class="logo-text"></path>
                <path d="M126.989 22.1168H128.003V23.3628H128.418L129.408 22.1168H130.548L130.553 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.003V25.4964H126.989V22.1168Z" fill="black" class="logo-text"></path>
                <path d="M131.402 25.2743V24.3475H131.407C131.972 24.6326 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3464 133.425 24.3031 132.701 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.913 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.387 22.84 132.952 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5405 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.953 25.5884C132.364 25.5884 131.895 25.4675 131.402 25.2743Z" fill="black" class="logo-text"></path>
              </svg>
            </a>
            <a href="https://blog.paloaltonetworks.com" class="nav-lockup active" >Blog</a>
          </div>
          <div class="col col-mobile">
            <button class="nav-toggle closed" id="nav-mobile-toggle">
              <svg class="menu-dashes open" width="21" height="16" viewBox="0 0 21 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <line x1="18.8125" y1="1.5" x2="1.5" y2="1.5" stroke="black" stroke-width="3" stroke-linecap="round"></line>
                <line x1="18.8125" y1="8" x2="1.5" y2="8" stroke="black" stroke-width="3" stroke-linecap="round"></line>
                <line x1="18.8125" y1="14.5" x2="1.5" y2="14.5" stroke="black" stroke-width="3" stroke-linecap="round"></line>
              </svg>
              <svg class="menu-x close" width="18" height="17" viewBox="0 0 18 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                <line x1="2.95117" y1="14.2207" x2="14.8534" y2="2.31847" stroke="black" stroke-width="3" stroke-linecap="round"></line>
                <line x1="1.5" y1="-1.5" x2="18.3323" y2="-1.5" transform="matrix(-0.707107 -0.707107 -0.707107 0.707107 14.998 16.3422)" stroke="black" stroke-width="3" stroke-linecap="round"></line>
              </svg>
                <span class="mobile-menu">Menu</span>
            </button>
          </div>
            <nav class="col col-navbar navbar" id="nav-mobile">
                <ul>
                    <li class="menu-item-home"><a href="https://blog.paloaltonetworks.com">Palo Alto Networks</a></li>
                                            
                    <li class="menu-item-object-net_sec_post">
                        <a href="https://blog.paloaltonetworks.com/network-security/">Network Security</a>
                    </li>
                    
                                            
                    <li class="menu-item-object-sase_post">
                        <a href="https://blog.paloaltonetworks.com/sase/">SASE</a>
                    </li>
                    
                                            
                    <li class="menu-item-object-cloud_sec_post">
                        <a href="https://blog.paloaltonetworks.com/prisma-cloud/">Cloud Native Security</a>
                    </li>
                    
                                            
                    <li class="menu-item-object-sec_ops_post">
                        <a href="https://blog.paloaltonetworks.com/security-operations/">Security Operations</a>
                    </li>
                    
                                        <li>
                <div class="search"  id="form-search">
                    <input type="text" name="search" autocomplete="off" id="postSearch1" placeholder="Search the Blog" />
                  
                    <button id="nav-search-open-toggle">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" >
                      <path d="M8.66675 15.3335C12.3487 15.3335 15.3335 12.3487 15.3335 8.66675C15.3335 4.9848 12.3487 2 8.66675 2C4.9848 2 2 4.9848 2 8.66675C2 12.3487 4.9848 15.3335 8.66675 15.3335Z" stroke="black" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path>
                      <path d="M18.0007 18.0001L13.3784 13.3778" stroke="black" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path>
                    </svg>
                  </button>
                  
                  <button id="nav-search-close-toggle">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" >
                      <line x1="2.95117" y1="14.2207" x2="14.8534" y2="2.31847" stroke="black" stroke-width="3" stroke-linecap="round"></line>
                      <line x1="1.5" y1="-1.5" x2="18.3323" y2="-1.5" transform="matrix(-0.707107 -0.707107 -0.707107 0.707107 14.998 16.3422)" stroke="black" stroke-width="3" stroke-linecap="round"></line>
                    </svg>
                  </button>
                  
                </div>
              </li>
                </ul>
                        </nav>
          
            
        </div>
      </div>
    </header>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/masonry/4.2.2/masonry.pkgd.min.js"></script>-->
<script type="text/javascript">
    var main_nav_active_class = '';
    var main_nav_menu_item_name = 'menu-item-home';
    var str_subscription = '<div class="container-fluid container-newsletter-signup" >\
    <div class="container-lg">\
        <div class="row no-gutters row-newsletter-signup">\
            <div class="col-12 col-md-5 col-newsletter-signup-header">\
                <h2>Get updates!</h2>\
                <p class="lead">Sign up to receive the latest news</p>\
            </div>\
            <div class="col-12 col-md-7 col-newsletter-signup-form">\
                <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate="" class="subscribe-form clearfix" name="Unit42_Subscribe" id="subscribe_form1">\
                    <input type="hidden" value="subscribe-unit42" name="FormName">\
    <input id="field14" type="hidden" name="Qualifying_Campaign__c" value="70170000000lBnb">\
                         <input type="hidden" value="1086" name="formid">\
                         <input type="hidden" value="531-OCS-018" name="munchkinId">\
                         <input type="hidden" value="19887" name="lpId">\
                         <input type="hidden" value="1086" name="formVid">\
                         <input type="hidden" name="mkto_opt-in" value="true">\
                <div class="row no-gutters row-newsletter-signup-input">\
                    <div class="col-10 col-sm-11 col-newsletter-signup-input">\
                        <input type="email" name="Email" placeholder="Enter your email" id="input-newsletter-signup" class="subscribe-field rounded business_email" autocomplete="off">\
                    </div>\
                    <div class="col-2 col-sm-1 col-newsletter-signup-button">\
                        <button type="submit" value="Subscribe" disabled="disabled">\
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12" fill="none">\
                            <path d="M1 6L14.3333 6" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\
                            <path d="M9.33301 1L14.333 6L9.33301 11" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\
                            </svg>\
                        </button>\
                    </div>\
                </div>\
                <div class="email_invalid_msg">Please enter a valid email.</div>\
                <div class="row row-legal-disclaimer">\
                    <div class="col-12 col-legal-disclaimer">\
                        <p class="legal-disclaimer">By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>\
                    </div>\
                </div>\
                <div class="row row-recatcha d-none" id="row-recatcha">\
                    <div class="col-12 col-recatcha text-sm-center">\
                        <div id="captcha_container" class="google-recapth"></div>\
                    </div>\
                </div>\
                </form>\
            </div>\
        </div>\
    </div>\
</div>';
</script>
<article class="container-feed-master " id="main-container">
   <!--<div class="container-fluid container-breadcrumb"  data-aos="fade-in">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="https://blog.paloaltonetworks.com">Palo Alto Networks</a></li>
			          </ol>
        </nav>
    </div>-->
    
    <div class="container-fluid container-feed-article">
      <div class="container-lg">
        <div class="row row-feed-filters article-container container-inner" data-aos="fade-in" >
            <h1 class="blog-title">LabyREnth Capture the Flag (CTF): Threat Track Solutions</h1>
              <div class="col-xs-12 col-sm-6 col-md-8 col-lg-8 col-xl-9 pad-0">
                   <div class="tags-item">
                    <a href="https://blog.paloaltonetworks.com/category/events/">Events</a>                    
                    <a href="https://blog.paloaltonetworks.com/tag/ctf/" rel="tag">CTF</a><a href="https://blog.paloaltonetworks.com/tag/labyrenth/" rel="tag">LabyREnth</a><a href="https://blog.paloaltonetworks.com/tag/unit-42/" rel="tag">Unit 42</a>                  </div>
              </div>
              <div class="col-xs-12 col-sm-6 col-md-4 col-lg-4 col-xl-3 pad-0 mobile-links">
                   <ol class="react-items">
                    <li>
				
				
				20,871
			 people reacted</li>
                    <li class="line"></li>
                    <li>
                      <div class="metadata-likes ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'18169','like')">
                          <svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M4.74998 15.9999H2.49999C2.10217 15.9999 1.72064 15.8419 1.43934 15.5606C1.15803 15.2793 1 14.8977 1 14.4999V9.24995C1 8.85213 1.15803 8.4706 1.43934 8.18929C1.72064 7.90799 2.10217 7.74996 2.49999 7.74996H4.74998M9.99994 6.24997V3.24999C9.99994 2.65325 9.76289 2.08096 9.34094 1.65901C8.91898 1.23705 8.34669 1 7.74996 1L4.74998 7.74996V15.9999H13.2099C13.5717 16.004 13.9227 15.8772 14.1983 15.6429C14.474 15.4086 14.6557 15.0826 14.7099 14.7249L15.7449 7.97496C15.7775 7.75997 15.763 7.54047 15.7024 7.33165C15.6418 7.12283 15.5365 6.92968 15.3938 6.7656C15.2511 6.60151 15.0745 6.47041 14.8761 6.38138C14.6777 6.29234 14.4623 6.2475 14.2449 6.24997H9.99994Z" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                          </svg>
                          <span>1</span>
                      </div>
                    </li>
                  </ol>
              </div>
              <div class="container-lg author-desc-row">
                <div class="col-8 author-desc">
                  <div class="metadata-thumbnail" >
                                          <div class="metadata-thumbnail-author" style="background-image: url('https://blog.paloaltonetworks.com/wp-content/uploads/2017/05/unit42_400x400.jpg')">
                                          </div>      
                  </div>
                  <div class="metadata-author" >
                    <span class="author-name">By <a href="https://blog.paloaltonetworks.com/author/richard-wartell/" title="Posts by Richard Wartell" class="author url fn" rel="author">Richard Wartell</a>, <a href="https://blog.paloaltonetworks.com/author/micah-yates/" title="Posts by Micah Yates" class="author url fn" rel="author">Micah Yates</a>, <a href="https://blog.paloaltonetworks.com/author/jeff-white/" title="Posts by Jeff White" class="author url fn" rel="author">Jeff White</a>, <a href="https://blog.paloaltonetworks.com/author/josh-grunzweig/" title="Posts by Josh Grunzweig" class="author url fn" rel="author">Josh Grunzweig</a> and <a href="https://blog.paloaltonetworks.com/author/anthony-kasza/" title="Posts by Anthony Kasza" class="author url fn" rel="author">Anthony Kasza</a></span><br /> 
                      <time datetime="2016-09-02T00:37:34+00:00">September 1, 2016 at 5:37 PM</time><br />
                      35 min. read
                  </div>
                </div>
                <!--<div class="col-6 social-items">
                      <span class="links">
                        <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M4.28843 12.8112C4.28843 13.9855 3.32843 14.9375 2.1442 14.9375C0.959967 14.9375 0 13.9855 0 12.8112C0 11.6368 0.96 10.6848 2.14423 10.6848C3.32846 10.6848 4.28843 11.6368 4.28843 12.8112ZM10.1699 14.38C9.89019 9.2468 5.74406 5.13004 0.562199 4.85236C0.256339 4.83596 0 5.07967 0 5.38341V6.97945C0 7.25886 0.217299 7.49317 0.498449 7.5113C4.24282 7.75315 7.2442 10.7221 7.48858 14.4432C7.5069 14.722 7.74318 14.9375 8.0249 14.9375H9.63435C9.94068 14.9375 10.1864 14.6833 10.1699 14.38ZM14.9997 14.3896C14.7186 6.62601 8.41959 0.342913 0.552556 0.062845C0.250212 0.0520872 0 0.294304 0 0.594294V2.1903C0 2.47668 0.22885 2.70976 0.5174 2.72152C6.91848 2.9818 12.0562 8.07771 12.3187 14.4245C12.3305 14.7106 12.5655 14.9375 12.8544 14.9375H14.4638C14.7663 14.9375 15.0105 14.6894 14.9997 14.3896Z" fill="black"/>
                        </svg>
                      </span>
                      <span class="links">
                        <svg width="15" height="18" viewBox="0 0 15 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.7857 11.25C10.9286 11.25 10.1484 11.6016 9.57254 12.1781L6.28125 10.016C6.47879 9.35508 6.47879 8.64141 6.28125 7.98398L9.57254 5.82188C10.1484 6.39844 10.9286 6.75 11.7857 6.75C13.5603 6.75 15 5.23828 15 3.375C15 1.51172 13.5603 0 11.7857 0C10.0112 0 8.57143 1.51172 8.57143 3.375C8.57143 3.71953 8.62165 4.06406 8.71875 4.39102L5.42746 6.55312C4.85156 5.97656 4.07143 5.625 3.21429 5.625C1.43973 5.625 0 7.13672 0 9C0 10.8633 1.43973 12.375 3.21429 12.375C4.07143 12.375 4.85156 12.0234 5.42746 11.4469L8.71875 13.609C8.62165 13.9395 8.57143 14.2805 8.57143 14.625C8.57143 16.4883 10.0112 18 11.7857 18C13.5603 18 15 16.4883 15 14.625C15 12.7617 13.5603 11.25 11.7857 11.25ZM11.7857 1.6875C12.673 1.6875 13.3929 2.44336 13.3929 3.375C13.3929 4.30664 12.673 5.0625 11.7857 5.0625C10.8984 5.0625 10.1786 4.30664 10.1786 3.375C10.1786 2.44336 10.8984 1.6875 11.7857 1.6875ZM3.21429 10.6875C2.32701 10.6875 1.60714 9.93164 1.60714 9C1.60714 8.06836 2.32701 7.3125 3.21429 7.3125C4.10156 7.3125 4.82143 8.06836 4.82143 9C4.82143 9.93164 4.10156 10.6875 3.21429 10.6875ZM11.7857 16.3125C10.8984 16.3125 10.1786 15.5566 10.1786 14.625C10.1786 13.6934 10.8984 12.9375 11.7857 12.9375C12.673 12.9375 13.3929 13.6934 13.3929 14.625C13.3929 15.5566 12.673 16.3125 11.7857 16.3125Z" fill="black"/>
                        </svg>
                      </span>
                </div>-->
                <div class="col-4 social-items">
                  <div class="links">
                      <a href="http://feeds.feedburner.com/PaloAltoNetworks" target="_blank"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M4.28843 12.8112C4.28843 13.9855 3.32843 14.9375 2.1442 14.9375C0.959967 14.9375 0 13.9855 0 12.8112C0 11.6368 0.96 10.6848 2.14423 10.6848C3.32846 10.6848 4.28843 11.6368 4.28843 12.8112ZM10.1699 14.38C9.89019 9.2468 5.74406 5.13004 0.562199 4.85236C0.256339 4.83596 0 5.07967 0 5.38341V6.97945C0 7.25886 0.217299 7.49317 0.498449 7.5113C4.24282 7.75315 7.2442 10.7221 7.48858 14.4432C7.5069 14.722 7.74318 14.9375 8.0249 14.9375H9.63435C9.94068 14.9375 10.1864 14.6833 10.1699 14.38ZM14.9997 14.3896C14.7186 6.62601 8.41959 0.342913 0.552556 0.062845C0.250212 0.0520872 0 0.294304 0 0.594294V2.1903C0 2.47668 0.22885 2.70976 0.5174 2.72152C6.91848 2.9818 12.0562 8.07771 12.3187 14.4245C12.3305 14.7106 12.5655 14.9375 12.8544 14.9375H14.4638C14.7663 14.9375 15.0105 14.6894 14.9997 14.3896Z" fill="black"/>
                    </svg>
                    </a>
                  </div>
                  <div class="links">
                    <div class="dropdown dropup">
                      <a href="#!" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <svg width="15" height="18" viewBox="0 0 15 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.7857 11.25C10.9286 11.25 10.1484 11.6016 9.57254 12.1781L6.28125 10.016C6.47879 9.35508 6.47879 8.64141 6.28125 7.98398L9.57254 5.82188C10.1484 6.39844 10.9286 6.75 11.7857 6.75C13.5603 6.75 15 5.23828 15 3.375C15 1.51172 13.5603 0 11.7857 0C10.0112 0 8.57143 1.51172 8.57143 3.375C8.57143 3.71953 8.62165 4.06406 8.71875 4.39102L5.42746 6.55312C4.85156 5.97656 4.07143 5.625 3.21429 5.625C1.43973 5.625 0 7.13672 0 9C0 10.8633 1.43973 12.375 3.21429 12.375C4.07143 12.375 4.85156 12.0234 5.42746 11.4469L8.71875 13.609C8.62165 13.9395 8.57143 14.2805 8.57143 14.625C8.57143 16.4883 10.0112 18 11.7857 18C13.5603 18 15 16.4883 15 14.625C15 12.7617 13.5603 11.25 11.7857 11.25ZM11.7857 1.6875C12.673 1.6875 13.3929 2.44336 13.3929 3.375C13.3929 4.30664 12.673 5.0625 11.7857 5.0625C10.8984 5.0625 10.1786 4.30664 10.1786 3.375C10.1786 2.44336 10.8984 1.6875 11.7857 1.6875ZM3.21429 10.6875C2.32701 10.6875 1.60714 9.93164 1.60714 9C1.60714 8.06836 2.32701 7.3125 3.21429 7.3125C4.10156 7.3125 4.82143 8.06836 4.82143 9C4.82143 9.93164 4.10156 10.6875 3.21429 10.6875ZM11.7857 16.3125C10.8984 16.3125 10.1786 15.5566 10.1786 14.625C10.1786 13.6934 10.8984 12.9375 11.7857 12.9375C12.673 12.9375 13.3929 13.6934 13.3929 14.625C13.3929 15.5566 12.673 16.3125 11.7857 16.3125Z" fill="black"/>
                        </svg>
                      </a>

                      <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                        <div class="share-dropdown">
                          <p><strong>SHARE</strong></p>
                          <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fblog.paloaltonetworks.com%2F2016%2F09%2Flabyrenth-capture-the-flag-ctf-threat-track-solutions%2F" target="_blank">
                          <i class="fa fb-icon fa-facebook-official pop-up-icon" aria-hidden="true"></i></a>
                          
                          <a href="https://twitter.com/home?status=https%3A%2F%2Fblog.paloaltonetworks.com%2F2016%2F09%2Flabyrenth-capture-the-flag-ctf-threat-track-solutions%2F+-+LabyREnth+Capture+the+Flag+%28CTF%29%3A+Threat+Track+Solutions" target="_blank"><i class="fa tw-icon fa-twitter pop-up-icon" aria-hidden="true"></i></a>
                          <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fblog.paloaltonetworks.com%2F2016%2F09%2Flabyrenth-capture-the-flag-ctf-threat-track-solutions%2F&title=LabyREnth+Capture+the+Flag+%28CTF%29%3A+Threat+Track+Solutions&summary=&source=" target="_blank"><i class="fa lindn-icon fa-linkedin pop-up-icon" aria-hidden="true"></i></a>
                          <a href="//www.reddit.com/submit?url=https://blog.paloaltonetworks.com/2016/09/labyrenth-capture-the-flag-ctf-threat-track-solutions/" target="_blank"><i class="fa blog-icon fa-stumbleupon-circle pop-up-icon" aria-hidden="true"></i></a>
                          
                          </div>                       
                        </div>
                      </div>
                    </div>
                </div>
              </div>
              <div class="entry-content article-description"><p>Welcome back to our blog series where we reveal the solutions to <a href="https://blog.paloaltonetworks.com/2016/07/unit42-announcing-the-labyrenth-capture-the-flag-ctf-challenge/" target="_blank">LabyREnth, the Unit 42 Capture the Flag (CTF)</a> challenge. We’ll be revealing the <a href="https://blog.paloaltonetworks.com/tag/ctf/" target="_blank">solutions</a> to one challenge track per week. Next up, the Threat track.<span id="more-18169"></span></p>
<h3>Threat 1 Challenge: Welcome to the well of wishes!</h3>
<p><em>Challenge Created By: Jeff White </em><a href="https://twitter.com/noottrak" target="_blank"><em>@noottrak</em></a></p>
<p>For this challenge you’re provided a PCAP that has 30 HTTP GET Requests to <a href="http://www.dopefish.com" target="_blank">www.dopefish.com</a>. Inside each request is the same URL to the below image and a base64, reversed, string that decodes to “Not everything is as it seems&#8230;”.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_1.png"><img class="size-large wp-image-18346 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_1-500x289.png" alt="CTF_Threat_1" width="500" height="289" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_1-500x289.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_1-230x133.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_1-510x295.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_1-69x40.png 69w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_1.png 663w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Looking at the actual GET requests, the URL structure is interesting as there are a few sections in the URL that remain static between the URLs so we’ll go ahead and extract them all for further analysis.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_2.png"><img class="size-large wp-image-18334 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_2-500x371.png" alt="CTF_Threat_2" width="500" height="371" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_2-500x371.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_2-230x170.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_2-768x569.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_2-405x300.png 405w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_2-54x40.png 54w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_2.png 900w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Using the below command extracts each URL.</p>
<p>tcpdump -r dopefish_labyrinth.pcap -A |grep &#8220;GET /&#8221; |grep -o &#8220;/.*&#8221; |sort –u</p>
<p>The general breakdown of the URL is as follows:</p>
<p>/M[a-zA-Z]{3}.php?=owVXdTMzc[a-zA-Z0-9]{109}&amp;L4bry1nth_[0-9]{3,5}?NxM[a-zA-Z0-9]{134}-[0-9]{4,5}%26%71%77port%3D27500</p>
<p>Dropping the URL into an online URL parser shows that the query string being supplied to the file is the entire string after the initial “?”, which seems odd since there appears to be other variables in the URL.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_3.png"><img class="size-large wp-image-18331 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_3-500x390.png" alt="CTF_Threat_3" width="500" height="390" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_3-500x390.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_3-230x180.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_3-768x600.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_3-384x300.png 384w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_3-51x40.png 51w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_3.png 899w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Further analysis shows that the URL is not correctly formatted as “?” and “=” are reserved characters. When they are placed next to each other, without variables in-between, the rest of the URL becomes invalid.</p>
<p>Looking at the query string starting with “=” and the above hint with a reverse base64 string beginning with the same symbol, I try to base64 decode the reversed string…which works, but the output is of no use.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_4.png"><img class="size-large wp-image-18328 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_4-500x15.png" alt="CTF_Threat_4" width="500" height="15" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_4-500x15.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_4-230x7.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_4-768x23.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_4-510x15.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_4-240x7.png 240w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_4.png 899w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>After taking a closer look at the URLs, I noticed there are definite patterns that stand out in the characters, but “NxM” continues to repeat itself roughly every 18 characters. More importantly, the NxM pattern that is seen in the first long string and the long string directly following the “&amp;L4bry1nth_[0-9]{3,5}?” section of the URL. By removing this and putting the two long strings together, reversing it, and base64 decoding it, we get much more usable results.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_5.png"><img class="size-large wp-image-18325 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_5-500x20.png" alt="CTF_Threat_5" width="500" height="20" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_5-500x20.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_5-230x9.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_5-768x30.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_5-510x20.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_5-240x9.png 240w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_5.png 897w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>“317WW317WW317WW317WW317WW317WW317WW317WW317WW317WW317WW317<br />
W317WW317WW317WW317WW317WW317WW317WW317WW317WW317WW317WW317<br />
W317WW317WW317WW317WW317WW317WW317WW317WW317WW317WW317WW317<br />
W317WW317WW”</p>
<p>Continuing to build on our previous line, we wrap it in a for loop and parse out only the two halves, reverse them, and print the result.</p>
<p>for i in $(tcpdump -r dopefish_labyrinth.pcap -A |grep &#8220;GET /&#8221; |grep -o &#8220;/.*&#8221; |sort -u |cut -d&#8221;=&#8221; -f2 |cut -d&#8221;-&#8221; -f1 |sed -e &#8216;s/&amp;L4bry1nth_.*?//g&#8217;); do echo &#8220;=$i&#8221; |rev |base64 -D ; done</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_6.png"><img class="size-large wp-image-18322 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_6-500x196.png" alt="CTF_Threat_6" width="500" height="196" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_6-500x196.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_6-230x90.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_6-768x300.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_6-510x199.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_6-102x40.png 102w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_6.png 900w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>There is a very apparent pattern in the output. The last step we take is to add one more command to our line and strip out the “317”, which turns out was the “NxM” from the URL.</p>
<p>for i in $(tcpdump -r dopefish_labyrinth.pcap -A |grep &#8220;GET /&#8221; |grep -o &#8220;/.*&#8221; |sort -u |cut -d&#8221;=&#8221; -f2 |cut -d&#8221;-&#8221; -f1 |sed -e &#8216;s/&amp;L4bry1nth_.*?//g&#8217;); do echo &#8220;=$i&#8221; |rev |base64 -D ; done |sed -e &#8216;s/317//g&#8217;</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_7.png"><img class="size-large wp-image-18319 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_7-500x488.png" alt="CTF_Threat_7" width="500" height="488" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_7-500x488.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_7-230x225.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_7-768x750.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_7-307x300.png 307w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_7-41x40.png 41w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_7-32x32.png 32w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_7.png 900w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>The key is PAN{th3D0p3fshl1v3s}.</p>
<h3>Threat 2 Challenge: The rest of us, we died with our honor.</h3>
<p><em>Challenge Created By: </em>Micah Yates <a href="https://twitter.com/m1kachu_" target="_blank">@m1kachu_</a></p>
<p><em>The hint is referring to this awesome </em><a href="http://i.imgur.com/srMDxbk.jpg" target="_blank"><em>web-comic</em></a><em>.</em></p>
<p>To begin the challenge, we are given a file named jareth1.gif</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_8.png"><img class="size-full wp-image-18316 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_8.png" alt="CTF_Threat_8" width="319" height="383" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_8.png 319w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_8-230x276.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_8-250x300.png 250w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_8-33x40.png 33w" sizes="(max-width: 319px) 100vw, 319px" /></a></p>
<p>The thumbnail makes it look like a valid gif, but is it?</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/jareth1.gif"><img class="size-full wp-image-18598 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/jareth1.gif" alt="jareth1" width="461" height="305" /></a></p>
<p>The file opens and animates fine.</p>
<p>Opening the gif with a hex editor, the header looks like a regular gif header.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_10.png"><img class="size-large wp-image-18310 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_10-500x12.png" alt="CTF_Threat_10" width="500" height="12" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_10-500x12.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_10-230x6.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_10-768x19.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_10-510x12.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_10-240x6.png 240w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Scroll to the bottom, and this file is missing the standard gif trailer of 0x3B. (Read more about <a href="http://giflib.sourceforge.net/whatsinagif/bits_and_bytes.html" target="_blank">what’s in a valid gif</a>.)</p>
<p>The hex values at the end are not the standard gif trailer.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_11.png"><img class="size-large wp-image-18307 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_11-500x11.png" alt="CTF_Threat_11" width="500" height="11" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_11-500x11.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_11-230x5.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_11-768x17.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_11-510x11.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_11-240x5.png 240w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>There is data appended to this gif.</p>
<p>So what do we do with this information? One trick I like to employ with tampered image files is to do a reverse image lookup via Google. I upload the jareth1.gif file to google image search and get this back:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_12.png"><img class="size-large wp-image-18304 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_12-500x268.png" alt="CTF_Threat_12" width="500" height="268" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_12-500x268.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_12-230x123.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_12-510x274.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_12-75x40.png 75w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_12.png 550w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Clicking through a few of the visually similar images we find this <a href="http://i.imgur.com/CTKsJjN.gif">gif</a>. It animates the same and has the same dimensions as our jareth1.gif but a different size.</p>
<p>When diffing the two gifs, we can see that the original gif ended at offset 0x3436D with a valid trailer of 0x3B. Some shellcode and malware authors like to hide data by XOR-ing it with single or multi-byte hex values. Since it appears that the 0xAA bytes are repeating at the end of the file, and some data typically contains nulls, lets XOR the entire file by 0xAA.</p>
<p>Now let’s look at the leftover data’s header:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_13.png"><img class="size-large wp-image-18301 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_13-500x29.png" alt="CTF_Threat_13" width="500" height="29" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_13-500x29.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_13-230x13.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_13-768x44.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_13-510x29.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_13-240x14.png 240w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_13.png 1057w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Based off of the header, it appears that the hidden data is a 7zip archive. Let’s save off this XOR’d data to another file.</p>
<p>One trick I like to use is 7zip’s ability to unzip files when the header is in the incorrect place. Simply use the command line or right click and select 7zip -&gt; Extract here.</p>
<p>Decompressing that file gives us another file simply named “file”.</p>
<p>Taking a quick look at the header we see that this is an html file.</p>
<p>Renaming it to file.html and opening it with a browser yields this glorious ASCII art of David Bowie:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_14.png"><img class="size-large wp-image-18298 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_14-500x286.png" alt="CTF_Threat_14" width="500" height="286" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_14-500x286.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_14-230x131.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_14-768x439.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_14-510x291.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_14-70x40.png 70w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_14.png 1001w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>So what now? There’s no obfuscated javascript, just a seemingly incomprehensible mess of html. It also looks as if there is a repeating pattern of A7 A0 bookending some other data.</p>
<p>Let’s drop a section of that hex looking data into a hex editor:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_15.png"><img class="size-large wp-image-18295 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_15-500x65.png" alt="CTF_Threat_15" width="500" height="65" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_15-500x65.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_15-230x30.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_15-768x99.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_15-510x66.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_15-240x31.png 240w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>None of it renders into ASCII, let’s try XORing it with 2 byte 0xA7A0 to see if there’s data underneath:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_16.png"><img class="size-large wp-image-18292 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_16-500x71.png" alt="CTF_Threat_16" width="500" height="71" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_16-500x71.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_16-230x33.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_16-768x109.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_16-510x73.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_16-240x34.png 240w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_16.png 1082w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Still nothing to work with, but it does look like it could possibly be ASCII text.</p>
<p>Let’s undo that and try again with the original single byte 0xAA:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_17.png"><img class="size-large wp-image-18289 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_17-500x69.png" alt="CTF_Threat_17" width="500" height="69" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_17-500x69.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_17-230x32.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_17-768x106.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_17-510x70.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_17-240x33.png 240w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_17.png 1080w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Much better. The text renders as:</p>
<p>Write a YARA rule to find normal valid GIF files.</p>
<p>Using the template below:</p>
<ol>
<li>replace each &#8220;**&#8221; pair in $header with the appropriate 6 bytes.</li>
<li>replace each &#8220;*&#8221; in $trailer with the appropriate regex.</li>
<li>replace the &#8220;*&#8221; in condition with the appropriate digit.</li>
</ol>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c5e37f22343568176" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
rule valid_gif : valid_gif
{
        strings:

			$header = { ** ** ** ** ** ** }
			$trailer = *******
				
        condition:
			$header at * and $trailer
}

Using the information about proper gif structure we write the following correct rule:

rule valid_gif : valid_gif
{
        strings:

			$header = { 47 49 46 38 39 61 }
			$trailer = /\x3B$/
				
        condition:
			$header at 0 and $trailer
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c5e37f22343568176-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f22343568176-2">2</div><div class="crayon-num" data-line="crayon-5f694c5e37f22343568176-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f22343568176-4">4</div><div class="crayon-num" data-line="crayon-5f694c5e37f22343568176-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f22343568176-6">6</div><div class="crayon-num" data-line="crayon-5f694c5e37f22343568176-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f22343568176-8">8</div><div class="crayon-num" data-line="crayon-5f694c5e37f22343568176-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f22343568176-10">10</div><div class="crayon-num" data-line="crayon-5f694c5e37f22343568176-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f22343568176-12">12</div><div class="crayon-num" data-line="crayon-5f694c5e37f22343568176-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f22343568176-14">14</div><div class="crayon-num" data-line="crayon-5f694c5e37f22343568176-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f22343568176-16">16</div><div class="crayon-num" data-line="crayon-5f694c5e37f22343568176-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f22343568176-18">18</div><div class="crayon-num" data-line="crayon-5f694c5e37f22343568176-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f22343568176-20">20</div><div class="crayon-num" data-line="crayon-5f694c5e37f22343568176-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f22343568176-22">22</div><div class="crayon-num" data-line="crayon-5f694c5e37f22343568176-23">23</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c5e37f22343568176-1"><span class="crayon-e">rule </span><span class="crayon-v">valid_gif</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">valid_gif</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f22343568176-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694c5e37f22343568176-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">strings</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f22343568176-4">&nbsp;</div><div class="crayon-line" id="crayon-5f694c5e37f22343568176-5"><span class="crayon-h">			</span><span class="crayon-sy">$</span><span class="crayon-v">header</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f22343568176-6"><span class="crayon-h">			</span><span class="crayon-sy">$</span><span class="crayon-v">trailer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span></div><div class="crayon-line" id="crayon-5f694c5e37f22343568176-7"><span class="crayon-h">				</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f22343568176-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">condition</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f22343568176-9"><span class="crayon-h">			</span><span class="crayon-sy">$</span><span class="crayon-e">header </span><span class="crayon-e ">at *</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">trailer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f22343568176-10"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694c5e37f22343568176-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f22343568176-12"><span class="crayon-e">Using </span><span class="crayon-e">the </span><span class="crayon-e">information </span><span class="crayon-e">about </span><span class="crayon-e">proper </span><span class="crayon-e">gif </span><span class="crayon-e">structure </span><span class="crayon-e">we </span><span class="crayon-e">write </span><span class="crayon-e">the </span><span class="crayon-e">following </span><span class="crayon-e">correct </span><span class="crayon-v">rule</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f22343568176-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f22343568176-14"><span class="crayon-e">rule </span><span class="crayon-v">valid_gif</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">valid_gif</span></div><div class="crayon-line" id="crayon-5f694c5e37f22343568176-15"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f22343568176-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">strings</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f22343568176-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f22343568176-18"><span class="crayon-h">			</span><span class="crayon-sy">$</span><span class="crayon-v">header</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-cn">47</span><span class="crayon-h"> </span><span class="crayon-cn">49</span><span class="crayon-h"> </span><span class="crayon-cn">46</span><span class="crayon-h"> </span><span class="crayon-cn">38</span><span class="crayon-h"> </span><span class="crayon-cn">39</span><span class="crayon-h"> </span><span class="crayon-cn">61</span><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694c5e37f22343568176-19"><span class="crayon-h">			</span><span class="crayon-sy">$</span><span class="crayon-v">trailer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-sy">\</span><span class="crayon-v">x3B</span><span class="crayon-sy">$</span><span class="crayon-o">/</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f22343568176-20"><span class="crayon-h">				</span></div><div class="crayon-line" id="crayon-5f694c5e37f22343568176-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">condition</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f22343568176-22"><span class="crayon-h">			</span><span class="crayon-sy">$</span><span class="crayon-e">header </span><span class="crayon-i">at</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">trailer</span></div><div class="crayon-line" id="crayon-5f694c5e37f22343568176-23"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>After reading this article about <a href="http://giflib.sourceforge.net/whatsinagif/bits_and_bytes.html" target="_blank">what’s in a gif</a>:</p>
<ol>
<li>The header is self-explanatory.</li>
<li>The regex format is required here to make sure there is no following data after the 3B</li>
<li>And of course the header has to be at the beginning of the file at position 0</li>
</ol>
<p>Submitting the rule above will result in the key: PAN{848Y_wIsh3D_4w4y}</p>
<h3>Threat 3 Challenge: Matryoshkas got nothing on me.</h3>
<p><em>Challenge Created By: Josh Grunzweig </em><a href="https://twitter.com/jgrunzweig" target="_blank"><em>@jgrunzweig</em></a></p>
<p>For this challenge, we’re presented with a Python script. When you run the script, the only output you receive is this:</p>
<p>python h0ggle.py<br />
You fell into a pit and died&#8230; of dysentery.</p>
<p>Looking at the script, it appears to base64 decode the data and decrypt it before passing it to exec() function. The data is rather large, with over one million characters. It’s using AES for the encryption from the Crypto.Cipher suite and stepping through it with a debugger shows that it continues this iteration process where each blob of data executed contains the same code with a new blob of data.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_18.png"><img class="size-large wp-image-18286 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_18-500x135.png" alt="CTF_Threat_18" width="500" height="135" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_18-500x135.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_18-230x62.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_18-768x208.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_18-510x138.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_18-148x40.png 148w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_18.png 898w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Following this line of logic, we can quickly script out this process. We’ll write each decrypted section to a new file and include the headers necessary to run it again, so on and so forth, until we reach the end.</p>
<p>First, we’ll create header.txt with the following data:</p>
<p>#!/usr/bin/env python</p>
<p><strong>from </strong>Crypto.Cipher <strong>import </strong>AES <strong>as </strong>tiywynstbg<br />
<strong>import </strong>base64 <strong>as </strong>ufjliotyds<br />
<strong>import </strong>itertools <strong>as </strong>abtwsjxzys<br />
<strong>from </strong>itertools <strong>import </strong>cycle, izip<br />
<strong>def </strong>gasfewfesafds(message, key):<br />
<strong>return &#8221;</strong>.join(chr(ord(c)^ord(k)) <strong>for </strong>c,k <strong>in </strong>abtwsjxzys.izip(message, abtwsjxzys.cycle(key)))</p>
<p>Next, we’ll put together a one-liner to traverse the dark depths of Python and see where it leads.</p>
<p>cp h0ggle.py h0ggle_1.py; for i in $(seq 1 50); do sed -e &#8216;s/exec(/print(/g&#8217; h0ggle_$i.py &gt; temp; mv temp h0ggle_$i.py; python h0ggle_$i.py &gt; temp; cat header.txt temp &gt; h0ggle_$((i+1)).py; done</p>
<p>We run into a syntax error on file h0ggle_28.py, which shows our dysentery error message.</p>
<p>File &#8220;h0ggle_28.py&#8221;, line 8<br />
You fell into a pit and died&#8230; of dysentery.<br />
^</p>
<p>Looking at h0ggle_27.py we can see how to safely cross the river!</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_19.png"><img class="size-large wp-image-18283 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_19-500x159.png" alt="CTF_Threat_19" width="500" height="159" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_19-500x159.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_19-230x73.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_19-768x245.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_19-510x163.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_19-125x40.png 125w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_19.png 900w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Key = PAN{all_dir3ctionz_l3ad_n0wh3r3}</p>
<h3>Threat 4 Challenge: The same, but different.</h3>
<p><em>Challenge Created By: </em>Micah Yates <a href="https://twitter.com/m1kachu_" target="_blank">@m1kachu_</a></p>
<p><em>The hint is referring to the previous yara challenge, Threat 2 Challenge: The rest of us, we died with our honor.</em></p>
<p>To begin the challenge, we are given 6 word docs.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_20.png"><img class="size-full wp-image-18460 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_20.png" alt="CTF_Threat_20" width="320" height="369" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_20.png 320w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_20-230x265.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_20-260x300.png 260w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_20-35x40.png 35w" sizes="(max-width: 320px) 100vw, 320px" /></a></p>
<p>Let’s open them all up</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_21.png"><img class="size-large wp-image-18457 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_21-500x258.png" alt="CTF_Threat_21" width="500" height="258" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_21-500x258.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_21-230x118.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_21-768x396.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_21-510x263.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_21-78x40.png 78w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_21.png 1058w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>The files open and display the somewhat same word doc.</p>
<p>Running the file command on all of these files results in:</p>
<p>3673c9d7a5b2f978d3a34001d360ac485f22ed6fa868c8304eb99273a6efb268.doc: Microsoft Word 2007+<br />
668bed5ed5d5effb3be659e8dab55c63369985064f7ee80f9365e75b34f6283d.doc: Microsoft Word 2007+<br />
7717bd124dd0c0881afd6b327ff41b420bff77d3c5ae338a31cce5cfdcb3b5d0.doc: data<br />
87f146c41082d7ba885f9433e0223b346f3032f7364bf18675b924a017994779.doc: Microsoft Word 2007+<br />
afc502de73482404cc344301c207f27c7da7b31641cd2192b3bba40f3ab6964e.doc: Composite Document File V2 Document, Little Endian, Os: Windows, Version 6.1, Code page: 1252, Author: Micah Yates, Template: Normal.dotm, Last Saved By: Micah Yates, Revision Number: 2, Name of Creating Application: Microsoft Office Word, Create Time/Date: Wed Jul 13 17:19:00 2016, Last Saved Time/Date: Wed Jul 13 17:19:00 2016, Number of Pages: 1, Number of Words: 146, Number of Characters: 837, Security: 0<br />
d48a2f4922bca81ce8fff8c18d788f41d2034c7999ca1ed03965d914dc06a9df.doc: Rich Text Format data, version 1, unknown character set</p>
<p>They’re not all the same file format, but all contain the same basic content. There’s a .doc, .docx, .rtf, .mhtm, .dot, and .docm file with the same plaintext inside. Simply changing their extensions to .doc allows for Word to try and open them as a standard Word .doc</p>
<p>Let’s open up the RTF (d48a2f4922bca81ce8fff8c18d788f41d2034c7999ca1ed03965d914dc06a9df.doc) in a hex editor. They’re typically fairly simple to follow. The header looks fine so lets scroll down to the bottom of the file.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_22.png"><img class="size-large wp-image-18454 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_22-500x140.png" alt="CTF_Threat_22" width="500" height="140" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_22-500x140.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_22-230x65.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_22-768x216.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_22-510x143.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_22-143x40.png 143w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Looks weird right? Let’s take a look at the RTF file format on Wikipedia, specifically the <a href="https://en.wikipedia.org/wiki/Rich_Text_Format#Code_Syntax">Code Syntax</a>:</p>
<p>Get all that?</p>
<p>So the TL;DR of that section states that RTF data must be within curly braces “{}”. This RTF file clearly has data appended to it.</p>
<p>Remember the hint? “The same, but different.”Well it seems this challenge is similar to the Threat 2 challenge. There is unknown data appended to a legitimate looking file.</p>
<p>Let’s attack the data that seems to be repeating. The appended data looks similar to base64 encoding, but somewhat obscured. Within this appended data we have 3 sequences of data that are 48 bytes long that are repeating.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_23.png"><img class="size-large wp-image-18451 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_23-500x10.png" alt="CTF_Threat_23" width="500" height="10" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_23-500x10.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_23-230x5.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_23-768x15.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_23-510x10.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_23-240x5.png 240w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_24.png"><img class="size-large wp-image-18448 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_24-500x9.png" alt="CTF_Threat_24" width="500" height="9" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_24-500x9.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_24-230x4.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_24-768x14.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_24-510x10.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_24-240x5.png 240w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Two of them are different, and of those, one is clearly not a valid Base64. (See <a href="https://en.wikipedia.org/wiki/Base64">Wikipedia’s definition of Base64</a>.)</p>
<p>When there are sequences of four repeating characters in Base64 encoded data, the underlying data typically repeats in some sort of pattern. For example: AAAAAAAAA Base64 encoded is QUFBQUFBQUFB</p>
<p>Let’s assume these two different sequences are hiding the same data, but have encoded it differently due to data position. If that’s true, it looks like both sequences have also been obscured by a single byte operation. So what do we do to figure out that operation? Brute Force!</p>
<p>Let’s write a small script that performs single byte operations on the two sequences and then test it to see if they’re valid Base64 characters. In short, this runs a simple one byte XOR over each byte in the sequence and checks to see if they are ASCII compatible with Base64 characters.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c5e37f2b376798989" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import sys, re
data_sequence = bytearray(open(sys.argv[1], 'rb').read())

test_output = ""

key = range(0,255)
for i in range(len(key)):
    for j in data_sequence:
        test_output+=(chr(i^j))
    base64_test = test_output
    test_output = ""
    if re.match("(?:[A-Za-z0-9+\/]{8})", base64_test):
        print hex(i), base64_test</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c5e37f2b376798989-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f2b376798989-2">2</div><div class="crayon-num" data-line="crayon-5f694c5e37f2b376798989-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f2b376798989-4">4</div><div class="crayon-num" data-line="crayon-5f694c5e37f2b376798989-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f2b376798989-6">6</div><div class="crayon-num" data-line="crayon-5f694c5e37f2b376798989-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f2b376798989-8">8</div><div class="crayon-num" data-line="crayon-5f694c5e37f2b376798989-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f2b376798989-10">10</div><div class="crayon-num" data-line="crayon-5f694c5e37f2b376798989-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f2b376798989-12">12</div><div class="crayon-num" data-line="crayon-5f694c5e37f2b376798989-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c5e37f2b376798989-1"><span class="crayon-e">import </span><span class="crayon-v">sys</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">re</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f2b376798989-2"><span class="crayon-v">data_sequence</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">bytearray</span><span class="crayon-sy">(</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">sys</span><span class="crayon-sy">.</span><span class="crayon-v">argv</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'rb'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f2b376798989-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f2b376798989-4"><span class="crayon-v">test_output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5f694c5e37f2b376798989-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f2b376798989-6"><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">255</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f2b376798989-7"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f2b376798989-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">data_sequence</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f2b376798989-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">test_output</span><span class="crayon-o">+=</span><span class="crayon-sy">(</span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">^</span><span class="crayon-v">j</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f2b376798989-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">base64_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">test_output</span></div><div class="crayon-line" id="crayon-5f694c5e37f2b376798989-11"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">test_output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f2b376798989-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">re</span><span class="crayon-sy">.</span><span class="crayon-e">match</span><span class="crayon-sy">(</span><span class="crayon-s">"(?:[A-Za-z0-9+\/]{8})"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">base64_test</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f2b376798989-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print </span><span class="crayon-e">hex</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">base64_test</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>I truncated the two sequences above into an 8-byte sequence of data:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_25.png"><img class="size-full wp-image-18445 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_25.png" alt="CTF_Threat_25" width="361" height="108" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_25.png 361w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_25-230x69.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_25-134x40.png 134w" sizes="(max-width: 361px) 100vw, 361px" /></a></p>
<p>Running the script over these shortened sequences, it returns 4 XOR candidates:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_26.png"><img class="size-full wp-image-18442 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_26.png" alt="CTF_Threat_26" width="189" height="84" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_26.png 189w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_26-90x40.png 90w" sizes="(max-width: 189px) 100vw, 189px" /></a></p>
<p>So we have four potential XOR values that decode valid Base64 characters.</p>
<p>Starting with XOR-ing the appended data with 0x26 we get this:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_27.png"><img class="size-large wp-image-18439 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_27-500x419.png" alt="CTF_Threat_27" width="500" height="419" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_27-500x419.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_27-230x193.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_27-768x644.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_27-358x300.png 358w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_27-48x40.png 48w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_27.png 1036w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Looks pretty promising, and almost all characters are Base64 standard except there are no “+” characters, only “-“.</p>
<p>This looks like it may be using an alternate encoding string with “-“ in place of “+”. If we try and decode with this alphabet: “ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-/”, there is no data that looks promising.</p>
<p>Some malicious Base64 encodings use alternate alphabets. Sometimes they’re simple and just change up the position of the alphabet. Let’s write another brute force script to rotate the position of the alphabet above, decode, and test to see if it has valid ASCII text.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c5e37f2e667988065" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import string, base64, re

STANDARD_ALPHABET = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
CUSTOM_ALPHABET = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-/'
ROTATED_ALPHABET = CUSTOM_ALPHABET
def is_ascii(s):
    return all(ord(c) &lt; 128 for c in s)
input_str = "vRjD3gu6ysbzqvjbihjP1gu63gW6zgvOzwnOigfG1cbQyxjDyxrD1QTNigXAihrC0xm6zwT91Qr/zcb-
yxr7l6OkvxnD1A263g7/ihr/1xbGyxr/igj/1gXRihj/2gL7yQu6zwf90ca8k8C8ihb70xi63Q/O0cbO0gu
6zA/M2Rq6mti6yB/OzxmUdqCncBjP1gu6zwT9xQrJyMaUigvIyPX-
1QmncBGnc8a6ica6ica62RrM0wTB2NCnc6-jdqCjcq--
zA/M2Rq6psbVicCEicCEicCEicCEicCEicCEicCEicCEicCEicCEicCEicCEihOnc6-
jcsrNzwnJ1Aq6psbVicCEicCEicCEicCEicCEicCEicCEicCEicCEicCEicCEicCEihOnc6-
jcsrO0g/MzcaXihG6k8C6k8C6k8C6k8C6k8C6k8C6k8C6k8C6k8C6k8C6k8C6k8C65qOkcq
-jcqOkica6ica6icb91QT-0xrD1QSUdqCjcq-LigXAihrCzwOncBOa"

def alt_decode(input):
  return base64.b64decode(input.translate(DECODE_TRANS))

for rotate in range(len(CUSTOM_ALPHABET)):
    ROTATED_ALPHABET = CUSTOM_ALPHABET[rotate:]+CUSTOM_ALPHABET[:rotate]
    DECODE_TRANS = string.maketrans(ROTATED_ALPHABET, STANDARD_ALPHABET)
    if is_ascii(alt_decode(input_str)):
        print rotate, ROTATED_ALPHABET
        print "***************"
        print alt_decode(input_str) </textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c5e37f2e667988065-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f2e667988065-2">2</div><div class="crayon-num" data-line="crayon-5f694c5e37f2e667988065-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f2e667988065-4">4</div><div class="crayon-num" data-line="crayon-5f694c5e37f2e667988065-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f2e667988065-6">6</div><div class="crayon-num" data-line="crayon-5f694c5e37f2e667988065-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f2e667988065-8">8</div><div class="crayon-num" data-line="crayon-5f694c5e37f2e667988065-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f2e667988065-10">10</div><div class="crayon-num" data-line="crayon-5f694c5e37f2e667988065-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f2e667988065-12">12</div><div class="crayon-num" data-line="crayon-5f694c5e37f2e667988065-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f2e667988065-14">14</div><div class="crayon-num" data-line="crayon-5f694c5e37f2e667988065-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f2e667988065-16">16</div><div class="crayon-num" data-line="crayon-5f694c5e37f2e667988065-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f2e667988065-18">18</div><div class="crayon-num" data-line="crayon-5f694c5e37f2e667988065-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f2e667988065-20">20</div><div class="crayon-num" data-line="crayon-5f694c5e37f2e667988065-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f2e667988065-22">22</div><div class="crayon-num" data-line="crayon-5f694c5e37f2e667988065-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f2e667988065-24">24</div><div class="crayon-num" data-line="crayon-5f694c5e37f2e667988065-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f2e667988065-26">26</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c5e37f2e667988065-1"><span class="crayon-e">import </span><span class="crayon-t">string</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">base64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">re</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f2e667988065-2">&nbsp;</div><div class="crayon-line" id="crayon-5f694c5e37f2e667988065-3"><span class="crayon-v">STANDARD_ALPHABET</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f2e667988065-4"><span class="crayon-v">CUSTOM_ALPHABET</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-/'</span></div><div class="crayon-line" id="crayon-5f694c5e37f2e667988065-5"><span class="crayon-v">ROTATED_ALPHABET</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">CUSTOM_ALPHABET</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f2e667988065-6"><span class="crayon-e">def </span><span class="crayon-e">is_ascii</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f2e667988065-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">all</span><span class="crayon-sy">(</span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f2e667988065-8"><span class="crayon-v">input_str</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"vRjD3gu6ysbzqvjbihjP1gu63gW6zgvOzwnOigfG1cbQyxjDyxrD1QTNigXAihrC0xm6zwT91Qr/zcb-</span></div><div class="crayon-line" id="crayon-5f694c5e37f2e667988065-9"><span class="crayon-s">yxr7l6OkvxnD1A263g7/ihr/1xbGyxr/igj/1gXRihj/2gL7yQu6zwf90ca8k8C8ihb70xi63Q/O0cbO0gu</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f2e667988065-10"><span class="crayon-s">6zA/M2Rq6mti6yB/OzxmUdqCncBjP1gu6zwT9xQrJyMaUigvIyPX-</span></div><div class="crayon-line" id="crayon-5f694c5e37f2e667988065-11"><span class="crayon-s">1QmncBGnc8a6ica6ica62RrM0wTB2NCnc6-jdqCjcq--</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f2e667988065-12"><span class="crayon-s">zA/M2Rq6psbVicCEicCEicCEicCEicCEicCEicCEicCEicCEicCEicCEicCEihOnc6-</span></div><div class="crayon-line" id="crayon-5f694c5e37f2e667988065-13"><span class="crayon-s">jcsrNzwnJ1Aq6psbVicCEicCEicCEicCEicCEicCEicCEicCEicCEicCEicCEicCEihOnc6-</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f2e667988065-14"><span class="crayon-s">jcsrO0g/MzcaXihG6k8C6k8C6k8C6k8C6k8C6k8C6k8C6k8C6k8C6k8C6k8C6k8C65qOkcq</span></div><div class="crayon-line" id="crayon-5f694c5e37f2e667988065-15"><span class="crayon-s">-jcqOkica6ica6icb91QT-0xrD1QSUdqCjcq-LigXAihrCzwOncBOa"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f2e667988065-16">&nbsp;</div><div class="crayon-line" id="crayon-5f694c5e37f2e667988065-17"><span class="crayon-e">def </span><span class="crayon-e">alt_decode</span><span class="crayon-sy">(</span><span class="crayon-v">input</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f2e667988065-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">base64</span><span class="crayon-sy">.</span><span class="crayon-e">b64decode</span><span class="crayon-sy">(</span><span class="crayon-v">input</span><span class="crayon-sy">.</span><span class="crayon-e">translate</span><span class="crayon-sy">(</span><span class="crayon-v">DECODE_TRANS</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f2e667988065-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f2e667988065-20"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">rotate </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">CUSTOM_ALPHABET</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f2e667988065-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ROTATED_ALPHABET</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">CUSTOM_ALPHABET</span><span class="crayon-sy">[</span><span class="crayon-v">rotate</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-v">CUSTOM_ALPHABET</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">rotate</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f2e667988065-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">DECODE_TRANS</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">string</span><span class="crayon-sy">.</span><span class="crayon-e">maketrans</span><span class="crayon-sy">(</span><span class="crayon-v">ROTATED_ALPHABET</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">STANDARD_ALPHABET</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f2e667988065-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">is_ascii</span><span class="crayon-sy">(</span><span class="crayon-e">alt_decode</span><span class="crayon-sy">(</span><span class="crayon-v">input_str</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f2e667988065-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print </span><span class="crayon-v">rotate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">ROTATED_ALPHABET</span></div><div class="crayon-line" id="crayon-5f694c5e37f2e667988065-25"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"***************"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f2e667988065-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print </span><span class="crayon-e">alt_decode</span><span class="crayon-sy">(</span><span class="crayon-v">input_str</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>So what we did in the script was enter our data that had been XOR-ed with 0x26. We defined an alternative Base64 alphabet and then looped through all variations of that alphabet by rotating the entire alphabet by one character per loop. We then checked each output to see if it was valid ASCII, and then printed it. Running the above code returns:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_28.png"><img class="size-large wp-image-18436 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_28-500x164.png" alt="CTF_Threat_28" width="500" height="164" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_28-500x164.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_28-230x76.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_28-768x252.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_28-510x167.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_28-122x40.png 122w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_28.png 923w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Here’s the encoded data and clue. It appears that the decoding alphabet has been rotated by 26 characters.</p>
<p>Would you look at that, three lines of repeating characters, all the same length: “{ ** ** ** ** ** ** ** ** ** ** ** ** }”</p>
<p>So to recap, we brute-forced a single byte XOR, then brute forced an alternate base64 alphabet that had been rotated left by 26 characters.</p>
<p>Going back through the other documents we find the two variations to this encoded data, and fill out the YARA rule like this:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c5e37f30014474088" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
rule enc_doc : enc_doc
{
        strings:
		
			$first = { 50 74 4C 62 15 41 53 10 5F 55 44 5C }
			$second = { 4F 40 15 6B 16 5E 54 09 4F 41 43 10 }
			$third = { 4F 45 44 5E 14 67 09 69 5C 55 44 11 }
				
        condition:
			1 of them
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c5e37f30014474088-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f30014474088-2">2</div><div class="crayon-num" data-line="crayon-5f694c5e37f30014474088-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f30014474088-4">4</div><div class="crayon-num" data-line="crayon-5f694c5e37f30014474088-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f30014474088-6">6</div><div class="crayon-num" data-line="crayon-5f694c5e37f30014474088-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f30014474088-8">8</div><div class="crayon-num" data-line="crayon-5f694c5e37f30014474088-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f30014474088-10">10</div><div class="crayon-num" data-line="crayon-5f694c5e37f30014474088-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c5e37f30014474088-1"><span class="crayon-e">rule </span><span class="crayon-v">enc_doc</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">enc_doc</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f30014474088-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694c5e37f30014474088-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">strings</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f30014474088-4"><span class="crayon-h">		</span></div><div class="crayon-line" id="crayon-5f694c5e37f30014474088-5"><span class="crayon-h">			</span><span class="crayon-sy">$</span><span class="crayon-v">first</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-h"> </span><span class="crayon-cn">74</span><span class="crayon-h"> </span><span class="crayon-cn">4C</span><span class="crayon-h"> </span><span class="crayon-cn">62</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-h"> </span><span class="crayon-cn">41</span><span class="crayon-h"> </span><span class="crayon-cn">53</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-cn">5F</span><span class="crayon-h"> </span><span class="crayon-cn">55</span><span class="crayon-h"> </span><span class="crayon-cn">44</span><span class="crayon-h"> </span><span class="crayon-cn">5C</span><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f30014474088-6"><span class="crayon-h">			</span><span class="crayon-sy">$</span><span class="crayon-v">second</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-cn">4F</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-h"> </span><span class="crayon-cn">6B</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-h"> </span><span class="crayon-cn">5E</span><span class="crayon-h"> </span><span class="crayon-cn">54</span><span class="crayon-h"> </span><span class="crayon-cn">09</span><span class="crayon-h"> </span><span class="crayon-cn">4F</span><span class="crayon-h"> </span><span class="crayon-cn">41</span><span class="crayon-h"> </span><span class="crayon-cn">43</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694c5e37f30014474088-7"><span class="crayon-h">			</span><span class="crayon-sy">$</span><span class="crayon-v">third</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-cn">4F</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-h"> </span><span class="crayon-cn">44</span><span class="crayon-h"> </span><span class="crayon-cn">5E</span><span class="crayon-h"> </span><span class="crayon-cn">14</span><span class="crayon-h"> </span><span class="crayon-cn">67</span><span class="crayon-h"> </span><span class="crayon-cn">09</span><span class="crayon-h"> </span><span class="crayon-cn">69</span><span class="crayon-h"> </span><span class="crayon-cn">5C</span><span class="crayon-h"> </span><span class="crayon-cn">55</span><span class="crayon-h"> </span><span class="crayon-cn">44</span><span class="crayon-h"> </span><span class="crayon-cn">11</span><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f30014474088-8"><span class="crayon-h">				</span></div><div class="crayon-line" id="crayon-5f694c5e37f30014474088-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">condition</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f30014474088-10"><span class="crayon-h">			</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-e">of </span><span class="crayon-i">them</span></div><div class="crayon-line" id="crayon-5f694c5e37f30014474088-11"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>Submitting the rule above will result in the key: PAN{7H1r7EEn-hOuR_71me_l1M17}</p>
<h3>Threat 5 Challenge: Hello Confetti!</h3>
<p><em>Challenge Created By: Anthony Kasza </em><a href="https://twitter.com/anthonykasza"><em>@anthonykasza</em></a></p>
<p>Opening the provided “hello.pcap” file with Wireshark and examining the protocol hierarchy within the pcap shows only UDP traffic. Wireshark believes a few of the packets are malformed real-time transport control packets while the majority of the packets are data.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_29.png"><img class="size-large wp-image-18433 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_29-500x161.png" alt="CTF_Threat_29" width="500" height="161" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_29-500x161.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_29-230x74.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_29-510x164.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_29-124x40.png 124w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_29.png 749w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Observing the UDP conversations within Wireshark, only a single “connection” occurred within the pcap. The connection is between port 9090 and 53321 on 127.0.0.1. The inconsistency of protocols above combined with a single connection within the trace file leads to the conclusion the protocol being used is non-standard.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_30.png"><img class="size-large wp-image-18430 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_30-500x354.png" alt="CTF_Threat_30" width="500" height="354" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_30-500x354.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_30-230x163.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_30-424x300.png 424w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_30-57x40.png 57w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_30.png 647w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>The first packet in the trace contains the data “hello :)” followed by an 0x0a. This is the only packet with a length that’s not 8234 and sent from port 53321 to port 9090. The second packet contains data which starts with “BZh” which is the magic file header for a bzip file. Ignoring the first “hello” packet, a bzip archive can be extracted from the trace file. Decompressing the bzip archive reveals a second pcap trace.</p>
<p>Using similar techniques as before, multiple FTP over IPv6 connections can be observed within the pcap. Following one of the FTP connections reveals a series of requests and responses, which all streams mimic:</p>
<ul>
<li>an anonymous FTP login occurs</li>
<li>a series of change directory commands is issued to /this/is/going/to/be/so/much/fun/</li>
<li>a size request for a file resulting in a response of 61052</li>
<li>a REST request for a specified byte offset of the file</li>
<li>the TCP connection is then reset</li>
</ul>
<p>This series of commands is indicative of an FTP range request.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_31.png"><img class="size-large wp-image-18427 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_31-500x464.png" alt="CTF_Threat_31" width="500" height="464" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_31-500x464.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_31-230x213.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_31-323x300.png 323w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_31-43x40.png 43w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_31.png 655w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Reassembling the bytes of the file transferred via FTP range requests provides a tarball. Within the tarball is a third pcap trace file.</p>
<p>Again, observing protocols and conversations within the pcap reveals multiple HTTP connections between two end points. By observing the HTTP response codes in the connections a participant may have noticed only “206 Partial Content” codes. These codes are used to respond to HTTP range requests. The “Range” header is also included in all requests issued within the trace file.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_32.png"><img class="size-large wp-image-18424 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_32-500x283.png" alt="CTF_Threat_32" width="500" height="283" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_32-500x283.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_32-230x130.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_32-510x288.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_32-71x40.png 71w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_32.png 637w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Similar to FTP range requests, HTTP range requests can be used to request specific byte ranges for resources. Reassembling the byte ranges reveals a fourth and final packet trace file.</p>
<p>Within this trace file is a single TLS session between a host and Google. Within the requested SNI names of the “Client Hello” message of the TLS exchange additional server names (besides www.google.com) are present. This should be a big red flag to participants as this indicates the client would accept HTTP host names besides www.google.com. These SNI entries are also not ASCII characters, which also may have been a red flag.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_33.png"><img class="size-large wp-image-18421 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_33-500x353.png" alt="CTF_Threat_33" width="500" height="353" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_33-500x353.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_33-230x162.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_33-425x300.png 425w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_33-57x40.png 57w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_33.png 620w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>The additional SNI entries in hexadecimal representation follow:</p>
<ol>
<li>61707f4a</li>
<li>6801117501561d11</li>
<li>7811795450435511680144117d585a54116172706162110b75</li>
<li>4c</li>
</ol>
<p>Knowing previous challenge flags took the form of “PAN{ FLAG }” XORing the first value of the first SNI entry, 0x61, with 0x50 (“P” in hexadecimal) revealed the key, 0x31, used to XOR the remaining characters with. Doing so produces the key for this challenge:</p>
<p>PAN{Y0 D0g, I Heard Y0u Like PCAPS :D}</p>
<p>This challenge tested the participant’s knowledge of standard networking protocols and how these protocols can be (mis)used to fragment data at the application layer.  It also tested the participant’s tenacity as it was a rather long and obfuscation heavy challenge. Tools used to solve this challenge could include Wireshark, common command line utilities, Bro, and Python’s dpkt module.</p>
<h3>Threat 6 Challenge: There can only be one.</h3>
<p><em>Challenge Created By: </em>Micah Yates <a href="https://twitter.com/m1kachu_" target="_blank">@m1kachu_</a></p>
<p><em>The hint is referring to the singular string required for the challenge YARA rule.</em></p>
<p>We are given the following instructions in the directions.txt file:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c5e37f36777379098" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Given the included archive of malware samples:

Find the longest, contiguous, most efficient rule to catch all of them.
The rule must use the hexadecimal format. 
The rule CANNOT fire on any other samples. ONLY the 48 provided.
The wildcard ("?" or "??") is allowed but not jumps "[1-6]". See http://yara.readthedocs.io/en/latest/writingrules.
html#hexadecimal-strings 
The samples are included in yara_samples.7z password is "infected"

The rule must follow this example format:

rule yara_challenge
{
	strings:
		$yara_challenge = { de ad b? ef ?? ??}
	condition:
		 all of them 
}

You will change the contents of $yara_challenge from "de ad b? ef ?? ??" to a hex formatted rule that will catch all
48 samples.

Use this template when submitting your rule:

rule yara_challenge
{
	strings:
		$yara_challenge = { ** ** ** ** ** ** }
	condition:
		 all of them 
}


Hint:
There are 52 wildcard "?"'s within the answer

Malware samples have the following sha256 hashes:
0050e14f8e6bca0b2b99708f0659e38f407debec5ab7afc71de48fb104508a60
04a23b3cb2d6361df66ca94a470ffa1017a8e5cd3255ce342219765d7d4619bc
104a657a127f86f7b3c0266374d3c8190089600649bfec9d022a1db5a593ff05
10611281e1ccbdbb578b5d5e2b5d3bb101b137313f30488859d33efc0b0a2d49
16efd909ed255628ad4da000cb7a2d1efda45ba3c549cb6c89017f92ffe3661f
190759abb680efcc7e3ae3321089b43dbf3fa96a5d23a1cfb67b0eac4479bd7e
1bbeca916a642737c0a0366afdf5054b4c34763f3ef182ce02fbd47330df08a5
1d0d00c76353c8a1d2e33af602238244f0e0417193d7f65cfca4f4b576107071
2037ffebd0249c148a7aace14bddb1e722676449a1fb2e242c54de9507aa9891
383f0d2cbf8914c3ecb23ea82bff38e1c048980806e37d75e3539362d105675c
3c14b486b84574dddb44e6090bea99f1635271aa9d2b34e121b9a6a7c63e20eb
495a0660bbeebdf5c97066962a188b2df761f73ccd0056491a1a66a02f7d8b22
4f0532e15ced95a1cebc13dd268dcbe7c609d4da237d9e46916678f288d3d9c6
584da5ab12cecc1346990260edbddff27c6a8beb64fddb43e4a5e4c3c7aeafed
5db8bb1cff115c3d984a560508dea374163d1579d61c64c5f8339bed21247858
5dcdf2e8f1b9348bfd3330a31a70a4b5fc03dd86e45553dca9d85f74f9d8ec6c
637aef27fca11245278a48f70535902570ef526ba19bcb8a675f07cdc7788993
64a373487c4cc2b8b60687ecc01150b546b18be7069981c5fe5d48075190f1ff
693f08996d40c0c2bdb25ae5457d44f9df694a8972a70fe989312753c7fe9ab4
7c7700a4b8e19a168f7befb37155cdb133fec1fd5944e4ad57d483be40f9f5d5
7d40062e8399a547f5578d462d3d864abf44a52a251f3d6dc0e3d0f2919b9b06
7d5f4c2030022ca5db32716635f8b2f850fe74531d0dc1dc859e86dc9afdd411
7e732e41d93b613cac1ba979d7f7c98c8603f65a50bbf6b6198f1ee396dc7174
837485ae1a0d843692bac9f91ad3f3c77f576414c2f1abc477b053dbc3302939
873276d9f8cbf3206408319f5579048663b30cb8f36b1a1a0a08e74a2685c688
8cea8428c05a2845315cbdd64daa9bfcfc6ee49f935923786452db8b7e395662
98fe63c98c8865781a7ef52b8b105dd3eeb444dfe3242468af0211eadd4076a5
a0d777ff492a90ec6d9eff93e38e7b35cf0ff70111b7723dc48a88ccd468d1fa
a4ef1ce4dd797047944605ab1d94b6e7e091949635b04ffb4cb929e1c13a93b5
a52762177877479859e4f88a13f605ad1e69d759019cf49dcf026781375b74a7
bb4f09d5fb61d65e48bfc235657a895280ebe9c0bb20ddff112edb6ab5a6114a
c8acb5eab3b6019fda9609b2badd902d7be9ebdd042e2c244018589ff1398355
cc170c55c076d3c280752bfb55b25b28cc4fa56c730a2df64e636f92b737ce01
d8a6e6bace789a863e537f814cca587ae697e9a5533ae43288d76f3fcad4491f
dbbd5d7944b1791027762a40a70b3c74772a9d31b5c67b6519394a1705edabcc
df391f2ffc4e001b1572bb0386504a2e6bc56b0446575be4035cb617f8f0c579
e03bd4b39cf7bc80a5177abe797dd896df1c97c59ede45728a245f7b912def33
e6a2b6355fd513a8ce24deef488ee3cc39f5d736915965875c54f81c19e52971
e96de8414e0e438184d2352be17d1f31f2f309fe5f4c7c167dd4375fa28f96b0
e9af4018616e4275c6b6af5531bb988431c1454d8567cc4f6c7d2b4dc63440aa
e9d191e5a9565068627795d74eb6605f3878b6c5655955f72f69dffa5076e495
ea96636e1c8741efac1eefb673726087261fa23c680a8556abf36ec13409253f
ef3b6b3060ef897724cea9ac2080b1201d08c9e6a0dad0ecf492c08441a4f604
f3b82f2c80c2ea5496407200bab1cc04f3679b80c74608aa03bfae37e62f992e
f48db6b5d9d34ead2dc736cd7f8af15b7b6fb3e39fe0baf5eac52e1e3967795c
f6a180cc3b31693739089a9966dd1feb107bb49216f1e3ed11baab8e4f6b5226
f737829e9ad9a025945ad9ce803641677ae0fe3abf43b1984a7c8ab994923178
fc2751ff381d75154c76da7a42211509f7cc3fd4b50956e36e53b4f7653534d5</textarea></div>
			<div class="crayon-main" style=" max-width: 500px;">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-2">2</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-4">4</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-6">6</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-8">8</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-10">10</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-12">12</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-14">14</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-16">16</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-18">18</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-20">20</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-22">22</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-24">24</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-26">26</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-28">28</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-30">30</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-32">32</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-34">34</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-36">36</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-38">38</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-40">40</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-42">42</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-44">44</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-46">46</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-48">48</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-50">50</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-52">52</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-54">54</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-56">56</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-58">58</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-60">60</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-62">62</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-64">64</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-66">66</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-68">68</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-70">70</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-72">72</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-74">74</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-76">76</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-78">78</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-80">80</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-82">82</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f36777379098-84">84</div><div class="crayon-num" data-line="crayon-5f694c5e37f36777379098-85">85</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c5e37f36777379098-1"><span class="crayon-e">Given </span><span class="crayon-e">the </span><span class="crayon-e">included </span><span class="crayon-e">archive </span><span class="crayon-e">of </span><span class="crayon-e">malware </span><span class="crayon-v">samples</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-2">&nbsp;</div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-3"><span class="crayon-e">Find </span><span class="crayon-e">the </span><span class="crayon-v">longest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">contiguous</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">most </span><span class="crayon-e">efficient </span><span class="crayon-e">rule </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-st">catch</span><span class="crayon-h"> </span><span class="crayon-e">all </span><span class="crayon-e">of </span><span class="crayon-v">them</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-4"><span class="crayon-e">The </span><span class="crayon-e">rule </span><span class="crayon-e">must </span><span class="crayon-st">use</span><span class="crayon-h"> </span><span class="crayon-e">the </span><span class="crayon-e">hexadecimal </span><span class="crayon-v">format</span><span class="crayon-sy">.</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-5"><span class="crayon-e">The </span><span class="crayon-e">rule </span><span class="crayon-e">CANNOT </span><span class="crayon-e">fire </span><span class="crayon-e">on </span><span class="crayon-e">any </span><span class="crayon-e">other </span><span class="crayon-v">samples</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">ONLY </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-cn">48</span><span class="crayon-h"> </span><span class="crayon-v">provided</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-6"><span class="crayon-e">The </span><span class="crayon-e">wildcard</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"?"</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-s">"??"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">allowed </span><span class="crayon-e">but </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-i">jumps</span><span class="crayon-h"> </span><span class="crayon-s">"[1-6]"</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">See </span><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//yara.readthedocs.io/en/latest/writingrules.</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-7"><span class="crayon-v">html</span><span class="crayon-p">#hexadecimal-strings </span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-8"><span class="crayon-e">The </span><span class="crayon-e">samples </span><span class="crayon-e">are </span><span class="crayon-e">included </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">yara_samples</span><span class="crayon-sy">.</span><span class="crayon-cn">7z</span><span class="crayon-h"> </span><span class="crayon-e">password </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-s">"infected"</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-10"><span class="crayon-e">The </span><span class="crayon-e">rule </span><span class="crayon-e">must </span><span class="crayon-e">follow </span><span class="crayon-r">this</span><span class="crayon-h"> </span><span class="crayon-e">example </span><span class="crayon-v">format</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-12"><span class="crayon-e">rule</span><span class="crayon-h"> </span><span class="crayon-e">yara_challenge</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-13"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-14"><span class="crayon-h">	</span><span class="crayon-v">strings</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-15"><span class="crayon-h">		</span><span class="crayon-sy">$</span><span class="crayon-v">yara_challenge</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-e">de </span><span class="crayon-i">ad</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-i">ef</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-16"><span class="crayon-h">	</span><span class="crayon-v">condition</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-17"><span class="crayon-h">		 </span><span class="crayon-e">all </span><span class="crayon-e">of </span><span class="crayon-i">them</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-18"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-20"><span class="crayon-e">You </span><span class="crayon-e">will </span><span class="crayon-e">change </span><span class="crayon-e">the </span><span class="crayon-e">contents </span><span class="crayon-i">of</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-e">yara_challenge </span><span class="crayon-i">from</span><span class="crayon-h"> </span><span class="crayon-s">"de ad b? ef ?? ??"</span><span class="crayon-h"> </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-e">hex </span><span class="crayon-e">formatted </span><span class="crayon-e">rule </span><span class="crayon-e">that </span><span class="crayon-e">will </span><span class="crayon-st">catch</span><span class="crayon-h"> </span><span class="crayon-i">all</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-21"><span class="crayon-cn">48</span><span class="crayon-h"> </span><span class="crayon-v">samples</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-22">&nbsp;</div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-23"><span class="crayon-st">Use</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-h"> </span><span class="crayon-e">template </span><span class="crayon-e">when </span><span class="crayon-e">submitting </span><span class="crayon-e">your </span><span class="crayon-v">rule</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-24">&nbsp;</div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-25"><span class="crayon-e">rule</span><span class="crayon-h"> </span><span class="crayon-e">yara_challenge</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-26"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-27"><span class="crayon-h">	</span><span class="crayon-v">strings</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-28"><span class="crayon-h">		</span><span class="crayon-sy">$</span><span class="crayon-v">yara_challenge</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-29"><span class="crayon-h">	</span><span class="crayon-v">condition</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-30"><span class="crayon-h">		 </span><span class="crayon-e">all </span><span class="crayon-e">of </span><span class="crayon-i">them</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-31"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-32">&nbsp;</div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-34"><span class="crayon-v">Hint</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-35"><span class="crayon-e">There </span><span class="crayon-i">are</span><span class="crayon-h"> </span><span class="crayon-cn">52</span><span class="crayon-h"> </span><span class="crayon-i">wildcard</span><span class="crayon-h"> </span><span class="crayon-s">"?"</span>'<span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-e">within </span><span class="crayon-e">the </span><span class="crayon-e">answer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-36">&nbsp;</div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-37"><span class="crayon-e">Malware </span><span class="crayon-e">samples </span><span class="crayon-e">have </span><span class="crayon-e">the </span><span class="crayon-e">following </span><span class="crayon-e">sha256 </span><span class="crayon-v">hashes</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-38"><span class="crayon-cn">0050e14f8e6bca0b2b99708f0659e38f407debec5ab7afc71de48fb104508a60</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-39"><span class="crayon-cn">04a23b3cb2d6361df66ca94a470ffa1017a8e5cd3255ce342219765d7d4619bc</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-40"><span class="crayon-cn">104a657a127f86f7b3c0266374d3c8190089600649bfec9d022a1db5a593ff05</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-41"><span class="crayon-cn">10611281e1ccbdbb578b5d5e2b5d3bb101b137313f30488859d33efc0b0a2d49</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-42"><span class="crayon-cn">16efd909ed255628ad4da000cb7a2d1efda45ba3c549cb6c89017f92ffe3661f</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-43"><span class="crayon-cn">190759abb680efcc7e3ae3321089b43dbf3fa96a5d23a1cfb67b0eac4479bd7e</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-44"><span class="crayon-cn">1bbeca916a642737c0a0366afdf5054b4c34763f3ef182ce02fbd47330df08a5</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-45"><span class="crayon-cn">1d0d00c76353c8a1d2e33af602238244f0e0417193d7f65cfca4f4b576107071</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-46"><span class="crayon-cn">2037ffebd0249c148a7aace14bddb1e722676449a1fb2e242c54de9507aa9891</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-47"><span class="crayon-cn">383f0d2cbf8914c3ecb23ea82bff38e1c048980806e37d75e3539362d105675c</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-48"><span class="crayon-cn">3c14b486b84574dddb44e6090bea99f1635271aa9d2b34e121b9a6a7c63e20eb</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-49"><span class="crayon-cn">495a0660bbeebdf5c97066962a188b2df761f73ccd0056491a1a66a02f7d8b22</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-50"><span class="crayon-cn">4f0532e15ced95a1cebc13dd268dcbe7c609d4da237d9e46916678f288d3d9c6</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-51"><span class="crayon-cn">584da5ab12cecc1346990260edbddff27c6a8beb64fddb43e4a5e4c3c7aeafed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-52"><span class="crayon-cn">5db8bb1cff115c3d984a560508dea374163d1579d61c64c5f8339bed21247858</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-53"><span class="crayon-cn">5dcdf2e8f1b9348bfd3330a31a70a4b5fc03dd86e45553dca9d85f74f9d8ec6c</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-54"><span class="crayon-cn">637aef27fca11245278a48f70535902570ef526ba19bcb8a675f07cdc7788993</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-55"><span class="crayon-cn">64a373487c4cc2b8b60687ecc01150b546b18be7069981c5fe5d48075190f1ff</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-56"><span class="crayon-cn">693f08996d40c0c2bdb25ae5457d44f9df694a8972a70fe989312753c7fe9ab4</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-57"><span class="crayon-cn">7c7700a4b8e19a168f7befb37155cdb133fec1fd5944e4ad57d483be40f9f5d5</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-58"><span class="crayon-cn">7d40062e8399a547f5578d462d3d864abf44a52a251f3d6dc0e3d0f2919b9b06</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-59"><span class="crayon-cn">7d5f4c2030022ca5db32716635f8b2f850fe74531d0dc1dc859e86dc9afdd411</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-60"><span class="crayon-cn">7e732e41d93b613cac1ba979d7f7c98c8603f65a50bbf6b6198f1ee396dc7174</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-61"><span class="crayon-cn">837485ae1a0d843692bac9f91ad3f3c77f576414c2f1abc477b053dbc3302939</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-62"><span class="crayon-cn">873276d9f8cbf3206408319f5579048663b30cb8f36b1a1a0a08e74a2685c688</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-63"><span class="crayon-cn">8cea8428c05a2845315cbdd64daa9bfcfc6ee49f935923786452db8b7e395662</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-64"><span class="crayon-cn">98fe63c98c8865781a7ef52b8b105dd3eeb444dfe3242468af0211eadd4076a5</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-65"><span class="crayon-e">a0d777ff492a90ec6d9eff93e38e7b35cf0ff70111b7723dc48a88ccd468d1fa</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-66"><span class="crayon-e">a4ef1ce4dd797047944605ab1d94b6e7e091949635b04ffb4cb929e1c13a93b5</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-67"><span class="crayon-e">a52762177877479859e4f88a13f605ad1e69d759019cf49dcf026781375b74a7</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-68"><span class="crayon-e">bb4f09d5fb61d65e48bfc235657a895280ebe9c0bb20ddff112edb6ab5a6114a</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-69"><span class="crayon-e">c8acb5eab3b6019fda9609b2badd902d7be9ebdd042e2c244018589ff1398355</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-70"><span class="crayon-e">cc170c55c076d3c280752bfb55b25b28cc4fa56c730a2df64e636f92b737ce01</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-71"><span class="crayon-e">d8a6e6bace789a863e537f814cca587ae697e9a5533ae43288d76f3fcad4491f</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-72"><span class="crayon-e">dbbd5d7944b1791027762a40a70b3c74772a9d31b5c67b6519394a1705edabcc</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-73"><span class="crayon-e">df391f2ffc4e001b1572bb0386504a2e6bc56b0446575be4035cb617f8f0c579</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-74"><span class="crayon-e">e03bd4b39cf7bc80a5177abe797dd896df1c97c59ede45728a245f7b912def33</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-75"><span class="crayon-e">e6a2b6355fd513a8ce24deef488ee3cc39f5d736915965875c54f81c19e52971</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-76"><span class="crayon-e">e96de8414e0e438184d2352be17d1f31f2f309fe5f4c7c167dd4375fa28f96b0</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-77"><span class="crayon-e">e9af4018616e4275c6b6af5531bb988431c1454d8567cc4f6c7d2b4dc63440aa</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-78"><span class="crayon-e">e9d191e5a9565068627795d74eb6605f3878b6c5655955f72f69dffa5076e495</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-79"><span class="crayon-e">ea96636e1c8741efac1eefb673726087261fa23c680a8556abf36ec13409253f</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-80"><span class="crayon-e">ef3b6b3060ef897724cea9ac2080b1201d08c9e6a0dad0ecf492c08441a4f604</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-81"><span class="crayon-e">f3b82f2c80c2ea5496407200bab1cc04f3679b80c74608aa03bfae37e62f992e</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-82"><span class="crayon-e">f48db6b5d9d34ead2dc736cd7f8af15b7b6fb3e39fe0baf5eac52e1e3967795c</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-83"><span class="crayon-e">f6a180cc3b31693739089a9966dd1feb107bb49216f1e3ed11baab8e4f6b5226</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f36777379098-84"><span class="crayon-e">f737829e9ad9a025945ad9ce803641677ae0fe3abf43b1984a7c8ab994923178</span></div><div class="crayon-line" id="crayon-5f694c5e37f36777379098-85"><span class="crayon-v">fc2751ff381d75154c76da7a42211509f7cc3fd4b50956e36e53b4f7653534d5</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0029 seconds] -->
<p>So lets unzip the included archive and take a look at the included files.</p>
<p>Based off of the above conditions, it appears that the rule must be exclusive to this set of 48 files. That rules out common repeating elements of a PE file, like header, padding etc. So I’m going to look at data and functionality within the binaries.</p>
<p>My approach to this problem would be to diff the two smallest files in the archive and see what code lines up. (If you have a paid version of IDA-Pro, you can use a free plugin, <a href="https://www.zynamics.com/software.html">BinDiff</a>.) We’ll diff the two smallest files:</p>
<ul>
<li>fc2751ff381d75154c76da7a42211509f7cc3fd4b50956e36e53b4f7653534d5</li>
<li>e96de8414e0e438184d2352be17d1f31f2f309fe5f4c7c167dd4375fa28f96b0</li>
</ul>
<p>Let’s sort the diffed files by basic block count, this will give us the longest functions in the binaries.</p>
<p>It looks like they’re 100% the same according to bindiff. Looks promising.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_34.png"><img class="size-large wp-image-18418 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_34-500x117.png" alt="CTF_Threat_34" width="500" height="117" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_34-500x117.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_34-230x54.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_34-768x179.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_34-510x119.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_34-172x40.png 172w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_34.png 965w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Opening up both files at sub_10001000 in Hex View in IDA we can see that they’re practically identical.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_35.png"><img class="size-large wp-image-18415 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_35-500x540.png" alt="CTF_Threat_35" width="500" height="540" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_35-500x540.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_35-230x248.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_35-768x829.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_35-278x300.png 278w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_35-37x40.png 37w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_35.png 962w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Since we’re going to convert this hex to a yara rule lets open up these files in bash and convert them to text. Then do a silly grep for the beginning of the hex that matches and almost everything after that.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_36.png"><img class="size-large wp-image-18412 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_36-500x100.png" alt="CTF_Threat_36" width="500" height="100" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_36-500x100.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_36-230x46.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_36-768x154.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_36-510x102.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_36-199x40.png 199w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_36.png 976w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>This gives us a nice text file with all of the similar hex bytes:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_37.png"><img class="size-large wp-image-18409 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_37-500x254.png" alt="CTF_Threat_37" width="500" height="254" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_37-500x254.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_37-230x117.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_37-768x390.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_37-510x259.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_37-79x40.png 79w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_37.png 983w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>There are 48 unique lines, so it looks like we’re on the right track. Next step is to write a python script to figure out the placement of those 52 wildcards.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_38.png"><img class="size-large wp-image-18406 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_38-500x300.png" alt="CTF_Threat_38" width="500" height="300" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_38-500x300.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_38-230x138.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_38-768x461.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_38-67x40.png 67w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_38.png 977w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>This script checks line by line, then character by character to see if the hex text matches, if not it’s replaced with a “?”. It then cuts off the rule after the 52<sup>nd</sup> occurrence of the “?” and prints out the rule:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_39.png"><img class="size-large wp-image-18403 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_39-500x101.png" alt="CTF_Threat_39" width="500" height="101" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_39-500x101.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_39-230x46.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_39-768x155.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_39-510x103.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_39-199x40.png 199w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_39.png 999w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>We end up with a yara rule that catches all 48 samples:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c5e37f3a254745352" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
rule yara_challenge
{
	strings:
		$yara_challenge = { 
5153568B742414B9030000008BC633DB99F7F93BD375048BC6EB1683FA0175058D4602EB0C8
3FA028D460174048B4424088D0C8500000000B856555555F7E98B4C241C8BC2C1E81F03D049
3BCA7D065E33C05B59C3558D5601575289742414895C2428E8?E??00008BCE8B74241C8BE88B
C18BFD83C404C1E902F3A58BC883E103F3A48B4C241C8B74242083F903C60429000F8C870000
00B8ABAAAAAAF7E1D1EA8D04522BC8894C24108B7C242483C3048A0C2F83C703C1F90283E1
3F897C24248A81?0???0?088441EFC8A4C2FFD8A442FFE83E103C1F804C1E10483E00F0BC88A8
9?0???0?0884C1EFD8A442FFF8A4C2FFEC1F80683E10F83E003C1E1020BC18A80?0???0?08844
1EFE8A4C2FFF83E13F4A8A81?0???0?088441EFF758B8B44241083F802754E8B4424248A0C288
D7C2801C1F90283E13F8A91?0???0?08814338A04288A0F83E003C1F904C1E00483E10F0BC18
A90?0???0?0885433018A0783E00F8A0C85?0???0?0884C3302C64433033DEB3883F80175368B
4424248A1428C1FA0283E23F8A8A?0???0?0880C338A142883E203C1E2048A82?0???0?088443
301B03D884433028844330383C30455C6043300E8?5??000083C4048BC35F5D5E5B59C390909
09090909090909053568B74240C578BFE83C9FF33C0F2AEF7D1498BF98BC7250300008079054
883C8FC4074065F5E33C05BC368?4 }
	condition:
		 all of them 
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c5e37f3a254745352-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f3a254745352-2">2</div><div class="crayon-num" data-line="crayon-5f694c5e37f3a254745352-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f3a254745352-4">4</div><div class="crayon-num" data-line="crayon-5f694c5e37f3a254745352-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f3a254745352-6">6</div><div class="crayon-num" data-line="crayon-5f694c5e37f3a254745352-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f3a254745352-8">8</div><div class="crayon-num" data-line="crayon-5f694c5e37f3a254745352-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f3a254745352-10">10</div><div class="crayon-num" data-line="crayon-5f694c5e37f3a254745352-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f3a254745352-12">12</div><div class="crayon-num" data-line="crayon-5f694c5e37f3a254745352-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f3a254745352-14">14</div><div class="crayon-num" data-line="crayon-5f694c5e37f3a254745352-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f3a254745352-16">16</div><div class="crayon-num" data-line="crayon-5f694c5e37f3a254745352-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f3a254745352-18">18</div><div class="crayon-num" data-line="crayon-5f694c5e37f3a254745352-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f3a254745352-20">20</div><div class="crayon-num" data-line="crayon-5f694c5e37f3a254745352-21">21</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c5e37f3a254745352-1"><span class="crayon-e">rule</span><span class="crayon-h"> </span><span class="crayon-e">yara_challenge</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f3a254745352-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694c5e37f3a254745352-3"><span class="crayon-h">	</span><span class="crayon-v">strings</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f3a254745352-4"><span class="crayon-h">		</span><span class="crayon-sy">$</span><span class="crayon-v">yara_challenge</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5f694c5e37f3a254745352-5"><span class="crayon-cn">5153568B742414B9030000008BC633DB99F7F93BD375048BC6EB1683FA0175058D4602EB0C8</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f3a254745352-6"><span class="crayon-cn">3FA028D460174048B4424088D0C8500000000B856555555F7E98B4C241C8BC2C1E81F03D049</span></div><div class="crayon-line" id="crayon-5f694c5e37f3a254745352-7"><span class="crayon-cn">3BCA7D065E33C05B59C3558D5601575289742414895C2428E8</span><span class="crayon-sy">?</span><span class="crayon-v">E</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-cn">00008BCE8B74241C8BE88B</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f3a254745352-8"><span class="crayon-i">C18BFD83C404C1E902F3A58BC883E103F3A48B4C241C8B74242083F903C60429000F8C870000</span></div><div class="crayon-line" id="crayon-5f694c5e37f3a254745352-9"><span class="crayon-cn">00B8ABAAAAAAF7E1D1EA8D04522BC8894C24108B7C242483C3048A0C2F83C703C1F90283E1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f3a254745352-10"><span class="crayon-cn">3F897C24248A81</span><span class="crayon-sy">?</span><span class="crayon-cn">0</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-cn">0</span><span class="crayon-sy">?</span><span class="crayon-cn">088441EFC8A4C2FFD8A442FFE83E103C1F804C1E10483E00F0BC88A8</span></div><div class="crayon-line" id="crayon-5f694c5e37f3a254745352-11"><span class="crayon-cn">9</span><span class="crayon-sy">?</span><span class="crayon-cn">0</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-cn">0</span><span class="crayon-sy">?</span><span class="crayon-cn">0884C1EFD8A442FFF8A4C2FFEC1F80683E10F83E003C1E1020BC18A80</span><span class="crayon-sy">?</span><span class="crayon-cn">0</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-cn">0</span><span class="crayon-sy">?</span><span class="crayon-cn">08844</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f3a254745352-12"><span class="crayon-cn">1EFE8A4C2FFF83E13F4A8A81</span><span class="crayon-sy">?</span><span class="crayon-cn">0</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-cn">0</span><span class="crayon-sy">?</span><span class="crayon-cn">088441EFF758B8B44241083F802754E8B4424248A0C288</span></div><div class="crayon-line" id="crayon-5f694c5e37f3a254745352-13"><span class="crayon-v">D7C2801C1F90283E13F8A91</span><span class="crayon-sy">?</span><span class="crayon-cn">0</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-cn">0</span><span class="crayon-sy">?</span><span class="crayon-cn">08814338A04288A0F83E003C1F904C1E00483E10F0BC18</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f3a254745352-14"><span class="crayon-v">A90</span><span class="crayon-sy">?</span><span class="crayon-cn">0</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-cn">0</span><span class="crayon-sy">?</span><span class="crayon-cn">0885433018A0783E00F8A0C85</span><span class="crayon-sy">?</span><span class="crayon-cn">0</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-cn">0</span><span class="crayon-sy">?</span><span class="crayon-cn">0884C3302C64433033DEB3883F80175368B</span></div><div class="crayon-line" id="crayon-5f694c5e37f3a254745352-15"><span class="crayon-cn">4424248A1428C1FA0283E23F8A8A</span><span class="crayon-sy">?</span><span class="crayon-cn">0</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-cn">0</span><span class="crayon-sy">?</span><span class="crayon-cn">0880C338A142883E203C1E2048A82</span><span class="crayon-sy">?</span><span class="crayon-cn">0</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-cn">0</span><span class="crayon-sy">?</span><span class="crayon-cn">088443</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f3a254745352-16"><span class="crayon-cn">301B03D884433028844330383C30455C6043300E8</span><span class="crayon-sy">?</span><span class="crayon-cn">5</span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-cn">000083C4048BC35F5D5E5B59C390909</span></div><div class="crayon-line" id="crayon-5f694c5e37f3a254745352-17"><span class="crayon-cn">09090909090909053568B74240C578BFE83C9FF33C0F2AEF7D1498BF98BC7250300008079054</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f3a254745352-18"><span class="crayon-cn">883C8FC4074065F5E33C05BC368</span><span class="crayon-sy">?</span><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694c5e37f3a254745352-19"><span class="crayon-h">	</span><span class="crayon-v">condition</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f3a254745352-20"><span class="crayon-h">		 </span><span class="crayon-e">all </span><span class="crayon-e">of </span><span class="crayon-i">them</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5f694c5e37f3a254745352-21"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>Submitting the rule above will result in the key: PAN{8oogI3_WonD3rL4nd}</p>
<p>BONUS:</p>
<p>If you combine the keys from all three yara challenges, they write out a Haiku about the Labyrinth Movie.</p>
<h3>Threat 7 Challenge: There has been a breach of the Borg&#8217;s drone network!</h3>
<p><em>Challenge Created By: Jeff White </em><a href="https://twitter.com/noottrak" target="_blank"><em>@noottrak</em></a></p>
<p>For this challenge, we’re given a Windows PE “drone.exe” and when we run it we’re greeted with a Borg Cube and some text about an apparent encryption.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_40.png"><img class="size-large wp-image-18400 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_40-500x177.png" alt="CTF_Threat_40" width="500" height="177" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_40-500x177.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_40-230x82.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_40-768x273.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_40-510x181.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_40-113x40.png 113w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_40.png 899w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Based on the text, it appears the URL (<a href="https://www.youtube.com/watch?v=AyenRCJ_4Ww">https://www.youtube.com/watch?v=AyenRCJ_4Ww</a> &#8211; the Borg montra!) and key “borgdata” are encrypted to form the hash “374316062B033D0A3E6A746B46560377367A3328393720611641435A400C0C0B7E6E69<br />
E392C2C394E5B5B1717061B0A”. Then an error occurs and another hash is displayed and the program exits.</p>
<p>Looking at the strings for the program, a number of them immediately stand out and, after a quick trip to Google, imply that this PE was built with PyInstaller.</p>
<p>__main__</p>
<p>__file__</p>
<p>%s returned %d</p>
<p>pyi-windows-manifest-filename</p>
<p>Cannot allocate memory for ARCHIVE_STATUS</p>
<p>_MEIPASS2</p>
<p>Cannot open self %s or archive %s</p>
<p>PATH</p>
<p>Failed to get executable path.</p>
<p>GetModuleFileNameW: %s</p>
<p>Failed to convert executable path to UTF-8.</p>
<p>Py_DontWriteBytecodeFlag</p>
<p>Cannot GetProcAddress for Py_DontWriteBytecodeFlag</p>
<p>Py_FileSystemDefaultEncoding</p>
<p>Cannot GetProcAddress for Py_FileSystemDefaultEncoding</p>
<p>Py_FrozenFlag</p>
<p>Cannot GetProcAddress for Py_FrozenFlag</p>
<p>Py_IgnoreEnvironmentFlag</p>
<p>PyInstaller is “a program that packages Python programs into stand-alone executables.”Now we know what we’re dealing with. I decided that the quickest way to tackle this challenge would be to extract the Python script instead of trying to reverse-engineer a 9MB PE that wraps a Python script.</p>
<p>After some more Google-Fu, we find PyInstaller Extractor on <a href="https://sourceforge.net/projects/pyinstallerextractor/">Sourceforge</a> and try to run it against our binary but immediately receive a traceback.</p>
<p>Traceback (most recent call last):<br />
File &#8220;pyinstxtractor11.py&#8221;, line 115, in &lt;module&gt;<br />
fd=open(name,&#8217;wb&#8217;)<br />
IOError: [Errno 2] No such file or directory: &#8221;</p>
<p>Analyzing the traceback and the section of code where it happened, it looks like it had issues opening a file.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c5e37f3d327593890" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
    #Remove trailing null bytes from name
    name=name.rstrip('\00')

    bpath=os.path.dirname(name)
    if bpath!='':
        #Check if path exists, create if not
        if os.path.exists(bpath)==False:
            os.makedirs(bpath)
    fd=open(name,'wb')
    fd.write(buf)
    fd.close()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c5e37f3d327593890-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f3d327593890-2">2</div><div class="crayon-num" data-line="crayon-5f694c5e37f3d327593890-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f3d327593890-4">4</div><div class="crayon-num" data-line="crayon-5f694c5e37f3d327593890-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f3d327593890-6">6</div><div class="crayon-num" data-line="crayon-5f694c5e37f3d327593890-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f3d327593890-8">8</div><div class="crayon-num" data-line="crayon-5f694c5e37f3d327593890-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f3d327593890-10">10</div><div class="crayon-num" data-line="crayon-5f694c5e37f3d327593890-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c5e37f3d327593890-1"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#Remove trailing null bytes from name</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f3d327593890-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-v">name</span><span class="crayon-sy">.</span><span class="crayon-e">rstrip</span><span class="crayon-sy">(</span><span class="crayon-s">'\00'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f3d327593890-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f3d327593890-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">bpath</span><span class="crayon-o">=</span><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-v">path</span><span class="crayon-sy">.</span><span class="crayon-e">dirname</span><span class="crayon-sy">(</span><span class="crayon-v">name</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f3d327593890-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">bpath</span><span class="crayon-o">!=</span><span class="crayon-s">''</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f3d327593890-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#Check if path exists, create if not</span></div><div class="crayon-line" id="crayon-5f694c5e37f3d327593890-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-v">path</span><span class="crayon-sy">.</span><span class="crayon-e">exists</span><span class="crayon-sy">(</span><span class="crayon-v">bpath</span><span class="crayon-sy">)</span><span class="crayon-o">==</span><span class="crayon-t">False</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f3d327593890-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-e">makedirs</span><span class="crayon-sy">(</span><span class="crayon-v">bpath</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f3d327593890-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fd</span><span class="crayon-o">=</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-s">'wb'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f3d327593890-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fd</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-v">buf</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f3d327593890-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fd</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>There were also some interesting files dropped before the program had the issue, which may be useful later.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_41.png"><img class="size-large wp-image-18397 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_41-500x62.png" alt="CTF_Threat_41" width="500" height="62" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_41-500x62.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_41-230x28.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_41-768x95.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_41-510x63.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_41-240x30.png 240w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_41.png 899w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Testing our assumption, we modify the script to print the ‘name’ field and can validate it’s printing out the file names we saw written to disk.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_42.png"><img class="size-large wp-image-18394 aligncenter" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_42-500x244.png" alt="CTF_Threat_42" width="500" height="244" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_42-500x244.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_42-230x112.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_42-510x249.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_42-82x40.png 82w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_42.png 675w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Given this, we simply wrap that action in a try/except where we specify the filename as “broke” if it is empty.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c5e37f3f527315151" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
    try:
        fd=open(name,'wb')
    except:
        print "broke file"
        fd=open("broke”,'wb')</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c5e37f3f527315151-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f3f527315151-2">2</div><div class="crayon-num" data-line="crayon-5f694c5e37f3f527315151-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f3f527315151-4">4</div><div class="crayon-num" data-line="crayon-5f694c5e37f3f527315151-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c5e37f3f527315151-1"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f3f527315151-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fd</span><span class="crayon-o">=</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-s">'wb'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f3f527315151-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">except</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f3f527315151-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"broke file"</span></div><div class="crayon-line" id="crayon-5f694c5e37f3f527315151-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fd</span><span class="crayon-o">=</span><span class="crayon-e">open</span><span class="crayon-sy">(</span>"<span class="crayon-i">broke</span>”<span class="crayon-sy">,</span><span class="crayon-s">'wb'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Running it again, we see a slew of files now get written to disk.</p>
<p><img class="aligncenter size-full wp-image-18568" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_43-1.png" alt="CTF_threat_43" width="460" height="358" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_43-1.png 460w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_43-1-230x179.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_43-1-385x300.png 385w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_43-1-51x40.png 51w" sizes="(max-width: 460px) 100vw, 460px" /></p>
<p>Looking at our “broke” file, we see it’s actually the script for the program!</p>
<p><img class="aligncenter wp-image-18559 size-full" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_44.jpg" alt="CTF_threat_44" width="367" height="368" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_44.jpg 367w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_44-100x100.jpg 100w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_44-230x231.jpg 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_44-299x300.jpg 299w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_44-40x40.jpg 40w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_44-32x32.jpg 32w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_44-64x64.jpg 64w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_44-96x96.jpg 96w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_44-128x128.jpg 128w" sizes="(max-width: 367px) 100vw, 367px" /></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c5e37f41765820578" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
#!/usr/bin/env python
import requests, time, sys, json, ast, logging, base64
logging.getLogger("scapy.runtime").setLevel(logging.CRITICAL)
from scapy.all import *

def AABBBC(AABBCF, AABBCE, AABBBF):
    AABBCC = len(AABBCF)/float(len(AABBCE))
    if str(AABBCC).split(".")[1] == "0":
        AABBCD = int(str((AABBCC)).split(".")[0]) * 8
    else:
        while str(AABBCC).split(".")[1] != "0":
            AABBCF += "@"
            AABBCC = len(AABBCF)/float(len(AABBCE))
        AABBCD = int(str((AABBCC)).split(".")[0]) * 8
    AABBB0 = []
    AABBCF = list(AABBCF)
    AABBCE = list(AABBCE)
    while AABBCF != []:
        p_AABBCF = AABBCF[0:8]
        p_AABBCE = AABBCE[0:8]
        AABBB1 = []
        for i in xrange(0,8):
            if type(p_AABBCE[i]) == int: # [+] *** ALERT ALERT *** [+]
                AABBB2 = (ord(chr(p_AABBCE[i])) ^ ord(p_AABBCF[0])) # [+] HUMANS HAVE BROKEN THROUGH [+]
            else: # [+] MODULATE SHIELDS [+]
                AABBB2 = (ord(p_AABBCE[i]) ^ ord(p_AABBCF[0])) # [+] *** ALERT ALERT *** [+]
            AABBB0.append(AABBB2)
            AABBB1.append(AABBB2)
            AABBCF.pop(0)
            p_AABBCF.pop(0)
            AABBCE = AABBB1
        AABBCE.reverse()
    AABBB0.reverse()
    AABBB4 = []
    for i in AABBB0:
        AABBB3 = hex(i)
        if len(AABBB3) != 4:
            AABBB4.append("0" + hex(i)[2:])
        else:
            AABBB4.append(hex(i)[2:])
    AABBB4 = "".join(AABBB4).upper()
    return AABBB4

def AABBB7(AABBBE):
    return AABBBE[::-1]

def AABBCB(AABBBE):
    print "\t[-] *** ERROR CONNECTING ***"
    print "\n[+] SHUTTING DOWN DRONE [+]\n"
    time.sleep(2)
    sys.exit()

def main():
    AABBBD = """
            ___________
           /-/_"/-/_/-/|
          /"-/-_"/-_//||
         /__________/|/|
         |"|_'='-]:+|/||
         |-+-|.|_'-"||//
         |[".[:!+-'=|//
         |='!+|-:]|-|/
          ----------
"""
    print AABBBD
    print "[+] BORG DRONE BOOTUP STARTING [+]"
    time.sleep(2)
    try:
        AABBBA = json.load(open("borgstruct.cfg"))
        print "\t[-] CONFIGURATION", str(AABBBA['key'][1]) + ".0 LOADED"
    except:
        AABBBA = {"warp": ["d0rw$54p", "lss", "p//:ptth", "nimda//:ptf"],
                  "coil": ["r/moc.nibets", "exe.1\:c", "tropmmoc"],
                  "dilithium": ["praw", "-redrocirt", "FfPE6AFw/w"],
                  "scalar": [874, 34, 666],
                  "array": [69, 80, 443, 25, 22, 2600, 666, 8443, 27500],
                  "LoadLibraryA": ["IsDebuggerPresent", "IsDebuggerDetected", "NtQueryInformationProcess", "GetTickCount"],
                  "LoadLibraryB": ["CheckRemoteDebuggerPresent", "UnhandledExceptionFilter", "CloseHandle", "QueryPerformanceCounter"],
                  "LoadLibraryC": ["NtGetContextThread", "NtSetContextThread", "NtClose"],
                  "adb": ["0xCD", "0x03"],
                  "targets": ["squirtle", "humans", "ferengi", "rick astley"],
                  "key": ["borgdata", 1, 2, 3, 4, 5, 6, 7, 8, "startrek", "cloaking"],
                  "commands": ["ping", "shutdown", "nslookup"],
                  "lore": ["grab", "the", "flag"]}
        json.dump(AABBBA, open("borgstruct.cfg", "w"))
        print "\t[-] CONFIGURATION VERSION", str(AABBBA['key'][1]) + ".0 WRITTEN"
    if AABBBA['key'][1] == 1:
        print "\n[+] FETCHING STARTUP VALUE FROM MATRIX"
        time.sleep(2)
        try:
            AABBB5 = AABBB7((AABBBA['dilithium'][2]) + "a" + (AABBBA['coil'][0]) + "a" + (AABBBA['warp'][2]))
            AABBB6 = requests.get(AABBB5, verify=False)
        except:
            AABBCB(AABBBA['LoadLibraryA'][0])
        AABBCE = AABBB6.content.split("\n")[1]
        print "\t[-] DATA =", AABBCE
    if AABBBA['key'][1] == 2: # [+] *** ALERT ALERT *** [+]
        print "\n[+] SEND FLAG REQUEST WITH ENCRYPTED DATA AND CODE [+]" # [+] HUMANS HAVE BROKE NEXT DEFENSE [+]
        AABBCE = AABBB7((AABBBA['dilithium'][2]) + "o" + (AABBBA['coil'][0]) + "o" + (AABBBA['warp'][2])) # [+] INITIATE LOW ORBIT ION CANNON [+]
        print "\t[-] DATA =", AABBCE # [+] *** ALERT ALERT *** [+]
    AABBCF = AABBBA['key'][0]
    print "\t[-] INITIALIZATION KEY =", AABBCF
    if len(AABBCF) != 8:
        sys.exit()
    print "\n[+] STARTING BORG ENCRYPTION ROUTINE [+]"
    time.sleep(2)
    AABBBB = AABBBC(AABBCE, AABBCF, AABBBA['array'][3])
    print "\t[-] RESULT = " + AABBBB
    print "\n[+] STARTING DRONE COMMUNICATION PROTOCOLS [+]"
    time.sleep(2)
    scalar_array = AABBBA['scalar'][0]
    FEEDDEAD = base64.b64decode('cGFuYm9yZ2Ryb25lLmNvbQ==')
    try:
        AABBB8 = IP(dst=FEEDDEAD)/TCP(dport=AABBBA['array'][5],window=scalar_array,flags="S")/AABBBB
        AABBB9 = sr1(AABBB8, verbose=False)
    except:
        AABBCB(AABBBA['LoadLibraryB'][1])
    if AABBB9[TCP].window == 666:
        print "\t*** ERROR RECEIVED ***"
        print "\t[-] RETURNED = ", AABBB9[Raw]
        print "\n[+] SHUTTING DOWN DRONE [+]\n"
        time.sleep(2)
        sys.exit()
    elif AABBB9[TCP].window == 34:
        print "\t[-] UPDATE SUCCESSFUL"
        AABBBA = ast.literal_eval(str(AABBB9[Raw]).strip("\n"))
        print "\t[-] CONFIGURATION VERSION", str(AABBBA['key'][1]) + ".0 WRITTEN"
        json.dump(AABBBA, open("borgstruct.cfg", "w"))
        print "\t[-] PROCESSING COMMANDS"
        print "\t[-] EXECUTING COMMAND =", AABBBA['commands'][3], AABBBA['adb'][2], "/"
        time.sleep(10)
        print "\t*** ERROR WITH COMMAND ***"
        print "\t[-] NEW SERVER FUNCTION ADDED - FLAG REQUEST"
        print "\t[-] FLAG REQUEST REQUIRED FOR CURRENT ENCRYPTED DATA"
        print "\n[+] SHUTTING DOWN DRONE [+]\n"
        time.sleep(2)
        sys.exit()
    else:
        print "\t[-] RETURNED = ", AABBB9[Raw], "\n"

if __name__ == "__main__":
    main()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-2">2</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-4">4</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-6">6</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-8">8</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-10">10</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-12">12</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-14">14</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-16">16</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-18">18</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-20">20</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-22">22</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-24">24</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-26">26</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-28">28</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-30">30</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-32">32</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-34">34</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-36">36</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-38">38</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-40">40</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-42">42</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-44">44</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-46">46</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-48">48</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-50">50</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-52">52</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-54">54</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-56">56</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-58">58</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-60">60</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-62">62</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-64">64</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-66">66</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-68">68</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-70">70</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-72">72</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-74">74</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-76">76</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-78">78</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-80">80</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-82">82</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-84">84</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-86">86</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-88">88</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-90">90</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-92">92</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-94">94</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-96">96</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-98">98</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-100">100</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-102">102</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-104">104</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-106">106</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-108">108</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-110">110</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-112">112</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-114">114</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-116">116</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-118">118</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-120">120</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-122">122</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-124">124</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-126">126</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-128">128</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-130">130</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-132">132</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-134">134</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-136">136</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-138">138</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-140">140</div><div class="crayon-num" data-line="crayon-5f694c5e37f41765820578-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f41765820578-142">142</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c5e37f41765820578-1"><span class="crayon-p">#!/usr/bin/env python</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-2"><span class="crayon-e">import </span><span class="crayon-v">requests</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sys</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">json</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ast</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">logging</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">base64</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-3"><span class="crayon-v">logging</span><span class="crayon-sy">.</span><span class="crayon-e">getLogger</span><span class="crayon-sy">(</span><span class="crayon-s">"scapy.runtime"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">setLevel</span><span class="crayon-sy">(</span><span class="crayon-v">logging</span><span class="crayon-sy">.</span><span class="crayon-v">CRITICAL</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-4"><span class="crayon-e">from </span><span class="crayon-v">scapy</span><span class="crayon-sy">.</span><span class="crayon-e">all </span><span class="crayon-e ">import *</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-6"><span class="crayon-e">def </span><span class="crayon-e">AABBBC</span><span class="crayon-sy">(</span><span class="crayon-v">AABBCF</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AABBCE</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AABBBF</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBCC</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">AABBCF</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">AABBCE</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">AABBCC</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">"."</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"0"</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBCD</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">AABBCC</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">"."</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">8</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">AABBCC</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">"."</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-s">"0"</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBCF</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">"@"</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBCC</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">AABBCF</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">AABBCE</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBCD</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">AABBCC</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">"."</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">8</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBB0</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBCF</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">AABBCF</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBCE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">AABBCE</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">AABBCF</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">p_AABBCF</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">AABBCF</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">p_AABBCE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">AABBCE</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBB1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">xrange</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-v">p_AABBCE</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-p"># [+] *** ALERT ALERT *** [+]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBB2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-v">p_AABBCE</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">p_AABBCF</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p"># [+] HUMANS HAVE BROKEN THROUGH [+]</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-p"># [+] MODULATE SHIELDS [+]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBB2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">p_AABBCE</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">p_AABBCF</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p"># [+] *** ALERT ALERT *** [+]</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBB0</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">AABBB2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBB1</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">AABBB2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBCF</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">p_AABBCF</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBCE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">AABBB1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-32"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBCE</span><span class="crayon-sy">.</span><span class="crayon-e">reverse</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBB0</span><span class="crayon-sy">.</span><span class="crayon-e">reverse</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBB4</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">AABBB0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBB3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">hex</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">AABBB3</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBB4</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-s">"0"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">hex</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBB4</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">hex</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBB4</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">AABBB4</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">upper</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">AABBB4</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-43">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-44"><span class="crayon-e">def </span><span class="crayon-e">AABBB7</span><span class="crayon-sy">(</span><span class="crayon-v">AABBBE</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">AABBBE</span><span class="crayon-sy">[</span><span class="crayon-o">::</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-46">&nbsp;</div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-47"><span class="crayon-e">def </span><span class="crayon-e">AABBCB</span><span class="crayon-sy">(</span><span class="crayon-v">AABBBE</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\t[-] *** ERROR CONNECTING ***"</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\n[+] SHUTTING DOWN DRONE [+]\n"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-e">sleep</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">sys</span><span class="crayon-sy">.</span><span class="crayon-e">exit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-52">&nbsp;</div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-53"><span class="crayon-e">def </span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBBD</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-s">"</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-55"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;___________</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-56"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /-/_"</span><span class="crayon-o">/</span><span class="crayon-o">-</span><span class="crayon-o">/</span><span class="crayon-v">_</span><span class="crayon-o">/</span><span class="crayon-o">-</span><span class="crayon-o">/</span><span class="crayon-o">|</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">/</span><span class="crayon-s">"-/-_"</span><span class="crayon-o">/</span><span class="crayon-o">-</span><span class="crayon-v">_</span><span class="crayon-c">//||</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">/</span><span class="crayon-v">__________</span><span class="crayon-o">/</span><span class="crayon-o">|</span><span class="crayon-o">/</span><span class="crayon-o">|</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">|</span><span class="crayon-s">"|_'='-]:+|/||</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-60"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |-+-|.|_'-"</span><span class="crayon-o">||</span><span class="crayon-c">//</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-61"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">|</span><span class="crayon-sy">[</span><span class="crayon-s">".[:!+-'=|//</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-62"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |='!+|-:]|-|/</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-63"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-64"><span class="crayon-s">"</span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-65"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print </span><span class="crayon-e">AABBBD</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-66"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"[+] BORG DRONE BOOTUP STARTING [+]"</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-67"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-e">sleep</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-68"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-69"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBBA</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">json</span><span class="crayon-sy">.</span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">"borgstruct.cfg"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-70"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\t[-] CONFIGURATION"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'key'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">".0 LOADED"</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-71"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">except</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-72"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBBA</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">"warp"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"d0rw$54p"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"lss"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"p//:ptth"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"nimda//:ptf"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-73"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"coil"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"r/moc.nibets"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"exe.1\:c"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"tropmmoc"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-74"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"dilithium"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"praw"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"-redrocirt"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"FfPE6AFw/w"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-75"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"scalar"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">874</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">34</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">666</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-76"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"array"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">69</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">443</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">22</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2600</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">666</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8443</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">27500</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-77"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"LoadLibraryA"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"IsDebuggerPresent"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"IsDebuggerDetected"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"NtQueryInformationProcess"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"GetTickCount"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-78"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"LoadLibraryB"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"CheckRemoteDebuggerPresent"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"UnhandledExceptionFilter"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"CloseHandle"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"QueryPerformanceCounter"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-79"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"LoadLibraryC"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"NtGetContextThread"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"NtSetContextThread"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"NtClose"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-80"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"adb"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"0xCD"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"0x03"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-81"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"targets"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"squirtle"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"humans"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"ferengi"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"rick astley"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-82"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"key"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"borgdata"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"startrek"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"cloaking"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-83"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"commands"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"ping"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"shutdown"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"nslookup"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-84"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"lore"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"grab"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"the"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"flag"</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-85"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">json</span><span class="crayon-sy">.</span><span class="crayon-e">dump</span><span class="crayon-sy">(</span><span class="crayon-v">AABBBA</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">"borgstruct.cfg"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"w"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-86"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\t[-] CONFIGURATION VERSION"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'key'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">".0 WRITTEN"</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-87"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'key'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-88"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\n[+] FETCHING STARTUP VALUE FROM MATRIX"</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-89"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-e">sleep</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-90"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-91"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBB5</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">AABBB7</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'dilithium'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"a"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'coil'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"a"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'warp'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-92"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBB6</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">requests</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-v">AABBB5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verify</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-93"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">except</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-94"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">AABBCB</span><span class="crayon-sy">(</span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'LoadLibraryA'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-95"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBCE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">AABBB6</span><span class="crayon-sy">.</span><span class="crayon-v">content</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">"\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-96"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\t[-] DATA ="</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">AABBCE</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-97"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'key'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-p"># [+] *** ALERT ALERT *** [+]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-98"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\n[+] SEND FLAG REQUEST WITH ENCRYPTED DATA AND CODE [+]"</span><span class="crayon-h"> </span><span class="crayon-p"># [+] HUMANS HAVE BROKE NEXT DEFENSE [+]</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-99"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBCE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">AABBB7</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'dilithium'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"o"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'coil'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"o"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'warp'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p"># [+] INITIATE LOW ORBIT ION CANNON [+]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-100"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\t[-] DATA ="</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AABBCE</span><span class="crayon-h"> </span><span class="crayon-p"># [+] *** ALERT ALERT *** [+]</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-101"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBCF</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'key'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-102"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\t[-] INITIALIZATION KEY ="</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">AABBCF</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-103"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">AABBCF</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-104"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">sys</span><span class="crayon-sy">.</span><span class="crayon-e">exit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-105"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\n[+] STARTING BORG ENCRYPTION ROUTINE [+]"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-106"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-e">sleep</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-107"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBBB</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">AABBBC</span><span class="crayon-sy">(</span><span class="crayon-v">AABBCE</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AABBCF</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'array'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-108"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\t[-] RESULT = "</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">AABBBB</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-109"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\n[+] STARTING DRONE COMMUNICATION PROTOCOLS [+]"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-110"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-e">sleep</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-111"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">scalar_array</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'scalar'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-112"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">FEEDDEAD</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">base64</span><span class="crayon-sy">.</span><span class="crayon-e">b64decode</span><span class="crayon-sy">(</span><span class="crayon-s">'cGFuYm9yZ2Ryb25lLmNvbQ=='</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-113"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-114"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBB8</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">IP</span><span class="crayon-sy">(</span><span class="crayon-v">dst</span><span class="crayon-o">=</span><span class="crayon-v">FEEDDEAD</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-e">TCP</span><span class="crayon-sy">(</span><span class="crayon-v">dport</span><span class="crayon-o">=</span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'array'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-v">window</span><span class="crayon-o">=</span><span class="crayon-v">scalar_array</span><span class="crayon-sy">,</span><span class="crayon-v">flags</span><span class="crayon-o">=</span><span class="crayon-s">"S"</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-e">AABBBB</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-115"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBB9</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sr1</span><span class="crayon-sy">(</span><span class="crayon-v">AABBB8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-116"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">except</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-117"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">AABBCB</span><span class="crayon-sy">(</span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'LoadLibraryB'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-118"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">AABBB9</span><span class="crayon-sy">[</span><span class="crayon-v">TCP</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">window</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">666</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-119"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\t*** ERROR RECEIVED ***"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-120"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\t[-] RETURNED = "</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AABBB9</span><span class="crayon-sy">[</span><span class="crayon-v">Raw</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-121"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\n[+] SHUTTING DOWN DRONE [+]\n"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-122"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-e">sleep</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-123"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">sys</span><span class="crayon-sy">.</span><span class="crayon-e">exit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-124"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">elif </span><span class="crayon-v">AABBB9</span><span class="crayon-sy">[</span><span class="crayon-v">TCP</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">window</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">34</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-125"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\t[-] UPDATE SUCCESSFUL"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-126"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">AABBBA</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ast</span><span class="crayon-sy">.</span><span class="crayon-e">literal_eval</span><span class="crayon-sy">(</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">AABBB9</span><span class="crayon-sy">[</span><span class="crayon-v">Raw</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">strip</span><span class="crayon-sy">(</span><span class="crayon-s">"\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-127"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\t[-] CONFIGURATION VERSION"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'key'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">".0 WRITTEN"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-128"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">json</span><span class="crayon-sy">.</span><span class="crayon-e">dump</span><span class="crayon-sy">(</span><span class="crayon-v">AABBBA</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">"borgstruct.cfg"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"w"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-129"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\t[-] PROCESSING COMMANDS"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-130"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\t[-] EXECUTING COMMAND ="</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'commands'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'adb'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"/"</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-131"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-e">sleep</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-132"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\t*** ERROR WITH COMMAND ***"</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-133"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\t[-] NEW SERVER FUNCTION ADDED - FLAG REQUEST"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-134"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\t[-] FLAG REQUEST REQUIRED FOR CURRENT ENCRYPTED DATA"</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-135"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\n[+] SHUTTING DOWN DRONE [+]\n"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-136"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-e">sleep</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-137"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">sys</span><span class="crayon-sy">.</span><span class="crayon-e">exit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-138"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-139"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\t[-] RETURNED = "</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AABBB9</span><span class="crayon-sy">[</span><span class="crayon-v">Raw</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"\n"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-140">&nbsp;</div><div class="crayon-line" id="crayon-5f694c5e37f41765820578-141"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">__name__</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"__main__"</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f41765820578-142"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0087 seconds] -->
<p>Lots of things going on in the script, the main ones of interest are some of the ones that immediately jump out for investigation.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c5e37f4a592377900" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# Called before encryption message prints
AABBBB = AABBBC(AABBCE, AABBCF, AABBBA['array'][3])
# Scapy sending data to a server (part of the “COMMUNICATION PROTOCOL”?)
AABBB8 = IP(dst=FEEDDEAD)/TCP(dport=AABBBA['array'][5],window=scalar_array,flags="S")/AABBBB
#  Branch leads to messages about the flag
    elif AABBB9[TCP].window == 34:
        print "\t[-] NEW SERVER FUNCTION ADDED - FLAG REQUEST"
        print "\t[-] FLAG REQUEST REQUIRED FOR CURRENT ENCRYPTED DATA"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c5e37f4a592377900-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4a592377900-2">2</div><div class="crayon-num" data-line="crayon-5f694c5e37f4a592377900-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4a592377900-4">4</div><div class="crayon-num" data-line="crayon-5f694c5e37f4a592377900-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4a592377900-6">6</div><div class="crayon-num" data-line="crayon-5f694c5e37f4a592377900-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4a592377900-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c5e37f4a592377900-1"><span class="crayon-p"># Called before encryption message prints</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4a592377900-2"><span class="crayon-v">AABBBB</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">AABBBC</span><span class="crayon-sy">(</span><span class="crayon-v">AABBCE</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AABBCF</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'array'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f4a592377900-3"><span class="crayon-p"># Scapy sending data to a server (part of the “COMMUNICATION PROTOCOL”?)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4a592377900-4"><span class="crayon-v">AABBB8</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">IP</span><span class="crayon-sy">(</span><span class="crayon-v">dst</span><span class="crayon-o">=</span><span class="crayon-v">FEEDDEAD</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-e">TCP</span><span class="crayon-sy">(</span><span class="crayon-v">dport</span><span class="crayon-o">=</span><span class="crayon-v">AABBBA</span><span class="crayon-sy">[</span><span class="crayon-s">'array'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-v">window</span><span class="crayon-o">=</span><span class="crayon-v">scalar_array</span><span class="crayon-sy">,</span><span class="crayon-v">flags</span><span class="crayon-o">=</span><span class="crayon-s">"S"</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-v">AABBBB</span></div><div class="crayon-line" id="crayon-5f694c5e37f4a592377900-5"><span class="crayon-p">#&nbsp;&nbsp;Branch leads to messages about the flag</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4a592377900-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">elif </span><span class="crayon-v">AABBB9</span><span class="crayon-sy">[</span><span class="crayon-v">TCP</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">window</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">34</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f4a592377900-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\t[-] NEW SERVER FUNCTION ADDED - FLAG REQUEST"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4a592377900-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"\t[-] FLAG REQUEST REQUIRED FOR CURRENT ENCRYPTED DATA"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>First things first, we’ll take a look at the encryption function and decipher that. We set a breakpoint on the main() function and begin to step through the code to understand what it’s doing.</p>
<ul>
<li>Tries to load the file “borgstruct.cfg” and if that fails, it writes a dictionary to disk as that file.</li>
<li>Check if dictionary ‘key’[1] is equal to 1 and if so, puts together a string from various locations within the dictionary. <a href="http://pastebin.com/raw/wFA6EPfF">This URL contains the Youtube video mentioned above</a>.</li>
<li>Sets another variable to “borgdata”.<br />
Calls the encryption routine AABBBC(URL,”borgdata”,25).</li>
</ul>
<p><img class="aligncenter wp-image-18562 size-full" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_45.png" alt="CTF_threat_45" width="462" height="92" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_45.png 462w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_45-230x46.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_45-201x40.png 201w" sizes="(max-width: 462px) 100vw, 462px" /></p>
<ul>
<li>Checks if URL is divisible by 8 and, if not, pads it with “@”.</li>
<li>Splits each variable into a list and begins the XoR the URL by key “borgdata”.<img class="aligncenter size-large wp-image-18565" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_46-500x181.png" alt="CTF_threat_46" width="500" height="181" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_46-500x181.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_46-230x83.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_46-768x278.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_46-510x185.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_46-110x40.png 110w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_threat_46.png 828w" sizes="(max-width: 500px) 100vw, 500px" /></li>
<li>Once it has the first set of 8 ordinals it reverses them and uses this set as the next XoR key, which continues on for the full length of the URL.<img class="aligncenter size-full wp-image-18379" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_47.png" alt="CTF_Threat_47" width="900" height="188" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_47.png 900w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_47-230x48.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_47-768x160.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_47-500x104.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_47-510x107.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_47-191x40.png 191w" sizes="(max-width: 900px) 100vw, 900px" /><br />
This is classic cipher block chaining where each encrypted ciphertext is used as the encryption key for the next block.</li>
<li>If we let the process continue until the end, it reverses the order of the final ordinal list and then converts it to hex.</li>
</ul>
<p>Since we know the ciphertext and now we know how the key is derived, we have enough pieces of the puzzle to build a decryptor. By copying the code from the script and de-obfuscating it, we can build our reverse decryption function.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c5e37f4d033109993" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
#!/usr/bin/env python

def decrypt(hash):
    final_key = []
    key = []
    count = 0
    while count != len(hash):
        key.append(hash[count:count+2])
        count += 2
    key = key[::-1]
    temp = []
    for value in key:
        ord_value = ord(value.decode("hex"))
        temp.append(ord_value)
    count = 0
    block_count = len(temp)
    while block_count != 0:
        cipher = []
        block = temp[block_count - 8:block_count]
        if block_count != 0:
            for value in block:
                cipher.append(value)
        else:
            for value in block:
                cipher.append(value)
        xor_key = (temp[block_count - 16:block_count - 8])[::-1]

        string_key = []
        count = 0
        if block_count - 8  != 0:
            while count != 8:
                string_key.append(chr(cipher[count] ^ xor_key[count]))
                count +=1
        else:
            string_key = ["????????"]
        final_key.append("".join(string_key))

        block_count -= 8
        xor_key = []
    final_key = "".join(final_key[::-1])
    return "".join(final_key)

def encrypt(pt, key, add_value):
    pt_size = len(pt)/float(len(key)) # Grab Key Length
    if str(pt_size).split(".")[1] == "0": # Check if divisible by 8
        multiply_size = int(str((pt_size)).split(".")[0]) * 8
    else:
        while str(pt_size).split(".")[1] != "0": # Pad pt to be divisible by 8
            pt += "@"
            pt_size = len(pt)/float(len(key))
        multiply_size = int(str((pt_size)).split(".")[0]) * 8
    cipher = []
    pt = list(pt) # Put plaintext and key into their respective list for processing in 8 byte chunks
    key = list(key)
    while pt != []: # Stop when all plaintext processed
        p_pt = pt[0:8]
        p_key = key[0:8]
        temp_list = []
        for i in xrange(0,8): # Process 8 bytes at a time
            if type(p_key[i]) == int: # Second 8 bytes and on will always be integers
                new_ct = (ord(chr(p_key[i])) ^ ord(p_pt[0])) # XOR each PT byte with key byte
            else: # First run of XOR, assuming ASCII key
                new_ct = (ord(p_key[i]) ^ ord(p_pt[0]))
            cipher.append(new_ct) # Add each byte to CT list
            temp_list.append(new_ct)
            pt.pop(0)
            p_pt.pop(0)
            key = temp_list
        key.reverse() # Reverse Key list each run so now Z-&gt;A on second run+ (integers)
    cipher.reverse() # Reverse entire CT
    cipher_text = []
    for i in cipher: # Convert each integer to hex equivalent
        hex_value = hex(i)
        if len(hex_value) != 4: # Pad to get consistent output with leading 0's
            cipher_text.append("0" + hex(i)[2:])
        else:
            cipher_text.append(hex(i)[2:])
    cipher_text = "".join(cipher_text).upper() # Join it into one string
    return cipher_text

def main():
    pt = "https://www.youtube.com/watch?v=AyenRCJ_4Ww"
    key = "borgdata"
    numb = 25
    enc_hash = encrypt(pt, key, numb)
    dec_hash = decrypt(enc_hash)
    print "Encrypted Hash: %s\nDecrypted Hash: %s" % (enc_hash, dec_hash)

if __name__ == "__main__":
    main()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-2">2</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-4">4</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-6">6</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-8">8</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-10">10</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-12">12</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-14">14</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-16">16</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-18">18</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-20">20</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-22">22</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-24">24</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-26">26</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-28">28</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-30">30</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-32">32</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-34">34</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-36">36</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-38">38</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-40">40</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-42">42</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-44">44</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-46">46</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-48">48</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-50">50</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-52">52</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-54">54</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-56">56</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-58">58</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-60">60</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-62">62</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-64">64</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-66">66</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-68">68</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-70">70</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-72">72</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-74">74</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-76">76</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-78">78</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-80">80</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-82">82</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-84">84</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-86">86</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-88">88</div><div class="crayon-num" data-line="crayon-5f694c5e37f4d033109993-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f4d033109993-90">90</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-1"><span class="crayon-p">#!/usr/bin/env python</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-2">&nbsp;</div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-3"><span class="crayon-e">def </span><span class="crayon-e">decrypt</span><span class="crayon-sy">(</span><span class="crayon-v">hash</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">final_key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">count</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">count</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">hash</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">key</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">hash</span><span class="crayon-sy">[</span><span class="crayon-v">count</span><span class="crayon-o">:</span><span class="crayon-v">count</span><span class="crayon-o">+</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">count</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-sy">[</span><span class="crayon-o">::</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">temp</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">value </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ord_value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">value</span><span class="crayon-sy">.</span><span class="crayon-e">decode</span><span class="crayon-sy">(</span><span class="crayon-s">"hex"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">temp</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">ord_value</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">count</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">block_count</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">temp</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">block_count</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">cipher</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">block</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">temp</span><span class="crayon-sy">[</span><span class="crayon-v">block_count</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-o">:</span><span class="crayon-v">block_count</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">block_count</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">value </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">block</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">cipher</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">value</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">value </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">block</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">cipher</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">value</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">xor_key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">temp</span><span class="crayon-sy">[</span><span class="crayon-v">block_count</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-o">:</span><span class="crayon-v">block_count</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-o">::</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">string_key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">count</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">block_count</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">count</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">string_key</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-v">cipher</span><span class="crayon-sy">[</span><span class="crayon-v">count</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-v">xor_key</span><span class="crayon-sy">[</span><span class="crayon-v">count</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">count</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">string_key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"????????"</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">final_key</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-s">""</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">string_key</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">block_count</span><span class="crayon-h"> </span><span class="crayon-o">-=</span><span class="crayon-h"> </span><span class="crayon-cn">8</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">xor_key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">final_key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">final_key</span><span class="crayon-sy">[</span><span class="crayon-o">::</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">final_key</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-42">&nbsp;</div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-43"><span class="crayon-e">def </span><span class="crayon-e">encrypt</span><span class="crayon-sy">(</span><span class="crayon-v">pt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">add_value</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">pt_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">pt</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p"># Grab Key Length</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">pt_size</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">"."</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"0"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-p"># Check if divisible by 8</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">multiply_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">pt_size</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">"."</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">8</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">pt_size</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">"."</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-s">"0"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-p"># Pad pt to be divisible by 8</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">pt</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">"@"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">pt_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">pt</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">multiply_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">pt_size</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">"."</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">8</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">cipher</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">pt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">pt</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p"># Put plaintext and key into their respective list for processing in 8 byte chunks</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-55"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">pt</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-p"># Stop when all plaintext processed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-56"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">p_pt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pt</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">p_key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">temp_list</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">xrange</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-p"># Process 8 bytes at a time</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-60"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-v">p_key</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-p"># Second 8 bytes and on will always be integers</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-61"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_ct</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-v">p_key</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">p_pt</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p"># XOR each PT byte with key byte</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-62"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-p"># First run of XOR, assuming ASCII key</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_ct</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">p_key</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">p_pt</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-64"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">cipher</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">new_ct</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p"># Add each byte to CT list</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-65"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">temp_list</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">new_ct</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-66"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">pt</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-67"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">p_pt</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-68"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">temp_list</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-69"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">key</span><span class="crayon-sy">.</span><span class="crayon-e">reverse</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p"># Reverse Key list each run so now Z-&gt;A on second run+ (integers)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-70"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">cipher</span><span class="crayon-sy">.</span><span class="crayon-e">reverse</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p"># Reverse entire CT</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-71"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">cipher_text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-72"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">cipher</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-p"># Convert each integer to hex equivalent</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-73"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">hex_value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">hex</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-74"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">hex_value</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-p"># Pad to get consistent output with leading 0's</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-75"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">cipher_text</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-s">"0"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">hex</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-76"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-77"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">cipher_text</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">hex</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-78"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">cipher_text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">cipher_text</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">upper</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p"># Join it into one string</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-79"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">cipher_text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-80">&nbsp;</div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-81"><span class="crayon-e">def </span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-82"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">pt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"https://www.youtube.com/watch?v=AyenRCJ_4Ww"</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-83"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"borgdata"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-84"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">numb</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">25</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-85"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">enc_hash</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">encrypt</span><span class="crayon-sy">(</span><span class="crayon-v">pt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">numb</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-86"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">dec_hash</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">decrypt</span><span class="crayon-sy">(</span><span class="crayon-v">enc_hash</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-87"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"Encrypted Hash: %s\nDecrypted Hash: %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">enc_hash</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dec_hash</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-88">&nbsp;</div><div class="crayon-line" id="crayon-5f694c5e37f4d033109993-89"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">__name__</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"__main__"</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f4d033109993-90"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0051 seconds] -->
<p>Running the code with the known plain text and initial key shows we get the same ciphertext shown in the initial run of the drone.exe executable, along with our known YouTube URL.</p>
<p><img class="aligncenter size-full wp-image-18376" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_48.png" alt="CTF_Threat_48" width="899" height="60" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_48.png 899w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_48-230x15.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_48-768x51.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_48-500x33.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_48-510x34.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_48-240x16.png 240w" sizes="(max-width: 899px) 100vw, 899px" /></p>
<p>Now we can take the returned value and put it through our decryptor to see what we get.</p>
<p>The hash “405E520E4A0E6F3401584E0A4E121E00322C24793B7E6C3304594B0E41131B032C6867<br />
07A3E2A2B484553174C0E064724696363753C372F5B40550117061B0A” becomes “???????<br />
twitter.com/borgcommlink/status/755587712267104257@@@@@@”.</p>
<p>Browsing to that Twitter address, we’re greeted with yet another hash.<a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_49.png"><img class="aligncenter wp-image-18373 size-large" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_49-500x259.png" alt="CTF_Threat_49" width="500" height="259" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_49-500x259.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_49-230x119.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_49-768x398.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_49-510x264.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_49-77x40.png 77w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_49.png 900w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>This hash decrypts to another excellent <a href="https://www.youtube.com/watch?v=rTAx8r_090o" target="_blank">Star Trek Youtube video</a>.</p>
<p>Looking back at our script, we can tell that the script sends a hash to panborgdrone.com on port TCP/2600 and based on the result of what the server sends back, either shuts down or updates its configuration with a new “function” called “FLAG REQUEST”. Sounds promising.</p>
<p>Let’s try editing the script and sending the hash from Borg Head.</p>
<p><img class="aligncenter size-full wp-image-18370" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_50.png" alt="CTF_Threat_50" width="506" height="95" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_50.png 506w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_50-230x43.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_50-500x94.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_50-213x40.png 213w" sizes="(max-width: 506px) 100vw, 506px" /></p>
<p>We get a slightly different error message this time and no hash like we did originally. Instead of “HIVE|MIND|HASH” it’s “HIVE|ERROR|DATA|874”. Looking at the Scapy command again, the TCP Window Size is set by variable “scalar_array” which pulls from the configuration dictionary.</p>
<p><img class="aligncenter size-full wp-image-18367" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_51.png" alt="CTF_Threat_51" width="899" height="193" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_51.png 899w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_51-230x49.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_51-768x165.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_51-500x107.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_51-510x109.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_51-186x40.png 186w" sizes="(max-width: 899px) 100vw, 899px" /></p>
<p>Setting the Window Size to 34 nets us a change in response from the server.</p>
<p><img class="aligncenter size-full wp-image-18364" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_52.png" alt="CTF_Threat_52" width="750" height="265" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_52.png 750w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_52-230x81.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_52-500x177.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_52-510x180.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_52-113x40.png 113w" sizes="(max-width: 750px) 100vw, 750px" /></p>
<p>Looking at the 2.0 configuration, this key and values stand out immediately.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c5e37f52853985611" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
   "datashat" : [
      "submit",
      "the",
      "flag",
      "manually"
   ],</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c5e37f52853985611-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f52853985611-2">2</div><div class="crayon-num" data-line="crayon-5f694c5e37f52853985611-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f52853985611-4">4</div><div class="crayon-num" data-line="crayon-5f694c5e37f52853985611-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c5e37f52853985611-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c5e37f52853985611-1"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-s">"datashat"</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f52853985611-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"submit"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5f694c5e37f52853985611-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"the"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f52853985611-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"flag"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5f694c5e37f52853985611-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"manually"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c5e37f52853985611-6"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Running the bot again with the new configuration, it loads a new URL (with quite possibly the <a href="https://www.youtube.com/watch?v=X6oUz1v17Uo">best Star Trek video ever made</a>) and XoR key of “borgcube” to generate a new hash. Placing the new hash in our send command, we get the following error “HIVE|ERROR|CMD|2E”, which is different than the previous “ERROR|DATA” message we received.</p>
<p><img class="aligncenter size-full wp-image-18361" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_53.png" alt="CTF_Threat_53" width="900" height="249" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_53.png 900w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_53-230x64.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_53-768x212.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_53-500x138.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_53-510x141.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_53-145x40.png 145w" sizes="(max-width: 900px) 100vw, 900px" /></p>
<p>Changing the Window Size back to 874 didn’t result in any change of the message; however, while looking through the rest of Borg Head’s Tweets, we find this little gem among the memes and Borgs talking to each other.<br />
<a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_54.png"><img class="aligncenter wp-image-18358 size-large" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_54-500x362.png" alt="CTF_Threat_54" width="500" height="362" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_54-500x362.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_54-230x166.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_54-768x556.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_54-415x300.png 415w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_54-55x40.png 55w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_54.png 900w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>In the background of this message is a spreadsheet with a table showing various commands (CMD) and their respective Window Size. We can see that value 874 corresponds to “DRONE CHECKIN”, value 34 is “DRONE UPDATE”, and value 824 is “FLAG REQUEST”!</p>
<p>Updating our script one last time with our new Window Size we are rewarded with our key.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_55.png"><img class="aligncenter wp-image-18355 size-large" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_55-500x234.png" alt="CTF_Threat_55" width="500" height="234" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_55-500x234.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_55-230x108.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_55-768x360.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_55-510x239.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_55-85x40.png 85w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_55.png 900w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>A Star Wars troll for all the Star Trek fans…</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_56.png"><img class="aligncenter wp-image-18172 size-large" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_56-500x375.png" alt="CTF_Threat_56" width="500" height="375" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_56-500x375.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_56-230x173.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_56-400x300.png 400w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_56-53x40.png 53w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Threat_56.png 650w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>PAN{m4yTh3f0rc3beWIThyOu}</p>
</div>
            </div>

        </div>       
    </div>
  </article>


<script type="text/javascript">
    $('body').on('mouseover', '.idc_ul_cont_not_liked_inner', function(e) {
          $(this).find('svg').children('path').attr('stroke','#FF2E00');
          //$(this).attr('src','https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/blue-like-icon.png');
      });
      $('body').on('mouseout', '.idc_ul_cont_not_liked_inner', function(e) {
          $(this).find('svg').children('path').attr('stroke','#000000');
          //$(this).attr('src','https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/grey-like-icon.png');
      });
      
    $(document).ready(function(){
        //Moving single post page subscribe box one paragraph above from last
        var cont_width = $(".entry-content").width();
        cont_width = Math.round(cont_width/2);//
        var p_tag_found = false;
        var child_count = $( ".entry-content").children().length;
        var last_p_tag = ''; //2nd p tag 
        var p_tag_traverse_cnt = 0;
        var p_arr = [];
        var next_tag_is_image_container = false;
        for(var i = 0; i < child_count ; i++){
            var p_el = $('.entry-content').children().eq(i);
            /*
            var tag_name = $(p_el).prop('tagName');
            if(tag_name != 'UL' || tag_name == 'P'){
                continue
            }
            */
            
              var temp_text = $(p_el).html();
              temp_text = temp_text.trim();
              
              
              var found_in_child = $( p_el ).find( "img, iframe, video, figure" );
                
              if(temp_text == '&nbsp;' || temp_text == ''){
                 continue;
              }
              else{
                  p_arr.push(p_el);
              }
        }
        console.log(p_arr);
        

        $.each(p_arr, function (index,value) {
            
            if(next_tag_is_image_container){
                next_tag_is_image_container = false;
                return;
            }
            
            var found_img1 = $(p_arr[index]).find( "img, iframe, video, figure" );//finding any image
            var found_txt1 = $(p_arr[index]).text().trim();
            if(found_img1.length != 0 && found_txt1 == ''){//if image exists inside paragraph, with no sibling text
                return;
            }
                
                var p_el = value;
                var current_tag_name = $(p_el).prop('tagName');
                if(current_tag_name == 'IMG' || current_tag_name == 'IFRAME' || current_tag_name == 'VIDEO' || current_tag_name == 'FIGURE'){
                    return;
                }
              
              
                  p_tag_traverse_cnt++;
                  var next_of_p = p_arr[index+1];
                  var next_tag = $(next_of_p).prop('tagName');
                  
                  
                  if(p_tag_traverse_cnt == 3){
                      //If next element is UL, then add subscription box after UL
                      
                      //if next element is image or video, add the box after 3rd paragraph
                      
                      if(next_tag == 'IMG' || next_tag == 'IFRAME' || next_tag == 'VIDEO' || next_tag == 'FIGURE'){
                          //Check if image is not right aligned
                          var img_width = $(next_of_p).width();
                          
                          if(img_width > cont_width){//If image is not right aligned
                              next_tag_is_image_container = true;
                                return;
                          }
                          
                          
                      }
                      //Check if image or video exist as a child element
                      var found_in_child = $( next_of_p ).find( "img, iframe, video, figure" );
                      //console.log(found_in_child[0].width);
                      //console.log(found_in_child);
                      if(found_in_child.length != 0){
                             var img_width = found_in_child[0].width;
                             console.log(img_width+" "+cont_width);
                          if(img_width > cont_width){//If image is not right aligned
                              next_tag_is_image_container = true;
                                return;
                          }
                          
                      }
                      
                      if(next_tag == 'UL' && current_tag_name != 'UL'){
                          last_p_tag = next_of_p;
                          return false;    
                      }
                      else{
                          last_p_tag = p_el;
                          return false;    
                      }
                      
                  }    
                  if(p_tag_traverse_cnt > 3){
                       //If next element is UL, then add subscription box after UL
                      if(next_tag == 'UL' && current_tag_name != 'UL'){
                          last_p_tag = next_of_p;
                          return false;     
                      }
                      else{
                          last_p_tag = p_el;
                          return false;   
                      }
                  }
              
        });
        
        
        if(last_p_tag != ''){
            $( last_p_tag ).after('<div style="clear:both;"></div>',$('.subscribe-form-inner'));
        }
        // $( ".entry-content p:last-child" ).before($('.subscribe-form-inner'));
        
    });
    $('a').each(function() {
        if(this.id == 'share_btn'){
            return;
        }
        var a = new RegExp('/' + window.location.host + '/');
        if(!a.test(this.href)) {
            $(this).click(function(event) {
                event.preventDefault();
                event.stopPropagation();
                window.open(this.href, '_blank');
            });
        }
     });
     $('.comment-form-cookies-consent input[type=checkbox]').prop('checked','checked');
     //$('.form-submit input[type=submit]').after( '<img class="ajax-loader" style="display:none;" src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/backgrounds/ajax-loader.gif" alt="Sending ...">' );
     //Hide manage subscription link
     
     if($('.subscribe-to-comments input[type=checkbox]').length == 0){
         $('.subscribe-to-comments').hide();
     }
     
          $('.form-submit input[type=submit]').attr('disabled',true);
          function enableCommentBtn(){
         $('.form-submit input[type=submit]').attr('disabled',false);
     }
     function disableCommentBtn(){
         $('.form-submit input[type=submit]').attr('disabled',true);
     }
    </script>
<div id="search-result-continer" style="display:none;min-height: 343px;">
    <!--<div id="search-result-heading" class="container-fluid container-breadcrumb"  data-aos="fade-in" style="display:none;">
       <div class="container-lg">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
              <li class="breadcrumb-item"><a href="https://blog.paloaltonetworks.com">Palo Alto Networks</a></li>
              <li class="breadcrumb-item search-term"></li>
          </ol>
        </nav>
       </div>
    </div>-->
    <div class="container-fluid container-feed-cards">
        <div class="container-lg">
            <div class="row row-feed">
                <div class="col col-feed">
                    
                    <div id="ajax_loader" class="text-center pb-40 pt-40">
                  <span>Loading...</span>
			</div>
      <div id="notfound2" class="text-center pt-40 pb-40" style="display: none;">Sorry, no results were found.</div>
      
                    <div class="row row-feed articles_container CoveoResultList" data-layout="list" data-wait-animation="fade" data-fields-to-include="@articlecategory, @articleauthor, @articlepublishedtime, @articlecategory, @articleauthorlink, @articledescription, @articlepostimage, @articlepublishedtimestring, @articleauthorimagelink, @articlepostid, @articlepostlength, @articlecategorylink, @uri" data-result-container-selector='#test_id' id="test_id">
                        <script id="customTemplate" type="text/underscore" class="result-template">
            <% JSON.stringify(raw) %>
              <article data-article-id="<% if(typeof raw.articlepostid !== "undefined") { print(raw.articlepostid); } %>" class="feed-card h-100 pan-coveo-search-list">
                <%if (typeof raw.articlepostimage =='undefined') { 
                    raw.articlepostimage = 'https://blog.paloaltonetworks.com/wp-content/uploads/2016/11/blog-generic-banner-1.jpg';
                 } %>
                        
                <%if (typeof raw.articlepostimage !='undefined') { %> 
                <div onclick="location.href='<%= raw.uri %>'" class="feed-card-thumbnail" style="background-image: url(<%= raw.articlepostimage %>);">
                <% if(typeof raw.articlepostid !== "undefined") { %>
                <!--<div class="total_number_view left-bottom"><span class="people-reacted<% if(typeof raw.articlepostid !== "undefined") { print(raw.articlepostid); } %>">#</span> people reacted</div>-->
                <% } %>
                  
                </div>
                <% } %>

                <div class="feed-card-content">
                <p class="label">
                <%  _.each(raw.articlecategory,function(item,key,list) { %> <a <% if(typeof raw.articlepostid == "undefined"){print(' target="_blank"');} %>  href="<% if(typeof raw.articleauthorimagelink !== "undefined"){ print(raw.articlecategorylink[key]); } else{ print("#");}  %>" class="author url fn" rel="author"><%= item %></a><%if (key+1 < raw.articlecategory.length) { %>,<%  } %><%  }); %>
                            </p>
                  <h3><a <% if(typeof raw.articlepostid == "undefined"){print(' target="_blank"');} %> class="CoveoResultLink"><% var title_article = title.substr(0,75); print(title_article); var title_length = title.length; if(title_length > 75){print("...")} %></a></h3>
                  </div>
                  
                  <div class="feed-card-metadata">
			<div class="metadata-thumbnail">
			<div class="metadata-thumbnail-author">
	  		<img src="<% if(typeof raw.articleauthorimagelink !== "undefined"){ var image_link = raw.articleauthorimagelink[0]; if(image_link.indexOf("unit42.paloaltonetworks.com") != -1 ){ print("https://blog.paloaltonetworks.com/wp-content/themes/PaloAltoNetworksBlog/dist/images/unit42-logo1.jpg");} else{ print(image_link);} }else{ print("https://blog.paloaltonetworks.com/wp-content/uploads/2016/10/Social_BlogIcon_10.13.16.png"); } %>" width="75" height="75" alt="Avatar" class="avatar avatar-75 wp-user-avatar wp-user-avatar-75 photo avatar-default">			</div>
		</div>
		
		<div class="metadata-author">
                    <span class="author-name">
				By <%  _.each(raw.articleauthor,function(item,key,list) { %> <a <% if(typeof raw.articlepostid == "undefined"){print(' target="_blank"');} %> title="Posts by <%= item %>" href="<%= raw.articleauthorlink[key] %>" class="author url fn" rel="author"><%= item %></a><%if (key+1 < raw.articleauthor.length) { %><%if (key+1 == raw.articleauthor.length-1) { %> and <% } else { %>,<% } } %><%  }); %>                        <br>
                        <time datetime="<%= raw.articlepublishedtimestring %>"><%= raw.articlepublishedtimestring %></time>
                        <br>
                       <% if(typeof raw.articlepostlength !== "undefined"){ print(Math.ceil(raw.articlepostlength/200) + " min. read"); } %>
                    
                    </span>
		</div>
    <div class="metadata-likes ldc-ul_cont idc_ul_cont_not_liked" onclick="<%  print("alter_ul_post_values(this,'"+ raw.articlepostid +"','like')"); %>">
        
        <svg class=" " width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M4.74998 15.9999H2.49999C2.10217 15.9999 1.72064 15.8419 1.43934 15.5606C1.15803 15.2793 1 14.8977 1 14.4999V9.24995C1 8.85213 1.15803 8.4706 1.43934 8.18929C1.72064 7.90799 2.10217 7.74996 2.49999 7.74996H4.74998M9.99994 6.24997V3.24999C9.99994 2.65325 9.76289 2.08096 9.34094 1.65901C8.91898 1.23705 8.34669 1 7.74996 1L4.74998 7.74996V15.9999H13.2099C13.5717 16.004 13.9227 15.8772 14.1983 15.6429C14.474 15.4086 14.6557 15.0826 14.7099 14.7249L15.7449 7.97496C15.7775 7.75997 15.763 7.54047 15.7024 7.33165C15.6418 7.12283 15.5365 6.92968 15.3938 6.7656C15.2511 6.60151 15.0745 6.47041 14.8761 6.38138C14.6777 6.29234 14.4623 6.2475 14.2449 6.24997H9.99994Z" stroke="#727272" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                                </svg>
                                <span class="<%  print("article-like-id"+raw.articlepostid);  %>"></span></span>
        
    </div>
	
</div>
              </article>
          </script>
          
                </div>     
                      <div class="col">
	
          <div class="loadmore text-center loadmore_main" style="display: none;">
      <button type="button" class="btn  load_more_btn" data-firstres="0">Load more</button>
    </div>
                    </div>
                      <div class="container" style="display: none;">
  
               

    <!-- Each DOM element with a class starting with "coveo-" (lowercase) is for CSS or alignment purpose only. -->
    <div class='coveo-search-section'>
      <div class="coveo-results-column">
        <!--selected breadcrumb-->
        <div class="CoveoBreadcrumb">
          <div class="coveo-breadcrumb-clear-all" title="Clear All Filters" tabindex="0">
            <div class="coveo-icon coveo-breadcrumb-icon-clear-all"></div>
            <div>Clear </div>
          </div>
        </div>
        <span class="CoveoSort coveo-sort-selection" data-sort-criteria="@articlepublishedtime descending" data-caption="Date"></span>
        <div class="coveo-results-header">
          <div class="coveo-summary-section">
            <span class="CoveoQuerySummary"></span>
          </div>
        </div>
      </div>
    </div>
                      </div>
      
          
            </div>
        </div>            
    </div>
</div>
</div>

<script type="text/javascript">
    document.write(str_subscription);
</script>
<section class="pan-mega-footer">
    <div class="container">
        <div class="row pan-mega-footer-links">
            <div class="col-xs-12 col-sm-4 col-md-3">
                <div class="footerTitle1 title baseComponent parbase">
                    <p>Popular Resources</p>
                </div>
                <div class="footerList1 list baseComponent parbase">
                    <ul class=" list-unstyled">
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Blog" href="https://blog.paloaltonetworks.com/">Blog</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Careers" href="https://jobs.paloaltonetworks.com/">Careers</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Communities" href="https://www.paloaltonetworks.com/communities">Communities</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Content Library" href="https://www.paloaltonetworks.com/resources">Content Library</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Cyberpedia" href="https://www.paloaltonetworks.com/cyberpedia">Cyberpedia</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Event Center" href="https://events.paloaltonetworks.com">Event Center</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Investors" href="https://investors.paloaltonetworks.com/investor-relations/overview/default.aspx">Investors</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Tech Docs" href="https://docs.paloaltonetworks.com/">Tech Docs</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Unit 42" href="https://unit42.paloaltonetworks.com/">Unit 42</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Sitemap" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-xs-12 col-sm-4 col-md-3">
                <div class="footerTitle2 title baseComponent parbase">
                    <p>Legal Notices</p>
                </div>
                <div class="footerList2 list baseComponent parbase">
                    <ul class=" list-unstyled">
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Legal Notices:Privacy" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Legal Notices:Trust Center" href="https://www.paloaltonetworks.com/legal-notices/trust-center">Trust Center</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Legal Notices:Terms of Use" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Legal Notices:Documents" href="https://www.paloaltonetworks.com/legal">Documents</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-xs-12 col-sm-4 col-md-3">
                <div class="footerTitle3 title baseComponent parbase">
                    <p>Account</p>
                </div>
                <div class="footerList3 list baseComponent parbase">
                    <ul class=" list-unstyled">
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Account:Manage Subscriptions" href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a>
                        </li>
                    </ul>
                </div>
                <div class="vulnerabilityHtml html baseComponent parbase">
                    <div style="margin-top: 30px">
                        <a href="https://www.paloaltonetworks.com/security-disclosure" style="color: #C63F24; font-family: Arial,sans-serif; font-size: 14px; font-style: normal; font-weight: normal; line-height: normal">Report a Vulnerability</a>
                    </div>
                </div>
            </div>
            <div class="col-xs-12 col-sm-12 col-md-3 footer-social-col">
                <div class="content">                
                    <ul class="list-inline">
                        <li class="list-inline-item">
                            <a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank"><img alt="Facebook" class="lozad" data-loaded="true" data-src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Facebook-black.svg" src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Facebook-black.svg"></a>
                        </li>
                        <li class="list-inline-item">
                            <a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank"><img alt="Linkedin" class="lozad" data-loaded="true" data-src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Linkedin-black.svg" src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Linkedin-black.svg"></a>
                        </li>
                        <li class="list-inline-item">
                            <a href="https://twitter.com/PaloAltoNtwks" target="_blank"><img alt="Twitter" class="lozad" data-loaded="true" data-src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Twitter-black.svg" src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Twitter-black.svg"></a>
                        </li>
                        <li class="list-inline-item">
                            <a href="https://www.youtube.com/user/paloaltonetworks" target="_blank"><img alt="Youtube" class="lozad" data-loaded="true" data-src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Youtube-black.svg" src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Youtube-black.svg"></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</section>
<footer class="pan-footer">
    <div class="container">
        <span><p>&copy; 2020 Palo Alto Networks, Inc. All rights reserved.<br></p>
        </span>
    </div>
</footer>
<div class="CoveoSearchbox" data-enable-search-as-you-type="false" data-enable-omnibox="true" data-omnibox-timeout="1000" data-placeholder="Search the blog" data-enable-query-suggest-addon="false" data-trigger-query-on-clear="true" id="pan-coveo-input" style="display: none;"></div>



<script type="text/javascript">
    jQuery('body').attr('data-pipeline', "New Research Center Pipeline");
    var timerIsCoveoDefined = '';
    var resultTotalCount;
    //var root = document.getElementById('coveo-container');
    var root = document.body;
    var isloadCoveoLibraryCalled = false;
    var screenwidth = window.screen.width;
    var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
    var topSearch = true;
    //Coveo code
    function loadCoveoLibrary() {
        if (isloadCoveoLibraryCalled) {
            return;
        }
        isloadCoveoLibraryCalled = true;
        $.getScript("https://static.cloud.coveo.com/searchui/v2.3679/js/CoveoJsSearch.Lazy.min.js");
        timerIsCoveoDefined = setInterval(isCoveoDefined, 1000);
    }
    function isCoveoDefined() {
        if (typeof Coveo !== 'undefined') {
            console.log("Coveo object is now defined.")
            executeCoveoSearch();
            clearInterval(timerIsCoveoDefined);
            $('#postSearch1, #postSearch2').attr('title', '');
            $('#postSearch1, #postSearch2').prop("readonly", false);
            $('.dropdown-menu a').css('pointer-events','auto');
        }
    }
    function executeCoveoSearch() {

        var settings = {
            "async": false,
            "url": "https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/coveosearch.getaccesstoken.php",
            //"url": "https://www.paloaltonetworks.com/apps/pan/public/coveosearch.getaccesstoken.json",
            "method": "GET",
        }


        jQuery.ajax(settings).done(function (response) {

            Coveo.SearchEndpoint.endpoints['default'] = new Coveo.SearchEndpoint({
                restUri: 'https://platform.cloud.coveo.com/rest/search',
                queryStringArguments: {
                    organizationId: 'paloaltonetworksintranet'                    
                },
                accessToken: response.token
            });
            Coveo.$$(root).on("querySuccess", function (e, data) {
                //console.log(data.query.q);
                if(!$('#searching').val()){
                    topSearch = false;
                }
                
                if(topSearch){
                    $([document.documentElement, document.body]).animate({
                        scrollTop: 0 
                    }, 1000);
                }
                
                if(topSearch){
                    $('nav.navbar li a.active').removeClass('active');
                }
                resultTotalCount = data.results.totalCount;
                //document.title = "Palo Alto Networks Blog";
                /*
                if(resultTotalCount > 0){
                    $('#search-result-heading .search-term').text(capitalizeFirstLetter(data.query.q));
                    $('#search-result-heading').show();
                }
                else{
                    $('#search-result-heading').hide();
                    $('#search-result-heading .search-term').text('');
                }
                */

            });
            Coveo.$$(root).on("newResultsDisplayed", function (e, args) {
                $('#ajax_loader').hide();
                $('#notfound2').hide();
                $('.load_more_btn').html('Load more');
                $('.load_more_btn').prop('disabled', false);
                $('.CoveoResult').addClass('col-xs-12 col-sm-6 col-md-6 col-lg-4 col-xl-4 col-feed-card grid-item');
                var article_ids = new Array();
                jQuery.each(jQuery('.pan-coveo-search-list'), function (i) {
                    var article_id_tmp = $(this).data("article-id");
                    if (article_id_tmp != '' && !jQuery(this).hasClass('num-like-retrieved')) {
                        article_ids.push(article_id_tmp);
                    }
                    if (article_id_tmp != '') {
                        //If this article is liked, make the thumb icon to blue
                        var article_liked_list = [];
                        var like_found = $.inArray(article_id_tmp, article_liked_list);
                        if (like_found != -1) {
                            $(this).find('.ldc-ul_cont').find('svg').children('path').attr('stroke', '#FF2E00');
                            $(this).find('.ldc-ul_cont').removeClass('idc_ul_cont_not_liked');
                        }
                    }
                });
                if (article_ids.length > 0) {
                    var saveData = $.ajax({
                        type: 'POST',
                        url: wp_vars.ajax_url,
                        data: {action: 'fetch_total_article_likes', article_ids_arr: JSON.stringify(article_ids)},
                        dataType: "json",
                        success: function (resultData) {
                            //var article_likes = JSON.parse(resultData);
                            jQuery.each(article_ids, function (i, val) {
                                $('.article-like-id' + val).text(resultData[val][0]);
                                //$('.people-reacted'+val).text(resultData[val][1]);
                                $('.article-like-id' + val).closest(".pan-coveo-search-list").addClass('num-like-retrieved');
                            });
                        }
                    });
                }
                //console.log($('.CoveoResult').length +'|'+ resultTotalCount);
                //console.log(Coveo.state(root, 'first'));
                if ($('.CoveoResult').length >= resultTotalCount) {
                    $('.load_more_btn').hide();
                } else {
                    $('.load_more_btn').show();
                }
                if (resultTotalCount <= 0) {
                    $('#notfound2').show();
                } else {
                    $('#notfound2').hide();
                }
                
                if (jQuery('.magic-box-input input').val() || $('.CoveoResult').length >= 1) {
                    if(topSearch){
                        jQuery('#main-container').hide();
                        $('#inner_cards').show();
                        jQuery('.loadmore_main2').hide();
                        jQuery('#search-result-continer').show();
                        jQuery('.loadmore_main').show();
                        $('#main-container .container-feed-cards .container-lg').removeAttr('style');
                        $('#search-result-continer .container-feed-cards .container-lg').removeAttr('style');
                    }
                    else{
                        jQuery('#main-container').show();
                        $('#inner_cards').hide();
                        jQuery('.loadmore_main2').hide();
                        jQuery('#search-result-continer').show();
                        jQuery('.loadmore_main').show();
                        $('#main-container .container-feed-cards .container-lg').attr('style','padding-bottom: 0;');
                        $('#search-result-continer .container-feed-cards .container-lg').attr('style','padding-top: 0;');
                    }
                } else {
                    jQuery('#search-result-continer').hide();
                    jQuery('.loadmore_main').hide();
                    $('#inner_cards').show();
                    jQuery('#main-container').show();
                    jQuery('.loadmore_main2').show();
                }
            });
            //Coveo.state(root, 'numberOfResults',9);
            //Coveo.state(Coveo.$$(document).find(".magic-box-input input"), 'f:@articlecategory' , 'Secure the Cloud');
            Coveo.SearchInterface.options.autoTriggerQuery.defaultValue = false;
            Coveo.init(root);
        });
    }

    $('body').on('blur', '.magic-box-input input, #postSearch1', function (e) {
        var has_hash = false;
        if (window.location.hash.length) {
            has_hash = true;
        }
        var to_append = '';
        if (has_hash) {
            to_append = window.location.hash.replace('#', '');
            to_append = '#' + to_append;
        }
        window.history.replaceState(null, null, "?search_field=" + $(this).val() + to_append);
    });

    $('.load_more_btn').on('click', function () {
        //Coveo.SearchEndpoint.endpoints["default"].options.queryStringArguments.numberOfResults = 8;
        load_more_clicked = true;

        var this_btn = $(this);
        $(this).addClass('is-clicked');
        $(this).html('Loading...');
        $(this).prop('disabled', true);
        //jQuery('.articles_container').masonry('reloadItems').masonry();
        //Coveo.SearchEndpoint.endpoints["default"].options.queryStringArguments.numberOfResults = 8;
        //Coveo.state(root, 'firstResult',$('.CoveoResult').length - 1);
        Coveo.$('.CoveoResultList').coveo('displayMoreResults', 9);
        //Coveo.SearchEndpoint.endpoints["default"].options.queryStringArguments.numberOfResults = 9;
        setTimeout(function () {
            this_btn.removeClass('is-clicked');
        }, 1900);
    });
    var interval;
    var timer2;

    if (isIE11) {
        executeCoveoSearch();
    }




    var captcha_rendered = false;
    var subscribeSuccess = false;

    jQuery('body').on('change paste keyup', '.business_email_bot', function () {
        jQuery(this).closest('form').find('.google-recapth').removeClass('d-none');
    });

    $('body').on('mouseover', '.idc_ul_cont_not_liked', function (e) {
        $(this).find('svg').children('path').attr('stroke', '#FF2E00');
        //$(this).attr('src','https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/blue-like-icon.png');
    });
    $('body').on('mouseout', '.idc_ul_cont_not_liked', function (e) {
        $(this).find('svg').children('path').attr('stroke', '#727272');
        //$(this).attr('src','https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/grey-like-icon.png');
    });




    $(document).ready(function () {
        getSerializedTracking("Unit42_Subscribe");

    });
    $('body').click(function () {
        $('.CoveoDidYouMean').hide();
    });

    jQuery('body').on('change paste keyup', '.business_email', function () {
        //console.log($('#captcha_container2').children().length);
        if ($('#captcha_container').length == 1 && $('#captcha_container').children().length == 0) {
            console.log("cap1");
            var loadCaptcha = function () {
                captchaContainer = grecaptcha.render('captcha_container', {
                    'sitekey': '6LeyHGkUAAAAAEwfqwKWxNqdht3xjSNf-j3bK7l2',
                    'callback': function (response) {
                        $("form[name='Unit42_Subscribe'] button[type='submit']").prop('disabled', false);
                        subscribeSuccess = true;
                    },
                    'expired-callback' : function(){
                        $("form[name='Unit42_Subscribe'] button[type='submit']").prop('disabled', true);
                        subscribeSuccess = false;
                    }
                });
            }
            loadCaptcha();
        }
        /*
        if ($('#captcha_container2').length == 1 && $('#captcha_container2').children().length == 0) {
            console.log("cap2");
            var loadCaptcha2 = function () {
                captchaContainer = grecaptcha.render('captcha_container2', {
                    'sitekey': '6LeyHGkUAAAAAEwfqwKWxNqdht3xjSNf-j3bK7l2',
                    'callback': function (response) {
                        $("form[name='contact_sales_modal'] input[type='submit']").prop('disabled', false);
                        subscribeSuccess = true;
                    }
                });
            }

            loadCaptcha2();
        }
        */
        setTimeout(function () {
            jQuery('#row-recatcha').removeClass('d-none');
            //jQuery('.articles_container').masonry('layout');
        }, 50);
    });


    jQuery('body').on('submit', 'form.subscribe-form', function () {
        var success = true;
        var form = jQuery(this);
        var mail = form.find('input[name="Email"]');
        if (mail.val() === '' || !isEmail(mail.val())) {
            mail.closest("form").addClass('has-error');
            success = false;
        } else {
            mail.closest("form").removeClass('has-error');
        }

        if (success && subscribeSuccess) {
            $.ajax({
                type: 'POST',
                url: form.attr('action'),
                data: form.serialize(),
                success: function (msg) {
                    form.html('<p style="color: #0c6;">You have been successfully subscribed</p>');
                    //masonry.masonry('layout');
                }
            });
        }
        return false;
    });


    function isEmail(email) {
        var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(String(email).toLowerCase());
    }


    $(document).ready(function () {
        //$('body').attr('data-results-per-page', '9');
        $("#dropdownMenuButton").click(function(){
            if (typeof Coveo === 'undefined') {
                //$(".dropdown-menu a").attr('disabled',"disabled");
                $('.dropdown-menu a').css('pointer-events','none');
                loadCoveoLibrary();
            }
        });
        
        $(".dropdown-menu a").click(function(e){
            $(this).parents(".dropdown").find('.btn').html($(this).text());
            $(this).parents(".dropdown").find('.btn').val($(this).data('value'));
            topSearch = false;
            e.preventDefault(); 
        });
        
        /**
         $('img').each(function() {
         var path = $(this).attr('src');
         $(this).attr('src', path.replace("http://blog-localhost.paloaltonetworks.com/wp-content/upload", "https://blog.paloaltonetworks.com/wp-content/upload"));
         });
         $('figure').each(function() {
         var path = $(this).attr('style');
         if (typeof path !== 'undefined'){
         $(this).attr('style', path.replace("http://blog-localhost.paloaltonetworks.com/wp-content/upload", "https://blog.paloaltonetworks.com/wp-content/upload"));
         }
         });
         * 
         */
        
        $(".pan-page-alert-close").click(function(){
            $("#nav-mobile").css("top", "72px");
          });
          $("#feed-clear").click(function(){
              //$('#mostRecentTab').trigger('click');
            $('#postSearch2').val('');
            $('#sec-search-clear').hide();
            jQuery('#search-result-continer').hide();
            jQuery('.loadmore_main').hide();
            $('#inner_cards').show();
            jQuery('#main-container').show();
            jQuery('.loadmore_main2').show();
            $('#main-container .container-feed-cards .container-lg').removeAttr('style');
            
            
            $('.col-feed-filter #dropdownMenuButton').val("Most Recent");
            $('.col-feed-filter #dropdownMenuButton').html("Most Recent");
            $('#mostRecentTab').addClass('coveo-selected');
            $('#mostPopularTab').removeClass('coveo-selected');
         
            
          });
          

        $('#postSearch2').focus(function () {
            if (typeof Coveo === 'undefined') {
                //$('#postSearch1, #postSearch2').attr('title', 'Loading...please wait');
                $('#postSearch1, #postSearch2').prop("readonly", true);
                loadCoveoLibrary();
            }
        });
        $('body').on('keyup', '#postSearch1, #postSearch2', function (e) {
            //cur_search_txt = jQuery('.magic-box-input input').val(); 
            if(this.id == 'postSearch2'){
                topSearch = false;
            }
            else{
                topSearch = true;
            }
            var typed_text;
            if(topSearch){
                typed_text = $('#postSearch1').val();
            }
            else{
                typed_text = $('#postSearch2').val();
                if((typed_text.length > 0) ){
                    $('#sec-search-clear').show();
                    //$('#feed-search').prop('disabled', false);
                }
                else{
                    $('#sec-search-clear').hide();
                    //$('#feed-search').prop('disabled', true);
                }
            }
            
            
            $('.magic-box-input input').val(typed_text);
            if ((typed_text.length > 0) && e.keyCode === 13) {
                if(topSearch && !$('#searching').val()){
                    location.href='https://blog.paloaltonetworks.com?search_field='+typed_text;
                    return;
                }
                //enterKeyPressed = true;
                if (screenwidth < 992) {
                    if(topSearch){
                    mobileToggle();
                }
                }
                $('.CoveoSearchButton').click();
            }
        });
    });
</script>


    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://blog.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#FA582D');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <script type='text/javascript'>
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/blog.paloaltonetworks.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"}};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/plugins/contact-form-7/includes/js/scripts.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/popper.min.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/bootstrap.min.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/aos.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wp_vars = {"ajax_url":"https:\/\/blog.paloaltonetworks.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/masonry2.js?v2'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/jquery.cookie.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-includes/js/wp-embed.min.js'></script>
  </body>
</html>

