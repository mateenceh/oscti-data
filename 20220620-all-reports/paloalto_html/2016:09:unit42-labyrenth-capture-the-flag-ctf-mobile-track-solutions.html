
<!doctype html>
<html lang="en-US">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="preload" href="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/clearbit-autocomplete.css" as="style">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://usageanalytics.coveo.com">
  <link rel="preconnect" href="https://paloaltonetworks.tt.omtrdc.net">
  <link rel="preconnect" href="https://platform.cloud.coveo.com">
  <link rel="preconnect" href="https://assets.adobedtm.com">
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
  <!-- Adobe -->
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {opacity: 0 !important}", 3000));
</script>
<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<!-- End Adobe -->
  
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700&display=swap" rel="stylesheet">

  <!-- Typekit -->
  <!--
  <script src="//use.typekit.net/itd3sep.js"></script>
  <script>try{Typekit.load({ async: true });}catch(e){}</script>-->
  <!-- End Typekit -->

 


    


<link rel="apple-touch-icon" sizes="57x57" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/favicon-194x194.png" sizes="194x194">
<link rel="icon" type="image/png" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/manifest.json">
<link rel="mask-icon" href="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/safari-pinned-tab.svg" color="#8ad3de">
<link rel="shortcut icon" href="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/assets/images/icons/favicon.ico">
<meta name="msapplication-TileImage" content="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/mstile-144x144.png">
<meta name="msapplication-config" content="https://www.paloaltonetworks.com/etc/clientlibs/pan/img/favicons2020/browserconfig.xml">
<meta name="msapplication-TileColor" content="#da532c">




  <!-- Start WP HEAD -->
  <link rel="alternate" hreflang="en" href="https://blog.paloaltonetworks.com/2016/09/unit42-labyrenth-capture-the-flag-ctf-mobile-track-solutions/" />

	<!-- This site is optimized with the Yoast SEO plugin v14.2 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>LabyREnth Capture the Flag (CTF): Mobile Track Solutions</title>
	<meta name="robots" content="index, follow" />
	<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<link rel="canonical" href="https://blog.paloaltonetworks.com/2016/09/unit42-labyrenth-capture-the-flag-ctf-mobile-track-solutions/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="LabyREnth Capture the Flag (CTF): Mobile Track Solutions" />
	<meta property="og:description" content="Welcome back to our blog series where we reveal the solutions to LabyREnth, the Unit 42 Capture the Flag (CTF) challenge. We’ll be revealing the solutions to one challenge track per week. Next up, the Mobile track. Mobile &hellip;" />
	<meta property="og:url" content="https://blog.paloaltonetworks.com/2016/09/unit42-labyrenth-capture-the-flag-ctf-mobile-track-solutions/" />
	<meta property="og:site_name" content="Palo Alto Networks Blog" />
	<meta property="article:published_time" content="2016-09-29T20:15:59+00:00" />
	<meta property="article:modified_time" content="2016-10-03T14:50:09+00:00" />
	<meta property="og:image" content="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/blog-web-banner-650x300.jpg" />
	<meta property="og:image:width" content="650" />
	<meta property="og:image:height" content="300" />
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Palo Alto Networks Blog &raquo; Feed" href="https://blog.paloaltonetworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Palo Alto Networks Blog &raquo; Comments Feed" href="https://blog.paloaltonetworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Palo Alto Networks Blog &raquo; LabyREnth Capture the Flag (CTF): Mobile Track Solutions Comments Feed" href="https://blog.paloaltonetworks.com/2016/09/unit42-labyrenth-capture-the-flag-ctf-mobile-track-solutions/feed/" />
<meta property="og:date_created" content="September 29, 2016 at 1:15 PM"/>
<meta property="og:post_image" content="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/blog-web-banner-650x300.jpg"/>
<meta property="og:post_id" content="19938"/>
<meta property="og:post_total_likes" content="1"/>
<meta property="og:post_length" content="4871"/>
<meta property="og:category" content="Events"/>
<meta property="og:category_link" content="https://blog.paloaltonetworks.com/category/events/"/>
<meta property="og:author" content="Richard Wartell"/>
<meta property="og:author" content="Jeff White"/>
<meta property="og:author" content="Tyler Halfpop"/>
<meta property="og:author" content="Juan Cortes"/>
<meta property="og:author" content="Josh Grunzweig"/>
<meta property="og:authorloginname" content="Richard Wartell"/>
<meta property="og:authorloginname" content="Jeff White"/>
<meta property="og:authorloginname" content="Tyler Halfpop"/>
<meta property="og:authorloginname" content="Juan Cortes"/>
<meta property="og:authorloginname" content="Josh Grunzweig"/>
<meta property="og:authorlink" content="https://blog.paloaltonetworks.com/author/richard-wartell/"/>
<meta property="og:authorlink" content="https://blog.paloaltonetworks.com/author/jeff-white/"/>
<meta property="og:authorlink" content="https://blog.paloaltonetworks.com/author/tyler-halfpop/"/>
<meta property="og:authorlink" content="https://blog.paloaltonetworks.com/author/juan-cortes/"/>
<meta property="og:authorlink" content="https://blog.paloaltonetworks.com/author/josh-grunzweig/"/>
<meta property="og:author_image_link" content="https://blog.paloaltonetworks.com/wp-content/uploads/2017/05/unit42_400x400.jpg"/>
<meta property="og:author_image_link" content="https://blog.paloaltonetworks.com/wp-content/uploads/2017/05/unit42_400x400.jpg"/>
<meta property="og:author_image_link" content="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/tyler-halfpop.png"/>
<meta property="og:author_image_link" content="https://blog.paloaltonetworks.com/wp-content/uploads/2020/03/panw_master-twitter-profile-pic-400x400-1.png"/>
<meta property="og:author_image_link" content="https://blog.paloaltonetworks.com/wp-content/uploads/2017/05/unit42_400x400.jpg"/>
<meta property="og:section" content="Palo Alto Networks"/>
<meta property="og:recent_views" content="573"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"LabyREnth Capture the Flag (CTF): Mobile Track Solutions","name":"LabyREnth Capture the Flag (CTF): Mobile Track Solutions","description":"Welcome back to our blog series where we reveal the\u00a0solutions\u00a0to\u00a0LabyREnth, the Unit 42 Capture the Flag (CTF)\u00a0challenge. We\u2019ll be revealing the\u00a0solutions\u00a0to one challenge track per week. Next up, the Mobile track. Mobile &hellip;","url":"https:\/\/blog.paloaltonetworks.com\/2016\/09\/unit42-labyrenth-capture-the-flag-ctf-mobile-track-solutions\/","mainEntityOfPage":"https:\/\/blog.paloaltonetworks.com\/2016\/09\/unit42-labyrenth-capture-the-flag-ctf-mobile-track-solutions\/","datePublished":"September 29, 2016","articleBody":"Welcome back to our blog series where we reveal the\u00a0solutions\u00a0to\u00a0LabyREnth, the Unit 42 Capture the Flag (CTF)\u00a0challenge. We\u2019ll be revealing the\u00a0solutions\u00a0to one challenge track per week. Next up, the Mobile track.\r\nMobile 1 Challenge: This is your last chance, choose wisely!\r\nChallenge Created By: Jeff White @noottrak\r\n\r\nWe are given an iOS app for this challenge. When we run it in the emulator, we have some squares to touch. If we select a correct square it turns green, if we select a wrong one, it turns yellow; if we touch a wrong one again, it turns red and we lose.\r\n\r\n\r\n\r\nThe goal is to turn all the squares green to win and get the flag. We could just play the game and get lucky, or we could try and reverse the program to obtain the key. If we open the binary in IDA we can browse through the functions and quickly find an interesting function that stands out. Specifically, one of them is moving a long array of bytes to incrementing offsets of RDX at the beginning of the function. If we push \u2018R\u2019 on each byte in IDA, we can see that the key is being moved.\r\n\r\n\r\nPAN{EZE_S41d_Th15_w4s_Ea5y}\r\n\r\nMobile 2 Challenge: Multiple choice, you say?\r\nChallenge Created By: Juan Cortes @kongo_86\r\n\r\nWe are given an APK file \u2018EZfill.apk\u2019. To start analyzing this we can either unzip it using a zip tool or use apktool so we can look at the resources, Manifest file, and the smali code. I prefer the apktool.\r\n\r\n\r\n\r\nExamining the AndroidManifest.xml file reveals this is a rather small APK with one main activity.\r\n\r\n\r\n\r\nThe next step will be to load our APK into our emulator.\r\n\r\n\r\n\r\nOur app shows up in our app\u2019s list:\r\n\r\n\r\n\r\nOpening the app gives a login screen. Let\u2019s input some fake data and see what we get:\r\n\r\n\r\n\r\nSeems the app is doing some checking for the email and password. At this point we can start analyzing the app\u2019s code. We can go straight into viewing smali code or we can use Bytecodeviewer.\r\n\r\nBy examining the code, we can see decompiled code in java. We immediately notice a function that takes an array of char as a parameter and returns an array of char. Inside that function we have an array of int\u2019s, which if we were to guess, is the encoded flag. We need to find where this function is being called from and the char array that is passed as an argument. In order to trace it back, we need to look for the onCreate function. This is the first callback when an Android application is started. If you recall from loading the app into the emulator, we saw a button so this leads us to believe a function handles the action of clicking it. Inside the onCreate function we see setOnClickListener. If we follow what is passed to setOnClickListener, it points to a class \u2018b\u2019 which has the function OnClick.\r\n\r\n\r\n\r\nThe onClick calls back to a function in CupsLogin. Since the code is slightly obfuscated and a bit hard to trace, we\u2019ll focus on key points in order to trace this. We noticed these two little functions:\r\n\r\n\r\n\r\n\r\n\r\nAssuming the check for the char \u2018@\u2019 and length check of 4, we can conclude that it is checking the email and\/or password. Tracing this back, we can see that is being used in private void m().\r\n\r\n\r\n\r\nInspecting that code inside that function reveals that the \u2018string\u2019 &amp; \u2018string2\u2019 is being passed to an object.\r\n\r\n\r\n\r\nThe object being created extends AsyncTask. According to Android\u2019s documentation on AsyncTask, when executed, it goes thru four steps.\r\n\r\nInside this class were some more checks in regards to chars. Analyzing the code, we see that doInBackground calls function \u2018a\u2019. Inside this function we see a call too:\r\n\r\n\r\n\r\nAnalyzing that function, we can see that it is doing checks and building an array of char and then passing it to a function. Let\u2019s see what values it expects.\r\n\r\nAfter spending time figuring out what char values are expected, we can statically determine a few values for the password:\r\nkey = [\u2018@\u2019, ?, ?, \u2018u\u2019, \u2018I\u2019, \u2018d\u2019, ?]\r\nFor the remaining chars, we can write a python script to brute force it. Don\u2019t forget to transpose the decoding function we found earlier into python. Below is a sample script to decode this.\r\ndef decode(key):\r\n\r\n   secret = [] #new char[66];\r\n   flag = [453, 431, 409, 342, 318, 293, 460, 273, 383, 369, 374, 466, 261, \r\n   380, 513, 267, 301, 266, 310, 437, 260, 325, 379, 333, 454, 350, 345, \r\n   460, 293, 303, 289, 290, 438, 373, 264, 309, 351]\r\n\r\n   key = bytearray(key)\r\n   kidx = 0\r\n   for f in flag:\r\n       t = f - 2\r\n       t = ((key[kidx] - 19 + 86) ^ t) &gt;&gt; 2\r\n       secret.append(t)\r\n       kidx = kidx + 1\r\n       if kidx == len(key):\r\n           kidx = 0\r\n\r\n   return secret\r\n\r\ndef char2enum():\r\n   x =[]\r\n   for a in range(32,127):\r\n       t = a &amp; 0xf ^ a\r\n       if t == 96:\r\n           x.append(a)\r\n\r\n   return x\r\n\r\ndef char1_6enum():\r\n   chars = []\r\n   for a in range(32,127):\r\n       for b in range(32,127):\r\n           if a ^ b == 21:\r\n               if [chr(a),chr(b)] in chars:\r\n                   continue\r\n               chars.append([chr(a),chr(b)])\r\n\r\n   return chars\r\n\r\n\r\nchar2 = char2enum()\r\nchar16 = char1_6enum()\r\n\r\nkey  = ['@', ' ', ' ', 'u', 'i', 'd', ' ']\r\n\r\nfor c1 in char2:\r\n   for c in char16:\r\n       key[2] = c1\r\n       key[1] = c[0]\r\n       key[6] = c[1]\r\n       test = decode(key)\r\n       k = \"\".join(chr(k) for k in bytearray(key))\r\n       flg = \"\".join(chr(t) for t in test)\r\n       print \"%s:\\t%s\" % (k,flg)\r\n\r\nThis will generate about 1,500 different variations. We can then grep for lines that have \u2018PAN{\u2018 and that slims it down to 16. Interestingly enough, we get the flag with eight different keys.\r\n\r\n\r\n\r\nIf we enter any of the right combos in the app we get:\r\n\r\n\r\nPAN{da_cups_is_halfEmpty_||_halfFull}\r\n\r\nMobile 3 Challenge: This executable can be run on any of the 15 BEST phones in circulation!\r\nChallenge Created By: Josh Grunzweig @jgrunzweig\u00a0\r\n\r\nFor this particular challenge, users are given an application created for the Windows mobile platform. There are a couple of ways to go about solving this challenge; however, approaching it statically is probably the easiest versus setting up the Microsoft Windows mobile emulator or debugging the code on an actual phone. Should the user run the application in an emulated environment, they are presented with the following:\r\n\r\n\r\nFigure 1 Application running in emulated environment\r\nLooking at the provided binary, if we unzip the file two times, we\u2019re presented with the following files:\r\n\r\n\r\nFigure 2 Unzipped files from Windows mobile application\r\nThe executable in question is a .NET binary, which we can decompile using a program such as dnSpy. Looking at the underlying code, we can see that obfuscation has been implemented to make it more difficult to read and understand.\r\n\r\n\r\nFigure 3 Decompiled code in Windows mobile application\r\nStepping through the code and renaming functions along the way allows us to get an understanding of what is going on. The code performs the following:\r\n\r\n \tThe code checks to see if the SystemProductName is \u2018Virtual\u2019, indicating it is running within an emulator.\r\n \tA Boolean check is performed against a function that always returns True, which must be manually changed.\r\n \tThe screen resolution is checked to look for a width greater than 1000 and a height of 5.\r\n\r\nShould all of these conditions be met, the code execution will proceed. Otherwise, the user is presented with a response of \u2018Hounds Released!\u2019.\r\n\r\n\r\nFigure 4 One of the many error messages encountered\r\nIf the user makes it this far, the code will start looking at the provided user input to determine if the correct key is provided. The length of the key is first inspected. If the key does not have a length of 12, a random error message will be returned. However, should it have a length of 12, code execution proceeds. The code then makes the following checks:\r\n\r\n \tChecks to see if the SystemProductName starts with a \u2018V\u2019, which it should since our previous check was looking for \u2018Virtual\u2019. The 6th byte of this string (\u2018a\u2019) is stored to later be used in the key.\r\n \tThe first byte of the provided key is checked for an ordinal of 66, or the character \u2018B\u2019.\r\n \tThe embedded MrBurns.jpg file is loaded, and the 7th byte is read and later used in the key (\u2018J\u2019).\r\n \tThe SystemManufacturer is checked for a length of 5 and the last three characters of \u2018kia\u2019. Based on all possible manufacturers, we can conclude that this code is looking for a string of \u2018Nokia\u2019. The first two characters are stored to a variable and later used in the key (\u2018No\u2019).\r\n \tThe 2nd through 4th characters of the provided key are XORed against a key and checked for a result of \u2018DIE\u2019. Reversing this process allows us to conclude the application is looking for an inputted string of \u2018AdP\u2019 at bytes 2 through 4 of the provided key.\r\n \tThe 5th through 8th characters of the provided key are checked against a long embedded string, looking for a value of \u2018uzzl\u2019.\r\n \tThe same checks are performed against the 9th and 10th characters, looking for \u20183\u2019 and \u2018r\u2019 respectively.\r\n \tFinally, further checks are made against the last two bytes of the provided key, looking for \u2018!\u2019 and \u2018?\u2019.\r\n \tAn embedded Garbage.jpg is read and attempted to be decrypted against the provided key if all of these conditions are met.\r\n\r\nIn addition to everything encountered, various red herring code snippets are included to waste the reverser\u2019s time. Also, string obfuscation was used via the l1() and llll() functions, which unhex and XOR strings respectively. To make things slightly more difficult, function overloading is also used to make reversing a bit trickier.\r\n\r\nTaking everything learned, we can conclude that the application is looking for a key of length 12. The string of \u2018aNoJ\u2019 is then concatenated at the end. Based on the checks encountered, we can conclude that the provided key must be that of \u2018BAdPuzzl3r!?\u2019. Using this key gives us the following result:\r\n\r\n\r\nFigure 5 Key after using correct input string\r\nPAN{Th4t's_My_S3cr3t_N0boDy_Def34ts_th3_HOUNDS}\r\nMobile 4 Challenge: (walk or swipe) and (baby and you and cry)\r\nChallenge Created By: Juan Cortes @kongo_86\r\n\r\nFor this mobile challenge we are given an APK named \u2018Swip3r\u2019. As with the previous APK, we start our analysis by using apktool and load it up into our emulator to get an understanding of the application. We will use Android\u2019s adb tool to install the application. Below are screenshots highlighting these steps.\r\n\r\n\r\n(APK Tool)\r\n\r\n(adb install)\r\n\r\n(App icon in the emulator)\r\nWe continue by doing a basic dynamic analysis of the application. This gives us a better understanding of what the challenge may require in order to be solved. The app launches with a button that says \u201cGive me the child\u201d. Clicking it changes the screen to the character \u2018Jared\u2019 with \u201cYour eyes can se so cruel\u2026\u201d on the bottom of the screen. Clicking on the screen doesn\u2019t appear to do anything. As the name of the APK suggest, if we swipe we see that the screen changes to a baby crying with the text \u201c0oo0oopps!: 1\u201d. If we continue swiping the screen in a different direction, we see the text \u201c\u201c0oo0oopps: 2\u201d. Once again swiping increases that number after the text. So it appears that the app tracks the number of times we swipe and as it suggests we are doing something wrong.\r\n\r\n\r\n(Starting the app)\r\n\r\n(Jared appears)\r\n\r\n(Crying baby)\r\nAt this point, we have some understanding of the app due to our dynamic analysis. Let\u2019s perform a static analysis of the APK structure and see if we find anything interesting.\r\n\r\nThe AndroidManifest.xml, while an important file for APK analysis, reveals nothing interesting in this particular app\u2019s manifest. However, if we go into the lib folder, we see the following two folders and each of them holds a native library: \u201clibswiipiin.so\u201d. My guess is this is not your typical android library and is a custom library.\r\n\r\n\r\n(Libraries)\r\nAt this point, we can either load the library on IDA or attempt to decompile the APK\u2019s code using Bytecode Viewer. Why not both?\r\n\r\nLet\u2019s start with looking at the decompiled Java code. The application only has two classes: MainActivity.class &amp; Swip3r.class. The Swip3r class is rather small and we see that it sets the title and starts the activity \u2018MainActivity\u201d.\r\n\r\n\r\n(Swip3r.class)\r\nNow we\u2019ll examine the code in the MainActivity.class. We can quickly see the interesting strings we observed from our basic dynamic analysis. We see the app attempts to load the library: \u2018swiipiin\u2019. Lastly, at the end of the class file, we see two native methods being called: \u2018wel()\u2019 and \u2018well()\u2019. One which takes no parameters and the other takes eight parameters.\r\n\r\n\r\n(oops strings)\r\n\r\n(library loading)\r\n\r\n(Native Methods)\r\nAt this point we know that app uses the native library with the two native methods. We focus on finding where these two methods are being used and then moving to analyze the native library methods. The easy crude way is to just copy the decompiled code into Notepad++ and search for these native methods. We find that \u2018wel()\u2019 is used once in the OnCreate() method and \u2018well()\u2019 is used three times inside the onFling() method. Lastly, we can see that both methods after being called, returns a value that is being used to display text.\r\n\r\n\r\n(wel())\r\n\r\n\r\n(well())\r\n\r\nLet\u2019s switch over to IDA for a bit and examine the native library. Under exports we see the native methods we previously found in our decompiled Java code. Examining ARM assembly hurts my eyes more than looking at x86 assembly, but we will attempt to analyze these methods a bit. By looking at the code, we can tell that its loading a string \u201cYour eyes can se so cruel\u201d and then returns. If you remember, we saw this text when we loaded the app in our emulator. It coincides with the fact that this method, after being called, returns a value that is used as a string in displaying text. Looking at the other method \u2018well()\u2019 we can see it calls a function (Note: I have renamed this function) \u2018well_func1_F8C\u2019. Looking at that function and using IDA\u2019s \u2018Xrefs from\u2019 we see it calls ten other functions. If you look at those ten functions, most of them have a loop with some sort of bitwise operation, which tells me there is some decoding going on. As I mentioned previously, looking at ARM assembly is not as pleasant as x86. We take another approach and examine the decompiled Java code.\r\n\r\n\r\n(IDA Exports)\r\n\r\n(Xrefs)\r\n\r\n(Example Func Loop)\r\n\r\n(Example2 Func Loop)\r\nThe nice thing about ByteCode Viewer is that you get options from different Java decompilers. For example, if we focus on the \u2018OnFling()\u2019 method using JD-GUI decompiler, we get nasty nested while loops. If we choose Procyon decompiler, we get a nice set of nested IF...ELSE statements which is far better for reading the code. If you copy over the decompiled code to Notepad++, it makes it easier to collapse code and see a \u2018big picture\u2019 of what\u2019s going on.\r\n\r\n\r\n(Big picture)\r\nA quick Google search will help you understand what is the point of the OnFling() method as well as its parameters. This will help us understand what we need to do in order to simplify the completion of this challenge. At this point, we can break down the code looking at each IF and ELSE IF and determine what values are needed. Starting with the first set of conditional statements we see that the code is checking the values from motionEvent.getY(), motionEvent.getX(), motionEvent2.getY(), motionEvent2.getX(). These values are used to detect a motion on a screen on using the X and Y axis, which in turn detect when the user moves UP, DOWN, LEFT, RIGHT. Inside each conditional statement we see that the app sets several int\u2019s with values that are checked throughout this OnFling() method. Knowing that we want the application to call the native method \u2018well()\u2019 we can begin analyzing what values should be set with the right swipe motions as well as stay away from the motions that set the values which calls the \u201c0oo0oopps!\u201d message. After studying the code, we can conclude that the right combination is: UP, LEFT, DOWN, RIGHT, UP. Enjoying a handful of Jared pictures the last image holds the key: PAN{jAr3d_sayz_'swwip3r_!NO!_swipp11nn'}\r\n\r\n\r\n(Begin)\r\n\r\n(UP)\r\n\r\n(LEFT)\r\n\r\n(DOWN)\r\n\r\n(RIGHT)\r\n\r\n(UP)\r\nQuick little easter-egg, if you notice the app has detection for a method \u2018onLongPress()\u2019. Hence if you hold down on the screen\u2019s emulator a nice little string comes on top of the screen. This appears to be base64, however is three different base64 strings, each of which decode to: https:\/\/goo.gl\/VgmUUy. This is a Google shortened URL which leads to a YouTube video of the Labyrinth song \u201cWithin you \u2013 David Bowie 1986.\u201d Unfortunately the Internet gods have since removed this video. Interestingly there were 26 clicks made to this URL all from different countries. Note: the real number is 27, since one click was done during testing. Get more information about the URL.\r\n\r\n\r\n(easter-egg)\r\n\r\n(url decoded)\r\nPAN{jAr3d_sayz_'swwip3r_!NO!_swipp11nn'}\r\nMobile 5 Challenge: Can you escape the labyrinth with your life?\r\nChallenge Created By: Jeff White @noottrak\r\n\r\nSimilar to the first iOS challenge, we\u2019re provided with the ARM compiled binary and a simulator version.\r\n\r\nLooking through the simulator folders we can see a lot of images with ominous names such as \u201cdeath_01.jpg\u201d, \u201ctunnel_01.jpg\u201d, and \u201cwin_01.jpg\u201d. If we load the binary into IDA and look at the strings, we see some interesting messages with \u201cLOSE\u201d, \u201cWIN\u201d, and the start of a URL.\r\n\r\n\r\n\r\nWe can also see multiple base64-encoded strings.\r\n\r\n\r\n\r\nPulling the base64-encoded strings out and decoding them shows they are reversed words and sentences.\r\nThe outside air washes over you.\r\nSunlight beams down and warms you.\r\nYou let out a sigh of relief.\r\nYou look back and the maze vanishes.\r\nStepping out of the maze, you live another day.\r\nA tear of joy streams down your face.\r\nThere was never any doubt of winning.\r\nYou chose...poorly.\r\nYour stomach feels like a pit, the last feeling you'll ever have.\r\nChills run down your spine as all of the air seeps out of the room.\r\nMommy?\r\nYou knew this was the wrong way...\r\nGulp..this is the end.\r\nDeath awaits you.\r\nYou pray for a quick death.\r\nYou peek around the right corner, the coast looks clear.\r\nYou quickly dive into the right tunnel.\r\nNoises of children echo from the right.\r\nA green mist rises from the tunnel.\r\nThis tunnel looks familiar, have you gone this way?\r\nYou feel a cold breath on your neck.\r\nThis tunnel looks promising...for the dead.\r\nYou scurry backwards, only to find a new room.\r\nThe sights of this room frieghten you.\r\nDoors begin to shut, but you quickly jump back.\r\nThe room fills with fog you think you went back.\r\nYou think best before moving forward, best to stay put.\r\nClaustrophobia is setting in.\r\nYou have a yearn for your mommy, but her ghost is all that's here.\r\nA light seems to beacon in the left tunnel.\r\nYou sprint to the door along the left.\r\nDid a shadow just cross the far door?\r\nEenie-meenie-minie-moe... giant trolls with no toes.\r\nIt feels warm in this direction.\r\nRunes begin to glow as you walk by.\r\nSmells of rotten flesh and fungus greet you.\r\nYou move forward to the next tunnel.\r\nA scream bellows from ahead, you run towards it.\r\nWhispers call you near.\r\nScratched arrows on the wall point forward.\r\nIs this the right way?\r\nYou step over corpses on your way.\r\nYou step silently ahead, listening to screams in the distance.\r\ndungeon\r\nlabyrinth\r\nevil\r\ncrystal\r\nhades\r\nbowie\r\nspace\r\ntreasure\r\nloot\r\nlost\r\nmaze\r\nsecret\r\n\r\nBased on the strings, it looks like the app is some kind of game so let\u2019s go ahead and boot it up in a simulator and see what it does before we dive in. For a quick and simple simulation, you can use the website appetize.io for iOS or APK simulation.\r\n\r\n\r\n\r\n&nbsp;\r\n\r\nUsing the arrow keys, we can navigate around the \u201cLabyrinth\u201d and see some of the base64-decoded strings on each screen.\r\n\r\n\r\n\r\nEventually we fail and get our \u201c***LOSE***\u201d message.\r\n\r\n\r\n\r\nResetting a few times, we eventually make our way out of the maze, which appears random since repeating the same steps would cause us to lose at different points.\r\n\r\n\r\n\r\nWhen you win, it says you have the \u201cHigh Score!\u201d and that you can submit your score to http:\/\/pansecretloot.com. After clicking submit though, we\u2019re presented with the below message.\r\n\r\n\r\n\r\nThe error message states that it was unable to resolve and \u201cno flag for you\u201d. Checking the domain pansecretloot.com, it indeed does not resolve so presumably this is what the message referred to. When I play the game again, we see it\u2019s using a different domain this time, http:\/\/panlostspace.com, which it states also cannot be resolved.\r\n\r\n\r\n\r\nPlaying through a couple of times, this pattern just continues to repeat.\r\nhttp:\/\/pansecretloot.com\r\nhttp:\/\/panlostspace.com\r\nhttp:\/\/panlootdungeon.com\r\nhttp:\/\/panlostlost.com\r\nhttp:\/\/pansecretdungeon.com\r\nhttp:\/\/pandungeonbowie.com\r\n\r\nIf you recall from our base64 encoded strings, after all of the messages being displayed in the game is a short list of single words.\r\ndungeon\r\nlabyrinth\r\nevil\r\ncrystal\r\nhades\r\nbowie\r\nspace\r\ntreasure\r\nloot\r\nlost\r\nmaze\r\nsecret\r\n\r\nYou can easily see the correlation. It appears that two of the words are being appended to \u201chttp:\/\/pan\u201d to build a domain. Smells DGAish to me! If this is the final list of 12 words, and we know they can be next to each other (lostlost), then it\u2019s just 12^2 for the combinations, which is easily generated and checked.\r\nwords = [\"dungeon\", \"labyrinth\", \"evil\", \"crystal\", \"hades\", \"bowie\", \"space\", \"treasure\", \"loot\", \"lost\", \"maze\", \"secret\"]\r\n\r\nfor i in words:\r\n\tcount = 0\r\n\twhile count &lt; len(words):\r\n\t\tprint \"pan\" + i + words[count] + \".com\"\r\n\t\tcount += 1\r\n\r\nIterating through the generated list and performing DNS lookups, we come across this gem.\r\nHost panbowietreasure.com not found: 3(NXDOMAIN)\r\nHost panbowieloot.com not found: 3(NXDOMAIN)\r\nHost panbowielost.com not found: 3(NXDOMAIN)\r\nHost panbowiemaze.com not found: 3(NXDOMAIN)\r\nHost panbowiesecret.com not found: 3(NXDOMAIN)\r\npanspacedungeon.com has address 52.43.46.197\r\nHost panspacelabyrinth.com not found: 3(NXDOMAIN)\r\nHost panspaceevil.com not found: 3(NXDOMAIN)\r\nHost panspacecrystal.com not found: 3(NXDOMAIN)\r\nHost panspacehades.com not found: 3(NXDOMAIN)\r\nHost panspacebowie.com not found: 3(NXDOMAIN)\r\nHost panspacespace.com not found: 3(NXDOMAIN)\r\n\r\nBrowsing to this domain, it just returns the string \u201cM4z3Cub3\".\r\n\r\n\r\n\r\nSo it seems the app is building domains from this wordlist but fails to progress because of resolution errors. What if we simply change our host lookup so that all of these domains resolve to the known live site?\r\n\r\nAppetize.io is great for quickly looking at an app, but it doesn\u2019t offer us anything in the way of debugging. Since I\u2019m not cool enough to have a physical iOS device that I can load this on, I\u2019ll need to figure out how to load this into a local simulator so that I can affect the domain resolution.\r\n\r\nThe next part was slightly confusing so I\u2019ll explain it here to hopefully make someone\u2019s life easier. Basically, if you create an Xcode project and run it on a simulator, it generates an .app file for that simulated device. If you right click on the .app file under Products in Xcode, you can open the folder that contains your file, then simply move over the .app included with this challenge. The directory path looks like this:\r\n\r\n\r\n\r\nThe directory \u201clabyREnth_mobile5-XXX\u201d is the project name and then the generated device ID that was created in Xcode for our simulated device. Loading our simulator, we see the app we copied over, along with our empty project app.\r\n\r\n\r\n\r\nNow that we have the app running locally, we\u2019ll modify our \/etc\/hosts file with all of the domains we enumerated and point them all to the IP we resolved for panspacedungeon.com.\r\n\r\n\r\n\r\nNext, we\u2019ll run our app and navigate the game until we trigger the win condition.\r\n\r\n\r\n\r\nSuccess!\r\n\r\n\r\n\r\nPAN{G3t_Sch1f7y}\r\nMobile 6 Challenge: This handheld is best handheld\r\nChallenge Created By: Richard Wartell @wartortell\u00a0\r\n\r\nFor this challenge we\u2019re handed a file with an extension of .86p. Not exactly a common extension and the file is only 2kb, so let\u2019s open it in a hex editor:\r\n\r\n\r\n\r\nImmediately we can see some strings that look interesting, but the first and most important is \u201c**TI86**\u201d. So maybe we\u2019re dealing with a TI86 assembly program? Let\u2019s try to find an emulator where we can run this.\r\n\r\nWabbitemu comes to the rescue here. Wabbitemu will allow us to run TI calculator assembly programs. Since this program is for a TI86 calculator, we install the TI86 ROM for the calculator. We can then load the program by opening OGMob.86p and running the following series of keys:\r\n2nd -&gt; CUSTOM -&gt; Asm( -&gt; ENTER -&gt; PRGM -&gt; NAMES -&gt; OGMob -&gt; )\r\nThis creates the line, Asm(OGMob), which is how you execute assembly programs on a TI86 calculator. When we execute the program, we get the following info:\r\n\r\n\r\n\r\nPlaying around with this by hitting some keys, it looks like the display changes based on key presses, but no matter what we keep getting back to a screen that says \u201cFAILURE\u201d. At this point, we need to start looking at this in a disassembler. Looking around for resources on reversing a TI86 binary, we find a decent blog post.\r\n\r\nHowever, loading at the suggested addresses here doesn\u2019t work, but playing around in the Wabbitemu debugger shows us that the binary needs to be loaded at 0xD6FD. We can figure this out simply from trial and error, getting the bytes to match up with what is showing up in our debugger.\r\n\r\nOnce this is loaded correctly, we can finally take a look at things in graph mode. The main graph of the program looks like this:\r\n\r\n\r\n\r\nHowever, we have a lot of function calls that don\u2019t seem to go anywhere in IDA, though they point to places in the debugger. So if we Google the addresses with TI86, we find this link about the constants. So it turns out that all of these are internal functions in calculator. By creating a new segment and storing our constants there, we can nicely label our IDB so that we can see what it\u2019s doing:\r\n\r\n\r\n\r\nNow we can finally put the pieces together and we see a lot of sequences that look like _getkey, compare, conditional branch. Finally, we\u2019re seeing the logic of what we saw before with entering keys and then seeing \u201cFAILURE\u201d. Presumably, if we enter the right key combination, we\u2019ll get the key for the challenge.\r\n\r\nIf we walk through the logic for the _getKey calls, and use the site we referenced earlier for our key constants, we get the following sequence:\r\n\r\nENTER CLEAR ( 8 6 7 - 5 3 0 9 )\r\n\r\nWhen we enter these in the right order, this is what our screen shows:\r\n\r\n\r\n\r\nWhich is the key:\r\n\r\nPAN{dis_C@1c's_Ju51_4_YOUZ?!?}\r\nBonus round:\r\nAs we were walking through those key presses, there is a large body of code that executes, and the screen changes every other key press. If we look at the data that code is referencing, we find it all pointing to constants and then using those constants to draw onto the screen. Each constant seems to be made up of 8 bytes based on the gaps:\r\n\r\n\r\n\r\nNothing really comes up if we look at these as just letters or numbers, for example, here are the first two of the 8 byte constants:\r\n\r\n\r\n\r\nBut, if we look at these in binary, something much more interesting pops up:\r\n01110111\u00a0 00100100\r\n01010101\u00a0 00100101\r\n01010101\u00a0 00110100\r\n01010101\u00a0 00110101\r\n01101111\u00a0 10101101\r\n01001000\u00a0 10101100\r\n01001000\u00a0 10100101\r\n01001000\u00a0 10100100\r\nThough not immediately obvious, if you step back from this, or convert it to white\/black space, this does in fact have the key for the challenge in it. The first two constants above contain the binary representation of an 8bit by 8bit sprite of the letters PAN. If we do this with all the constants, we\u2019ll get the full key from there.\r\n\r\n\r\n\r\nLeave a comment below to share your thoughts about these challenges. Be sure to also check out how other threat researchers solved these challenges:\r\nMobile 1\r\n\r\n \thttps:\/\/github.com\/gray-panda\/grayrepo\/tree\/master\/2016_labyREnth\/mob1_lastchance\r\n \thttps:\/\/github.com\/uafio\/git\/blob\/master\/scripts\/labyREnth-2016\/labyrenth-2016-mobile-1.txt\r\n\r\nMobile 2\r\n\r\n \thttps:\/\/github.com\/gray-panda\/grayrepo\/tree\/master\/2016_labyREnth\/mob2_cups\r\n \thttps:\/\/github.com\/uafio\/git\/blob\/master\/scripts\/labyREnth-2016\/labyrenth-2016-mobile-2.py\r\n\r\nMobile 3\r\n\r\n \thttps:\/\/github.com\/gray-panda\/grayrepo\/tree\/master\/2016_labyREnth\/mob3_watt\r\n \thttps:\/\/github.com\/uafio\/git\/blob\/master\/scripts\/labyREnth-2016\/labyrenth-2016-mobile-3.py\r\n\r\nMobile 4\r\n\r\n \thttps:\/\/github.com\/gray-panda\/grayrepo\/tree\/master\/2016_labyREnth\/mob4_swip3r\r\n \thttps:\/\/github.com\/uafio\/git\/blob\/master\/scripts\/labyREnth-2016\/labyrenth-2016-mobile-4.txt\r\n\r\nMobile 5\r\n\r\n \thttps:\/\/github.com\/gray-panda\/grayrepo\/tree\/master\/2016_labyREnth\/mob5_ioga\r\n \thttps:\/\/github.com\/uafio\/git\/blob\/master\/scripts\/labyREnth-2016\/labyrenth-2016-mobile-5.py\r\n\r\nMobile 6\r\n\r\n \thttps:\/\/github.com\/gray-panda\/grayrepo\/tree\/master\/2016_labyREnth\/mob6_ogmob\r\n \thttps:\/\/sketchy.website\/2016\/08\/16\/labyrenth-mobile-6-walkthrough\/\r\n \thttps:\/\/github.com\/uafio\/git\/blob\/master\/scripts\/labyREnth-2016\/labyrenth-2016-mobile-6.txt\r\n","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/blog.paloaltonetworks.com\/wp-content\/uploads\/2016\/09\/blog-web-banner-650x300.jpg","width":100,"height":46},"author":[{"@type":"Person","name":"Richard Wartell"},{"@type":"Person","name":"Jeff White"},{"@type":"Person","name":"Tyler Halfpop"},{"@type":"Person","name":"Juan Cortes"},{"@type":"Person","name":"Josh Grunzweig"}]}</script>		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/blog.paloaltonetworks.com\/wp-includes\/js\/wp-emoji-release.min.js"}};
			/*! This file is auto-generated */
			!function(e,a,t){var r,n,o,i,p=a.createElement("canvas"),s=p.getContext&&p.getContext("2d");function c(e,t){var a=String.fromCharCode;s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,e),0,0);var r=p.toDataURL();return s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,t),0,0),r===p.toDataURL()}function l(e){if(!s||!s.fillText)return!1;switch(s.textBaseline="top",s.font="600 32px Arial",e){case"flag":return!c([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])&&(!c([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!c([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]));case"emoji":return!c([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340])}return!1}function d(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(i=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},o=0;o<i.length;o++)t.supports[i[o]]=l(i[o]),t.supports.everything=t.supports.everything&&t.supports[i[o]],"flag"!==i[o]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[i[o]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(r=t.source||{}).concatemoji?d(r.concatemoji):r.wpemoji&&r.twemoji&&(d(r.twemoji),d(r.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='crayon-css'  href='https://blog.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://blog.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://blog.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://blog.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='contact-form-7-css'  href='https://blog.paloaltonetworks.com/wp-content/plugins/contact-form-7/includes/css/styles.css' type='text/css' media='all' />
<style id='contact-form-7-inline-css' type='text/css'>
.wpcf7 .wpcf7-recaptcha iframe {margin-bottom: 0;}.wpcf7 .wpcf7-recaptcha[data-align="center"] > div {margin: 0 auto;}.wpcf7 .wpcf7-recaptcha[data-align="right"] > div {margin: 0 0 0 auto;}
</style>
<link rel='stylesheet' id='dashicons-css'  href='https://blog.paloaltonetworks.com/wp-includes/css/dashicons.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://blog.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//blog.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//blog.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-menu-item-0-css'  href='//blog.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/menu-item/style.css' type='text/css' media='all' />
<link rel='stylesheet' id='sage/css-css'  href='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/styles/main.css' type='text/css' media='all' />
<script>if (document.location.protocol != "https:") {document.location = document.URL.replace(/^http:/i, "https:");}</script><script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/jquery-3.5.1.min.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/jquery-migrate-1.4.1.min.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/blog.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js'></script>
<link rel='https://api.w.org/' href='https://blog.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://blog.paloaltonetworks.com/?p=19938' />
<link rel="alternate" type="application/json+oembed" href="https://blog.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.paloaltonetworks.com%2F2016%2F09%2Funit42-labyrenth-capture-the-flag-ctf-mobile-track-solutions%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://blog.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.paloaltonetworks.com%2F2016%2F09%2Funit42-labyrenth-capture-the-flag-ctf-mobile-track-solutions%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:180,186,114,3,12,9,81,84,87,129,138,6,162;" />
  <script>var $ = jQuery;</script>
    <!-- Unit42 Scripts -->
  <script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  <!-- End Unit42 Scripts -->
<meta name="google-site-verification" content="G1onsZ_PNprWXTYsKyATpZKzp8IAJ1jlbavSwUDN5Uo" />
</head>
  <body data-rsssl=1 data-results-per-page="9" class="post-template-default single single-post postid-19938 single-format-standard unit42-labyrenth-capture-the-flag-ctf-mobile-track-solutions sidebar-primary">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <input type="hidden" id="searching" value=""/><header class="container-fluid container-blog sticky-top">
     
      <div class="pan-page-alert pan-page-alert-light">
    		<div class="pan-page-alert-text"><a href="https://www.paloaltonetworks.com/our-response-to-covid-19" data-page-track-value=":en_us: title :covid19" data-page-track="true">See our response to COVID-19</a></div>
    		<button type="button" class="pan-page-alert-close" aria-label="page alert close">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1 1L6 6M6 6L11 1M6 6L1 11M6 6L11 11" stroke="#727272" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
          </button>
		  </div>
    
	
      <div class="container-xl">
        <div class="row">
          <div class="col-logo">
            <a href="https://www.paloaltonetworks.com" class="nav-logo" nav-track="true" nav-track-breadcrumb="nav:logo" aria-label="paloaltonetworks">
              <svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M59.4806 4.69592C57.6725 4.69592 55.7941 5.18876 53.4694 6.43377L54.7609 9.62741C56.7798 8.50019 58.4474 8.00735 59.6687 8.00735C61.0542 8.00735 61.6648 8.52395 61.6648 9.20483V9.25133C61.6648 9.72143 61.2887 9.97974 60.3733 10.0738L58.777 10.238C54.7847 10.6606 53.1409 12.3985 53.1409 14.7934V14.9577C53.1409 17.2359 55.0192 19.0203 57.6725 19.0203C59.4197 19.0203 60.9374 18.2826 61.8601 16.9807L62.1577 18.7857H65.7739V10.5904C65.7739 6.71584 63.5432 4.69592 59.4806 4.69592ZM59.1283 15.8969C57.7903 15.8969 57.1559 15.3803 57.1559 14.5816V14.5351C57.1559 13.8305 57.5547 13.3139 59.0105 13.1031L59.6449 13.0091C60.5717 12.8799 61.141 12.7095 61.6648 12.3923V13.4317C61.6648 15.0052 60.6781 15.8969 59.1283 15.8969Z" fill="black" class="logo-text"></path>
                <path d="M25.4785 4.78994L20.8529 0.164276L16.2272 4.78994L18.5281 7.09192L6.92834 18.6917L11.554 23.3174L16.1797 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="#FA582D" class="logo-icon"></path>
                <path d="M11.6001 0.164063L0 11.7642L4.62603 16.3902L16.2262 4.79009L11.6001 0.164063Z" fill="#FA582D" class="logo-icon"></path>
                <path d="M27.7795 7.09215L16.1793 18.6923L20.8054 23.3183L32.4055 11.7182L27.7795 7.09215Z" fill="#FA582D" class="logo-icon"></path>
                <path d="M72.2314 0H68.1223V18.7857H72.2314V0Z" fill="black" class="logo-text"></path>
                <path d="M46.2362 4.69592C44.3681 4.69592 42.8679 5.52249 42.0424 6.81709L41.7283 4.93046H38.1121V23.4806H42.2211V17.051C43.0033 18.2567 44.4828 19.0193 46.2362 19.0193C49.5238 19.0193 52.2009 16.1077 52.2009 12.0916V11.6215C52.2009 7.60853 49.5238 4.69592 46.2362 4.69592ZM47.974 11.9759C47.974 14.0888 46.8705 15.6159 45.0387 15.6159C43.2068 15.6159 42.1033 14.0898 42.1033 11.9759V11.7414C42.1033 9.62741 43.2068 8.10137 45.0387 8.10137C46.8705 8.10137 47.974 9.62741 47.974 11.7414V11.9759Z" fill="black" class="logo-text"></path>
                <path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="black" class="logo-text"></path>
                <path d="M138.709 5.54211V5.47185C138.709 5.07304 138.404 4.79097 137.864 4.79097H136.924V6.9514H137.371V6.22299H137.867L138.24 6.9514H138.733L138.274 6.09694C138.553 6.01119 138.709 5.80248 138.709 5.54211ZM137.37 5.18979H137.863C138.145 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.144 5.82418 137.863 5.82418H137.37V5.18979Z" fill="black" class="logo-text"></path>
                <path d="M137.77 3.63997C136.502 3.63997 135.539 4.60292 135.539 5.87066C135.539 7.1384 136.502 8.10135 137.77 8.10135C139.037 8.10135 140 7.1384 140 5.87066C140 4.60292 139.037 3.63997 137.77 3.63997ZM137.77 7.79552C136.666 7.79552 135.868 6.99685 135.868 5.86963C135.868 4.7424 136.666 3.94373 137.77 3.94373C138.873 3.94373 139.672 4.7424 139.672 5.86963C139.672 6.99685 138.873 7.79552 137.77 7.79552Z" fill="black" class="logo-text"></path>
                <path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="black" class="logo-text"></path>
                <path d="M116.518 15.6159C115.321 15.6159 114.875 15.029 114.875 13.7613V8.10136H119.712V4.93148H114.875V1.76057L110.766 2.3712V14.159C110.766 17.3764 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="black" class="logo-text"></path>
                <path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="black" class="logo-text"></path>
                <path d="M81.2247 4.69592C77.0216 4.69592 74.0625 7.6075 74.0625 11.6236V12.0937C74.0625 16.1087 77.0216 19.0213 81.2247 19.0213C85.4278 19.0213 88.3869 16.1097 88.3869 12.0937V11.6236C88.3858 7.60853 85.4278 4.69592 81.2247 4.69592ZM84.159 11.9759C84.159 14.0888 83.0555 15.6159 81.2236 15.6159C79.3918 15.6159 78.2883 14.0898 78.2883 11.9759V11.7414C78.2883 9.62741 79.3918 8.10137 81.2236 8.10137C83.0555 8.10137 84.159 9.62741 84.159 11.7414V11.9759Z" fill="black" class="logo-text"></path>
                <path d="M98.0448 22.1168H99.0976L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0253 23.5312H99.0109V25.4964H98.0448V22.1168Z" fill="black" class="logo-text"></path>
                <path d="M102.816 22.1168H105.771L105.81 22.9372H103.826V23.4011H105.385V24.1491H103.826V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="black" class="logo-text"></path>
                <path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="black" class="logo-text"></path>
                <path d="M110.943 22.1168H112.024L112.574 24.4632H112.628L113.342 22.1168H114.333L115.032 24.4632H115.086L115.626 22.1168H116.66L115.771 25.4964H114.443L113.826 23.4589H113.797L113.168 25.4964H111.836L110.943 22.1168Z" fill="black" class="logo-text"></path>
                <path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.258 23.8071C120.258 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.915 24.7391 120.258 24.3909 120.258 23.8071Z" fill="black" class="logo-text"></path>
                <path d="M122.364 22.1168H124.334C125.232 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.45 24.2369 125.015 24.4105L125.816 25.4974H124.668L124.045 24.6089H123.378V25.4974H122.364V22.1168ZM124.203 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.203 22.933H123.377V23.8164H124.203Z" fill="black" class="logo-text"></path>
                <path d="M126.989 22.1168H128.003V23.3628H128.418L129.408 22.1168H130.548L130.553 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.003V25.4964H126.989V22.1168Z" fill="black" class="logo-text"></path>
                <path d="M131.402 25.2743V24.3475H131.407C131.972 24.6326 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3464 133.425 24.3031 132.701 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.913 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.387 22.84 132.952 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5405 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.953 25.5884C132.364 25.5884 131.895 25.4675 131.402 25.2743Z" fill="black" class="logo-text"></path>
              </svg>
            </a>
            <a href="https://blog.paloaltonetworks.com" class="nav-lockup active" >Blog</a>
          </div>
          <div class="col col-mobile">
            <button class="nav-toggle closed" id="nav-mobile-toggle">
              <svg class="menu-dashes open" width="21" height="16" viewBox="0 0 21 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <line x1="18.8125" y1="1.5" x2="1.5" y2="1.5" stroke="black" stroke-width="3" stroke-linecap="round"></line>
                <line x1="18.8125" y1="8" x2="1.5" y2="8" stroke="black" stroke-width="3" stroke-linecap="round"></line>
                <line x1="18.8125" y1="14.5" x2="1.5" y2="14.5" stroke="black" stroke-width="3" stroke-linecap="round"></line>
              </svg>
              <svg class="menu-x close" width="18" height="17" viewBox="0 0 18 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                <line x1="2.95117" y1="14.2207" x2="14.8534" y2="2.31847" stroke="black" stroke-width="3" stroke-linecap="round"></line>
                <line x1="1.5" y1="-1.5" x2="18.3323" y2="-1.5" transform="matrix(-0.707107 -0.707107 -0.707107 0.707107 14.998 16.3422)" stroke="black" stroke-width="3" stroke-linecap="round"></line>
              </svg>
                <span class="mobile-menu">Menu</span>
            </button>
          </div>
            <nav class="col col-navbar navbar" id="nav-mobile">
                <ul>
                    <li class="menu-item-home"><a href="https://blog.paloaltonetworks.com">Palo Alto Networks</a></li>
                                            
                    <li class="menu-item-object-net_sec_post">
                        <a href="https://blog.paloaltonetworks.com/network-security/">Network Security</a>
                    </li>
                    
                                            
                    <li class="menu-item-object-sase_post">
                        <a href="https://blog.paloaltonetworks.com/sase/">SASE</a>
                    </li>
                    
                                            
                    <li class="menu-item-object-cloud_sec_post">
                        <a href="https://blog.paloaltonetworks.com/prisma-cloud/">Cloud Native Security</a>
                    </li>
                    
                                            
                    <li class="menu-item-object-sec_ops_post">
                        <a href="https://blog.paloaltonetworks.com/security-operations/">Security Operations</a>
                    </li>
                    
                                        <li>
                <div class="search"  id="form-search">
                    <input type="text" name="search" autocomplete="off" id="postSearch1" placeholder="Search the Blog" />
                  
                    <button id="nav-search-open-toggle">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" >
                      <path d="M8.66675 15.3335C12.3487 15.3335 15.3335 12.3487 15.3335 8.66675C15.3335 4.9848 12.3487 2 8.66675 2C4.9848 2 2 4.9848 2 8.66675C2 12.3487 4.9848 15.3335 8.66675 15.3335Z" stroke="black" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path>
                      <path d="M18.0007 18.0001L13.3784 13.3778" stroke="black" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path>
                    </svg>
                  </button>
                  
                  <button id="nav-search-close-toggle">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" >
                      <line x1="2.95117" y1="14.2207" x2="14.8534" y2="2.31847" stroke="black" stroke-width="3" stroke-linecap="round"></line>
                      <line x1="1.5" y1="-1.5" x2="18.3323" y2="-1.5" transform="matrix(-0.707107 -0.707107 -0.707107 0.707107 14.998 16.3422)" stroke="black" stroke-width="3" stroke-linecap="round"></line>
                    </svg>
                  </button>
                  
                </div>
              </li>
                </ul>
                        </nav>
          
            
        </div>
      </div>
    </header>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/masonry/4.2.2/masonry.pkgd.min.js"></script>-->
<script type="text/javascript">
    var main_nav_active_class = '';
    var main_nav_menu_item_name = 'menu-item-home';
    var str_subscription = '<div class="container-fluid container-newsletter-signup" >\
    <div class="container-lg">\
        <div class="row no-gutters row-newsletter-signup">\
            <div class="col-12 col-md-5 col-newsletter-signup-header">\
                <h2>Get updates!</h2>\
                <p class="lead">Sign up to receive the latest news</p>\
            </div>\
            <div class="col-12 col-md-7 col-newsletter-signup-form">\
                <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate="" class="subscribe-form clearfix" name="Unit42_Subscribe" id="subscribe_form1">\
                    <input type="hidden" value="subscribe-unit42" name="FormName">\
    <input id="field14" type="hidden" name="Qualifying_Campaign__c" value="70170000000lBnb">\
                         <input type="hidden" value="1086" name="formid">\
                         <input type="hidden" value="531-OCS-018" name="munchkinId">\
                         <input type="hidden" value="19887" name="lpId">\
                         <input type="hidden" value="1086" name="formVid">\
                         <input type="hidden" name="mkto_opt-in" value="true">\
                <div class="row no-gutters row-newsletter-signup-input">\
                    <div class="col-10 col-sm-11 col-newsletter-signup-input">\
                        <input type="email" name="Email" placeholder="Enter your email" id="input-newsletter-signup" class="subscribe-field rounded business_email" autocomplete="off">\
                    </div>\
                    <div class="col-2 col-sm-1 col-newsletter-signup-button">\
                        <button type="submit" value="Subscribe" disabled="disabled">\
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12" fill="none">\
                            <path d="M1 6L14.3333 6" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\
                            <path d="M9.33301 1L14.333 6L9.33301 11" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\
                            </svg>\
                        </button>\
                    </div>\
                </div>\
                <div class="email_invalid_msg">Please enter a valid email.</div>\
                <div class="row row-legal-disclaimer">\
                    <div class="col-12 col-legal-disclaimer">\
                        <p class="legal-disclaimer">By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>\
                    </div>\
                </div>\
                <div class="row row-recatcha d-none" id="row-recatcha">\
                    <div class="col-12 col-recatcha text-sm-center">\
                        <div id="captcha_container" class="google-recapth"></div>\
                    </div>\
                </div>\
                </form>\
            </div>\
        </div>\
    </div>\
</div>';
</script>
<article class="container-feed-master " id="main-container">
   <!--<div class="container-fluid container-breadcrumb"  data-aos="fade-in">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="https://blog.paloaltonetworks.com">Palo Alto Networks</a></li>
			          </ol>
        </nav>
    </div>-->
    
    <div class="container-fluid container-feed-article">
      <div class="container-lg">
        <div class="row row-feed-filters article-container container-inner" data-aos="fade-in" >
            <h1 class="blog-title">LabyREnth Capture the Flag (CTF): Mobile Track Solutions</h1>
              <div class="col-xs-12 col-sm-6 col-md-8 col-lg-8 col-xl-9 pad-0">
                   <div class="tags-item">
                    <a href="https://blog.paloaltonetworks.com/category/events/">Events</a>                    
                    <a href="https://blog.paloaltonetworks.com/tag/ctf/" rel="tag">CTF</a><a href="https://blog.paloaltonetworks.com/tag/labyrenth/" rel="tag">LabyREnth</a><a href="https://blog.paloaltonetworks.com/tag/unit-42/" rel="tag">Unit 42</a>                  </div>
              </div>
              <div class="col-xs-12 col-sm-6 col-md-4 col-lg-4 col-xl-3 pad-0 mobile-links">
                   <ol class="react-items">
                    <li>
				
				
				11,559
			 people reacted</li>
                    <li class="line"></li>
                    <li>
                      <div class="metadata-likes ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'19938','like')">
                          <svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M4.74998 15.9999H2.49999C2.10217 15.9999 1.72064 15.8419 1.43934 15.5606C1.15803 15.2793 1 14.8977 1 14.4999V9.24995C1 8.85213 1.15803 8.4706 1.43934 8.18929C1.72064 7.90799 2.10217 7.74996 2.49999 7.74996H4.74998M9.99994 6.24997V3.24999C9.99994 2.65325 9.76289 2.08096 9.34094 1.65901C8.91898 1.23705 8.34669 1 7.74996 1L4.74998 7.74996V15.9999H13.2099C13.5717 16.004 13.9227 15.8772 14.1983 15.6429C14.474 15.4086 14.6557 15.0826 14.7099 14.7249L15.7449 7.97496C15.7775 7.75997 15.763 7.54047 15.7024 7.33165C15.6418 7.12283 15.5365 6.92968 15.3938 6.7656C15.2511 6.60151 15.0745 6.47041 14.8761 6.38138C14.6777 6.29234 14.4623 6.2475 14.2449 6.24997H9.99994Z" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                          </svg>
                          <span>1</span>
                      </div>
                    </li>
                  </ol>
              </div>
              <div class="container-lg author-desc-row">
                <div class="col-8 author-desc">
                  <div class="metadata-thumbnail" >
                                          <div class="metadata-thumbnail-author" style="background-image: url('https://blog.paloaltonetworks.com/wp-content/uploads/2017/05/unit42_400x400.jpg')">
                                          </div>      
                  </div>
                  <div class="metadata-author" >
                    <span class="author-name">By <a href="https://blog.paloaltonetworks.com/author/richard-wartell/" title="Posts by Richard Wartell" class="author url fn" rel="author">Richard Wartell</a>, <a href="https://blog.paloaltonetworks.com/author/jeff-white/" title="Posts by Jeff White" class="author url fn" rel="author">Jeff White</a>, <a href="https://blog.paloaltonetworks.com/author/tyler-halfpop/" title="Posts by Tyler Halfpop" class="author url fn" rel="author">Tyler Halfpop</a>, <a href="https://blog.paloaltonetworks.com/author/juan-cortes/" title="Posts by Juan Cortes" class="author url fn" rel="author">Juan Cortes</a> and <a href="https://blog.paloaltonetworks.com/author/josh-grunzweig/" title="Posts by Josh Grunzweig" class="author url fn" rel="author">Josh Grunzweig</a></span><br /> 
                      <time datetime="2016-09-29T20:15:59+00:00">September 29, 2016 at 1:15 PM</time><br />
                      25 min. read
                  </div>
                </div>
                <!--<div class="col-6 social-items">
                      <span class="links">
                        <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M4.28843 12.8112C4.28843 13.9855 3.32843 14.9375 2.1442 14.9375C0.959967 14.9375 0 13.9855 0 12.8112C0 11.6368 0.96 10.6848 2.14423 10.6848C3.32846 10.6848 4.28843 11.6368 4.28843 12.8112ZM10.1699 14.38C9.89019 9.2468 5.74406 5.13004 0.562199 4.85236C0.256339 4.83596 0 5.07967 0 5.38341V6.97945C0 7.25886 0.217299 7.49317 0.498449 7.5113C4.24282 7.75315 7.2442 10.7221 7.48858 14.4432C7.5069 14.722 7.74318 14.9375 8.0249 14.9375H9.63435C9.94068 14.9375 10.1864 14.6833 10.1699 14.38ZM14.9997 14.3896C14.7186 6.62601 8.41959 0.342913 0.552556 0.062845C0.250212 0.0520872 0 0.294304 0 0.594294V2.1903C0 2.47668 0.22885 2.70976 0.5174 2.72152C6.91848 2.9818 12.0562 8.07771 12.3187 14.4245C12.3305 14.7106 12.5655 14.9375 12.8544 14.9375H14.4638C14.7663 14.9375 15.0105 14.6894 14.9997 14.3896Z" fill="black"/>
                        </svg>
                      </span>
                      <span class="links">
                        <svg width="15" height="18" viewBox="0 0 15 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.7857 11.25C10.9286 11.25 10.1484 11.6016 9.57254 12.1781L6.28125 10.016C6.47879 9.35508 6.47879 8.64141 6.28125 7.98398L9.57254 5.82188C10.1484 6.39844 10.9286 6.75 11.7857 6.75C13.5603 6.75 15 5.23828 15 3.375C15 1.51172 13.5603 0 11.7857 0C10.0112 0 8.57143 1.51172 8.57143 3.375C8.57143 3.71953 8.62165 4.06406 8.71875 4.39102L5.42746 6.55312C4.85156 5.97656 4.07143 5.625 3.21429 5.625C1.43973 5.625 0 7.13672 0 9C0 10.8633 1.43973 12.375 3.21429 12.375C4.07143 12.375 4.85156 12.0234 5.42746 11.4469L8.71875 13.609C8.62165 13.9395 8.57143 14.2805 8.57143 14.625C8.57143 16.4883 10.0112 18 11.7857 18C13.5603 18 15 16.4883 15 14.625C15 12.7617 13.5603 11.25 11.7857 11.25ZM11.7857 1.6875C12.673 1.6875 13.3929 2.44336 13.3929 3.375C13.3929 4.30664 12.673 5.0625 11.7857 5.0625C10.8984 5.0625 10.1786 4.30664 10.1786 3.375C10.1786 2.44336 10.8984 1.6875 11.7857 1.6875ZM3.21429 10.6875C2.32701 10.6875 1.60714 9.93164 1.60714 9C1.60714 8.06836 2.32701 7.3125 3.21429 7.3125C4.10156 7.3125 4.82143 8.06836 4.82143 9C4.82143 9.93164 4.10156 10.6875 3.21429 10.6875ZM11.7857 16.3125C10.8984 16.3125 10.1786 15.5566 10.1786 14.625C10.1786 13.6934 10.8984 12.9375 11.7857 12.9375C12.673 12.9375 13.3929 13.6934 13.3929 14.625C13.3929 15.5566 12.673 16.3125 11.7857 16.3125Z" fill="black"/>
                        </svg>
                      </span>
                </div>-->
                <div class="col-4 social-items">
                  <div class="links">
                      <a href="http://feeds.feedburner.com/PaloAltoNetworks" target="_blank"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M4.28843 12.8112C4.28843 13.9855 3.32843 14.9375 2.1442 14.9375C0.959967 14.9375 0 13.9855 0 12.8112C0 11.6368 0.96 10.6848 2.14423 10.6848C3.32846 10.6848 4.28843 11.6368 4.28843 12.8112ZM10.1699 14.38C9.89019 9.2468 5.74406 5.13004 0.562199 4.85236C0.256339 4.83596 0 5.07967 0 5.38341V6.97945C0 7.25886 0.217299 7.49317 0.498449 7.5113C4.24282 7.75315 7.2442 10.7221 7.48858 14.4432C7.5069 14.722 7.74318 14.9375 8.0249 14.9375H9.63435C9.94068 14.9375 10.1864 14.6833 10.1699 14.38ZM14.9997 14.3896C14.7186 6.62601 8.41959 0.342913 0.552556 0.062845C0.250212 0.0520872 0 0.294304 0 0.594294V2.1903C0 2.47668 0.22885 2.70976 0.5174 2.72152C6.91848 2.9818 12.0562 8.07771 12.3187 14.4245C12.3305 14.7106 12.5655 14.9375 12.8544 14.9375H14.4638C14.7663 14.9375 15.0105 14.6894 14.9997 14.3896Z" fill="black"/>
                    </svg>
                    </a>
                  </div>
                  <div class="links">
                    <div class="dropdown dropup">
                      <a href="#!" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <svg width="15" height="18" viewBox="0 0 15 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.7857 11.25C10.9286 11.25 10.1484 11.6016 9.57254 12.1781L6.28125 10.016C6.47879 9.35508 6.47879 8.64141 6.28125 7.98398L9.57254 5.82188C10.1484 6.39844 10.9286 6.75 11.7857 6.75C13.5603 6.75 15 5.23828 15 3.375C15 1.51172 13.5603 0 11.7857 0C10.0112 0 8.57143 1.51172 8.57143 3.375C8.57143 3.71953 8.62165 4.06406 8.71875 4.39102L5.42746 6.55312C4.85156 5.97656 4.07143 5.625 3.21429 5.625C1.43973 5.625 0 7.13672 0 9C0 10.8633 1.43973 12.375 3.21429 12.375C4.07143 12.375 4.85156 12.0234 5.42746 11.4469L8.71875 13.609C8.62165 13.9395 8.57143 14.2805 8.57143 14.625C8.57143 16.4883 10.0112 18 11.7857 18C13.5603 18 15 16.4883 15 14.625C15 12.7617 13.5603 11.25 11.7857 11.25ZM11.7857 1.6875C12.673 1.6875 13.3929 2.44336 13.3929 3.375C13.3929 4.30664 12.673 5.0625 11.7857 5.0625C10.8984 5.0625 10.1786 4.30664 10.1786 3.375C10.1786 2.44336 10.8984 1.6875 11.7857 1.6875ZM3.21429 10.6875C2.32701 10.6875 1.60714 9.93164 1.60714 9C1.60714 8.06836 2.32701 7.3125 3.21429 7.3125C4.10156 7.3125 4.82143 8.06836 4.82143 9C4.82143 9.93164 4.10156 10.6875 3.21429 10.6875ZM11.7857 16.3125C10.8984 16.3125 10.1786 15.5566 10.1786 14.625C10.1786 13.6934 10.8984 12.9375 11.7857 12.9375C12.673 12.9375 13.3929 13.6934 13.3929 14.625C13.3929 15.5566 12.673 16.3125 11.7857 16.3125Z" fill="black"/>
                        </svg>
                      </a>

                      <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                        <div class="share-dropdown">
                          <p><strong>SHARE</strong></p>
                          <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fblog.paloaltonetworks.com%2F2016%2F09%2Funit42-labyrenth-capture-the-flag-ctf-mobile-track-solutions%2F" target="_blank">
                          <i class="fa fb-icon fa-facebook-official pop-up-icon" aria-hidden="true"></i></a>
                          
                          <a href="https://twitter.com/home?status=https%3A%2F%2Fblog.paloaltonetworks.com%2F2016%2F09%2Funit42-labyrenth-capture-the-flag-ctf-mobile-track-solutions%2F+-+LabyREnth+Capture+the+Flag+%28CTF%29%3A+Mobile+Track+Solutions" target="_blank"><i class="fa tw-icon fa-twitter pop-up-icon" aria-hidden="true"></i></a>
                          <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fblog.paloaltonetworks.com%2F2016%2F09%2Funit42-labyrenth-capture-the-flag-ctf-mobile-track-solutions%2F&title=LabyREnth+Capture+the+Flag+%28CTF%29%3A+Mobile+Track+Solutions&summary=&source=" target="_blank"><i class="fa lindn-icon fa-linkedin pop-up-icon" aria-hidden="true"></i></a>
                          <a href="//www.reddit.com/submit?url=https://blog.paloaltonetworks.com/2016/09/unit42-labyrenth-capture-the-flag-ctf-mobile-track-solutions/" target="_blank"><i class="fa blog-icon fa-stumbleupon-circle pop-up-icon" aria-hidden="true"></i></a>
                          
                          </div>                       
                        </div>
                      </div>
                    </div>
                </div>
              </div>
              <div class="entry-content article-description"><p>Welcome back to our blog series where we reveal the solutions to <a href="https://blog.paloaltonetworks.com/2016/07/unit42-announcing-the-labyrenth-capture-the-flag-ctf-challenge/">LabyREnth, the Unit 42 Capture the Flag (CTF)</a> challenge. We’ll be revealing the solutions to one challenge track per week. Next up, the Mobile track.</p>
<h3>Mobile 1 Challenge: This is your last chance, choose wisely!</h3>
<p><em>Challenge Created By: Jeff White </em><a href="https://twitter.com/noottrak"><em>@noottrak</em></a></p>
<p>We are given an iOS app for this challenge. When we run it in the emulator, we have some squares to touch. If we select a correct square it turns green, if we select a wrong one, it turns yellow; if we touch a wrong one again, it turns red and we lose.<span id="more-19938"></span></p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-1.png"><img class="aligncenter size-large wp-image-19941" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-1-500x450.png" alt="labyrenth_mobile-1" width="500" height="450" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-1-500x450.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-1-230x207.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-1-333x300.png 333w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-1-44x40.png 44w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-1.png 570w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>The goal is to turn all the squares green to win and get the flag. We could just play the game and get lucky, or we could try and reverse the program to obtain the key. If we open the binary in IDA we can browse through the functions and quickly find an interesting function that stands out. Specifically, one of them is moving a long array of bytes to incrementing offsets of RDX at the beginning of the function. If we push ‘R’ on each byte in IDA, we can see that the key is being moved.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-2.png"><img class="aligncenter size-large wp-image-19944" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-2.png" alt="labyrenth_mobile-2" width="357" height="395" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-2.png 357w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-2-230x254.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-2-271x300.png 271w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-2-36x40.png 36w" sizes="(max-width: 357px) 100vw, 357px" /></a></p>
<p style="text-align: left;">PAN{EZE_S41d_Th15_w4s_Ea5y}</p>
<h3>Mobile 2 Challenge: Multiple choice, you say?</h3>
<p><em>Challenge Created By: Juan Cortes </em><a href="https://twitter.com/kongo_86"><em>@kongo_86</em></a></p>
<p>We are given an APK file ‘EZfill.apk’. To start analyzing this we can either unzip it using a zip tool or use apktool so we can look at the resources, Manifest file, and the smali code. I prefer the apktool.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-3.png"><img class="aligncenter size-large wp-image-19947" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-3-500x267.png" alt="labyrenth_mobile-3" width="500" height="267" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-3-500x267.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-3-230x123.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-3-768x410.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-3-510x272.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-3-75x40.png 75w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-3.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Examining the AndroidManifest.xml file reveals this is a rather small APK with one main activity.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-4.png"><img class="aligncenter size-large wp-image-19950" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-4-500x117.png" alt="labyrenth_mobile-4" width="500" height="117" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-4-500x117.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-4-230x54.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-4-768x180.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-4-510x120.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-4-170x40.png 170w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-4.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>The next step will be to load our APK into our emulator.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-5.png"><img class="aligncenter size-large wp-image-19953" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-5-500x214.png" alt="labyrenth_mobile-5" width="500" height="214" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-5-500x214.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-5-230x99.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-5-768x329.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-5-510x219.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-5-93x40.png 93w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-5.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Our app shows up in our app’s list:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-6.png"><img class="aligncenter size-large wp-image-19956" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-6.png" alt="labyrenth_mobile-6" width="178" height="155" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-6.png 178w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-6-46x40.png 46w" sizes="(max-width: 178px) 100vw, 178px" /></a></p>
<p>Opening the app gives a login screen. Let’s input some fake data and see what we get:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-7.png"><img class="aligncenter size-large wp-image-19959" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-7.png" alt="labyrenth_mobile-7" width="390" height="638" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-7.png 390w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-7-230x376.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-7-183x300.png 183w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-7-24x40.png 24w" sizes="(max-width: 390px) 100vw, 390px" /></a></p>
<p>Seems the app is doing some checking for the email and password. At this point we can start analyzing the app’s code. We can go straight into viewing smali code or we can use <a href="http://bytecodeviewer.com/">Bytecodeviewer</a>.</p>
<p>By examining the code, we can see decompiled code in java. We immediately notice a function that takes an array of char as a parameter and returns an array of char. Inside that function we have an array of int’s, which if we were to guess, is the encoded flag. We need to find where this function is being called from and the char array that is passed as an argument. In order to trace it back, we need to look for the onCreate function. This is the first callback when an Android application is started. If you recall from loading the app into the emulator, we saw a button so this leads us to believe a function handles the action of clicking it. Inside the onCreate function we see setOnClickListener. If we follow what is passed to setOnClickListener, it points to a class ‘b’ which has the function OnClick.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-8.png"><img class="aligncenter size-large wp-image-19962" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-8-500x364.png" alt="labyrenth_mobile-8" width="500" height="364" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-8-500x364.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-8-230x167.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-8-412x300.png 412w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-8-55x40.png 55w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-8.png 515w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>The onClick calls back to a function in CupsLogin. Since the code is slightly obfuscated and a bit hard to trace, we’ll focus on key points in order to trace this. We noticed these two little functions:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-9.png"><img class="aligncenter size-large wp-image-19965" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-9-500x77.png" alt="labyrenth_mobile-9" width="500" height="77" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-9-500x77.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-9-230x35.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-9-510x78.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-9-240x37.png 240w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-9.png 553w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-10.png"><img class="aligncenter size-large wp-image-19968" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-10-500x72.png" alt="labyrenth_mobile-10" width="500" height="72" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-10-500x72.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-10-230x33.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-10-510x73.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-10-240x34.png 240w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-10.png 571w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Assuming the check for the char ‘@’ and length check of 4, we can conclude that it is checking the email and/or password. Tracing this back, we can see that is being used in private void m().</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-11.png"><img class="aligncenter size-large wp-image-19971" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-11-500x146.png" alt="labyrenth_mobile-11" width="500" height="146" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-11-500x146.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-11-230x67.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-11-768x224.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-11-510x149.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-11-137x40.png 137w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-11.png 834w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Inspecting that code inside that function reveals that the ‘string’ &amp; ‘string2’ is being passed to an object.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-12.png"><img class="aligncenter size-large wp-image-19974" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-12-500x94.png" alt="labyrenth_mobile-12" width="500" height="94" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-12-500x94.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-12-230x43.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-12-510x96.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-12-213x40.png 213w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-12.png 665w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>The object being created extends AsyncTask. According to <a href="https://developer.android.com/reference/android/os/AsyncTask.html">Android’s documentation on AsyncTask</a>, when executed, it goes thru four steps.</p>
<p>Inside this class were some more checks in regards to chars. Analyzing the code, we see that doInBackground calls function ‘a’. Inside this function we see a call too:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-13.png"><img class="aligncenter size-large wp-image-19977" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-13.png" alt="labyrenth_mobile-13" width="469" height="526" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-13.png 469w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-13-230x258.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-13-267x300.png 267w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-13-36x40.png 36w" sizes="(max-width: 469px) 100vw, 469px" /></a></p>
<p>Analyzing that function, we can see that it is doing checks and building an array of char and then passing it to a function. Let’s see what values it expects.</p>
<p>After spending time figuring out what char values are expected, we can statically determine a few values for the password:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c6437ccd813154274" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
key = [‘@’, ?, ?, ‘u’, ‘I’, ‘d’, ?]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c6437ccd813154274-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c6437ccd813154274-1"><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span>‘<span class="crayon-sy">@</span>’<span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-sy">,</span><span class="crayon-h"> </span>‘<span class="crayon-i">u</span>’<span class="crayon-sy">,</span><span class="crayon-h"> </span>‘<span class="crayon-i">I</span>’<span class="crayon-sy">,</span><span class="crayon-h"> </span>‘<span class="crayon-i">d</span>’<span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>For the remaining chars, we can write a python script to brute force it. Don’t forget to transpose the decoding function we found earlier into python. Below is a sample script to decode this.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c6437cd6458110367" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def decode(key):

   secret = [] #new char[66];
   flag = [453, 431, 409, 342, 318, 293, 460, 273, 383, 369, 374, 466, 261, 
   380, 513, 267, 301, 266, 310, 437, 260, 325, 379, 333, 454, 350, 345, 
   460, 293, 303, 289, 290, 438, 373, 264, 309, 351]

   key = bytearray(key)
   kidx = 0
   for f in flag:
       t = f - 2
       t = ((key[kidx] - 19 + 86) ^ t) &gt;&gt; 2
       secret.append(t)
       kidx = kidx + 1
       if kidx == len(key):
           kidx = 0

   return secret

def char2enum():
   x =[]
   for a in range(32,127):
       t = a &amp; 0xf ^ a
       if t == 96:
           x.append(a)

   return x

def char1_6enum():
   chars = []
   for a in range(32,127):
       for b in range(32,127):
           if a ^ b == 21:
               if [chr(a),chr(b)] in chars:
                   continue
               chars.append([chr(a),chr(b)])

   return chars


char2 = char2enum()
char16 = char1_6enum()

key  = ['@', ' ', ' ', 'u', 'i', 'd', ' ']

for c1 in char2:
   for c in char16:
       key[2] = c1
       key[1] = c[0]
       key[6] = c[1]
       test = decode(key)
       k = "".join(chr(k) for k in bytearray(key))
       flg = "".join(chr(t) for t in test)
       print "%s:\t%s" % (k,flg)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-2">2</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-4">4</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-6">6</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-8">8</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-10">10</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-12">12</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-14">14</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-16">16</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-18">18</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-20">20</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-22">22</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-24">24</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-26">26</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-28">28</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-30">30</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-32">32</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-34">34</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-36">36</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-38">38</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-40">40</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-42">42</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-44">44</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-46">46</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-48">48</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-50">50</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-52">52</div><div class="crayon-num" data-line="crayon-5f694c6437cd6458110367-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cd6458110367-54">54</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c6437cd6458110367-1"><span class="crayon-e">def </span><span class="crayon-e">decode</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-2">&nbsp;</div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-3"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">secret</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-p">#new char[66];</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-4"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">flag</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">453</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">431</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">409</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">342</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">318</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">293</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">460</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">273</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">383</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">369</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">374</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">466</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">261</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-5"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">380</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">513</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">267</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">301</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">266</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">310</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">437</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">260</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">325</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">379</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">333</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">454</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">350</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">345</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-6"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">460</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">293</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">303</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">289</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">290</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">438</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">373</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">264</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">309</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">351</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-8"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">bytearray</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-9"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">kidx</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-10"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">flag</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">[</span><span class="crayon-v">kidx</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">19</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">86</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">secret</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">kidx</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">kidx</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">kidx</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">kidx</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-18"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">secret</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-20"><span class="crayon-e">def </span><span class="crayon-e">char2enum</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-21"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-22"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-cn">127</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xf</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-i">a</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">96</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-26">&nbsp;</div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-27"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">x</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-28">&nbsp;</div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-29"><span class="crayon-e">def </span><span class="crayon-e">char1_6enum</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-30"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-v">chars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-31"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-cn">127</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">b</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-cn">127</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-v">b</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">chars</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">chars</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-v">b</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-38"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">chars</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-40">&nbsp;</div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-41"><span class="crayon-v">char2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">char2enum</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-42"><span class="crayon-v">char16</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">char1_6enum</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-43">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-44"><span class="crayon-v">key</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'@'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'u'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'i'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'d'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-45">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-46"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">c1 </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">char2</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-47"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">char16</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">key</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">c1</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-49"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">key</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">key</span><span class="crayon-sy">[</span><span class="crayon-cn">6</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">decode</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">bytearray</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c6437cd6458110367-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">flg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cd6458110367-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"%s:\t%s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">,</span><span class="crayon-v">flg</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0030 seconds] -->
<p>This will generate about 1,500 different variations. We can then grep for lines that have ‘PAN{‘ and that slims it down to 16. Interestingly enough, we get the flag with eight different keys.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-14.png"><img class="aligncenter size-large wp-image-19980" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-14-500x289.png" alt="labyrenth_mobile-14" width="500" height="289" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-14-500x289.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-14-230x133.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-14-768x443.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-14-510x294.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-14-69x40.png 69w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-14.png 892w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>If we enter any of the right combos in the app we get:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-15.png"><img class="aligncenter size-large wp-image-19983" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-15-500x826.png" alt="labyrenth_mobile-15" width="500" height="826" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-15-500x826.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-15-230x380.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-15-182x300.png 182w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-15-24x40.png 24w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-15.png 568w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: left;">PAN{da_cups_is_halfEmpty_||_halfFull}</p>
<h3>Mobile 3 Challenge: This executable can be run on any of the 15 BEST phones in circulation!</h3>
<p><em>Challenge Created By: Josh Grunzweig </em><a href="https://twitter.com/jgrunzweig"><em>@jgrunzweig</em></a><em> </em></p>
<p>For this particular challenge, users are given an application created for the Windows mobile platform. There are a couple of ways to go about solving this challenge; however, approaching it statically is probably the easiest versus setting up the Microsoft Windows mobile emulator or debugging the code on an actual phone. Should the user run the application in an emulated environment, they are presented with the following:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-16_Figure-1.png"><img class="aligncenter size-large wp-image-19986" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-16_Figure-1.png" alt="labyrenth_mobile-16_figure-1" width="477" height="874" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-16_Figure-1.png 477w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-16_Figure-1-230x421.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-16_Figure-1-164x300.png 164w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-16_Figure-1-22x40.png 22w" sizes="(max-width: 477px) 100vw, 477px" /></a></p>
<p style="text-align: center;"><em>Figure 1 Application running in emulated environment</em></p>
<p>Looking at the provided binary, if we unzip the file two times, we’re presented with the following files:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-17_Figure-2.png"><img class="aligncenter size-large wp-image-19989" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-17_Figure-2-500x265.png" alt="labyrenth_mobile-17_figure-2" width="500" height="265" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-17_Figure-2-500x265.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-17_Figure-2-230x122.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-17_Figure-2-768x408.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-17_Figure-2-510x271.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-17_Figure-2-75x40.png 75w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-17_Figure-2.png 974w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: center;"><em>Figure 2 Unzipped files from Windows mobile application</em></p>
<p>The executable in question is a .NET binary, which we can decompile using a program such as <a href="https://github.com/0xd4d/dnSpy">dnSpy</a>. Looking at the underlying code, we can see that obfuscation has been implemented to make it more difficult to read and understand.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-18_Figure-3.png"><img class="aligncenter size-large wp-image-19992" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-18_Figure-3-500x267.png" alt="labyrenth_mobile-18_figure-3" width="500" height="267" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-18_Figure-3-500x267.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-18_Figure-3-230x123.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-18_Figure-3-768x410.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-18_Figure-3-510x273.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-18_Figure-3-75x40.png 75w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-18_Figure-3.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: center;"><em>Figure 3 Decompiled code in Windows mobile application</em></p>
<p>Stepping through the code and renaming functions along the way allows us to get an understanding of what is going on. The code performs the following:</p>
<ol>
<li>The code checks to see if the SystemProductName is ‘Virtual’, indicating it is running within an emulator.</li>
<li>A Boolean check is performed against a function that always returns True, which must be manually changed.</li>
<li>The screen resolution is checked to look for a width greater than 1000 and a height of 5.</li>
</ol>
<p>Should all of these conditions be met, the code execution will proceed. Otherwise, the user is presented with a response of ‘Hounds Released!’.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-19_Figure-4.png"><img class="aligncenter size-large wp-image-19995" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-19_Figure-4-500x272.png" alt="labyrenth_mobile-19_figure-4" width="500" height="272" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-19_Figure-4-500x272.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-19_Figure-4-230x125.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-19_Figure-4-510x277.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-19_Figure-4-74x40.png 74w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-19_Figure-4.png 548w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: center;"><em>Figure 4 One of the many error messages encountered</em></p>
<p>If the user makes it this far, the code will start looking at the provided user input to determine if the correct key is provided. The length of the key is first inspected. If the key does not have a length of 12, a random error message will be returned. However, should it have a length of 12, code execution proceeds. The code then makes the following checks:</p>
<ol>
<li>Checks to see if the SystemProductName starts with a ‘V’, which it should since our previous check was looking for ‘Virtual’. The 6th byte of this string (‘a’) is stored to later be used in the key.</li>
<li>The first byte of the provided key is checked for an ordinal of 66, or the character ‘B’.</li>
<li>The embedded MrBurns.jpg file is loaded, and the 7th byte is read and later used in the key (‘J’).</li>
<li>The SystemManufacturer is checked for a length of 5 and the last three characters of ‘kia’. Based on all possible manufacturers, we can conclude that this code is looking for a string of ‘Nokia’. The first two characters are stored to a variable and later used in the key (‘No’).</li>
<li>The 2<sup>nd </sup>through 4<sup>th</sup> characters of the provided key are XORed against a key and checked for a result of ‘DIE’. Reversing this process allows us to conclude the application is looking for an inputted string of ‘AdP’ at bytes 2 through 4 of the provided key.</li>
<li>The 5<sup>th</sup> through 8<sup>th</sup> characters of the provided key are checked against a long embedded string, looking for a value of ‘uzzl’.</li>
<li>The same checks are performed against the 9<sup>th</sup> and 10<sup>th</sup> characters, looking for ‘3’ and ‘r’ respectively.</li>
<li>Finally, further checks are made against the last two bytes of the provided key, looking for ‘!’ and ‘?’.</li>
<li>An embedded Garbage.jpg is read and attempted to be decrypted against the provided key if all of these conditions are met.</li>
</ol>
<p>In addition to everything encountered, various red herring code snippets are included to waste the reverser’s time. Also, string obfuscation was used via the l1() and llll() functions, which unhex and XOR strings respectively. To make things slightly more difficult, function overloading is also used to make reversing a bit trickier.</p>
<p>Taking everything learned, we can conclude that the application is looking for a key of length 12. The string of ‘aNoJ’ is then concatenated at the end. Based on the checks encountered, we can conclude that the provided key must be that of ‘BAdPuzzl3r!?’. Using this key gives us the following result:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-20_Figure-5.png"><img class="aligncenter size-large wp-image-19998" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-20_Figure-5-500x914.png" alt="labyrenth_mobile-20_figure-5" width="500" height="914" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-20_Figure-5-500x914.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-20_Figure-5-230x421.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-20_Figure-5-164x300.png 164w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-20_Figure-5-22x40.png 22w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-20_Figure-5.png 573w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: center;"><em>Figure 5 Key after using correct input string</em></p>
<p>PAN{Th4t&#8217;s_My_S3cr3t_N0boDy_Def34ts_th3_HOUNDS}</p>
<h3>Mobile 4 Challenge: (walk or swipe) and (baby and you and cry)</h3>
<p><em>Challenge Created By: Juan Cortes </em><a href="https://twitter.com/kongo_86"><em>@kongo_86</em></a></p>
<p>For this mobile challenge we are given an APK named ‘Swip3r’. As with the previous APK, we start our analysis by using apktool and load it up into our emulator to get an understanding of the application. We will use Android’s adb tool to install the application. Below are screenshots highlighting these steps.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-21.png"><img class="aligncenter size-large wp-image-20001" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-21-500x324.png" alt="labyrenth_mobile-21" width="500" height="324" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-21-500x324.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-21-230x149.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-21-768x498.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-21-463x300.png 463w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-21-62x40.png 62w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-21.png 853w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: center;">(APK Tool)</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-22.png"><img class="aligncenter size-large wp-image-20004" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-22-500x233.png" alt="labyrenth_mobile-22" width="500" height="233" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-22-500x233.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-22-230x107.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-22-768x358.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-22-510x237.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-22-86x40.png 86w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-22.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: center;">(adb install)</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-23.png"><img class="aligncenter size-large wp-image-20007" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-23.png" alt="labyrenth_mobile-23" width="196" height="374" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-23.png 196w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-23-157x300.png 157w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-23-21x40.png 21w" sizes="(max-width: 196px) 100vw, 196px" /></a></p>
<p style="text-align: center;">(App icon in the emulator)</p>
<p>We continue by doing a basic dynamic analysis of the application. This gives us a better understanding of what the challenge may require in order to be solved. The app launches with a button that says “Give me the child”. Clicking it changes the screen to the character ‘Jared’ with “Your eyes can se so cruel…” on the bottom of the screen. Clicking on the screen doesn’t appear to do anything. As the name of the APK suggest, if we swipe we see that the screen changes to a baby crying with the text “0oo0oopps!: 1”. If we continue swiping the screen in a different direction, we see the text ““0oo0oopps: 2”. Once again swiping increases that number after the text. So it appears that the app tracks the number of times we swipe and as it suggests we are doing something wrong.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-24.png"><img class="aligncenter size-large wp-image-20010" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-24.png" alt="labyrenth_mobile-24" width="275" height="432" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-24.png 275w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-24-230x361.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-24-191x300.png 191w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-24-25x40.png 25w" sizes="(max-width: 275px) 100vw, 275px" /></a></p>
<p style="text-align: center;">(Starting the app)</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-25.png"><img class="aligncenter size-large wp-image-20013" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-25.png" alt="labyrenth_mobile-25" width="421" height="500" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-25.png 421w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-25-230x273.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-25-253x300.png 253w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-25-34x40.png 34w" sizes="(max-width: 421px) 100vw, 421px" /></a></p>
<p style="text-align: center;">(Jared appears)</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-26.png"><img class="aligncenter size-large wp-image-20016" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-26.png" alt="labyrenth_mobile-26" width="345" height="440" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-26.png 345w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-26-230x293.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-26-235x300.png 235w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-26-31x40.png 31w" sizes="(max-width: 345px) 100vw, 345px" /></a></p>
<p style="text-align: center;">(Crying baby)</p>
<p>At this point, we have some understanding of the app due to our dynamic analysis. Let’s perform a static analysis of the APK structure and see if we find anything interesting.</p>
<p>The AndroidManifest.xml, while an important file for APK analysis, reveals nothing interesting in this particular app’s manifest. However, if we go into the lib folder, we see the following two folders and each of them holds a native library: “libswiipiin.so”. My guess is this is not your typical android library and is a custom library.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-27.png"><img class="aligncenter size-large wp-image-20019" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-27.png" alt="labyrenth_mobile-27" width="496" height="376" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-27.png 496w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-27-230x174.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-27-396x300.png 396w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-27-53x40.png 53w" sizes="(max-width: 496px) 100vw, 496px" /></a></p>
<p style="text-align: center;">(Libraries)</p>
<p>At this point, we can either load the library on IDA or attempt to decompile the APK’s code using Bytecode Viewer. Why not both?</p>
<p>Let’s start with looking at the decompiled Java code. The application only has two classes: MainActivity.class &amp; Swip3r.class. The Swip3r class is rather small and we see that it sets the title and starts the activity ‘MainActivity”.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-28.png"><img class="aligncenter size-large wp-image-20022" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-28-500x462.png" alt="labyrenth_mobile-28" width="500" height="462" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-28-500x462.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-28-230x213.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-28-325x300.png 325w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-28-43x40.png 43w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-28.png 609w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: center;">(Swip3r.class)</p>
<p>Now we’ll examine the code in the MainActivity.class. We can quickly see the interesting strings we observed from our basic dynamic analysis. We see the app attempts to load the library: ‘swiipiin’. Lastly, at the end of the class file, we see two native methods being called: ‘wel()’ and ‘well()’. One which takes no parameters and the other takes eight parameters.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-29.png"><img class="aligncenter size-large wp-image-20025" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-29-500x147.png" alt="labyrenth_mobile-29" width="500" height="147" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-29-500x147.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-29-230x68.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-29-768x226.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-29-510x150.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-29-136x40.png 136w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-29.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: center;">(oops strings)</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-30.png"><img class="aligncenter size-large wp-image-20028" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-30-500x135.png" alt="labyrenth_mobile-30" width="500" height="135" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-30-500x135.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-30-230x62.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-30-510x138.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-30-148x40.png 148w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-30.png 534w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: center;">(library loading)</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-31.png"><img class="aligncenter size-large wp-image-20031" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-31-500x58.png" alt="labyrenth_mobile-31" width="500" height="58" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-31-500x58.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-31-230x27.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-31-768x89.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-31-510x59.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-31-240x28.png 240w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-31.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: center;">(Native Methods)</p>
<p>At this point we know that app uses the native library with the two native methods. We focus on finding where these two methods are being used and then moving to analyze the native library methods. The easy crude way is to just copy the decompiled code into Notepad++ and search for these native methods. We find that ‘wel()’ is used once in the OnCreate() method and ‘well()’ is used three times inside the onFling() method. Lastly, we can see that both methods after being called, returns a value that is being used to display text.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-32.png"><img class="aligncenter size-large wp-image-20034" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-32-500x376.png" alt="labyrenth_mobile-32" width="500" height="376" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-32-500x376.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-32-230x173.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-32-399x300.png 399w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-32-53x40.png 53w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-32.png 759w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: center;">(wel())</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-33.png"><img class="aligncenter size-large wp-image-20037" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-33-500x376.png" alt="labyrenth_mobile-33" width="500" height="376" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-33-500x376.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-33-230x173.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-33-399x300.png 399w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-33-53x40.png 53w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-33.png 740w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>(well())</p>
<p>Let’s switch over to IDA for a bit and examine the native library. Under exports we see the native methods we previously found in our decompiled Java code. Examining ARM assembly hurts my eyes more than looking at x86 assembly, but we will attempt to analyze these methods a bit. By looking at the code, we can tell that its loading a string “Your eyes can se so cruel” and then returns. If you remember, we saw this text when we loaded the app in our emulator. It coincides with the fact that this method, after being called, returns a value that is used as a string in displaying text. Looking at the other method ‘well()’ we can see it calls a function (Note: I have renamed this function) ‘well_func1_F8C’. Looking at that function and using IDA’s ‘Xrefs from’ we see it calls ten other functions. If you look at those ten functions, most of them have a loop with some sort of bitwise operation, which tells me there is some decoding going on. As I mentioned previously, looking at ARM assembly is not as pleasant as x86. We take another approach and examine the decompiled Java code.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-34.png"><img class="aligncenter size-large wp-image-20040" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-34-500x99.png" alt="labyrenth_mobile-34" width="500" height="99" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-34-500x99.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-34-230x46.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-34-768x153.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-34-510x101.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-34-201x40.png 201w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-34.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: center;">(IDA Exports)</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-35.png"><img class="aligncenter size-large wp-image-20043" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-35-500x129.png" alt="labyrenth_mobile-35" width="500" height="129" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-35-500x129.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-35-230x59.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-35-768x198.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-35-510x131.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-35-155x40.png 155w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-35.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: center;">(Xrefs)</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-36.png"><img class="aligncenter size-large wp-image-20046" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-36-500x333.png" alt="labyrenth_mobile-36" width="500" height="333" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-36-500x333.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-36-230x153.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-36-451x300.png 451w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-36-60x40.png 60w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-36.png 684w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: center;">(Example Func Loop)</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-37.png"><img class="aligncenter size-large wp-image-20049" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-37-500x274.png" alt="labyrenth_mobile-37" width="500" height="274" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-37-500x274.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-37-230x126.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-37-510x280.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-37-73x40.png 73w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-37.png 759w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: center;">(Example2 Func Loop)</p>
<p>The nice thing about ByteCode Viewer is that you get options from different Java decompilers. For example, if we focus on the ‘OnFling()’ method using JD-GUI decompiler, we get nasty nested while loops. If we choose Procyon decompiler, we get a nice set of nested IF&#8230;ELSE statements which is far better for reading the code. If you copy over the decompiled code to Notepad++, it makes it easier to collapse code and see a ‘big picture’ of what’s going on.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-38.png"><img class="aligncenter size-large wp-image-20052" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-38-500x141.png" alt="labyrenth_mobile-38" width="500" height="141" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-38-500x141.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-38-230x65.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-38-768x217.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-38-510x144.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-38-142x40.png 142w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-38.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: center;">(Big picture)</p>
<p>A quick <a href="https://developer.android.com/reference/android/view/GestureDetector.OnGestureListener.html#onFling(android.view.MotionEvent,%20android.view.MotionEvent,%20float,%20float)">Google search</a> will help you understand what is the point of the <a href="https://developer.android.com/reference/android/view/GestureDetector.OnGestureListener.html#onFling(android.view.MotionEvent,%20android.view.MotionEvent,%20float,%20float)">OnFling() </a>method as well as its parameters. This will help us understand what we need to do in order to simplify the completion of this challenge. At this point, we can break down the code looking at each IF and ELSE IF and determine what values are needed. Starting with the first set of conditional statements we see that the code is checking the values from motionEvent.getY(), motionEvent.getX(), motionEvent2.getY(), motionEvent2.getX(). These values are used to detect a motion on a screen on using the X and Y axis, which in turn detect when the user moves UP, DOWN, LEFT, RIGHT. Inside each conditional statement we see that the app sets several int’s with values that are checked throughout this OnFling() method. Knowing that we want the application to call the native method ‘well()’ we can begin analyzing what values should be set with the right swipe motions as well as stay away from the motions that set the values which calls the “0oo0oopps!” message. After studying the code, we can conclude that the right combination is: UP, LEFT, DOWN, RIGHT, UP. Enjoying a handful of Jared pictures the last image holds the key: PAN{jAr3d_sayz_&#8217;swwip3r_!NO!_swipp11nn&#8217;}</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-39.png"><img class="aligncenter size-large wp-image-20055" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-39.png" alt="labyrenth_mobile-39" width="319" height="376" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-39.png 319w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-39-230x271.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-39-255x300.png 255w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-39-34x40.png 34w" sizes="(max-width: 319px) 100vw, 319px" /></a></p>
<p style="text-align: center;">(Begin)</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-40.png"><img class="aligncenter size-large wp-image-20058" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-40.png" alt="labyrenth_mobile-40" width="267" height="308" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-40.png 267w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-40-230x265.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-40-260x300.png 260w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-40-35x40.png 35w" sizes="(max-width: 267px) 100vw, 267px" /></a></p>
<p style="text-align: center;">(UP)</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-41.png"><img class="aligncenter size-large wp-image-20061" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-41.png" alt="labyrenth_mobile-41" width="250" height="299" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-41.png 250w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-41-230x275.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-41-33x40.png 33w" sizes="(max-width: 250px) 100vw, 250px" /></a></p>
<p style="text-align: center;">(LEFT)</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-42.png"><img class="aligncenter size-large wp-image-20064" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-42.png" alt="labyrenth_mobile-42" width="253" height="297" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-42.png 253w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-42-230x270.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-42-34x40.png 34w" sizes="(max-width: 253px) 100vw, 253px" /></a></p>
<p style="text-align: center;">(DOWN)</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-43.png"><img class="aligncenter size-large wp-image-20067" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-43-500x595.png" alt="labyrenth_mobile-43" width="500" height="595" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-43-500x595.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-43-230x274.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-43-252x300.png 252w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-43-34x40.png 34w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-43.png 505w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: center;">(RIGHT)</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-44.png"><img class="aligncenter size-large wp-image-20070" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-44-500x502.png" alt="labyrenth_mobile-44" width="500" height="502" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-44-500x502.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-44-100x100.png 100w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-44-230x231.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-44-299x300.png 299w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-44-40x40.png 40w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-44-32x32.png 32w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-44-64x64.png 64w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-44-96x96.png 96w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-44-128x128.png 128w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-44.png 646w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: center;">(UP)</p>
<p>Quick little easter-egg, if you notice the app has detection for a method ‘onLongPress()’. Hence if you hold down on the screen’s emulator a nice little string comes on top of the screen. This appears to be base64, however is three different base64 strings, each of which decode to: https://goo.gl/VgmUUy. This is a Google shortened URL which leads to a YouTube video of the Labyrinth song “Within you – David Bowie 1986.” Unfortunately the Internet gods have since removed this video. Interestingly there were 26 clicks made to this URL all from different countries. Note: the real number is 27, since one click was done during testing. <a href="https://goo.gl/#analytics/goo.gl/VgmUUy/all_time">Get more information about the URL.</a></p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-45.png"><img class="aligncenter size-large wp-image-20073" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-45-500x274.png" alt="labyrenth_mobile-45" width="500" height="274" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-45-500x274.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-45-230x126.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-45-510x280.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-45-73x40.png 73w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-45.png 534w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: center;">(easter-egg)</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-46.png"><img class="aligncenter size-large wp-image-20076" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-46-500x304.png" alt="labyrenth_mobile-46" width="500" height="304" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-46-500x304.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-46-230x140.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-46-493x300.png 493w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-46-66x40.png 66w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-46.png 528w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p style="text-align: center;">(url decoded)</p>
<p>PAN{jAr3d_sayz_&#8217;swwip3r_!NO!_swipp11nn&#8217;}</p>
<h3>Mobile 5 Challenge: Can you escape the labyrinth with your life?</h3>
<p><em>Challenge Created By: Jeff White </em><a href="https://twitter.com/noottrak"><em>@noottrak</em></a></p>
<p>Similar to the first iOS challenge, we’re provided with the ARM compiled binary and a simulator version.</p>
<p>Looking through the simulator folders we can see a lot of images with ominous names such as “death_01.jpg”, “tunnel_01.jpg”, and “win_01.jpg”. If we load the binary into IDA and look at the strings, we see some interesting messages with “LOSE”, “WIN”, and the start of a URL.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-47.png"><img class="aligncenter size-large wp-image-20079" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-47-500x232.png" alt="labyrenth_mobile-47" width="500" height="232" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-47-500x232.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-47-230x107.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-47-768x356.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-47-510x237.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-47-86x40.png 86w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-47.png 899w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>We can also see multiple base64-encoded strings.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-47.2.png"><img class="aligncenter size-large wp-image-20142" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-47.2-500x305.png" alt="labyrenth_mobile-47-2" width="500" height="305" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-47.2-500x305.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-47.2-230x140.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-47.2-768x468.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-47.2-492x300.png 492w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-47.2-66x40.png 66w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-47.2.png 902w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Pulling the base64-encoded strings out and decoding them shows they are reversed words and sentences.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c6437ce0112749815" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
The outside air washes over you.
Sunlight beams down and warms you.
You let out a sigh of relief.
You look back and the maze vanishes.
Stepping out of the maze, you live another day.
A tear of joy streams down your face.
There was never any doubt of winning.
You chose...poorly.
Your stomach feels like a pit, the last feeling you'll ever have.
Chills run down your spine as all of the air seeps out of the room.
Mommy?
You knew this was the wrong way...
Gulp..this is the end.
Death awaits you.
You pray for a quick death.
You peek around the right corner, the coast looks clear.
You quickly dive into the right tunnel.
Noises of children echo from the right.
A green mist rises from the tunnel.
This tunnel looks familiar, have you gone this way?
You feel a cold breath on your neck.
This tunnel looks promising...for the dead.
You scurry backwards, only to find a new room.
The sights of this room frieghten you.
Doors begin to shut, but you quickly jump back.
The room fills with fog you think you went back.
You think best before moving forward, best to stay put.
Claustrophobia is setting in.
You have a yearn for your mommy, but her ghost is all that's here.
A light seems to beacon in the left tunnel.
You sprint to the door along the left.
Did a shadow just cross the far door?
Eenie-meenie-minie-moe... giant trolls with no toes.
It feels warm in this direction.
Runes begin to glow as you walk by.
Smells of rotten flesh and fungus greet you.
You move forward to the next tunnel.
A scream bellows from ahead, you run towards it.
Whispers call you near.
Scratched arrows on the wall point forward.
Is this the right way?
You step over corpses on your way.
You step silently ahead, listening to screams in the distance.
dungeon
labyrinth
evil
crystal
hades
bowie
space
treasure
loot
lost
maze
secret</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-2">2</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-4">4</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-6">6</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-8">8</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-10">10</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-12">12</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-14">14</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-16">16</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-18">18</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-20">20</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-22">22</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-24">24</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-26">26</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-28">28</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-30">30</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-32">32</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-34">34</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-36">36</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-38">38</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-40">40</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-42">42</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-44">44</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-46">46</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-48">48</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-50">50</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-52">52</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce0112749815-54">54</div><div class="crayon-num" data-line="crayon-5f694c6437ce0112749815-55">55</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c6437ce0112749815-1"><span class="crayon-e">The </span><span class="crayon-e">outside </span><span class="crayon-e">air </span><span class="crayon-e">washes </span><span class="crayon-e">over </span><span class="crayon-v">you</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-2"><span class="crayon-e">Sunlight </span><span class="crayon-e">beams </span><span class="crayon-e">down </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-e">warms </span><span class="crayon-v">you</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-3"><span class="crayon-e">You </span><span class="crayon-e">let </span><span class="crayon-i">out</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-e">sigh </span><span class="crayon-e">of </span><span class="crayon-v">relief</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-4"><span class="crayon-e">You </span><span class="crayon-e">look </span><span class="crayon-e">back </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-e">the </span><span class="crayon-e">maze </span><span class="crayon-v">vanishes</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-5"><span class="crayon-e">Stepping </span><span class="crayon-e">out </span><span class="crayon-e">of </span><span class="crayon-e">the </span><span class="crayon-v">maze</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">you </span><span class="crayon-e">live </span><span class="crayon-e">another </span><span class="crayon-v">day</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-6"><span class="crayon-i">A</span><span class="crayon-h"> </span><span class="crayon-e">tear </span><span class="crayon-e">of </span><span class="crayon-e">joy </span><span class="crayon-e">streams </span><span class="crayon-e">down </span><span class="crayon-e">your </span><span class="crayon-v">face</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-7"><span class="crayon-e">There </span><span class="crayon-e">was </span><span class="crayon-e">never </span><span class="crayon-e">any </span><span class="crayon-e">doubt </span><span class="crayon-e">of </span><span class="crayon-v">winning</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-8"><span class="crayon-e">You </span><span class="crayon-v">chose</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-v">poorly</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-9"><span class="crayon-e">Your </span><span class="crayon-e">stomach </span><span class="crayon-e">feels </span><span class="crayon-i">like</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-v">pit</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">the </span><span class="crayon-e">last </span><span class="crayon-e">feeling </span><span class="crayon-i">you</span><span class="crayon-s">'ll ever have.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-10"><span class="crayon-s">Chills run down your spine as all of the air seeps out of the room.</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-11"><span class="crayon-s">Mommy?</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-12"><span class="crayon-s">You knew this was the wrong way...</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-13"><span class="crayon-s">Gulp..this is the end.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-14"><span class="crayon-s">Death awaits you.</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-15"><span class="crayon-s">You pray for a quick death.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-16"><span class="crayon-s">You peek around the right corner, the coast looks clear.</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-17"><span class="crayon-s">You quickly dive into the right tunnel.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-18"><span class="crayon-s">Noises of children echo from the right.</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-19"><span class="crayon-s">A green mist rises from the tunnel.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-20"><span class="crayon-s">This tunnel looks familiar, have you gone this way?</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-21"><span class="crayon-s">You feel a cold breath on your neck.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-22"><span class="crayon-s">This tunnel looks promising...for the dead.</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-23"><span class="crayon-s">You scurry backwards, only to find a new room.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-24"><span class="crayon-s">The sights of this room frieghten you.</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-25"><span class="crayon-s">Doors begin to shut, but you quickly jump back.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-26"><span class="crayon-s">The room fills with fog you think you went back.</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-27"><span class="crayon-s">You think best before moving forward, best to stay put.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-28"><span class="crayon-s">Claustrophobia is setting in.</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-29"><span class="crayon-s">You have a yearn for your mommy, but her ghost is all that'</span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-v">here</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-30"><span class="crayon-i">A</span><span class="crayon-h"> </span><span class="crayon-e">light </span><span class="crayon-e">seems </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">beacon </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">the </span><span class="crayon-e">left </span><span class="crayon-v">tunnel</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-31"><span class="crayon-e">You </span><span class="crayon-e">sprint </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">the </span><span class="crayon-e">door </span><span class="crayon-e">along </span><span class="crayon-e">the </span><span class="crayon-v">left</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-32"><span class="crayon-i">Did</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-e">shadow </span><span class="crayon-e">just </span><span class="crayon-e">cross </span><span class="crayon-e">the </span><span class="crayon-e">far </span><span class="crayon-v">door</span><span class="crayon-sy">?</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-33"><span class="crayon-v">Eenie</span><span class="crayon-o">-</span><span class="crayon-v">meenie</span><span class="crayon-o">-</span><span class="crayon-v">minie</span><span class="crayon-o">-</span><span class="crayon-v">moe</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">giant </span><span class="crayon-e">trolls </span><span class="crayon-e">with </span><span class="crayon-e">no </span><span class="crayon-v">toes</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-34"><span class="crayon-e">It </span><span class="crayon-e">feels </span><span class="crayon-e">warm </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-h"> </span><span class="crayon-v">direction</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-35"><span class="crayon-e">Runes </span><span class="crayon-e">begin </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">glow </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">you </span><span class="crayon-e">walk </span><span class="crayon-v">by</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-36"><span class="crayon-e">Smells </span><span class="crayon-e">of </span><span class="crayon-e">rotten </span><span class="crayon-e">flesh </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-e">fungus </span><span class="crayon-e">greet </span><span class="crayon-v">you</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-37"><span class="crayon-e">You </span><span class="crayon-e">move </span><span class="crayon-e">forward </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">the </span><span class="crayon-e">next </span><span class="crayon-v">tunnel</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-38"><span class="crayon-i">A</span><span class="crayon-h"> </span><span class="crayon-e">scream </span><span class="crayon-e">bellows </span><span class="crayon-e">from </span><span class="crayon-v">ahead</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">you </span><span class="crayon-e">run </span><span class="crayon-e">towards </span><span class="crayon-v">it</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-39"><span class="crayon-e">Whispers </span><span class="crayon-e">call </span><span class="crayon-e">you </span><span class="crayon-v">near</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-40"><span class="crayon-e">Scratched </span><span class="crayon-e">arrows </span><span class="crayon-e">on </span><span class="crayon-e">the </span><span class="crayon-e">wall </span><span class="crayon-e">point </span><span class="crayon-v">forward</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-41"><span class="crayon-st">Is</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-h"> </span><span class="crayon-e">the </span><span class="crayon-e">right </span><span class="crayon-v">way</span><span class="crayon-sy">?</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-42"><span class="crayon-e">You </span><span class="crayon-e">step </span><span class="crayon-e">over </span><span class="crayon-e">corpses </span><span class="crayon-e">on </span><span class="crayon-e">your </span><span class="crayon-v">way</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-43"><span class="crayon-e">You </span><span class="crayon-e">step </span><span class="crayon-e">silently </span><span class="crayon-v">ahead</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">listening </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">screams </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">the </span><span class="crayon-v">distance</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-44"><span class="crayon-e">dungeon</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-45"><span class="crayon-e">labyrinth</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-46"><span class="crayon-e">evil</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-47"><span class="crayon-e">crystal</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-48"><span class="crayon-e">hades</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-49"><span class="crayon-e">bowie</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-50"><span class="crayon-e">space</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-51"><span class="crayon-e">treasure</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-52"><span class="crayon-e">loot</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-53"><span class="crayon-e">lost</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce0112749815-54"><span class="crayon-e">maze</span></div><div class="crayon-line" id="crayon-5f694c6437ce0112749815-55"><span class="crayon-v">secret</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0019 seconds] -->
<p>Based on the strings, it looks like the app is some kind of game so let’s go ahead and boot it up in a simulator and see what it does before we dive in. For a quick and simple simulation, you can use the website appetize.io for iOS or APK simulation.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-48.png"><img class="aligncenter size-large wp-image-20082" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-48-500x1002.png" alt="labyrenth_mobile-48" width="500" height="1002" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-48-500x1002.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-48-230x461.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-48-150x300.png 150w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-48-20x40.png 20w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-48.png 611w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>&nbsp;</p>
<p>Using the arrow keys, we can navigate around the “Labyrinth” and see some of the base64-decoded strings on each screen.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-49.png"><img class="aligncenter size-large wp-image-20085" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-49-500x999.png" alt="labyrenth_mobile-49" width="500" height="999" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-49-500x999.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-49-230x460.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-49-150x300.png 150w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-49-20x40.png 20w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-49.png 627w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Eventually we fail and get our “***LOSE***” message.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-50.png"><img class="aligncenter size-large wp-image-20088" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-50-500x984.png" alt="labyrenth_mobile-50" width="500" height="984" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-50-500x984.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-50-230x452.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-50-153x300.png 153w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-50-20x40.png 20w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-50.png 640w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Resetting a few times, we eventually make our way out of the maze, which appears random since repeating the same steps would cause us to lose at different points.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-51.png"><img class="aligncenter size-large wp-image-20091" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-51-500x987.png" alt="labyrenth_mobile-51" width="500" height="987" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-51-500x987.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-51-230x454.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-51-152x300.png 152w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-51-20x40.png 20w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-51.png 638w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>When you win, it says you have the “High Score!” and that you can submit your score to <a href="http://pansecretloot.com">http://pansecretloot.com</a>. After clicking submit though, we’re presented with the below message.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-52.png"><img class="aligncenter size-large wp-image-20094" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-52-500x206.png" alt="labyrenth_mobile-52" width="500" height="206" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-52-500x206.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-52-230x95.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-52-768x317.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-52-510x210.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-52-97x40.png 97w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-52.png 769w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>The error message states that it was unable to resolve and “no flag for you”. Checking the domain pansecretloot.com, it indeed does not resolve so presumably this is what the message referred to. When I play the game again, we see it’s using a different domain this time, <a href="http://panlostspace.com">http://panlostspace.com</a>, which it states also cannot be resolved.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-53.png"><img class="aligncenter size-large wp-image-20097" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-53-500x991.png" alt="labyrenth_mobile-53" width="500" height="991" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-53-500x991.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-53-230x456.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-53-151x300.png 151w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-53-20x40.png 20w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-53.png 634w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Playing through a couple of times, this pattern just continues to repeat.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c6437ce6952500520" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
http://pansecretloot.com
http://panlostspace.com
http://panlootdungeon.com
http://panlostlost.com
http://pansecretdungeon.com
http://pandungeonbowie.com</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c6437ce6952500520-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce6952500520-2">2</div><div class="crayon-num" data-line="crayon-5f694c6437ce6952500520-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce6952500520-4">4</div><div class="crayon-num" data-line="crayon-5f694c6437ce6952500520-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce6952500520-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c6437ce6952500520-1"><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//pansecretloot.com</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce6952500520-2"><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//panlostspace.com</span></div><div class="crayon-line" id="crayon-5f694c6437ce6952500520-3"><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//panlootdungeon.com</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce6952500520-4"><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//panlostlost.com</span></div><div class="crayon-line" id="crayon-5f694c6437ce6952500520-5"><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//pansecretdungeon.com</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce6952500520-6"><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//pandungeonbowie.com</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>If you recall from our base64 encoded strings, after all of the messages being displayed in the game is a short list of single words.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c6437ce8074782046" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
dungeon
labyrinth
evil
crystal
hades
bowie
space
treasure
loot
lost
maze
secret</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c6437ce8074782046-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce8074782046-2">2</div><div class="crayon-num" data-line="crayon-5f694c6437ce8074782046-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce8074782046-4">4</div><div class="crayon-num" data-line="crayon-5f694c6437ce8074782046-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce8074782046-6">6</div><div class="crayon-num" data-line="crayon-5f694c6437ce8074782046-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce8074782046-8">8</div><div class="crayon-num" data-line="crayon-5f694c6437ce8074782046-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce8074782046-10">10</div><div class="crayon-num" data-line="crayon-5f694c6437ce8074782046-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ce8074782046-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c6437ce8074782046-1"><span class="crayon-e">dungeon</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce8074782046-2"><span class="crayon-e">labyrinth</span></div><div class="crayon-line" id="crayon-5f694c6437ce8074782046-3"><span class="crayon-e">evil</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce8074782046-4"><span class="crayon-e">crystal</span></div><div class="crayon-line" id="crayon-5f694c6437ce8074782046-5"><span class="crayon-e">hades</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce8074782046-6"><span class="crayon-e">bowie</span></div><div class="crayon-line" id="crayon-5f694c6437ce8074782046-7"><span class="crayon-e">space</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce8074782046-8"><span class="crayon-e">treasure</span></div><div class="crayon-line" id="crayon-5f694c6437ce8074782046-9"><span class="crayon-e">loot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce8074782046-10"><span class="crayon-e">lost</span></div><div class="crayon-line" id="crayon-5f694c6437ce8074782046-11"><span class="crayon-e">maze</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ce8074782046-12"><span class="crayon-v">secret</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>You can easily see the correlation. It appears that two of the words are being appended to “http://pan” to build a domain. Smells DGAish to me! If this is the final list of 12 words, and we know they can be next to each other (lostlost), then it’s just 12^2 for the combinations, which is easily generated and checked.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c6437cea275538174" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
words = ["dungeon", "labyrinth", "evil", "crystal", "hades", "bowie", "space", "treasure", "loot", "lost", "maze", "secret"]

for i in words:
	count = 0
	while count &lt; len(words):
		print "pan" + i + words[count] + ".com"
		count += 1</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c6437cea275538174-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cea275538174-2">2</div><div class="crayon-num" data-line="crayon-5f694c6437cea275538174-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cea275538174-4">4</div><div class="crayon-num" data-line="crayon-5f694c6437cea275538174-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437cea275538174-6">6</div><div class="crayon-num" data-line="crayon-5f694c6437cea275538174-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c6437cea275538174-1"><span class="crayon-v">words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"dungeon"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"labyrinth"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"evil"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"crystal"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"hades"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"bowie"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"space"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"treasure"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"loot"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"lost"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"maze"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"secret"</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cea275538174-2">&nbsp;</div><div class="crayon-line" id="crayon-5f694c6437cea275538174-3"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">words</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cea275538174-4"><span class="crayon-h">	</span><span class="crayon-v">count</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5f694c6437cea275538174-5"><span class="crayon-h">	</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">count</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">words</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437cea275538174-6"><span class="crayon-h">		</span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"pan"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">words</span><span class="crayon-sy">[</span><span class="crayon-v">count</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">".com"</span></div><div class="crayon-line" id="crayon-5f694c6437cea275538174-7"><span class="crayon-h">		</span><span class="crayon-v">count</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Iterating through the generated list and performing DNS lookups, we come across this gem.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c6437ceb957037620" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Host panbowietreasure.com not found: 3(NXDOMAIN)
Host panbowieloot.com not found: 3(NXDOMAIN)
Host panbowielost.com not found: 3(NXDOMAIN)
Host panbowiemaze.com not found: 3(NXDOMAIN)
Host panbowiesecret.com not found: 3(NXDOMAIN)
panspacedungeon.com has address 52.43.46.197
Host panspacelabyrinth.com not found: 3(NXDOMAIN)
Host panspaceevil.com not found: 3(NXDOMAIN)
Host panspacecrystal.com not found: 3(NXDOMAIN)
Host panspacehades.com not found: 3(NXDOMAIN)
Host panspacebowie.com not found: 3(NXDOMAIN)
Host panspacespace.com not found: 3(NXDOMAIN)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c6437ceb957037620-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ceb957037620-2">2</div><div class="crayon-num" data-line="crayon-5f694c6437ceb957037620-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ceb957037620-4">4</div><div class="crayon-num" data-line="crayon-5f694c6437ceb957037620-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ceb957037620-6">6</div><div class="crayon-num" data-line="crayon-5f694c6437ceb957037620-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ceb957037620-8">8</div><div class="crayon-num" data-line="crayon-5f694c6437ceb957037620-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ceb957037620-10">10</div><div class="crayon-num" data-line="crayon-5f694c6437ceb957037620-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694c6437ceb957037620-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c6437ceb957037620-1"><span class="crayon-e">Host </span><span class="crayon-v">panbowietreasure</span><span class="crayon-sy">.</span><span class="crayon-e">com </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">found</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">(</span><span class="crayon-v">NXDOMAIN</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ceb957037620-2"><span class="crayon-e">Host </span><span class="crayon-v">panbowieloot</span><span class="crayon-sy">.</span><span class="crayon-e">com </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">found</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">(</span><span class="crayon-v">NXDOMAIN</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c6437ceb957037620-3"><span class="crayon-e">Host </span><span class="crayon-v">panbowielost</span><span class="crayon-sy">.</span><span class="crayon-e">com </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">found</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">(</span><span class="crayon-v">NXDOMAIN</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ceb957037620-4"><span class="crayon-e">Host </span><span class="crayon-v">panbowiemaze</span><span class="crayon-sy">.</span><span class="crayon-e">com </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">found</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">(</span><span class="crayon-v">NXDOMAIN</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c6437ceb957037620-5"><span class="crayon-e">Host </span><span class="crayon-v">panbowiesecret</span><span class="crayon-sy">.</span><span class="crayon-e">com </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">found</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">(</span><span class="crayon-v">NXDOMAIN</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ceb957037620-6"><span class="crayon-v">panspacedungeon</span><span class="crayon-sy">.</span><span class="crayon-e">com </span><span class="crayon-e">has </span><span class="crayon-i">address</span><span class="crayon-h"> </span><span class="crayon-cn">52.43.46.197</span></div><div class="crayon-line" id="crayon-5f694c6437ceb957037620-7"><span class="crayon-e">Host </span><span class="crayon-v">panspacelabyrinth</span><span class="crayon-sy">.</span><span class="crayon-e">com </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">found</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">(</span><span class="crayon-v">NXDOMAIN</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ceb957037620-8"><span class="crayon-e">Host </span><span class="crayon-v">panspaceevil</span><span class="crayon-sy">.</span><span class="crayon-e">com </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">found</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">(</span><span class="crayon-v">NXDOMAIN</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c6437ceb957037620-9"><span class="crayon-e">Host </span><span class="crayon-v">panspacecrystal</span><span class="crayon-sy">.</span><span class="crayon-e">com </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">found</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">(</span><span class="crayon-v">NXDOMAIN</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ceb957037620-10"><span class="crayon-e">Host </span><span class="crayon-v">panspacehades</span><span class="crayon-sy">.</span><span class="crayon-e">com </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">found</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">(</span><span class="crayon-v">NXDOMAIN</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694c6437ceb957037620-11"><span class="crayon-e">Host </span><span class="crayon-v">panspacebowie</span><span class="crayon-sy">.</span><span class="crayon-e">com </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">found</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">(</span><span class="crayon-v">NXDOMAIN</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694c6437ceb957037620-12"><span class="crayon-e">Host </span><span class="crayon-v">panspacespace</span><span class="crayon-sy">.</span><span class="crayon-e">com </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">found</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">(</span><span class="crayon-v">NXDOMAIN</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p>Browsing to this domain, it just returns the string “M4z3Cub3&#8243;.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-54.png"><img class="aligncenter size-large wp-image-20100" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-54-500x174.png" alt="labyrenth_mobile-54" width="500" height="174" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-54-500x174.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-54-230x80.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-54-510x178.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-54-115x40.png 115w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-54.png 525w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>So it seems the app is building domains from this wordlist but fails to progress because of resolution errors. What if we simply change our host lookup so that all of these domains resolve to the known live site?</p>
<p>Appetize.io is great for quickly looking at an app, but it doesn’t offer us anything in the way of debugging. Since I’m not cool enough to have a physical iOS device that I can load this on, I’ll need to figure out how to load this into a local simulator so that I can affect the domain resolution.</p>
<p>The next part was slightly confusing so I’ll explain it here to hopefully make someone’s life easier. Basically, if you create an Xcode project and run it on a simulator, it generates an .app file for that simulated device. If you right click on the .app file under Products in Xcode, you can open the folder that contains your file, then simply move over the .app included with this challenge. The directory path looks like this:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-55.png"><img class="aligncenter size-large wp-image-20103" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-55-500x312.png" alt="labyrenth_mobile-55" width="500" height="312" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-55-500x312.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-55-230x144.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-55-481x300.png 481w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-55-64x40.png 64w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-55.png 742w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>The directory “labyREnth_mobile5-XXX” is the project name and then the generated device ID that was created in Xcode for our simulated device. Loading our simulator, we see the app we copied over, along with our empty project app.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-56.png"><img class="aligncenter size-large wp-image-20106" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-56-500x339.png" alt="labyrenth_mobile-56" width="500" height="339" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-56-500x339.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-56-230x156.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-56-768x520.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-56-443x300.png 443w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-56-59x40.png 59w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-56.png 774w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Now that we have the app running locally, we’ll modify our /etc/hosts file with all of the domains we enumerated and point them all to the IP we resolved for panspacedungeon.com.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-58.png"><img class="aligncenter size-large wp-image-20112" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-58-500x233.png" alt="labyrenth_mobile-58" width="500" height="233" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-58-500x233.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-58-230x107.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-58-768x359.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-58-510x238.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-58-86x40.png 86w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-58.png 844w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Next, we’ll run our app and navigate the game until we trigger the win condition.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-59.png"><img class="aligncenter size-large wp-image-20115" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-59-500x915.png" alt="labyrenth_mobile-59" width="500" height="915" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-59-500x915.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-59-230x421.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-59-164x300.png 164w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-59-22x40.png 22w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-59.png 738w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Success!</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-60.png"><img class="aligncenter size-large wp-image-20118" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-60-500x266.png" alt="labyrenth_mobile-60" width="500" height="266" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-60-500x266.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-60-230x122.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-60-510x271.png 510w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-60-75x40.png 75w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-60.png 761w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>PAN{G3t_Sch1f7y}</p>
<h3>Mobile 6 Challenge: This handheld is best handheld</h3>
<p><em>Challenge Created By: Richard Wartell </em><a href="https://twitter.com/wartortell"><em>@wartortell</em></a><em> </em></p>
<p>For this challenge we’re handed a file with an extension of .86p. Not exactly a common extension and the file is only 2kb, so let’s open it in a hex editor:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-61.png"><img class="aligncenter size-large wp-image-20121" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-61-500x468.png" alt="labyrenth_mobile-61" width="500" height="468" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-61-500x468.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-61-230x215.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-61-768x719.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-61-320x300.png 320w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-61-43x40.png 43w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-61.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Immediately we can see some strings that look interesting, but the first and most important is “**TI86**”. So maybe we’re dealing with a TI86 assembly program? Let’s try to find an emulator where we can run this.</p>
<p><a href="https://wabbit.codeplex.com/">Wabbitemu</a> comes to the rescue here. Wabbitemu will allow us to run TI calculator assembly programs. Since this program is for a TI86 calculator, we install the TI86 ROM for the calculator. We can then load the program by opening OGMob.86p and running the following series of keys:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694c6437cee469568528" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
2nd -&gt; CUSTOM -&gt; Asm( -&gt; ENTER -&gt; PRGM -&gt; NAMES -&gt; OGMob -&gt; )</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694c6437cee469568528-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694c6437cee469568528-1"><span class="crayon-cn">2nd</span><span class="crayon-h"> </span><span class="crayon-o">-&gt;</span><span class="crayon-h"> </span><span class="crayon-v">CUSTOM</span><span class="crayon-h"> </span><span class="crayon-o">-&gt;</span><span class="crayon-h"> </span><span class="crayon-e">Asm</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-o">-&gt;</span><span class="crayon-h"> </span><span class="crayon-v">ENTER</span><span class="crayon-h"> </span><span class="crayon-o">-&gt;</span><span class="crayon-h"> </span><span class="crayon-v">PRGM</span><span class="crayon-h"> </span><span class="crayon-o">-&gt;</span><span class="crayon-h"> </span><span class="crayon-v">NAMES</span><span class="crayon-h"> </span><span class="crayon-o">-&gt;</span><span class="crayon-h"> </span><span class="crayon-v">OGMob</span><span class="crayon-h"> </span><span class="crayon-o">-&gt;</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>This creates the line, Asm(OGMob), which is how you execute assembly programs on a TI86 calculator. When we execute the program, we get the following info:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-62.png"><img class="aligncenter size-large wp-image-20124" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-62.png" alt="labyrenth_mobile-62" width="370" height="807" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-62.png 370w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-62-230x502.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-62-138x300.png 138w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-62-18x40.png 18w" sizes="(max-width: 370px) 100vw, 370px" /></a></p>
<p>Playing around with this by hitting some keys, it looks like the display changes based on key presses, but no matter what we keep getting back to a screen that says “FAILURE”. At this point, we need to start looking at this in a disassembler. Looking around for resources on reversing a TI86 binary, we find a <a href="https://www.omnimaga.org/asm-language/ida-pro/">decent blog post</a>.</p>
<p>However, loading at the suggested addresses here doesn’t work, but playing around in the Wabbitemu debugger shows us that the binary needs to be loaded at 0xD6FD. We can figure this out simply from trial and error, getting the bytes to match up with what is showing up in our debugger.</p>
<p>Once this is loaded correctly, we can finally take a look at things in graph mode. The main graph of the program looks like this:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-63.png"><img class="aligncenter size-large wp-image-20127" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-63-500x587.png" alt="labyrenth_mobile-63" width="500" height="587" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-63-500x587.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-63-230x270.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-63-768x901.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-63-256x300.png 256w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-63-34x40.png 34w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-63.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>However, we have a lot of function calls that don’t seem to go anywhere in IDA, though they point to places in the debugger. So if we Google the addresses with TI86, we find this <a href="https://github.com/abbrev/ti-86-asm/blob/master/stranded/ti86asm.inc">link about the constants</a>. So it turns out that all of these are internal functions in calculator. By creating a new segment and storing our constants there, we can nicely label our IDB so that we can see what it’s doing:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-64.png"><img class="aligncenter size-large wp-image-20130" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-64-500x532.png" alt="labyrenth_mobile-64" width="500" height="532" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-64-500x532.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-64-230x245.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-64-768x817.png 768w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-64-282x300.png 282w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-64-38x40.png 38w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-64.png 975w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Now we can finally put the pieces together and we see a lot of sequences that look like _getkey, compare, conditional branch. Finally, we’re seeing the logic of what we saw before with entering keys and then seeing “FAILURE”. Presumably, if we enter the right key combination, we’ll get the key for the challenge.</p>
<p>If we walk through the logic for the _getKey calls, and use the site we referenced earlier for our key constants, we get the following sequence:</p>
<p>ENTER CLEAR ( 8 6 7 &#8211; 5 3 0 9 )</p>
<p>When we enter these in the right order, this is what our screen shows:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-65.png"><img class="aligncenter size-large wp-image-20133" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-65-500x1095.png" alt="labyrenth_mobile-65" width="500" height="1095" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-65-500x1095.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-65-230x504.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-65-137x300.png 137w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-65-18x40.png 18w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-65.png 514w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Which is the key:</p>
<p>PAN{dis_C@1c&#8217;s_Ju51_4_YOUZ?!?}</p>
<h3>Bonus round:</h3>
<p>As we were walking through those key presses, there is a large body of code that executes, and the screen changes every other key press. If we look at the data that code is referencing, we find it all pointing to constants and then using those constants to draw onto the screen. Each constant seems to be made up of 8 bytes based on the gaps:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-66.png"><img class="aligncenter size-large wp-image-20136" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-66-500x605.png" alt="labyrenth_mobile-66" width="500" height="605" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-66-500x605.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-66-230x278.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-66-248x300.png 248w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-66-33x40.png 33w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-66.png 680w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>Nothing really comes up if we look at these as just letters or numbers, for example, here are the first two of the 8 byte constants:</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-67.png"><img class="aligncenter size-large wp-image-20139" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-67-500x344.png" alt="labyrenth_mobile-67" width="500" height="344" srcset="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-67-500x344.png 500w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-67-230x158.png 230w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-67-436x300.png 436w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-67-58x40.png 58w, https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/LabyREnth_Mobile-67.png 748w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<p>But, if we look at these in binary, something much more interesting pops up:</p>
<p style="text-align: center;"><strong>01110111  00100100</strong></p>
<p style="text-align: center;"><strong>01010101  00100101</strong></p>
<p style="text-align: center;"><strong>01010101  00110100</strong></p>
<p style="text-align: center;"><strong>01010101  00110101</strong></p>
<p style="text-align: center;"><strong>01101111  10101101</strong></p>
<p style="text-align: center;"><strong>01001000  10101100</strong></p>
<p style="text-align: center;"><strong>01001000  10100101</strong></p>
<p style="text-align: center;"><strong>01001000  10100100</strong></p>
<p>Though not immediately obvious, if you step back from this, or convert it to white/black space, this does in fact have the key for the challenge in it. The first two constants above contain the binary representation of an 8bit by 8bit sprite of the letters PAN. If we do this with all the constants, we’ll get the full key from there.</p>
<p><a href="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Mobile.png"><img class="aligncenter wp-image-20469" src="https://blog.paloaltonetworks.com/wp-content/uploads/2016/09/CTF_Mobile.png" alt="ctf_mobile" width="500" height="146" /></a></p>
<p>Leave a comment below to share your thoughts about these challenges. Be sure to also check out how other threat researchers solved these challenges:</p>
<h3>Mobile 1</h3>
<ul>
<li><a href="https://github.com/gray-panda/grayrepo/tree/master/2016_labyREnth/mob1_lastchance">https://github.com/gray-panda/grayrepo/tree/master/2016_labyREnth/mob1_lastchance</a></li>
<li><a href="https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-mobile-1.txt">https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-mobile-1.txt</a></li>
</ul>
<h3>Mobile 2</h3>
<ul>
<li><a href="https://github.com/gray-panda/grayrepo/tree/master/2016_labyREnth/mob2_cups">https://github.com/gray-panda/grayrepo/tree/master/2016_labyREnth/mob2_cups</a></li>
<li><a href="https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-mobile-2.py">https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-mobile-2.py</a></li>
</ul>
<h3>Mobile 3</h3>
<ul>
<li><a href="https://github.com/gray-panda/grayrepo/tree/master/2016_labyREnth/mob3_watt">https://github.com/gray-panda/grayrepo/tree/master/2016_labyREnth/mob3_watt</a></li>
<li><a href="https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-mobile-3.py">https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-mobile-3.py</a></li>
</ul>
<h3>Mobile 4</h3>
<ul>
<li><a href="https://github.com/gray-panda/grayrepo/tree/master/2016_labyREnth/mob4_swip3r">https://github.com/gray-panda/grayrepo/tree/master/2016_labyREnth/mob4_swip3r</a></li>
<li><a href="https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-mobile-4.txt">https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-mobile-4.txt</a></li>
</ul>
<h3>Mobile 5</h3>
<ul>
<li><a href="https://github.com/gray-panda/grayrepo/tree/master/2016_labyREnth/mob5_ioga">https://github.com/gray-panda/grayrepo/tree/master/2016_labyREnth/mob5_ioga</a></li>
<li><a href="https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-mobile-5.py">https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-mobile-5.py</a></li>
</ul>
<h3>Mobile 6</h3>
<ul>
<li><a href="https://github.com/gray-panda/grayrepo/tree/master/2016_labyREnth/mob6_ogmob">https://github.com/gray-panda/grayrepo/tree/master/2016_labyREnth/mob6_ogmob</a></li>
<li><a href="https://sketchy.website/2016/08/16/labyrenth-mobile-6-walkthrough/">https://sketchy.website/2016/08/16/labyrenth-mobile-6-walkthrough/</a></li>
<li><a href="https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-mobile-6.txt">https://github.com/uafio/git/blob/master/scripts/labyREnth-2016/labyrenth-2016-mobile-6.txt</a></li>
</ul>
</div>
            </div>

        </div>       
    </div>
  </article>


<script type="text/javascript">
    $('body').on('mouseover', '.idc_ul_cont_not_liked_inner', function(e) {
          $(this).find('svg').children('path').attr('stroke','#FF2E00');
          //$(this).attr('src','https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/blue-like-icon.png');
      });
      $('body').on('mouseout', '.idc_ul_cont_not_liked_inner', function(e) {
          $(this).find('svg').children('path').attr('stroke','#000000');
          //$(this).attr('src','https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/grey-like-icon.png');
      });
      
    $(document).ready(function(){
        //Moving single post page subscribe box one paragraph above from last
        var cont_width = $(".entry-content").width();
        cont_width = Math.round(cont_width/2);//
        var p_tag_found = false;
        var child_count = $( ".entry-content").children().length;
        var last_p_tag = ''; //2nd p tag 
        var p_tag_traverse_cnt = 0;
        var p_arr = [];
        var next_tag_is_image_container = false;
        for(var i = 0; i < child_count ; i++){
            var p_el = $('.entry-content').children().eq(i);
            /*
            var tag_name = $(p_el).prop('tagName');
            if(tag_name != 'UL' || tag_name == 'P'){
                continue
            }
            */
            
              var temp_text = $(p_el).html();
              temp_text = temp_text.trim();
              
              
              var found_in_child = $( p_el ).find( "img, iframe, video, figure" );
                
              if(temp_text == '&nbsp;' || temp_text == ''){
                 continue;
              }
              else{
                  p_arr.push(p_el);
              }
        }
        console.log(p_arr);
        

        $.each(p_arr, function (index,value) {
            
            if(next_tag_is_image_container){
                next_tag_is_image_container = false;
                return;
            }
            
            var found_img1 = $(p_arr[index]).find( "img, iframe, video, figure" );//finding any image
            var found_txt1 = $(p_arr[index]).text().trim();
            if(found_img1.length != 0 && found_txt1 == ''){//if image exists inside paragraph, with no sibling text
                return;
            }
                
                var p_el = value;
                var current_tag_name = $(p_el).prop('tagName');
                if(current_tag_name == 'IMG' || current_tag_name == 'IFRAME' || current_tag_name == 'VIDEO' || current_tag_name == 'FIGURE'){
                    return;
                }
              
              
                  p_tag_traverse_cnt++;
                  var next_of_p = p_arr[index+1];
                  var next_tag = $(next_of_p).prop('tagName');
                  
                  
                  if(p_tag_traverse_cnt == 3){
                      //If next element is UL, then add subscription box after UL
                      
                      //if next element is image or video, add the box after 3rd paragraph
                      
                      if(next_tag == 'IMG' || next_tag == 'IFRAME' || next_tag == 'VIDEO' || next_tag == 'FIGURE'){
                          //Check if image is not right aligned
                          var img_width = $(next_of_p).width();
                          
                          if(img_width > cont_width){//If image is not right aligned
                              next_tag_is_image_container = true;
                                return;
                          }
                          
                          
                      }
                      //Check if image or video exist as a child element
                      var found_in_child = $( next_of_p ).find( "img, iframe, video, figure" );
                      //console.log(found_in_child[0].width);
                      //console.log(found_in_child);
                      if(found_in_child.length != 0){
                             var img_width = found_in_child[0].width;
                             console.log(img_width+" "+cont_width);
                          if(img_width > cont_width){//If image is not right aligned
                              next_tag_is_image_container = true;
                                return;
                          }
                          
                      }
                      
                      if(next_tag == 'UL' && current_tag_name != 'UL'){
                          last_p_tag = next_of_p;
                          return false;    
                      }
                      else{
                          last_p_tag = p_el;
                          return false;    
                      }
                      
                  }    
                  if(p_tag_traverse_cnt > 3){
                       //If next element is UL, then add subscription box after UL
                      if(next_tag == 'UL' && current_tag_name != 'UL'){
                          last_p_tag = next_of_p;
                          return false;     
                      }
                      else{
                          last_p_tag = p_el;
                          return false;   
                      }
                  }
              
        });
        
        
        if(last_p_tag != ''){
            $( last_p_tag ).after('<div style="clear:both;"></div>',$('.subscribe-form-inner'));
        }
        // $( ".entry-content p:last-child" ).before($('.subscribe-form-inner'));
        
    });
    $('a').each(function() {
        if(this.id == 'share_btn'){
            return;
        }
        var a = new RegExp('/' + window.location.host + '/');
        if(!a.test(this.href)) {
            $(this).click(function(event) {
                event.preventDefault();
                event.stopPropagation();
                window.open(this.href, '_blank');
            });
        }
     });
     $('.comment-form-cookies-consent input[type=checkbox]').prop('checked','checked');
     //$('.form-submit input[type=submit]').after( '<img class="ajax-loader" style="display:none;" src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/backgrounds/ajax-loader.gif" alt="Sending ...">' );
     //Hide manage subscription link
     
     if($('.subscribe-to-comments input[type=checkbox]').length == 0){
         $('.subscribe-to-comments').hide();
     }
     
          $('.form-submit input[type=submit]').attr('disabled',true);
          function enableCommentBtn(){
         $('.form-submit input[type=submit]').attr('disabled',false);
     }
     function disableCommentBtn(){
         $('.form-submit input[type=submit]').attr('disabled',true);
     }
    </script>
<div id="search-result-continer" style="display:none;min-height: 343px;">
    <!--<div id="search-result-heading" class="container-fluid container-breadcrumb"  data-aos="fade-in" style="display:none;">
       <div class="container-lg">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
              <li class="breadcrumb-item"><a href="https://blog.paloaltonetworks.com">Palo Alto Networks</a></li>
              <li class="breadcrumb-item search-term"></li>
          </ol>
        </nav>
       </div>
    </div>-->
    <div class="container-fluid container-feed-cards">
        <div class="container-lg">
            <div class="row row-feed">
                <div class="col col-feed">
                    
                    <div id="ajax_loader" class="text-center pb-40 pt-40">
                  <span>Loading...</span>
			</div>
      <div id="notfound2" class="text-center pt-40 pb-40" style="display: none;">Sorry, no results were found.</div>
      
                    <div class="row row-feed articles_container CoveoResultList" data-layout="list" data-wait-animation="fade" data-fields-to-include="@articlecategory, @articleauthor, @articlepublishedtime, @articlecategory, @articleauthorlink, @articledescription, @articlepostimage, @articlepublishedtimestring, @articleauthorimagelink, @articlepostid, @articlepostlength, @articlecategorylink, @uri" data-result-container-selector='#test_id' id="test_id">
                        <script id="customTemplate" type="text/underscore" class="result-template">
            <% JSON.stringify(raw) %>
              <article data-article-id="<% if(typeof raw.articlepostid !== "undefined") { print(raw.articlepostid); } %>" class="feed-card h-100 pan-coveo-search-list">
                <%if (typeof raw.articlepostimage =='undefined') { 
                    raw.articlepostimage = 'https://blog.paloaltonetworks.com/wp-content/uploads/2016/11/blog-generic-banner-1.jpg';
                 } %>
                        
                <%if (typeof raw.articlepostimage !='undefined') { %> 
                <div onclick="location.href='<%= raw.uri %>'" class="feed-card-thumbnail" style="background-image: url(<%= raw.articlepostimage %>);">
                <% if(typeof raw.articlepostid !== "undefined") { %>
                <!--<div class="total_number_view left-bottom"><span class="people-reacted<% if(typeof raw.articlepostid !== "undefined") { print(raw.articlepostid); } %>">#</span> people reacted</div>-->
                <% } %>
                  
                </div>
                <% } %>

                <div class="feed-card-content">
                <p class="label">
                <%  _.each(raw.articlecategory,function(item,key,list) { %> <a <% if(typeof raw.articlepostid == "undefined"){print(' target="_blank"');} %>  href="<% if(typeof raw.articleauthorimagelink !== "undefined"){ print(raw.articlecategorylink[key]); } else{ print("#");}  %>" class="author url fn" rel="author"><%= item %></a><%if (key+1 < raw.articlecategory.length) { %>,<%  } %><%  }); %>
                            </p>
                  <h3><a <% if(typeof raw.articlepostid == "undefined"){print(' target="_blank"');} %> class="CoveoResultLink"><% var title_article = title.substr(0,75); print(title_article); var title_length = title.length; if(title_length > 75){print("...")} %></a></h3>
                  </div>
                  
                  <div class="feed-card-metadata">
			<div class="metadata-thumbnail">
			<div class="metadata-thumbnail-author">
	  		<img src="<% if(typeof raw.articleauthorimagelink !== "undefined"){ var image_link = raw.articleauthorimagelink[0]; if(image_link.indexOf("unit42.paloaltonetworks.com") != -1 ){ print("https://blog.paloaltonetworks.com/wp-content/themes/PaloAltoNetworksBlog/dist/images/unit42-logo1.jpg");} else{ print(image_link);} }else{ print("https://blog.paloaltonetworks.com/wp-content/uploads/2016/10/Social_BlogIcon_10.13.16.png"); } %>" width="75" height="75" alt="Avatar" class="avatar avatar-75 wp-user-avatar wp-user-avatar-75 photo avatar-default">			</div>
		</div>
		
		<div class="metadata-author">
                    <span class="author-name">
				By <%  _.each(raw.articleauthor,function(item,key,list) { %> <a <% if(typeof raw.articlepostid == "undefined"){print(' target="_blank"');} %> title="Posts by <%= item %>" href="<%= raw.articleauthorlink[key] %>" class="author url fn" rel="author"><%= item %></a><%if (key+1 < raw.articleauthor.length) { %><%if (key+1 == raw.articleauthor.length-1) { %> and <% } else { %>,<% } } %><%  }); %>                        <br>
                        <time datetime="<%= raw.articlepublishedtimestring %>"><%= raw.articlepublishedtimestring %></time>
                        <br>
                       <% if(typeof raw.articlepostlength !== "undefined"){ print(Math.ceil(raw.articlepostlength/200) + " min. read"); } %>
                    
                    </span>
		</div>
    <div class="metadata-likes ldc-ul_cont idc_ul_cont_not_liked" onclick="<%  print("alter_ul_post_values(this,'"+ raw.articlepostid +"','like')"); %>">
        
        <svg class=" " width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M4.74998 15.9999H2.49999C2.10217 15.9999 1.72064 15.8419 1.43934 15.5606C1.15803 15.2793 1 14.8977 1 14.4999V9.24995C1 8.85213 1.15803 8.4706 1.43934 8.18929C1.72064 7.90799 2.10217 7.74996 2.49999 7.74996H4.74998M9.99994 6.24997V3.24999C9.99994 2.65325 9.76289 2.08096 9.34094 1.65901C8.91898 1.23705 8.34669 1 7.74996 1L4.74998 7.74996V15.9999H13.2099C13.5717 16.004 13.9227 15.8772 14.1983 15.6429C14.474 15.4086 14.6557 15.0826 14.7099 14.7249L15.7449 7.97496C15.7775 7.75997 15.763 7.54047 15.7024 7.33165C15.6418 7.12283 15.5365 6.92968 15.3938 6.7656C15.2511 6.60151 15.0745 6.47041 14.8761 6.38138C14.6777 6.29234 14.4623 6.2475 14.2449 6.24997H9.99994Z" stroke="#727272" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                                </svg>
                                <span class="<%  print("article-like-id"+raw.articlepostid);  %>"></span></span>
        
    </div>
	
</div>
              </article>
          </script>
          
                </div>     
                      <div class="col">
	
          <div class="loadmore text-center loadmore_main" style="display: none;">
      <button type="button" class="btn  load_more_btn" data-firstres="0">Load more</button>
    </div>
                    </div>
                      <div class="container" style="display: none;">
  
               

    <!-- Each DOM element with a class starting with "coveo-" (lowercase) is for CSS or alignment purpose only. -->
    <div class='coveo-search-section'>
      <div class="coveo-results-column">
        <!--selected breadcrumb-->
        <div class="CoveoBreadcrumb">
          <div class="coveo-breadcrumb-clear-all" title="Clear All Filters" tabindex="0">
            <div class="coveo-icon coveo-breadcrumb-icon-clear-all"></div>
            <div>Clear </div>
          </div>
        </div>
        <span class="CoveoSort coveo-sort-selection" data-sort-criteria="@articlepublishedtime descending" data-caption="Date"></span>
        <div class="coveo-results-header">
          <div class="coveo-summary-section">
            <span class="CoveoQuerySummary"></span>
          </div>
        </div>
      </div>
    </div>
                      </div>
      
          
            </div>
        </div>            
    </div>
</div>
</div>

<script type="text/javascript">
    document.write(str_subscription);
</script>
<section class="pan-mega-footer">
    <div class="container">
        <div class="row pan-mega-footer-links">
            <div class="col-xs-12 col-sm-4 col-md-3">
                <div class="footerTitle1 title baseComponent parbase">
                    <p>Popular Resources</p>
                </div>
                <div class="footerList1 list baseComponent parbase">
                    <ul class=" list-unstyled">
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Blog" href="https://blog.paloaltonetworks.com/">Blog</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Careers" href="https://jobs.paloaltonetworks.com/">Careers</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Communities" href="https://www.paloaltonetworks.com/communities">Communities</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Content Library" href="https://www.paloaltonetworks.com/resources">Content Library</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Cyberpedia" href="https://www.paloaltonetworks.com/cyberpedia">Cyberpedia</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Event Center" href="https://events.paloaltonetworks.com">Event Center</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Investors" href="https://investors.paloaltonetworks.com/investor-relations/overview/default.aspx">Investors</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Tech Docs" href="https://docs.paloaltonetworks.com/">Tech Docs</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Unit 42" href="https://unit42.paloaltonetworks.com/">Unit 42</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Popular Resources:Sitemap" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-xs-12 col-sm-4 col-md-3">
                <div class="footerTitle2 title baseComponent parbase">
                    <p>Legal Notices</p>
                </div>
                <div class="footerList2 list baseComponent parbase">
                    <ul class=" list-unstyled">
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Legal Notices:Privacy" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Legal Notices:Trust Center" href="https://www.paloaltonetworks.com/legal-notices/trust-center">Trust Center</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Legal Notices:Terms of Use" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a>
                        </li>
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Legal Notices:Documents" href="https://www.paloaltonetworks.com/legal">Documents</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-xs-12 col-sm-4 col-md-3">
                <div class="footerTitle3 title baseComponent parbase">
                    <p>Account</p>
                </div>
                <div class="footerList3 list baseComponent parbase">
                    <ul class=" list-unstyled">
                        <li>
                            <a class="" data-page-track="true" data-page-track-value="footer:Account:Manage Subscriptions" href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a>
                        </li>
                    </ul>
                </div>
                <div class="vulnerabilityHtml html baseComponent parbase">
                    <div style="margin-top: 30px">
                        <a href="https://www.paloaltonetworks.com/security-disclosure" style="color: #C63F24; font-family: Arial,sans-serif; font-size: 14px; font-style: normal; font-weight: normal; line-height: normal">Report a Vulnerability</a>
                    </div>
                </div>
            </div>
            <div class="col-xs-12 col-sm-12 col-md-3 footer-social-col">
                <div class="content">                
                    <ul class="list-inline">
                        <li class="list-inline-item">
                            <a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank"><img alt="Facebook" class="lozad" data-loaded="true" data-src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Facebook-black.svg" src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Facebook-black.svg"></a>
                        </li>
                        <li class="list-inline-item">
                            <a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank"><img alt="Linkedin" class="lozad" data-loaded="true" data-src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Linkedin-black.svg" src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Linkedin-black.svg"></a>
                        </li>
                        <li class="list-inline-item">
                            <a href="https://twitter.com/PaloAltoNtwks" target="_blank"><img alt="Twitter" class="lozad" data-loaded="true" data-src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Twitter-black.svg" src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Twitter-black.svg"></a>
                        </li>
                        <li class="list-inline-item">
                            <a href="https://www.youtube.com/user/paloaltonetworks" target="_blank"><img alt="Youtube" class="lozad" data-loaded="true" data-src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Youtube-black.svg" src="https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/svg/Youtube-black.svg"></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</section>
<footer class="pan-footer">
    <div class="container">
        <span><p>&copy; 2020 Palo Alto Networks, Inc. All rights reserved.<br></p>
        </span>
    </div>
</footer>
<div class="CoveoSearchbox" data-enable-search-as-you-type="false" data-enable-omnibox="true" data-omnibox-timeout="1000" data-placeholder="Search the blog" data-enable-query-suggest-addon="false" data-trigger-query-on-clear="true" id="pan-coveo-input" style="display: none;"></div>



<script type="text/javascript">
    jQuery('body').attr('data-pipeline', "New Research Center Pipeline");
    var timerIsCoveoDefined = '';
    var resultTotalCount;
    //var root = document.getElementById('coveo-container');
    var root = document.body;
    var isloadCoveoLibraryCalled = false;
    var screenwidth = window.screen.width;
    var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
    var topSearch = true;
    //Coveo code
    function loadCoveoLibrary() {
        if (isloadCoveoLibraryCalled) {
            return;
        }
        isloadCoveoLibraryCalled = true;
        $.getScript("https://static.cloud.coveo.com/searchui/v2.3679/js/CoveoJsSearch.Lazy.min.js");
        timerIsCoveoDefined = setInterval(isCoveoDefined, 1000);
    }
    function isCoveoDefined() {
        if (typeof Coveo !== 'undefined') {
            console.log("Coveo object is now defined.")
            executeCoveoSearch();
            clearInterval(timerIsCoveoDefined);
            $('#postSearch1, #postSearch2').attr('title', '');
            $('#postSearch1, #postSearch2').prop("readonly", false);
            $('.dropdown-menu a').css('pointer-events','auto');
        }
    }
    function executeCoveoSearch() {

        var settings = {
            "async": false,
            "url": "https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/coveosearch.getaccesstoken.php",
            //"url": "https://www.paloaltonetworks.com/apps/pan/public/coveosearch.getaccesstoken.json",
            "method": "GET",
        }


        jQuery.ajax(settings).done(function (response) {

            Coveo.SearchEndpoint.endpoints['default'] = new Coveo.SearchEndpoint({
                restUri: 'https://platform.cloud.coveo.com/rest/search',
                queryStringArguments: {
                    organizationId: 'paloaltonetworksintranet'                    
                },
                accessToken: response.token
            });
            Coveo.$$(root).on("querySuccess", function (e, data) {
                //console.log(data.query.q);
                if(!$('#searching').val()){
                    topSearch = false;
                }
                
                if(topSearch){
                    $([document.documentElement, document.body]).animate({
                        scrollTop: 0 
                    }, 1000);
                }
                
                if(topSearch){
                    $('nav.navbar li a.active').removeClass('active');
                }
                resultTotalCount = data.results.totalCount;
                //document.title = "Palo Alto Networks Blog";
                /*
                if(resultTotalCount > 0){
                    $('#search-result-heading .search-term').text(capitalizeFirstLetter(data.query.q));
                    $('#search-result-heading').show();
                }
                else{
                    $('#search-result-heading').hide();
                    $('#search-result-heading .search-term').text('');
                }
                */

            });
            Coveo.$$(root).on("newResultsDisplayed", function (e, args) {
                $('#ajax_loader').hide();
                $('#notfound2').hide();
                $('.load_more_btn').html('Load more');
                $('.load_more_btn').prop('disabled', false);
                $('.CoveoResult').addClass('col-xs-12 col-sm-6 col-md-6 col-lg-4 col-xl-4 col-feed-card grid-item');
                var article_ids = new Array();
                jQuery.each(jQuery('.pan-coveo-search-list'), function (i) {
                    var article_id_tmp = $(this).data("article-id");
                    if (article_id_tmp != '' && !jQuery(this).hasClass('num-like-retrieved')) {
                        article_ids.push(article_id_tmp);
                    }
                    if (article_id_tmp != '') {
                        //If this article is liked, make the thumb icon to blue
                        var article_liked_list = [];
                        var like_found = $.inArray(article_id_tmp, article_liked_list);
                        if (like_found != -1) {
                            $(this).find('.ldc-ul_cont').find('svg').children('path').attr('stroke', '#FF2E00');
                            $(this).find('.ldc-ul_cont').removeClass('idc_ul_cont_not_liked');
                        }
                    }
                });
                if (article_ids.length > 0) {
                    var saveData = $.ajax({
                        type: 'POST',
                        url: wp_vars.ajax_url,
                        data: {action: 'fetch_total_article_likes', article_ids_arr: JSON.stringify(article_ids)},
                        dataType: "json",
                        success: function (resultData) {
                            //var article_likes = JSON.parse(resultData);
                            jQuery.each(article_ids, function (i, val) {
                                $('.article-like-id' + val).text(resultData[val][0]);
                                //$('.people-reacted'+val).text(resultData[val][1]);
                                $('.article-like-id' + val).closest(".pan-coveo-search-list").addClass('num-like-retrieved');
                            });
                        }
                    });
                }
                //console.log($('.CoveoResult').length +'|'+ resultTotalCount);
                //console.log(Coveo.state(root, 'first'));
                if ($('.CoveoResult').length >= resultTotalCount) {
                    $('.load_more_btn').hide();
                } else {
                    $('.load_more_btn').show();
                }
                if (resultTotalCount <= 0) {
                    $('#notfound2').show();
                } else {
                    $('#notfound2').hide();
                }
                
                if (jQuery('.magic-box-input input').val() || $('.CoveoResult').length >= 1) {
                    if(topSearch){
                        jQuery('#main-container').hide();
                        $('#inner_cards').show();
                        jQuery('.loadmore_main2').hide();
                        jQuery('#search-result-continer').show();
                        jQuery('.loadmore_main').show();
                        $('#main-container .container-feed-cards .container-lg').removeAttr('style');
                        $('#search-result-continer .container-feed-cards .container-lg').removeAttr('style');
                    }
                    else{
                        jQuery('#main-container').show();
                        $('#inner_cards').hide();
                        jQuery('.loadmore_main2').hide();
                        jQuery('#search-result-continer').show();
                        jQuery('.loadmore_main').show();
                        $('#main-container .container-feed-cards .container-lg').attr('style','padding-bottom: 0;');
                        $('#search-result-continer .container-feed-cards .container-lg').attr('style','padding-top: 0;');
                    }
                } else {
                    jQuery('#search-result-continer').hide();
                    jQuery('.loadmore_main').hide();
                    $('#inner_cards').show();
                    jQuery('#main-container').show();
                    jQuery('.loadmore_main2').show();
                }
            });
            //Coveo.state(root, 'numberOfResults',9);
            //Coveo.state(Coveo.$$(document).find(".magic-box-input input"), 'f:@articlecategory' , 'Secure the Cloud');
            Coveo.SearchInterface.options.autoTriggerQuery.defaultValue = false;
            Coveo.init(root);
        });
    }

    $('body').on('blur', '.magic-box-input input, #postSearch1', function (e) {
        var has_hash = false;
        if (window.location.hash.length) {
            has_hash = true;
        }
        var to_append = '';
        if (has_hash) {
            to_append = window.location.hash.replace('#', '');
            to_append = '#' + to_append;
        }
        window.history.replaceState(null, null, "?search_field=" + $(this).val() + to_append);
    });

    $('.load_more_btn').on('click', function () {
        //Coveo.SearchEndpoint.endpoints["default"].options.queryStringArguments.numberOfResults = 8;
        load_more_clicked = true;

        var this_btn = $(this);
        $(this).addClass('is-clicked');
        $(this).html('Loading...');
        $(this).prop('disabled', true);
        //jQuery('.articles_container').masonry('reloadItems').masonry();
        //Coveo.SearchEndpoint.endpoints["default"].options.queryStringArguments.numberOfResults = 8;
        //Coveo.state(root, 'firstResult',$('.CoveoResult').length - 1);
        Coveo.$('.CoveoResultList').coveo('displayMoreResults', 9);
        //Coveo.SearchEndpoint.endpoints["default"].options.queryStringArguments.numberOfResults = 9;
        setTimeout(function () {
            this_btn.removeClass('is-clicked');
        }, 1900);
    });
    var interval;
    var timer2;

    if (isIE11) {
        executeCoveoSearch();
    }




    var captcha_rendered = false;
    var subscribeSuccess = false;

    jQuery('body').on('change paste keyup', '.business_email_bot', function () {
        jQuery(this).closest('form').find('.google-recapth').removeClass('d-none');
    });

    $('body').on('mouseover', '.idc_ul_cont_not_liked', function (e) {
        $(this).find('svg').children('path').attr('stroke', '#FF2E00');
        //$(this).attr('src','https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/blue-like-icon.png');
    });
    $('body').on('mouseout', '.idc_ul_cont_not_liked', function (e) {
        $(this).find('svg').children('path').attr('stroke', '#727272');
        //$(this).attr('src','https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/images/grey-like-icon.png');
    });




    $(document).ready(function () {
        getSerializedTracking("Unit42_Subscribe");

    });
    $('body').click(function () {
        $('.CoveoDidYouMean').hide();
    });

    jQuery('body').on('change paste keyup', '.business_email', function () {
        //console.log($('#captcha_container2').children().length);
        if ($('#captcha_container').length == 1 && $('#captcha_container').children().length == 0) {
            console.log("cap1");
            var loadCaptcha = function () {
                captchaContainer = grecaptcha.render('captcha_container', {
                    'sitekey': '6LeyHGkUAAAAAEwfqwKWxNqdht3xjSNf-j3bK7l2',
                    'callback': function (response) {
                        $("form[name='Unit42_Subscribe'] button[type='submit']").prop('disabled', false);
                        subscribeSuccess = true;
                    },
                    'expired-callback' : function(){
                        $("form[name='Unit42_Subscribe'] button[type='submit']").prop('disabled', true);
                        subscribeSuccess = false;
                    }
                });
            }
            loadCaptcha();
        }
        /*
        if ($('#captcha_container2').length == 1 && $('#captcha_container2').children().length == 0) {
            console.log("cap2");
            var loadCaptcha2 = function () {
                captchaContainer = grecaptcha.render('captcha_container2', {
                    'sitekey': '6LeyHGkUAAAAAEwfqwKWxNqdht3xjSNf-j3bK7l2',
                    'callback': function (response) {
                        $("form[name='contact_sales_modal'] input[type='submit']").prop('disabled', false);
                        subscribeSuccess = true;
                    }
                });
            }

            loadCaptcha2();
        }
        */
        setTimeout(function () {
            jQuery('#row-recatcha').removeClass('d-none');
            //jQuery('.articles_container').masonry('layout');
        }, 50);
    });


    jQuery('body').on('submit', 'form.subscribe-form', function () {
        var success = true;
        var form = jQuery(this);
        var mail = form.find('input[name="Email"]');
        if (mail.val() === '' || !isEmail(mail.val())) {
            mail.closest("form").addClass('has-error');
            success = false;
        } else {
            mail.closest("form").removeClass('has-error');
        }

        if (success && subscribeSuccess) {
            $.ajax({
                type: 'POST',
                url: form.attr('action'),
                data: form.serialize(),
                success: function (msg) {
                    form.html('<p style="color: #0c6;">You have been successfully subscribed</p>');
                    //masonry.masonry('layout');
                }
            });
        }
        return false;
    });


    function isEmail(email) {
        var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(String(email).toLowerCase());
    }


    $(document).ready(function () {
        //$('body').attr('data-results-per-page', '9');
        $("#dropdownMenuButton").click(function(){
            if (typeof Coveo === 'undefined') {
                //$(".dropdown-menu a").attr('disabled',"disabled");
                $('.dropdown-menu a').css('pointer-events','none');
                loadCoveoLibrary();
            }
        });
        
        $(".dropdown-menu a").click(function(e){
            $(this).parents(".dropdown").find('.btn').html($(this).text());
            $(this).parents(".dropdown").find('.btn').val($(this).data('value'));
            topSearch = false;
            e.preventDefault(); 
        });
        
        /**
         $('img').each(function() {
         var path = $(this).attr('src');
         $(this).attr('src', path.replace("http://blog-localhost.paloaltonetworks.com/wp-content/upload", "https://blog.paloaltonetworks.com/wp-content/upload"));
         });
         $('figure').each(function() {
         var path = $(this).attr('style');
         if (typeof path !== 'undefined'){
         $(this).attr('style', path.replace("http://blog-localhost.paloaltonetworks.com/wp-content/upload", "https://blog.paloaltonetworks.com/wp-content/upload"));
         }
         });
         * 
         */
        
        $(".pan-page-alert-close").click(function(){
            $("#nav-mobile").css("top", "72px");
          });
          $("#feed-clear").click(function(){
              //$('#mostRecentTab').trigger('click');
            $('#postSearch2').val('');
            $('#sec-search-clear').hide();
            jQuery('#search-result-continer').hide();
            jQuery('.loadmore_main').hide();
            $('#inner_cards').show();
            jQuery('#main-container').show();
            jQuery('.loadmore_main2').show();
            $('#main-container .container-feed-cards .container-lg').removeAttr('style');
            
            
            $('.col-feed-filter #dropdownMenuButton').val("Most Recent");
            $('.col-feed-filter #dropdownMenuButton').html("Most Recent");
            $('#mostRecentTab').addClass('coveo-selected');
            $('#mostPopularTab').removeClass('coveo-selected');
         
            
          });
          

        $('#postSearch2').focus(function () {
            if (typeof Coveo === 'undefined') {
                //$('#postSearch1, #postSearch2').attr('title', 'Loading...please wait');
                $('#postSearch1, #postSearch2').prop("readonly", true);
                loadCoveoLibrary();
            }
        });
        $('body').on('keyup', '#postSearch1, #postSearch2', function (e) {
            //cur_search_txt = jQuery('.magic-box-input input').val(); 
            if(this.id == 'postSearch2'){
                topSearch = false;
            }
            else{
                topSearch = true;
            }
            var typed_text;
            if(topSearch){
                typed_text = $('#postSearch1').val();
            }
            else{
                typed_text = $('#postSearch2').val();
                if((typed_text.length > 0) ){
                    $('#sec-search-clear').show();
                    //$('#feed-search').prop('disabled', false);
                }
                else{
                    $('#sec-search-clear').hide();
                    //$('#feed-search').prop('disabled', true);
                }
            }
            
            
            $('.magic-box-input input').val(typed_text);
            if ((typed_text.length > 0) && e.keyCode === 13) {
                if(topSearch && !$('#searching').val()){
                    location.href='https://blog.paloaltonetworks.com?search_field='+typed_text;
                    return;
                }
                //enterKeyPressed = true;
                if (screenwidth < 992) {
                    if(topSearch){
                    mobileToggle();
                }
                }
                $('.CoveoSearchButton').click();
            }
        });
    });
</script>


    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://blog.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#FA582D');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <script type='text/javascript'>
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/blog.paloaltonetworks.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"}};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/plugins/contact-form-7/includes/js/scripts.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/popper.min.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/bootstrap.min.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/aos.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wp_vars = {"ajax_url":"https:\/\/blog.paloaltonetworks.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/masonry2.js?v2'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-content/themes/panwblog2020/dist/scripts/jquery.cookie.js'></script>
<script type='text/javascript' src='https://blog.paloaltonetworks.com/wp-includes/js/wp-embed.min.js'></script>
  </body>
</html>

