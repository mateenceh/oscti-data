
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>VIDEO: Tips, Tricks, and Clues to Escape the LabyREnth CTF</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-video-tips-tricks-clues-escape-labyrenth-ctf/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-video-tips-tricks-clues-escape-labyrenth-ctf/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="VIDEO: Tips, Tricks, and Clues to Escape the LabyREnth CTF" />
<meta property="og:description" content="Have you escaped the LabyREnth? Tips, tricks and clues to make your escape." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-video-tips-tricks-clues-escape-labyrenth-ctf/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="capture the flag" />
<meta property="article:tag" content="CTF" />
<meta property="article:tag" content="LabyREnth" />
<meta property="article:tag" content="Unit 42" />
<meta property="article:section" content="Events" />
<meta property="article:published_time" content="2017-06-28T13:00:33+00:00" />
<meta property="article:modified_time" content="2018-11-01T10:53:20+00:00" />
<meta property="og:updated_time" content="2018-11-01T10:53:20+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/Labyrenth_countdown.png" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/Labyrenth_countdown.png" />
<meta property="og:image:width" content="1040" />
<meta property="og:image:height" content="644" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Have you escaped the LabyREnth? Tips, tricks and clues to make your escape." />
<meta name="twitter:title" content="VIDEO: Tips, Tricks, and Clues to Escape the LabyREnth CTF" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/Labyrenth_countdown.png" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; VIDEO: Tips, Tricks, and Clues to Escape the LabyREnth CTF Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-video-tips-tricks-clues-escape-labyrenth-ctf/feed/" />
<meta property="og:likes" content="0"/>
<meta property="og:readtime" content="8"/>
<meta property="og:views" content="15,125"/>
<meta property="og:date_created" content="June 28, 2017 at 4:00 PM"/>
<meta property="og:post_length" content="1860"/>
<meta property="og:category" content="Events"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/events/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Samantha Pierre"/>
<meta property="og:author" content="Richard Wartell"/>
<meta property="og:author" content="Tyler Halfpop"/>
<meta property="og:author" content="Jeff White"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/samantha-pierre/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/richard-wartell/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/tyler-halfpop/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/jeff-white/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/05/Samantha.Pierre-150x150.jpg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"VIDEO: Tips, Tricks, and Clues to Escape the LabyREnth CTF","name":"VIDEO: Tips, Tricks, and Clues to Escape the LabyREnth CTF","description":"Have you escaped the LabyREnth? Tips, tricks and clues to make your escape.","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-video-tips-tricks-clues-escape-labyrenth-ctf\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-video-tips-tricks-clues-escape-labyrenth-ctf\/","datePublished":"June 28, 2017","articleBody":"We\u2019re halfway through Unit 42\u2019s LabyREnth Capture the Flag (CTF) competition, and things are getting interesting. Malware reverse engineers and threat experts across the world are testing their technical skills in binaries, threat intelligence, programming, and more. Armor has been acquired, tears have been shed, cows have been spotted... Plus, puppies!\n\nHave you escaped the LabyREnth yet?\n\nWe know many of you are still in the LabyREnth building security skills and solving challenges. Because we don\u2019t want to leave you trapped in the maze, the LabyREnth creators put together a video and several writeups with some of their best tips, tricks, and clues for solving their security challenges. Check them out below.\n\n\n\nAll monetary prizes have been claimed, but you can still win electronics and challenge coins, so we encourage you to keep going. As always, good luck escaping the LabyREnth!\nDocuments 1 Challenge Hints\nBy: Jeff White\n\nFor this challenge, we\u2019re given an RTF file called \u201cfind_bbz_challenge_file.rtf\u201d and upon opening it we\u2019re immediately greeted with a prompt to Enable Macros.\n\n\n\nRunning it we see a message to double click an object with the Firefox icon to \u201cFind BBZ\u201d.\n\n\n\nFinally, double clicking this Firefox icon takes us to an image of David Bowie in a new document that is opened.\n\n\n\nThe first thing I like to do when analyzing Word documents like this is to dig into the Macro source and try to understand what\u2019s happening under the hood. I\u2019ll focus on the \u201cDocument_Open()\u201d function and follow the logic and debug the code.\n\nOpening up the Visual Basic Editor we see the function under \u201cThisDocument\u201d and it immediately does a check for the value of variable \u201cwfozoV\u201d; if it does not equal \u201cbbz\u201d then it launches a function \u201cdLMNiMbhMkYVvgR\u201d.\n\n\n\nLooking at this function shows some variables being set to the returned result of a call to \u201cjlETByoSKP\u201d with an array of integers and another integer.\n\n\n\nThis second function appears to be a decoding routine and has familiar operations such as XOR and MOD.\n\nAlso of note is the MsgBox function right below the first variable that gets set. Typically, in CTF\u2019s, a MsgBox is used to display the key or other pertinent messages so this is a good place to pause the debugger and see what\u2019s happening.\n\n\n\nIn the Locals window, you can see the decoded message. Given this, you should be able to decode the rest of the messages and take down the first level Documents challenge!\nBinaries 1 Challenge Hints\nBy: Tyler Halfpop\n\nWe are given the following 3 files for this challenge.\u00a0 Two of the files come up as data using the file command and look like they might be compressed or encrypted in a hex editor.\u00a0 One of the files is a PE executable.\u00a0 This is where you might want to start your analysis.\nMyFirstMalware.exe: PE32 executable (console) Intel 80386, for MS Windows\nconfig.jpg:         data\nnotdroids.jpg:      data\n\n7875563cd66e948ff2356ebf9b5e33dbd579ccffafbea82b40cb14ae5f772252  MyFirstMalware.exe\n5921f38aa15eaeb3188438ebf85d3cb29e4b9a74b21fa9dadc110dfdf8a410da  config.jpg\nfcb8ce15333bf305b9025edfcfe6b5864ddc941b03d68fb4c54ca722b9f44d12  notdroids.jpg\nIf you check the strings for MyFirstMalware.exe you will find the correct location to place the other two files in your virtual machine.\nC:\\notdroids.jpg\nC:\\config.jpg\n\nIf you open MyFirstMalware.exe in a disassembler like IDA and find the main method pictured below you can see that a few of the calls are dynamically resolved.\n\n\n\nFigure 1 main method\n\nThe simplest method to determine what these calls are is to use a debugger and step through the program to see what is being called.\u00a0 Most of the APIs in this challenge are resolved dynamically like this.\u00a0 This is a common technique that malware authors use to try to make their code more difficult to analyze.\n\nYou will need to do something about the sleep call or you will be waiting for a long time.\u00a0 The simplest method is just to change the parameter pushed to sleep to 1 and then nop out (0x90) the remaining bytes.\n\n\n\nFigure 2 Renamed functions and patched sleep call\n\nNext you will encounter a few anti-analysis techniques that will set variables used for the file decryption.\u00a0 You need to pass the checks correctly in order to get the correct file to decrypt and the correct password.\u00a0 After the checks a string is built with the name of an executable, followed by a function that handles the file decryption.\n\n\n\nFigure 2 Disassembly Anti-Checks and Main Flow\n\nAfter you are able to pass the checks correctly and decrypt the correct file it is injected into another process.\u00a0 You will need to dump this executable in order to analyze it.\u00a0 Set a breakpoint on WriteProcessMemory when you find it and then dump the memory pointed to by the third argument on the stack.\n\n\n\nFigure 3 WriteProcessMemory breakpoint showing MZ header\n\nYou can then start analyzing the dumped binary, which employs similar tricks.\u00a0\u00a0 You should be able to apply the same strategies used on the first binary to find the key.\nThreat 2 Challenge Hints\nBy: Jeff White\n\nIf you played the CTF last year you\u2019ll immediately be familiar with this challenge. We\u2019re given a folder of 50+ malicious files and are tasked with creating a YARA rule to find a common, specific, function across the set. This is a common practice when analyzing threats and it allows you to find related samples which can then expand your overall knowledge of a given family.\n\nThe directions.txt file that comes with the samples gives us more insight into what\u2019s required. Specifically, our rule will need to match the following syntax and will need to include 308 wildcard\u2019s for a total of 298 byte matching hex-rule.\nrule yara_challenge\n{\n    strings:\n        $yara_challenge = { de ad b? ef ?? ??}\n    condition:\n         all of them \n}\n\nTypically, what I do in these scenarios is start with the smallest file possible as it must contain the function we\u2019re interested in and will have less noise, then I\u2019ll choose a larger file that will have more noise but should make finding similarities easier. For this example, I\u2019ll use the below samples if you want to follow along.\n\nSmall (94KB) - 7f63e65ab460ff8ad607ede5bedb9573263015ba81824c3896f5416969353dba\nLarge (394KB) - c99b32b4bd6744311cdb357c8fa2210de6b79873f104a8f6268c2e60c606d330\n\nThere are a few methods to approach this problem and the most basic is a simple visual comparison inside a disassembler like IDA. You can compare the basic blocks and graph overview one-by-one to see if anything visually matches.\n\n\n\nBased on the image above, you can see neither of these functions match. At this point you can go down the list until something stands out but this can be extremely time consuming and prone to simple mistakes.\n\nAnother method for comparison is to use a tool like BinDiff and take advantage of its built-in \u201cSimilarity\u201d scoring system to see if any basic blocks match.\n\n\n\nYou can sort the results by Similarity and Confidence to focus in on blocks that appear to be shared between samples. This helps reduce the noise reduce the overall amount of time required.\n\nIf you open one of the high Similarity\/Confidence blocks up, you\u2019ll see a visual comparison similar to what we saw in IDA.\n\n\n\nIn the above image, you can see two functions that are an exact match. If this was the correct size and what we\u2019re after, we can grab the underlying hex bytes which make up the instructions and values. Looking at the hex in IDA we can build a rule based on this data.\n\n\n\nWhere the MOV instruction is highlighted as \u201c8B 54 24 08\u201d. Our resulting YARA rule, for this one instruction, would then look like the below.\n rule yara_challenge\n{\n    strings:\n        $yara_challenge = { 8B 54 24 08 }\n    condition:\n         all of them \n}\n\nRinse and repeat for the entire function until you have the rule. Keep in mind that the function size is 298 bytes so it\u2019s fairly large.\n\nThe wildcards come into play when you consider things like offsets or values used by the instructions. In our above example, \u201cMOV EDX, [esp+arg_4]\u201d exists in one sample but what if in another sample it\u2019s arg_B? In that case, the instruction could be the same but we need to account for this delta with a wildcard in YARA so that it still matches between the two.\n\nBelow is the same rule but with a wildcard that specifies ANY value here, assuming the rest match, will result in a match.\n rule yara_challenge\n{\n    strings:\n        $yara_challenge = { 8B 54 24 0? }\n    condition:\n         all of them \n}\n\nWith 308 wildcards, you can bet the function you\u2019re looking for is going to have a lot of different values!\nMobile 3 Challenge Hints\nBy: Tyler Halfpop\n\nThis challenge is an iOS app that was written in Swift.\u00a0 If you look at the strings you might notice that there are what looks like some base64 encoded strings.\n\n\n\nThe strings are base64 encoded and xor encoded with different keys.\u00a0 We can use the Swift interpreter and these functions below to decode the strings.\u00a0 After we decode the strings we can see what looks like a device name, some GPS coordinates, a device type, a decimal, a good job message, and a failure message.\u00a0 You need to make sure you have the correct values for the environment checks in order to decrypt the key properly.\n\n\n\nIf we look at the cross references for the example decoded good job message displayed above.\u00a0 We can see that the function that references the string is called from a memory warning.\u00a0 We can also see some functions related to AES encryption and crc32 algorithm.\n\n\nProgramming 3 Challenge Hints\nBy: Richard Wartell\n\nFor the third challenge of the programming track, we\u2019re given an IP address and port, as well as a hint that states: \u201cThe transition from first person to third person is real hard, especially when the game's a cheater...\u201d. This hint refers to the first challenge from the programming track, which is a third person maze. This challenge is a first person maze in ascii art that you must solve in order to progress. When we connect to the challenge we see this:\n\n\n\nThe challenge appears to take 4 possible moves: w for move forward, a for turn left, d for turn right, and s for move backwards. Now if we start moving through the maze a little bit, we start to realize that this game cheats. After walking for a while, we keep running into a wall.\n\n\n\nDisconnecting from the challenge and reconnecting allows us to start over, however this keeps happening. After walking for a while, we keep ending up at a dead end like the one below, as if the challenge is creating new walls as you play.\n\n\n\nThe challenge here is to figure out how the game cheats, as it must be predictable in order to be solvable, and then get to the end of the maze where the key awaits.","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2017\/06\/Labyrenth_countdown-150x150.png","width":150,"height":150},"author":[{"@type":"Person","name":"Samantha Pierre"},{"@type":"Person","name":"Richard Wartell"},{"@type":"Person","name":"Tyler Halfpop"},{"@type":"Person","name":"Jeff White"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"35617","token":"7e15a0f8b3","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=35617' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-video-tips-tricks-clues-escape-labyrenth-ctf%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-video-tips-tricks-clues-escape-labyrenth-ctf%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-35617 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">VIDEO: Tips, Tricks, and Clues to Escape the LabyREnth CTF</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-35617 entry-meta">
			
			
			<span class="post-views-count">15,125</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'35617','like')"><i class="ui ui-2"></i><span class="ml-5">0</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 8</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-video-tips-tricks-clues-escape-labyrenth-ctf%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-video-tips-tricks-clues-escape-labyrenth-ctf%2F+-+VIDEO%3A+Tips%2C+Tricks%2C+and+Clues+to+Escape+the+LabyREnth+CTF" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-video-tips-tricks-clues-escape-labyrenth-ctf%2F&title=VIDEO%3A+Tips%2C+Tricks%2C+and+Clues+to+Escape+the+LabyREnth+CTF&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/unit42-video-tips-tricks-clues-escape-labyrenth-ctf/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/samantha-pierre/" title="Posts by Samantha Pierre" class="author url fn" rel="author">Samantha Pierre</a>, <a href="https://unit42.paloaltonetworks.com/author/richard-wartell/" title="Posts by Richard Wartell" class="author url fn" rel="author">Richard Wartell</a>, <a href="https://unit42.paloaltonetworks.com/author/tyler-halfpop/" title="Posts by Tyler Halfpop" class="author url fn" rel="author">Tyler Halfpop</a> and <a href="https://unit42.paloaltonetworks.com/author/jeff-white/" title="Posts by Jeff White" class="author url fn" rel="author">Jeff White</a>        </p>
        <p><time datetime="2017-06-28T13:00:33+00:00">June 28, 2017 at 4:00 PM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/events/" rel="category tag">Events</a>, <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/capture-the-flag/" rel="tag">capture the flag</a>, <a href="https://unit42.paloaltonetworks.com/tag/ctf/" rel="tag">CTF</a>, <a href="https://unit42.paloaltonetworks.com/tag/labyrenth/" rel="tag">LabyREnth</a>, <a href="https://unit42.paloaltonetworks.com/tag/unit-42/" rel="tag">Unit 42</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="900" height="557" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/Labyrenth_countdown-900x557.png" class="attachment-single size-single wp-post-image" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/Labyrenth_countdown-900x557.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/Labyrenth_countdown-300x186.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/Labyrenth_countdown-768x476.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/Labyrenth_countdown-1024x634.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/Labyrenth_countdown-370x229.png 370w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/Labyrenth_countdown.png 1040w" sizes="(max-width: 900px) 100vw, 900px" />            </figure>
                    <p>We’re halfway through Unit 42’s LabyREnth Capture the Flag (CTF) competition, and things are getting interesting. Malware reverse engineers and threat experts across the world are testing their technical skills in binaries, threat intelligence, programming, and more. Armor has been acquired, tears have been shed, cows have been spotted&#8230; Plus, puppies!</p>
<p>Have you escaped the LabyREnth yet?</p>
<p>We know many of you are still in the LabyREnth building security skills and solving challenges. Because we don’t want to leave you trapped in the maze, the LabyREnth creators put together a video and several writeups with some of their best tips, tricks, and clues for solving their security challenges. Check them out below.</p>
<div style="display: block; position: relative; max-width: 100%;">
<div style="padding-top: 56.25%;"><iframe width="300" height="150" style="width: 100%; height: 100%; position: absolute; top: 0px; bottom: 0px; right: 0px; left: 0px;" src="//players.brightcove.net/1050259881001/rJLR3mDB_default/index.html?videoId=5485146620001" allowfullscreen="allowfullscreen" webkitallowfullscreen="webkitallowfullscreen" mozallowfullscreen="mozallowfullscreen"></iframe></div>
</div>
<p>All monetary prizes have been claimed, but you can still win electronics and challenge coins, so we encourage you to keep going. As always, good luck escaping the LabyREnth!</p>
<h3>Documents 1 Challenge Hints</h3>
<p><em>By: Jeff White</em></p>
<p>For this challenge, we’re given an RTF file called “find_bbz_challenge_file.rtf” and upon opening it we’re immediately greeted with a prompt to Enable Macros.</p>
<p><img class="alignnone size-full wp-image-36082" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_1.png" alt="LabyREnth_Tips_1" width="975" height="658" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_1.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_1-900x607.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_1-300x202.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_1-768x518.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_1-370x250.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p>Running it we see a message to double click an object with the Firefox icon to “Find BBZ”.</p>
<p><img class="alignnone size-full wp-image-36058" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_2.png" alt="LabyREnth_Tips_2" width="747" height="631" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_2.png 747w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_2-300x253.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_2-370x313.png 370w" sizes="(max-width: 747px) 100vw, 747px" /></p>
<p>Finally, double clicking this Firefox icon takes us to an image of David Bowie in a new document that is opened.</p>
<p><img class="alignnone size-full wp-image-36034" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_3.png" alt="LabyREnth_Tips_3" width="975" height="962" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_3.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_3-900x888.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_3-300x296.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_3-768x758.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_3-370x365.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p>The first thing I like to do when analyzing Word documents like this is to dig into the Macro source and try to understand what’s happening under the hood. I’ll focus on the “Document_Open()” function and follow the logic and debug the code.</p>
<p>Opening up the Visual Basic Editor we see the function under “ThisDocument” and it immediately does a check for the value of variable “wfozoV”; if it does not equal “bbz” then it launches a function “dLMNiMbhMkYVvgR”.</p>
<p><img class="alignnone size-full wp-image-36010" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_4.png" alt="LabyREnth_Tips_4" width="974" height="392" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_4.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_4-900x362.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_4-300x121.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_4-768x309.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_4-370x149.png 370w" sizes="(max-width: 974px) 100vw, 974px" /></p>
<p>Looking at this function shows some variables being set to the returned result of a call to “jlETByoSKP” with an array of integers and another integer.</p>
<p><img class="alignnone size-full wp-image-35986" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_5.png" alt="LabyREnth_Tips_5" width="974" height="595" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_5.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_5-900x550.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_5-300x183.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_5-768x469.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_5-370x226.png 370w" sizes="(max-width: 974px) 100vw, 974px" /></p>
<p>This second function appears to be a decoding routine and has familiar operations such as XOR and MOD.</p>
<p>Also of note is the MsgBox function right below the first variable that gets set. Typically, in CTF’s, a MsgBox is used to display the key or other pertinent messages so this is a good place to pause the debugger and see what’s happening.</p>
<p><img class="alignnone size-full wp-image-35962" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_6.png" alt="LabyREnth_Tips_6" width="972" height="296" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_6.png 972w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_6-900x274.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_6-300x91.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_6-768x234.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_6-370x113.png 370w" sizes="(max-width: 972px) 100vw, 972px" /></p>
<p>In the Locals window, you can see the decoded message. Given this, you should be able to decode the rest of the messages and take down the first level Documents challenge!</p>
<h3>Binaries 1 Challenge Hints</h3>
<p><em>By: Tyler Halfpop</em></p>
<p>We are given the following 3 files for this challenge.  Two of the files come up as data using the file command and look like they might be compressed or encrypted in a hex editor.  One of the files is a PE executable.  This is where you might want to start your analysis.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694ca404339444248309" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
MyFirstMalware.exe: PE32 executable (console) Intel 80386, for MS Windows
config.jpg:         data
notdroids.jpg:      data

7875563cd66e948ff2356ebf9b5e33dbd579ccffafbea82b40cb14ae5f772252  MyFirstMalware.exe
5921f38aa15eaeb3188438ebf85d3cb29e4b9a74b21fa9dadc110dfdf8a410da  config.jpg
fcb8ce15333bf305b9025edfcfe6b5864ddc941b03d68fb4c54ca722b9f44d12  notdroids.jpg</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694ca404339444248309-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694ca404339444248309-2">2</div><div class="crayon-num" data-line="crayon-5f694ca404339444248309-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694ca404339444248309-4">4</div><div class="crayon-num" data-line="crayon-5f694ca404339444248309-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694ca404339444248309-6">6</div><div class="crayon-num" data-line="crayon-5f694ca404339444248309-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694ca404339444248309-1"><span class="crayon-v">MyFirstMalware</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">PE32 </span><span class="crayon-e">executable</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">console</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">Intel</span><span class="crayon-h"> </span><span class="crayon-cn">80386</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">MS </span><span class="crayon-e">Windows</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694ca404339444248309-2"><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-v">jpg</span><span class="crayon-o">:</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">data</span></div><div class="crayon-line" id="crayon-5f694ca404339444248309-3"><span class="crayon-v">notdroids</span><span class="crayon-sy">.</span><span class="crayon-v">jpg</span><span class="crayon-o">:</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694ca404339444248309-4">&nbsp;</div><div class="crayon-line" id="crayon-5f694ca404339444248309-5"><span class="crayon-cn">7875563cd66e948ff2356ebf9b5e33dbd579ccffafbea82b40cb14ae5f772252</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">MyFirstMalware</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694ca404339444248309-6"><span class="crayon-cn">5921f38aa15eaeb3188438ebf85d3cb29e4b9a74b21fa9dadc110dfdf8a410da</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-e">jpg</span></div><div class="crayon-line" id="crayon-5f694ca404339444248309-7"><span class="crayon-e">fcb8ce15333bf305b9025edfcfe6b5864ddc941b03d68fb4c54ca722b9f44d12&nbsp;&nbsp;</span><span class="crayon-v">notdroids</span><span class="crayon-sy">.</span><span class="crayon-v">jpg</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>If you check the strings for MyFirstMalware.exe you will find the correct location to place the other two files in your virtual machine.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694ca404344198468110" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
C:\notdroids.jpg
C:\config.jpg</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694ca404344198468110-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694ca404344198468110-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694ca404344198468110-1"><span class="crayon-v">C</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-v">notdroids</span><span class="crayon-sy">.</span><span class="crayon-i">jpg</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694ca404344198468110-2"><span class="crayon-v">C</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-v">jpg</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>If you open MyFirstMalware.exe in a disassembler like IDA and find the main method pictured below you can see that a few of the calls are dynamically resolved.</p>
<p><img class="alignnone size-full wp-image-35938" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_7.png" alt="LabyREnth_Tips_7" width="802" height="708" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_7.png 802w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_7-300x265.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_7-768x678.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_7-370x327.png 370w" sizes="(max-width: 802px) 100vw, 802px" /></p>
<p><em>Figure 1 main method</em></p>
<p>The simplest method to determine what these calls are is to use a debugger and step through the program to see what is being called.  Most of the APIs in this challenge are resolved dynamically like this.  This is a common technique that malware authors use to try to make their code more difficult to analyze.</p>
<p>You will need to do something about the sleep call or you will be waiting for a long time.  The simplest method is just to change the parameter pushed to sleep to 1 and then nop out (0x90) the remaining bytes.</p>
<p><img class="alignnone size-full wp-image-35914" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_8.png" alt="LabyREnth_Tips_8" width="975" height="518" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_8.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_8-900x478.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_8-300x159.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_8-768x408.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_8-370x197.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p><em>Figure 2 Renamed functions and patched sleep call</em></p>
<p>Next you will encounter a few anti-analysis techniques that will set variables used for the file decryption.  You need to pass the checks correctly in order to get the correct file to decrypt and the correct password.  After the checks a string is built with the name of an executable, followed by a function that handles the file decryption.</p>
<p><img class="alignnone size-full wp-image-35890" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_9.png" alt="LabyREnth_Tips_9" width="975" height="923" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_9.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_9-900x852.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_9-300x284.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_9-768x727.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_9-370x350.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p><em>Figure 2 Disassembly Anti-Checks and Main Flow</em></p>
<p>After you are able to pass the checks correctly and decrypt the correct file it is injected into another process.  You will need to dump this executable in order to analyze it.  Set a breakpoint on WriteProcessMemory when you find it and then dump the memory pointed to by the third argument on the stack.</p>
<p><img class="alignnone size-full wp-image-35866" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_10.png" alt="LabyREnth_Tips_10" width="975" height="405" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_10.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_10-900x374.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_10-300x125.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_10-768x319.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_10-370x154.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p><em>Figure 3 WriteProcessMemory breakpoint showing MZ header</em></p>
<p>You can then start analyzing the dumped binary, which employs similar tricks.   You should be able to apply the same strategies used on the first binary to find the key.</p>
<h3>Threat 2 Challenge Hints</h3>
<p><em>By: Jeff White</em></p>
<p>If you played the CTF last year you’ll immediately be familiar with this challenge. We’re given a folder of 50+ malicious files and are tasked with creating a YARA rule to find a common, specific, function across the set. This is a common practice when analyzing threats and it allows you to find related samples which can then expand your overall knowledge of a given family.</p>
<p>The directions.txt file that comes with the samples gives us more insight into what’s required. Specifically, our rule will need to match the following syntax and will need to include 308 wildcard’s for a total of 298 byte matching hex-rule.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694ca404347098909590" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
rule yara_challenge
{
    strings:
        $yara_challenge = { de ad b? ef ?? ??}
    condition:
         all of them 
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694ca404347098909590-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694ca404347098909590-2">2</div><div class="crayon-num" data-line="crayon-5f694ca404347098909590-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694ca404347098909590-4">4</div><div class="crayon-num" data-line="crayon-5f694ca404347098909590-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694ca404347098909590-6">6</div><div class="crayon-num" data-line="crayon-5f694ca404347098909590-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694ca404347098909590-1"><span class="crayon-e">rule</span><span class="crayon-h"> </span><span class="crayon-e">yara_challenge</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694ca404347098909590-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694ca404347098909590-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">strings</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694ca404347098909590-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">yara_challenge</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-e">de </span><span class="crayon-i">ad</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-i">ef</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-sy">?</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694ca404347098909590-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">condition</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694ca404347098909590-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">all </span><span class="crayon-e">of </span><span class="crayon-i">them</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5f694ca404347098909590-7"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Typically, what I do in these scenarios is start with the smallest file possible as it must contain the function we’re interested in and will have less noise, then I’ll choose a larger file that will have more noise but should make finding similarities easier. For this example, I’ll use the below samples if you want to follow along.</p>
<p>Small (94KB) &#8211; 7f63e65ab460ff8ad607ede5bedb9573263015ba81824c3896f5416969353dba<br />
Large (394KB) &#8211; c99b32b4bd6744311cdb357c8fa2210de6b79873f104a8f6268c2e60c606d330</p>
<p>There are a few methods to approach this problem and the most basic is a simple visual comparison inside a disassembler like IDA. You can compare the basic blocks and graph overview one-by-one to see if anything visually matches.</p>
<p><img class="alignnone size-full wp-image-35842" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_11.png" alt="LabyREnth_Tips_11" width="974" height="458" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_11.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_11-900x423.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_11-300x141.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_11-768x361.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_11-370x174.png 370w" sizes="(max-width: 974px) 100vw, 974px" /></p>
<p>Based on the image above, you can see neither of these functions match. At this point you can go down the list until something stands out but this can be extremely time consuming and prone to simple mistakes.</p>
<p>Another method for comparison is to use a tool like BinDiff and take advantage of its built-in “Similarity” scoring system to see if any basic blocks match.</p>
<p><img class="alignnone size-full wp-image-35818" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_12.png" alt="LabyREnth_Tips_12" width="974" height="325" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_12.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_12-900x300.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_12-300x100.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_12-768x256.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_12-370x123.png 370w" sizes="(max-width: 974px) 100vw, 974px" /></p>
<p>You can sort the results by Similarity and Confidence to focus in on blocks that appear to be shared between samples. This helps reduce the noise reduce the overall amount of time required.</p>
<p>If you open one of the high Similarity/Confidence blocks up, you’ll see a visual comparison similar to what we saw in IDA.</p>
<p><img class="alignnone size-full wp-image-35794" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_13.png" alt="LabyREnth_Tips_13" width="974" height="427" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_13.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_13-900x395.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_13-300x132.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_13-768x337.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_13-370x162.png 370w" sizes="(max-width: 974px) 100vw, 974px" /></p>
<p>In the above image, you can see two functions that are an exact match. If this was the correct size and what we’re after, we can grab the underlying hex bytes which make up the instructions and values. Looking at the hex in IDA we can build a rule based on this data.</p>
<p><img class="alignnone size-full wp-image-35770" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_14.png" alt="LabyREnth_Tips_14" width="975" height="1022" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_14.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_14-900x943.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_14-286x300.png 286w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_14-768x805.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_14-370x388.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p>Where the MOV instruction is highlighted as “8B 54 24 08”. Our resulting YARA rule, for this one instruction, would then look like the below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694ca40434c719972577" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
 rule yara_challenge
{
    strings:
        $yara_challenge = { 8B 54 24 08 }
    condition:
         all of them 
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694ca40434c719972577-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694ca40434c719972577-2">2</div><div class="crayon-num" data-line="crayon-5f694ca40434c719972577-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694ca40434c719972577-4">4</div><div class="crayon-num" data-line="crayon-5f694ca40434c719972577-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694ca40434c719972577-6">6</div><div class="crayon-num" data-line="crayon-5f694ca40434c719972577-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694ca40434c719972577-1"><span class="crayon-h"> </span><span class="crayon-e">rule</span><span class="crayon-h"> </span><span class="crayon-e">yara_challenge</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694ca40434c719972577-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694ca40434c719972577-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">strings</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694ca40434c719972577-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">yara_challenge</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-cn">8B</span><span class="crayon-h"> </span><span class="crayon-cn">54</span><span class="crayon-h"> </span><span class="crayon-cn">24</span><span class="crayon-h"> </span><span class="crayon-cn">08</span><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694ca40434c719972577-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">condition</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694ca40434c719972577-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">all </span><span class="crayon-e">of </span><span class="crayon-i">them</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5f694ca40434c719972577-7"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Rinse and repeat for the entire function until you have the rule. Keep in mind that the function size is 298 bytes so it’s fairly large.</p>
<p>The wildcards come into play when you consider things like offsets or values used by the instructions. In our above example, “MOV EDX, [esp+arg_4]” exists in one sample but what if in another sample it’s arg_B? In that case, the instruction could be the same but we need to account for this delta with a wildcard in YARA so that it still matches between the two.</p>
<p>Below is the same rule but with a wildcard that specifies ANY value here, assuming the rest match, will result in a match.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694ca40434e192373511" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
 rule yara_challenge
{
    strings:
        $yara_challenge = { 8B 54 24 0? }
    condition:
         all of them 
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694ca40434e192373511-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694ca40434e192373511-2">2</div><div class="crayon-num" data-line="crayon-5f694ca40434e192373511-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694ca40434e192373511-4">4</div><div class="crayon-num" data-line="crayon-5f694ca40434e192373511-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694ca40434e192373511-6">6</div><div class="crayon-num" data-line="crayon-5f694ca40434e192373511-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694ca40434e192373511-1"><span class="crayon-h"> </span><span class="crayon-e">rule</span><span class="crayon-h"> </span><span class="crayon-e">yara_challenge</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694ca40434e192373511-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694ca40434e192373511-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">strings</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694ca40434e192373511-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">yara_challenge</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-cn">8B</span><span class="crayon-h"> </span><span class="crayon-cn">54</span><span class="crayon-h"> </span><span class="crayon-cn">24</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694ca40434e192373511-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">condition</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694ca40434e192373511-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">all </span><span class="crayon-e">of </span><span class="crayon-i">them</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5f694ca40434e192373511-7"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>With 308 wildcards, you can bet the function you’re looking for is going to have a lot of different values!</p>
<h3>Mobile 3 Challenge Hints</h3>
<p><em>By: Tyler Halfpop</em></p>
<p>This challenge is an iOS app that was written in Swift.  If you look at the strings you might notice that there are what looks like some base64 encoded strings.</p>
<p><img class="alignnone size-full wp-image-35746" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_15.png" alt="LabyREnth_Tips_15" width="975" height="395" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_15.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_15-900x365.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_15-300x122.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_15-768x311.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_15-370x150.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p>The strings are base64 encoded and xor encoded with different keys.  We can use the Swift interpreter and these functions below to decode the strings.  After we decode the strings we can see what looks like a device name, some GPS coordinates, a device type, a decimal, a good job message, and a failure message.  You need to make sure you have the correct values for the environment checks in order to decrypt the key properly.</p>
<p><img class="alignnone size-full wp-image-35722" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_16.png" alt="LabyREnth_Tips_16" width="975" height="493" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_16.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_16-900x455.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_16-300x152.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_16-768x388.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_16-370x187.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<p>If we look at the cross references for the example decoded good job message displayed above.  We can see that the function that references the string is called from a memory warning.  We can also see some functions related to AES encryption and crc32 algorithm.</p>
<p><img class="alignnone size-full wp-image-35698" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_17.png" alt="LabyREnth_Tips_17" width="975" height="141" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_17.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_17-900x130.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_17-300x43.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_17-768x111.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_17-370x54.png 370w" sizes="(max-width: 975px) 100vw, 975px" /></p>
<h3>Programming 3 Challenge Hints</h3>
<p><em>By: Richard Wartell</em></p>
<p>For the third challenge of the programming track, we’re given an IP address and port, as well as a hint that states: “The transition from first person to third person is real hard, especially when the game&#8217;s a cheater&#8230;”. This hint refers to the first challenge from the programming track, which is a third person maze. This challenge is a first person maze in ascii art that you must solve in order to progress. When we connect to the challenge we see this:</p>
<p><img class="alignnone size-full wp-image-35674" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_18.png" alt="LabyREnth_Tips_18" width="723" height="600" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_18.png 723w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_18-300x249.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_18-370x307.png 370w" sizes="(max-width: 723px) 100vw, 723px" /></p>
<p>The challenge appears to take 4 possible moves: w for move forward, a for turn left, d for turn right, and s for move backwards. Now if we start moving through the maze a little bit, we start to realize that this game cheats. After walking for a while, we keep running into a wall.</p>
<p><img class="alignnone size-full wp-image-35650" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_19.png" alt="LabyREnth_Tips_19" width="719" height="525" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_19.png 719w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_19-590x430.png 590w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_19-300x219.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_19-370x270.png 370w" sizes="(max-width: 719px) 100vw, 719px" /></p>
<p>Disconnecting from the challenge and reconnecting allows us to start over, however this keeps happening. After walking for a while, we keep ending up at a dead end like the one below, as if the challenge is creating new walls as you play.</p>
<p><img class="alignnone size-full wp-image-35626" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_20.png" alt="LabyREnth_Tips_20" width="724" height="588" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_20.png 724w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_20-300x244.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/06/LabyREnth_Tips_20-370x300.png 370w" sizes="(max-width: 724px) 100vw, 724px" /></p>
<p>The challenge here is to figure out how the game cheats, as it must be predictable in order to be solvable, and then get to the end of the maze where the key awaits.</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
