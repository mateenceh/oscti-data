
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/favicon-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <title>Recent InPage Exploits Lead to Multiple Malware Families</title>
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-recent-inpage-exploits-lead-multiple-malware-families/" />

<!-- This site is optimized with the Yoast SEO plugin v12.6.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Unit 42 observed numerous InPage exploits leading to multiple malware families."/>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>
<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-recent-inpage-exploits-lead-multiple-malware-families/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Recent InPage Exploits Lead to Multiple Malware Families" />
<meta property="og:description" content="Unit 42 observed numerous InPage exploits leading to multiple malware families." />
<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-recent-inpage-exploits-lead-multiple-malware-families/" />
<meta property="og:site_name" content="Unit42" />
<meta property="article:tag" content="BioData" />
<meta property="article:tag" content="Confucius" />
<meta property="article:tag" content="InPage" />
<meta property="article:tag" content="MY24" />
<meta property="article:section" content="Unit 42" />
<meta property="article:published_time" content="2017-11-02T11:00:27+00:00" />
<meta property="article:modified_time" content="2018-11-01T10:56:37+00:00" />
<meta property="og:updated_time" content="2018-11-01T10:56:37+00:00" />
<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<meta property="og:image:secure_url" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<meta property="og:image:width" content="650" />
<meta property="og:image:height" content="300" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Unit 42 observed numerous InPage exploits leading to multiple malware families." />
<meta name="twitter:title" content="Recent InPage Exploits Lead to Multiple Malware Families" />
<meta name="twitter:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Recent InPage Exploits Lead to Multiple Malware Families Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-recent-inpage-exploits-lead-multiple-malware-families/feed/" />
<meta property="og:likes" content="1"/>
<meta property="og:readtime" content="11"/>
<meta property="og:views" content="22,659"/>
<meta property="og:date_created" content="November 2, 2017 at 1:00 PM"/>
<meta property="og:post_length" content="3076"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Jacob Soo"/>
<meta property="og:author" content="Josh Grunzweig"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/jacob-soo/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/joshgruznweig/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Recent InPage Exploits Lead to Multiple Malware Families","name":"Recent InPage Exploits Lead to Multiple Malware Families","description":"Unit 42 observed numerous InPage exploits leading to multiple malware families.","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-recent-inpage-exploits-lead-multiple-malware-families\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-recent-inpage-exploits-lead-multiple-malware-families\/","datePublished":"November 2, 2017","articleBody":"In recent weeks, Unit 42 has discovered three documents crafted to exploit the InPage program. InPage is a word processor program that supports languages such as Urdu, Persian, Pashto, and Arabic. The three InPage exploit files are linked through their use of very similar shellcode, which suggests that either the same actor is behind these attacks, or the attackers have access to a shared builder. The documents were found to drop the following malware families:\n\n \tThe previously discussed CONFUCIUS_B malware family\n \tA backdoor previously not discussed in the public domain, commonly detected by some antivirus solutions as \u201cBioData\u201d\n \tA previously unknown backdoor that we have named MY24\n\nThe use of InPage as an attack vector is not commonly seen, with the only previously noted attacks being documented by Kaspersky in late 2016.\nThe decoy documents used by the InPage exploits suggest that the targets are likely to be politically or militarily motivated. They contained subjects such as intelligence reports and political situations related to India, the Kashmir region, or terrorism being used as lure documents.\nIn the blog below, we analyze and present our findings on three of these malicious InPage documents:\n\n \tCyber Advisory No 91.inp\n \tIntelligence Report-561 (1).inp\n \tTehreek-E-Kashmir Mujahaid List.inp\n\nWe also include analysis of the new backdoor we discovered: MY24.\n&nbsp;\nCyber Advisory No 91.inp\nWe discovered the first InPage exploit to have the following attributes:\n\n\n\nSHA256\n1d1e7a6175e6c514aaeca8a43dabefa017ddc5b166ccb636789b6a767181a022\n\n\nOriginal Filename\nCyber Advisory No 91.inp\n\n\n\nThe exploit for this document is the same one described by described by Kaspersky late last year. This exploit was unsuccessful in the latest version in InPage (Version 3.60), and as such the underlying vulnerability has likely been patched.\nOverall, the entire execution flow of this malware from start to finish can be summarized as follows:\n\nFigure 1 InPage exploit document execution flow\n&nbsp;\nWhen the malicious .INP file is opened using a vulnerable version of InPage, it will execute the shellcode that is embedded within it.\nThis particular shellcode, along with the shellcode found within another InPage exploit document that will be discussed later on, began with a marker of \u2018LuNdLuNd\u2019, followed by a series of NOPs. It continues to identify an offset to an embedded executable file, which will eventually be run on the victim machine.\nThis particular shellcode uses a unique hashing mechanism for identifying and loading Microsoft Windows libraries and functions. It uses this method to load a series of functions, as seen below:\n\nFigure 2 Shellcode loading functions using custom hashing algorithm\n&nbsp;\nThe hashing algorithm in question can be represented in Python as follows:\ndef hashAlgo(string):\n  hsh = 0\n  for c in string:\n    v1 = ord(c) | 0x60\n    hsh = 2 * (hsh + v1)\n  return hsh\nlibrary = \"ntdll.dll\"\nfunction = \"memcpy\"\nprint \"[+] '{}' Library: 0x{:x}\".format(library, hashAlgo(library))\nprint \"[+] '{}' Function: 0x{:x}\".format(function, hashAlgo(function))\nOutput:\n[+] 'ntdll.dll' Library: 0x1b708\n[+] 'memcpy' Function: 0x347a\n\nThis particular hashing algorithm does not appear to be widely used, however, in our searches using the YARA rule provided at the end of this blog, we were able to identify roughly 70 PE32 samples that have recently employed this same hashing technique.\nThe shellcode then proceeds to attempt to create a mutex with a value of \u201cQPONMLKJIH\u201d to ensure only one instance of the shellcode is running at a given time. Finally, the shellcode will copy the embedded payload into newly allocated memory before executing it.\nThis newly dropped payload is a DLL with the following attributes:\n\n\n\nSHA256\n7bbf14ced3ca490179d3727b7287eb581c3a730131331be042d0f0510bc804f9\n\n\nCompile Timestamp\n2015-05-08 12:51:54 UTC\n\n\nPDB String\nc:\\users\\mz\\documents\\visual studio 2013\\Projects\\Shellcode\\Release\\Shellcode.pdb\n\n\n\n&nbsp;\nThis particular DLL acts as a dropper, and has two embedded resource files\u2014an executable payload that will be used to ultimately drop the final payload, as well as a decoy InPage file. It begins by spawning a new thread that loads the two files from embedded resources with names of \u2018BIN\u2019 and \u2018BIN2\u2019 respectively. The executable is dropped to the following path before it is executed:\n\n \t%TEMP%\\winopen.exe\n\nThe InPage decoy document is dropped to the following path before it is run:\n\n \t%TEMP\\SAMPLE.INP\n\nThe decoy document in question looks like the following. The rough translation to English has been provided in red:\n\nFigure 3 Decoy InPage file with rough translation\n&nbsp;\nBased on the rough translation of this document, it appears to deal with current issues within the Kashmir region. This of course is not consistent with the original filename, and it is unclear why this is the case. Perhaps the attacker forgot to change the lure from a previous exploit, or simply didn\u2019t find it necessary. This lure, while inconsistent with the original filename, is in line with the other InPage exploit file that also looked to be of the same subject matter.\nThe executable file in the \u2018%TEMP%\\winopen.exe\u2019 path has the following attributes:\n\n\n\nSHA256\n692815d06b720669585a71bc8151b89ca6748f882b35e365e08cfaf6eda77049\n\n\nCompile Timestamp\n2017-07-31 06:03:42 UTC\n\n\n\n&nbsp;\nThis particular executable is made to resemble the legitimate application Putty. Unlike other files we witnessed up to this point, this sample has rudimentary anti-debugging and anti-analysis techniques in place prior to the main execution flow.\nIt proceeds to decrypt an embedded resource object using the RC4 algorithm. The following key is used for decryption:\n\n \tVACqItywGR1v3qGxVZQPYXxMZV0o2fzp\n\nAfter this data is decrypted, the following registry key is written to ensure persistence. Again, we see the malware mimic the appearance of the legitimate Putty application.\n\n \tHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\Putty - %TEMP%\\winopen.exe\n\nFinally, the malware will spawn a new suspended instance of itself, where the decrypted data is written and subsequently executed.\nThis next stage of malware has the following properties:\n\n\n\nSHA256\nbb5540fe0bbc0cda08865aad891a585cd465b224bfe84762216cd04178087516\n\n\nCompile Timestamp\n2017-05-17 05:47:05 UTC\n\n\n\n&nbsp;\nThis malware operates almost identical to the previously witnessed sample. However, this time the embedded resource object is decrypted using the following RC4 key:\n\n \tkRPAnN2DN6vfrxsJ55Lntnh7Mma8E68s\n\nThe next, and last stage of this malware execution has the following attributes:\n\n\n\nSHA256\nd1a14bc3160f5ed6232ceaf40de1959d7dba3eae614efd2882b04d538cda825b\n\n\nCompile Timestamp\n2016-10-31 02:41:09 UTC\n\n\n\n&nbsp;\nThis final payload is an instance of the CONFUCIUS_B malware family, which we have previously discussed. This particular sample attempts to connect to the following host for C2 operations:\n\n \t151.80.14[.]194\n\n\nIntelligence Report-561 (1).inp\nWe identified this malicious InPage document as having the following attributes:\n\n\n\nSHA256\n35c5f6030513f11fd1dcf9bd232de457ba7f3af3aedc0e2e976895b296a09df6\n\n\nOriginal Filename\nIntelligence Report-561 (1).inp\n\n\n\n&nbsp;\nThis particular exploit file uses the exact same shellcode witnessed previously, where an embedded DLL is loaded into memory. Again, this executable drops and executes two files\u2014a Microsoft Windows executable payload and an InPage decoy document.\nThe embedded payload within the shellcode has the following attributes:\n\n\n\nSHA256\n83e3b2938ee6a3e354c93c6ec756da96b03cc69118b5748b07aee4d900da1844\n\n\nCompile Timestamp\n2015-05-08 12:51:54 UTC\n\n\nPDB String\nc:\\users\\mz\\documents\\visual studio 2013\\Projects\\Shellcode\\Release\\Shellcode.pdb\n\n\n\n&nbsp;\nAgain, we see the executable payload and decoy document dropped to the following respective locations:\n\n \t%TEMP%\\winopen.exe\n \t%TEMP%\\SAMPLE.inp\n\nThe dropped executable is a previously undocumented backdoor written in Delphi that has been named BioData by multiple antivirus organizations.\nThis InPage exploit document follows a much simpler execution flow, as seen in the following diagram.\n\nFigure 4 InPage exploit execution flow\n&nbsp;\nThe decoy InPage file dropped by this malware looks like the following. The language used within it appears to be a mix of Arabic and Urdu. A rough translation has been provided in red in the image below.\n\nFigure 5 Decoy InPage document dropped by malware\n&nbsp;\nThe Biodata payload has the following attributes:\n\n\n\nSHA256\n5716509e4cdbf8ffa5fbce02b8881320cb852d98e590215455986a5604a453f7\n\n\nCompile Timestamp\n1992-06-19 22:22:17 UTC\n\n\n\n&nbsp;\nNote that the timestamp above is the result of this sample being compiled in Delphi, which uses the same hardcoded compilation timestamp for all samples that are generated.\nThroughout the execution of this sample, numerous strings are decoded using a customized 94-character substitution table. BioData will go through each character of the obfuscated string, and will replace each character based on the following table:\n\nFigure 6 Substitution table used by BioData\n&nbsp;\nThe malware proceeds to generate and create a \u2018Document\u2019 folder within the %USERPROFILE% directory. This folder will contain all of the malware\u2019s files throughout its execution. In order to maintain persistence, the malware will generate the following file in the startup folder, which points to the current path of the BioData executable:\n\n \tAdobe creative suit.lnk\n\nBioData proceeds to generate a randomized 30-character string of uppercase and lowercase letters. This string is written to the following file:\n\n \t%USERPROFILE%\\Document\\users.txt\n\nThis 30-character string is used by the malware to act as a unique identifier for the victim, and will be used for all network communication with a remote server.\nThe username and computer name are identified, and are written to a string of the following format:\n\n \tUser name and System Name :- [Username]_[Computer Name]\n\nThis data is obfuscated and written to the following file:\n\n \t%USERPROFILE%\\Document\\SyLog.log\n\nIn order to obfuscate this data, the malware uses a unique algorithm. Represented in Python, the following script will decode this file:\nimport sys\nfrom binascii import *\nfile = sys.argv[1]\nfh = open(file, 'rb')\nfd = fh.read()\nfh.close()\ndef bit_not(n, numbits=8):\n  return (1 &lt;&lt; numbits) - 1 - n\ndef decode(data):\n  c = 0\n  output = \"\"\n  for d in data:\n    o = bit_not((0x6121 &gt;&gt; c) &amp; 0xFF)\n    output += chr(ord(d) ^ o)\n    c += 1\n    if c == 32:\n      c = 0\n  return output\nprint decode(fd)\n\nBioData sends both GET and POST requests to the following URL:\n\n \thttp:\/\/errorfeedback[.]com\/MarkQuality455\/developerbuild.php\n\nPOST requests are made with a hardcoded User-Agent, shown below in Figure 7. Additionally, a \u2018b\u2019 GET parameter is included that contains the victim\u2019s previously generated unique identifier. The contents of the POST requests are the obfuscated SyLog.log file. The remote C2 server has been observed responding to these requests with \u2018Success\u2019. These requests simply act as a beacon, including the basic victim information that was previously obtained.\n\nFigure 7 HTTP POST request by BioData\n&nbsp;\nGET requests are made in a slightly different fashion. These requests contain an empty User-Agent, and are also found to be missing a number of HTTP headers that are commonly seen.\n&nbsp;\n\nFigure 8 HTTP GET request by BioData\n&nbsp;\nUnlike the POST requests, the malware both looks for and makes use of the response given, if any, by the C2 server. The malware parses any response given by first hex-decoding it. It then base64-decodes the resulting string. The final string is used to form a subsequent GET request.\nIf for instance, the malware responded with a decoded string of \u2018malware.exe\u2019, the subsequent GET request would look like the following:\n\n \thttp:\/\/errorfeedback[.]com\/MarkQuality455\/bzGwXILtkMRZaJxzciXAeCYviduBuy\/malware.exe\n\nThe request above uses the same victim identifier that has been observed in the previous examples provided.\nThis hypothetical \u2018malware.exe\u2019 request contains the raw contents of the payload that BioData will drop to disk and execute. The contents are placed in the following file path for this hypothetical:\n\n \t%USERPROFILE%\\Document\\malware.exe\n\nFinally, after this dropped payload is successfully executed, the malware will send a GET request such as the following:\n\n \thttp:\/\/errorfeedback[.]com\/MarkQuality455\/developerbuild.php?f=62574673643246795a53356c654755&amp;b=bzGwXILtkMRZaJxzciXAeCYviduBuy\n\nIn the above example, the \u2018b\u2019 parameter is the victim identifier, and the \u2018f\u2019 parameter is the string of \u2018malware.exe\u2019 after it has been base64-encoded and hex-encoded. This request alerts the attack that the hypothetical payload of \u2018malware.exe\u2019 has been run.\n\nTehreek-E-Kashmir Mujahaid List.inp\nWe identified this malicious InPage document as having the following attributes:\n\n\n\nSHA256\n3e410397955d5a127182d69e019dbc8bbffeee864cd9c96e577c9c13f05a232f\n\n\nOriginal Filename\nTehreek-E-Kashmir Mujahaid List.inp\n\n\n\n&nbsp;\nUnfortunately, no decoy document was included with this exploit file. However, the filename provides clues as to the context that may have been present when this file was delivered to the intended recipient. The phrase \u2018Tehreek-E-Kashmir\u2019 is most likely related to the conflict in the Kashmir region of India. Additionally, the term \u2018Mujahaid\u2019 may be a misspelling of the word \u2018Mujahid\u2019, a term used to describe an individual engaged in Jihad.\nThis particular InPage shellcode looks to be near identical to the two others previously discussed, however, it appears as though the attackers simply partially overwrote the original shellcode that was present to substitute their own. This results in the shellcode acting as a downloader, instead of loading an embedded payload. We can see the modifications visually in the following image:\n\nFigure 9 Differences between InPage exploit documents\n&nbsp;\nIn the image above, the \u2018Cyber Advisory No 91.inp\u2019 exploit file has the large additional size, as it included the payload. The \u2018Tehreek-E-Kashmir Mujahaid List.inp\u2019 exploit file instead has removed this. However, original artifacts from the original shellcode are still present, including the function that loads Microsoft Windows API calls using the unique hashing algorithm.\nThe shellcode begins by iterating through the Process Environment Block (PEB), searching for a loaded module that has a \u20183\u2019 in the 7th position. In other words, the shellcode uses a simple trick to search for kernel32.dll. It proceeds to iterate through kernel32\u2019s functions, looking for the GetProcAddress function. In order to find this function it will compare the first four letters against \u2018GetP\u2019, and the third set of four letters against \u2018ddre\u2019.\nThe shellcode then gets the address of the WinExec function, which in turn is used to execute the following command:\n\n \tcmd \/c mkdir C:\\Wins\n\nIt then performs the following:\n\n \tGets the address of the LoadLibraryA function\n \tLoads the urlmon.dll library\n \tGets the address of the URLDownloadToFileA function\n\nThe shellcode then proceeds to make a request to the following URL and download the response to \u2018C:\\Wins\\cnh\u2019.\n\n \thttp:\/\/zmwardrobe[.]com\/wp-sign\n\nFinally, the shellcode will execute this downloaded file via a call to WinExec.\nThe response from this webserver returned a payload, that we have named MY24, with the following attributes:\n\n\n\nSHA256\n71b7de2e3a60803df1c3fdc46af4fd8cfb7c803a53c9a85f7311348f6ff88cbe\n\n\nCompile Timestamp\n2017-05-18 05:26:54 UTC\n\n\n\n&nbsp;\nIt should also be noted that a malicious Microsoft Word document with the following properties was observed downloading and executing the same payload.\n\n\n\nSHA256\n3f1d3d02e7707b2bc686b5add875e1258c65a0facd5cf8910ba0f321e230e17c\n\n\nOriginal Filename\nLas Vegas ISIS Claim Proof.doc\n\n\nFirst Seen\n2017-10-05 05:53:27\n\n\n\n&nbsp;\nMY24 Analysis\nThis backdoor begins by decoding a series of embedded strings by adding 33 to each character. The following example within the Python interpreter demonstrates this:\n\nFigure 10 Example string decoding within Python interpreter\n&nbsp;\nThe malware proceeds to execute a function that is responsible for generating the following path:\n\n \t%APPDATA%\\Startup\\wintasks.exe\n\nHowever, this path is never used, leading us to believe that the malware author had the intention of copying the payload to this destination and likely setting persistence, but seemingly forgot to.\nMY24 proceeds to spawn two timers where the functions are responsible for resolving the C2 domain of userveblog.ddns[.]net, as well as connecting to this domain.\nTwo new threads are then created\u2014one for handling any data that is received from the connection to the C2 and one that is responsible for sending out data.\nFinally, a function is called that is responsible for collecting information about the victim machine. The following information is collected:\n\n \tVersion of Microsoft Windows\n \tUsername\n \tComputer name\n\nThe MY24 instance expects to receive a command initially from the remote server of userveblog.ddns[.]net on port 9832. All communication is performed using raw sockets via a custom communication protocol. The packets received by the malware have the following format:\n\nFigure 11 Received packet format for MY24 malware\n&nbsp;\nAll data received and sent by MY24 is encrypted using a 13-byte XOR key of \"t6%9k$2Ri9ctv\". The data portion of the received command will include one of the following commands:\n\n\n\nReceived Command\nDescription\n\n\n2000\nReturn victim information\n\n\n2001\nGet drive information\n\n\n2002\nList files\n\n\n2004\nUnknown\n\n\n2005\nCreate file handle to append data\n\n\n2006\nWrite appended data to previously created file handle\n\n\n2007\nCreate file handle for reading data\n\n\n2009\nRead data from previously created file handle\n\n\n2012\nSpawn a shell of cmd.exe\n\n\n2013\nInteract with previously spawned shell\n\n\n2015\nUnknown\n\n\n2016\nKill previously spawned shell\n\n\n2019\nList current process network communication on the victim machine\n\n\n2021\nUnknown\n\n\n2022\nKill process\n\n\n2023\nEnumerate processes\n\n\n2025\nUnknown\n\n\n\n&nbsp;\nResponses sometimes vary in size, but are primarily sent with a size of 9084 bytes. The author of this tool did not allocate proper buffer size when sending out the data, resulting in part of the stack being included in the response by the MY24 malware. Examples of commands being sent and received may be seen below. A custom server was written to interact with the MY24 malware, which is seen in the following image.\n&nbsp;\n\nFigure 12 Interacting with MY24 backdoor\nConclusion\nWhile documents designed to exploit the InPage software are rare, they are not new - however in recent weeks Unit42 has observed numerous InPage exploits leveraging similar shellcode, suggesting continued use of the exploit previously discussed by Kaspersky.\nThe decoy documents dropped suggest that the targets are likely to be politically or militarily motivated, with subjects such as Intelligence reports and political situations being used as lure documents. The variety of malware payloads dropped suggests the attackers behind these attacks have a reasonable development resource behind them and Unit42 continues to observe new versions of these malware families being created.\nPalo Alto Networks customers are protected against these threats in a number of ways:\n\n \tAll domains observed in these malware families have been flagged as malicious.\n \tAll payloads are appropriately categorized as malicious within the WildFire platform and blocked by Traps.\n \tThe payloads witnessed have been tagged in AutoFocus as Confucius_B, MY24, and\u00a0BioData for continued tracking and observation.\n\n\nAppendix\nYARA Rules\nrule InPageShellcodeHashing\n{\n\tstrings:\n\t\t$hashingFunction = {55 8B EC 51 53 52 33 C9 33 DB 33 D2 8B 45 08 8A 10 80 CA 60 03 DA D1 E3 03 45 10 8A 08 84 C9 E0 EE 33 C0 8B 4D 0C 3B D9 74 01 40 5A 5B 59 8B E5 5D C2 0C 00}\n\tcondition:\n\t\t$hashingFunction\n}\n\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2016\/09\/unit42-web-banner-650x300-150x150.jpg","width":150,"height":150},"author":[{"@type":"Person","name":"Jacob Soo"},{"@type":"Person","name":"Josh Grunzweig"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='bodhi-svgs-attachment-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/svg-support/css/svgs-attachment.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpp_params = {"sampling_active":"0","sampling_rate":"100","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":"48348","token":"7e15a0f8b3","debug":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp-5.0.0.min.js?ver=5.0.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.3.5'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=48348' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-recent-inpage-exploits-lead-multiple-malware-families%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-recent-inpage-exploits-lead-multiple-malware-families%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.3.5 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>
  <body class="post-template-default single single-post postid-48348 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/"><img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" /></a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-98931" class="menu-item menu-item-type-post_type_archive menu-item-object-events menu-item-98931"><a href="https://unit42.paloaltonetworks.com/events/">Speaking Events</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>

  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Recent InPage Exploits Lead to Multiple Malware Families</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-48348 entry-meta">
			
			
			<span class="post-views-count">22,659</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'48348','like')"><i class="ui ui-2"></i><span class="ml-5">1</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 11</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-recent-inpage-exploits-lead-multiple-malware-families%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-recent-inpage-exploits-lead-multiple-malware-families%2F+-+Recent+InPage+Exploits+Lead+to+Multiple+Malware+Families" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-recent-inpage-exploits-lead-multiple-malware-families%2F&title=Recent+InPage+Exploits+Lead+to+Multiple+Malware+Families&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/unit42-recent-inpage-exploits-lead-multiple-malware-families/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/jacob-soo/" title="Posts by Jacob Soo" class="author url fn" rel="author">Jacob Soo</a> and <a href="https://unit42.paloaltonetworks.com/author/joshgruznweig/" title="Posts by Josh Grunzweig" class="author url fn" rel="author">Josh Grunzweig</a>        </p>
        <p><time datetime="2017-11-02T11:00:27+00:00">November 2, 2017 at 1:00 PM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/biodata/" rel="tag">BioData</a>, <a href="https://unit42.paloaltonetworks.com/tag/confucius/" rel="tag">Confucius</a>, <a href="https://unit42.paloaltonetworks.com/tag/inpage/" rel="tag">InPage</a>, <a href="https://unit42.paloaltonetworks.com/tag/my24/" rel="tag">MY24</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="650" height="300" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" class="attachment-single size-single wp-post-image" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg 650w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-300x138.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-370x171.jpg 370w" sizes="(max-width: 650px) 100vw, 650px" />            </figure>
                    <p>In recent weeks, Unit 42 has discovered three documents crafted to exploit the <a href="http://www.inpage.com/">InPage</a> program. InPage is a word processor program that supports languages such as Urdu, Persian, Pashto, and Arabic. The three InPage exploit files are linked through their use of very similar shellcode, which suggests that either the same actor is behind these attacks, or the attackers have access to a shared builder. The documents were found to drop the following malware families:</p>
<ul>
<li>The <a href="https://researchcenter.paloaltonetworks.com/2016/09/unit42-confucius-says-malware-families-get-further-by-abusing-legitimate-websites/">previously discussed CONFUCIUS_B</a> malware family</li>
<li>A backdoor previously not discussed in the public domain, commonly detected by some antivirus solutions as “BioData”</li>
<li>A previously unknown backdoor that we have named MY24</li>
</ul>
<p>The use of InPage as an attack vector is not commonly seen, with the only previously noted attacks being documented by <a href="https://securelist.com/inpage-zero-day-exploit-used-to-attack-financial-institutions-in-asia/76717/">Kaspersky</a> in late 2016.<br />
The decoy documents used by the InPage exploits suggest that the targets are likely to be politically or militarily motivated. They contained subjects such as intelligence reports and political situations related to India, the Kashmir region, or terrorism being used as lure documents.<br />
In the blog below, we analyze and present our findings on three of these malicious InPage documents:</p>
<ul>
<li><a href="#cyber-advisory">Cyber Advisory No 91.inp</a></li>
<li><a href="#intelligence-report">Intelligence Report-561 (1).inp</a></li>
<li><a href="#tehreek">Tehreek-E-Kashmir Mujahaid List.inp</a></li>
</ul>
<p>We also include analysis of the new backdoor we discovered: MY24.<br />
&nbsp;</p>
<p id="cyber-advisory"><span style="font-size: 18pt;">Cyber Advisory No 91.inp</span></p>
<p>We discovered the first InPage exploit to have the following attributes:</p>
<table>
<tbody>
<tr>
<td width="108"><strong>SHA256</strong></td>
<td width="359">1d1e7a6175e6c514aaeca8a43dabefa017ddc5b166ccb636789b6a767181a022</td>
</tr>
<tr>
<td width="108"><strong>Original Filename</strong></td>
<td width="359">Cyber Advisory No 91.inp</td>
</tr>
</tbody>
</table>
<p>The exploit for this document is the same one described by described by <a href="https://securelist.com/inpage-zero-day-exploit-used-to-attack-financial-institutions-in-asia/76717/">Kaspersky late last year</a>. This exploit was unsuccessful in the latest version in InPage (Version 3.60), and as such the underlying vulnerability has likely been patched.<br />
Overall, the entire execution flow of this malware from start to finish can be summarized as follows:<br />
<img class="aligncenter wp-image-48615" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_1.png" alt="inpage_1" width="600" height="306" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_1.png 973w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_1-900x459.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_1-300x153.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_1-768x391.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_1-370x189.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 1 InPage exploit document execution flow</em></p>
<p>&nbsp;<br />
When the malicious .INP file is opened using a vulnerable version of InPage, it will execute the shellcode that is embedded within it.<br />
This particular shellcode, along with the shellcode found within another InPage exploit document that will be discussed later on, began with a marker of ‘LuNdLuNd’, followed by a series of NOPs. It continues to identify an offset to an embedded executable file, which will eventually be run on the victim machine.<br />
This particular shellcode uses a unique hashing mechanism for identifying and loading Microsoft Windows libraries and functions. It uses this method to load a series of functions, as seen below:<br />
<img class="aligncenter wp-image-48591" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_2.png" alt="inpage_2" width="400" height="286" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_2.png 740w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_2-300x214.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_2-370x265.png 370w" sizes="(max-width: 400px) 100vw, 400px" /></p>
<p style="text-align: center;"><em>Figure 2 Shellcode loading functions using custom hashing algorithm</em></p>
<p>&nbsp;<br />
The hashing algorithm in question can be represented in Python as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cbf98643557860960" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def hashAlgo(string):
  hsh = 0
  for c in string:
    v1 = ord(c) | 0x60
    hsh = 2 * (hsh + v1)
  return hsh
library = "ntdll.dll"
function = "memcpy"
print "[+] '{}' Library: 0x{:x}".format(library, hashAlgo(library))
print "[+] '{}' Function: 0x{:x}".format(function, hashAlgo(function))
Output:
[+] 'ntdll.dll' Library: 0x1b708
[+] 'memcpy' Function: 0x347a</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cbf98643557860960-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cbf98643557860960-2">2</div><div class="crayon-num" data-line="crayon-5f694cbf98643557860960-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cbf98643557860960-4">4</div><div class="crayon-num" data-line="crayon-5f694cbf98643557860960-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cbf98643557860960-6">6</div><div class="crayon-num" data-line="crayon-5f694cbf98643557860960-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cbf98643557860960-8">8</div><div class="crayon-num" data-line="crayon-5f694cbf98643557860960-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cbf98643557860960-10">10</div><div class="crayon-num" data-line="crayon-5f694cbf98643557860960-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cbf98643557860960-12">12</div><div class="crayon-num" data-line="crayon-5f694cbf98643557860960-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cbf98643557860960-1"><span class="crayon-e">def </span><span class="crayon-e">hashAlgo</span><span class="crayon-sy">(</span><span class="crayon-t">string</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cbf98643557860960-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">hsh</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5f694cbf98643557860960-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-t">string</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cbf98643557860960-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">0x60</span></div><div class="crayon-line" id="crayon-5f694cbf98643557860960-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">hsh</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">hsh</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">v1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cbf98643557860960-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">hsh</span></div><div class="crayon-line" id="crayon-5f694cbf98643557860960-7"><span class="crayon-v">library</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"ntdll.dll"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cbf98643557860960-8"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"memcpy"</span></div><div class="crayon-line" id="crayon-5f694cbf98643557860960-9"><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"[+] '{}' Library: 0x{:x}"</span><span class="crayon-sy">.</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-v">library</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">hashAlgo</span><span class="crayon-sy">(</span><span class="crayon-v">library</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cbf98643557860960-10"><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"[+] '{}' Function: 0x{:x}"</span><span class="crayon-sy">.</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">hashAlgo</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cbf98643557860960-11"><span class="crayon-v">Output</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cbf98643557860960-12"><span class="crayon-sy">[</span><span class="crayon-o">+</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-s">'ntdll.dll'</span><span class="crayon-h"> </span><span class="crayon-v">Library</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0x1b708</span></div><div class="crayon-line" id="crayon-5f694cbf98643557860960-13"><span class="crayon-sy">[</span><span class="crayon-o">+</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-s">'memcpy'</span><span class="crayon-h"> </span><span class="crayon-t">Function</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0x347a</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>This particular hashing algorithm does not appear to be widely used, however, in our searches using the YARA rule provided at the end of this blog, we were able to identify roughly 70 PE32 samples that have recently employed this same hashing technique.<br />
The shellcode then proceeds to attempt to create a mutex with a value of “QPONMLKJIH” to ensure only one instance of the shellcode is running at a given time. Finally, the shellcode will copy the embedded payload into newly allocated memory before executing it.<br />
This newly dropped payload is a DLL with the following attributes:</p>
<table>
<tbody>
<tr>
<td width="109"><strong>SHA256</strong></td>
<td width="358">7bbf14ced3ca490179d3727b7287eb581c3a730131331be042d0f0510bc804f9</td>
</tr>
<tr>
<td width="109"><strong>Compile Timestamp</strong></td>
<td width="358">2015-05-08 12:51:54 UTC</td>
</tr>
<tr>
<td width="109"><strong>PDB String</strong></td>
<td width="358">c:\users\mz\documents\visual studio 2013\Projects\Shellcode\Release\Shellcode.pdb</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
This particular DLL acts as a dropper, and has two embedded resource files—an executable payload that will be used to ultimately drop the final payload, as well as a decoy InPage file. It begins by spawning a new thread that loads the two files from embedded resources with names of ‘BIN’ and ‘BIN2’ respectively. The executable is dropped to the following path before it is executed:</p>
<ul>
<li>%TEMP%\winopen.exe</li>
</ul>
<p>The InPage decoy document is dropped to the following path before it is run:</p>
<ul>
<li>%TEMP\SAMPLE.INP</li>
</ul>
<p>The decoy document in question looks like the following. The rough translation to English has been provided in red:<br />
<img class="aligncenter wp-image-48567" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_3.png" alt="inpage_3" width="600" height="371" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_3.png 965w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_3-900x557.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_3-300x186.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_3-768x475.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_3-370x229.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 3 Decoy InPage file with rough translation</em></p>
<p>&nbsp;<br />
Based on the rough translation of this document, it appears to deal with current issues within the Kashmir region. This of course is not consistent with the original filename, and it is unclear why this is the case. Perhaps the attacker forgot to change the lure from a previous exploit, or simply didn’t find it necessary. This lure, while inconsistent with the original filename, is in line with the other InPage exploit file that also looked to be of the same subject matter.<br />
The executable file in the ‘%TEMP%\winopen.exe’ path has the following attributes:</p>
<table>
<tbody>
<tr>
<td width="110"><strong>SHA256</strong></td>
<td width="358">692815d06b720669585a71bc8151b89ca6748f882b35e365e08cfaf6eda77049</td>
</tr>
<tr>
<td width="110"><strong>Compile Timestamp</strong></td>
<td width="358">2017-07-31 06:03:42 UTC</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
This particular executable is made to resemble the legitimate application Putty. Unlike other files we witnessed up to this point, this sample has rudimentary anti-debugging and anti-analysis techniques in place prior to the main execution flow.<br />
It proceeds to decrypt an embedded resource object using the RC4 algorithm. The following key is used for decryption:</p>
<ul>
<li>VACqItywGR1v3qGxVZQPYXxMZV0o2fzp</li>
</ul>
<p>After this data is decrypted, the following registry key is written to ensure persistence. Again, we see the malware mimic the appearance of the legitimate Putty application.</p>
<ul>
<li>HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce\Putty &#8211; %TEMP%\winopen.exe</li>
</ul>
<p>Finally, the malware will spawn a new suspended instance of itself, where the decrypted data is written and subsequently executed.<br />
This next stage of malware has the following properties:</p>
<table>
<tbody>
<tr>
<td width="107"><strong>SHA256</strong></td>
<td width="360">bb5540fe0bbc0cda08865aad891a585cd465b224bfe84762216cd04178087516</td>
</tr>
<tr>
<td width="107"><strong>Compile Timestamp</strong></td>
<td width="360">2017-05-17 05:47:05 UTC</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
This malware operates almost identical to the previously witnessed sample. However, this time the embedded resource object is decrypted using the following RC4 key:</p>
<ul>
<li>kRPAnN2DN6vfrxsJ55Lntnh7Mma8E68s</li>
</ul>
<p>The next, and last stage of this malware execution has the following attributes:</p>
<table>
<tbody>
<tr>
<td width="109"><strong>SHA256</strong></td>
<td width="359">d1a14bc3160f5ed6232ceaf40de1959d7dba3eae614efd2882b04d538cda825b</td>
</tr>
<tr>
<td width="109"><strong>Compile Timestamp</strong></td>
<td width="359">2016-10-31 02:41:09 UTC</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
This final payload is an instance of the CONFUCIUS_B malware family, which <a href="https://researchcenter.paloaltonetworks.com/2016/09/unit42-confucius-says-malware-families-get-further-by-abusing-legitimate-websites/">we have previously discussed</a>. This particular sample attempts to connect to the following host for C2 operations:</p>
<ul>
<li>151.80.14[.]194</li>
</ul>
<p id="intelligence-report"><span style="font-size: 18pt;"><br />
Intelligence Report-561 (1).inp</span></p>
<p>We identified this malicious InPage document as having the following attributes:</p>
<table>
<tbody>
<tr>
<td width="118"><strong>SHA256</strong></td>
<td width="350">35c5f6030513f11fd1dcf9bd232de457ba7f3af3aedc0e2e976895b296a09df6</td>
</tr>
<tr>
<td width="118"><strong>Original Filename</strong></td>
<td width="350">Intelligence Report-561 (1).inp</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
This particular exploit file uses the exact same shellcode witnessed previously, where an embedded DLL is loaded into memory. Again, this executable drops and executes two files—a Microsoft Windows executable payload and an InPage decoy document.<br />
The embedded payload within the shellcode has the following attributes:</p>
<table>
<tbody>
<tr>
<td width="105"><strong>SHA256</strong></td>
<td width="363">83e3b2938ee6a3e354c93c6ec756da96b03cc69118b5748b07aee4d900da1844</td>
</tr>
<tr>
<td width="105"><strong>Compile Timestamp</strong></td>
<td width="363">2015-05-08 12:51:54 UTC</td>
</tr>
<tr>
<td width="105"><strong>PDB String</strong></td>
<td width="363">c:\users\mz\documents\visual studio 2013\Projects\Shellcode\Release\Shellcode.pdb</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
Again, we see the executable payload and decoy document dropped to the following respective locations:</p>
<ul>
<li>%TEMP%\winopen.exe</li>
<li>%TEMP%\SAMPLE.inp</li>
</ul>
<p>The dropped executable is a previously undocumented backdoor written in Delphi that has been named BioData by multiple antivirus organizations.<br />
This InPage exploit document follows a much simpler execution flow, as seen in the following diagram.<br />
<img class="aligncenter wp-image-48543" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_4.png" alt="inpage_4" width="400" height="319" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_4.png 679w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_4-300x239.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_4-370x295.png 370w" sizes="(max-width: 400px) 100vw, 400px" /></p>
<p style="text-align: center;"><em>Figure 4 InPage exploit execution flow</em></p>
<p>&nbsp;<br />
The decoy InPage file dropped by this malware looks like the following. The language used within it appears to be a mix of Arabic and Urdu. A rough translation has been provided in red in the image below.<br />
<img class="aligncenter wp-image-48519" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_5.png" alt="inpage_5" width="600" height="476" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_5.png 927w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_5-900x714.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_5-300x238.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_5-768x609.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_5-370x293.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 5 Decoy InPage document dropped by malware</em></p>
<p>&nbsp;<br />
The Biodata payload has the following attributes:</p>
<table>
<tbody>
<tr>
<td width="109"><strong>SHA256</strong></td>
<td width="358">5716509e4cdbf8ffa5fbce02b8881320cb852d98e590215455986a5604a453f7</td>
</tr>
<tr>
<td width="109"><strong>Compile Timestamp</strong></td>
<td width="358">1992-06-19 22:22:17 UTC</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
Note that the timestamp above is the result of this sample being compiled in Delphi, which uses the same hardcoded compilation timestamp for all samples that are generated.<br />
Throughout the execution of this sample, numerous strings are decoded using a customized 94-character substitution table. BioData will go through each character of the obfuscated string, and will replace each character based on the following table:<br />
<img class="aligncenter wp-image-48495" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_6.png" alt="inpage_6" width="600" height="107" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_6.png 973w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_6-900x160.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_6-300x53.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_6-768x137.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_6-370x66.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 6 Substitution table used by BioData</em></p>
<p>&nbsp;<br />
The malware proceeds to generate and create a ‘Document’ folder within the %USERPROFILE% directory. This folder will contain all of the malware’s files throughout its execution. In order to maintain persistence, the malware will generate the following file in the startup folder, which points to the current path of the BioData executable:</p>
<ul>
<li>Adobe creative suit.lnk</li>
</ul>
<p>BioData proceeds to generate a randomized 30-character string of uppercase and lowercase letters. This string is written to the following file:</p>
<ul>
<li>%USERPROFILE%\Document\users.txt</li>
</ul>
<p>This 30-character string is used by the malware to act as a unique identifier for the victim, and will be used for all network communication with a remote server.<br />
The username and computer name are identified, and are written to a string of the following format:</p>
<ul>
<li>User name and System Name :- [Username]_[Computer Name]</li>
</ul>
<p>This data is obfuscated and written to the following file:</p>
<ul>
<li>%USERPROFILE%\Document\SyLog.log</li>
</ul>
<p>In order to obfuscate this data, the malware uses a unique algorithm. Represented in Python, the following script will decode this file:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cbf9864d997492374" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import sys
from binascii import *
file = sys.argv[1]
fh = open(file, 'rb')
fd = fh.read()
fh.close()
def bit_not(n, numbits=8):
  return (1 &lt;&lt; numbits) - 1 - n
def decode(data):
  c = 0
  output = ""
  for d in data:
    o = bit_not((0x6121 &gt;&gt; c) &amp; 0xFF)
    output += chr(ord(d) ^ o)
    c += 1
    if c == 32:
      c = 0
  return output
print decode(fd)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cbf9864d997492374-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cbf9864d997492374-2">2</div><div class="crayon-num" data-line="crayon-5f694cbf9864d997492374-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cbf9864d997492374-4">4</div><div class="crayon-num" data-line="crayon-5f694cbf9864d997492374-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cbf9864d997492374-6">6</div><div class="crayon-num" data-line="crayon-5f694cbf9864d997492374-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cbf9864d997492374-8">8</div><div class="crayon-num" data-line="crayon-5f694cbf9864d997492374-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cbf9864d997492374-10">10</div><div class="crayon-num" data-line="crayon-5f694cbf9864d997492374-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cbf9864d997492374-12">12</div><div class="crayon-num" data-line="crayon-5f694cbf9864d997492374-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cbf9864d997492374-14">14</div><div class="crayon-num" data-line="crayon-5f694cbf9864d997492374-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cbf9864d997492374-16">16</div><div class="crayon-num" data-line="crayon-5f694cbf9864d997492374-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cbf9864d997492374-18">18</div><div class="crayon-num" data-line="crayon-5f694cbf9864d997492374-19">19</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cbf9864d997492374-1"><span class="crayon-e">import </span><span class="crayon-e">sys</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cbf9864d997492374-2"><span class="crayon-e">from </span><span class="crayon-e">binascii </span><span class="crayon-e ">import *</span></div><div class="crayon-line" id="crayon-5f694cbf9864d997492374-3"><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sys</span><span class="crayon-sy">.</span><span class="crayon-v">argv</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cbf9864d997492374-4"><span class="crayon-v">fh</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">file</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'rb'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cbf9864d997492374-5"><span class="crayon-v">fd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">fh</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cbf9864d997492374-6"><span class="crayon-v">fh</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cbf9864d997492374-7"><span class="crayon-e">def </span><span class="crayon-e">bit_not</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">numbits</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cbf9864d997492374-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">numbits</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-i">n</span></div><div class="crayon-line" id="crayon-5f694cbf9864d997492374-9"><span class="crayon-e">def </span><span class="crayon-e">decode</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cbf9864d997492374-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5f694cbf9864d997492374-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cbf9864d997492374-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cbf9864d997492374-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">o</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">bit_not</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">0x6121</span><span class="crayon-h"> </span><span class="crayon-o">&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cbf9864d997492374-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-v">d</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-v">o</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f694cbf9864d997492374-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cbf9864d997492374-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5f694cbf9864d997492374-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cbf9864d997492374-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">output</span></div><div class="crayon-line" id="crayon-5f694cbf9864d997492374-19"><span class="crayon-e">print </span><span class="crayon-e">decode</span><span class="crayon-sy">(</span><span class="crayon-v">fd</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>BioData sends both GET and POST requests to the following URL:</p>
<ul>
<li>http://errorfeedback[.]com/MarkQuality455/developerbuild.php</li>
</ul>
<p>POST requests are made with a hardcoded User-Agent, shown below in Figure 7. Additionally, a ‘b’ GET parameter is included that contains the victim’s previously generated unique identifier. The contents of the POST requests are the obfuscated SyLog.log file. The remote C2 server has been observed responding to these requests with ‘Success’. These requests simply act as a beacon, including the basic victim information that was previously obtained.<br />
<img class="aligncenter wp-image-48471" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_7.png" alt="inpage_7" width="600" height="292" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_7.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_7-380x184.png 380w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_7-900x438.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_7-300x146.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_7-768x374.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_7-370x180.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 7 HTTP POST request by BioData</em></p>
<p>&nbsp;<br />
GET requests are made in a slightly different fashion. These requests contain an empty User-Agent, and are also found to be missing a number of HTTP headers that are commonly seen.<br />
&nbsp;<br />
<img class="aligncenter wp-image-48447" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_8.png" alt="inpage_8" width="600" height="200" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_8.png 975w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_8-900x300.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_8-300x100.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_8-768x256.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_8-370x123.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 8 HTTP GET request by BioData</em></p>
<p>&nbsp;<br />
Unlike the POST requests, the malware both looks for and makes use of the response given, if any, by the C2 server. The malware parses any response given by first hex-decoding it. It then base64-decodes the resulting string. The final string is used to form a subsequent GET request.<br />
If for instance, the malware responded with a decoded string of ‘malware.exe’, the subsequent GET request would look like the following:</p>
<ul>
<li>http://errorfeedback[.]com/MarkQuality455/bzGwXILtkMRZaJxzciXAeCYviduBuy/malware.exe</li>
</ul>
<p>The request above uses the same victim identifier that has been observed in the previous examples provided.<br />
This hypothetical ‘malware.exe’ request contains the raw contents of the payload that BioData will drop to disk and execute. The contents are placed in the following file path for this hypothetical:</p>
<ul>
<li>%USERPROFILE%\Document\malware.exe</li>
</ul>
<p>Finally, after this dropped payload is successfully executed, the malware will send a GET request such as the following:</p>
<ul>
<li>http://errorfeedback[.]com/MarkQuality455/developerbuild.php?f=62574673643246795a53356c654755&amp;b=bzGwXILtkMRZaJxzciXAeCYviduBuy</li>
</ul>
<p>In the above example, the ‘b’ parameter is the victim identifier, and the ‘f’ parameter is the string of ‘malware.exe’ after it has been base64-encoded and hex-encoded. This request alerts the attack that the hypothetical payload of ‘malware.exe’ has been run.</p>
<p id="tehreek"><span style="font-size: 18pt;"><br />
Tehreek-E-Kashmir Mujahaid List.inp</span></p>
<p>We identified this malicious InPage document as having the following attributes:</p>
<table>
<tbody>
<tr>
<td width="113"><strong>SHA256</strong></td>
<td width="354">3e410397955d5a127182d69e019dbc8bbffeee864cd9c96e577c9c13f05a232f</td>
</tr>
<tr>
<td width="113"><strong>Original Filename</strong></td>
<td width="354">Tehreek-E-Kashmir Mujahaid List.inp</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
Unfortunately, no decoy document was included with this exploit file. However, the filename provides clues as to the context that may have been present when this file was delivered to the intended recipient. The phrase ‘Tehreek-E-Kashmir’ is most likely related to the conflict in the Kashmir region of India. Additionally, the term ‘Mujahaid’ may be a misspelling of the word ‘Mujahid’, a term used to describe an individual engaged in Jihad.<br />
This particular InPage shellcode looks to be near identical to the two others previously discussed, however, it appears as though the attackers simply partially overwrote the original shellcode that was present to substitute their own. This results in the shellcode acting as a downloader, instead of loading an embedded payload. We can see the modifications visually in the following image:<br />
<img class="aligncenter wp-image-48423" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_9.png" alt="inpage_9" width="600" height="505" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_9.png 973w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_9-900x758.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_9-300x253.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_9-768x646.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_9-370x311.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 9 Differences between InPage exploit documents</em></p>
<p>&nbsp;<br />
In the image above, the ‘Cyber Advisory No 91.inp’ exploit file has the large additional size, as it included the payload. The ‘Tehreek-E-Kashmir Mujahaid List.inp’ exploit file instead has removed this. However, original artifacts from the original shellcode are still present, including the function that loads Microsoft Windows API calls using the unique hashing algorithm.<br />
The shellcode begins by iterating through the Process Environment Block (PEB), searching for a loaded module that has a ‘3’ in the 7<sup>th</sup> position. In other words, the shellcode uses a simple trick to search for kernel32.dll. It proceeds to iterate through kernel32’s functions, looking for the GetProcAddress function. In order to find this function it will compare the first four letters against ‘GetP’, and the third set of four letters against ‘ddre’.<br />
The shellcode then gets the address of the WinExec function, which in turn is used to execute the following command:</p>
<ul>
<li>cmd /c mkdir C:\Wins</li>
</ul>
<p>It then performs the following:</p>
<ol>
<li>Gets the address of the LoadLibraryA function</li>
<li>Loads the urlmon.dll library</li>
<li>Gets the address of the URLDownloadToFileA function</li>
</ol>
<p>The shellcode then proceeds to make a request to the following URL and download the response to ‘C:\Wins\cnh’.</p>
<ul>
<li>http://zmwardrobe[.]com/wp-sign</li>
</ul>
<p>Finally, the shellcode will execute this downloaded file via a call to WinExec.<br />
The response from this webserver returned a payload, that we have named MY24, with the following attributes:</p>
<table>
<tbody>
<tr>
<td width="107"><strong>SHA256</strong></td>
<td width="360">71b7de2e3a60803df1c3fdc46af4fd8cfb7c803a53c9a85f7311348f6ff88cbe</td>
</tr>
<tr>
<td width="107"><strong>Compile Timestamp</strong></td>
<td width="360">2017-05-18 05:26:54 UTC</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
It should also be noted that a malicious Microsoft Word document with the following properties was observed downloading and executing the same payload.</p>
<table>
<tbody>
<tr>
<td width="107"><strong>SHA256</strong></td>
<td width="360">3f1d3d02e7707b2bc686b5add875e1258c65a0facd5cf8910ba0f321e230e17c</td>
</tr>
<tr>
<td width="107"><strong>Original Filename</strong></td>
<td width="360">Las Vegas ISIS Claim Proof.doc</td>
</tr>
<tr>
<td width="107"><strong>First Seen</strong></td>
<td width="360">2017-10-05 05:53:27</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
<strong>MY24 Analysis</strong><br />
This backdoor begins by decoding a series of embedded strings by adding 33 to each character. The following example within the Python interpreter demonstrates this:<br />
<img class="aligncenter wp-image-48399" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_10.png" alt="inpage_10" width="400" height="158" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_10.png 608w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_10-300x118.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_10-370x146.png 370w" sizes="(max-width: 400px) 100vw, 400px" /></p>
<p style="text-align: center;"><em>Figure 10 Example string decoding within Python interpreter</em></p>
<p>&nbsp;<br />
The malware proceeds to execute a function that is responsible for generating the following path:</p>
<ul>
<li>%APPDATA%\Startup\wintasks.exe</li>
</ul>
<p>However, this path is never used, leading us to believe that the malware author had the intention of copying the payload to this destination and likely setting persistence, but seemingly forgot to.<br />
MY24 proceeds to spawn two timers where the functions are responsible for resolving the C2 domain of userveblog.ddns[.]net, as well as connecting to this domain.<br />
Two new threads are then created—one for handling any data that is received from the connection to the C2 and one that is responsible for sending out data.<br />
Finally, a function is called that is responsible for collecting information about the victim machine. The following information is collected:</p>
<ul>
<li>Version of Microsoft Windows</li>
<li>Username</li>
<li>Computer name</li>
</ul>
<p>The MY24 instance expects to receive a command initially from the remote server of userveblog.ddns[.]net on port 9832. All communication is performed using raw sockets via a custom communication protocol. The packets received by the malware have the following format:<br />
<img class="aligncenter wp-image-48375" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_11.png" alt="inpage_11" width="400" height="84" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_11.png 668w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_11-300x63.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_11-370x78.png 370w" sizes="(max-width: 400px) 100vw, 400px" /></p>
<p style="text-align: center;"><em>Figure 11 Received packet format for MY24 malware</em></p>
<p>&nbsp;<br />
All data received and sent by MY24 is encrypted using a 13-byte XOR key of &#8220;t6%9k$2Ri9ctv&#8221;. The data portion of the received command will include one of the following commands:</p>
<table>
<tbody>
<tr>
<td width="126"><strong>Received Command</strong></td>
<td width="342"><strong>Description</strong></td>
</tr>
<tr>
<td width="126">2000</td>
<td width="342">Return victim information</td>
</tr>
<tr>
<td width="126">2001</td>
<td width="342">Get drive information</td>
</tr>
<tr>
<td width="126">2002</td>
<td width="342">List files</td>
</tr>
<tr>
<td width="126">2004</td>
<td width="342">Unknown</td>
</tr>
<tr>
<td width="126">2005</td>
<td width="342">Create file handle to append data</td>
</tr>
<tr>
<td width="126">2006</td>
<td width="342">Write appended data to previously created file handle</td>
</tr>
<tr>
<td width="126">2007</td>
<td width="342">Create file handle for reading data</td>
</tr>
<tr>
<td width="126">2009</td>
<td width="342">Read data from previously created file handle</td>
</tr>
<tr>
<td width="126">2012</td>
<td width="342">Spawn a shell of cmd.exe</td>
</tr>
<tr>
<td width="126">2013</td>
<td width="342">Interact with previously spawned shell</td>
</tr>
<tr>
<td width="126">2015</td>
<td width="342">Unknown</td>
</tr>
<tr>
<td width="126">2016</td>
<td width="342">Kill previously spawned shell</td>
</tr>
<tr>
<td width="126">2019</td>
<td width="342">List current process network communication on the victim machine</td>
</tr>
<tr>
<td width="126">2021</td>
<td width="342">Unknown</td>
</tr>
<tr>
<td width="126">2022</td>
<td width="342">Kill process</td>
</tr>
<tr>
<td width="126">2023</td>
<td width="342">Enumerate processes</td>
</tr>
<tr>
<td width="126">2025</td>
<td width="342">Unknown</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
Responses sometimes vary in size, but are primarily sent with a size of 9084 bytes. The author of this tool did not allocate proper buffer size when sending out the data, resulting in part of the stack being included in the response by the MY24 malware. Examples of commands being sent and received may be seen below. A custom server was written to interact with the MY24 malware, which is seen in the following image.<br />
&nbsp;<br />
<img class="aligncenter wp-image-48351" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_12.png" alt="inpage_12" width="600" height="159" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_12.png 973w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_12-900x239.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_12-300x80.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_12-768x204.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/11/inpage_12-370x98.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 12 Interacting with MY24 backdoor</em></p>
<h1><span style="font-size: 18pt;">Conclusion</span></h1>
<p>While documents designed to exploit the InPage software are rare, they are not new &#8211; however in recent weeks Unit42 has observed numerous InPage exploits leveraging similar shellcode, suggesting continued use of the exploit previously discussed by Kaspersky.<br />
The decoy documents dropped suggest that the targets are likely to be politically or militarily motivated, with subjects such as Intelligence reports and political situations being used as lure documents. The variety of malware payloads dropped suggests the attackers behind these attacks have a reasonable development resource behind them and Unit42 continues to observe new versions of these malware families being created.<br />
Palo Alto Networks customers are protected against these threats in a number of ways:</p>
<ul>
<li>All domains observed in these malware families have been flagged as malicious.</li>
<li>All payloads are appropriately categorized as malicious within the WildFire platform and blocked by Traps.</li>
<li>The payloads witnessed have been tagged in AutoFocus as <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Confucius_B">Confucius_B</a>, <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.MY24">MY24</a>, and <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.BioData">BioData</a> for continued tracking and observation.</li>
</ul>
<p><span style="font-size: 18pt;"><br />
Appendix</span><br />
<strong>YARA Rules</strong></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f694cbf98656900338411" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
rule InPageShellcodeHashing
{
	strings:
		$hashingFunction = {55 8B EC 51 53 52 33 C9 33 DB 33 D2 8B 45 08 8A 10 80 CA 60 03 DA D1 E3 03 45 10 8A 08 84 C9 E0 EE 33 C0 8B 4D 0C 3B D9 74 01 40 5A 5B 59 8B E5 5D C2 0C 00}
	condition:
		$hashingFunction
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f694cbf98656900338411-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cbf98656900338411-2">2</div><div class="crayon-num" data-line="crayon-5f694cbf98656900338411-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cbf98656900338411-4">4</div><div class="crayon-num" data-line="crayon-5f694cbf98656900338411-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f694cbf98656900338411-6">6</div><div class="crayon-num" data-line="crayon-5f694cbf98656900338411-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f694cbf98656900338411-1"><span class="crayon-e">rule</span><span class="crayon-h"> </span><span class="crayon-e">InPageShellcodeHashing</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cbf98656900338411-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f694cbf98656900338411-3"><span class="crayon-h">	</span><span class="crayon-v">strings</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cbf98656900338411-4"><span class="crayon-h">		</span><span class="crayon-sy">$</span><span class="crayon-v">hashingFunction</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-cn">55</span><span class="crayon-h"> </span><span class="crayon-cn">8B</span><span class="crayon-h"> </span><span class="crayon-i">EC</span><span class="crayon-h"> </span><span class="crayon-cn">51</span><span class="crayon-h"> </span><span class="crayon-cn">53</span><span class="crayon-h"> </span><span class="crayon-cn">52</span><span class="crayon-h"> </span><span class="crayon-cn">33</span><span class="crayon-h"> </span><span class="crayon-i">C9</span><span class="crayon-h"> </span><span class="crayon-cn">33</span><span class="crayon-h"> </span><span class="crayon-i">DB</span><span class="crayon-h"> </span><span class="crayon-cn">33</span><span class="crayon-h"> </span><span class="crayon-i">D2</span><span class="crayon-h"> </span><span class="crayon-cn">8B</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-h"> </span><span class="crayon-cn">08</span><span class="crayon-h"> </span><span class="crayon-cn">8A</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-h"> </span><span class="crayon-i">CA</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-h"> </span><span class="crayon-cn">03</span><span class="crayon-h"> </span><span class="crayon-e">DA </span><span class="crayon-e">D1 </span><span class="crayon-i">E3</span><span class="crayon-h"> </span><span class="crayon-cn">03</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-cn">8A</span><span class="crayon-h"> </span><span class="crayon-cn">08</span><span class="crayon-h"> </span><span class="crayon-cn">84</span><span class="crayon-h"> </span><span class="crayon-e">C9 </span><span class="crayon-e">E0 </span><span class="crayon-i">EE</span><span class="crayon-h"> </span><span class="crayon-cn">33</span><span class="crayon-h"> </span><span class="crayon-i">C0</span><span class="crayon-h"> </span><span class="crayon-cn">8B</span><span class="crayon-h"> </span><span class="crayon-cn">4D</span><span class="crayon-h"> </span><span class="crayon-cn">0C</span><span class="crayon-h"> </span><span class="crayon-cn">3B</span><span class="crayon-h"> </span><span class="crayon-i">D9</span><span class="crayon-h"> </span><span class="crayon-cn">74</span><span class="crayon-h"> </span><span class="crayon-cn">01</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-h"> </span><span class="crayon-cn">5A</span><span class="crayon-h"> </span><span class="crayon-cn">5B</span><span class="crayon-h"> </span><span class="crayon-cn">59</span><span class="crayon-h"> </span><span class="crayon-cn">8B</span><span class="crayon-h"> </span><span class="crayon-i">E5</span><span class="crayon-h"> </span><span class="crayon-cn">5D</span><span class="crayon-h"> </span><span class="crayon-i">C2</span><span class="crayon-h"> </span><span class="crayon-cn">0C</span><span class="crayon-h"> </span><span class="crayon-cn">00</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f694cbf98656900338411-5"><span class="crayon-h">	</span><span class="crayon-v">condition</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f694cbf98656900338411-6"><span class="crayon-h">		</span><span class="crayon-sy">$</span><span class="crayon-i">hashingFunction</span></div><div class="crayon-line" id="crayon-5f694cbf98656900338411-7"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>&nbsp;</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>

<script type="text/javascript" src="https://researchcenter.paloaltonetworks.com/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.9"></script>
        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2020 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
            <script type="text/javascript">
            (function(){
                document.addEventListener('DOMContentLoaded', function(){
                    let wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                    if ( wpp_widgets ) {
                        for (let i = 0; i < wpp_widgets.length; i++) {
                            let wpp_widget = wpp_widgets[i];
                            WordPressPopularPosts.theme(wpp_widget);
                        }
                    }
                });
            })();
        </script>
                <script>
            var WPPImageObserver = null;

            function wpp_load_img(img) {
                if ( ! 'imgSrc' in img.dataset || ! img.dataset.imgSrc )
                    return;

                img.src = img.dataset.imgSrc;

                if ( 'imgSrcset' in img.dataset ) {
                    img.srcset = img.dataset.imgSrcset;
                    img.removeAttribute('data-img-srcset');
                }

                img.classList.remove('wpp-lazyload');
                img.removeAttribute('data-img-src');
                img.classList.add('wpp-lazyloaded');
            }

            function wpp_observe_imgs(){
                let wpp_images = document.querySelectorAll('img.wpp-lazyload'),
                    wpp_widgets = document.querySelectorAll('.popular-posts-sr');

                if ( wpp_images.length || wpp_widgets.length ) {
                    if ( 'IntersectionObserver' in window ) {
                        WPPImageObserver = new IntersectionObserver(function(entries, observer) {
                            entries.forEach(function(entry) {
                                if (entry.isIntersecting) {
                                    let img = entry.target;
                                    wpp_load_img(img);
                                    WPPImageObserver.unobserve(img);
                                }
                            });
                        });

                        if ( wpp_images.length ) {
                            wpp_images.forEach(function(image) {
                                WPPImageObserver.observe(image);
                            });
                        }

                        if ( wpp_widgets.length ) {
                            for (var i = 0; i < wpp_widgets.length; i++) {
                                let wpp_widget_images = wpp_widgets[i].querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widgets[i].shadowRoot ) {
                                    wpp_widget_images = wpp_widgets[i].shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    wpp_widget_images.forEach(function(image) {
                                        WPPImageObserver.observe(image);
                                    });
                                }
                            }
                        }
                    } /** Fallback for older browsers */
                    else {
                        if ( wpp_images.length ) {
                            for (var i = 0; i < wpp_images.length; i++) {
                                wpp_load_img(wpp_images[i]);
                                wpp_images[i].classList.remove('wpp-lazyloaded');
                            }
                        }

                        if ( wpp_widgets.length ) {
                            for (var j = 0; j < wpp_widgets.length; j++) {
                                let wpp_widget = wpp_widgets[j],
                                    wpp_widget_images = wpp_widget.querySelectorAll('img.wpp-lazyload');

                                if ( ! wpp_widget_images.length && wpp_widget.shadowRoot ) {
                                    wpp_widget_images = wpp_widget.shadowRoot.querySelectorAll('img.wpp-lazyload');
                                }

                                if ( wpp_widget_images.length ) {
                                    for (var k = 0; k < wpp_widget_images.length; k++) {
                                        wpp_load_img(wpp_widget_images[k]);
                                        wpp_widget_images[k].classList.remove('wpp-lazyloaded');
                                    }
                                }
                            }
                        }
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                wpp_observe_imgs();

                // When an ajaxified WPP widget loads,
                // Lazy load its images
                document.addEventListener('wpp-onload', function(){
                    wpp_observe_imgs();
                });
            });
        </script>
        <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
