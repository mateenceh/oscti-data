<!DOCTYPE html>
<html >
<head>
	<meta charset="UTF-8" />
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<script type="text/javascript">
var gform;gform||(document.addEventListener("gform_main_scripts_loaded",function(){gform.scriptsLoaded=!0}),window.addEventListener("DOMContentLoaded",function(){gform.domLoaded=!0}),gform={domLoaded:!1,scriptsLoaded:!1,initializeOnLoaded:function(o){gform.domLoaded&&gform.scriptsLoaded?o():!gform.domLoaded&&gform.scriptsLoaded?window.addEventListener("DOMContentLoaded",o):document.addEventListener("gform_main_scripts_loaded",o)},hooks:{action:{},filter:{}},addAction:function(o,n,r,t){gform.addHook("action",o,n,r,t)},addFilter:function(o,n,r,t){gform.addHook("filter",o,n,r,t)},doAction:function(o){gform.doHook("action",o,arguments)},applyFilters:function(o){return gform.doHook("filter",o,arguments)},removeAction:function(o,n){gform.removeHook("action",o,n)},removeFilter:function(o,n,r){gform.removeHook("filter",o,n,r)},addHook:function(o,n,r,t,i){null==gform.hooks[o][n]&&(gform.hooks[o][n]=[]);var e=gform.hooks[o][n];null==i&&(i=n+"_"+e.length),gform.hooks[o][n].push({tag:i,callable:r,priority:t=null==t?10:t})},doHook:function(n,o,r){var t;if(r=Array.prototype.slice.call(r,1),null!=gform.hooks[n][o]&&((o=gform.hooks[n][o]).sort(function(o,n){return o.priority-n.priority}),o.forEach(function(o){"function"!=typeof(t=o.callable)&&(t=window[t]),"action"==n?t.apply(null,r):r[0]=t.apply(null,r)})),"filter"==n)return r[0]},removeHook:function(o,n,t,i){var r;null!=gform.hooks[o][n]&&(r=(r=gform.hooks[o][n]).filter(function(o,n,r){return!!(null!=i&&i!=o.tag||null!=t&&t!=o.priority)}),gform.hooks[o][n]=r)}});
</script>

	<link rel="profile" href="http://gmpg.org/xfn/11" />
	<link rel="pingback" href="https://securelist.com/xmlrpc.php" />
	<link rel="apple-touch-icon" sizes="180x180" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/favicons/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/favicons/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/favicons/favicon-16x16.png">
	<link rel="manifest" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/favicons/site.webmanifest">
	<link rel="shortcut icon" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/favicons/favicon.ico">
	<title>Inside the EquationDrug Espionage Platform | Securelist</title>

<!-- The SEO Framework by Sybre Waaijer -->
<meta name="keywords" content="APT,Cyber espionage,Equation,Malware Descriptions,Malware Technologies,Nation State Sponsored Espionage,Spyware,Stuxnet,Targeted attacks" />
<meta name="description" content="EquationDrug represents the main espionage platform from the Equation Group. It’s been in use for over 10 years, replacing EquationLaser until it was itself replaced itself by the even more sophisticated GrayFish platform." />
<meta property="og:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/03/08063246/175648301.jpg" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Inside the EquationDrug Espionage Platform" />
<meta property="og:description" content="EquationDrug represents the main espionage platform from the Equation Group. It’s been in use for over 10 years, replacing EquationLaser until it was itself replaced itself by the even more sophisticated GrayFish platform." />
<meta property="og:url" content="https://securelist.com/inside-the-equationdrug-espionage-platform/69203/" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@Securelist" />
<meta name="twitter:creator" content="@Securelist" />
<meta name="twitter:title" content="Inside the EquationDrug Espionage Platform" />
<meta name="twitter:description" content="EquationDrug represents the main espionage platform from the Equation Group. It’s been in use for over 10 years, replacing EquationLaser until it was itself replaced itself by the even more sophisticated GrayFish platform." />
<meta name="twitter:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/03/08063246/175648301.jpg" />
<link rel="canonical" href="https://securelist.com/inside-the-equationdrug-espionage-platform/69203/" />
<script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://securelist.com/","name":"Securelist"}},{"@type":"ListItem","position":2,"item":{"@id":"https://securelist.com/category/apt-reports/","name":"Category: APT reports"}},{"@type":"ListItem","position":3,"item":{"@id":"https://securelist.com/inside-the-equationdrug-espionage-platform/69203/","name":"Inside the EquationDrug Espionage Platform"}}]}</script>
<script type="application/ld+json">{"@context":"https://schema.org","@type":"NewsArticle","mainEntityOfPage":{"@type":"WebPage","@id":"https://securelist.com/inside-the-equationdrug-espionage-platform/69203/"},"headline":"Inside the EquationDrug Espionage Platform","image":"https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/03/08063246/175648301.jpg","datePublished":"2015-03-11T11:00:01+00:00","dateModified":"2021-02-15T12:25:38+00:00","author":{"@type":"Person","name":"GReAT"},"publisher":{"@type":"Organization","name":"Kaspersky","logo":{"@type":"ImageObject","url":"https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2019/06/04065705/article-logo-small_new.png","width":60,"height":60}},"description":"EquationDrug represents the main espionage platform from the Equation Group. It\u2019s been in use for over 10 years, replacing EquationLaser until it was itself replaced itself by the even more sophisticated GrayFish platform."}</script>
<!-- / The SEO Framework by Sybre Waaijer | 20.75ms meta | 0.41ms boot -->

<link rel='dns-prefetch' href='//kasperskycontenthub.com' />
<link rel='dns-prefetch' href='//securelist.com' />
<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//media.kaspersky.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Securelist - English - Global - securelist.com &raquo; Feed" href="https://securelist.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Securelist - English - Global - securelist.com &raquo; Comments Feed" href="https://securelist.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Securelist - English - Global - securelist.com &raquo; Inside the EquationDrug Espionage Platform Comments Feed" href="https://securelist.com/inside-the-equationdrug-espionage-platform/69203/feed/" />
<link rel='stylesheet' id='crayon-group-css' href='//assets.kasperskycontenthub.com/wp-content/plugins/bwp-minify/min/?f=wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css,wp-includes/css/dist/block-library/style.min.css,wp-content/plugins/jquery-collapse-o-matic/css/core_style.css,wp-content/plugins/jquery-collapse-o-matic/css/light_style.css,wp-content/plugins/honeypot-comments/public/assets/css/public.css,wp-content/plugins/kspr_twitter_pullquote/css/style.css,wp-content/themes/securelist2020/assets/css/main.css,wp-content/plugins/kaspersky-social-sharing/assets/css/style.css,wp-content/plugins/kaspersky-social-sharing/assets/css/custom.css&#038;ver=816b5101' type='text/css' media='all' />
<link rel='stylesheet' id='taxonomy-image-plugin-public-group-css' href='//assets.kasperskycontenthub.com/wp-content/plugins/bwp-minify/min/?f=wp-content/plugins/taxonomy-images/css/style.css&#038;ver=816b5101' type='text/css' media='screen' />
<script type='text/javascript' src='https://securelist.com/wp-content/plugins/kaspersky-enable-jquery-migrate-helper/js/jquery/jquery-1.12.4-wp.js?ver=1.12.4-wp' id='jquery-core-js'></script>
<script type='text/javascript' id='kaspersky-sso-integration-js-extra'>
/* <![CDATA[ */
var kasperskySSOIntegrationData = {"authorizationURL":"https:\/\/auth.ca.uis.kaspersky.com\/connect\/authorize?client_id=securelist&client_name=Securelist&redirect_uri=https%3A%2F%2Fsecurelist.com%2Fkaspersky-sso%2Flogin%2F&response_type=code&scope=openid email profile offline_access","endSessionURL":"https:\/\/auth.ca.uis.kaspersky.com\/connect\/endsession?id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6IjhCODgxMjhBNTc4RTIxRTk3OEFBOTVENEYwRUQxMzQyNDU1NTk1ODAiLCJ4NXQiOiJpNGdTaWxlT0llbDRxcFhVOE8wVFFrVlZsWUEiLCJ0eXAiOiJKV1QifQ.eyJuYmYiOjE2NDc4MDg4OTUsImV4cCI6MTY0Nzg5NTI5NSwiaXNzIjoiaHR0cHM6Ly9hdXRoLmNhLnVpcy5rYXNwZXJza3kuY29tIiwiYXVkIjoic2VjdXJlbGlzdCIsImlhdCI6MTY0NzgwODg5NSwiYXRfaGFzaCI6ImhBWDRJd3BUWUNWOVNiZUhPT1E4OVEiLCJzaWQiOiJfaUVxNER2bm1qVUtEVGdSSUk3YURBIiwic3ViIjoiMjhmMWI0YTYtNmYwZS00YmY1LWI5NDUtN2EzMjA0MjYwZDcyIiwiYXV0aF90aW1lIjoxNjQ3ODA4ODk0LCJpZHAiOiJLYXNwZXJza3lJZCIsImthc3BlcnNreS5zdWJfdmVyc2lvbiI6IjMifQ.A0pdhHwDIuWaPnLALKOnCc4YcJQr7y_oJ5UNGXGuutvcE-7FA8jVxYs3VXXSmE-xoNxGWPIKPk7Ps3gu-IMY8d3oO7zFMI0eSa3amcZEB0izneg1wt91dwxeZY0fYCvGzTXQK8x4mqMUwJJ8d4xy5MINN4u8G2YBEvd3mRoeXdrkRoFIMJvHFd1g2rUolfXS9Uk8nAYoKLHrDqk3F4gZa4EfFf1QjzXMfIIC8ReByJXH4yCl5V2Ntzb64U0QOvW68RJNa_CUqkoFx5Y-gnEreNwbDKb0EjewT8vnyaU6HdLskz4zHd0oSnGDVOHsIkpTkILuR1u3ispuLzhoqEAg2w&post_logout_redirect_uri=https:\/\/securelist.com\/kaspersky-sso\/logout\/"};
/* ]]> */
</script>
<script type='text/javascript' id='kss_js-js-extra'>
/* <![CDATA[ */
var kss = {"twitter_account":"Securelist"};
/* ]]> */
</script>
<script type='text/javascript' src='//assets.kasperskycontenthub.com/wp-content/plugins/bwp-minify/min/?f=wp-content/plugins/kaspersky-sso-integration/assets/js/main.js,wp-content/plugins/honeypot-comments/public/assets/js/public.js,wp-content/plugins/kspr_twitter_pullquote/js/kaspersky-twitter-pullquote.js,wp-content/plugins/kaspersky-social-sharing/assets/js/social-share.js&#038;ver=816b5101'></script>
<link rel="alternate" hreflang="x-default" href="https://securelist.com/inside-the-equationdrug-espionage-platform/69203/" />
		<script>
			window.dataLayer = window.dataLayer || [];
			window.dataLayer.push({
				'Author' : 'GReAT',
				'PostId' : '69203',
				'PublicationDate' : '2015-03-11',
				'Categories': 'APT reports',
				'Tags': 'APT, Cyber espionage, Equation, Malware Descriptions, Malware Technologies, Nation State Sponsored Espionage, Spyware, Stuxnet, Targeted attacks',
			});
		</script>
						<!-- Google Tag Manager -->
		<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
		new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
		j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
		'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-5CGZ3HG');</script>
		<!-- End Google Tag Manager -->

		<!-- Google Tag Manager -->
		<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
		new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
		j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
		'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-WZ7LJ3');</script>
		<!-- End Google Tag Manager -->
		<link rel="https://api.w.org/" href="https://securelist.com/wp-json/" /><link rel="alternate" type="application/json" href="https://securelist.com/wp-json/wp/v2/posts/69203" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://securelist.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://securelist.com/wp-includes/wlwmanifest.xml" /> 
<link rel="alternate" type="application/json+oembed" href="https://securelist.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fsecurelist.com%2Finside-the-equationdrug-espionage-platform%2F69203%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://securelist.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fsecurelist.com%2Finside-the-equationdrug-espionage-platform%2F69203%2F&#038;format=xml" />
<script type="text/javascript">
var sNew = document.createElement("script");
sNew.async = true;
sNew.src = "https://kasperskycontenthub.com/?dm=ed1f9e435dc885292eab65620c51f3fb&action=load&blogid=43&siteid=1&t=1959891974&back=https%3A%2F%2Fsecurelist.com%2Finside-the-equationdrug-espionage-platform%2F69203%2F"
var s0 = document.getElementsByTagName('script')[0];
s0.parentNode.insertBefore(sNew, s0);
</script>
			<meta property="fb:pages" content="115250821818252" />
			<script type="text/javascript">
document.write(unescape("%3Cscript src='//munchkin.marketo.net/munchkin.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script>Munchkin.init('802-IJN-240');</script><!-- Facebook Pixel Code -->
<script>
	!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
	n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
	n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
	t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
	document,'script','//connect.facebook.net/en_US/fbevents.js');
	fbq('init', '839281392784015');
	fbq('track', 'PageView');
</script>
<!-- End Facebook Pixel Code -->
        
<script>
(function() {
    var s = document.getElementsByTagName('script')[0]
      , p = document.createElement('script');
    p.async = 'async';
    p.src = '//rum-static.pingdom.net/pa-560b0cc5abe53daf128a2dfc.js';
    s.parentNode.insertBefore(p, s);
})();
</script>


        <script type="text/javascript">
            var jQueryMigrateHelperHasSentDowngrade = false;

			window.onerror = function( msg, url, line, col, error ) {
				// Break out early, do not processing if a downgrade reqeust was already sent.
				if ( jQueryMigrateHelperHasSentDowngrade ) {
					return true;
                }

				var xhr = new XMLHttpRequest();
				var nonce = '17405bdbb0';
				var jQueryFunctions = [
					'andSelf',
					'browser',
					'live',
					'boxModel',
					'support.boxModel',
					'size',
					'swap',
					'clean',
					'sub',
                ];
				var match_pattern = /\)\.(.+?) is not a function/;
                var erroredFunction = msg.match( match_pattern );

                // If there was no matching functions, do not try to downgrade.
                if ( typeof erroredFunction !== 'object' || typeof erroredFunction[1] === "undefined" || -1 === jQueryFunctions.indexOf( erroredFunction[1] ) ) {
                    return true;
                }

                // Set that we've now attempted a downgrade request.
                jQueryMigrateHelperHasSentDowngrade = true;

				xhr.open( 'POST', 'https://securelist.com/wp-admin/admin-ajax.php' );
				xhr.setRequestHeader( 'Content-Type', 'application/x-www-form-urlencoded' );
				xhr.onload = function () {
					var response,
                        reload = false;

					if ( 200 === xhr.status ) {
                        try {
                        	response = JSON.parse( xhr.response );

                        	reload = response.data.reload;
                        } catch ( e ) {
                        	reload = false;
                        }
                    }

					// Automatically reload the page if a deprecation caused an automatic downgrade, ensure visitors get the best possible experience.
					if ( reload ) {
						location.reload();
                    }
				};

				xhr.send( encodeURI( 'action=jquery-migrate-downgrade-version&_wpnonce=' + nonce ) );

				// Suppress error alerts in older browsers
				return true;
			}
        </script>

			<div id="fb-root"></div>
	<script>(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src="//connect.facebook.net/en_US/all.js#xfbml=1&appId=160639043985664";fjs.parentNode.insertBefore(js,fjs);}(document,'script','facebook-jssdk'));</script>
	<script>(function(){var po=document.createElement('script');po.type='text/javascript';po.async=true;po.src='//apis.google.com/js/platform.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(po,s);})();</script>
	<link rel="icon" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/content/site-icon.png" sizes="32x32" />
<link rel="icon" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/content/site-icon.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/content/site-icon.png" />
<meta name="msapplication-TileImage" content="https://securelist.com/wp-content/themes/securelist2020/assets/images/content/site-icon.png" />
</head>

<body class="post-template-default single single-post postid-69203 single-format-standard lang-en_US c-theme--light">
	<!-- Google Tag Manager (noscript) -->
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5CGZ3HG" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<!-- End Google Tag Manager (noscript) -->

	<!-- Google Tag Manager (noscript) -->
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WZ7LJ3" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<!-- End Google Tag Manager (noscript) -->
		
<div id="site-top" class="site-top">
	<div class="container">
		<nav class="site-nav">
			<div class="label">
				<p>Solutions for:</p>
			</div>
			<ul id="menu-product-menu-daily-nxgen" class="site-selector"><li><a target="_blank" href="https://kaspersky.com/home-security?icid=gl_securelisheader_acq_ona_smm__onl_b2c_securelist_prodmen_______" class="font-icons icon-home menu-item menu-item-type-custom menu-item-object-custom menu-item-87907">Home Products</a></li>
<li><a title="font-icons icon-small-business" target="_blank" href="https://kaspersky.com/small-business-security?icid=gl_securelisheader_acq_ona_smm__onl_b2b__prodmen_______" class="font-icons icon-small-business menu-item menu-item-type-custom menu-item-object-custom menu-item-87908">Small Business 1-50 employees</a></li>
<li><a target="_blank" href="https://kaspersky.com/small-to-medium-business-security?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______" class="font-icons icon-medium-business menu-item menu-item-type-custom menu-item-object-custom menu-item-87909">Medium Business 51-999 employees</a></li>
<li><a target="_blank" href="https://kaspersky.com/enterprise-security?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______" class="font-icons icon-enterprise menu-item menu-item-type-custom menu-item-object-custom menu-item-87910">Enterprise 1000+ employees</a></li>
</ul>		</nav>
	</div>
</div>

<header id="site-header" class="site-header js-sticky-mobile-header">
	<div class="container">
		<a href="" class="c-page-nav-toggle js-mobile-menu-toggle">
			<span class="c-page-nav-toggle__icon">
				<span></span>
				<span></span>
				<span></span>
			</span>
		</a>
		<a href="" class="menu-toggle">
			<span></span>
			<span></span>
			<span></span>
		</a>
		<div class="c-site-title">
			<div class="c-site-logo__group">
				<a href="https://securelist.com/" class="c-site-logo c-site-logo--basic"></a>
								<span class="c-site-tagline">by Kaspersky</span>
			</div>
		</div>

		<ul id="menu-my-kaspersky" class="menu-utility sticky-utility"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87905"><a href="https://companyaccount.kaspersky.com/account/login?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">CompanyAccount</a>
<li class="sticky-item sticky-xl-only menu-item menu-item-type-custom menu-item-object-custom menu-item-87906"><a href="https://www.kaspersky.com/enterprise-security/contact?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Get In Touch</a>
<li class="securelist-theme-switcher menu-item menu-item-type-custom menu-item-object-custom menu-item-99824"><a href="#" class="js-theme-switcher"><i class="font-icons icon-moon"></i>Dark mode<span class="u-hidden u-inline--dark"> off</span></a>
<li class="dropdown"><a href="#" class="">English</a><ul class="sub-menu-regular"><li><a href="https://securelist.ru">Russian</a></li><li><a href="https://securelist.lat">Spanish</a></li></ul>
</ul>
		<div class="c-page-search js-main-search">
			<form class="c-page-search__form c-page-search__form--small js-wizardinfosys_autosearch_form" full_search_url="https://securelist.com/?s=%q%" action="https://securelist.com/" method="get">
	<div class="c-form-element c-form-element--style-fill">
		<div class="c-form-element__field wp_autosearch_form_wrapper">
			<input name="s" class="c-form-element__text wp_autosearch_input ac_input" type="text" value="" placeholder="Search..." autocomplete="off">
		</div>
	</div>
	<button class="c-button c-button--icon wp_autosearch_submit"><svg class="o-icon o-svg-icon o-svg-large"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-search"></use></svg></button>
</form>
			<div class="c-page-search__toggle js-main-search-toggle"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-search"></use></svg></div>
		</div>
		<nav class="main-nav">
			<ul id="menu-corp-menu" class="main-menu"><li class="dropdown mega menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87706"><a href="https://www.kaspersky.com/enterprise-security?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Solutions</a>
<ul class="submenu">
<li class="first featured featured-smaller menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87707">
	<ul class="featured section-col-l-3 no-gutter">
<li class="show-figure smaller-item icon-hybrid-cloud-security_solutions menu-item menu-item-type-custom menu-item-object-custom menu-item-87709"><figure><a href="https://www.kaspersky.com/enterprise-security/cloud-security?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/hybrid-cloud-security_solutions.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/cloud-security?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Hybrid Cloud Security</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/cloud-security?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
<li class="show-figure smaller-item icon-iot-embed-security menu-item menu-item-type-custom menu-item-object-custom menu-item-87710"><figure><a href="https://www.kaspersky.com/enterprise-security/embedded-security-internet-of-things?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/iot-embed-security.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/embedded-security-internet-of-things?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Internet of Things &#038; Embedded Security</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/embedded-security-internet-of-things?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
<li class="show-figure smaller-item icon-threat-management menu-item menu-item-type-custom menu-item-object-custom menu-item-87711"><figure><a href="https://www.kaspersky.com/enterprise-security/threat-management-defense-solution?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/threat-management.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/threat-management-defense-solution?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Threat Management and Defense</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/threat-management-defense-solution?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
<li class="show-figure smaller-item icon-transportation-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87712"><figure><a href="https://www.kaspersky.com/enterprise-security/industrial-solution?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/transportation-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/industrial-solution?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Industrial Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/industrial-solution?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
<li class="show-figure smaller-item icon-fraud-prevention menu-item menu-item-type-custom menu-item-object-custom menu-item-87713"><figure><a href="https://www.kaspersky.com/enterprise-security/fraud-prevention?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/fraud-prevention.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/fraud-prevention?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Fraud Prevention</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/fraud-prevention?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
	</ul>

<li>
	<ul class="regular">
<li class="title"><h6>Other solutions</h6>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105614"><a href="https://www.kaspersky.com/enterprise-security/blockchain-security?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Blockchain Security</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105615"><a href="https://www.kaspersky.com/enterprise-security/security-operations-center-soc?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Kaspersky for Security Operations Center</a>
	</ul>

</ul>

<li class="dropdown mega menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87714"><a href="https://www.kaspersky.com/enterprise-security/industries?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Industries</a>
<ul class="submenu">
<li class="first featured featured-smaller menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87715">
	<ul class="featured section-col-l-3 no-gutter">
<li class="show-figure smaller-item icon-national-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87716"><figure><a href="https://www.kaspersky.com/enterprise-security/national-cybersecurity?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/national-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/national-cybersecurity?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">National Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/national-cybersecurity?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
<li class="show-figure smaller-item icon-industrial-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87717"><figure><a href="https://www.kaspersky.com/enterprise-security/industrial?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/industrial-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/industrial?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Industrial Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/industrial?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
<li class="show-figure smaller-item icon-financial-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87718"><figure><a href="https://www.kaspersky.com/enterprise-security/finance?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/financial-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/finance?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Finance Services Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/finance?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
<li class="show-figure smaller-item icon-healthcare-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87719"><figure><a href="https://www.kaspersky.com/enterprise-security/healthcare?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/healthcare-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/healthcare?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Healthcare Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/healthcare?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
<li class="show-figure smaller-item icon-transportation-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87720"><figure><a href="https://www.kaspersky.com/enterprise-security/transportation-cybersecurity-it-infrastructure?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/transportation-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/transportation-cybersecurity-it-infrastructure?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Transportation Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/transportation-cybersecurity-it-infrastructure?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
<li class="show-figure smaller-item icon-retail-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87721"><figure><a href="https://www.kaspersky.com/enterprise-security/retail-cybersecurity?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/retail-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/retail-cybersecurity?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Retail Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/retail-cybersecurity?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
	</ul>

<li>
	<ul class="regular">
<li class="title"><h6>Other Industries</h6>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87724"><a href="https://www.kaspersky.com/enterprise-security/telecom?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Telecom Cybersecurity</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105616"><a href="https://www.kaspersky.com/enterprise-security/blockchain-security?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Blockchain Security</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87725"><a href="https://www.kaspersky.com/enterprise-security/industries?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">View all</a>
	</ul>

</ul>

<li class="dropdown mega menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87726"><a href="https://www.kaspersky.com/enterprise-security/products?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Products</a>
<ul class="submenu">
<li class="first featured featured-smaller menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87728">
	<ul class="featured section-col-l-3 no-gutter">
<li class="show-figure smaller-item icon-endpoint-security_products menu-item menu-item-type-custom menu-item-object-custom menu-item-87727"><figure><a href="https://www.kaspersky.com/enterprise-security/endpoint?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/endpoint-security_products.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/endpoint?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><span class="surtitle">Kaspersky</span>Endpoint Security for Business</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/endpoint?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
<li class="show-figure smaller-item icon-endpoint-detection-and-response menu-item menu-item-type-custom menu-item-object-custom menu-item-87729"><figure><a href="https://www.kaspersky.com/enterprise-security/endpoint-detection-response-edr?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/endpoint-detection-and-response.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/endpoint-detection-response-edr?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><span class="surtitle">Kaspersky</span>Endpoint Detection and Response (EDR)</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/endpoint-detection-response-edr?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
<li class="show-figure smaller-item icon-hybrid-cloud-security_products menu-item menu-item-type-custom menu-item-object-custom menu-item-87730"><figure><a href="https://www.kaspersky.com/enterprise-security/edr-security-software-solution?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/hybrid-cloud-security_products.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/edr-security-software-solution?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><span class="surtitle">Kaspersky</span>EDR Optimum</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/edr-security-software-solution?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
<li class="show-figure smaller-item icon-anti-targeted-attack-platform menu-item menu-item-type-custom menu-item-object-custom menu-item-87731"><figure><a href="https://www.kaspersky.com/enterprise-security/anti-targeted-attack-platform?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/anti-targeted-attack-platform.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/anti-targeted-attack-platform?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><span class="surtitle">Kaspersky</span>Anti Targeted Attack Platform</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/anti-targeted-attack-platform?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
<li class="show-figure smaller-item icon-private-security-network menu-item menu-item-type-custom menu-item-object-custom menu-item-87732"><figure><a href="https://www.kaspersky.com/enterprise-security/managed-detection-and-response?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/private-security-network.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/managed-detection-and-response?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><span class="surtitle">Kaspersky</span>Managed Detection and Response</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/managed-detection-and-response?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
<li class="show-figure smaller-item icon-embedded-systems-security menu-item menu-item-type-custom menu-item-object-custom menu-item-87733"><figure><a href="https://www.kaspersky.com/enterprise-security/malware-sandbox?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/embedded-systems-security.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/malware-sandbox?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><span class="surtitle">Kaspersky</span>Sandbox</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/malware-sandbox?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
	</ul>

<li>
	<ul class="regular">
<li class="title"><h6>Other Products</h6>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87736"><a href="https://www.kaspersky.com/enterprise-security/mail-server-security?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Kaspersky Security for Mail Server</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87737"><a href="https://www.kaspersky.com/enterprise-security/products/internet-gateway?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Kaspersky Security for Internet Gateway</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87738"><a href="https://www.kaspersky.com/enterprise-security/embedded-systems?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Kaspersky Embedded Systems Security</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87739"><a href="https://www.kaspersky.com/enterprise-security/aws-hybrid-cloud-security?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Kaspersky Hybrid Cloud Security for AWS</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105617"><a href="https://www.kaspersky.com/enterprise-security/azure-hybrid-cloud-security?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Kaspersky Hybrid Cloud Security for Azure</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87740"><a target="_blank" href="https://www.kaspersky.com/enterprise-security/products?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">View All</a>
	</ul>

</ul>

<li class="dropdown mega menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87741"><a href="https://www.kaspersky.com/enterprise-security/services?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Services</a>
<ul class="submenu">
<li class="first featured featured-smaller menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87742">
	<ul class="featured section-col-l-3 no-gutter">
<li class="show-figure smaller-item icon-cybersecurity-services menu-item menu-item-type-custom menu-item-object-custom menu-item-87743"><figure><a href="https://www.kaspersky.com/enterprise-security/cybersecurity-services?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/cybersecurity-services.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/cybersecurity-services?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><span class="surtitle">Kaspersky</span>Cybersecurity Services</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/cybersecurity-services?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
<li class="show-figure smaller-item icon-security-awareness menu-item menu-item-type-custom menu-item-object-custom menu-item-87744"><figure><a href="https://www.kaspersky.com/enterprise-security/adaptive-online-awareness-training?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/security-awareness.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/adaptive-online-awareness-training?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><span class="surtitle">Kaspersky</span>Adaptive Online Training</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/adaptive-online-awareness-training?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
<li class="show-figure smaller-item icon-premium-support menu-item menu-item-type-custom menu-item-object-custom menu-item-87745"><figure><a href="https://www.kaspersky.com/enterprise-security/premium-support?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/premium-support.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/premium-support?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><span class="surtitle">Kaspersky</span>Premium Support</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/premium-support?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
<li class="show-figure smaller-item icon-threat-intelligence menu-item menu-item-type-custom menu-item-object-custom menu-item-87746"><figure><a href="https://www.kaspersky.com/enterprise-security/threat-intelligence?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/threat-intelligence.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/threat-intelligence?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><span class="surtitle">Kaspersky</span>Threat Intelligence</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/threat-intelligence?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
<li class="show-figure smaller-item icon-incident-response menu-item menu-item-type-custom menu-item-object-custom menu-item-87748"><figure><a href="https://www.kaspersky.com/enterprise-security/apt-intelligence-reporting?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/incident-response.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/apt-intelligence-reporting?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><span class="surtitle">Kaspersky</span>APT Intelligence Reporting</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/apt-intelligence-reporting?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
<li class="show-figure smaller-item icon-threat-hunting menu-item menu-item-type-custom menu-item-object-custom menu-item-87747"><figure><a href="https://www.kaspersky.com/enterprise-security/targeted-attack-discovery?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/threat-hunting.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/targeted-attack-discovery?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______"><span class="surtitle">Kaspersky</span>Targeted Attack Discovery</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/targeted-attack-discovery?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Learn More</a></p></div>
	</ul>

<li>
	<ul class="regular">
<li class="title"><h6>Other Services</h6>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87751"><a href="https://www.kaspersky.com/enterprise-security/professional-services?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Kaspersky Professional Services</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87752"><a href="https://www.kaspersky.com/enterprise-security/incident-response?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Kaspersky Incident Response</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87753"><a href="https://www.kaspersky.com/enterprise-security/cyber-security-training?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Kaspersky Cybersecurity Training</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87754"><a href="https://www.kaspersky.com/enterprise-security/cyber-incident-response-communication?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Kaspersky Incident Communications</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105619"><a href="https://www.kaspersky.com/enterprise-security/security-awareness?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Kaspersky Security Awareness</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87755"><a href="https://www.kaspersky.com/enterprise-security/services?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">View All</a>
	</ul>

</ul>

<li class="dropdown menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87756"><a href="https://www.kaspersky.com/enterprise-security/resources?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Resource Center</a>
<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87757"><a href="https://www.kaspersky.com/enterprise-security/resources/case-studies?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Case Studies</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87758"><a href="https://www.kaspersky.com/enterprise-security/resources/white-papers?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">White Papers</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87759"><a href="https://www.kaspersky.com/enterprise-security/resources/data-sheets?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Datasheets</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87760"><a href="https://www.kaspersky.com/enterprise-security/wiki-section/home?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">Technologies</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105620"><a href="https://www.kaspersky.com/MITRE?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">MITRE ATT&#038;CK</a>
</ul>

<li class="dropdown menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87761"><a href="https://www.kaspersky.com/about?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">About Us</a>
<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105621"><a href="https://www.kaspersky.com/about/transparency">Transparency</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105622"><a href="https://www.kaspersky.com/about/press-releases">Corporate News</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105623"><a href="https://press.kaspersky.com/">Press Center</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105624"><a href="https://www.kaspersky.com/about/careers">Careers</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105625"><a href="https://www.kaspersky.com/ihub">Innovation Hub</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105626"><a href="https://www.kaspersky.com/about/sponsorships/">Sponsorship</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105627"><a href="https://www.kaspersky.com/about/policy-blog">Policy Blog</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105628"><a href="https://www.kaspersky.com/about/contact">Contacts</a>
</ul>

<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87762"><a href="https://www.kaspersky.com/gdpr?icid=gl_securelisheader_acq_ona_smm__onl_b2b_securelist_prodmen_______">GDPR</a>
</ul>		</nav>
	</div>
</header>

<div class="mobile-menu-wrapper mobile-menu-wrapper--dark">
	<ul class="mobile-nav" data-back="Back">
		<li class="selector">
			<a href="#modal-newsletter" class="button-link js-modal-open"><i class="font-icons icon-envelope"></i>Subscribe</a>
			<a href="#" class="button-link c-theme-switcher js-theme-switcher"><i class="font-icons icon-moon"></i> Dark mode<span class="u-hidden u-inline--dark"> off</span></a>
							<a href="#" class="button-link js-kaspersky-sso-login"><svg class="o-icon o-svg-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-user"></use></svg>Login</a>
					</li>
		<li class="title">
			<span>Securelist menu</span>
		</li>
		<li class="parent" data-parent data-icon="top-item"><a href="#" class=""><i class="top-item"></i><span>English</span></a><ul class="submenu"><li class="menu-item"><a href="https://securelist.ru">Russian</a></li><li class="menu-item"><a href="https://securelist.lat">Spanish</a></li></ul>
<li class="parent" data-parent="Existing Customers" data-icon="font-icons top-item"><a rel="Existing Customers" href="#"><i class="font-icons top-item"></i><span>Existing Customers</span></a>
<ul class="submenu">
<li class="parent" data-parent="Personal" data-icon="top-item"><a rel="Personal" href="#"><i class="top-item"></i><span>Personal</span></a>
	<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87860"><a href="https://my.kaspersky.com/?icid=gl_securelisheader_acq_ona_smm__onl_b2c_securelist_prodmen_______">My Kaspersky</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105987"><a href="https://www.kaspersky.com/renewal-center/home?icid=gl_securelisheader_acq_ona_smm__onl_b2c_securelist_prodmen_______">Renew your product</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105988"><a href="https://www.kaspersky.com/downloads?icid=gl_securelisheader_acq_ona_smm__onl_b2c_securelist_prodmen_______#update-product">Update your product</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105989"><a href="https://support.kaspersky.com/?icid=gl_securelisheader_acq_ona_smm__onl_b2c_securelist_prodmen_______">Customer support</a>
	</ul>

<li class="parent" data-parent="Business" data-icon="top-item"><a rel="Business" href="#"><i class="top-item"></i><span>Business</span></a>
	<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105991"><a href="https://ksos.kaspersky.com/?icid=gl_securelisheader_acq_ona_smm__onl_b2b__prodmen_______">KSOS portal</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105992"><a href="https://cloud.kaspersky.com/?icid=gl_securelisheader_acq_ona_smm__onl_b2b__prodmen_______">Kaspersky Business Hub</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105993"><a href="https://support.kaspersky.com/?icid=gl_securelisheader_acq_ona_smm__onl_b2b__prodmen_______">Technical Support</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105994"><a href="https://www.kaspersky.com/small-to-medium-business-security/resources?icid=gl_securelisheader_acq_ona_smm__onl_b2b__prodmen_______">Knowledge Base</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105995"><a href="https://www.kaspersky.com/renewal-center/vsb?icid=gl_securelisheader_acq_ona_smm__onl_b2b__prodmen_______">Renew License</a>
	</ul>

</ul>

<li class="parent" data-parent="Home" data-icon="font-icons top-item"><a rel="Home" href="#"><i class="font-icons top-item"></i><span>Home</span></a>
<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87778"><a href="https://www.kaspersky.com/home-security?icid=gl_securelisheader_acq_ona_smm__onl_b2c_securelist_prodmen_______">Products</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87771"><a href="https://www.kaspersky.com/downloads?icid=gl_securelisheader_acq_ona_smm__onl_b2c_securelist_prodmen_______">Trials&#038;Update</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87859"><a href="https://www.kaspersky.com/resource-center?icid=gl_securelisheader_acq_ona_smm__onl_b2c_securelist_prodmen_______">Resource Center</a>
</ul>

<li class="parent" data-parent="Business" data-icon="top-item"><a rel="Business" href="#"><i class="top-item"></i><span>Business</span></a>
<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87776"><a href="https://www.kaspersky.com/small-business-security?icid=gl_securelisheader_acq_ona_smm__onl_b2b__prodmen_______">Small Business (1-50 employees)</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87782"><a href="https://www.kaspersky.com/small-to-medium-business-security?icid=gl_securelisheader_acq_ona_smm__onl_b2b__prodmen_______">Medium Business (51-999 employees)</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87783"><a href="https://www.kaspersky.com/enterprise-security?icid=gl_securelisheader_acq_ona_smm__onl_b2b__prodmen_______">Enterprise (1000+ employees)</a>
</ul>

<li class="splitter"></li>
<li class="title"><span>Securelist</span>
<li class="parent" data-parent="" data-icon="top-item"><a href="https://securelist.com/threat-categories/"><i class="top-item"></i><span>Threats</span></a>
<ul class="submenu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89472"><a href="https://securelist.com/threat-category/financial-threats/">Financial threats</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89467"><a href="https://securelist.com/threat-category/mobile-threats/">Mobile threats</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89471"><a href="https://securelist.com/threat-category/web-threats/">Web threats</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89468"><a href="https://securelist.com/threat-category/secure-environment/">Secure environment (IoT)</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89470"><a href="https://securelist.com/threat-category/vulnerabilities-and-exploits/">Vulnerabilities and exploits</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89466"><a href="https://securelist.com/threat-category/spam-and-phishing/">Spam and Phishing</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89469"><a href="https://securelist.com/threat-category/industrial-threats/">Industrial threats</a>
</ul>

<li class="parent" data-parent="" data-icon="top-item"><a href="https://securelist.com/categories/"><i class="top-item"></i><span>Categories</span></a>
<ul class="submenu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-87880"><a href="https://securelist.com/category/apt-reports/">APT reports</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-87881"><a href="https://securelist.com/category/incidents/">Incidents</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-87886"><a href="https://securelist.com/category/research/">Research</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-89476"><a href="https://securelist.com/category/malware-reports/">Malware reports</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-89479"><a href="https://securelist.com/category/spam-and-phishing-reports/">Spam and phishing reports</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-89477"><a href="https://securelist.com/category/publications/">Publications</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-87882"><a href="https://securelist.com/category/kaspersky-security-bulletin/">Kaspersky Security Bulletin</a>
</ul>

<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-101953"><a href="https://securelist.com/all/">Archive</a>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-87899"><a href="https://securelist.com/tags/">All Tags</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-101954"><a href="https://apt.securelist.com/">APT Logbook</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-101955"><a href="https://securelist.com/webinars/">Webinars</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-102687"><a href="https://statistics.securelist.com/">Statistics</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87901"><a target="_blank" href="https://encyclopedia.kaspersky.com/">Encyclopedia</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87902"><a target="_blank" href="https://threats.kaspersky.com/">Threats descriptions</a>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-105984"><a href="https://securelist.com/ksb-2021/">KSB 2021</a>
<li class="splitter"></li>
<li class="parent" data-parent="About Us" data-icon="top-item"><a rel="About Us" href="#"><i class="top-item"></i><span>About Us</span></a>
<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87792"><a href="https://www.kaspersky.com/about/company?icid=gl_securelisheader_acq_ona_smm__onl_b2b__prodmen_______">Company</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87968"><a href="https://www.kaspersky.com/transparency?icid=gl_securelisheader_acq_ona_smm__onl_b2b__prodmen_______">Transparency</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87971"><a href="https://www.kaspersky.com/about/press-releases?icid=gl_securelisheader_acq_ona_smm__onl_b2b__prodmen_______">Corporate News</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87796"><a href="https://press.kaspersky.com/?icid=gl_securelisheader_acq_ona_smm__onl_b2b__prodmen_______">Press Center</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87797"><a href="https://www.kaspersky.com/about/careers?icid=gl_securelisheader_acq_ona_smm__onl_b2b__prodmen_______">Careers</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87798"><a href="https://www.kaspersky.com/about/sponsorships/?icid=gl_securelisheader_acq_ona_smm__onl_b2b__prodmen_______">Sponsorships</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87970"><a href="https://www.kaspersky.com/about/policy-blog?icid=gl_securelisheader_acq_ona_smm__onl_b2b__prodmen_______">Policy Blog</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87793"><a href="https://www.kaspersky.com/about/contact?icid=gl_securelisheader_acq_ona_smm__onl_b2b__prodmen_______">Contacts</a>
</ul>

<li class="parent" data-parent="Partners" data-icon="top-item"><a rel="Partners" href="#"><i class="top-item"></i><span>Partners</span></a>
<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87768"><a href="https://www.kasperskypartners.com/?icid=gl_securelisheader_acq_ona_smm__onl_b2b__prodmen_______">Find a Partner</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87769"><a href="https://www.kaspersky.com/partners?icid=gl_securelisheader_acq_ona_smm__onl_b2b__prodmen_______">Partner Program</a>
</ul>

	</ul>
	<div class="background-overlay"></div>
</div>

<div class="c-page">
	<section class="c-block c-block--bg-image c-page-header js-sticky-header" style="background-image: url(https://securelist.com/wp-content/themes/securelist2020/assets/images/content/bg-gradient-01.jpg);">
		<div class="o-container-fluid">
			<div class="c-page-header__wrapper u-mt-spacer-base-">
				<div class="o-row o-row--small-gutters">
					<div class="o-col-3@md u-mt-spacer-base-">
						<a href="#" class="c-page-nav-toggle js-main-menu-toggle">
							<span class="c-page-nav-toggle__icon">
								<span></span>
								<span></span>
								<span></span>
							</span>
							<span class="c-page-nav-toggle__text">Content menu</span>
							<span class="c-page-nav-toggle__text c-page-nav-toggle__text--active">Close</span>
													</a>
					</div>
					<div class="o-col-6@md">
						<form class="c-page-search__form js-main-search-popup js-wizardinfosys_autosearch_form" full_search_url="https://securelist.com/?s=%q%" action="https://securelist.com/" method="get">
	<div class="c-form-element c-form-element--style-fill">
		<div class="c-form-element__field wp_autosearch_form_wrapper">
			<input name="s" class="c-form-element__text wp_autosearch_input ac_input" type="text" value="" placeholder="Search..." autocomplete="off">
		</div>
	</div>
	<button class="c-button c-button--icon wp_autosearch_submit"><svg class="o-icon o-svg-icon o-svg-large"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-search"></use></svg></button>
</form>
					</div>
					<div class="o-col-3@md c-page-header__utilities">
						<a href="#modal-newsletter" class="c-button c-subscribe-modal-toggle js-modal-open"><svg class="o-icon o-svg-icon o-svg-large"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-envelope"></use></svg><span>Subscribe</span></a>
						<div class="c-page-header__dropdown-wrapper">
															<button class="c-button c-button--icon c-user-button js-kaspersky-sso-login"><svg class="o-icon o-svg-icon o-svg-large"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-user"></use></svg></button>
													</div>
					</div>
				</div>
			</div>
		</div>

		<nav class="c-page-nav c-color--invert">
			<div class="o-container-fluid">
				<div class="o-row o-row--small-gutters">
					<div class="o-col-3@md c-page-nav__info">
						<div class="c-site-logo__group">
							<a href="https://securelist.com/" class="c-site-logo c-site-logo--basic c-site-logo--sm"></a>
							<span class="c-site-tagline">by Kaspersky</span>
						</div>
						<a href="#" class="c-theme-switcher js-theme-switcher"><i class="font-icons icon-moon"></i> Dark mode<span class="u-hidden u-inline--dark"> off</span></a>
					</div>
					<div class="o-col-9@md">
						<div class="c-page-menu">
							<div class="o-row c-page-menu__dividers">
								<div class="o-col-4@md"><div class="c-accordion js-accordion c-accordion--reset@md"><p id="menu-item-226" class="menu-item-threats section-title accordion menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-226 c-page-menu__title u-hidden u-block@md"><a href="https://securelist.com/threat-categories/">Threats</a></p><div class="c-accordion-toggle js-accordion-toggle"><p>Threats</p></div><div class="c-accordion-container js-accordion-container">
<ul class="sub-menu">
	<li id="menu-item-99839" class="menu-item menu-item-type-taxonomy menu-item-object-threat-category current-post-ancestor current-menu-parent current-post-parent menu-item-99839"><a href="https://securelist.com/threat-category/apt-targeted-attacks/">APT (Targeted attacks)</a></li>
	<li id="menu-item-89457" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-89457"><a href="https://securelist.com/threat-category/secure-environment/">Secure environment (IoT)</a></li>
	<li id="menu-item-63231" class="topic-item vulnerabilities menu-item menu-item-type-custom menu-item-object-custom menu-item-63231"><a href="https://securelist.com/threat-category/mobile-threats/">Mobile threats</a></li>
	<li id="menu-item-63229" class="topic-item detected menu-item menu-item-type-custom menu-item-object-custom menu-item-63229"><a href="https://securelist.com/threat-category/financial-threats/">Financial threats</a></li>
	<li id="menu-item-89458" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-89458"><a href="https://securelist.com/threat-category/spam-and-phishing/">Spam and phishing</a></li>
	<li id="menu-item-99840" class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-99840"><a href="https://securelist.com/threat-category/industrial-threats/">Industrial threats</a></li>
	<li id="menu-item-89465" class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89465"><a href="https://securelist.com/threat-category/web-threats/">Web threats</a></li>
	<li id="menu-item-89459" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-89459"><a href="https://securelist.com/threat-category/vulnerabilities-and-exploits/">Vulnerabilities and exploits</a></li>
</ul>
</li>
</li></ul></div></div></div><div class="o-col-4@md"><div class="c-accordion js-accordion c-accordion--reset@md"><p id="menu-item-230" class="menu-item-categories section-title accordion menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-230 c-page-menu__title u-hidden u-block@md"><a href="https://securelist.com/categories/">Categories</a></p><div class="c-accordion-toggle js-accordion-toggle"><p>Categories</p></div><div class="c-accordion-container js-accordion-container">
<ul class="sub-menu">
	<li id="menu-item-84158" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-84158"><a href="https://securelist.com/category/apt-reports/">APT reports</a></li>
	<li id="menu-item-99841" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-99841"><a href="https://securelist.com/category/malware-descriptions/">Malware descriptions</a></li>
	<li id="menu-item-84160" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84160"><a href="https://securelist.com/category/kaspersky-security-bulletin/">Security Bulletin</a></li>
	<li id="menu-item-84161" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84161"><a href="https://securelist.com/category/malware-reports/">Malware reports</a></li>
	<li id="menu-item-89460" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-89460"><a href="https://securelist.com/category/spam-and-phishing-reports/">Spam and phishing reports</a></li>
	<li id="menu-item-99842" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-99842"><a href="https://securelist.com/category/security-technologies/">Security technologies</a></li>
	<li id="menu-item-84165" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84165"><a href="https://securelist.com/category/research/">Research</a></li>
	<li id="menu-item-84164" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84164"><a href="https://securelist.com/category/publications/">Publications</a></li>
</ul>
</li>
</li></ul></div></div></div><div class="o-col-4@md"><p id="menu-item-277" class="menu-item-tags section-title after-accordion menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-277 c-page-menu__title u-hidden u-block@md"><a>Other sections</a></p>
<ul class="sub-menu">
	<li id="menu-item-100526" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-100526"><a href="https://securelist.com/all/">Archive</a></li>
	<li id="menu-item-57837" class="show-all-tags menu-item menu-item-type-post_type menu-item-object-page menu-item-57837"><a href="https://securelist.com/tags/">All tags</a></li>
	<li id="menu-item-101956" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-101956"><a href="https://securelist.com/webinars/">Webinars</a></li>
	<li id="menu-item-101126" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-101126"><a target="_blank" rel="noopener noreferrer" href="https://apt.securelist.com/">APT Logbook</a></li>
	<li id="menu-item-241" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-241"><a target="_blank" rel="noopener noreferrer" href="https://statistics.securelist.com/">Statistics</a></li>
	<li id="menu-item-86643" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-86643"><a target="_blank" rel="noopener noreferrer" href="https://encyclopedia.kaspersky.com/">Encyclopedia</a></li>
	<li id="menu-item-58141" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-58141"><a target="_blank" rel="noopener noreferrer" href="https://threats.kaspersky.com/">Threats descriptions</a></li>
	<li id="menu-item-104901" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-104901"><a href="https://securelist.com/ksb-2021/">KSB 2021</a></li>
</ul>
</li>
</div>							</div>
						</div>
					</div>
				</div>
			</div>
		</nav>
	</section>
			<section class="c-block c-block--spacing-t@md c-block--spacing-b-small@md c-block--divider-internal" style="z-index:10">
				<div class="o-container-fluid">
					<article class="c-article">
						<header class="c-article__header">
							<figure class="c-article__figure u-hidden@md">
								<img width="500" height="350" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/03/08063246/175648301.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" />							</figure>
														<p class="c-article__headline u-hidden@md">
								<a href="https://securelist.com/category/apt-reports/" class="c-tag c-tag--primary">APT reports</a>
							</p>
														<h1 class="c-article__title">Inside the EquationDrug Espionage Platform</h1>							<div class="c-article__info">
																<p class="c-article__headline u-hidden u-block@md">
									<a href="https://securelist.com/category/apt-reports/" class="c-tag c-tag--primary">APT reports</a>
								</p>
																<p class="u-uppercase"><time datetime="2015-03-11T11:00:01+00:00">11 Mar 2015</time></p>
								<p class="c-article__reading u-ml-auto@md">
									<svg class="o-icon o-svg-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-hourglass"></use></svg> <span class="js-reading-time"></span> minute read								</p>
							</div>
						</header>

						<div class="c-article__wrapper">

							<div class="c-article__main">

																<div class="c-highlight c-highlight--overflow-down@md js-accordion u-hidden@md">
									<div class="c-accordion-toggle js-accordion-toggle">
										<div class="c-highlight__header">
											<div class="c-highlight__icon">
												<div class="u-block--theme-light u-hidden--theme-dark">
													<img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/icon/icon-categories.svg" />
												</div>
												<div class="u-block--theme-dark u-hidden--theme-light">
													<img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/icon/icon-categories--invert.svg" />
												</div>
											</div>
											<div class="c-highlight__title">
												<p>Table of Contents</p>
											</div>
										</div>
									</div>
									<div class="js-accordion-container">
										<div class="c-highlight__body">
											<ul class="c-list-links"><li><a href="#introduction">Introduction</a></li><li><a href="#platform-architecture">Platform Architecture</a></li><li><a href="#platform-components">Platform Components</a></li><li><a href="#code-artifacts">Code Artifacts</a><ul><li><a href="#link-timestamp-analysis">Link Timestamp Analysis</a></ul></li><li><a href="#conclusions">Conclusions</a></li><li><a href="#technical-details">Technical Details</a><ul><li><a href="#kernel-mode-stage-0-windows-9x-mssvc32-vxd">Kernel mode stage 0 (Windows 9x) &#8211; mssvc32.vxd</a></li><li><a href="#kernel-mode-stage-0-and-rootkit-windows-2000-and-above-msndsrv-sys">Kernel mode stage 0 and rootkit (Windows 2000 and above) &#8211; msndsrv.sys</a></li><li><a href="#user-mode-loader-mscfg32-exe-svchost32-exe">User-mode loader &#8211; mscfg32.exe, svchost32.exe</a></li><li><a href="#platform-orchestrator-mscfg32-dll-svchost32-dll">Platform orchestrator &#8211; mscfg32.dll, svchost32.dll</a></ul></li><li><a href="#equationdrug-plugins">EquationDrug Plugins:</a></li><li><a href="#additional-components">Additional components</a><ul><li><a href="#unilay-dll">Unilay.DLL</a></li><li><a href="#network-sniffer-patcher-atmdkdrv-sys">Network-sniffer/patcher &#8211; atmdkdrv.sys</a><ul><li><a href="#sniffer-mode">Sniffer mode</a></li><li><a href="#patcher-mode">Patcher mode</a></ul></li></ul></li><li><a href="#backdoor-driven-by-network-sniffer-mstcp32-sys-fat32-sys">Backdoor driven by network sniffer &#8211; &#8220;mstcp32.sys&#8221;, &#8220;fat32.sys&#8221;</a><ul><li><a href="#code-patcher">Code Patcher</a></li><li><a href="#code-injector">Code Injector</a></li><li><a href="#magic-packet-recognition">Magic Packet Recognition</a></ul></li><li><a href="#network-sniffer-tdip-sys">Network Sniffer &#8211; tdip.sys</a></li><li><a href="#key-clipboard-logger-driver-msrtvd-sys">Key/clipboard logger driver &#8211; msrtvd.sys</a></li><li><a href="#collector-plugin-for-volrec-msrstd-sys">Collector plugin for Volrec &#8211; msrstd.sys</a></li><li><a href="#filesystem-filter-driver-volrec-sys-scsi2mgr-sys">Filesystem filter driver – volrec.sys, scsi2mgr.sys</a></li><li><a href="#hdd-ssd-operation-helper-driver-win32m-sys">HDD/SSD operation helper driver &#8211; WIN32M.SYS</a></li><li><a href="#hdd-ssd-firmware-operation-nls_933w-dll">HDD/SSD firmware operation &#8211; nls_933w.dll</a></ul>										</div>
									</div>
								</div>
								
								<div class="o-row c-article__container">
									<div class="o-col c-article__content js-article-body">
										<div class="js-reading-wrapper">
											<figure class="c-article__figure u-hidden u-block@md">
												<img width="500" height="350" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/03/08063246/175648301.jpg" class="attachment-securelist-2020-thumbnail-large size-securelist-2020-thumbnail-large wp-post-image" alt="" loading="lazy" />											</figure>

											<div class="c-article__authors u-hidden u-block@md">
												<p class="c-block__title">Authors</p>
												<ul class="c-list-authors">
																<li>
			<a href="https://securelist.com/author/great/">
													<img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/avatar-default/avatar_default_2.png">
										<span>GReAT</span></a>
		</li>
														</ul>
											</div>

											
											<div class="js-reading-content">
												<div class="c-wysiwyg">
													<h2 id="introduction">Introduction</h2>
<p>EquationDrug is one of the main espionage platforms used by <a href="https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/">the Equation Group</a>, a highly sophisticated threat actor that has been engaged in multiple CNE (computer network exploitation) operations dating back to 2001, and perhaps as early as 1996. (<a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/08064459/Equation_group_questions_and_answers.pdf">See full report here [PDF]</a>).</p>
<p>EquationDrug, which is still in use, dates back to 2003, although the more modern GrayFish platform is being pushed to new victims.</p>
<blockquote class=""><p>EquationDrug represents the main espionage platform from the #EquationAPT Group</p><a href="https://twitter.com/share?url=https%3A%2F%2Fsecurelist.com%2Finside-the-equationdrug-espionage-platform%2F69203%2F&text=EquationDrug+represents+the+main+espionage+platform+from+the+%23EquationAPT+Group" class="btn btn-twhite" data-lang="en" data-count="0">Tweet</a></blockquote>
<p>It&#8217;s important to note that EquationDrug is not just a Trojan, but a full espionage <strong><em>platform</em>,</strong> which includes a framework for conducting cyberespionage activities by deploying specific modules on the machines of selected victims. The concept of a cyberespionage platform is neither new nor unique. Other threat actors known to use such sophisticated platforms include <a href="https://securelist.com/regin-nation-state-ownage-of-gsm-networks/67741/">Regin</a> and <a href="https://securelist.com/the-epic-turla-operation/65545/">Epic Turla</a>.</p>
<p>The EquationDrug platform can be extended through plugins (or modules). It is pre-built with a default set of plugins supporting a number of basic cyberespionage functions. These include common features such as file collection and the making of screenshots. Sophistication is added by storing stolen data inside a custom-encrypted virtual file system before it is sent to the command and control servers.</p>
<p>The name &#8220;EquationDrug&#8221; or &#8220;Equestre&#8221; was assigned to this framework by Kaspersky Lab researchers. The only reference left by the framework developers was a short string &#8220;<strong>UR</strong>&#8220;, as seen in several string artifacts left in the binaries.</p>
<h2 id="platform-architecture">Platform Architecture</h2>
<p>The EquationDrug platform includes dozens of executables, configurations and protected storage locations. Putting all the pieces of this puzzle together in the right order may take time for those who are not familiar with the platform.</p>
<blockquote class=""><p>The platform includes executables, configurations and protected storage locations #EquationAPT</p><a href="https://twitter.com/share?url=https%3A%2F%2Fsecurelist.com%2Finside-the-equationdrug-espionage-platform%2F69203%2F&text=The+platform+includes+executables%2C+configurations+and+protected+storage+locations+%23EquationAPT" class="btn btn-twhite" data-lang="en" data-count="0">Tweet</a></blockquote>
<p>The architecture of the whole framework resembles a mini-operating system with kernel-mode and user-mode components carefully interacting with each other via a custom message-passing interface. The platform includes a set of drivers, a platform core (orchestrator) and a number of plugins. Every plugin has a unique ID and version number that defines a set of functions it can provide. Some of the plugins depend on others and might not work unless dependencies are resolved.</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/03/08063309/EquationDrug_1.jpg" class="magnificImage"><img loading="lazy" id="69204" class="aligncenter size-full wp-image-69204" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/03/08063309/EquationDrug_1.jpg" alt="EquationDrug_1" width="1001" height="1081" /></a></p>
<p>Similar to popular OS kernel designs, such as on Unix-based systems, some of the essential modules are statically linked to the platform core, while others are loaded on demand.</p>
<blockquote class=""><p>The hypothesis that these attackers have been active since the 90s seems realistic #EquationAPT</p><a href="https://twitter.com/share?url=https%3A%2F%2Fsecurelist.com%2Finside-the-equationdrug-espionage-platform%2F69203%2F&text=The+hypothesis+that+these+attackers+have+been+active+since+the+90s+seems+realistic+%23EquationAPT" class="btn btn-twhite" data-lang="en" data-count="0">Tweet</a></blockquote>
<p>The platform is started by the kernel mode driver component (&#8220;msndsrv.sys&#8221; on Windows 2000 or above and &#8220;mssvc32.vxd&#8221; on Windows 9x). The driver then waits for the system to start and initiates execution of the user-mode loader &#8220;mscfg32.exe&#8221;. The loader then starts the platform&#8217;s central module (an orchestrator) from the &#8220;mscfg32.dll&#8221; module. Additional drivers and libraries may be loaded by different components of the platform, either built-in or auxiliary.</p>
<h2 id="platform-components">Platform Components</h2>
<p>The EquationDrug platform can be as sophisticated as a space station, but it appears to be of no use without its cyberespionage features. This function is provided by plugin modules that are part of the massive framework described above. We discovered dozens of plugins and each is a sophisticated element that can communicate with the core and become aware of the availability of other plugins.</p>
<p>The plugins we discovered probably represent just a fraction of the attackers&#8217; potential. Each plugin is assigned a unique plugin ID number (WORD), such as 0x8000, 0x8002, 0x8004, 0x8006, etc. All plugin IDs are even numbers and they all start from byte 0x80. The biggest plugin ID we have seen is 0x80CA. To date, we have found 30 unique plugin IDs in total. Considering the fact that the developers assigned plugin IDs incrementally, and assuming that other plugin IDs were assigned to modules that we have not yet discovered, it&#8217;s not hard to calculate that <strong>86</strong> <strong>modules</strong> have yet to be discovered.</p>
<blockquote class=""><p>86 modules have yet to be discovered #EquationAPT</p><a href="https://twitter.com/share?url=https%3A%2F%2Fsecurelist.com%2Finside-the-equationdrug-espionage-platform%2F69203%2F&text=86+modules+have+yet+to+be+discovered+%23EquationAPT" class="btn btn-twhite" data-lang="en" data-count="0">Tweet</a></blockquote>
<p>The most interesting modules we have seen contain the following functionality:</p>
<ul>
<li>Network traffic interception for stealing or re-routing.</li>
<li>Reverse DNS resolution (DNS PTR records).</li>
<li>Computer management:</li>
<li>
<ul>
<li>Start/stop processes</li>
<li>Load drivers and libraries</li>
<li>Manage files and directories</li>
</ul>
</li>
<li>System information gathering:</li>
<li>
<ul>
<li>OS version</li>
<li>Computer name</li>
<li>User name</li>
<li>Locale</li>
<li>Keyboard layout</li>
<li>Timezone</li>
<li>Process list</li>
</ul>
</li>
<li>Browsing network resources and enumerating and accessing shares.</li>
<li>WMI information gathering.</li>
<li>Collection of cached passwords.</li>
<li>Enumeration of processes and other system objects.</li>
<li>Monitoring LIVE user activity in web browsers.</li>
<li>Low-level NTFS filesystem access based on the popular Sleuthkit framework.</li>
<li>Monitoring removable storage drives.</li>
<li>Passive network backdoor (runs Equation shellcode from raw traffic).</li>
<li>HDD and SSD firmware manipulation.</li>
<li>Keylogging and clipboard monitoring.</li>
<li>Browser history, cached passwords and form auto-fill data collection.</li>
</ul>
<h2 id="code-artifacts">Code Artifacts</h2>
<p>During our research we paid attention to unique identifiers and codenames used by the developers in the malware. Most of this information is carefully protected with obfuscation or encryption algorithms to prevent quick recognition, but anyone who breaks through this layer of encryption may discover some interesting internal strings, as demonstrated below:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/03/08063305/EquationDrug_2.jpg" class="magnificImage"><img loading="lazy" id="69205" class="aligncenter size-full wp-image-69205" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/03/08063305/EquationDrug_2.jpg" alt="EquationDrug_2" width="633" height="135" /></a></p>
<p>Some other interesting text strings include:</p>
<div style="border: 1px solid #BCD9DD;margin-bottom: 15px;padding: 10px"><strong>SkyhookChow</strong> Target<br />
<strong>SkyhookChow</strong> Payload<br />
Dissecorp<br />
Manual/<strong>DRINKPARSLEY</strong>/2008-09-30/10:06:46.468-04:00<br />
VTT/82053737/<strong>STRAITACID</strong>/2008-09-03/10:44:56.361-04:00<br />
VTT/82051410/<strong>LUTEUSOBSTOS</strong>/2008-07-30/17:27:23.715-04:00<br />
<strong>STRAITSHOOTER</strong>30.ex_<br />
<strong>BACKSNARF</strong>_AB25<br />
c:\users\<strong>rmgree5</strong>\co\<strong>standalonegrok</strong>_2.1.1.1\gk_driver\gk_sa_driver…<br />
To install: run with no arguments<br />
Attempting to drop<br />
<strong>SF</strong>Criteria_Check failed!<br />
<strong>SF</strong>Driver<br />
Error detected! Uninstalling&#8230;<br />
Timeout waiting for the &#8220;canInstallNow&#8221; event from the <strong>implant-specific</strong> EXE!<br />
Trying to call <strong>privilege lib</strong>&#8230;<br />
Hiding directory<br />
Hiding plugin&#8230;<br />
Merging plugin&#8230;<br />
Merging old plugin key&#8230;<br />
Couldn&#8217;t reset canInstallNowEvent!<br />
Performing <strong>UR-</strong>specific pre-install&#8230;<br />
Work complete.<br />
Merged transport manager state.<br />
!!<strong>SF</strong>Config!!</div>
<p>Some other names, such as kernel object and file names, abbreviations, resource code page and several generic messages, point to English-speaking developers. Due to the limited number of such text strings it&#8217;s hard to tell reliably if the developers were native English speakers.</p>
<h3 id="link-timestamp-analysis">Link Timestamp Analysis</h3>
<p>We have gathered a reasonably large number of executable samples to which we have been able to apply link timestamp analysis.</p>
<p>A link timestamp is a 4-bytes value stored in an executable file header. This value is automatically set by compiler software when a developer builds a new executable. The value contains a detailed timestamp including minutes and even seconds of compilation time (think of it as the file&#8217;s moment of birth).</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/03/08063302/EquationDrug_3.jpg" class="magnificImage"><img loading="lazy" id="69206" class="aligncenter size-full wp-image-69206" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/03/08063302/EquationDrug_3.jpg" alt="EquationDrug_3" width="276" height="75" /></a></p>
<p>Link timestamp analysis require the collection of the timestamps of all available executables, grouping them according to certain criteria, such as the hour or day of the week, and putting them on a chart. Below are some charts built using this approach.</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/03/08063257/EquationDrug_4.jpg" class="magnificImage"><img loading="lazy" id="69207" class="aligncenter size-full wp-image-69207" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/03/08063257/EquationDrug_4.jpg" alt="EquationDrug_4" width="791" height="403" /></a><br />
<a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/03/08063252/EquationDrug_5_1.jpg" class="magnificImage"><img loading="lazy" id="69219" class="aligncenter wp-image-69219 size-full" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/03/08063252/EquationDrug_5_1.jpg" alt="" width="793" height="430" /></a></p>
<p>Can we trust this information? The answer is: not fully, because the link timestamp can be altered by the developer in a way that&#8217;s not always possible to spot. However, certain indicators such as matching the year on the timestamp with the support of technology popular in that year leads  us to believe that the timestamps were, at the very least, not wholly replaced. Looking at this from the other side, the easiest option for the developer is to wipe the timestamp completely, replacing it with zeroes. This was not found in the case of EquationDrug. In fact, the timestamps look very realistic and match the working days and hours of a well-organized software developer from timezone UTC-3 or UTC-4, if you assume that they come to work at 8 or 9 am.</p>
<blockquote class=""><p>The timestamps match the working days of software developer from timezone UTC-3 or UTC-4 #EquationAPT</p><a href="https://twitter.com/share?url=https%3A%2F%2Fsecurelist.com%2Finside-the-equationdrug-espionage-platform%2F69203%2F&text=The+timestamps+match+the+working+days+of+software+developer+from+timezone+UTC-3+or+UTC-4+%23EquationAPT" class="btn btn-twhite" data-lang="en" data-count="0">Tweet</a></blockquote>
<p>And finally, in case you are wondering if the developers work on public holidays, you can check this for yourself against the full list of their working dates:</p>
<div style="margin-bottom: 15px;text-align: center">
<table border="0px" width="100%" cellspacing="0">
<tbody>
<tr valign="center">
<td style="border-left: 1px solid #BCD9DD;width: 17%">2001.08.17</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2007.12.11</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2009.04.16</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2011.10.20</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2012.08.31</td>
<td style="border-left: 1px solid #BCD9DD;border-right: 1px solid #BCD9DD;width: 15%">2013.06.11</td>
</tr>
<tr valign="center">
<td style="border-left: 1px solid #BCD9DD;width: 17%">2001.08.23</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2007.12.17</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2009.06.05</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2011.10.26</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2012.09.28</td>
<td style="border-left: 1px solid #BCD9DD;border-right: 1px solid #BCD9DD;width: 15%">2013.06.26</td>
</tr>
<tr valign="center">
<td style="border-left: 1px solid #BCD9DD;width: 17%">2003.08.16</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2008.01.01</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2009.12.15</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2012.03.06</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2012.10.23</td>
<td style="border-left: 1px solid #BCD9DD;border-right: 1px solid #BCD9DD;width: 15%">2013.08.09</td>
</tr>
<tr valign="center">
<td style="border-left: 1px solid #BCD9DD;width: 17%">2003.08.17</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2008.01.23</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2010.01.22</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2012.03.22</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2012.11.02</td>
<td style="border-left: 1px solid #BCD9DD;border-right: 1px solid #BCD9DD;width: 15%">2013.08.28</td>
</tr>
<tr valign="center">
<td style="border-left: 1px solid #BCD9DD;width: 17%">2005.03.16</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2008.01.24</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2010.02.19</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2012.04.03</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2012.11.06</td>
<td style="border-left: 1px solid #BCD9DD;border-right: 1px solid #BCD9DD;width: 15%">2013.10.16</td>
</tr>
<tr valign="center">
<td style="border-left: 1px solid #BCD9DD;width: 17%">2005.09.08</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2008.01.29</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2010.02.22</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2012.04.04</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2013.01.08</td>
<td style="border-left: 1px solid #BCD9DD;border-right: 1px solid #BCD9DD;width: 15%">2013.11.04</td>
</tr>
<tr valign="center">
<td style="border-left: 1px solid #BCD9DD;width: 17%">2006.06.15</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2008.01.30</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2010.03.27</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2012.04.05</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2013.02.07</td>
<td style="border-left: 1px solid #BCD9DD;border-right: 1px solid #BCD9DD;width: 15%">2013.11.26</td>
</tr>
<tr valign="center">
<td style="border-left: 1px solid #BCD9DD;width: 17%">2006.09.18</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2008.04.24</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2010.06.15</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2012.04.12</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2013.02.21</td>
<td style="border-left: 1px solid #BCD9DD;border-right: 1px solid #BCD9DD;width: 15%">2013.12.04</td>
</tr>
<tr valign="center">
<td style="border-left: 1px solid #BCD9DD;width: 17%">2006.10.04</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2008.05.07</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2011.02.09</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2012.07.02</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2013.02.22</td>
<td style="border-left: 1px solid #BCD9DD;border-right: 1px solid #BCD9DD;width: 15%">2013.12.05</td>
</tr>
<tr valign="center">
<td style="border-left: 1px solid #BCD9DD;width: 17%">2006.10.16</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2008.05.09</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2011.02.23</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2012.07.09</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2013.02.27</td>
<td style="border-left: 1px solid #BCD9DD;border-right: 1px solid #BCD9DD;width: 15%">2013.12.13</td>
</tr>
<tr valign="center">
<td style="border-left: 1px solid #BCD9DD;width: 17%">2007.07.12</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2008.06.17</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2011.08.08</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2012.07.17</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2013.04.16</td>
<td style="border-left: 1px solid #BCD9DD;border-right: 1px solid #BCD9DD;width: 15%"></td>
</tr>
<tr valign="center">
<td style="border-left: 1px solid #BCD9DD;width: 17%">2007.10.02</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2008.09.17</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2011.08.30</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2012.08.02</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2013.05.08</td>
<td style="border-left: 1px solid #BCD9DD;border-right: 1px solid #BCD9DD;width: 15%"></td>
</tr>
<tr valign="center">
<td style="border-left: 1px solid #BCD9DD;width: 17%">2007.10.16</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2008.09.24</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2011.09.02</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2012.08.03</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2013.05.14</td>
<td style="border-left: 1px solid #BCD9DD;border-right: 1px solid #BCD9DD;width: 15%"></td>
</tr>
<tr valign="center">
<td style="border-left: 1px solid #BCD9DD;width: 17%">2007.12.10</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2008.12.05</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2011.10.04</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2012.08.14</td>
<td style="border-left: 1px solid #BCD9DD;width: 17%">2013.05.24</td>
<td style="border-left: 1px solid #BCD9DD;border-right: 1px solid #BCD9DD;width: 15%"></td>
</tr>
</tbody>
</table>
</div>
<h2 id="conclusions">Conclusions</h2>
<p>EquationDrug represents the main espionage platform from the Equation Group. It&#8217;s been in use for over 10 years, replacing EquationLaser until it was replaced itself by the even more sophisticated GrayFish platform.</p>
<blockquote class=""><p>The EquationDrug case demonstrates an interesting trend: a growth in code sophistication #EquationAPT</p><a href="https://twitter.com/share?url=https%3A%2F%2Fsecurelist.com%2Finside-the-equationdrug-espionage-platform%2F69203%2F&text=The+EquationDrug+case+demonstrates+an+interesting+trend%3A+a+growth+in+code+sophistication+%23EquationAPT" class="btn btn-twhite" data-lang="en" data-count="0">Tweet</a></blockquote>
<p>The EquationDrug case demonstrates an interesting trend that we have been seeing while analyzing supposedly nation-state cyberattack tools: a growth in code sophistication. It is clear that nation-state attackers are looking for better stability, invisibility, reliability and universality in their cyberespionage tools. You can make a basic browser password-stealer or a sniffer within days.  However, nation-states are focused on creating frameworks for wrapping such code into something that can be customized on live systems and provide a reliable way to store all components and data in encrypted  form, inaccessible to normal users. While traditional cybercriminals mass-distribute emails with malicious attachments or infect websites on a large scale, nation-states create automatic systems infecting only selected users. While traditional cybercriminals typically reuse one malicious file for all victims, nation-states prepare malware unique to each victim and even implement restrictions preventing decryption and execution outside of the target computer.</p>
<blockquote class=""><p>Nation-state attackers create automatic systems infecting only selected users #EquationAPT</p><a href="https://twitter.com/share?url=https%3A%2F%2Fsecurelist.com%2Finside-the-equationdrug-espionage-platform%2F69203%2F&text=Nation-state+attackers+create+automatic+systems+infecting+only+selected+users+%23EquationAPT" class="btn btn-twhite" data-lang="en" data-count="0">Tweet</a></blockquote>
<p>Sophistication of the framework is what makes this type of actor different from traditional cybercriminals, who prefer to focus on payload and malware capabilities such as implementing a long list of custom third-party software credential database parsers.</p>
<p>The difference in tactics between cybercriminals and nation-state attackers appears to be due to relative resource availability. It&#8217;s known that cybercriminals attempt to infect as many users as possible and that they can sometimes compromise hundreds of thousands of systems. It would will take many years to check all those machines manually, analyzing who owns them, what data is stored on them, and what custom software they run.</p>
<p>Cybercriminals probably don&#8217;t even have enough disk space to collect all the potentially interesting data from the victims hit by their large scale infections. That is why cybercriminals prefer to extract tiny chunks of the most important data (credentials, credit card numbers, etc) on the machine of the victim and transfer only few kilobytes from each compromised host. Such data, when combined from all users, normally takes up gigabytes of disk space.</p>
<p>Nation-state attackers have sufficient resources to store as much data as they want. They have access to virtually unlimited data storage. However, they don&#8217;t need, and often try to avoid, infecting random users, for the obvious reason of avoiding attention and remaining invisible. Implementing custom data format parsers in the malware not only doesn&#8217;t help them find all the valuable data on the victim&#8217;s machine, but may also attract extra attention from security software running on the system. They mostly prefer to have a generic remote system management tool that can copy any information they might need even if it causes some redundancy. However, copying large volumes of information might slow down network connection and attract attention, especially in some countries with poorly developed internet infrastructure. To date, nation-state attackers have had to balance between these two poles: copying victims&#8217; entire hard drives while stealing only tiny bits of passwords and keys.</p>
<blockquote class=""><p>Nation-state attackers use a remote system management tool that can copy any information they need #EquationAPT</p><a href="https://twitter.com/share?url=https%3A%2F%2Fsecurelist.com%2Finside-the-equationdrug-espionage-platform%2F69203%2F&text=Nation-state+attackers+use+a+remote+system+management+tool+that+can+copy+any+information+they+need+%23EquationAPT" class="btn btn-twhite" data-lang="en" data-count="0">Tweet</a></blockquote>
<p>Now, if you wonder why EquationDrug, a powerful cyberespionage platform, doesn&#8217;t provide all stealing capability as standard in its malware core, the answer is that they prefer to customize the attack for each one of their victims. Only if they have chosen to actively monitor you and the security products on your machines have been disarmed, will you receive a plugin for the live tracking of your conversations or other specific functions related to your activities. We believe modularity and customization will become a unique trademark of nation-state attackers in the future.</p>
<p>Some code paths in EquationDrug modules lead to OS version checks including a test for Windows 95, which is accepted as one of supported platforms. While some other checks will not pass on Windows 95, the presence of this code means that this OS was supported in some earlier variants of the malware. Considering this and the existence of components designed to run on Windows 9x (such as VXD-files), as well as compilation timestamps dating back to early 2000s, the hypothesis  that these attackers have been active since the 90s seems realistic. This makes the current attacker an outstanding actor operating longer than any other in the field.</p>
<hr style="width: 100%" />
<h2 id="technical-details">Technical Details</h2>
<h3 id="kernel-mode-stage-0-windows-9x-mssvc32-vxd">Kernel mode stage 0 (Windows 9x) &#8211; mssvc32.vxd</h3>
<div style="margin-bottom: 15px;text-align: center">
<table border="0" width="90%">
<tbody>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>MD5</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;text-align: left">0a5e9b15014733ee7685d8c8be81fb0d</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Size</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">6 710 bytes</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Format</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Linear Executable (LE)</td>
</tr>
</tbody>
</table>
</div>
<p>This VXD driver handles only two control messages: W32_DeviceIoControl and Dynamic_Init. The DeviceIoControl part is not completely implemented and the driver is only able to check for some known control codes.  However it does nothing. This handler looks more like a code stub rather than actual payload.</p>
<p>On the Dynamic_Init event, the driver retrieves the location of the user-mode loader executable from the following registry value:</p>
<p><strong><em>[HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\MemSubSys] Config</em></strong></p>
<p>If the value is not present in the registry, it uses the following fallback string hardcoded in the binary:</p>
<p><strong>C:\WINDOWS\SYSTEM\SVCHOST32.EXE</strong></p>
<p>Next, it installs a callback procedure using Windows function _SHELL_CallAtAppyTime. This procedure will be called when CPU is running in ring-3 mode, so that a new executable (loader process) can be started via the traditional way. This is a standard trick that was used by developers in the 90s to initiate a call to DLL export in ring-3 from ring-0 in Windows 9x OS family.</p>
<h3 id="kernel-mode-stage-0-and-rootkit-windows-2000-and-above-msndsrv-sys">Kernel mode stage 0 and rootkit (Windows 2000 and above) &#8211; msndsrv.sys</h3>
<div style="margin-bottom: 15px;text-align: center">
<table border="0" width="90%">
<tbody>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>MD5</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;text-align: left">c4f8671c1f00dab30f5f88d684af1927</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Size</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">105 392 bytes</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Format</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">PE32 Native</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Compiled</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">2008.01.23 14:12:33 (GMT)</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Location</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">%System32%\drivers\msndsrv.sys</td>
</tr>
</tbody>
</table>
</div>
<p>This module can create log files in the following known locations:</p>
<p><strong>%systemroot%\system32\mslog32.dat</strong><br />
<strong>%systemroot%\system32\msperf32.dat</strong> (default location)</p>
<p>The driver acts as the first stage of the EquationDrug platform on Windows 2000+ and implements rootkit functions for hiding the components of the platform. Additionally, it implements a NDIS driver for filtering network traffic.</p>
<p>When started and initialized, the driver retrieves the location of the user-mode loader executable from the registry value:</p>
<p><strong><em>[HKLM\System\CurrentControlSet\Services\%driver name%] Config</em></strong></p>
<p>The <strong>%driver name%</strong> is not hardcoded and is obtained dynamically from the current module name, which means that different instances may check different registry keys and this may not be a reliable way to check for infection. The sample we analyzed used &#8220;<strong>msndsrv</strong>&#8221; as the <strong>%driver name%</strong>.</p>
<p>Next, it crafts and injects a shellcode in &#8220;services.exe&#8221; or &#8220;winlogon.exe&#8221;. The shellcode is designed to spawn the loader process from the executable called <strong>&#8220;mscfg32.exe&#8221;</strong>.</p>
<p>The rootkit code in the driver hooks several Native API functions that lets it hide or protect registry keys, files and running processes. The components of EquationDrug can modify the list of protected objects by sending DeviceIoControl messages to the driver. The driver also maintains a persistent list of protected objects that is stored in the following registry values:</p>
<p><strong><em>[HKLM\System\CurrentControlSet\Services\%driver name%] 1<br />
[HKLM\System\CurrentControlSet\Services\%driver name%] 2</em></strong></p>
<p>These values are also protected by the rootkit. They can be revealed by booting Windows in Safe Mode.</p>
<p>The driver contains the following unused strings:</p>
<ul>
<li><strong>\\.\mailslot\dskInfo</strong></li>
<li><strong>Dissecorp</strong></li>
</ul>
<h3 id="user-mode-loader-mscfg32-exe-svchost32-exe">User-mode loader &#8211; mscfg32.exe, svchost32.exe</h3>
<div style="margin-bottom: 15px;text-align: center">
<table border="0" width="90%">
<tbody>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>MD5</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;text-align: left">c3af66b9ce29efe5ee34e87b6e136e3a</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Size</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">22 016 bytes</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Format</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">PE32 EXE</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Compiled</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">2008.01.23 14:26:05 (GMT)</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Location</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">%System32%\mscfg32.exe</td>
</tr>
</tbody>
</table>
</div>
<p>This module opens a unique event named &#8220;<strong>D0385CB7-B834-45d1-A501-1A1700E6C34E</strong>&#8220;. If the event exists, it waits for 10 seconds and attempts to open a file whose name can be decrypted as &#8220;<strong>\\.\MSNDSRV</strong>&#8220;. If the device file is successfully opened, the code issues a device request with IOCTL code <strong>0x80000194</strong> and no parameters.</p>
<p>This module uses RC5 in CBC-like mode with a key length of 96-bit for string encryption.</p>
<p>Careful analysis reveals some bits of uninitialized memory found next to encryption key locations. This is unused but partly meaningful memory, because it seems to contain short chunks of strings resembling some local filepaths:</p>
<ul>
<li><strong>&#8220;rver\8&#8221; (probably part of &#8220;Server\8&#8230;&#8221; string)</strong></li>
<li><strong>&#8220;LInj&#8221; (could be a part of &#8220;DLLInjector&#8221; or similar)</strong></li>
</ul>
<p>It&#8217;s apparent that some parts of the code were designed to run on Windows 9x, for example a call to <strong>RegisterServiceProcess</strong> Windows API function makes sense only on Windows 9x OS family, because this API function doesn&#8217;t exist on Windows NT platform.</p>
<p>The module uses a unique algorithm for generating registry value names. The code contains strings, such as &#8220;<span style="color: #d00003">SkyhookChow Target</span>&#8220;, that are converted to GUID-like strings by calculating SHA1 hash and using its hexadecimal representation as a string. The resulting strings are used as actual registry value names in <strong><em>[HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\MemSubSys]</em></strong> registry key.</p>
<p>Sample registry value names:</p>
<div style="margin-bottom: 15px;text-align: center">
<table border="0" width="100%">
<tbody>
<tr valign="center">
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000" width="30%"><strong>Original String</strong></td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000" width="70%"><strong>GUID-like registry value name</strong></td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">SkyhookChow Target</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">{B6F5CD13-A74D-8B82-A6AA-6FA1BE2484C1-6832DF06}</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">SkyhookChow Payload</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">{F4CF0326-6DCD-EEC8-5323-01CEDB66741A-B55F6F12}</td>
</tr>
</tbody>
</table>
</div>
<p>These registry values are encrypted using an RC5 algorithm using a hardcoded 1024-bit key with 24 rounds.</p>
<p>The registry value:</p>
<p><strong><em>[HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\MemSubSys] {F4CF0326-6DCD-EEC8-5323-01CEDB66741A-B55F6F12}</em></strong> (&#8220;SkyhookChow Payload&#8221;)<br />
should contain the location of the orchestrator DLL file (&#8220;mscfg32.dll&#8221;). If the value is not present a default value <strong>&#8220;%SYSTEM%\mscfg32.dll&#8221;</strong> is used.</p>
<p>The registry value:</p>
<p><strong><em>[HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\MemSubSys] {B6F5CD13-A74D-8B82-A6AA-6FA1BE2484C1-6832DF06}</em></strong> (&#8220;SkyhookChow Target&#8221;)<br />
may contain the location of the executable file that will be used as a &#8220;shell&#8221; process for the orchestrator library.</p>
<p>The module attempts to start the &#8220;shell&#8221; process in suspended mode. If there is no &#8220;SkyhookChow Target&#8221; value or the specified executable fails to start, the module tries different failsafe locations of the programs that can be used instead:</p>
<ol>
<li>Default browser set in the registry <strong><em>[HKLM\SOFTWARE\Clients\StartMenuInternet\{current @default value}\shell\open\command]</em></strong></li>
<li><strong>%SystemRoot%\System32\svchost.exe</strong></li>
<li><strong>%SystemRoot%\System32\lsass.exe</strong></li>
<li>Spoolsv service binary from the <strong><em>[HKLM\SYSTEM\CurrentControlSet\Services\Spooler] ImagePath</em></strong> registry value.</li>
<li>Default html file handler from <strong><em>[HKLM\SOFTWARE\Classes\htmlfile\shell\open\command]</em></strong>registry value.</li>
<li>Internet Explorer path from <strong><em>[HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\] IEXPLORE.EXE</em></strong> registry value.</li>
</ol>
<p>Next, the module injects extra code into a newly started target process. The injected code loads the payload DLL (&#8220;mscfg32.dll&#8221;) into the target process and waits for the parent process to exit. When the parent process quits, it unloads the payload DLL and exits as well. The rest of the logic relies on the loaded DLL in that new process. See the description of the <strong>&#8220;mscfg32.dll&#8221;</strong> module below.</p>
<p>The module communicates with the Stage0/Rootkit driver <strong>&#8220;msndsrv.sys&#8221;</strong> by sending DeviceIoControl messages to the device &#8220;<strong>\\.\MSNDSRV&#8221;.</strong> It activates the rootkit for its own process, for the target process holding the orchestrator and for all the files involved.</p>
<h3 id="platform-orchestrator-mscfg32-dll-svchost32-dll">Platform orchestrator &#8211; mscfg32.dll, svchost32.dll</h3>
<div style="margin-bottom: 15px;text-align: center">
<table border="0" width="90%">
<tbody>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>MD5</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;text-align: left">5767b9d851d0c24e13eca1bfd16ea424</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Size</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">249 856 bytes</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Format</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">PE32 DLL</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Compiled</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">2008.01.24 22:11:34 (GMT)</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Location</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">%System%\mscfg32.dll</td>
</tr>
</tbody>
</table>
</div>
<p>Creates mutex: &#8220;<strong>01C482BA-BD31-4874-A08B-A93EA5BCE511</strong>&#8220;, or terminates if one already exists.</p>
<p>Writes a timestamped log file to one of the following locations:</p>
<ul>
<li><strong>%SystemRoot%\temp\~yh56816.tmp</strong></li>
<li><strong>C:\Windows\Temp\~yh56816.tmp</strong></li>
<li><strong>%Registry_SystemRoot_Value%\temp\~yh56816.tmp</strong></li>
<li>Value of <strong><em>[HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\MemSubSys] D</em></strong></li>
</ul>
<p>The file &#8220;~yh56816.tmp&#8221; retains the history of execution. It comprises debug records of simple structure:</p>
<p><strong>        Stage: DWORD | DateTimeLow: DWORD | DateTimeHigh: DWORD</strong></p>
<p>Basically, it logs the execution of every stage of the orchestrator and the time of execution. The Stage is an integer number starting from 1.</p>
<p>This module spawns a new thread in the DllMain function which contains the main function body. The procedure disables application error popups shown by the default exception handler. This is probably done only in the &#8220;Release&#8221; version of the malware, because the following code generates exceptions that are reported to the user if application error popups are not disabled. We assume that the &#8220;Debug&#8221; version of the code doesn&#8217;t suppress error popups when exception occurs as this helps with the debugging of the code.</p>
<p>The module checks the OS version and if it encounters an unsupported operating system the code generates an exception which terminates the application. The list of OS versions that pass this test:</p>
<ul>
<li>Windows 95/98/ME</li>
<li>Windows NT 4.0 and above.</li>
</ul>
<p>If the module runs on Win9x, it executes Win9x-specific function RegisterServiceProcess to hide from the Windows Task Manager application. If the module is NOT running on WinNT6.0+, it then attempts to open a virtual device file with one of the following names:</p>
<ul>
<li><strong>\\.\MSSVC32</strong> on Win9x</li>
<li><strong>\\.\MSNDSRV</strong> on WinNT</li>
</ul>
<p>If the device file is successfully opened, the module activates a rootkit for its process and for the file location <strong>&#8220;%SYSTEM%\unilay.dll&#8221;</strong> local path. This is followed by finding and terminating a process named &#8220;<strong>winproc.exe</strong>&#8221; which is the name of another component of the platform. Note that this part of the code is executed only on platforms different from WinNT 6.x (Windows Vista and later).</p>
<p>The module was designed to fetch or update its main configuration data from different places. There are some default values set inside the code, such as some timeout values and the following C&amp;Cs:</p>
<ul>
<li><strong>www.waeservices[.]com</strong></li>
<li><strong>213.198.79.49</strong></li>
</ul>
<p>These default values can be overwritten later.</p>
<p>Next, it locates a data section called &#8220;<strong>Share2</strong>&#8221; in the current module and verifies the starting magic number. If it is <strong>0x63959700,</strong> it then decrypts the rest of the data in the section and interprets it as a configuration block. However, data from the next location can override all previous settings. This is a registry value with special name.</p>
<p>The naming of the registry location is the same GUID-like SHA1 value as the one used in the loader (&#8220;mscfg32.exe&#8221;), and is produced from the source string &#8220;Configuration&#8221;:</p>
<p><strong><em>[HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\MemSubSys] {42E14DD3-F07A-78F1-7659-26AE141569AC-E0B3EE89}</em></strong></p>
<p>The configuration block stored in the registry value is encrypted using RC5 with the 1024-bit key. Both the loader and the orchestrator share the same key for encrypting and decrypting the registry values in the &#8220;MemSubSys&#8221; key.</p>
<p>The decrypted configuration block consists of a series of tagged configuration records in the following format:</p>
<p><strong>        [RecordType:DWORD][RecordSize: DWORD][RecordValue: %RecordSize%]</strong></p>
<p>We retrieved a copy of a configuration block and decrypted and partly interpreted it. We are including the results for one of the configuration blocks:</p>
<div style="border: 1px solid #BCD9DD;margin-bottom: 15px;padding: 10px"><strong>Time value</strong>: 1 year 0 months 1 days 22 hours 6 mins 52 secs. The orchestrator is expected to set this field to the time of initial configuration.<br />
<strong>Binaries</strong>: 3&#215;1024-bit encryption keys<br />
1b8e7818dad6345c53c2707a2c44648eee700d5cf34fea6a19a3fa0a6a871c72963fdded 91e2703c82b7747b8793e3063700da32cfb8d907dcce1beb36edd575418d1134ef188b 27ec3ce23711a656b0a8bf28921fbf1c39b4c90ad561e4174ed90f26ce11245bb9deb4b 4720403f47ca865ec8bbd3c1df9d93d042ff5b52ec6<br />
05000000000000000000000000000000000000000000000000000000000000000000 00000000000000000000000000000000000000000000000000000000000000000000 00000000000000000000000000000000000000000000000000000000000000000000 0000000000000000000000000000000000000000000000000000<br />
ed04953f3452068ae6439f04c7904c8be5e98e66e2cd0f267d65240aeed88bd4d3c6105 c99950dd42ccde4bc6bbaf9f6cb1b4e628d943e91f8f97f2aff705fdd25e3af6ba0bc4fd13 d67a2bcb751bb8f21f3d4b66c599f3e572802911394d142f8cf3a299d6d4558f9f0f01634 9afd1888472f4f8c729ffe913f670931f1a227<br />
<strong>C&amp;C domain</strong>: www[dot]waeservices[dot]com<br />
<strong>C&amp;C IP address</strong>: 213.198.79.49<br />
<strong>C&amp;C port</strong>: 443<br />
<strong>Timestamp</strong>: 2010-12-08 11:35:57<br />
<strong>Tool Reference</strong>: <strong>VTT/82055898/STEALTHFIGHTER/ 2008-10-16/14:59:06.229-04:00</strong><br />
<strong>TimeoutA</strong>: 25200 sec (7 hours)<br />
<strong>TimeoutB</strong>: 32400 sec (9 hours)<br />
<strong>TimeoutC</strong>: 3600 sec (1 hour)<br />
<strong>TimeoutD</strong>: 172800 sec (48 hours)<br />
+Several Unknown Values</div>
<p>Other configuration blocks we discovered contained similar information, with only some unique values:</p>
<div style="border: 1px solid #BCD9DD;margin-bottom: 15px;padding: 10px"><strong>Timestamp</strong>: 2009-11-23 14:10:15<br />
<strong>Tool Reference</strong>: <strong>Manual/DRINKPARSLEY/2008-09-30/10:06:46.468-04:00</strong><br />
<strong>Tool Reference</strong>: <strong>VTT/82053737/STRAITACID/2008-09-03/10:44:56.361-04:00</strong><br />
<strong>Tool Reference</strong>: <strong>STRAITSHOOTER30.ex_</strong><br />
<strong>Tool Reference:</strong> VTT/82051410/<strong>LUTEUSOBSTOS</strong>/2008-07-30/17:27:23.715-04:00<br />
<strong>Tool Reference: BACKSNARF_AB25</strong></div>
<p>During the next step, the module obtains PE file version information from the resource section. It loads the version info using hard-coded module names, which are supposed to match the current module name:</p>
<ul>
<li><strong>SVCHOST32.DLL</strong> for Windows 9x</li>
<li><strong>MSCFG32.DLL</strong> for Windows NT</li>
</ul>
<p>If file version information is available, it gets language-specific values of the PrivateBuild block. The codepage and languages that are verified: Unicode, <strong>LANG_NEUTRAL</strong> and <strong>LANG_ENGLISH_US</strong>. When this check passes, the module gets <strong>@default</strong> registry value from the following location:</p>
<ul>
<li><strong><em>[HKLM\SOFTWARE\Classes\CLSID\{091FD378-422D-A36E-8487-83B57ADD2109}] TypeLib</em></strong></li>
</ul>
<p>If the key is not found, the code checks for registry value <strong>TypeLib</strong> in the following key:</p>
<ul>
<li><strong><em>[HKLM\SOFTWARE\Classes\CLSID\{091FD378-422D-A36E-8487-83B57ADD2109}]</em></strong></li>
</ul>
<p>If such a value is found, it is then deleted along with the <strong>Version</strong> value if it exists in the same key.</p>
<p>The string obtained from one of two possible registry values is processed as if this value is a CLSID-like string: the code takes the last 16 hexadecimal digits, splits them in two 8-chars values, converts them to binary form (two DWORDs) and reverses the order of bytes in each DWORD and XORs, the first value with <strong>0x8ED400C0</strong><strong>,</strong> and the second with <strong>0x4FC2C17B</strong>.  Next, the first DWORD value becomes second and the second becomes first. In this order, they are stored in a structure in memory. These two values seem to be very important as they override a few values in the previously known configuration. If they don&#8217;t exist, values from the current configuration replace them and are stored back in the registry following the reverse procedure:</p>
<ol>
<li><strong><em>[HKLM\SOFTWARE\Classes\CLSID\{091FD378-422D-A36E-8487-83B57ADD2109}\Version]</em></strong> is created and <strong>@default</strong> value is set to version obtained from file version information <strong>PrivateBuild</strong> field (i.e. <strong>3.04.00.0001</strong>). This seems to be <strong>used as kit version number</strong>.</li>
<li><strong><em>[HKLM\SOFTWARE\Classes\CLSID\{091FD378-422D-A36E-8487-83B57ADD2109}\Version]</em></strong> is created and <strong>@default</strong> value is set to a CLSID like string generated from the following:
<ul>
<li>Fixed prefix string: <strong>&#8220;{8C936AF9-243D-11D0-&#8220;</strong></li>
<li>Two important DWORD values in the format of &#8220;%04X-%04X%08X}&#8221; string.</li>
</ul>
</li>
</ol>
<p>We collected and decrypted several samples of such values. According to the code, they are initialized with values of the Microsoft filetime format. So, we decided to interpret them as filetime values:</p>
<div style="border: 1px solid #BCD9DD;margin-bottom: 15px;padding: 10px">20101C04EC2C17B: 1 year(s) 7 month(s) 21 day(s) 23 hour(s) 32 min(s) 1 sec(s)<br />
81E01C04EC2C17B: 1 year(s) 7 month(s) 8 day(s) 12 hour(s) 13 min(s) 5 sec(s)<br />
E0001C04EC2C17B: 1 year(s) 7 month(s) 21 day(s) 1 hour(s) 6 min(s) 15 sec(s)<br />
77101C04EC2C17B: 1 year(s) 5 month(s) 20 day(s) 19 hour(s) 15 min(s) 4 sec(s)<br />
30F01C04EC2C17B: 1 year(s) 8 month(s) 0 day(s) 6 hour(s) 10 min(s) 33 sec(s)<br />
C0901C04EC2C17B: 1 year(s) 8 month(s) 2 day(s) 6 hour(s) 29 min(s) 39 sec(s)<br />
66701C04EC2C17B: 1 year(s) 6 month(s) 9 day(s) 2 hour(s) 10 min(s) 23 sec(s)<br />
F6501C04EC2C17B: 1 year(s) 6 month(s) 6 day(s) 19 hour(s) 53 min(s) 22 sec(s)<br />
01401C04EC2C17B: 1 year(s) 6 month(s) 25 day(s) 23 hour(s) 34 min(s) 13 sec(s)</div>
<p>After that, the module stores current time values in encrypted form in the registry value:</p>
<p><strong><em>[HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\MemSubSys] {08DAB849-0E1E-A1F0-DCF1-457081E091DB-117DB663}</em></strong> (encoded SHA1 of &#8220;StartTime&#8221;)</p>
<p>The module contains an additional compressed Windows DLL file in the resource section, which is extracted as <strong>&#8220;unilay.dll&#8221;</strong> (see below). This DLL exports a number of functions that are just wrappers of the system API used to work with files and the registry, and also start processes and load additional DLL files.</p>
<p>The orchestrator contains several built-in plugins that form the core of the platform. These are initialized in the first place, and then additional plugins are loaded. All the plugins are indexed in a single encrypted registry value:</p>
<p><strong><em>[HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\MemSubSys] 1</em></strong></p>
<p>This value has information about all the components of the current kit. It may include Unicode strings with paths to extra DLLs which serve as plugins. Each DLL exports at least four functions which are imported by ordinal numbers from 1 to 4.</p>
<p>The structure of the registry value &#8220;1&#8221;:</p>
<p><strong>[Count:DWORD]{ [Plugin Id:WORD][Plugin Path Length:DWORD][Plugin Path String:VARIABLE] }</strong></p>
<p>Plugins interact with each other and with the orchestrator by exchanging messages of pre-defined format. The message transport is implemented as a global object that contains four communication streams. Every stream contains a pair of kernel synchronization object handles (a semaphore with fixed maximum value defaulted to 1000 and a mutex) and a message queue as an array. A dedicated thread processes messages that appear in the message queues.</p>
<p>A message arrives in a parcel, represented as two DWORD values that contain the size of the message and a pointer to the message data. The message data starts with a DWORD identifying a class of message (a request, reply, etc).</p>
<p>The orchestrator contains the following built-in plugins (listed by internal ID): 8000, 8022, 8024, 803C, 8046, 800A, 8042, 8002, 8004, 8006, 8008, 8070, 808E. Several additional built-in modules have been discovered in newer versions of the orchestrator that was shipped with the GrayFish platform.</p>
<h2 id="equationdrug-plugins">EquationDrug Plugins:</h2>
<div style="margin-bottom: 15px;text-align: center">
<table border="0" width="100%">
<tbody>
<tr valign="center">
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000" width="20%"><strong>Plugin ID</strong></td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000" width="30%"><strong>File name</strong></td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000" width="50%"><strong>Description</strong></td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">8000</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left"><em>Built-in</em></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Core, basic API for other modules</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">8002</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">wshcom.dll</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">C&amp;C communication using Windows sockets</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">8004</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left"><em>Built</em><em>-in</em></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Additional message queue</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">8006</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left"><em>Built</em><em>-in</em></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Memory allocation / storage</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">8008</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">vnetapi32.dll&amp;</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">C&amp;C communication code based on DoubleFantasy, using WinInet API</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">800A</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left"><em>Built</em><em>-in</em></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">C&amp;C communication orchestrator</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">800C</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">perfcom.dll</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">HTTP communication</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">8022</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">khlp680w.dll</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">System API: execute processes, load libraries, manipulate files and directories</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">8024</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">cmib158w.dll</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Collects system information: OS version, computer name, user name, locale, keyboard layout, timezone, process lists</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">8034</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">cmib456w.dll</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Management of the VFS backed by encrypted &#8220;.FON&#8221; files in the &#8220;Fonts\Extension&#8221; directory. Provides encryption using RC5 for these files</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">803E</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">nls_874w.dll</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Network sniffer</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">803C</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left"><em>Built</em><em>-in</em></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Communication with the NDIS filter part of &#8220;msndsrv.sys&#8221;</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">8040</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">khlp807w.dll</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Network exploration API, share enumeration and access</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">8042</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left"><em>Built</em><em>-in</em></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Compression library based on Nrv2d / UCL</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">8046</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left"><em>Built</em><em>-in</em></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Communication with the rootkit part of &#8220;msndsrv.sys&#8221;</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">8048</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">mstkpr.dll</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Disk forensics and direct NTFS reader based on sources of SleuthKit</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">8050</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">khlp760w.dll</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Additional encryption facilities for the file-backed VFS</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">8058</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">khlp733w.dll</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Collects local system information, WMI information, cached passwords</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">8070</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">khlp747w.dll</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Enumerates processes and system objects</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">807A</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">mscoreep32.dll</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Plugins for monitoring Internet Explorer and Mozilla browser activities</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">808A</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">khlp866w.dll</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Compression library based on Zlib</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">808E</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left"><em>Built-in</em></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Reverse (PTR record) DNS resolver</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">8094</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left"><em>Built-in</em></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">In-memory storage</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">809C</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left"><em>Built-in</em></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">In-memory storage</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">80AA</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">nls933w.dll</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">HDD / SSD firmware manipulation</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">80AE</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">wpl913h.dll</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Keylogger and clipboard monitoring (aka &#8220;GROK&#8221;)</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">80BE</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">vnetapi.dll</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">C&amp;C communication via WinHTTP API</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">80C6</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">webmgr.dll</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Extracts web history, Mozilla/Internet Explorer-saved form data and cached credentials</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">80CA</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">wshapi.dll</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">C&amp;C communications interface via Windows sockets</td>
</tr>
</tbody>
</table>
</div>
<h2 id="additional-components">Additional components</h2>
<h3 id="unilay-dll">Unilay.DLL</h3>
<p>This module provides a compatibility layer for accessing system API functions for Windows 9x. It redirects Unicode (&#8220;W&#8221;) variants of Windows API functions to corresponding ANSI variants by converting Unicode string parameters to multi-byte strings and calling the respective ANSI API.</p>
<div style="margin-bottom: 15px;text-align: center">
<table border="0" width="90%">
<tbody>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>MD5</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;text-align: left">EF4405930E6071AE1F7F6FA7D4F3397D</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Size</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">9 728 bytes</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Compiled</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">2008.01.23 14:23:10 (GMT)</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Format</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">PE32 DLL, linker version 6.0 (Microsoft Visual C++ 6.0)</td>
</tr>
</tbody>
</table>
</div>
<p>Exported functions (redirected to ANSI variants):</p>
<ul>
<li>100017EF: CopyFileW</li>
<li>10001039: CreateDirectoryW</li>
<li>10001111: CreateFileW</li>
<li>100011B3: CreateProcessW</li>
<li>10001177: DeleteFileW</li>
<li>10001516: FindFirstChangeNotificationW</li>
<li>10001466: FindFirstFileExW</li>
<li>10001300: FindFirstFileW</li>
<li>100014C6: FindNextFileW</li>
<li>10001564: GetCurrentDirectoryW</li>
<li>1000188F: GetFileAttributesW</li>
<li>100016C6: GetStartupInfoW</li>
<li>10001602: GetSystemDirectoryW</li>
<li>10001664: GetWindowsDirectoryW</li>
<li>10001853: LoadLibraryW</li>
<li>1000178B: MoveFileExW</li>
<li>1000172D: MoveFileW</li>
<li>10001913: RegCreateKeyExW</li>
<li>100019F5: RegDeleteKeyW</li>
<li>10001DDF: RegDeleteValueW</li>
<li>10001A39: RegEnumKeyExW</li>
<li>10001BE2: RegEnumValueW</li>
<li>1000199B: RegOpenKeyExW</li>
<li>10001B23: RegQueryInfoKeyW</li>
<li>10001D57: RegSetValueExW</li>
<li>100010D5: RemoveDirectoryW</li>
<li>10001E81: SHGetFileInfoW</li>
<li>100015C6: SetCurrentDirectoryW</li>
<li>100018CB: SetFileAttributesW</li>
<li>10001E23: lstrcmpW</li>
</ul>
<h3 id="network-sniffer-patcher-atmdkdrv-sys">Network-sniffer/patcher &#8211; atmdkdrv.sys</h3>
<div style="margin-bottom: 15px;text-align: center">
<table border="0" width="90%">
<tbody>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>MD5s</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;text-align: left">8d87a1845122bf090b3d8656dc9d60a8<br />
214f7a2c95bdc265888fbcd24e3587da</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Size</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">41 440, 43 840 bytes</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Format</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">PE32 Native</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Compiled</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">2009.04.16 17:19:30 (GMT)<br />
2008.05.07 19:55:14 (GMT)</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Version Info</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">
<ul>
<li>FileDescription: Network Services</li>
<li>LegalCopyright: Copyright (C) Microsoft Corp. 1981-2000</li>
<li>InternalName: atmdkdrv.sys</li>
</ul>
<p>or</p>
<ul>
<li>FileDescription: CineMaster C 1.1 WDM Main Driver</li>
<li>LegalCopyright: Copyright 1999 RAVISENT Technologies Inc.</li>
<li>InternalName: ATMDKDRV.SYS</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<p>Creates a file storage &#8220;<strong>\SystemRoot\fonts\vgafixa1.fon</strong>&#8220;. Its first word is set to 0x21 at the beginning of the DriverEntry function, and is replaced with 0x20 at the end of DriverEntry.</p>
<p>This driver appears to have been put together in &#8220;quick-and-dirty hack&#8221; style, using parts of the &#8220;<strong>mstcp32.sys&#8221;</strong> sniffer and other unknown drivers. It contains a lot of unused code which is partially broken or disabled. These include a broken &#8220;Dynamically disable/enable windows audit logging&#8221; subsystem and an incomplete &#8220;Patcher mode&#8221;.</p>
<p>There are three algorithms used for strings encryption &#8211; RC5; alphabet encryption like the one used in &#8220;mstcp32.sys&#8221;; and XOR with a pre-seeded random number generator. Decrypted strings are immediately encrypted back until the next usage to avoid in-memory detection.</p>
<p>The driver&#8217;s filename and device name differ across the samples. They depend on the name of the registry key that is used to start the driver.</p>
<p>The driver may operate in one of two independent modes &#8211; as a network sniffer or as a memory patcher. The mode of operation is selected on startup, based on the &#8220;Config2&#8221; value of the driver&#8217;s registry key. By default the driver starts in &#8220;sniffer mode&#8221;.</p>
<h4 id="sniffer-mode">Sniffer mode</h4>
<p>The sniffer code is similar to the one used in the driver&#8217;s &#8220;tdip.sys&#8221; and &#8220;mstcp32.sys&#8221; and uses NT4 NDIS-4, XP NDIS-5 interfaces, targeting incoming traffic on Ethernet and VPN (ndiswanip) interfaces. It captures only directed packets (containing a destination address equal to the station address of the NIC). Packers-filtering engine rules may be set via DeviceIoControl messages. Filtered packets are stored in-memory until requested. Maximum packets storage list length is 128 items per filtering rule.</p>
<h4 id="patcher-mode">Patcher mode</h4>
<p>Almost broken, it does nothing interesting except, possibly, replace the thread&#8217;s ServiceTable to an unchanged, clear copy taken from the on-disk image of &#8220;ntoskrnl.exe&#8221;.</p>
<p><strong>Sniffer only IOCTLs:</strong><br />
44038004 &#8211; add filtering rule<br />
44038008 &#8211; clear stored packet in specified filtering rules list<br />
4403800C &#8211; enable specified filtering rule<br />
44038010 &#8211; disable specified filtering rule<br />
44038014 &#8211; get stored packet from specified filtering rules list<br />
44038018 &#8211; process packet like the one received from the wire (filter and store)<br />
4403801C &#8211; set maximum rules list length<br />
44038020 &#8211; get maximum rules list length<br />
80000004 &#8211; enablePacketsFiltering<br />
80000008 &#8211; disablePacketsFiltering (PauseSniffer)<br />
800024B4 &#8211; send packet to the specified network interface</p>
<p><strong>Common IOCTLs:</strong><br />
80000028 &#8211; do nothing (broken/unused part)<br />
80000038 &#8211; set external object (broken/unused part)<br />
8000003C &#8211; get 4 dwords struct (broken/unused part)<br />
80000040 &#8211; copy 260 bytes from the request (broken/unused part)<br />
80000320 &#8211; set I/O port mapping (broken/unused part)<br />
80000324 &#8211; clear I/O port mapping (broken/unused part)<br />
80000328 &#8211; set external PnP Event (broken/unused part)<br />
80000640 &#8211; replace specified thread&#8217;s SDT (ETHREAD.ServiceTable field) to a given copy</p>
<h3 id="backdoor-driven-by-network-sniffer-mstcp32-sys-fat32-sys">Backdoor driven by network sniffer &#8211; &#8220;mstcp32.sys&#8221;, &#8220;fat32.sys&#8221;</h3>
<div style="margin-bottom: 15px;text-align: center">
<table border="0" width="90%">
<tbody>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>MD5s</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;text-align: left">74DE13B5EA68B3DA24ADDC009F84BAEE<br />
B2C7339E87C932C491E34CDCD99FEB07<br />
311D4923909E07D5C703235D83BF4479<br />
21C278C88D8F6FAEA64250DF3BFFD7C6</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Size</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">57 328 &#8211; 57 760 bytes</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Format</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">PE32 Native</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Compiled</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">2007.10.02 12:42:14 (GMT)<br />
2001.08.17 20:52:04 (GMT)</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Version Info</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">
<ul>
<li>FileDescription: TCP/IP driver</li>
<li>LegalCopyright: Copyright (C) Microsoft Corp. 1981-1999</li>
<li>InternalName: mstcp32.sys</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<p>This is a sniffer tool similar to &#8220;tdip.sys&#8221; and it uses NT4 NDIS-4, XP NDIS-5 interfaces.  It targets incoming traffic on Ethernet and VPN (ndiswanip) interfaces, but instead of dumb packet dumping, it uses received packets as commands for the &#8220;process injector&#8221; subsystem that is able to extract and execute code from the specially crafted network packets.</p>
<p>Default filtering rules are stored in the &#8220;Options&#8221; registry value of the driver&#8217;s registry key. It captures only directed packets (containing a destination address equal to the station address of the NIC).</p>
<p>The driver&#8217;s filename and device name differ across the samples. They depend on the name of the registry key that is used to start the driver.</p>
<h4 id="code-patcher">Code Patcher</h4>
<p>The driver patches OS code to dynamically disable or enable Windows audit logging.</p>
<p>It patches the function &#8220;<strong>LsapAdtWriteLog&#8221;</strong> in &#8220;lsasrv.dll&#8221; module of the &#8220;lsass.exe&#8221; process.</p>
<p>It searches for pre-defined signatures of the function &#8220;LsapAdtWriteLog&#8221; of known Windows versions &#8211; 4.0, 5.0, 5.1, 5.2 (NT4, Win2000, XP, WinSrv2003).</p>
<p>Then it selects a corresponding offset to replace the opcodes:</p>
<ul>
<li>&#8216;jz&#8217; to never taken &#8216;jo&#8217; in case of XP</li>
<li>jmp over inner logic to procedure epilog in case of Windows Server 2003 so LsapAdtWriteLog skips logging of audit records</li>
</ul>
<p>The module also patches &#8220;SepAdtLogAuditRecord&#8221; inside &#8220;ntoskrnl.exe&#8221; to &#8220;retn 4&#8221; instead of the first opcode of the function.</p>
<p>The disabled audit can be restored after a timeout or on-event by a dedicated thread.</p>
<p><strong>Expected IOCTL codes:</strong></p>
<ul>
<li>80000004 &#8211; setFilteringRules</li>
<li>80000008 &#8211; disablePacketsFiltering (PauseSniffer)</li>
<li>80000028 &#8211; do nothing (possible broken GetDriverName)</li>
<li>80000038 &#8211; disable_audit</li>
<li>8000003C &#8211; enable_audit</li>
</ul>
<h4 id="code-injector">Code Injector</h4>
<p>The code-builder within this module facilitates exploitation by providing up to four predefined execution templates, which seem to be suitable for generating several code patterns.</p>
<p>Below is a list of the execution templates we found:</p>
<ul>
<li>locate a DLL via PEB structure and resolve exports</li>
<li>call single function</li>
<li>call four functions</li>
<li>call six functions</li>
</ul>
<p>Using these as a base for the templates, the code-builder inserts parameters and proper offsets to call one of the following code patterns:</p>
<ul>
<li>Locate and call WinExec</li>
<li>Locate and call LoadLibraryW, GetProcAddress, call exported procedure, FreeLibrary</li>
<li>Locate and call LoadLibraryW, GetProcAddress, call GetModuleHandle, FreeLibrary</li>
<li>Locate and call OpenProcess, VirtualAllocEx, WriteProcessMemory, CreateRemoteThread, VirtualFreeEx, CloseHandle</li>
</ul>
<p>The code injection procedure allocates memory via ZwAllocateVirtualMemory in services.exe and copies implanted code. After that it uses KeInsertQueueApc to let the code run and waits 30 seconds for APC to complete.</p>
<p>When the module starts, it reads registry value <strong><em>[HKLM\System\CurrentControlSet\Services\%driver name%]</em></strong> <strong><em>Processes</em></strong>. This value may contain a list of process names that should be started by injected executable code but only after services.exe and winlogon.exe has been started. The injection of code into winlogon.exe and services.exe ensures that the newly started process will have SYSTEM user privileges. During the injection stage Windows Audit Logging is fully disabled to avoid leaving any suspicious records in Windows Logs.</p>
<h4 id="magic-packet-recognition">Magic Packet Recognition</h4>
<p>All incoming packets are first filtered by BPF-like rules. The filtering rules are located in <strong><em>[HKLM\System\CurrentControlSet\Services\%driver name%] Options</em></strong> registry value or passed via corresponding IOCTL. Packets that passed through the filter are added in the end of processing queue.</p>
<p>Packets from the queue must have valid checksum values. After checking that, the code XOR-decrypts additional data from the end of the packet. The decrypted end of the packet contains another control structure that defines which encryption algorithm is used to decipher packet body. Supported algorithms include RC5 and RSA. There is a 1024-bits RSA public key hardcoded inside the module body, while a 96-bits RC5 key is generated dynamically.</p>
<p>The backdoor command may arrive in a single packet or be split into pieces and come with several packets. There is a procedure for re-assembling pieces together: a multi-packet command is added to a special packet collector which puts all the pieces together before passing it further.</p>
<p><strong>Backdoor command</strong> is stored in the first byte of the decrypted request and can be one of the following values:</p>
<div style="margin-bottom: 15px;text-align: center">
<table border="0" width="100%">
<tbody>
<tr valign="center">
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000" width="20%"><strong>Command Byte</strong></td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000" width="20%"><strong>Short Name</strong></td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000" width="60%"><strong>Description</strong></td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">0</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">StatusCheck</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Reply with encrypted DriverName, packet collector keys, &#8220;Processes&#8221; and &#8220;Params&#8221; registry values, names of processes for code injection (defaults are &#8220;services.exe&#8221; and &#8220;winlogon.exe&#8221;), list of unprocessed commands from packet collector.</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">1</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Panic</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Disable packet filtering, securely delete driver file, clear related registry keys, set ClearPageFileAtShutdown flag, unbind adapters, delete devices and prepare for unloading. However, the driver cannot unload itself and it remains in the memory until reboot, which means it can be detected via DRIVER_OBJECT structure.</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">2</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">CodeInject</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Injects code implant received from packet body.</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">3</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">CallWinExec</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Disable Windows Audit and start new process via standard code injection in Winlogon.exe.</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">4</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">ResetCollector</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Drop all packets with specific key from packet collector.</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">5</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left" colspan="2">Unused or disabled</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">6</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">GenerateRC5Key</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Generates RC5 session key. 96-bits RC5 key is generated by taking a SHA1 hash of value from KeTickCount, XOR-encrypt with SHA1 hash of two PerformanceFrequency values, which is followed by nine more additional SHA1 hashing.</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">7</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">SetRegProcesses</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Sets new &#8220;Processes&#8221; registry value.</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">8</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">DeleteRegProcesses</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Deletes current &#8220;Processes&#8221; registry value.</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">9</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">SetRegParams</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Sets a universal &#8220;Params&#8221; registry value which is used for storing any information, i.e. could be a unique victim marker or exploitation stage number.</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">a</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left" colspan="2">Unused or disabled</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">b</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Ping</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Reply with classic ICMP Echo Response packet.</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">c</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">ChangeInjectTarget</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">Set new target injection processes (defaults are &#8220;Winlogon.exe&#8221; and &#8220;Services.exe&#8221;). Effective until reboot.</td>
</tr>
</tbody>
</table>
</div>
<p>Note: &#8220;mstcp32&#8221; is mentioned together with rootkit-like behavior in 2004 here: <a href="http://www.pcreview.co.uk/forums/mstcp32-t1445152.html">http://www.pcreview.co.uk/forums/mstcp32-t1445152.html</a></p>
<h3 id="network-sniffer-tdip-sys">Network Sniffer &#8211; tdip.sys</h3>
<div style="margin-bottom: 15px;text-align: center">
<table border="0" width="90%">
<tbody>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>MD5s</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;text-align: left">20506375665a6a62f7d9dd22d1cc9870<br />
60dab5bb319281747c5863b44c5ac60d</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Size</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">22448 &#8211; 28800 bytes</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Format</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">PE32 Native</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Compiled</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">2006.10.16 18:42:40 (GMT)<br />
2003.08.17 21:47:33 (GMT)</td>
</tr>
</tbody>
</table>
</div>
<p>Supports the following versions of Windows: NT4 using NDIS-4 and XP using NDIS-5. Doesn&#8217;t use Vista and later NDIS-6 features. However, later NDIS versions are backward-compatible, so the driver is still valid for current versions of Windows.</p>
<p><strong>Version Info:</strong></p>
<ul>
<li>FileDescription: IP Transport Driver</li>
<li>LegalCopyright: © Microsoft Corporation. All rights reserved.</li>
<li>FileVersion: 5.1.2600.2180</li>
<li>InternalName: tdip.sys</li>
</ul>
<p>This driver is a packet sniffer for incoming-only traffic on Ethernet and VPN (ndiswanip) interfaces or any used with ms_pschedmp as an alternative connection.</p>
<p>It implements a BPF (Berkeley packet filter) style packet-filtering system that is configured from the driver&#8217;s registry configuration values or from DeviceIoControl messages.</p>
<p>The captured network packets may be written to disk in libpcap format (magic 0xA1B2C3D4 version 2.4) and encrypted with one-byte XOR, key 0xE3.</p>
<p>The driver&#8217;s configuration is stored in the registry key:<br />
<strong>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\tdip]</strong></p>
<ul>
<li><strong>Options</strong> &#8211; packet filtering rules in BPF format</li>
<li><strong>Tag</strong> &#8211; selector of filtered packet types / Defaults in case of MediumWan to NDIS_PACKET_TYPE_BROADCAST|NDIS_PACKET_TYPE_MULTICAST|NDIS_PACKET_TYPE_DIRECTED;<br />
(or NDIS_PACKET_TYPE_BROADCAST|NDIS_PACKET_TYPE_DIRECTED in any other case)</li>
<li><strong>ImageFile</strong> &#8211; full path name to the resulting pcap file</li>
<li><strong>Duration</strong> &#8211; used as Length of the original packet in dump file. (default 0xffff)</li>
<li><strong>Backup</strong> &#8211; max size of the pcap file</li>
</ul>
<p>IOCTLs:</p>
<ul>
<li>0x80002004 getCurrentState</li>
<li>0x80002008 setFilteringRules</li>
<li>0x8000200C getFilteringRules</li>
<li>0x80002024 getDumpFileSize</li>
<li>0x80002010/0x80002014/0x80002018/0x8000201C pause/resume</li>
<li>0x80002020 getVersion &#8211; returns 2.4.0</li>
</ul>
<p>Driver has three logical parts, and uses an incomplete function pointer table as interface:</p>
<ol>
<li>Business logic: filtering rules, packet dumping, device ioctl, options</li>
<li>Ndis driver skeleton</li>
<li>Primitives lib: Strings, XORing, registry I/O</li>
</ol>
<p>The code is of very good quality. It looks more complicated than Winpcap 2.3 (released 28 mar 2002), but less so than Winpcap 3.0 (released by 10 apr 2003). Interestingly, the driver identifies itself as &#8220;version 2.4&#8221; in the pcap file despite there being no Winpcap version 2.4.</p>
<h3 id="key-clipboard-logger-driver-msrtvd-sys">Key/clipboard logger driver &#8211; msrtvd.sys</h3>
<div style="margin-bottom: 15px;text-align: center">
<table border="0" width="90%">
<tbody>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>MD5s</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;text-align: left">98dea1bce37bf7087360e1958400589b<br />
bb8f56874189d5dfe9294f0553a49b83<br />
f6bf3ed3bcd466e5fd1cbaf6ba658716</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Size</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">31 488 &#8211; 36 736 bytes</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Format</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">PE32 Native</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Compiled</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">2010.02.19 22:45:18 (GMT)<br />
2008.09.17 16:23:54 (GMT)</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Version Info</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">
<ul>
<li>FileDescription: MSRTvd interface driver</li>
<li>LegalCopyright: © Microsoft Corporation. All rights reserved.</li>
<li>InternalName: msrtvd.sys</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<p>This is a keylogger and clipboard monitoring tool.</p>
<p>On startup, the driver creates a device named &#8220;<strong>\Device\Gk0</strong>&#8221; and a symbolic link named &#8220;<strong>\DosDevices\Gk</strong>&#8220;.</p>
<p>Then it attaches to the <strong>csrss.exe</strong> process and disassembles <strong>user32.dll</strong> and <strong>ntdll.dll</strong> routines to obtain <strong>win32k.sys</strong> and <strong>ntoskrnl.exe</strong> SDT services indexes and pointers of needed Nt/Zw APIs.</p>
<p>Then, using a built-in disassembler, it obtains pointers to NtUserPeekMessage, NtUserGetMessage, NtUserGetClipboardData and using the disassembler again selects the parts of the code that will be then hooked by splicing.</p>
<p>The interceptor routines are copied from a special PE section named &#8220;.msda&#8221;. These routines are able to collect key press chains and clipboard text data, add information about current Time, ProcessName, ForegroundWindowText,and UserName related to this event.</p>
<p>A dedicated thread (&#8220;dumper&#8221;) gathers the collected data, compresses the results with LZO appends it every 30 minutes to a file &#8220;<strong>%<em>system-wide TEMP</em>%\tm154o.da</strong>&#8220;.</p>
<p>Most strings inside are encrypted by XOR with a pre-seeded random number generator.</p>
<p>IOCTLs:</p>
<ul>
<li>0x22002C -start dumper thread</li>
<li>0x220030 &#8211; stop dumper thread</li>
<li>0x220034 &#8211; check if the driver has new data to dump</li>
<li>0x220038 &#8211; set two external events signaled on dump data availability (it references a plugin possibility)</li>
<li>0x22003C &#8211; restart dumper thread</li>
<li>0x220040 &#8211; get size of available data</li>
</ul>
<h3 id="collector-plugin-for-volrec-msrstd-sys">Collector plugin for Volrec &#8211; msrstd.sys</h3>
<div style="margin-bottom: 15px;text-align: center">
<table border="0" width="90%">
<tbody>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>MD5s</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;text-align: left">69e7943f3d48233de4a39a924c59ed2c<br />
15d39578460e878dd89e8911180494ff</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Size</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">13 696 &#8211; 17 408 bytes</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Format</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">PE32 Native</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Compiled</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">2009.06.05 16:21:55 (GMT)<br />
2009.12.15 16:33:52 (GMT)</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Version Info</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">
<ul>
<li>FileDescription: msrstd driver</li>
<li>LegalCopyright: © Microsoft Corporation. All rights reserved.</li>
<li>InternalName: msrstd.sys</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<p>This driver is a plugin that collects events from the &#8220;volrec.sys&#8221; driver, and delivers them by sending DeviceIoControl messages. It collects events about file and disk volume operations.</p>
<p>On startup the driver obtains a pointer to &#8220;<strong>\Device\volrec</strong>&#8220;, then creates a control device &#8220;<strong>\Device\msrstd0</strong>&#8221; and a symbolic link to it named <strong>&#8220;\DosDevices\msrstd&#8221;</strong></p>
<p>All strings inside the driver are encrypted by XOR with a pre-seeded random number generator.</p>
<p>For file events the driver collects the filenames, and caches data about read and write operations. For disk volume events it queries disk properties and reads volume labels and disk serial numbers of removable drives (USB, FireWire drives).</p>
<p>IOCTLs:</p>
<p><strong>0x220004</strong> &#8211; turn on VolumeEvents collection<br />
<strong>0x220008</strong> &#8211; turn off VolumeEvents collection<br />
<strong>0x22000C</strong> &#8211; retrieve previously stored VolumeEvent (operationType, deviceTypeFlags, VolumeLabel, volumeSerialNumber, DosDriveLetter)<br />
<strong>0x220010</strong> &#8211; turn on FileEvents collection<br />
<strong>0x220014</strong> &#8211; turn off FileEvents collection<br />
<strong>0x220018</strong> &#8211; retrieve previously stored FileEvent (fileName, deviceTypeFlags, VolumeLabel, volumeSerialNumber, DosDriveLetter)<br />
<strong>0x22001C</strong> &#8211; connect to Volrec.sys (send ioctl 0x220004), enable plugin operation<br />
<strong>0x220020</strong> &#8211; disconnect from Volrec.sys (send ioctl 0x220008), disable plugin operation</p>
<h3 id="filesystem-filter-driver-volrec-sys-scsi2mgr-sys">Filesystem filter driver – volrec.sys, scsi2mgr.sys</h3>
<div style="margin-bottom: 15px;text-align: center">
<table border="0" width="90%">
<tbody>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>MD5s</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;text-align: left">a6662b8ebca61ca09ce89e1e4f43665d<br />
c17e16a54916d3838f63d208ebab9879</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Size</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">14 464-14 848 byres</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Format</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">PE32 Native</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Compiled</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">2009.06.05 16:21:57 (GMT)<br />
2009.12.15 16:33:57 (GMT)</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Version Info</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">
<ul>
<li>FileDescription: Volume recognizer driver</li>
<li>LegalCopyright: © Microsoft Corporation. All rights reserved.</li>
<li>InternalName: volrec.sys</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<p>This driver is a generic filesystem filter which feeds system events to user-mode plugins.</p>
<p>On startup the driver creates a control device named &#8220;\Device\volrec&#8221; and a symbolic link to it named &#8220;\DosDevices\volrec0&#8221;. It then attaches all available filesystem devices.  It is also, able to handle removable storage devices.</p>
<p>All strings inside the driver are encrypted by XOR with a pre-seeded random number generator.</p>
<p>IOCTLs:</p>
<ul>
<li>0x220004 &#8211; setup plugin interface</li>
<li>0x220008 &#8211; disable plugin calls</li>
</ul>
<p>The driver handles the following system events:</p>
<ul>
<li>file opened, created or closed</li>
<li>data is read or written to a file</li>
<li>new volume is mounted, unmounted</li>
<li>new USB or FireWire device attached</li>
</ul>
<h3 id="hdd-ssd-operation-helper-driver-win32m-sys">HDD/SSD operation helper driver &#8211; WIN32M.SYS</h3>
<div style="margin-bottom: 15px;text-align: center">
<table border="0" width="90%">
<tbody>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>MD5s</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;text-align: left">2b444ac5209a8b4140dd6b747a996653<br />
b3487fdd1efd2d1ea1550fef5b749037</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Size</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">19 456 &#8211; 26 631 bytes</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Format</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">PE32 Native, PE32+ Native</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Compiled</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">2001.08.23 17:03:19 (GMT)<br />
2013.05.14 15:58:36 (GMT)</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Description</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">This module will be the subject of a dedicated blogpost.</td>
</tr>
</tbody>
</table>
</div>
<h3 id="hdd-ssd-firmware-operation-nls_933w-dll">HDD/SSD firmware operation &#8211; nls_933w.dll</h3>
<div style="margin-bottom: 15px;text-align: center">
<table border="0" width="90%">
<tbody>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>MD5s</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;border-top: 1px solid #BCD9DD;text-align: left">11fb08b9126cdb4668b3f5135cf7a6c5<br />
9f3f6f46c67d3fad2479963361cf118b</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Size</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">212 480 &#8211; 310 272 bytes</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Format</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">PE32 DLL, PE32+ DLL</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Compiled</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">2010.06.15 16:23:37 (GMT)<br />
2013.05.14 16:12:35 (GMT)</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Version Info</strong> (64bit dll only)</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">
<ul>
<li>FileDescription: Windows Networking Library</li>
<li>LegalCopyright: Copyright (C) Microsoft Corp. 1981-2001</li>
<li>FileVersion: 80AA</li>
<li>InternalName: nls_933w.dll</li>
<li>OriginalFilename: nls_933w.dll</li>
<li>PrivateBuild: 4.0.1.0</li>
<li>ProductName: Microsoft(R) Windows (R) 2000 Operating System</li>
<li>ProductVersion: 5.0.2074.0</li>
<li>Full Version: 1.0.0.1</li>
</ul>
</td>
</tr>
<tr valign="center">
<td style="border-bottom: 1px solid #BCD9DD;width: 20%;text-align: left"><strong>Description</strong></td>
<td style="border-bottom: 1px solid #BCD9DD;text-align: left">This (80AA) plugin is a HDD firmware flashing tool which includes an API and the ability to read/write arbitrary information into hidden sectors on the disk.<br />
The plugin will be the subject of a separate blogpost.</td>
</tr>
</tbody>
</table>
</div>
<p><a href="https://kas.pr/APT_reporting_SL_text_button" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/11/07200515/640x60_apt_subscribe_banner.png" alt="Subscribe now For Kaspersky Lab's APT Intelligence Reports" width="640" height="60" class="aligncenter size-full wp-image-73094" /></a></p>
												</div>
											</div>
										</div>

										<div class="c-article__footer">
											<div class="c-article__categories">
													<ul class="c-list-tags">
				<li><a href="https://securelist.com/tag/apt/" class="c-link-tag"><span>APT</span></a></li>
					<li><a href="https://securelist.com/tag/cyber-espionage/" class="c-link-tag"><span>Cyber espionage</span></a></li>
					<li><a href="https://securelist.com/tag/equation/" class="c-link-tag"><span>Equation</span></a></li>
					<li><a href="https://securelist.com/tag/malware-descriptions/" class="c-link-tag"><span>Malware Descriptions</span></a></li>
					<li><a href="https://securelist.com/tag/malware-technologies/" class="c-link-tag"><span>Malware Technologies</span></a></li>
					<li><a href="https://securelist.com/tag/nation-state-sponsored-espionage/" class="c-link-tag"><span>Nation State Sponsored Espionage</span></a></li>
					<li><a href="https://securelist.com/tag/spyware/" class="c-link-tag"><span>Spyware</span></a></li>
					<li><a href="https://securelist.com/tag/stuxnet/" class="c-link-tag"><span>Stuxnet</span></a></li>
					<li><a href="https://securelist.com/tag/targeted-attacks/" class="c-link-tag"><span>Targeted attacks</span></a></li>
			</ul>
												</div>
											<div class="c-article__authors u-hidden@md">
												<p class="c-title--extra-small">Authors</p>
												<ul class="c-list-authors">
																<li>
			<a href="https://securelist.com/author/great/">
													<img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/avatar-default/avatar_default_3.png">
										<span>GReAT</span></a>
		</li>
														</ul>
											</div>
										</div>
				<div id="comments" class="entry-comments c-article__comments js-comments-wrapper">
	<p class="c-title--extra-small">Inside the EquationDrug Espionage Platform</p>		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="u-hidden"> <small></small></h3><form action="https://securelist.com/wp-comments-post.php" method="post" id="loginform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> <span class="required-field-message" aria-hidden="true">Required fields are marked <span class="required" aria-hidden="true">*</span></span></p><div class="comment-form-comment"><textarea id="comment" name="comment" style="width:100%" rows="8" aria-required="true" placeholder="Type your comment here"></textarea></div><!-- .comment-form-comment --><p class="comment-form-author"><label for="author">Name <span class="required" aria-hidden="true">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required="required" /></p>
<p class="comment-form-email"><label for="email">Email <span class="required" aria-hidden="true">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" required="required" /></p>
<script type="text/javascript">
                document.addEventListener("input", function (event) {
                    if (!event.target.closest("#comment")) return;

                    try{
                        grecaptcha.render("recaptcha-submit-btn-area", {
                            "sitekey" : "6LfQdrAaAAAAAEb_rTrwlbyc8z0Fa9CMjELY_2Ts",
                            "theme" : "standard"
                        });
                    }catch(error){/*possible duplicated instances*/}
                });
            </script>

            <script src="https://www.google.com/recaptcha/api.js?hl=en&render=explicit" async defer></script>        <div id="recaptcha-submit-btn-area">&nbsp;</div>
        <noscript>
            <style type="text/css">#form-submit-save {display:none;}</style>
            <input name="submit" type="submit" id="submit-alt" tabindex="6" value="Submit Comment"/>
        </noscript>
        <p class="form-submit"><input name="submit" type="submit" id="commentsubmit" class="submit" value="Comment" /><a rel="nofollow" id="cancel-comment-reply-link" href="/inside-the-equationdrug-espionage-platform/69203/#respond" style="display:none;">Cancel</a> <input type='hidden' name='comment_post_ID' value='69203' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="709d229188" /></p><!-- the following input field has been added by the Honeypot Comments plugin to thwart spambots -->
	<input type="hidden" id="DYkOcBVUGG5wg2YhsTdEMXwyP" name="EcVGsrYtKOY4Vs71X7Vdle9oz" /><p style="display: none !important;"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="148"/><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
				<ol class="comment-list js-comments">
			
		<li class="comment even thread-even depth-1  js-comment" id="comment-431098">
			<article>
				<figure class="comment-avatar">
					<img alt='' src='https://secure.gravatar.com/avatar/b8a0a16a68b345e91c5de905d60fa0e3?s=24&#038;d=https%3A%2F%2Fkasperskycontenthub.com%2Fwp-content%2Fthemes%2Fkaspersky-root%2Fassets%2Fimages%2Favatar_default.jpg&#038;r=g' srcset='https://secure.gravatar.com/avatar/b8a0a16a68b345e91c5de905d60fa0e3?s=48&#038;d=https%3A%2F%2Fkasperskycontenthub.com%2Fwp-content%2Fthemes%2Fkaspersky-root%2Fassets%2Fimages%2Favatar_default.jpg&#038;r=g 2x' class='avatar avatar-24 photo' height='24' width='24' loading='lazy'/>				</figure>

				<header class="comment-header">
					<div class="comment-author">
						<p class="comment-name"><span><a href="http://abeontech.com/" rel="external nofollow">Adam Davies</a></span> <span class="says"></span></p>
						<div class="comment-meta commentmetadata">

							Posted on							<time datetime="2015-03-12T11:52:04+00:00">March 12, 2015. 11:52 am</time>						</div><!-- .comment-meta -->

					</div><!-- .comment-author -->
				</header>

				<div class="comment-content">
										<p>If waeservices[dot]com is/was being used as a C&amp;C, shouldn&#8217;t they be chased up?  The domain is still live and on the same IP (213.198.79.49), just not responding to normal queries&#8230; Odd that. They seem to be liable to me. If they infected me, I&#8217;d chase it up by going after the C&amp;C server. They didn&#8217;t obfuscate that enough. Any why on Earth did they use domain names? An excellent article. Thanks for making this public. Think I need to test my machine now 🙂</p>
					<div class="comment-reply"><a rel='nofollow' class='comment-reply-link' href='https://securelist.com/inside-the-equationdrug-espionage-platform/69203/?replytocom=431098#respond' data-commentid="431098" data-postid="69203" data-belowelement="comment-431098" data-respondelement="respond" data-replyto="Reply to Adam Davies" aria-label='Reply to Adam Davies'>Reply</a></div><!-- .comment-reply -->				</div><!-- .comment-content -->

			</article>
	</li><!-- #comment-## -->

		<li class="comment odd alt thread-odd thread-alt depth-1  js-comment" id="comment-432153">
			<article>
				<figure class="comment-avatar">
					<img alt='' src='https://secure.gravatar.com/avatar/a4ed6cea28004d00252dbfcc14254678?s=24&#038;d=https%3A%2F%2Fkasperskycontenthub.com%2Fwp-content%2Fthemes%2Fkaspersky-root%2Fassets%2Fimages%2Favatar_default.jpg&#038;r=g' srcset='https://secure.gravatar.com/avatar/a4ed6cea28004d00252dbfcc14254678?s=48&#038;d=https%3A%2F%2Fkasperskycontenthub.com%2Fwp-content%2Fthemes%2Fkaspersky-root%2Fassets%2Fimages%2Favatar_default.jpg&#038;r=g 2x' class='avatar avatar-24 photo' height='24' width='24' loading='lazy'/>				</figure>

				<header class="comment-header">
					<div class="comment-author">
						<p class="comment-name"><span><a href="http://cryto.net/~joepie91" rel="external nofollow">Sven Slootweg</a></span> <span class="says"></span></p>
						<div class="comment-meta commentmetadata">

							Posted on							<time datetime="2015-03-12T21:36:11+00:00">March 12, 2015. 9:36 pm</time>						</div><!-- .comment-meta -->

					</div><!-- .comment-author -->
				</header>

				<div class="comment-content">
										<p>Also tweeted this at you, but not sure if it was seen &#8211; the string &#8220;Dissecorp&#8221; is simply &#8220;process ID&#8221; backwards.</p>
					<div class="comment-reply"><a rel='nofollow' class='comment-reply-link' href='https://securelist.com/inside-the-equationdrug-espionage-platform/69203/?replytocom=432153#respond' data-commentid="432153" data-postid="69203" data-belowelement="comment-432153" data-respondelement="respond" data-replyto="Reply to Sven Slootweg" aria-label='Reply to Sven Slootweg'>Reply</a></div><!-- .comment-reply -->				</div><!-- .comment-content -->

			</article>
	</li><!-- #comment-## -->

		<li class="comment even thread-even depth-1  js-comment" id="comment-481061">
			<article>
				<figure class="comment-avatar">
									</figure>

				<header class="comment-header">
					<div class="comment-author">
						<p class="comment-name"><span>Francesco Lago</span> <span class="says"></span></p>
						<div class="comment-meta commentmetadata">

							Posted on							<time datetime="2015-04-04T08:19:10+00:00">April 4, 2015. 8:19 am</time>						</div><!-- .comment-meta -->

					</div><!-- .comment-author -->
				</header>

				<div class="comment-content">
										<p>By reading the report, I came to the conclusion, that according to it, every hard drive from every kind of manufacturer could be infected.</p>
<p>Even those not listened , like for example for Verbatim, seems to be potentially infected, because, as far as I know, they have components of Seagate (or other manufacturers mentioned in the report), inside of their products.</p>
<p>Therefore, my question is: are there “reliable” hard drive manufacturers?</p>
					<div class="comment-reply"><a rel='nofollow' class='comment-reply-link' href='https://securelist.com/inside-the-equationdrug-espionage-platform/69203/?replytocom=481061#respond' data-commentid="481061" data-postid="69203" data-belowelement="comment-481061" data-respondelement="respond" data-replyto="Reply to Francesco Lago" aria-label='Reply to Francesco Lago'>Reply</a></div><!-- .comment-reply -->				</div><!-- .comment-content -->

			</article>
	</li><!-- #comment-## -->

		<li class="comment odd alt thread-odd thread-alt depth-1  js-comment" id="comment-522458">
			<article>
				<figure class="comment-avatar">
									</figure>

				<header class="comment-header">
					<div class="comment-author">
						<p class="comment-name"><span>leetunglong</span> <span class="says"></span></p>
						<div class="comment-meta commentmetadata">

							Posted on							<time datetime="2015-06-03T07:40:52+00:00">June 3, 2015. 7:40 am</time>						</div><!-- .comment-meta -->

					</div><!-- .comment-author -->
				</header>

				<div class="comment-content">
										<p>Great job! &#8220;This (80AA) plugin is a HDD firmware flashing tool which includes an API and the ability to read/write arbitrary information into hidden sectors on the disk.&#8221; However, I find the file version of nls_933w.dll(MD5:11fb08b9126cdb4668b3f5135cf7a6c5) is 0x80AB. Why?</p>
					<div class="comment-reply"><a rel='nofollow' class='comment-reply-link' href='https://securelist.com/inside-the-equationdrug-espionage-platform/69203/?replytocom=522458#respond' data-commentid="522458" data-postid="69203" data-belowelement="comment-522458" data-respondelement="respond" data-replyto="Reply to leetunglong" aria-label='Reply to leetunglong'>Reply</a></div><!-- .comment-reply -->				</div><!-- .comment-content -->

			</article>
	</li><!-- #comment-## -->

		<li class="comment even thread-even depth-1  js-comment" id="comment-2955407">
			<article>
				<figure class="comment-avatar">
					<img alt='' src='https://secure.gravatar.com/avatar/631d0c0fbec614514422c896086198d7?s=24&#038;d=https%3A%2F%2Fkasperskycontenthub.com%2Fwp-content%2Fthemes%2Fkaspersky-root%2Fassets%2Fimages%2Favatar_default.jpg&#038;r=g' srcset='https://secure.gravatar.com/avatar/631d0c0fbec614514422c896086198d7?s=48&#038;d=https%3A%2F%2Fkasperskycontenthub.com%2Fwp-content%2Fthemes%2Fkaspersky-root%2Fassets%2Fimages%2Favatar_default.jpg&#038;r=g 2x' class='avatar avatar-24 photo' height='24' width='24' loading='lazy'/>				</figure>

				<header class="comment-header">
					<div class="comment-author">
						<p class="comment-name"><span>Wizkid</span> <span class="says"></span></p>
						<div class="comment-meta commentmetadata">

							Posted on							<time datetime="2019-12-09T15:52:26+00:00">December 9, 2019. 3:52 pm</time>						</div><!-- .comment-meta -->

					</div><!-- .comment-author -->
				</header>

				<div class="comment-content">
										<p>This was awesome</p>
					<div class="comment-reply"><a rel='nofollow' class='comment-reply-link' href='https://securelist.com/inside-the-equationdrug-espionage-platform/69203/?replytocom=2955407#respond' data-commentid="2955407" data-postid="69203" data-belowelement="comment-2955407" data-respondelement="respond" data-replyto="Reply to Wizkid" aria-label='Reply to Wizkid'>Reply</a></div><!-- .comment-reply -->				</div><!-- .comment-content -->

			</article>
	</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
		
	
</div><!-- .entry-comments -->
											</div>
									<div class="o-col c-article__sidebar c-widgets--distributed u-hidden u-flex@md">
																				<div class="c-widget__wrapper">
											<div class="c-highlight js-accordion is-active u-hidden u-block@md js-sticky-widget">
												<div class="c-accordion-toggle js-accordion-toggle">
													<div class="c-highlight__header">
														<div class="c-highlight__icon">
															<div class="u-block--theme-light u-hidden--theme-dark">
																<img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/icon/icon-categories.svg" />
															</div>
															<div class="u-block--theme-dark u-hidden--theme-light">
																<img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/icon/icon-categories--invert.svg" />
															</div>
														</div>
														<div class="c-highlight__title">
															<p>Table of Contents</p>
														</div>
													</div>
												</div>
												<div class="js-accordion-container">
													<div class="c-highlight__body">
														<ul class="c-list-links"><li><a href="#introduction">Introduction</a></li><li><a href="#platform-architecture">Platform Architecture</a></li><li><a href="#platform-components">Platform Components</a></li><li><a href="#code-artifacts">Code Artifacts</a><ul><li><a href="#link-timestamp-analysis">Link Timestamp Analysis</a></ul></li><li><a href="#conclusions">Conclusions</a></li><li><a href="#technical-details">Technical Details</a><ul><li><a href="#kernel-mode-stage-0-windows-9x-mssvc32-vxd">Kernel mode stage 0 (Windows 9x) &#8211; mssvc32.vxd</a></li><li><a href="#kernel-mode-stage-0-and-rootkit-windows-2000-and-above-msndsrv-sys">Kernel mode stage 0 and rootkit (Windows 2000 and above) &#8211; msndsrv.sys</a></li><li><a href="#user-mode-loader-mscfg32-exe-svchost32-exe">User-mode loader &#8211; mscfg32.exe, svchost32.exe</a></li><li><a href="#platform-orchestrator-mscfg32-dll-svchost32-dll">Platform orchestrator &#8211; mscfg32.dll, svchost32.dll</a></ul></li><li><a href="#equationdrug-plugins">EquationDrug Plugins:</a></li><li><a href="#additional-components">Additional components</a><ul><li><a href="#unilay-dll">Unilay.DLL</a></li><li><a href="#network-sniffer-patcher-atmdkdrv-sys">Network-sniffer/patcher &#8211; atmdkdrv.sys</a><ul><li><a href="#sniffer-mode">Sniffer mode</a></li><li><a href="#patcher-mode">Patcher mode</a></ul></li></ul></li><li><a href="#backdoor-driven-by-network-sniffer-mstcp32-sys-fat32-sys">Backdoor driven by network sniffer &#8211; &#8220;mstcp32.sys&#8221;, &#8220;fat32.sys&#8221;</a><ul><li><a href="#code-patcher">Code Patcher</a></li><li><a href="#code-injector">Code Injector</a></li><li><a href="#magic-packet-recognition">Magic Packet Recognition</a></ul></li><li><a href="#network-sniffer-tdip-sys">Network Sniffer &#8211; tdip.sys</a></li><li><a href="#key-clipboard-logger-driver-msrtvd-sys">Key/clipboard logger driver &#8211; msrtvd.sys</a></li><li><a href="#collector-plugin-for-volrec-msrstd-sys">Collector plugin for Volrec &#8211; msrstd.sys</a></li><li><a href="#filesystem-filter-driver-volrec-sys-scsi2mgr-sys">Filesystem filter driver – volrec.sys, scsi2mgr.sys</a></li><li><a href="#hdd-ssd-operation-helper-driver-win32m-sys">HDD/SSD operation helper driver &#8211; WIN32M.SYS</a></li><li><a href="#hdd-ssd-firmware-operation-nls_933w-dll">HDD/SSD firmware operation &#8211; nls_933w.dll</a></ul>													</div>
												</div>
											</div>
										</div>
																					<div class="c-widget__wrapper">
		<div class="js-sticky-widget">
					<p><span class="c-tag c-tag--primary">GReAT webinars</span></p>
							<div class="o-row o-row--small-gutters">
				<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
														<article class="c-card c-card--hor-reverse@xs u-items-center">
						<div class="c-card__body">
							<header class="c-card__header">
															<time datetime="2021-05-13T13:00:00+00:00" class="c-card__event-date">13 May 2021, 1:00pm</time>
															<h3 class="c-card__title c-card__title--has-icon"><a href="https://securelist.com/webinars/great-ideas-balalaika-edition/" class="c-card__title-icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></a><a href="https://securelist.com/webinars/great-ideas-balalaika-edition/" class="c-card__link">GReAT Ideas. Balalaika Edition</a></h3>							</header>
							<footer class="c-card__footer">
								<div class="c-card__authors">
									<ul class="c-list-authors c-list-authors--comma">
													<li>
			<a href="https://securelist.com/author/borislarin/">
						<span>Boris Larin</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/denislegezo/">
						<span>Denis Legezo</span></a>
		</li>
											</ul>
								</div>
							</footer>
						</div>
					</article>
														<article class="c-card c-card--hor-reverse@xs u-items-center">
						<div class="c-card__body">
							<header class="c-card__header">
															<time datetime="2021-02-26T12:00:00+00:00" class="c-card__event-date">26 Feb 2021, 12:00pm</time>
															<h3 class="c-card__title c-card__title--has-icon"><a href="https://securelist.com/webinars/great-ideas-green-tea-edition/" class="c-card__title-icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></a><a href="https://securelist.com/webinars/great-ideas-green-tea-edition/" class="c-card__link">GReAT Ideas. Green Tea Edition</a></h3>							</header>
							<footer class="c-card__footer">
								<div class="c-card__authors">
									<ul class="c-list-authors c-list-authors--comma">
													<li>
			<a href="https://securelist.com/author/johnhultquist/">
						<span>John Hultquist</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/brian_bartholomew/">
						<span>Brian Bartholomew</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/suguru/">
						<span>Suguru Ishimaru</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/vitalykamluk/">
						<span>Vitaly Kamluk</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/seongsupark/">
						<span>Seongsu Park</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/yusukeniwa/">
						<span>Yusuke Niwa</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/motohikosato/">
						<span>Motohiko Sato</span></a>
		</li>
											</ul>
								</div>
							</footer>
						</div>
					</article>
														<article class="c-card c-card--hor-reverse@xs u-items-center">
						<div class="c-card__body">
							<header class="c-card__header">
															<time datetime="2020-06-17T13:00:00+00:00" class="c-card__event-date">17 Jun 2020, 1:00pm</time>
															<h3 class="c-card__title c-card__title--has-icon"><a href="https://securelist.com/webinars/great-ideas-powered-by-sas-malware-attribution-and-next-gen-iot-honeypots/" class="c-card__title-icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></a><a href="https://securelist.com/webinars/great-ideas-powered-by-sas-malware-attribution-and-next-gen-iot-honeypots/" class="c-card__link">GReAT Ideas. Powered by SAS: malware attribution and next-gen IoT honeypots</a></h3>							</header>
							<footer class="c-card__footer">
								<div class="c-card__authors">
									<ul class="c-list-authors c-list-authors--comma">
													<li>
			<a href="https://securelist.com/author/marcopreuss/">
						<span>Marco Preuss</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/denislegezo/">
						<span>Denis Legezo</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/costin/">
						<span>Costin Raiu</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/kurtb/">
						<span>Kurt Baumgartner</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/dandemeter/">
						<span>Dan Demeter</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/yaroslavshmelev/">
						<span>Yaroslav Shmelev</span></a>
		</li>
											</ul>
								</div>
							</footer>
						</div>
					</article>
														<article class="c-card c-card--hor-reverse@xs u-items-center">
						<div class="c-card__body">
							<header class="c-card__header">
															<time datetime="2020-08-26T14:00:00+00:00" class="c-card__event-date">26 Aug 2020, 2:00pm</time>
															<h3 class="c-card__title c-card__title--has-icon"><a href="https://securelist.com/webinars/great-ideas-powered-by-sas-threat-actors-advance-on-new-fronts/" class="c-card__title-icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></a><a href="https://securelist.com/webinars/great-ideas-powered-by-sas-threat-actors-advance-on-new-fronts/" class="c-card__link">GReAT Ideas. Powered by SAS: threat actors advance on new fronts</a></h3>							</header>
							<footer class="c-card__footer">
								<div class="c-card__authors">
									<ul class="c-list-authors c-list-authors--comma">
													<li>
			<a href="https://securelist.com/author/ivankwiatkowski/">
						<span>Ivan Kwiatkowski</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/maheryamout/">
						<span>Maher Yamout</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/noushinshabab/">
						<span>Noushin Shabab</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/pierredelcher/">
						<span>Pierre Delcher</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/felixaime/">
						<span>Félix Aime</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/giampaolodedola/">
						<span>Giampaolo Dedola</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/santiago/">
						<span>Santiago Pontiroli</span></a>
		</li>
											</ul>
								</div>
							</footer>
						</div>
					</article>
														<article class="c-card c-card--hor-reverse@xs u-items-center">
						<div class="c-card__body">
							<header class="c-card__header">
															<time datetime="2020-07-22T14:00:00+00:00" class="c-card__event-date">22 Jul 2020, 2:00pm</time>
															<h3 class="c-card__title c-card__title--has-icon"><a href="https://securelist.com/webinars/great-ideas-powered-by-sas-threat-hunting-and-new-techniques/" class="c-card__title-icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></a><a href="https://securelist.com/webinars/great-ideas-powered-by-sas-threat-hunting-and-new-techniques/" class="c-card__link">GReAT Ideas. Powered by SAS: threat hunting and new techniques</a></h3>							</header>
							<footer class="c-card__footer">
								<div class="c-card__authors">
									<ul class="c-list-authors c-list-authors--comma">
													<li>
			<a href="https://securelist.com/author/dimitrybestuzhev/">
						<span>Dmitry Bestuzhev</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/costin/">
						<span>Costin Raiu</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/pierredelcher/">
						<span>Pierre Delcher</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/brian_bartholomew/">
						<span>Brian Bartholomew</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/borislarin/">
						<span>Boris Larin</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/arieljungheit/">
						<span>Ariel Jungheit</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/fabioa/">
						<span>Fabio Assolini</span></a>
		</li>
											</ul>
								</div>
							</footer>
						</div>
					</article>
												</div>
			</div>
				</div>
	</div>
													<div class="c-widget__wrapper">
			<div class="js-sticky-widget">
				<p><span class="c-tag c-tag--primary">From the same authors</span></p>
				<div class="o-row o-row--small-gutters">
							<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a href="https://securelist.com/webinar-on-cyberattacks-in-ukraine-summary-and-qa/106075/" class="c-card__figure" style="background-image: url(https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2021/01/18163828/abstract-headphone_Zoom-800x450.jpg);">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2021/01/18163828/abstract-headphone_Zoom-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" loading="lazy" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a href="https://securelist.com/webinar-on-cyberattacks-in-ukraine-summary-and-qa/106075/" class="c-card__link">Webinar on cyberattacks in Ukraine &#8211; summary and Q&amp;A</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a href="https://securelist.com/elections-goransom-and-hermeticwiper-attack/105960/" class="c-card__figure" style="background-image: url(https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2020/09/09131757/abstract_random_red_code-800x450.jpg);">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2020/09/09131757/abstract_random_red_code-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" loading="lazy" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a href="https://securelist.com/elections-goransom-and-hermeticwiper-attack/105960/" class="c-card__link">Elections GoRansom – a smoke screen for the HermeticWiper attack</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a href="https://securelist.com/apt-annual-review-2021/105127/" class="c-card__figure" style="background-image: url(https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2021/11/29150529/ksb-2021_APT-review-year-800x450.jpg);">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2021/11/29150529/ksb-2021_APT-review-year-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" loading="lazy" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a href="https://securelist.com/apt-annual-review-2021/105127/" class="c-card__link">APT annual review 2021</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a href="https://securelist.com/scarcruft-surveilling-north-korean-defectors-and-human-rights-activists/105074/" class="c-card__figure" style="background-image: url(https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/27114415/abstract-Fingerprint-Scanning-Technology-800x450.jpeg);">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/27114415/abstract-Fingerprint-Scanning-Technology-800x450.jpeg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" loading="lazy" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a href="https://securelist.com/scarcruft-surveilling-north-korean-defectors-and-human-rights-activists/105074/" class="c-card__link">ScarCruft surveilling North Korean defectors and human rights activists</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a href="https://securelist.com/advanced-threat-predictions-for-2022/104870/" class="c-card__figure" style="background-image: url(https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2021/11/17085725/apt_soc_ksb-2021-800x450.jpg);">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2021/11/17085725/apt_soc_ksb-2021-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" loading="lazy" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a href="https://securelist.com/advanced-threat-predictions-for-2022/104870/" class="c-card__link">Advanced threat predictions for 2022</a></h3>		</header>
					</div>
</article>
		</div>
							</div>
			</div>
		</div>
					<div class="c-widget__wrapper">
				<div class="c-widget-subscribe js-sticky-widget">
					<div class="c-block__header">
						<h5 class="c-title--small">Subscribe to our weekly e-mails</h5>
						<p>The hottest research right in your inbox</p>
					</div>
					<div class="c-form--float-labels js-float-labels">
						<script type="text/javascript"></script>
                <div class='gf_browser_gecko gform_wrapper gform_wrapper_original_id_11 subscribe-mc_wrapper gform_legacy_markup_wrapper' id='gform_wrapper_424316096' ><div id='gf_424316096' class='gform_anchor' tabindex='-1'></div><form method='post' enctype='multipart/form-data' target='gform_ajax_frame_424316096' id='gform_424316096' class='subscribe-mc gform_legacy_markup' action='/inside-the-equationdrug-espionage-platform/69203/#gf_424316096' >
                        <div class="gform-content-wrapper"><div class='gform_body gform-body'><ul id='gform_fields_424316096' class='gform_fields top_label form_sublabel_below description_below'><li id="field_11_1" class="gfield gfield_contains_required field_sublabel_below field_description_below gfield_visibility_visible" ><label class='gfield_label screen-reader-text' for='input_424316096_1' >Email<span class="gfield_required"><span class="gfield_required gfield_required_asterisk">*</span></span></label><div class='ginput_container ginput_container_email'>
                            <input name='input_1' id='input_424316096_1' type='text' value='' class='medium'   placeholder='Email' aria-required="true" aria-invalid="false"  />
                        </div></li><li id="field_11_3" class="gfield js-kaspersky-gform-recaptcha-placeholder gform_hidden field_sublabel_below field_description_below gfield_visibility_hidden" ><div class='ginput_container ginput_container_text'><input name='input_3' id='input_424316096_3' type='hidden' class='gform_hidden'  aria-invalid="false" value='' /></div></li><li id="field_11_2" class="gfield input-without-label label-gdpr gfield_contains_required field_sublabel_below field_description_below gfield_visibility_visible" ><label class='gfield_label screen-reader-text gfield_label_before_complex'  ><span class="gfield_required"><span class="gfield_required gfield_required_asterisk">*</span></span></label><div class='ginput_container ginput_container_checkbox'><ul class='gfield_checkbox' id='input_424316096_2'><li class='gchoice gchoice_11_2_1'>
								<input class='gfield-choice-input' name='input_2.1' type='checkbox'  value='I agree'  id='choice_424316096_11_2_1'   />
								<label for='choice_424316096_11_2_1' id='label_424316096_11_2_1'>I agree to provide my email address to “AO Kaspersky Lab” to receive information about new posts on the site. I understand that I can withdraw this consent at any time via e-mail by clicking the “unsubscribe” link that I find at the bottom of any e-mail sent to me for the purposes mentioned above.</label>
							</li></ul></div></li></ul></div>
        <div class='gform_footer top_label'> 	<button type="submit" class="gform_button button" id='gform_submit_button_424316096' value="Sign up">
		<svg class="o-icon o-svg-icon o-svg-large"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-envelope"></use></svg>		<span>Subscribe</span>
	</button>

	 <input type='hidden' name='gform_ajax' value='form_id=11&amp;title=&amp;description=&amp;tabindex=0' />
            <input type='hidden' class='gform_hidden' name='is_submit_11' value='1' />
            <input type='hidden' class='gform_hidden' name='gform_submit' value='11' />
            
            <input type='hidden' class='gform_hidden' name='gform_unique_id' value='' />
            <input type='hidden' class='gform_hidden' name='state_11' value='WyJbXSIsImIwODQwZTA2ZGQ0NzYwODcyOTBkZjNmZDM1NDk2Y2ZkIl0=' />
            <input type='hidden' class='gform_hidden' name='gform_target_page_number_11' id='gform_target_page_number_424316096_11' value='0' />
            <input type='hidden' class='gform_hidden' name='gform_source_page_number_11' id='gform_source_page_number_424316096_11' value='1' />
            <input type='hidden' name='gform_random_id' value='424316096' /><input type='hidden' name='gform_field_values' value='securelist_2020_form_location=sidebar' />
            
        </div>
                        </div><p style="display: none !important;"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_2" name="ak_js" value="230"/><script>document.getElementById( "ak_js_2" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>
                        </div>
                <iframe style='display:none;width:0px;height:0px;' src='about:blank' name='gform_ajax_frame_424316096' id='gform_ajax_frame_424316096' title='This iframe contains the logic required to handle Ajax powered Gravity Forms.'></iframe>
                <script type="text/javascript">
gform.initializeOnLoaded( function() {gformInitSpinner( 424316096, 'https://securelist.com/wp-content/themes/securelist2020/assets/images/content/ajax-spinner-red.svg' );jQuery('#gform_ajax_frame_424316096').on('load',function(){var contents = jQuery(this).contents().find('*').html();var is_postback = contents.indexOf('GF_AJAX_POSTBACK') >= 0;if(!is_postback){return;}var form_content = jQuery(this).contents().find('#gform_wrapper_424316096');var is_confirmation = jQuery(this).contents().find('#gform_confirmation_wrapper_424316096').length > 0;var is_redirect = contents.indexOf('gformRedirect(){') >= 0;var is_form = form_content.length > 0 && ! is_redirect && ! is_confirmation;var mt = parseInt(jQuery('html').css('margin-top'), 10) + parseInt(jQuery('body').css('margin-top'), 10) + 100;if(is_form){jQuery('#gform_wrapper_424316096').html(form_content.html());if(form_content.hasClass('gform_validation_error')){jQuery('#gform_wrapper_424316096').addClass('gform_validation_error');} else {jQuery('#gform_wrapper_424316096').removeClass('gform_validation_error');}setTimeout( function() { /* delay the scroll by 50 milliseconds to fix a bug in chrome */ jQuery(document).scrollTop(jQuery('#gform_wrapper_424316096').offset().top - mt); }, 50 );if(window['gformInitDatepicker']) {gformInitDatepicker();}if(window['gformInitPriceFields']) {gformInitPriceFields();}var current_page = jQuery('#gform_source_page_number_424316096_11').val();gformInitSpinner( 424316096, 'https://securelist.com/wp-content/themes/securelist2020/assets/images/content/ajax-spinner-red.svg' );jQuery(document).trigger('gform_page_loaded', [424316096, current_page]);window['gf_submitting_424316096'] = false;}else if(!is_redirect){var confirmation_content = jQuery(this).contents().find('.GF_AJAX_POSTBACK').html();if(!confirmation_content){confirmation_content = contents;}setTimeout(function(){jQuery('#gform_wrapper_424316096').replaceWith(confirmation_content);jQuery(document).scrollTop(jQuery('#gf_424316096').offset().top - mt);jQuery(document).trigger('gform_confirmation_loaded', [424316096]);window['gf_submitting_424316096'] = false;wp.a11y.speak(jQuery('#gform_confirmation_message_424316096').text());}, 50);}else{jQuery('#gform_424316096').append(contents);if(window['gformRedirect']) {gformRedirect();}}jQuery(document).trigger('gform_post_render', [424316096, current_page]);} );} );
</script>
					</div>
				</div>
			</div>
					<div class="c-widget__wrapper">
			<div class="js-sticky-widget">
				<p><span class="c-tag c-tag--primary">In the same category</span></p>
				<div class="o-row o-row--small-gutters">
							<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a href="https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468/" class="c-card__figure" style="background-image: url(https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/01/19145346/abstract_moonbounce-800x450.jpg);">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/01/19145346/abstract_moonbounce-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" loading="lazy" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a href="https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468/" class="c-card__link">MoonBounce: the dark side of UEFI firmware</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a href="https://securelist.com/the-bluenoroff-cryptocurrency-hunt-is-still-on/105488/" class="c-card__figure" style="background-image: url(https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/01/12134602/abstract_fintech-800x450.jpg);">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/01/12134602/abstract_fintech-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" loading="lazy" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a href="https://securelist.com/the-bluenoroff-cryptocurrency-hunt-is-still-on/105488/" class="c-card__link">The BlueNoroff cryptocurrency hunt is still on</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a href="https://securelist.com/scarcruft-surveilling-north-korean-defectors-and-human-rights-activists/105074/" class="c-card__figure" style="background-image: url(https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/27114415/abstract-Fingerprint-Scanning-Technology-800x450.jpeg);">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/27114415/abstract-Fingerprint-Scanning-Technology-800x450.jpeg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" loading="lazy" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a href="https://securelist.com/scarcruft-surveilling-north-korean-defectors-and-human-rights-activists/105074/" class="c-card__link">ScarCruft surveilling North Korean defectors and human rights activists</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a href="https://securelist.com/wirtes-campaign-in-the-middle-east-living-off-the-land-since-at-least-2019/105044/" class="c-card__figure" style="background-image: url(https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2021/11/26150139/sl-abstract-excel-label-800x450.jpg);">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2021/11/26150139/sl-abstract-excel-label-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" loading="lazy" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a href="https://securelist.com/wirtes-campaign-in-the-middle-east-living-off-the-land-since-at-least-2019/105044/" class="c-card__link">WIRTE&#8217;s campaign in the Middle East &#8216;living off the land&#8217; since at least 2019</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a href="https://securelist.com/apt-trends-report-q3-2021/104708/" class="c-card__figure" style="background-image: url(https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2019/04/09094920/abstract-digital-blue-800x450.jpg);">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2019/04/09094920/abstract-digital-blue-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" loading="lazy" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a href="https://securelist.com/apt-trends-report-q3-2021/104708/" class="c-card__link">APT trends report Q3 2021</a></h3>		</header>
					</div>
</article>
		</div>
							</div>
			</div>
		</div>
		<li id="kaspersky_related_posts_widget-2" class="widget widget_kaspersky_related_posts_widget"><h3 class="widget-title">In the same category</h3><ul class="related-recent">									<li><a href="https://securelist.com/transparent-tribe-part-2/98233/">
						<img width="330" height="200" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/11/11130332/securelist_abs_5-330x200.jpg" class="attachment-securelist-medium-promo size-securelist-medium-promo wp-post-image" alt="" loading="lazy" />					</a><h4><a href="https://securelist.com/transparent-tribe-part-2/98233/" title="Transparent Tribe: Evolution analysis, part 2">Transparent Tribe: Evolution analysis, part 2</a></h4></li>
																<li><a href="https://securelist.com/deathstalker-mercenary-triumvirate/98177/">
						<img width="330" height="200" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/11/11130214/securelist_abs_1-330x200.jpg" class="attachment-securelist-medium-promo size-securelist-medium-promo wp-post-image" alt="" loading="lazy" />					</a><h4><a href="https://securelist.com/deathstalker-mercenary-triumvirate/98177/" title="Lifting the veil on DeathStalker, a mercenary triumvirate">Lifting the veil on DeathStalker, a mercenary triumvirate</a></h4></li>
																<li><a href="https://securelist.com/transparent-tribe-part-1/98127/">
						<img width="330" height="200" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/11/11130332/securelist_abs_5-330x200.jpg" class="attachment-securelist-medium-promo size-securelist-medium-promo wp-post-image" alt="" loading="lazy" />					</a><h4><a href="https://securelist.com/transparent-tribe-part-1/98127/" title="Transparent Tribe: Evolution analysis, part 1">Transparent Tribe: Evolution analysis, part 1</a></h4></li>
																<li><a href="https://securelist.com/cactuspete-apt-groups-updated-bisonal-backdoor/97962/">
						<img width="330" height="200" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2019/03/11100003/abstract-polygon-330x200.jpg" class="attachment-securelist-medium-promo size-securelist-medium-promo wp-post-image" alt="" loading="lazy" />					</a><h4><a href="https://securelist.com/cactuspete-apt-groups-updated-bisonal-backdoor/97962/" title="CactusPete APT group&#8217;s updated Bisonal backdoor">CactusPete APT group&#8217;s updated Bisonal backdoor</a></h4></li>
																<li><a href="https://securelist.com/apt-trends-report-q2-2020/97937/">
						<img width="330" height="200" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/08/21082144/abstract-digital-yellow-330x200.jpeg" class="attachment-securelist-medium-promo size-securelist-medium-promo wp-post-image" alt="" loading="lazy" />					</a><h4><a href="https://securelist.com/apt-trends-report-q2-2020/97937/" title="APT trends report Q2 2020">APT trends report Q2 2020</a></h4></li>
							</ul></li>
<li id="text-22" class="widget widget_text">			<div class="textwidget"><p><a href="https://xtraining.kaspersky.com/courses/hunt-apts-with-yara-like-a-great-ninja?redef=1&#038;THRU&#038;reseller=gl_xc-overview_acq_ona_smm__onl_b2b_securelist_banner_______&#038;utm_source=securelist&#038;utm_medium=blog&#038;utm_campaign=gl_course-overview_ay0073&#038;utm_content=banner&#038;utm_term=gl_securelist_organic_elqwbvemf73woii" target="_blank" rel="noopener"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2020/09/14132657/Hunt-APT_YARA_Early_live_v3.jpg" width="370" /></a></p>
</div>
		</li>
									</div>
								</div>

							</div>
						</div>

						<div class="c-article__progress rpi-progress-bar">
							<div class="c-article__progress-bar__position rpi-progress-bar__position"></div>
							<div class="rpi-progress-bar__percentage"></div>
						</div>
					</article>
				</div>
			</section>
			<section class="c-block c-block--spacing-t-small c-block--spacing-b-small@md c-block--divider-internal">
	<div class="o-container-fluid">
		<h5 class="c-block__title">Latest Posts</h5>
		<div class="o-row o-row--small-gutters@sm c-card__row c-card__row--fixed-width-down@sm js-slider-posts-mobile">
					<div class="o-col-6@sm o-col-3@md">
			<article class="c-card c-card--standard@xs">
		<a href="https://securelist.com/elections-goransom-and-hermeticwiper-attack/105960/" class="c-card__figure" style="background-image: url(https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2020/09/09131757/abstract_random_red_code-800x450.jpg);">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2020/09/09131757/abstract_random_red_code-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" loading="lazy" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline u-hidden u-block@md">
				<a href="https://securelist.com/category/incidents/" class="c-tag c-tag--primary">Incidents</a>
			</p>
		
		
			<h3 class="c-card__title"><a href="https://securelist.com/elections-goransom-and-hermeticwiper-attack/105960/" class="c-card__link">Elections GoRansom – a smoke screen for the HermeticWiper attack</a></h3>		</header>
						<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a href="https://securelist.com/author/great/">
						<span>GReAT</span></a>
		</li>
						</ul>
			</div>
		</footer>
			</div>
</article>
		</div>
					<div class="o-col-6@sm o-col-3@md">
			<article class="c-card c-card--standard@xs">
		<a href="https://securelist.com/financial-cyberthreats-in-2021/105898/" class="c-card__figure" style="background-image: url(https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/02/15163118/abstract_money_graphs-800x450.jpg);">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/02/15163118/abstract_money_graphs-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" loading="lazy" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline u-hidden u-block@md">
				<a href="https://securelist.com/category/publications/" class="c-tag c-tag--primary">Publications</a>
			</p>
		
		
			<h3 class="c-card__title"><a href="https://securelist.com/financial-cyberthreats-in-2021/105898/" class="c-card__link">Financial cyberthreats in 2021</a></h3>		</header>
						<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a href="https://securelist.com/author/kaspersky/">
						<span>Kaspersky</span></a>
		</li>
						</ul>
			</div>
		</footer>
			</div>
</article>
		</div>
					<div class="o-col-6@sm o-col-3@md">
			<article class="c-card c-card--standard@xs">
		<a href="https://securelist.com/mobile-malware-evolution-2021/105876/" class="c-card__figure" style="background-image: url(https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/02/21124415/abstract_mobile-report-2021-800x450.jpg);">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/02/21124415/abstract_mobile-report-2021-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" loading="lazy" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline u-hidden u-block@md">
				<a href="https://securelist.com/category/malware-reports/" class="c-tag c-tag--primary">Malware reports</a>
			</p>
		
		
			<h3 class="c-card__title"><a href="https://securelist.com/mobile-malware-evolution-2021/105876/" class="c-card__link">Mobile malware evolution 2021</a></h3>		</header>
						<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a href="https://securelist.com/author/tatyanashishkova/">
						<span>Tatyana Shishkova</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/antonkivva/">
						<span>Anton Kivva</span></a>
		</li>
						</ul>
			</div>
		</footer>
			</div>
</article>
		</div>
					<div class="o-col-6@sm o-col-3@md">
			<article class="c-card c-card--standard@xs">
		<a href="https://securelist.com/ddos-attacks-in-q4-2021/105784/" class="c-card__figure" style="background-image: url(https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/02/09185713/sl-abstract-data-flow-ddos-800x450.jpg);">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/02/09185713/sl-abstract-data-flow-ddos-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" loading="lazy" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline u-hidden u-block@md">
				<a href="https://securelist.com/category/ddos-reports/" class="c-tag c-tag--primary">DDoS reports</a>
			</p>
		
		
			<h3 class="c-card__title"><a href="https://securelist.com/ddos-attacks-in-q4-2021/105784/" class="c-card__link">DDoS attacks in Q4 2021</a></h3>		</header>
						<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a href="https://securelist.com/author/alexandergutnikov/">
						<span>Alexander Gutnikov</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/olegkupreev/">
						<span>Oleg Kupreev</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/yaroslavshmelev/">
						<span>Yaroslav Shmelev</span></a>
		</li>
						</ul>
			</div>
		</footer>
			</div>
</article>
		</div>
					</div>
	</div>
</section>
	<section class="c-block c-block--spacing-t-small c-block--spacing-b-small@md c-block--divider-internal">	<div class="o-container-fluid">
			<h5 class="c-block__title">Latest Webinars</h5>
			<div class="o-row o-row--small-gutters@sm c-card__row c-card__row--fixed-width-down@sm js-slider-posts-mobile">
														<div class="o-col-6@sm o-col-3@md">
						<article class="c-card c-card--standard@xs">
	<a href="https://securelist.com/webinars/ukraine-cyberattack-analysis/" class="c-card__figure" style="background-image: url(https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2020/10/05091531/abstract_digital_mosaic-800x450.jpg);">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2020/10/05091531/abstract_digital_mosaic-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" loading="lazy" />	</a>
	<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline">
				<a href="https://securelist.com/webinar-category/cyberthreat-talks/" class="c-tag c-tag--primary c-tag--has-icon"><span class="c-tag__icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></span>Cyberthreat talks</a>
			</p>
							<time datetime="2022-03-10T18:00:00+00:00" class="c-card__event-date">10 Mar 2022, 6:00pm</time>
					<h3 class="c-card__title"><a href="https://securelist.com/webinars/ukraine-cyberattack-analysis/" class="c-card__link">A look at current cyberattacks in Ukraine</a></h3>		</header>
				<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a href="https://securelist.com/author/costin/">
						<span>Costin Raiu</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/marcopreuss/">
						<span>Marco Preuss</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/kurtb/">
						<span>Kurt Baumgartner</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/dandemeter/">
						<span>Dan Demeter</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/ivankwiatkowski/">
						<span>Ivan Kwiatkowski</span></a>
		</li>
						</ul>
			</div>
		</footer>
	</div>
</article>
					</div>
													<div class="o-col-6@sm o-col-3@md">
						<article class="c-card c-card--standard@xs">
	<a href="https://securelist.com/webinars/insights-the-log4shell-attack/" class="c-card__figure" style="background-image: url(https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2019/10/02094116/abstract-bomb-scull-sad-cross-scull-800x450.jpg);">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2019/10/02094116/abstract-bomb-scull-sad-cross-scull-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" loading="lazy" />	</a>
	<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline">
				<a href="https://securelist.com/webinar-category/cyberthreat-talks/" class="c-tag c-tag--primary c-tag--has-icon"><span class="c-tag__icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></span>Cyberthreat talks</a>
			</p>
							<time datetime="2022-01-13T10:00:00+00:00" class="c-card__event-date">13 Jan 2022, 10:00am</time>
					<h3 class="c-card__title"><a href="https://securelist.com/webinars/insights-the-log4shell-attack/" class="c-card__link">CCB Q4 2021 event: Insights about the details of the Log4Shell attack</a></h3>		</header>
				<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a href="https://securelist.com/author/costin/">
						<span>Costin Raiu</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/markusneis/">
						<span>Markus Neis</span></a>
		</li>
						</ul>
			</div>
		</footer>
	</div>
</article>
					</div>
													<div class="o-col-6@sm o-col-3@md">
						<article class="c-card c-card--standard@xs">
	<a href="https://securelist.com/webinars/the-bluenoroff-cryptocurrency-hunt/" class="c-card__figure" style="background-image: url(https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/02/03090340/abstract_crypto_bitcoin_dark-800x450.jpg);">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/02/03090340/abstract_crypto_bitcoin_dark-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" loading="lazy" />	</a>
	<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline">
				<a href="https://securelist.com/webinar-category/cyberthreat-talks/" class="c-tag c-tag--primary c-tag--has-icon"><span class="c-tag__icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></span>Cyberthreat talks</a>
			</p>
							<time datetime="2022-01-13T10:00:00+00:00" class="c-card__event-date">13 Jan 2022, 10:00am</time>
					<h3 class="c-card__title"><a href="https://securelist.com/webinars/the-bluenoroff-cryptocurrency-hunt/" class="c-card__link">CCB Q4 2021 event: Elaborating on the BlueNoroff&#8217;s cryptocurrency hunt</a></h3>		</header>
				<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a href="https://securelist.com/author/seongsupark/">
						<span>Seongsu Park</span></a>
		</li>
						</ul>
			</div>
		</footer>
	</div>
</article>
					</div>
													<div class="o-col-6@sm o-col-3@md">
						<article class="c-card c-card--standard@xs">
	<a href="https://securelist.com/webinars/atm-pos-threat-landscape/" class="c-card__figure" style="background-image: url(https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2011/06/02110842/abstract_money-800x450.jpg);">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2011/06/02110842/abstract_money-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" loading="lazy" />	</a>
	<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline">
				<a href="https://securelist.com/webinar-category/cyberthreat-talks/" class="c-tag c-tag--primary c-tag--has-icon"><span class="c-tag__icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></span>Cyberthreat talks</a>
			</p>
							<time datetime="2022-01-18T17:00:00+00:00" class="c-card__event-date">18 Jan 2022, 5:00pm</time>
					<h3 class="c-card__title"><a href="https://securelist.com/webinars/atm-pos-threat-landscape/" class="c-card__link">ATM &#038; PoS threat landscape: evolution and COVID-19 lockdown impact</a></h3>		</header>
				<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a href="https://securelist.com/author/dimitrybestuzhev/">
						<span>Dmitry Bestuzhev</span></a>
		</li>
			<li>
			<a href="https://securelist.com/author/oleggorobets/">
						<span>Oleg Gorobets</span></a>
		</li>
						</ul>
			</div>
		</footer>
	</div>
</article>
					</div>
									</div>
		</div>
	</section>
		<section class="c-block c-block--spacing-t-small c-block--spacing-b-small@md c-block--divider-internal">
		<div class="o-container-fluid">
			<h5 class="c-block__title">Reports</h5>
			<div class="o-row o-row--small-gutters">
				<div class="o-col-8@sm">
					<div class="o-row o-row--small-gutters">
																							<div class="o-col-6@md">
												<article class="c-card c-card--standard@xs">
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a href="https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468/" class="c-card__link">MoonBounce: the dark side of UEFI firmware</a></h3>		</header>
				<div class="c-card__desc">
			<p>At the end of 2021, we inspected UEFI firmware that was tampered with to embed a malicious code we dub MoonBounce. In this report we describe how the MoonBounce implant works and how it is connected to APT41.</p>
		</div>
					</div>
</article>
						</div>
																							<div class="o-col-6@md c-card__dividers c-card__dividers--hide@md">
												<article class="c-card c-card--standard@xs">
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a href="https://securelist.com/the-bluenoroff-cryptocurrency-hunt-is-still-on/105488/" class="c-card__link">The BlueNoroff cryptocurrency hunt is still on</a></h3>		</header>
				<div class="c-card__desc u-hidden u-block@md">
			<p>It appears that BlueNoroff shifted focus from hitting banks and SWIFT-connected servers to solely cryptocurrency businesses as the main source of the group’s illegal income. </p>
		</div>
					</div>
</article>
						</div>
																							<div class="o-col-6@md c-card__dividers c-card__dividers--hide@md">
												<article class="c-card c-card--standard@xs">
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a href="https://securelist.com/scarcruft-surveilling-north-korean-defectors-and-human-rights-activists/105074/" class="c-card__link">ScarCruft surveilling North Korean defectors and human rights activists</a></h3>		</header>
				<div class="c-card__desc u-hidden u-block@md">
			<p>The ScarCruft group (also known as APT37 or Temp.Reaper) is a nation-state sponsored APT actor. Recently, we had an opportunity to perform a deeper investigation on a host compromised by this group. </p>
		</div>
					</div>
</article>
						</div>
																							<div class="o-col-6@md c-card__dividers c-card__dividers--hide@md">
												<article class="c-card c-card--standard@xs">
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a href="https://securelist.com/wirtes-campaign-in-the-middle-east-living-off-the-land-since-at-least-2019/105044/" class="c-card__link">WIRTE&#8217;s campaign in the Middle East &#8216;living off the land&#8217; since at least 2019</a></h3>		</header>
				<div class="c-card__desc u-hidden u-block@md">
			<p>In this report we provide details on a malicious VBS implant distributed via MS Excel droppers and a fake &#8220;Kaspersky Update Agent&#8221; which we attribute to WIRTE APT who may be linked to Gaza Cybergang.</p>
		</div>
					</div>
</article>
						</div>
															</div>
				</div>
								<div class="o-col-4@sm u-hidden u-block@sm">
					<div class="c-image c-image--overflow-down@sm">
						<a href="https://xtraining.kaspersky.com/?reseller=gl_xtr-general_acq_ona_smm__onl_b2b_securelist_ban_sm-team______&#038;utm_source=securelist&#038;utm_medium=blog&#038;utm_campaign=gl_xtr-general_az0075&#038;utm_content=banner&#038;utm_term=gl_securelist_organic_adbydaqili75vov"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/01/20172839/xTraining_General_Banner_370x500_eng-370x500.jpg" /></a>					</div>
				</div>
							</div>
		</div>
	</section>
		<section class="c-block c-block--spacing-t-small c-block--spacing-b-small@md">
		<div class="o-container-fluid">
			<div class="o-row c-block__row u-flex-nowrap@md">
				<div class="o-col">
					<div class="c-block__header">
						<h5 class="c-block__title">Subscribe to our weekly e-mails</h5>
						<p>The hottest research right in your inbox</p>
					</div>
				</div>
				<div class="o-col u-flex-shrink-0 u-flex-grow">
					<div class="c-form--newsletter u-ml-auto">
						
                <div class='gf_browser_gecko gform_wrapper gform_wrapper_original_id_11 subscribe-mc_wrapper gform_legacy_markup_wrapper' id='gform_wrapper_1589924125' ><div id='gf_1589924125' class='gform_anchor' tabindex='-1'></div><form method='post' enctype='multipart/form-data' target='gform_ajax_frame_1589924125' id='gform_1589924125' class='subscribe-mc gform_legacy_markup' action='/inside-the-equationdrug-espionage-platform/69203/#gf_1589924125' >
                        <div class="gform-content-wrapper"><div class='gform_body gform-body'><ul id='gform_fields_1589924125' class='gform_fields top_label form_sublabel_below description_below'><li id="field_11_1" class="gfield gfield_contains_required field_sublabel_below field_description_below gfield_visibility_visible" ><label class='gfield_label screen-reader-text' for='input_1589924125_1' >Email<span class="gfield_required"><span class="gfield_required gfield_required_asterisk">*</span></span></label><div class='ginput_container ginput_container_email'>
                            <input name='input_1' id='input_1589924125_1' type='text' value='' class='medium'   placeholder='Email' aria-required="true" aria-invalid="false"  />
                        </div></li><li id="field_11_3" class="gfield js-kaspersky-gform-recaptcha-placeholder gform_hidden field_sublabel_below field_description_below gfield_visibility_hidden" ><div class='ginput_container ginput_container_text'><input name='input_3' id='input_1589924125_3' type='hidden' class='gform_hidden'  aria-invalid="false" value='' /></div></li><li id="field_11_2" class="gfield input-without-label label-gdpr gfield_contains_required field_sublabel_below field_description_below gfield_visibility_visible" ><label class='gfield_label screen-reader-text gfield_label_before_complex'  ><span class="gfield_required"><span class="gfield_required gfield_required_asterisk">*</span></span></label><div class='ginput_container ginput_container_checkbox'><ul class='gfield_checkbox' id='input_1589924125_2'><li class='gchoice gchoice_11_2_1'>
								<input class='gfield-choice-input' name='input_2.1' type='checkbox'  value='I agree'  id='choice_1589924125_11_2_1'   />
								<label for='choice_1589924125_11_2_1' id='label_1589924125_11_2_1'>I agree to provide my email address to “AO Kaspersky Lab” to receive information about new posts on the site. I understand that I can withdraw this consent at any time via e-mail by clicking the “unsubscribe” link that I find at the bottom of any e-mail sent to me for the purposes mentioned above.</label>
							</li></ul></div></li></ul></div>
        <div class='gform_footer top_label'> 	<button class="gform_button button" type="submit" id='gform_submit_button_1589924125' value="Sign up">
		<svg class="o-icon o-svg-icon o-svg-large u-hidden u-inline-block@sm"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-envelope"></use></svg>		<span class="u-hidden u-inline@sm">Subscribe</span>
		<span class="u-hidden@sm"><svg class="o-icon o-svg-icon o-svg-right"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-arrow"></use></svg></span>
	</button>
		 <input type='hidden' name='gform_ajax' value='form_id=11&amp;title=&amp;description=&amp;tabindex=0' />
            <input type='hidden' class='gform_hidden' name='is_submit_11' value='1' />
            <input type='hidden' class='gform_hidden' name='gform_submit' value='11' />
            
            <input type='hidden' class='gform_hidden' name='gform_unique_id' value='' />
            <input type='hidden' class='gform_hidden' name='state_11' value='WyJbXSIsImIwODQwZTA2ZGQ0NzYwODcyOTBkZjNmZDM1NDk2Y2ZkIl0=' />
            <input type='hidden' class='gform_hidden' name='gform_target_page_number_11' id='gform_target_page_number_1589924125_11' value='0' />
            <input type='hidden' class='gform_hidden' name='gform_source_page_number_11' id='gform_source_page_number_1589924125_11' value='1' />
            <input type='hidden' name='gform_random_id' value='1589924125' /><input type='hidden' name='gform_field_values' value='securelist_2020_form_location=' />
            
        </div>
                        </div><p style="display: none !important;"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_3" name="ak_js" value="160"/><script>document.getElementById( "ak_js_3" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>
                        </div>
                <iframe style='display:none;width:0px;height:0px;' src='about:blank' name='gform_ajax_frame_1589924125' id='gform_ajax_frame_1589924125' title='This iframe contains the logic required to handle Ajax powered Gravity Forms.'></iframe>
                <script type="text/javascript">
gform.initializeOnLoaded( function() {gformInitSpinner( 1589924125, 'https://securelist.com/wp-content/themes/securelist2020/assets/images/content/ajax-spinner-red.svg' );jQuery('#gform_ajax_frame_1589924125').on('load',function(){var contents = jQuery(this).contents().find('*').html();var is_postback = contents.indexOf('GF_AJAX_POSTBACK') >= 0;if(!is_postback){return;}var form_content = jQuery(this).contents().find('#gform_wrapper_1589924125');var is_confirmation = jQuery(this).contents().find('#gform_confirmation_wrapper_1589924125').length > 0;var is_redirect = contents.indexOf('gformRedirect(){') >= 0;var is_form = form_content.length > 0 && ! is_redirect && ! is_confirmation;var mt = parseInt(jQuery('html').css('margin-top'), 10) + parseInt(jQuery('body').css('margin-top'), 10) + 100;if(is_form){jQuery('#gform_wrapper_1589924125').html(form_content.html());if(form_content.hasClass('gform_validation_error')){jQuery('#gform_wrapper_1589924125').addClass('gform_validation_error');} else {jQuery('#gform_wrapper_1589924125').removeClass('gform_validation_error');}setTimeout( function() { /* delay the scroll by 50 milliseconds to fix a bug in chrome */ jQuery(document).scrollTop(jQuery('#gform_wrapper_1589924125').offset().top - mt); }, 50 );if(window['gformInitDatepicker']) {gformInitDatepicker();}if(window['gformInitPriceFields']) {gformInitPriceFields();}var current_page = jQuery('#gform_source_page_number_1589924125_11').val();gformInitSpinner( 1589924125, 'https://securelist.com/wp-content/themes/securelist2020/assets/images/content/ajax-spinner-red.svg' );jQuery(document).trigger('gform_page_loaded', [1589924125, current_page]);window['gf_submitting_1589924125'] = false;}else if(!is_redirect){var confirmation_content = jQuery(this).contents().find('.GF_AJAX_POSTBACK').html();if(!confirmation_content){confirmation_content = contents;}setTimeout(function(){jQuery('#gform_wrapper_1589924125').replaceWith(confirmation_content);jQuery(document).scrollTop(jQuery('#gf_1589924125').offset().top - mt);jQuery(document).trigger('gform_confirmation_loaded', [1589924125]);window['gf_submitting_1589924125'] = false;wp.a11y.speak(jQuery('#gform_confirmation_message_1589924125').text());}, 50);}else{jQuery('#gform_1589924125').append(contents);if(window['gformRedirect']) {gformRedirect();}}jQuery(document).trigger('gform_post_render', [1589924125, current_page]);} );} );
</script>
					</div>
				</div>
			</div>
						<div class="u-hidden@sm u-mb-spacer-base-">
				<div class="c-image c-image--overflow-down@sm">
					<a href="https://xtraining.kaspersky.com/?reseller=gl_xtr-general_acq_ona_smm__onl_b2b_securelist_ban_sm-team______&#038;utm_source=securelist&#038;utm_medium=blog&#038;utm_campaign=gl_xtr-general_az0075&#038;utm_content=banner&#038;utm_term=gl_securelist_organic_adbydaqili75vov"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/01/20172851/xTraining_General_Banner_1080x1080_eng-370x370.jpg" /></a>				</div>
			</div>
					</div>
	</section>
	</div><!-- /.c-page -->

<section class="c-block c-block--spacing-t-small c-block--spacing-t-large@md c-block--spacing-b c-page-footer c-block--bg-image c-color--invert" style="background-image: url(https://securelist.com/wp-content/themes/securelist2020/assets/images/content/bg-gradient-02.jpg);">
	<div class="o-container-fluid">
		<div class="c-page-footer__content">
			<div class="o-row o-row--reverse">
				<div class="o-col-9@md">
					<div class="c-page-menu">
						<div class="o-row c-page-menu__dividers">
							<div class="o-col-4@md"><div class="c-accordion js-accordion c-accordion--reset@md"><p class="menu-item-threats section-title accordion menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-226 c-page-menu__title u-hidden u-block@md"><a href="https://securelist.com/threat-categories/">Threats</a></p><div class="c-accordion-toggle js-accordion-toggle"><p>Threats</p></div><div class="c-accordion-container js-accordion-container">
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category current-post-ancestor current-menu-parent current-post-parent menu-item-99839"><a href="https://securelist.com/threat-category/apt-targeted-attacks/">APT (Targeted attacks)</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-89457"><a href="https://securelist.com/threat-category/secure-environment/">Secure environment (IoT)</a></li>
	<li class="topic-item vulnerabilities menu-item menu-item-type-custom menu-item-object-custom menu-item-63231"><a href="https://securelist.com/threat-category/mobile-threats/">Mobile threats</a></li>
	<li class="topic-item detected menu-item menu-item-type-custom menu-item-object-custom menu-item-63229"><a href="https://securelist.com/threat-category/financial-threats/">Financial threats</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-89458"><a href="https://securelist.com/threat-category/spam-and-phishing/">Spam and phishing</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-99840"><a href="https://securelist.com/threat-category/industrial-threats/">Industrial threats</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89465"><a href="https://securelist.com/threat-category/web-threats/">Web threats</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-89459"><a href="https://securelist.com/threat-category/vulnerabilities-and-exploits/">Vulnerabilities and exploits</a></li>
</ul>
</li>
</li></ul></div></div></div><div class="o-col-4@md"><div class="c-accordion js-accordion c-accordion--reset@md"><p class="menu-item-categories section-title accordion menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-230 c-page-menu__title u-hidden u-block@md"><a href="https://securelist.com/categories/">Categories</a></p><div class="c-accordion-toggle js-accordion-toggle"><p>Categories</p></div><div class="c-accordion-container js-accordion-container">
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-84158"><a href="https://securelist.com/category/apt-reports/">APT reports</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-99841"><a href="https://securelist.com/category/malware-descriptions/">Malware descriptions</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84160"><a href="https://securelist.com/category/kaspersky-security-bulletin/">Security Bulletin</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84161"><a href="https://securelist.com/category/malware-reports/">Malware reports</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-89460"><a href="https://securelist.com/category/spam-and-phishing-reports/">Spam and phishing reports</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-99842"><a href="https://securelist.com/category/security-technologies/">Security technologies</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84165"><a href="https://securelist.com/category/research/">Research</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84164"><a href="https://securelist.com/category/publications/">Publications</a></li>
</ul>
</li>
</li></ul></div></div></div><div class="o-col-4@md"><p class="menu-item-tags section-title after-accordion menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-277 c-page-menu__title u-hidden u-block@md"><a>Other sections</a></p>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-100526"><a href="https://securelist.com/all/">Archive</a></li>
	<li class="show-all-tags menu-item menu-item-type-post_type menu-item-object-page menu-item-57837"><a href="https://securelist.com/tags/">All tags</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-101956"><a href="https://securelist.com/webinars/">Webinars</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-101126"><a target="_blank" rel="noopener noreferrer" href="https://apt.securelist.com/">APT Logbook</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-241"><a target="_blank" rel="noopener noreferrer" href="https://statistics.securelist.com/">Statistics</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-86643"><a target="_blank" rel="noopener noreferrer" href="https://encyclopedia.kaspersky.com/">Encyclopedia</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-58141"><a target="_blank" rel="noopener noreferrer" href="https://threats.kaspersky.com/">Threats descriptions</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-104901"><a href="https://securelist.com/ksb-2021/">KSB 2021</a></li>
</ul>
</li>
</div>						</div>
					</div>
				</div>
				<div class="o-col-3@md">
					<div class="c-site-logo c-site-logo--kaspersky"></div>
				</div>
			</div>
		</div>
		<div class="c-page-footer__wrapper">
			<div class="c-page-footer__info">
								<p>© 2022 AO Kaspersky Lab. All Rights Reserved.<br />
Registered trademarks and service marks are the property of their respective owners.</p>
							</div>
			<div class="c-page-footer__links">
				<ul>
																<li><a href="https://www.kaspersky.com/web-privacy-policy">Privacy Policy</a></li>
																<li><a href="https://www.kaspersky.com/end-user-license-agreement">License Agreement</a></li>
																<li><a href="javascript: void(0);" onclick="javascript: Cookiebot.renew()">Cookies</a></li>
									</ul>
			</div>
		</div>
	</div>
</section>

<div id="modal-newsletter" class="c-modal__wrapper c-modal__wrapper--sm mfp-hide">
	<div class="c-modal">
		<a href="#" class="c-modal-close js-modal-close"></a>
		<div class="c-modal__main">
			<div class="c-block c-block--spacing-t-small c-block--spacing-b-small">
				<div class="o-container-fluid">
					<div class="c-block__header">
						<h5 class="c-title--small">Subscribe to our weekly e-mails</h5>
						<p>The hottest research right in your inbox</p>
					</div>
					<div class="c-form--float-labels js-float-labels">
						
                <div class='gf_browser_gecko gform_wrapper gform_wrapper_original_id_11 subscribe-mc_wrapper gform_legacy_markup_wrapper' id='gform_wrapper_732342660' ><div id='gf_732342660' class='gform_anchor' tabindex='-1'></div><form method='post' enctype='multipart/form-data' target='gform_ajax_frame_732342660' id='gform_732342660' class='subscribe-mc gform_legacy_markup' action='/inside-the-equationdrug-espionage-platform/69203/#gf_732342660' >
                        <div class="gform-content-wrapper"><div class='gform_body gform-body'><ul id='gform_fields_732342660' class='gform_fields top_label form_sublabel_below description_below'><li id="field_11_1" class="gfield gfield_contains_required field_sublabel_below field_description_below gfield_visibility_visible" ><label class='gfield_label screen-reader-text' for='input_732342660_1' >Email<span class="gfield_required"><span class="gfield_required gfield_required_asterisk">*</span></span></label><div class='ginput_container ginput_container_email'>
                            <input name='input_1' id='input_732342660_1' type='text' value='' class='medium'   placeholder='Email' aria-required="true" aria-invalid="false"  />
                        </div></li><li id="field_11_3" class="gfield js-kaspersky-gform-recaptcha-placeholder gform_hidden field_sublabel_below field_description_below gfield_visibility_hidden" ><div class='ginput_container ginput_container_text'><input name='input_3' id='input_732342660_3' type='hidden' class='gform_hidden'  aria-invalid="false" value='' /></div></li><li id="field_11_2" class="gfield input-without-label label-gdpr gfield_contains_required field_sublabel_below field_description_below gfield_visibility_visible" ><label class='gfield_label screen-reader-text gfield_label_before_complex'  ><span class="gfield_required"><span class="gfield_required gfield_required_asterisk">*</span></span></label><div class='ginput_container ginput_container_checkbox'><ul class='gfield_checkbox' id='input_732342660_2'><li class='gchoice gchoice_11_2_1'>
								<input class='gfield-choice-input' name='input_2.1' type='checkbox'  value='I agree'  id='choice_732342660_11_2_1'   />
								<label for='choice_732342660_11_2_1' id='label_732342660_11_2_1'>I agree to provide my email address to “AO Kaspersky Lab” to receive information about new posts on the site. I understand that I can withdraw this consent at any time via e-mail by clicking the “unsubscribe” link that I find at the bottom of any e-mail sent to me for the purposes mentioned above.</label>
							</li></ul></div></li></ul></div>
        <div class='gform_footer top_label'> 	<button type="submit" class="gform_button button" id='gform_submit_button_732342660' value="Sign up">
		<svg class="o-icon o-svg-icon o-svg-large"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-envelope"></use></svg>		<span>Subscribe</span>
	</button>

	 <input type='hidden' name='gform_ajax' value='form_id=11&amp;title=&amp;description=&amp;tabindex=0' />
            <input type='hidden' class='gform_hidden' name='is_submit_11' value='1' />
            <input type='hidden' class='gform_hidden' name='gform_submit' value='11' />
            
            <input type='hidden' class='gform_hidden' name='gform_unique_id' value='' />
            <input type='hidden' class='gform_hidden' name='state_11' value='WyJbXSIsImIwODQwZTA2ZGQ0NzYwODcyOTBkZjNmZDM1NDk2Y2ZkIl0=' />
            <input type='hidden' class='gform_hidden' name='gform_target_page_number_11' id='gform_target_page_number_732342660_11' value='0' />
            <input type='hidden' class='gform_hidden' name='gform_source_page_number_11' id='gform_source_page_number_732342660_11' value='1' />
            <input type='hidden' name='gform_random_id' value='732342660' /><input type='hidden' name='gform_field_values' value='securelist_2020_form_location=sidebar' />
            
        </div>
                        </div><p style="display: none !important;"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_4" name="ak_js" value="41"/><script>document.getElementById( "ak_js_4" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>
                        </div>
                <iframe style='display:none;width:0px;height:0px;' src='about:blank' name='gform_ajax_frame_732342660' id='gform_ajax_frame_732342660' title='This iframe contains the logic required to handle Ajax powered Gravity Forms.'></iframe>
                <script type="text/javascript">
gform.initializeOnLoaded( function() {gformInitSpinner( 732342660, 'https://securelist.com/wp-content/themes/securelist2020/assets/images/content/ajax-spinner-red.svg' );jQuery('#gform_ajax_frame_732342660').on('load',function(){var contents = jQuery(this).contents().find('*').html();var is_postback = contents.indexOf('GF_AJAX_POSTBACK') >= 0;if(!is_postback){return;}var form_content = jQuery(this).contents().find('#gform_wrapper_732342660');var is_confirmation = jQuery(this).contents().find('#gform_confirmation_wrapper_732342660').length > 0;var is_redirect = contents.indexOf('gformRedirect(){') >= 0;var is_form = form_content.length > 0 && ! is_redirect && ! is_confirmation;var mt = parseInt(jQuery('html').css('margin-top'), 10) + parseInt(jQuery('body').css('margin-top'), 10) + 100;if(is_form){jQuery('#gform_wrapper_732342660').html(form_content.html());if(form_content.hasClass('gform_validation_error')){jQuery('#gform_wrapper_732342660').addClass('gform_validation_error');} else {jQuery('#gform_wrapper_732342660').removeClass('gform_validation_error');}setTimeout( function() { /* delay the scroll by 50 milliseconds to fix a bug in chrome */ jQuery(document).scrollTop(jQuery('#gform_wrapper_732342660').offset().top - mt); }, 50 );if(window['gformInitDatepicker']) {gformInitDatepicker();}if(window['gformInitPriceFields']) {gformInitPriceFields();}var current_page = jQuery('#gform_source_page_number_732342660_11').val();gformInitSpinner( 732342660, 'https://securelist.com/wp-content/themes/securelist2020/assets/images/content/ajax-spinner-red.svg' );jQuery(document).trigger('gform_page_loaded', [732342660, current_page]);window['gf_submitting_732342660'] = false;}else if(!is_redirect){var confirmation_content = jQuery(this).contents().find('.GF_AJAX_POSTBACK').html();if(!confirmation_content){confirmation_content = contents;}setTimeout(function(){jQuery('#gform_wrapper_732342660').replaceWith(confirmation_content);jQuery(document).scrollTop(jQuery('#gf_732342660').offset().top - mt);jQuery(document).trigger('gform_confirmation_loaded', [732342660]);window['gf_submitting_732342660'] = false;wp.a11y.speak(jQuery('#gform_confirmation_message_732342660').text());}, 50);}else{jQuery('#gform_732342660').append(contents);if(window['gformRedirect']) {gformRedirect();}}jQuery(document).trigger('gform_post_render', [732342660, current_page]);} );} );
</script>
					</div>
				</div>
			</div>
		</div><!-- /.c-modal__main -->
	</div><!-- /.c-modal -->
</div><!-- /.c-modal__wrapper -->
<script src="//static.ads-twitter.com/oct.js" type="text/javascript"></script>
<script type="text/javascript">twttr.conversion.trackPid('ntt0i', { tw_sale_amount: 0, tw_order_quantity: 0 });</script>
<noscript>
<img height="1" width="1" style="display:none;" alt="" src="https://analytics.twitter.com/i/adsct?txn_id=ntt0i&p_id=Twitter&tw_sale_amount=0&tw_order_quantity=0" />
<img height="1" width="1" style="display:none;" alt="" src="//t.co/i/adsct?txn_id=ntt0i&p_id=Twitter&tw_sale_amount=0&tw_order_quantity=0" />
</noscript>            <!-- Facebook Pixel Image -->
            <noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=839281392784015&amp;ev=PageView&amp;noscript=1" /></noscript>
            <!-- End Facebook Pixel Image -->
                        <script type="text/javascript">
            if ( typeof _recaptcha_wordpress_savedcomment != 'undefined') {
                document.getElementById('comment').value =
                    _recaptcha_wordpress_savedcomment;
            }
            </script><script type='text/javascript' src='https://kasperskycontenthub.com/securelist/wp-content/plugins/kaspersky-embeds/js/scripts.js?ver=1.0' id='kspr_embeds-js'></script>
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js?render=explicit&#038;ver=202124050927' id='kaspersky-dynamic-gravity-forms-google-recaptcha-js'></script>
<script type='text/javascript' id='kaspersky-omniture-js-extra'>
/* <![CDATA[ */
var kaspersky = {"pageName":"Kaspersky Securelist","pageType":"blog","platformName":"Micro Site","businessType":"b2c","siteLocale":"en-GLOBAL"};
/* ]]> */
</script>
<script type='text/javascript' src='//media.kaspersky.com/tracking/omniture/s_code_single_suite.js?ver=5.9.2' id='kaspersky-omniture-js'></script>
<script type='text/javascript' id='crayon_js-js-extra'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/securelist.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' id='kaspersky-dynamic-gravity-forms-main-js-extra'>
/* <![CDATA[ */
var kasperskyDynamicaReCaptchaData = {"ajaxUrl":"https:\/\/securelist.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' id='wp-autosearch-script-js-extra'>
/* <![CDATA[ */
var wp_autosearch_config = {"autocomplete_taxonomies":{"0":"category"},"split_results_by_type":"true","search_title":"true","search_content":"false","search_terms":"false","search_exactonly":"true","order_by":"title","order":"DESC","search_comments":"false","search_tags":"false","no_of_results":"5","description_limit":"100","title_limit":"50","excluded_ids":{},"excluded_cats":{},"full_search_url":"https:\/\/kasperskycontenthub.com\/securelist\/?s=%q%","min_chars":"3","ajax_delay":"200","cache_length":"200","autocomplete_sortorder":"posts","thumb_image_display":"false","thumb_image_width":"50","thumb_image_height":"50","get_first_image":"true","force_resize_first_image":"true","thumb_image_crop":"true","default_image":"https:\/\/kasperskycontenthub.com\/securelist\/wp-content\/plugins\/wp-autosearch\/assert\/image\/default.png","search_image":"https:\/\/kasperskycontenthub.com\/securelist\/wp-content\/plugins\/wp-autosearch\/assert\/image\/search-icon.png","display_more_bar":"false","display_result_title":"false","enable_token":"true","custom_css":"","custom_js":"","try_full_search_text":"Search more...","no_results_try_full_search_text":"No Results!","show_author":"false","show_date":"false","description_result":"false","color":{"results_even_bar":"E8E8E8","results_odd_bar":"FFFFFF","results_even_text":"000000","results_odd_text":"000000","results_hover_bar":"5CCCB2","results_hover_text":"FFFFFF","seperator_bar":"2D8DA0","seperator_hover_bar":"6A81A0","seperator_text":"FFFFFF","seperator_hover_text":"FFFFFF","more_bar":"5286A0","more_hover_bar":"4682A0","more_text":"FFFFFF","more_hover_text":"FFFFFF","box_border":"57C297","box_background":"FFFFFF","box_text":"000000"},"title":{"page":"Pages","post":"Posts","webinars":"Webinars"},"post_types":{"0":"page","1":"post"},"nonce":"73fa2a6c74","ajax_url":"https:\/\/securelist.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' id='securelist-script-js-extra'>
/* <![CDATA[ */
var securelist2020Data = {"ajaxUrl":"https:\/\/securelist.com\/wp-admin\/admin-ajax.php","loading":"Loading...","marketoBaseURL":"","marketoVirtualForm":"27241","munchkinID":"802-IJN-240","reCaptcha_key":"6Lf2eUQUAAAAAC-GQSZ6R2pjePmmD6oA6F_3AV7j"};
/* ]]> */
</script>
<script type='text/javascript' src='//assets.kasperskycontenthub.com/wp-content/plugins/bwp-minify/min/?f=wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js,wp-content/plugins/kaspersky-gravity-forms-dynamic-recaptcha/assets/js/main.js,wp-content/plugins/kaspersky-wp-autosearch/assert/js/migrate.js,wp-content/plugins/kaspersky-wp-autosearch/assert/js/autocomplete.js,wp-content/plugins/kaspersky-wp-autosearch/assert/js/ajax-script.js,wp-content/plugins/wds-no-login-autocomplete/js/script.js,wp-content/themes/securelist2020/assets/js/main.js,wp-includes/js/comment-reply.min.js,wp-includes/js/dist/vendor/regenerator-runtime.min.js,wp-includes/js/dist/vendor/wp-polyfill.min.js&#038;ver=816b5101'></script>
<script type='text/javascript' src='//assets.kasperskycontenthub.com/wp-content/plugins/bwp-minify/min/?f=wp-includes/js/dist/dom-ready.min.js,wp-includes/js/dist/hooks.min.js,wp-includes/js/dist/i18n.min.js,wp-includes/js/dist/a11y.min.js&#038;ver=816b5101'></script>
<script type='text/javascript' defer='defer' src='https://securelist.com/wp-content/plugins/gravityforms/js/jquery.json.min.js?ver=2.5.16.3' id='gform_json-js'></script>
<script type='text/javascript' id='gform_gravityforms-js-extra'>
/* <![CDATA[ */
var gform_i18n = {"datepicker":{"days":{"monday":"Mon","tuesday":"Tue","wednesday":"Wed","thursday":"Thu","friday":"Fri","saturday":"Sat","sunday":"Sun"},"months":{"january":"January","february":"February","march":"March","april":"April","may":"May","june":"June","july":"July","august":"August","september":"September","october":"October","november":"November","december":"December"},"firstDay":1,"iconText":"Select date"}};
var gf_global = {"gf_currency_config":{"name":"U.S. Dollar","symbol_left":"$","symbol_right":"","symbol_padding":"","thousand_separator":",","decimal_separator":".","decimals":2,"code":"USD"},"base_url":"https:\/\/securelist.com\/wp-content\/plugins\/gravityforms","number_formats":[],"spinnerUrl":"https:\/\/securelist.com\/wp-content\/plugins\/gravityforms\/images\/spinner.svg","strings":{"newRowAdded":"New row added.","rowRemoved":"Row removed","formSaved":"The form has been saved.  The content contains the link to return and complete the form."}};
var gf_legacy_multi = {"11":"1"};
var gf_global = {"gf_currency_config":{"name":"U.S. Dollar","symbol_left":"$","symbol_right":"","symbol_padding":"","thousand_separator":",","decimal_separator":".","decimals":2,"code":"USD"},"base_url":"https:\/\/securelist.com\/wp-content\/plugins\/gravityforms","number_formats":[],"spinnerUrl":"https:\/\/securelist.com\/wp-content\/plugins\/gravityforms\/images\/spinner.svg","strings":{"newRowAdded":"New row added.","rowRemoved":"Row removed","formSaved":"The form has been saved.  The content contains the link to return and complete the form."}};
var gf_legacy_multi = {"11":"1"};
var gf_global = {"gf_currency_config":{"name":"U.S. Dollar","symbol_left":"$","symbol_right":"","symbol_padding":"","thousand_separator":",","decimal_separator":".","decimals":2,"code":"USD"},"base_url":"https:\/\/securelist.com\/wp-content\/plugins\/gravityforms","number_formats":[],"spinnerUrl":"https:\/\/securelist.com\/wp-content\/plugins\/gravityforms\/images\/spinner.svg","strings":{"newRowAdded":"New row added.","rowRemoved":"Row removed","formSaved":"The form has been saved.  The content contains the link to return and complete the form."}};
var gf_legacy_multi = {"11":"1"};
/* ]]> */
</script>
<script type='text/javascript' defer='defer' src='https://securelist.com/wp-content/plugins/gravityforms/js/gravityforms.min.js?ver=2.5.16.3' id='gform_gravityforms-js'></script>
<script type='text/javascript' defer='defer' src='https://securelist.com/wp-content/plugins/gravityforms/js/placeholders.jquery.min.js?ver=2.5.16.3' id='gform_placeholder-js'></script>
<script type="text/javascript">
gform.initializeOnLoaded( function() { jQuery(document).on('gform_post_render', function(event, formId, currentPage){if(formId == 11) {if(typeof Placeholders != 'undefined'){
                        Placeholders.enable();
                    }} } );jQuery(document).bind('gform_post_conditional_logic', function(event, formId, fields, isInit){} ) } );
</script>
<script type="text/javascript">
gform.initializeOnLoaded( function() { jQuery(document).trigger('gform_post_render', [11, 1]) } );
</script>


<!-- Powered by Whitelist IP For Limit Login Attempts | URL: http://club.orbisius.com/products/wordpress-plugins/whitelist-ip-for-limit-login-attempts/ -->


</body>
</html>
