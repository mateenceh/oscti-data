<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Microsoft RC4 Flaw - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Microsoft RC4 Flaw Comments Feed" href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/147" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=147' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2005%2F01%2Fmicrosoft_rc4_f.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2005%2F01%2Fmicrosoft_rc4_f.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-147 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-147" class="post-147 post type-post status-publish format-standard hentry category-uncategorized tag-cryptanalysis tag-cryptography tag-encryption tag-microsoft tag-privacy tag-vulnerabilities">

	<div class="article">

		<h2 class="entry">Microsoft RC4 Flaw</h2>
		<p>One of the most important rules of stream ciphers is to never use the same keystream to encrypt two different documents.  If someone does, you can break the encryption by XORing the two ciphertext streams together.  The keystream drops out, and you end up with plaintext XORed with plaintext &#8212; and you can easily recover the two plaintexts using letter frequency analysis and other basic techniques.</p>
<p>It&#8217;s an amateur crypto mistake.  The easy way to prevent this attack is to use a unique initialization vector (IV) in addition to the key whenever you encrypt a document.</p>
<p>Microsoft uses the RC4 stream cipher in both Word and Excel.  And they make this mistake.  Hongjun Wu has details (link is a <a href="http://eprint.iacr.org/2005/007.pdf">PDF</a>).</p>
<blockquote><p>In this report, we point out a serious security flaw in Microsoft Word and Excel. The stream cipher RC4 [9] with key length up to 128 bits is used in Microsoft Word and Excel to protect the documents.  But when an encrypted document gets modified and saved, the initialization vector remains the same and thus the same keystream generated from RC4 is applied to encrypt the different versions of that document. The consequence is disastrous since a lot of information of the document could be recovered easily.</p></blockquote>
<p>This isn&#8217;t new.  Microsoft made the same mistake in 1999 with RC4 in <a href="http://www.bindview.com/Support/RAZOR/Advisories/1999/adv_WinNT_syskey.cfm">WinNT Syskey</a>.  Five years later, Microsoft has the same flaw in other products.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/cryptanalysis/" rel="tag">cryptanalysis</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/encryption/" rel="tag">encryption</a>, <a href="https://www.schneier.com/tag/microsoft/" rel="tag">Microsoft</a>, <a href="https://www.schneier.com/tag/privacy/" rel="tag">privacy</a>, <a href="https://www.schneier.com/tag/vulnerabilities/" rel="tag">vulnerabilities</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html" rel="bookmark">Posted on January 18, 2005 at 9:00 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html#comments">23 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html" data-title="Microsoft RC4 Flaw" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-1404">

			<div class="comment by-ma ">

				<p class="commentcredit">

					<span class="commenter">MA</span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1404">
						January 18, 2005 10:20 AM					</a>

				</p>

				<p>I think this is not a mistake, but a &#8220;feature&#8221;, and they do it on purpose to allow CIA/NSA/etc easly crack the encription, while giving the user a false feel of security</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-1405">

			<div class="comment by-arik ">

				<p class="commentcredit">

					<span class="commenter">Arik</span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1405">
						January 18, 2005 10:51 AM					</a>

				</p>

				<p>Had I wanted to create a file format that can easily be decoded by the security agencies, I would have used a covert channel rather than encryption that&#8217;s flawed.</p>
<p>A word file is so big and contains so much redundant data that hiding the decryption key inside it, one bit at a time, seems much more plausible than using flawed encryption on purpose.</p>
<p>Moreover, the agency would be out of luck if they desperately need to decode a document and they only have a single one (the attack Bruce described requires at least two documents).</p>
<p>&#8212; Arik</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-1406">

			<div class="comment by-scott-laird ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://scottstuff.net/scott' rel='external nofollow ugc' class='url'>Scott Laird</a></span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1406">
						January 18, 2005 12:06 PM					</a>

				</p>

				<p>This <em>really</em> isn&#8217;t new with Microsoft&#8211;Windows 95 used the same basic scheme to encrypt its local passwords.  One of the encrypted records was the username in uppercase, padded out to 20 bytes with nulls.  Since each record in the file reused the same RC4 stream, the first 20 bytes of each password record could be recovered with pencil and paper.</p>
<p>See <a href="http://seclists.org/lists/bugtraq/1995/Dec/0004.html" rel="nofollow ugc">http://seclists.org/lists/bugtraq/1995/Dec/0004.html</a> for more details.</p>
<p>The scuttlebutt at the time suggested that Microsoft couldn&#8217;t quite understand what was wrong with the way they were using RC4; obviously they still haven&#8217;t figured it out.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-1407">

			<div class="comment by-davi-ottenheimer ">

				<p class="commentcredit">

					<span class="commenter">Davi Ottenheimer</span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1407">
						January 18, 2005 12:10 PM					</a>

				</p>

				<p>RC4, even with IV, is still weak if implemented incorrectly. That was the mistake made with Wired Equivalent Privacy (WEP) for wireless security.</p>
<p>Just as you recommend, the WEP authors included Initialization Vectors to avoid encrypting two ciphertexts with the same key stream. Unfortunately, however, they only implemented a 24-bit field for the IV, and all mobile devices were set with a shared a key. So it did not take long for the WEP devices to demonstrate a weak/incorrect implementation of encryption using RC4 even with an IV.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-1408">

			<div class="comment by-peter-gutmann ">

				<p class="commentcredit">

					<span class="commenter">Peter Gutmann</span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1408">
						January 19, 2005 10:21 AM					</a>

				</p>

				<p>They&#8217;ve been doing this since at least 1993 with WfW password encryption.  The last time I looked at this (in 1998, for my Godzilla crypto tutorial) they&#8217;d managed to get RC4 wrong every single time they were known to have used it.  So this isn&#8217;t really a new problem, it&#8217;s just a bug-compatible continuation of a problem that&#8217;s been around for more than a decade.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-1409">

			<div class="comment by-david-mohring ">

				<p class="commentcredit">

					<span class="commenter">David Mohring</span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1409">
						January 20, 2005 3:25 PM					</a>

				</p>

				<p>Re. NSA/CIA back door.<br />
Transcript of Internet Caucus Panel Discussion on Encryption, Statement of Congressman Curt Weldon</p>
<p><a href="http://www.techlawjournal.com/cong106/encrypt/19990928a.htm#weldon1" rel="nofollow ugc">http://www.techlawjournal.com/cong106/encrypt/19990928a.htm#weldon1</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-1410">

			<div class="comment by-clay-webster ">

				<p class="commentcredit">

					<span class="commenter">Clay Webster</span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1410">
						January 21, 2005 12:24 PM					</a>

				</p>

				<p>Microsoft hires recent college grads who will continue to make these same notice mistakes over and over&#8230; regardless of the technical specialty.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-1411">

			<div class="comment by-w-t-ichiyasu ">

				<p class="commentcredit">

					<span class="commenter">W.T. Ichiyasu</span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1411">
						January 21, 2005 11:32 PM					</a>

				</p>

				<p>I have never trusted or relied on Microsoft&#8217;s native &#8220;document-level&#8221; encryption in any incarnation of Office, nor have I ever recommended that any of my clients even attempt to rely on the same to protect the confidendiality of their documents&#8217; contents.  (I&#8217;m none too pleased with &#8220;EFS,&#8221; either, but don&#8217;t even get me started on that&#8230;)</p>
<p>As a result of consciously never using non-MS file-level encryption, I haven&#8217;t bothered to keep abreast of all of the third-party tools that once existed to &#8220;recover&#8221; (decrypt) &#8220;natively encrypted&#8221; Office documents, with no prior knowledge of the original encryption keys.  Some of those tools were baloney, but some really did work as advertised (which is why I became persuaded that native Office encryption was baloney).</p>
<p>Did all of those Office-cracker tools suddenly disappear???&#8230;  Did any of them exploit the botched implementation of RC4???&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-1412">

			<div class="comment by-ted-sumner ">

				<p class="commentcredit">

					<span class="commenter">Ted Sumner</span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1412">
						January 21, 2005 11:54 PM					</a>

				</p>

				<p>Mr. Ichiyasu raises a crucial point.  The crackers I used on Outlook, Excel and Word were simply brute force.  It seems unlikely that the naive implementation by Microsoft is the root of the weakness.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-1413">

			<div class="comment by-m-carson ">

				<p class="commentcredit">

					<span class="commenter">M. Carson</span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1413">
						January 22, 2005 8:50 AM					</a>

				</p>

				<p>This <em>really, really</em> isn&#8217;t new. The user account creation tool in the original Microsoft version of Xenix, back in the early &#8217;80&#8217;s, used the same IV (&#8220;salt&#8221;) for encrypting all passwords. The passwd command (for changing passwords) didn&#8217;t have this flaw, but often initial passwords were never changed. This made it substantially simpler to break large numbers of passwords on Xenix systems.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-1414">

			<div class="comment by-pir2 ">

				<p class="commentcredit">

					<span class="commenter">pir2</span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1414">
						January 23, 2005 11:36 PM					</a>

				</p>

				<p>Why would MS try harder? With such a monopolistic situation (rather communist when you think about it!), they would be stupid to invest hard cash delivering value to the customer. We will, anyway, all end up queuing at the same bakery, for lack of a better choice. Old debate though&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-1415">

			<div class="comment by-jean-guy-poudrier ">

				<p class="commentcredit">

					<span class="commenter">Jean-Guy Poudrier</span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1415">
						January 24, 2005 8:49 AM					</a>

				</p>

				<p>Send me the link has soon has possible<br />
for correcton of the bug in Word and Excel document.<br />
thank</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-1416">

			<div class="comment by-mike-nichols ">

				<p class="commentcredit">

					<span class="commenter">Mike Nichols</span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1416">
						January 26, 2005 11:43 AM					</a>

				</p>

				<p>From my perspective, this type of less than perfect encryption will keep all but the &#8220;afflicted&#8221; snoop away from the information.<br />
For the seriously determined and resourced, virtually no amount of encryption is absolute because it still involves an algorithm of some complexity.<br />
The only true protection is to prevent unncessary access to the file in the first place.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-1417">

			<div class="comment by-vesselin-bontchev ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.people.frisk-software.com/~bontchev/index.html' rel='external nofollow ugc' class='url'>Vesselin Bontchev</a></span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1417">
						January 26, 2005 12:47 PM					</a>

				</p>

				<p>The point is really moot, folks.</p>
<p>First, a correction &#8211; Word does not use RC4 with a 128-bit key; it uses RC4 with a 40-bit key which is derived from a 128-bit hash (MD5, if I remember correctly) of the user-provided password. (Since version 97, that is. Earlier versions of Word used a &#8220;toy&#8221; cipher &#8211; a trivial Vigenere variant.)</p>
<p>Given the speed of computers nowadays, and given that RC4 is a relatively fast cipher, a 40-bit-long key for it is ridiculously insecure anyway &#8211; no matter how implemented.</p>
<p>Even if the flaw you&#8217;re discussing here didn&#8217;t exist, one could still brute-force the cipher in a few days on a reasonably fast PC (much faster if a cluster of PCs is used). There are even cracking programs for Word documents floating around that do just that. They don&#8217;t recover the password; they just exhaust the full (relatively small) 40-bit keyspace and decrypt the document.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-1418">

			<div class="comment by-guest-from-russia ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.frikzona.org' rel='external nofollow ugc' class='url'>Guest from russia</a></span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1418">
						January 26, 2005 6:54 PM					</a>

				</p>

				<p>This is not a first error, and not a last. Can&#8217;t do anything</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-1419">

			<div class="comment by-israel-torres ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.techworld.com/security/news/index.cfm?NewsID=3027' rel='external nofollow ugc' class='url'>Israel Torres</a></span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1419">
						January 27, 2005 10:52 AM					</a>

				</p>

				<p>Here is Zimmermann&#8217;s Interview regarding this flaw posted today Jan 27 2005:</p>
<p><a href="http://www.techworld.com/security/news/index.cfm?NewsID=3027" rel="nofollow ugc">http://www.techworld.com/security/news/index.cfm?NewsID=3027</a></p>
<p>Crypto expert: Microsoft flaw is serious<br />
Microsoft should sort flaw and abandon RC4 in favour of better ciphers, says PGP creator.</p>
<p>&#8220;Cryptography expert Phil Zimmermann has said he believes the flaw discovered in Microsoft’s Word and Excel encryption is serious and warrants immediate attention.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-1420">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.sloppycode.net' rel='external nofollow ugc' class='url'>chris</a></span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1420">
						January 28, 2005 4:06 AM					</a>

				</p>

				<p>When you say &#8216;using letter frequency analysis and other basic techniques&#8217;, Bruce, is this something that can be done in hours or days on a standard p3/p4?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-1421">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1421">
						February 2, 2005 1:57 PM					</a>

				</p>

				<p>It probably is not even required to use a brutforce search, a 40 bit key is small enough to form a &#8220;catalouge&#8221; especially if the hash does not produce all of the 40 bit keys.</p>
<p>On his retirment Bob Moriss (NSA chief Scientist) made comments about modern computer files and their structures. Most of the Microsoft file formats start with a sequence of many bytes that is effectivly a magic number. Look the encrypted version up in the sorted catalouge and the key would drop out, estimated search time is based on search time of the memory holding the catalogue but could easily be down to sub millisecond times&#8230;</p>
<p>Therefore all MicroSoft encrypted documents sent on the internet could be decoded pretty much in real time, if there was the desire to harvest them.</p>
<p>The maths shows that 40 bits is approximatly 10^12 and a 130Gbyte Hard drive holds around 0.125E12 bytes so the catalogue could be fitted onto 40 IDE hard drives that cost less than 100USD each. A 5 tera byte raid array can be purchesed of the internet quite cheaply so even a home user could build the catalogue at home.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-1422">

			<div class="comment by-rafael-sevilla ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://stormwyrm.blogspot.com' rel='external nofollow ugc' class='url'>Rafael Sevilla</a></span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1422">
						February 3, 2005 2:23 AM					</a>

				</p>

				<p>IIRC, the exact same mistake was made in MS-PPTP, as Schneier&#8217;s own analysis of the protocol pointed out. I suppose nobody at Microsoft ever bothered to read Applied Cryptography&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-1423">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1423">
						October 3, 2006 10:45 AM					</a>

				</p>

				<p>If you use a different password to encrypt each document then they cannot be subjected to this attack.<br />
True or false?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-1424">

			<div class="comment by-john-milton ">

				<p class="commentcredit">

					<span class="commenter">john milton</span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1424">
						December 25, 2006 9:16 AM					</a>

				</p>

				<p>False, as explained above: since there is &#8220;known content&#8221;  in the unencrypted file regardless of what password was used a snoop tries all 2^40 possible keys, until they find one that displays that content</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-1426">

			<div class="comment by-alex ">

				<p class="commentcredit">

					<span class="commenter">Alex</span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1426">
						June 3, 2007 5:41 PM					</a>

				</p>

				<p>Hi all,<br />
a curiosity about RC4.<br />
Suppose the I generate a random 128-bit key and I encrypt a text. When I&#8217;ll decrypt it, before encrypt again I generate a new 128-bit key.<br />
I suppose that this approach bypass RC4 flaws. Isn&#8217;t it?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-1427">

			<div class="comment by-matt ">

				<p class="commentcredit">

					<span class="commenter">Matt</span> •

					<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/#comment-1427">
						August 4, 2007 5:41 PM					</a>

				</p>

				<p>I was wondering if there was a more secure way of protecting sheets. I have a very advanced template that requires users to input data on a sheet. There are separate sheets in the workbook that calculate the output and display it.<br />
Mainly, I wish to prevent the &#8220;brain&#8221; of the sheet to be stolen; while allowing the users to still access the inputs.</p>
<p>This security hole is very disconcerting, and I wish to correct this issue.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2005/01/microsoft_rc4_f.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2005/01/microsoft_rc4_f.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2005%2F01%2Fmicrosoft_rc4_f.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2005/01/microsoft_rc4_f.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='147' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2005/01/signal_article.html" rel="prev">← SIGNAL Article</a>		<a href="https://www.schneier.com/blog/archives/2005/01/the_department.html" rel="next">DHS Biometric ID Cards →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
