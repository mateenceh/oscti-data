<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>SQL Injection Vulnerabilities - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; SQL Injection Vulnerabilities Comments Feed" href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/1154" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=1154' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2006%2F10%2Fsql_injection_v.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2006%2F10%2Fsql_injection_v.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-1154 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-1154" class="post-1154 post type-post status-publish format-standard hentry category-uncategorized tag-databases tag-google tag-search-engines tag-sql-injection tag-vulnerabilities">

	<div class="article">

		<h2 class="entry">SQL Injection Vulnerabilities</h2>
		<p>This is a really interesting <a href="http://portal.spidynamics.com/s/msutton/archive/2006/09/26/How-Prevalent-Are-SQL-Injection-Vulnerabilities_3F00_.aspx">post</a> about someone finding SQL injection vulnerabilities with Google.  His result is that 11.3% of websites are vulnerable to this attack.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/databases/" rel="tag">databases</a>, <a href="https://www.schneier.com/tag/google/" rel="tag">Google</a>, <a href="https://www.schneier.com/tag/search-engines/" rel="tag">search engines</a>, <a href="https://www.schneier.com/tag/sql-injection/" rel="tag">SQL injection</a>, <a href="https://www.schneier.com/tag/vulnerabilities/" rel="tag">vulnerabilities</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html" rel="bookmark">Posted on October 4, 2006 at 1:45 PM</a>			•
			<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html#comments">18 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html" data-title="SQL Injection Vulnerabilities" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-44275">

			<div class="comment by-israel-torres ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://blog.israeltorres.org' rel='external nofollow ugc' class='url'>Israel Torres</a></span> •

					<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html/#comment-44275">
						October 4, 2006 2:25 PM					</a>

				</p>

				<p>I know that at least once a day while surfing I&#8217;ll find simple little glitches that could cause larger problems in the future if gone ignored. I&#8217;ll send off a friendly email from an &#8220;anonymous&#8221; account stating the problem and that it would be wise to fix it (and even how). I&#8217;ll check back once in a while surfing and sometimes it is fixed and sometimes it isn&#8217;t. Let’s say I am more surprised when it is fixed than when it isn’t.</p>
<p>You can thank me later. 😉</p>
<p>Israel Torres</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-44276">

			<div class="comment by-bryan ">

				<p class="commentcredit">

					<span class="commenter">Bryan</span> •

					<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html/#comment-44276">
						October 4, 2006 2:55 PM					</a>

				</p>

				<p>A minor correction &#8211; he actually said 11.3% of sites <em>from the initial population of URL&#8217;s</em> are vulnerable, not 11.3% of all sites at large. The initial population of URL&#8217;s were those which came out of a Google query for &#8220;id=10&#8221;.</p>
<p>It is still a horrific number.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-44277">

			<div class="comment by-quack-lawyer ">

				<p class="commentcredit">

					<span class="commenter">Quack Lawyer</span> •

					<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html/#comment-44277">
						October 4, 2006 3:20 PM					</a>

				</p>

				<p>This is interesting and hopefully will push some web site designers to have another look at their site security but here is a cautionary tale about unauthorised penetration testing:</p>
<p><a href="http://www.theregister.co.uk/2005/10/11/tsunami_hacker_followup/" rel="nofollow ugc">http://www.theregister.co.uk/2005/10/11/tsunami_hacker_followup/</a></p>
<p>Not sure what the US position is but basically, the police in the UK seem to prosecute if they can regardless of motives.</p>
<p>Also, the terms and conditions for using Google API could be construed to bar unauthorised penetration testing:</p>
<p>Section 2: APPROPRIATE CONDUCT<br />
&#8220;Users outside of the United States agree to comply with their own local rules regarding online conduct &#8230;&#8221;</p>
<p>Full terms and conditions are at <a href="http://code.google.com/tos.html." rel="nofollow ugc"></a><a href="http://code.google.com/tos.html" rel="nofollow ugc">http://code.google.com/tos.html</a>.</p>
<p>I daresay the real risk of getting into trouble doing this is negligble but it&#8217;s best to think about the possible implications before injecting SQL code into somebody&#8217;s server.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-44278">

			<div class="comment by-jeremy-h ">

				<p class="commentcredit">

					<span class="commenter">Jeremy H</span> •

					<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html/#comment-44278">
						October 4, 2006 5:23 PM					</a>

				</p>

				<p>When I was an undergrad (in &#8217;03 or &#8217;04), I took a course in applied cryptography.  It focussed more on the application side and the high level, rather than the mathematics and the low level.</p>
<p>One of our assignments was to recover a key against some public algorithm with a chosen-ciphertext attack.  Our interface to the implementation containing the key was a CGI web script.</p>
<p>At the outset, our prof said &#8220;this is the first time I&#8217;ve coded a CGI interface, it should be secure, but if anyone finds a vulnerability, please let me know.&#8221;  The first thing that I did was pass &#8220;; ls&#8221; as my ciphertext.  I was rewarded with a directory listing of where the app was running from.  The ciphertext from the client was being dumped to a command line shell script.</p>
<p>This vulnerability is no different, and will continue for as long as data from the client is not properly escaped or encapsulated.  These errors would be much more rare if developers followed the MVC design pattern and never trusted data from the client side.  Skipping either of those steps may be expected from amateurs, but anyone claiming to do professional work should be doing both.  Unfortunately, quick hacks are more prevalent than we&#8217;d hope.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-44279">

			<div class="comment by-davi-ottenheimer ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://davi.poetry.org/' rel='external nofollow ugc' class='url'>Davi Ottenheimer</a></span> •

					<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html/#comment-44279">
						October 4, 2006 5:47 PM					</a>

				</p>

				<p>Input validation is a great concept but with human behavior so prone to mistakes is 11% a large or small number? And what will make it smaller? Incentives? Penalties?</p>
<p>For example, people are known to put food in their mouth without input validation every day. Even when faced with overwhelming evidence of harm from certain things (e.g. trans fats) they are not easily convinced to start &#8220;whitelisting&#8221;. Perhaps the rule should be food must be properly escaped or encapsulated&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-44280">

			<div class="comment by-nick-andrew ">

				<p class="commentcredit">

					<span class="commenter">Nick Andrew</span> •

					<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html/#comment-44280">
						October 4, 2006 6:28 PM					</a>

				</p>

				<p>The PHP language is complicit in this because its SQL functions do not support placeholders. PHP applications must embed variables as literals in their SQL statements, and so there are functions to quote strings which must be used on all the variables which will go into the statement.</p>
<p>Forget to call the quoting function, and if your variable isn&#8217;t sufficiently well validated, your statement may be vulnerable to an sql injection attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-44281">

			<div class="comment by-roger ">

				<p class="commentcredit">

					<span class="commenter">Roger</span> •

					<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html/#comment-44281">
						October 4, 2006 7:16 PM					</a>

				</p>

				<p>The problem, of course, is that world facing web applications have very high vulnerability, yet many web application development systems are sold on the ease of use by newbies, who don&#8217;t understand the security risks.</p>
<p>It might be possible in principle to create a web app language that prevents newbies from shooting themselves in the feet, but it&#8217;s been tried in the past and doesn&#8217;t work (usually, the language is too restrictive, AND the newbie programmer finds a way to suicide anyway!)</p>
<p>So it is yet another problem of user (well, newbie programmer) education &#8212; a perennial thorn in the side for security. Incidentally a couple of months ago I read Sverre H. Huseby&#8217;s &#8220;Innocent Code: a security wake-up call for web programmers&#8221;. I highly recommend it. It is so well written that I think any new programmer who reads it will not only develop a feel for the general principles involved in securing apps (as well as many specific techniques), but is also likely to develop an interest in the subject and start consciously securing everything in sight. I especially like to quote Huseby&#8217;s Rule 1 (of 27):<br />
   &#8220;Do not underestimate the power of the dark side&#8221;.</p>
<p>@Jeremy H:</p>
<blockquote><p>
  &#8230; the MVC design pattern and never trusted data from the client side. Skipping either of those steps may be expected from amateurs, but anyone claiming to do professional work should be doing both.
</p></blockquote>
<p>I agree, never, ever ever trust data from the client side. But some projects are so simple that an MVC design is needless complexity, which itself can be a source of problems. Anything with only 1 or 2 screens and only one (or 0) types of user input, may not need it. A lot of quite useful web apps have only one or two screens.</p>
<p>For example, when I found a lot of my Q&amp;D web hacks were very similar, I made a little library that made one liners of common tasks like loading a standardised config file, connecting to a (read only) db view, doing a SQL query (a fixed string taken from the config file), displaying a 2D array as an HTML table of (filtered) data, deciding what logger is in use, and other little pieces like that. The whole library is about 40 lines, is written with Extreme Security in mind, and has been audited numerous times. With it, I create Q&amp;D web apps that are about 6 &#8211; 12 lines long (mainly light arithmetical processing), plus 6 lines of config file, and take about half an hour to build (including coding of tests, 2nd party code audit, documentation, and deployment).</p>
<p>Building these as MVC &#8212; even desiging the model &#8212; would be a severe waste of effort. Yet of all my web apps these are often the ones that are most popular with and useful to users; I know of one example which saved certain program managers about 2 man hours of work every week, and helped in halving the remaining failure rate in the systems it reported on.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-44282">

			<div class="comment by-schmecurity ">

				<p class="commentcredit">

					<span class="commenter">Schmecurity</span> •

					<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html/#comment-44282">
						October 5, 2006 3:29 AM					</a>

				</p>

				<p>Regarding SQL injection; it is a common misconception that placeholders is a silver bullet.</p>
<p>Don&#8217;t get me wrong; you should definetly use placeholders. However, how secure this is will always depend on the implementation in the driver. A few years ago, I investigated the application we were developing, to see if we were safe from SQL injection.</p>
<p>We used several databases, and when I checked the source code for the PostgreSQL JDBC driver, one of the methods used was actually vulnerable to SQL injection (if my memory serves me right, it was the PreparedStatement.setObject method&#8230; but then again, I might be wrong).</p>
<p>This bug was pretty obvious, and it was fixed (I think), but everyone should remember that the drivers is software just like everything else, and don&#8217;t do anything magical.</p>
<p>Obviously, we can&#8217;t go around checking the source code for every driver out there (and some are closed source, of course), so in the end we probably have to trust the vendors.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-44283">

			<div class="comment by-schmecurity ">

				<p class="commentcredit">

					<span class="commenter">Schmecurity</span> •

					<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html/#comment-44283">
						October 5, 2006 3:30 AM					</a>

				</p>

				<p>Sverre H. Huseby&#8217;s &#8220;Innocent Code: a security wake-up call for web programmers&#8221; is well written, but it is very basic and definetly for newbies. Just something to keep in mind if you buy it, and don&#8217;t expect anything more.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-44284">

			<div class="comment by-ciaran-mcnulty ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://ciaranmcnulty.com' rel='external nofollow ugc' class='url'>Ciaran McNulty</a></span> •

					<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html/#comment-44284">
						October 5, 2006 5:34 AM					</a>

				</p>

				<p>@Nick Andrew</p>
<p>Actually PHP&#8217;s PDO interface for DB transactions does support placeholders in SQL, although it is fairly new.</p>
<p>The PEAR::DB libraries have long supported this sort of functionality too, but as with most things in PHP, the security vulnerability comes from the fact that anyone can get stuff up and running without having to code &#8216;the right way&#8217;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-44285">

			<div class="comment by-nkt ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.discreetsecuritysolutions.com' rel='external nofollow ugc' class='url'>NKT</a></span> •

					<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html/#comment-44285">
						October 5, 2006 6:10 AM					</a>

				</p>

				<p>@Nick Andrew,</p>
<p>you can easily and securely validate your inputs in PHP, it&#8217;s just that most people don&#8217;t bother to, out of a lack of knowledge. When I started doing web design, years back, I didn&#8217;t even know what could be done, so how would I protect against it? The second I heard about it, I added a handwritten (and rather aggressive) line of scrubbing code to my scripts. However, use <a href="http://uk.php.net/manual/en/function.mysql-real-escape-string.php" rel="nofollow ugc">http://uk.php.net/manual/en/function.mysql-real-escape-string.php</a> and you will be safe from anything clever, as it simply stops things like &#8216; by adding a second &#8216; so while it might still sometimes cause an error due to not being a string, it won&#8217;t actually do anything bad. And your type checking should catch that.</p>
<p>Further, use &#8220;@&#8230; or die;&#8221; to prevent anyone causing an SQL error from seeing what they caused. Without feedback, hacking anything gets a lot harder.</p>
<p>For a simple web dialogue that&#8217;s enough.</p>
<p>The biggest issue is &#8220;Nephew Art&#8221;. Because the barriers to entry on the web are so low, and there are no enforced standards at all, people do things like passing secure variables in URL strings in good faith, in the £50 website built by their nephew.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-44286">

			<div class="comment by-toby ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mcs.open.ac.uk/tcon2/' rel='external nofollow ugc' class='url'>Toby</a></span> •

					<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html/#comment-44286">
						October 5, 2006 8:18 AM					</a>

				</p>

				<p>My surname is O&#8217;Neil, and I have lost count of the number of poorly implemented websites that won&#8217;t let me accept my surname.</p>
<p>A personal favourite is the online insurance broker where I gain an extra &#8216; after each page &#8212; by the time the quotes are gathered, my surname is O&#8221;&#8221;Neil. Still, at least it retains the `Neil&#8217;, frequently I become simply O, and my purchase is declined  8-(</p>
<p>Usually the problems seem to be occuring because the site designers are trying to attacks, and have failed to realise that an apostrophe can be part of a legitimate response&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-44287">

			<div class="comment by-corey-mutter ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.friendlyandhelpful.com' rel='external nofollow ugc' class='url'>Corey Mutter</a></span> •

					<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html/#comment-44287">
						October 5, 2006 1:58 PM					</a>

				</p>

				<p>I have one word for all of you that want to avoid SQL injection: Stored Procedures.</p>
<p>Have the ID the Web app uses to connect to the database have no permissions to select or change any tables, only to execute some SPs you&#8217;ve written. Those SPs run as another DB user that does have the needed access to tables.</p>
<p>Presto! No chance of SQL injection (without guessing the password needed to connect as the user the SPs run as, if it&#8217;s allowed to connect at all, or compromising the DB server). As a plus, you can enforce arbitrary security restrictions.</p>
<p>For example, in a system I did like this, when the web app wants to get a list of the user&#8217;s trouble tickets, it executes a SP with one parameter: the user&#8217;s session ID. The SP looks up the session ID in a table to get the user&#8217;s login name, looks up the login name in a profile table to get the user&#8217;s company, then returns the rows from the trouble-ticket table for that company. Therefore, you just can&#8217;t get at a company&#8217;s trouble tickets without having a valid session ID for a user from that company (or compromising the DB server). This is true even if you can throw arbitrary SQL at the database from the web app (since that user can&#8217;t do anything but execute the SPs).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-44288">

			<div class="comment by-schmecurity ">

				<p class="commentcredit">

					<span class="commenter">Schmecurity</span> •

					<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html/#comment-44288">
						October 5, 2006 3:47 PM					</a>

				</p>

				<p>Stored procedures? Well&#8230; Putting application logic in the database? I guess it might be secure, but it&#8217;s not really great application design.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-44289">

			<div class="comment by-repton ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://repton-infinity.livejournal.com/' rel='external nofollow ugc' class='url'>Repton</a></span> •

					<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html/#comment-44289">
						October 5, 2006 4:57 PM					</a>

				</p>

				<p>Google has just released a <a href="http://www.google.com/codesearch/advanced_code_search" rel="nofollow ugc">code search</a> facility.  Some guy on Slashdot <a href="http://developers.slashdot.org/comments.pl?sid=199207&amp;cid=16319697" rel="nofollow ugc">pointed out</a> that you can use it to search for SQL injection attacks: <a href="http://www.google.com/codesearch?hl=en&amp;lr=&amp;q=Where+%5C%24_POST+-addslashes+lang%3Aphp" rel="nofollow ugc">http://www.google.com/codesearch?hl=en&#038;lr=&#038;q=Where+%5C%24_POST+-addslashes+lang%3Aphp</a></p>
<p>As an example, the second result on the page has this code:</p>
<p><code>$sql = "SELECT * FROM users WHERE uname='".$_POST['username']."' AND upass='".$md5pw."'";</code></p>
<p>(obviously, you&#8217;re not finding vulnerable websites, you&#8217;re finding vulnerable packages instead.  But still&#8230;)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-44290">

			<div class="comment by-paeniteo ">

				<p class="commentcredit">

					<span class="commenter">Paeniteo</span> •

					<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html/#comment-44290">
						October 6, 2006 4:06 AM					</a>

				</p>

				<p>I always wonder what is so difficult about putting mysql_real_escape_string around variables intended to go into the database&#8230;</p>
<p>Replace:<br />
$id = $_POST[&#8216;id&#8217;];<br />
by:<br />
$id = mysql_real_escape_string($_POST[&#8216;id&#8217;]);</p>
<p>It does not really take much skill to just do this.<br />
Yes, I&#8217;m aware that this very function had a security flaw not long ago, but apart from this you are about as secure as you can get when you have to transfer strings into the DB.</p>
<p>In the above case, you could also add something like:<br />
if (!is_number($id)) die(&#8220;illegal ID&#8221;);</p>
<p>Even an activated magic_quotes_gpc setting in PHP will save you from most trouble and would work even with activated register_globals (where it is not necessary to manually move request-parameters into variables).</p>
<p>Maybe, register_globals is again the root of all evil, as it makes writing things like<br />
$query = &#8220;select * from table where id=&#8217;$id'&#8221;;<br />
without thinking about where $id comes from too easy.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-44291">

			<div class="comment by-thomas-mueller ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.h2database.com' rel='external nofollow ugc' class='url'>Thomas Mueller</a></span> •

					<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html/#comment-44291">
						November 23, 2006 1:04 PM					</a>

				</p>

				<p>I suggest to <em>enforce</em> that application developers use parameterized (also called prepared) statements. This is possible: depending on the rights, the database rejects embedded literals in SQL statements and only allows parameterized statements. For details of my proposal, see here: <a href="http://www.h2database.com/html/advanced.html#sql_injection" rel="nofollow ugc">http://www.h2database.com/html/advanced.html#sql_injection</a><br />
Unfortunately, this feature is only implemented in the H2 database yet. But I think it is a simple and sound solution.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-44292">

			<div class="comment by-thomas-mueller ">

				<p class="commentcredit">

					<span class="commenter">Thomas Mueller</span> •

					<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html/#comment-44292">
						November 24, 2006 3:40 PM					</a>

				</p>

				<p>I suggest to <em>enforce</em> using parameterized statements. This can be done in the database engine itself. Just disallow string (and number) literals in SQL statements. I have implemented this functionality in my database, H2 (www.h2database.com), see &#8216;Advanced Topics&#8217; &#8211; &#8216; Protection against SQL Injection&#8217;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2006/10/sql_injection_v.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2006/10/sql_injection_v.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2006%2F10%2Fsql_injection_v.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2006/10/sql_injection_v.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='1154' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2006/10/firefox_javascr.html" rel="prev">← Firefox JavaScript Flaw: Real or Hoax?</a>		<a href="https://www.schneier.com/blog/archives/2006/10/phishtank.html" rel="next">PhishTank →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
