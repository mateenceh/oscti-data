<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Attacking Bank-Card PINs - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Attacking Bank-Card PINs Comments Feed" href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/1237" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=1237' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2006%2F11%2Fattacking_bankc.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2006%2F11%2Fattacking_bankc.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-1237 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-1237" class="post-1237 post type-post status-publish format-standard hentry category-uncategorized tag-banking tag-credit-cards tag-encryption tag-insiders tag-passwords tag-pins tag-vulnerabilities">

	<div class="article">

		<h2 class="entry">Attacking Bank-Card PINs</h2>
		<p>Research paper by Omer Berkman and Odelia Moshe Ostrovsky:  &#8220;<a href="http://www.arx.com/documents/The_Unbearable_Lightness_of_PIN_Cracking.pdf">The Unbearable Lightness of PIN Cracking</a>&#8220;:</p>
<blockquote><p><b>Abstract.</b> We describe new attacks on the financial PIN processing API. The attacks apply to switches as well as to verification facilities. The attacks are extremely severe allowing an attacker to expose customer PINs by executing only one or two API calls per exposed PIN. One of the attacks uses only the translate function which is a required function in every switch. The other attacks abuse functions that are used to allow customers to select their PINs online. Some of the attacks can be applied on a switch even though the attacked functions require issuer’s keys which do not exist on a switch. This is particularly disturbing as it was widely believed that functions requiring issuer’s keys cannot do any harm if the respective keys are unavailable.</p></blockquote>
<p>Basically, the paper describes an inherent flaw with the way ATM PINs are encrypted and transmitted on the international financial networks, making them vulnerable to attack from malicious insiders in a bank.</p>
<p>One of the most disturbing aspects of the attack is that you&#8217;re only as secure as the most untrusted bank on the network.  Instead of just having to trust your own issuer bank that they have good security against insider fraud, you have to trust every other financial institution on the network as well.  An insider at another bank can crack your ATM PIN if you withdraw money from any of the other bank&#8217;s ATMs.</p>
<p>The authors tell me that they&#8217;ve contacted the major credit card companies and banks with this information, and haven&#8217;t received much of a response.  They believe it is now time to alert the public.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/banking/" rel="tag">banking</a>, <a href="https://www.schneier.com/tag/credit-cards/" rel="tag">credit cards</a>, <a href="https://www.schneier.com/tag/encryption/" rel="tag">encryption</a>, <a href="https://www.schneier.com/tag/insiders/" rel="tag">insiders</a>, <a href="https://www.schneier.com/tag/passwords/" rel="tag">passwords</a>, <a href="https://www.schneier.com/tag/pins/" rel="tag">PINs</a>, <a href="https://www.schneier.com/tag/vulnerabilities/" rel="tag">vulnerabilities</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html" rel="bookmark">Posted on November 17, 2006 at 7:31 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html#comments">45 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html" data-title="Attacking Bank-Card PINs" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-47506">

			<div class="comment by-felix ">

				<p class="commentcredit">

					<span class="commenter">Felix</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47506">
						November 17, 2006 8:25 AM					</a>

				</p>

				<p>Correction:<br />
&#8220;One is the most disturbing&#8221; should be &#8220;One of the most disturbing&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47507">

			<div class="comment by-another_bruce ">

				<p class="commentcredit">

					<span class="commenter">another_bruce</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47507">
						November 17, 2006 9:09 AM					</a>

				</p>

				<p>we&#8217;re all gonna wake up to empty checking accounts some morning.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47508">

			<div class="comment by-supersnail ">

				<p class="commentcredit">

					<span class="commenter">supersnail</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47508">
						November 17, 2006 9:21 AM					</a>

				</p>

				<p>If you can get inside an ATM switch with enough authority to run arbitary code, then you&#8217;re a pretty poor fraudster if you only come away with a bunch of pin codes!</p>
<p>The real weakness in the attack from a practical point of view is how do you capture and identify &#8220;your&#8221; ATM transaction in all the thousands of transactions flowing through the switch?</p>
<p>Also Brits and Frenchies cannot sleep soundly either. A different more secure protocol is used for chip n pin, but, the old pin block is supported for backward compatibility, so, it would be vulnerable to this attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47509">

			<div class="comment by-stan ">

				<p class="commentcredit">

					<span class="commenter">Stan</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47509">
						November 17, 2006 9:28 AM					</a>

				</p>

				<p>@ Felix:  My goodness, thanks for that.  I&#8217;m sure nobody ever would have figured that out on their own.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47510">

			<div class="comment by-keith ">

				<p class="commentcredit">

					<span class="commenter">Keith</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47510">
						November 17, 2006 9:29 AM					</a>

				</p>

				<p>And of course PIN numbers are the customer&#8217;s responsibility to keep secure and secret, so the security problem here is an externality to the bank anyway.<br />
Added to that externality, even if someone gets a pile of your customers&#8217; PINs, you can just blame it on one of the other banks in the network.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47511">

			<div class="comment by-andre-leplume ">

				<p class="commentcredit">

					<span class="commenter">Andre LePlume</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47511">
						November 17, 2006 9:36 AM					</a>

				</p>

				<p>At least our passports are secure.</p>
<p>Oh, wait a minute&#8230;.</p>
<p><a href="http://www.guardian.co.uk/idcards/story/0" rel="nofollow ugc">http://www.guardian.co.uk/idcards/story/0</a>,,1950226,00.html</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47512">

			<div class="comment by-carlos ">

				<p class="commentcredit">

					<span class="commenter">Carlos</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47512">
						November 17, 2006 9:38 AM					</a>

				</p>

				<p>Another shocking banking security flaw:<br />
<a href="http://technology.timesonline.co.uk/article/0" rel="nofollow ugc">http://technology.timesonline.co.uk/article/0</a>,,19509-2453590.html</p>
<p>How on earth isn&#8217;t this encrypted?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47513">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">bob</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47513">
						November 17, 2006 9:58 AM					</a>

				</p>

				<p>@another_bruce: Its not so bad, I wake up to an empty checking account every day&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47514">

			<div class="comment by-gopi-flaherty ">

				<p class="commentcredit">

					<span class="commenter">Gopi Flaherty</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47514">
						November 17, 2006 10:12 AM					</a>

				</p>

				<p>&#8220;The authors tell me that they&#8217;ve contacted the major credit card companies and banks with this information, and haven&#8217;t received much of a response.&#8221;</p>
<p>This is the sort of behaviour that encourages full disclosure. When I read of corporations dismissing attacks as impractical or improbable, I&#8217;m reminded of the banner at the top of l0pht Heavy Industries&#8217; web site, which went approximately:</p>
<p>&#8220;&#8216;That exploit is purely theoretical.&#8217; &#8211; Microsoft</p>
<p>l0pht: Making the theoretical practical since 199x&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47515">

			<div class="comment by-todd-jonz ">

				<p class="commentcredit">

					<span class="commenter">Todd Jonz</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47515">
						November 17, 2006 10:37 AM					</a>

				</p>

				<p>We&#8217;ve recently been assured by election officials and Diebold executives alike that all poll workers are trustworthy (<em>titter</em>), and that we needn&#8217;t worry our pretty little heads about insiders compromising electronic voting systems.  By extension, I think it&#8217;s safe to assume that all bank employees are similarly trustworthy (<em>snicker</em>), and that security vulnerabilities in internal banking systems are nothing we need to be concerned about.  (<em>GUFFAW!</em>)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47516">

			<div class="comment by-derf ">

				<p class="commentcredit">

					<span class="commenter">derf</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47516">
						November 17, 2006 10:38 AM					</a>

				</p>

				<p>Malicious insiders in a bank don&#8217;t need your PIN.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47517">

			<div class="comment by-mdf ">

				<p class="commentcredit">

					<span class="commenter">mdf</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47517">
						November 17, 2006 10:46 AM					</a>

				</p>

				<p>Stupid malicious insiders at the bank don&#8217;t need a PIN.</p>
<p>The smart ones do though.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47518">

			<div class="comment by-graham-steel ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://homepages.inf.ed.ac.uk/gsteel/' rel='external nofollow ugc' class='url'>Graham Steel</a></span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47518">
						November 17, 2006 10:59 AM					</a>

				</p>

				<p>I recently wrote a paper on automatically quantifying the difficulty of cracking PINs, when various different combinations of the commands mentioned in Berkman and Ostrovsky&#8217;s paper are available to the intruder. It will appear in the November 2006 edition of Theoretical Computer Science, (Volume 367, Issues 1-2, pages 257-270), but you can also download a pre-print from my webpage if you&#8217;re interested&#8230;</p>
<p><a href="http://homepages.inf.ed.ac.uk/gsteel/papers/" rel="nofollow ugc">http://homepages.inf.ed.ac.uk/gsteel/papers/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47519">

			<div class="comment by-fergus-doyle ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://doyle.blogs.ie' rel='external nofollow ugc' class='url'>Fergus Doyle</a></span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47519">
						November 17, 2006 11:40 AM					</a>

				</p>

				<p>The bad news is there is a real problem here and has always been it only applies where you are using your card at an &#8220;untrusted&#8221; bank though.  You should be safe at your bank if you trust them 🙂</p>
<p>The good news is that for chip cards where the ATM acquires the card by the chip this problem does not exist as the encryption is done in the pinpad (the actual thing you press the keys on) and in the card itself and never gets seen elsewhere.</p>
<p>So the sooner we are all using chip cards rather than magnetic stripe cards the better.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47520">

			<div class="comment by-cj ">

				<p class="commentcredit">

					<span class="commenter">CJ</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47520">
						November 17, 2006 12:08 PM					</a>

				</p>

				<p>@Fergus:</p>
<p>Not quite.  The PIN is encrypted on the keypad, but it still needs to be translated to encryption under the key of the appropriate switch, as it travels through the system.  So your PIN is encrypted and decrypted multiple times on the route to your bank from the ATM: the reason this is thought to be safe is because the decryption and re-encryption occurs within a hardware module (the HSM), which is a sealed unit which is tamper-proof.  This attack shows that that isn&#8217;t sufficient.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47521">

			<div class="comment by-kirill ">

				<p class="commentcredit">

					<span class="commenter">kirill</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47521">
						November 17, 2006 3:32 PM					</a>

				</p>

				<p>you may have missed this piece of news about a year ago, approximately September-October 2005. I don&#8217;t remember exactly, it was either Citi or Raiffeisen, who did forced replacement of all its cards ever inserted into ATMs in Ukraine. It was suggested at that time that the one of those nice ATM cryptoprocessors vulnerabilities has been exploited.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47522">

			<div class="comment by-lawrence-doliveiro ">

				<p class="commentcredit">

					<span class="commenter">Lawrence D&#039;Oliveiro</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47522">
						November 17, 2006 6:24 PM					</a>

				</p>

				<p>Do you find it depressing being a security researcher? Describing a flaw doesn&#8217;t seem to be enough for you to get taken seriously by those who are supposed to be responsible for maintaining security. Then when you try to prove your point by demonstrating an actual attack, instead if admitting you were right, they get you arrested and thrown in jail.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47523">

			<div class="comment by-andrew ">

				<p class="commentcredit">

					<span class="commenter">Andrew</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47523">
						November 17, 2006 11:33 PM					</a>

				</p>

				<p>Mental note: stop reading this blog at a certain work site.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47524">

			<div class="comment by-swiss-connection ">

				<p class="commentcredit">

					<span class="commenter">swiss connection</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47524">
						November 18, 2006 7:18 AM					</a>

				</p>

				<p>@lawrence</p>
<p>Interesting thought. Let&#8217;s suppose I can demonstrate this vulnerability. What do I do? Do I call the BBC or CNN and pull a couple of thousand dollars out some celebrities bank account in front of the running camera, or do I pull a few hundred thousand dollars secretly and run.</p>
<p>Which is more likely to get you arrested?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47525">

			<div class="comment by-michael-mckay ">

				<p class="commentcredit">

					<span class="commenter">Michael McKay</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47525">
						November 18, 2006 12:00 PM					</a>

				</p>

				<p>As a former financial standards member and designer of financial HSMs, I can see this paper is exploring the ramifications of two known weaknesses.  The combination of the two together may lead to more effective attacks than was generally thought – but at this point I’ve only done a quick skim of the paper.</p>
<p>I have a bit of bad news for those trumpeting the security of chipcards as a solution &#8212; ironically they are the main reason why ISO 0 format PIN Blocks still exist.  I can’t count the times that we have attempted to eliminate that format in the standards group (pretty much successfully in the USA I might note).  Although I’m a bit hazy on early chipcard history, I believe the original reason chipcards started using ISO format 0 was a situation when the chipcards needed to accept an encrypted PIN before the account number was known.  In any case, I’ve heard of multiple places where chipcards ended up using ISO 0 Pin Blocks.</p>
<p>There are ways to eliminate this need at the protocol level, but it is notoriously hard to change these things once they get implemented.  Worse the HSM designs have to support them as long as they are still in use.  I can&#8217;t speak for all HSM vendors, but the one I used to work for provided mitigations by giving the HSM owner very fine grained controls over the HSM API.  The HSM owner, using k-of-n schemes of multifactor user identification, can disable individual commands and/or protocol-primitives (such as ISO 0 support).</p>
<hr />
<p>Some of the following comments are pretty similar to the ones I made here the last time an attack of this type was mentioned here.  Not so ironically the root cause of that problem was the same (where it was revealed some British banks were still using non-ISO format 3 PIN Blocks).</p>
<p>Speaking of how hard it is to change these things, you have to realize a couple of thing about the financial security area.  The first is that any change is typically very expensive, and extremely slow at its best when compared to say a OS or application patch.  The biggest reason is the large fleet of remote (and poorly connected) hardware devices.  Although it has been slowly changing, you can’t assume universal connectivity for the vast majority of POS devices (the integrated POS device, like the PIN Pads attached to supermarket may have 5 or more different protocols hops, none of which allow arbitrary messages to be sent back and forth).  Combine that with the fact that client devices are deployed in the millions and have only limited remote update capabilities.  The devices are extremely cost sensitive– which means they have minimal functionality and any major change means they have to be replaced altogether.  Another reason for the slow pace of change is that financial networks consist of many participants running mission-critical transactions.  Any changes have to be coordinated, tested, usually supported in parallel, and eventually phased-out.</p>
<p>Put these altogether, and you will find extremely slow response (compared to what application or OS level security researchers are used to).  My favorite big example is the transition to 3DES away from single-DES; which believe it or not is still ongoing!  The standards committee I served on knew about this potential from the beginning, and started making active recommendations to phase out single-DES in the mid-to-early 90’s.  Around 2000 or so (long after the EFF DES Cracker), large entities like Visa and MasterCard started to requires it (or more accurately threaten to charge more for single-DES transactions).  The deadlines kept changing, but last I heard the USA was supposed to have no more single-DES ATMs by 2005 (who knows how many waivers have been issued).  The USA POS market still is not free of single-DES terminals.  Many other countries were even slower than the USA.</p>
<p>This is a lot more complicated than simply sending out a patch!  Having said that; I&#8217;ve also found many banks to be unresponsive to security issues.  In some cases I think this is OK, one of the lessons I&#8217;ve had to learn as a financial security designer is that banks are the experts on risk management.  I can advise and point out the risks, but at the end of the day it is just one factor in an incredibly broad set of risks the bank is managing.  That is not to say that the banks are always right; and more perniciously there are a number of situations where security decision makers are not subject to the proper amount of liability (IMHO POS security is weaker than it should be in the USA because of muddled liability).</p>
<hr />
<p>Finally, I’d mention that the other HSM command the paper deals with is also a known weakness.  My former company did not offer that specific function on its general purpose financial HSMs, because of exactly the types of attacks mentioned (being able to associate attacker chosen accounts with an existing account).  It was actually a long running conflict between us and the dominant European HSM manufacturer; we insisted they buy a special purpose system to perform those types of functions while our competitor made it available on the same box (save money vs. doing security right).</p>
<p>As I said in the beginning, they took two known weakness and combined them in a specific implementation to come up with something that was worse than generally known.  At first glance, I believe some of these problems can be solved (or at least mitigated) at the HSM API level (and at one point that would been my job – but not any longer 🙂    Most switches don’t need the change PIN function, so that should be disabled.  The tricky part is when you can’t just simply shut-off a feature (like if you HAVE TO support ISO-0 for those pesky chipcards), in that case you try to design a very restricted special purpose API will be less subject to attacks of this type.  Not always easy to do, but that was what made that job fun!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47526">

			<div class="comment by-yrfid ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.yrfid.com' rel='external nofollow ugc' class='url'>yRFID</a></span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47526">
						November 19, 2006 3:14 AM					</a>

				</p>

				<p>Do you find it depressing being a security researcher? Describing a flaw doesn&#8217;t seem to be enough for you to get taken seriously by those who are supposed to be responsible for maintaining security. Then when you try to prove your point by demonstrating an actual attack, instead if admitting you were right, they get you arrested and thrown in jail.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47527">

			<div class="comment by-odelia-moshe-ostrovsky ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.arx.com' rel='external nofollow ugc' class='url'>Odelia Moshe Ostrovsky</a></span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47527">
						November 20, 2006 12:09 PM					</a>

				</p>

				<p>I am glad to see all the remarks here.</p>
<p>Regarding the EMV issue – the attacks are relevant also to chip cards, since in the EMV world the PIN verification process remains the same when online PIN verification takes place (and currently, due to VISA requirements for a certain hardware configuration in ATMs, there is no other way for ATMs to verify the PIN but online).</p>
<hr />
<p>The attacks in the paper are taking advantage of 3 functions:<br />
“translate???, “calculate_Offset??? and “calculate_PVV???.</p>
<p>The “translate??? function uses new weaknesses (of ISO_1 format) as well as known weaknesses (of ISO-0 format), which together enable exposure of the PIN code even outside of the issuer environment – for example in switches.  Disabling the “translate??? function at the HSM as suggested cannot be a solution, as every switch application require this function.</p>
<p>The “calculate_Offset??? function retrieves in clear format the difference (SUBmodulu10) of the customer intermediate PIN and the Final PIN (which is used by the customer). So what if we know one of the values in advance? It means that we know 2 out of 3 variables of the equation and thus it is very easy to compute the missing secret variable. Adding the “calculate_Offset??? function’s weaknesses to the ISO_1 weaknesses – enables reveling 1 PIN code per 1 (!!!) HSM call.</p>
<p>Disabling the “calculate_Offset“ function or the “calculate_PVV??? function in the HSM is not a solution for financial institutions that allow their customers to select their own PIN code because the capability of “customer selected PIN??? is enabled by using these functions.</p>
<p>Some of the attacks that use the “calculate_Offset??? and “Calculate_PVV??? functions are possible in switches. These functions exist in switches since the HSMs come with the complete set of the PIN processing API, as it was widely believed that functions requiring issuer&#8217;s keys cannot do any harm if the respective keys are unavailable. We describe in the paper how the “calculate_Offset??? and “calculate_PVV??? functions can also be used to expose customers PIN codes even without the issuer keys.</p>
<p>As in the previous cases, disabling these two functions in switches is also not a good solution for preventing the attacks – since issuers cannot prevent the switch employees from re-enabling the functions and use them maliciously.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47528">

			<div class="comment by-michael-mckay ">

				<p class="commentcredit">

					<span class="commenter">Michael McKay</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47528">
						November 21, 2006 3:21 AM					</a>

				</p>

				<p>I read Odelia&#8217;s comments, and mostly agree with them.  Let me clarify a few points:</p>
<p>1) I never suggested disabling the translate function.  This is mandatory functionality for a switch.</p>
<p>2) The calculate_Offset and Calculate_PVV functions are not needed by switches, unless the banks want &#8220;not-on-us&#8221; PIN Change transactions, something I&#8217;ve never heard requested.</p>
<p>3) If the switch personal can re-enable the commands, than the HSM has a real security problem.  At one point HSM enabling and disabling commands were considered kind of separate from sensitive mode.  But by the mid-90&#8217;s we knew that enabling optional functionality was a real threat (thieves made money that way), so I&#8217;ve generally considered it mandatory that a financial HSMs have either dual-control or K-of-N user management to enable or disable &#8220;weak&#8221; commands (but upon reflection I don&#8217;t recall a statement to this effect in ISO 13491).</p>
<p>To recap for the people reading this who are not HSM API designers (just about everyone I guess), a financial HSM typically has to support have many, many different functions.  The financial HSM API has two basic modes &#8211; sensitive and operational.  The sensitive mode is used to configure the HSM, load keys, and perform other sensitive operations (most HSM users will think of enabling a CA signature operation).</p>
<p>Operational mode functionality is supposed to be safe &#8211; e.g. they will provide the cryptographic functionality needed and nothing else (won&#8217;t provide an useful oracle attack, etc.).  The translate PIN command is an example of an operational command, which will be safe so long as certain aspects of the environment are carefully constrained (such as restricting the loading of key to sensitive mode).  A way to view this paper is that is presents a method of attacking operational mode commands in such a way that they inappropriately serve as an oracle.</p>
<p>Some of these are operational mode commands have known weaknesses, but are required for certain solutions.  A good (and relevant) example of a &#8220;weak command&#8221; is one that has the ability to accept an ISO 0 format PIN Block.  Over the years I&#8217;ve made a specialty of trying to get rid of the need for these commands (not easy, usually have to change the environment as well as the HSM API).</p>
<p>4) As I mentioned before, most of the HSM API&#8217;s I&#8217;ve seen for PIN Change functionality are inherently weak.  This is both because the command generates PVNs (thus opening a possible oracle attack based on the number of possible PINs &#8211; instead of the normal HSM requirement to make oracle attacks no more valuable than exhaustive key attacks), and because the command needs the ability to associate  encrypted PINs and account numbers.  A true operational mode command should prevent an attacker from putting their PIN onto a chosen account (hello Bill Gates!), or submitting a known PIN to a PVN generating command.  The naive approaches I&#8217;m familiar with have a customer entering the current and new PIN at an ATM using the same structure and keys as a normal PIN transaction; and believe me, it has a lot more weaknesses than the attacks mentioned by the paper.</p>
<p>I&#8217;ve actually designed a robust ATM based PIN Change HSM API (for a major British Bank).  Our security goals (commands with no known weaknesses) could only be accomplished by changing  the environment, which meant modifications to both host and ATM applications were needed.  There are also a lot of nuances, for example consider that the account number of the card has a many-to-many relationship with actual bank accounts (an ATM card can access a checking and saving account, while the same checking account may be accessible by multiple ATM cards).  This relationship needs to be formally stated and protected by a signature or MAC, which can be checked by the HSM before it associates the new PIN with the account.  You also need to carefully keep track of three types of PINs (reference PIN from the database, trial current PIN, and proposed new PIN), each of which should be encrypted with it&#8217;s own type of key and/or structure (so they can&#8217;t be substituted for one another).  It was a design I was proud of, and at one point we (I and my counterpart at the bank) were prepared to present a paper on this, but than I switched jobs and it kind of fell apart.</p>
<p>Again, to clarify things for the people who are not HSM API designers.</p>
<p>Designing operational mode commands is pretty much a black art, and this is an area where I&#8217;d like to see more formal methods and tests developed.  Mike Bond and Ross Anderson have done some good work in this area, and just now I&#8217;m starting to see some more academic work.  Part of the reason I&#8217;m making such in-depth posts is to encourage people to look into this area (and make it better).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47529">

			<div class="comment by-brandy ">

				<p class="commentcredit">

					<span class="commenter">Brandy</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47529">
						November 21, 2006 3:35 AM					</a>

				</p>

				<p>Hi,<br />
is it possible that there are systems which use the same static PIN block key again and again ? As far as i understand the attack on the PIN block transfer function, it only makes sense if the originator of the PIN block, e.g. an ATM, always uses the same PIN block key. And this is very hard to imagine, it would be unthinkable here. The systems i know use an unpredictable new key for each transaction, so it would not be possible to generate the lookup table that seems to be required for the attack (to be exact, the table would not be of any use). Am i missing something here ?<br />
Cheers,<br />
Brandy</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47530">

			<div class="comment by-ronnie ">

				<p class="commentcredit">

					<span class="commenter">Ronnie</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47530">
						November 21, 2006 3:46 AM					</a>

				</p>

				<p>Bruce,</p>
<p>Is this in any way connected to the Decimalisation attack theory expounded by Mike Bond back in 2003? As I recall this too was based on the ability of a Bank insider to make use of &#8216;redundant&#8217; HSMs for guessing PIN values.</p>
<p>These theories although extremely valid, if unfortunatly as yet devalued by the UK Courts, are in my view extremely interesting but too complex.</p>
<p>To defraud a bank at the level suggested insiders have far more opportunity by old fashioned fraud and forgery facilitated by computers than to go to all the effort involved in cracking an algorithm.</p>
<p>Despite their public image most banks are cavalier about securing customer data and are happier to take the small losses rather than secure their operation.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47531">

			<div class="comment by-odelia-moshe-ostrovsky ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://https:www.arx.com' rel='external nofollow ugc' class='url'>Odelia Moshe Ostrovsky</a></span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47531">
						November 21, 2006 10:04 AM					</a>

				</p>

				<p>Michael,</p>
<p>I agree with most of the things that you wrote. Some of the solutions we though about were as you mentioned. But I though that major changes are not something that the industry will be able to handle. So I started thinking how to enhance the security within the standards limits. I though that removing ISO-1 is crucial and can be done since the ISO-1 format was approved only in the last few years (so only those who used the ISO-1 will have to adjust their applications while others will get a more secured environment without performing any changes to their application, still getting the upgrade software that removes the ISO-1 implementation will be not simple). Removing ISO-0 will affect the whole industry and it will take years to implement the changes in practice. Do you think that removing ISO-0 is something that the ISO group will consider?</p>
<p>Regarding disabling function: I agree that if the switch personal can re-enable commands, then the HSM has a real security problem. But the functions “calc_Offset??? and “calc_PVV??? were not considered weak and in most HSMs there are not under the list of sensitive operations. I do believe that K-of-N approach is definitely enhancing the solution but in switches the solution must cover all areas. Even K-of-N persons at a switch should not be able to reveal PIN codes. In perfect world no information leakage is permitted. The best solution should be that even if all employees at the switch are corrupted – but the keys are well protected – the corrupted employees should gain no access to secret data.</p>
<p>I very much agree that PIN Change functionality is weak and that this is the outcome of using for “PIN change??? the same structure and keys as a normal PIN transaction. As you wrote, a true operational mode command should prevent an attacker from putting their PIN onto a chosen account. So it is obvious that ISO-0 is not very secure (and ISO-3 as well) since it is possible to find more than one account that will fit a PIN block – but how can anyone explain the fact that ISO group approved the ISO-1 format, which can fit to ANY account????</p>
<p>It is extremely interesting to design commands with no known weaknesses. For “PIN change??? this can work, as the bank will be the one to enforce the change and will be responsible to update all his applications. I started to design such a solution for the “translate??? function but it seems that it will requires changing all applications involved (ATM, Switches, verification facilities, “stand-in??? facilities). In order for it to be a complete solution – the switches should also adjust their application. How can this be enforced? For example, if one bank decides that his PIN codes will be formatted differently, all switches around the world should be able to handle this new format, otherwise this bank’s customers will not be able to use their cards everywhere. Even if ISO group will change the standard – as long as old formats are supported, the problem remains.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47532">

			<div class="comment by-michael-mckay ">

				<p class="commentcredit">

					<span class="commenter">Michael McKay</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47532">
						November 21, 2006 12:16 PM					</a>

				</p>

				<p>Odelia became confused because I made a mistake about which ISO PIN Block format was which (since I was part of the ANSI X9 organization, I&#8217;ve always just thought of the &#8220;good one&#8221; as the &#8220;ANSI PIN Block&#8221; 🙂</p>
<p>ISO Format 0, which consists of both the PIN and an account number is the &#8220;better&#8221; format (and corresponds to the ANSI PIN Block).  ISO Format 1 only uses the PIN, and ISO 2 adds some additional random material; and both have big weaknesses (ANSI X9 specifically bans their use).  If you want the details, look at ANSI X9.9 or ISO 9564 part1 (I probably should have looked it over myself 🙁</p>
<p>Making the changes universal is a tough problem.  At the very least this attack helps people recognize that the PIN Change commands are &#8220;weak&#8221; one.  And we are both in full agreement that it is hard to solve the problem without changing the environment.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47533">

			<div class="comment by-michael-mckay ">

				<p class="commentcredit">

					<span class="commenter">Michael McKay</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47533">
						November 21, 2006 12:28 PM					</a>

				</p>

				<p>@Ronnie, the decimalization attack was similar, in that it involved the manipulation of an HSM API &#8211; one that was believed to be a proper operational mode command (see above for definition).</p>
<p>That problem was a lot simpler to solve though.  Basically HSM vendors removed the the decimalization table from the API inputs, and instead required that it be a configuration value that could only be changed when the HSM was in senstive mode.</p>
<p>Still this was a good attack, and illustrates why the financial HSM APIs should have more scrutiny.  To my knowledge, only two HSM vendors have made their API&#8217;s public (nCipher and IBM).  I wish this was more common, but most HSM vendors consider their API to be a proprietary trade secret.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47534">

			<div class="comment by-todd ">

				<p class="commentcredit">

					<span class="commenter">Todd</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47534">
						November 21, 2006 7:43 PM					</a>

				</p>

				<p>This is a very interesting discussion.  I am one of those &#8220;HSM designers&#8221;, and I am also a participant in the ANSI standards group that defines many of these standards under discussion.  In my 20+ years working in this area, I can tell you that it is a very large ship that is very slow to change direction.  As others have pointed out, while many would love to change the PIN block standards and other related standards, it simply cannot be done except over the course of many years &#8211; and even then, the banks demand that HSM vendors continue to support &#8220;legacy&#8221; formats and standards which will still be in use many years after they have been dropped as approved standards.  We all wish it was not this way, but there is not much you can do about it &#8211; because of the large and diverse set of hardware and software in use, and because banks are very cautious about changing things in the security arena.</p>
<p>Having said that&#8230;  I would like to let people know that the ANSI committee is right now working toward a new PIN block standard that would alleviate the known problems.  However, it is likely to be quite a few years before it appears, and quite a few years beyond that before it is in widespread use.</p>
<p>By the way &#8211; for those who are less familiar with this world of standards, ANSI and ISO advise each other, submit proposals to each other, and try very hard to end up with finance industry security standards that are the same.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47535">

			<div class="comment by-don-davis ">

				<p class="commentcredit">

					<span class="commenter">Don Davis</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47535">
						November 22, 2006 10:05 AM					</a>

				</p>

				<p>I am a journalist writing an article about this attack. Anyone with knowledge of ATM cards and networks who would like to provide their thoughts on the significance of this paper, please contact me at <a href="mailto:don.davis@sourcemedia.com">don.davis@sourcemedia.com</a>.</p>
<p>Don</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47536">

			<div class="comment by-jr ">

				<p class="commentcredit">

					<span class="commenter">JR</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47536">
						November 22, 2006 11:21 AM					</a>

				</p>

				<p>The threat is significant and immediate.</p>
<p>It is quite possible that somewhere in the world an insider is already working on it. It is unreasonable to assume otherwise.</p>
<p>ISO-1 and most if not all legacy PIN block formats should be banned and banished from all active banking HSMs, ATMs, EPPs etc. as soon as possible. The ban must be substantiated by an audit.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47537">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47537">
						November 22, 2006 12:20 PM					</a>

				</p>

				<p>If an insider would have physical access to the HSM they&#8217;d be able to easily decrypt any information going in/out of the HSM when they change master keys. All the insider would have to do is sniff transactions going into the HSM and later decrypt them with the master key which he/she inputs into the HSM during the 30 &#8211; 90 day key change cycle.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47538">

			<div class="comment by-jr ">

				<p class="commentcredit">

					<span class="commenter">JR</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47538">
						November 22, 2006 12:38 PM					</a>

				</p>

				<p>To Anonymous:</p>
<ul>
<li>
<p>The attacks do not require physical access. This is the main point of the research article.</p>
</li>
<li>
<p>Nobody is supposed to know the master key. Where I consult, no one does.</p>
</li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47539">

			<div class="comment by-omer-berkman ">

				<p class="commentcredit">

					<span class="commenter">Omer Berkman</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47539">
						November 22, 2006 5:02 PM					</a>

				</p>

				<p>To Brandy,</p>
<p>Transport keys may certainly change. However, parameters to the API functions that control the keys to be used in the API function come from the outside so the attacker can always use the same key. Additionally, when a transport key is changed between, say, an ATM and the attacked HSM, so that encrypted PIN blocks start to arrive encrypted with a new key, the attacker can use the translate function to change the encryption of the block from the new key to the desired one.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47540">

			<div class="comment by-donald ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.linkdumponpayments.blogspot.com' rel='external nofollow ugc' class='url'>Donald</a></span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47540">
						November 24, 2006 9:43 AM					</a>

				</p>

				<p>The technical bit of the paper is ok, but it becomes highly unscientific where the authors imply that possible many phantom transactions are caused by this technical issue. That would require in-depth investigation of such transactions, which I don&#8217;t see in the paper.</p>
<p>I recognize that all scientist wish to do policy-relevant research, but I don&#8217;t think it is a good thing to expand a technical finding so easily and unscientifically into the discussion on causes of phantom-transactions (where family members are the real cause instead of the technical holes).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47541">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47541">
						November 24, 2006 10:02 AM					</a>

				</p>

				<p>Family members? Tell that to the victims of the Dollar Tree, Officemax, Wesco, Arco, GB, etc, etc frauds.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47542">

			<div class="comment by-donald ">

				<p class="commentcredit">

					<span class="commenter">Donald</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47542">
						November 25, 2006 3:10 AM					</a>

				</p>

				<p>John. I should clarify that my comment was coming from Europe; I acknowledge that the security culture and measures in the US is different (also depending on the nature of the card: debit/credit). So frauds in the US may have additional causes (unrelated to the customer). Still I don&#8217;t see on what grounds the paper would classify this specific technical issue as the main source of trouble for phantom transactions or all the frauds you mention. That would require additional research into those frauds, which I don&#8217;t read in their paper.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47543">

			<div class="comment by-omer-berkman ">

				<p class="commentcredit">

					<span class="commenter">Omer Berkman</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47543">
						November 25, 2006 9:40 AM					</a>

				</p>

				<p>Donald &amp; John,</p>
<p>We were not careful enough in the sentence regarding phantom withrawls in the Conclusions. The word &#8220;may&#8221; should have been added (as is the case in the Introduction).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47544">

			<div class="comment by-thomas-brandtstaetter ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.synargos.com' rel='external nofollow ugc' class='url'>Thomas Brandtstaetter</a></span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47544">
						December 4, 2006 8:59 AM					</a>

				</p>

				<p>This attack scenario is tricky indeed, but not really new. It makes absolutely sense, to improve the technical implementation as described:</p>
<ul>
<li>disable Refomat-Options at switch HSM and allow for PIN-Block Key-Translate (i.e. TRANSCIPHER) only</li>
<li>consequent usage of ISO-0 PIN-block format all the way through (from ATM through switch to authorisation instance)</li>
<li>correctly bind customer data and check for correct usage within HSM</li>
<li>keep vital operations and systems bank-internal (which doesn&#8217;t really meet the ideas of the outsourcing market)</li>
<li>improve ISO8583 Protocols by binding the data-entry-entity (ATM) to the HSMs being used</li>
<li>be good (god) to your employees</li>
<li>and so on </li>
</ul>
<p>In total, I would assume, that attacking a webserver behind the SSL-Tunnel is easier for an insider adversary, in order to get valuable credit-card information.</p>
<p>Without a secure TRANSCIPHER function (HSM internal) at the switch-side (the frontend webserver in that case) you would be worse than the weekness of the PIN Translate implementation discussed here.</p>
<p>After all, if you are able to introduce &#8220;additional unauthorized&#8221; software in production systems, you could easily attack side-channel-wise after the  PIN-Authorization process and directly bypass it&#8217;s decision and draw from the account directly.</p>
<p>Thomas Brandtstaetter</p>
<p>The world is a puzzle, with everyone puzzling (T.B.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47545">

			<div class="comment by-thomas-brandtstaetter ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.synargos.com' rel='external nofollow ugc' class='url'>Thomas Brandtstaetter</a></span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47545">
						December 4, 2006 9:06 AM					</a>

				</p>

				<p>Addition to my comment regarding the similarity in attacking SSL-secured services, assuming one can introduce additonal unauthorized software:</p>
<hr />
<p>A New Vulnerability In RSA Cryptography</p>
<p>A new vulnerability associated with RSA cryptography has been found, which works by spying the CPU internals with a spy program running on the same computer as the crypto application. Dedicated systems (like CAcert´s certificate generation) are not affected, only multi-tasking and multi-user systems are affected.</p>
<h2><a href="http://blog.cacert.org/2006/11/193.html" rel="nofollow ugc">http://blog.cacert.org/2006/11/193.html</a></h2>
<p>Best Regards, Thomas Brandtstaetter</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47546">

			<div class="comment by-mohit ">

				<p class="commentcredit">

					<span class="commenter">mohit</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47546">
						December 6, 2006 10:47 AM					</a>

				</p>

				<p>Hi,<br />
I have followed this discussion with great interest. However, I am unclear as to how knowing all the PINs flowing through a switch would be of any help. How would the attacker know which account number the PIN corresponds to, i.e, which account to withdraw the money from.<br />
(A previous post also wondered similarly about the practicality of this weakness.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47547">

			<div class="comment by-mark-linton ">

				<p class="commentcredit">

					<span class="commenter">Mark Linton</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47547">
						December 6, 2006 12:09 PM					</a>

				</p>

				<p>Within the threat model section of the paper, it discusses the attacker requirements.  I have the following question related to this information.</p>
<p>By requiring logical access to the attacked facility, does this describe the requirement of the attacker to interact with the HSM through the APIs?  If so, what are the typical interaction methods (i.e. what interfaces are normally available/used, and what&#8217;s required for their interaction?)</p>
<p>To combat these requirements, what compensating controls would be most effective at limiting the methods of interactions to only authorized components?</p>
<p>Thanks.</p>
<p>Very interesting paper and discussion by the way&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47548">

			<div class="comment by-michael-mckay ">

				<p class="commentcredit">

					<span class="commenter">Michael McKay</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47548">
						December 7, 2006 12:33 AM					</a>

				</p>

				<p>@Mohit &#8211; The PINS are associated with a &#8220;PAN&#8221; (Primary Account Number).  At one point the PAN might have actually been the customer&#8217;s account number, but mostly now the PAN is effectively a unique number that corresponds the magnetic card itself.  The PAN has a many-to-many relationship with actual account numbers (e.g. one card may access multiple accounts, and an account many have multiple cards).  During most of the transaction, the PAN is the primary identifier, it is only when it reaches the issuer host that it becomes associated with an account.  In practical terms, knowing the PAN is good enough to mount an attack.</p>
<p>@Mark Linton &#8211; Most financial HSMs are now attached through TCP/IP, usually on a private sub-net.  Historically I think virtually every type of computer connection has been used in the past &#8211; Asynch, BiSynch, IBM and Tandem channel attached, PCMCIA, SCSI, PCI, etc. (USB is the only mode I&#8217;m pretty sure has not been used, although there are non-financial HSMs that use it).</p>
<p>The attacks definitely require some type of interactive communication with the HSM, so controlling that carefully is a mitigation measure.  Some of this gets into the &#8220;just how rogue is the switch&#8221;.  A purely bogus switch would not bother with this attack method, and just use their knowledge of the cryptographic master keys to directly recover the PINS.   So this type of attack could occur at a &#8220;careless switch&#8221;, which has not disabled unneeded commands and allows communication access to the HSM.</p>
<p>I have not read the MSNBC article all the way through yet, but I&#8217;m quoted as saying that the problem is worrisome.  This is correct as far as it goes, but I gave a lot of qualifiers first before I allowed that it would become worrisome.    For instance, the PIN Translate feature has to support ISO Format 1/2 PIN Blocks, something that most HSMs do not by default support.  So it does become worrisome, when a HSM is configured to support both of these weak commands, and is being operated by a careless switch.</p>
<p>As Thomas Brandtstaetter points out, there are easier places to attack.  Some are much easier!  The difference is that these are mostly done by issuing institutions, and flaws here only effect their own customers.  What made this attack interesting was the potential for a careless switch to jeopardize multiple institutions (although I guess this really is just a shade of gray, since poorly handled master keys could have the same effect).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-47549">

			<div class="comment by-thomas-brandtstaetter ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.synargos.com' rel='external nofollow ugc' class='url'>Thomas Brandtstaetter</a></span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47549">
						December 13, 2006 3:37 AM					</a>

				</p>

				<p>@ Michael McKay &#8211; is it possible, that we discuss a few points off-topic via email?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-47554">

			<div class="comment by-mofat ">

				<p class="commentcredit">

					<span class="commenter">mofat</span> •

					<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/#comment-47554">
						January 30, 2009 5:15 AM					</a>

				</p>

				<p>i want to know more about how to hack a pin code of a bank card or to hack into an acc on the internet</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2006/11/attacking_bankc.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2006/11/attacking_bankc.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2006%2F11%2Fattacking_bankc.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2006/11/attacking_bankc.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='1237' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2006/11/more_voting_lin.html" rel="prev">← More Voting Links</a>		<a href="https://www.schneier.com/blog/archives/2006/11/uk_rfid_passpor.html" rel="next">UK RFID Passport Cracked →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
