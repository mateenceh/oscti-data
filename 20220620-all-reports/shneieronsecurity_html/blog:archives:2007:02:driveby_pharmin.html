<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Drive-By Pharming - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Drive-By Pharming Comments Feed" href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/1398" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=1398' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2007%2F02%2Fdriveby_pharmin.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2007%2F02%2Fdriveby_pharmin.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-1398 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-1398" class="post-1398 post type-post status-publish format-standard hentry category-uncategorized tag-dns tag-hacking tag-hardware tag-malware tag-man-in-the-middle-attacks tag-network-security tag-web tag-wi-fi tag-wireless">

	<div class="article">

		<h2 class="entry">Drive-By Pharming</h2>
		<p>Sid Stamm, Zulfikar Ramzan, and Markus Jakobsson have developed a clever, and potentially devastating, attack against home routers.</p>
<p>First, the attacker creates a web page containing a simple piece of malicious JavaScript code.  When the page is viewed, the code makes a login attempt into the user&#8217;s home broadband router, and then attempts to change its DNS server settings to point to an attacker-controlled DNS server.  Once the user&#8217;s machine receives the updated DNS settings from the router (after the machine is rebooted) future DNS requests are made to and resolved by the attacker&#8217;s DNS server.</p>
<p>And then the attacker basically owns the victim&#8217;s web connection.</p>
<p>The main condition for the attack to be successful is that the attacker can guess the router password.  This is surprisingly easy, since home routers come with a default password that is uniform and often never changed.</p>
<p>They&#8217;ve written proof of concept code that can successfully carry out the steps of the attack on Linksys, D-Link, and NETGEAR home routers.  If users change their home broadband router passwords to something difficult to guess, they are safe from this attack.</p>
<p>Additional details (as well as a nifty flash animation illustrating it) can be found <a href="http://www.symantec.com/enterprise/security_response/weblog/2007/02/driveby_pharming_how_clicking_1.html">here</a>. There&#8217;s also a <a href="http://www.symantec.com/avcenter/reference/Driveby_Pharming.pdf">paper</a> on the attack.  And there&#8217;s a <a href="http://it.slashdot.org/article.pl?sid=07/02/16/1421238">Slashdot thread</a>.</p>
<p>Cisco says that <a href="http://www.computerworld.com/action/article.do?command=viewArticleBasic&#038;articleId=9011588&#038;intsrc=hm_list">77 of its routers</a> are vulnerable.</p>
<p>Note that the attack does not require the user to download any malicious software; simply viewing a web page with the malicious JavaScript code is enough.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/dns/" rel="tag">DNS</a>, <a href="https://www.schneier.com/tag/hacking/" rel="tag">hacking</a>, <a href="https://www.schneier.com/tag/hardware/" rel="tag">hardware</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/man-in-the-middle-attacks/" rel="tag">man-in-the-middle attacks</a>, <a href="https://www.schneier.com/tag/network-security/" rel="tag">network security</a>, <a href="https://www.schneier.com/tag/web/" rel="tag">web</a>, <a href="https://www.schneier.com/tag/wi-fi/" rel="tag">Wi-Fi</a>, <a href="https://www.schneier.com/tag/wireless/" rel="tag">wireless</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html" rel="bookmark">Posted on February 22, 2007 at 12:40 PM</a>			•
			<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html#comments">78 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html" data-title="Drive-By Pharming" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-54593">

			<div class="comment by-surprised ">

				<p class="commentcredit">

					<span class="commenter">Surprised</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54593">
						February 22, 2007 1:14 PM					</a>

				</p>

				<p>&#8220;This is surprisingly easy, since home routers come with a default password that is uniform and often never changed.&#8221;</p>
<p>Since when is user stupidity a surprise? Software/hardware developers should expect it already.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54594">

			<div class="comment by-michael-ash ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.mikeash.com' rel='external nofollow ugc' class='url'>Michael Ash</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54594">
						February 22, 2007 1:19 PM					</a>

				</p>

				<p>It has long been standard security practice that when logging in to a new system with a default password, the first required step is to have the user create a new password. If routers did this and refused to function until a customized password was set, none of these problems would occur.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54595">

			<div class="comment by-jp ">

				<p class="commentcredit">

					<span class="commenter">JP</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54595">
						February 22, 2007 1:19 PM					</a>

				</p>

				<p>It seems like having remote/WAN administration turned off (the default setting on my Netgear router iirc) would prevent this, even if you kept the password.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54596">

			<div class="comment by-janantha ">

				<p class="commentcredit">

					<span class="commenter">janantha</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54596">
						February 22, 2007 1:25 PM					</a>

				</p>

				<p>All though how many cautions the router company&#8217;s provide to change the default password some people simply don&#8217;t care about it. They always think &#8220;who is going to hack on to my wireless network&#8221; well they are wrong.! Therefore the best solution is if the company&#8217;s which manufactures the routers truly care about the users security they should put a random password strings before release of the product instead of the default password. To further nail down the physical security of the password it self, it could be hidden inside a scratchable silver coating. With the present problem i think thats the most practically solution to the problem.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54597">

			<div class="comment by-andre-leplume ">

				<p class="commentcredit">

					<span class="commenter">Andre LePlume</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54597">
						February 22, 2007 1:28 PM					</a>

				</p>

				<p>I take it this is clever because the attack code is execute within the (meager) perimeter?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54598">

			<div class="comment by-ac ">

				<p class="commentcredit">

					<span class="commenter">ac</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54598">
						February 22, 2007 1:35 PM					</a>

				</p>

				<p>@JP</p>
<p>No, disabling WAN administration does not block this attack.  The vector for the attack is your own PC.  However, enabling WAN administration on a router with the default password would certainly increase your vulnerability, and to much less sophisticated attacks than this one.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54599">

			<div class="comment by-george ">

				<p class="commentcredit">

					<span class="commenter">george</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54599">
						February 22, 2007 1:38 PM					</a>

				</p>

				<p>I can think of how many times I have changed my password for my broadband router.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54600">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">Chris</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54600">
						February 22, 2007 1:43 PM					</a>

				</p>

				<p>New home router advert:</p>
<p>&#8220;Proven to be as secure in the default configuration as an ATM!&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54601">

			<div class="comment by-michael-t ">

				<p class="commentcredit">

					<span class="commenter">Michael T</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54601">
						February 22, 2007 1:45 PM					</a>

				</p>

				<p>The router box I have in my hand at the moment has the router MAC address printed on a label and affixed to the box.</p>
<p>Assume the MAC is unique; it should be.</p>
<p>To do this, every individual router must be programmed differently (to have a different MAC) and must be tracked from programming to boxing (to get the right sticker on the right box) and has a one-off printed sticker.</p>
<p>Given that these systems are in place, why couldn&#8217;t they be co-opted to program each router with a different default password and put it on a sticker on the box?</p>
<p>Michael</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54602">

			<div class="comment by-dan ">

				<p class="commentcredit">

					<span class="commenter">Dan</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54602">
						February 22, 2007 1:51 PM					</a>

				</p>

				<p>IMHO, generating random passwords and packing them with routers before shipping would add cost and complexity to the production process, regardless of whatever other per-unit configuration was already being performed. It&#8217;s not necessarily a no-brainer.</p>
<p>And, for that matter, routers would still <em>have</em> to revert to a default password after a hardware reset.</p>
<p>Also, the attack isn&#8217;t a matter of Javascript being improperly &#8216;sandboxed&#8217; &#8211; after all, you have to allow active web pages to inititate network communication in many instances.</p>
<p>Sticky problem.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54603">

			<div class="comment by-dragonfrog ">

				<p class="commentcredit">

					<span class="commenter">dragonfrog</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54603">
						February 22, 2007 1:56 PM					</a>

				</p>

				<p>It gets better</p>
<p>Some ISPs (mine included) are now providing customers with 2Wire modem/router/WAPs.  These gizmos have a number of security properties that should scare the bejesus out of anyone.</p>
<p>Most relevant to this &#8211; the vast majority of changes require no password at all.  You can change the default password, but you&#8217;d be hard pressed to find a setting that requires you to enter it.</p>
<p>So, I can change such firewall and port forwarding options as it offers, as well as what DNS servers it uses, without entering my password.  And so, of course, can my browser&#8230;</p>
<p>As if that wasn&#8217;t bad enough, the things are actually under the ISP&#8217;s administrative control &#8211; their tech support folks can log in from &#8216;outside&#8217; my home network with, I&#8217;m sure, a global password that&#8217;s never changed, and change any setting I can, as well as some I can&#8217;t.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54604">

			<div class="comment by-dragonfrog ">

				<p class="commentcredit">

					<span class="commenter">dragonfrog</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54604">
						February 22, 2007 2:05 PM					</a>

				</p>

				<p>@Dan</p>
<p>The routers don&#8217;t have to revert to a <em>global</em> default password on a hard reset.  They could revert to using their own MAC address as a password, for example.  As Michael pointed out, that&#8217;s already on a label on the box.  Since people usually lose the box, it should also be on a label on the bottom of the router.</p>
<p>This would raise the bar to remote attackers somewhat.  The first three bytes of the MAC are vendor specific, but the last three should be essentially unpredictable, so there&#8217;s about 24 bits of randomness there.  I don&#8217;t know of any javascript interfaces to the ARP cache &#8211; anyone?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54605">

			<div class="comment by-kevin-way ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://blog.insidesystems.net/' rel='external nofollow ugc' class='url'>Kevin Way</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54605">
						February 22, 2007 2:15 PM					</a>

				</p>

				<p>&#8220;Since when is user stupidity a surprise? Software/hardware developers should expect it already.&#8221;</p>
<p>The user aren&#8217;t stupid, they are just regular people who assume that their purchases are reasonably well designed.</p>
<p>Being non-experts, this is a reasonable assumption to make, and it is developer error if it turns out to be incorrect.</p>
<p>Fortunately there are some units that are properly designed.  As an example, the Apple units are in a setup-only mode out of the box, and require an administrative password to be set prior to the unit providing a functional network connection.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54606">

			<div class="comment by-joshua ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://tobascodagama.com' rel='external nofollow ugc' class='url'>Joshua</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54606">
						February 22, 2007 2:26 PM					</a>

				</p>

				<p>Unfortunately, as long as turnkey deployment remains a huge selling point, smart default passwords on routers will not happen.</p>
<p>How many average users do you think even know their router <i>has</i> a password? They don&#8217;t have to, they just plug one end into their cable modem and the other into their computers. Or, if it&#8217;s wireless, they just pug one end into their cable modem and they&#8217;re done. That ease-of-use means more to that average user than not being PWNT. Unfortunately.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54607">

			<div class="comment by-paul-crowley ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.ciphergoth.org/' rel='external nofollow ugc' class='url'>Paul Crowley</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54607">
						February 22, 2007 2:26 PM					</a>

				</p>

				<p>I don&#8217;t understand why cross-site scripting restrictions don&#8217;t prevent this attack.  JavaScript code on site x is supposed to be sandboxed such that it can only connect to site x.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54608">

			<div class="comment by-blob11 ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://127.0.0.1' rel='external nofollow ugc' class='url'>BLOB[11]</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54608">
						February 22, 2007 2:37 PM					</a>

				</p>

				<p>The threat to be protected against here is fairly narrow.  Javascript doesn&#8217;t have the power to do extensive attacks against router login pages or do stuff like grab MAC addresses.  Trojans can do better, but there&#8217;s no need for a trojan to hijack a router when it can hijack the host system directly.  Designing routers to use their LAN-side MAC address as the default password is sufficient to defeat this threat.</p>
<p>Another way to defang Javascript router attacks would be to require router logins to correctly respond to a captcha as long as the default password is in place.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54609">

			<div class="comment by-paul-cantrell ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://innig.net' rel='external nofollow ugc' class='url'>Paul Cantrell</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54609">
						February 22, 2007 2:45 PM					</a>

				</p>

				<p>Using Javascript to create a LAN-based attack vector is nothing short of brilliant. Nicely done, you diabolical kids.</p>
<p>Notwithstanding the sheer stupidity of the routers having global default passwords, I wonder if this adds to the case for authenticated DNS?</p>
<p>I wonder &#8230; if the attacker wanted to spoof, say, my bank account, then could SSL be able to flag certificates for secure sites changing and/or being improperly signed?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54610">

			<div class="comment by-meeters ">

				<p class="commentcredit">

					<span class="commenter">meeters</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54610">
						February 22, 2007 3:05 PM					</a>

				</p>

				<p>Have a nice default first time password. Then have the router prompt for a required password change when it is first turned on or reset?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54611">

			<div class="comment by-keith-schuler ">

				<p class="commentcredit">

					<span class="commenter">Keith Schuler</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54611">
						February 22, 2007 3:10 PM					</a>

				</p>

				<p>Users are only &#8220;safe&#8221; from this attack in that the router DNS values can&#8217;t be changed if the password isn&#8217;t guessed. The user&#8217;s browser can still become a &#8220;browser zombie&#8221; if they don&#8217;t close the application&#8230; and therefore, still not &#8220;safe&#8221;!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54612">

			<div class="comment by-yakko ">

				<p class="commentcredit">

					<span class="commenter">Yakko</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54612">
						February 22, 2007 3:16 PM					</a>

				</p>

				<p>Not a fix for a lot of home users, but i use a linux box for my dhcp server and caching DNS. I don&#8217;t use the router&#8217;s settings. Then again I have pretty hard random passwords on my routers too.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54613">

			<div class="comment by-yakko ">

				<p class="commentcredit">

					<span class="commenter">Yakko</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54613">
						February 22, 2007 3:19 PM					</a>

				</p>

				<p>hmmm, Apple&#8217;s wireless routers are updated using a custom app and SNMP. I wonder if they&#8217;re vulnerable to a similar type attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54614">

			<div class="comment by-filias-cupio ">

				<p class="commentcredit">

					<span class="commenter">Filias Cupio</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54614">
						February 22, 2007 3:42 PM					</a>

				</p>

				<p>Finally a security problem where the appropriate solution is a yellow sticky note with the password scrawled on it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54615">

			<div class="comment by-sencer ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.sencer.de' rel='external nofollow ugc' class='url'>Sencer</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54615">
						February 22, 2007 3:51 PM					</a>

				</p>

				<p>THe attack is called &#8220;CSRF&#8221; Cross-Site Request-Forgeries. It&#8217;s been documented for several years, I remember stumbling on it myself 2-3 yars ago, and being very suprised that it doesn&#8217;t wider publicity &#8211; that has luckily changes in the past year. It&#8217;s not only routers, but all sorts of intranet-webapplications are open to this line of attack (especially when it&#8217;s standard-software, or someone has insider-knowledge; and users stay logged in for most for most of the time).</p>
<p>Those kind of attacks can be made considerably more difficult with one-time tokens in all forms and/or tokens as subdomains^1 etc.</p>
<p>[1] <a href="http://blog.php-security.org/archives/48-CSRF-protections-are-not-doomed-by-XSS.html" rel="nofollow ugc">http://blog.php-security.org/archives/48-CSRF-protections-are-not-doomed-by-XSS.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54616">

			<div class="comment by-aikimark ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://shunner.com' rel='external nofollow ugc' class='url'>aikimark</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54616">
						February 22, 2007 3:58 PM					</a>

				</p>

				<p>that is another reason to surf the web with mimimal trust and Java scripting disabled.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54617">

			<div class="comment by-chris-l ">

				<p class="commentcredit">

					<span class="commenter">Chris L</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54617">
						February 22, 2007 4:03 PM					</a>

				</p>

				<p>One reason this attack works is that many routers allow you to change their configuration with an HTTP GET request. And you can put a user name and password at the front of the URL. So any web page could have an &#8220;img&#8221; or &#8220;script&#8221; tag with a &#8220;src&#8221; URL that changes your router settings (instead of actually loading a script or image). This could be defeated (at least partially?) if they required HTTP POST &#8211; in which case the cross-site scripting restrictions would kick in. I hope this makes sense, maybe I&#8217;m wrong.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54618">

			<div class="comment by-sammy-the-surfer ">

				<p class="commentcredit">

					<span class="commenter">Sammy The Surfer</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54618">
						February 22, 2007 4:19 PM					</a>

				</p>

				<p>@Filias &#8211; Funniest comment in this thread. Bruce needs to update his article to include that as a solution.</p>
<p>It&#8217;s rather unfair to blame the users in this case.  Most non-techies will just unbox it, plug it in and turn it on.  They&#8217;re so easy to use that there is no configuration required, so why would a consumer even bother?  People don&#8217;t know about DNS, MAC Addresses or admin pages.  Or care, for that matter.  It&#8217;s all well and good to tie the admin password to the mac, or have a silver scratchy inside the box, but if the consumer never attempts to hit the admin page, then all that is useless.</p>
<p>What the router should do is present them with the admin page the very first time they try to get online and not let them out to the public internet until they&#8217;ve changed the admin password and maybe do some basic configuration.  It&#8217;s easy enough to have a short start-up wizard webpage, and since users are used to wizards in MS Office and other software, this shouldn&#8217;t be much different for them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54619">

			<div class="comment by-blair-nilsson ">

				<p class="commentcredit">

					<span class="commenter">Blair Nilsson</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54619">
						February 22, 2007 5:49 PM					</a>

				</p>

				<p>This is one of the situations that a captcha to log in would solve nicely.</p>
<p>The user doesn&#8217;t need to know the password. But the javascript attacker wouldn&#8217;t be able to solve it.</p>
<p>Just enough security, it&#8217;s likely not to stop other attacks though.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54620">

			<div class="comment by-metapundit ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://metapundit.net/sections/blog' rel='external nofollow ugc' class='url'>metapundit</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54620">
						February 22, 2007 6:08 PM					</a>

				</p>

				<p>Quick &#8211; giant-squid-blogging time&#8230;</p>
<p><a href="http://sfgate.com/cgi-bin/article.cgi?f=/n/a/2007/02/22/international/i012415S46.DTL" rel="nofollow ugc">http://sfgate.com/cgi-bin/article.cgi?f=/n/a/2007/02/22/international/i012415S46.DTL</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54621">

			<div class="comment by-matthew-skala ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://ansuz.sooke.bc.ca/bonobo-conspiracy/' rel='external nofollow ugc' class='url'>Matthew Skala</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54621">
						February 22, 2007 6:35 PM					</a>

				</p>

				<p>&#8220;Note that the attack does not require the user to download any malicious software; simply viewing a web page with the malicious JavaScript code is enough.&#8221;</p>
<p>Viewing a Web page with the malicious JavaScript code <em>is</em> downloading malicious software.  That&#8217;s the point.  Why do we still permit Web pages to contain executable code?  Why did we ever?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54622">

			<div class="comment by-laen ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.laen.org/' rel='external nofollow ugc' class='url'>Laen</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54622">
						February 22, 2007 6:36 PM					</a>

				</p>

				<p>..This is especially devious if you&#8217;ve recently logged into your router&#8217;s admin interface and your HTTP Auth attributes are saved.</p>
<p>This:<br />
&lt;a href=&#8221;http://192.168.0.1/action.cgi?do-something-devious&#8221;&gt; Free stuff!&lt;/a&gt;</p>
<p>Could do something devious without the user being any the wiser.</p>
<p>Why don&#8217;t we see more attacks based on browsers caching authentication details?</p>
<p>For example, a website could fire off a itty-bitty popup window that hits every single bank&#8217;s online-banking page for transferring money..  Or it could make some javascript XMLRPC calls to google to spam..</p>
<p>What would stop that?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54623">

			<div class="comment by-barry-kelly ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://barrkel.blogspot.com/' rel='external nofollow ugc' class='url'>Barry Kelly</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54623">
						February 22, 2007 6:54 PM					</a>

				</p>

				<p>Problem: in my experience, home routers regularly require resetting, whether due to cheap QC of firmware, or other reasons. And every reset clears the password. Eventually, you get bored of redoing the password every time.</p>
<p>Definitely, there needs to be a device-specific default password physically attached to the router.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54624">

			<div class="comment by-stephen ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.dranger.com' rel='external nofollow ugc' class='url'>Stephen</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54624">
						February 22, 2007 7:43 PM					</a>

				</p>

				<p>Another solution would be for the router to generate a unique token every time you load the configuration page. Then make it so changes can&#8217;t be made without that token. If remote JS attacks can still get around this, there are some serious browser XSS vulnerabilities that should be dealt with.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54625">

			<div class="comment by-pseudonymous ">

				<p class="commentcredit">

					<span class="commenter">Pseudonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54625">
						February 22, 2007 7:53 PM					</a>

				</p>

				<p>@Blair Nilsson<br />
&#8220;This is one of the situations that a captcha to log in would solve nicely. The user doesn&#8217;t need to know the password. But the javascript attacker wouldn&#8217;t be able to solve it.&#8221;</p>
<p>If only.</p>
<p>The JS can get the captcha image and send it to the attacker by encoding it into a GET.  The attacker decodes the data in the GET, posts an image to a web-server, and offshores a bunch of 3rd-world captcha-busters to do the work.</p>
<p>There are limits to the size of a GET URL, but there are no limits to what you can put in the GET request&#8217;s headers.  All you&#8217;d need is something that hex-encodes the raw image data.  Should be pretty simple, really.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54626">

			<div class="comment by-vincent ">

				<p class="commentcredit">

					<span class="commenter">Vincent</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54626">
						February 22, 2007 8:34 PM					</a>

				</p>

				<p>Another solution for the home user might be to stick a USB port on the side of the device, and and force the user to plug it into their computer to configure it.  No more configuration over the air seems like it solves this problem completely.  And IMNSHO if a home user has to fiddle with their router more then once, it&#8217;s a pice of unmitigated crap.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54627">

			<div class="comment by-mike ">

				<p class="commentcredit">

					<span class="commenter">Mike</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54627">
						February 22, 2007 9:16 PM					</a>

				</p>

				<p>This is way overblown.<br />
Javascript can&#8217;t execute this attack unless JAVA is enabled.<br />
Most users wisely have Java off.</p>
<p>If Java is on, then it&#8217;s usually &#8220;game over&#8221; anyway.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54628">

			<div class="comment by-bill ">

				<p class="commentcredit">

					<span class="commenter">Bill</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54628">
						February 22, 2007 10:40 PM					</a>

				</p>

				<p>What me worry? I&#8217;ve got a crappy Internet connection from NetZero. Just try and hijack it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54629">

			<div class="comment by-james-lick ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.jameslick.com/' rel='external nofollow ugc' class='url'>James Lick</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54629">
						February 23, 2007 12:00 AM					</a>

				</p>

				<p>@Mike: JAVA and JavaScript, despite the names, are completely different things.  And it is really not my experience that &#8216;most users&#8217; have turned off either one.  JavaScript is used by so many major sites these days that it makes it really hard to use the net without it.</p>
<p>As for the proposed solutions, using the MAC address as password only works so long as attackers are not able to obtain a MAC address.  As soon as they have that capability, then that approach fails too.</p>
<p>The proposed solution some others have made is pretty good though: disable the WAN port until the router configuration is completed <em>including</em> requiring the default password to be set.  Then you&#8217;d &#8216;never&#8217; have a router with a default password accessible to a net connected PC (well unless you have multiple routers involved or a PC already infected with a router-hacking trojan but those are less likely).</p>
<p>There have been a few comments asking what&#8217;s the point of compromising a router when a PC needs to be compromised in the process.  1) PCs are not left on all day by most users.  Routers typically are.  2) Most PCs have some kind of anti-virus or spyware protection, so an infection is more likely to be removed at some point.  Routers do not have such protections, and most people will not reset/replace them unless something seriously is wrong.  3) Most routers today are actually small general-purpose computers running Linux or some embedded OS like VxWorks, either of which is capable of having arbitrary software being installed on it.  It&#8217;s quite possible to install things like proxy servers, email redirectors and even lightweight web servers on them (people do this legitimately with things like OpenWRT or Sveasoft every day).  And once you have access to one you have a direct network connection, while a hacked PC behind a router is often only limited to outbound connections.</p>
<p>In summary, access to a router gets you a direct 24 hour connection to the net with less chance of detection of rogue software.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54630">

			<div class="comment by-supersnail ">

				<p class="commentcredit">

					<span class="commenter">supersnail</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54630">
						February 23, 2007 2:20 AM					</a>

				</p>

				<p>I think the real problem here is password fatigue.<br />
I am not particulary geeky outside of work and dont go in for a lot of high tech at home but I must remember:<br />
   3 windows XP passwords.<br />
   3 Suse linux passwords.<br />
   2 email account passwords.<br />
   6 Web site login passwords.<br />
   2 bank account passwords.<br />
   5 bank account related pin numbers.<br />
   3 Mobile phone pin codes.<br />
This is on top of 20 something regularly exoiring passwords at work (thankyou Bruce for password safe !).</p>
<p>So when I install a network router I have a choice. Do I change the password immedialtly and risk forgetting it? Or do I leave the device wide open?<br />
This becomes more of a dilema when installing a device for a friend or relative, do you change the password and hope they remember it?</p>
<p>This is actually an occasion where writing the password on a piece of paper and scotch taping it to the box is sensible security practice. (If the bad guys are in your house poking around your PC setup you&#8217;ve lost everyhing anyway!)</p>
<p>Perhaps the manufacturers (at least for home devices) could do this for us, randomly allocate a default password and stick a label with the password on the box.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54631">

			<div class="comment by-paeniteo ">

				<p class="commentcredit">

					<span class="commenter">Paeniteo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54631">
						February 23, 2007 2:25 AM					</a>

				</p>

				<p>@CrisL: &#8220;One reason this attack works is that many routers allow you to change their configuration with an HTTP GET request. &#8230; This could be defeated (at least partially?) if they required HTTP POST &#8211; in which case the cross-site scripting restrictions would kick in.&#8221;</p>
<p>You can use Javascript&#8217;s form.submit() method to submit POST-based forms.</p>
<p>I am not sure whether you can dynamically change the form&#8217;s destination-URL without a browser warning, but that is not necessary anyway (just let the form point to 192.168.2.1 from the beginning).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54632">

			<div class="comment by-tarkeel ">

				<p class="commentcredit">

					<span class="commenter">Tarkeel</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54632">
						February 23, 2007 2:30 AM					</a>

				</p>

				<p>@James Lick: Good points, but the main attack vector is probably fishing. By compromising the router, you can invisibly poison the DNS, and sending all requests for legitimate site URLs such as eBay and PayPal to your own custom site. Or you could just perform a man-in-the-middle attack on traffic that goes through. If done wisely, this will be undetectable to the user.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54633">

			<div class="comment by-paeniteo ">

				<p class="commentcredit">

					<span class="commenter">Paeniteo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54633">
						February 23, 2007 2:31 AM					</a>

				</p>

				<p>@James Lick: &#8220;JavaScript is used by so many major sites these days that it makes it really hard to use the net without it.&#8221;</p>
<p>Using Firefox with the NoScript extension, I can confirm the first part of your sentence but not the second one.</p>
<p>Many sites use Javascript, but with the big majority of these you will just experience a minor loss of convenience, if at all.</p>
<p>There are, however, some sites that seem to be unable to even put &#8220;Hello World&#8221; online without heavy scripting.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54634">

			<div class="comment by-ben-combee ">

				<p class="commentcredit">

					<span class="commenter">Ben Combee</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54634">
						February 23, 2007 3:51 AM					</a>

				</p>

				<p>I don&#8217;t think Java is needed for this attack&#8230; if you&#8217;re going after the dumb users who plug-and-play their routers, then you can fairly reliably guess what the subnet is using the defaults provided by the router.  You could probably hard code scans for 10.0.0.1, 192.168.0.1, and 192.168.1.1 and get enough hits for this hack to be worth doing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54635">

			<div class="comment by-ben-smyth ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.cs.bham.ac.uk/~bas/' rel='external nofollow ugc' class='url'>Ben Smyth</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54635">
						February 23, 2007 5:42 AM					</a>

				</p>

				<p>Continuing from Pseudonymous<br />
Free porn&#8230;. Offer free porn and require the users to submit a captcha.</p>
<p>@Ben Combee<br />
Java is not needed. &#8220;dumb users who plug-and-play their routers, then you can fairly reliably guess what the subnet is using the defaults provided by the router.&#8221; Not just dumb users! I personally always use the default subnet, why shouldn&#8217;t I? (Security by obscurity?)</p>
<p>It also makes telephone support (generally from friends and family) far easier &#8211; type 192.168.0.1 into the Internet. Note the deliberate use of <code>Internet' as opposed to</code>browser&#8217;. Its far easier Start -&gt; Run -&gt; cmd  -&gt; ipconfig /all  now tell me what&#8217;s there.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54636">

			<div class="comment by-salmon ">

				<p class="commentcredit">

					<span class="commenter">Salmon</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54636">
						February 23, 2007 5:44 AM					</a>

				</p>

				<p>I think one of the problems with a unique password for each device is that it would require something that able to survive firmware flashings, which would presumably drive up the cost. An idea would be to just use the MAC address as the default password. Not ideal, but better than the default password of &#8220;password&#8221; on my router.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54637">

			<div class="comment by-leonerd ">

				<p class="commentcredit">

					<span class="commenter">LeoNerd</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54637">
						February 23, 2007 5:54 AM					</a>

				</p>

				<p>&#8220;Perhaps the manufacturers (at least for home devices) could do this for us, randomly allocate a default password and stick a label with the password on the box.&#8221;</p>
<p>I don&#8217;t know about the US, but our dear friends BT already do that with at least some of their wireless home router kit. My parents&#8217; one, for example, has its password on a sticker on the bottom, right next to its MAC address.</p>
<p>Surely if someone like BT can do it, the likes of DLink/LinkSys/Belkin/&#8230; can?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54638">

			<div class="comment by-paeniteo ">

				<p class="commentcredit">

					<span class="commenter">Paeniteo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54638">
						February 23, 2007 6:57 AM					</a>

				</p>

				<p>@Ben Smyth: &#8220;It also makes telephone support (generally from friends and family) far easier &#8211; type 192.168.0.1 into the Internet.&#8221;</p>
<p>It is even simpler than that: Most routers (in germany) have specialized DNS names reserved for them that work even if you change their default IP-configuration. As they are commonly used as DNS-proxies, that is trivial to implement.<br />
Mine, for example, runs at 192.168.99.99 and responds to the name &#8220;fritz.box&#8221; (and its IP).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54639">

			<div class="comment by-frank-wilhoit ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.broadheath.com' rel='external nofollow ugc' class='url'>Frank Wilhoit</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54639">
						February 23, 2007 6:57 AM					</a>

				</p>

				<p>paeniteo has it right.  NoScript blocks JavaScript by default but allows domains to be easily whitelisted for JavaScript execution on either a permanent or one-session basis.  This has been <em>far</em>and<em>away</em> the single most beneficial device I have ever adopted for blocking attacks of all kinds.  Any web site that <em>requires</em> JavaScript has to meet an extremely high burden of proof with me.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54640">

			<div class="comment by-guillaume ">

				<p class="commentcredit">

					<span class="commenter">Guillaume</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54640">
						February 23, 2007 8:06 AM					</a>

				</p>

				<p>It&#8217;s an old trick. IE, Firefox and Opera fixed it for regular URL a while ago.<br />
<a href="http://support.microsoft.com/kb/834489" rel="nofollow ugc">http://support.microsoft.com/kb/834489</a></p>
<p>This is a browser bug. RFC 2396 is pretty clear about this :</p>
<p>Some URL schemes use the format &#8220;user:password&#8221; in the userinfo field. This practice is NOT RECOMMENDED, because the passing of authentication information in clear text (such as URI) has proven to be a security risk in almost every case where it has been used.</p>
<p>Speaking of old news, that trick works with Flash too :<br />
<a href="http://www.webappsec.org/lists/websecurity/archive/2006-08/msg00001.html" rel="nofollow ugc">http://www.webappsec.org/lists/websecurity/archive/2006-08/msg00001.html</a></p>
<p>+A hijacked banking site will display an untrusted certificate warning. Unfortunatly, users who don&#8217;t care/know how to change default password will have no idea what this pop-up is about.</p>
<p>If Symantec wanted to do more than product selling FUD , it should have showed that pop-up in their fancy animation&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54641">

			<div class="comment by-james-lick ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.jameslick.com/' rel='external nofollow ugc' class='url'>James Lick</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54641">
						February 23, 2007 8:16 AM					</a>

				</p>

				<p>Salmon: Routers these days are typically designed for separate storage of configuration settings (often incorrectly called &#8216;nvram&#8217; settings even though they are usually in flash) and firmware.  Updating firmware usually doesn&#8217;t result in configuration changes being lost, only a &#8216;reset to defaults&#8217; would.  If you used a &#8216;WAN disabled until password set&#8217; design then it really doesn&#8217;t matter in either case.</p>
<p>The comments about using the NoScript plugin are all fine and good, but the average user just wants to have Gmail work without having to twiddle with things.  Until such functionality is available by default in the majority of user&#8217;s browsers, it is of limited value as a general security mechanism.</p>
<p>The type of  person who doesn&#8217;t know or care about putting a password on his router is rather unlikely to know or care about controlling how JavaScript is configured on his computer.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54642">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">bob</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54642">
						February 23, 2007 10:20 AM					</a>

				</p>

				<p>@supersnail: and dont forget to mention that at least half of those passwords are forced to be changed on differing timelines, have to conform to differing criteria and cannot be used again for n tries.</p>
<p>Safe combinations come from the factory set to 0-50-0. I wonder how many operational ATMs can still be opened this way.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54643">

			<div class="comment by-fenris-fox ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://fenrisfox.blogspot.com' rel='external nofollow ugc' class='url'>Fenris Fox</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54643">
						February 23, 2007 10:27 AM					</a>

				</p>

				<p>Two minutes of basic due diligence would take care of this attack&#8230;</p>
<p>But since when can that be expected of the popcorn-faring masses?</p>
<p>/ Uses Firefox on all machines with NoScript.<br />
// Has Linux on his personal machine.<br />
/// Has his router locked down like Fort Knox.<br />
//// Slashies! =:o)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54644">

			<div class="comment by-tanj ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://grok-security.blogspot.com' rel='external nofollow ugc' class='url'>tanj</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54644">
						February 23, 2007 10:47 AM					</a>

				</p>

				<p>We (the security/IT industry) have no excuse for pushing this problem onto the users.  We are behaving like the auto industry before the publication of &#8220;unsafe at any speed.&#8221;</p>
<p>It&#8217;s time the router manufactures stepped up and installed some safety in their devices.  I especially like the comment pointing out that some folks are going in the direction of not requiring any authentication.  I wonder if an ISP is smart enough to install a client-side certificate for secure admin access to a CPE device&#8230;</p>
<p>I blogged on this, here <a href="http://grok-security.blogspot.com/2007/02/i-hate-passwords-12.html" rel="nofollow ugc">http://grok-security.blogspot.com/2007/02/i-hate-passwords-12.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54645">

			<div class="comment by-jake-reynolds ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.fishnetsecurity.com' rel='external nofollow ugc' class='url'>Jake Reynolds</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54645">
						February 23, 2007 11:08 AM					</a>

				</p>

				<p>This is just a sexy name for XSRF (cross-site request forgery) a subtype of script injection attacks. Jeremiah Grossman and RSnake have also been talking about port-scanning and exploiting internal devices using script injection for a quite a while now.</p>
<p><a href="http://www.blackhat.com/html/bh-usa-06/bh-usa-06-speakers.html#Grossman" rel="nofollow ugc">http://www.blackhat.com/html/bh-usa-06/bh-usa-06-speakers.html#Grossman</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54646">

			<div class="comment by-steve-parker ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://steve-parker.org/' rel='external nofollow ugc' class='url'>Steve Parker</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54646">
						February 23, 2007 12:08 PM					</a>

				</p>

				<p>It&#8217;s easier than that if you&#8217;re a UK Sky Broadband customer:</p>
<p><a href="http://steve-parker.org/urandom/?y=2007&amp;m=02#netgear" rel="nofollow ugc">http://steve-parker.org/urandom/?y=2007&#038;m=02#netgear</a></p>
<p>No JavaScript required. And even if the user has changed their admin password, a &#8220;sky-branded&#8221; phishing attack would easily be able to convince a user to enter their Sky router&#8217;s password.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54647">

			<div class="comment by-kashmarek ">

				<p class="commentcredit">

					<span class="commenter">kashmarek</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54647">
						February 23, 2007 12:49 PM					</a>

				</p>

				<p>Nobody mentioned the router userid.  Change it!  Most are blank from the factory.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54648">

			<div class="comment by-gsm ">

				<p class="commentcredit">

					<span class="commenter">GSM</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54648">
						February 23, 2007 1:09 PM					</a>

				</p>

				<p>Am I right to assume that entering the IP address instead of the URL would defeat this attack?</p>
<p>The only problem seems to be that when I replace the domain name with IP with the domain name, the page doesn&#8217;t load correctly.  (This is clearly beyond my level of expertise.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54649">

			<div class="comment by-kiwano ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://unripe.melon.org/' rel='external nofollow ugc' class='url'>kiwano</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54649">
						February 23, 2007 1:14 PM					</a>

				</p>

				<p>When I read &#8220;drive-by&#8221;, I thought of performing a similar DNS redirection attack as a wardriver. While not particularly useful as a bulk attack, it could still be valuable for targetted attacks (like hitting a wealthy neighbourhood).</p>
<p>In such a case, using the MAC address of the router as a default password would not be adequate security, since it&#8217;s pretty plainly visible to a wardriver. I&#8217;d go with the first passwording suggestion that the router doesn&#8217;t work until you&#8217;ve set/changed the password to a non-default.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54650">

			<div class="comment by-aarrgghh ">

				<p class="commentcredit">

					<span class="commenter">aarrgghh</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54650">
						February 23, 2007 1:57 PM					</a>

				</p>

				<p>I&#8217;ve seen a similiar Unix attack vector over 15 years ago.  The HP terminals at our Univerisity had escape codes that allowed you to request a section of the screen to be sent back.  If you could write to another persons terminal for a 1/2 second, you could display a command and then have it sent as the user using the terminal.  They were aware of the issue but were waiting on a new ROM chip to fix it.  (Most people had their .cshrc lock the tty, but there was always a small timing window after logon).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54651">

			<div class="comment by-mikea ">

				<p class="commentcredit">

					<span class="commenter">MikeA</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54651">
						February 23, 2007 2:04 PM					</a>

				</p>

				<p>Perhaps I just live in a hyperspatial data vortex, and the following <em>only</em> happens to me, but nobody seems to have mentioned that some (well, two of mine, from two vendors) routers change their passwords with no input from me. That is, I go to do some maintenance and notice that the box responds to neither the password I set (and wrote on a sticky-note) nor the password I get back to by giving it the Vulcan Death Grip. Since I never enable WAN administration and only enable Wireless when I&#8217;m using it, (OK, just 40-bit WEP, but even the non-wireless Linksys does this) I am at a loss to explain it. Random bugs or a vendors &#8220;Secure by obscurity&#8221; alt-default?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54652">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">bob</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54652">
						February 23, 2007 3:39 PM					</a>

				</p>

				<p>@Stephen<br />
&#8220;Another solution would be for the router to generate a unique token every time you load the configuration page. Then make it so changes can&#8217;t be made without that token.&#8221;</p>
<p>Exactly how does the legitimate user learn the token&#8217;s value?  If the user can&#8217;t provide the token, the router refuses reconfig.  But if the router can&#8217;t tell the user what to enter, using a safe channel, then the router can never be reconfigured.</p>
<p>Safe?  Yes.  Useful?  Not so much.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54653">

			<div class="comment by-roger ">

				<p class="commentcredit">

					<span class="commenter">Roger</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54653">
						February 23, 2007 10:42 PM					</a>

				</p>

				<p>@Dan, paenito, Frank Wilhoit, James Lick:</p>
<p>I have to endorse the comments that Javascript is not at all essential, in fact is easily disabled. I have been using Noscript for more than a year now, and there are only about 5 or 6 sites where I find I want to whitelist Javascript. Not only that, but I&#8217;ve become a bit more aware of what sites are actually doing with their JS. At least 90% of Javascript scripts are just doing hitbox style user tracking. Disabling them has NO EFFECT whatsoever on the user exerience, except that the site oftens runs a little faster and is more reliable during times of congestion. Plus, of course, it protects my privacy.</p>
<p>And about 90% of the remainder is useless frippery. Disabling those generally stops things sliding about on the screen so much, which makes it easier to read the actual content, which is generally totally unaltered.</p>
<p>It&#8217;s true that it is too much to expect home users to configure NoScript. However a perfectly acceptable default configuration to give to firends, colleagues and relatives would be Firefox with Noscript installed and a list of about a dozen sites pre-whitelisted for them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54654">

			<div class="comment by-roger ">

				<p class="commentcredit">

					<span class="commenter">Roger</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54654">
						February 24, 2007 5:36 AM					</a>

				</p>

				<p>@Paul Crowley:<br />
&#8220;I don&#8217;t understand why cross-site scripting restrictions don&#8217;t prevent this attack.&#8221;</p>
<p>What cross site scripting restrictions? XSS remains a serious attack vector with no general solution apart from asking web-designers to be more security conscious. There is a feature in some recent browsers which makes it harder for a malicious script to snarf a cookie, but that doesn&#8217;t apply here.</p>
<p>&#8220;JavaScript code on site x is supposed to be sandboxed such that it can only connect to site x.&#8221;</p>
<p>Erm, aren&#8217;t you thinking of Java? There is nothing to stop your Javascript saying document.write(&#8220;&lt;img src=&#8217;http://whatever.you.want&#8217;&gt;&#8221;)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54655">

			<div class="comment by-andreas ">

				<p class="commentcredit">

					<span class="commenter">Andreas</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54655">
						February 24, 2007 12:12 PM					</a>

				</p>

				<p>Changing the password is not enough! The browser should be restarted every time the configuration page has been opened, because from then on the router can be accessed without a password. And never tick the &#8220;memorize password&#8221; box. The attacker does need a password any more because the browser will willingly deliver it. This is also true with your bank &#8211; an attacker could access your bank account with javascript (no router needed).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54656">

			<div class="comment by-mik ">

				<p class="commentcredit">

					<span class="commenter">Mik</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54656">
						February 24, 2007 3:22 PM					</a>

				</p>

				<p>Pay attention kiddies.<br />
THERE IS ABSOLUTELY NO WAY FOR JAVASCRIPT TO DO THIS.</p>
<p>If you read the white paper, they even acknowledge it.</p>
<p>The only, half-arse, demo uses javascript to call JAVA (not the same thing).  Java is the only way to get the needed network info (besides active-X).</p>
<p>Leave JS on all day.  As long as JAVA is off, you&#8217;re safe.<br />
If java is on, chances are your machine will be compromised by a more conventional  attack first.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54657">

			<div class="comment by-andreas ">

				<p class="commentcredit">

					<span class="commenter">Andreas</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54657">
						February 24, 2007 5:39 PM					</a>

				</p>

				<p>Javascript alone is enough for a serious attack. There are not so many possibilities for a router address, many use 192.168.1.1 or 192.168.0.1, so that is already a good bet, no need of Java for this.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54658">

			<div class="comment by-andreas ">

				<p class="commentcredit">

					<span class="commenter">Andreas</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54658">
						February 24, 2007 9:19 PM					</a>

				</p>

				<p>For example, visiting a website with the following code will change the dns1 entry of a TRENDnet TRW-432BRP router:</p>
<p>&lt;script src =<br />
&#8220;http://admin:admin@192.168.1.1/wan_poe.cgi?dns1=204.101.251.1&#8221;&gt;<br />
&lt;/script&gt;</p>
<p>It&#8217;s that simple.<br />
Write  a few more of these for the most popular routers, and off you go, no JAVA needed.</p>
<p>It is really a miracle that no-one had thought of this before.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54659">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54659">
						February 24, 2007 11:38 PM					</a>

				</p>

				<p>@Mik</p>
<p>The Java applet doesn&#8217;t appear to play a critical role.  All it does is ascertain the LAN-local IP address, in order to determine where to start scanning for routers.  The JavaScript performs the scan that finds the router.</p>
<p>If the JS can simply guess at several plausible local IP addresses, it can accept failure.  This takes longer, so the page the user is reading has to be more engaging, so the user tarries longer.  This does not seem an insurmountable obstacle.</p>
<p>So I would say that even with Java disabled, JS alone can mount such an attack.  In fact, it seems so easy, I may try to whip this up over the weekend, using JS alone.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54660">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54660">
						February 24, 2007 11:42 PM					</a>

				</p>

				<p>@Mike</p>
<blockquote><p>
  Most users wisely have Java off.
</p></blockquote>
<p>The paper says 90% of home users have Java enabled.<br />
YOU may have Java off, but YOU may not be &#8220;most users.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54661">

			<div class="comment by-werner ">

				<p class="commentcredit">

					<span class="commenter">Werner</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54661">
						February 25, 2007 4:27 AM					</a>

				</p>

				<p>Mixing up data with programs is the real problem.<br />
Browsing webservers for information of any kind is the most important use of the internet, for many private computer owners it is the most important use of their computer. Forcing them to download prgrams together with the information, knowing they have no change to proof these programs, most time without them knowing of it, this is the real malicious attack.<br />
As mentioned by others, most of Java Script is completely useless and it only exists because of the stupidity of the web designer. For the rest, it is  mostly useless for the user, but of value for the provider of the webside. For the very few java scripts that do something usefull for the user, there are better solutions with far less security risks.<br />
I wonder what all these people defending us against cross site scripting and all these complicated things would do, if they had not created the problem in the first place.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54662">

			<div class="comment by-andreas ">

				<p class="commentcredit">

					<span class="commenter">Andreas</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54662">
						February 25, 2007 9:15 AM					</a>

				</p>

				<p>One of the problems is that browsers issue HTTP authentification without warning. Firefox sends the warining:</p>
<p>Confirm<br />
You are about to log into the site &#8220;192.168.1.1&#8221; with the username &#8220;admin&#8221;<br />
Cancel/OK</p>
<p>but not if the page is accessed via a &lt;script&gt; tag. Safari never issues such a warning. (I don&#8217;t know about IE). The browser programmers could do a better job to prevent this kind of intrusion.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54663">

			<div class="comment by-andreas ">

				<p class="commentcredit">

					<span class="commenter">Andreas</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54663">
						February 25, 2007 10:21 AM					</a>

				</p>

				<p>The same (no warning) occurs with other tags that have a src= attribute.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54664">

			<div class="comment by-andreas ">

				<p class="commentcredit">

					<span class="commenter">Andreas</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54664">
						February 25, 2007 10:55 AM					</a>

				</p>

				<p>On <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=371598," rel="nofollow ugc"></a><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=371598" rel="nofollow ugc">https://bugzilla.mozilla.org/show_bug.cgi?id=371598</a>, bob wrote:</p>
<p>&lt;img<br />
src=http://192.168.1.1/cgi-bin/setup_dns.exe?page=setup_dns&amp;logout=&amp;dns1_1=208&amp;dns1_2=67&amp;dns1_3=222&amp;dns1_4=222&amp;dns2_1=208&amp;dns2_2=67&amp;dns2_3=220&amp;dns2_4=220&gt;</p>
<p>this sets, on a philips router, the dns servers to opendns.org without a password<br />
(end of quote)<br />
This is an unacceptable and irresponsible security risk that leaves the user absolutely defenseless: changing the router password does not help here.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54665">

			<div class="comment by-andreas ">

				<p class="commentcredit">

					<span class="commenter">Andreas</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54665">
						February 25, 2007 5:12 PM					</a>

				</p>

				<p>Philips has fixed this problem in a recent firmware update. However, there might be other routers that behave that way.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54666">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54666">
						February 25, 2007 10:42 PM					</a>

				</p>

				<p>&#8220;I don&#8217;t know of any javascript interfaces to the ARP cache &#8211; anyone?&#8221;</p>
<p>I don&#8217;t know javascript so instead I have to wait for the next arbitrary-code bug in an image file parser.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54667">

			<div class="comment by-ian-ringrose ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.ringrose.name' rel='external nofollow ugc' class='url'>Ian Ringrose</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54667">
						February 26, 2007 7:54 AM					</a>

				</p>

				<p>What about a <em>physical</em> button on the device that has to be pressed within 2 minutes of making a configuration change, so as to confirm the change.  The config web pages could tell the user to press the button after saving the change, so stopping most automated attacks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54668">

			<div class="comment by-doodle ">

				<p class="commentcredit">

					<span class="commenter">Doodle</span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54668">
						February 26, 2007 1:31 PM					</a>

				</p>

				<p>@Ian: That is too cumbersome.</p>
<p>I think the easiest idea to implement here is to just require the user to change the default password by a prompt that says &#8220;Pick a password to allow administration of the router.&#8221; That way we have circumvented the entire issue.</p>
<p>The main issue here is the fact that they have default passwords, which in most situations, are required to be changed. Fix the default password problem, and (most) other drive-by pharming related problems go away.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-54669">

			<div class="comment by-rockport ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://rockport3.blogspot.com' rel='external nofollow ugc' class='url'>Rockport</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54669">
						March 27, 2007 4:39 PM					</a>

				</p>

				<p>Just stop by to say that there is a lot of ways of killing rabits. The security field ain&#8217;t out too</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-54670">

			<div class="comment by-deepunp ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.' rel='external nofollow ugc' class='url'>deepunp</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/#comment-54670">
						August 23, 2007 3:45 AM					</a>

				</p>

				<p>hai this is deepu my  domain is system administrator in in company i want know without using third party tool how to reset the administrator password useing lan connection</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2007/02/driveby_pharmin.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2007/02/driveby_pharmin.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2007%2F02%2Fdriveby_pharmin.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2007/02/driveby_pharmin.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='1398' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2007/02/cya_security_1.html" rel="prev">← CYA Security</a>		<a href="https://www.schneier.com/blog/archives/2007/02/us_terrorism_ar.html" rel="next">U.S Terrorism Arrests/Convictions Significantly Overstated →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
