<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>JavaScript Hijacking - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; JavaScript Hijacking Comments Feed" href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/1485" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=1485' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2007%2F04%2Fjavascript_hija_1.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2007%2F04%2Fjavascript_hija_1.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-1485 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-1485" class="post-1485 post type-post status-publish format-standard hentry category-uncategorized tag-computer-security tag-mitigation tag-privacy tag-web tag-web-privacy">

	<div class="article">

		<h2 class="entry">JavaScript Hijacking</h2>
		<p>Interesting <a href="http://www.fortifysoftware.com/servlet/downloads/public/JavaScript_Hijacking.pdf">paper</a> on JavaScript Hijacking: a new type of eavesdropping attack against Ajax-style Web applications.  I&#8217;m pretty sure it&#8217;s the first type of attack that specifically targets Ajax code.  The attack is possible because Web browsers don&#8217;t protect JavaScript the same way they protect HTML; if a Web application transfers confidential data using messages written in JavaScript, in some cases the messages can be read by an attacker.</p>
<p>The authors show that many popular Ajax programming frameworks do nothing to prevent JavaScript hijacking.  Some actually <i>require</i> a programmer to create a vulnerable server in order to function.</p>
<p>Like so many of these sorts of vulnerabilities, preventing the class of attacks is easy.  In many cases, it requires just a few additional lines of code.  And like so many software security problems, programmers need to understand the security implications of their work so that they can mitigate the risks they face.  But my guess is that JavaScript hijacking won&#8217;t be solved so easily, because programmers don&#8217;t understand the security implications of their work and won&#8217;t prevent the attacks.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/computer-security/" rel="tag">computer security</a>, <a href="https://www.schneier.com/tag/mitigation/" rel="tag">mitigation</a>, <a href="https://www.schneier.com/tag/privacy/" rel="tag">privacy</a>, <a href="https://www.schneier.com/tag/web/" rel="tag">web</a>, <a href="https://www.schneier.com/tag/web-privacy/" rel="tag">web privacy</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html" rel="bookmark">Posted on April 2, 2007 at 3:45 PM</a>			•
			<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html#comments">64 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html" data-title="JavaScript Hijacking" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-57830">

			<div class="comment by-carmelo-lisciotto ">

				<p class="commentcredit">

					<span class="commenter">Carmelo Lisciotto</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57830">
						April 2, 2007 4:04 PM					</a>

				</p>

				<p>The System Administrators should be the ones concerned.</p>
<p>Carmelo Lisciotto</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57831">

			<div class="comment by-shawn-lauriat ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://frozen-o.com/blog/' rel='external nofollow ugc' class='url'>Shawn Lauriat</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57831">
						April 2, 2007 5:13 PM					</a>

				</p>

				<p>That doesn&#8217;t look new, that just looks like a specific usage of the data returned by a XSRF vulnerability, in order to more conveniently capture data the application already exposed in ways it shouldn&#8217;t.</p>
<p>In other words, it doesn&#8217;t really look like an attack, just a method to parse the results of an already successful CSRF attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57832">

			<div class="comment by-pdp ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.gnucitizen.org' rel='external nofollow ugc' class='url'>pdp</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57832">
						April 2, 2007 5:18 PM					</a>

				</p>

				<p>IMHO, this paper does not show anything that is new. In order to get any of the examples running you need to have access to the page DOM via XSS or some sort of browser bug. If the attacker has access to the page and the page DOM, of course they can hijack whatever they want.</p>
<p>So the title &#8220;JavaScript Hijaking&#8221; does not make sense at all, at least not to me. It is almost like saying Python hijacking or Perl hijacking. If someone has access to Python or Perl&#8217;s dynamic environment they will be able to hijack all of the objects.</p>
<p>This paper is primarily based on using JavaScript capabilities as programming language to show fictitious problems. Every AJAX programmer knows how to overwrite prototype methods and properties but this does not make the programming feature a security problem.</p>
<p>It is time to look at JavaScript the same way you look at other programming languages. There is nothing different about.</p>
<p>That&#8217;s all I have to say.</p>
<p>Good blog!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57833">

			<div class="comment by-rapier57 ">

				<p class="commentcredit">

					<span class="commenter">rapier57</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57833">
						April 2, 2007 5:20 PM					</a>

				</p>

				<p>Not just system administrators should be concerned, but web application development project leads and security administrators.</p>
<p>The Ajax model is the &#8220;cool&#8221; new technology on the Web, but very dangerous. I refer you to OWASP (http:// www. owasp. org/index.php/Main_Page) for more detailed information on secure web application development.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57834">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57834">
						April 2, 2007 5:25 PM					</a>

				</p>

				<p>Curiously, the paper seems to deliberately avoid making the simple recommendation not to use JSON for message exchange in the first place. I&#8217;ve always been extremely wary of JSON&#8211;anything that requires calling eval on an interpolated value is something to be avoided in any language. It&#8217;s an inherently lazy and dangerous construct, and frameworks should not be promulgating it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57835">

			<div class="comment by-nate ">

				<p class="commentcredit">

					<span class="commenter">Nate</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57835">
						April 2, 2007 5:28 PM					</a>

				</p>

				<p>Quote: &#8220;But my guess is that Javascript hijacking won&#8217;t be solved so easily, because programmers don&#8217;t understand the security implications of their work and won&#8217;t prevent the attacks.&#8221;</p>
<p>It&#8217;s actually not as bad as it could be, since very few people roll their own Ajax libraries. If Prototype and the others update, then it&#8217;s just a matter of getting people to update their libraries (which is not as difficult as updating their own code), and new builds will hopefully have new versions of the libraries.</p>
<p>Compare that to everybody writing do_query(&#8220;SELECT * FROM secret_data WHERE id = &#8221; . $_GET[&#8216;id&#8217;]) all over the place.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57836">

			<div class="comment by-josh-h ">

				<p class="commentcredit">

					<span class="commenter">Josh H</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57836">
						April 2, 2007 5:28 PM					</a>

				</p>

				<p>@pdp:</p>
<p>Traditional XSS attacks have concerned evil parties injecting evil code into forum posts and blog comments (or whatever) so that the code runs from the context of the application from which they want to steal data. This is crucial, because modern web browsers implement &#8220;same origin&#8221; security policies.</p>
<p>What&#8217;s new about this attack is that the evil code does not need to be injected into the target page. If I can direct your web app&#8217;s users to my page, and on my page I have a [script] tag with a SRC that calls your web app, your app&#8217;s JSON code will be executed in the context of my page, and I can steal any data that is delivered.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57837">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57837">
						April 2, 2007 5:38 PM					</a>

				</p>

				<p>pdp&gt; In order to get any of the examples running you need to have access to the page DOM via XSS or some sort of browser bug.</p>
<p>I don&#8217;t think that&#8217;s correct. Read it again. As I understand it, the attack takes advantage of the fact that any cookie-based session id will be transmitted by the browser when retrieving the protected URL embedded in the SCRIPT element contained in the attacker&#8217;s external page. The result object can then be captured by the attacker in the external context by overriding the object instantiation method.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57838">

			<div class="comment by-kragen-sitaker ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://pobox.com/~kragen' rel='external nofollow ugc' class='url'>Kragen Sitaker</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57838">
						April 2, 2007 5:54 PM					</a>

				</p>

				<p>Quick summary for those who haven&#8217;t read the paper: if your web server will serve up private information in response to HTTP GETs, authenticated only by ambient authority like session cookies or HTTP Basic authentication, in JSON or related JavaScript formats, then third parties can use cross-host script tags to get that data into their own web page where they can read it.</p>
<p>A slight variation of JSON is usually the most convenient way to get data into AJAX pages, so it&#8217;s used with AJAX a lot, but it&#8217;s not a strictly AJAX technique; it&#8217;s a perfectly good format for getting data from Perl into Python or Ruby into PHP.  So this isn&#8217;t a strictly an attack on AJAX applications; AJAX is vague enough that that probably isn&#8217;t possible.</p>
<p>The paper does argue that any client-side framework requires your server to be vulnerable to this attack, but it is wrong.  First, the client-side framework can&#8217;t require you to store private data on your server; second, none of the client-side frameworks I&#8217;m familiar with (not all of them, admittedly) make such stringent demands on the design of your server URLs that it is impossible to pass authenticating data in an URL parameter, and it seems that a framework that did do such a thing would be very hard to use for anything.</p>
<p>The capability-security community has known for a long time that separating designation and authority &#8212; for example, as in the paper, designating your private sales-leads mailbox with a name that anyone can guess and try to fool your browser into accessing with your authority on their behalf &#8212; leads to subtle security bugs.  This is yet another example.</p>
<p>I&#8217;ve written a little bit about this in the past:<br />
<a href="http://lists.canonical.org/pipermail/kragen-tol/2000-August/000619.html" rel="nofollow ugc">http://lists.canonical.org/pipermail/kragen-tol/2000-August/000619.html</a></p>
<p>Tyler Close&#8217;s &#8220;web-calculus&#8221; work is probably the closest thing we have to a generic solution to the problem: <a href="http://www.waterken.com/dev/Web/" rel="nofollow ugc">http://www.waterken.com/dev/Web/</a> &#8212; see also his &#8220;YURL&#8221; work at <a href="http://www.waterken.com/dev/YURL/" rel="nofollow ugc">http://www.waterken.com/dev/YURL/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57839">

			<div class="comment by-jonas ">

				<p class="commentcredit">

					<span class="commenter">Jonas</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57839">
						April 2, 2007 5:58 PM					</a>

				</p>

				<p>Only 4 comments and already there&#8217;s lots of wrong information&#8230;</p>
<ol>
<li>you don&#8217;t need to eval JSON, there&#8217;s also a more restrictive JSON-&#8220;parser&#8221; for JavaScript. They&#8217;re all available from json.org</li>
<li>There&#8217;s also no need for a browser bug or DOM-access to exploit XSRF (Cross-site request forgery)-bugs. Browser&#8217;s loading script-tags behave exactly like they should.</li>
<li>There already has been some discussion of this on the web lately. The security recommendations are pretty easy to follow:
<ul>
<li>don&#8217;t use data-changing GET requests</li>
<li>within your application, only publish public data at fixed URLs, use hard-to-guess URLs for private data</li>
<li>don&#8217;t &#8220;just eval()&#8221; JSON</li>
<li>don&#8217;t consume JSON by using dynamic script tags</li>
</ul>
</li>
</ol>
<p>for more go here:<br />
&#8220;Safe JSON&#8221;<br />
<a href="http://robubu.com/?p=24" rel="nofollow ugc">http://robubu.com/?p=24</a><br />
and<br />
JSON is not as safe as people think it is<br />
<a href="http://getahead.org/blog/joe/2007/03/05/json_is_not_as_safe_as_people_think_it_is.html" rel="nofollow ugc">http://getahead.org/blog/joe/2007/03/05/json_is_not_as_safe_as_people_think_it_is.html</a></p>
<p>XSRF-techniques were used to break Gmail over a year ago, so this is not exactly &#8220;new&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57840">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57840">
						April 2, 2007 6:17 PM					</a>

				</p>

				<p>Jonas&gt; you don&#8217;t need to eval JSON, there&#8217;s also a more restrictive JSON-&#8220;parser&#8221; for JavaScript.</p>
<p>Obviously one <em>can</em> parse JSON without evaling it. But JSON is designed for eval, and that&#8217;s why this problem exists. Any message format that could be parsed as JavaScript in the context of a SCRIPT element would have the same problem.</p>
<p>The issue I was raising is the mindset of the programmer who things an eval-based message architecture is a good idea. People who think that way write a lot of insecure code.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57841">

			<div class="comment by-pdp ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.gnucitizen.org' rel='external nofollow ugc' class='url'>pdp</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57841">
						April 2, 2007 6:18 PM					</a>

				</p>

				<p>@antibozo, @Josh,</p>
<p>I generalized a bit, however&#8230; what I am trying to say is that this paper does not outline anything new. This paper is all about how the developer can mess it up on the JSON side by exporting their results as either array or provide a callback. Yes, it is a problem. However, what bugs me is the actual exaggeration that was introduced.</p>
<p>Again, IMHO, this paper is more like marketing/PR campaign rather then actual security research because the vulnerabilities and issues are already disclosed and widely discussed in many blogs, mailing lists, etc.</p>
<p>The authors of the paper assume that every framework that supports JSON is directly vulnerable to the attack they describe but that is not true. Most AJAX applications use JSON but a lot of them use {} instead of [] and therefore are protected.</p>
<p>Moreover, the paper provides a protection mechanism that is flowed from top to bottom. I don&#8217;t want to get too much into JavaScript programming internals in this comment but the general truth is the following&#8230; if the attacker load code before yours and they properly overwrite the prototype of several objects thy can as well put the rest of the application in totally transparent sandbox, which means&#8230; no matter what kind of protection mechanisms you have there&#8230; they all will show a green light.</p>
<p>To sum up: I cannot see the purpose of this paper. I cannot understand why it is called JavaScript hijacking? JSON Hijacking is much better. I disagree completely that all the frameworks they mention are vulnerable. Again, if the framework exports results as [] or provide a callback without some sort of CSRF protection mechanism, then yes&#8230; this is a problem.</p>
<p>BTW, The while(1) loop technique was the trick that google used to block the contact list vulnerability discovered a couple of months ago.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57842">

			<div class="comment by-jim ">

				<p class="commentcredit">

					<span class="commenter">Jim</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57842">
						April 2, 2007 7:54 PM					</a>

				</p>

				<blockquote><p>
  The authors of the paper assume that every framework that supports JSON is directly vulnerable to the attack they describe but that is not true. Most AJAX applications use JSON but a lot of them use {} instead of [] and therefore are protected.
</p></blockquote>
<p>Read it again, again.  They aren&#8217;t protected.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57843">

			<div class="comment by-michael-koziarski ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.koziarski.net/' rel='external nofollow ugc' class='url'>Michael Koziarski</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57843">
						April 2, 2007 8:44 PM					</a>

				</p>

				<p>This really does seem to be a special case of CSRF (aka XSRF) attacks.  The solution would appear to be the same,  use tokens in your URLs to prevent shenanigans.</p>
<p>It&#8217;s a clever use of javascript&#8217;s dynamic nature to aid with the capture, but if you can make the browser request private / dangerous URLs in another app, you can do a bunch of damage already.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57844">

			<div class="comment by-brian-chess ">

				<p class="commentcredit">

					<span class="commenter">Brian Chess</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57844">
						April 2, 2007 11:11 PM					</a>

				</p>

				<p>Hi, I&#8217;m Brian Chess, I&#8217;m one of the authors of the paper.  It&#8217;s been fun reading the discussion here.  I think the paper does a decent job of addressing most of the issues being discussed, but I thought I&#8217;d directly comment on some of the statements I&#8217;ve read.  Most of the things I might take issue with have already been corrected in subsequent posts, but I thought I&#8217;d try to collect everything together in one one place.  If I get inspired, maybe I&#8217;ll turn this into a FAQ.</p>
<p>C: The System Administrators should be the ones concerned.</p>
<p>B: This is a software problem.  It won&#8217;t be fixed until programmers fix it.  The reason we&#8217;re talking about it is to try to raise awareness among the Ajax development community.</p>
<p>C: It doesn&#8217;t really look like an attack, just a method to parse the results of an already successful CSRF attack.</p>
<p>B: The Same Origin Policy implemented by all major web browsers is designed to prevent parsing the results of a CSRF attack.  JavaScript Hijacking takes advantage of a hole in the Single Origin Policy.  In many cases, allowing an attacker to both read and write data is significantly worse than simply allowing them to make illegitimate requests.</p>
<p>C: In order to get any of the examples running you need to have access to the page DOM via XSS or some sort of browser bug.</p>
<p>B: Not so.  One of the most important things to note about JavaScript Hijacking is that it does not require the presence of another defect.</p>
<p>C: It&#8217;s actually not as bad as it could be, since very few people roll their own Ajax libraries.</p>
<p>B: The only data we could find on this subject suggest that 25% of Ajax programmers are rolling their own.  Scary!</p>
<p>C: The paper does argue that any client-side framework requires your server to be vulnerable to this attack, but it is wrong.</p>
<p>B: The paper does not make that claim.  Many of the client-side frameworks default to sending HTTP POST requests, which is a poor defense, but does not require the server to be vulnerable.  We only characterize a framework as requiring a server to be vulnerable if it defaults to using HTTP GET and provides no defense against JavaScript Hijacking.  When we first wrote the paper, none of the client side frameworks did anything to explain the problem to their users or to prevent a programmer from using the framework in a vulnerable way.  We&#8217;re happy to see that that&#8217;s changing rapidly.</p>
<p>C: You don&#8217;t need to eval JSON, there&#8217;s also a more restrictive JSON-&#8220;parser&#8221; for JavaScript. They&#8217;re all available from json.org</p>
<p>B: The JSON parser from json.org eventually calls eval(), but it doesn&#8217;t really matter.  Calling eval() is not a prerequisite to being vulnerable.  All you have to do is create an object, so the problem exists no matter how you parse the JSON.</p>
<p>C: Most AJAX applications use JSON but a lot of them use {} instead of [] and therefore are protected.</p>
<p>B: This is entirely dependent upon the type of objects that the application is communicating.  Array syntax is natural for communicating lists and other collections, and if the outermost structure is an array, all of the contents of the array are vulnerable.  If the security of your program depends on your choice of data structures, you&#8217;re on thin ice.</p>
<p>C: what I am trying to say is that this paper does not outline anything new.</p>
<p>B: We did our best to give credit to relevant prior work, including Grossman&#8217;s Google attack and Joe Walker&#8217;s comments on JSON.  What we think is new in the paper is:<br />
  1) The generalization of Grossman&#8217;s attack (he said it could not be used against JSON, but we show that it can).<br />
  2) An exploration of how widespread the problem is.<br />
  3) A discussion of the possible defenses against the attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57845">

			<div class="comment by-pdp ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.gnucitizen.org' rel='external nofollow ugc' class='url'>pdp</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57845">
						April 3, 2007 2:10 AM					</a>

				</p>

				<p>that&#8217;s cool Brian,</p>
<p>Thanks for clarifying.</p>
<p>I am still confused with the way the paper turns JSON a vulnerability. JSON is not perfect, for reasons you&#8217;ve mentioned, but it is not that bad. If properly used, JSON could be quite powerful and very fast because, in its most purest form, the code evaluates directly into the JavaScript interpreter. This way the developer does not need to care about parsing the data structure.</p>
<p>The only reason JSON Hijacking works is because by default the interpreter handles anonymous Arrays which I don&#8217;t think that have any purpose at all. Maybe I am wrong.</p>
<p>So yes [&#8216;John&#8217;, &#8216;Fred&#8217;] evaluates properly and can be hijacked via CSRF but {names:[&#8216;John&#8217;, &#8216;Fred&#8217;]} will trigger an error.</p>
<p>Why don&#8217;t u call the paper JSON Hijacking. JavaScript hijacking is too vague and usually refers to a technique that describes how to create a sandbox around the application for monitoring purposes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57846">

			<div class="comment by-the-other-roy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.rant-central.com' rel='external nofollow ugc' class='url'>The other Roy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57846">
						April 3, 2007 6:05 AM					</a>

				</p>

				<p>It seems that this paper builds on the material seen in the 2006 CCC presentation (<a href="http://events.ccc.de/congress/2006/Fahrplan/events/1602.en.html" rel="nofollow ugc">http://events.ccc.de/congress/2006/Fahrplan/events/1602.en.html</a>).  I think it&#8217;s amusing that the Slashdot crowd largely brushed the CCC paper off back in January, but are reacting to Brian, et al, with something like &#8220;ZOMGTheSkyIsFalling!&#8221;  Must be the &#8220;Web 2.0&#8221; tag.</p>
<p>Good work, Brian.  Thanks for contributing here, as well.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57847">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57847">
						April 3, 2007 8:59 AM					</a>

				</p>

				<p>pdp&gt; If properly used, JSON could be quite powerful and very fast because, in its most purest form, the code evaluates directly into the JavaScript interpreter.</p>
<p>Gods, help us.</p>
<p>That is exactly why it shouldn&#8217;t be used. There are plenty of efficient ways to serialize data structures that don&#8217;t render them confusable with code. That people are deliberately using a dangerous serialization strategy for perceived benefits in speed is clear evidence that general knowledge of security is not improving. This is especially true in this context&#8211;a slow, interpreted language makes a remote procedure call, and people are so keen to shave a couple of milliseconds off the result parsing time they are willing to navigate a security minefield? And has anyone even demonstrated that the JavaScript parser is actually faster than the alternatives?</p>
<p>No, I suspect the JSON design wasn&#8217;t chosen for speed anyway&#8211;it was because someone was both too lazy to write a parser and forgot what the X in AJAX stands for. What&#8217;s scary is how many other clowns hopped on board that rattle-trap streetcar.</p>
<p>Gods, help us.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57848">

			<div class="comment by-pdp ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.gnucitizen.org' rel='external nofollow ugc' class='url'>pdp</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57848">
						April 3, 2007 9:00 AM					</a>

				</p>

				<p>my final say is located at: <a href="http://www.gnucitizen.org/blog/big-fish" rel="nofollow ugc">http://www.gnucitizen.org/blog/big-fish</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57849">

			<div class="comment by-dale-newfield ">

				<p class="commentcredit">

					<span class="commenter">Dale Newfield</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57849">
						April 3, 2007 11:05 AM					</a>

				</p>

				<p>I don&#8217;t believe the &#8220;Preventing Direct Execution of the Response&#8221; suggestions in this paper are sufficient.  eval is just another function, which can be redefined.  Wouldn&#8217;t this break the gmail &#8220;solution&#8221; mentioned?</p>
<pre><code>  var orig_eval = eval;
  eval = function(arg) {
  &amp;nbsp;&amp;nbsp;if (arg &amp;&amp; arg.substr(0,9) == "while(1);") {
  &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;arg = arg.substring(9);
  &amp;nbsp;&amp;nbsp;}
  &amp;nbsp;&amp;nbsp;return orig_eval(arg);
  }
</code></pre>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57850">

			<div class="comment by-dale-newfield ">

				<p class="commentcredit">

					<span class="commenter">Dale Newfield</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57850">
						April 3, 2007 11:42 AM					</a>

				</p>

				<p>Or, eliminating the need for the global var:<br />
eval = function(orig_eval) {<br />
&nbsp;&nbsp;return function(arg) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;if (arg &amp;&amp; arg.substr(0,9) == &#8220;while(1);&#8221;) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg = arg.substring(9);<br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;return orig_eval(arg);<br />
&nbsp;&nbsp;}<br />
}(eval);</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57851">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57851">
						April 3, 2007 12:13 PM					</a>

				</p>

				<p>The preventive suggestions are not intended to break eval; they are intended to keep the result document from being successfully evaluated as JavaScript in the context of a SCRIPT element.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57852">

			<div class="comment by-ernesto ">

				<p class="commentcredit">

					<span class="commenter">Ernesto</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57852">
						April 3, 2007 12:27 PM					</a>

				</p>

				<p>OMG, Schneier&#8217;s talking and not quoting.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57853">

			<div class="comment by-andrew-dupont ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://andrewdupont.net' rel='external nofollow ugc' class='url'>Andrew Dupont</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57853">
						April 3, 2007 3:03 PM					</a>

				</p>

				<p>I can confirm that this is a new thing — not just a restating of a previous XSS or XSRF flaw — but I think it has greater implications for API architects than for JavaScript library authors.</p>
<p>Consider the following:<br />
(1) Bob&#8217;s web site is all Ajaxified and uses a RESTful JSON API to serve data to the client.<br />
(2) Alice logs into Bob&#8217;s web site and has a session token set via cookie.<br />
(3) Alice then visits Carol&#8217;s web site. Carol dynamically appends a SCRIPT tag with the SRC attribute set to a URL on Bob&#8217;s site. Since Alice is logged into Bob&#8217;s site, Bob assumes the requester can be trusted with Alice&#8217;s sensitive data.</p>
<p>Since Carol can&#8217;t read the JSON response in as a string, she has to hook into the JS interpreter herself by overriding a constructor for a native datatype (like Array or Object).</p>
<p>So it seems to me that this problem is most easily fixed on Bob&#8217;s end: he should check the referrer or use some sort of shared secret to ensure that the only responses that contain sensitive information are those that Bob himself knows about.</p>
<p>Or he can do what Brian&#8217;s paper suggests: surround the JSON response in comment delimiters, so that it can be evaluated only by those who can examine the response text (i.e., not Carol). We on the Prototype core team have discussed implementing something like this in an upcoming version.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57854">

			<div class="comment by-tim-harris ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.timharrisportfolio.com' rel='external nofollow ugc' class='url'>Tim Harris</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57854">
						April 3, 2007 4:23 PM					</a>

				</p>

				<p>My simple solution&#8230; DO NOT USE AJAX !!!</p>
<p>To the people that DO use it, you will make me happy with much business as hackers begin to attack just AJAX applications.  Yet another overhyped product to roll out of silicon valley I presume.  You smart people just give us Texans way too much to look forward to !!!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57855">

			<div class="comment by-daniel-haran ">

				<p class="commentcredit">

					<span class="commenter">Daniel Haran</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57855">
						April 3, 2007 4:54 PM					</a>

				</p>

				<p>@Andrew: Glad to see you guys are addressing this. The comment delimiters seem hackish &#8211; checking the referrer and using a shared secret seem sufficient. If a person is clever enough to try this type of attack, chances are they can remove whatever comment delimiters you throw at them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57856">

			<div class="comment by-tobie-langel ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://tobielangel.com' rel='external nofollow ugc' class='url'>Tobie Langel</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57856">
						April 4, 2007 12:14 AM					</a>

				</p>

				<p>@ Daniel: Since the attacker&#8217;s only option is to use a dynamic script to grab the data (thanks to the SOP), commenting the data out is a sufficient protection, as there is no way to access it if it&#8217;s in a script tag (nor to strip the comments).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57857">

			<div class="comment by-matt-kruse ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.javascripttoolbox.com' rel='external nofollow ugc' class='url'>Matt Kruse</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57857">
						April 4, 2007 11:03 AM					</a>

				</p>

				<p>The sky is not falling. JSON is not a problem. Ajax is not a problem. The JS frameworks are not a problem.</p>
<p>As far as I can tell, web site authors should only care about this if:<br />
1. You serve JSON from GET requests<br />
2. The JSON is an array [], not an object {}<br />
3. The data contains private information<br />
4. The only authentication done is checking that a session exists.</p>
<p>From my experience, very, very few sites would ever meet all of these conditions.</p>
<p>I would love to see a single real-world example that exists right now that is vulnerable to this attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57858">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57858">
						April 4, 2007 11:11 AM					</a>

				</p>

				<p>I have to agree with pdp that calling this &#8220;AJAX hacking&#8221; or &#8220;JavaScript hacking&#8221; is total nonsense. The problem is clearly with JSON, and this only implicates AJAX to the extent that fools use JSON in a broken fashion&#8211;and it shouldn&#8217;t even properly be called AJAX in that case. Now these web application scanner vendors are abusing the situation to sell more of their ineffectual products through hype and hysteria.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57859">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57859">
						April 4, 2007 11:15 AM					</a>

				</p>

				<p>Matt Kruse&gt; As far as I can tell, web site authors should only care about this if:<br />
Matt Kruse&gt; 2. The JSON is an array [], not an object {}</p>
<p>Yeah, and you think building a house on that semantic precipice is a good idea?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57860">

			<div class="comment by-matt-kruse ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.javascripttoolbox.com' rel='external nofollow ugc' class='url'>Matt Kruse</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57860">
						April 4, 2007 11:23 AM					</a>

				</p>

				<p>@antibozo: The point is, that&#8217;s just one condition that <em>must</em> be met for this to even be an exploit. I deliver array&#8217;s via JSON without fear in some places because I don&#8217;t meet the other conditions.</p>
<p>Yes, it&#8217;s a potential problem. Sure, it should be addressed.</p>
<p>My point is, this is NOT a big concern for anyone I know of because I can&#8217;t find a single site that could be exploited in this manner. Until someone exploits this in a way that could impact more than 3 people (say, for example, grab meaningful paypal data), it&#8217;s just an interesting quirk with very little real-world impact. It does NOT deserve to be posted to a thousand blogs and news sites and inciting panic as seems to be the case now.</p>
<p>It&#8217;s propaganda. Kudos to Fortify for a brilliant advertising campaign.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57861">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57861">
						April 4, 2007 11:37 AM					</a>

				</p>

				<p>Matt Kruse&gt; The point is, that&#8217;s just one condition that <em>must</em> be met for this to even be an exploit.</p>
<p>How certain are you of that?</p>
<p>And do you really expect people to disclose vulnerable sites here?</p>
<p>I agree that propaganda is involved, on both sides.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57862">

			<div class="comment by-brian-chess ">

				<p class="commentcredit">

					<span class="commenter">Brian Chess</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57862">
						April 4, 2007 12:58 PM					</a>

				</p>

				<p>pdp&gt; I am still confused with the way the paper turns JSON a vulnerability.</p>
<p>You&#8217;re right that the problem is not restricted to JSON.  Actually, that&#8217;s why we named the problem JavaScript Hijacking; it affects any system that uses JavaScript as a data transport format.  I&#8217;ve seen other formats&#8211;some that are much more vulnerable than JSON.  (A list of function calls where the data is in each function call&#8217;s parameter list, for example.)  The reason we focused on JSON in the paper is that it seems to be the most popular format in widespread use.</p>
<p>Arrays are important in JSON.  If you&#8217;d like to communicate a list of email messages, a set of bank accounts, or any other collection, an array is the natural way to do it.  You certainly could protect yourself from JavaScript Hijacking by making sure that you only return objects and never arrays, but now you&#8217;ve got to think about JavaScript Hijacking every time you write a new method.  Better to build some protections into the transport code.</p>
<p>There&#8217;s been a lot of interesting work on JavaScript going on in the exploit development world lately.  People have really woken up to the fact that JavaScript is a powerful exploit writing tool.  The CCC paper mentioned earlier is a great example of that kind of work.  However, the CCC paper begins with the assumption that the web application contains a defect such as a cross-site scripting vulnerability that allows an attacker to inject malicious code.  The reason why the JavaScript Hijacking technique needs its own name is that it does not require any cross-site scripting, response splitting, or other well-understood type of vulnerability to be present.  It is a different animal.</p>
<p>As to the question of whether or not programmers should be moving data around with JavaScript, I don&#8217;t have any useful answer.  The fact is that programmers are doing it, and all indications are they&#8217;re going to do more of it.  For the most part they&#8217;re doing it without any idea about the security risks involved.  That&#8217;s what I want to change and why I think it&#8217;s important to bring attention to new attacks like JavaScript Hijacking.</p>
<p>In his original post, Bruce doesn&#8217;t sound like he&#8217;s very hopeful that programmers will adopt reasonable secure coding techniques.  I think I&#8217;m a little more hopeful than he is, but what I can say for sure is that, if there&#8217;s any chance that programmers can do a better job of getting security right, we security folks need to explain the risks as best we can.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57863">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57863">
						April 4, 2007 1:24 PM					</a>

				</p>

				<p>Brian Chess&gt; it affects any system that uses JavaScript as a data transport format.</p>
<p>Fair enough. But that&#8217;s not even remotely what the term &#8220;JavaScript Hijacking&#8221; suggests. And unfortunately, a lot of people are generalizing even beyond that and characterizing AJAX in this light, which is is inaccurate because &#8220;AJAX&#8221; uses XML as its message format, not JavaScript. Blood over the dam now, and the paper seems like good work to me, but more thought should have gone into your terminology.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57864">

			<div class="comment by-matt-kruse ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.javascripttoolbox.com' rel='external nofollow ugc' class='url'>Matt Kruse</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57864">
						April 4, 2007 2:14 PM					</a>

				</p>

				<p>Okay, I&#8217;ve officially hit the first instance of &#8220;I just read that Ajax has security problems, maybe we should do something else&#8221; since this was released.</p>
<p>This is the real impact of propaganda scare-tactic &#8220;news releases&#8221; like this. In the real world this paper probably won&#8217;t protect anyone (still haven&#8217;t heard of a single real exploit, even from the hacker community) but rather it will cause well-intentioned but uninformed people to form a bias against ajax and further the existing biases against javascript.</p>
<p>What a shame.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57865">

			<div class="comment by-foodoo ">

				<p class="commentcredit">

					<span class="commenter">FooDoo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57865">
						April 4, 2007 4:20 PM					</a>

				</p>

				<p>It should be interesting to see what is possible now that Jitko has been leaked.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57866">

			<div class="comment by-owen-blacker ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://owenblacker.livejournal.com' rel='external nofollow ugc' class='url'>Owen Blacker</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57866">
						April 5, 2007 5:56 AM					</a>

				</p>

				<p>I think it&#8217;s worth pointing out the response from Scott Guthrie at Microsoft, which is surprisingly reassuring: <a href="http://tinyurl.com/37ulwn" rel="nofollow ugc">http://tinyurl.com/37ulwn</a> (weblogs.asp.net)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57867">

			<div class="comment by-rg3 ">

				<p class="commentcredit">

					<span class="commenter">RG3</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57867">
						April 5, 2007 2:50 PM					</a>

				</p>

				<p>&#8220;programmers don&#8217;t understand the security implications of their work&#8221;</p>
<p>I consider myself security-aware.  Possibly more than most programmers.  But I tried my hand at one of the sample tests at <a href="http://www.sans-ssi.org/" rel="nofollow ugc">http://www.sans-ssi.org/</a> at got 3/10 on my first go.</p>
<p>I think the problem is largely one of training &#8211; when people are trained in the dark art of programming, security is considered an &#8220;add-on&#8221;, rather than something that should pervade the whole process.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57868">

			<div class="comment by-kentaromiura ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mykenta.blogspot.com' rel='external nofollow ugc' class='url'>kentaromiura</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57868">
						April 8, 2007 4:20 AM					</a>

				</p>

				<p>@Andrew:<br />
I don&#8217;t think so.</p>
<p>if an attacker can execute javascript surrounding with comment or poisoning the data with garbage is not a good solution, if you can strip out comment, so the attacker can.</p>
<p>In Js there is no secret, all the code is readable and then a shared secret(like webservice) is pretty much shared and not more secret.</p>
<p>and i think that using post instead of get don&#8217;t prevent nothing.</p>
<p>me and andrea giammarchi<br />
[http://webreflection.blogspot.com/]<br />
had a brainstorming, but in the end our result was that is always possible to an attacker to get the data.<br />
i&#8217;m working on the last try, trying to get a case where if the attacker try to redefine something he get in a circular reference, but even if i solve this (allowing a safe eval) not all problems are solved.<br />
Bye 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57869">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57869">
						April 8, 2007 11:00 AM					</a>

				</p>

				<p>kentaromiura&gt; if an attacker can execute javascript surrounding with comment or poisoning the data with garbage is not a good solution, if you can strip out comment, so the attacker can.</p>
<p>An attacker has no opportunity to modify the content returned to the browser when it evaluates a SCRIPT tag before it is passed to the JavaScript interpreter, nor can he modify the request method (always GET). That is the scenario under discussion. Go back and read the paper again.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57870">

			<div class="comment by-kentaromiura ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mykenta.blogspot.com' rel='external nofollow ugc' class='url'>kentaromiura</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57870">
						April 8, 2007 5:09 PM					</a>

				</p>

				<p>I don&#8217;t need to.<br />
as I already said if an attacker could execute javascript it can totally rewrite your page, or a smarter one could add an iframe to allow cross domain xmlhttprequest, that for the sake can use post ^_^;;<br />
so get or post make no difference.</p>
<p>as I just said if an attacker can execute code, it don&#8217;t need to eval nothing, the goal of the attacker is to stole information, so it can make a fake xmlhttprequest(or use a fake object or function) and use the iframe to save your data, actually he can NEVER eval your code, but he have stole it.</p>
<p>so poison the data don&#8217;t automatically protect you. neither use get or post.</p>
<p>neither my solution, because if an attacker add a script at the very end of the page(and use for example dean edward ondomcontentloaded) and delete what i just rewrote then he make my efford null.</p>
<p>the solution is to don&#8217;t send the data.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57871">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57871">
						April 9, 2007 1:14 PM					</a>

				</p>

				<p>kentarmiura&gt; can make a fake xmlhttprequest(or use a fake object or function) and use the iframe to save your data</p>
<p>Actually, he can&#8217;t. That&#8217;s what the so-called &#8220;Same Origin Policy&#8221; prevents. The described attack exploits a loophole in this policy, namely that JavaScript imported to a page via the SCRIPT element does not have to come from the same server as the enclosing document. Documents retrieved via an XmlHttpRequest object or IFRAME, on the other hand, are not accessible to a requester with a different origin than the requested document.</p>
<p>Like I say, go back and read the paper again.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57872">

			<div class="comment by-kn ">

				<p class="commentcredit">

					<span class="commenter">kn</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57872">
						April 9, 2007 4:47 PM					</a>

				</p>

				<p>Is there any real world application out in the wild that is vulnerable to javascript hijacking ?</p>
<p>seems like this issue is not very prevalent.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57873">

			<div class="comment by-kentaromiura ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mykenta.blogspot.com' rel='external nofollow ugc' class='url'>kentaromiura</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57873">
						April 9, 2007 4:51 PM					</a>

				</p>

				<p>yes, so this<br />
<a href="http://dojotoolkit.org/node/87" rel="nofollow ugc">http://dojotoolkit.org/node/87</a><br />
is only bullshit.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57874">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57874">
						April 9, 2007 5:18 PM					</a>

				</p>

				<p>kentaromiura&gt; yes, so this <a href="http://dojotoolkit.org/node/87" rel="nofollow ugc">http://dojotoolkit.org/node/87</a> is only bullshit.</p>
<p>That IFRAMEs can coordinate deliberately with a parent document in order to exchange messages via URL fragment identifiers does not mean that an attacker can spy at will on a document in an IFRAME from another server. If such spying were possible, the whole fragment id hack wouldn&#8217;t be necessary. A service built using that strategy could conceivably have vulnerabilities similar to the one described here, however.</p>
<p>Do yourself a favor and try implementing the attack you described. It will better acquaint you with the limitations imposed on JavaScript.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57875">

			<div class="comment by-tk ">

				<p class="commentcredit">

					<span class="commenter">TK</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57875">
						April 10, 2007 8:39 AM					</a>

				</p>

				<p>antibozo&gt; No, I suspect the JSON design wasn&#8217;t chosen for speed anyway&#8211;it was because someone was both too lazy to write a parser and forgot what the X in AJAX stands for. (&#8230;)  And unfortunately, a lot of people are generalizing even beyond that and characterizing AJAX in this light, which is is inaccurate because &#8220;AJAX&#8221; uses XML as its message format, not JavaScript.</p>
<p>The X in AJAX doesn&#8217;t really stand for XML as a data transfer format but more for XHTML (including the DOM capabilities to change the HTML on the fly) and the XmlHttpRequest object.</p>
<p>Quoted from <a href="http://www.adaptivepath.com/publications/essays/archives/000385.php" rel="nofollow ugc">http://www.adaptivepath.com/publications/essays/archives/000385.php</a> :</p>
<p>&#8220;&#8230; Ajax incorporates:</p>
<pre><code>* standards-based presentation using XHTML and CSS;
* dynamic display and interaction using the Document Object Model;
* data interchange and manipulation using XML and XSLT;
* asynchronous data retrieval using XMLHttpRequest;
* and JavaScript binding everything together."
</code></pre>
<p>Although it mentions XML as the data interchange format, there are these questions in the FAQ, on the same site:</p>
<p>&#8220;Q. Why did you feel the need to give this a name?</p>
<p>A. I needed something shorter than “Asynchronous JavaScript+CSS+DOM+XMLHttpRequest??? to use when discussing this approach with clients.</p>
<p>(&#8230;)</p>
<p>Q. Some of the Google examples you cite don’t use XML at all. Do I have to use XML and/or XSLT in an Ajax application?</p>
<p>A. No. XML is the most fully-developed means of getting data in and out of an Ajax client, but there’s no reason you couldn’t accomplish the same effects using a technology like JavaScript Object Notation or any similar means of structuring data for interchange.&#8221;</p>
<p>Lastly, from Wikipedia:</p>
<p>&#8220;XML is sometimes used as the format for transferring data between the server and client, although any format will work, including preformatted HTML, plain text, JSON and even EBML. These files may be created dynamically by some form of server-side scripting.&#8221;</p>
<p>A brazilian news site published the following (translated to English):</p>
<p>&#8220;According to Fortify, the source of the problem is that the AJAX applications are setting aside the X (of XML). This way, the application does everything in Javascript and therefore is unsafe.&#8221;</p>
<p>That was what worried me most, so I felt like clearing it up. Plus any good Ajax application should never do &#8220;everything in Javascript.&#8221;</p>
<p>About the paper itself, although some may say it doesn&#8217;t mention anything new, it&#8217;s useful as for putting together most of the security concerns developers should be aware of when working with &#8216;Javascript code&#8217; as a data transfer format.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57876">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57876">
						April 10, 2007 9:27 AM					</a>

				</p>

				<p>TK, yes, I&#8217;m aware that the original meaning of the X (it did stand for XML when the term was first promulgated) has been lost in what is now typically called &#8220;AJAX&#8221;. I simply think it&#8217;s indicative of the ignorance of a lot &#8220;AJAX&#8221; &#8220;programmers&#8221; that they are unaware of the meaning of the acronym. It&#8217;s just a little illustrative side issue to the real flaws of the JSON approach&#8211;that it encourages using eval on externally supplied data that is typically too complex to use regular expressions to sanity-check, and that APIs that use JSON or any JavaScript notation as a message format are far less compatible with languages other than JavaScript, so if you want to build another program in Java or Perl that calls into the same API, you have to find some ugly JavaScript parser to extricate the data. Hell, even Microsoft&#8217;s VIEWSTATE syntax would be more compact and interoperable for most applications than JSON, if for some reason XML is not an option.</p>
<p>I agree on the paper itself; it&#8217;s useful to shine a light on any class of vulnerabilities that may result from an increasingly common architecture. The only issue I take with the paper is the absurdly broad-brush approach of calling it &#8220;JavaScript Hijacking&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57877">

			<div class="comment by-kentaromiura ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mykenta.blogspot.com' rel='external nofollow ugc' class='url'>kentaromiura</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57877">
						April 13, 2007 4:14 PM					</a>

				</p>

				<p>@antibozo: actually I have done it in another, simpler way, I am writing an article on this, I am 100% sure that all the solutions write on that pdf are wrong.<br />
When I finish my article I&#8217;ll show you.<br />
in the meantime you could read what a guru have to say about this:<br />
<a href="http://yuiblog.com/blog/2007/04/10/json-and-browser-security/" rel="nofollow ugc">http://yuiblog.com/blog/2007/04/10/json-and-browser-security/</a></p>
<p>and for the sake, is not only a json nor an ajax problem, is a javascript problem.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57878">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57878">
						April 13, 2007 5:07 PM					</a>

				</p>

				<p>kentaromiura&gt; <a href="http://yuiblog.com/blog/2007/04/10/json-and-browser-security/" rel="nofollow ugc">http://yuiblog.com/blog/2007/04/10/json-and-browser-security/</a></p>
<p>If you&#8217;re referring to the section entitled &#8220;Script Tags&#8221;, what the author describes is the reverse of the attack the &#8220;JavaScript Hijacking&#8221; paper is about.</p>
<p>In the paper, the victim visits an outer page authored by an attacker, which includes a SCRIPT element pointing to an AJAX service that delivers some form of JavaScript-encoded message, and the outer page then captures the message by overriding object instantiation methods. This does not require any cross-site scripting vulnerability in the AJAX application; all it requires is for the victim to visit the attacker&#8217;s page, and for the AJAX application to encode messages in a vulnerable JavaScript format.</p>
<p>The closest to this attack the URL you cite comes to is this:</p>
<p>&#8220;Another use of script tags is to deliver JSON data from different sites. There is absolutely no protection against the case where the different site sends dangerous scripts instead of benign JSON data.&#8221;</p>
<p>This is the reverse scenario; in this case, the outer document is trusted and it uses a SCRIPT to include an inner, malicious document. This has always been known to be a vulnerable design because the script included via SCRIPT has access to the DOM of the outer document.</p>
<p>But in &#8220;JavaScript Hijacking&#8221;, the <em>outer</em> document is malicious, and uses a SCRIPT to include an inner, trusted document. This is a completely different animal because the outer document is not supposed to have access to the DOM of any inner document that originates from a different server.</p>
<p>I think you still don&#8217;t understand the vulnerability and that we are talking at cross purposes. I look forward to reading your article, though. I will keep checking back here.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57879">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57879">
						April 13, 2007 5:21 PM					</a>

				</p>

				<p>kentaromiura&gt; <a href="http://yuiblog.com/blog/2007/04/10/json-and-browser-security/" rel="nofollow ugc">http://yuiblog.com/blog/2007/04/10/json-and-browser-security/</a></p>
<p>That document also says this:</p>
<p>&#8220;Since script tags are exempt from the Same Origin Policy, a script tag can be used from any page to make a GET request of your server. The request will even include your cookies. If the response contains confidential information, then your server must refuse the request.</p>
<p>&#8220;There are people who are selling magic wrappers to put around JSON text to prevent delivery to unauthorized receivers. Avoid that stuff. It will fail when new browser bugs are created and discovered, and in some cases might introduce painful new exploits.&#8221;</p>
<p>Here&#8217;s better advice: stop encoding messages as script. No, doing so is not a vulnerability in itself, but it trains people to write vulnerable code.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57880">

			<div class="comment by-kentaromiura ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mykenta.blogspot.com' rel='external nofollow ugc' class='url'>kentaromiura</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57880">
						April 14, 2007 2:16 PM					</a>

				</p>

				<p>@antibozo:<br />
you are right, the paper describe the reverse scenario.</p>
<p>I was speaking about when someone put a script in your page (either by make you click on a link or using some bug in a webpage)<br />
In this case the attacker could do what he want.</p>
<p>In Fortify scenario, the attacker could   use a proxy for make a post instead of a get and return the data cleaned [stripping out the comments and the while(1);].</p>
<p>So the defensor must check server side that the page that make the request come from the same domain.<br />
thank you for clearing out this to me, now I must rewrite my article adding this case.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57881">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57881">
						April 14, 2007 2:52 PM					</a>

				</p>

				<p>kentaromiura&gt; In Fortify scenario, the attacker could use a proxy for make a post instead of a get and return the data cleaned [stripping out the comments and the while(1);].</p>
<p>If the attacker points the SCRIPT at a proxy, the browser won&#8217;t send the cookie or HTTP authentication info, so from the AJAX service&#8217;s perspective, the proxy will be like any other anonymous client. The browser will only send authenticators directly to the AJAX service.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57882">

			<div class="comment by-kentaromiura ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mykenta.blogspot.com' rel='external nofollow ugc' class='url'>kentaromiura</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57882">
						April 14, 2007 3:04 PM					</a>

				</p>

				<p>i mean a flash proxy embed in the page</p>
<p><a href="http://blog.monstuff.com/Flash4AJAX/static/Xdomain.html" rel="nofollow ugc">http://blog.monstuff.com/Flash4AJAX/static/Xdomain.html</a></p>
<p>in that case i presume the cookie is send.<br />
but I need to try before 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57883">

			<div class="comment by-kentaromiura ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mykenta.blogspot.com' rel='external nofollow ugc' class='url'>kentaromiura</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57883">
						April 14, 2007 3:36 PM					</a>

				</p>

				<p>seems that is not possible to execute cross-domain data leakage attack using Flash because of its crossdomain.xml security model because the server would have to explicitly allow it,well i&#8217;m a bit reassured</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57884">

			<div class="comment by-ti ">

				<p class="commentcredit">

					<span class="commenter">Ti</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57884">
						April 16, 2007 12:56 PM					</a>

				</p>

				<p>@kentaromiura: it&#8217;s a good thing you didn&#8217;t write that crap of a paper, the last thing we need is more false claims about how vulnerable Javascript is.  you should thank antibozo for educating you on the basics</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57885">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57885">
						April 16, 2007 1:40 PM					</a>

				</p>

				<p>Ti, though I appreciate the vote of confidence, your comment is pretty harsh; I chalk this up to English&#8217;s not being kentaromiura&#8217;s first language, and he did cite some interesting links, so no harm, no foul.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57886">

			<div class="comment by-kentaromiura ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mykenta.blogspot.com' rel='external nofollow ugc' class='url'>kentaromiura</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57886">
						April 17, 2007 11:16 AM					</a>

				</p>

				<p>@Ti:Sorry for my misurestanding, but actually I think that javascript <em>is</em> pretty vulnerable, expecially when someone don&#8217;t take care of the server side, as i already said if one attacker can execute even few bytes of javascript,due to a bug in the application, it can totally rewrite all the code in your application and you can&#8217;t do nothing to prevent it.</p>
<p>@antibozo:Ti is right, I have to thank you, I don&#8217;t public my paper because out there there is lot of code injection article.<br />
Since i put lot of efford in it these days I still thinking on rewrite it better,focusing  on other interesting things I found..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57887">

			<div class="comment by-mike-koss ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://bluedot.us/users/mike' rel='external nofollow ugc' class='url'>Mike Koss</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57887">
						April 22, 2007 11:59 AM					</a>

				</p>

				<p>It seems to me, the popularity of using &lt;SCRIPT&gt;-includes, derives from the desire to be able to implement client-side mashups (which must be able to get around the same-source cross-site scripting protections of the browser).  Web services that want to support these are bundling their data access API&#8217;s inside of &lt;SCRIPT&gt;-includes.  So, if these calls can return private user data, the script will necessarily co-mingle it&#8217;s objects with those of the outer (potentially malicious) page.</p>
<p>I think what this paper highlights is that there is no such thing as a &#8220;safe&#8221; &lt;SCRIPT&gt;-based mashup returning private data.  Unless the calling page can pass some hard-to-guess and time-limited identifier in the &lt;SCRIPT&gt; request, there are many techniques for the outer page to sniff out the data objects created by the inner &lt;SCRIPT&gt;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57888">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57888">
						April 22, 2007 1:41 PM					</a>

				</p>

				<p>Mike Koss&gt; I think what this paper highlights is that there is no such thing as a &#8220;safe&#8221; -based mashup returning private data.</p>
<p>I think you&#8217;re not quite getting it. Yes, any page that uses SCRIPT to include a document from a server under someone else&#8217;s control is potentially dangerous. That&#8217;s not what this attack is about. In this attack, the system being exploited might not use a mashup at all, and whether it does is irrelevant. The attacker is the one using a mashup, deliberately.</p>
<p>Mike Koss&gt; Unless the calling page can pass some hard-to-guess and time-limited identifier in the  request, there are many techniques for the outer page to sniff out the data objects created by the inner .</p>
<p>No, there aren&#8217;t. But there is at least one, which is the technique described in the paper. That technique recovers messages encoded as JavaScript in certain cases, and it doesn&#8217;t matter whether the &#8220;calling page&#8221; passes an additional authenticator; the difference should be that the service, if coded securely, would refrain from transmitting private data if the caller is authenticated only by a cookie-based session id.</p>
<p>I think you need to read the paper once more, and review the so-called &#8220;same origin policy&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57889">

			<div class="comment by-mike-koss ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://bluedot.us/users/mike' rel='external nofollow ugc' class='url'>Mike Koss</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57889">
						April 23, 2007 11:29 AM					</a>

				</p>

				<p>antibozo: The point I was trying to make is that the popularity of using a cross-site &lt;SCRIPT&gt; tag is due to people creating &#8220;mashups&#8221;.  If all your functionality is available on a single server, there is not a compelling reason to implement your  data interfaces via &lt;SCRIPT&gt; tags, but rather most sites should be using XMLHttpRequest &#8211; where browsers enforce Same Source rules.</p>
<p>So, what I get from this paper is &#8211; unless you&#8217;re explicitly designing your interface to support a mashup &#8211; you shouldn&#8217;t be using the &lt;SCRIPT&gt; tag as a data transport.</p>
<p>As to my last point about &#8220;many techniques&#8221; available to access the objects that come from a &lt;SCRIPT&gt;, I realize that the paper describes one &#8211; trapping the setter event on an Object class member.  My claim is that there are actually many more holes than this &#8211; just addressing the one described, does not necessarily solve the root problem.  I believe all the objects created inside the &lt;SCRIPT&gt; tag are available in the same name-space as the containing page; so there are other techniques available to get access to global variables, etc. depending on what the malicious page knows about the specifics of the behavior of the target &lt;SCRIPT&gt;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57890">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57890">
						April 23, 2007 12:40 PM					</a>

				</p>

				<p>Mike Koss&gt; So, what I get from this paper is &#8211; unless you&#8217;re explicitly designing your interface to support a mashup &#8211; you shouldn&#8217;t be using the  tag as a data transport.</p>
<p>Again, the vulnerable service doesn&#8217;t use SCRIPT as a vehicle for message transport. No one does, except the attacker.</p>
<p>Mike Koss&gt; My claim is that there are actually many more holes than this &#8211; just addressing the one described, does not necessarily solve the root problem.</p>
<p>That may be true, and that&#8217;s one of the several reasons not to use JavaScript as a message transport (as JSON does).</p>
<p>Mike Koss&gt; I believe all the objects created inside the  tag are available in the same name-space as the containing page; so there are other techniques available to get access to global variables, etc. depending on what the malicious page knows about the specifics of the behavior of the target .</p>
<p>The type of message transport under attack doesn&#8217;t set any global variables*. It presents a JavaScript initializer, which a legitimate client could turn into a local object by passing it to eval(). For example, a legitimate client might use an XmlHttpRequest object to request a document from the service, and the service might send back: &#8220;very secret value encoded as a JavaScript string\n&#8221;. The client could then turn this into a local object by doing &#8220;var secretValue = eval (resultDoc);&#8221;. No SCRIPT is involved. The legitimate client is allowed to pass resultDoc to eval because resultDoc came from the same origin as the client.</p>
<p>The attacker doesn&#8217;t have the same access to result documents from the service, because the malicious page has a different origin. So the attacker instead uses SCRIPT to request the secret document because SCRIPT isn&#8217;t subject to the &#8220;same origin policy&#8221;. This still isn&#8217;t adequate for the attacker because the attacker can&#8217;t directly read the result document&#8211;bare initializers don&#8217;t have side effects*. But munging of the JavaScript interpreter allows interception of the message as it is being parsed.</p>
<p>The feasability of this attack is a side effect of the choice by the service&#8217;s author to use JavaScript as its message transport, because he is too lazy or ignorant either to write a parser for his messages encoded in a sane format, or to simply use XML for messages and handle results using the native JavaScript DOM API.</p>
<p>No offense, but please go back and read the paper again.</p>
<ul>
<li>If the vulnerable service does set global variables or use messages that call predefined functions, attacking it is easier and doesn&#8217;t require fooling with the JavaScript interpreter. The paper describes attacks against services that use bare initializers as messages.</li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57891">

			<div class="comment by-mike-koss ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://bluedot.us/users/mike' rel='external nofollow ugc' class='url'>Mike Koss</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57891">
						April 23, 2007 9:18 PM					</a>

				</p>

				<p>antiobozo: No offense, but please don&#8217;t ask me to read the paper again.  I GET it, and I do understand it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-57896">

			<div class="comment by-geciktirici ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.geciktiricispreyler.com' rel='external nofollow ugc' class='url'>geciktirici</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57896">
						July 15, 2008 8:49 AM					</a>

				</p>

				<p>The attacker doesn&#8217;t have the same access to result documents from the service, because the malicious page has a different origin. So the attacker instead uses SCRIPT to request the secret document because SCRIPT isn&#8217;t subject to the &#8220;same origin policy&#8221;. This still isn&#8217;t adequate for the attacker because the attacker can&#8217;t directly read the result document&#8211;bare initializers don&#8217;t have side effects*. But munging of the JavaScript interpreter allows interception of the message as it is being parsed</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-57899">

			<div class="comment by-web-design-and-development ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://pennfolio.com' rel='external nofollow ugc' class='url'>web design and development</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/#comment-57899">
						September 14, 2009 7:15 PM					</a>

				</p>

				<p>Nothing new. INMO, I think it really depends on the programmer&#8217;s skills on how he handles the securities.</p>
<p>good post!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2007/04/javascript_hija_1.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2007/04/javascript_hija_1.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2007%2F04%2Fjavascript_hija_1.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2007/04/javascript_hija_1.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='1485' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2007/04/another_tsa_fai.html" rel="prev">← TSA Failures in the News</a>		<a href="https://www.schneier.com/blog/archives/2007/04/papers_please.html" rel="next">"Papers, Please" →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
