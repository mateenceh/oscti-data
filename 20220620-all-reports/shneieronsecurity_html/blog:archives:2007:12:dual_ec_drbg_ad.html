<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Dual_EC_DRBG Added to Windows Vista - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Dual_EC_DRBG Added to Windows Vista Comments Feed" href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/1973" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=1973' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2007%2F12%2Fdual_ec_drbg_ad.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2007%2F12%2Fdual_ec_drbg_ad.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-1973 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-1973" class="post-1973 post type-post status-publish format-standard hentry category-uncategorized tag-backdoors tag-cryptography tag-nsa tag-operating-systems tag-random-numbers tag-vulnerabilities tag-windows">

	<div class="article">

		<h2 class="entry">Dual_EC_DRBG Added to Windows Vista</h2>
		<p>Microsoft <a href="http://technet2.microsoft.com/WindowsVista/en/library/417467e7-7845-46d4-85f1-dd471fbc0de91033.mspx?mfr=true">has</a> <a href="http://msdn2.microsoft.com/en-us/library/aa375534.aspx">added</a> the random-number generator Dual_EC-DRBG to Windows Vista, as part of SP1.  Yes, this is the same RNG that <a href="http://www.schneier.com/essay-198.html">could have an NSA backdoor</a>.</p>
<p>It&#8217;s not enabled by default, and my advice is to never enable it.  Ever.</p>
<p>EDITED TO ADD (12/18):  I should make this clear that the algorithm is available as a program call.  It is not something that the user can enable or disable.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/backdoors/" rel="tag">backdoors</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/nsa/" rel="tag">NSA</a>, <a href="https://www.schneier.com/tag/operating-systems/" rel="tag">operating systems</a>, <a href="https://www.schneier.com/tag/random-numbers/" rel="tag">random numbers</a>, <a href="https://www.schneier.com/tag/vulnerabilities/" rel="tag">vulnerabilities</a>, <a href="https://www.schneier.com/tag/windows/" rel="tag">Windows</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html" rel="bookmark">Posted on December 17, 2007 at 10:22 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html#comments">82 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html" data-title="Dual_EC_DRBG Added to Windows Vista" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-77100">

			<div class="comment by-eric ">

				<p class="commentcredit">

					<span class="commenter">Eric</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77100">
						December 17, 2007 10:59 AM					</a>

				</p>

				<p>You know what would be scary? If they secretly started using this algorithm even if you requested something else.  Could anyone tell?  What if they only pulled the switch under specific conditions (i.e. Chinese language versions)?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77101">

			<div class="comment by-nick ">

				<p class="commentcredit">

					<span class="commenter">Nick</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77101">
						December 17, 2007 11:21 AM					</a>

				</p>

				<p>Or Microsoft could just enable Dual_EC-DRBG to be used sometime in the future after most people forget it&#8217;s there.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77102">

			<div class="comment by-annic ">

				<p class="commentcredit">

					<span class="commenter">annic</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77102">
						December 17, 2007 11:46 AM					</a>

				</p>

				<p>1.) How do you switch it on and off?</p>
<p>2.) How do you know what state it is in(of or off)??</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77103">

			<div class="comment by-derf ">

				<p class="commentcredit">

					<span class="commenter">derf</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77103">
						December 17, 2007 11:48 AM					</a>

				</p>

				<p>Either a stealth Windows Update will turn it on, or a future critical security fix will quietly make it the default.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77104">

			<div class="comment by-hal ">

				<p class="commentcredit">

					<span class="commenter">HAL</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77104">
						December 17, 2007 12:11 PM					</a>

				</p>

				<p>I got to this point, &#8220;When developing Windows Vista, Microsoft set out to provide higher levels of productivity, mobility, and security, with lower costs.&#8221;  Then my BS Detector went off.</p>
<p>Microsoft lowering costs!  Yeah right.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77105">

			<div class="comment by-joe ">

				<p class="commentcredit">

					<span class="commenter">Joe</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77105">
						December 17, 2007 12:20 PM					</a>

				</p>

				<p>Well, it&#8217;s good to know that Microsoft is at least keeping their security flaws up to date.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77106">

			<div class="comment by-stacy ">

				<p class="commentcredit">

					<span class="commenter">stacy</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77106">
						December 17, 2007 12:21 PM					</a>

				</p>

				<p>&#8220;[&#8230;] and my advice is to never enable it. Ever.&#8221;</p>
<p>Are you referring to the RNG or to Vista? 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77107">

			<div class="comment by-electron ">

				<p class="commentcredit">

					<span class="commenter">electron</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77107">
						December 17, 2007 12:23 PM					</a>

				</p>

				<p>But Microsoft <em>is</em> lowering costs &#8211; the costs of the recording studios.<br />
Microsoft <em>is</em> increasing security &#8211; making it possible for the RIAA to check what you&#8217;ve got without the owner of the computer knowing.<br />
Microsoft <em>is</em> increasing productivity &#8211; that of the lawyers prosecuting the DRM cases for the RIAA.</p>
<p>Everybody else? click &#8216;n&#8217; wait.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77108">

			<div class="comment by-hal ">

				<p class="commentcredit">

					<span class="commenter">HAL</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77108">
						December 17, 2007 12:45 PM					</a>

				</p>

				<p>Yeah electron, everybody is going to buy a Zune which is a giant flop.  They&#8217;re making music low cost, but high loss.</p>
<p>&#8220;Robertson, &#8220;I&#8217;ve been looking for a good verb to describe losing all of your music to DRM because it&#8217;s increasingly common and I think I have one: zune.&#8221;&#8221;<br />
<a href="http://www.engadget.com/tag/michael%20robertson/" rel="nofollow ugc">http://www.engadget.com/tag/michael%20robertson/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77109">

			<div class="comment by-mark ">

				<p class="commentcredit">

					<span class="commenter">mark</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77109">
						December 17, 2007 12:47 PM					</a>

				</p>

				<blockquote><p>
  the costs of the recording studios.<br />
  Uh no.  Actually most recording is HD based and Vista is a performance dog.  In the past you&#8217;d base your studio around a Windows platform to save money.  But with Vista, you need more HW for the same performance and thus the costs go up.
</p></blockquote>
<p>Leave the recording studios out of the record label / DRM madness.  We&#8217;re victims just like you.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77110">

			<div class="comment by-patrick-star ">

				<p class="commentcredit">

					<span class="commenter">Patrick Star</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77110">
						December 17, 2007 12:48 PM					</a>

				</p>

				<p>@stacy:</p>
<p>Based on the purported complexity of Vista, can any assurances be made with respect to the security of that product?</p>
<p><a href="http://www.forbes.com/free_forbes/2007/0226/050.html" rel="nofollow ugc">http://www.forbes.com/free_forbes/2007/0226/050.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77111">

			<div class="comment by-grandma ">

				<p class="commentcredit">

					<span class="commenter">grandma</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77111">
						December 17, 2007 1:08 PM					</a>

				</p>

				<p>Anyone who runs Windows is a fscking schmuck and deserves what they get for their poor choice in operating systems.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77112">

			<div class="comment by-jesse-viviano ">

				<p class="commentcredit">

					<span class="commenter">Jesse Viviano</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77112">
						December 17, 2007 1:09 PM					</a>

				</p>

				<p>You should know that the documentation linked to states that the default RNG in Vista SP1 will not be Dual_EC_DRBG, but the RNG based on AES, which is CTR_DRBG, which Schneier recommended in his post warning against Dual_EC_DRBG.</p>
<p>Dual_EC_DRBG is only called when the programmer explicitly calls for it. Therefore, the way to make sure that Dual_EC_DRBG is not used is to perform a source code audit. The auditor must search the source code of the program in question for the constant named BCRYPT_RNG_DUAL_EC_ALGORITHM and the string &#8220;DUALECRNG&#8221; to make sure that they are either completely absent from the program or used to throw exceptions when their use is detected in runtime, and must make sure that the programmers did not program Dual_EC_DRBG in themselves.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77113">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77113">
						December 17, 2007 1:13 PM					</a>

				</p>

				<p>&#8221; [&#8230;] Therefore, the way to make sure that Dual_EC_DRBG is not used is to perform a source code audit&#8221;</p>
<p>With Windows you cannot audit the source code.<br />
Use Linux/xBSD instead of Windows.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77114">

			<div class="comment by-hal ">

				<p class="commentcredit">

					<span class="commenter">HAL</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77114">
						December 17, 2007 1:29 PM					</a>

				</p>

				<p>&#8220;Gartner survey found that 64% of companies planned to begin moving from Windows XP to Windows Vista by the winter of 2008.&#8221; via Information Week.</p>
<p>Good news story for security industry insiders.<br />
&#8220;Malware authors will step up efforts to attack Windows Vista in 2008, as Microsoft&#8217;s latest desktop operating system passes the 10 percent market share milestone, according to security firm McAfee.&#8221;</p>
<p>If attacks are going up, why in the world would 64% of biz users being heading in that direction? Nucking futs.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77115">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">Chris</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77115">
						December 17, 2007 1:46 PM					</a>

				</p>

				<p>Um, not to be a spoilsport, but isn&#8217;t this in the NIST standard?  Why doesn&#8217;t the blame belong there, instead of Microsoft implementing it?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77116">

			<div class="comment by-eric ">

				<p class="commentcredit">

					<span class="commenter">Eric</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77116">
						December 17, 2007 1:52 PM					</a>

				</p>

				<p>Imagining a Windows system that&#8217;s been rigged to always use the backdoored RNG leaves us with lots of interesting posibilities:<br />
1. Inject compromised machines into the supply line for your adversary.  I mentioned &#8220;Chinese language versions&#8221; earlier, but you could probably be more focused than that.<br />
2. If you ever crack your adversary&#8217;s machine, modifying the crypto DLL is an extremely subtle attack they&#8217;re unlikely to detect.<br />
3. If you can get your adversary to be paranoid about Windows Update, chances are they&#8217;ll leave open some other hole for you to exploit.<br />
4. You could probably detect a program signature in order to compromise only certain software.  For example, VPN software that&#8217;s used by a certain government.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77117">

			<div class="comment by-ronk ">

				<p class="commentcredit">

					<span class="commenter">RonK</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77117">
						December 17, 2007 2:26 PM					</a>

				</p>

				<p>@ Jesse Viviano</p>
<blockquote><p>
  The auditor must search the source code of the program in question for the constant named BCRYPT_RNG_DUAL_EC_ALGORITHM and the string &#8220;DUALECRNG&#8221;
</p></blockquote>
<p>I get the feeling that you don&#8217;t do source code security audits for a living. If I am not mistaken, the BCRYPT_&#8230; constant has a numerical value and your method of auditing would certainly miss the use of the value rather than the constant&#8217;s name. Not to mention that the value (or the string) could be generated by as complex a calculation as you&#8217;d like, rather than just sitting there exposed textually in the source code.</p>
<p>Or am I missing something????</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77118">

			<div class="comment by-jesse-viviano ">

				<p class="commentcredit">

					<span class="commenter">Jesse Viviano</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77118">
						December 17, 2007 2:28 PM					</a>

				</p>

				<p>@Anonymous</p>
<p>The source code audit is for the program calling the random number generator library. If the program calls the normal RNG, Dual_EC_DRBG is not going to get called. Instead, CTR_DRBG with AES or the older FIPS 186-2 RNG will get called, depending on which version of Windows is used. Windows Vista SP1 and later will call CTR_DRBG with AES, while older Windows versions will call the FIPS 186-2 RNG which is based on either DES or SHA-1, which have been both broken.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77119">

			<div class="comment by-jesse-viviano ">

				<p class="commentcredit">

					<span class="commenter">Jesse Viviano</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77119">
						December 17, 2007 2:49 PM					</a>

				</p>

				<p>@RonK</p>
<p>You are right. I am just a graduate student that reads this blog and am trying to clear up the confusion caused by people who read this post and fail to check the sources Schneier posted. You would also need to find out what that constant is. That can be done in one line of code in C++ in a test program:<br />
cout &lt;&lt; &#8220;Constant to avoid: &#8221; &lt;&lt; BCRYPT_RNG_DUAL_EC_ALGORITHM &lt;&lt; &#8216;\n&#8217;;</p>
<p>By the way, Schneier should have made it clear that it is the programmer&#8217;s choice to use this algorithm, not the user&#8217;s choice. I would have written the last line of the blog post like this: Fortunately, Dual_EC_DRBG must be explicitly called by the programmer writing a program. Never call it to generate secure random numbers in your programs.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77120">

			<div class="comment by-jeff-craig ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://blog.foxxtrot.net/' rel='external nofollow ugc' class='url'>Jeff Craig</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77120">
						December 17, 2007 4:03 PM					</a>

				</p>

				<p>@Chris, NIST has already been run over the coals for this algorithm, but to be fair to NIST, the potential vulnerability in it was only discovered well after the NIST report was published.  No one can say definitively if NIST or the NSA were aware of this potential backdoor before it was published.</p>
<p>Just because it was in the NIST report doesn&#8217;t mean that Microsoft had to implement it.  My question is, did they implement it with the seeds published in the NIST document, or did they use their own?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77121">

			<div class="comment by-rob ">

				<p class="commentcredit">

					<span class="commenter">Rob</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77121">
						December 17, 2007 4:23 PM					</a>

				</p>

				<p>@Jesse:</p>
<p>The source code validation won&#8217;t work, even within MS.</p>
<p>One of the security books from MS gives an example. The tool looked for NULL security descriptors in IIS source code. The programmers dutifully removed those from the source, and replaced them with malloc(-1).</p>
<p>Actually making sure it&#8217;s never called with a particular constant is another expression of the halting problem.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77122">

			<div class="comment by-cjhristoph-zurnieden ">

				<p class="commentcredit">

					<span class="commenter">Cjhristoph Zurnieden</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77122">
						December 17, 2007 4:47 PM					</a>

				</p>

				<p>Based on Microsoft&#8217;s long history of &#8220;good idea&#8212;bad implementation&#8221;  and the recently found flaws in w2k&#8217;s crypto-PRNG I cannot recommend any of the offered crypto-PRNGs in Windows, not even the AES based CTR_DRBG. They all might be implemented badly and the necessary tests would be costly and time-consuming.<br />
Or they followed the aforementioned tradition by heart and implemented the backdoors badly too?</p>
<p>The crypto-API in Windows is not usable for anything serious, as is any other closed source cryptographic algorithm.<br />
I have also  trouble finding something that is non-serious but at teh same time in need of weak encryption&#8212;movie spoilers perhaps?</p>
<p>CZ</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77123">

			<div class="comment by-tina-russell ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://tinarussell.wordpress.com/' rel='external nofollow ugc' class='url'>Tina Russell</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77123">
						December 17, 2007 5:06 PM					</a>

				</p>

				<p>Bruce, you&#8217;ve done tremendous work to help preserve our personal freedom and security so pleeeeease encourage good grammar as well! It should be &#8220;never to enable&#8221; it, so as to avoid splitting infinitives. (I know some people crow that the split infinitive as an error is so-o-o passé, but I&#8217;d still advise avoiding it.)</p>
<p>Sorry, I&#8217;m a grammar nut, we&#8217;re like this 😀</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77124">

			<div class="comment by-terry-cloth ">

				<p class="commentcredit">

					<span class="commenter">Terry Cloth</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77124">
						December 17, 2007 6:05 PM					</a>

				</p>

				<p>@CZ:  That&#8217;s what ROT13 is for:  <a href="http://en.wikipedia.org/wiki/Rot13" rel="nofollow ugc">http://en.wikipedia.org/wiki/Rot13</a><br />
About as weak as it gets, but strong enough.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77125">

			<div class="comment by-me ">

				<p class="commentcredit">

					<span class="commenter">Me</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77125">
						December 17, 2007 7:44 PM					</a>

				</p>

				<p>Tina,</p>
<p>I believe splitting the infinitive is more effective here.  &#8220;My advice is never to enable it&#8221; would say that his advice is never that it should be enabled.   This is nuancedly different from saying that he advises someone that this should never be enabled.</p>
<p>Your correction adds ambiguity.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77126">

			<div class="comment by-security ">

				<p class="commentcredit">

					<span class="commenter">security</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77126">
						December 17, 2007 8:05 PM					</a>

				</p>

				<p>To switch off this feature:<br />
You will need a blank cd, cd burner, iso burning software and a some free space on your harddrive.<br />
Goto <a href="http://www.ubuntu.com" rel="nofollow ugc">http://www.ubuntu.com</a> download feisty fawn.<br />
Burn iso to CD<br />
Insert CD<br />
Reboot<br />
Double click icon that installs software</p>
<p>This is all that is needed to ensure a safe OS</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77127">

			<div class="comment by-question ">

				<p class="commentcredit">

					<span class="commenter">Question</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77127">
						December 17, 2007 8:15 PM					</a>

				</p>

				<p>How do you know that they did not just change the old library functions to use the new code?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77129">

			<div class="comment by-jonathan-allen ">

				<p class="commentcredit">

					<span class="commenter">Jonathan Allen</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77129">
						December 17, 2007 9:17 PM					</a>

				</p>

				<p>Oxford, the Chicago Manual of Style, and the Columbia Guide to Standard English Usage all state that it is acceptable to use split infinitives.</p>
<p>No one really knows why the anti-split infinitive movement started in the 19th century, though Columbia states, &#8220;one possibly after-the-fact reason for the objections was that since Latin and Greek infinitives were not (indeed, as single words, could not) be split, neither should English infinitives, even though they often came in two parts, to plus infinitive, and so were vulnerable to being split by adverbs.&#8221;</p>
<p>So complaining about split infinitives is not only &#8220;passé&#8221;, it demonstrates poor grammar.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77130">

			<div class="comment by-rob ">

				<p class="commentcredit">

					<span class="commenter">rob</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77130">
						December 17, 2007 9:49 PM					</a>

				</p>

				<p>I think Jesse is right; the second link (to the API documentation) implies that if I&#8217;m writing code for Vista I&#8217;m allowed to ask for that RNG when creating a struct of type CRYPT_INTERFACE_REG. Its not &#8216;disabled&#8217; in any way, there just (probably) aren&#8217;t any programs that are currently using it.</p>
<p>The real danger of something like this is if it somehow ends up in .NET framework or IE down the road; people programming against the COM interface for IE (or using the browser control in .NET, even old versions) or people writing SSL using the built-ins in .NET could be compromised without knowing it. I think it will be some time before this could happen (keep an eye out to see if its included in XP SP3 next year) but something to keep in the back of one&#8217;s mind when writing applications &#8211; if you want real security, you simply must write it yourself.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77131">

			<div class="comment by-marc ">

				<p class="commentcredit">

					<span class="commenter">marc</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77131">
						December 17, 2007 10:21 PM					</a>

				</p>

				<p>i wonder what we would do without blogs&#8230;</p>
<p>probably less people would know about these things</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77132">

			<div class="comment by-tom ">

				<p class="commentcredit">

					<span class="commenter">Tom</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77132">
						December 18, 2007 12:19 AM					</a>

				</p>

				<p>@Jesse Viviano:</p>
<p>If someone is actively trying to avoid detection there&#8217;s always ways around simple source code searches like that. Here&#8217;s a trivial example:</p>
<p>#define NEW_SECRET_CONST XXX-1</p>
<p>where XXX is BCRYPT_RNG_DUAL_EC_ALGORITHM+1</p>
<p>Probably better to look for the functions that actually use these constants (though even those could be obfuscated easily)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77133">

			<div class="comment by-arne-d-h ">

				<p class="commentcredit">

					<span class="commenter">Arne D H</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77133">
						December 18, 2007 1:06 AM					</a>

				</p>

				<p>Would it be possible to create a peer reviewed, opensource tool to alter vista/xp in security conscious ways, for everyone concerned with security? Such a tool could replace the offending code with a dialog box stating that you are about to do unsafe stuff.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77134">

			<div class="comment by-pedant ">

				<p class="commentcredit">

					<span class="commenter">Pedant</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77134">
						December 18, 2007 2:48 AM					</a>

				</p>

				<p>@marc</p>
<p>Given the tiff earlier over splitting infinitives, perhaps I should point out that you probably mean <i>fewer</i> people, as unless they&#8217;ve been puréed first, people are not a continuous quantity.</p>
<p>On topic, given Peter Gutmann&#8217;s recent presentation (<a href="http://www.cs.auckland.ac.nz/~pgut001/pubs/malware_biz.pdf" rel="nofollow ugc">http://www.cs.auckland.ac.nz/~pgut001/pubs/malware_biz.pdf</a>) , perhaps we should conclude that the Windows OS is irretrievably compromised and that any important information should be processed on hardware dedicated to the job, that has been formally proven to be secure.  That probably discounts anything with a general purpose OS &#8211; including Linux and BSD.</p>
<p>Pedant</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77135">

			<div class="comment by-joachim ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://strombergson.com/kryptoblog/' rel='external nofollow ugc' class='url'>Joachim</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77135">
						December 18, 2007 3:06 AM					</a>

				</p>

				<p>Aloha!</p>
<p>Am I the only one that find it interesting that Microsoft is the employer of Niels Ferguson and Dan Shumow, the two researchers that raised the issue of a possible backdoor in the PRNG?</p>
<p>Are Niels and Dan totally out of the loop @ Microsoft? Why on earth were they hired by MS if their competence and receommendations are not used?</p>
<p>Remember that not long ago weaknesses was found in the PRNG in Win2K and WinXP by Leo Dorrendorf, Zvi Gutterman and Benny Pinkas (<a href="http://eprint.iacr.org/2007/419.pdf" rel="nofollow ugc">http://eprint.iacr.org/2007/419.pdf</a>). These weaknesses MS claimed was fixed in Vista and XP by &#8220;various changes and enhancements to the random number generator.&#8221;</p>
<p>Why on earth does not MS use Yarros/Fortuna when they have Niels on the payroll? And why introduce a new, optional PRNG the same staff members warns about?</p>
<p>Yes, NIST have some explaining to do, but MS behaviour is IMHO <em>really</em> weird.</p>
<p>BTW: Have anybody seen any official response by NIST on the Dual_EC_DRBG issue? Are they following the duck and cover-routine?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77136">

			<div class="comment by-stevej ">

				<p class="commentcredit">

					<span class="commenter">SteveJ</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77136">
						December 18, 2007 5:06 AM					</a>

				</p>

				<p>I don&#8217;t really understand the criticism of MS here. Well, I kind of do, but I don&#8217;t think it&#8217;s justified.</p>
<p>Have any of the people saying that MS are in the wrong on this, or malicious, or whatever, actually ever implemented a published standard as a software library before? I have. It doesn&#8217;t matter whether you think some part of the specification is stupid, or harmful, or that no programmer should ever use it. You still include it, because otherwise you aren&#8217;t implementing the standard.</p>
<p>If MS are going to implement a NIST standard, they should do that, not just implement the bits we or they prefer. If anything, it&#8217;s good news that, just for once, they aren&#8217;t &#8220;tweaking&#8221; the spec to their own corporate preferences.</p>
<p>It would be even better news if MS documented it with a note that it may be cracked, but ultimately it&#8217;s the programmer&#8217;s decision whether to use a particular &#8220;feature&#8221; or not. If your program needs to generate the same sequence of numbers as some other thing which is using Dual_EC-DRBG, then you need an implementation of the algorithm. MS don&#8217;t know whether the pseudo-randomness of the sequence is security-critical or not, so why is it their job to try to stop you?</p>
<p>You&#8217;ll note that linux distributions still include the &#8220;md5sum&#8221; utility, despite the fact that MD5 probably should not longer be considered a secure hash function. That doesn&#8217;t mean GNU or the distributions are creating security flaws in linux, it just means they think you might some day need to compute an MD5 sum.</p>
<p>Bruce&#8217;s advice is spot on &#8211; he said not to use the algorithm. He didn&#8217;t say freak out and panic that MS are up to something.</p>
<p>I&#8217;m sure he&#8217;d advise not to use DSA or MD5 or ROT13 either, but I bet there are implementations of those algorithms in several OSs.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77137">

			<div class="comment by-stevej ">

				<p class="commentcredit">

					<span class="commenter">SteveJ</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77137">
						December 18, 2007 5:18 AM					</a>

				</p>

				<p>Sorry, when I said &#8220;DSA&#8221; above, I meant to say &#8220;the original DSA in FIPS 186&#8221;. I didn&#8217;t mean to imply that the general algorithm of DSA is ineffective, just the 512-bit keys permitted in FIPS 186 and later deprecated.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77138">

			<div class="comment by-greg ">

				<p class="commentcredit">

					<span class="commenter">greg</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77138">
						December 18, 2007 6:09 AM					</a>

				</p>

				<p>@Joachim<br />
MS has a very large R&amp;D department. They produce some fantastic work. But they are pretty much independent of the OS development.</p>
<p>Question to all. Why would someone use windows when security is a high priority? No I don&#8217;t mean linux vrs windows flames wars, I mean live update and the general setup where M$ does not trust the <em>user</em> or <em>owner</em>. There are a lot of systems out there all with there benefits and cost. Only use windows where you only need &#8220;adequate&#8221; security. Example I only use windows to play games.</p>
<p>But lets face it, if NSA is part of our threat model there are far more serious flaws in windows than the RND generator.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77139">

			<div class="comment by-frymaster ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.127001.org' rel='external nofollow ugc' class='url'>Frymaster</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77139">
						December 18, 2007 6:41 AM					</a>

				</p>

				<p>a few comments:</p>
<p>Yes, someone could get around a source code audit quite easily if the wanted to use flawed RNG algorithms; they could do that anyway using ANY flawed RNG (or reimplementing the algorithm themselves).  Wanting to get round it implies knowing the implications of their action and deliberately choosing to do The Wrong Thing in the face of moral, professional, and managerial objections.</p>
<p>It would be nice if IDEs flagged the use of these things automatically (a bit like &#8220;deprecated&#8221; classes and methods) but if you&#8217;re savvy enough to be choosing your own RNG you can probably google search the name of it and figure this out for yourself</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77140">

			<div class="comment by-brian-boyko ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.followingalexiswest.com' rel='external nofollow ugc' class='url'>Brian Boyko</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77140">
						December 18, 2007 7:27 AM					</a>

				</p>

				<p>Not to put too fine a point on this &#8211; but if random number generation is a massively important task for computers to handle, why can&#8217;t we hook up a little d20 to a PCMCIA slot and be done with it?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77141">

			<div class="comment by-rob ">

				<p class="commentcredit">

					<span class="commenter">rob</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77141">
						December 18, 2007 8:13 AM					</a>

				</p>

				<p>I agree, Microsoft really isn&#8217;t to blame for this, NIST is. If there is a question about the algorithm they shouldn&#8217;t endorse it.</p>
<p>Any real threat here boils down to a lack of instutitional memory &#8211; obviously MS has a lot of smart people on the payroll, and the comment that they were just implementing the spec is valid. The problem is inadequate communication and documentation. Two years from now when someone decides to put a new RNG to put in IE 47.x, who is going to remember that there is a question about this algorithm? And if some sort of doomsday scenario were to happen and I wrote some code where I used a library function to communicate and my security was compromised, I could of course blame microsoft who could blame NIST, but none of that helps anyone.</p>
<p>I poked around my ubuntu system and the web last night looking for references to this RNG in common linux software and the ubuntu dist in particular but couldn&#8217;t find much. I did notice that there are some elliptical-curve RNG algorithms in use but could not easily determine if any of them were the one in question. I think the danger is just as present in any other OS as in Vista, though perhaps it will not be present in as short a time.</p>
<p>I also wonder if there&#8217;s a way to detect this algorithm in use, and really don&#8217;t have the expertise to give a straight answer on that, but my feeling is &#8216;probably no.&#8217; If it gets implemented in a library function, or gets swapped for the default in TPM, I doubt that your run-of-the-mill developer will notice. I wouldn&#8217;t notice, and I write code using Microsoft&#8217;s encryption library from time to time.</p>
<p>I guess it may be time to write an open-source SSL implementation for Windows that doesn&#8217;t use any built-in functions.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77142">

			<div class="comment by-tommy ">

				<p class="commentcredit">

					<span class="commenter">tommy</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77142">
						December 18, 2007 8:37 AM					</a>

				</p>

				<p>what kind of national secrets are you all so worried about protecting? i understand snooping is wrong, but what are they going to find out? you&#8217;re itunes playlist? your kids soccer schedule??</p>
<p>paranoid nerds!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77143">

			<div class="comment by-carlo-graziani ">

				<p class="commentcredit">

					<span class="commenter">Carlo Graziani</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77143">
						December 18, 2007 10:15 AM					</a>

				</p>

				<p>I wonder what a FOIA request for documents related to the Standard-setting process undergirding Dual_EC-DRBG would show.  If there is even one elision from a document, or one document request refused on grounds of National Security, that would pretty much settle the &#8220;surreptitious back door&#8221; question.</p>
<p>Bruce, do you do FOIA requests?  Or, do you talk to people who do?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77144">

			<div class="comment by-garrett-g ">

				<p class="commentcredit">

					<span class="commenter">Garrett G.</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77144">
						December 18, 2007 10:26 AM					</a>

				</p>

				<p>Microsoft has (finally!) taken security far more seriously than in the past. I believe this trend began in 2003, when Gates ordered every s/w engineer in the company to attend mandatory security training (how many s/w companies do that?). Vista adds significant security enhancements to the OS, including randomization of library addresses, reduced privs for many services, and many others. Also, why would Ms take the substantial risk of cooperating w/ the NSA, esp given what happen to telecoms that did so? That would be stupid from a business standpoint.</p>
<p>Some of the vents against MS actually contain valid points. But does that mean that MS is culpable in this particular regard (absolving NIST of any responsibility)? I think not.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77145">

			<div class="comment by-mrdude ">

				<p class="commentcredit">

					<span class="commenter">MrDude</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77145">
						December 18, 2007 10:27 AM					</a>

				</p>

				<p>@Carlo Graziani</p>
<p>I like it. A question where &#8220;I will not answer that question&#8221; answers the question&#8230;..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77146">

			<div class="comment by-markus ">

				<p class="commentcredit">

					<span class="commenter">markus</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77146">
						December 18, 2007 10:37 AM					</a>

				</p>

				<p>@tommy<br />
OK. Again someone of the &#8220;nothing to hide&#8221; fraction. Probably your itunes playlist isn&#8217;t that interesting, but would you want your bank account to be read by somebody? As you may or may not know, a breakable RNG is not that bad in the random-playback of itunes, as it may make your next song predictable, but come on, do you really think people who implement backdoors in algorithms are interested in that kind of data?</p>
<p>THINK about it!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77147">

			<div class="comment by-greg ">

				<p class="commentcredit">

					<span class="commenter">Greg</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77147">
						December 18, 2007 10:45 AM					</a>

				</p>

				<p>@Garrett G.</p>
<p>Of course M$ is taking security seriously. They don&#8217;t want us cracking &#8220;trusted computing&#8221; do they&#8230;. They want us, the user, out of the loop.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77148">

			<div class="comment by-karrick ">

				<p class="commentcredit">

					<span class="commenter">Karrick</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77148">
						December 18, 2007 10:53 AM					</a>

				</p>

				<p>&#8220;Anyone who runs Windows is a fscking schmuck and deserves what they get for their poor choice in operating systems.&#8221;<br />
    &#8212; Grandma</p>
<p>I&#8217;m still concerned because many people do not voluntarily use said operating system at home, but have no alternate at work.  What about schools and libraries?  Whether some computer users use the above operating system or not is pointless.  Whatever is used by the masses becomes the standard, and interoperability will be the double-edged knife that will bring this back around to haunt those who attempt to stay ahead of the vulnerability curve by using non-main-stream-vendor supplied software.</p>
<p>The adoption of this by the main-stream operating system vendor means that within 5 years it likely will be in other operating systems in one form or another.</p>
<p>This will only result in the systematic weakening of encrypted communications by private parties.</p>
<p>&#8220;what kind of national secrets are you all so worried about protecting? i understand snooping is wrong, but what are they going to find out? you&#8217;re itunes playlist? your kids soccer schedule??&#8221;<br />
    &#8212; tommy</p>
<p>I will state first hand that most people in government service just want to serve their fellow citizen and make their country better.  Indiscriminate use of technology to monitor the day-to-day lives of citizens does not promote individual liberties and human rights.  There are many news reports of persons in various countries who are imprisoned and tortured for their beliefs.  How long before <em>your</em> beliefs are in opposition to the ruling party of your government?  If this question does not make you pause, then I sincerely question the depth of your perspective.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77150">

			<div class="comment by-garrett-g ">

				<p class="commentcredit">

					<span class="commenter">Garrett G.</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77150">
						December 18, 2007 11:31 AM					</a>

				</p>

				<p>Oh, I should also add that we should logically think of security (or any specific subject) within a broader context. I.e., rather than thinking about security within the context of security (a narrow focus) or thinking about security within the context of information technology (a slightly less narrow focus), it&#8217;s helpful to think about security within the context of everything else (to borrow Thomas Barnett&#8217;s terminology).</p>
<p>In the case of Microsoft, they&#8217;ve put a large focus on securing their software. Why? The answer is primarily economic. They have a lot (of money) to lose if Microsoft continues to experience s/w holes (like buffer overflow vulnerabilities) on a massive scale. Hence, MS added support for NX/XD (DEP) in SP2 of XP and have added more infrastructure-hardening capabilities in Vista (yes, in addition to the obvious one: UAC). The motivation behind this was primarily business, so it&#8217;s helpful to see that perspective as part of the big picture.</p>
<p>I.e., security within the context of everything else (namely business, in this case). Which, by the way, Schneier seems to have a knack for, in my humblest of opinions.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77151">

			<div class="comment by-simon ">

				<p class="commentcredit">

					<span class="commenter">simon</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77151">
						December 18, 2007 11:47 AM					</a>

				</p>

				<p>@flamers</p>
<p>If I were Bruce, I&#8217;d close comments. Can&#8217;t even nerd stuff like PRGNs live without M$/Linux flames and STFU use?<br />
Anyone may avoid it altogeher with the CryptoAPI stuff which is suspicious anyway if you are really concerned (or paranoid). Or permutate the data it outputs until oblivion. MS may not exactly be about choice, but who wants has every possibility.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77152">

			<div class="comment by-maelcum ">

				<p class="commentcredit">

					<span class="commenter">maelcum</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77152">
						December 18, 2007 11:52 AM					</a>

				</p>

				<p>Kool &#8211; paying for (nsa) backdoors &#8211; M$ just s**ks<br />
I got nothing to hide so i use sidux or debian, its free and modular.<br />
I hope Vista will be the last os out of Redmond, its just bloated slow ugly and too expensive for this code crap. If the government is reading my mails I want to read theirs too!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77153">

			<div class="comment by-garrett-g ">

				<p class="commentcredit">

					<span class="commenter">Garrett G.</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77153">
						December 18, 2007 11:55 AM					</a>

				</p>

				<p>@Simon</p>
<p>I agree w/ your sentiment. But turning off comments isn&#8217;t the answer, in my view. After all, flamers get the attention, but those with real insight ultimately get respect. With an interactive blog, you get both the good &amp; the bad; the result is, I&#8217;d argue, often a &#8220;net good&#8221;; flamers&#8217; comments are easily skipped (with the apropos sigh) while those with substantial insight are rewarded with readership and interest in their ideas.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77154">

			<div class="comment by-bill-payne ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://prosefights.org' rel='external nofollow ugc' class='url'>bill payne</a></span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77154">
						December 18, 2007 11:57 AM					</a>

				</p>

				<p>Do you know?</p>
<p>How the Iraq/Iran War Got Started</p>
<p><a href="http://www.prosefights.org/thecanadian/thecanadian.htm#gotstarted" rel="nofollow ugc">http://www.prosefights.org/thecanadian/thecanadian.htm#gotstarted</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77155">

			<div class="comment by-simon ">

				<p class="commentcredit">

					<span class="commenter">Simon</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77155">
						December 18, 2007 12:25 PM					</a>

				</p>

				<p>@Garret</p>
<p>You&#8217;re very right, it&#8217;s not the answer. But it seems skipping those &#8216;comments&#8217; is easier for you than for me (guess I&#8217;ll have to work on that).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77156">

			<div class="comment by-d0c0 ">

				<p class="commentcredit">

					<span class="commenter">d0c0</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77156">
						December 18, 2007 1:15 PM					</a>

				</p>

				<p>Someone wrote:<br />
   You know what would be scary? If they<br />
   secretly started using this algorithm&#8230;.</p>
<p>You know what would be even scarier? If it turns out that ANY OF YOU thinks that a packetized communications system &#8212; oh, sorry, I mean THE packetized communications system &#8212; was designed and developed for ANY REASON other than making it easier for the DOUBLE SECRET POLICE to not only your mail and listen to your conversations, but to control your computers.</p>
<p>But there&#8217;s a FUNNY side, too&#8230; namely, the fact that you&#8217;ve been convinced to PAY FOR IT &#8211; the whole frigging thing &#8211; out of your own pockets.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77157">

			<div class="comment by-andy-p ">

				<p class="commentcredit">

					<span class="commenter">Andy P.</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77157">
						December 18, 2007 4:32 PM					</a>

				</p>

				<p>Maybe i&#8217;ve got something wrong, so please correct me: By writing RNG  here is really meant a PRNG, not a true RNG?<br />
I&#8217;m remember to be teached, there is no possibilitiy to build a true RNG in software on a deterministic maschine like a standard PC (without an extra RNG in Hardware).<br />
I know, there are PRNGs which cannot  hardly distinguished  from a true RNG, looking at the output, but looking from the mathematical point of view, there are &#8220;only&#8221; PRNGs.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77158">

			<div class="comment by-jesse-viviano ">

				<p class="commentcredit">

					<span class="commenter">Jesse Viviano</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77158">
						December 18, 2007 5:48 PM					</a>

				</p>

				<p>@Andy P.<br />
There are ways to write true random number generators for computers. However, this requires a source of chaos, like interrupts generated by the network card, the time it takes your hard disk to send the first byte of a file after a request is made (this depends on the position of the disk being read and the file&#8217;s first sector, which the OS has no control of and therefore is a valid source of chaos), the keyboard, and the mouse. The latter two require a human to be using the computer, but without some hardware noise generator, these are the best sources of chaos the computer can use. Using this chaos, a true RNG can be made.</p>
<p>One could argue that a harware RNG would be better, but the only way to ensure that a hardware RNG does not contain some trap the hardware vendor could use to break anything using it is to see the source code, so hardware RNGs are not as trustable as a keyboard and mouse (unless the hardware vendor GPL&#8217;s the hardware source like Sun does on some of its CPUs).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77159">

			<div class="comment by-andy-p ">

				<p class="commentcredit">

					<span class="commenter">Andy P.</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77159">
						December 18, 2007 7:14 PM					</a>

				</p>

				<p>@Jesse Viviano<br />
This is what I exactly learned to be a PRNG: an algorithm to spread the few bits of chaotic bits of input (as known as entropy) to create random values, using the avalance effect of i.e. a chiffre. All PRNG have something in common: If you try to get more random numbers from the PRNG that the entropy can substitue either the PRNG is blocked/empty or provide non random numbers. This doesn&#8217;t happen per se to a true RNG (i.e. build around a noisy transistor or something similar). I admit that the PRNGs used today are random enough from the practical point of view. But looking from the mathematic POV it is still a deterministic black box with something rare random input. As I learned sometimes long ago as a dogma: &#8220;there is no way to implement a RNG in a deterimistic machine&#8221;. But maybe this dogma is now proven wrong?<br />
I also admit your concern about the hardware trap, so for practical reasons, an PRNG in OS seems to be the easiest way to produce random numbers today.<br />
Maybe sometimes will simple hardware RNGs be a standard feature of any chipset or CPU: all you need are a few transistors for a CPU-readeable shift register, clocked by FSB and filled by 1bit digitised thermal noise from a  PN-border of a semiconductor. Estimated costs: 10 cent. Profit: a true marketing feature. Gain: no hassle about the entropy of PRNGs, because a  tricked input is by far more expensive to build than this.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77160">

			<div class="comment by-jesse-viviano ">

				<p class="commentcredit">

					<span class="commenter">Jesse Viviano</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77160">
						December 18, 2007 11:18 PM					</a>

				</p>

				<p>@Andy P.</p>
<p>The difference between a true software RNG and a PRNG is that a PRNG might take some seed data in the beginning and never takes any input after that. RC4, Blum Blum Shub, and a block cipher run in either OFB a.k.a. output feedback mode or CTR mode a.k.a. counter mode. In short, a PRNG will always generate the same sequence of bits if it is given the same initial seed. A true software RNG will use some source of chaos to continuously reseed the algorithm and will block if there is no more chaos to use, resulting in unpredictable output every time.</p>
<p>According to Wikipedia, Linux was the first OS to implement such a true software random number generator in its implementation of /dev/random/, though the first version is considered either weak or broken. I do not know if this has been fixed. Thanks to Schneier&#8217;s warning and recommendation, it might be fixed to use CTR_DRBG with AES if it needs fixing. AFAIK, the first version was made more complicated than it should be to avoid formerly overly-strict encryption export laws which have been relaxed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77161">

			<div class="comment by-jeff-williams ">

				<p class="commentcredit">

					<span class="commenter">Jeff Williams</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77161">
						December 19, 2007 12:28 AM					</a>

				</p>

				<p>I agree with the never activating this.<br />
What&#8217;s even worse is that the NSA&#8217;s<br />
own DNS is grossly misconfigured.<br />
See:<a href="http://private.dnsstuff.com/tools/dnsreport.ch?domain=nsa.gov&#038;token=059017354832148e074150741f48e019" rel="nofollow ugc">http://private.dnsstuff.com/tools/dnsreport.ch?domain=nsa.gov&#038;token=059017354832148e074150741f48e019</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77162">

			<div class="comment by-seb ">

				<p class="commentcredit">

					<span class="commenter">seb</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77162">
						December 19, 2007 3:42 AM					</a>

				</p>

				<p>Is it possible to remove the corresponding file containing the new code or to manually corrupt the section in the file containing the code so that program calls to the weaker RNG would cause an error or a program crash &#8211;so at least calls would be noticed?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77163">

			<div class="comment by-ninho ">

				<p class="commentcredit">

					<span class="commenter">Ninho</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77163">
						December 19, 2007 6:00 AM					</a>

				</p>

				<p>@Andy P : modern PC-chipsets have embedded the kind of RNG you describe, even before the &#8220;TPM&#8221;. The SiS based PC on which I&#8217;m typing has one. It works more or less like you imagined, clocked by the FSB (or optionnaly by the much slower USB clock), shifting 1 bit per clock into a 32-bit register in PCI space.</p>
<p>Only &#8220;small&#8221; problem, such components are chipset make and model specific, hence difficult to use (other than in the BIOS or motherboard specific drivers).</p>
<p>What is more, the specs are often closely kept by the manufacturers &#8211; delivered only on condition of no diclosure, and effectively difficult to reach at for the ordinary programmer/hacker.</p>
<p>And even though I got the programming spec for mine, there is no hint of the physical source of the &#8220;random&#8221; bits &#8211; all I can say is they did well against the standard &#8220;diehard&#8221; tests.</p>
<p>&#8212;<br />
Ninho</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77164">

			<div class="comment by-danny ">

				<p class="commentcredit">

					<span class="commenter">Danny</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77164">
						December 19, 2007 6:58 AM					</a>

				</p>

				<p>Conspiracy theory: NSA insists on including Dual_EC-DRBG knowing full well that nobody will use it, to drive people towards the that OTHER available PRNG, to which NSA also have a backdoor :).</p>
<p>Like the &#8220;pen&#8221; example they use in marketing classes: if you have two sorts of pens on the shelf, people will buy the cheaper one. To sell the pricy one, add an even more expensive one to the shelf. You&#8217;ll never sell one of those, but sales of the pen now priced &#8220;in the middle&#8221; will skyrocket.</p>
<p>So by adding a known poor PRNG &#8220;underneath&#8221;, are we to be driven towards the other PRNG, whose faults are known only to the spooks, maybe ?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77165">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77165">
						December 19, 2007 7:29 AM					</a>

				</p>

				<p>@Jesse, Rob,</p>
<p>&#8220;One of the security books from MS gives an example. The tool looked for NULL security descriptors in IIS source code. The programmers dutifully removed those from the source, and replaced them with malloc(-1).&#8221;</p>
<p>This use asside malloc() should never be used in security related software (and what usefull software is not security related these days).</p>
<p>It has been known for a long time that malloc() is a security problem.</p>
<p>Many moons ago SUN had a problem with one of its stock programs. It was reported that it was leaking the tail end of the password file to the user (and others).</p>
<p>What was happening was that the programer had used malloc() to create a buffer into which the password file was read. When that part of the prog had finished it released the memory.</p>
<p>The program then almost imediately called malloc() to create a new buffer and was handed a pointer back to the memory that had been previously used.</p>
<p>Under certain circumstances the buffer was either not or only partialy overwritten with new data, the buffer was then flushed out in it&#8217;s entirety thus leaking the tail end of the password file.</p>
<p>The solution was to replace malloc() with calloc(). For more details see the book &#8220;Deep C Secrets&#8221;.</p>
<p>However you should not use any of the malloc family in this way as they will still not clear the data from the buffer when you free it and there is no gaurenty that other parts of the program (or other programs) will not get handed the memory with the data in it.</p>
<p>The correct thing to do is to clear all alloced memory before you free it (also make sure that compiler does not optimize this step out).</p>
<p>As you can apriciate this is a real problem in Object Orientated programing and code that uses multithreading.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77166">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77166">
						December 19, 2007 7:39 AM					</a>

				</p>

				<p>@ALL</p>
<p>Under no circumstances write your own RNG be it PRNG or TRNG it might look simple but belive me it is not, most people (even some large electronics corps/comps) get it wrong in one way or another.</p>
<p>IF you don&#8217;t accept the above at least please read Ross J Anderson&#8217;s book (security Engineering) Bruce and Neils book and Vol 2 of Knuth&#8217;s Art of Computer Programing, and then please thing again</p>
<p>Oh and finaly if you still want to do it please do not come running back with tails of woe about how you product was compromised.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77167">

			<div class="comment by-hali ">

				<p class="commentcredit">

					<span class="commenter">Hali</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77167">
						December 19, 2007 12:03 PM					</a>

				</p>

				<p>At the moment I am not exactly at the point to see the backdoor clearly.<br />
The call of simple rand() to generate a random number, for example as a password key for AES to be transfered to the client through a DH channel seems to be a bad idea, because the rand() algorithm must be initialisied, and if the initialised number is known, everything is broken.<br />
So most programmes hopefully join more than one scource of random numbers (SHA/MD5), to hope that at least one source is okay (rand() + PIDs + type speed, mouse-position, hardware-generators iv avaliable). In this scenario I don&#8217;t see a deep problem of a backdoor as a &#8220;weak algorithm&#8221;. Even if the backdoor will send the random number to NSA by internet, they will only know one random number before the hash function.</p>
<p>Where exactly is the problem in this case, if nobody really knows if there is backdoor or not.<br />
If there is no backdoor, the source of a new (probably good) random algorithm is born.<br />
If there is a backdoor, this random number has the same worth like a rand() call.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77168">

			<div class="comment by-simon ">

				<p class="commentcredit">

					<span class="commenter">simon</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77168">
						December 20, 2007 6:08 AM					</a>

				</p>

				<p>@hali</p>
<p>the provlem is: you can derive the whole iv from looking at few (unabridged) output bytes, and thus predict the wohle sequence (very bad!).<br />
The backdoor is not like in subseven, more like in DES. (If that helps you)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77169">

			<div class="comment by-hali ">

				<p class="commentcredit">

					<span class="commenter">Hali</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77169">
						December 20, 2007 6:38 AM					</a>

				</p>

				<p>@Simon<br />
Thanks a lot, that was helpful to categorize the problem.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77170">

			<div class="comment by-notanyspam ">

				<p class="commentcredit">

					<span class="commenter">notanyspam</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77170">
						December 20, 2007 3:11 PM					</a>

				</p>

				<p>Speaking of encryption and related algorithms, does anyone know of a <em>well-reviewed</em> library implementing symmetric ciphers and chaining modes? There seem to be many libraries (e.g., libtomcrypt, libgcrypt), but precious little information about who&#8217;s reviewed them and how.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77171">

			<div class="comment by-adri ">

				<p class="commentcredit">

					<span class="commenter">Adri</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77171">
						December 20, 2007 3:33 PM					</a>

				</p>

				<p>This will make me switch to linux/mac, but I got no money for macs, and no time to learn linux codes&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77172">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77172">
						December 21, 2007 4:03 PM					</a>

				</p>

				<p>@Adri:<br />
&#8220;no time to learn linux codes&#8221;</p>
<p>If you can&#8217;t use Ubuntu, you&#8217;re probably in a coma or cave. Even the elderly are using Ubuntu Linux, get with the program!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77173">

			<div class="comment by-rngdev ">

				<p class="commentcredit">

					<span class="commenter">rngdev</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77173">
						December 22, 2007 8:42 AM					</a>

				</p>

				<p>unix, linux, mac, clones and the like&#8217;s, all have had severe issues with RNG&#8217;s/PRNG&#8217;s .. there are several available distro&#8217;s available just now which have issues with their RNG&#8217;s/PRNG&#8217;s. &#8211; There has been just as many bugs and security flaws in the unix clone world as in the world of windows, they are just fixed much faster and have much less impact on the world.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77174">

			<div class="comment by-john-smith ">

				<p class="commentcredit">

					<span class="commenter">John Smith</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77174">
						January 2, 2008 2:39 PM					</a>

				</p>

				<p>Where can you buy a laptop without paying for microsoft software?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77177">

			<div class="comment by-fud ">

				<p class="commentcredit">

					<span class="commenter">fud</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77177">
						March 19, 2008 11:34 AM					</a>

				</p>

				<p>this news is pure FUD.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77178">

			<div class="comment by-suc ">

				<p class="commentcredit">

					<span class="commenter">suc</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77178">
						March 19, 2008 11:35 AM					</a>

				</p>

				<p>it&#8217;s part of a standard hence why MS is adding the function to the OS</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77179">

			<div class="comment by-wack ">

				<p class="commentcredit">

					<span class="commenter">wack</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77179">
						March 30, 2008 1:18 AM					</a>

				</p>

				<p>If MS is adding Dual_EC_DRBG just because its a Standard despite its vulnerablility, then MS cryptographic department is stupid.</p>
<p>Either that or they are claiming ignorance for sinister benefits.</p>
<p>And there are stories of USA spying on foreign technology companies and passing on the information to local ones.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77180">

			<div class="comment by-reality-check ">

				<p class="commentcredit">

					<span class="commenter">reality check</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77180">
						April 8, 2008 4:46 AM					</a>

				</p>

				<p>ok..ive been looking at CNG &#8211; the suitB support, ecc etc etc&#8230;on the face of it, it looks cool&#8230;</p>
<p>As usual I im having great issues with finding out exactly how to replace the PRNG (Random number generator) for some of the very reasons highlighted in this blog&#8230;</p>
<p>Anyone have experience (if there is such a thing yet of doing this?)</p>
<p>Im trying to replace the windows RNG with a custom one&#8230;my idea is to create a .dll that utilises soap which in turn calls my authentication server &#8211; running a hardware RNG service (HSM).  I have already replaced the windows revocation provider to utilise my own x509 certificate checks but this was with CAPI not CNG.</p>
<p>Any ideas or pointers (MSDN already used, googled, etc..)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77181">

			<div class="comment by-roberto ">

				<p class="commentcredit">

					<span class="commenter">roberto</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77181">
						April 23, 2008 9:53 AM					</a>

				</p>

				<p>should it not be enough to hexedit the dll or where else the library call is hosted, change a letter in the function call name, save it and do such that the file will not be replaced by the backped one by the system, nor replaced in upgrades. yes, crash of the bad programs will happen, that&#8217;s ok.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77182">

			<div class="comment by-hook ">

				<p class="commentcredit">

					<span class="commenter">Hook</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77182">
						May 6, 2008 5:43 PM					</a>

				</p>

				<p>Intel was supposed to include a true RNG device in their chipset almost 10 years ago.  It was going serial shift quantum noise from a forward biased diode as the above poster talked about.</p>
<p>Why isn&#8217;t this a standard part of the IA32/64 instruction set, implemented in hardware using quantum noise?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77183">

			<div class="comment by-nicholas-parimore ">

				<p class="commentcredit">

					<span class="commenter">Nicholas Parimore</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77183">
						November 22, 2008 2:30 PM					</a>

				</p>

				<p>Yes, Intel did include RNG on some chips, but VIA has the one you want. Their C7 processors have dual-TRNG&#8217;s that can reach Mbit/s speeds. Also have hardware support for AES, SHA1/SHA256, and some RSA and public key ops. Did I mention it comes with those $200 Everex Walmart PC&#8217;s? Can anyone say &#8220;cheap crypto server?&#8221;</p>
<p>VIA Padlock Security Engine: <a href="http://www.via.com.tw/en/initiatives/padlock/hardware.jsp" rel="nofollow ugc">http://www.via.com.tw/en/initiatives/padlock/hardware.jsp</a></p>
<p>Cryptography Research&#8217;s Analysis of VIA TRNG: <a href="http://cryptography.com/research/evaluations.html" rel="nofollow ugc">http://cryptography.com/research/evaluations.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-77184">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77184">
						November 23, 2008 11:15 AM					</a>

				</p>

				<p>@ Nicholas Parimore,</p>
<p>&#8220;Yes, Intel did include RNG on some chips, but VIA has the one you want. Their C7 processors have dual-TRNG&#8217;s that can reach Mbit/s speeds. Also have hardware support for AES, SHA1/SHA256, and some RSA and public key ops.&#8221;</p>
<p>Yup the c7&#8217;s used to be on low cost low power boards as well and i that form where very cost effective in bespoke kit.</p>
<p>Unfortunatly the &#8220;atom&#8221; appears to be the current favourate flavour, which means big re-work comming over the horizon 8(</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-77185">

			<div class="comment by-test ">

				<p class="commentcredit">

					<span class="commenter">test</span> •

					<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/#comment-77185">
						April 1, 2014 2:39 AM					</a>

				</p>

				<p>My Adobe Reader 11.0 contains a file named ccme_ecdrbg.dll</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2007/12/dual_ec_drbg_ad.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2007/12/dual_ec_drbg_ad.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2007%2F12%2Fdual_ec_drbg_ad.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2007/12/dual_ec_drbg_ad.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='1973' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2007/12/friday_squid_bl_99.html" rel="prev">← Friday Squid Blogging: Squids in Medicine</a>		<a href="https://www.schneier.com/blog/archives/2007/12/new_identity_th.html" rel="next">New Identity Theft Tool →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
