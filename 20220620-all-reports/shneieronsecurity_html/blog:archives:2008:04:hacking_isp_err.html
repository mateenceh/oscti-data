<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Hacking ISP Error Pages - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Hacking ISP Error Pages Comments Feed" href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/2215" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=2215' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2008%2F04%2Fhacking_isp_err.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2008%2F04%2Fhacking_isp_err.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-2215 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-2215" class="post-2215 post type-post status-publish format-standard hentry category-uncategorized tag-dns tag-hacking tag-isps tag-malware tag-phishing tag-spam">

	<div class="article">

		<h2 class="entry">Hacking ISP Error Pages</h2>
		<p><a href="http://.wired.com/27bstroke6/2008/04/isps-error-page.html">This</a> is a big deal:</p>
<blockquote><p>At issue is a growing trend in which ISPs subvert the Domain Name System, or DNS, which translates website names into numeric addresses.</p>
<p>When users visit a website like Wired.com, the DNS system maps the domain name into an IP address such as 72.246.49.48. But if a particular site does not exist, the DNS server tells the browser that there&#8217;s no such listing and a simple error message should be displayed.</p>
<p>But starting in August 2006, Earthlink instead intercepts that Non-Existent Domain (NXDOMAIN) response and sends the IP address of ad-partner Barefruit&#8217;s server as the answer. When the browser visits that page, the user sees a list of suggestions for what site the user might have actually wanted, along with a search box and Yahoo ads.</p>
<p>The rub comes when a user is asking for a nonexistent subdomain of a real website, such as http://webmale.google.com, where the subdomain webmale doesn&#8217;t exist (unlike, say, mail in mail.google.com). In this case, the Earthlink/Barefruit ads appear in the browser, while the title bar suggests that it&#8217;s the official Google site.</p>
<p>As a result, all those subdomains are only as secure as Barefruit&#8217;s servers, which turned out to be not very secure at all. Barefruit neglected basic web programming techniques, making its servers vulnerable to a malicious JavaScript attack.  That meant hackers could have crafted special links to unused subdomains of legitimate websites that, when visited, would serve any content the attacker wanted.</p>
<p>The hacker could, for example, send spam e-mails to Earthlink subscribers with a link to a webpage on money.paypal.com. Visiting that link would take the victim to the hacker&#8217;s site, and it would look as though they were on a real PayPal page.</p>
<p>Kaminsky demonstrated the vulnerability by finding a way to insert a YouTube video from 80s pop star Rick Astley into Facebook and PayPal domains. But a black hat hacker could instead embed a password-stealing Trojan. The attack might also allow hackers to pretend to be a logged-in user, or to send e-mails and add friends to a Facebook account.</p>
<p>Earthlink isn&#8217;t alone in substituting ad pages for error messages, according to Kaminsky, who has seen similar behavior from other major ISPs including Verizon, Time Warner, Comcast and Qwest.</p></blockquote>
<p>Another <a href="http://www.theregister.co.uk/2008/04/20/kaminsky_demo_at_toorcon/">article</a>.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/dns/" rel="tag">DNS</a>, <a href="https://www.schneier.com/tag/hacking/" rel="tag">hacking</a>, <a href="https://www.schneier.com/tag/isps/" rel="tag">ISPs</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/phishing/" rel="tag">phishing</a>, <a href="https://www.schneier.com/tag/spam/" rel="tag">spam</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html" rel="bookmark">Posted on April 24, 2008 at 6:43 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html#comments">42 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html" data-title="Hacking ISP Error Pages" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-87085">

			<div class="comment by-sean ">

				<p class="commentcredit">

					<span class="commenter">Sean</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87085">
						April 24, 2008 7:27 AM					</a>

				</p>

				<p>I&#8217;ve seen this is the UK on AOL and Claranet.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87086">

			<div class="comment by-d ">

				<p class="commentcredit">

					<span class="commenter">D</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87086">
						April 24, 2008 7:38 AM					</a>

				</p>

				<p>Time warner started doing the same thing a while back.  They do give you an option to opt out, which is tracked by IP I believe, but they do not advertise it very well.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-87087">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87087">
						April 24, 2008 7:53 AM					</a>

				</p>

				<p>Just another reason to be running your own cache. While these days the ISPs are delibrately subverting things, in the past their caches were vulnerable to poisoning.<br />
Until they start putting in transparent DNS proxies, running your own caching name server will save you some grief.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87088">

			<div class="comment by-matthew-schinckel ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://schinckel.net' rel='external nofollow ugc' class='url'>Matthew Schinckel</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87088">
						April 24, 2008 7:58 AM					</a>

				</p>

				<p>@Anonymous</p>
<p>But who, other than us nerds, is able to actually keep something like a transparent proxy working.  I wouldn&#8217;t encourage my Mum to have one on her net connection.  It&#8217;s much easier to just point her router&#8217;s DNS at a better one.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-87089">

			<div class="comment by-carlo-graziani ">

				<p class="commentcredit">

					<span class="commenter">Carlo Graziani</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87089">
						April 24, 2008 8:04 AM					</a>

				</p>

				<p>&#8220;Kaminsky demonstrated the vulnerability by finding a way to insert a YouTube video from 80s pop star Rick Astley into Facebook and PayPal domains.&#8221;</p>
<p>I like the idea of Rickrolling as a vulnerability demo.  Financially harmless yet psyche-scarring, it&#8217;s a good way to drive home the &#8220;you&#8217;ve been had&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87090">

			<div class="comment by-dima ">

				<p class="commentcredit">

					<span class="commenter">Dima</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87090">
						April 24, 2008 8:06 AM					</a>

				</p>

				<p>Network Solutions (or was it Verisign?) tried to pull this trick on all of us about 5 years back.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-87091">

			<div class="comment by-gordon ">

				<p class="commentcredit">

					<span class="commenter">Gordon</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87091">
						April 24, 2008 8:14 AM					</a>

				</p>

				<p>Verizon does this, and it pisses me off.  I&#8217;m used to typing something in the FireFox address bar and getting an I&#8217;m-feeling-lucky search.</p>
<p>This is completely aside from the issues that lack of an NXDOMAIN cause for spam filtering.  Verizon has a page that supposedly lets you disable it, but when I checked all the links on it were 404 (they&#8217;re fixed now, but basically they told you to use a different DNS, so I did).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87092">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87092">
						April 24, 2008 8:23 AM					</a>

				</p>

				<p>A home user wouldn&#8217;t want to run a transparent proxy. They can run a caching resolver that starts at the root and works downward. Then they don&#8217;t need to use anyone else&#8217;s resolver.<br />
However ISPs may want to use transparent proxies to allow them to keep pulling the same shennagins they do now to make extra money.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-87093">

			<div class="comment by-shachar-shemesh ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.lingnu.com' rel='external nofollow ugc' class='url'>Shachar Shemesh</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87093">
						April 24, 2008 8:40 AM					</a>

				</p>

				<p>Maybe this is good after all.</p>
<p>At the moment, Google keeps most of its cookies so that they are sent to all subdomains of Google. They do this so they can track your identity as you move through the various Google services. This is also the reason that gmail is read through &#8220;mail.google.com&#8221;, and not &#8220;gmail.com&#8221;.</p>
<p>But if this practice becomes a problem, so does google&#8217;s practice. Maybe this problem will negate the other one.</p>
<p>Shachar</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87094">

			<div class="comment by-rajiv ">

				<p class="commentcredit">

					<span class="commenter">Rajiv</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87094">
						April 24, 2008 8:56 AM					</a>

				</p>

				<p>Domain names are valuable intellectual property to their owners.  I believe that a case could be made that an ISP returning a different page for someone else&#8217;s domain is infringment and theft.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-87095">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">bob</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87095">
						April 24, 2008 9:05 AM					</a>

				</p>

				<p>Im glad this has finally caught public attention it has been bugging me for quite a while.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87096">

			<div class="comment by-andy ">

				<p class="commentcredit">

					<span class="commenter">Andy</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87096">
						April 24, 2008 9:07 AM					</a>

				</p>

				<p>Why doesn&#8217;t the target domain return a redirect URL for undefined names within their domain?  Ask for &#8220;webmale.google.com&#8221; and get &#8220;www.google.com&#8221; back.  They can be arbitrarily simple or smart &#8211; &#8220;music.retailer.com&#8221; could take you to the home page or to the music offerings.  This puts the control back into the hands of the domain owner.  It would also allow &#8220;foo.com&#8221; to work for as an alias for &#8220;www.foo.com&#8221; for those lazy typists among us.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-87097">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.ladadadada.net' rel='external nofollow ugc' class='url'>Dave</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87097">
						April 24, 2008 9:08 AM					</a>

				</p>

				<p>I know that TalkTalk in the UK also do this and what&#8217;s worse is that you are redirected to the ad-laden page (which means you can&#8217;t just fix the one-letter typo anymore, you have to re-type the entire domain) and the ad-laden page is horrendously slow.</p>
<p>Of course, I changed my DNS servers and I&#8217;m no longer with TalkTalk but this is a scary problem.</p>
<p>Shouldn&#8217;t there be some legislation about returning inaccurate results to DNS requests ?<br />
There isn&#8217;t much of a conceptual difference between hijacking mail.google.com and hijacking webmail.google.com.  The only difference is that Google have decided that one of them should return NXDOMAIN and the other should return an IP address.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87098">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87098">
						April 24, 2008 9:14 AM					</a>

				</p>

				<p>This is the reason why I do not let my ISP resolve the DNS lookup.  Instead I use an outside firm in another place and time continuum to do the task.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-87099">

			<div class="comment by-trevor-stone ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://trevorstone.org' rel='external nofollow ugc' class='url'>Trevor Stone</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87099">
						April 24, 2008 9:20 AM					</a>

				</p>

				<p>What do these ad sites do in response to non-http traffic?  If the ad site was malicious (or compromised) and someone misspells the name of a domain the first time they SSH to it (or if they ignore the warning that they haven&#8217;t connected before), they could divulge their username and password.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87100">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">bob</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87100">
						April 24, 2008 9:21 AM					</a>

				</p>

				<p>As long as the ISPs dont mind accepting financial liability for the damage they cause; plus lost time and underwriting lost identities incurred when they usurp the 404 mission, its fine with me. I know I never signed a waiver for them to redirect me to their choice of site when I mistyupe something. If they send me to a malware site, they can take some of the revenues they gain through their negligent greed and share it with me to reimburse me for my suffering.</p>
<p>I bet a couple of $M+ lawsuit settlements would quickly put this back the way God and DARPA intended.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-87101">

			<div class="comment by-capt-jean-luc-pikachu ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.omlettesoft.com/newjournal.php3?who=Lord+Omlette' rel='external nofollow ugc' class='url'>Capt. Jean-Luc Pikachu</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87101">
						April 24, 2008 9:29 AM					</a>

				</p>

				<p>Verizon lets you &#8220;opt out&#8221;.  Figure out what DNS servers you&#8217;re automagically assigned, then change both so that the last 12 is a 14.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87102">

			<div class="comment by-derf ">

				<p class="commentcredit">

					<span class="commenter">derf</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87102">
						April 24, 2008 9:34 AM					</a>

				</p>

				<p>This basically comes down to a problem of choice.  If we actually had competition, the company promising not to do this (and keeping that promise) would get all of the business, even if it cost a few cents more per month.  Yet because the marketplace can only hold so many ISPs (due to monopoly and expiration of the access agreements that let smaller ISPs have access to the cable plant at reasonable prices) our only choices (in the US) for &#8220;high speed&#8221; are the phone company DSL (likely AT&amp;T) or the local wired cable television network.  In many locations, only one of the two is available.</p>
<p>Competition is a good thing, but monopolies don&#8217;t see it that way.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-87103">

			<div class="comment by-kadin2048 ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://kadin.sdf-us.org' rel='external nofollow ugc' class='url'>Kadin2048</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87103">
						April 24, 2008 9:58 AM					</a>

				</p>

				<blockquote><p>
  What do these ad sites do in response to non-http traffic?
</p></blockquote>
<p>The issue is on the DNS level, it&#8217;s not in any way specific to HTTP traffic.</p>
<p>If you have an ISP that is hijacking like this, you can test it using the &#8220;nslookup&#8221; or &#8220;host&#8221; utilities (Windows and modern Linux distros, respectively).  You can type in any bogus domain name you want, and instead of getting a NXDOMAIN, you&#8217;ll get an A record that corresponds to the advertising server.</p>
<p>So basically, if you&#8217;re trying to connect via SSH (or some other non-HTTP protocol) and mistype the address, rather than just getting a DNS error, you&#8217;ll try to connect to the ISP advertising server.  What happens at that point depends on how the server is configured; I expect you&#8217;ll get a &#8216;connection refused&#8217; message.</p>
<p>This idea was crap when Verisign tried to pull it a few years ago, it&#8217;s crap when OpenDNS does it, and it&#8217;s crap when ISPs do it.  Unfortunately, until it&#8217;s made illegal, I think we&#8217;ll see people continuing to try it.  It&#8217;s just too lucrative a revenue source; it doesn&#8217;t matter if it breaks all sorts of software, if it makes them a few quick bucks they&#8217;re going to do it if they&#8217;re allowed.</p>
<p>Personally I use the OpenNIC alternate-root nameservers for DNS resolution, and they&#8217;ve been working well for me.  It&#8217;s most of the good things that you can say about OpenDNS, but without wildcarding/typosquatting.  They also have a few TLDs that don&#8217;t exist in the IANA root, which might be good or bad depending on your point of view.  I just ignore them, mostly.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87104">

			<div class="comment by-peter-pearson ">

				<p class="commentcredit">

					<span class="commenter">Peter Pearson</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87104">
						April 24, 2008 9:59 AM					</a>

				</p>

				<p>Three posters have mentioned getting better DNS, but nobody says where.  C&#8217;mon, guys; share the good news.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-87105">

			<div class="comment by-leon-avalos ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://getcreditsavy.com' rel='external nofollow ugc' class='url'>Leon Avalos</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87105">
						April 24, 2008 10:10 AM					</a>

				</p>

				<p>Just another reason to be running your own cache. While these days the ISPs are delibrately subverting things, in the past their caches were vulnerable to poisoning.<br />
Until they start putting in transparent DNS proxies, running your own caching name server will save you some grief.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87106">

			<div class="comment by-paeniteo ">

				<p class="commentcredit">

					<span class="commenter">Paeniteo</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87106">
						April 24, 2008 10:10 AM					</a>

				</p>

				<p>Well, I use this for my <em>own</em> domains all the time. No matter what subdomain you ask, you will get a valid IP.</p>
<p>If you use HTTP and try a non-existing subdomain, a default virtual host will inform you about this problem. Btw, you wouldn&#8217;t believe how many people think that host names must start with &#8220;www.&#8221;&#8230;<br />
For non-HTTP protocols, you get whatever listens at that port, as hostnames do not matter there.</p>
<p>I originally set this up so that I could conveniently add subdomains (which mostly redirect to subdirectories of the primary website) by only changing Apache configuration.<br />
Now it turns out that my setup even has security benefits ;-D</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-87107">

			<div class="comment by-fdhy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.youtube.com/watch?v=eBGIQ7ZuuiU' rel='external nofollow ugc' class='url'>FDHY</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87107">
						April 24, 2008 10:20 AM					</a>

				</p>

				<p>I use Verizon and it&#8217;s annoying because it&#8217;s not only for an unknown subdomain but also for when they&#8217;re having network issues and cannot bring up reliable sites like google.com&#8230;  Badness&#8230; Make it stop!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87108">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87108">
						April 24, 2008 10:21 AM					</a>

				</p>

				<p>Just thinking aloud.  But an interesting if nerdy piece of research would be to query two of a list of different DNS&#8217;s and compare the results.  There&#8217;d be some devil in the details but vastly different IPs could be rejected.</p>
<p>You could monitor when your ISP was playing games with you.</p>
<p>Put this in a client and provide feedback to a central site to monitor whos playing games and bring it more out in the open.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-87109">

			<div class="comment by-skymt ">

				<p class="commentcredit">

					<span class="commenter">skymt</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87109">
						April 24, 2008 10:52 AM					</a>

				</p>

				<p>@ Peter Pearson (and anyone else who wants a better DNS server)</p>
<p>Try 4.2.2.1-4.2.2.6. They&#8217;re run by Level 3 and are quite fast. I&#8217;ve had response times as low as 11 ms.</p>
<p>I also recommend a caching DNS server for high-traffic periods. pdnsd is easy to set up, if you happen to have a Unix box available.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87110">

			<div class="comment by-boogle ">

				<p class="commentcredit">

					<span class="commenter">Boogle</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87110">
						April 24, 2008 11:00 AM					</a>

				</p>

				<p>I use TimeWarner for me it only returns ads on bad domains &amp; TLD (ie <a href="http://www.gggooooglleee.com" rel="nofollow ugc">http://www.gggooooglleee.com</a>. / <a href="http://www.google.edu" rel="nofollow ugc">http://www.google.edu</a>) but gives me a 404 on bad subdomains (pay.google.com.)<br />
I had never seen the opt out untill I went looking for it after reading this article. I have not yet determined how it tracks prefrences</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-87111">

			<div class="comment by-pawned ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://n8ux.wordpress.com' rel='external nofollow ugc' class='url'>Pawned!</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87111">
						April 24, 2008 11:03 AM					</a>

				</p>

				<p>Well I&#8217;m very happy with OpenDNS and it&#8217;s features, as well as DNS-Omatic for Keeping my no-ip addresses updated.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87112">

			<div class="comment by-infosponge ">

				<p class="commentcredit">

					<span class="commenter">Infosponge</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87112">
						April 24, 2008 12:16 PM					</a>

				</p>

				<p>ISPs are taking such a huge interest in manipulating data in transit, regardless of the ethics or security risks, that this kind of problem isn&#8217;t going to go away without legislation.</p>
<p>The market can&#8217;t solve this problem because limited choices for last mile connectivity (phone or cable) mean most ISPs are essentially monopolies.</p>
<p>We need a dumb pipe act to obligate all network providers to pass IP payloads verbatim.  Anything less than this and it&#8217;s only a matter of time until every protocol and connection is subject to inappropriate monetization.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-87113">

			<div class="comment by-tk ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://tkincher.com' rel='external nofollow ugc' class='url'>tk.</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87113">
						April 24, 2008 12:43 PM					</a>

				</p>

				<p>OpenDNS is a really solid alternative, except that I was having some seriously bizarre issues (lookups failing in odd ways, lookup speed getting very slow) with Comcast a couple of months after I set OpenDNS as my only DNS server on my wireless router.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87114">

			<div class="comment by-lol ">

				<p class="commentcredit">

					<span class="commenter">lol</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87114">
						April 24, 2008 1:04 PM					</a>

				</p>

				<p>Googler matt cutts probably wouldn&#8217;t think that this is cool&#8230;.<br />
<a href="http://www.mattcutts.com/blog/confirmed-isp-modifies-google-home-page/" rel="nofollow ugc">http://www.mattcutts.com/blog/confirmed-isp-modifies-google-home-page/</a></p>
<p>But&#8230; they do this themselves via their toolbar:<br />
<a href="http://seoker.com/2008/02/11/google-hijacking-404-error-pages/" rel="nofollow ugc">http://seoker.com/2008/02/11/google-hijacking-404-error-pages/</a></p>
<p>Whether it is a &#8220;hacker&#8221; or a search engine, control of your computer is based on understanding your computer and the intent of both the &#8220;do no evil&#8221; (right) and evil doers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-87115">

			<div class="comment by-grant ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://perimetergrid.com' rel='external nofollow ugc' class='url'>Grant</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87115">
						April 24, 2008 1:14 PM					</a>

				</p>

				<p>There&#8217;s also a post at <a HREF="http://perimetergrid.com/wp/2008/04/23/ad-replacers-let-dan-kaminsky-rickroll-the-web/" rel="nofollow ugc">Perimeter Grid</a> about how Kaminsky&#8217;s script works, and how it could be used to carry out an actual attack.</p>
<p>This is a great example of how the lack of &#8220;net neutrality&#8221; does more than just give larger, paying websites a &#8220;fast lane&#8221; &#8212; it also puts all of us at risk by making our own ISPs hostile.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87116">

			<div class="comment by-skymt ">

				<p class="commentcredit">

					<span class="commenter">skymt</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87116">
						April 24, 2008 1:56 PM					</a>

				</p>

				<p>For what it&#8217;s worth, OpenDNS also hijacks error pages by default. They also invisibly return one of their own servers for lookups of google.com:</p>
<p><a href="http://forums.opendns.com/comments.php?DiscussionID=226" rel="nofollow ugc">http://forums.opendns.com/comments.php?DiscussionID=226</a><br />
<a href="http://blog.opendns.com/2007/05/22/google-turns-the-page/" rel="nofollow ugc">http://blog.opendns.com/2007/05/22/google-turns-the-page/</a></p>
<p>Both are features you can opt out of. On the other hand, almost all ISPs let you opt out of their DNS hijacking, so there doesn&#8217;t seem to be any real advantage to switching to OpenDNS, at least in this context.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-87117">

			<div class="comment by-john-ridley ">

				<p class="commentcredit">

					<span class="commenter">John Ridley</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87117">
						April 24, 2008 2:05 PM					</a>

				</p>

				<p>Charter Communications does it too.  It prompted me to set up my router (which runs dd-wrt) to use OpenDNS instead.</p>
<p>As has been mentioned though, OpenDNS does the same damn thing; instead of returning domain not found or something, I get redirected to guide.opendns.com and what look like google results.  Better than my ISP&#8217;s behavior but still not as good as getting the proper error back.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87118">

			<div class="comment by-xd0s ">

				<p class="commentcredit">

					<span class="commenter">xd0s</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87118">
						April 24, 2008 4:33 PM					</a>

				</p>

				<p>@infosponge</p>
<p>&#8220;We need a dumb pipe act to obligate all network providers to pass IP payloads verbatim. Anything less than this and it&#8217;s only a matter of time until every protocol and connection is subject to <em>inappropriate monetization</em>.&#8221;<br />
(emphasis added by me)</p>
<p>What exactly is inappropriate monetization?  A legal term?  A moral stance?  A technical ideal?</p>
<p>I&#8217;m all for net neutrality and pipes being pipes, but how does one go about identifying appropriate vs inappropriate monetization of these things?  Let alone how does one enforce it?</p>
<p>From the discussion here (I have not done much research on it yet) it appears that this behavior is common and frequently able to opted out of if you choose to.  So independant of the bad security at the Ad Hosting site and some mucking with how they present the resulting page as a child domain vs a separate domain (I think I got that right), what is the great offense to net neutrality that they did?</p>
<p>I&#8217;m not trying to defend them as much as understand why this is a net neutrality issue.  Would it be ok if they presented the hosting page&#8217;s domain correctly and included a link to the &#8220;real&#8221; result page?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-87119">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87119">
						April 24, 2008 6:25 PM					</a>

				</p>

				<p>I&#8217;m surprised that only Rajiv brought up the infringement issue.  I&#8217;m sure many domain names are trademarked and hijacking nonexistent subdomains sure looks like trademark infringement to me.  Of course, I am not a lawyer.  I don&#8217;t even play one on TV.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87120">

			<div class="comment by-otto-defey ">

				<p class="commentcredit">

					<span class="commenter">Otto Defey</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87120">
						April 24, 2008 8:03 PM					</a>

				</p>

				<p>It&#8217;s not only misspellings that Earthlink is harvesting.  We commonly omit the initially &#8220;www.&#8221; from a site name, and that almost always works.  When I tried &#8220;oup.com/us&#8221; I got the infernal page of useless suggestions.  I retried with &#8220;www.oup.com/us&#8221;, and that got me what I wanted.  Thanks for the helpful service, Earthlink.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-87121">

			<div class="comment by-colossal-squid ">

				<p class="commentcredit">

					<span class="commenter">Colossal Squid</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87121">
						April 25, 2008 5:06 AM					</a>

				</p>

				<p>&#8220;I&#8217;m sure many domain names are trademarked and hijacking nonexistent subdomains sure looks like trademark infringement to me.&#8221;</p>
<p>Since the sub-domains don&#8217;t actually exist, how can the trademark be infringed?<br />
Here&#8217;s the relevant UK law:<br />
The Trade Marks Act 1994 states that &#8220;a person infringes a registered trade mark if he uses in the course of trade a sign which is identical with the trade mark in relation to goods or services which are identical with those for which it is registered&#8221; (section 10(1) of the Act). A person may also infringe a registered trade mark where the sign is similar and the goods or services are similar to those for which the mark is registered and there is a likelihood of confusion on the part of the public as a result (section 10(2)).</p>
<p>A person also infringes a registered trade mark where a sign is identical but the goods are dissimilar if the trade mark has a reputation in the UK and its use takes unfair advantage of, or is detrimental to, the mark’s distinctive character or reputation (section 10(3)).</p>
<p>Looking at it, you might be able to make a case based on Section 10(3), but it seems a bit of a stretch.</p>
<p>IANAL etc.</p>
<p>@Rajiv<br />
&#8220;I believe that a case could be made that an ISP returning a different page for someone else&#8217;s domain is infringment and theft.&#8221;</p>
<p>Can you explain what has been &#8216;stolen&#8217; here?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87122">

			<div class="comment by-roystgnr ">

				<p class="commentcredit">

					<span class="commenter">roystgnr</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87122">
						April 25, 2008 3:49 PM					</a>

				</p>

				<p>&#8220;What exactly is inappropriate monetization?&#8221;</p>
<p>It&#8217;s a poorly chosen phrase to describe a very important idea.  On the one hand, calling wire fraud &#8220;inappropriate&#8221; is an incredible understatement, and &#8220;monetization&#8221; is a red herring when discussing fraud which would be wrong whether done for financial reasons, political or personal reasons, or just for laughs.</p>
<p>On the other hand, the internet works at all only so far as we can trust our ISPs to give us the unedited packets that other users send us, to give us accurate replies to our requests for the services like DNS that they provide, and to never fraudulently impersonate other users.  Man-in-the-middle attacks on our network connections are immoral and are supposed to be illegal, even if the attacker is being paid (or perhaps especially if the attacker is being paid) to provide those connections.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-87123">

			<div class="comment by-argv ">

				<p class="commentcredit">

					<span class="commenter">argv</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87123">
						August 5, 2009 5:24 AM					</a>

				</p>

				<p>I think once one becomes aware of how much income this practice generates (I for one am amazed- it is huge), then this all makes sense.</p>
<p>It has been going on for many years (see Net Sol reference above).  Everyone is in the game- they are only human and I suspect the temptation for financial gain is too great- from registrars to browser companies to search engine companies to ISP&#8217;s to DNS alternative providers to all types of crafty individuals.  They are all taking part.</p>
<p>The problem (if there is one) is twofold:<br />
1. DNS (vs /etc/hosts) is not needed; the conditions of 30 yrs ago have changed; GB&#8217;s for under $1; see above local cache suggestion- /etc/hosts is a digital &#8216;phonebook&#8217; and it could easily be centrally distributed as a single file in a secure way); IP addresses do not have to be like shifting sands, updated by the minute- imagine if phone numbers were like that.  Imagine if everytime you dialled a wrong number it was redirected to a call center where someone was waiting to try to sell you something to point you to other sellers.</p>
<ol>
<li>Users are too &#8216;dumb&#8217; (i.e., unwilling to take an interest in learning about this; they can&#8217;t stop impulse clicking on screen areas and typing mindlessly into their browser address bars; they fail to see that the internet is similar to telephony: it operates by numbers- IP addresses are no longer than phone numbers, and no more difficult to remember, if typing them out).  I still am amazed that users type directly in their address bars (and of course make mistakes) to find sites.  Firefox and Google certainly are not trying to stop this.</li>
</ol>
<p>The money is steadily coming in from the advertisers.  It&#8217;s 99% of Google&#8217;s income.  And from that income comes the imcome of many of the above parties mentioned.  All dependent on each other- trickle down.  Having &#8216;dumb&#8217; users just encourages this to continue.  There is no reason anyone (except consumers perhaps) might want to change the situation.  It is a cash cow.</p>
<p>Maybe it&#8217;s unfortunate that we have to endure more DNS follies because by being faulty the system brings in even more ad income.  But I doubt those profiting from it would think so.</p>
<p>There&#8217;s a reason I put &#8216;dumb&#8217; in quotes.  Users are not dumb; they are actually smarter than we are: what they don&#8217;t know won&#8217;t bother them.  And they certainly don&#8217;t concern themselves with DNS.  The more one knows about DNS the more annoying it is.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87124">

			<div class="comment by-argv ">

				<p class="commentcredit">

					<span class="commenter">argv</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87124">
						August 7, 2009 2:22 AM					</a>

				</p>

				<p>In short:<br />
&#8211; do your own lookups<br />
&#8211; on your own local cache</p>
<p>Every home user can do this.</p>
<p>There are speed and reliability gains, and all &#8216;problems&#8217; identified here would be solved.  And there&#8217;s another &#8216;problem&#8217; that has not been mentioned which would be eliminated, relating to privacy.  That is, the infamous &#8220;DNS leaks&#8221; problem.</p>
<p>Using an external DNS provider is like dialling &#8216;directory assistance&#8217; every time one wants to make a &#8216;call&#8217;, despite that one can easily obtain a copy of the &#8216;telephone directory&#8217; and keep it near the phone.  And in this case, thanks to technology, the later method is actually faster, and no more less convenient.</p>
<p>Key to telepony metaphor:<br />
&#8216;directory assistance&#8217; = a DNS service<br />
&#8216;call&#8217; = access a resource via HTTP<br />
&#8216;telephone directory&#8217; = a DNS cache</p>
<p>There is software to do this (run a local cache) that is simple, open source and free.  All you have to do is open your mind, stop thinking in terms of the anti-/etc/hosts, DNS paradigm and have a look.  It&#8217;s been right there all along.</p>
<p>For PC users, here no need to argue the merits of DNS.  Sending UDP packets to some foreign server&#8217;s DNS port 53 every time one wants to &#8216;make a call&#8217; is not necessary.  All one needs is a copy of the &#8216;telephone directory&#8217; (=all hostnames and corresponding IP&#8217;s, i.e. a modern-day /etc/hosts).  The only reason all PC users do not have this already is because we were sold on an alternative that was deemed necessary due in part to hadware constraints, and the usual obsessive compulsiveness about staying &#8216;updated&#8217; things almost in realtime.  For the non-tecnical user, the &#8216;telephone directory&#8217; does not need to be updated every 5min.  And having a searchable copy of the directory might encourage users to stick to &#8216;trustworthy&#8217; sites, not some dodgy ones that hide their locations using a variety of tricks.</p>
<p>Well, that concludes my pitch for simplicity.  I reckon this is a high traffic blog; I hope that maybe my comments get some people thinking outside the box (where &#8216;the box&#8217; = the anti-/etc/hosts, DNS paradigm).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-87125">

			<div class="comment by-dragon ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.superiorz.org' rel='external nofollow ugc' class='url'>Dragon</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87125">
						December 24, 2011 8:43 AM					</a>

				</p>

				<p>dont worry guys i will help u, how to remove malicious isp error in ur pc/lappy &#8230;.<br />
Step:1 &#8211; search ComboFix and download/save software into ur pc/lappy &#8230;..<br />
Step:2 &#8211; restart ur pc/lappy after run safe mode press F8 &#8230;..<br />
Step:3 &#8211; run combofix this soft automatically remove ISP error malicious attacker link and .exe also &#8230;&#8230; few minutes after if finish u will see log.text and u can read other deletion files lines in top position &#8230;. example see my deletion files &#8230;.</p>
<p>{((((((((((((((((((((((((((((((((((((((((   Other Deletions   )))))))))))))))))))))))))))))))))))))))))))))))))<br />
.<br />
.<br />
d:\documents and settings\All Users\Application Data\TEMP<br />
d:\documents and settings\All Users\Application Data\TEMP\D1B5B4F1.TMP<br />
d:\documents and settings\Dragon\WINDOWS<br />
d:\windows\kb913800.exe<br />
d:\windows\system32\oobe\isperror<br />
d:\windows\system32\oobe\isperror\ispcnerr.htm<br />
d:\windows\system32\oobe\isperror\ispdtone.htm<br />
d:\windows\system32\oobe\isperror\isphdshk.htm<br />
d:\windows\system32\oobe\isperror\ispins.htm<br />
d:\windows\system32\oobe\isperror\ispnoanw.htm<br />
d:\windows\system32\oobe\isperror\isppberr.htm<br />
d:\windows\system32\oobe\isperror\ispphbsy.htm<br />
d:\windows\system32\oobe\isperror\ispsbusy.htm<br />
)}</p>
<p>if finish combofix then restart ur pc/lappy after ur pc/lappy will work load fast browser 00.648 seconds in 27 queris &#8230;..</p>
<p>if u dont understand my english i say to sorry to u bcoz i am indian i will help little to all user normally &#8230;</p>
<p>best regards<br />
Lucky<br />
Superiorz &amp; Kings-Yahoo Staff</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-87126">

			<div class="comment by-andy-f ">

				<p class="commentcredit">

					<span class="commenter">Andy F</span> •

					<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/#comment-87126">
						October 8, 2013 5:14 AM					</a>

				</p>

				<p>There&#8217;s another implication of the Barefruit NXDOMAIN fiasco. When connected to a corporate VPN under normal circumstances, Domain name resolution works because the ISP&#8217;s DNS server will try and fail to resolve your corporate LAN&#8217;s private address range, and then return NXDOMAIN. The corporate DNS Server will then resolve your private addresses.</p>
<p>But not with Barefruit, oh no. Barefruit doesn&#8217;t care that the name you specified resolves to a private address on your LAN &#8211; it will still hijack the NXDOMAIN response to serve up its spam, ensuring that your corporate DNS servers never get a chance to resolve that address, comprehensively breaking your VPN. Thanks Barefruit!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2008/04/hacking_isp_err.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2008/04/hacking_isp_err.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2008%2F04%2Fhacking_isp_err.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2008/04/hacking_isp_err.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='2215' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2008/04/reverseengineer.html" rel="prev">← Reverse-Engineering Exploits from Patches</a>		<a href="https://www.schneier.com/blog/archives/2008/04/designing_proce.html" rel="next">Designing Processors to Support Hacking →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
