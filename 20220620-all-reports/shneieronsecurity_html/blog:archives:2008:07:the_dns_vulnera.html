<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>The DNS Vulnerability - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; The DNS Vulnerability Comments Feed" href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/2381" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=2381' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2008%2F07%2Fthe_dns_vulnera.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2008%2F07%2Fthe_dns_vulnera.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-2381 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-2381" class="post-2381 post type-post status-publish format-standard hentry category-uncategorized tag-disclosure tag-dns tag-essays tag-internet tag-leaks tag-man-in-the-middle-attacks tag-network-security tag-vulnerabilities">

	<div class="article">

		<h2 class="entry">The DNS Vulnerability</h2>
		<p>Despite the best efforts of the security community, the details of a critical internet vulnerability discovered by Dan Kaminsky about six months ago have leaked. Hackers are racing to produce exploit code, and network operators who haven&#8217;t already patched the hole are scrambling to catch up. The whole mess is a good illustration of the problems with researching and disclosing flaws like this.</p>
<p>The <a href="http://darkoz.com/?p=15">details</a> of the <a href="http://.invisibledenizen.org/2008/07/kaminskys-dns-issue-accidentally-leaked.html">vulnerability</a> aren&#8217;t important, but basically it&#8217;s a form of DNS cache poisoning. The DNS system is what translates domain names people understand, like www.schneier.com, to IP addresses computers understand: 204.11.246.1. There is a whole family of vulnerabilities where the DNS system on your computer is fooled into thinking that the IP address for www.badsite.com is really the IP address for www.goodsite.com &#8212; there&#8217;s no way for you to tell the difference &#8212; and that allows the criminals at www.badsite.com to trick you into doing all sorts of things, like giving up your bank account details. Kaminsky discovered a particularly nasty variant of this cache-poisoning attack.</p>
<p>Here&#8217;s the way the timeline was supposed to work: Kaminsky discovered the vulnerability about six months ago, and quietly worked with vendors to patch it. (There&#8217;s a fairly straightforward fix, although the implementation nuances are complicated.) Of course, this meant describing the vulnerability to them; why would companies like Microsoft and Cisco believe him otherwise? On July 8, he held a <a href="http://news.bbc.co.uk/2/hi/technology/7496735.stm">press conference</a> to <a href="http://www.doxpara.com/?p=1162">announce</a> the <a href="http://www.kb.cert.org/vuls/id/800113">vulnerability</a> &#8212; but not the details &#8212; and reveal that a patch was available from a long list of vendors. We would all have a month to patch, and Kaminsky would release details of the vulnerability at the <a href="http://www.blackhat.com/html/bh-usa-08/bh-us-08-main.html">BlackHat</a> conference early next month.</p>
<p>Of course, the details <a href="http://it.slashdot.org/it/08/07/21/2212227.shtml">leaked</a>. <a href="http://.wired.com/27bstroke6/2008/07/details-of-dns.html">How</a> isn&#8217;t important; it could have leaked a zillion different ways. Too many people knew about it for it to remain secret. Others who knew the general idea were too smart <a href="http://addxorrol.blogspot.com/2008/07/on-dans-request-for-no-speculation.html">not to speculate</a> on the details. I&#8217;m kind of amazed the details remained secret for this long; undoubtedly it had leaked into the underground community before the public leak two days ago. So now everyone who back-burnered the problem is rushing to patch, while the hacker community is racing to produce working exploits. </p>
<p>What&#8217;s the moral here? It&#8217;s easy to condemn Kaminsky: If he had shut up about the problem, we wouldn&#8217;t be in this mess. But that&#8217;s just wrong. Kaminsky found the vulnerability by accident. There&#8217;s no reason to believe he was the first one to find it, and it&#8217;s ridiculous to believe he would be the last. Don&#8217;t shoot the messenger. The problem is with the DNS protocol; it&#8217;s insecure.</p>
<p>The real lesson is that the <a href="http://www.schneier.com/crypto-gram-0103.html#1">patch treadmill</a> doesn&#8217;t work, and it hasn&#8217;t for years. This cycle of finding security holes and rushing to patch them before the bad guys exploit those vulnerabilities is expensive, inefficient and incomplete. We need to design security into our systems right from the beginning. We need <a href="https://www.schneier.com/blog/archives/2007/08/assurance.html">assurance</a>. We need security engineers involved in system design. This process won&#8217;t prevent every vulnerability, but it&#8217;s much more secure &#8212; and cheaper &#8212; than the patch treadmill we&#8217;re all on now.</p>
<p>What a security engineer brings to the problem is a particular <a href="https://www.schneier.com/blog/archives/2008/03/the_security_mi.html">mindset</a>. He thinks about systems from a security perspective. It&#8217;s not that he discovers all possible attacks before the bad guys do; it&#8217;s more that he anticipates potential types of attacks, and defends against them even if he doesn&#8217;t know their details. I see this all the time in good cryptographic designs. It&#8217;s over-engineering based on intuition, but if the security engineer has good intuition, it generally works.</p>
<p>Kaminsky&#8217;s vulnerability is a perfect example of this. Years ago, cryptographer Daniel J. Bernstein <a href="http://cr.yp.to/djbdns/forgery.html">looked at DNS security</a> and decided that Source Port Randomization was a smart design choice. That&#8217;s exactly the work-around being rolled out now following Kaminsky&#8217;s discovery. Bernstein didn&#8217;t discover Kaminsky&#8217;s attack; instead, he saw a general class of attacks and realized that this enhancement could protect against them. Consequently, the DNS program he wrote in 2000, <a href="http://cr.yp.to/djbdns/dnscache.html">djbdns</a>, doesn&#8217;t need to be patched; it&#8217;s already immune to Kaminsky&#8217;s attack.</p>
<p>That&#8217;s what a good design looks like. It&#8217;s not just secure against known attacks; it&#8217;s also secure against unknown attacks. We need more of this, not just on the internet but in voting machines, ID cards, transportation payment cards &#8230; everywhere. Stop assuming that systems are secure unless demonstrated insecure; start assuming that systems are insecure unless designed securely.</p>
<p>This essay <a href="http://www.wired.com/politics/security/commentary/securitymatters/2008/07/securitymatters_0723">previously appeared</a> on Wired.com.</p>
<p>EDITED TO ADD (8/7):  Seems like the flaw is <a href="http://.wired.com/27bstroke6/2008/08/dns-flaw-much-w.html">much worse</a> than we thought.</p>
<p>EDITED TO ADD (8/13):  Someone else <a href="http://isc.sans.org/diary.html?storyid=4693">discovered the vulnerability first</a>.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/disclosure/" rel="tag">disclosure</a>, <a href="https://www.schneier.com/tag/dns/" rel="tag">DNS</a>, <a href="https://www.schneier.com/tag/essays/" rel="tag">essays</a>, <a href="https://www.schneier.com/tag/internet/" rel="tag">Internet</a>, <a href="https://www.schneier.com/tag/leaks/" rel="tag">leaks</a>, <a href="https://www.schneier.com/tag/man-in-the-middle-attacks/" rel="tag">man-in-the-middle attacks</a>, <a href="https://www.schneier.com/tag/network-security/" rel="tag">network security</a>, <a href="https://www.schneier.com/tag/vulnerabilities/" rel="tag">vulnerabilities</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html" rel="bookmark">Posted on July 29, 2008 at 6:01 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html#comments">71 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html" data-title="The DNS Vulnerability" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-93793">

			<div class="comment by-lewis-donofrio ">

				<p class="commentcredit">

					<span class="commenter">Lewis Donofrio</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93793">
						July 29, 2008 7:00 AM					</a>

				</p>

				<p>I though believe it or not Microsoft solved this problem years ago with the joining of Active Directory and MSDNS by using only authenticated hosts for zone transfers.</p>
<p>&#8211;someone correct me if I&#8217;m mistaken.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93794">

			<div class="comment by-d ">

				<p class="commentcredit">

					<span class="commenter">D</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93794">
						July 29, 2008 7:04 AM					</a>

				</p>

				<p>&#8220;There&#8217;s no reason to believe he was the first one to find it&#8221;</p>
<p>And he wasn&#8217;t &#8230;</p>
<p><a href="http://isc.sans.org/diary.html?storyid=4693" rel="nofollow ugc">http://isc.sans.org/diary.html?storyid=4693</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93795">

			<div class="comment by-security4all ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://security4all.blogspot.com' rel='external nofollow ugc' class='url'>Security4all</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93795">
						July 29, 2008 7:05 AM					</a>

				</p>

				<p>Well said. Security by design. The internet used to be a safer place when security wasn&#8217;t that important as feature. Even this patch is just to make exploitation more difficult and ultimately not the final solution.</p>
<p>There has been a lot of talk about DNSSEC and how it&#8217;s now the time to adopt it. Since we seem to trust other mechanisms (such as PKI/SSL) on DNS, maybe it&#8217;s time to reconsider?</p>
<p>On the other hand, someone said &#8220;there is no business model for DNSSEC&#8221;.<br />
DNSSEC needs more storage, bandwidth, administration, network resources ,&#8230;..</p>
<p>More here<br />
<a href="http://www.research.att.com/~trevor/papers/dnssec-incentives.pdf" rel="nofollow ugc">http://www.research.att.com/~trevor/papers/dnssec-incentives.pdf</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93796">

			<div class="comment by-the-cube-monkey ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://noclicky.blogspot.com' rel='external nofollow ugc' class='url'>The Cube Monkey</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93796">
						July 29, 2008 7:09 AM					</a>

				</p>

				<p>Thank you Bruce!  =)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93797">

			<div class="comment by-security4all ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://security4all.blogspot.com' rel='external nofollow ugc' class='url'>Security4all</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93797">
						July 29, 2008 7:14 AM					</a>

				</p>

				<p>First of all, authoritative nameservers were not the issue. The resolving/caching nameservers are.</p>
<p>Second of all, that post of the Internet Storm Center got it wrong. This DNS vulnerability wasn&#8217;t previously discovered. This wasn&#8217;t an issue of Birthday attacks and waiting till the TTL (Time To Live) of the domain expired to poison the cache. This exploit can overwrite any existing domain at any time. And it can be done in 10 seconds (using a high bandwidth connection). Although the current public exploits aren&#8217;t there yet, they are being refined.</p>
<p>Just listen to the webcast that Dan Kaminsky gave explaining the issue.<br />
<a href="http://security4all.blogspot.com/2008/07/recorded-blackhat-webcast-with-dan.html" rel="nofollow ugc">http://security4all.blogspot.com/2008/07/recorded-blackhat-webcast-with-dan.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93798">

			<div class="comment by-bruno-maury ">

				<p class="commentcredit">

					<span class="commenter">Bruno Maury</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93798">
						July 29, 2008 7:22 AM					</a>

				</p>

				<p>You say a good security designer &#8220;anticipates potential types of attacks&#8221;. Can you name a computer protocol or system that was designed from the ground up with security in mind and that has never –ever– been compromised, letting the users waiting for a patch like in this occurrence ? When both a good and a bad designs are compromised, what is the difference when the system is so massively deployed that it will take weeks to patch in full ?</p>
<p>And even if one designs a system virtually immune to any attack, isn&#8217;t there a chance for the implementation to be faulty (like for OpenSSL back in May) ? You quote port randomization as a good design, but isn&#8217;t port randomization an implementation detail in a fundamentally flawed design ?</p>
<p>Thanks for writing this blog and sharing your insights with us 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93799">

			<div class="comment by-nicholas-weaver ">

				<p class="commentcredit">

					<span class="commenter">Nicholas Weaver</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93799">
						July 29, 2008 7:25 AM					</a>

				</p>

				<p>The reason why it leaked is easy: its incredibly STUPID:</p>
<p>&#8220;DNS resolvers will cache glue records, and will overwrite the existing cache entries for these glue records&#8221;.</p>
<p>This is, IIRC, another thing that DJBDNS doesn&#8217;t do: cache glue records.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93800">

			<div class="comment by-rob-funk ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://funknet.net/rfunk' rel='external nofollow ugc' class='url'>Rob Funk</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93800">
						July 29, 2008 7:45 AM					</a>

				</p>

				<p>@Lewis Dinofrio, this has nothing to do with zone transfers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93801">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93801">
						July 29, 2008 7:50 AM					</a>

				</p>

				<p>It&#8217;s another example. Security has to be designed in. Of course there can still be security problems either due to the original design or the implementation being faulty but designing in security at the beginning means it is a lot less likely and easier to fix.</p>
<p>Look at the difference between an operating system like VMS (designed to be a secure and robust commercial platform) and unix. I know modern unix kernels have been substantially re-designed but the original was not designed with security in mind.</p>
<p>This DNS problem was a design flaw in the original DNS which was not designed for security.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93802">

			<div class="comment by-trichinosis-usa ">

				<p class="commentcredit">

					<span class="commenter">Trichinosis USA</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93802">
						July 29, 2008 8:00 AM					</a>

				</p>

				<p>How do you address the greed factor?</p>
<p>There are thousands of Cisco switches and routers out there which will never be patched because Cisco insists on a contract or warranty before issuing the patch.</p>
<p>When does it become appropriate to order a vendor to provide no-cost fixes for their vulnerabilities in the interests of greater security? How else should this problem be solved?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93803">

			<div class="comment by-eam ">

				<p class="commentcredit">

					<span class="commenter">Eam</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93803">
						July 29, 2008 8:02 AM					</a>

				</p>

				<p>@Security4y&#8217;all: &#8220;Although the current public exploits aren&#8217;t there yet, they are being refined.&#8221;</p>
<p>I may be mistaken (can&#8217;t check at work), but I do believe there has been a Metasploit module for this vulnerability out for around a week now.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93804">

			<div class="comment by-eam ">

				<p class="commentcredit">

					<span class="commenter">Eam</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93804">
						July 29, 2008 8:13 AM					</a>

				</p>

				<p>@Bruno Maury:<br />
I&#8217;m really not sure what you&#8217;re getting at here. You&#8217;re saying that if a system is so widely deployed that it takes weeks to patch most installations, then it doesn&#8217;t matter how often it needs to be patched? Seriously?</p>
<p>Anyway, you should check out Microsoft SQL Server 2005&#8217;s track record. It was designed using the Secure Development Lifecycle, and the first serious vulnerability for it was only discovered a few weeks ago. Because of this, life as a SQL Server 2005 admin is notably devoid of headaches (especially when compared to previous SQL Server versions!).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93805">

			<div class="comment by-stevej ">

				<p class="commentcredit">

					<span class="commenter">SteveJ</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93805">
						July 29, 2008 9:02 AM					</a>

				</p>

				<p>@Earn:</p>
<p>Here&#8217;s a flash video of someone at least claiming to combine the Metasploit DNS cache poisoning tools with his own tools which imitate software update servers for Java and other applications:</p>
<p><a href="http://www.infobyte.com.ar/demo/evilgrade.htm" rel="nofollow ugc">http://www.infobyte.com.ar/demo/evilgrade.htm</a></p>
<p>Ironically, the &#8220;patch treadmill&#8221; mentioned by Bruce not only doesn&#8217;t work, it creates its own problems.</p>
<p>Users are in a double-bind, where they can&#8217;t run old versions of apps because they&#8217;re vulnerable, and they can&#8217;t reliably acquire new versions because the vendors don&#8217;t make them available via secure mechanisms.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93806">

			<div class="comment by-allen ">

				<p class="commentcredit">

					<span class="commenter">Allen</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93806">
						July 29, 2008 9:10 AM					</a>

				</p>

				<p>djbdns is not immune to the attack, having randomized source ports simply makes attacks harder.</p>
<p>How much harder?  Not much.  Kaminsky&#8217;s own test suite and the exploits that have recently made their way into the light can compromise a DNS server that does source port randomization in a matter of minutes.</p>
<p>The problem isn&#8217;t the DNS protocol either, it&#8217;s an implementation issue that can be easily fixed.</p>
<p>Don&#8217;t cache NS/A records at the same level of the query you&#8217;re sending.  When you ask for &#8216;amazon.com&#8217; and get a &#8216;.com&#8217; NS list from the TLDs, that&#8217;s ok.  It&#8217;s in bailiwick and it&#8217;s relevant to your question.</p>
<p>When you ask for &#8220;12345.amazon.com&#8221; from &#8220;ns1.amazon.com&#8221; and you get a response back saying &#8220;dunno the address, but here&#8217;s another NS server at the same level as me that may know&#8221;, trash the response.</p>
<p>Problem solved.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93807">

			<div class="comment by-nuno ">

				<p class="commentcredit">

					<span class="commenter">Nuno</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93807">
						July 29, 2008 9:27 AM					</a>

				</p>

				<p>Allen is right,</p>
<p>and there are other ways to make DNS more safe, still the exploit works where conditions can be meet.</p>
<p>but still DNS can be implemented in very different ways protecting you from this exploits. in fact protecting yourself from unkown vulnerabilities can be just by setting up your DNS servers to trust only the DNS servers you want. still many exploits in the wild exploit native flaws in protocols but this means exploits need to reach the app, thats where the real security implementation comes into place.</p>
<p>I can&#8217;t be to sure that what has been developed in djbdns was developed thinking in unkown vulnerabilities as it can allways have its own vulns.. so the implementation is the way to think about security.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93808">

			<div class="comment by-fp ">

				<p class="commentcredit">

					<span class="commenter">FP</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93808">
						July 29, 2008 9:27 AM					</a>

				</p>

				<p>&#8220;There is a whole family of vulnerabilities where the DNS system on your computer is fooled into thinking that the IP address for <a href="http://www.badsite.com" rel="nofollow ugc">http://www.badsite.com</a> is really the IP address for <a href="http://www.goodsite.com" rel="nofollow ugc">http://www.goodsite.com</a> &#8212; there&#8217;s no way for you to tell the difference.&#8221;</p>
<p>True, although the vulnerability is mitigated in the presence of an SSL certificate.  <a href="http://www.badsite.com" rel="nofollow ugc">http://www.badsite.com</a> would not be able to present you with a valid, signed SSL certificate for <a href="http://www.goodsite.com" rel="nofollow ugc">http://www.goodsite.com</a>.  So an attentive user would have some warning before handing over her account details.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93809">

			<div class="comment by-nicholas-weaver ">

				<p class="commentcredit">

					<span class="commenter">Nicholas Weaver</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93809">
						July 29, 2008 9:30 AM					</a>

				</p>

				<p>No, allen.  the problem is what happens is you cache &#8220;in bailywick&#8221; glue!</p>
<p>EG, you ask for aoeui.amazon.com and you get a response back saying:</p>
<p>aoeui.amazon.com CNAME: <a href="http://www.amazon.com" rel="nofollow ugc">http://www.amazon.com</a><br />
<a href="http://www.amazon.com" rel="nofollow ugc">http://www.amazon.com</a> A: 66.66.66.66</p>
<p>(because the attacker won the race), and the DNS server then happily overwrites the cached entry for <a href="http://www.amazon.com" rel="nofollow ugc">http://www.amazon.com</a>.</p>
<p>Its all &#8220;in bailywick&#8221;, it all seems proper.</p>
<p>What it comes down to: you should NEVER cache glue, in bailywick or not!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93810">

			<div class="comment by-bruno-maury ">

				<p class="commentcredit">

					<span class="commenter">Bruno Maury</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93810">
						July 29, 2008 9:31 AM					</a>

				</p>

				<p>@Earn<br />
&#8220;You&#8217;re saying that if a system is so widely deployed that it takes weeks to patch most installations, then it doesn&#8217;t matter how often it needs to be patched?&#8221;</p>
<p>I don&#8217;t think I said that. I&#8217;m asking whether it makes a difference waiting and deploying a patch when the system to patch is poorly designed, as opposed to well designed. You mention SQL Server 2005, of which I have no knowledge, but maybe you can answer this: suppose there were as many SQL Server 2005 instances than DNS servers (I don&#8217;t know either number, this question is hypothetical) and that an exploit of the same impact was found for both, would it make a difference that SQL Server is well designed and that DNS is not ?</p>
<p>When Bruce says: &#8220;This cycle of finding security holes and rushing to patch them before the bad guys exploit those vulnerabilities is expensive, inefficient and incomplete&#8221; and then advocates for putting security at the core of systems/protocols design, it makes me wonder whether good systems are subject to the same cycle and what&#8217;s the difference in patch release frequency between both kinds.</p>
<p>To come back to the actual DNS exploits, I have read elsewhere that port randomization does not solve the issue but merely makes it harder to exploit. Hence my question about this solution being an implementation detail rather than a good design.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93811">

			<div class="comment by-nicholas-weaver ">

				<p class="commentcredit">

					<span class="commenter">Nicholas Weaver</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93811">
						July 29, 2008 9:34 AM					</a>

				</p>

				<p>And I BELIEVE that DJBDNS will only use glue records for the duration of the query, not beyond (which IS safe), so, if so, djbdns is immune, period.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93812">

			<div class="comment by-nicholas-weaver ">

				<p class="commentcredit">

					<span class="commenter">Nicholas Weaver</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93812">
						July 29, 2008 9:41 AM					</a>

				</p>

				<p>Bruno: Correct, but a very big difference on exploitability.</p>
<p>Without port randomization, you can do it &#8220;blind&#8221; with on the order of 2^16 packets: generate a query, send 100 tries, query the next invalid host, send 100 tries, repeat&#8230;</p>
<p>With port randomization, the blind attack takes 2^32 packets, which is infeasible.</p>
<p>But if you put your DNS server behind a NAT, you lose the port randomization in most cases, as NATs will often sequentialize UDP ports.</p>
<p>If glue records are not retained beyond the lifespan of the current query, this attack fails to work because instead of being able to do a bunch of races and have any single race win, you have to win the FIRST race to poison a name, because after that the result is cached and the server won&#8217;t generate queries that you can attempt to poison for that name.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93813">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93813">
						July 29, 2008 9:48 AM					</a>

				</p>

				<p>@john, early versions of VMS had problems as well. For example their way of handling privilege escalation. No authentication was needed to raise your privilege level to the maximum allowed. This was a major hole in that privileged programs that called nonprivileged code (such as mail using a foreign terminal handler that could be a user program). It also meant that users with privileges (such as physical I/O)  had to be really really careful about running trojans. They couldn&#8217;t just rely on not having the privilege enabled, as being allowed to turn it on was enough.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93814">

			<div class="comment by-mister-paul ">

				<p class="commentcredit">

					<span class="commenter">Mister Paul</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93814">
						July 29, 2008 9:58 AM					</a>

				</p>

				<p>I found this whole debacle odd. Anyone who has done arp-cache poisoning and is familiar with typical UDP transaction schemes would come upon this easily. I know of people who surmised this weakness years ago and heard it bandied about for some time. I&#8217;m not taking anything away from Kaminsky &#8212; his work is always good &#8212; but I very very much doubt his actions in anyway made things worse. I think any knowledgeable, motivated attacker had already probably happened upon this or would have soon enough. The &#8220;leak&#8221; furor is laughable and seriously misplaced.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93815">

			<div class="comment by-nuno ">

				<p class="commentcredit">

					<span class="commenter">Nuno</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93815">
						July 29, 2008 9:59 AM					</a>

				</p>

				<p>And I BELIEVE that DJBDNS will only use glue records for the duration of the query, not beyond (which IS safe), so, if so, djbdns is immune, period.</p>
<p>Posted by: Nicholas Weaver at July 29, 2008 9:34 AM</p>
<p>so you can&#8217;t use the dns server as a caching only server ? and thats it is safe&#8230; because is limited in the way you use it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93816">

			<div class="comment by-davi-ottenheimer ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://davi.poetry.org/blog' rel='external nofollow ugc' class='url'>Davi Ottenheimer</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93816">
						July 29, 2008 10:39 AM					</a>

				</p>

				<p>Nice article. Would have liked to see a tie into physical vulnerabilities and disclosure habits.</p>
<p>Locksport continues to grow, while lock companies do little to patch vulnerable locks:<br />
<a href="http://www.slate.com/id/2195862" rel="nofollow ugc">http://www.slate.com/id/2195862</a></p>
<p>And NXP Semiconductor is suing to gag the the team that researched Oyster card flaws:</p>
<p><a href="http://www.theregister.co.uk/2008/07/08/nxp_sues_oyster_researchers/" rel="nofollow ugc">http://www.theregister.co.uk/2008/07/08/nxp_sues_oyster_researchers/</a></p>
<p>You seem to only refer to software security here, but there&#8217;s many more dimensions to the issue.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93817">

			<div class="comment by-2longago ">

				<p class="commentcredit">

					<span class="commenter">2LongAgo</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93817">
						July 29, 2008 10:40 AM					</a>

				</p>

				<p>People knew about this and other flaws a long time ago.<br />
Programmers can automate tests to check for flaws&#8230;<br />
Flaws are worth $, and inside knowledge gives one a job.  Perfect is hard to negotiate money in public open source.<br />
Funny, all these Coverity, &#8216;NSA guidelines,&#8217; etc, $$$$$ Cisco, ETC, and only the ones who knew, run the good stuff, with the good configurations.<br />
Full disclosure is dead, who want to be thought of as a refugee maid?<br />
Even *BSD uses Bind, Sendmail crap.  It is all a crock putting in other programs, you got to then handle other issues that some are not up for.  Looks like the migration time to DJB stuff is coming.<br />
If only DJB would help with his stuff to *BSD.  It would be worth money.  Heck, congress should pay.  They waste a billion here and there on nothing.<br />
The money wasted on bad IT is insane!  And what do we get from congress but more War on X disaster racketting.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93818">

			<div class="comment by-oldami ">

				<p class="commentcredit">

					<span class="commenter">oldami</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93818">
						July 29, 2008 10:54 AM					</a>

				</p>

				<p>I really wish that the understanding of this concept (Bruce&#8217;s rant, not the vulnerability) could be beaten into the heads of every member of congress &#8211; and all the foreign governments as well.  Software is developed on a economic business model, not a security model.  Until laws force a change or governments fund the proper changes we will continue down this dark path.</p>
<p>Thank you Mr Schneier for advocating as you do.  I consider you the greatest hero of the digital age.<br />
&#8211; Oldami</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93819">

			<div class="comment by-t ">

				<p class="commentcredit">

					<span class="commenter">t</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93819">
						July 29, 2008 11:00 AM					</a>

				</p>

				<p>Now, you can attack DNS with ddos since the ISC patch poorly implemented port randomization.  You can send a bunch of rand.domain.com at the server and slow it to a grinding halt.</p>
<p>Remember, it has to keep track of all the open ports, so you can mess with how it handles timeouts, while it waits for answers to non-existent domains.</p>
<p>Current hardware requirements for the current randomized port version of BIND need to be evaluated.</p>
<p>If you cannot poison it, shut it down or make it slow to respond.</p>
<p>Maybe it&#8217;s time to not use BIND until a good solution is found.  Switching to djbdns in the short time might make more sense.  Of course, then pound djbdns to make sure it can handle the load.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93820">

			<div class="comment by-a-fan ">

				<p class="commentcredit">

					<span class="commenter">A Fan</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93820">
						July 29, 2008 11:44 AM					</a>

				</p>

				<p>WWDJBD?  🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93821">

			<div class="comment by-a-fan ">

				<p class="commentcredit">

					<span class="commenter">A fan</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93821">
						July 29, 2008 11:46 AM					</a>

				</p>

				<p>&#8220;Of course, then pound djbdns to make sure it can handle the load.&#8221;</p>
<p>t, you kill me.  DJBDNS is /way/ more efficient.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93822">

			<div class="comment by-fdhy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.ApexRally.com' rel='external nofollow ugc' class='url'>FDHY</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93822">
						July 29, 2008 12:12 PM					</a>

				</p>

				<p>It&#8217;d be interesting to have someone share a more detailed solution to this issue.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93823">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93823">
						July 29, 2008 12:14 PM					</a>

				</p>

				<p>Security4all&gt; There has been a lot of talk about DNSSEC and how it&#8217;s now the time to adopt it.</p>
<p>Actually, there&#8217;s been very little talk of DNSSEC, which is unfortunate because this is yet another reason we should have had the infrastructure in place years ago.</p>
<p>Security4all&gt; Since we seem to trust other mechanisms (such as PKI/SSL) on DNS, maybe it&#8217;s time to reconsider?</p>
<p>Reconsider the braindead X.509 PKI we currently use? Definitely. The status quo of CAs performing authentication of domain ownership using cleartext email is pathetic, and the very existence of CAs (for most purposes, anyway) is an unnecessary expense. Furthermore, the ability of <em>any</em> CA to sign <em>any</em> subject is a fundamental design flaw in the X.509-based PKI; anyone who imports a CA certificate for example.com&#8217;s enterprise PKI ends up trusting the managers of that PKI not to forge a cert for, say, bankofamerica.com.</p>
<p>Security4all&gt; On the other hand, someone said &#8220;there is no business model for DNSSEC&#8221;.</p>
<p>Whoever said that was deeply confused. If we can build a DNSSEC-based PKI, the business model of not paying through the nose for certificates is obvious. Not only that, but we could distribute public keys for as many hosts and services as we like, and deploy opportunistic encryption using IPsec without having to set up keys ahead of time.</p>
<p>Moreover, DNSSEC-based PKI can be mutual. In the broken status quo, we are accustomed to think not only that each certificate requires paying a third party, but also that we can&#8217;t rely on users to have verifiable client certificates. With DNSSEC this is no longer the case, since with the appropriate naming schema, DNSSEC can distribute secure public keys for both parties in communication. This means we have all the infrastructure needed for message encryption and message authentication, in both directions, all for the one-time cost of setting up DNSSEC and getting your KSK signed by your domain parent.</p>
<p>Elaborate revocation protocols, also involving a third party, are no longer necessary. Just remove the signature from the DNS, and the certificate expires when the DNS TTL elapses.</p>
<p>DNSSEC-based PKI also appropriately constrains signing authority along the domain axis, which is the axis being verified in the first place (i.e. the CN in the certificate subject). This means that the example.com PKI&#8217;s administrators no longer have the ability to forge unrelated certs that the PKI&#8217;s users end up trusting.</p>
<p>Security4all&gt; More here<br />
<a href="http://www.research.att.com/~trevor/papers/dnssec-incentives.pdf" rel="nofollow ugc">http://www.research.att.com/~trevor/papers/dnssec-incentives.pdf</a></p>
<p>Yet another outdated report making the misguided comparison between DNSSEC and SSL. Of course DNSSEC doesn&#8217;t replace SSL; it doesn&#8217;t address the same problem at all. It can, however, replace the CAs in the certificate issuance process, which is the magical hand-waving part the DNSSEC detractors always seem to overlook.</p>
<p>Moreover, DNSSEC provides a general, secure, distributed, redundant, hierarchical database. The possibilities for this are endless and not limited to distribution of any sort of public key&#8211;consider identity management, for example.</p>
<p>Oh, and it solves DNS cache poisoning.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93824">

			<div class="comment by-todd-knarr ">

				<p class="commentcredit">

					<span class="commenter">Todd Knarr</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93824">
						July 29, 2008 12:32 PM					</a>

				</p>

				<p>There&#8217;s one thing that can be done to make attacks more difficult that I don&#8217;t think is being implemented yet: ignore all additional records in the response that aren&#8217;t applicable to the RR name being queried. If you query for the A records for <a href="http://www.example.com" rel="nofollow ugc">http://www.example.com</a>, an additional MX or TXT record for it is acceptable but an A record for database.example.com should be ignored. In a delegation response, only A records for the responsive NS records should be accepted. That closes most of the exposure, leaving only poisoning of delegation responses open.</p>
<p>DNSSEC removes the problem entirely, and maybe this will motivate people to get the proper records in place for it to work.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93825">

			<div class="comment by-security4all ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://security4all.blogspot.comp' rel='external nofollow ugc' class='url'>Security4all</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93825">
						July 29, 2008 12:34 PM					</a>

				</p>

				<p>@Eam</p>
<p>Yes, besides metasploit, there were even 2 exploits on milw0rm. What I meant is that using the developed exploit takes several minutes. Whereas Dan Kaminsky said it could be done in 10 seconds.</p>
<p>@antibozo</p>
<p>Interesting remarks. I found that pdf by looking for more information. You are right. Everybody is focused mainly on patching and the discussion about DNSSEC has stopped. Maybe it shouldn&#8217;t have.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93826">

			<div class="comment by-av ">

				<p class="commentcredit">

					<span class="commenter">av</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93826">
						July 29, 2008 12:40 PM					</a>

				</p>

				<p>@Allen &#8211; poisoning NS records is only one variant of potential attacks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93827">

			<div class="comment by-jnarvey ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.boonbox.net/devfense.htm' rel='external nofollow ugc' class='url'>jnarvey</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93827">
						July 29, 2008 12:43 PM					</a>

				</p>

				<p>Building security into websites and web applications during the development stage is exactly what is required. Considering the excellent ROI from web application security (as explained at <a href="http://www.pcis.com/web/vvblog.nsf/dx/how-to-calculate-return-on-investment-roi-for-web-security" rel="nofollow ugc">http://www.pcis.com/web/vvblog.nsf/dx/how-to-calculate-return-on-investment-roi-for-web-security</a>), it&#8217;s incredible that more organizations haven&#8217;t made action like web security audits a priority.<br />
<a href="http://www.boonbox.net/devfense.htm" rel="nofollow ugc">http://www.boonbox.net/devfense.htm</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93828">

			<div class="comment by-jnarvey ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.boonbox.net/devfense.htm' rel='external nofollow ugc' class='url'>jnarvey</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93828">
						July 29, 2008 12:45 PM					</a>

				</p>

				<p>Try that link to the ROI of web security blog post again.</p>
<p><a href="http://www.pcis.com/web/vvblog.nsf/dx/how-to-calculate-return-on-investment-roi-for-web-security" rel="nofollow ugc">http://www.pcis.com/web/vvblog.nsf/dx/how-to-calculate-return-on-investment-roi-for-web-security</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93829">

			<div class="comment by-antonio ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.denhaag.com' rel='external nofollow ugc' class='url'>Antonio</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93829">
						July 29, 2008 1:19 PM					</a>

				</p>

				<p>Without knowing the details of this specific attack, I feel very sympathetic about preventing problems compared to patch-treadmilling security issues.</p>
<p>The line of thinking that I&#8217;m considering may not apply to all kinds of security problems, but will add to the prevention considerably by controlling software changes much more than in the past.</p>
<p>In this past, we needed the fast (software) update cycles to make wonderful new innovations possible and to correct errors. Instant update gratification, but today that same update / software modification possibility allows infections to take place.</p>
<p>Infections can occur because the computer does allow (or does not prevent) changes in the software to take place, when online. On a desktop one needs to update the OS, firewall, virus scanner, spyware scanner and phising warning, to prevent an unwanted modification of software to occur. How much preventive measures can I get rid of, when this software can&#8217;t physically be modified (for some time)?</p>
<p>I personally can live with a guaranteed half-year cycle for my software updates as long as it allows me to safely interact with the internet the rest of the time.<br />
In SetTopBoxes the way to achieve this is by checking on modification of the software image &amp; reloading in case of minor problems, en making the box unusable when more major problems are found.<br />
And aren&#8217;t running applications in a virtual machine a similar way of controlling these kinds of risk?</p>
<p>Could a way of &#8220;software freeze&#8221; (like the physical switch on my SD card) in a PC, in combination with a secure (e.g. once every half-year) update be such a preventive / security design to change the rules of the patch treadmill game?</p>
<p>Any suggestions, comments or thoughts?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93830">

			<div class="comment by-steve ">

				<p class="commentcredit">

					<span class="commenter">Steve</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93830">
						July 29, 2008 1:19 PM					</a>

				</p>

				<p>Antibozo: You&#8217;ve strong arguments in favor of rolling out DNSSEC all over, and have addressed the disincentives paper&#8211;what about Thomas Ptacek&#8217;s arguments against?  Making DoS much easier against the DNS infrastructure doesn&#8217;t sound like a good idea to me.</p>
<p><a href="http://www.matasano.com/log/756/a-case-against-dnssec-count-1-solves-a-non-problem/" rel="nofollow ugc">http://www.matasano.com/log/756/a-case-against-dnssec-count-1-solves-a-non-problem/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93831">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93831">
						July 29, 2008 2:24 PM					</a>

				</p>

				<p>Steve&gt; what about Thomas Ptacek&#8217;s arguments against? Making DoS much easier against the DNS infrastructure doesn&#8217;t sound like a good idea to me.</p>
<p>Well, Mr. Ptacek&#8217;s arguments, like the other paper already cited, are directed primarily at the red herring of end-to-end encryption, which DNSSEC doesn&#8217;t attempt to solve any more than certificate signing on its own does. Meanwhile, he blows the complexity of DNSSEC operations out of proportion, in my opinion; I&#8217;ve actually practiced working with DNSSEC and it&#8217;s really not that hard. Like anything else, you need some new tools to help out, and once you have them you wonder what all the fuss was about.</p>
<p>So most of Ptacek&#8217;s series is moot, in my opinion, and you&#8217;ll note that he never completed it. But, as you suggest, he does raise a couple of other issues that are not without validity.</p>
<p>I don&#8217;t dispute that there are computational requirements for DNSSEC that make DoS more feasible. But computers get faster and cheaper, and bandwidth gets higher, so generally redundancy can be applied to deal with this problem, if it even turns out to be a practical problem. At the same time, virtualization is making deployment of redundant infrastructure much easier.</p>
<p>In contrast, DNS cache poisoning, which is a real and immediate threat, gets continually easier as computational capacity and bandwidth go up. I don&#8217;t think the 15 or 16 bits of entropy we get out of source port randomization (while depleting available entropy for other things and increasing memory requirements for firewalls) are going to stop someone with a large botnet from poisoning a cache, and within a few years the benefit will have eroded yet again and pretty much anyone will be able to do it. There&#8217;s no other evasion for cache poisoning I&#8217;m aware of once that happens, other than modifying the DNS infrastructure. DNSSEC is the only contender I&#8217;m aware of for doing that, and it comes with all these potential side benefits I mentioned earlier.</p>
<p>So, yes, I agree with Ptacek that DNS operations and infrastructure requirements are indeed somewhat more demanding under DNSSEC, but I think people will find that in practice, it&#8217;s really not that hard. I would point interested users toward the tools written by Sparta as a first cut for making things like key rollover easy to manage. In my estimation, the real and immediate benefit of DNSSEC (no cache poisoning) outweighs the theoretical cost (easier DoS), and the <em>potential</em> benefits, once we have DNSSEC, blow all other considerations out of the water. Management costs of doing DNSSEC are the biggest unknown right now, but that&#8217;s because there&#8217;s no infrastructure for most of us to play with. It&#8217;s a chicken and egg problem, unfortunately. There will be an initial outlay to get significant deployment, but after that, reduced management costs in other areas, such as PKI, will compensate.</p>
<p>I think that if, as a community, we had put the same cumulative effort into deploying DNSSEC that has been wasted on trying to mitigate against cache poisoning over the past six years, we would be a lot farther along in overall network security. Unfortunately, DNSSEC has had few proponents, and a few vocal opponents. And here we are, trying to deal with cache poisoning yet again.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93832">

			<div class="comment by-tim ">

				<p class="commentcredit">

					<span class="commenter">Tim</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93832">
						July 29, 2008 2:28 PM					</a>

				</p>

				<p>These security problems are more a reflection of the mindset of the community than a technical one.  Technical problems, once found, are generally relatively easy to solve.  Overcoming the inertia of establishment is a different task altogether.  Of course, the community can&#8217;t seem to come to terms with a security protocol for DNS either.</p>
<p>We have all known for YEARS that software such as Sendmail and BIND (The Buggy Internet Daemon, as DJB likes to call it) has a long history of security problems.  The question is why do a large population of the community still run them (Sendmail is less of an issue due to the popularity of Postfix)?</p>
<p>I blame most of it on the institutional &#8220;cheerleaders&#8221; for these products.  If you examine the history of these software, you will find an amazing amount of FUD (much of which DJB debunks on his website) spread about moving away from these software.  The trouble is, some of these same cheerleaders are respected technical community leaders.  It can be hard to get a true assessment amongst all the noise.  Personally, it took some hard lessons in the trenches to decide for myself.</p>
<p>I don&#8217;t want to debate the merit (or lack thereof) of other software (personally I am a DJB fan) but what I want to know is, why is BIND (and its descendants) still running at the majority of the core and at the infrastructure level, given it&#8217;s clear and numerous security issues in the past?</p>
<p>Tim</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93833">

			<div class="comment by-mister-paul ">

				<p class="commentcredit">

					<span class="commenter">Mister Paul</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93833">
						July 29, 2008 2:37 PM					</a>

				</p>

				<p>@anitbozo: My last analysis of DNSSEC (admittedly a few years ago) was that it was easy to effective DoS. Not only that, it was reasonably obvious how to do so, and probably could be cobbled together by any intermediate skill attacker. I recommended against it (it was my job role to make that kind of judgement). Unless they have done some serious fixes, I still would.</p>
<p>In the current situation, randomized ports would, at the minimum, force an attacker to send a very large number of unsuccessful packets for every given poisoning attempt. This would be trivial to detect; at the minimum you could develop a system that would alert to the attempt and take corrective action if possible (blacklisting an IP, locking down the record, ceasing to cache that record, or other possible applicable measures). This would probably result in a reduction of service, possibly a limited DoS, but is doable without client changes. More importantly, this kind of defence should be present <em>regardless</em> of how &#8220;secure&#8221; the protocol is; no single line of defense is good enough to even be acceptable. Lacking rudimentary defences beyond crossing your fingers is irresponsible, particularly for major players in the system.</p>
<p>Of course, they are not incented to action, as alluded to.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93834">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93834">
						July 29, 2008 3:08 PM					</a>

				</p>

				<p>Mister Paul&gt; My last analysis of DNSSEC (admittedly a few years ago) was that it was easy to effective DoS.</p>
<p>Well, traditional DNS is pretty easy to DoS also.</p>
<p>In any case, if you are aware of a specific cryptographic attack that will cripple recursive DNSSEC servers that isn&#8217;t addressed in the current implementations, I would encourage you to publish your findings so that people can fix the problem.</p>
<p>Also note that as bandwidth goes up, and clients begin to do DNSSEC RR validation in the local resolver, recursive nameservers become less necessary. And once clients do validation locally, recursive nameservers don&#8217;t have to do it any more and can revert to plain caches.</p>
<p>Mister Paul&gt; In the current situation, randomized ports would, at the minimum, force an attacker to send a very large number of unsuccessful packets for every given poisoning attempt.</p>
<p>In the current situation, someone with a large botnet is in a position to do this. And in the current situation, there are plenty of other more limited vectors for cache poisoning (e.g. arp spoofing) that don&#8217;t rely on volume at all.</p>
<p>Mister Paul&gt; at the minimum you could develop a system that would alert to the attempt and take corrective action</p>
<p>What corrective action? Dump all caches? Will you be able to tell whether one of those poison packets was successful?</p>
<p>I appreciate your effort, but I think you are devising a very complex system that has to be deployed for <em>every</em> nameserver (not to mention client resolver) in order to stop cache poisoning, and, by your own admission, still results in limited DoS. Do you really think that&#8217;s easier than building a DNSSEC infrastructure that is resistant to denial of service? And in the long run, doesn&#8217;t it ultimately fail anyway? Or is IPv6 going to save us by giving us a bigger source port range?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93835">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93835">
						July 29, 2008 3:14 PM					</a>

				</p>

				<p>Mister Paul&gt; Of course, they are not incented to action, as alluded to.</p>
<p>Oh, yes, forgot to mention: here you&#8217;re definitely on to something.</p>
<p>What large company makes millions selling X.509 certs and also happens to operate the .com and .net registries? Three guesses. Conflict of interest? Nah&#8230; ;^)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93836">

			<div class="comment by-t ">

				<p class="commentcredit">

					<span class="commenter">t</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93836">
						July 29, 2008 3:18 PM					</a>

				</p>

				<p>@mister paul:</p>
<p>Since you are all ready crafting raw udp packets for the exploit, you can easily turn around and craft those to DoS with random IPs and MAC addresses.  Some one could then use your firewall rules to have you effectively block whomever they wanted.</p>
<p>But if you want to use a botnet, then you&#8217;re pretty much limited to windows, which doesn&#8217;t support raw socket creation, so then you end up blocking legit IPs since the IP normally cannot be spoofed.</p>
<p>How do you prevent a cache of:</p>
<p>rand.somedomain.com</p>
<p>where rand is a random letter and number.  You would end up forcing a cache flush.</p>
<p>So is the real answer to get away from using cache servers as bandwidth continues to increase?  What&#8217;s the performance loss with today&#8217;s bandwidth of not caching records?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93837">

			<div class="comment by-bruce-schneier ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93837">
						July 29, 2008 3:47 PM					</a>

				</p>

				<p>&#8220;You say a good security designer &#8216;anticipates potential types of attacks.&#8217; Can you name a computer protocol or system that was designed from the ground up with security in mind and that has never –ever– been compromised&#8230;.&#8221;</p>
<p>Of course not.  What in the world does that have to do with the first sentence?  If perfection is your security goal, you&#8217;ll never succeed &#8212; not in computer security, not in physical security, not in any kind of security.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93838">

			<div class="comment by-andy ">

				<p class="commentcredit">

					<span class="commenter">Andy</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93838">
						July 29, 2008 4:04 PM					</a>

				</p>

				<p>We could use some security mindset on the implementation as well.</p>
<ol>
<li>I send out a request for a DNS record.</li>
<li>I get a reply, I cache the result.</li>
<li>I get a second reply with a different result, delete both replies (clear cache) and request again!</li>
</ol>
<p>The issue seems to be accepting the first reply and just ignoring the second.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93839">

			<div class="comment by-mister-paul ">

				<p class="commentcredit">

					<span class="commenter">Mister Paul</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93839">
						July 29, 2008 5:13 PM					</a>

				</p>

				<p>@t : &#8220;Since you are all ready crafting raw udp packets for the exploit, you can easily turn around and craft those to DoS with random IPs and MAC addresses.&#8221;</p>
<p>Don&#8217;t assume I am an idiot. Clearly, if you write some kind of generic &#8220;oh, a bad request, block that IP&#8221; you actually enable DoS instead of preventing it. As I said, take <em>some</em> corrective action. It has to be careful and considered. Going to DNSSEC is not going to make the general problem of additional defences go away; it will need defending too, as no system can be relied on alone. And, as I said, it will be creating a limited DoS situation. And yes, DNSSEC is a nightmare to deploy. And still needs additional protection.</p>
<p>As to secret cryptographic attacks, I have  none. Most cryptographic systems tend to have DoS weaknesses, simply because the attacker can spend minimal resources generating things like bogus signatures which cost the defender a lot more resources to check. Anytime you create a large attacker/defender resource imbalance, you tend to open yourself wide open to DoS attacks, and DNSSEC doesn&#8217;t have any particularly clever methods to reduce load in my recollection.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93840">

			<div class="comment by-allen ">

				<p class="commentcredit">

					<span class="commenter">Allen</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93840">
						July 29, 2008 6:12 PM					</a>

				</p>

				<p>Wow, lot of comments on this one, haven&#8217;t read them all, but this one was directed back at me.</p>
<p>Nicholas, I agree with you generally speaking, but I am taking the alternative approach.  I say cache glue and ONLY cache glue.</p>
<p>Your example of using a CNAME rather than an NS/A combo is interesting, and in that case, I would agree with you &#8212; throw it away, and go look up &#8216;www.amazon.com&#8217; if you got a CNAME pointing to it.</p>
<p>If you get an NS/A record fine, go there and ask, but don&#8217;t cache it since it&#8217;s at the same depth you are asking about.</p>
<p>As a stopgap until they straighten this out in BIND, I&#8217;ve written a DNS shim that you configure in BIND as a forwarder for zones you want to protect.  It never caches anything itself, always asks at least twice (to compare answers), is recursive, and strips all additional/authority records off the final answer it gives back to BIND.</p>
<p>Problem solved. 🙂</p>
<p>I&#8217;ll be getting it up somewhere soon under a BSD license or similar for people to play with.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93841">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93841">
						July 29, 2008 6:32 PM					</a>

				</p>

				<p>Mister Paul&gt; And yes, DNSSEC is a nightmare to deploy.</p>
<p>This is a common misconception and is simply not true. You should try actually playing with the current tools. For example, take a look at:</p>
<p><a href="http://www.dnssec-tools.org/" rel="nofollow ugc">http://www.dnssec-tools.org/</a></p>
<p>It also should be said that specific DNSSEC trust islands already exist, and lookaside validation can be used to extend those into other TLDs without getting the root or even the gTLDs signed (see RFC 5074). This is supported by BIND. Hopefully it won&#8217;t be necessary, but that depends on possibly uncooperative TLD registries.</p>
<p>See also ICANN&#8217;s most recent statements here, planning for signature of the DNS root by late this year:</p>
<p><a href="http://www.icann.org/en/announcements/announcement-24jul08-en.htm" rel="nofollow ugc">http://www.icann.org/en/announcements/announcement-24jul08-en.htm</a></p>
<p>No one forces you to use DNSSEC on your own systems, so if you perceive potential crypto-based denial of service as a more serious problem than the untrustworthiness of DNS as a whole, you&#8217;re free to operate your own nameservers in the traditional way.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93842">

			<div class="comment by-allen ">

				<p class="commentcredit">

					<span class="commenter">Allen</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93842">
						July 29, 2008 8:10 PM					</a>

				</p>

				<p>@antibozo</p>
<p>Unfortunately, DNSSEC won&#8217;t protect us against attacks like these.  Even if the root, the GTLDs, and even the target zone were signed &#8212; the attackers unsigned spoofed response would still have to be honored.</p>
<p>The query going out can request DNSSEC, but it cannot demand it, exactly because it is not widely deployed and it is certainly not mandatory.</p>
<p>Of course if you know a sensitive site you use (like your bank) is signed (it probably isn&#8217;t), you can setup your own caching recursive bind server and tell it to only trust response from that domain that are signed, but that&#8217;s not blanket coverage by any stretch.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93843">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93843">
						July 29, 2008 8:18 PM					</a>

				</p>

				<p>Allen&gt; Even if the root, the GTLDs, and even the target zone were signed &#8212; the attackers unsigned spoofed response would still have to be honored.</p>
<p>Not sure what you mean. If the attacker&#8217;s spoofed response cannot be validated it will be discarded. The DNSSEC-aware recursive nameserver knows that the zone is signed already from the zone&#8217;s parent, so it can disregard answers that have no signatures.</p>
<p>Where a parent delegates to an unsigned zone, naturally, the unsigned zone is still vulnerable to poisoning.</p>
<p>If the attack is directed at a stub resolver, also, yes, it will still work, with the scope of a single client. This gets resolved when the stub resolvers are replaced with validating resolvers, which has to happen eventually anyway.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93844">

			<div class="comment by-allen ">

				<p class="commentcredit">

					<span class="commenter">Allen</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93844">
						July 29, 2008 9:53 PM					</a>

				</p>

				<p>antibozo, you got me there, I mixed up my gripes.  If we had full end to end dnssec then yes, it could prevent these attacks.</p>
<p>Since we don&#8217;t, you need to configure it in &#8220;lookaside&#8221; mode, which doesn&#8217;t require the key to be there but just trusts it if it&#8217;s found.  Correct me if I&#8217;m wrong, I just setup my first DNSSEC enabled zone last weekend. 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93845">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93845">
						July 29, 2008 10:15 PM					</a>

				</p>

				<p>Allen&gt; Since we don&#8217;t, you need to configure it in &#8220;lookaside&#8221; mode, which doesn&#8217;t require the key to be there but just trusts it if it&#8217;s found. Correct me if I&#8217;m wrong, I just setup my first DNSSEC enabled zone last weekend. 🙂</p>
<p>Close. Lookaside (i.e. DLV) works around the lack of signing on the root or parent by using another domain as the root for looking up DS records. So if a DS record can&#8217;t be found for secure.example.com, the resolver will try secure.example.com.dlv.example.com, where dlv.example.com is lookaside domain configured in the resolver.</p>
<p>As I mentioned before, we can hope that lookaside won&#8217;t be necessary; it&#8217;s proposed as a workaround if we can&#8217;t get a signed root and signed TLDs.</p>
<p>This is a concise document that explains DLV, among other things:</p>
<p><a href="http://alan.clegg.com/files/DNSSEC_in_6_minutes.pdf" rel="nofollow ugc">http://alan.clegg.com/files/DNSSEC_in_6_minutes.pdf</a></p>
<p>Glad to hear you&#8217;re trying zone signing. Not really that difficult, is it?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93846">

			<div class="comment by-joe-in-australia ">

				<p class="commentcredit">

					<span class="commenter">Joe in Australia</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93846">
						July 29, 2008 10:18 PM					</a>

				</p>

				<p>It strikes me that part of the problem is because we set up our computers to have an algorithmic approach to security: apply this test, that test, and another test; and process  the packet if it passes all three tests. That would be like a documented protocol for airport security that read &#8220;search every person who is bearded, a Moslem, or who comes from a non-European country.&#8221; There are two problems with this protocol: first, it gives potential attackers a model for designing their attacks; and a successful attack against one target will be very to work against other targets.</p>
<p>We need two things to solve these problems. The first thing we need is a lot of different organic protocols that will detect suspicious behavior. Any particular site may be running one, many, or all of these protocols. In fact, an ideal protocol would be non-deterministic so that no attacker could be sure that a particular attack would work. The other thing we need is a way to share information on attackers so that the same attack can&#8217;t be run sequentially on many different sites.</p>
<p>These techniques wouldn&#8217;t stop every conceivable attack. That&#8217;s not even desirable: you want attackers to try exploits in the wild so that you have a chance to detect their failures. The great benefit of an organic approach to security is that even successful attacks will be successful against only a random handful of sites; and failed attacks will alert the defenders so that they can test for data corruption caused by successful attacks elsewhere.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93847">

			<div class="comment by-lewls ">

				<p class="commentcredit">

					<span class="commenter">lewls</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93847">
						July 29, 2008 10:43 PM					</a>

				</p>

				<p>i find it funny how people are so quick to point out that dan wasn&#8217;t the first to discover this vulnerability. sure, he didn&#8217;t come up with the idea of cache poisoning, but that&#8217;s not what he&#8217;s releasing (the concept of cache poisoning). dan found a novel way of actually exploiting a bug that has been around for many years.. so give him credit for that.</p>
<p>(this directed at post #2 (D))</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93848">

			<div class="comment by-david ">

				<p class="commentcredit">

					<span class="commenter">David</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93848">
						July 29, 2008 11:13 PM					</a>

				</p>

				<p>@FP:</p>
<p>It would be easier to use the presence or absence of a certificate to notice <a href="http://www.badsite.com" rel="nofollow ugc">http://www.badsite.com</a> if one could count on a certificate one could connect to <a href="http://www.goodsite.com" rel="nofollow ugc">http://www.goodsite.com</a>.</p>
<p>Last I looked, while commercial sites tended to have certificates, they didn&#8217;t necessarily say anything related to the site.  If people would check the certificates and refuse to deal with anybody who&#8217;s certificate doesn&#8217;t match the site, certificates might actually become useful for identification.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93849">

			<div class="comment by-chel-van-gennip ">

				<p class="commentcredit">

					<span class="commenter">Chel van Gennip</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93849">
						July 30, 2008 3:18 AM					</a>

				</p>

				<p>The DNS protocol was designed in 1983, when networks were slow and the value of information on the network was less. Better protocols are possible, but migration to a new protocol is difficult. We wil have to live with this protocol for some time.</p>
<p>I think it is time to strip DNS from optimizations, build for 2400 baud networks, and to review implementations so they use the current protocol at its best.</p>
<p>First any DNS system should stop to use not requested &#8220;extra&#8221; information. If you ask information about <a href="http://www.somedomain.net" rel="nofollow ugc">http://www.somedomain.net</a>, the DNS should only use the direct answer, either <a href="http://www.somedomain.net" rel="nofollow ugc">http://www.somedomain.net</a> has address 123.45.67.89 or dns.some.server.net is the nameserver for <a href="http://www.somedomain.net" rel="nofollow ugc">http://www.somedomain.net</a>. It should ignore all extra information like: and dns.some.server.net has IP address nnn.nnn.nnn.nnn, and resolve dns.some.server.net  by itself. This does take extra queries, but we aren&#8217;t on the 2400 baud network anymore.</p>
<p>Using only direct answers on direct questions would have helped against almost any DNS attack until now.</p>
<p>Secondly the DNS system should use the possibilities in the protocol, e.g. use real random numbers, real random ports, check every bit of information received, drop a query after the first answer even if it is a wrong answer (so a wrong sequence number should result in NXDOMAIN and not wait for a better sequence number!), handle incoming requests and outgoing requests on different networks etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93850">

			<div class="comment by-bill ">

				<p class="commentcredit">

					<span class="commenter">Bill</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93850">
						July 30, 2008 3:50 AM					</a>

				</p>

				<p>Finally I disagree with Bruce <em>gasp</em>!</p>
<p>Being on the &#8220;patching treadmill&#8221; gives you less residual risk than not being on it.</p>
<p>I think what you mean to say is that strategically it&#8217;s ineffective, but operationally it can be highly effective.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93851">

			<div class="comment by-ross-snider ">

				<p class="commentcredit">

					<span class="commenter">Ross Snider</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93851">
						July 30, 2008 6:24 AM					</a>

				</p>

				<p>We needs to fix these problems with DNS and with SNMP and fix those overflows and free() bugs. That&#8217;s really important.</p>
<p>However, I think the most important thing the security industry should be doing is creating security awareness. We could stop every type of software exploit and fix all of our protocols completely (not that we could prove that) and still people around the world would be owned. Company would still be owned. Governments would still be owned. It&#8217;s a wonderfully trivial thing to send resume.exe to a company &#8211; and it works. And even if it doesn&#8217;t chances are profile.pif will.</p>
<p><a href="http://procrast-nation.com/?p=134" rel="nofollow ugc">http://procrast-nation.com/?p=134</a> More here.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93852">

			<div class="comment by-jason-r-coombs ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.jaraco.com' rel='external nofollow ugc' class='url'>Jason R. Coombs</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93852">
						July 30, 2008 1:02 PM					</a>

				</p>

				<p>Lewis Donofrio &gt; I though believe it or not Microsoft solved this problem years ago with the joining of Active Directory and MSDNS by using only authenticated hosts for zone transfers.</p>
<blockquote><p>
  &#8211;someone correct me if I&#8217;m mistaken.
</p></blockquote>
<p>Microsoft released patches for their Windows Server 2000 and Windows Server 2003 products.  No patches were released for their Server 2008 product.  I&#8217;ve been unable to confirm, but I believe this indicates the problem didn&#8217;t exist in Server 2008 DNS for the same reason as djbdns &#8211; security was built in.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93853">

			<div class="comment by-vmsboy ">

				<p class="commentcredit">

					<span class="commenter">VMSBoy</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93853">
						July 30, 2008 2:02 PM					</a>

				</p>

				<p>VMS shipped for its first ten years with a rather nasty security hole in the default install: google vms field account. It&#8217;s not a security poster child.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93854">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93854">
						July 30, 2008 2:41 PM					</a>

				</p>

				<p>The NY Times has a write-up by John Markoff on this problem in today&#8217;s issue. See <a href="http://www.nytimes.com/2008/07/30/technology/30flaw.html?ref=technology" rel="nofollow ugc">http://www.nytimes.com/2008/07/30/technology/30flaw.html?ref=technology</a> for the story.</p>
<p>The problem has me concerned. I don&#8217;t really understand the glitch, but I do not like the idea of some of my important web sites being spoofed so that I give my important data to a criminal.</p>
<p>The article suggests OpenDNS as a solution. Is it really a solution?</p>
<p>My own idea is to use the IP directly, such as <a href="http://199.239.136.245" rel="nofollow ugc">http://199.239.136.245</a> instead of <a href="http://www.nytimes.com" rel="nofollow ugc">http://www.nytimes.com</a>. Would this avoid the security problem?</p>
<p>Please advise.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93855">

			<div class="comment by-t ">

				<p class="commentcredit">

					<span class="commenter">t</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93855">
						July 30, 2008 2:53 PM					</a>

				</p>

				<p>@John</p>
<p>The &#8220;glitch&#8221; is pretty straight forward.  Imagine you open up the phone book and someone had overwritten people&#8217;s numbers with different numbers.  Having never seen the original numbers,  you wouldn&#8217;t be any wiser.</p>
<p>Your solution would not work 100% of the time.  Sites like google have multiple IPs pointing to their name.  This is so if one server goes down, you will find another one instead.  This redundancy helps keep their site active, and the event is transparent to the user.</p>
<p>Also, sites will load content from other sites by name, which could have had their domain poisoned.  You would have to turn off in your browser all content not from the IP you provided.</p>
<p>DNS really keeps the gritty details behind the scenes to make the Internet easier to use.</p>
<p>Sites like openDNS, however, capture your Internet activity to mine later.  This information is really valuable to third parties.</p>
<p>One issue that has not be touched on is the impact of DNS poisoning on ISP proxies.  I would like to hear more information about that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93856">

			<div class="comment by-a ">

				<p class="commentcredit">

					<span class="commenter">a</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93856">
						July 30, 2008 6:10 PM					</a>

				</p>

				<p>John:</p>
<p>Where do you get the IP?   Sure, if you have a source that you know to be trustworthy that will tell you nytimes.com is 199.239.136.245, that should work, but as I understand it the entire problem is that you can&#8217;t trust the DNS servers that provide those mappings.</p>
<p>And the suggestion for OpenDNS would be a good one, if you could trust <i>that</i> site wasn&#8217;t being spoofed.  Seems to me that getting everyone to hardcode in references to your DNS server would be a clever move, if you knew the vulnerability was rapidly being patched.  Or is that going beyond security-conscious and well into paranoia?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93857">

			<div class="comment by-bub ">

				<p class="commentcredit">

					<span class="commenter">Bub</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93857">
						July 30, 2008 8:38 PM					</a>

				</p>

				<p>On the flip side, certificates are generally tied to the host/domain name, not the IP, so if you go to <a href="http://www.mybank.com" rel="nofollow ugc">http://www.mybank.com</a>, and check that it is secure, and check that you are still at <a href="http://www.mybank.com" rel="nofollow ugc">http://www.mybank.com</a> (in the url bar), in theory you should be ok; if they redirected you to their own site, they should not have a valid certificate (signed by a root authority) that matches the host/domain name. You do have to be careful that the certificate is good (don&#8217;t be clicking yes to those self-signed cert warnings, but y&#8217;all should know better), and that you haven&#8217;t be redirected somewhere (is that url bar where you expected to be?). Might be slight comfort, but relying on DNS for your security is kinda silly anyway.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93858">

			<div class="comment by-bub ">

				<p class="commentcredit">

					<span class="commenter">bub</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93858">
						July 30, 2008 8:39 PM					</a>

				</p>

				<p>Should have added, I am assuming you are using HTTPS for your logins. If you&#8217;re not, then you shouldn&#8217;t be worrying about DNS hacks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93859">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93859">
						July 31, 2008 12:08 PM					</a>

				</p>

				<p>a asked where I get the IP. I use TraceRoute lookup.</p>
<p>However, for many sites, using the IP directly doesn&#8217;t work. I have only a few sites for which I need assurance. Some of these, a direct IP works, and some don&#8217;t.</p>
<p>I used <a href="http://www.doxpara.com" rel="nofollow ugc">http://www.doxpara.com</a> to check my ISP, charter.net. Doxpara says it may be vulnerable.</p>
<p>I don&#8217;t think I have a solution.</p>
<p>Ugh.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93860">

			<div class="comment by-david-keech ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.ladadadada.net' rel='external nofollow ugc' class='url'>David Keech</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93860">
						July 31, 2008 10:03 PM					</a>

				</p>

				<p>The trouble with designing security in from the start is that too many security-aware programmers want their 15 minutes of fame.</p>
<p>If you were working on a DNS project and, say, added port randomisation and non-caching of glue records, nobody will ever know.  The vulnerability never existed and the exploit will never happen.</p>
<p>It&#8217;s like the guy who is stopped by a policeman in London because he is sprinkling a white powder from a little box everywhere he walks.  The policeman asks: &#8220;What are you doing there ?&#8221;<br />
“I’m sprinkling this special dust. It’s to keep the elephants away”<br />
“But there are no elephants in London”<br />
“You see ? Elephant dust works really well !”</p>
<p>Even if the elephant dust is actually working, the guy sprinkling it gets no credit.  The elephant hunter who tracks down and traps the rogue elephant once it gets loose in London is hailed as a hero and put on the front page of all the newspapers.</p>
<p>You could develop a secure DNS program and then discover a vulnerability that it wasn&#8217;t vulnerable to&#8230; but it&#8217;s more time-effective to just look for the vulnerability.  You will still get just as much fame.</p>
<p>The other half of this issue is that you can&#8217;t tell the difference between someone who is sprinkling fake elephant dust and someone who is sprinkling real elephant dust until an elephant shows up.</p>
<p>@John: Traceroute gets its IP addresses from DNS, the same as any domain to IP address lookup does.  The only solution is to find a trustworthy DNS server you can use.</p>
<p>I understand that OpenDNS have patched their servers so you can use them if you want.  I have issues with some of their other practices but they should be fine from a security point of view.  DNS is their entire business whereas DNS is only a tiny part of your ISP&#8217;s business and not a part that makes them any money.  OpenDNS have the right incentive to make sure their DNS servers are up to scratch.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93862">

			<div class="comment by-john-david-galt ">

				<p class="commentcredit">

					<span class="commenter">John David Galt</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93862">
						August 4, 2008 11:29 PM					</a>

				</p>

				<p>Perhaps DNS servers, and financial sites, should inform their users of their immediate &#8220;neighbors&#8221; in Internet topography.  This would allow detection of spoofing using <b>traceroute</b>.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-93863">

			<div class="comment by-john-day ">

				<p class="commentcredit">

					<span class="commenter">John Day</span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93863">
						August 11, 2008 4:43 PM					</a>

				</p>

				<p>Thank you for saying (yet again) that patching doesn&#8217;t work.</p>
<p>In the 70s, we had the same situation with Operating Systems. Finally there was a definitive government report that concluded that no amount of patching would fix an OS not designed to be secure from the outset. Why do we have to learn this lesson again?  It is far more expensive this time than the last time.</p>
<p>Whether we like it or not, a network is nothing more than a very loose distributed OS. Not helped by the fact that the Internet architecture is more an analog to DOS than to a real OS, like UNIX or VMS. Not only was it not designed to be secure, but it is only half a network architecture.  It is far from clear that half an architecture can ever be secured.</p>
<p>If DNS is to be secure, it must be considered from the stand point of a complete architecture. Protecting against even classes of attacks is only patching by another name.</p>
<p>Take care,<br />
John Day</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-93866">

			<div class="comment by-lquykdsa ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://chloe.tvartistry.com/' rel='external nofollow ugc' class='url'>lquykdsa</a></span> •

					<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/#comment-93866">
						June 12, 2013 3:23 PM					</a>

				</p>

				<p>higw  <a href="http://chloe.tvartistry.com/" rel="nofollow ugc">chloe バッグ</a> <a href="http://chloe.party-wine.com/" rel="nofollow ugc">chloe 財布</a> <a href="http://chloe.ozeanys.com/" rel="nofollow ugc">クロエ 財布</a> <a href="http://convers.epacclad.com/" rel="nofollow ugc">コンバース オールスター</a> <a href="http://convers.reidconstruct.com/" rel="nofollow ugc">コンバース</a> gdup<br />
 <a href="http://chloe.tvartistry.com/" rel="nofollow ugc">chloe 財布</a> <a href="http://chloe.party-wine.com/" rel="nofollow ugc">chloe 財布</a> <a href="http://chloe.ozeanys.com/" rel="nofollow ugc">クロエ アウトレット</a> <a href="http://convers.epacclad.com/" rel="nofollow ugc">コンバース スニーカー</a> <a href="http://convers.reidconstruct.com/" rel="nofollow ugc">コンバース</a> klmr<br />
 <a href="http://chloe.tvartistry.com/" rel="nofollow ugc">クロエ 財布</a> <a href="http://chloe.party-wine.com/" rel="nofollow ugc">クロエ アウトレット</a> <a href="http://chloe.ozeanys.com/" rel="nofollow ugc">クロエ アウトレット</a> <a href="http://convers.epacclad.com/" rel="nofollow ugc">コンバース オールスター</a> <a href="http://convers.reidconstruct.com/" rel="nofollow ugc">コンバース オールスター</a> lhsx<br />
 <a href="http://chloe.tvartistry.com/" rel="nofollow ugc">chloe 財布</a> <a href="http://chloe.party-wine.com/" rel="nofollow ugc">chloe バッグ</a> <a href="http://chloe.ozeanys.com/" rel="nofollow ugc">クロエ 財布</a> <a href="http://convers.epacclad.com/" rel="nofollow ugc">コンバース スニーカー</a> <a href="http://convers.reidconstruct.com/" rel="nofollow ugc">コンバース</a> vala<br />
 <a href="http://chloe.tvartistry.com/" rel="nofollow ugc">クロエ アウトレット</a> <a href="http://chloe.party-wine.com/" rel="nofollow ugc">chloe バッグ</a> <a href="http://chloe.ozeanys.com/" rel="nofollow ugc">chloe バッグ</a> <a href="http://convers.epacclad.com/" rel="nofollow ugc">コンバース オールスター</a> <a href="http://convers.reidconstruct.com/" rel="nofollow ugc">コンバース オールスター</a> sdih</p>
<p>kxgv<br />
 smeb<br />
 paqv  <a href="http://chloe.tvartistry.com/" rel="nofollow ugc"></a> <a href="http://chloe.party-wine.com/" rel="nofollow ugc"></a> <a href="http://chloe.ozeanys.com/" rel="nofollow ugc"></a> <a href="http://convers.epacclad.com/" rel="nofollow ugc"></a> <a href="http://convers.reidconstruct.com/" rel="nofollow ugc"></a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2008/07/the_dns_vulnera.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2008/07/the_dns_vulnera.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2008%2F07%2Fthe_dns_vulnera.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2008/07/the_dns_vulnera.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='2381' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2008/07/software_liabil.html" rel="prev">← Software Liabilities and Free Software</a>		<a href="https://www.schneier.com/blog/archives/2008/07/world_war_ii_de.html" rel="next">World War II Deception Story →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
