<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Malware Steals ATM Data - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Malware Steals ATM Data Comments Feed" href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/2884" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=2884' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2009%2F06%2Fmalware_steals.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2009%2F06%2Fmalware_steals.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-2884 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-2884" class="post-2884 post type-post status-publish format-standard hentry category-uncategorized tag-atms tag-banking tag-crime tag-exploits tag-fraud tag-malware tag-operating-systems tag-physical-security tag-theft">

	<div class="article">

		<h2 class="entry">Malware Steals ATM Data</h2>
		<p>One of the risks of using a commercial OS for embedded systems like ATMs: it&#8217;s easier to <a href="http://www.theinquirer.net/inquirer/news/1184568/malware-steals-atm-accounts-pin-codes">write malware</a> against it:</p>
<blockquote><p>The report does not detail how the ATMs are infected, but it seems likely that the malware is encoded on a card that can be inserted in an ATM card reader to mount a buffer overflow attack. The machine is compromised by replacing the isadmin.exe file to infect the system.</p>
<p>The malicious isadmin.exe program then uses the Windows API to install the functional attack code by replacing a system file called lsass.exe in the C:WINDOWS directory.</p>
<p>Once the malicious lsass.exe program is installed, it collects users account numbers and PIN codes and waits for a human controller to insert a specially crafted control card to take over the ATM.</p>
<p>After the ATM is put under control of a human attacker, they can perform various functions, including harvesting the purloined data or even ejecting the cash box.</p></blockquote>
<p>EDITED TO ADD (6/14):  Seems like the story I quoted was jumping to conclusions.   The actual <a rhef="https://www.trustwave.com/downloads/alerts/Trustwave-Security-Alert-ATM-Malware-Analysis-Briefing.pdf">report<a> says  &#8220;the malware is installed and activated through a dropper file (a file that an attacker can use to deploy tools onto a compromised system) by the name of isadmin.exe,&#8221; which doesn&#8217;t really sound like it&#8217;s referring to a buffer overflow attack carried out through a card emulator.  Also, The Register <a href="http://www.theregister.co.uk/2009/06/03/atm_trojans/">says</a> &#8220;[the] malicious programs can be installed only by people with physical access to the machines, making some level of insider cooperation necessary.&#8221; </p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/atms/" rel="tag">ATMs</a>, <a href="https://www.schneier.com/tag/banking/" rel="tag">banking</a>, <a href="https://www.schneier.com/tag/crime/" rel="tag">crime</a>, <a href="https://www.schneier.com/tag/exploits/" rel="tag">exploits</a>, <a href="https://www.schneier.com/tag/fraud/" rel="tag">fraud</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/operating-systems/" rel="tag">operating systems</a>, <a href="https://www.schneier.com/tag/physical-security/" rel="tag">physical security</a>, <a href="https://www.schneier.com/tag/theft/" rel="tag">theft</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html" rel="bookmark">Posted on June 10, 2009 at 1:51 PM</a>			•
			<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html#comments">49 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2009/06/malware_steals.html" data-title="Malware Steals ATM Data" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-114481">

			<div class="comment by-aaron ">

				<p class="commentcredit">

					<span class="commenter">Aaron</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114481">
						June 10, 2009 2:24 PM					</a>

				</p>

				<p>Seems like they should have included something to disable the last five minutes of camera footage if the control card was inserted. Easy to walk away with the cash box, hard to keep it if they have footage of you doing it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114482">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://bobertville.blogspot.com/' rel='external nofollow ugc' class='url'>Bob</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114482">
						June 10, 2009 2:28 PM					</a>

				</p>

				<p>It never ceases to amaze me that companies and organizations whose entire business model rests on security choose the OS/CPU combination that has the most known exploits and the largest community of skilled black hats.</p>
<p>I&#8217;m not advocating security through obscurity, but thieves &#8211; whether thugs on the street or Eastern European hackers &#8211; usually prefer the easy targets.</p>
<p>In a more rational world, companies that make ATMs, voting machines, and so on would reject Windows, especially on x86, out of hand. Instead, we&#8217;d see a varied ecosystem including Linux on ARM, QNX on MIPS, VxWorks on PowerPC, and so on. You certainly don&#8217;t need the latest-and-greatest from Intel and Microsoft &#8211; it&#8217;s not like these applications are exactly processor-intensive or require much of a GUI.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114483">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114483">
						June 10, 2009 2:30 PM					</a>

				</p>

				<p>Perhaps their is something about ATM technology I don&#8217;t understand, but even when using Windows for their system (a questionable decision), what kind of brainiac decided to allow this to be initiated from the ATM card slot?  Seems little need for anything but a read of numbers to be performed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114484">

			<div class="comment by-karl ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.cs.washington.edu/homes/supersat/' rel='external nofollow ugc' class='url'>Karl</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114484">
						June 10, 2009 2:31 PM					</a>

				</p>

				<p>I am highly skeptical of a buffer overflow attack being mounted through the magstripe reader. Not only do cards only contain a limited amount of data (but could be theoretically infinite if a card emulator was used), but the character set is EXTREMELY limited, especially on track 2. I would be VERY impressed if someone managed to write a successful buffer overflow that only used this limited character set.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114485">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://bobertville.blogspot.com/' rel='external nofollow ugc' class='url'>Bob</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114485">
						June 10, 2009 2:34 PM					</a>

				</p>

				<p>@Aaron: The footage would only be useful if they could identify you from it. I immediately thought of a half dozen ways to fox that &#8211; for details, read Harry Harrison&#8217;s Stainless Steel Rat short stories.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114486">

			<div class="comment by-dan ">

				<p class="commentcredit">

					<span class="commenter">Dan</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114486">
						June 10, 2009 2:37 PM					</a>

				</p>

				<p>You know, just seeing &#8220;C:\WINDOWS&#8221; associated with an ATM makes me shake my head in amazement&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114487">

			<div class="comment by-jeremy ">

				<p class="commentcredit">

					<span class="commenter">Jeremy</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114487">
						June 10, 2009 2:51 PM					</a>

				</p>

				<p>I somehow would&#8217;ve thought that all the data on an ATM card would be in a fixed-length format, and read accordingly, which should make buffer overflows impossible.  But I suppose what seems the obvious way to do something in the abstract isn&#8217;t necessarily the easiest or best in practice&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114488">

			<div class="comment by-karl ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.cs.washington.edu/homes/supersat/' rel='external nofollow ugc' class='url'>Karl</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114488">
						June 10, 2009 3:09 PM					</a>

				</p>

				<p>Jeremy: The ISO 7811 standard for magstripe cards has a fixed upper length of data, but that doesn&#8217;t mean that cards not conforming to the standard (or card emulators) can&#8217;t exceed that length. Still very skeptical, though.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114489">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114489">
						June 10, 2009 3:26 PM					</a>

				</p>

				<p>There exists those blackhats who can dream assembly and machine code exploits for SYSTEMS.</p>
<p>Those who can write top code can break top code in different archs, it just takes teams, time, and $.</p>
<p>Check out how many banks still use lower grade ssl/tls.  RC4-MD5, grr.  Some use SHA, and AES.  Some also have extra urls to stuff that can compromise analysis.  Oh well.  Why bother.</p>
<p>Check out how many browsers even, grr, have any reason to trust anything.</p>
<p>Logs and meaning even are problematic with Lynx.  Oh well.  Computer Security, what a lousy field, better to be an actor.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114490">

			<div class="comment by-michael-lambrellis ">

				<p class="commentcredit">

					<span class="commenter">Michael Lambrellis</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114490">
						June 10, 2009 3:28 PM					</a>

				</p>

				<p>To those skeptical of the likelihood of a successful buffer overflow:<br />
It seems to me highly likely (using a card emulator), given the developer&#8217;s probable assumption that the fields are fixed length (since that&#8217;s all the card can store), and that the character set is limited. Developer assumptions about input data is probably the single biggest vector for attacks on Windows (and any other system). Long live the buffer overflow!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114491">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">bob</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114491">
						June 10, 2009 3:31 PM					</a>

				</p>

				<p>I dont understand why people sell &#8220;limited use&#8221; computers, like ATMs, Voting Machines, GPSs, automobiles that use an OS for &#8220;general purpose&#8221; systems like Win, Mac, Linux etc.</p>
<p>They should write a dedicated OS which only does the few functions needed for the mission. Display to the screen. Read from the card. Activate a couple of motors and servos (to dispense cash, accept deposit, etc). Store data. Communicate with outside world. Print something.</p>
<p>Yes, the initial development time will be more, but in the long run it will come out miles ahead due to radically simplified testing, debugging and &#8220;oh shit we forgot it could do THAT&#8221; fixes.</p>
<p>Nevermind the incredible value of never seeing your company in the headlines followed by the words &#8220;&#8230;loses 450,000 customer records&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114492">

			<div class="comment by-ac ">

				<p class="commentcredit">

					<span class="commenter">-ac-</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114492">
						June 10, 2009 4:00 PM					</a>

				</p>

				<p>@Anonymous: &#8220;Oh well. Computer Security, what a lousy field, better to be an actor.&#8221;<br />
Well you could play a security expert 😉</p>
<p>I think the POC exploit to should be to eject the cash drawer as soon as it is inserted. But then, maybe I just want to see what the people loading the ATM do next.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114493">

			<div class="comment by-mel ">

				<p class="commentcredit">

					<span class="commenter">Mel</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114493">
						June 10, 2009 5:06 PM					</a>

				</p>

				<blockquote><p>
  what kind of brainiac decided to allow this to be initiated from the ATM card slot?
</p></blockquote>
<p>From my short stint in the industry: the kind of brainiac who&#8217;s obsessed with lowering maintenance costs.  If we opened up an ATM machine we had to send an armoured truck with a couple of guards, etc.  A guy with a magic card is much cheaper.</p>
<p>IMHO the way to do it right is through the network with signed messages, but &#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114494">

			<div class="comment by-david ">

				<p class="commentcredit">

					<span class="commenter">David</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114494">
						June 10, 2009 5:22 PM					</a>

				</p>

				<p>I have had money stolen from my checking account using a cloned ATM card.  During the investigation into exactly what happened, I learned that most ATM cameras no longer work, or are no longer maintained.  So it seems these days it is only a small risk that your picture will be taken at an ATM machine.  This is probably because defeating a camera on the machine is brainlessly simple (duct tape, anyone?).  A remote camera would be moderately more risky for a would-be thief.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114495">

			<div class="comment by-ge ">

				<p class="commentcredit">

					<span class="commenter">ge</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114495">
						June 10, 2009 6:38 PM					</a>

				</p>

				<p>I have to agree with previous posters, it is highly doubtful that the contents of a magnetic strip can contain information that causes a buffer overflow attack. You&#8217;d have to get the card reader firmware (which is stored in a ROM) to send an oversized message first, and then the application has to be written in an unusually stupid way.</p>
<p>Not all that likely. It seems more likely that the creator of the original article has something to sell to the ATM industry.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114496">

			<div class="comment by-todd ">

				<p class="commentcredit">

					<span class="commenter">Todd</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114496">
						June 10, 2009 7:18 PM					</a>

				</p>

				<p>&#8220;&#8230;they can perform various functions, including harvesting the purloined data or even ejecting the cash box.&#8221;  Should that read &#8220;ejecting the CONTENTS of the cash box.&#8221;? Given the cash container is physically secured, I don&#8217;t see how this is possible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114497">

			<div class="comment by-ninja ">

				<p class="commentcredit">

					<span class="commenter">Ninja</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114497">
						June 10, 2009 7:25 PM					</a>

				</p>

				<p>Another commenter mentioned the cameras watching the ATMs. But who&#8217;s watching the cameras? If a masked offender walks up to an ATM at 4am and hacks it with an overflow card, how many real transactions will go through before it&#8217;s discovered?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114498">

			<div class="comment by-g ">

				<p class="commentcredit">

					<span class="commenter">G</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114498">
						June 10, 2009 8:28 PM					</a>

				</p>

				<p>IMHO it is highly unlikely that the code was injected via a card &#8211; this is just a blatant unverified assumption in the linked article.  The report does not state the source of the initial compromise, which is probably someone with access to the OS store on the machine.  Once the code is there, like any hacked system, any trigger (aka card in this case) can be used.  Don&#8217;t see anything new here except a compromised network via the usual routes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114499">

			<div class="comment by-rophuine ">

				<p class="commentcredit">

					<span class="commenter">Rophuine</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114499">
						June 10, 2009 9:22 PM					</a>

				</p>

				<p>re: Cameras<br />
Having worked in IT for a TPP, I got to assist with plenty of ATM theft cases. It&#8217;s amazing how often the thief: a) lives in the local area, and b) smiles for the camera. The unmaintained, non-functional camera myth works wonders, even today. The smart ones just cover their faces up; many ATMs are accessible late at night when few people are around to be suspicious.</p>
<p>re: Initial Exploit<br />
I read the report, and couldn&#8217;t see anything specific about the initial compromise vector. Buffer overflow via the mag-stripe seems unlikely to yield the amount of exploit code involved, or even to provide a vector to cause download and execution from elsewhere. I would suspect the usual vector is via tech staff.</p>
<p>re: PIN block<br />
I&#8217;m not sure about European standards, but where I&#8217;ve worked there are all sorts of rules surrounding PIN entry keypads. Specifically, they must contain an additional layer of encryption separate to the rest of the transaction device. The &#8216;additional data which may be PIN-related&#8217; (my paraphrasing) is likely to be a DES or 3-DES block containing a salted hash of the PIN. Given the situation, you could make a chosen-plaintext attack against this layer, but it&#8217;s still a thorny problem. Keys are rotated frequently. Well, they&#8217;re meant to be.</p>
<p>One possibility is that the thieves are hoping to grab a large volume of track 2 data and perform a reverse-brute-force attack (same password, many accounts) using two or three common PINs.</p>
<p>If they were able to prevent the encryption layer from triggering, this should prevent the transaction from completing (as the acquirer will be expecting an encrypted PIN block), although this could be defeated with a social attack (first transaction ALWAYS fails with &#8216;Incorrect PIN&#8217;, second transaction turns the encryption layer back on).</p>
<p>All of that aside, I still suspect (as ge suggested) that the author wants to sell the banks some service or software.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114500">

			<div class="comment by-filias-cupio ">

				<p class="commentcredit">

					<span class="commenter">Filias Cupio</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114500">
						June 10, 2009 9:25 PM					</a>

				</p>

				<p>&#8220;One of the risks of using a commercial OS for embedded systems like ATM machines: it&#8217;s easier to write malware against it&#8221;</p>
<p>&#8220;Don&#8217;t use a commercial OS for ATM machines&#8221; would be a security through obscurity measure. Rather I would say &#8220;Don&#8217;t use a large complex general purpose OS for ATM machines.&#8221; (Especially one which has a poor reputation for security.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114501">

			<div class="comment by-salach-shabati ">

				<p class="commentcredit">

					<span class="commenter">Salach Shabati</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114501">
						June 10, 2009 11:25 PM					</a>

				</p>

				<p>In Europe almost all ATMs support smartcards, which give a higher-bandwidth channel to the ATM. Still it requires intimate knowledge to mount an attack via this channel, so i guess the infection was done in a different way and not as speculated in the article. As someone else said wisely &#8211; once the malware is in place a card could be used to trigger it into action, but it seems unlikely that it was injected that way.<br />
The theory that the company is advancing some sort of product they want to sell seems also very valid.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114502">

			<div class="comment by-paul ">

				<p class="commentcredit">

					<span class="commenter">paul</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114502">
						June 11, 2009 12:28 AM					</a>

				</p>

				<h2>@bob:</h2>
<h2>I dont understand why people sell &#8220;limited use&#8221; computers, like ATMs, Voting Machines, GPSs, automobiles that use an OS for &#8220;general purpose&#8221; systems like Win, Mac, Linux etc.</h2>
<p>I think it&#8217;s pricing. If they can use already-written software, it means they don&#8217;t have to develop it themselves, which means shorter development time, which means lower cost, which means lower price, which means competitive advantage. Might also mean more successful attacks, but they don&#8217;t include that in their RFP responses haha.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114503">

			<div class="comment by-dimitris-andrakakis ">

				<p class="commentcredit">

					<span class="commenter">Dimitris Andrakakis</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114503">
						June 11, 2009 2:24 AM					</a>

				</p>

				<p>I wonder if Bruce is referring to this :</p>
<p>Data-sniffing trojans burrow into Eastern European ATMs (<a href="http://www.theregister.co.uk/2009/06/03/atm_trojans" rel="nofollow ugc">http://www.theregister.co.uk/2009/06/03/atm_trojans</a>)</p>
<p>If so, according to the article the malware &#8220;can be installed only by people with physical access to the machines, making some level of insider cooperation necessary&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114504">

			<div class="comment by-cybergibbons ">

				<p class="commentcredit">

					<span class="commenter">Cybergibbons</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114504">
						June 11, 2009 2:40 AM					</a>

				</p>

				<p>I don&#8217;t think it would be particularly hard to exploit these machines. I&#8217;ve frequently seen machines which have been partially or entirely broken open, giving access to a CD-ROM drive and even a keyboard. This is more common with the stand-alone ATMs found in petrol stations and shopping centres.</p>
<p>An example is <a href="http://s3.amazonaws.com/twitpic/photos/large/3840363.jpg?AWSAccessKeyId=0ZRYP5X5F6FSMBCCSE82&#038;Expires=1244706734&#038;Signature=N1WQtUSrznEJC8sur6kwN6ac65w%3D" rel="nofollow ugc">http://s3.amazonaws.com/twitpic/photos/large/3840363.jpg?AWSAccessKeyId=0ZRYP5X5F6FSMBCCSE82&#038;Expires=1244706734&#038;Signature=N1WQtUSrznEJC8sur6kwN6ac65w%3D</a><br />
 and <a href="http://s3.amazonaws.com/twitpic/photos/large/3840515.jpg?AWSAccessKeyId=0ZRYP5X5F6FSMBCCSE82&#038;Expires=1244706735&#038;Signature=l1lIn9Nx2BO%2B0y1YyYpxzEZdIA4%3D" rel="nofollow ugc">http://s3.amazonaws.com/twitpic/photos/large/3840515.jpg?AWSAccessKeyId=0ZRYP5X5F6FSMBCCSE82&#038;Expires=1244706735&#038;Signature=l1lIn9Nx2BO%2B0y1YyYpxzEZdIA4%3D</a>. People were still using this machine, I called the number on it to report it damaged, and they didn&#8217;t seem to care.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114505">

			<div class="comment by-imarsorama ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://imarsorama.com/' rel='external nofollow ugc' class='url'>imarsorama</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114505">
						June 11, 2009 4:02 AM					</a>

				</p>

				<p>@Rophuine:<br />
&#8220;re: Initial Exploit<br />
I read the report, and couldn&#8217;t see anything specific about the initial compromise vector. &#8221;</p>
<p>The report clearly says that &#8220;The malware is installed and activated through a dropper file&#8221;</p>
<p>It&#8217;s all about opening the ATM case, plugging in USB device and running malware. Unimaginable number of local physical attack vectors are not addressed in most ATM OS builds &#8211; USB, CD, easy admin passwordm unlocked desktop, once even Autorun.</p>
<p>@Dimitris Andrakakis: You are absolutely right, Trustwave refers to that Diebold malware.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114506">

			<div class="comment by-asmor ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.encounteraday.com' rel='external nofollow ugc' class='url'>Asmor</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114506">
						June 11, 2009 4:38 AM					</a>

				</p>

				<p><i>One of the risks of using a commercial OS for embedded systems like ATM machines: it&#8217;s easier to write malware against it:</i></p>
<p>Tacit endorsement of security through obscurity?</p>
<p>Surely the problem here is that they used a notoriously insecure OS. Don&#8217;t get me wrong, I&#8217;m a Windows user through and through, but I hope to hell my bank isn&#8217;t using it for their ATMs&#8230;</p>
<p>Seems like if they&#8217;re going that route, some flavor of Linux would be wise.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114507">

			<div class="comment by-mark ">

				<p class="commentcredit">

					<span class="commenter">Mark</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114507">
						June 11, 2009 6:02 AM					</a>

				</p>

				<p>@bob<br />
I dont understand why people sell &#8220;limited use&#8221; computers, like ATMs, Voting Machines, GPSs, automobiles that use an OS for &#8220;general purpose&#8221; systems like Win, Mac, Linux etc.</p>
<p>In this case things are made worst by using a general purpose OS which has a poor distinction between &#8220;user&#8221; and &#8220;admin&#8221; tasks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114508">

			<div class="comment by-loldongs ">

				<p class="commentcredit">

					<span class="commenter">loldongs</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114508">
						June 11, 2009 6:07 AM					</a>

				</p>

				<p>Another reason windows gets used, instead of some specialised hardened OS, is that banks like to monetize their ATMs by having them show fancy animated adverts. These are probably windows screensavers (i.e. executables that present another infection vector.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114509">

			<div class="comment by-dimitris-andrakakis ">

				<p class="commentcredit">

					<span class="commenter">Dimitris Andrakakis</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114509">
						June 11, 2009 6:16 AM					</a>

				</p>

				<p>@Asmor :</p>
<p>I don&#8217;t see an endorsement here. Bruce merely says that it&#8217;s easier to write malware against a commercial (which I read as &#8220;widely used&#8221;) OS.</p>
<p>If the OS was custom built or something you don&#8217;t come across every day (think AS/400, HP-UX, Solaris or ) then the talent pool for malware programmers would be severely limited. Therefore</p>
<p>Note that does not imply or require for one OS to be more secure than the other.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114510">

			<div class="comment by-adam ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://geekswithblogs.net/aschepis' rel='external nofollow ugc' class='url'>Adam</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114510">
						June 11, 2009 6:26 AM					</a>

				</p>

				<p>LSASS is pretty important in windows.  LSASS == Local Security Authority Subsystem Service and is responsible for enforcing the security policy on Windows machines</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114511">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114511">
						June 11, 2009 6:34 AM					</a>

				</p>

				<p>(My apologies for hitting &#8220;post&#8221; before completing)</p>
<p>@Asmor :<br />
I don&#8217;t see an endorsement here. Bruce merely says that it&#8217;s easier to write malware against a commercial (which I read as &#8220;widely used&#8221;) OS.</p>
<p>If the OS was custom built or something you don&#8217;t come across every day (think AS/400, HP-UX, Solaris or even the now-extinct BeOS for that matter) then the talent pool for malware programmers would be severely limited, and the creation of malware would be inhibited.</p>
<p>Note that does not imply or require for one OS to be more secure than the other.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114512">

			<div class="comment by-mark-r ">

				<p class="commentcredit">

					<span class="commenter">Mark R</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114512">
						June 11, 2009 7:25 AM					</a>

				</p>

				<p>If this attack relied on physical access to install the malicious code, doesn&#8217;t that sort of make the OS irrelevant?</p>
<p>I would think this falls more into the realm of hardware controls and restricting what can be done at the local console.  Unfortunately, 90% of the time it holds true that &#8220;local access is total access.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114513">

			<div class="comment by-cybergibbons ">

				<p class="commentcredit">

					<span class="commenter">Cybergibbons</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114513">
						June 11, 2009 7:31 AM					</a>

				</p>

				<p>The cryptoprocessors in these things are very tamper resistant.</p>
<p>Maybe it would be a good idea for the whole thing to be tamper resistant, and at least how some form of secure auditing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114514">

			<div class="comment by-beos ">

				<p class="commentcredit">

					<span class="commenter">BeOS</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114514">
						June 11, 2009 8:21 AM					</a>

				</p>

				<p>BeOS isn&#8217;t quite extinct. The audio company, IZ Technology, uses BeOS as the OS for their recording systems. I&#8217;m guessing they procured a source license from Be prior to operations shut down, but I&#8217;m just guessing. Maybe when Palm goes belly up, some other corp will get the IP and open in&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114515">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114515">
						June 11, 2009 8:38 AM					</a>

				</p>

				<p>@paul: &#8220;I think it&#8217;s pricing. If they can use already-written software, it means they don&#8217;t have to develop it themselves, which means shorter development time, which means lower cost, which means lower price, which means competitive advantage. Might also mean more successful attacks, but they don&#8217;t include that in their RFP responses haha.&#8221;</p>
<hr />
<p>It&#8217;s also continuity, and there is an upside to security.  There is high turnover in IT, and any new employee would need to be trained on the OS.  Further, while commercial OS would be easier for an outsider to exploit, I would image an in-house OS would be easier for an insider to exploit and harder for someone to detect.</p>
<p>This whole story seems a bit fishy to me, since I can&#8217;t imagine all this being initiated from a ATM card slot&#8211;unless there was collusion from the inside.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114516">

			<div class="comment by-alex ">

				<p class="commentcredit">

					<span class="commenter">Alex</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114516">
						June 11, 2009 9:19 AM					</a>

				</p>

				<ol>
<li>The &#8220;card reader buffer overflow attack&#8221; is completely on Inquirer, the brief I’ve read said it was an internal job, file was installed by bank&#8217;s employees, inside <em>signed</em> update package.</li>
<li>Any ATM I&#8217;ve seen from Diebold, NCR, Siemens-Nixdorf uses heavily customized version of Windows 2000/XP Embedded.  (Old IBMs use OS/2, still working:-)). Almost any management tool/protocol (rdp, wmi, rpc, remote registry) is removed or restricted.  I can’t say that those ATMs are normal Windows boxes.</li>
<li>“Eastern Europe” means one (big) bank in country located between Poland and China.</li>
</ol>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114517">

			<div class="comment by-fp ">

				<p class="commentcredit">

					<span class="commenter">FP</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114517">
						June 11, 2009 9:20 AM					</a>

				</p>

				<p>@bob: &#8220;They should write a dedicated OS&#8221;</p>
<p>In general it&#8217;s smart to use an off the shelf operating system.  Means more functionality, better development and debugging tools, larger developer and user base, and generally better testing.  All result is faster time to market for less cost.</p>
<p>How many bugs would a dedicated OS have?</p>
<p>Sound development practices need to be applied either way.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114518">

			<div class="comment by-shane ">

				<p class="commentcredit">

					<span class="commenter">Shane</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114518">
						June 11, 2009 11:08 AM					</a>

				</p>

				<p>@Filias Cupio<br />
&#8220;&#8216;Don&#8217;t use a commercial OS for ATM machines&#8217; would be a security through obscurity measure.&#8221;</p>
<p>@Asmor<br />
&#8220;Tacit endorsement of security through obscurity?&#8221;</p>
<p>Are you guys high? No, really?</p>
<p>Not using a full on windows desktop OS on an ATM is not &#8216;security through obscurity&#8217;, it&#8217;s just plain common sense.</p>
<p>This isn&#8217;t a desktop home computer, it has a very specific and very sensitive (people are sensitive about their money) set of tasks.  Using a bloated, buggy OS chalk full of all the best security holes of the day is just plain ignorant.  Using a streamlined, hardened to the brink OS written with the hardware, tasks and major security concerns kept in mind is, again, common sense.</p>
<p>I&#8217;m also quite certain that, given the man, Bruce would much prefer a solution that was open for peer review.  The &#8216;we promise it is safe&#8217; bit doesn&#8217;t cut it around here.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114519">

			<div class="comment by-doug-coulter ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.coultersmithing.com' rel='external nofollow ugc' class='url'>Doug Coulter</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114519">
						June 11, 2009 9:46 PM					</a>

				</p>

				<p>I&#8217;ve rolled my own OS&#8217;s for quite a large number of embedded devices.  Even for ones that do a lot more than an ATM, it&#8217;s just not that hard compared to a general purpose gui desktop system, and needn&#8217;t necessarily introduce more security bugs or issues.  You just keep it simple, cooperative multitasking at most, eg main loop just calls state machines that do things and return when done or between chunks of lengthy jobs. Reset the watchdog timer each time around, done.</p>
<p>You probably don&#8217;t need a filesystem or a lot of other complex I/O driver stuff if you design the thing right.</p>
<p>By simply leaving out things the application doesn&#8217;t need, but which are hard to strip (or tempting not to for debug reasons) from a big OS, you gain quite a bit in security.  And since the boot time is now effectively zero, you can have it reboot or hit a watchdog timer if anything seems the least bit fishy and most users won&#8217;t notice or complain.<br />
Makes it real hard to crack.</p>
<p>In embedded systems, any memory, cycles, whatever that isn&#8217;t used is a waste of money.  When you&#8217;re making millions of them (think paging or telephony systems) being able to use a small 8 bit controller vs a windows CE class computer is a very big deal &#8212; you only pay for the software effort once, not for every unit.  We&#8217;ve heard CEO&#8217;s chortling down the hall that we only charged them a few hundred K$ for software they were going to make millions from (and they did).</p>
<p>Calling this security by obscurity is like calling encryption the same thing in my opinion.<br />
Heck, 99% of the secure systems I did for lots of 9&#8217;s reliability didn&#8217;t even have the ability to write the code store at all (took an external programmer of some sort) &#8212; cheaper and avoids quite a lot of trouble.</p>
<p>That all companies don&#8217;t do it this way perhaps speaks more to the lack of good programmers more than anything else.  With a general purpose OS, after all, you can use drag/drop/java code monkies who can&#8217;t really program well, but are common and cheap &#8212; even though it would be cheaper to hire a pro for 3-5 times the hourly rate, if you could just find one of us.</p>
<p>And our results are better, faster, cleaner and more secure, by design, because we had control over the design, and didn&#8217;t have to leverage things we couldn&#8217;t understand (not because we were dumb, but because the design was a secret like windows source code, for example).  And in fact, when an opysys gets that complex, I&#8217;d submit that no one truly understands all the possible interactions that can lead to a breach.  It&#8217;s just not smart to go that way.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114520">

			<div class="comment by-steve-friedl ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://unixwiz.net' rel='external nofollow ugc' class='url'>Steve Friedl</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114520">
						June 11, 2009 10:57 PM					</a>

				</p>

				<p>@Shane: ATMs and other systems use XP Embedded, and this is not the same thing you have at home. The build/configuration systems offer more than 10,000 options (really!) for excluding this component or including that one. It&#8217;s incredibly tunable: if you don&#8217;t want notepad or a desktop or an IP layer, you can exclude them.</p>
<p>Diebold says that the hack required physical access to the inside of the machine: <a href="http://www.diebold.com/ATMs_illegalsoftware_Russia/default.htm" rel="nofollow ugc">http://www.diebold.com/ATMs_illegalsoftware_Russia/default.htm</a></p>
<p>I&#8217;m not sure if any OS could withstand this kind of inside attack, and it seems disingenuous to use this to justify any position on choice of software.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114521">

			<div class="comment by-peter-maxwell ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.allicient.co.uk/' rel='external nofollow ugc' class='url'>Peter Maxwell</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114521">
						June 12, 2009 6:59 AM					</a>

				</p>

				<p>There is a very specific reason why a large proportion of the ATMs you&#8217;ll come across &#8211; at least in the UK anyway &#8211; will be using Windows; and it has nothing to do with ease of software design, maintenance, OS security, or for that matter anything about the ATM unit itself.  Unfortunately, it is probably covered by the confidentiality clause from my last job so I&#8217;ll have to stop short of pointing out what it actually is.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114522">

			<div class="comment by-eric-s ">

				<p class="commentcredit">

					<span class="commenter">Eric S.</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114522">
						June 13, 2009 12:45 AM					</a>

				</p>

				<p>@Bob: I once saw an ATM crash when I put my card in, and I got to watch as OS/2 booted up.  That was surreal.  Oh, and it ate my card.  🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114523">

			<div class="comment by-anton ">

				<p class="commentcredit">

					<span class="commenter">Anton</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114523">
						June 13, 2009 2:30 AM					</a>

				</p>

				<p>So what software is generally used to fly commercial or military aircraft</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114524">

			<div class="comment by-bobalink ">

				<p class="commentcredit">

					<span class="commenter">bobalink</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114524">
						June 14, 2009 12:39 PM					</a>

				</p>

				<p>Another big reason to use Windows is the programmer pool.  It&#8217;s orders of magnitude larger than the pool for embedded OSes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114525">

			<div class="comment by-euan ">

				<p class="commentcredit">

					<span class="commenter">Euan</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114525">
						June 14, 2009 10:45 PM					</a>

				</p>

				<p>Commercial is the wrong term.  An open source OS can still be commercial.</p>
<p>Proprietary or closed source would be more accurate.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114526">

			<div class="comment by-angel-one ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.angelsofsecurity.com' rel='external nofollow ugc' class='url'>Angel One</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114526">
						June 16, 2009 1:47 PM					</a>

				</p>

				<p>The problem with Windows is not that it is commercial or common, but that it is general purpose. A windows machine can surf the web, make word documents, read acrobat files, watch movies, and edit photos. None of these are functions that you want your ATM to be performing. The advantage to embedded devices is not that they are unknown, but that they do nothing other than what they are supposed to do, and therefore greatly reduce the chances of vulnerabilities being found.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114527">

			<div class="comment by-peter-maxwell ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.allicient.co.uk/' rel='external nofollow ugc' class='url'>Peter Maxwell</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114527">
						June 17, 2009 5:31 PM					</a>

				</p>

				<p>@Angel One:&#8221;The advantage to embedded devices is not that they are unknown, but that they do nothing other than what they are supposed to do&#8230;&#8221;</p>
<p>It is also the disadvantage of embedded devices.  Windows, disregarding all the debate over pros and cons, has a massive associated base of software, hardware, etc that only works with windows.  So say you are managing the role out of a big project&#8230; you see a product which is cost effective, maintainable and pretty much the best on the market, it however only runs with windows &#8211; what do you do?  Do you force the company you work for to spend over the odds on an inferior product, or do you use the one that must run on windows?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-114528">

			<div class="comment by-malware ">

				<p class="commentcredit">

					<span class="commenter">malware</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114528">
						November 10, 2009 1:08 PM					</a>

				</p>

				<p>&#8220;I am highly skeptical of a buffer overflow attack being mounted through the magstripe reader. Not only do cards only contain a limited amount of data (but could be theoretically infinite if a card emulator was used), but the character set is EXTREMELY limited, especially on track 2. I would be VERY impressed if someone managed to write a successful buffer overflow that only used this limited character set.&#8221;<br />
@Karl  I think they use multiple malicious cards- one to get in, and a few more to install malware. If so, you wouldnt necessarily be limited to a character limit, but by the chance of someone getting in line behind you. Or the security &#8220;cameras&#8221; whom someone said were mostly non-funcitonal&#8230;..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-114530">

			<div class="comment by-banacles ">

				<p class="commentcredit">

					<span class="commenter">Banacles</span> •

					<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/#comment-114530">
						December 17, 2009 10:30 AM					</a>

				</p>

				<p>i need the malware (isass.exe)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2009/06/malware_steals.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2009/06/malware_steals.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2009%2F06%2Fmalware_steals.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2009/06/malware_steals.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='2884' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2009/06/im_selling_my_l.html" rel="prev">← I&#039;m Selling My Laptop</a>		<a href="https://www.schneier.com/blog/archives/2009/06/second_shb_work.html" rel="next">Second SHB Workshop Liveblogging (1) →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
