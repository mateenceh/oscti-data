<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Another New AES Attack - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Another New AES Attack Comments Feed" href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/2975" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=2975' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2009%2F07%2Fanother_new_aes.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2009%2F07%2Fanother_new_aes.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-2975 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-2975" class="post-2975 post type-post status-publish format-standard hentry category-uncategorized tag-academic-papers tag-aes tag-cryptanalysis tag-cryptography">

	<div class="article">

		<h2 class="entry">Another New AES Attack</h2>
		<p>A new and very impressive attack against <a href="http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf">AES</a> has just been announced.</p>
<p>Over the past couple of months, there have <a href="http://eprint.iacr.org/2009/241">been</a> <a href="http://eprint.iacr.org/2009/317">two</a> (the second blogged about <a href="http://www.schneier.com/blog/archives/2009/07/new_attack_on_a.html">here</a>) new cryptanalysis papers on AES.  The attacks presented in the papers are not practical &#8212; they&#8217;re far too complex, they&#8217;re related-key attacks, and they&#8217;re against larger-key versions and not the 128-bit version that most implementations use &#8212; but they are impressive pieces of work all the same.</p>
<p>This new attack, by Alex Biryukov, Orr Dunkelman, Nathan Keller, Dmitry Khovratovich, and Adi Shamir, is much more devastating.  It is a completely practical attack against ten-round AES-256:</p>
<blockquote><p><b>Abstract.</b><br />AES is the best known and most widely used block cipher. Its three versions (AES-128, AES-192, and AES-256) differ in their key sizes (128 bits, 192 bits and 256 bits) and in their number of rounds (10, 12, and 14, respectively). In the case of AES-128, there is no known attack which is faster than the 2<sup>128</sup> complexity of exhaustive search. However, AES-192 and AES-256 were recently shown to be breakable by attacks which require 2<sup>176</sup> and 2<sup>119</sup> time, respectively. While these complexities are much faster than exhaustive search, they are completely non-practical, and do not seem to pose any real threat to the security of AES-based systems.</p>
<p>In this paper we describe several attacks which can break with practical complexity variants of AES-256 whose number of rounds are comparable to that of AES-128. One of our attacks uses only two related keys and 2<sup>39</sup> time to recover the complete 256-bit key of a 9-round version of AES-256 (the best previous attack on this variant required 4 related keys and 2<sup>120</sup> time). Another attack can break a 10 round version of AES-256 in 2<sup>45</sup> time, but it uses a stronger type of related subkey attack (the best previous attack on this variant required 64 related keys and 2<sup>172</sup> time).</p></blockquote>
<p>They also describe an attack against 11-round AES-256 that requires 2<sup>70</sup> time &#8212; almost practical.</p>
<p>These new results greatly improve on the Biryukov, Khovratovich, and Nikolic papers mentioned above, and a <a href="https://www.schneier.com/wp-content/uploads/2009/07/paper-rijndael-2.pdf">paper</a> I wrote with six others in 2000, where we describe a related-key attack against 9-round AES-256 (then called Rijndael) in 2<sup>224</sup> time.  (This again proves the cryptographer&#8217;s adage: attacks always get better, they never get worse.)</p>
<p>By any definition of the term, this is a huge result.</p>
<p>There are three reasons not to panic:</p>
<ul>
<li>The attack exploits the fact that the key schedule for 256-bit version is pretty lousy &#8212; something we pointed out in our 2000 paper &#8212; but doesn&#8217;t extend to AES with a 128-bit key.
<li>It&#8217;s a related-key attack, which requires the cryptanalyst to have access to plaintexts encrypted with multiple keys that are related in a specific way.
<li>The attack only breaks 11 rounds of AES-256.  Full AES-256 has 14 rounds.</ul>
<p>Not much comfort there, I agree.  But it&#8217;s what we have.</p>
<p>Cryptography is all about safety margins.  If you can break <i>n</i> round of a cipher, you design it with 2<i>n</i> or 3<i>n</i> rounds.  What we&#8217;re learning is that the safety margin of AES is much less than previously believed.  And while there is no reason to scrap AES in favor of another algorithm, NST should increase the number of rounds of all three AES variants.  At this point, I suggest AES-128 at 16 rounds, AES-192 at 20 rounds, and AES-256 at 28 rounds.  Or maybe even more; we don&#8217;t want to be revising the standard again and again.</p>
<p>And for new applications I suggest that people don&#8217;t use AES-256.  AES-128 provides more than enough security margin for the forseeable future.  But if you&#8217;re already using AES-256, there&#8217;s no reason to change.</p>
<p>The paper I have is still a draft.  It is being circulated among cryptographers, and should be online in a couple of days.  I will post the link as soon as I have it.</p>
<p>UPDATED TO ADD (8/3): The paper is <a href="http://eprint.iacr.org/2009/374">public</a>.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/academic-papers/" rel="tag">academic papers</a>, <a href="https://www.schneier.com/tag/aes/" rel="tag">AES</a>, <a href="https://www.schneier.com/tag/cryptanalysis/" rel="tag">cryptanalysis</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html" rel="bookmark">Posted on July 30, 2009 at 9:26 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html#comments">144 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html" data-title="Another New AES Attack" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-118132">

			<div class="comment by-aes ">

				<p class="commentcredit">

					<span class="commenter">aes</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118132">
						July 30, 2009 10:16 AM					</a>

				</p>

				<blockquote>
<blockquote><p>
    I suggest AES-128 at 16 rounds, AES-192 at 20 rounds, and AES-256 at 28 rounds.
  </p></blockquote>
</blockquote>
<p>This would mean that AES would be almost twice as slow, so AES-128 would run at about 25-30 cpb. I would be concerned that the users would start rejecting the standard in favour of faster alternatives.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118133">

			<div class="comment by-peleus ">

				<p class="commentcredit">

					<span class="commenter">peleus</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118133">
						July 30, 2009 10:20 AM					</a>

				</p>

				<p>But didn&#8217;t we already assume the NSA had known about these attacks all along? Kind of like what happened with DES for a decade before we realized we should use triple DES instead. Regardless AES will probably remain viable for a good long time for your average user&#8217;s needs. Whereas persons with high security needs  will/should continue to rely a security schema consisting of various tools rather than a single security solution such as cryptography.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118134">

			<div class="comment by-aes ">

				<p class="commentcredit">

					<span class="commenter">aes</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118134">
						July 30, 2009 10:22 AM					</a>

				</p>

				<blockquote>
<blockquote><p>
    I suggest AES-128 at 16 rounds, AES-192 at 20 rounds, and AES-256 at 28 rounds.
  </p></blockquote>
</blockquote>
<p>And what about the key schedule and the s-box(algebraic properties). Should they be fixed to, just in case?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118135">

			<div class="comment by-casey ">

				<p class="commentcredit">

					<span class="commenter">Casey</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118135">
						July 30, 2009 10:41 AM					</a>

				</p>

				<p>If we do have to increase the number of rounds due to security concerns, I wonder if this means we need to take a more serious look at Serpent.  IIRC, this was regarded as the most secure of the algorithms submitted to AES and I believe the main point for rejection was speed (Don&#8217;t quote me on this, I very well my be wrong).</p>
<p>I&#8217;m not saying that we should replace AES now or in the near future.  I&#8217;m just suggesting that we may want to have a backup plan and if adding more rounds to AES is the only solution, then maybe Serpent gives us a better safety margin.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118136">

			<div class="comment by-doug ">

				<p class="commentcredit">

					<span class="commenter">Doug</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118136">
						July 30, 2009 10:52 AM					</a>

				</p>

				<p>So if I read this right (haven&#8217;t seen the paper yet), AES-128 is actually harder to break than AES-256 due to the nature of this attack?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118137">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">Chris</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118137">
						July 30, 2009 11:23 AM					</a>

				</p>

				<blockquote>
<blockquote><p>
    But didn&#8217;t we already assume the NSA had known about these attacks all along?
  </p></blockquote>
</blockquote>
<p>DES was developed by the NSA internally and was not subject to much analysis prior to it being released. While it&#8217;s debated if the NSA thought it was faulty to begin with (the &#8220;key size&#8221; argument) it&#8217;s development was not an open discussion.</p>
<p>AES on the other hand was developed from dozens of openly submitted algorithms that where analysed by any party that wanted to take a look at it. Rijndael was selected because it seemed to be the best at the time. But there was no conspiracy to push Rijndael as the algorithm because it was known to have flaws. As good as they are, it&#8217;s hard to assume that the NSA&#8217;s cryptographers are so good that they would find things that the rest of the world&#8217;s crypto experts would miss.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118138">

			<div class="comment by-bobby-g ">

				<p class="commentcredit">

					<span class="commenter">Bobby G.</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118138">
						July 30, 2009 11:39 AM					</a>

				</p>

				<p>What this shows to me is that we never can completely trust that there isn&#8217;t unknown better attacks out there. While we can&#8217;t assume the NSA (or similar agencies) have better experts, we can chain together a few likelihoods that could be uncomfortable for some. Agencies like this have deep pockets not directly focused on profit and are quite likely to be able to have experts as good or better than others. Agencies like this are quite unlikely to publicly announce their abilities. A saving grace I would think is that they can&#8217;t actually use any such ability in legal cases without obviously making it known they have the ability. Hence, they may be limited to clandestine use.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118139">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118139">
						July 30, 2009 11:50 AM					</a>

				</p>

				<p>Bruce and Co. was advocating additional rounds for Rijndael back in 2000 (<a href="http://www.schneier.com/paper-twofish-final.pdf" rel="nofollow ugc">http://www.schneier.com/paper-twofish-final.pdf</a>). Or, they should have chosen TwoFish/Serpent instead&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118140">

			<div class="comment by-nick ">

				<p class="commentcredit">

					<span class="commenter">nick</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118140">
						July 30, 2009 11:51 AM					</a>

				</p>

				<p>This seems to suggest AES128 is stronger than AES256. Bruce, could you clarify?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118141">

			<div class="comment by-k-signal-eingang ">

				<p class="commentcredit">

					<span class="commenter">K. Signal Eingang</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118141">
						July 30, 2009 12:13 PM					</a>

				</p>

				<p>It looks to me like this does show AES-256 to be weaker than 128, but only if the listed preconditions are met &#8211; that is, that the encryption method is carried out for fewer rounds than standard, and the attacker already has some relatively hard-to-get information.  I would be curious to know how one knows how many rounds are being used, though, and whether it&#8217;s important for the attacker to know this number or not.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118142">

			<div class="comment by-blue-moon ">

				<p class="commentcredit">

					<span class="commenter">Blue Moon</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118142">
						July 30, 2009 12:20 PM					</a>

				</p>

				<p>I think this new attack on AES may cause NIST to shy away from hashes that are based on AES, even though there may be no direct relationship between the attack and the hash.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118143">

			<div class="comment by-gabriel-jagenstedt ">

				<p class="commentcredit">

					<span class="commenter">Gabriel Jägenstedt</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118143">
						July 30, 2009 12:21 PM					</a>

				</p>

				<p>@ K. Signal: Well one easy way to check is by having a look in the source code of whatever implementation you are running. For example the loop-aes implementation clearly uses 14 rounds and I would guess most other implementations do the same.</p>
<p>However Im unsure what effect the fact that loop-aes uses 65 keys not 1 has on this attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-118144">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118144">
						July 30, 2009 1:13 PM					</a>

				</p>

				<p>&#8220;This would mean that AES would be almost twice as slow&#8230;&#8221;</p>
<p>No.  It would be 50% slower.  Right now AES-128 has ten rounds.</p>
<p>Security doesn&#8217;t come for free.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-118145">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118145">
						July 30, 2009 1:15 PM					</a>

				</p>

				<p>&#8220;But didn&#8217;t we already assume the NSA had known about these attacks all along?&#8221;</p>
<p>Actually, the NSA approved AES for use up to &#8212; I think &#8212; SECRET, so they either didn&#8217;t know about the attack or didn&#8217;t care.  Or wanted us all to think they couldn&#8217;t break it, and were willing to sacrifice their secrets to perpetuate that belief.</p>
<p>Wheels within wheels&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-118146">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118146">
						July 30, 2009 1:17 PM					</a>

				</p>

				<p>&#8220;And what about the key schedule and the s-box(algebraic properties). Should they be fixed to, just in case?&#8221;</p>
<p>Fixing the 256-bit key schedule would be nice, but that&#8217;s a more complicated change.  Adding rounds is quick and easy, and requires very little thought.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-118147">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118147">
						July 30, 2009 1:20 PM					</a>

				</p>

				<p>&#8220;If we do have to increase the number of rounds due to security concerns, I wonder if this means we need to take a more serious look at Serpent&#8230;.  I&#8217;m not saying that we should replace AES now or in the near future. I&#8217;m just suggesting that we may want to have a backup plan and if adding more rounds to AES is the only solution, then maybe Serpent gives us a better safety margin.&#8221;</p>
<p>We could certainly abandon AES in favor of either Serpent or Twofish.  But those algorithms are both over a decade old, and designed for 32-bit CPUs.</p>
<p>I would much rather extend the life of AES now, and have NIST &#8212; or someone &#8212; hold a new competition for a replacement algorithm after they finish with SHA-3.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-118148">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118148">
						July 30, 2009 1:22 PM					</a>

				</p>

				<p>&#8220;So if I read this right (haven&#8217;t seen the paper yet), AES-128 is actually harder to break than AES-256 due to the nature of this attack?&#8221;</p>
<p>Yes and no.  Neither can be broken.  There are no attacks against any AES variants that are better than brute force; all of these attacks are against reduced-round variants.</p>
<p>That being said, the key schedule for AES-256 is very poor.  I would recommend that people use AES-128 and not AES-256.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-118149">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118149">
						July 30, 2009 1:24 PM					</a>

				</p>

				<p>&#8220;What this shows to me is that we never can completely trust that there isn&#8217;t unknown better attacks out there.&#8221;</p>
<p>Of course.</p>
<p>All we can ever say about the security of a symmetric cipher is that we can&#8217;t break it, and that no one else we know has admitted to being able to break it, either.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-118150">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118150">
						July 30, 2009 1:28 PM					</a>

				</p>

				<p>&#8220;I would be curious to know how one knows how many rounds are being used, though, and whether it&#8217;s important for the attacker to know this number or not.&#8221;</p>
<p>The number of rounds is fixed and not part of the key.  It&#8217;s public information.</p>
<p>In all cryptanalytic attacks, we assume that the attacker knows all the details of the algorithm.  We assume they can disassemble the hardware, reverse-engineer the chips, recover the source code, and so on.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118151">

			<div class="comment by-jeremy ">

				<p class="commentcredit">

					<span class="commenter">Jeremy</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118151">
						July 30, 2009 1:31 PM					</a>

				</p>

				<p>&#8220;Actually, the NSA approved AES for use up to &#8212; I think &#8212; SECRET, so they either didn&#8217;t know about the attack or didn&#8217;t care.&#8221;</p>
<p>If I recall correctly, they approved AES-192 and AES-256 for TOP SECRET.</p>
<p>I notice you&#8217;ve commented that this attack doesn&#8217;t extend to AES-128, but haven&#8217;t mentioned AES-192.  Is that more similar to AES-128 or AES-256?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-118152">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118152">
						July 30, 2009 1:33 PM					</a>

				</p>

				<p>&#8220;I notice you&#8217;ve commented that this attack doesn&#8217;t extend to AES-128, but haven&#8217;t mentioned AES-192. Is that more similar to AES-128 or AES-256?&#8221;</p>
<p>The new attack does not extend to AES-192, but some of the attacks from the previous few months &#8212; still wildly infeasible &#8212; do.  Given that new results are still coming in fast and furious, I&#8217;m not willing to comment on AES-192 yet.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118153">

			<div class="comment by-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118153">
						July 30, 2009 1:52 PM					</a>

				</p>

				<p>Do you think its time to start the work on Threefish?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118154">

			<div class="comment by-daniel-franke ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://dfranke.us' rel='external nofollow ugc' class='url'>Daniel Franke</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118154">
						July 30, 2009 1:58 PM					</a>

				</p>

				<p>It already exists 🙂</p>
<p><a href="http://en.wikipedia.org/wiki/Threefish" rel="nofollow ugc">http://en.wikipedia.org/wiki/Threefish</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-118155">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118155">
						July 30, 2009 2:00 PM					</a>

				</p>

				<p>&#8220;Do you think its time to start the work on Threefish?&#8221;</p>
<p>As a second-round SHA-3 candidate, I would hope the work has already been started on Threefish.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118156">

			<div class="comment by-rm ">

				<p class="commentcredit">

					<span class="commenter">rm</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118156">
						July 30, 2009 2:00 PM					</a>

				</p>

				<p>Pretty sick stuff, best thing I&#8217;ve read in a while. Lot of lessons to be learned right here.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118157">

			<div class="comment by-rm ">

				<p class="commentcredit">

					<span class="commenter">rm</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118157">
						July 30, 2009 2:10 PM					</a>

				</p>

				<p>Got me thinking again, remembering your epic book &#8216;secrets and lies&#8217;. I know plenty of SSL cert providers that use AES256, because the number is &#8220;higher&#8221; than 128, so it must be &#8220;better&#8221;.</p>
<p>Gotta love security.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118158">

			<div class="comment by-erik ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.locolomo.org' rel='external nofollow ugc' class='url'>Erik</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118158">
						July 30, 2009 2:16 PM					</a>

				</p>

				<p>&#8220;At this point, I suggest AES-128 at 16 rounds, AES-192 at 20 rounds, and AES-256 at 28 rounds.&#8221;</p>
<p>A possibly &#8220;stupid&#8221; question from a non-cryptographer: Why do you need more rounds with longer keys? And how did you come up with these seemingly arbitrary numbers for more rounds?</p>
<p>BR, Erik</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118159">

			<div class="comment by-hal ">

				<p class="commentcredit">

					<span class="commenter">Hal</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118159">
						July 30, 2009 2:39 PM					</a>

				</p>

				<p>I like the idea of increasing AES rounds. Next year Intel is coming out with processors with AES acceleration, what they call AES-NI. This has a single instruction which implements an AES round. It makes AES so fast it is practically for free, the other processing typically dominates.</p>
<p>Increasing the number of AES rounds still allows using these instructions, you just put in a few more of them. AES would still be super fast on the new hardware.</p>
<p>Another option to consider would be to in effect double the number of rounds, by standardizing single-key double-AES. (That is, C = AES(K,AES(K,P)) to encrypt P to C.) This would allow the existing investment in AES hardware encryption infrastructure to be maintained. And you&#8217;d still get good speed with Intel AES-NI.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118160">

			<div class="comment by-peter-maxwell ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.allicient.co.uk/' rel='external nofollow ugc' class='url'>Peter Maxwell</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118160">
						July 30, 2009 2:41 PM					</a>

				</p>

				<p>Before the paper is published; is there any more information on the relationship between the number of related keys, number of rounds and attack complexity?</p>
<p>Is the attack an algebraic attack?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118161">

			<div class="comment by-vedaal ">

				<p class="commentcredit">

					<span class="commenter">vedaal</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118161">
						July 30, 2009 2:53 PM					</a>

				</p>

				<p>a little OT ;</p>
<p>as vulnerabilities keep being discovered in AES, and SHA,</p>
<p>can we have an update on Solitaire?</p>
<p>(even with the bias described by Paul Crowley, it still seems secure, but how much work would it take to break,<br />
relative to the attacks against AES)</p>
<p>also,<br />
was there ever a winner for the Cory Doctorow Crypto Wedding Ring contest?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118162">

			<div class="comment by-david-johnston ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.deadhat.com' rel='external nofollow ugc' class='url'>David Johnston</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118162">
						July 30, 2009 2:58 PM					</a>

				</p>

				<p>You can&#8217;t go round just adding rounds to the AES-128 specification. Its 10 rounds are baked into a lot hardware implementations in a lot of silicon products.</p>
<p>NIST could specify some new supa-dupa-AES-128, but it would have to be a new specification of a new algorithm. The existing algorithm simply can&#8217;t be changed in the millions of products using it.</p>
<p>I know of no hardware implementation that has a &#8216;more rounds&#8217; register. It would just create problems when you try to get it through FIPS.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-118163">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118163">
						July 30, 2009 3:05 PM					</a>

				</p>

				<p>&#8220;A possibly &#8216;stupid&#8217; question from a non-cryptographer: Why do you need more rounds with longer keys? And how did you come up with these seemingly arbitrary numbers for more rounds?&#8221;</p>
<p>Good questions, actually.  The meta-answer to both is: diffusion.  When block ciphers get broken, they&#8217;re invariably broken due to diffusion failures.  What more rounds give you is more diffusions.</p>
<p>AES-256 needs more rounds for two reasons.  One, the key is twice as long, so it takes more rounds to get complete diffusion of the key.  The AES-256 key schedule is particularly bad in this regard, so it takes a lot more rounds.  Fourteen rounds just isn&#8217;t enough.</p>
<p>And two, no one cares about attacks greater than brute force.  Since AES-256 is much harder to brute force, it needs to resist more complex attacks than AES-128.</p>
<p>As to your second question, choosing the number of rounds for a cipher is a combination of experience and guesswork.  The AES rounds of 10, 12, and 14 were arbitrary, but represented the designers&#8217; best guess as to what would be secure.  In my 2000 paper, I recommended increasing the number of rounds considerably, based on my best guess at the time.</p>
<p>The round recommendations I gave above &#8212; 16, 20, 28 &#8212; are designed to restore AES&#8217;s security cushion.  They&#8217;re off the top of my head, and certainly not the last word on the topic.  I&#8217;m sure this third paper isn&#8217;t the last word on these attacks &#8212; there&#8217;ll be further improvements in the coming months &#8212; and further discussion is required.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-118164">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118164">
						July 30, 2009 3:07 PM					</a>

				</p>

				<p>&#8220;You can&#8217;t go round just adding rounds to the AES-128 specification. Its 10 rounds are baked into a lot hardware implementations in a lot of silicon products.&#8221;</p>
<p>Agreed.  We would have to migrate the specification slowly and carefully.  But as hard as it would be to add rounds to AES, replacing AES with a whole new algorithm would be even harder.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-118165">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118165">
						July 30, 2009 3:09 PM					</a>

				</p>

				<p>&#8220;Another option to consider would be to in effect double the number of rounds, by standardizing single-key double-AES.&#8221;</p>
<p>This is a clever idea.  It halves the speed, but it&#8217;s much easier to standardize on.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118166">

			<div class="comment by-aes ">

				<p class="commentcredit">

					<span class="commenter">aes</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118166">
						July 30, 2009 3:18 PM					</a>

				</p>

				<blockquote>
<blockquote>
<blockquote>
<blockquote><p>
        &#8220;Another option to consider would be to in effect double the number of rounds, by standardizing single-key double-AES.&#8221;
      </p></blockquote>
</blockquote>
<p>    This is a clever idea. It halves the speed, but it&#8217;s much easier to standardize on.
  </p></blockquote>
</blockquote>
<p>But is it secure? Double-DES can be broken with a meet-in-the-middle attack. As for having triple-AES, I think thats way to slow.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-118167">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118167">
						July 30, 2009 3:20 PM					</a>

				</p>

				<p>&#8220;But is it secure? Double-DES can be broken with a meet-in-the-middle attack.&#8221;</p>
<p>Single-key double-AES.  The meet-in-the-middle attack breaks 2-key variants.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118168">

			<div class="comment by-bobby-g ">

				<p class="commentcredit">

					<span class="commenter">Bobby G.</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118168">
						July 30, 2009 3:48 PM					</a>

				</p>

				<p>I&#8217;m curious about what form these attacks generally take. They are way beyond my math ability but are they usually in the form of a mathematical proof? Or do they usually present an algorithm as to how to implement the attack? I would expect that they never actually demonstrate an attack as that would take a very long time even with significant CPU resources. Or am I wrong on that?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118169">

			<div class="comment by-hal ">

				<p class="commentcredit">

					<span class="commenter">Hal</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118169">
						July 30, 2009 3:51 PM					</a>

				</p>

				<p>The reason for double DES was to make the key longer. Regular DES has only a 56 bit key. Doubling it was aimed at giving 2*56 or 112 bit strength. Meet in the middle attacks defeat this goal, giving two-key double DES still only about 56 bit key strength.</p>
<p>Doubling AES would have a different goal: not to increase the key size, but to make the cipher stronger against cryptanalysis by in effect giving it more rounds. Meet in the middle wouldn&#8217;t apply.</p>
<p>However it occurs to me that vanilla double-AES, with the same key, is not the same as AES with twice as many rounds, because the key schedule would be different. You could approximate the effect of double-round AES by making the key for the 2nd AES instance be based on the final round key from the first instance. That would be hard though because hardware implementations won&#8217;t spit out that final round key.</p>
<p>Definitely need more thought on this one.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118170">

			<div class="comment by-brad-conte ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://bradconte.com' rel='external nofollow ugc' class='url'>Brad Conte</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118170">
						July 30, 2009 4:07 PM					</a>

				</p>

				<p>And they called me crazy when I chose AES-Twofish for my TrueCrypt partition.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118171">

			<div class="comment by-daniel ">

				<p class="commentcredit">

					<span class="commenter">Daniel</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118171">
						July 30, 2009 4:12 PM					</a>

				</p>

				<p>&#8220;Cryptography is all about safety margins. &#8221;</p>
<p>In the AES competition, some teams advocated using a security margin &#8211; something like: # of rounds divided by # of rounds of best attack &#8211; as a selection criterion, which probably would have favored e.g. Serpent over Rijndael. NIST didn&#8217;t follow that idea.</p>
<p>Bruce, with hindsight, and with SHA-3 coming up: Is the computed security margin a useful selection criteria?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118172">

			<div class="comment by-randall ">

				<p class="commentcredit">

					<span class="commenter">Randall</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118172">
						July 30, 2009 4:34 PM					</a>

				</p>

				<p>@Bruce: Since the attacks have been against the AES key schedule, perhaps we should be considering key schedule improvements instead of raw increases in the number of rounds.</p>
<p>The &#8220;W&#8221; cipher used by Whirlpool, for instance, uses the round function itself in the key schedule.  One of its authors was an AES designer, and it&#8217;s been published a while.</p>
<p>Just tweaking the key schedule preserves speed in applications that use a single key to encrypt lots of data, and it&#8217;s seemingly more insurance against future key-schedule attacks than an increase in the round count would be.</p>
<p>Maybe we should be asking NIST to take proposals for an AES-2, an incremental strengthening (but not total redesign) of AES?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118173">

			<div class="comment by-randall ">

				<p class="commentcredit">

					<span class="commenter">Randall</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118173">
						July 30, 2009 5:03 PM					</a>

				</p>

				<p>A baroque, but somewhat backwards-compatible option: munge the raw key so that an attacker has less control over what&#8217;s fed into the weak key schedule.  I&#8217;m talking about baking this into the definition of tweaked AES, not a protocol-level change.</p>
<p>The hash function could be AES-CTR, SHA-2/3 with reduced(?) rounds, or something special-purpose.  It just needs to be strong enough that attackers definitely can&#8217;t feed systematic differences into the AES key schedule, and needs to be fast and simple and easy to drop into all the environments that use AES now.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118174">

			<div class="comment by-mtgap ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mtgap.bilfo.com/blog' rel='external nofollow ugc' class='url'>MTGAP</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118174">
						July 30, 2009 5:14 PM					</a>

				</p>

				<p>The NSA uses 192- and 256-bit AES for top secret information, and yet 128 bits is more secure than 256. Hmm.</p>
<p>According to 2000 people (<a href="http://www.cryptosystem.net/aes/" rel="nofollow ugc">http://www.cryptosystem.net/aes/</a>), the NSA can already break AES. So maybe we should stop using it at all. 😛</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118175">

			<div class="comment by-mark ">

				<p class="commentcredit">

					<span class="commenter">Mark</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118175">
						July 30, 2009 5:31 PM					</a>

				</p>

				<p>@Chris: &#8220;DES was developed by the NSA internally and was not subject to much analysis prior to it being released.&#8221;</p>
<p>Actually, DES was designed by IBM as a modification to the Lucifer cipher. NSA reviewed it and suggested changes to the S-boxes and reducing the key size from 80 bits to 56 bits. So the NSA had a hand in the result, but it&#8217;s not an NSA design per se. (See <a href="http://en.wikipedia.org/wiki/Data_Encryption_Standard" rel="nofollow ugc">http://en.wikipedia.org/wiki/Data_Encryption_Standard</a>, e.g.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118176">

			<div class="comment by-al ">

				<p class="commentcredit">

					<span class="commenter">Al</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118176">
						July 30, 2009 6:25 PM					</a>

				</p>

				<p>It was gonna happen. It both scares me and makes me feel safer. On one hand, billions of people rely on it for protecting bank data, SSNs, DMV databases, etc.</p>
<p>On the other, it needs to be tested. We need people like this so we aren&#8217;t lured into a false sense of security. More out of paranoia than anything else, I use triple crypto (Truecrypt): AES,Serpent,Twofish. If I had complete discretion over software selection on a legal professional&#8217;s laptop, I&#8217;d push for this.</p>
<p>The system encryption will be only AES (for speed reasons). But all crypto containers within will be the triple.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118177">

			<div class="comment by-western-infidels ">

				<p class="commentcredit">

					<span class="commenter">Western Infidels</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118177">
						July 30, 2009 6:33 PM					</a>

				</p>

				<p>@Brad Conte: And they called me crazy when I chose AES-Twofish for my TrueCrypt partition.</p>
<p>Someone correct me if I&#8217;m wrong:</p>
<p>If I understand this right, because it&#8217;s a related-key attack, it&#8217;s not useful for attacking a single encrypted text like a TrueCrypt volume. To make the attack work, an attacker needs access to lots of pairs of plaintext and corresponding ciphertext encrypted with keys that are mathematically related to the target key.</p>
<p>With a TrueCrypt volume, the attacker would generally have access to the ciphertext only, and would have no obvious way of generating any related keys.</p>
<p>I think the main danger is for network systems, where lots of keys are generated automatically, and where it might be possible to harvest lots of plaintext/ciphertext pairs automatically.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118178">

			<div class="comment by-scott-contini ">

				<p class="commentcredit">

					<span class="commenter">Scott Contini</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118178">
						July 30, 2009 9:26 PM					</a>

				</p>

				<p>Maybe one could consider changes to AES-192 or AES-256 based upon the number of rounds or the key schedule, but those who are suggesting throwing out the whole algorithm are over-reacting.</p>
<p>I posted this on sci.crypt a few days ago and I think it is worth reposting here:</p>
<p>When Rijndael was chosen as the AES, there were three concerns that people voiced about the algorithm:</p>
<ol>
<li>The key schedule looks dangerous.  For example, see the paper &#8220;Improved<br />
Cryptanalysis of Rijndael&#8221; by Ferguson et al. or &#8220;Strengthening the Key Schedule of the AES&#8221; by L. May et al.</li>
<li>The number of rounds for 192- and 256-bit version of the cipher.  I remember Shamir saying at a conference that he was concerned about the number of rounds for more than 128-bit key size and he expects that in the future there will be a theoretical attack on AES-192 or AES-256 which will not threaten it in practice, but will cause bad publicity.  He suggest that AES-192 have 15 rounds<br />
and AES-256 to have 20 rounds (if I remember correctly).  Shamir&#8217;s prediction was 100% correct.</li>
<li>Algebraic attacks.  I think the first paper on this topic was &#8220;A Simple<br />
Algebraic Representation of Rijndael&#8221; by Ferguson et al, but then later came the papers by Courtois and Pieprzyk, and Murphy and Robshaw.</li>
</ol>
<p>It was decided not to change the original proposal.  But it turns out that changes according to #1 or #2 above would&#8217;ve been a good idea and perhaps would have resisted the present attacks.</p>
<p>(Both Ferguson et al papers had Schneier as one of the coauthors)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118179">

			<div class="comment by-scott-contini ">

				<p class="commentcredit">

					<span class="commenter">Scott Contini</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118179">
						July 30, 2009 10:01 PM					</a>

				</p>

				<p>I hear a lot of talk about &#8220;security margins&#8221;.  I just remind people that SHA-1 had a very large security margin until Wang et al finally figured out how to attack it, and then the design fell quickly.  In this case, the difficulty was figuring out how to analyse the darn thing, so the apparent security margin was giving a false sense of strength.  Security margins are great to have, but they cannot be solely relied upon.  Ideally we want a design that not only has a good security margin, but also has some other good reasons for trusting it.  For example, the nice provable resistance to differential and linear cryptanalysis that Rijndael offers is a very good reason (too bad that this design philosophy did not carry over to the key schedule).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118180">

			<div class="comment by-brad-conte ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://bradconte.com' rel='external nofollow ugc' class='url'>Brad Conte</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118180">
						July 30, 2009 11:02 PM					</a>

				</p>

				<p>@ Western Infidels</p>
<blockquote><p>
  If I understand this right, because it&#8217;s a related-key attack, it&#8217;s not useful for attacking a single encrypted text like a TrueCrypt volume. To make the attack work, an attacker needs access to lots of pairs of plaintext and corresponding ciphertext encrypted with keys that are mathematically related to the target key.
</p></blockquote>
<p>It is somewhat plausible. If TrueCrypt had a flaw in generating keys, I created multiple volumes with it in succession, and an attacker was able to get access the contents of a couple of the volumes (say I left the volumes mounted and left the room) it may apply.</p>
<p>But your point is valid, TrueCrypt volumes are not the subject of interest here. However, my intent was humor, not to proclaim superiority of layering AES and Twofish. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118181">

			<div class="comment by-david-wagner ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.cs.berkeley.edu/~daw/index.html' rel='external nofollow ugc' class='url'>David Wagner</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118181">
						July 31, 2009 12:37 AM					</a>

				</p>

				<p>I guess I don&#8217;t agree with the recommendation to increase the number of rounds in the AES.  The AES is still fine, as long as you use it properly.  These attacks only apply in a related-key threat model.  But for most applications of AES (e.g., for encryption), as long as you use AES properly, related-key attacks are not possible.  This does require designing your protocol to avoid introducing the opportunity for related-key attacks, but that is a solved problem these days.</p>
<p>If you want to put it in the terms of theoretical cryptography: as a pseudorandom permutation (PRP), AES is still perfectly fine.  Stick to protocols that only count on AES to be a PRP, and you&#8217;ll be fine.  If you&#8217;re using AES in some way so that the overall system&#8217;s security can only be justified by assuming that AES is a so-called &#8220;ideal cipher&#8221; (basically, the block cipher equivalent of the random oracle model), then yeah, you may be in trouble &#8212; but in my opinion, that was never all that great an idea anyway, given the earlier results on the AES key schedule.</p>
<p>About the only major usage of AES that&#8217;s likely to be affected (as far as I can see right now) is using AES in certain hashing modes of operation (e.g., Davies-Meyer.  But there&#8217;s probably not much need to use AES in that way in most systems, given the existence of dedicated hash functions that are designed for this purpose.</p>
<p>So, bottom line: great research, but I&#8217;m not convinced we need to change the standard.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118182">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118182">
						July 31, 2009 2:58 AM					</a>

				</p>

				<p>@ Bruce Schneier,</p>
<p>&#8220;Actually, the NSA approved AES for use up to &#8212; I think &#8212; SECRET, so they either didn&#8217;t know about the attack or didn&#8217;t care. Or wanted us all to think they couldn&#8217;t break it, and were willing to sacrifice their secrets to perpetuate that belief.&#8221;</p>
<p>On a historical note,</p>
<p>It is known that the US put into service a number of cipher systems that had issues to do with &#8220;week keys&#8221;.</p>
<p>In that part of the key space was very week and part of it strong and other parts in between.</p>
<p>There have been various sugestions as to why the most compeling was that the equipment would fall into enamy hands and either be used by them or copied and used. Thus the argument &#8220;We know the keys to avoide but they don&#8217;t&#8221;</p>
<p>It also became known that Crypto AG had &#8220;advice&#8221; from the NSA in the design of systems to go to other countries.</p>
<p>This sort of &#8220;reuse&#8221; mentality made it into capstone with the final system being moderatly strong but even minor changes significantly weekening it.</p>
<p>So as we would say in the UK &#8220;The&#8217;ve previous&#8221; when it comes to week key systems.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118183">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118183">
						July 31, 2009 3:33 AM					</a>

				</p>

				<p>Whils&#8217;t in historical mode a question raises it&#8217;s head again,</p>
<p>&#8220;WHEN is NIST going to wake up and smell the coffee?&#8221;</p>
<p>DES had a problem in that it was a &#8220;one size fits all&#8221; solution. It was known and recognised as a serious &#8220;engineering&#8221; issue long before DES by those involved with Gov Crypto. It quickly became clear when Crypto became part of more standard engineering.</p>
<p>NIST atleast paid lip service to the size issue in AES but it went about it the wrong way, which is why we have this and previous threads.</p>
<p>What was also know long before AES is that it&#8217;s not just an issue of &#8220;size&#8221; but also &#8220;style&#8221;.</p>
<p>That is some systems require only a modicum of security others a lot.</p>
<p>Likewise some systems have to be extrodinarily cheap others money is almost no object.</p>
<p>For instance transport payment cards and other low value payment cards need to be very cheap to be effective to roll out. They do not need to be secure for one hundred years.</p>
<p>Likewise &#8220;consumer&#8221; product design follows Charles Moore&#8217;s Law and designs are obsoleate within four years at most.</p>
<p>AES did almost nothing for low value payment cards which is one of the reasons such crap crypto was used in them and we get threads about how they are being broken.</p>
<p>Again this was a well known issue.</p>
<p>You just have to look at the battle between Sky and the card cloners etc to see this applied to &#8220;consumer grade crypto&#8221;.</p>
<p>NIST need to stop this &#8220;Champion of Champions&#8221; type competition which is arguably harmfull to industry and actuall get on with what they are supposed to do which is help not hinder.</p>
<p>I have said for a very long time that probably the most important thing NIST should do for industry is develop a &#8220;frame work&#8221; for Crypto and other security where &#8220;size&#8221;, &#8220;style&#8221; and &#8220;obsolecence&#8221; should be clearly recognised as major problems that are addressed.</p>
<p>Then they can get back to having &#8220;crypto competitions&#8221; for the different slots in the frame work that industry needs now and in the foreseable future.</p>
<p>And before people say &#8220;it&#8217;s not practical&#8221; i&#8217;ll tell you in advance &#8220;wake up and smell the coffee&#8221;</p>
<p>In Europe we have a darn sight more experiance of system inter operation than you do in the US which is one reason you have GSM phones that work as advertised, that also get features added as and when industry thinks they will generate revenue.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118184">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118184">
						July 31, 2009 4:15 AM					</a>

				</p>

				<p>@ Brad Conte,  Western Infidels,</p>
<p>&#8220;And they called me crazy when I chose AES-Twofish for my TrueCrypt partition.&#8221;</p>
<p>Hard drive encryption is a actually a very hard problem that has a great deal more to do with crypto modes than it does individual crypto types such as DES, AES, TwoFish etc.</p>
<p>For instance you have two compeating problems,</p>
<p>1, Access speed to blocks<br />
2, Attacks in depth.</p>
<p>Historicaly the solution to the first would be to use some kind of stream cipher with offset capability.</p>
<p>However the last place on earth you would have used a stream cipher is one where attacks in depth are possible.</p>
<p>Likewise historicaly the solution you would use for the second problem would be a block cipher in chaining mode.</p>
<p>But for fast access thats the last thing you would do on a hard drive or voume on it.</p>
<p>One possible solution would be to use a collection of modes like chaining on individual blocks with IV&#8217;s based on another mode such as CTR. But that in turn has it&#8217;s own issues.</p>
<p>So &#8220;Western Infidels&#8221; question,</p>
<p>&#8220;If I understand this right, because it&#8217;s a related-key attack, it&#8217;s not useful for attacking a single encrypted text like a TrueCrypt volume. To make the attack work, an attacker needs access to lots of pairs of plaintext and corresponding ciphertext encrypted with keys that are mathematically related to the target key.&#8221;</p>
<p>In a single encrypted container (especialy with snap shots) most of those conditions are likley to be true depending on what modes and how the HD encryption designer went about their task and what the business drivers where/are.</p>
<p>And remember as with WEP, the designers may be expert in their field of endevor but not that of crypto, as Apple apears to have recently demonstrated with their 3G S iPhone (like Bruce I want to see a lot more on that attack).</p>
<p>Which brings us around to &#8220;Western Infidels&#8221; diferentiation between networks and hard drives,</p>
<p>&#8220;I think the main danger is for network systems, where lots of keys are generated automatically, and where it might be possible to harvest lots of plaintext/ciphertext pairs automatically.&#8221;</p>
<p>This is also true of HD encryption on very large volumes such as storage arrays.</p>
<p>It is because of this and many many other issues that storage crypto is a very hard problem, probably more so than with &#8220;databases&#8221; which have on the face of it a subset of the problems of HD Crypto. But you should hear that little voice asking &#8220;hey arn&#8217;t they stored on HD&#8217;s&#8221; 😉</p>
<p>The point being that none of the issues or solutions to them can be considered in isolation and you drop into that delightful N^2/2 problem at the design stage&#8230;</p>
<p>As Brad noted,</p>
<p>&#8220;TrueCrypt volumes are not the subject of interest here.&#8221;</p>
<p>Nor is HD crypto in general, it&#8217;s a subject that would take up many threads, books etc (and already has done so).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118185">

			<div class="comment by-bf-skinner ">

				<p class="commentcredit">

					<span class="commenter">BF Skinner</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118185">
						July 31, 2009 5:31 AM					</a>

				</p>

				<p>@peleus &#8220;But didn&#8217;t we already assume the NSA had known about these attacks all along&#8221;</p>
<p>Where&#8217;s the NSA&#8217;s incentive to withhold findings? Did I hear wrong AES has been cleared for encryption to TOP SECRET? I knew about use at SECRET.</p>
<p>@Clive &#8220;Crypto AG had &#8220;advice&#8221; from the NSA &#8221;</p>
<p>Arguably true for AG and I&#8217;ve heard the story and it sounds right to me. But there&#8217;s a difference between crippling the cover other peoples communications and doin&#8217; it to yourself.  While NSA may have a mandate to read US mail going overseas (they won&#8217;t say) AES is the mandated standard for ALL gov&#8217;t encryption (presumedly outside of military comms). And if they&#8217;ve dilberately allowed US information that, if compromised, will cause exceptionally grave damage to the US to be protected by weak ciphers that&#8217;s beyond wheels within wheels. It&#8217;s likely criminal or treason.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118186">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118186">
						July 31, 2009 5:46 AM					</a>

				</p>

				<p>@ Bruce,</p>
<p>You can tell it&#8217;s a slow day waiting on the NHS&#8230;</p>
<p>With regard to your quick comment,</p>
<p>&#8220;Adding rounds is quick and easy, and requires very little thought.&#8221;</p>
<p>I&#8217;m going to sound picky but I have to disagree with the what you&#8217;ve said there.</p>
<p>It should be &#8220;requires very little resources&#8221;</p>
<p>As was shown with 2-DES to little &#8220;thought&#8221; gave rise to a new attack.</p>
<p>The real issue is crypto and it&#8217;s protocols are a very specialised field of endevor much like quantum physics in many ways.</p>
<p>The people who use the product of both of those fields are other scientists and engineers.</p>
<p>Scientists have depth (but rarely bredth) and engineers have bredth (and sometimes depth).</p>
<p>Ehgineers by and large treat the product of both Crypto and quantum as &#8220;off the shelf&#8221; building blocks.</p>
<p>That is as a &#8220;resource&#8221; which they take on spec as &#8220;doing what it says on the packet&#8221;.</p>
<p>Therfore any thought they give it is in most cases how to efficiently put it into whatever they are currently designing. They generaly don&#8217;t question it&#8217;s fundemental behaviour unless problems arise, or ascociated activity such as drawing up &#8220;user/test cases&#8221; focuses a strong light on it.</p>
<p>I know it&#8217;s wrong but at the end of the day you have only had 24Hours, of which &#8220;the man&#8221; pays you for eight, even though you&#8217;ve worked 12 just to meet the demands of &#8220;the man&#8221; and keep your job.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118187">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118187">
						July 31, 2009 6:10 AM					</a>

				</p>

				<p>&#8220;Cryptography is all about safety margins.&#8221;</p>
<p>Whilst true it hides a lot of thorny issues out of sight.</p>
<p>First of a deliberate (as opposed to accidental) margin implies that the designer knows that it is required.</p>
<p>And it follows from that they also have reason to belive they know &#8220;why&#8221;.</p>
<p>The first problem is the &#8220;why&#8221; is known attacks and probable attacks. Not unknown or not understood attacks.</p>
<p>The second problem is as Bruce has observed with hash&#8217;s in the past. Strengthening against one type of attack has a habit of weakening against other attacks.</p>
<p>That is there are &#8220;trade offs&#8221; not just with speed and efficiency but also aspects of the strength of a crypto algorithm.</p>
<p>It may be (although I can&#8217;t immediatly see a valid argument) that increasing the amount of perceived &#8220;diffusion&#8221; from increased rounds might have the opposit effect when the &#8220;diffusion&#8221; is examined in a different manner.</p>
<p>And the crypto designer needs to keep all this in mind when selecting which margins and by how much.</p>
<p>Which is equivalent to playing an unknown game  with unknown equipment on an unknown ground in the dark against an unknown opponent.</p>
<p>As the Chinese curse has it &#8220;may you live in interesting times&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118188">

			<div class="comment by-mark-r ">

				<p class="commentcredit">

					<span class="commenter">Mark R</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118188">
						July 31, 2009 6:29 AM					</a>

				</p>

				<p>Western Infidels said:</p>
<p>&#8220;I think the main danger is for network systems, where lots of keys are generated automatically, and where it might be possible to harvest lots of plaintext/ciphertext pairs automatically.&#8221;</p>
<p>Am I right in thinking a web server running SSL/TLS fits this description perfectly?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118189">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118189">
						July 31, 2009 7:03 AM					</a>

				</p>

				<p>@ BF Skinner,</p>
<p>&#8220;But there&#8217;s a difference between crippling the cover other peoples communications and doin&#8217; it to yourself.&#8221;</p>
<p>Ahhh, I did not make myself clear.</p>
<p>The joy about have a system with 20% of the key space being very strong and 20% being very weak is &#8220;if you know&#8221; you stick to the keys in the &#8220;very strong&#8221; group. You just design the system such that the 20% of the keyspace is going to cover your conceivable needs.</p>
<p>Your oposition however if they do not know will use keys from across the full keyspace in a random way. So sometimes they will use very strong keys but just as likley they will use as many very weak keys (1 in 5 messages).</p>
<p>The advantage for the NSA is not just in getting access to those 20% of messages under the very weak keys. It&#8217;s all the info in those messages that enable you to develop &#8220;signals knowledge&#8221; that will provide significant help in breaking the 60% of messages encrypted under the strong keys.</p>
<p>The important fact that you may not have been aware of (and I did not mention) is that all KeyMat used by the US Gov comes from the NSA either directly or indirectly through the systems they have developed. Thus this would ensure that the US Gov only ever used the very strong keys.</p>
<p>So no they would not be leaving themselves open to charges of treason.</p>
<p>As I also said the ill fated capstone system used a crypto design that as a number of observers have said is very brittle. That is when the individual components of the crypto algorithm are used the way the NSA has put them together then it is strong. But even very small aparently very minor changes weaken the result dramaticaly.</p>
<p>I find it hard to belive that the NSA arrived at such a design just by accident.</p>
<p>Also the LEAF &#8220;opps&#8221; smells like a red herring in the sun. No lack of respect to those who where responsable for putting it in but it was a bit to obvious. Which is why a &#8220;get around&#8221; was probably spotted so quickly. The advantage to the NSA is that it gives the majority a false sense of security and if used is not an impediment to their activities.</p>
<p>I suspect that when examined you will find there are also exploitable problems in the key space with very strong and weak keys in equal measure along with the bulk being strong.</p>
<p>In (open) practice There are only three practical ways currently to attack a crypto system that is in use,</p>
<p>1, key space attacks<br />
2, side channel attacks<br />
3, in depth attacks.</p>
<p>As the last is well known and for high level communicatons largly mitigated by various cipher modes. It is not a likley avenue of attack except in &#8220;consumer&#8221; grade communications and other &#8220;consumer&#8221; uses of crypto (see my comments about HD crypto).</p>
<p>The second is an implementation issue that although well known prio to AES was ignored during AES (loop unrolling / cache / etc). And as a result there are very practical attacks against &#8220;consumer grade&#8221; AES systems that are in use. Such attacks however are not likley to be of any use against Gov Level systems simply because it is so well known to them (EmSec/TEMPEST).</p>
<p>Which leaves the &#8220;key space attacks&#8221; as one of the areas the likes of the NSA and GCHQ are going to be playing in when it comes to second tier Governments and their crypto systems.</p>
<p>And as I noted &#8220;the NSA has previous&#8221; in this area although it is not widely known.</p>
<p>Now before you right me of as a &#8220;conspiracy nut&#8221; try putting yourself in the NSA&#8217;s shoes. They have two very conflicting primary purposes &#8220;protect US&#8221; comms &#8220;break non US&#8221; comms.</p>
<p>It has been known since long befor the NSA existed that your systems are &#8220;known to the oposition&#8221; and even in modern times people will pass across info to the oposition for purely &#8220;human&#8221; reasons.</p>
<p>Ask yourself the question &#8220;how do I do both tasks, knowing that my systems are known to the oposition&#8221;</p>
<p>Then think about how nicley &#8220;key space&#8221; attacks answer the problem&#8230;</p>
<p>Oh and if you can think of a better way feel free to give voice to it as the &#8220;open crypto&#8221; community will thank you for it. Not least because it will give them a new field of research 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118190">

			<div class="comment by-david ">

				<p class="commentcredit">

					<span class="commenter">David</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118190">
						July 31, 2009 8:23 AM					</a>

				</p>

				<p>I don&#8217;t understand Bruce&#8217;s comment about AES-256 being much harder to brute force than AES-128.</p>
<p>Brute-forcing a 128-bit key will require, on the average, roughly 4 x 10 ^ 36 tries.  If we assume that attacks are limited to ten billion years, that&#8217;s roughly 3 x 10 ^ 17 seconds to attack it in.  That means it&#8217;s necessary to try about 10 ^ 19 keys per second to get an average of one 128-bit key broken each ten billion years.  If a machine can try one key a nanosecond, that means we need ten billion machines, and we have to have means to power them after the Sun dies.  If we want to brute-force it in ten years, that&#8217;s ten billion billion machines.</p>
<p>I think that&#8217;s effectively impossible.  Saying that a 256-bit key is harder to brute-force is like saying that it&#8217;s harder to swim the Pacific than the Atlantic.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118191">

			<div class="comment by-sam-trenholme ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.samiam.org' rel='external nofollow ugc' class='url'>Sam Trenholme</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118191">
						July 31, 2009 9:45 AM					</a>

				</p>

				<p>Bruce,</p>
<p>I remember a few years ago you made a comment to the effect that &#8220;lower powered computers do not go away, but end up in other places&#8221;; for example, 8-bit processors end up in control systems for cars and what not.</p>
<p>Indeed, while modern computers by and large do have 64-bit processors, many Netbook CPUs do not have this support, nor do the ARM processors used by the majority of cell phones.  In addition, 64-bit software is still not very common, and there are  software support issues for people trying to use a 64-bit operating system; most Windows installations today are still 32-bit.</p>
<p>This in mind, I&#8217;m a little disappointed that more effort hasn&#8217;t been made to made a Bona Fide 32-bit version of Threefish/Skein.  The Skein paper points out this is possible.  From section 5.4:</p>
<p>&#8220;All versions of Skein are specified with 64-bit words. The word size can be seen as a tunable parameter; we can define a Skein variant with 32-bit words. This variant would run much faster on 32-bit CPUs, but significantly slower on 64-bit CPUs.&#8221;</p>
<p>One thing I would like to see is better support for legacy 32-bit processors.  This is the one reason I prefer Keccak over Skein, since their paper does describe how to make a 32-bit version of the hash.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118192">

			<div class="comment by-randall ">

				<p class="commentcredit">

					<span class="commenter">Randall</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118192">
						July 31, 2009 1:36 PM					</a>

				</p>

				<p>@Sam: You can get 20 cpb for Skein in 32-bit code today.  If it were parallelized, you could get a little over 10 cpb.  That&#8217;s because all 32-bit desktop processors (and even some ARM chips) have instructions that can do math on pairs of 64-bit numbers.</p>
<p>I think the Skein team made a reasonable decision.  Skein doesn&#8217;t have any real deal-breakers for low-end hardware &#8212; no 64-bit multiplications or 8&#215;64 S-boxes or such.  And using 64-bit additions is a big speed gain on NIST&#8217;s 64-bit reference platform.  Wish they&#8217;d default to the tree mode, but you can&#8217;t have everything.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118193">

			<div class="comment by-randall ">

				<p class="commentcredit">

					<span class="commenter">Randall</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118193">
						July 31, 2009 1:43 PM					</a>

				</p>

				<p>Er, I said &#8220;all 32-bit desktop processors&#8221; have those instructions, but I mean all reasonably recent x86 processors, both desktop and mobile (Intel Atom, etc.).  There might be a few embedded processors that don&#8217;t have it still.  The 64-bit instructions in SSE2 first appeared in the Pentium 4 in 2001.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118194">

			<div class="comment by-doubtful ">

				<p class="commentcredit">

					<span class="commenter">Doubtful</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118194">
						July 31, 2009 5:22 PM					</a>

				</p>

				<p>Here&#8217;s a thread on this on the TrueCrypt forum. A guy called &#8220;Hiu&#8221; over there is really laying into Bruce&#8217;s coverage of this topic. Since I&#8217;m not an expert, I would like to see some sort of debate between both camps. A non-expert really can&#8217;t get any sort of meaningful understanding if you have one side talking here and the other side on another forum.</p>
<p><a href="http://forums.truecrypt.org/viewtopic.php?t=16870" rel="nofollow ugc">http://forums.truecrypt.org/viewtopic.php?t=16870</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118195">

			<div class="comment by-bob-d ">

				<p class="commentcredit">

					<span class="commenter">bob d</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118195">
						July 31, 2009 6:41 PM					</a>

				</p>

				<p>Bruce,</p>
<p>$50 bucks and a bottle of 1989 La Tour says that in five years AES* will be cracked via algebraic attack 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118196">

			<div class="comment by-joe-c ">

				<p class="commentcredit">

					<span class="commenter">Joe C</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118196">
						July 31, 2009 7:14 PM					</a>

				</p>

				<p>Read an interesting comment about this on Slashdot.. thought I would copy paste it here. Bruce, I believe you sort of alluded to this in one of your BlackHat/DefCon talks in stating there is some reason to believe the NSA might have better means for calculating security margins in advance.</p>
<p>Quote:</p>
<p>&#8220;The best attack against DES breaks 15 out of 16 rounds faster than brute force. However for the full 16 rounds, the best attack against DES is brute force. Likewise, the best attack against SKIPJACK breaks 31 out of 32 rounds. In both cases NSA was fairly involved with the development of the algorithms and they just happen to have no &#8220;security margin&#8221;. Perhaps that means NSA was ignorant of the methods (such as impossible differential cryptanalysis) that the academic sector developed. Perhaps it means that NSA is willing to play fast and loose with securing government communications. Or maybe, just maybe, it means that NSA knows exactly how strong the algorithms are and doesn&#8217;t need to rely on ad-hoc measures like &#8220;security margins&#8221;. I don&#8217;t know, but the fact that AES-192/256 is specified for Top Secret while AES-128 is for Secret makes me suspect that NSA knows far more about the real security levels of AES than the keysize would indicate.&#8221;</p>
<p>Source: <a href="http://tech.slashdot.org/comments.pl?sid=1322099&#038;cid=28904549" rel="nofollow ugc">http://tech.slashdot.org/comments.pl?sid=1322099&#038;cid=28904549</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118197">

			<div class="comment by-iv ">

				<p class="commentcredit">

					<span class="commenter">iv</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118197">
						July 31, 2009 7:24 PM					</a>

				</p>

				<p>I&#8217;m interested in cryptography solely as an end-user / system implementor, not a designer, so the following post comes from that viewpoint.</p>
<p>For a long time (since before AES) whenever I needed crypto, I used Blowfish. After AES appeared I still used Blowfish out of inertia and have only recently started to use AES more than Blowfish.</p>
<p>What interests me is &#8211; how come Blowfish, at least according to <a href="http://en.wikipedia.org/wiki/Blowfish_%28cipher%29" rel="nofollow ugc">http://en.wikipedia.org/wiki/Blowfish_%28cipher%29</a> designed in 1993 appears to be more secure than AES today? I&#8217;ve read that its worse features are the complex (long) key schedule and the 64-bit block size but apparently the key schedule is a huge part of what keeps it safe, and just how bad using 64-bit block size really is in practice?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118198">

			<div class="comment by-doubtful ">

				<p class="commentcredit">

					<span class="commenter">Doubtful</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118198">
						July 31, 2009 7:55 PM					</a>

				</p>

				<p>@ bob d</p>
<p>I was going to post something in the same vain. However, I&#8217;m going to say the opposite. I&#8217;ll bet you the full 14 rounds are still secure (though not necessarily unbroken) in 20+ years.</p>
<p>Here&#8217;s my problem with all of this. This thread is unnecessarily alarmist. Bruce criticizes people all the time for the exact same type of thing he&#8217;s doing here. 11 rounds are broken (though still secure for now) using an impractical attack. 12, 13, and 14 rounds are still unbroken.</p>
<p>So, the way TrueCrypt implements AES still requires an exhaustive brute force attack to break it.</p>
<p>I&#8217;m usually a fan of this site, but full rounds AES is NOT broken.</p>
<p>However, knowing the people at TrueCrypt, they&#8217;ll probably relegate AES to legacy, even though there&#8217;s no reason to do so other than the alarmism.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118199">

			<div class="comment by-doug-coulter ">

				<p class="commentcredit">

					<span class="commenter">Doug Coulter</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118199">
						July 31, 2009 8:33 PM					</a>

				</p>

				<p>Unless the NSA has completely lost it since I worked with them and DOD back in the day, things like &#8220;this is good enough for secret, or top secret&#8221; isn&#8217;t how it&#8217;s done, and for good reasons that I can&#8217;t see have changed much.  This was awhile back, understand.</p>
<p>Some security needs to be long lived (perhaps forever) and some can tolerate short lifetime.  For example, communication among fighter pilots or tankers may only need to be a secret for a little longer than a mission, or a conflict at most, while some things need to stay secret &#8220;forever&#8221;.  In the cases I&#8217;m aware of, providing a super level of security for a moving platform just used too much computational power (at the time) to be practical, and it didn&#8217;t seem to matter if someone could reliably crack it in a few weeks anyway &#8212; they were vaporized by then.  And any information the adversary might have gotten was of purely academic or historical interest by that time.</p>
<p>On the other hand, some things, like methods, names of certain people in a network, and other things you&#8217;d hope would be secure against a concentrated attack on the cipher by anyone interested, and that the adversary might have the resources of a state.</p>
<p>So the metric used back then (70&#8217;s and 80&#8217;s) was more like &#8220;how long can this last against a concerted attack&#8221;, not in any way &#8220;how secret is the stuff we want protected&#8221;.  Operational security is certainly very important, but it doesn&#8217;t matter much after the operation is done, so can use a code that&#8217;s breakable, but that takes enough time to break so as not to matter to the operation.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118200">

			<div class="comment by-albert ">

				<p class="commentcredit">

					<span class="commenter">Albert</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118200">
						July 31, 2009 9:28 PM					</a>

				</p>

				<p>When I worked at RSA, back when the AES competition was going on; I talked to quite a few cryptographers and they all were fairly confident that Rijndael would win.  I was voting for Serpent.  But I had made a comment that because we weren&#8217;t as familiar with the Rijndael square structure as we were with say, a Feistel based structure, there might come a time within 8~10 years, we might be looking at TRIPLE-AES, as we did with Triple-DES.</p>
<p>I think with this new attack, the time has come&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118201">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118201">
						August 1, 2009 2:20 AM					</a>

				</p>

				<p>@ Doug Coulter,</p>
<p>&#8220;Unless the NSA has completely lost it since I worked with them and DOD back in the day, things like &#8220;this is good enough for secret, or top secret&#8221; isn&#8217;t how it&#8217;s done, and for good reasons that I can&#8217;t see have changed much.&#8221;</p>
<p>Nor has it changed in other places that I&#8217;m aware of (though like you it&#8217;s been a few years).</p>
<p>One security parameter that used to be an &#8220;accepted norm&#8221; was &#8220;if we can&#8217;t break it we don&#8217;t use it&#8221;. This was because  it&#8217;s &#8220;strength was unknown&#8221; and that was a major cause of concern for exactly the reasons you stated.</p>
<p>Oh and inconveniant as they have always been the NSA and others still print up OTP&#8217;s of various forms in large quantaties.</p>
<p>And other people have realised that OTP is still a good way to go. I recently saw a prototype of a USB device that was an OTP system.</p>
<p>The design is quite &#8220;cute&#8221; and I was surprised at how it had been designed a lot of thought went into it. It managed to be both conservative and inovative. The amount of keymat it holds is surprisingly large (and no it did not use flash memory for storing the pad) and would be more than sufficient for a very busy MS Office using person on a short trip.</p>
<p>The only issue with it being &#8220;realy cute&#8221; is the current EmSec (EMC style) protection but I don&#8217;t think that is going to be an impossible problem to solve 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118202">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118202">
						August 1, 2009 3:23 AM					</a>

				</p>

				<p>@ Doubtful,</p>
<p>&#8220;Here&#8217;s my problem with all of this. This thread is unnecessarily alarmist. Bruce criticizes people all the time for the exact same type of thing he&#8217;s doing here.&#8221;</p>
<p>Some of the posts may be but I don&#8217;t think Bruce is. In fact he may actually be being conserative.</p>
<p>You need to be mindfull of who the intended audience Bruce is adressing on this particular thread. It is not the ordinary blog readers but those who take a much more indepth view.</p>
<p>As with any sufficiently complex subject it has a language of it&#8217;s own where words and phrases have speciffic meanings that are different from their more normal lose everyday meanings. And that is going to always be a bit of a problem on an open blog, especialy one that encorages non experts and experts to participate on an equal basis.</p>
<p>What is concerning Bruce and what he is talking about is the speed the (known) effective security of AES is dropping.</p>
<p>In essence he has updated a line on a graph in his head with the latest results and seen that it crosses the axis a lot sooner than it did before. And this is significant not of it&#8217;s self but as an indicator of what might be to come (have a look at the history of FEAL for why).</p>
<p>Whilst currently of no &#8220;joe public&#8221; practical concern it may become one soon if a new class of attack comes out of the work. But it is of concern to those &#8220;in the field of endevor&#8221; as it effects new designs currently in progress.</p>
<p>So you need to view it against an individuals needs.</p>
<p>Now some people have little need of security margins their data or aplication has a short life of a couple of years.</p>
<p>Other people have need of much longer protection on their data say 25years (the length of a mortgage for instance).</p>
<p>And some have need for 999years (the length of some land leases).</p>
<p>And of course there will be some for which the time to the &#8220;end of the universe&#8221; is a little to short.</p>
<p>As Bruce has made clear in the past those practicing in the crypto field have different views on what is and is not broken to Joe Public.</p>
<p>If you look back you will see that the definition is one where an attack is less than &#8220;brute force&#8221;.</p>
<p>It&#8217;s a nice simple definition but is time scale independent and there is the problem for most people.</p>
<p>Now other things being equal the time for a &#8220;brute force&#8221; attack doubles with each aditional bit in key length. Therefore a &#8220;break&#8221; against a 256bit system compared to a 128bit system is going to be 2^128 (3.4E+38) times as hard and take that many times as long.</p>
<p>However not all things are equall sometimes different attacks can be refined or combined quite quickly then the difference in key size to work may actually be linear not exponential, that is a 256bit size only being 2^7 (128) times stronger.</p>
<p>Then there is Moore&#8217;s law and a whole host of other things to take into account befor a &#8220;real time line&#8221; figure can be reached that &#8220;joe public&#8221; will have a conceptual feel for.</p>
<p>Bruce is being cautious and saying AES appears to be sucumbing to new attacks faster than was originaly thought by the designers.</p>
<p>Which is of concern to those designing new crypto primatives (ie Hashes at the moment) around AES or the AES structures.</p>
<p>He has not said that Joe Public needs to worry about using AES for what it was designed for.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118203">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118203">
						August 1, 2009 4:00 AM					</a>

				</p>

				<p>@ Doubtful,</p>
<p>&#8220;A guy called &#8220;Hiu&#8221; over there is really laying into Bruce&#8217;s coverage of this topic.&#8221;</p>
<p>I had a quick look over there at &#8220;hiu&#8217;s&#8221; comments and it appears that he and Bruce are comming at the issue from different angles.</p>
<p>Bruce is sayint that &#8220;due to problems in the key schedualing in 256bit AES the number of rounds should be increased or people should stick with 128Bit AES that has a different/better key schedualing.</p>
<p>Hiu appears to think Bruce is arguing just about a weakness in the rounds&#8230;</p>
<p>So Hiu is arguing against what he thinks Bruce has said, NOT something that Bruce has actually said.</p>
<p>Hmm based on that discrepancy of view point you would have an argument that would be both pointless and potentialy endless.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118204">

			<div class="comment by-roger ">

				<p class="commentcredit">

					<span class="commenter">Roger</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118204">
						August 1, 2009 6:40 AM					</a>

				</p>

				<p>I was going to say something very similar to Doug&#8217;s remark. It might explain why the NSA would approve AES-192 and AES-256 for TOP SECRET, even though AES-256 appears to be weaker than AES-128 against certain classes of attack. (The alternative explanation, of course, is that they didn&#8217;t know of these attacks.)</p>
<p>If a brute force attack on a 128 bit key is the best you can do, then for the time being that cipher is totally unbreakable. For that matter, so is a 96 bit key.</p>
<p>However at some point in the distant future advances in computational technology (e.g. quantum computing, which effectively halves the length of a symmetric key) may make that cipher vulnerable to key searches. Thus if a message must remain secure for many decades to come, it would seem prudent to use a key length that is at least double what you might otherwise think is suitable.</p>
<p>There are other attacks, which may be faster than a brute force search. Even if they are not currently practicable, we might wonder if this could be an issue for messages that must remain secure for a very long time. The answer is no, they are probably not a problem. Pretty well all such attacks require extremely large amounts of CT / PT pairs with special properties, related keys, or some other kind of interaction with the system. Only very weak ciphers are vulnerable to better-than-brute-force attacks that require only a small number of CTs, no PT, and 1 key. So if you currently practice good habits with your key management, then these sorts of attacks will probably never become a threat, even if they become computationally feasible, because the attacker cannot reach back into the past and get you to encrypt some chosen PTs for him.</p>
<p>Thus for short term secrets, we may be concerned with smarter attacks, but the attacker only gets to use current computational power. All 3 versions of AES seem to be OK in that regard. For long term secrets, the attacker gets to use fabulous, scarcely imaginable  computational power, but it is unlikely he can launch any attack more efficient than QC brute force. AES-192 and AES-256 are ok in that regard, AES-128 is not.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118205">

			<div class="comment by-roger ">

				<p class="commentcredit">

					<span class="commenter">Roger</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118205">
						August 1, 2009 8:00 AM					</a>

				</p>

				<p>@Doubtful:</p>
<blockquote><p>
  Here&#8217;s a thread on this on the TrueCrypt forum. A guy called &#8220;Hiu&#8221; over there is really laying into Bruce&#8217;s coverage of this topic. Since I&#8217;m not an expert, I would like to see some sort of debate between both camps.
</p></blockquote>
<p>So would I, but I can&#8217;t register to post there without giving a paid email address &#8212; FTS.</p>
<p>Anyway, pretty well everything hiu says is either exaggerated, misleading, misinformed, or misrepresents what Bruce has said. Not to mention just plain rude. Examples:<br />
1. hiu wrote: &#8220;Schneier should follow his advice and stop writing those sensationalistic FUD-creating articles. &#8221;</p>
<p>After Bruce wrote such sensationalistic stuff as &#8220;The attacks &#8230; are not practical&#8221; and &#8220;There are three reasons not to panic&#8221;</p>
<ol>
<li>hiu wrote: &#8220;- There are currently no attacks on the full AES-128 or the full AES-256 (faster than brute force).&#8221;</li>
</ol>
<p>This is false, and I hope hiu is not involved with TrueCrypt development if he is happy to throw around such strong opinions without staying abreast of the research. In fact, the related key attack on AES-256 which was published by Biryukov and Khovratovich last month does break the <em>FULL</em> AES-256 faster than brute force &#8212; in fact, even faster than brute force on AES-128.</p>
<p>This attack is actually explicitly referred to in the main blog posting above, leading us to the inevitable conclusion that hiu doesn&#8217;t bother to actually read things before venting his spleen.</p>
<p>You may wonder why we care about a new attack on a reduced round version when there is an existing attack on a full version? Quite simply, the new attack gets through nearly all the rounds whilst shaving a mere 2^49 off the work factor. If &#8212; and this is pure speculation &#8212; the last three rounds could be pushed out at the same exponential growth rate as the first 11, we might see a full round attack with complexity 2^89. Or, 1 billion times faster in just one month. Ouch.</p>
<ol>
<li>hiu wrote: &#8220;Because since the very beginning, 9 out of 10 rounds of AES128 are broken. That&#8217;s right.&#8221; and when challenged for a source, replied:<br />
&#8220;The paper was written by the Twofish team including Schneier in the year 2000. See page 5:<br />
<a href="http://csrc.nist.gov/archive/aes/round2/comments/20000515-bschneier.pdf" rel="nofollow ugc">http://csrc.nist.gov/archive/aes/round2/comments/20000515-bschneier.pdf</a> &#8221;<br />
In fact, page 5 of this paper makes no such claim! Rijndael (it wasn&#8217;t yet called AES) is actually not even mentioned on that page!</li>
</ol>
<p>Possibly hiu means page 4, where a table notes a safety factor of 1.11 for Rijndael. However hiu seems to think &#8212; without reading the original paper to which this refers &#8212; that this means Rijndael-128. If he had more carefully read the text reading up to it on page 3, or, heavens forbid, read the actual paper it cites (a paper co-authored by Bruce and available on this very website) he would have realised that the attack is actually against 9 rounds of Rijndael-256. Now known as AES-256. The very cipher currently being criticised. And thus, if he actually understood his own reference, actually blowing the ground out from under his own feet.</p>
<p>I could go on, but life is short, and there are plenty more like hiu on the internets &#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118206">

			<div class="comment by-confusedone ">

				<p class="commentcredit">

					<span class="commenter">ConfusedOne</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118206">
						August 1, 2009 8:41 AM					</a>

				</p>

				<p>Am I missing something? Why is single-key double AES more secure than double-key double AES?</p>
<p>The Meet-In-The-Middle attack is even easier with the same key, is it not? The original attack needs to store all the results from encrypting a plain text with all keys and then comparing it to the decryption with all keys. This storage is quite unlikely to be feasible with 256 key bits, so I would think the Meet-In-The-Middle attack is infeasible for double-key double-AES.</p>
<p>However, if you know that the key is the same for both steps, you do not need to store all the intermediate (&#8216;middle&#8217;) results: you can try every key, encrypting plain and decrypting crypted text, and directly compare: if the result is equal, you have found the correct key, with only O(1) space instead of O(2^n), and the same amount of time: 2 times more than single AES.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118207">

			<div class="comment by-sherwood-botsford ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://sherwoods-forests.com' rel='external nofollow ugc' class='url'>Sherwood Botsford</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118207">
						August 1, 2009 9:04 AM					</a>

				</p>

				<p>It behoves the makers of software to make the crypt units modular.</p>
<p>Suppose that tomorrow someone comes up with a scheme that breaks all forms of AES in time short enough to be useful.</p>
<p>Every AES dependent system in the world is no longer secure.</p>
<p>It is unlikely however that all the crypt systems will be broken simultaneously.</p>
<p>Suppose that at any given time a software package that uses cryptography has 3-6 different modules.  If AES breaks, then either you, your software vendor, or the other end of the secure connection marks AES as broken, and your software uses two-fish instead.  When two-fish breaks, you use red-fish, then blue-fish.</p>
<p>In economics you diversify your portfolio.  You don&#8217;t want to have all your money in Exxon when the Valdez hits the rocks.</p>
<p>In ecology, population dynamics are more stable with increasing numbers of species.  In the arctic when the lemming population crashes so does the owl population.  In Alberta when the rabbits come down with tularaemia and crash, the coyotes eat more mice.  (And lamb&#8230;)</p>
<p>The Irish potato famine was caused in part by using the same variety everywhere.  The spuds were genetically identical.  Now when they are planting willow in high density as biofuel, they recommend using at least 5 different unrelated strains:  A pest that affects one strain badly can take out only 20% of the supply.</p>
<p>Vancouver planted one variety of cherry tree as a street tree.  Block after block was planted with this tree.  When they got some fungus it spread like wildfire.  Now they don&#8217;t plant more than 2 blocks of a given variety, then leave a buffer.</p>
<p>One of the virtues of multiple computer operating systems is increased resilience.  The attack that breaks windows doesn&#8217;t subvert my linux box.  The root kit that subverts my linux box doesn&#8217;t work on my wife&#8217;s Mac.  The exploit for BIND 9 doesn&#8217;t work on djndns or maradns.</p>
<p>So too in cryptography:  You want multiple ciphers in place and ready to use.  When the great Next Best Think crypto contest concludes, I hope that NIST recommends that 5 be accepted as standards &#8212; and that they mandate a framework for modularity so they can be dropped in place and verified.</p>
<hr />
<p>The other concept is the use of dummy payloads.  Consider the following:</p>
<p>I want to keep a secret from the NSA.  My source and my destination exchange messages constantly, all encrypted.  Most of the plaintext is the output of /dev/random or other noise generator.   Firstly, this makes it tricky to tell if you have successfully decrypted the message.  Secondly, as long as encryption is faster than cracking, you can waste far more of their time than yours.  Thirdly, if typical crack systems work on the first N blocks of the message to try to determine if it is interesting, then having real message with a Y block preamble of /dev/random means either that they have to up the ante and pick a new N &gt; Y, or they will miss real messages.</p>
<p>Dummy payloads can help defeat traffic analysis too.  E.g. if you can access some of the machines using an onion router, and can determine a high level of correlation in  activity on machines A and B, then you know a link.  On the other hand if the network is set up to exchange dummy payloads whenever traffic permits, or to generate spikes in traffic between arbitrary pairs of units, then traffic analysis becomes less useful unless you can tell real packets from dummy packets.</p>
<hr />
<p>The use of honeypot transactions can help in a security audit.  Example:</p>
<p>As a large bank, I ask employees to install package X on their home computer.  X exchanges transactions with the bank computer, but does so using fictitious accounts.  The bank computer watches for attempts to access these accounts.  All attempts to access account Fictitious 121 should come from X121.   Successful attempts to access an account from elsewhere shows that the system is broken.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118208">

			<div class="comment by-brucefan ">

				<p class="commentcredit">

					<span class="commenter">Brucefan</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118208">
						August 1, 2009 10:34 AM					</a>

				</p>

				<p>For Bruce Schneier, SHA-1 is merely a compression algorithm.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118209">

			<div class="comment by-pierce-wetter ">

				<p class="commentcredit">

					<span class="commenter">Pierce Wetter</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118209">
						August 1, 2009 11:10 AM					</a>

				</p>

				<p>If key scheduling is the issue and the attack only works with related keys, what if you just SHA-256 the original key first? That would make it very very hard to create related keys.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118210">

			<div class="comment by-doubtful ">

				<p class="commentcredit">

					<span class="commenter">Doubtful</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118210">
						August 1, 2009 3:43 PM					</a>

				</p>

				<p>@Roger</p>
<blockquote><p>
  This is false, and I hope hiu is not involved with TrueCrypt development if he is happy to throw around such strong opinions without staying abreast of the research. In fact, the related key attack on AES-256 which was published by Biryukov and Khovratovich last month does break the <em>FULL</em> AES-256 faster than brute force &#8212; in fact, even faster than brute force on AES-128.
</p></blockquote>
<p>Doesn&#8217;t this only apply when AES is used as a hash? I don&#8217;t think this applies to the way it is used in real life (e.g. TrueCrypt, PGP), so I think hiu is actually correct.</p>
<p>Also, I don&#8217;t believe this attack applies to real-life usage. My understanding is that even if TrueCrypt used 11 round AES (instead of the 14 they use), this attack wouldn&#8217;t apply. So, I have to ask the question, is 11 round AES actually broken if no one uses AES in a way that would be susceptible to this attack?</p>
<p>So, my question is, how do you actually define broken? Shouldn&#8217;t it apply to real-world usage and not require data that you can&#8217;t actually obtain in real life?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118211">

			<div class="comment by-doubtful ">

				<p class="commentcredit">

					<span class="commenter">Doubtful</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118211">
						August 1, 2009 4:06 PM					</a>

				</p>

				<p>Let me clarify what I said above. This is my understanding (a non-expert perspective):</p>
<p>The way TrueCrypt uses 14 round AES still requires an exhaustive brute force attack, thus it is not broken. I believe that neither of the attacks that came out in the last month apply to the way TrueCrypt and other OTFE software uses AES-256.</p>
<p>If TrueCrypt were to use 11 round AES but keep all other implementation the same, I believe it would still require an exhaustive brute force attack, thus it is not broken for this application. My understanding of this new attack is that it requires information that cannot be obtained in real life.</p>
<p>If the above is correct, then is 11 round AES actually broken?</p>
<p>Thanks</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118212">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118212">
						August 1, 2009 5:05 PM					</a>

				</p>

				<p>@ Pierce Wetter,</p>
<p>&#8220;If key scheduling is the issue and the attack only works with related keys, what if you just SHA-256 the original key first? That would make it very very hard to create related keys.&#8221;</p>
<p>The simple answer is yes.</p>
<p>This is the basis of a number of a number of &#8220;generator&#8221; modes for block ciphers.</p>
<p>Perhaps the simplest to understand is CTR mode where you have a simple binary counter at the input and you encrypt under a randomly selected key.</p>
<p>Other modes involve feeding back the output to the input and encrypting.</p>
<p>Some modes have issues with certain types of ciphers. If I remember correctly DES in feedback mode does not work to well for all sizes (you&#8217;d need to look them up).</p>
<p>And this is the rub with simple answers to simple questions they tend to be general and not specific and some specifics have exceptions whilst others not or different&#8230; 8(</p>
<p>It is one of the reasons that engineers (and I include myself in this) need to be wary of what they are doing with cipher blocks, because a system they design might meet the test cases they can think up while badly failing other tests known to a domain expert (sadly there are not enough of those to go around, and it really is a case of what not who you know).</p>
<p>It is interesting to note that some scientists from related fields when watching or being involved with an impromptu crypto discussion have indicated that it felt like a blood sport (it&#8217;s not but then neither do they take prisoners 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118213">

			<div class="comment by-witek-baryluk ">

				<p class="commentcredit">

					<span class="commenter">Witek Baryluk</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118213">
						August 1, 2009 6:11 PM					</a>

				</p>

				<p>I always was thinking that high speed hardware solutions uses round pipelining, where number of rounds doesn&#8217;t really hurts performance in any way (it only increses number of gates lineary, because loop over round are unrolled). The enc/dec bandwidth is the same (only latency and power consumption increses).</p>
<p>But software implementations and very constrained hardware implementation (like smartcards, where every gate matters), will have problem (but on the other hand, increasing number of runds here is simpler).</p>
<p>So considering this, why anybody will choice small number of rounds. Why they just didn&#8217;t choicen number 32 for all of them, just for safty? Specialized hardware implementations will still be fast due to pipelining, for smartcards it doesn&#8217;t really metter, they are processing just few packets per second, mayby software implementation will be 2 times slower only. This puts NIST and NSA in bad light again.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118214">

			<div class="comment by-roger ">

				<p class="commentcredit">

					<span class="commenter">Roger</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118214">
						August 1, 2009 6:36 PM					</a>

				</p>

				<p>@Doubtful:</p>
<blockquote><p>
  Doesn&#8217;t this only apply when AES is used as a hash?
</p></blockquote>
<p>Absolutely not; it is a related key attack, same as this one. It is a key recovery attack on the block cipher itself. There are two ways you might be getting confused here. Firstly, the attack uses the &#8220;correcting disturbance&#8221; method, which was originally invented for attacks on hash functions. However here that basic method has been ingeniously modified for use as an attack on a cipher.</p>
<p>Secondly, related key attacks are often too casually dismissed as being impractical, since they can be prevented by a good key management system. However the area where they become devastating is in certain constructions for turning the cipher into a hash. In that case, related key attacks on the underlying cipher have <em>in practice</em> been used to find collisions on the hash (e.g.: see cracking of Microsoft&#8217;s X-box.)</p>
<p>That does not mean, however, that the attack will &#8220;only apply when &#8230; used as a hash&#8221;. Use as a hash is simply a mode in which the attacker can easily obtain the related key conditions he wants, and the defender can do nothing to prevent it. However if your key management is not good enough, the attack <em>may</em> still be applicable in other circumstances.</p>
<blockquote><p>
  I don&#8217;t think this applies to the way it is used in real life (e.g. TrueCrypt, PGP),
</p></blockquote>
<p>You should be very careful about saying &#8220;the way it is used in real life (e.g. TrueCrypt, PGP)&#8221; AES is now one of the most widely deployed ciphers in the world, used in thousands of products. We have no idea how many of these might or might not be vulnerable to related key attacks. Most of these have been implemented by generalist software engineers (or in some cases, hardware engineers) who have only a basic understanding of cryptography. When a cipher is certified by the crypto community, they expect to treat it as a magic black box that takes two inputs and spits out security. In fact in some cases it may be incorporated into standards that obligate the implementers to treat it that way! So when you start adding caveats like &#8220;oh, XXX version cannot be used where YYY applies&#8221;, you have a problem.</p>
<p>In particular, hardware devices often have room to fit only one cryptographic primitive, so it gets reused for many things. There are certain block cipher hash constructions for which a key size that is double the block size, is just perfect. Thus if I were a betting man I would wager that there are applications out there using AES-256 as a hash.</p>
<blockquote><p>
  so I think hiu is actually correct.
</p></blockquote>
<p>hiu didn&#8217;t write &#8220;attacks that apply only in this particular application&#8221;, he wrote &#8220;- There are currently <em>NO</em> attacks on the full AES-128 or the full AES-256 (faster than brute force).&#8221; (emphasis added.) This is not correct. Such an attack is known, and was widely publicised in the relevant community just 1 month ago. hiu&#8217;s statement is a load of baloney, and since it was so easy for him to know better, it indicates that he shoots his mouth off (or his keyboard, actually) about things he has not researched very carefully.</p>
<blockquote><p>
  Also, I don&#8217;t believe this attack applies to real-life usage.
</p></blockquote>
<p>Ta-da! You&#8217;re absolutely correct. But I have to point out, that is exactly what everyone else has been saying too: the attacks are not currently practical.</p>
<p>The problem here is that there are no attacks at all that are currently practical against any AES variant, including AES-128. Let me emphasise this: AES-128 is not just ok-ish security for the little guy whose secrets don&#8217;t really matter; AES-128 is a formidably powerful cipher, suitable for protecting national secrets against immensely capable opponents who are prepared to spend billions of dollars attacking it. So what the heck is AES-256 for if AES-128 is practically unbreakable? Well, AES-256 is for two things:</p>
<p>a) chumps who say &#8220;ooh, it has a bigger key, I must use that!&#8221;<br />
If option a. applies to you, go right ahead and keep using AES-256; no problems will ensue (so long as you use good key management, and don&#8217;t use it in a hash!)</p>
<p>b) ultra-high security applications that are concerned about the attack capabilities of advanced national intelligence agencies many decades in the future, using computing technology we could barely dream of today.<br />
But if option b. applies, you have a problem. You don&#8217;t know how powerful your hypothetical future enemies will be, so you chose a stupendously, ridiculously enormous extra margin of safety. In now turns out that in certain circumstances, under attack by hypothetical super-powerful future enemies, you don&#8217;t get any extra safety at all. You would actually have been better off with AES-128. That&#8217;s a problem. It begins to look as if you really have to have a good handle on exactly what attack model you are resisting before it would be sensible to choose AES-256 over AES-128.</p>
<blockquote><p>
  The way TrueCrypt uses 14 round AES still requires an exhaustive brute force attack, thus it is not broken. I believe that neither of the attacks that came out in the last month apply to the way TrueCrypt and other OTFE software uses AES-256.
</p></blockquote>
<p>The attack against 11 rounds of AES-256 which Bruce announced above (but hasn&#8217;t been published yet), and the attack against all 14 rounds published last month, are both related key attacks. If TrueCrypt is not vulnerable to related key attacks, then it is ok. I have seen the bulk encryption modes of TrueCrypt, and they seem to be immune to related key attacks. I haven&#8217;t looked in detail at all the fiddly little extra bits; someone who thoroughly understands the concept will need to go over them all in detail to ensure that they are OK, but I expect they probably are.</p>
<p>I absolutely could <em>not</em> assert that this is true for all OTFE software.</p>
<blockquote><p>
  If TrueCrypt were to use 11 round AES but keep all other implementation the same, I believe it would still require an exhaustive brute force attack, thus it is not broken for this application.
</p></blockquote>
<p>That is probably correct, but an exhaustive code audit by experts would be required before you could guarantee it.</p>
<blockquote><p>
  My understanding of this new attack is that it requires information that cannot be obtained in real life.
</p></blockquote>
<p>This is <em>probably</em> true for the specific case of TrueCrypt. There are almost certainly implementations for which it is <em>not</em> true.</p>
<blockquote><p>
  If the above is correct, then is 11 round AES actually broken?
</p></blockquote>
<p>Absolutely. If there were people using AES-256 with 11 rounds &#8212; and there isn&#8217;t, so we are here talking about pure hypotheticals &#8212; then it is likely that some of those implementations would be vulnerable to related key attacks. The attack against the 11 round version is probably already computationally feasible for some opponents and in less than decade it will be feasible for distributed community efforts like distributed.net. In this hypothetical parallel world in which people have deployed 11 round AES-256 applications, we would be sounding klaxons, starting code audits, issuing work-arounds, and generally recommending that everyone <em>immediately</em> switch to AES-128.</p>
<p>Back in the real world where 11 round AES-256 is a purely academic construct, the real reason we are worried about it is that it indicates work on AES-256 is progressing so rapidly that people are beginning to worry about non-academic, practical breaks emerging much sooner than the c. 10 year window it takes to revise, implement and deploy new standards.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118215">

			<div class="comment by-doubtful ">

				<p class="commentcredit">

					<span class="commenter">Doubtful</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118215">
						August 1, 2009 6:44 PM					</a>

				</p>

				<p>At the risk of overposting, can anyone tell me how a related-key can apply in real life to the world of block ciphers?</p>
<p>Throw hashes out, as AES was not designed to be a hash, but a block cipher. Will a related-key attack ever be applicable to the real world? Because every other forum I&#8217;ve been to has dismissed these attacks as mostly irrelevant.</p>
<p>Does the related-key attack require some faulty implementation in the software?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118216">

			<div class="comment by-doubtful ">

				<p class="commentcredit">

					<span class="commenter">Doubtful</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118216">
						August 1, 2009 6:48 PM					</a>

				</p>

				<p>Sorry, I wrote the above post before reading Roger&#8217;s post. It wasn&#8217;t meant to be an insult.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118217">

			<div class="comment by-doubtful ">

				<p class="commentcredit">

					<span class="commenter">Doubtful</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118217">
						August 1, 2009 7:09 PM					</a>

				</p>

				<p>@Roger</p>
<blockquote><p>
  Absolutely. If there were people using AES-256 with 11 rounds &#8212; and there isn&#8217;t, so we are here talking about pure hypotheticals &#8212; then it is likely that some of those implementations would be vulnerable to related key attacks. The attack against the 11 round version is probably already computationally feasible for some opponents and in less than decade it will be feasible for distributed community efforts like distributed.net. In this hypothetical parallel world in which people have deployed 11 round AES-256 applications, we would be sounding klaxons, starting code audits, issuing work-arounds, and generally recommending that everyone <em>immediately</em> switch to AES-128.
</p></blockquote>
<p>In this parallel world, wouldn&#8217;t it be just as easy to verify that your software is immune to related-key attacks? You&#8217;ve already stated that if AES-256 is implemented properly, as is probably the case with TrueCrypt, then the software can be immune to related-key attacks. Are you saying that it&#8217;s such a daunting task to do this that switching to AES-128 would be preferable.</p>
<p>And if AES-128 were preferable to AES-256, couldn&#8217;t we just use Twofish or Serpent? It seems to me these two would be preferable to AES-128 because of their 256 bit key and because they&#8217;ve both received a good amount of scrutiny (although not as much as AES).</p>
<blockquote><p>
  Back in the real world where 11 round AES-256 is a purely academic construct, the real reason we are worried about it is that it indicates work on AES-256 is progressing so rapidly that people are beginning to worry about non-academic, practical breaks emerging much sooner than the c. 10 year window it takes to revise, implement and deploy new standards.
</p></blockquote>
<p>Are you sure that the worry is due to fast progress? It could be entirely coincidental that there was a release of two papers within one month of each other with related-key attacks, the latter being much better than the former. It&#8217;s entirely possible that we could go for years without a better attack. It&#8217;s been more than a decade since Rijndael was released for public review. It&#8217;s entirely possible this recent flurry of activity is coincidental. I think the timing of these two attacks could be as big a factor as anything else.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118218">

			<div class="comment by-brucefan ">

				<p class="commentcredit">

					<span class="commenter">Brucefan</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118218">
						August 1, 2009 10:44 PM					</a>

				</p>

				<p>Hiu is a fool for sure, look what nonsense he stated in that truecrypt forum:</p>
<blockquote><p>
  A single round of AES256 is as strong as a single round of AES128.
</p></blockquote>
<p>I guess he doesn&#8217;t understand key diffusion.</p>
<p>Makes me not want to ever consider Truecrypt if it has such an ignoramus working on it&#8217;s code.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118219">

			<div class="comment by-doubtful ">

				<p class="commentcredit">

					<span class="commenter">Doubtful</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118219">
						August 1, 2009 11:07 PM					</a>

				</p>

				<p>@Brucefan</p>
<blockquote><p>
  Makes me not want to ever consider Truecrypt if it has such an ignoramus working on it&#8217;s code.
</p></blockquote>
<p>I don&#8217;t think he&#8217;s involved with TrueCrypt. He&#8217;s just a member (with a bit of a mean streak), as far as I can tell. I agree that the way he talks to people leaves something to be desired. That style is okay if you&#8217;re never wrong. But you&#8217;re leaving yourself open for a major thumping if you even make a small mistake.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-118220">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118220">
						August 2, 2009 1:50 AM					</a>

				</p>

				<p>&#8220;Since the attacks have been against the AES key schedule, perhaps we should be considering key schedule improvements instead of raw increases in the number of rounds.&#8221;</p>
<p>Increasing rounds is quick and easy.  Any more complicated change will require actual cryptanalysis, and will take much much longer.  If we&#8217;re going through that much work, we might as well take advantage of another decade of cryptographic research and choose a new algorithm altogether.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-118221">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118221">
						August 2, 2009 1:51 AM					</a>

				</p>

				<p>&#8220;If I understand this right, because it&#8217;s a related-key attack, it&#8217;s not useful for attacking a single encrypted text like a TrueCrypt volume.&#8221;</p>
<p>Correct.  That and the attack doesn&#8217;t work against full 14-round AES-256, or against AES-128 at all.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-118222">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118222">
						August 2, 2009 1:53 AM					</a>

				</p>

				<p>&#8220;Saying that a 256-bit key is harder to brute-force is like saying that it&#8217;s harder to swim the Pacific than the Atlantic.&#8221;</p>
<p>Agreed, but cryptographers compare completely impractical attacks all the time.  (There is a school of thought that agrees with you, though.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-118223">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118223">
						August 2, 2009 2:01 AM					</a>

				</p>

				<p>&#8220;Here&#8217;s a thread on this on the TrueCrypt forum. A guy called &#8220;Hiu&#8221; over there is really laying into Bruce&#8217;s coverage of this topic.&#8221;</p>
<p>He seems to be misrepresenting a lot of what I wrote above.  I tried to write the post to prevent panic, not foment it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-118224">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118224">
						August 2, 2009 2:03 AM					</a>

				</p>

				<p>&#8220;This thread is unnecessarily alarmist. Bruce criticizes people all the time for the exact same type of thing he&#8217;s doing here. 11 rounds are broken (though still secure for now) using an impractical attack. 12, 13, and 14 rounds are still unbroken.&#8221;</p>
<p>I sure hope it&#8217;s not.  I&#8217;m not trying to be alarmist.</p>
<p>We cryptographers like to change things slowly and deliberately, before there is cause for alarm.  It&#8217;s much better that way.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-118225">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118225">
						August 2, 2009 2:05 AM					</a>

				</p>

				<p>&#8220;I guess I don&#8217;t agree with the recommendation to increase the number of rounds in the AES. The AES is still fine, as long as you use it properly. These attacks only apply in a related-key threat model. But for most applications of AES (e.g., for encryption), as long as you use AES properly, related-key attacks are not possible. This does require designing your protocol to avoid introducing the opportunity for related-key attacks, but that is a solved problem these days.&#8221;</p>
<p>I agree with your analysis, but think that a simple change is prudent.  Think of it as analogous to the change from SHA to SHA-1: a quick change made in response to a potential future weakness.  It was better to make that change before it was required.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118226">

			<div class="comment by-aes ">

				<p class="commentcredit">

					<span class="commenter">aes</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118226">
						August 2, 2009 3:04 AM					</a>

				</p>

				<blockquote>
<blockquote><p>
    Think of it as analogous to the change from SHA to SHA-1: a quick change made in response to a potential future weakness.
  </p></blockquote>
</blockquote>
<p>The change from SHA-0 to SHA-1 was quick, but it required a radical intervention into the algorithm&#8217;s structure itself, not just increasing the nr. of rounds. The exact thing you are arguing against in your previos comments.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-118227">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118227">
						August 2, 2009 9:14 AM					</a>

				</p>

				<p>&#8220;The change from SHA-0 to SHA-1 was quick, but it required a radical intervention into the algorithm&#8217;s structure itself, not just increasing the nr. of rounds. The exact thing you are arguing against in your previos comments.&#8221;</p>
<p>Exactly.  This is much, much easier than even that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-118228">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118228">
						August 2, 2009 9:16 AM					</a>

				</p>

				<p>&#8220;Are you sure that the worry is due to fast progress? It could be entirely coincidental that there was a release of two papers within one month of each other with related-key attacks, the latter being much better than the former. It&#8217;s entirely possible that we could go for years without a better attack. It&#8217;s been more than a decade since Rijndael was released for public review. It&#8217;s entirely possible this recent flurry of activity is coincidental. I think the timing of these two attacks could be as big a factor as anything else.&#8221;</p>
<p>Well, it&#8217;s the same team &#8212; basically &#8212; behind the three papers, so it&#8217;s not a coincidence.  What we&#8217;re seeing is a new vector of attack being exploited.  I don&#8217;t think we&#8217;ve reached the end of the potential for this new attack vector.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-118229">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118229">
						August 2, 2009 9:20 AM					</a>

				</p>

				<p>&#8220;And if AES-128 were preferable to AES-256, couldn&#8217;t we just use Twofish or Serpent? It seems to me these two would be preferable to AES-128&#8230;.&#8221;</p>
<p>There is a lot of benefit to having and using a single standard.  I don&#8217;t think we should abandon AES in favor of other algorithms.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118230">

			<div class="comment by-buherator ">

				<p class="commentcredit">

					<span class="commenter">buherator</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118230">
						August 2, 2009 10:45 AM					</a>

				</p>

				<p>Thanks for the post, it was really informative!</p>
<p>Do you think that this could possibly affect 802.11i (WPA2) systems in the future?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118231">

			<div class="comment by-doubtful ">

				<p class="commentcredit">

					<span class="commenter">Doubtful</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118231">
						August 2, 2009 11:36 AM					</a>

				</p>

				<p>@Bruce Schneier</p>
<blockquote><p>
  There is a lot of benefit to having and using a single standard. I don&#8217;t think we should abandon AES in favor of other algorithms.
</p></blockquote>
<p>I know people a lot better than I know cryptography, and I think it&#8217;s going to be a very tough sell to get people to adopt AES-128. This is going to seem like a downgrade to a lot of people, even if they don&#8217;t really understand the science behind it. If the decision is based on consumer demand at all, I would be surprised to see anywhere near a universal adoption of this. I don&#8217;t speak for the TrueCrypt developers, but I have a hard time believing that they will offer AES-128 as a single cipher (i.e. not as part of a cascade). They may decide to drop AES-256 (or not- I have no idea) and only provide it as legacy. But, if they do that, my guess is they would simply stick with Twofish and Serpent.</p>
<p>The reason I say this is because the people on the TrueCrypt forums who have some knowledge of cryptography (but not an expert knowledge) are going to see that they were using 256 bit keys before. A 128 bit key will be unacceptable to a lot of these people.</p>
<p>Also, I  wish that everyone wasn&#8217;t talking on different forums, taking entirely different perspectives. A debate would really help people like me understand this better. Since I&#8217;m not an expert, I&#8217;ll post something that Justin Troutman (a cryptography expert) said at Wilders Security:</p>
<blockquote><p>
  These related-key attacks, in a nutshell, assume that an adversary has access to different plaintexts encrypted under different, related, keys, which can be ruled out, if you do things right. From the way it looks now, the attacks would apply if the AES was used as a hash function, in Davies-Meyer mode, for example, which is essentially the construct on which MD5, SHA-1, SHA-2. However, we don&#8217;t need to use the AES this way, because we have dedicated hash functions already that meet security requirements of which the AES was never intended.
</p></blockquote>
<p>We use the AES for purposes like message encryption and message authentication, where modes, such as CTR (i.e., encryption for confidentiality) and CMAC (i.e., authentication for integrity) assume the AES to be a PRP; this is still just fine. On the other hand, if we expect the AES to behave like an ideal block cipher, as might be assumed in Davies-Meyer mode, then we might have a problem. So, TrueCrypt and PGP aren&#8217;t susceptible. Furthermore, I can&#8217;t think of any application that is.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118232">

			<div class="comment by-aes ">

				<p class="commentcredit">

					<span class="commenter">aes</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118232">
						August 2, 2009 12:48 PM					</a>

				</p>

				<blockquote>
<blockquote><p>
    Exactly. This is much, much easier than even that.
  </p></blockquote>
</blockquote>
<p>No, no, I mean when you argued, that changing the key schedule was to radical:<br />
&#8220;Fixing the 256-bit key schedule would be nice, but that&#8217;s a more complicated change.&#8221;</p>
<p>If NSA dared to change the structure of SHA-0, why shouldn&#8217;t we change the key schedule of AES-192 and AES-256?<br />
If NSA just increased the nr. of rounds(no adding of shifts), SHA-1 would have probably been much weaker than it is now. If I remember correctly Biham and Chen showed in 2004 that SHA-0 with larger nr. of rounds is weaker than with default, 80 rounds.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118233">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118233">
						August 2, 2009 2:45 PM					</a>

				</p>

				<p>@ Bruce,</p>
<p>One of the problems so far is that most of the issues and answers have been in sound bites and in ways that &#8220;Joe Public&#8221; is unfamiliar with and also in a disconnected fashion.</p>
<p>So If you could do a quick FAQ type Q&amp;A for &#8220;Joe Public&#8221; it might take a lot of the wind out of the arguments etc.</p>
<p>As I see it the following &#8220;Joe Public&#8221; questions have been or will be asked but due to various reasons the answers have not been given or are not getting through clearly.</p>
<p>So my attempt at Qs and some As is,</p>
<p>The No.1 question for &#8220;Joe Public&#8221; is,</p>
<p>&#8220;Is it broken?&#8221;</p>
<p>With broken being in the &#8220;normal practical human&#8221; meaning not the more specialized meaning used by cryptographers.</p>
<p>The answer from your comments is a little long, but in essense is,</p>
<p>1.A) Because this attack is based on the part of AES256 that expands the key for use and that in AES256 it is significantly different to AES128, AES128 is as far as is currently known, completely unaffected by this attack.</p>
<p>1.B) Further that AES256 is not broken in the normal sense either, because this attack only partially extends previous attacks and there is still a reasonable margin of safety to be yet used up.</p>
<p>Which leads onto question No.2 by &#8220;Joe Public&#8221;,</p>
<p>&#8220;how soon before it will be broken?&#8221;</p>
<p>The answer to which is,</p>
<p>2.A) For most uses of AES256 this attack currently will not lead to a break.</p>
<p>2.B) Nor is it likely to in the near future except for some specialized use of AES. And that is very dependent on if the attack can be extended to all the current rounds (doubtful) and then only with selected texts under related keys.</p>
<p>Which leads onto Joe Public question No.3,</p>
<p>&#8220;How many selected texts and how are the keys related?&#8221;</p>
<p>This is the question(s) that have so far not been answered in a way that Joe Public can easily comprehend. So can the answer(s) be put in a way that can?</p>
<p>3.) ???</p>
<p>Joe Public has noticed that various people have said that the &#8220;related keys&#8221; problem has been solved, but no further information has been forth coming. So Joe Public question No.4,</p>
<p>&#8220;what are the methods that stop related keys being used?&#8221;</p>
<p>4.) ???</p>
<p>And question No.5,</p>
<p>&#8220;On the assumption that the attack can be extended to all the rounds will the attack be actually practical to use in the normal sense of the word?&#8221;</p>
<p>5.) ???</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118234">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118234">
						August 2, 2009 6:25 PM					</a>

				</p>

				<p>Well, we use a program that uses three different encryption methods with three different passphrases for each, encrypting each encrypted block again with the next method. I am not an expert on encryption, but it seemed to be a good idea to multi encrypt our data this way. Thanks to this discussion, I changed the methods from 2Fish/AES/RC6 to 2Fish/AES/Serpent.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118235">

			<div class="comment by-bw ">

				<p class="commentcredit">

					<span class="commenter">BW</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118235">
						August 3, 2009 4:45 AM					</a>

				</p>

				<p>Maybe the NSA wanted to read the rest of the governments documents; it was adopted, after all, post-9/11 during the Bush years. If the NSA can get Bush to approved warrantless wiretaps, don&#8217;t you think they could get him to allow a broken encryption alg to be used as long as it let us read everyone else&#8217;s stuff? The logic is so screwed up that it just might have happened.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118236">

			<div class="comment by-nathan-russell ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://en.wikipedia.org/wiki/User:Pakaran' rel='external nofollow ugc' class='url'>Nathan Russell</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118236">
						August 3, 2009 3:29 PM					</a>

				</p>

				<p>Bruce, does it still make sense to use AES-256 because of concerns about Grover&#8217;s Algorithm?  Or is that far too theoretical and long-term to be a concern?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-118237">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118237">
						August 3, 2009 5:43 PM					</a>

				</p>

				<p>The paper is public.</p>
<p><a href="http://eprint.iacr.org/2009/374" rel="nofollow ugc">http://eprint.iacr.org/2009/374</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-118238">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118238">
						August 3, 2009 5:44 PM					</a>

				</p>

				<p>&#8220;If NSA dared to change the structure of SHA-0, why shouldn&#8217;t we change the key schedule of AES-192 and AES-256?&#8221;</p>
<p>Presumably the NSA had a large internal review process before they made that change.  For us out in the academic and public world, such a review process would be hard.  It&#8217;s easier &#8212; and just as effective &#8212; to increase the number of rounds.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118239">

			<div class="comment by-matthew ">

				<p class="commentcredit">

					<span class="commenter">Matthew</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118239">
						August 13, 2009 9:14 AM					</a>

				</p>

				<p>Will the use of CBC reduce the effectiveness of these attacks?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118241">

			<div class="comment by-uri ">

				<p class="commentcredit">

					<span class="commenter">Uri</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118241">
						August 17, 2009 11:28 AM					</a>

				</p>

				<p>The problem with AES is caused by its cryptographically weak key schedule. IMHO the correct (though at this time impractical) solution is to employ a key schedule algorithm that obfuscates relationship between the bits of the round subkeys.</p>
<p>This has been discussed back in the 1990-ties &#8211; see Key Schedule on Wiki.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118242">

			<div class="comment by-uri ">

				<p class="commentcredit">

					<span class="commenter">Uri</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118242">
						August 17, 2009 11:37 AM					</a>

				</p>

				<p>Wanted to add &#8211; cihper designers face a dilemma: good key agility vs. elaborate but secure key schedule. Invariably they choose the faster and simpler key schedule over a slower but more secure alternative.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118243">

			<div class="comment by-justin-wells ">

				<p class="commentcredit">

					<span class="commenter">Justin Wells</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118243">
						August 21, 2009 11:42 AM					</a>

				</p>

				<p>Doesn&#8217;t the NSA recommend that AES be used in GCM mode? I am not an expert so someone else needs to clarify, but isn&#8217;t GCM one of those modes that uses AES only as a random generator, and so not susceptible to this attack?</p>
<p>I guess the big question is, for those of us who liked what we thought was the margin of safety provided by AES256 over AES128, that is now apparently gone, how do we get our margin of safety back?</p>
<p>Up thread someone suggested that doing a SHA256 hash on the key before using it with AES would resolve the problem. Is that true?</p>
<p>If I stick with AES256 in GCM mode and I SHA256 the key before passing it to the cipher, am I safe from this attack?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118244">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">dave</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118244">
						October 11, 2009 3:15 AM					</a>

				</p>

				<p>In other words, AES256 is still good for disk encryption using a single key (such as TrueCrypt) , and AES128 is better for a stream cipher such as implemented in OpenSSH.<br />
&#8220;Will the use of CBC reduce the effectiveness of these attacks?&#8221; In OpenSSH using CBC is a bad idea.[ google : openssh cbc exploit]  CTR (Counter Mode) is the preferred mode for OpenSSH, I don&#8217;t know if it is for other applications, and i know CBC without the use of ESSIV in disk encryption is vulnerable to attacks such as watermarking.<br />
So the best mode for OpenSSH is : Ciphers aes128-ctr ; MACs hmac-ripemd-160 (since SHA1 is broken, and your other options are MD5 and even &#8220;more broken&#8221; algorithms.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118245">

			<div class="comment by-max-sala ">

				<p class="commentcredit">

					<span class="commenter">Max Sala</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118245">
						October 19, 2009 1:43 AM					</a>

				</p>

				<p>@John at August 2, 2009 6:25 PM<br />
&#8220;Well, we use a program that uses three different encryption methods with three different passphrases for each, encrypting each encrypted block again with the next method. I am not an expert on encryption, but it seemed to be a good idea to multi encrypt our data this way. Thanks to this discussion, I changed the methods from 2Fish/AES/RC6 to 2Fish/AES/Serpent.&#8221;</p>
<p>Serpent is very similar to AES, in fact they&#8217;re<br />
both translation-based ciphers with my<br />
restricted definition [1]. If AES is going down the sink, Serpent (and Present) will likely follow. However, I don&#8217;t think AES is under any threat by a practical attack, not now and not in a near future.</p>
<p>Max<br />
[1]-&gt; arXiv:0806.4135 (to appear in AAECC)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118247">

			<div class="comment by-cw ">

				<p class="commentcredit">

					<span class="commenter">CW</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118247">
						January 5, 2010 7:52 AM					</a>

				</p>

				<p>Unfortunately, additional rounds requires additional round keys, and there is a limit on the number of round keys that can be expanded from the seed key based on the number of round constant dimensions in the spec.</p>
<p>If you try to expand the number of round to those suggested the spec breaks because there are not enough round constants to do so.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118248">

			<div class="comment by-cw ">

				<p class="commentcredit">

					<span class="commenter">CW</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118248">
						January 5, 2010 7:38 PM					</a>

				</p>

				<p>max rounds for AES based on key expansion method and round constants seems to be the integer of</p>
<p>((KeySizeInBits/128)  * 11) &#8211; 1</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118249">

			<div class="comment by-mike ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.never_give_this_out.com' rel='external nofollow ugc' class='url'>Mike</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118249">
						February 24, 2010 1:43 PM					</a>

				</p>

				<p>The issue here is time and compute power.  This places the breakdown of the key in the hands of private parties with a reasonable amount of computational horsepower &#8211; no longer the domain of perhaps only governments.  This is a bigger problem than suggested and it cannot be ignored.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118250">

			<div class="comment by-sandy-harris ">

				<p class="commentcredit">

					<span class="commenter">Sandy Harris</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118250">
						April 17, 2010 6:43 AM					</a>

				</p>

				<p>This attack works against AES-256 but not AES-128, because as Bruce puts the AES-256 key schedule is &#8220;pretty lousy&#8221;.</p>
<p>So is this a solution, given a 256-bit key? Set up AES-128, run its key schedule with 128 of the key bits. Use the other 128 to initialise a counter. Encrypt that counter with the AES-128 to generate a set of round keys. Use those for the AES-256 encryption.</p>
<p>This might be too expensive, of course. Also, you end up with the round keys being related, but that&#8217;s true for any key schedule.</p>
<p>See <a href="http://eprint.iacr.org/2008/473" rel="nofollow ugc">http://eprint.iacr.org/2008/473</a> for another approach to deriving a stronger 256-bit cipher from AES-128.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118251">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118251">
						April 17, 2010 11:22 PM					</a>

				</p>

				<p>@ Sandy Harris,</p>
<p>&#8220;This might be too expensive, of course. Also, you end up with the round keys being related, but that&#8217;s true for any key schedule.&#8221;</p>
<p>Hmm related at what level&#8230;</p>
<p>Take a block cipher like TEA, AES or DES and throw the key expansion for the rounds away (it&#8217;s inefficient in DES and broken in AES256 anyway ;).</p>
<p>Replace it with stream cipher such as ARC, where you map part of the ARC Sarray into the block cipher where the expanded key would have gone in.</p>
<p>Then using a BBS generator to give you an additional value to add into updating the Jptr in the ARC update function.</p>
<p>I came about this odd arrangement in reverse back around 95 when looking for a way to improve on an existing design I&#8217;d done to generate many many keys using a True Random Number Generator (TRNG). The original idea used a card shuffling algorithm not that dissimilar to ARC4 to spread the entropy of the TRNG across a 1Kbyte state array. The ARC4 algorithm had been let out of the bag back in late 94 and as it had been &#8220;blessed&#8221; by various crypto experts I decided to use it. I modified it by adding the TRNG output as an additional offset to the J ptr. Part of the ARC4 state array was passed to a modified DES block cipher that had already been written such that the key expansion was done separately (and passed as a pointer to an array holding the expanded keys for the DES rounds). I modified the design again in late 98 to use the BBS generator instead of the TRNG to make a &#8220;software only version&#8221;.</p>
<p>As far as I could tell at the time the output from the ARC4+BBS generator passed all the standard tests.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118252">

			<div class="comment by-rana ">

				<p class="commentcredit">

					<span class="commenter">rana</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118252">
						June 9, 2010 2:30 PM					</a>

				</p>

				<p>can u give me function or formula to calculate time to break aes</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118253">

			<div class="comment by-frank ">

				<p class="commentcredit">

					<span class="commenter">Frank</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118253">
						July 8, 2010 4:21 PM					</a>

				</p>

				<p>Bruce,</p>
<p>Can you comment on this article? &#8212; <a href="http://eprint.iacr.org/2009/531" rel="nofollow ugc">http://eprint.iacr.org/2009/531</a></p>
<p>Or the better question is does it in any way change your opinion of using AES-128 over AES-256?</p>
<p>Please forgive me I am not in the cryptography field, just trying to make an informed decision on the best cipher to use.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118254">

			<div class="comment by-rob ">

				<p class="commentcredit">

					<span class="commenter">Rob</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118254">
						August 6, 2010 7:29 AM					</a>

				</p>

				<p>practical attacks vs non practical attacks, panic or not to panic.. o.k.Reality for you&#8230;</p>
<p>Your drivers license number expires in 8 years. Your credit card  number will change in 4 years. Your social security number will be usefull for we hope around 120 years.. being generous here..</p>
<p>So any data that I need to protect those kinds of items has to have a shelf life of those time frames.</p>
<p>There are very few that have need of much more than that.</p>
<p>even as far as the country goes theres few &#8220;secrets&#8221; that need to be protected for more than a single mans lifetime.</p>
<p>Now the other side of the equation.</p>
<p>this is the theoretical side..  where reputations are made.. where neither the data or the algorithm thats protecting the data is important.. The name of the guy who wrote the algo, or the attack is the important thing here&#8230;</p>
<p>this is where encryption must last longer than the established time line for the end of the solar system &#8230; Preferably galaxy&#8230;</p>
<p>so which is right? BOTH &#8230;&#8230;.</p>
<p>Just as practical science needs its theorists so we have the same issues here.</p>
<p>Just my thoughts..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118255">

			<div class="comment by-smu-johnson ">

				<p class="commentcredit">

					<span class="commenter">smu johnson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118255">
						August 11, 2010 2:00 AM					</a>

				</p>

				<p>@ Bruce Schneier at August 2, 2009 9:20 AM<br />
&#8220;There is a lot of benefit to having and using a single standard. I don&#8217;t think we should abandon AES in favor of other algorithms.&#8221;</p>
<p>This is a great debate right here.  I would very much like to hear the reasons why we should still stick with AES despite all this worry about it being cracked in the upcoming months / years.  I&#8217;m no expert, but it seems like a no-brainer for me to pick Serpent or Twofish over AES and 1) not have to worry about any of this lousy round implementation stuff and 2) check the &#8220;Is AES broken?&#8221; blog pages every month.  To me it seems that life is too short to stick with AES on this recommendation and continue to worry about a break coming around the corner.</p>
<p>On the other hand&#8230; it could be that picking a standard (like AES) is best because it will get more attention and flaws will likely be discovered sooner.  But by the same token, this seems like a good reason to use something else.  If the non-standardized AES finalist candidates draw less cryptoanalysis attention to them, and are already considered by experts to have more of a security margin, why not just use them instead?  It seems that my AES encrypted files won&#8217;t be secure anymore far sooner by sticking with this &#8220;use the standard&#8221; paradigm.</p>
<p>To me, it seems that if a &#8220;cipher break&#8221; time race took place, the AES might break before Twofish or Serpent ciphers would.  If that&#8217;s true, why the insistance on faithfully sticking with a standard?</p>
<p>I&#8217;m asking sincerely, as I am not an expert, and this very question has haunted me for the last month or two.</p>
<p>Thanks for reading, I hope to hear a reply.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118256">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118256">
						August 11, 2010 2:46 AM					</a>

				</p>

				<p>@ Smu Johnson,</p>
<p>&#8220;To me, it seems that if a &#8220;cipher break&#8221; time race took place, the AES might break before Twofish or Serpent ciphers would. If that&#8217;s true, why the insistance on faithfully sticking with a standard?&#8221;</p>
<p>I was once told,</p>
<p>There are two winners in every race, the one who came in first, and the one selling the tickets. And as we know there is always going to be some one who beats the guy who came in first next time or the time after, but the guy selling the tickets wins every time&#8230;</p>
<p>The simple fact is AES won the Pentathlon but has already been beaten in each individual discipline It&#8217;s an all rounder not the fastest sprinter etc. And history tells us at some point it will fail to be the best all rounder lose it&#8217;s title and eventualy retire.</p>
<p>This may be upsetting for some of the supporters but that&#8217;s the way life is.</p>
<p>But remember the second guy he does not care he&#8217;s going to keep on selling tickets as long as people want to buy them.</p>
<p>It is why I say the likes of NIST should move their game up from putting all their weight behind the winner and should &#8220;own the stadium&#8221;. Or put in place a standard framework with plug in modules.</p>
<p>Thus if AES is for whatever reason not suitable you can use an alternative just by using a different plug in.</p>
<p>Also more importantly if the AES plug in you are using is found to be deficient for some reason (as has happened with &#8220;timing attacks&#8221;) you can swap it out for one that does not.</p>
<p>The problem with software is the &#8220;built in&#8221; mentality in small and embedded systems such as &#8220;Utility Meters&#8221; they can have a lifetime of 25 years or more and are worth only a fraction of the cost of installing them.</p>
<p>Thus the security of the Utility Network depends on the weakest link, if an adversary can find the AES key because of an implementation fault in an old meter, the network is compramised at that point for as long as the implementation fault remains in use.</p>
<p>If however an appropriate standard for a framework is in place Utility Meter manufactures will work to the standard otherwise they significantly limit their market potential.</p>
<p>Thus getting a good framework is way more important than getting a good algorithm.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118257">

			<div class="comment by-pierre ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://gwan.ch/' rel='external nofollow ugc' class='url'>Pierre</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118257">
						November 6, 2010 8:08 AM					</a>

				</p>

				<p>&#8220;Cryptography is all about safety margins&#8221;</p>
<p>It explains why everybody is telling the (stupid) story about how to hide the forest with a couple of trees.</p>
<p>Cryptography should rather be about delivering Shannon&#8217;s &#8220;perfect security&#8221;.</p>
<p>I can&#8217;t believe that people who dedicated their whole life to the subject can&#8217;t see how the unicity principle translates into far more viable methods than the one-time pad.</p>
<p>If the world is in love with the concept of security by obscurity this can only be to happily practice shoulder-surfing.</p>
<p>This is just sad.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118258">

			<div class="comment by-get-your-facts-right ">

				<p class="commentcredit">

					<span class="commenter">get your facts right</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118258">
						November 7, 2010 8:59 PM					</a>

				</p>

				<p>&#8220;The Bureau of Information Resource Management&#8217;s Radio Programs Branch<br />
(IRM/OPS/ITI/LWS/RPB) provides all overseas missions two-way radios<br />
equipped with Digital Encryption Standard (DES) or Advance Encryption<br />
Standard (AES). These encryption algorithms provide limited protection<br />
from unauthorized interception of voice communications and are only<br />
approved for the transmission of Department of State Sensitive But<br />
Unclassified (SBU) and Department of Defense For Official Use Only (FOUO)<br />
communications. Under no circumstances should DES- or AES-equipped<br />
radios be used for the transmission of classified information, as defined by<br />
Executive Order 12958.&#8221;</p>
<p><a href="http://www.state.gov/documents/organization/89272.pdf" rel="nofollow ugc">http://www.state.gov/documents/organization/89272.pdf</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118259">

			<div class="comment by-alan-taylor ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.pgpboard.com/viewtopic.php?f=2&#038;t=206' rel='external nofollow ugc' class='url'>Alan Taylor</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118259">
						November 9, 2010 1:23 PM					</a>

				</p>

				<p>It is understood that the NSA has classified AES 256 for use with TOP SECRET traffic. This only applies to NSA prior approved applications, and cipher operating modes. The NSA will usually supply the approved cipher, and in the case of “enhanced” AES 256 this includes enhanced key schedules and management. The AES 256 enhanced algorithm supplied by the NSA is not available to the commercial sector.</p>
<p>The majority of US State Department equipment laptops, radios, satellite links etc. should have NSA approved embedded encryption technology. This technology is hardware based and not software based. This takes the form of NSA approved chipsets.</p>
<p>NSA approved chipsets are manufactured and supplied by NSA approved manufacturers and suppliers. One of the most prominent suppliers of NSA cipher chip sets is Harris RF Communications 1680 University Avenue, Rochester NY.</p>
<p>Harris Sierra II chip sets are supplied with NSA suite A, and suite B cipher algorithms. The Sierra II chipset can be embedded into a variety of communications equipment and terminals. (See attached PDF)</p>
<p>In addition Harris supply NSA approved SECNET wireless interface modules for travelling diplomats. The chipset can be programmed with additional NSA classified cipher algorithms depending upon usage/deployment and application.</p>
<p>The data over at Cryptome looks a little dated. I would suspect that the some of the equipment did not conform to NSA cryptographic requirements.</p>
<p>Concerning your comments about security of AES. I will not speculate on this. However, it is common knowledge that in terms of outright security the SERPENT 32 round block cipher was rated higher than AES during the selection process. However, AES prevailed as it was deemed faster, and more easily integrated into smart card applications.</p>
<p>Alan Taylor<br />
PGPBOARD Administrator<br />
London, England</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118260">

			<div class="comment by-david-oftedal ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://folk.uio.no/davidjo/' rel='external nofollow ugc' class='url'>David Oftedal</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118260">
						November 29, 2010 4:07 AM					</a>

				</p>

				<p>So this seems to be getting some attention:</p>
<p><a href="http://eprint.iacr.org/2010/594" rel="nofollow ugc">http://eprint.iacr.org/2010/594</a></p>
<p>&#8220;In this paper we analyze the case of AES and present an attack which is capable of recovering the full secret key in almost realtime for AES-128, requiring only a very limited number of observed encryptions. Unlike most other attacks, ours neither needs to know the ciphertext, nor does it need to know any information about the plaintext (such as its distribution, etc.). Moreover, for the first time we also show how the plaintext can be recovered without having access to the ciphertext. Further, our spy process can be run under an unprivileged user account.&#8221;</p>
<p>Time to go back to ROT-13?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118261">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118261">
						November 29, 2010 6:25 AM					</a>

				</p>

				<p>@ David Oftedal,</p>
<p>&#8220;In this paper we analyze the case of AES and present an attack which is capable of recovering the full secret key in almost realtime for AES-128&#8230;&#8221;</p>
<p>The fact that AES is susceptible to side channel Cache attacks have been known about since before it was certified (it&#8217;s why I prefered another European candidate).</p>
<p>This particular attack is good (very good in some. respects) and as Bruce has noted in the past attacks can only get better with time.</p>
<p>Speaking of &#8220;things noted in the past&#8221; I have been saying for quite some time now that the two big areas of attacks are going to be,</p>
<p>1, Side Channel attacks.<br />
2, Known plaintext attacks.</p>
<p>The only real solution to (1) side channel attacks is as has been known for over 60years &#8220;don&#8217;t use cipher systems online&#8221;</p>
<p>As the above statment has caused problems with readers on the blog in the past I will say that by &#8220;online&#8221; I mean a machine that is coupled in some way to an external monitorable point be it whilst using the cipher or (as could be done with the spy ware) at some later point in time such that any info obtained whilst &#8220;monitoring&#8221; the use of the cipher is leaked out.</p>
<p>Practicaly this means using two machines on fully issolated (ofline) that is only used to encipher/decipher and only the ciphertext files are copied to an &#8220;online&#8221; system for TX/RX.</p>
<p>As for (2) known plaintext attacks can be used with large volumes of &#8220;data at rest&#8221; such as encrypted hard drives where poor design allows either &#8220;attacks in depth&#8221; or the system is effectivly &#8220;ECB&#8221; or aproximating some other weak system like a stream cipher with key re-use.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118262">

			<div class="comment by-coyote ">

				<p class="commentcredit">

					<span class="commenter">Coyote</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118262">
						March 3, 2011 7:34 AM					</a>

				</p>

				<p>Thanks a lot for this paper, very interesting.<br />
Just a question now, what&#8217;s the stand of the attacks on AES nowadays? Still the same as 2009? Do you still recommand the use of AES 128?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118263">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">john</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118263">
						August 4, 2011 1:27 AM					</a>

				</p>

				<p>I would like to know which is the best security algorithm without the attacks among TWOFISH and AES,then also whether blowfish can be used to analyze among those results</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118264">

			<div class="comment by-andy ">

				<p class="commentcredit">

					<span class="commenter">Andy</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118264">
						August 4, 2011 2:57 AM					</a>

				</p>

				<p>an = angle</p>
<p>buf[0+an] = a[0]<br />
buf[4+an] = t[0]<br />
buf[1+an] = a[1]<br />
buf[5+an] = t[1]<br />
&#8230;16<br />
buf[0+an] = a[0]<br />
buf[4+an] = t[0]<br />
buf[1+an] = a[1]<br />
buf[5+an] = t[1]<br />
&#8230;32<br />
buf[0+an] = a[0]<br />
buf[4+an] = t[0]<br />
buf[1+an] = a[1]<br />
buf[5+an] = t[1]<br />
&#8230;64<br />
buf[0+an] = a[0]<br />
buf[4+an] = t[0]<br />
buf[1+an] = a[1]<br />
buf[5+an] = t[1]<br />
&#8230;128&#8230;up say 4 bil, max limit</p>
<p>[0][1][2][3][4][5]<br />
[0]   [1]   [2]<br />
1&amp;1 = 0<br />
0&amp;1 = 1,</p>
<p>link,nonlink</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118265">

			<div class="comment by-andy ">

				<p class="commentcredit">

					<span class="commenter">Andy</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118265">
						August 4, 2011 3:02 AM					</a>

				</p>

				<p>Tun foil hat stuff, can also predict the future . you don&#8217;t need to know the value of the vars, just how many vars there are, and do a bruteforce run, if you change one of the values say from zero to one(monday), if it rained on monday that vars is the value of monday&#8230; 12 oclock change another one to zero or what not, at the bottom of the tree yes or no</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118266">

			<div class="comment by-noob ">

				<p class="commentcredit">

					<span class="commenter">Noob</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118266">
						October 16, 2011 9:31 AM					</a>

				</p>

				<p>Hi everyone, I been reading all the post and it&#8217;s confusing to me. This might be a silly question but I am currently using truecrypt with a 20 character password. Is that safe against cracking? What if I increase it to 50 characters, would that make any difference. It&#8217;s going to be tough trying to remember it though 🙁 Thanks if anyone can answer</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118267">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118267">
						October 16, 2011 12:32 PM					</a>

				</p>

				<p>@ noob,</p>
<p>&#8220;&#8230; with a 20 character password. Is that safe against cracking? What if increase it to 50 characters&#8221;</p>
<p>It&#8217;s a simple enough question but the answer is hard.</p>
<p>The usual argument is that password cracking is done by &#8220;bruteforce&#8221; that is starting from A-B,AA-BB,&#8230; steping through every single combination of upper case, lower case, numbers and valid punctuation characters untill the password or phrase is found.</p>
<p>If that were the case you would have something like 70^20 passwords to go through, which would give you a reasonable level of security.</p>
<p>However the human brain is weak and most people are hard pushed to remember a purely random string of more than 7 numbers or five or six alpha chars.</p>
<p>Thus people use some &#8220;clever&#8221; method by which to make a long phrase memorable. The problem with this is it can reduce the entropy value of each charecter immensely so instead of each char having around 6.3bits of entropy giving your 20 char pass phrase around 126bits of entropy, it reduces the entropy to as little as 1.4bits per char giving you as little as 28bits of entropy.</p>
<p>Thus the important thing here is &#8220;can reduce&#8221; that is if your potential enemy knows how you are remembering your passphrase they can use the method to reduce the search space accordingly.</p>
<p>So my advice is to either find your own personal way to remember a 20 char password that is either random or apparently random, or take Bruce&#8217;s standard advice about writing it down on a piece of paper you keep in your wallet. Better still find some way to incorperate the two methods together in some &#8220;unique to you&#8221; method.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118268">

			<div class="comment by-alan-taylor ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.pgpboard.com' rel='external nofollow ugc' class='url'>Alan Taylor</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118268">
						February 4, 2012 8:36 AM					</a>

				</p>

				<p>This is such an informative thread. Concerning the NSA&#8217;s use of AES for &#8220;Top Secret&#8221; traffic. Be aware that the NSA uses an enhanced version of AES for NSA prior approved applications, and cipher operating modes. The NSA will usually supply the approved cipher, and in the case of “enhanced” AES 256 this includes enhanced key schedules and management. The AES 256 enhanced algorithm supplied by the NSA is not available to the commercial sector.</p>
<p>See: <a href="http://www.pgpboard.com/viewtopic.php?f=2&#038;t=206&#038;p=346" rel="nofollow ugc">http://www.pgpboard.com/viewtopic.php?f=2&#038;t=206&#038;p=346</a></p>
<p>Regards<br />
AT</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118270">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">Chris</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118270">
						December 26, 2013 4:34 AM					</a>

				</p>

				<p>Give that AES-192 requires 2^176 time, doesn&#8217;t this still make it more secure than the 2^128 time required by AES-128?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118271">

			<div class="comment by-art ">

				<p class="commentcredit">

					<span class="commenter">Art</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118271">
						January 4, 2015 4:14 AM					</a>

				</p>

				<p>Funny it&#8217;s 2015 now. The original blog was in 2009. 6 years later AES isn&#8217;t any less secure than it was 6 years ago.</p>
<p>There is still no known practical attacks that can break AES, and it&#8217;s universally agreed AES 256 is stronger.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118272">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118272">
						January 4, 2015 10:18 AM					</a>

				</p>

				<p>@ Art,</p>
<blockquote><p>There is still no known practical attacks that can break AES.</p></blockquote>
<p>Err that is badly worded, whilst there are no practical attacks publicaly know against the AES algorithm, the same is not true against practical implementations. As for what the various IC agencies might additionaly know, your guess is as good as most others.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118273">

			<div class="comment by-art ">

				<p class="commentcredit">

					<span class="commenter">Art</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118273">
						January 5, 2015 2:45 AM					</a>

				</p>

				<p>@Clive Robinson</p>
<p>IC agencies are not smarter than the entire human intelligence and academic world combined. Given there are still no practical attacks against AES by academic world, it&#8217;s safe to assume IC agencies don&#8217;t have it either. IC agencies are not aliens with different brains than the entire academic world combined.</p>
<p>The original 2009 blog entry was alarmist. Related-key attacks are no concern of properly implemented software. Back in 2009 dozens of people posted on various boards claiming  that schneier says 128 AES is better than 256 AES.</p>
<p>The fact is that I am writing right now in 2015, six years later, and there has been zero progress in showing AES is anywhere even close to be broken.</p>
<p>What progress has been made in 6 years that weakens AES in any practical way? Nothing. Zero. Well, except biclique attack  that requires 2^88 bits of data (38  trillion terabytes) and weakens AES 128 to still impractical 2^126, Even that attack ism given amount of data required, is probably slower in practice than brute force.</p>
<p>So no progress whatsoever since this blog post.</p>
<p>&#8220;Attacks always get stronger&#8221; but apparently sometimes they just get stuck</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118274">

			<div class="comment by-normand-martel ">

				<p class="commentcredit">

					<span class="commenter">Normand Martel</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118274">
						May 9, 2015 8:33 PM					</a>

				</p>

				<p>I really like the idea to keep the same same algorithm but increase the number of rounds. I&#8217;ve written AES in MPLAB and ioncreasing the number of rounds only requires minor changes and adding a few returns for Rcon. AES/Rijndael is already very fast and i sincerly agree that adding rounds is a very viable compromise considering that AES might attain robustness levels approaching Serpent and Twofish.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118275">

			<div class="comment by-art ">

				<p class="commentcredit">

					<span class="commenter">Art</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118275">
						November 3, 2015 8:23 PM					</a>

				</p>

				<p>Normand Martel, wrong dude. Ignore this alarmist 6 years blog post by schneier. There is not one iota of evidence AES 256 is weaker than AES 128. The related key attacks are irrelevant as properly designed software don&#8217;t use related-keys.</p>
<p>By the way, there is no reason to believe the 14 round AES 256 is in any danger of being broken for the next several hundred years, if ever.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118276">

			<div class="comment by-david ">

				<p class="commentcredit">

					<span class="commenter">David</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118276">
						March 21, 2016 3:11 PM					</a>

				</p>

				<p>In <a href="https://eprint.iacr.org/2012/260.pdf" rel="nofollow ugc">https://eprint.iacr.org/2012/260.pdf</a> Huang and Lai suggest transposing the subkey matrices of AES to improve the key schedule.  Has there been any analysis of this variation?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-118277">

			<div class="comment by-sebastian ">

				<p class="commentcredit">

					<span class="commenter">Sebastian</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118277">
						June 2, 2019 7:18 AM					</a>

				</p>

				<p>I&#8217;d give my left nut to see Bruce answer some of the latter day comments on this thread, some killer points and questions.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-118278">

			<div class="comment by-spacelifeform ">

				<p class="commentcredit">

					<span class="commenter">SpaceLifeForm</span> •

					<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/#comment-118278">
						June 16, 2020 8:56 PM					</a>

				</p>

				<p>Nonce-Disrespecting Adversaries:  Practical Forgery Attacks on GCM in TLS</p>
<p><a href="https://eprint.iacr.org/2016/475.pdf" rel="nofollow ugc">https://eprint.iacr.org/2016/475.pdf</a></p>
<p>(nonce reuse)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2009/07/another_new_aes.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2009/07/another_new_aes.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2009%2F07%2Fanother_new_aes.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2009/07/another_new_aes.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='2975' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2009/07/risks_of_cloud.html" rel="prev">← Risks of Cloud Computing</a>		<a href="https://www.schneier.com/blog/archives/2009/07/nuclear_self-te.html" rel="next">Nuclear Self-Terrorization →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
