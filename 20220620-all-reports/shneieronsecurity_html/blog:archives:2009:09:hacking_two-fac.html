<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Hacking Two-Factor Authentication - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Hacking Two-Factor Authentication Comments Feed" href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/3036" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=3036' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2009%2F09%2Fhacking_two-fac.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2009%2F09%2Fhacking_two-fac.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-3036 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-3036" class="post-3036 post type-post status-publish format-standard hentry category-uncategorized tag-authentication tag-banking tag-fraud tag-identity-theft tag-malware tag-man-in-the-middle-attacks tag-two-factor-authentication">

	<div class="article">

		<h2 class="entry">Hacking Two-Factor Authentication</h2>
		<p>Back in 2005, I wrote about the <a href="https://www.schneier.com/blog/archives/2005/03/the_failure_of.html">failure</a> of two-factor authentication to mitigate banking fraud:</p>
<blockquote><p>Here are two new active attacks we&#8217;re starting to see:</p>
<ul>
<li><b>Man-in-the-Middle attack.</b> An attacker puts up a fake bank website and entices user to that website. User types in his password, and the attacker in turn uses it to access the bank&#8217;s real website. Done right, the user will never realize that he isn&#8217;t at the bank&#8217;s website. Then the attacker either disconnects the user and makes any fraudulent transactions he wants, or passes along the user&#8217;s banking transactions while making his own transactions at the same time.
<li><b>Trojan attack.</b> Attacker gets Trojan installed on user&#8217;s computer. When user logs into his bank&#8217;s website, the attacker piggybacks on that session via the Trojan to make any fraudulent transaction he wants.</ul>
<p>See how two-factor authentication doesn&#8217;t solve anything? In the first case, the attacker can pass the ever-changing part of the password to the bank along with the never-changing part. And in the second case, the attacker is relying on the user to log in.</p></blockquote>
<p><a href="http://www.technologyreview.com/computing/23488/page1/">Here&#8217;s</a> an example:</p>
<blockquote><p>The theft happened despite Ferma&#8217;s use of a one-time password, a six-digit code issued by a small electronic device every 30 or 60 seconds. Online thieves have adapted to this additional security by creating special programs&#8211;real-time Trojan horses&#8211;that can issue transactions to a bank while the account holder is online, turning the one-time password into a weak link in the financial security chain. &#8220;I think it&#8217;s a broken model,&#8221; Ferrari says.</p></blockquote>
<p>Of course it&#8217;s a broken model.  We have to stop trying to authenticate the person; instead, we need to <a href="http://www.schneier.com/crypto-gram-0504.html#1">authenticate the transaction</a>:</p>
<blockquote><p>One way to think about this is that two-factor authentication solves security problems involving authentication. The current wave of attacks against financial systems are not exploiting vulnerabilities in the authentication system, so two-factor authentication doesn&#8217;t help.</p>
<p>Security is always an arms race, and you could argue that this situation is simply the cost of treading water. The problem with this reasoning is it ignores countermeasures that permanently reduce fraud. By concentrating on authenticating the individual rather than authenticating the transaction, banks are forced to defend against criminal tactics rather than the crime itself.</p>
<p>Credit cards are a perfect example. Notice how little attention is paid to cardholder authentication. Clerks barely check signatures. People use their cards over the phone and on the Internet, where the card&#8217;s existence isn&#8217;t even verified. The credit card companies spend their security dollar authenticating the transaction, not the cardholder.</p></blockquote>
<p><a href="http://www.schneier.com/crypto-gram-0504.html#2">More</a> on mitigating identity theft.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/authentication/" rel="tag">authentication</a>, <a href="https://www.schneier.com/tag/banking/" rel="tag">banking</a>, <a href="https://www.schneier.com/tag/fraud/" rel="tag">fraud</a>, <a href="https://www.schneier.com/tag/identity-theft/" rel="tag">identity theft</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/man-in-the-middle-attacks/" rel="tag">man-in-the-middle attacks</a>, <a href="https://www.schneier.com/tag/two-factor-authentication/" rel="tag">two-factor authentication</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html" rel="bookmark">Posted on September 22, 2009 at 6:39 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html#comments">98 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html" data-title="Hacking Two-Factor Authentication" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-121159">

			<div class="comment by-a-nonny-bunny ">

				<p class="commentcredit">

					<span class="commenter">A Nonny Bunny</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121159">
						September 22, 2009 7:20 AM					</a>

				</p>

				<p>Surely two-factor identification does prevent a whole host of other exploits. I wouldn&#8217;t throw it out simply because it doesn&#8217;t solve <em>every</em> problem. I doubt anything will ever solve every problem.</p>
<p>I suppose perhaps a bank could send a text-message with the transaction details as well as a confirmation code. That way you know what transaction you&#8217;re committing to, and you can see whether a man in the middle has added anything.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121160">

			<div class="comment by-ricky-bobby ">

				<p class="commentcredit">

					<span class="commenter">Ricky Bobby</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121160">
						September 22, 2009 7:21 AM					</a>

				</p>

				<p>Why do you think authenticating the transaction will fix everything?</p>
<p>Don&#8217;t you think someone will learn how to circumvent this transaction authentication as well?</p>
<p>Nothing is perfect.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121161">

			<div class="comment by-larry-seltzer ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://blogs.pcmag.com/securitywatch/' rel='external nofollow ugc' class='url'>Larry Seltzer</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121161">
						September 22, 2009 7:23 AM					</a>

				</p>

				<p>I think you&#8217;re overstating things to say it doesn&#8217;t solve anything. Of course it doesn&#8217;t solve <em>everything</em> but it does solve many very common attacks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121162">

			<div class="comment by-igor ">

				<p class="commentcredit">

					<span class="commenter">igor</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121162">
						September 22, 2009 7:26 AM					</a>

				</p>

				<p>My bank already authenticates transactions. Every time I try to make a transfer or other sensitive operation, I get a text message &#8220;transfer: amount [sth.] from account [first and last digits] to account [first and last digits] at [time and date]. Your one-time password is [8 digits]&#8221;.</p>
<p>I wonder if there are any problems with that system? In my opinion, there aren&#8217;t any with the general idea. They might be in the implementation details, although I&#8217;ve never found any.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121163">

			<div class="comment by-mathfox ">

				<p class="commentcredit">

					<span class="commenter">MathFox</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121163">
						September 22, 2009 7:29 AM					</a>

				</p>

				<p>I know one bank that gives a device where you enter amount and account number of the other party in the transaction and the device gives you a checksum to confirm the online transaction.<br />
It is not perfect (the device can be stolen), but it prevents man in the middle network attacks because the mitm has no checksum for his fraudulent transaction and changing the information of a valid transaction will cause a checksum failure. (Read up on MACs in a cryptography text.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121164">

			<div class="comment by-franz-alt ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://twitter.com/wwwprofi' rel='external nofollow ugc' class='url'>Franz Alt</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121164">
						September 22, 2009 8:10 AM					</a>

				</p>

				<p>The only two ideas I have to make this better is<br />
a) use a non-conprimisable system, for example Linux-Boot-CD for homebanking<br />
&amp;<br />
b) use a client-certificate for a secure connection.<br />
I don&#8217;t know, if b) works with a browser and https, but HBCI should be ok, shouldn&#8217;t it?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121165">

			<div class="comment by-savik ">

				<p class="commentcredit">

					<span class="commenter">Savik</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121165">
						September 22, 2009 8:33 AM					</a>

				</p>

				<p>I would think two factor out of band authentication would be the answer to this issue. For instance, you initiate authentication to your online banking site using user-name and password &#8211; then you get a phone call and have to enter a PIN to complete the authentication.</p>
<p>After you are in you could also set it up to authenticate through out of band authentication any wire transfers or high dollar  transactions&#8230;that threshold can be configurable so as not to bother you with nominal transaction amounts.</p>
<p>One could also choose to receive a TXT message every time a transaction occurred- so it could be verified.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121166">

			<div class="comment by-nick-owen ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.wikidsystems.com' rel='external nofollow ugc' class='url'>Nick Owen</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121166">
						September 22, 2009 8:44 AM					</a>

				</p>

				<p>Focusing on what process is being authenticated is more helpful than the number of factors involved.</p>
<p>I like to break it down further into session, host/mutual and transaction authentication. Here&#8217;s an article I wrote on this topic some time ago: <a href="http://searchsoftwarequality.techtarget.com/tip/0,289483,sid92_gci1180513,00.html" rel="nofollow ugc">http://searchsoftwarequality.techtarget.com/tip/0,289483,sid92_gci1180513,00.html</a>.</p>
<p>Doing strong transaction authentication is better than session authentication, if you are only doing one!  But one will not be enough.  All three will need to be addressed in a real way, based on cryptographic principles.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121167">

			<div class="comment by-fok ">

				<p class="commentcredit">

					<span class="commenter">FOK</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121167">
						September 22, 2009 8:48 AM					</a>

				</p>

				<p>Two factor can remedy lot of attacks being performed nowadays. But only when it is done right. Simply sending authentication code via SMS doesn&#8217;t solve it much. When there is MITM, then you are talking to fake site and provides security codes that can be used by malicious party. Better is sending authentication messages with transaction identification as igor wrote. This is exactly what my bank is doing. You just check if the account numbers fit and if so, then you enters code to the form. But this is still susceptible to MITM. Just keep in mind that SMS is sent via network similar to internet. Authentication protocol on SMSC is kind of fun if not omitted at all. Just because you don&#8217;t know how to forge SMS doesn&#8217;t mean nobody can do it.<br />
One of the banks I know was much better in protecting transactions. They use two factor authentication with strong countermeasure against forgery. You either receive encrypted message on your mobile, that is processed by banking application, loaded into your phone SIM by your bank, after entering BPIN. Or you can have special calculator where you enter your transaction details and device generates security code for the transaction based on entered data. And of course such calculator is protected by PIN.<br />
Some banks are offering smart card authorization tokens. But There is hidden risk too. I never heard about this attack. But consider MITM between keyboard and crypto device. If you can intercept communication between computer and device, then you can generate as much transactions as you wish just replaying PIN for crypto device. Of course as long as it is inserted in USB port.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121168">

			<div class="comment by-brazzy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.brazzy.de/' rel='external nofollow ugc' class='url'>brazzy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121168">
						September 22, 2009 8:49 AM					</a>

				</p>

				<p>@Savik &#8211; out-of-band two-factor auth doesn&#8217;t prevent man-in-the-middle attacks any better than simple auth unless, as Bruce writes, you authenticate the transaction by including data about it with the out-of-band communication so that the user can check <em>which</em> transaction he&#8217;s approving.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121170">

			<div class="comment by-pixel ">

				<p class="commentcredit">

					<span class="commenter">Pixel</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121170">
						September 22, 2009 8:55 AM					</a>

				</p>

				<p>My bank gave me a small device which reads my bank card, validates my PIN, then generates a unique 8-digit code.  And that&#8217;s just to get in.</p>
<p>If I want to transfer money to an account I haven&#8217;t transferred to previously, I have to use the same device, again with bank card and PIN, plus the target account number and transfer value.  without this, the most I can do is move money around my own accounts, or to people I have already approved.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121171">

			<div class="comment by-tobias ">

				<p class="commentcredit">

					<span class="commenter">Tobias</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121171">
						September 22, 2009 8:57 AM					</a>

				</p>

				<p>A lot of banks in sweden got just the solution to authenticate the transaction.</p>
<p>You enter the code of the target account in your offline pad, got a confirmation code you enter on the website.</p>
<p>After that you enter the amount of money you transfer in your pad and enters the confirmation code on the website.</p>
<p>In that case you both enter the amount of money and the confirmation code. Then the bank checks against their algorithm to see it match.</p>
<p>Ofcoz you could do a MITM attack on that in some cases, but it&#8217;s not as easy as just one time pads.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121172">

			<div class="comment by-paeniteo ">

				<p class="commentcredit">

					<span class="commenter">Paeniteo</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121172">
						September 22, 2009 9:00 AM					</a>

				</p>

				<p>@Franz Alt:</p>
<blockquote><p>
  a) use a non-conprimisable system,<br />
  for example Linux-Boot-CD for<br />
  homebanking
</p></blockquote>
<p>There simply is no such thing as a non-compromisable system.<br />
Practically speaking, a Linux-Boot-CD might come close to that ideal. If you know german, google for &#8220;Bankix&#8221;.</p>
<blockquote><p>
  b) use a client-certificate for a<br />
  secure connection.
</p></blockquote>
<p>Pointless against trojans.</p>
<p>@FOK:</p>
<blockquote><p>
  But this is still susceptible to MITM.<br />
  Just keep in mind that SMS is sent<br />
  via network similar to internet.
</p></blockquote>
<p>True, but the odds that an attacker is able to conduct simultaneous MITM-attacks against <em>both</em> your internet- and cellphone-connections appear quite low.<br />
Also, the procedure definitely increases complexity (=costs) for the attacker.</p>
<p>cu, Paeniteo</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121173">

			<div class="comment by-franz-alt ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://twitter.com/wwwprofi' rel='external nofollow ugc' class='url'>Franz Alt</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121173">
						September 22, 2009 9:01 AM					</a>

				</p>

				<p>Another idea:<br />
After sending a bank transfer via internet, I could get an automatic &#8220;recall&#8221; to my cellphone, which reads again my ordner and I have to accept.</p>
<p>I think it&#8217;s quite good, but way more expensive then other solutions, but better then sending TANs to a mobile phone, which doesn&#8217;t prevents all mitm-attacks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121174">

			<div class="comment by-coffee ">

				<p class="commentcredit">

					<span class="commenter">coffee</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121174">
						September 22, 2009 9:02 AM					</a>

				</p>

				<p>I think saying 2factor doesn&#8217;t solve anything is an obtuse statement. But, I think what was being said is it doesn&#8217;t solve fraud&#8230; which is equally short sighted.</p>
<p>The point being missed is layers of defense. 2factor can greatly reduce issues when combined with other controls, even simple controls that create a more sound environment.</p>
<p>Anyone relying only on one security control to solve everything will fail &#8211; regardless of the control in question. Security is a system&#8230; not a box. Moreover, applying every control in the world will not address everything&#8230; there is a balance between threat and control, cost and loss.</p>
<p>Attacking the validity of any one control without considering the entire environment is extraordinarily short sighted. Can 2factor be hacked? Yes. Will the hack be successful when combined with other supporting controls? Less likely.</p>
<p>Implying that 2factor is worthless and all your energy should be directed at authenticating the transaction (which Bruce failed to elaborate upon what exactly he means by this) is counterproductive. This is analogous to building a wall, having it fail against a specific attack, so you tear down the wall and build a moat assuming that the moat will thwart all future attacks &#8211; which is wrong, and clearly a wall and a moat would be a better solution.</p>
<p>I guess when authenticating the transaction fails to solve the problem, we&#8217;ll be rewarded with a similar posting on how we need to ditch that and move to something else. I think even squid know that one defense isn&#8217;t perfect, but can be made  better when combined with multiple, intertwined defense tactics.</p>
<p>It seems to me that defense in depth got lost in his anti-2factor post.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121175">

			<div class="comment by-carlo-graziani ">

				<p class="commentcredit">

					<span class="commenter">Carlo Graziani</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121175">
						September 22, 2009 9:06 AM					</a>

				</p>

				<p>The trouble is, these systems have been designed to authenticate customers to banks.  They don&#8217;t appear to do anything in aid of the converse problem &#8212; authenticating banks to customers.</p>
<p>I suppose it&#8217;s the externality thing again.  Banks have a greater incentive to protect themselves than to protect their customers.  Probably if the banks were made 100% liable for losses due to internet-banking fraud, they&#8217;d come up with a more symmetric authentication scheme in a hurry.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121176">

			<div class="comment by-bobafett ">

				<p class="commentcredit">

					<span class="commenter">BobaFett</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121176">
						September 22, 2009 9:13 AM					</a>

				</p>

				<p>Egg credit card in the UK has occasional transaction authentication via an automated system that phones the customer when their spending patterns deviate from the norm (usually occurs with new internet based counterparts).  Admittedly their incentive is greater, as being a provider of credit they are liable for any fraudulent use and not the customer (in my experience at least).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121177">

			<div class="comment by-roboticus ">

				<p class="commentcredit">

					<span class="commenter">Roboticus</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121177">
						September 22, 2009 9:23 AM					</a>

				</p>

				<p>For everyone saying something along the lines of send a text message to customers telling them &#8220;Transfer $XXX  From XXXX-XXXX to XXXX-XXXXX&#8221;, I have worked with the public for  8 years now. I can tell you as hard as it may be to believe, most people wouldn&#8217;t pay the slightest bit of attention to the amount or destination account number. I can count on the fingers of one hand the number of customers I&#8217;ve seen look at the total on the customer display and make sure it matches the credit card slip they are signing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121178">

			<div class="comment by-matt-from-ct ">

				<p class="commentcredit">

					<span class="commenter">Matt from CT</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121178">
						September 22, 2009 9:35 AM					</a>

				</p>

				<p>Didn&#8217;t feel like my normal granola bar this morning for breakfast.</p>
<p>Stopped at McD&#8217;s to get my weekly grease quotient.</p>
<p>Their computers were down.</p>
<p>Took two employees four attempts at using a calculator to tally up my order.</p>
<p>Then they couldn&#8217;t figure out the change for a $7.03 meal from a $20 bill.</p>
<p>They had to ask the manager for help.</p>
<p>And we think devices to calculate transaction hashes are going to help us?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121179">

			<div class="comment by-nosuchthingasidentitytheft ">

				<p class="commentcredit">

					<span class="commenter">NoSuchThingAsIdentityTheft</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121179">
						September 22, 2009 9:44 AM					</a>

				</p>

				<p>Trojan attack: Game over. If the bad guy has installed software on your computer, it is no longer your computer. There is nothing you can do to protect your information or transactions. Period.</p>
<p>MITM attack: A few years ago, real-time MITM attacks against the web browser were considered not practical, but now they are. If your web browser session can fall to a real-time MITM attack, why do you think any OOB transaction verification won&#8217;t also?</p>
<p>The fundamental underlying problem in any MITM attack is that the customer is not verifying the identity of the bank.</p>
<p>If the customer is not verifying that they are connected to and interacting with the real bank from their web browser, it is highly unlikely they will verify that the SMS message (or whatever OOB transaction verification method) actually came from the real bank.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121180">

			<div class="comment by-bf-skinner ">

				<p class="commentcredit">

					<span class="commenter">BF Skinner</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121180">
						September 22, 2009 9:49 AM					</a>

				</p>

				<p>Doesn&#8217;t an authenticated transaction rely on an authorized user?</p>
<p>Does authenticating the transaction just add an additional link. A link that can be manipulated by getting between the user and their authority to authenticate the transaction?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121181">

			<div class="comment by-shahram-karimian ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.msksecurity.com' rel='external nofollow ugc' class='url'>Shahram Karimian</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121181">
						September 22, 2009 9:53 AM					</a>

				</p>

				<p>I wonder how common MITM attacks are? 2FA protects againts a majority of the attacks</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121182">

			<div class="comment by-tim ">

				<p class="commentcredit">

					<span class="commenter">Tim</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121182">
						September 22, 2009 9:54 AM					</a>

				</p>

				<p>None of these attacks would work against the systems where you use your phone to add new payees.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121183">

			<div class="comment by-michael-argast ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.sophos.com' rel='external nofollow ugc' class='url'>Michael Argast</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121183">
						September 22, 2009 9:56 AM					</a>

				</p>

				<p>The tone of this does seem off to me &#8211; ditch two-factor because it is possible to bypass it?</p>
<p>While we&#8217;re at it, ditch password screens because they make it harder?</p>
<p>I understand your railing against passwords and authenticating the user, but authenticating the transaction has its own issues. It is really not that different than a sort of challenge-response scheme, which can be bypassed via things like MITM, or worse, make for a usability nightmare whenever anybody does anything unusual (which for many people, is all the time).</p>
<p>Modern security usually involves layers &#8211; the point isn&#8217;t to make it unbreakable (there is no such thing) but to make it sufficiently difficult the attackers go elsewhere or to reduce/mitigate the risk and costs.</p>
<p>Sure, Trojans and MITM attacks can break two-factor, but there are a lot more attacks that can break one-factor or no-factor.</p>
<p>Michael Argast, Security Analyst, Sophos</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121184">

			<div class="comment by-fok ">

				<p class="commentcredit">

					<span class="commenter">FOK</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121184">
						September 22, 2009 9:58 AM					</a>

				</p>

				<blockquote><p>
  True, but the odds that an attacker is able to conduct simultaneous MITM-attacks against <em>both</em> &gt; your internet- and cellphone-connections appear quite low.<br />
  Also, the procedure definitely increases complexity (=costs) for the attacker.
</p></blockquote>
<p>Yes in computer security it is always about increasing complexity. But forging SMS is not so hard.<br />
If you know bit about your victim and his/her bank, then it is quite easy to plot an attack if you have access to the infrastructure. in my previous career I was allowed to send SMS from my computer that appeared on receivers side as it was sent from my handy. All this via SMS gateway connecte not only to different provider but also in different country.<br />
Now consider fact that GSM protocol allows canceling already sent SMS message. So you asks banking application to send SMSes to your phone and eventually cancels warning message that is sent to users mobile. And from now on you are the master of the account.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121185">

			<div class="comment by-john-verry ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.PivotPointSecurity.com' rel='external nofollow ugc' class='url'>John Verry</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121185">
						September 22, 2009 10:04 AM					</a>

				</p>

				<p>Glad to see that the common reaction to this blog was the same as mine &#8212; underwhelmed.</p>
<p>I also find holding anything the credit card companies does as being &#8220;good practice&#8221; (The credit card companies spend their security dollar authenticating the transaction, not the cardholder.) as being comical.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121187">

			<div class="comment by-fok ">

				<p class="commentcredit">

					<span class="commenter">FOK</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121187">
						September 22, 2009 10:08 AM					</a>

				</p>

				<blockquote><p>
  Notice how little attention is paid to cardholder authentication.
</p></blockquote>
<p>There are also examples how cards can be more protected.<br />
Currently card companies are issuing chip cards that are better at maintaining security than magnetic strip only cards. But before this there was one bank in our country, that was swallowed by another bank that offered card locking. You had to send encrypted SMS to the bank to unlock your card and after doing transaction you locked card by same procedure. So exposure to card misuse is quite limited.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121188">

			<div class="comment by-bf-skinner ">

				<p class="commentcredit">

					<span class="commenter">BF Skinner</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121188">
						September 22, 2009 10:09 AM					</a>

				</p>

				<p>@Michael Argast &#8220;ditch two-factor because it is possible to bypass it&#8221;</p>
<p>That&#8217;s not entirely what Bruce appears to be advocating.</p>
<p>This is based on an earlier argument of his (that link at top goes to a (2005) cryptogram) that 2factor works in some configurations but won&#8217;t work to deter and eliminate bank fraud.</p>
<p>He proposed the model of the credit card where user identites are barely addressed (when was the last time any of us were asked for a driver&#8217;s license? While writing a check right?)</p>
<p>But I&#8217;m having a hard time seeing how authenticating the transaction would work. CC companies assume transactions are legit until the cardholder tells &#8217;em it&#8217;s been stolen</p>
<p>(&#8230;yes&#8230;they do watch transactions, once someone in Romania was using my card number to order stuff and the CC company called to ask me about it. And once they questioned the size of my tuition payment but I never called them back and they didn&#8217;t refuse to honor the payment.)</p>
<p>But how would a bank work that?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121190">

			<div class="comment by-paeniteo ">

				<p class="commentcredit">

					<span class="commenter">Paeniteo</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121190">
						September 22, 2009 10:35 AM					</a>

				</p>

				<p>@FOK:</p>
<blockquote>
<blockquote><p>
    True, but the odds that an attacker is able to conduct simultaneous MITM-attacks against <em>both</em><br />
    your internet- and cellphone-connections appear quite low.<br />
    Also, the procedure definitely increases complexity (=costs) for the attacker.
  </p></blockquote>
<p>  Yes in computer security it is always about increasing complexity.<br />
  But forging SMS is not so hard.
</p></blockquote>
<p>The hard part IMHO would not be forging the SMS (kinda trivial) but intercepting the &#8220;real&#8221; SMS in the first place.<br />
I don&#8217;t think that would be possible for the common &#8220;broadband&#8221; phishing attacks but rather only for targetted attacks against single victims (which is an entirely different game).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121191">

			<div class="comment by-mark-tinberg ">

				<p class="commentcredit">

					<span class="commenter">Mark Tinberg</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121191">
						September 22, 2009 10:40 AM					</a>

				</p>

				<p>I reiterate, this kind of financial vulnerability could be mitigated by having a token with a keypad and having the token hash the transaction values (amount, dest account) along with the auth info.  That would prevent reuse of transaction data, as long as the backend only honored a token response one time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121192">

			<div class="comment by-bill ">

				<p class="commentcredit">

					<span class="commenter">Bill</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121192">
						September 22, 2009 10:55 AM					</a>

				</p>

				<p>@bruce</p>
<p>&#8220;The credit card companies spend their security dollar authenticating the transaction, not the cardholder.&#8221;</p>
<p>No, that&#8217;s not true. The VBV /secure code programs are designed to authenticate the cardholder.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121193">

			<div class="comment by-fok ">

				<p class="commentcredit">

					<span class="commenter">FOK</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121193">
						September 22, 2009 11:05 AM					</a>

				</p>

				<p>@Paeniteo:</p>
<blockquote><p>
  The hard part IMHO would not be forging the SMS (kinda trivial) but intercepting the &#8220;real&#8221; SMS in the first place.
</p></blockquote>
<p>Unfortunately there are banks that allow you to log in via password and SMS is used only for transaction verification. And your phone number can be easily changed after you log in. They send notification SMS when someone is trying to change target number but here comes cancellation message to suppress such warning as I worte.</p>
<blockquote><p>
  I don&#8217;t think that would be possible for the common &#8220;broadband&#8221; phishing attacks but rather only for targetted attacks against single victims (which is an entirely different game).
</p></blockquote>
<p>I didn&#8217;t say that it is easy. But even with two factor authentication your bank account can be robbed. And all this is in the time when other banks are using technology, that can easily prevent this. Just use SIM toolkit application that receives and send data to your bank encrypted and immediately you are on another level.<br />
The real problem with MITM is that most people didn&#8217;t verify what is base for security code. So attacker can easily change account number and amount of money transferred and user will confirm it with real authentication code. And this of course will not be solved by authentication message. The only solution is to use independent authentication device where you have to type all transaction details and then you receive security code for transaction as I wrote earlier. It can be even application for your phone or PDA, until phone trojans become common.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121194">

			<div class="comment by-rh ">

				<p class="commentcredit">

					<span class="commenter">RH</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121194">
						September 22, 2009 11:11 AM					</a>

				</p>

				<p>&#8220;Two Factor Authentication Doesn&#8217;t Solve anything&#8221;&#8230; doesn&#8217;t seem fair to use Trojans.  There is ALWAYS an implicit assumption that at least ONE piece of hardware is trustworthy and in the possession of the user.  Specifically, whatever portion of the process is used to authenticate MUST itself be reliable.  Thats like saying &#8220;SSL doesn&#8217;t help you because your computer knows the session key and it can be compromized.&#8221;  If you can&#8217;t trust your own machine, then its time to stop ordering online and start going to the teller windows at the Bank for your deposits.</p>
<p>The only systems I&#8217;ve seen which come even close to avoiding this problem are those where the final authentication is done by the user&#8217;s own eyeballs (such as comparing a text message&#8217;s specified account number to the one you think you&#8217;re sending money to.  But even that fails with modern day smart phones &#8211; how long will it be before a virus get out which gives no signs of its existence, until you try to bank with a compromised computer, then it shortcuts the text messages?</p>
<p>Any, like many others, my bank uses 2 factor to log in, but then for a set of &#8220;high risk&#8221; operations, such as large transactions, it asks for annother one-time use key.</p>
<p>We want our hardware generalized&#8230; the price we pay is not knowing what is actually getting executed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121195">

			<div class="comment by-nosuchthingasidentitytheft ">

				<p class="commentcredit">

					<span class="commenter">NoSuchThingAsIdentityTheft</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121195">
						September 22, 2009 11:15 AM					</a>

				</p>

				<p>&#8220;Credit cards are a perfect example. Notice how little attention is paid to cardholder authentication. Clerks barely check signatures. People use their cards over the phone and on the Internet, where the card&#8217;s existence isn&#8217;t even verified. The credit card companies spend their security dollar authenticating the transaction, not the cardholder.&#8221;</p>
<p>I don&#8217;t necessarily disagree, but I think that in the banking environment, comparing credit cards to bank accounts is sort of an &#8220;apples to oranges&#8221; comparison.</p>
<p>The reason credit cards work today is because the cardholder is not liable for fraudulent transactions! Simple as that.</p>
<p>Cardholders don&#8217;t check receipt totals because they know they can call the credit card company and easily dispute transactions after the fact. Since this is &#8220;credit&#8221; the cardholder has not lost any money at this point. In most cases (i.e. card signature verify, card not present, etc.), the responsibility falls onto the credit card merchant or the bank to investigate any fraud. In the worst case, the cardholder would only be liable for $50 (if that).</p>
<p>However, this is typically not the case with fraud related to bank accounts or debit cards (connected to bank accounts). In this case, the bank customer is liable, although I understand that some banks are better at &#8220;resetting&#8221; fraudulent transactions related to bank accounts and debit cards.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121196">

			<div class="comment by-rh ">

				<p class="commentcredit">

					<span class="commenter">RH</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121196">
						September 22, 2009 11:16 AM					</a>

				</p>

				<p>Also, the more hoops we make the criminals jump through, the more likely they will leave behind some breadcrumbs that make you think &#8220;hmm, thats kind of funny&#8230;&#8221;  such as SSL certificates not matching up.</p>
<p>In the end, the challenge is reducing bandwidth usage to those of only the secure I/O between the secure device and the user&#8217;s mind.  If every text message has an account number 16 digits long, how long will it be before someone simply glazes over them?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121197">

			<div class="comment by-ricky-bobby ">

				<p class="commentcredit">

					<span class="commenter">Ricky Bobby</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121197">
						September 22, 2009 11:19 AM					</a>

				</p>

				<p>This is a silly argument.  In every technology a security flaw will be found, it just depends on on the amount of money needed to find/exploit it and the time involved to exploit the vulnerability.  Security 101</p>
<p>Will two factor authentication fix every authentication issue?</p>
<p>No, but nothing will.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121198">

			<div class="comment by-richard-schwartz ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.poweroftheschwartz.com' rel='external nofollow ugc' class='url'>Richard Schwartz</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121198">
						September 22, 2009 11:21 AM					</a>

				</p>

				<p>Validating transactions via SMS raises the question of how you secure a transaction that changes the mobile number to be used for the SMS.  While ordinarily sending a confirmation text to the number you are switching from seems like a good idea, if you&#8217;ve been individually targeted it&#8217;s probably not going to be that difficult for the bad guy to simply steal your phone and drain your bank account before you even have time to get your provider to disable it.  Furthermore, in the ever-present battle between security and convenience there are some really thorny issues here.  E.g., if you are out of the country and your phone doesn&#8217;t work on the local system, you can&#8217;t get the confirming SMS.  (And if the alternative is to make a personal appearance at your bank branch to that&#8217;s not going to happen either.) So unless you&#8217;ve planned ahead and reserved a mobile number in the country you are visiting, you can&#8217;t take care of the switch in advance.  Although it&#8217;s a mistake nobody is likely to make twice, ending up abroad with no access to one&#8217;s credit card is not a situation you want your security measures to put your customer in even once.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121199">

			<div class="comment by-fok ">

				<p class="commentcredit">

					<span class="commenter">FOK</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121199">
						September 22, 2009 11:38 AM					</a>

				</p>

				<p>@RH:<br />
Authentication being done by users eyeballs is only false sense of security. Message sent to you can be forged so you will notice nothing. The only secure way to protect your transaction is security calculator. It is something like SecurID tokens but also takes into account transaction data you type on the keypad that must match what you type into bank&#8217;s web form. Then it works like digitally signed message. And because this device is not connected in any way to the computer, then it seem pretty secure to me. And of course the device itself is protected by the PIN :-).<br />
If you are interested, there is an image (very poor resolution) of such device on following page.<br />
<a href="http://www.e-komerce.cz/ec/ec.nsf/0/46984CBBA0728F33C1256C3A00499CD7" rel="nofollow ugc">http://www.e-komerce.cz/ec/ec.nsf/0/46984CBBA0728F33C1256C3A00499CD7</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121200">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121200">
						September 22, 2009 11:40 AM					</a>

				</p>

				<p>Ho hum, ho hum,</p>
<p>I&#8217;ve posted about this on Bruce&#8217;s blog a number of times in the past.</p>
<p>1, It is the transaction that needs to be authenticated.</p>
<p>2, But importantly the bank and the user need to authenticate each other as well.</p>
<p>3, The authentication needs to be &#8220;tamper proof&#8221;.</p>
<p>It is this last bit where people get it wrong and where attacks are going to happen.</p>
<p>To be &#8220;tamper proof&#8221; a lot of conditions have to be met,</p>
<p>A, It needs to be cryptographicaly secure<br />
B, It needs to be a secure side channel.<br />
C, It needs to be immutable.</p>
<p>Humans tend to be incapable of meeting A, a mobile phone will never meet C and B idealy should be through the user.</p>
<p>The solution is to use a token with a keypad. whereby transaction details are entered in along with a secret (something you know) and a two part crypto checksum is created which the user then types  part A of into the PC.</p>
<p>This gets sent to the bank which checks the transaction and sends back a confirmation check code which the user then types into the token. Part of the check code should be the same as part B of the checksum in the token if they match the token then performs an action on the rest of the check code and displays it to the user as the secure confirmation code that they then type into the PC.</p>
<p>The problem with all of this is reducing the amount of information the user has to type in to ease use.</p>
<p>Originaly I suggested using capatchers or their equivalent as this is a process designed to be human but not computer readable.</p>
<p>Since then the &#8220;phishers etc&#8221; have solved this problem they just forward the capatcher to somebody in the far east who gets paid some small sum (50cents or less) for typing in the correct answer&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121201">

			<div class="comment by-gert ">

				<p class="commentcredit">

					<span class="commenter">Gert</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121201">
						September 22, 2009 11:49 AM					</a>

				</p>

				<p>Around here (South-Africa) many banks use a single use code send via SMS for certain transactions. Successful attacks have been done using phone company employees&#8230;</p>
<p>In addition, initial login asks for 4 random characters from a password, which usually mean that the user needs to be fool into entering his complete password on a site for an login to be practical&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121202">

			<div class="comment by-bryan-feir ">

				<p class="commentcredit">

					<span class="commenter">Bryan Feir</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121202">
						September 22, 2009 12:06 PM					</a>

				</p>

				<p>As Clive mentioned, really, the ultimate solution is really a token with a keypad.  The cryptography on the token can be used to perform the authentication of the bank AND THE ATM to the customer as well, which is the side of this that is currently not done much.</p>
<p>I remember seeing descriptions and photographs of prototype systems like this back when I was in grad school&#8230; and that was in 1992.  This was a Visa card with a standard contact pad, a one-line LCD display, and a keypad.  The card had its own built-in encryption key, as well.</p>
<p>So, why isn&#8217;t this sort of thing used?<br />
&#8211; The cards/tokens are significantly more expensive to produce.<br />
&#8211; The cards/tokens are significantly more fragile, and need to be replaced more often.<br />
&#8211; Customer education is a pain, because people tend to be lazy.<br />
&#8211; There&#8217;s no actual requirement for it, and the banks tend to be lazy, too.<br />
Most of it boils down to externalities again; a truly secure system would cost the banks more than cleaning up the mess from less secure systems.  Also, a truly secure system would cause more problems with customers being blocked from their own money.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121203">

			<div class="comment by-uberdilligaff ">

				<p class="commentcredit">

					<span class="commenter">uberdilligaff</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121203">
						September 22, 2009 12:07 PM					</a>

				</p>

				<p>@Tinberg &#8211; I think you have it correct.  Authenticating the transaction by hashing the desired amount and account and out-of-band transaction code info means that your desired transaction will succeed, even if passed through a MITM.  However, the MITM attempt to alter the transaction to his benefit will fail. The MITM could cause my transaction to also fail by not forwarding it along to the real bank, but I can live with that outcome.</p>
<p>I disagree with Bruce&#8217;s assertion that 2-factor solves nothing.  Such procedures reduce the ability to attack my transaction from &#8220;anybody anywhere on the Internet who has stolen/bought my account and password, at any time of day or night, without any participation on my part&#8221; to &#8220;someone who can redirect my connection to his site and hope I don&#8217;t notice the certificate error, only at times when I initiate the connection, and only by causing my transaction to fail&#8221;.  I like those odds much better.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121204">

			<div class="comment by-fok ">

				<p class="commentcredit">

					<span class="commenter">FOK</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121204">
						September 22, 2009 12:15 PM					</a>

				</p>

				<p>After writing my last post I started to wonder since when is such authentication calculator offered. I found that the bank that was offering it started its operation in 1997. So it is more than 10 years without any significant improvement in other banks. Unfortunately such bank doesn&#8217;t exist anymore.<br />
it looks like banks doesn&#8217;t care about their customers money. Or how can one explain such lack of security for online transactions.</p>
<p>@Brian:</p>
<blockquote>
<ul>
<li>There&#8217;s no actual requirement for it, and the banks tend to be lazy, too.<br />
  You are completely right. There are several regulatory requirements on the IT security but nothing in case of transaction authorization.</li>
</ul>
</blockquote>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121205">

			<div class="comment by-steven-murdoch ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.cronto.com/' rel='external nofollow ugc' class='url'>Steven Murdoch</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121205">
						September 22, 2009 12:36 PM					</a>

				</p>

				<p>The extent to which people, even within the security community, believe that 2FA will solve their problems has always surprised me. Not only is 2FA weak in theory, but criminals are already carrying out attacks in industrial levels, with the &#8220;Man-in-the-Browser&#8221; variant being the most problematic.</p>
<p>I&#8217;ve described this attack in my blog post &#8220;2FA is dead&#8221;:<br />
 <a href="http://blog.cronto.com/index.php?c=1&#038;more=1&#038;pb=1&#038;tb=1&#038;title=2fa_is_dead" rel="nofollow ugc">http://blog.cronto.com/index.php?c=1&#038;more=1&#038;pb=1&#038;tb=1&#038;title=2fa_is_dead</a></p>
<p>I wholeheartedly agree with Bruce&#8217;s conclusion that transaction authentication is the way to go. My post also  discusses how the Cronto visual transaction signing system can defeat such attacks. For further details, see:<br />
 <a href="http://www.cronto.com/visual_cryptogram.htm" rel="nofollow ugc">http://www.cronto.com/visual_cryptogram.htm</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121206">

			<div class="comment by-casey ">

				<p class="commentcredit">

					<span class="commenter">casey</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121206">
						September 22, 2009 1:35 PM					</a>

				</p>

				<p>One bank I use has an image that is chosen by me when I created the online account.  If that image is not on the login page, I know that something is wrong.  I am still suceptible to the second attack.</p>
<p>The real question is who is getting ripped off- me or the bank? Who&#8217;s job is it to protect the money?  I could be wrong, but I thought I hired the bank to do this specific task.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121207">

			<div class="comment by-nosuchthingasidentitytheft ">

				<p class="commentcredit">

					<span class="commenter">NoSuchThingAsIdentityTheft</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121207">
						September 22, 2009 2:37 PM					</a>

				</p>

				<p>&#8220;Credit cards are a perfect example. Notice how little attention is paid to cardholder authentication. Clerks barely check signatures. People use their cards over the phone and on the Internet, where the card&#8217;s existence isn&#8217;t even verified. The credit card companies spend their security dollar authenticating the transaction, not the cardholder.&#8221;</p>
<p>When comparing credit card and bank account transaction authentication, you have to think about what is being authenticated and to who&#8217;s benefit.</p>
<p>Credit card transaction authentication is really for the benefit of the Merchant. When the Merchant authenticates a transaction, they are doing it to ensure they will get paid (i.e. the credit card account is valid and there is enough credit on the account to pay for the transaction). Nothing in the online transaction authentication (i.e. verifone) actually verifies that the real cardholder is authorizing the transaction.</p>
<p>On the other hand, bank account transaction authentication is for the benefit of the account holder. When the account holder authenticates a transaction they are doing so to identify themselves as the real account holder and to authorize the transfer the requested funds.</p>
<p>So, Credit card transaction authentication is more about ensuring the funds exist than it is about ensuring the real cardholder authorizes the transaction. Whereas, bank account transaction authentication is more about ensuring the real account holder is authorizing the transaction than it is about ensuring the funds exist in the account.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121208">

			<div class="comment by-maneesh ">

				<p class="commentcredit">

					<span class="commenter">Maneesh</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121208">
						September 22, 2009 2:56 PM					</a>

				</p>

				<p>I don&#8217;t see &#8216;Man in the Middle&#8217; and &#8216;Trojans&#8217; as failures of 2 factor Authentication.  These are different problems that need to be dealt separately.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121209">

			<div class="comment by-jeffrey ">

				<p class="commentcredit">

					<span class="commenter">Jeffrey</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121209">
						September 22, 2009 3:25 PM					</a>

				</p>

				<pre><code> I use the IronKey's Secure Sessions service to secure my personal transactions.  Using their DNS service (which is ran through their Secure Sessions SSL connection) they attempt to authenticate and verify the authenticity of the connection (checking for malicious activities) before allowing your secure connection to be made to the final destination website.
</code></pre>
<p><a href="https://www.ironkey.com/personal-solutions" rel="nofollow ugc">https://www.ironkey.com/personal-solutions</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121210">

			<div class="comment by-wouter-verhelst ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://wo.uter.be' rel='external nofollow ugc' class='url'>Wouter Verhelst</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121210">
						September 22, 2009 5:12 PM					</a>

				</p>

				<p>@ricky bobby: &#8220;authenticating the transaction&#8221; means having the user review the transaction, and sign that actual data to the bank.</p>
<p>For instance, on my bank, when I want to transfer money to an account that is not either the bank account of a large company, or already in my list of bank account numbers that I often transfer money to, then I have to enter the bank account number and the amount of money that I want to transfer into my digipass, which then generates a cryptographic signature.</p>
<p>Of course the security of the whole thing hinges on the security of the digipass (the algorithms of which are not public), but the principle seems sound.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121211">

			<div class="comment by-lionell-pack ">

				<p class="commentcredit">

					<span class="commenter">Lionell Pack</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121211">
						September 22, 2009 5:29 PM					</a>

				</p>

				<p>I tend to agree with Bruce: two-factor authentication over one channel is now easily reducible by fraudsters to the equivalent of one-factor.</p>
<p>I prefer the term &#8220;Two Channel Encryption&#8221;, but even then there&#8217;s exactly the caveat Bruce mentioned: if you use both channels to authenticate the PERSON, you haven&#8217;t added anything.</p>
<p>In the web-banking/SMS model, the website password authenticates the person. The transaction DETAILS are then sent over a different channel, along with a one-time password. This puts the onus on the user to authenticate the transaction, but still achieves the goal: to authenticate both the person AND the transaction.</p>
<p>The difficulty of simultaneously compromising a person&#8217;s web access AND their SMS receiver is orders of magnitude greater than the difficulty of compromising one.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121212">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121212">
						September 22, 2009 5:50 PM					</a>

				</p>

				<p>@ Gert,</p>
<p>&#8220;which usually mean that the user needs to be fool into entering his complete password on a site for an login to be practical&#8230;&#8221;</p>
<p>Unfortunatly not&#8230;</p>
<p>As you note,</p>
<p>&#8220;Successful attacks have been done using phone company employees&#8230;&#8221;</p>
<p>Which means that all previous SMS&#8217;s etc are available via the employees as well.</p>
<p>If the bank uses a predictable way of making the choice for the &#8220;4 random characters from a password&#8221; then potentialy the password can be &#8216;reconstructed&#8217; from the previous messages etc.</p>
<p>Cryptographicaly reconstructing a password is one of the oldest techneiques around and is a known problem to the attackers.</p>
<p>However I suspect that it is an unknown art to the average bank code cutter.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121215">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121215">
						September 22, 2009 6:40 PM					</a>

				</p>

				<p>@ Steven Murdoch,</p>
<p>&#8220;the Cronto visual transaction signing system can defeat such attacks.&#8221;</p>
<p>Did you fix that side channel issue I highlighted 16 months ago?</p>
<p><a href="http://www.lightbluetouchpaper.org/2008/04/09/new-banking-code-shifts-more-liability-to-customers/" rel="nofollow ugc">http://www.lightbluetouchpaper.org/2008/04/09/new-banking-code-shifts-more-liability-to-customers/</a></p>
<p>@ All</p>
<p>Bruce has bloged on this back in 2007,</p>
<p><a href="http://www.schneier.com/blog/archives/2007/05/interesting_spo.html#c176007" rel="nofollow ugc">http://www.schneier.com/blog/archives/2007/05/interesting_spo.html#c176007</a></p>
<p>And you will see I made a prediction&#8230;</p>
<p>Yes folks my balls are crystal not brass so please treat acordingly 8)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121216">

			<div class="comment by-jonathan-newnham ">

				<p class="commentcredit">

					<span class="commenter">Jonathan Newnham</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121216">
						September 22, 2009 7:27 PM					</a>

				</p>

				<p>My bank (in Australia) gets around this in what I think is an obvious way:</p>
<p>I attempt to make a transaction online. The bank sends an SMS with a confirmation code. I enter the confirmation code online.</p>
<p>No trojan will help an attacker, they have to have access to the SMS somehow (still possible but much harder).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121217">

			<div class="comment by-dbcooper ">

				<p class="commentcredit">

					<span class="commenter">dbCooper</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121217">
						September 22, 2009 10:18 PM					</a>

				</p>

				<p>I will never be susceptible to any of these MTM, phish, trojan, authentication, authorization problems.  Why?  I pay cash or with a cashiers check, for everything.</p>
<p>The tellers at my bank know my name and the names of my dogs.  On-line banking and plastic cards for debits/credits, what is the benefit?  I have never ascertained any.</p>
<p>If one wants to learn a secure way to move money using electrons or photons, explore the methods used in bank to bank transactions.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121218">

			<div class="comment by-daniel-miessler ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://danielmiessler.com' rel='external nofollow ugc' class='url'>Daniel Miessler</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121218">
						September 23, 2009 12:33 AM					</a>

				</p>

				<p>Let&#8217;s agree that having your two-factor authentication stolen in real-time by an advanced attack is bad. Yes. Granted. Fair enough.</p>
<p>But can&#8217;t we also agree that having a standard username and password stolen and then sold or used MULTIPLE TIMES is far worse?</p>
<p>I think you&#8217;re guilty here of letting the best be the enemy of the good.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121219">

			<div class="comment by-prasanna-s-bidare ">

				<p class="commentcredit">

					<span class="commenter">Prasanna S Bidare</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121219">
						September 23, 2009 3:44 AM					</a>

				</p>

				<p>Firstly, It proved beyond that signal factor is not sufficient.</p>
<p>While, doing 2FA one needs to pay attention to do Two way authentication also. Of course with a dynamic process.</p>
<p>On line non repudiation taking all transaction factors into consideration into mind.</p>
<p>With the use of Mobile connectivity and Mobile handsets as a second true factor, the transaction trace is better.</p>
<p>Balanced secured Eco, training to users and use of mobile infrastructure could be a solution to look for.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121220">

			<div class="comment by-yogi ">

				<p class="commentcredit">

					<span class="commenter">Yogi</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121220">
						September 23, 2009 5:33 AM					</a>

				</p>

				<p>Is there a known solution for MITM?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121221">

			<div class="comment by-hwkeitel ">

				<p class="commentcredit">

					<span class="commenter">hwKeitel</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121221">
						September 23, 2009 6:52 AM					</a>

				</p>

				<p>@igor: my bank calls it mTAN (mobile)</p>
<p>it&#8217;s important, that the TAN changes if the transaction details change. like the account#. but i think i read something about attacking this type of TANs.<br />
also, eavesdropping your transactions by reading your messages is possible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121222">

			<div class="comment by-ricky-bobby ">

				<p class="commentcredit">

					<span class="commenter">Ricky Bobby</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121222">
						September 23, 2009 6:55 AM					</a>

				</p>

				<p>Here is the issue with this argument.</p>
<p>We can say everything is broken and useless, since nothing is ever 100% secure.  We just do the best we can, just because a MITM or Trojan can beat a technology does not mean its useless.</p>
<p>The If game is always present.  Two factor authentication can be beat if a MITM exists.  Locks can be beat if picked. The bank sends an SMS, if someone has stolen your phone this gets beat.We have security guards at my doors at work, if ninjas attack they will win.</p>
<p>So, should we not do anything, because an IF always exists? No</p>
<p>Just understand the risk.</p>
<p>I believe the risk is low that someone will MITM or Trojan real time any 2 factor authentication, so I see no issues.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121223">

			<div class="comment by-nosuchthingasidentitytheft ">

				<p class="commentcredit">

					<span class="commenter">NoSuchThingAsIdentityTheft</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121223">
						September 23, 2009 9:05 AM					</a>

				</p>

				<p>@Yogi<br />
&#8220;Is there a known solution for MITM?&#8221;</p>
<p>YES! It is called SSL. The SSL protocol was designed to prevent MITM attacks through the use of server side authentication.</p>
<p>Unfortunately, the problem we have today is that the greedy CAs (and name service companies) detroyed any meaning of trust in the SSL server certificates used to establish SSL server authentication.</p>
<p>When SSL was first introduced, the CAs all issued highly vetted SSL server certs. Getting an SSL server certificate actually meant something (aka trust), it took a reasonable period of time (about a week or so) for the CA to perform a proper background check on the company requesting the SSL server cert (the CA required evidence like DUNS numbers and letters from company officers, and actually investigated these before issuing an SSL server cert).</p>
<p>Today, to get an SSL server cert, the CAs don&#8217;t do any checking at all (aka no trust), all one needs is a bogus email address and a bogus domain name (which the name service companies are happy to hand out, even with a stolen credit card, no checks or waiting periods, and no checks that the domain name requested is just a simple misspelling of a national brand), they don&#8217;t care, they just want your money (aka greed).</p>
<p>The good news is that the CAs are at least starting to &#8220;get it&#8221; (although it may be too late), that issuing SSL server certs is about trust not just them making money. The CAs have started to issue EV SSL server certs, which seem to be going back to the original model of actually vetting the company requesting the SSL server cert to attempt to establish a level of trust.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121224">

			<div class="comment by-cgomez ">

				<p class="commentcredit">

					<span class="commenter">Cgomez</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121224">
						September 23, 2009 9:07 AM					</a>

				</p>

				<p>Considering every time there has been fraud on any bank or credit account I own, it is remedied with either</p>
<p>a) a phone call TO ME by the bank verifying the bogus purchase<br />
b) a phone call made BY ME to the bank to say &#8220;what the heck is this?&#8221;</p>
<p>and is remedied within 1 hour&#8230;</p>
<p>I&#8217;d say we are protected just fine.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121225">

			<div class="comment by-bangya ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.hackitfor.me' rel='external nofollow ugc' class='url'>BangYa</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121225">
						September 23, 2009 9:54 AM					</a>

				</p>

				<p>SSL is not 100% dont be drinking the kool-aid.  While two factor authentication does have its faults, it does add an additional layer of security.  To truly secure a system, you need to use a defense in depth, because there will always eventually be a way in.<br />
Phone call wont work either, I have done work with numerous financial institutions, and have had a 100% success rate on compromising their customers accounts.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121226">

			<div class="comment by-steven-murdoch ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.cronto.com/' rel='external nofollow ugc' class='url'>Steven Murdoch</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121226">
						September 23, 2009 10:36 AM					</a>

				</p>

				<p>@Clive Robinson</p>
<p>Which particular side-channel issue are you referring to? There were a few comments from you in that post, but I&#8217;m not sure which one you meant.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121227">

			<div class="comment by-james-r-grinter ">

				<p class="commentcredit">

					<span class="commenter">James R Grinter</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121227">
						September 23, 2009 10:50 AM					</a>

				</p>

				<p>Oh yes, credit card companies know all about authenticating transactions rather than people.</p>
<p>&#8220;Hi, this is the security department at CreditCo limited. First I need to be sure I&#8217;m talking to you, Mr Customer. Can I have the first and third digits of your PIN, please?&#8221;</p>
<p>[Fail.]</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121228">

			<div class="comment by-jimfive ">

				<p class="commentcredit">

					<span class="commenter">JimFive</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121228">
						September 23, 2009 11:05 AM					</a>

				</p>

				<p>It seems to me that what this highlights is that when you move into the digital realm, things that look like two factor authentication, really aren&#8217;t.  A SecureID type fob, even though it&#8217;s on your key chain, isn&#8217;t really &#8220;something you have&#8221;.  That number on the fob is a special case of &#8220;something you know that changes a lot&#8221;.</p>
<p>In the physical world the &#8220;know/have/are&#8221; authenticators are verified by a person.  You are seen to know the code, have the key and match the photo, by a person.</p>
<h2>In the digital realm those authenticators are all verified in the same way, by being turned into &#8220;things you know&#8221; and transmitted over the network.  Which breaks the entire multi-factor protocol.</h2>
<p>JimFive</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121229">

			<div class="comment by-janitha-karunaratne ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.janitha.com' rel='external nofollow ugc' class='url'>Janitha Karunaratne</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121229">
						September 23, 2009 1:07 PM					</a>

				</p>

				<p>I see one possible solution to this using the current computer&#8217;s address.</p>
<ul>
<li>Username/Password as usual<br />
** 1. Server Sends Challenge (Unique to the user&#8217;s IP which he used username/password) through SMS for example<br />
** 2. User computes Response (Challenge + OneTimePassword),<br />
** 3. User Sends Response. </li>
</ul>
<p>The server would limit the session just to that address.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121230">

			<div class="comment by-steve-neville ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.linkedin.com/profile?viewProfile=&#038;key=1306039&#038;locale=en_US&#038;trk=tab_pro' rel='external nofollow ugc' class='url'>Steve Neville</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121230">
						September 23, 2009 2:21 PM					</a>

				</p>

				<p>Like many of the commenters on this post, I think that Bruce has missed the fundamental concept of dealing with security in a layered fashion. Can 2nd factor authentication be defeated?</p>
<p>Absolutely&#8230;but only with the right attacks (there are many variants).</p>
<p>Does it mean that we should &#8216;throw the baby out with the bath water&#8217;?? No!</p>
<p>The concept of layered security provides a tremendous opportunity to address a wide range of attacks, including MITM and trojans (sometimes referred to these days as Man-in-the-browser attacks). I believe organizations need to look at the problem more holistically though, considering the following:<br />
1) Defense in depth&#8211;a single solution will not solve the problem<br />
2) Impact on the customer experience&#8211;you can&#8217;t make things too difficult for end users or they will simply take other (more expensive!) paths<br />
3) Ability to react to future attacks&#8211;you need to be able to evolve&#8230;fraudsters are not standing still, that&#8217;s for sure<br />
4) Flexibility of solutions chosen&#8211;it&#8217;s important that you can deal with multiple user communities<br />
5) Affordability&#8230;it does come down to this at some point!</p>
<p>Considering these points, organizations should consider a layered strategy to address these attacks include deploying security capabilities like:<br />
1) EV SSL, which provides a higher level of confidence to end users that they are on the right web site<br />
2) Strong authentication, including tokens, out-of-band OTPs, digital certificates on smart cards, and others. This can include transaction authentication as well, but I would submit that usability will be key here&#8230;having users entering a lot of numbers/text in a small device is destined for failure!<br />
3) Fraud detection to transparently monitor online activities and help block fraudulent transactions. Examples: being able to detect that transactions are happening in rapid succession or having traits in the communication to the site that indicate a trojan.</p>
<p>We do have the ability to defend against these attacks&#8230;and it&#8217;s not through a single solution! But strong authentication definitely has a role to play!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121231">

			<div class="comment by-darren ">

				<p class="commentcredit">

					<span class="commenter">Darren</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121231">
						September 24, 2009 2:48 AM					</a>

				</p>

				<p>The SMS backchannel seems to be a fairly strong compromise, but there have been cases of identity theft where the attacker could use the mark&#8217;s credentials to transfer their telephone number.</p>
<p>Having stolen bank login credentials previously, the attacker simply transfers all the money to a mule and it&#8217;s done with before the mark has put 1+1 together.</p>
<p>PIN dual-factor and SMS backchannel is probably as strong as you can get with the untrustworthy internet.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121232">

			<div class="comment by-yogi ">

				<p class="commentcredit">

					<span class="commenter">Yogi</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121232">
						September 24, 2009 3:55 AM					</a>

				</p>

				<p>@NoSuchThingAsIdentityTheft</p>
<p>Ya i have read about SSL, however my query is if somehow an MITM were to change the certificate before the SSL handshake were to happen between the client and the server, currently is there a solution that can mitigate this attack?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121233">

			<div class="comment by-tom ">

				<p class="commentcredit">

					<span class="commenter">Tom</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121233">
						September 24, 2009 6:41 AM					</a>

				</p>

				<p>Natwest do this (authenticate the transaction) to an extent.<br />
Initial logon is customer number and then random characters from a pin (different to your atm pin) and password.</p>
<p>Any transactions to a NEW payee then have to be authenticated via a card reader that reads your chip and pin card, prompts for your pin and then issues a one time passcode.</p>
<p>Once the payee has been set up you do not need to use a one time password for further payments to that payee.</p>
<p>I imagine it works very effectively for them, reducing fraud with little over head for a cheap plastic card reader.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121235">

			<div class="comment by-nosuchthingasidentitytheft ">

				<p class="commentcredit">

					<span class="commenter">NoSuchThingAsIdentityTheft</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121235">
						September 24, 2009 9:24 AM					</a>

				</p>

				<p>@Yogi<br />
&#8220;&#8230;if somehow an MITM were to change the certificate before the SSL handshake were to happen between the client and the server&#8230;&#8221;</p>
<p>I am not sure I understand your question. The SSL server certificate is what tells the client they are connected to the real bank web server. If a MITM forces the client to a bogus web server (with a bogus look-a-like domain) which provides a bogus SSL server cert, then the client would easily be able to detect this to know they are not connected to the real bank website when they verify the SSL server certificate. This is the server authentication part of SSL that specifically prevents MITM attacks.</p>
<p>Keep in mind that the SSL server certificate is simply a container for the server&#8217;s PKI public key, provides identifying info, and is digitally signed by the CA (who is attesting to the validity of the identity and that the identity is in possession of the PKI private key).</p>
<p>Now, if you are asking if a CA would ever allow the creation of (and digitally sign) a SSL server certificate for a bogus web server (and bogus domain name) that would be similar enough to a real bank&#8217;s domain and SSL server certificate so that it could fool a non-vigilant bank customer? Then I would say yes, it could happen. In this case the problem is not SSL server auth, but the greedy CAs which would allow the creation of such bogus SSL server certs with bogus identities and domain names.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121236">

			<div class="comment by-ian-eiloart ">

				<p class="commentcredit">

					<span class="commenter">Ian Eiloart</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121236">
						September 24, 2009 10:57 AM					</a>

				</p>

				<p>Bruce, can you explain what you mean by &#8220;authenticate the transaction&#8221;, please? I&#8217;ve seen you use the term several times, but have no idea what it means. Can you give an example of a measure that can be used?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-121237">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121237">
						September 24, 2009 3:42 PM					</a>

				</p>

				<p>&#8220;Bruce, can you explain what you mean by &#8220;authenticate the transaction&#8221;, please? I&#8217;ve seen you use the term several times, but have no idea what it means. Can you give an example of a measure that can be used?&#8221;</p>
<p>Sure.  Think of credit cards.  For all the identity authentication schemes built into the system, no one really bothers with them.  Few merchants look at signatures.  And you can use credit cards to buy things over the phone &#8212; no authentication at all.</p>
<p>What credit card companies do is authenticate transactions.  They know what sorts of things people do when they steal credit cards.  They know what normal spending patterns look like.  When a transaction is fishy, they block it.  Sometimes they call the cardholder &#8212; this happened to me a couple of weeks ago &#8212; and sometimes they just cancel the card.</p>
<p>How would this look with electronic banking?  I don&#8217;t know, really.  Maybe the accountholder would get a phone call if he tried to transfer his entire bank balance to Romania.  That would be nice.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier odd alt thread-odd thread-alt depth-1" id="comment-121238">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121238">
						September 24, 2009 3:44 PM					</a>

				</p>

				<p>&#8220;Is there a known solution for MITM?&#8221;</p>
<p>Dealing with MITM is easy, but requires authentication on both sides.</p>
<p>The AT&amp;T TSD (remember the Clipper phone?) would display a code &#8212; I forget if it was two- or four-character &#8212; on each phone when the pair went secure.  The people talking were supposed to verify that they had the same code on their phones.  If the code was different, there was a MITM attack going on.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-schneier even thread-even depth-1" id="comment-121239">

			<div class="comment by-bruce-schneier official">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.schneier.com/blog' rel='external nofollow ugc' class='url'>Bruce Schneier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121239">
						September 24, 2009 3:51 PM					</a>

				</p>

				<p>&#8220;We do have the ability to defend against these attacks&#8230;and it&#8217;s not through a single solution! But strong authentication definitely has a role to play!&#8221;</p>
<p>Of course. And if we had infinite money, infinite time, infinite patience, etc., we would implement lots of partial solutions.  But we don&#8217;t, and the question is what security measures actually give us value for our time, patience, and money.</p>
<p>A security measure that forces the attackers to make a change in their tactics without actually reducing fraud is, in my opinion, not terribly useful.  (Of course, those who implement two-factor authentication will see a temporary reduction in fraud, as attackers shift their attacks to banks who have not implemented the technology.  But when the technology is everywhere, the attackers will just shift their tactics.)  I&#8217;d rather see security countermeasures that actually reduce fraud instead of move it around.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121240">

			<div class="comment by-terry-thomas ">

				<p class="commentcredit">

					<span class="commenter">Terry Thomas</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121240">
						September 24, 2009 5:55 PM					</a>

				</p>

				<p>@MathFox:</p>
<p>Some hardware devices for the users have been reported to have problems.</p>
<p><a href="http://www.lightbluetouchpaper.org/2009/02/26/optimised-to-fail-card-readers-for-online-banking/" rel="nofollow ugc">http://www.lightbluetouchpaper.org/2009/02/26/optimised-to-fail-card-readers-for-online-banking/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121241">

			<div class="comment by-william ">

				<p class="commentcredit">

					<span class="commenter">William</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121241">
						September 25, 2009 2:17 AM					</a>

				</p>

				<p>A couple things this article does not clarify:</p>
<ol>
<li>A man-in-the-middle attack meant to compromise two-factor authentication is a very specific attack.  The fraud/phishing scam targets very specific users and must automatically pass through all authentication credentials.  This is a costly and time-consuming effort for the criminal that provides less rewards, oftentimes, than a general phishing attack against a large user base (like phishing against Paypal).</li>
<li>Trojan attack described here has a lot of the same features as a man-in-the-middle attack.  For it to be effective as noted in this article, the trojan must be specially crafted for a specific banking or ecommerce site in order to piggyback on the session and begin performing transactions.  Again &#8211; a much smaller group of victims available through this method.  The trojan must recognize a user logging onto a site, must recognize &#8220;authorized&#8221; status, must recognize a session, and must know how to interact with the application.</li>
</ol>
<p>The premise of this article is that NO authentication method is strong enough because these attack vectors don&#8217;t care what authentication steps occur.</p>
<p>I don&#8217;t buy it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121242">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121242">
						September 25, 2009 5:18 AM					</a>

				</p>

				<p>@ William,</p>
<p>&#8220;The premise of this article is that NO authentication method is strong enough because these attack vectors don&#8217;t care what authentication steps occur.&#8221;</p>
<p>I disagree to me the premise of the artical is that the authentication is applied in the wrong way and has been demonstrated to have been defeated by various attackers.</p>
<p>The old CIA triad (Conf/Integ/Auth) is the usual argument, however it has a hidden assumption which is &#8220;trust&#8221;.</p>
<p>&#8220;Security trust&#8221; is effectivly the opposit of &#8220;human trust&#8221; for various reasons, however it is fairly clear that no user PC can be trusted for a whole host of reasons (and for that matter neither can the banks computers or most of their security moduls).</p>
<p>For authentication of any kind to work you have to have a communications path where the &#8220;end points&#8221; can be trusted at &#8220;all times&#8221;.</p>
<p>There are two issues with this, the first and most difficult to deal with is establishing the &#8220;trusted end points&#8221;. This is because DLL &#8220;Shims&#8221; etc are between the users eyeball and the application and therefore can do an &#8220;end run&#8221; around the application.</p>
<p>Secondly, the majority of systems currently out there only authenticate the setup of the communications path, and assume incorrectly that the authentication will remain good for the entire communications. A MITM attack can decide when and what to pass through or change.</p>
<p>When a &#8220;shim&#8221; and MITM attack are combined it is game over unless you,</p>
<p>1, Extend the communications end point beyond the reach of the attacker.</p>
<p>2, Ensure all the critical parts of the communication are fully authenticated.</p>
<p>Problem 2 means, that it is the &#8220;transaction&#8221; that must be fully authenticated not just the comms setup.</p>
<p>Problem 1 is a little more subtal due to side channal attacks. It requires a cryptographicaly secure method by which the user is included in the trusted path in a way in which the trust cannot be attacked.</p>
<p>The simplest way is to have an external device that cannot be tampered with that the user has to authenticate too to use (a pin and smart card are the ATM way of doing it).</p>
<p>When a critical &#8220;transaction&#8221; is to take place the user has to work through the token on the out bound (to bank) and in bound (from bank) communications.</p>
<p>Importantly the communications must go through the &#8220;user&#8221; in a secure, verifiable and auditable way (unlike an ATM).</p>
<p>The technology exists to do all of this but few if any organisations get even close to the required level of security.</p>
<p>I&#8217;m against the use of mobile phones for a couple of reasons,</p>
<p>1, They are not reliable technology.</p>
<p>2, They are not secure.</p>
<p>That is they may or may not offer a secondary comms channel depending on the phone cell coverage and number of inuse phones in the cell.</p>
<p>And as has been seen on a number of occasions not just the phones but the networks have been subject to succesfull attack.</p>
<p>Oh and a third reason arrises,</p>
<p>How do you know that the user is not &#8220;browsing the web&#8221; from the phone?</p>
<p>If they are then realisticaly there is no &#8220;independent second channel&#8221;&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121243">

			<div class="comment by-alinda ">

				<p class="commentcredit">

					<span class="commenter">Alinda</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121243">
						October 2, 2009 7:26 AM					</a>

				</p>

				<p>If the phone requires no network coverage or connectivity at all when generating an OTP, then it can realistically be regarded as an independant second channel, like <a href="http://www.fivebargate.net/" rel="nofollow ugc">http://www.fivebargate.net/</a> for example.  Moveover, such a solution can be used to authenticate each and every transaction without data overhead or SMS costs etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121244">

			<div class="comment by-eric-d ">

				<p class="commentcredit">

					<span class="commenter">Eric D</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121244">
						October 15, 2009 9:15 AM					</a>

				</p>

				<p>Most Belgian banks are already authenticating the transactions. It works pretty well but there were some thefts already.</p>
<p>How the system works:<br />
You get a Digipass device (<a href="http://www.vasco.com/products/digipass/digipass_readers/digipass_800_range/digipass_810.aspx" rel="nofollow ugc">http://www.vasco.com/products/digipass/digipass_readers/digipass_800_range/digipass_810.aspx</a>) where you put your bank card.<br />
At login, the website gives you a number, you type it into the digipass, enter your pin and give the result to the website.<br />
Then, for each transaction, you have to enter your pin, a random number given by the website and the amount of the transaction. That gives you a number to authenticate the transaction.</p>
<p>This means that an attacker has little use of your original login. There was an incident with Dexia bank where a trojan was using the open session of the users to do some transactions, popping up the authentication screen. While most people followed the instructions on screen and therefore signed the fraudulent transactions, it also attracted attention from more paranoid users.</p>
<p>The best attack in that situation would be to hijack the authentication of the actual transactions and to instead preform fraudulent transactions of the same amount. This would probably be discovered within a few days though.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121245">

			<div class="comment by-sherwood-botsford ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://sherwoods-forests.com' rel='external nofollow ugc' class='url'>Sherwood Botsford</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121245">
						October 15, 2009 12:50 PM					</a>

				</p>

				<p>The out of band is not fool proof against a MITM attack:</p>
<p>User logs in to MITM site.<br />
MITM uses credentials to log into BANK.<br />
Transaction proceeds normally.</p>
<p>MITM now has user login.<br />
MITM logs into Bank as user.<br />
MITM finds phone number of user for out of band verification. (This is something that users can change so it should be in their profile.)</p>
<p>User logs into MITM site<br />
MITM logs into BANK as user.<br />
MITM pretends to do transaction.<br />
MITM phones customer.<br />
Customer punches in PIN in response to phone call.</p>
<p>Transaction is not completed.</p>
<p>MITM logs into BANK<br />
MITM changes phone number for call back.<br />
MITM places transaction that drains account.</p>
<p>To protect it the out of band needs to be initiated twice &#8212; once from each end.  E.g. The above fails if the user cannot give his PIN over the phone in answer to a call from the bank, but rather must initiate a call to the bank with the verification code.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121246">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121246">
						October 15, 2009 2:33 PM					</a>

				</p>

				<p>@ Eric D,</p>
<p>&#8220;Most Belgian banks are already authenticating the transactions.&#8221;</p>
<p>Err no, not from what you are saying,</p>
<p>&#8220;Then, for each transaction, you have to enter your pin, a random number given by the website and the amount of the transaction.&#8221;</p>
<p>If what you are saying is correct then all you are authenticating is the amount to be transfered not the whole transaction.</p>
<p>As the &#8220;to which account&#8221; part is not authenticated, there is nothing to stop malware presenting to ou what you think is the right account detail whilst sending an altogether different account number to the bank.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121248">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121248">
						October 15, 2009 2:47 PM					</a>

				</p>

				<p>@ Alinda,</p>
<p>&#8220;If the phone requires no network coverage or connectivity at all when generating an OTP, then it can realistically be regarded as an independant second channel&#8221;</p>
<p>Sorry no it cannot.</p>
<p>The reason being that due to the phone connectivity, and that the phone is mutable you do not know if the application running on the phone is good or bad.</p>
<p>This leaves it potentialy open to attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121249">

			<div class="comment by-chris-drost ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://drostie.org/' rel='external nofollow ugc' class='url'>Chris Drost</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121249">
						October 15, 2009 4:21 PM					</a>

				</p>

				<p>Bruce, I just wanted to comment that this was actually an omission that I recalled from one of your entries last year:</p>
<p><a href="http://www.schneier.com/blog/archives/2008/12/credit_card_wit.html" rel="nofollow ugc">http://www.schneier.com/blog/archives/2008/12/credit_card_wit.html</a></p>
<p>I have a Rabobank account, so I&#8217;ve had to deal with this little PIN device for a while now.</p>
<p>At first I thought, &#8220;Oh, what a great idea! The problem with security is that your computer is not trustworthy because it can run <em>everything</em>, including malware. Why not keep the authentication device separate?&#8221;</p>
<p>But it strikes me more and more that if there was malware on my computer, it could quite possibly manipulate my user-experience anyway, so that the &#8220;You are paying for rent!&#8221; user-experience becomes, on the backend, &#8220;You are donating to the &#8216;Help the Needy Nigerian Criminals&#8217; charity!&#8221;</p>
<p>Of course, I use Kubuntu GNU/Linux, so I&#8217;m not targeted much by those sorts of attacks. But for two-factor to be Done Right, it always seemed to me that your bank needs but to hand you a custom BSD distro on a read-only USB stick, so that you can be sure that the user-interface and SSL components of the transaction are unimpeachable. The second factor isn&#8217;t a secure PIN-device; the second factor is a secure user-interface.</p>
<p>Now, I agree that banks can use transaction-profiling to cut down on the problem considerably. But while profiling might be the most cost-effective solution right now, it also doesn&#8217;t strike me as great. It only works when it&#8217;s cost-effective to tell the criminal transactions apart from the real transactions. What do you do with the transaction, &#8220;Chris sent 200 euros to some Paypal account&#8221;&#8230;? What do you do with a transaction that looks like it was made from a retailer that your bank doesn&#8217;t personally know?</p>
<p>Sure, they&#8217;re no longer stealing your nest egg. But when people start to view these deductions as a minor inconvenience rather than a major problem, the criminal becomes free also to continue stealing from you over long time-scales. With a lot of indifferent people, I imagine they could still earn enough money to fund the transaction-prettifying schemes that could hide them from traffic analysis.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121250">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121250">
						October 16, 2009 2:58 AM					</a>

				</p>

				<p>@ Chris Drost,</p>
<p>&#8220;The second factor isn&#8217;t a secure PIN-device; the second factor is a secure user-interface.&#8221;</p>
<p>Your wrong and right.</p>
<p>The &#8220;PIN-device&#8221; or token needs to authenticate the whole transaction value and account details. Which normaly a &#8220;PIN-device&#8221; does not do.</p>
<p>Therefore it is token that needs the &#8220;secure user-interface&#8221;.</p>
<p>The secure token should be the last item in the communications chain before the user, not the PC which can modify your outbound traffic to the bank or lie to you by changing the information the bank sends befor displaying it.</p>
<p>As I have said in the past,</p>
<p>1, The user needs to authenticate to the token</p>
<p>2, The token needs to authenticate to the bank</p>
<p>3, The bank needs to authenticate to the token</p>
<p>4, The full transaction has to be typed into the token to be &#8220;signed&#8221;</p>
<p>5, The user types the full transaction and signature into the PC and sends it to the bank.</p>
<p>6, The bank evaluates the transaction and signiture and if ok sends back a secure confirmation based on the transaction information.</p>
<p>7, The user types the secure confirmation into the token.</p>
<p>8, The token evaluates the confirmation against the transaction if it is ok the token calculates a secure autherisation based on the secure confirmation which it displays to the user.</p>
<p>9, The user then types the secure authorisation into the PC and sends it to the bank.</p>
<p>10, The bank checks the secure athorisation and onli if valid does the bank carry out the transaction.<br />
Anything less is open to attack.</p>
<p>Importantly the token must work through the user in both directions not directly with the PC otherwise the possability for a covert channel is opened whereby the token can be influanced by malware (which is also the reason why the token should not be an application on a mobile phone or other device that has a communications path other than through the user).</p>
<p>The problem with all this is the user has a lot of typing to do both on the token and on the PC.</p>
<p>However it is a requirment otherwise an attack is possible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121251">

			<div class="comment by-markus-thomas ">

				<p class="commentcredit">

					<span class="commenter">Markus Thomas</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121251">
						October 16, 2009 5:40 AM					</a>

				</p>

				<p>Using my German online banking, I am issued a specific one-time transaction pin via text messaging to my mobile phone. The message states the requested transaction with recipient&#8217;s account number, bank branch code and amount to be transferred.</p>
<p>Of course my mobile phone could be compromised, especially, if I was using a smartphone to do my internet banking and to recieve the text messages. However, if someone had access to my phone and internet banking login without my knowledge, one could easily create &#8220;legitimate&#8221; transactions, which could prove almost impossible to prove fraudulent.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121252">

			<div class="comment by-fullmoon ">

				<p class="commentcredit">

					<span class="commenter">fullmoon</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121252">
						October 16, 2009 11:24 AM					</a>

				</p>

				<p>@Clive Robinson<br />
This sounds like what IBM is doing out Zurich.<br />
They are using a USB device for the second factor.</p>
<p><a href="http://blogs.techrepublic.com.com/security/?p=2492" rel="nofollow ugc">http://blogs.techrepublic.com.com/security/?p=2492</a></p>
<p>Cheers</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121253">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121253">
						October 16, 2009 3:30 PM					</a>

				</p>

				<p>@ fullmoon,</p>
<p>&#8220;This sounds like what IBM is doing out Zurich.<br />
 They are using a USB device for the second factor.&#8221;</p>
<p>I&#8217;ve had a quick look but there is to little info to make a sound judgment.</p>
<p>My main concern is that it is connected via USB to the PC as a USB-MSD.</p>
<p>If there are any weaknesses in the IBM design then the malware on the PC will have a high bandwidth connectivity to the device to exploit it, without the user seeing anything happening.</p>
<p>It&#8217;s an attack vector that is all to likley and I&#8217;m far from confident it could be made &#8220;exploit proof&#8221;.</p>
<p>One reason to be wary is &#8220;how is the device programed&#8221; with the secrets, and are the secrets unique to each device in their entirety or is the SSL key common etc etc.</p>
<p>Likewise I&#8217;m not 100% certain it is going to pull up the transaction details (account sum info etc) reliably. A weakness with the bank end of the software might enable transaction information that the device does not recognise but the bank does (say using a multi octet char set as opposed to the standard HTML ISO char set).</p>
<p>There may be other worries I could come up with after a little more thinking but it would be unfair as the device gives every indication of still being in the final development phases.</p>
<p>However the major advantage is that if it works as advertised then it&#8217;s a single key press.</p>
<p>As I noted above the direct connection is a very real security risk, which ten years ago I decided was one that for security should be avoided. The downside of this choice is a lot of typing on the users behalf and thus a much more limited information capacity.</p>
<p>So the trade off IBM has is a potential attack vector -v- a lot of user typing and less information bandwidth (no guesses which would be prefered by most). The single button also increases reliability and reduces cost so it&#8217;s probably a prefered option to the way I sugest (which is probably best for security).</p>
<p>As for the downside the TechRepublic author noted about needing &#8220;multiple devices&#8221; for multiple accounts, I&#8217;m not realy sure that is a major issue for most people. And if it was IBM could solve it quite simply with a SIM reader to get the critical details off of a bank card.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121254">

			<div class="comment by-shahram-karimian ">

				<p class="commentcredit">

					<span class="commenter">shahram karimian</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121254">
						October 18, 2009 9:44 AM					</a>

				</p>

				<p>@ clive</p>
<p>Excellent ideas. The payment authentication makes a lot of sense but how would that work with the login process?<br />
I agree with Bruce about Time, money and patience.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121255">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121255">
						October 18, 2009 10:31 AM					</a>

				</p>

				<p>@ shahram karimian,</p>
<p>&#8220;but how would that work with the login process?&#8221;</p>
<p>1, The user types in their username on the website and sends it to the bank.</p>
<p>2, The bank sends a chalenge back.</p>
<p>3, The user starts up the token and types their pin in to unlock it and then select the login menu etc.</p>
<p>4, They type in the chalenge from the bank into the token, which displays a response.</p>
<p>5, They type the response into the web page and send it to the bank.</p>
<p>6, The bank processes the response and checks it is valid and sends back an acknowledgement.</p>
<p>7, The user types in the acknowledgment into the token and the token tells the user if the login process has compleated or not.</p>
<p>There are a number of ways the chalange / response / acknowledge can be done and in some cases it can be reduced.</p>
<p>For instance if with public key systems a &#8220;first cut&#8221; system would be,</p>
<p>When the user identifies themselves the bank looks up the users public key in it&#8217;s login database and uses this to encrypt a random number which it then encrypts with the banks private key and sends the result to the user.</p>
<p>The users types it into their token which decrypts it with the banks public key and decrypts the result with the users private key to get the random number back.</p>
<p>The token then does some transform on the random number (that is known to the bank). Then encrypts the result with it&#8217;s private key and encrypts the result with the banks public key and provides it to the user as the response.</p>
<p>The user sends the response to the bank, where there systems decrypt with the banks private key, then the users public key and checks the result is the same as the original random number that has been transformed by the same process. If the result is the same both ends have authenticated to each other.</p>
<p>The ack is just a way for the bank to tell the token it has authenticated to the bank or not as the case may be.</p>
<p>I say it is a &#8220;first cut&#8221; as there are a number of other things you need to do to make it secure but they are not required to explain the principle.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121256">

			<div class="comment by-shahram-karimian ">

				<p class="commentcredit">

					<span class="commenter">shahram karimian</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121256">
						October 18, 2009 11:03 AM					</a>

				</p>

				<p>@ clive</p>
<p>Wouldnt this method be suceptible to a MITM session hijack?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121257">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121257">
						October 18, 2009 2:06 PM					</a>

				</p>

				<p>@ shahram karimian,</p>
<p>&#8220;Wouldnt this method be suceptible to a MITM session hijack?&#8221;</p>
<p>In what way are you thinking it would be affected by passing on an untrusted path?</p>
<p>The user name is needed as the key into the bank database.</p>
<p>It can be sent as plain text or encrypted, if encrypted it would have to come from the token.</p>
<p>Also if encrypted it would need to be different every logon thus it would have a time and random number attached to the username prior to encryption.</p>
<p>In practice I don&#8217;t think encrypting it gains you much compared to the extra work involved.</p>
<p>What the next step does is send a &#8220;ticket&#8221; from the bank in a way only the bank can do (ie via it&#8217;s private key) and the users &#8220;public key&#8221; stored in the banks DB (but not generaly public).</p>
<p>Although a person in the middle could &#8220;unwrap&#8221; the encryption with the banks public key they end up with a ticket that is encrypted with the users public key which is not a lot of use to them.</p>
<p>The users token however can unwrap the ticket from both the banks private key and their public key.</p>
<p>The ticket should be in a format whereby it can be verified by the users token as valid (there are various ways this could be done such as appending a hash etc).</p>
<p>The users token performs some kind of transform to the ticket such as ADD and XOR then MUL mod a prime. This transform is effectivly a shared secret between the users token and the bank.</p>
<p>The users token then puts the response in the verifiable format,  encrypts it using it&#8217;s private key and the banks public key and sends it back.</p>
<p>Providing the transform and the verifiable format are both orthagonal to the public key operation a man in the middle could not (except by chance) manufavture a valid response to the bank.</p>
<p>The bank decrypts via it&#8217;s private key and the users public key and checks not just that the response is correct in the verifiable format, but also that the transform has been correctly carried out.</p>
<p>If it has then the bank can be reasonably certain it is talking to the users token.</p>
<p>It then sends back an ack with a timestamp etc that it encrypts with the users public key and the banks private key.</p>
<p>On decrypting this the users token is likewise reasonably certain that it is talking to the bank.</p>
<p>For the man in the middle to pass himself off as the bank he would have to know both the users &#8220;public key&#8221; and the banks &#8220;private key&#8221; or pass through unchanged the users tokens ID and banks chalenge unmodified. Likeise to pass himself of as the user to the bank he would additionaly have to know the users &#8220;private key&#8221; and transform.</p>
<p>The man in the middle can change and modify other traffic however actual transactions are protected.</p>
<p>If I&#8217;ve missed something let me know and I&#8217;ll check it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121258">

			<div class="comment by-shahram-karimian ">

				<p class="commentcredit">

					<span class="commenter">shahram karimian</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121258">
						October 18, 2009 10:06 PM					</a>

				</p>

				<p>@ clive</p>
<p>So once the token authenticates with the bank (out of band) the user can log in?</p>
<p>What if the attacker does a MITM by getting the username for the session and waiting for the for the user to authenticate via the token and  then logging in instead of the user?</p>
<p>As long as i can share a passwords with another user, MITM is possible. Meaning if i can call you you on the phone and you can give give me your username, password and OTP and i can login from my computer.</p>
<p>Maybe installing an SSL cert on the desktop would stop this attack but whats to stop malware from stealing the key?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121259">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121259">
						October 18, 2009 10:53 PM					</a>

				</p>

				<p>@ shahram karimian,</p>
<p>&#8220;So once the token authenticates with the bank (out of band) the user can log in?&#8221;</p>
<p>No the user has logged into their token (by entering their pin into it and therby weakly authenticating to it).</p>
<p>The users token and the bank are authenticating to each other (strongly).</p>
<p>The user does not actually log into the bank so their pin never gets sent down the wire.</p>
<p>The bank and user private keys are not known (or should not be) to any individual.</p>
<p>Likewise the user does not need to know their public key only the token and the bank need to know that.</p>
<p>And importantly the values for the orthagonal transform is a &#8220;shared secret&#8221; only known to the bank and the token never to the user.</p>
<p>Effectivly the user has not logged into the bank all they have done is establish a chain of authentication,</p>
<p>1, User to token (PIN).<br />
2, Bank to token (chalenge and ack).<br />
3, Token to bank (response)<br />
5, Bank through token to user (Ack).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121260">

			<div class="comment by-dan-deighton ">

				<p class="commentcredit">

					<span class="commenter">Dan Deighton</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121260">
						October 24, 2009 9:22 AM					</a>

				</p>

				<p>Cross-site Request Forgery (CSRF) attacks are another active threat that bypasses two-factor authentication.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121261">

			<div class="comment by-jamey-heary ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.networkworld.com/community/node/31124' rel='external nofollow ugc' class='url'>Jamey Heary</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121261">
						October 24, 2009 4:43 PM					</a>

				</p>

				<p>The effectiveness of two-factor depends on the type used.  For example if you use User based certificates as your second factor and perform mutual authentication then the man-in-the-middle attack is rendered defunct.  A trojan based attack would still be effective when running through its victim host but otherwise would not be able to steal a non-exportable certificate to perform the attack on another host.<br />
<a href="http://www.networkworld.com/community/node/31124" rel="nofollow ugc">http://www.networkworld.com/community/node/31124</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-121262">

			<div class="comment by-shahram-karimian ">

				<p class="commentcredit">

					<span class="commenter">Shahram Karimian</span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121262">
						October 29, 2009 7:45 PM					</a>

				</p>

				<p>Another Trojan: W32.silon</p>
<p><a href="http://www.internetnews.com/security/article.php/3846186/TwoHeaded+Trojan+Targets+Online+Banks.htm" rel="nofollow ugc">http://www.internetnews.com/security/article.php/3846186/TwoHeaded+Trojan+Targets+Online+Banks.htm</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-121263">

			<div class="comment by-glenn ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://cybersecurity-hq.blogspot.com/' rel='external nofollow ugc' class='url'>Glenn</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/#comment-121263">
						July 10, 2014 1:07 PM					</a>

				</p>

				<p>I also agree mutual authentication is a big gap in what is done for most banks. Would we be able to compartmentalize a banking application to prevent and/or perhaps further end-point protection via micro-virtualization such as those being implemented by Bromium ( <a href="http://www.bromium.com/innovations/micro-virtualization.html" rel="nofollow ugc">http://www.bromium.com/innovations/micro-virtualization.html</a>)? I had proposed in a paper I wrote something along these lines to help fight ransomware. My ransomware paper is at <a href="http://cybersecurity-hq.blogspot.com/2014/03/ransomware-challenges-posed-by-cyber.html" rel="nofollow ugc">http://cybersecurity-hq.blogspot.com/2014/03/ransomware-challenges-posed-by-cyber.html</a>.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2009/09/hacking_two-fac.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2009%2F09%2Fhacking_two-fac.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2009/09/hacking_two-fac.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='3036' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2009/09/inferring_frien.html" rel="prev">← Inferring Friendship from Location Data</a>		<a href="https://www.schneier.com/blog/archives/2009/09/quantum_compute.html" rel="next">Quantum Computer Factors the Number 15 →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
