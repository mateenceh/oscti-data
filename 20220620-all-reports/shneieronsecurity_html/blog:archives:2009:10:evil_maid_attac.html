<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>"Evil Maid" Attacks on Encrypted Hard Drives - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; &quot;Evil Maid&quot; Attacks on Encrypted Hard Drives Comments Feed" href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/3093" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=3093' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2009%2F10%2Fevil_maid_attac.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2009%2F10%2Fevil_maid_attac.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-3093 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-3093" class="post-3093 post type-post status-publish format-standard hentry category-uncategorized tag-computer-security tag-encryption tag-hacking tag-malware tag-privacy tag-tpm">

	<div class="article">

		<h2 class="entry">"Evil Maid" Attacks on Encrypted Hard Drives</h2>
		<p>Earlier this month, Joanna Rutkowska <a href="http://theinvisiblethings.blogspot.com/2009/10/evil-maid-goes-after-truecrypt.html">implemented</a> the &#8220;evil maid&#8221; attack against TrueCrypt.  The same kind of attack should work against any whole-disk encryption, including PGP Disk and BitLocker.  Basically, the attack works like this:</p>
<p>Step 1:  Attacker gains access to your shut-down computer and boots it from a separate volume.  The attacker writes a hacked bootloader onto your system, then shuts it down.</p>
<p>Step 2:  You boot your computer using the attacker&#8217;s hacked bootloader, entering your encryption key.  Once the disk is unlocked, the hacked bootloader does its mischief.  It might install malware to capture the key and send it over the Internet somewhere, or store it in some location on the disk to be retrieved later, or whatever.</p>
<p>You can see why it&#8217;s called the &#8220;evil maid&#8221; attack; a likely scenario is that you leave your encrypted computer in your hotel room when you go out to dinner, and the maid sneaks in and installs the hacked bootloader.  The same maid could even sneak back the next night and erase any traces of her actions.</p>
<p>This attack exploits the same basic vulnerability as the &#8220;<a href="http://citp.princeton.edu/memory/">Cold Boot</a>&#8221; attack from last year, and the &#8220;<a href="http://www.stoned-vienna.com/">Stoned Boot</a>&#8221; attack from earlier this year, and there&#8217;s no real defense to this sort of thing.  As soon as you give up physical control of your computer, <a href="http://blogs.zdnet.com/security/?p=4662&#038;tag=nl.e019">all bets are off</a>.</p>
<blockquote><p>Similar hardware-based attacks were among the main reasons why <a href="http://www.crn.com.au/News/155836,safety-first-for-it-executives-in-china.aspx">Symantec&#8217;s CTO Mark Bregman was recently advised</a> by  <em>&#8220;three-letter agencies in the US Government&#8221;</em> to use separate laptop and mobile device when traveling to China, citing potential hardware-based compromise.</p></blockquote>
<p>PGP <a href="http://blog.pgp.com/index.php/2009/10/evil-maid-attack/">sums it up</a> in their blog.</p>
<blockquote><p>No security product on the market today can protect you if the underlying computer has been compromised by malware with root level administrative privileges. That said, there exists well-understood common sense defenses against &#8220;Cold Boot,&#8221; &#8220;Stoned Boot&#8221; &#8220;Evil Maid,&#8221; and many other attacks yet to be named and publicized.</p></blockquote>
<p>The defenses are basically two-factor authentication: a token you don&#8217;t leave in your hotel room for the maid to find and use.  The maid could still corrupt the machine, but it&#8217;s more work than just storing the password for later use.  Putting your data on a thumb drive and taking it with you doesn&#8217;t work; when you return you&#8217;re plugging your thumb into a corrupted machine.</p>
<p>The real defense here is trusted boot, something <a href="http://www.schneier.com/blog/archives/2005/08/trusted_computi.html">Trusted Computing</a> is supposed to enable.  But Trusted Computing has its own problems, which is why we haven&#8217;t seen anything out of Microsoft in the seven-plus years they have been working on it (I wrote <a href="http://www.schneier.com/crypto-gram-0208.html#1">this</a> in 2002 about what they then called Palladium).</p>
<p>In the meantime, people who encrypt their hard drives, or partitions on their hard drives, have to realize that the encryption gives them less protection than they probably believe.  It protects against someone confiscating or stealing their computer and then trying to get at the data.  It does not protect against an attacker who has access to your computer over a period of time during which you use it, too.</p>
<p>EDITED TO ADD (10/23): A few readers have <a href="http://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html#c396831">pointed</a> <a href="http://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html#c396852">out</a> that BitLocker, the one thing that has come out of Microsoft&#8217;s Trusted Computing initiative in the seven-plus years they&#8217;ve been working on it, can prevent these sorts of attacks if the computer has a TPM module, version 1.2 or later, on the motherboard.  (Note: Not all computers do.)  I actually knew that; I just didn&#8217;t remember it.</p>
<p>EDITED TO ADD (11/12):  Peter Kleissner&#8217;s <a href="http://simonhunt.wordpress.com/2009/08/04/truecrypt-vs-peter-kleissner-or-stoned-bootkit-revisited/">Stoned Boot attacks</a> on TrueCrypt.</p>
<p>EDITED TO ADD (12/9):  A similar attack <a href="http://news.zdnet.co.uk/security/0,1000000189,39926434,00.htm">is</a> <a href="http://testlab.sit.fraunhofer.de/downloads/Publications/Attacking_the_BitLocker_Boot_Process_Trust2009.pdf">possible</a> against BitLocker with a TPM.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/computer-security/" rel="tag">computer security</a>, <a href="https://www.schneier.com/tag/encryption/" rel="tag">encryption</a>, <a href="https://www.schneier.com/tag/hacking/" rel="tag">hacking</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/privacy/" rel="tag">privacy</a>, <a href="https://www.schneier.com/tag/tpm/" rel="tag">TPM</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html" rel="bookmark">Posted on October 23, 2009 at 6:43 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html#comments">194 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html" data-title="&quot;Evil Maid&quot; Attacks on Encrypted Hard Drives" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-123555">

			<div class="comment by-yessir ">

				<p class="commentcredit">

					<span class="commenter">YesSir</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123555">
						October 23, 2009 7:04 AM					</a>

				</p>

				<p>The bootloader could also grab the code from the USB token and the password.</p>
<p>Defense: boot from USB drive and hash the bootloader to make sure it hasn&#8217;t changed.</p>
<p>Other &#8216;hotel room attacks&#8217;: hidden camera to capture your password; sound recorder to capture your typing and determine password; once the password is determined, steal the computer.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123556">

			<div class="comment by-richrumble ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://clearsite.sourceforge.net' rel='external nofollow ugc' class='url'>richrumble</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123556">
						October 23, 2009 7:07 AM					</a>

				</p>

				<p>Stoned boot DIDN&#8217;T work that way&#8230; (at first)&#8230; See slide 25 in: <a href="http://www.stoned-vienna.com/downloads/Presentation.pdf" rel="nofollow ugc">http://www.stoned-vienna.com/downloads/Presentation.pdf</a></p>
<p>Stoned was loaded with a running windows system, and must be done with admin level privs. It wrote to the MBR while windows was running, then lies in wait. Which begs the question&#8230; ummm so what? Why not just rootkit the pc if it&#8217;s running already, I don&#8217;t think a bootkit is all that impressive from that perspective. Stoned was dumb&#8230; but now has a live-CD that does the &#8220;evil-maid&#8221; attack.<br />
-rich</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123557">

			<div class="comment by-vasili-bourdo ">

				<p class="commentcredit">

					<span class="commenter">Vasili Bourdo</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123557">
						October 23, 2009 7:18 AM					</a>

				</p>

				<p>Here is idea how to defeat this attack:<br />
1) In BIOS, disable booting from local hard drive, or, even make local hard drive not bootable.<br />
2) Use (preferably write-protected, or even read-only) USB dongle to boot up computer.<br />
This dongle contains some minimalistic kernel with HDD encryption drivers which completely loads into RAM.<br />
3) The kernel proceeds with loading rest of OS from HDD. At this point, USB dongle may be removed and stored in safe place.</p>
<p>I believe, this procedure can be implemented on Linux. At least, Cooperative Linux (www.colinux.org) boots similarly.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123558">

			<div class="comment by-paeniteo ">

				<p class="commentcredit">

					<span class="commenter">Paeniteo</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123558">
						October 23, 2009 7:22 AM					</a>

				</p>

				<p>The core problem is that even with &#8220;full&#8221; disk encryption, a small part (i.e. the bootloader) is unencrypted (and therefore, open to manipulation).</p>
<p>A solution would be to have your bootloader on a thumb drive which you never leave alone.<br />
If the thumb drive does not only contain the bootloader but also some kind of secret, you have two-factor-authentication, too.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123559">

			<div class="comment by-wiredog ">

				<p class="commentcredit">

					<span class="commenter">wiredog</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123559">
						October 23, 2009 7:30 AM					</a>

				</p>

				<p>Another solution is to have the Important Data encrypted on a hidden partition (in &#8220;unallocated&#8221; free space on the disk).  Better yet, a hidden partition on a USB key or SD card.  The card/key is marked &#8220;1 GB&#8221; but is really 2 GB, with only 1 GB allocated.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123560">

			<div class="comment by-doug ">

				<p class="commentcredit">

					<span class="commenter">Doug</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123560">
						October 23, 2009 7:32 AM					</a>

				</p>

				<p>One countermeasure they discuss, that doesn&#8217;t require TPM was (when you return to the room) boot from a USB stick that performs a hash of the bootsector, and other critical parts of the hard drive (e.g. /boot if you&#8217;re running linux) against the known-good to check for modifications.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123561">

			<div class="comment by-phil ">

				<p class="commentcredit">

					<span class="commenter">phil</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123561">
						October 23, 2009 7:36 AM					</a>

				</p>

				<p>Sorry, wiredog. Once your machine is compromised, hidden partitions won&#8217;t help. You&#8217;ll still have to type in the password, and that&#8217;s when the evil program will grab it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123562">

			<div class="comment by-jason ">

				<p class="commentcredit">

					<span class="commenter">Jason!</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123562">
						October 23, 2009 7:37 AM					</a>

				</p>

				<p>My laptop of a decade ago had a BIOS password.  Aside from removing the hard drive and subverting it in a separate computer, it seems a reasonable defense against the whole &#8220;boot the same computer off another volume&#8221; thing.</p>
<p>And if the hard drive comes out that easily, take it with you.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123563">

			<div class="comment by-casey ">

				<p class="commentcredit">

					<span class="commenter">casey</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123563">
						October 23, 2009 7:38 AM					</a>

				</p>

				<p>I understood that FDE was only supposed to be able to protect against theft of the disk outright.  Is someone suggesting that it protects more than that?  I mean, once you log in, you can be compromised many, many ways.</p>
<p>An even more evil maid will hit you over the head after you log in&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123564">

			<div class="comment by-derob ">

				<p class="commentcredit">

					<span class="commenter">Derob</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123564">
						October 23, 2009 7:40 AM					</a>

				</p>

				<p>Some laptops sell with hardware protection. Before these do do <em>anything</em> after power-up you have to key in a numeric code on a small separate keypad.</p>
<p>I have such a laptop, and I use the feature to frustrate casual thieves in the vain hope that if everyone would use such a feature, they would seek different ware to steal. The feature is very easy to use, and the only problem I had with it was that the code I set did not use one of the four keys, which after a year clearly showed.</p>
<p>However it would also fully protect against evil maids, or at least require them to find a complicated workaround.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123565">

			<div class="comment by-go2null ">

				<p class="commentcredit">

					<span class="commenter">Go2Null</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123565">
						October 23, 2009 8:05 AM					</a>

				</p>

				<p>@Vasili Bourdo: Puppy Linux is similar.  Has a CryptPup derivative.</p>
<p>@casey:  LOL.  BTW, Even More Evil Maid &#8211; another Eve 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123566">

			<div class="comment by-stephen ">

				<p class="commentcredit">

					<span class="commenter">Stephen</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123566">
						October 23, 2009 8:10 AM					</a>

				</p>

				<p>Several posts list ways of beating this one attack, but these posters are missing the bigger picture. The &#8220;Evil Maid&#8221; attack could also install a hardware keylogger between the laptop keyboard and laptop. This doesn&#8217;t sound as easy, but I am not sure that installing a reliable custom boot loader is that easy either.</p>
<p>Whole disk encryption protects against simple attacks like theft, or a simple scan by a border agent. Even then there are limits. See the freezing ram attacks. If a dedicated attacker wants access to the data you must maintain positive physical control.</p>
<p>You also need to hope that your physical control is greater then your attackers physical threat. Ultimately all security boils down to who has the most guns.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123567">

			<div class="comment by-guest ">

				<p class="commentcredit">

					<span class="commenter">Guest</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123567">
						October 23, 2009 8:10 AM					</a>

				</p>

				<p>Change GMT zone when boot up. Check time when power on. Make a shot from webcam when boot.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123569">

			<div class="comment by-pdf23ds ">

				<p class="commentcredit">

					<span class="commenter">pdf23ds</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123569">
						October 23, 2009 8:18 AM					</a>

				</p>

				<p>&#8220;Whole disk encryption protects against simple attacks like theft, or a simple scan by a border agent.&#8221;</p>
<p>If a border agent feels like turning you back when you don&#8217;t give up your boot password, it doesn&#8217;t really gain you much.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123570">

			<div class="comment by-paul-renault ">

				<p class="commentcredit">

					<span class="commenter">Paul Renault</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123570">
						October 23, 2009 8:31 AM					</a>

				</p>

				<p>When you install TrueCrypt, it creates a recovery disk/ISO as part of the installation process.  It has an untampered-with copy of the new TrueCrypt boot sector.</p>
<p>If you had to leave your laptop alone somewhere and couldn&#8217;t be 100% sure that it hadn&#8217;t been tampered with, it would be prudent to restore the boot sector from the recovery disk first before you boot from the HDD.  The recovery disk/data could be installed on a secure bootable USB key which never left your side.</p>
<p>Perhaps those nice people who wrote TrueCrypt could create an easy-to-use installer to make a bootable USB recovery disk.</p>
<p>Ideally, someone out there would invent a relatively inexpensive USB key that could be written to, then, following some software-initiated handshaking sequence (say, using some sort of AES-crypto handshaking based on the USB key&#8217;s serial number) would literally destroy the write-enabling circuitry.  This would/could be the USB equivalent of a closed/finalized CD-ROM &#8211; with the TrueCrypt boot sector recovery software installed.</p>
<p>Alternately, the USB&#8217;s write circuitry could be on a breakable tab, which would be removed and destroyed once the key&#8217;s contents had been finalized and tested.  Yes, serial numbers of the write circuitry and the main USB circuitry would have to match.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123571">

			<div class="comment by-dimitris-andrakakis ">

				<p class="commentcredit">

					<span class="commenter">Dimitris Andrakakis</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123571">
						October 23, 2009 8:35 AM					</a>

				</p>

				<p>@Vasili Bourdo, @Doug :</p>
<p>Countermeasures can certainly be found once a specific attack is considered. The problem is that the average user needs a procedure that :</p>
<ol>
<li>Is relatively easy to setup</li>
<li>Is easy and quick to perform on a daily basis</li>
<li>Protects against a wide range of attacks</li>
</ol>
<p>#3 is, more or less, the value of an encrypted hard drive as opposed to, say, an encrypted &#8220;My documents&#8221; (or /home/user, or whatever) folder. And Rutkowska has shown (one of) the limitations of this strategy.</p>
<p>So I would argue that a better solution would not be an encrypted or hash-checked boot loader; but rather an encrypted usb drive containg <em>everything</em> (the OS and the data), that the user can take with him/her.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123572">

			<div class="comment by-jack ">

				<p class="commentcredit">

					<span class="commenter">Jack</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123572">
						October 23, 2009 8:36 AM					</a>

				</p>

				<p>I set up my computers at home with whole disk encryption (not because I need it, but Because It&#8217;s There)</p>
<p>Each computer boots from a USB thumbdrive that contains the kernel and initramfs.</p>
<p>The hard drives are set up with a LUKS partition table. If someone tried to install a bootloader on those drives it would actually overwrite the LUKS data and destroy the encryption keys, making the data competely inaccessable.</p>
<p>If I maintain control of the USB sticks my PCs are not vunerable to this attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123573">

			<div class="comment by-jonadab-the-unsightly-one ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mistersanity.blogspot.com' rel='external nofollow ugc' class='url'>Jonadab the Unsightly One</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123573">
						October 23, 2009 8:36 AM					</a>

				</p>

				<p>Inserting a hardware keylogger between the keyboard and the computer accomplishes the same thing with less fuss.</p>
<p>Perhaps the most important thing to note about this class of attack is that the perpetrator needs <em>unobserved</em> physical access, so he pretty much has to catch you with your guard down, e.g., at home.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123574">

			<div class="comment by-james-bond ">

				<p class="commentcredit">

					<span class="commenter">James Bond</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123574">
						October 23, 2009 8:40 AM					</a>

				</p>

				<p>I&#8217;ve always thought of an evil maid as the kind who would try to kick you with a poison-tipped shoe.</p>
<p>Installing a boot-loader doesn&#8217;t quite seem to make the grade. Naughty perhaps, but not evil.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123575">

			<div class="comment by-trent ">

				<p class="commentcredit">

					<span class="commenter">Trent</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123575">
						October 23, 2009 8:50 AM					</a>

				</p>

				<p>Actually Bitlocker is the only Microsoft product that does support Trusted Computing, and thus (if configured that way) will prevent exactly that attack (different bootloader = TPM won&#8217;t release the Key).<br />
And what used to be called Palladium is going much further than TPMs, it more corresponds to, for example, Intel Trusted Execution Technology.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123576">

			<div class="comment by-ash ">

				<p class="commentcredit">

					<span class="commenter">Ash</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123576">
						October 23, 2009 8:51 AM					</a>

				</p>

				<p>@James Bond: No no no, <em>Naughty</em> maid is something TOTALLY different&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123577">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123577">
						October 23, 2009 8:54 AM					</a>

				</p>

				<p>Reinforces something I&#8217;ve long believed that most people here already know.  As usual, it was not the strength of the encryption that failed, it is the implementation that was exploited.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123578">

			<div class="comment by-calum ">

				<p class="commentcredit">

					<span class="commenter">Calum</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123578">
						October 23, 2009 8:54 AM					</a>

				</p>

				<p>Isn&#8217;t it fairly straightforward to have a script hash the boot partition on boot and flag changes?  Sure, your password is gone but once the evil maid has had physical access she could equally likely have installed an aerial under your bed and be carrying out a TEMPEST attack from the comfort of her own home.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123579">

			<div class="comment by-z80 ">

				<p class="commentcredit">

					<span class="commenter">z80</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123579">
						October 23, 2009 9:00 AM					</a>

				</p>

				<p>Many people point out specific ways of protecting your boot-loader, but they miss the bigger picture. You can for example also modify the machines BIOS or its hardware.<br />
Without physical control <em>all_the_time</em> you have lost the game.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123580">

			<div class="comment by-sothis ">

				<p class="commentcredit">

					<span class="commenter">SoThis</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123580">
						October 23, 2009 9:01 AM					</a>

				</p>

				<p>Or this:</p>
<p>When you create a TrueCrypt volume, it can optionally fingerprint the bootloader, and install an executable on the TC volume that TC will autorun when mounted, that checks the fingerprint.  Since the executable and fingerprint are stored inside the TC volume, they can&#8217;t be altered by this type of attack, and will detect any bootloader or partition table changes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123581">

			<div class="comment by-m ">

				<p class="commentcredit">

					<span class="commenter">M</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123581">
						October 23, 2009 9:04 AM					</a>

				</p>

				<p>Sounds like a great place for a honeypot, or even putting slow-drying superglue on the keys, James. Why, I have this laptop here in the lab that will detonate unless you type in a secret key combination when you open the lid.</p>
<p>James, DON&#8217;T TOUCH THAT LAPT&#8230;&#8230;&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123582">

			<div class="comment by-guest ">

				<p class="commentcredit">

					<span class="commenter">Guest</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123582">
						October 23, 2009 9:06 AM					</a>

				</p>

				<p>The problem, therefore, that your yang sister can do this, no more.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123583">

			<div class="comment by-rob ">

				<p class="commentcredit">

					<span class="commenter">Rob</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123583">
						October 23, 2009 9:09 AM					</a>

				</p>

				<p>What could help also is to leave your computer on, in screensaver lock: If some evil made rebooted your system, she won&#8217;t be able to get back your locked screen, since that would require her to login; this should alarm you that someone may have touched your computer (or the power failed).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123584">

			<div class="comment by-matika ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.fitzenreiter.de/ata/ata_eng.htm' rel='external nofollow ugc' class='url'>matika</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123584">
						October 23, 2009 9:09 AM					</a>

				</p>

				<p>i suggest using the ATA Security Extension to avoid the easy access to the hard drive. i know it has been broken more or less for most hard drives, but still it offers some more hurdles.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123585">

			<div class="comment by-scott-lewis ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.thelewisfour.com' rel='external nofollow ugc' class='url'>Scott Lewis</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123585">
						October 23, 2009 9:11 AM					</a>

				</p>

				<p>Not to dispute the validity of this attack &#8230; but are people really leaving laptops in hotel rooms? Whether or not I need mine, I don&#8217;t leave it in a hotel room out in the open. I have left it in the safe, if the safe is big enough. But if I carried that type of dangerous material, encrypted or not, I might not do that either. Common sense still must prevail!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123586">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123586">
						October 23, 2009 9:12 AM					</a>

				</p>

				<p>The first and most obvious question is,</p>
<p>1) Why have a hard disk?</p>
<p>Then if you have a sufficiently good reason the next question should be,</p>
<p>2) Why should I boot from it?</p>
<p>Providing you don&#8217;t need to and there are plenty of ways to quite easily avoid it then you can &#8220;fully encrypt it&#8221; ie all sectors of all tracks without exception.</p>
<p>This leaves you with the next problem of the flash BIOS. There are ways around this. The first and least practical is to replace the flash chips with pin for pin compatable NV/ROM chips.</p>
<p>However there are other options that &#8220;sort of work&#8221;,</p>
<p>One of which is to write a basic BIOS which only boots a USB or equivalent easily removable device that then contains a boot overlay to a striped down kernel that then checks the BIOS and other semi mutable memory in the system for modifications or changes. If no changes then carry on, any changes then clean it out and re-load the semi mutable memory from the USB device.</p>
<p>Lest you worry you cannot do this there are various projects underway that have done a lot of the work for you.</p>
<p>This leaves the semi mutable memory in the CPU for &#8220;micro code update&#8221; to deal with and this is not an area that most mortals can do much about due to &#8220;code signing&#8221; and other issues on the chip.</p>
<p>The easiest solution to this is use a computer with a CPU that does not have this feature.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123587">

			<div class="comment by-jan-danielsson ">

				<p class="commentcredit">

					<span class="commenter">Jan Danielsson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123587">
						October 23, 2009 9:14 AM					</a>

				</p>

				<p>Hardly worth mentioning. Anyone with half a braincell has figured this out, and find a way to work around it, many years ago.</p>
<p>I&#8217;ve always booted my encrypted system from a USB memory stick (contains a salt, and configures my cryptodevice on top of my harddrive), which switches root from a ramdrive to the encrypted root. No booting occurs from the harddrive. I carry the USB memory stick with me, and I store it separated from the computer whenever I can.</p>
<p>What&#8217;s more interesting is how to defend against the Evil Cook, who installs a new bios chip.</p>
<p>Why doesn&#8217;t the hardware dump a hashvalue of the bios code to the screen and ask &#8220;do you trust this boot code?&#8221; prior to booting? It&#8217;s a simple thing to implement, and would protect against The Evil Cook attack. (As long as you memorize the hash and really check it every time).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123589">

			<div class="comment by-simon ">

				<p class="commentcredit">

					<span class="commenter">Simon</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123589">
						October 23, 2009 9:29 AM					</a>

				</p>

				<p>The Sinowal Trojan is prevalent according to McAfee and rewrites the MBR to gain control of the OS. Each time you reboot, it acquires stronger control. A &#8220;maid&#8221; doesn&#8217;t even have to touch your computer. It will download one of the stealthiest rootkits around and can inject itself into any running process to steal your password. Once this is done all someone has to do is snatch your machine and the data is theirs.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123591">

			<div class="comment by-scott-christiansen ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.linkedin.com/in/scottchristiansen' rel='external nofollow ugc' class='url'>Scott Christiansen</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123591">
						October 23, 2009 9:31 AM					</a>

				</p>

				<p>The TPM option is a nice option.  With it you can lock access to your laptop hard drive via a password (i.e. each time your PC boots you are required to enter a password &#8211; or biometrics &#8211; before the hard drive will be accessible), only after that authentication has been granted is the hardware able to access the data portion of the hard drive.</p>
<p>This also holds true if you take the hard drive out and boot it as a secondary volume.  You are first required to enter the password before any system can spin up and read the data on the drive.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123592">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123592">
						October 23, 2009 9:32 AM					</a>

				</p>

				<p>@ Jonadab the Unsightly One,</p>
<p>&#8220;Inserting a hardware keylogger between the keyboard and the computer accomplishes the same thing with less fuss.&#8221;</p>
<p>Actually there is a quite simple solution for this that works quite well&#8230;</p>
<p>Use one of those rather nice little RF combined keyboards and mouse pads, used for presentations.</p>
<p>A lot of them have the advantage that they will work in parralel with the ordinary keyboard. So you use it to enter your keys and passwords and the ordinary keypad for other activities.</p>
<p>It&#8217;s not perfect and has some disadvantages but it fools a lot of &#8220;wanabe covert operatives&#8221; which covers most LEAs and other three letter agencies and their payroll staff (off book staff are a very different breed of animal).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123593">

			<div class="comment by-davidwr ">

				<p class="commentcredit">

					<span class="commenter">davidwr</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123593">
						October 23, 2009 9:35 AM					</a>

				</p>

				<p>Several obvious and cheap deterrents:</p>
<p>1) leave it turned on with a screen-lock.  If anyone tampers with it, it will be obvious.</p>
<p>2) BIOS boot password</p>
<p>3) Tamper-evident seals over the hard disk to detect removal, and DVD tray, and any other bootable media to detect use.  If the seals are still in place when you come back you are probably okay.</p>
<p>Yes, these and other countermeasures that don&#8217;t involve &#8220;taking part of it with you&#8221; can be defeated by a resourceful opponent but not a run of the mill maid hired to compromise all laptops she encounters.</p>
<p>Personally, I like the idea of a bootloader-dongle mentioned above.  It&#8217;s something that can be made generic and widely and cheaply deployed.  Boot with dongle, enter password, decrypt drive bootloader, continue booting.  With nothing on the disk unencrypted, and the disk not natively bootable, it cuts security risks of theft or loss of 0wnership way down.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123594">

			<div class="comment by-jason ">

				<p class="commentcredit">

					<span class="commenter">Jason</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123594">
						October 23, 2009 9:37 AM					</a>

				</p>

				<p>Echo&#8217;ing what Scott Lewis said, in a way.</p>
<p>My and my wife&#8217;s laptops are locked up in our luggage if we have to leave them in a hotel room.</p>
<p>Granted the locks are easy to break, but that would leave physical evidence that bad things happened.</p>
<p>Someone would have to not only break the lock, but replace it with an identical one before compromising our laptops.</p>
<p>This is not a solution, mind you, just another deterrent.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123595">

			<div class="comment by-brian ">

				<p class="commentcredit">

					<span class="commenter">Brian</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123595">
						October 23, 2009 9:37 AM					</a>

				</p>

				<p>&#8220;[&#8230;] we haven&#8217;t seen anything out of Microsoft in the seven-plus years they have been working on it [&#8230;]&#8221;</p>
<p>You mean, besides BitLocker in TPM mode?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123596">

			<div class="comment by-john-greco ">

				<p class="commentcredit">

					<span class="commenter">john greco</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123596">
						October 23, 2009 9:38 AM					</a>

				</p>

				<p>@Rob</p>
<p>One potential way to get around that (or at least make malice seem more unlikely) is to simulate a power failure.  Unplug the laptop but leave the plug lying nearby as though someone needed to use the outlet for something else (say a vacuum cleaner, in keeping with the maid theme).  Do what you need to do, then leave it turned on and hope the battery drains before the target gets back.</p>
<p>If their computer happens to be configured to suspend or hibernate then it gets more tricky.  What I&#8217;ve don.. err, heard of being done is placing a coat or other random things ontop of the laptop in an inconspicious fasion, then when questioned appologize and insist it must have overheated and shutdown by itself.</p>
<p>All of this is unlikely to work if the target has a reason to be suspicious, but generally it works pretty well against the casual but careful user.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123597">

			<div class="comment by-guest ">

				<p class="commentcredit">

					<span class="commenter">Guest</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123597">
						October 23, 2009 9:38 AM					</a>

				</p>

				<p>Yes, I understand that what doing all of you, is only joke. Thank you, mr. Schneier, you do my life simplest whenever, thanks to all, who say here in English.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123598">

			<div class="comment by-bd ">

				<p class="commentcredit">

					<span class="commenter">BD</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123598">
						October 23, 2009 9:39 AM					</a>

				</p>

				<p>What about just using a lockable laptop case?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123599">

			<div class="comment by-nomen-publicus ">

				<p class="commentcredit">

					<span class="commenter">Nomen Publicus</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123599">
						October 23, 2009 9:39 AM					</a>

				</p>

				<p>Don&#8217;t put your secrets on a laptop, cellphone, pda or anything else you may be carrying around and can be left unattended or taken for &#8220;examination&#8221; by the local authorities.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123600">

			<div class="comment by-kangaroo ">

				<p class="commentcredit">

					<span class="commenter">kangaroo</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123600">
						October 23, 2009 9:40 AM					</a>

				</p>

				<p>vassili: That&#8217;s very easy on linux &#8212; the normal boot procedure (that not all distributions use) is to boot from a boot partition. It&#8217;s normally on the same hd as your root, but that&#8217;s just for ease of use.</p>
<p>The kernel is a mini-root system in a cpio archive plus the kernel itself &#8212; most features in simplified form are available. That filesystem is loaded in a ramdisk. The real root system is the pivoted over that system. Afterwards, the boot partition is entirely unused. I believe I&#8217;ve pulled usb sticks with the boot partition out after booting with no ill effects.</p>
<p>I find it interesting that so many of Schneiers readers, however, find this a practical threat &#8212; for 99% of the world, this is merely theoretical. The Evil Maid, etc, are only threats to folks who are in conflict with organizations that have specifically targeted them for data thievery, and are willing to invest some real cash and personal risk.</p>
<p>Very few CEOs are even in that category. It&#8217;s good to be unimportant &#8212; so much less stressful.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123601">

			<div class="comment by-guest ">

				<p class="commentcredit">

					<span class="commenter">Guest</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123601">
						October 23, 2009 9:41 AM					</a>

				</p>

				<p>@Nomen Publicus:<br />
You forgot say &#8220;don&#8217;t live&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123602">

			<div class="comment by-none ">

				<p class="commentcredit">

					<span class="commenter">none</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123602">
						October 23, 2009 9:41 AM					</a>

				</p>

				<p>We are all booting from an SD card we keep in our wallet next to our credit cards and then mounting the encrypted volume &#8211; aren&#8217;t we?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123603">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123603">
						October 23, 2009 9:43 AM					</a>

				</p>

				<p>@Jan Danielsson: &#8230; &#8220;do you trust this boot code?&#8221; &#8230;.</p>
<p>procedure EVIL<br />
    initialize()<br />
    display previously_good_hash()<br />
    display &#8220;do you trust this boot code?&#8221;<br />
    accept response<br />
    finish booting</p>
<p>After all, <em>what</em> is computing and displaying the hash of the bios code?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123604">

			<div class="comment by-phil ">

				<p class="commentcredit">

					<span class="commenter">Phil</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123604">
						October 23, 2009 9:50 AM					</a>

				</p>

				<p>Guys, these suggestions all beg the issue&#8230;the computer can no longer be trusted once it has been out of your possession.  Period.  No exception. You can come up with all of the USB flash-drive based &#8220;solutions&#8221; that you want, and some clever person with adequate resources will find a way to compromise the computer&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123605">

			<div class="comment by-theo-stevinz ">

				<p class="commentcredit">

					<span class="commenter">theo stevinz</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123605">
						October 23, 2009 9:51 AM					</a>

				</p>

				<p>I carry a  thin removable SSD, my laptop has<br />
huge RAM, processing and programs all through VM&#8217;s, communication is heavy on cultural allegory and nuance like sports.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123606">

			<div class="comment by-john-greco ">

				<p class="commentcredit">

					<span class="commenter">john greco</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123606">
						October 23, 2009 9:51 AM					</a>

				</p>

				<p>@kangaroo</p>
<p>The &#8220;evil maid&#8221; part of this is only an example.  This kind of attack could easily be pulled off by family, friends, or roommates.  It doesn&#8217;t take national budgets and international spy plots to make something like this feasible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123607">

			<div class="comment by-jan-danielsson ">

				<p class="commentcredit">

					<span class="commenter">Jan Danielsson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123607">
						October 23, 2009 9:58 AM					</a>

				</p>

				<p>@John: The hardware. I.e. a non-reprogrammable chip, soldered onto the motherboard. As long as it&#8217;s the first item executing code, and as long as it&#8217;s in a ROM, it&#8217;s an improvement over jumping into the BIOS boot code immediately.</p>
<p>If someone wants to steal my data, they won&#8217;t be removing soldered chips on my motherboard (there are much easier ways to get to my data, with much less risk). Replacing BIOS code, on the other hand, is trivial.</p>
<p>I guess it would require changing how PC&#8217;s boot, but it&#8217;s a very simple change.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123608">

			<div class="comment by-rajan-r-vaswani ">

				<p class="commentcredit">

					<span class="commenter">Rajan R Vaswani</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123608">
						October 23, 2009 9:58 AM					</a>

				</p>

				<p>Why not do a simple boot USB that checks the integrity of your MBR before continuing the boot process?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123609">

			<div class="comment by-sam-wong ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://hellosam.net' rel='external nofollow ugc' class='url'>Sam Wong</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123609">
						October 23, 2009 10:03 AM					</a>

				</p>

				<p>Please&#8230;even if you are in Linux camp, you can&#8217;t omit the biggest feature of BitLocker &#8211; it works with TPM to make sure the boot path is intact. Boot path includes BIOS code, MBR, Boot sector up to the BitLocker decryptor.</p>
<p>So unless the maid do a X-Ray Autospy on the TPM chip to reveal/modify the private key or stored checksum inside, which I doubt can be finished in a few hours, there isn&#8217;t much way to install a mal-bootloader.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123610">

			<div class="comment by-randell-jesup ">

				<p class="commentcredit">

					<span class="commenter">Randell Jesup</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123610">
						October 23, 2009 10:04 AM					</a>

				</p>

				<p>Evil Cook (who changes the BIOS &#8211; no need to replace the chip) is far more dangerous &#8211; they can subvert all these fancy &#8220;boot off write-protected USB&#8221; tricks, even the &#8220;restore the boot record&#8221; tricks.  The BIOS attack is almost as strong as the hardware keylogger, and harder to detect (if you know the BIOS version the person likely has, which if you know the make and brand isn&#8217;t hard).  If you&#8217;re fancy enough, it could in theory even transmit the key over the internet/wifi/etc.</p>
<p>Evil cook would also of course duplicate the harddrive while they&#8217;re at it, so once they have the password they don&#8217;t need access again.</p>
<p>Evil cook could also leave it so an attacker could remotely trigger a dump, or have it notice the computer is now in a &#8220;secure&#8221; domain and grab stuff to be dumped later.</p>
<p>Etc, etc.</p>
<p>The closest we&#8217;ve come to &#8220;secure boot&#8221; is the XBox 360, if for no other reason than the number of resources and mindpower devoted to breaking it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123611">

			<div class="comment by-kevinm ">

				<p class="commentcredit">

					<span class="commenter">kevinm</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123611">
						October 23, 2009 10:09 AM					</a>

				</p>

				<p>To make such attacks more difficult the BIOS should be password protected and refuse to boot from other media. The disk should be password protected and the BIOS unlocks it when booting. Microsoft do this in the XBOX 360 to prevent tampering with the disk by mounting it in another system. ATA disk passwords are described in <a href="http://en.wikipedia.org/wiki/Parallel_ATA#HDD_Passwords_and_Security" rel="nofollow ugc">http://en.wikipedia.org/wiki/Parallel_ATA#HDD_Passwords_and_Security</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123612">

			<div class="comment by-richard ">

				<p class="commentcredit">

					<span class="commenter">Richard</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123612">
						October 23, 2009 10:11 AM					</a>

				</p>

				<p>Would be interesting to see if rather than a removable USB key, one could use the PIV identity or other chip card, provided of course you take it with you when you leave.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123614">

			<div class="comment by-m ">

				<p class="commentcredit">

					<span class="commenter">M</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123614">
						October 23, 2009 10:13 AM					</a>

				</p>

				<p>@Clive Robinson</p>
<p>Are you really suggesting that it&#8217;s a good way to keep the most sensitive information you have, your key/passphrase, more secure by <em>sending it over the air</em>?!</p>
<p>Yes, it stops the attack that was described, but I think the solution is worse than the problem here.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123615">

			<div class="comment by-samuel ">

				<p class="commentcredit">

					<span class="commenter">Samuel</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123615">
						October 23, 2009 10:15 AM					</a>

				</p>

				<p>This attack does not work on a trusted boot path.<br />
Most commercial FDE solution (eg. Utimaco, Safeboot, MS Bitlocker) support TPM and smartcard authentication.</p>
<p>But maybe the point of Rutkowska was to say that TrueCrypt DOES NOT support TPM, and worse explicitly disdain it as &#8220;security theatre&#8221; per they FAQ.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123616">

			<div class="comment by-floyd-young ">

				<p class="commentcredit">

					<span class="commenter">Floyd Young</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123616">
						October 23, 2009 10:18 AM					</a>

				</p>

				<p>The method in which Truecrypt WDE works will allow a person to competely eliminate the bootloader from the HDD and use only the recovery disk to boot the system, thus eliminating this scenario and any way to even identifiy that Truecrypt is being used on the system.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123617">

			<div class="comment by-milo ">

				<p class="commentcredit">

					<span class="commenter">Milo</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123617">
						October 23, 2009 10:19 AM					</a>

				</p>

				<p>&#8220;Full disk encryption&#8221; &#8211; this phrase is used often, but quite often it is used wrong way. You <em>can&#8217;t</em> just modify bootloader (MBR or whatever) of fully encrypted disk successfully because it is fully encrypted and system is booting from external media (pendrive for example &#8211; I think it&#8217;s easier to keep it safe then whole laptop). None of mentioned software pieces supports out-of-the box full disk encryption with booting. It is partial disk encryption. Discussion about hardware rootkits is futile &#8211; we know that it is possible and probably always will be, so all that we can do is watch people doing this. Attack implemented by Joanna doesn&#8217;t brings nothing new. That&#8217;s all folks&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123618">

			<div class="comment by-dimitri ">

				<p class="commentcredit">

					<span class="commenter">Dimitri</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123618">
						October 23, 2009 10:24 AM					</a>

				</p>

				<p>Even easier than the &#8220;evil maid&#8221; is the &#8220;free software CD&#8221; that you find in the parking lot or is send as a gift to your house.. (or free music, free porn, or free whatever).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123619">

			<div class="comment by-matt ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.metamatt.com' rel='external nofollow ugc' class='url'>Matt</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123619">
						October 23, 2009 10:37 AM					</a>

				</p>

				<p>Even with Trusted Boot, how does that defend against the following scenario: evil maid swaps out your computer for an identical looking one configured to ask for your password (with identical timing and UI to the way your machine asks for your password), then store it somewhere and put up a phony error message.</p>
<p>The trouble as I see it with Trusted Boot is it doesn&#8217;t prevent what&#8217;s essentially a splice attack with another untrusted machine &#8212; Trusted Boot can make an honest machine refuse to boot when it&#8217;s been tampered with, but that guarantee doesn&#8217;t extend to other (dishonest) machines, and humans can&#8217;t tell the difference. (Unless you do key exchange with the bootloader&#8230; something humans aren&#8217;t very good at, but maybe your smartphone could do it.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123620">

			<div class="comment by-simon ">

				<p class="commentcredit">

					<span class="commenter">Simon</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123620">
						October 23, 2009 10:37 AM					</a>

				</p>

				<p>@Milo &#8211; incorrect in several cases.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123621">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123621">
						October 23, 2009 10:38 AM					</a>

				</p>

				<p>@ M (aka Q 😉</p>
<p>&#8220;Are you really suggesting that it&#8217;s a good way to keep the most sensitive information you have, your key/passphrase, more secure by <em>sending it over the air</em>?!&#8221;</p>
<p>If you use the right kit in the right way, yes it is more secure than using the ordinary keyboard (which does transmit plain text off it&#8217;s connector cable).</p>
<p>Some of the new &#8220;presentation kit&#8221; uses bluetooth with encryption and the encryption in some I&#8217;ve looked at is fairly standard block encryption.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123622">

			<div class="comment by-mork ">

				<p class="commentcredit">

					<span class="commenter">mork</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123622">
						October 23, 2009 10:38 AM					</a>

				</p>

				<p>@Rob</p>
<p>&#8220;What could help also is to leave your computer on, in screensaver lock&#8221;</p>
<p>That might solve one problem but leaves another.  You can now detect evil maids but you have allowed anyone with access to your computer and a can of cold spray access to your data.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123623">

			<div class="comment by-kashmarek ">

				<p class="commentcredit">

					<span class="commenter">kashmarek</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123623">
						October 23, 2009 10:38 AM					</a>

				</p>

				<p>There is a large group of users that have access to my computer when I am using it: the corporate desktop support team (some located where I work, others off-shore or the outsourced group).  Thus, any of these can back-door login (behind the scene support logins), do their dirty business if so inclined, and logoff without a trace (only my activity on the workstation is traced, it seems I can&#8217;t be trusted).</p>
<p>As such, the corporate move to use full disk encryption is only there to protect the corporation from the SEC or some-such, not really to protect the data.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123624">

			<div class="comment by-openeye ">

				<p class="commentcredit">

					<span class="commenter">OpenEYE</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123624">
						October 23, 2009 10:40 AM					</a>

				</p>

				<p>You keep failing to see the whole picture. The maid has full access to the room. Let&#8217;s evaluate contents of room at 03 hours: computer, computer BIOS, encrypted hard drive, DRM-ladden usb key device, fingerprint reader, retina scanner, <em>sleeping you</em>. Everything needed to get the data is in there.<br />
She can drug you, torture you, sex you up, keylog you, steal your key and computer, get your fingerprints and your eye or a scan thereof.<br />
Accept it, perfect security is not possible. With enough motivation any method where you can still access your data at all can be broken. Period.<br />
The more measures you take the most certain it is that the thing that&#8217;s going to end up broken is you.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123625">

			<div class="comment by-guest ">

				<p class="commentcredit">

					<span class="commenter">Guest</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123625">
						October 23, 2009 10:42 AM					</a>

				</p>

				<p>@davidwr</p>
<blockquote><p>
  Tamper-evident seals over the hard disk to detect removal
</p></blockquote>
<p>I think this is best</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123626">

			<div class="comment by-master ">

				<p class="commentcredit">

					<span class="commenter">Master</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123626">
						October 23, 2009 10:44 AM					</a>

				</p>

				<p>For those recommending a BIOS password and no booting from external devices, couldn&#8217;t you simply pull the BIOS battery out and reset the BIOS password? Or are you going to check that your BIOS password is still there every time?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123627">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123627">
						October 23, 2009 10:48 AM					</a>

				</p>

				<p>Just one thing to remember.</p>
<p>You don&#8217;t need to know the key if the hard drive encryption has not been done correctly.</p>
<p>A simple example,</p>
<p>The boot code is usually always in exactly the same place on MS OS&#8217;s and it realy does not change that much.</p>
<p>Now for simplicity assume the disk has been effectivly &#8220;stream encrypted&#8221; (or several other simple minded systems).</p>
<p>Your attacker simply produces a file that when XORed with the encrypted tracks from the hard drive will replace the &#8220;standard boot code&#8221; with the &#8220;maid code&#8221;.</p>
<p>This is effectivly a modified &#8220;known plain text&#8221; attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123628">

			<div class="comment by-anonymous-canuck ">

				<p class="commentcredit">

					<span class="commenter">anonymous canuck</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123628">
						October 23, 2009 10:48 AM					</a>

				</p>

				<p>Looking through the comments, there does seem to be a number of approaches to detect and/or mitigate this kind of attack.  FDE in combination with one or more of these still looks pretty good.</p>
<p>Another measure for laptops that can help along is the ability to set a password on the hard disk. I believe it&#8217;s set right in the controller.  If you move the hard disk the password moves with it.</p>
<p>I haven&#8217;t seen anything recent on how strong this is.  But the analysis I&#8217;d seen some years back suggested that a <em>lot</em> more sophistication and tooling would be need for this than say resetting the bios password.  Basically, AFAIK this is not an in the field attack.</p>
<p>Also, many laptops also have a password on the motherboard.  I&#8217;ve been told that if you forget it you;ll need to replace the motherboard.  A couple of companies I know explicitly won&#8217;t use this because of the cost implications of forgetting/loosing that pw.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123629">

			<div class="comment by-bw ">

				<p class="commentcredit">

					<span class="commenter">BW</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123629">
						October 23, 2009 10:52 AM					</a>

				</p>

				<p>A better &#8220;Evil Maid&#8221; would be that it steals your keys &amp; passwords (keylogger) and sends them over the internet when you connect. The beauty is, after it has gotten your passwords and keys, it can delete those bits of software. The boot loader is only needed to infect the computer, it too can be removed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123630">

			<div class="comment by-jeremyg ">

				<p class="commentcredit">

					<span class="commenter">JeremyG</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123630">
						October 23, 2009 11:00 AM					</a>

				</p>

				<p>I think it&#8217;s high time laptops start coming with tamper-evident lid locks, and not just anchors for tether cables, which protect the laptop from being taken but not from being hacked.  A lid lock will deter hacking or tampering with the laptop&#8217;s contents, or at least make it evident that someone did tamper with it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123631">

			<div class="comment by-jim ">

				<p class="commentcredit">

					<span class="commenter">Jim</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123631">
						October 23, 2009 11:12 AM					</a>

				</p>

				<p>Self-Encrypting Drives<br />
<a href="http://www.computerworld.com/comments/comment/view/9139733/546806" rel="nofollow ugc">http://www.computerworld.com/comments/comment/view/9139733/546806</a></p>
<p>Submitted by Lark Allen on October 21, 2009 &#8211; 18:42.</p>
<p>It&#8217;s great to see self-encrypting drives gaining mindshare for the benefits that come from hardware encryption versus traditional software FDE. There are significant benefits to SED: No performance degradation; more secure; easier to use; less complex to manage; stronger compliance evidence; and more.</p>
<p>However, our first-hand experience has shown significant enterprise adoption, and factory-installed hardware encryption has proven a strong business case, and we&#8217;re seeing strong adoption in healthcare, financial, retail, government, and across industries. Every Dell machine that ships with an encrypted drive (Seagate drives, as well as Samsung&#8217;s new self-encrypting SSDs) includes directly integrated management software from my employer, Wave Systems, and we also provide enterprise central management solutions for SED. So we hear the success stories directly from the end users &#8212; and factory integrated encryption may be an even better solution for the enterprise than for consumers, as both types of user simply want to ‘set it and forget it’ to let their computers manage the encryption.</p>
<p>BTW, self-encrypting drives are immuned to the much publicized Evil Maid USB boot attacks.</p>
<p>Thanks for exploring the latest innovations in hardware-based encryption.</p>
<p>Regards,</p>
<p>Lark Allen<br />
Executive Vice President<br />
Wave Systems Corp. (www.wave.com)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123633">

			<div class="comment by-lee ">

				<p class="commentcredit">

					<span class="commenter">Lee</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123633">
						October 23, 2009 11:18 AM					</a>

				</p>

				<p>Simple and cheap &#8211; use a netbook w/full disk and keep it with you all the time. Less convenient than the USB bootloader but simpler.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123634">

			<div class="comment by-john-greco ">

				<p class="commentcredit">

					<span class="commenter">john greco</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123634">
						October 23, 2009 11:41 AM					</a>

				</p>

				<p>@Jim</p>
<p>Interesting, but color me skeptical.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123635">

			<div class="comment by-edward-trivusky ">

				<p class="commentcredit">

					<span class="commenter">Edward Trivusky</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123635">
						October 23, 2009 11:41 AM					</a>

				</p>

				<p>You&#8217;re respected security researcher Bruce and yet you wrote that <em>evil maid</em> (by the way it&#8217;s in Jan/Joanna style to came up with stupid name for attack which already have one) will beat BitLocker. Well, that&#8217;s not true as Trent stated before. BitLocker use TPM so <em>it will</em> prevent that silly attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123636">

			<div class="comment by-edward-trivusky ">

				<p class="commentcredit">

					<span class="commenter">Edward Trivusky</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123636">
						October 23, 2009 11:46 AM					</a>

				</p>

				<p>I forgot to add: I know that you like to write blog posts, and you like to enlighten people with security BUT please, write about things you DO know because there is one thing worse than lack of information. Disinformation.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123637">

			<div class="comment by-vsaltao ">

				<p class="commentcredit">

					<span class="commenter">vsaltao</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123637">
						October 23, 2009 11:51 AM					</a>

				</p>

				<p>A simple fix for this would be to let the user be able to input a text string into the bootloader wich would let him know  later on that the loader wasnt messed by someone</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123638">

			<div class="comment by-coffeehound ">

				<p class="commentcredit">

					<span class="commenter">coffeehound</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123638">
						October 23, 2009 12:01 PM					</a>

				</p>

				<p>Excellent ideas.  Alas, the users often super-glue their RF cards to the laptop case and attach their security dongles to the handle to prevent loss.  All these solutions require a modicum of security awareness by the user.  This is a forlorn hope in the modern, downsized, always re-organizing, and internally-competitive company.<br />
A good solution works without any user awareness: which is what will be the case.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123639">

			<div class="comment by-anon-mouse ">

				<p class="commentcredit">

					<span class="commenter">anon mouse</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123639">
						October 23, 2009 12:05 PM					</a>

				</p>

				<p>WTF Bruce?  As Eward and Trent said, have pointed out, this is just wrong:</p>
<blockquote><p>
  The real defense here is trusted boot,<br />
   something Trusted Computing is<br />
   supposed to enable. But Trusted<br />
   Computing has its own problems, which<br />
   is why we haven&#8217;t seen anything out of<br />
   Microsoft in the seven-plus years they<br />
   have been working on it (I wrote this in<br />
   2002 about what they then called<br />
    Palladium).
</p></blockquote>
<p>You should update your post to say that bitlocker 100% defends against this hacked bootloader attack.  Maybe this is because (as your post said the other day), you&#8217;re still running XP, an 8 year old operating system, despite Vista&#8217;s security advances.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123640">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123640">
						October 23, 2009 12:52 PM					</a>

				</p>

				<p>This attack changes nothing for my strategies, as it doesn&#8217;t work against a few of my designs. For high assurance, I always recommend a read-only boot module that get&#8217;s the main microkernel and drivers going, after hashing them against a built-in value. Then, those essentially boot the system with built-in code-signing. Additionally, most stuff is disabled and powered down by the BIOS until it does the security checks. This scheme defeats most physical security attacks on commodity hardware, even more on dedicated hardware, and can only fall victim to attackers that connect tools to the chips themselves for reprogramming.</p>
<p>Trusted boot, in general, is an issue I&#8217;ve been looking at for a long time. In my designs, most of the key handling, etc. happens on a dedicated coprocessor. The coprocessor is small enough to fit in pocket and be with you all the time. The bootable flash drives are as well. I would generally use a notebook that&#8217;s easy to disassemble and physically verify, with tamper-evident seals. If evidence of tampering, reflash BIOS, run self-tests and load from trusted media. Restore original state, go from there. I also sometimes use the coprocessor as a firewall, etc. to provide added protection in event main system is sabotaged. That hurts flexibility though. Overall, there exist simple but time-consuming solutions that make these attacks much more difficult for assailants. If any of you are worried, I suggest you use these and other tricks to reduce the risk.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123641">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123641">
						October 23, 2009 1:20 PM					</a>

				</p>

				<p>@ Matt</p>
<p>That splice attack is nice and a known weakness of trusted boot. It&#8217;s easier to do when someone is accessing the machine remotely, as they can&#8217;t see it. The splice attack is why I include visual inspection and tamper-evidence in my physical protection scheme.</p>
<p>@ Jim</p>
<p>Self-encrypting drives don&#8217;t solve the general problem: they just require a different attack. Most drive encryption relies on a credential that must be obtained from the user on a system with weaker security than the HD&#8217;s controller. Trusted path is the solution, but most of <em>those</em> &#8220;secure&#8221; HD&#8217;s use a short PIN and nothing else. A combination of tamper-resistant hardware, PIN pad and crypto token key like NSA&#8217;s IME encrypter the way to go. No commercial system comes anywhere close to that standard.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123642">

			<div class="comment by-moo ">

				<p class="commentcredit">

					<span class="commenter">moo</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123642">
						October 23, 2009 1:35 PM					</a>

				</p>

				<p>@Clive Robinson: Nice idea with the portable RF keyboard/mouse combo.  Another idea is to get one of those flexible rubber USB keyboards and use that to type in the password.  If you get a transparent one, it would be very difficult for an adversary to modify that transparent keyboard (e.g. inserting a hardware keylogger in it) without you noticing.  Also, they are small enough that you can roll them up and put them in your pocket, always keeping them in your possession and away from attackers.  Combined with the never-boot-from-hard-drive techniques described above, this would make many attacks impractical.  If they need to compromise it without your knowledge for some reason (like to snoop on your future uses of that computer) then they may need to do it externally to the machine itself, with a laser aimed at a nearby window or something.</p>
<p>Of course, if you have adversaries who don&#8217;t need to keep the compromise secret from you, then XKCD&#8217;s advice about the $5 wrench attack still applies.  If you secure everything else well enough, then YOU become the weakest link in the security chain, and the easiest one to attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123643">

			<div class="comment by-todd-peterson ">

				<p class="commentcredit">

					<span class="commenter">Todd Peterson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123643">
						October 23, 2009 1:46 PM					</a>

				</p>

				<p>Readers might find it interesting to read about Peter Kleissner&#8217;s attacks on TrueCrypt as well (using his Stoned Bootkit):</p>
<p><a href="http://simonhunt.wordpress.com/2009/08/04/truecrypt-vs-peter-kleissner-or-stoned-bootkit-revisited/" rel="nofollow ugc">http://simonhunt.wordpress.com/2009/08/04/truecrypt-vs-peter-kleissner-or-stoned-bootkit-revisited/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123644">

			<div class="comment by-pedro-fortuny ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://pfortuny.net' rel='external nofollow ugc' class='url'>Pedro Fortuny</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123644">
						October 23, 2009 1:47 PM					</a>

				</p>

				<p>Is this not what Apple&#8217;s EFI etc. boot configuration prevents? I may be wrong, but as far as I know, Undercover uses this fact as part of the protection (you cannot boot an i386 OS X mac from a different volume without a password)?</p>
<p>Pedro Fortuny</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123645">

			<div class="comment by-mace-moneta ">

				<p class="commentcredit">

					<span class="commenter">Mace Moneta</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123645">
						October 23, 2009 1:51 PM					</a>

				</p>

				<p>There&#8217;s no reason a mobile device needs to be encrypted, or to have sensitive data on it.</p>
<p>Sshfs and encfs gets you secure access to encrypted data in &#8220;the cloud&#8221; (which could very well be your own system).</p>
<p>If you can remember the password for your full disk encryption, you can remember your sshfs login and encfs password.</p>
<p>Take the laptop, evil maid it, freeze the chips.  It contains nothing.  Nor should it, if you deal with anything that justifies encryption.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123646">

			<div class="comment by-meh1963 ">

				<p class="commentcredit">

					<span class="commenter">meh1963</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123646">
						October 23, 2009 2:10 PM					</a>

				</p>

				<p>With the plethora of large USB drives out there, why not avoid a disk in the PC and use the USB key?  Yeah, performance, but even so, it means that your data is in your possession&#8230;and USB stuff is easier to carry than a whole computer.</p>
<p>(Plus it means you can boot with whatever PC is around, which is Not A Bad Thing).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123648">

			<div class="comment by-bitmonger ">

				<p class="commentcredit">

					<span class="commenter">bitmonger</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123648">
						October 23, 2009 2:17 PM					</a>

				</p>

				<p>Two factor doesn&#8217;t really work here either.</p>
<p>If you can&#8217;t control access to your computer (the whole computer) &#8230; you&#8217;ve lost.</p>
<p>TPM chip + signed bootloader tied to a smartcard two factor credential would be interesting (don&#8217;t lose it).  &#8230;. but frankly &#8230; you still lose if someone has physical access.  You can&#8217;t stop them from loading microcode.  replacing the bios chip.  Even <em>if</em> microcode could not be loaded.  <em>if</em> the tpm could not be virtualized.</p>
<p>You have no authetication on any bus &#8230;<br />
You have cpus on nearly every device.<br />
You have god knows how much device driver code no one would sanely expect to act as a security boundry.</p>
<p>I don&#8217;t believe you could make a system from a commodity PC lacking enough features to be secure-able against this threat, but thats obvious, no?!</p>
<p>Do you really expect the people who wrote a fancy usb webcam driver you use to consider themselves as part of the surface of a TPM container??</p>
<p>Forget about tempest even&#8230;</p>
<p>You would need end to end encryption between each device on the bus to secure against physical access and each driver would have to be contained.</p>
<p>The TPM itself isn&#8217;t safe against detailed extended analysis.</p>
<p>You want security measure would stop the evil<br />
maid???</p>
<p>A safe door.<br />
A welded locked case she can&#8217;t open fast enough (for the whole thing keyboard power cable everything).</p>
<p>Anything else is not serious answer to this threat model.</p>
<p>Think about your threat.  Then choose technology.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123649">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123649">
						October 23, 2009 2:20 PM					</a>

				</p>

				<p>@meh1963: &#8220;With the plethora of large USB drives out there, why not avoid a disk in the PC and use the USB key? Yeah, performance, but even so, it means that your data is in your possession&#8230;and USB stuff is easier to carry than a whole computer. &#8221;</p>
<hr />
<p>If I&#8217;m understanding this attack correctly, your method still would be vulnerable to this attack.  The data and the encryption was not what was attacked, the setup of the computer was exploited.  All that would happen in your instance would they would have gotten your key when you went to access the data on the USB.</p>
<p>I mean, there is some possible mitigation in your idea, as the data is no longer machine dependent (however, this could be considered a risk meaning they don&#8217;t have to exploit any one machine, they can exploit any machine you may use to access your data).  And they would still need to get your USB to get that data.  But, they would have your key.</p>
<p>Again, I still think your idea leaves one vulnerable since it was never the encryption that was compromised.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123650">

			<div class="comment by-kurt-s ">

				<p class="commentcredit">

					<span class="commenter">Kurt S</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123650">
						October 23, 2009 2:28 PM					</a>

				</p>

				<p>I don&#8217;t see this being a huge risk for most companies, in fact it would take quite a concerted effort to make it happen where I work. But that&#8217;s why you have a security plan encompassing threats on multiple fronts. Yet you still need to strike a balance so the average user can do their job. Often times articles like this seem to not factor that in to the equation.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123651">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123651">
						October 23, 2009 2:45 PM					</a>

				</p>

				<p>@Kurt S: &#8220;I don&#8217;t see this being a huge risk for most companies, in fact it would take quite a concerted effort to make it happen where I work. But that&#8217;s why you have a security plan encompassing threats on multiple fronts. Yet you still need to strike a balance so the average user can do their job. Often times articles like this seem to not factor that in to the equation.&#8221;</p>
<hr />
<p>Fair point.  &#8220;Is risks worth the burden of protection?&#8221; is always a good question to ask.</p>
<p>I think the biggest threat on something like this would be an business insider.  An outsider would need to jump through a few more hoops, and/or get lucky, to pull it off.  But a disgruntled employee that is technically savy could pull it off.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123652">

			<div class="comment by-john-doe ">

				<p class="commentcredit">

					<span class="commenter">John Doe</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123652">
						October 23, 2009 2:51 PM					</a>

				</p>

				<p>Would this attack work on McAffee&#8217;s SafeBoot?</p>
<p>When asked one of my insiders responded with the following:</p>
<p>The SafeBoot File System uses an encrypted boot sector chain to get to the MBR. If that sector chain is modified, the machine will not boot to Windows and the machine will have to be re-imaged.  We’ve broken machines this way simply by altering the Windows boot partition with partition magic after SafeBoot was installed.  We had to reimage the machine.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123653">

			<div class="comment by-milo ">

				<p class="commentcredit">

					<span class="commenter">Milo</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123653">
						October 23, 2009 3:05 PM					</a>

				</p>

				<p>&#8220;incorrect in several cases.&#8221;</p>
<p>@Simon: OK, so you are evil maid. you have &#8220;cold&#8221; machine before yourself. Whole storage is encrypted. it&#8217;s PC (no EFI thing, just BIOS). how do you want to inject your code to MBR space without hw hacks (swapping BIOS too), or attack while system is running?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123654">

			<div class="comment by-ag ">

				<p class="commentcredit">

					<span class="commenter">AG</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123654">
						October 23, 2009 3:08 PM					</a>

				</p>

				<p>Low tech mitigation:</p>
<p>Slip the laptop between the mattress and the boxspring before you leave the room.</p>
<p>Yes, the maid could install a video camera and know that you hid it but in that case she probably has video of you typing your password anyway.</p>
<p>If you really care about protecting the data, take the laptop with you.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123655">

			<div class="comment by-paeniteo ">

				<p class="commentcredit">

					<span class="commenter">Paeniteo</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123655">
						October 23, 2009 4:09 PM					</a>

				</p>

				<p>@Mace Moneta: &#8220;Take the laptop, evil maid it, freeze the chips. It contains nothing. Nor should it, if you deal with anything that justifies encryption.&#8221;</p>
<p>Well, the machine will eventually contain the password to the sshfs+encfs. If the evil maid installs a simple keylogger, you&#8217;re lost.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123656">

			<div class="comment by-major-variola-ret ">

				<p class="commentcredit">

					<span class="commenter">Major Variola (ret)</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123656">
						October 23, 2009 4:19 PM					</a>

				</p>

				<p>You don&#8217;t need physical access to the <em>computer</em> to do this.  Just the<br />
physical environment of the computer.</p>
<p>The evil maid has an over the shoulder view of your password entry via the smoke<br />
detector (etc).    (As well as a video<br />
of the bed, should you be worth<br />
blackmailing and blackmailable,<br />
as so many important folks are.)</p>
<hr />
<p>Who is Sibel Edmonds?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123658">

			<div class="comment by-nate ">

				<p class="commentcredit">

					<span class="commenter">nate</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123658">
						October 23, 2009 4:47 PM					</a>

				</p>

				<p>With Linux, at least, it is very easy to boot up from a removeable drive media like a thumb drive.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123659">

			<div class="comment by-bw ">

				<p class="commentcredit">

					<span class="commenter">BW</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123659">
						October 23, 2009 5:28 PM					</a>

				</p>

				<p>Just for the sake of bringing Macs into the discussion (since it&#8217;s centered on the PC), it should be noted that most Mac laptops (probably all, but I don&#8217;t have the time to verify the claim), support SCSI/Firewire Disk Mode. Which means it can be booted into a special mode that makes it look like an HD to any computer you connect it to (via the Firewire or SCSI port, whichever the system has). Which is very handy for copying/overwriting the contents of the computers HD. It would also make installing a rootkit trivial and you don&#8217;t even need to tamper with the case/boot order.</p>
<p>Lets not even discuss DMA over Firewire.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123660">

			<div class="comment by-bw ">

				<p class="commentcredit">

					<span class="commenter">BW</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123660">
						October 23, 2009 5:43 PM					</a>

				</p>

				<p>@Pedro: According to Apple, you can&#8217;t go into Disk Mode if you have the Open Firmware password enabled. But you can take the HD out of the computer and pop it into another (which is the dark side of this attack).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123661">

			<div class="comment by-mace-moneta ">

				<p class="commentcredit">

					<span class="commenter">Mace Moneta</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123661">
						October 23, 2009 6:02 PM					</a>

				</p>

				<p>@Paeniteo:</p>
<p>&#8220;Well, the machine will eventually contain the password to the sshfs+encfs. If the evil maid installs a simple keylogger, you&#8217;re lost.&#8221;</p>
<p>Not so.  Since no encryption has been used to boot the system, the boot sector hash can be authenticated against a copy stored on a web site (as others have pointed out).  The environment can be safely validated, before using sshfs/encfs.</p>
<p>If you&#8217;re concerned about a software keylogger, use a bootable thumbdrive and no HD in the machine (can&#8217;t install a keylogger).  If you are concerned about a hardware keylogger, use an on-screen keyboard for the password.  If you&#8217;re worried about mouse capture by the keylogger, use a non-qwerty input method, like dasher.</p>
<p>The extent of the methodology is a function of the needed level of security.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123662">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123662">
						October 23, 2009 6:51 PM					</a>

				</p>

				<p>@ HJhon,</p>
<p>&#8216;Fair point. &#8220;Is risks worth the burden of protection?&#8221; is always a good question to ask.&#8217;</p>
<p>And it can be a question that is niegh on impossible to answer.</p>
<p>The first difficult part of the question is &#8220;risk&#8221;, which is very difficult to quantify.</p>
<p>For instance data is it&#8217;s self virtually worthless, it potentialy becomes valuble as information (data+metadata) but only if the context is known or can be reliably guessed.</p>
<p>The question then becomes what is the value to whom and why.</p>
<p>Some information even when in context has little value to some people but immense value to others and further the value has a time element as well.</p>
<p>Then the question becomes what is &#8220;value&#8221; it may not be possible to directly equate to dollars and cents. It might be a persons reputation or even liberty.</p>
<p>Then of course having got over the risk/value hurdel you then have to consider what the &#8220;burden&#8221; actually is to each player and why&#8230;</p>
<p>It&#8217;s not a fun game getting it right and quite offten the &#8220;burden&#8221; can be minimised with a little thought and enforcable user training.</p>
<p>I&#8217;m off the opinion the less usable information there is out there the safer people generaly are. However the current business and political trends are to needlessly maximise access to as much information as is possible.</p>
<p>This is something society either has to come to terms with or force a change in practice.</p>
<p>One step in the right direction would be legal in that it should be possible to release information to a third party without lossing control of it.</p>
<p>For instance in the UK if you decide to take up private medical insurance (as the current political idiots want people to do) you actually sign away most of the rights to information about yourself and at the same time grant unrestricted access to any and all information about you the insurance industry feels might be relavent to it at any time now or in the future&#8230;</p>
<p>Worse this information is usually sent to an organisation in the US against EU safe harbour regulations. Where the information is then sent for processing to some organisation in Asia where there is no legal control worthy of the name on the marketing of such information.</p>
<p>The hidden problem with information risk assessment is time. For instance the result of a routien medical test shows you have certain relation ships in your body chemistry. The discovery of a new medical relationship could suddenly turn what was information only of value to you and your doctor to being of major value to the insurance industry.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123663">

			<div class="comment by-rf ">

				<p class="commentcredit">

					<span class="commenter">RF</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123663">
						October 23, 2009 8:33 PM					</a>

				</p>

				<p>Hardware-based keyloggers aren&#8217;t foiled by BitLocker+TPM, much like a camera over you shoulder isn&#8217;t.</p>
<p>There are lots of other tricks to get around most disk encryption without formally &#8220;breaking&#8221; it.  Getting pwned by malware while you use the computer will always work.  Your computer might be unlocked for the maid as long as it&#8217;s in sleep mode, if that&#8217;s how it&#8217;s configured.  In practice, badguys can probably get many folks&#8217; passwords/passphrases without any serious cracking, like if you use it on all Web sites.  Two-factor authentication can mitigate the sleep mode and weak passphrase problems.</p>
<p>Still, disk encryption costs nothing compared to the benefits if you handle stuff like medical records or corporate secrets.  It gives you peace of mind in the very common situation where a laptop is just lost and none of these other attacks apply.  Not using it at all is a much worse mistake than expecting too much of it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123664">

			<div class="comment by-ifirebird ">

				<p class="commentcredit">

					<span class="commenter">ifirebird</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123664">
						October 23, 2009 8:57 PM					</a>

				</p>

				<p>a simple defense, don&#8217;t compromise physical access to your computer if you store your sensitive documents on it and you are in China!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123665">

			<div class="comment by-anton ">

				<p class="commentcredit">

					<span class="commenter">Anton</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123665">
						October 23, 2009 8:58 PM					</a>

				</p>

				<p>Ultimately this discussion and many others on this blog boil down to only being able to obtain real security by using an external token in combination with a password, in other words the good old and proven &#8220;keep a key in your pocket&#8221; approach.</p>
<p>So why are we not seeing common computer hardware, net, web  and storage access systems designed on this approach?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123666">

			<div class="comment by-tom-barry ">

				<p class="commentcredit">

					<span class="commenter">Tom Barry</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123666">
						October 23, 2009 10:07 PM					</a>

				</p>

				<p>My Asus netbook bios has the boot device set as only the TrueCrypted hard drive.  And it takes a password to change the bios settings and reverse that.  It seems to me that makes it safe up until the point where the maid takes it apart to do something complicated.</p>
<p>Not perfect but I guess that&#8217;s a start.  Probably many laptops can be set that way. I&#8217;m surprised it is not recommended more often.</p>
<ul>
<li>Tom</li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123667">

			<div class="comment by-fred-bloggs ">

				<p class="commentcredit">

					<span class="commenter">fred.bloggs</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123667">
						October 24, 2009 12:25 AM					</a>

				</p>

				<p>A side-comment, sparked by the Trusted Computing reference:</p>
<p>Perhaps Rupert Murdoch&#8217;s recent comments about how intermediaries/aggregators/others in the media game should be forced to pay more to big media like News Corp, is a warning shot across various peoples&#8217; collective bows that they will start demanding TC-based DRM systems soon?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123668">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123668">
						October 24, 2009 12:44 AM					</a>

				</p>

				<p>@ Tom Barry</p>
<p>Yep. This was the logic behind part of my scheme. A BIOS password relies on figuring out the password or a hardware attack on the machine itself. Complicates things for attacker.</p>
<p>@ RF</p>
<p>Indeed. This is why my scheme uses a mobile computer, cheap netbook in this case. The guy needing privacy can use any access point or network and the computer is disposable and easily replaced if compromised.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123669">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123669">
						October 24, 2009 1:54 AM					</a>

				</p>

				<p>A word of caution about BIOS passwords.</p>
<p>How do you think the following happens,</p>
<p>1, Initial load of flash by manufacturer.</p>
<p>2, Re-load of flash bios when it becomes corupted.</p>
<p>3, Re-work of motherboards for &#8220;recondition&#8221; resale.</p>
<p>The simple fact is that the speed of doing this and the cost of &#8220;connectig up&#8221; to the programer is unproductively expensive therefore the process has usually been designed to require the minimum of work involved.</p>
<p>And this means using the available &#8220;back plane&#8221; connectors and a &#8220;training sequence&#8221; to start the process.</p>
<p>Often it does not involve taking the casing off of the laptop/netbook/PC/etc or for that mater having it powered up in the conventional sense.</p>
<p>This is already known to quite a few people and it is certainly known to some of the larger criminal gangs shiping off to various countries in Africa etc.</p>
<p>When you remember where most of these devices are manufactured and by how few organisations it has reached the point where it is like &#8220;unlocking&#8221; a mobile phone.</p>
<p>Therefore it is almost certainly known to the &#8220;state employers&#8221; of business hotels &#8220;maids&#8221;.</p>
<p>And don&#8217;t forget when you visit certain countries  (large ex/comunist) to get  a visa you have to inform them where you are staying with documentation supplied by the hotel. And that only certain hotels and agencies can produce the paper work to &#8220;the required standard&#8221;.</p>
<p>Therfore the government of these countries know which hotel room you are staying in, who your employer is and a heck of a load of other interesting tit-bits about you (like credit cards you have, where you live, and in the case of the US how big your mortgage is)</p>
<p>Oh and the same is now true for those going on business to the USA and other countries.</p>
<p>And it is fairly well known that various countries do &#8220;state sponsered industrial spying&#8221; to maintain a &#8220;competative advantage&#8221; for their &#8220;chosen few&#8221; companies. In fact in one particular case the head of a countries state security service actually acknowledged to camera that such behaviour was less expensive than funding R&amp;D&#8230;</p>
<p>Oh one last question for you to ask your selves, &#8220;self encrypting hard drives&#8221; where do they get their &#8220;key from&#8221; and how much real entropy do you think there is in it?</p>
<p>I don&#8217;t know the specific answer for all devices, but I do know from past experiance that most engineers software or hardware don&#8217;t have the first clue about how to get &#8220;real entropy&#8221;.</p>
<p>And I have seen to many &#8220;Magic Pixie Dust&#8221; solutions (crypto hash etc) where the real entropy is sub 2^20 to have any faith in them.</p>
<p>The reason for this is again manufacturing cost. Entropy takes time to accumulate and time on a high volume production line is very very very expensive.</p>
<p>Design engineers appear to have a blind spot about how the entropy should be obtained.</p>
<p>They usually make the mistake of having the actual individual product items &#8220;self produce&#8221; the entropy rather than have it &#8220;programed in&#8221; on the production line (which is actually a much beter solution when done even moderatly well).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123670">

			<div class="comment by-robert-alexander ">

				<p class="commentcredit">

					<span class="commenter">Robert Alexander</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123670">
						October 24, 2009 4:00 AM					</a>

				</p>

				<p>What about hiding in the closet and jumping on the evil yelling &#8220;Schneierrrrrr&#8221; maid as she tries to do her evil ? 🙂 🙂 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123671">

			<div class="comment by-savek ">

				<p class="commentcredit">

					<span class="commenter">Savek</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123671">
						October 24, 2009 4:10 AM					</a>

				</p>

				<p>Actually, Linux is able to implement a secure boot with trustedGrub (and hdd encryption on top of that) as described in <a href="http://www.sirrix.com/content/pages/trustedgrub.htm" rel="nofollow ugc">http://www.sirrix.com/content/pages/trustedgrub.htm</a> and <a href="http://www.springerlink.com/content/l428265606834828/" rel="nofollow ugc">http://www.springerlink.com/content/l428265606834828/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123672">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123672">
						October 24, 2009 4:20 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>&#8220;IME encrypter&#8221;</p>
<p>Is like saying &#8220;ATM machine&#8221; 8)</p>
<p>@ ALL,</p>
<p>Symantic Jokes asside the NSA &#8220;Inline Media Encrypter&#8221; (KG200/201) is a fairly simple and effective device for in the NSA&#8217;s own words,</p>
<p>&#8220;The IME protects data classified Top Secret and below. Data stored on the hard drive is considered unclassified when encrypted.&#8221;</p>
<p>(Note &#8220;Top Secret and below&#8221; is the same rating as AES so not used for all data then 😉</p>
<p>However note the following caveats,</p>
<p>&#8220;Protects data-at-rest classified up to TS/SCI&#8221;</p>
<p>&#8220;Data is secure (stored encrypted) when at rest (unclassified)&#8221;</p>
<p>&#8221; When separated, the IME and CIK are unclassified&#8221;</p>
<p>(Note &#8220;at rest&#8221; realy means &#8220;powered off&#8221; not PC/laptop in standby or hiebernation. And the CIK is the equivalent of an &#8220;off line adminastrative master key&#8221; for data assurance).</p>
<p>And the minor problems,</p>
<p>&#8220;The IME provides Type 1 Encryption on a computer&#8217;s Integrated Device Electronic (IDE) hard drive.&#8221;</p>
<p>&#8220;Crypto-Ignition Key (CIK) is exclusive to the individual IME&#8221;</p>
<p>The &#8220;Crypto-Ignition Key&#8221; is (if I have been told correctly 😉 a little different to the CIK&#8217;s of old. It is a method by which the &#8220;Emergency Data Destruction without destroying equipment or losing data&#8221; is achived by &#8220;Instantaneous key zeroization&#8221; (delete the &#8220;secret&#8221; master key) can be reversed.</p>
<p>I&#8217;m assuming that the NSA has got the &#8220;Self-Generating Storage Key&#8221; for the &#8220;Up to 10&#8221; &#8220;Personal Identification Number (PIN)&#8221; protected &#8220;user accounts&#8221; that &#8220;can be assigned to each IME&#8221; correct (or better than average 😉</p>
<p>In fact the CIK is not a minor problem at all it is a major major problem. As various organisations have found &#8220;Key Managment&#8221; of device specific &#8220;master keys&#8221;, is a time consuming activity fraught with complications and non obvious stumbling blocks, pot holes and vast chasms bordering on apparently bottom less pits financialy.</p>
<p>Oh and I think it is probably safe to assume that somewhere the NSA has the equivalent of a &#8220;master master key&#8221; or &#8220;master key list&#8221; tucked away for various &#8220;data asurance&#8221; reasons (spots tend not to change quickly on the fur of &#8220;big cats&#8221; 😉</p>
<p>Then there is the subtal issue of &#8220;Operating system and drive independant&#8221;. What it realy means is it is &#8220;transparent&#8221; that is the computer sees it as an IDE drive and the IDE drive sees it as an IDE bus controler.</p>
<p>Which means that there is a known mapping of OS Components to disk blocks.</p>
<p>Which in a lot of similar commercial products defaults to a 1:1 mapping which means you know the coresponding &#8220;plain text&#8221; for very very large parts of the hard drive.</p>
<p>Does this matter, well yes and no it depends not only on the encryption algorithm used but the mode it is used in as well.<br />
Often to maintain speed and simplicity of design the wrong mode is used irrespective of the algorithm.</p>
<p>Does this matter the answer is unfortunatly yes unless your system designers are aware of the issues and take appropriate steps (which I&#8217;m assuming the NSA have).</p>
<p>As an example I mentioned further up the blog page the dangers of &#8220;Self-Generating Storage Keys&#8221; and low entropy.</p>
<p>Well if you know the plaintext at one or more points on the disk and the encryption mode is linear and unrelated to the data then you can build a rainbow table quite quickly and easily for the low entropy keys.</p>
<p>Even if the mode is non linear (but predictable) or the IVs of data dependent modes (cipher chaining etc) are predictable then raibow table attacks will keep on working.</p>
<p>The issue is realy to do with two things,</p>
<p>1, Random access<br />
2, Speed of access</p>
<p>And it is another example of where &#8220;efficiency&#8221; is the foe of &#8220;security&#8221;.</p>
<p>And also &#8220;speed to market&#8221; and &#8220;marketing specmanship&#8221;.</p>
<p>One (very wrong) way to get speed is to use a mode where keys can be &#8220;pre-computed&#8221; that is there is no dependency on the data being encrypted. In essence you have a &#8220;stream cipher&#8221;.</p>
<p>In the simplest type a stream cipher simply XORs the plaintext with the key stream.</p>
<p>Well if you know what the plaintext is you can simply recover the key stream. Which further means you can then use the recovered key stream to encrypt your own plaintext and replace the original.</p>
<p>So a malware writer just needs to guess the OS and read the appropriate blocks off the drive, to recover the key stream and then encipher the malware and write it back to the disk&#8230;</p>
<p>Oh and if you use a &#8220;standard system&#8221; to store MD5 or other hashes of executables the malware writer can do the same trick to those so your table of MD5 hashes on the drive (without care) are kind of worthless&#8230;</p>
<p>So when you boot up the malware is running on your machine potentialy leaking secrets and no knowledge of the keys was required.</p>
<p>Could the malware get the secret keys, well that depends on the security design of the IME device. If it is very good no, if it is not so good yes through sidechannels such as timing attacks and if it is poor then probably directly.</p>
<p>The lower cost and more userfriendly the IME the more likely the security design is likely to be poor, and the differences between a poor design and a very good design are very subtal and both can be produced from the same functional description and be fully interoperable&#8230;</p>
<p>For instance for increased speed you might decide to implement AES in a &#8220;loop unrolled&#8221; fashion which can leave it vulnerable to timing attacks.</p>
<p>A designer with security in mind would opt for a slower non timing dependent AES implementation.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123673">

			<div class="comment by-mihai-criveti ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://unixsadm.blogspot.com/' rel='external nofollow ugc' class='url'>Mihai Criveti</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123673">
						October 24, 2009 5:29 AM					</a>

				</p>

				<p>There are things which add complexity to the point where it&#8217;s easier just to break the victim&#8217;s legs until they squeal out the password&#8230;</p>
<p>Chances are your hotel maid won&#8217;t pull any of those tricks unless it&#8217;s <em>easy</em>. Once things get too complex you&#8217;re usually dealing with some sort of agency, corporate espionage or people who&#8217;d more readily resort to rubber-hose cryptanalysis.</p>
<ol>
<li>
<p>Keep your laptop in a secure case (things like a hard aluminium case with lock or cipher and a Kensington lock to tie the case down won&#8217;t help you much, but it would make it kind of obvious that someone ripped out your laptop).</p>
</li>
<li>
<p>BIOS password (most laptops come with BIOS and hard disk passwords and / or fingerprint scanners). Makes it hard for the attacker to boot their own media without resetting breaking this first (it would take time and hard to hide).</p>
</li>
<li>
<p>Hash your bootloader and check it as part of a startup script. Shouldn&#8217;t be too complicated, and the attacker would have a hard time writing all the code for sending the key over wireless / internet / something with just a bootloader attack.</p>
</li>
<li>
<p>Booting the TrueCrypt rescue disk first or booting the decoy operating system to check the integrity of the bootloader.</p>
</li>
</ol>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123674">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123674">
						October 25, 2009 12:01 PM					</a>

				</p>

				<p>@ Mihai Criveti,</p>
<p>With regards your 4 points above, the first three have problems when dealing with only minorly trained &#8220;evil maids&#8221;.</p>
<p>&#8220;1. Keep your laptop in a secure case (things like a hard aluminium case with lock or cipher and a Kensington lock to tie the case down won&#8217;t help you much, but it would make it kind of obvious that someone ripped out your laptop).&#8221;</p>
<p>Lock picking is a fairly minor skill that most people can learn with a little practice. In general woman are actualy better at it due to smaller hands and more sensitive sense of touch.</p>
<p>Not that this skill is always required you would be surprised just how many &#8220;expensive&#8221; or &#8220;strong&#8221; cases have ninges where the pin can be removed without to much trouble, and most people would not think to look at them. Cheaper cases are better in this respect simply because they tend to use rivets&#8230;</p>
<p>Almost the first thing a covert operative does before touching anything is take digital photos so they can put things back the way they where.</p>
<p>I was a little bored the other day in a shop that sells laptops and accessories whilst the person who I was with chatted to the sales person about which laptop they where going to buy I noticed that they used &#8220;kensington&#8221; style four wheel combo locks on their display. I stood there with my back to it and felt the wheels into the correct combination and opened it. When the sales person started getting patronising to my friend I drew his attention to the fact it had been left unlocked, the look on his face was a picture to behold 8)</p>
<p>&#8220;2. BIOS password (most laptops come with BIOS and hard disk passwords and / or fingerprint scanners). Makes it hard for the attacker to boot their own media without resetting breaking this first (it would take time and hard to hide).&#8221;</p>
<p>As I noted above some makes and models can have their BIOS read out and reflashed without much effort.</p>
<p>&#8220;3. Hash your bootloader and check it as part of a startup script. Shouldn&#8217;t be too complicated, and the attacker would have a hard time writing all the code for sending the key over wireless / internet / something with just a bootloader attack.&#8221;</p>
<p>Yes get a hash of your boot loader and the critical OS files, but put them and the checking program on write protected media you carry in your wallet. The startup script on the laptop is as vulnerable as any other part of it as are any hashes you&#8217;ve stored on it.</p>
<p>With regard to the hardness of writing a bootloader to &#8220;sending the key over wireless / internet / something&#8221; you are thinking about it in the wrong way. All they realy need to do is enable a back door at the IO level to send your keystrokes out. Most of the code is already written for them either in the bios code (netboot) or OS driver code. And due to legacy issues there are ways you can get IO code past various OS startups&#8230;</p>
<p>This sort of information and abilities are most certainly well within the abilities of current criminal gangs who ship stolen laptops mobile phones and high end motor cars to various &#8220;no questions asked&#8221; countries in various parts of the world&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123675">

			<div class="comment by-simon ">

				<p class="commentcredit">

					<span class="commenter">Simon</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123675">
						October 25, 2009 3:24 PM					</a>

				</p>

				<p>@milo &#8211; many different ways.<br />
Here&#8217;s one:</p>
<p>Unplug drive in laptop which uses Bitlocker, at SATA. Plug laptop drive into &#8220;other&#8221; machine. Spin up and rewrite MBR using other machine, for example write raw physical sectors with CreateFile (to get handle), SetFilePointer (to sector zero), then WriteFile. What you write to the MBR is intended to redirect process flow upon bootup to another area on the drive. Do you need details of latter?<br />
Then replace connections.<br />
Another is to swap drive so laptop starts up exactly like user expects, but it&#8217;s a dummy. Password pumped out to &#8220;other&#8221; location. By the time user thinks drive is hosed,  password is used at other location to start up original drive.<br />
HW features can prevent scenarios like this, but then attack path can be different.<br />
Do you want to do this remotely without touching the machine?<br />
Ultimately the problem with encrypted drives of all types is that the drive can be removed to another location and there, the attackers can do anything they want and can take all the time they need and can even continue deceiving you to their ends. Worse, you will never know if they succeeded or not. Same thing with using alternative drives to boot with.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123676">

			<div class="comment by-arno ">

				<p class="commentcredit">

					<span class="commenter">Arno</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123676">
						October 25, 2009 10:15 PM					</a>

				</p>

				<p>Incidentally, an attacker with access to your hardware can also install a hardware keylogger that is completely transparent to software. This device can then collect passwords at its leisure. Getting the collected data requires a second access, which can either again be physical, possibly leaving no traces and never having done anything software can detect or may require system compromise and some signaling to the device, e.g. via the keyboard LEDs.</p>
<p>Advanced versions may even listen to the TPM communication, which may break disk encryption based on it. After all the TPM does not do the disk crypto itself, and the session key for the disk does not change, so it is reasonable to expect it to be given to the host CPU at some time. (I may be mistaken, it has been a long time since I looked at what a TPM does.)</p>
<p>Of course this attack is expensive and likely requires a customized &#8220;bug&#8221;. It is still feasible and cheap enough to qualify as an industrial espionage tool.</p>
<p>Anyways, this example serves to demonstrate that with physical access most bets are off. This is neither new nor surprising.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123677">

			<div class="comment by-ano ">

				<p class="commentcredit">

					<span class="commenter">Ano</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123677">
						October 26, 2009 7:19 AM					</a>

				</p>

				<p>Hi,</p>
<p>two factor authentication didn&#8217;t help at all.</p>
<p>PGP Wholedisk/Truecrypt/etc. is not more secure with Smartcard than without.</p>
<p>Stoned bootkit with minimal enhancements could sniff the master key for HDD decryption (must be in RAM from computer). It&#8217;s not nessacery to access content or PIN of the smartcard.</p>
<p>PS: This posting wasn&#8217;t approved at pgp blog &#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123678">

			<div class="comment by-eric-jacksch ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://jacksch.com' rel='external nofollow ugc' class='url'>Eric Jacksch</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123678">
						October 26, 2009 7:48 AM					</a>

				</p>

				<p>A briefcase designed to resist surreptitious entry is a good supplement to whole hard drive encryption.  Govements have used them to transport sensitive documents and hardware for years.  Perhaps time the commercial sector pays attention?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123679">

			<div class="comment by-anothersolution ">

				<p class="commentcredit">

					<span class="commenter">AnotherSolution</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123679">
						October 26, 2009 9:37 AM					</a>

				</p>

				<p>Buy a powerful and small computer (iPhone). Always keep it with you. Buy an external LCD screen and keyboard that you can connect to your iPhone.</p>
<p>You may leave the external LCD screen and keyboards in your hotel room.</p>
<p>Never type a password on the external keyboard (use the iPhone keyboard).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123680">

			<div class="comment by-elijah ">

				<p class="commentcredit">

					<span class="commenter">Elijah</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123680">
						October 26, 2009 12:53 PM					</a>

				</p>

				<p>what would you do if someone kidnapped you and your family and threatened to kill them while torturing you if you did not give them the password?  Would you die for your encryption?  This is hardly worthy of an article.</p>
<p>What can you do against math, and an antenna picking up the EM signal from your monitor?</p>
<p>The suitcase idea is pretty good, but you&#8217;re still not 100% secure.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123681">

			<div class="comment by-arno ">

				<p class="commentcredit">

					<span class="commenter">Arno</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123681">
						October 26, 2009 1:22 PM					</a>

				</p>

				<p>@Elijah: Simple: If your secrets are that important, some TLA (Three Letter Agency) will kill your family in an &#8220;accident&#8221;, so that the situation cannot arise in the first place.</p>
<p>Incidentally, nobody needs 100% security. It just has to be better than the effort the attacker is willing to invest.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123682">

			<div class="comment by-karrde ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://wildekarrde.mee.nu' rel='external nofollow ugc' class='url'>karrde</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123682">
						October 26, 2009 2:10 PM					</a>

				</p>

				<p>Clive, et al,</p>
<p>WRT resetting BIOS passwords.</p>
<p>In my experience, I have seen one laptop computer nearly-bricked because of a BIOS password. After three hours on the phone with the manufacturer&#8217;s Tech Help, it was revealed that a paper-clip could be used to reset the BIOS to factory standard in 30 seconds.</p>
<p>That is, a knowledgeable person with a paperclip could reset the BIOS password on the laptop in a period of 30 seconds.</p>
<p>This particular event was in the late 1990&#8217;s, and I do not know if the reset method has changed since then. (My bet is that it hasn&#8217;t, for most laptops provided by big-name suppliers&#8230;paperclip-based methods are too useful to give up for such resets.)</p>
<p>This doesn&#8217;t alter the indication to the user that something has changed (the BIOS didn&#8217;t ask for its password), but it does show that BIOS passwords will not stop a knowledgeable person from booting your machine off of boot media of their choice.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123684">

			<div class="comment by-guy ">

				<p class="commentcredit">

					<span class="commenter">Guy</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123684">
						October 26, 2009 2:39 PM					</a>

				</p>

				<p>Would locks on the USB or Firewire ports help?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123685">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123685">
						October 26, 2009 2:57 PM					</a>

				</p>

				<p>@Guy: &#8220;Would locks on the USB or Firewire ports help?&#8221;</p>
<hr />
<p>Based on my understanding, no.</p>
<p>It was never the encryption, the ports, the files, or any USB that were attacked.  The computer implementation was attacked to basically log as the user typed in the encryption key/password.</p>
<p>The USB issue may keep them from the data, but they still have your key/password, so it depends on their goal.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123686">

			<div class="comment by-babak-memari ">

				<p class="commentcredit">

					<span class="commenter">Babak Memari</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123686">
						October 26, 2009 10:54 PM					</a>

				</p>

				<p>theoretically there is no new thing in this paper, but practically there is one new thing. If there is no hardware key loggers<br />
you can make a mini cd bootable like BartPE   <a href="http://www.nu2.nu/pebuilder/" rel="nofollow ugc">http://www.nu2.nu/pebuilder/</a><br />
and run Encrypting Software from inside of it. so you can bypass this EvilMaidUSB Keylogger.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123687">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123687">
						October 27, 2009 1:25 AM					</a>

				</p>

				<p>@ karrde,</p>
<p>&#8220;the manufacturer&#8217;s Tech Help, it was revealed that a paper-clip could be used to reset the BIOS to factory standard in 30 seconds&#8230; &#8230;and I do not know if the reset method has changed since then. (My bet is that it hasn&#8217;t, for most laptops provided by big-name suppliers&#8230;paperclip-based methods are too useful to give up for such resets.)&#8221;</p>
<p>As always yes and no.</p>
<p>Thr paperclip method used to be the equivalent of removing the power to the battery backed RAM.</p>
<p>The RAM would lose the &#8220;password&#8221; and the &#8220;checksum&#8221; of the password.</p>
<p>When the code runs on next reboot the contents of the password and checksum don&#8217;t match the software branches to &#8220;first time&#8221; mode which is what is known as &#8220;factory reset&#8221; and writes in the blank or known password.</p>
<p>On some machines these days there is a second branch in the factory reset mode. If a certain &#8220;hardware signal&#8221; is applied it simply does not reset the password and checksum field and enables extended BIOS &#8220;test&#8221; features.</p>
<p>The reason being for the techs working on repairs etc. It leaves the user password in place (if not corupted) and alows the tech to run diagnostic tests.</p>
<p>Now the important thing to remember is that often the BIOS password is in &#8220;plain text&#8221; and since the early days of DOS there has been a little &#8220;com&#8221; program that will read it out and display it on the screen&#8230;</p>
<p>Nearly all laptops have some kind of &#8220;tech&#8221; mode in one form or another even if it is just &#8220;PXE Boot&#8221;. Invariably all of these systems are designed to minimise labour costs or maximise &#8220;tech&#8221; efficiency so they tend to be quick and simple even on commercial &#8220;high security&#8221; laptops.</p>
<p>These &#8220;factory&#8221; and &#8220;tech&#8221; and &#8220;test&#8221; modes are a in nearly all hardware in on form or another, including &#8220;encrypting HD&#8217;s&#8221;.</p>
<p>The &#8220;secret&#8221; is often the &#8220;hardware signal&#8221;. As has been seen from the mobile phone handset &#8220;unlocking&#8221; &#8220;gold boxes&#8221; these signals get out and if there is a market for a device that replicates it (and there is) then it gets made.</p>
<p>It is a well known problem in other areas such as Sat/Cable TV set top boxes.</p>
<p>The classic example being in Europe with &#8220;Sky Decoder cards&#8221;. Where Sky by their own choice did not put in a sufficiently secure system at the start. This was broken, and again Sky by their own choice did not incresse the security sufficiently. Sky went through this loop something like ten times before they finally put in enough security.</p>
<p>The silly thing is that with Sky if they had originaly put in place the level of security they had on the fourth round then it would probably have been sufficient. However by putting in a weaker system and alowing a market place for &#8220;cracking&#8221; devices to develop they effectivly created a well funded and therefore more capable and determined set of oponents&#8230;</p>
<p>We are currently seeing this sort of &#8220;arms race&#8221; being repeated with the banking industry.</p>
<p>I for one saw the need for two way transaction authentication on &#8220;phone banking&#8221; (the forerunner of web banking) well over ten years ago and did work on solving the problem. The risks I identified where carried on into web banking, and we saw the build up of a market to exploit the weaknesses.</p>
<p>I liken the process to &#8220;mountin climbing&#8221;. Nobody starts of being a mountin climber they have to develop their skills and get/develop support equipment which forms a &#8220;market&#8221;. This only happens if there is an incentive to do so, or to put it the otherway you get an increasing reward as you move from moorland walking to hills then fells and then cliffs etc.</p>
<p>Sometimes you have to suffer the pain of putting in considerably more security at the start to stop a market developing in order to save yourself signifficant pain and diversion of resources at a later date&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123688">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123688">
						October 27, 2009 1:43 AM					</a>

				</p>

				<p>@ Babak Memari,</p>
<p>&#8220;you can make a mini cd bootable like BartPE and run Encrypting Software from inside of it. so you can bypass this EvilMaidUSB Keylogger.&#8221;</p>
<p>Sadly no it does not work with older MS OS&#8217;s due to backwards compatability issues.</p>
<p>The original PC boot up sequence (POST) allowed hardware IO devices to install their own software into the memory and IO map of the PC. The MS OS&#8217;s used to &#8220;respect&#8221; this and level the code in place. The modern equivalent of this is &#8220;plug and play&#8221; on PCI and above cards and autorun on media detection that you see with GSM etc mobile broadband dongles.</p>
<p>MS have claimed they have finaly fixed this in Win7 by requiring all hardware drivers to be &#8220;signed&#8221;.</p>
<p>However &#8220;code signing&#8221; suffers from the GIGO effect even after code review. And lets face it with various DMA modes and untrusted code running on the actuall IO CPU that the MS OS cannot see it&#8217;s a bit of a mute point anyway as there are not the hardware support features built in to make it work securely.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123689">

			<div class="comment by-cassandra ">

				<p class="commentcredit">

					<span class="commenter">Cassandra</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123689">
						October 27, 2009 3:58 AM					</a>

				</p>

				<p>With all this talk of hardware keyloggers, I&#8217;m mystified as to why there doesn&#8217;t seem to be a market for transparent laptops, keyboards and mice, so you can do a visual check for installation of keyloggers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123690">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123690">
						October 27, 2009 1:05 PM					</a>

				</p>

				<p>@ Clive</p>
<p>Nice analysis of IME. I think it came up short in two ways. First, it should support hibernation mode with little to no tweaks. This is because its transparent to OS and hibernation data would be encrypted as well. If encryption done properly, I&#8217;m not too worried about known plaintext attacks. The other beef is that my post concerned a device &#8220;like&#8221; IME: without Type 1 algorithms, master keys, etc. If NSA&#8217;s IME was an RSA PKI suite, then this IME would be the first PGP. See what I&#8217;m saying?</p>
<p>That BIOS attacks could be performed without opening the system was new to me. I was thinking about burning those debugging ports off the board, but I&#8217;m naturally concerned about survival of board functions. My scheme included many elements and BIOS security is just an obstacle.</p>
<p>The real security comes from using read-only boot media, cheap (i.e. easily replaced) netbook, tamper-evident seals, and data on external encrypted media. These tools are combined with certain policies about handling the equipment. For instance, if the data is really sensitive and I&#8217;m paranoid, I might go outside to random spot and lean against a wall while keying in my password. Or I might travel with a pocket-sized PC (think Fit PC) and just leave a transparent monitor, keyboard and mouse in my hotel room. Maybe I purchase random keyboard every day (relatively cheap). I can activate the PC with a token and enter password with a portable keyboard that stays on me&#8230; outside of the hotel room&#8230; then bring it back in and connect it to untrusted components. All of this uses commodity equipment and this is anonymously purchasable in the country your traveling to. The schemes have many other possibilities and I choose the specifics based on a risk assessment and likely attack vectors. I never use the same approach twice.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123691">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123691">
						October 27, 2009 4:00 PM					</a>

				</p>

				<p>@ Nick P,</p>
<p>Don&#8217;t get me wrong I like IME&#8217;s more than I like encrypting hard drives (for various reasons). But would happily use both in a &#8220;belt and braces&#8221; mode, but in either case the powersupply gets disconected before it leaves my sight.</p>
<p>The real problem with both of them is that they are transparent and therefor have the &#8220;keys&#8221; on them whilst still powered up after being in use, unless specific steps are taken to remove the keys&#8230;</p>
<p>Not having had the chance to play with the NSA IME I&#8217;ve had to work on what I&#8217;ve been told about it&#8217;s use of the CIK (which may be incorect). Apparently on the old style &#8220;transmission&#8221; equipment CIK&#8217;s where designed to be effectivly &#8220;pass through&#8221; and if pulled from the device it instantly stoped working.</p>
<p>What I have been led to belive is that in the NSA IME due to certain issues the CIK is no longer effectivly &#8220;pass through&#8221; and if the CIK is pulled the key is not instantly gone from the IME (if this matters and to what extent is unknown to the person who was telling me).</p>
<p>Any way back to the issue of transparancy and more general IME&#8217;s and the problem of the low power quick start modes of sleep / hibernation / suspend to disk / etc</p>
<p>Depending on the &#8220;how&#8221; of the mode and the design of the IME, it may end up holding the key whilst in the suspended state, thus it is still transparent when the user leaves it&#8230;</p>
<p>Now there are issues to do with &#8220;plug-n-pray&#8221; devices and U3 USB devices on IBM style PC&#8217;s and if you remember firewire on Apple kit.</p>
<p>When pluged in they get access to the hardware at a very low level.</p>
<p>One such access mechanisum is Direct Memory Access (DMA) and other Bus Mastering access. Having &#8220;signed driver&#8221; software in a traditional kernel design is not going to stop the device stomping all over memory if it feels like it, only properly designed and configured hardware can do that and only under some circumstances.</p>
<p>What you may have noticed on some laptops is a little flap on the underneath that hides a long multi contact connector. This &#8220;expansion connector&#8221; is supposadly for docking stations. However it is often the equivalent of a PCI or AT card slot which means that you could quite easily design a device to suspend the CPU and take over from it and with &#8220;transparent&#8221; devices like the IME or encrypting hard drives it&#8217;s game over at that point if they still hold the key&#8230;</p>
<p>Which is why the NSA IME spec very clearly talks about &#8220;data at rest&#8221; when the &#8220;Crypto Ignition Key&#8221; is seperate from the IME as being the only secure mode.</p>
<p>What I do like is your &#8220;imutable boot&#8221; solution it was how it used to be in the old days of embedded systems with real ROM chips soldered into the PCB 8)</p>
<p>What it appears to lack from your brief overview is a side channel token system for end to end authentication and checking.</p>
<p>Now I&#8217;m not sure but you alude to having an IME with Public Key on it. I had thought about using &#8220;oblivious transfer&#8221; via a shared secret unique to the IME and external token then it does not matter how much &#8220;key logging&#8221; or other code is put onto the PC as the malware will learn nothing of the encryption key from watching the &#8220;key transfer&#8221; from token to IME and it cannot be used for replay attacks either.</p>
<p>Further if Intel or AMD provided a suitable internal encryption device to the CPU then the IME could be used as a &#8220;key translator&#8221; such that data encrypted on the HD under one key would be be decrypted and re encrypted under the CPU key. Thus only the CPU ever gets to see the plain text data to work on. This sort of behaviour should be possible as part of TPM but as always the devil is in the details.</p>
<p>However this would be one small part of an overall system as I have previously outligned to you what we realy need is an apropriate framework and hyporvisor system 😉</p>
<p>Not impossible to get around (covert channels being what they are) but not the comparative walk in the park it currently is with commodity PC hardware which is designed to be &#8220;efficient&#8221; and low cost not &#8220;secure&#8221;.</p>
<p>Oddly I have recently been looking at the design of such a high availability system around PC104 cards in a blade type solution for a proposal and realisticaly I think it can be done without resorting to a total custom solution 8)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123692">

			<div class="comment by-dr-t ">

				<p class="commentcredit">

					<span class="commenter">Dr. T</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123692">
						October 27, 2009 5:30 PM					</a>

				</p>

				<p>&#8220;This attack exploits the same basic vulnerability as the &#8220;Cold Boot&#8221; attack from last year, and the &#8220;Stoned Boot&#8221; attack from earlier this year, and there&#8217;s no real defense to this sort of thing.&#8221;</p>
<p>There is a relatively easy defense. Before decrypting your hard drive, the operating system could check to see if anything had been written since your last session. If so, the OS refrains from decrypting the drive and issues a warning. You won&#8217;t know what was written, but you could take precautions such as disconnecting from a network, deactivating wireless connections, or transferring your drive to a secure computer for examination by a security expert.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123693">

			<div class="comment by-paeniteo ">

				<p class="commentcredit">

					<span class="commenter">Paeniteo</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123693">
						October 28, 2009 5:23 AM					</a>

				</p>

				<p>@Dr. T: &#8220;Before decrypting your hard drive, the operating system could check to see if anything had been written since your last session.&#8221;</p>
<p>And how exactly would the OS know that?<br />
Or do you think a trojan would be honest enough to update fileaccess-timestamps?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123694">

			<div class="comment by-milo ">

				<p class="commentcredit">

					<span class="commenter">Milo</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123694">
						October 28, 2009 2:11 PM					</a>

				</p>

				<p>@Simon</p>
<p>Here&#8217;s one:<br />
(&#8230;)</p>
<p>You don&#8217;t get it &#8211; if you are talking about Full Disk Encryption (real one, not parial advertised by some people as FDE) you are unable to rewrite MBR &#8211; it&#8217;s encrypted too. With same effect you can try to owerwrite part of encrypted file. With proper tool (GnuPG, TrueCrypt &#8211; you name it) and strong key (yeah, you can always throw random crap there). You are unable to do that in scenario mentioned by me earlier&#8230; Using another machine is useless because you have to decrypt disk first. And to do that you must have key (assuming that you don&#8217;t know any useful software bug). In real life in such disk there will be no MBR, because system isn&#8217;t booting from FDE disk &#8211; it&#8217;s using external media. I don&#8217;t care about what you can do with bitlocker or whatever if it isn&#8217;t encrypting <em>whole</em> disk.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123695">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123695">
						October 28, 2009 3:28 PM					</a>

				</p>

				<p>@ Milo</p>
<p>Yes, that is why the NSA made their IKE encrypter inline. So long as the entire drive is encrypted, which inline or onboard devices [should] do, then MBR and even hibernation &amp; page files are indeed protected. For whole disk encryption, the attacker will hit the BIOS, use hardware attack, put in a video camera or software attack on system after its running (real easy). I still recommend whole disk because it reduces risks from laptop thefts, which are quite common.</p>
<p>@ Clive</p>
<p>Glad you like the immutable boot. It&#8217;s my strongest defense, along with reduction of DMA devices and selecting random suppliers for a given unit. In my red-black link/voice encrypter designs, I use only serial lines to connect the device. It&#8217;s fast enough for many applications, has no DMA, and has drivers for almost every real-time or secure OS out there. I wish I was more hardware inclined though so i could improve that. What else is non-DMA but faster than serial? And easy to write drivers for?</p>
<p>Yes, I did leave out some things like authentication. I generally have to use very different schemes for different devices. I also try to reduce the use of public-key. For instance, many encryptors use asymetric for both key exchange and to sign messages. My schemes usually create an encryption and authentication key, use asymetric for key exchange, and then use symetric for encryption and authentication. Symetric is easier to get right, is faster and this reduces hardware cost. If I use a read-only, secure ROM, I would have certain public keys hardcoded in it. These would be key-signing keys used for authentication of updates, other devices, etc. In updating, for instance, I hash the new bootable software, sign the hash, and then on boot I just rehash it as its loaded into memory, check the signature and if it matches go with it. This way, firmware never needs updating: it just loads signed code or signs code after validation, using hardcoded public keys. It&#8217;s kind of a root of trust method like TPM&#8217;s, but no goofy PCR&#8217;s and everything happens on the processor.</p>
<p>As for your hypervisor, we already have those: the separation kernels, with modified scheduling algorithms. LynxSecure is a good example, as it strongly relies on Intel&#8217;s hardware extensions. I think what we really need is trusted, security-oriented CPU&#8217;s. We already have some, like Rockwell-Collin&#8217;s AAMP7G, but they aren&#8217;t cheap or civilian oriented. I would prefer a POWER-based RISC design for easier validation of microcode. As for your HA on the cards, I think LynxOS offers a really low-level HA solution at SBC board level. I&#8217;d like to hear more about your design, though, to see what makes it unique.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123696">

			<div class="comment by-babak-memari ">

				<p class="commentcredit">

					<span class="commenter">Babak Memari</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123696">
						October 28, 2009 10:11 PM					</a>

				</p>

				<p>Is there any same attack for PGP?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123697">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123697">
						October 29, 2009 1:18 AM					</a>

				</p>

				<p>@ Babak</p>
<p>Yes. The kinds of attacks that work on one disk encryption program usually work on the next. The attackers usually have to change the implementation, though. This doesn&#8217;t seem to be a big deal in most cases: the old FireWire and cold boot attacks were used on TrueCrypt and PGP.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123698">

			<div class="comment by-piskvor ">

				<p class="commentcredit">

					<span class="commenter">Piskvor</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123698">
						October 29, 2009 2:32 AM					</a>

				</p>

				<p>@Cassandra: Because the devices are too complicated for this check to be effective? Took my wireless mouse apart once: it&#8217;s a 3-layer PCB sandwich; even if it were transparent, a device hidden between the PCBs would probably escape visual detection. This holds even stronger for the laptops, where the manufacturer tries to cram as many features as possible into the smallest space &#8211; check a netbook&#8217;s disassembly instructions, even with the covers off, it&#8217;s an unholy jumble of components. One small chip more or less, who&#8217;ll notice?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123699">

			<div class="comment by-thorne ">

				<p class="commentcredit">

					<span class="commenter">Thorne</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123699">
						October 29, 2009 2:50 PM					</a>

				</p>

				<p>Imho the evil maid is the one who tries to check her mail on your laptop and causes you to spend all of the time and energy restoring your trusted computing environment for nothing&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123700">

			<div class="comment by-joao ">

				<p class="commentcredit">

					<span class="commenter">Joao</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123700">
						October 29, 2009 7:50 PM					</a>

				</p>

				<p>Let&#8217;s see&#8230;</p>
<p>Change in the MBR (boot), If it&#8217;s the only thing changed&#8230; the TrueCrypt team could make a area to define challenge questions/answers&#8230; like &#8220;How are you today?&#8221; (the user introduces the question) and the TrueCrypt would answer for example: &#8220;I&#8217;m fine, let&#8217;s boot today or tomorrow?&#8221;. The point is, you would define some questions and answers and the loader would give you the answers to your questions&#8230; the bad guy will not know your question/answer so you would immediately spot that it is a fake one. And stop introducing the password until you know what has happen to the computer while you were out.</p>
<p>Change to the bios&#8230; Gigabyte produces motherboards with dual bios&#8230; if some malware or flash operation goes wrong it can recover from the fixed one.</p>
<p>You can protect the bios with password.</p>
<p>In some bios you can disable the upgrade of the bios.</p>
<p>You can put special seals that you can visually inspected when you arrive to your computer&#8230; if they have been tampered&#8230; some one change something inside your computer&#8230; not good!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123701">

			<div class="comment by-babak-memari ">

				<p class="commentcredit">

					<span class="commenter">Babak Memari</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123701">
						October 30, 2009 2:01 AM					</a>

				</p>

				<p>how can we bypass this attack?</p>
<p>1-should we use a Master Boot Record Checker always?</p>
<p>2-Should we remove the encrypted hard disk always and carry it with ourselves?</p>
<p>3-Should we remove the hard disk and always use an external small portable hard disk?</p>
<p>4-should we use DOS OS?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123702">

			<div class="comment by-babak-memari ">

				<p class="commentcredit">

					<span class="commenter">Babak Memari</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123702">
						October 30, 2009 2:08 AM					</a>

				</p>

				<p>Reinstalling BIOS  or Flashing BIOS does remove it or not?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123703">

			<div class="comment by-babak-memari ">

				<p class="commentcredit">

					<span class="commenter">Babak Memari</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123703">
						October 30, 2009 2:28 AM					</a>

				</p>

				<p>is it possible to make a backup of MBR in a mini cd bootable like BartPE, and after first boot we can rewrite the  backuped MBR on the current MBR , then on the next boot , we can run the original OS or boot from mini cd bootable like BartPE.<br />
<a href="http://www.ranish.com/" rel="nofollow ugc">http://www.ranish.com/</a></p>
<p>what is your ideas?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123704">

			<div class="comment by-babak-memari ">

				<p class="commentcredit">

					<span class="commenter">Babak Memari</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123704">
						October 30, 2009 2:39 AM					</a>

				</p>

				<p>or this one<br />
<a href="http://dimio.altervista.org/eng/" rel="nofollow ugc">http://dimio.altervista.org/eng/</a><br />
HD HACKER</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123705">

			<div class="comment by-scorpius ">

				<p class="commentcredit">

					<span class="commenter">Scorpius</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123705">
						November 5, 2009 3:52 PM					</a>

				</p>

				<p>Please type &#8220;laptop pci keylogger&#8221; into google and browse the results.<br />
Ex. <a href="http://masbuchin.com/laptop-hardware-keylogger-in-a-mini-pci-card.htm" rel="nofollow ugc">http://masbuchin.com/laptop-hardware-keylogger-in-a-mini-pci-card.htm</a></p>
<p>All you have to do is to open laptop, insert this card.<br />
Wait and get 1 minute access to laptop later to retrieve card.</p>
<p>I believe TPM would help here.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123706">

			<div class="comment by-simon-bridge ">

				<p class="commentcredit">

					<span class="commenter">Simon Bridge</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123706">
						November 8, 2009 9:55 PM					</a>

				</p>

				<p>All the above boil down to &#8211; do not leave your computer where the maid can get it.</p>
<p>At the least, remove important bits of it when you go.</p>
<p>The exact strategy depends on what you care about. But I don&#8217;t think this is a new attack. Bruces lesson is that FDE is not the protection some people seem to think that it is.</p>
<p>An interesting theme emerging from above though is the variety of options available to you if you do not use a proprietary OS or rely on proprietary security systems.</p>
<p>We have the old distinction between FDE and <em>whole</em> disk encryption &#8211; where, in the latter, there are no unencrypted parts of the media. In single disk systems, there has to be something unencrypted there or the program which authenticates you cannot run. This leads to the suggestions to take the authentication and boot system with you when you leave the computer. The maid may install a custom bootloader to your computer, but your computer is not using software on the computer to boot so it sits there and does nothing. This is part of the &#8220;do not leave the computer alone&#8221; solution.</p>
<p>2-factor authentication &#8211; something you know and something you have &#8211; is debated back and forth. It does not stop the attack finding out your key (what you know) but that does the attacker no good if they don&#8217;t have the other token (something <em>you</em> have) &#8230; which, for some reason is assumed to be a smartcard. It is much more general than that &#8211; eg. it could be a physical part of the computer.</p>
<p>But this still wanders off the main point &#8211; we are no longer relying on encryption to keep the data secure&#8230; remember the lesson?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123707">

			<div class="comment by-simon-says ">

				<p class="commentcredit">

					<span class="commenter">Simon Says</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123707">
						November 9, 2009 5:03 AM					</a>

				</p>

				<p>I think really the most practical protection from this type of attack without the need for a TPM device is this except it doesn&#8217;t apply to laptops:</p>
<p>1) Use a usb token for two-factor authentication.</p>
<p>2) Make BIOS pw protected and only boot from encrypted drive and nothing else.</p>
<p>3) Put loads of padlocks and locks on your case to prevent it from being turned on and from being opened at all and to prevent the hard drive being taken out to be put in another computer .<br />
This wont help for a laptop but you could always put the laptop in a safe.</p>
<p>4) When going to use your computer instead of booting from encrypted hard drive, boot from a boot cd repair disc, like the one for pgp that lets you check and repaid the MBR if found to be corrupted.</p>
<p>I really dont see how someone could execute this attack if someone did this.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123708">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123708">
						November 9, 2009 5:47 AM					</a>

				</p>

				<p>@ Simon Says,</p>
<p>&#8220;I really dont see how someone could execute this attack if someone did this.&#8221;</p>
<p>It depends on which OS you go into from your CD&#8230;</p>
<p>It can be done by overwriting the flash in the BIOS or IO devices.</p>
<p>MS OS&#8217;s for instance used to &#8220;respect&#8221; code in certain parts of the memory map reserved originaly for loadable IO drivers stored on the IO card.</p>
<p>The PCI spec likwise alows for IO driver software to be loaded as does the &#8220;Plug-n-Pray&#8221; system.</p>
<p>Also a small device conected to any of the IO devices that use DMA can load executable code into the system main memory bypassing any security.</p>
<p>Oh and have a look at the U3 USB spec it might make your eyes open&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123709">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123709">
						November 9, 2009 6:38 AM					</a>

				</p>

				<p>@ Simon Bridge,</p>
<p>&#8220;&#8230; we are no longer relying on encryption to keep the data secure&#8230;&#8221;</p>
<p>Actualy the lesson is a little more subtal than that.</p>
<p>&#8216;The easiest way around security is via an &#8220;end run&#8221; around it&#8217;</p>
<p>For instance why add a &#8220;key logger&#8221; to someones system when a 2.4GHz low light miniture CCTV will shoulder surf almost undetectably.</p>
<p>Why put software on a users system when you can wake it up / boot it off of a combind Mobile broadband and memory USB key and slurp the entire HD / RAM contents out over the wirless network using an updated version ot the Coronors Toolkit.</p>
<p>Oh and a whole bunch of other little technical end run tricks.</p>
<p>Then there are the human weakneses to work with such as web browsing as well&#8230;</p>
<p>But hey as long as you have an umberella and a portable radio you can stop most non contact end runs.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123710">

			<div class="comment by-jmdesp ">

				<p class="commentcredit">

					<span class="commenter">jmdesp</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123710">
						November 9, 2009 12:45 PM					</a>

				</p>

				<p>A funny thing is that the most protected commonly used device against this kind of attack is probably the latest generation of iPhone.</p>
<p>It now has a very cleanly implemented secure boot. Except that finding vulnerabilities inside it is a cat and mouse game, and currently the cat is winning with yet another vulnerability found in the very latest 05.11.07 baseband code.</p>
<p>But Apple just has to update it, and given that the baseband is a small amount of code, they can  succeed to release one without any vulnerability, hackers spent monthes thinking they might not find any inside the 05.11.07 version. And on that day you&#8217;ll just have to hard reset your iPhone after the maid gives it back to you to make it secure again.<br />
It&#8217;s a plus that it&#8217;s not easy to open it (but possible).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123711">

			<div class="comment by-prasanna ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.startupit.org' rel='external nofollow ugc' class='url'>prasanna</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123711">
						November 11, 2009 10:44 AM					</a>

				</p>

				<p>Just a thought: Wouldn&#8217;t setting a BIOS level password and disabling boot from other medias like CD, USB prevent someone from planting a malware at boot (ofcourse we could still have encryption)?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123712">

			<div class="comment by-colin-jia-zheng ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://colin.co-rp.org' rel='external nofollow ugc' class='url'>Colin Jia Zheng</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123712">
						November 11, 2009 12:22 PM					</a>

				</p>

				<p>Modifying MBR and DOS compatibility region is indeed a potential attack for software full disk encryption (eg using dm-crypt).  Imagine that someone has physical access to your laptop (eg you left it at a friend&#8217;s home for a night).</p>
<p>I know two workarounds for this attack.</p>
<ol>
<li>
<p>Make a script to verify, during boot, that MBR + DOS compatibility region is unchanged.  You can store it as a file in an encrypted partition, and do a diff.</p>
</li>
<li>
<p>Use hardware encryption (will gradually replace software full disk encryption, or so I hope)</p>
</li>
</ol>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123713">

			<div class="comment by-tom-trottier ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://Information.Architecture.Abacurial.com' rel='external nofollow ugc' class='url'>tOM Trottier</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123713">
						November 11, 2009 6:17 PM					</a>

				</p>

				<p>@Piskvor &#8211; so make  the PCB boards transparent as well as the case. Have a light at the bottom so new shadows are easily noticed.</p>
<p>tOM</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123714">

			<div class="comment by-sven-turpe ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://erichsieht.wordpress.com/category/english/' rel='external nofollow ugc' class='url'>Sven Türpe</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123714">
						November 16, 2009 6:01 AM					</a>

				</p>

				<p>Mind that a TPM does not support trusted boot, it supports only authenticated boot. A TPM does not prevent the boot process from being altered, it only prevents keys from being released after the TPM became aware of alterations. The claim that BitLocker &#8220;100% defends against this hacked bootloader attack&#8221; is therefore wrong. You can modify the bootloader of a system with BitLocker, and system will execute the manipulated code, and this may be sufficient for an attacker to get the key. Trusted computing makes such attacks slightly more difficult but does not prevent them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123715">

			<div class="comment by-evilmaidpwnie ">

				<p class="commentcredit">

					<span class="commenter">evilmaidpwnie</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123715">
						November 18, 2009 1:49 AM					</a>

				</p>

				<p>evil maid can be nominated for pwnie awards&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123716">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">Bob</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123716">
						November 20, 2009 10:46 AM					</a>

				</p>

				<p>As far as I know it&#8217;s only if you encrypt the hard drive that you can become vulnerable using TrueCrypt, virtual containers are still fine though.</p>
<p>I definitely don&#8217;t recommend using Microsoft&#8217;s Bitlocker mainly because I just don&#8217;t trust Microsoft&#8230; if I know them well enough then they will have created a backdoor where Law Enforcement can get hold of the encryption keys.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123717">

			<div class="comment by-packagedblue ">

				<p class="commentcredit">

					<span class="commenter">PackagedBlue</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123717">
						November 20, 2009 8:45 PM					</a>

				</p>

				<p>Computer security and crypto is really only for those with access to intelligence agencies, or serviced based &#8220;clipper chip&#8221; type security.</p>
<p>I fear we have lost the right to be secure in our private papers, now, everything is a negotiation.  Heck, the constitution is a joke today, not even worth the amount it it can be printed on.</p>
<p>A new consumer ownership society is coming, for better and for worse.</p>
<p>Googles new efforts at trusted computing, chromium, is coming, and probably will be good enough, and might even solve &#8220;Evil Maid&#8221; attacks someday.</p>
<p>Custom computer work is going to become an interesting field, with little market left and incentives to specialize.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123719">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123719">
						November 21, 2009 4:40 AM					</a>

				</p>

				<p>@ PackagedBlue,</p>
<p>&#8220;Custom computer work is going to become an interesting field, with little market left and incentives to specialize.&#8221;</p>
<p>Hmm not sure what you mean by &#8220;Custom computer work&#8221;.</p>
<p>But the move to *nix and Jmee etc is most definatly on the up and up.</p>
<p>If you think about it a lot of mobile phones and other &#8220;gadgets&#8221; now have 32bit micros with VM hardware built in and as the price falls the old 8 and 16 bit micros are effectivly being priced out of all but mass manufacture FMCE. Which means it won&#8217;t be that long before your &#8220;white goods&#8221; have more computing power than 1980&#8217;s mainframes (any one remember the old Internet joke about the King and the toaster with the OO people chucked in the moat? How time makes idiots of us all 😉</p>
<p>An interesting turn up in the market has been work by the likes of Nokia and Google. Steve &#8220;barmy&#8221; at MS will probably get mega stress every time he sees an MS (blue or orange) worker with an iPhone. Especialy as HTC who supposadly made 80% of Windows Mobile is migrating across to Google&#8217;s Android and MS&#8217;s market share has declined by about the same amount as Android has picked up.</p>
<p>As for bespoke bussiness apps, well the one thing we can thank MS for is the Mono Culture of Business systems (and all the &#8220;security&#8221; employment that has given rise to ;). From a business prospective it has been easier and less costly to &#8220;migrate the processess&#8221; than get &#8220;best fit software&#8221; except in the likes of manufacturing and engineering and that&#8217;s changing as well (LabView etc).</p>
<p>If you think about it there are three classess of computers &#8220;old iron&#8221; backend high end middle ware servers and clients</p>
<p>With hand held battery powered clients getting as powerfull as early 1990&#8217;s servers and with what are effectivly &#8220;best of breed&#8221; OS&#8217;s available for free with the likes of Java the future for MS is probably going to be somewhat interesting.</p>
<p>Simply because their strong hold has been &#8220;desktop&#8221; and that is now turning into &#8220;thin clients&#8221; in peoples pockets (remember the XP pannic with Netbooks).</p>
<p>MS never realy made it into the back end world their server software has never realy scaled up to &#8220;big iron&#8221; and if the world moves to &#8220;cloud and thin client &#8216;chrome'&#8221; then MS will be left with &#8220;gamers&#8221; unless they have a radical re-think about their position. And to be honest I&#8217;m not sure Steve &#8220;barmy&#8221; is the man for that job he&#8217;s got a &#8220;trench warfare&#8221; mind set where Steve Jobs and the like have a different focus<br />
So yeah MS programers of business software might see a bleak future but simply altering their skill set is not going to kill (most of) them if they are &#8220;engineers&#8221; and not &#8220;code cutters&#8221;. It depends on how well they have learnt the fundamentals (which sadly don&#8217;t feature to much on a lot of higher education curicular these days).</p>
<p>As was said in a movie my son likes &#8220;that&#8217;s evolution baby&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123720">

			<div class="comment by-jan-steffan ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://testlab.sit.fraunhofer.de' rel='external nofollow ugc' class='url'>Jan Steffan</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123720">
						December 3, 2009 11:27 AM					</a>

				</p>

				<p>Unfortunately a TPM provides little protection here.<br />
It does not prevent that the laptop boots from a manipulated boot loader. A manipulated boot-loader can ask the user for the password, PIN, or key-file on a USB-drive in order to store this secret on the hard disk or to send it to the attacker over the network, e.g.</p>
<p>We actually demonstrated this for BitLocker with TPM:<br />
<a href="http://testlab.sit.fraunhofer.de/content/output/project_results/bitlocker_skimming/" rel="nofollow ugc">http://testlab.sit.fraunhofer.de/content/output/project_results/bitlocker_skimming/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123721">

			<div class="comment by-chuck ">

				<p class="commentcredit">

					<span class="commenter">Chuck</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123721">
						December 5, 2009 4:40 AM					</a>

				</p>

				<p>My idea would be (do not know if it <em>really</em> works or if it gives really more security 😉 ) to have the HDD totally <em>bare</em> encrypted without any partitions, MBRs, or bootloaders &#8212; but but from a USB-drive/key with the necessary bootloader and password (since I can boot my computer from USB-drives, SD-Cards and similar I would expect that it should be possible to boot a bootloader from one device as a simple USB-drive which starts the rest from the <em>original</em> device).<br />
The first/last sectors of the HDD could be hashed and tested before booting if someone tried to mess around.<br />
And when you leave your hotel room you take your usb-drive with you leaving the maids without any password knowledge and without the hardware key.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123722">

			<div class="comment by-frankly ">

				<p class="commentcredit">

					<span class="commenter">frankly</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123722">
						December 7, 2009 5:22 PM					</a>

				</p>

				<p>Commercial response:</p>
<p>PNL #050 – Passware Kit 9.5 Decrypts BitLocker Hard Drives, Supports PGP, and Windows 7.<br />
<a href="http://www.lostpassword.com/news/pnl50.htm" rel="nofollow ugc">http://www.lostpassword.com/news/pnl50.htm</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123723">

			<div class="comment by-packagedblue ">

				<p class="commentcredit">

					<span class="commenter">PackagedBlue</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123723">
						December 12, 2009 8:42 PM					</a>

				</p>

				<p>WEBMASTER: EDITED TO ADD (12/09) instead of (129)?  Article is the &#8220;Evil Maid&#8221; Attacks. 🙂</p>
<p>Lots of EDITED TO ADDS on older articles.  Would be nice if EDITED TO ADD had a similar list like 100 Latest Comments.  It is good to see EDITED TO ADDs.</p>
<p>And since that I am spoiled, a wikipedia style blog for some articles/comments might be cool, but I guess wikipedia is for that.</p>
<p>Just ideas, although anybody can come up with ideas, secure solid implementations and rolled out products take a lot of work.</p>
<p>Keep up the good work/blog.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123724">

			<div class="comment by-tualha ">

				<p class="commentcredit">

					<span class="commenter">Tualha</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123724">
						December 13, 2009 7:10 AM					</a>

				</p>

				<p>This sort of attack is why the whole prison scene in /Cryptonomicon/ is so silly. They didn&#8217;t have to go to all that trouble.</p>
<p>Now, of course, if they had gone to all that trouble as misdirection, and had this be the real attack, that would have been sweet 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123725">

			<div class="comment by-tommy ">

				<p class="commentcredit">

					<span class="commenter">Tommy</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123725">
						December 15, 2009 4:19 AM					</a>

				</p>

				<p>Could Jan Steffan or Bruce Schneier answer Chuck.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123726">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123726">
						December 15, 2009 6:09 AM					</a>

				</p>

				<p>@ Tommy</p>
<p>In principle there is little wrong with Chucks idea, BUT the devil is in the details.</p>
<p>There are many CD/DVD/USB *nix distributions that will run in memory only. Nearly all with a little work can be rebuilt to have &#8220;custom software&#8221; added to them within the OS code or with much less effort store &#8220;userland&#8221; files on a USB drive.</p>
<p>Unix alows raw partitions (ie those without recognised file systems etc) and in theory the access can be faster (Oracle used to do this for large DBs where the 32bit file size limit caused problems).</p>
<p>You can effectivly (depending on which *nix) mount the raw disk as a &#8220;file&#8221; which enables you to develop your own file system and encryption etc within that &#8220;file&#8221; and access it from a &#8220;userland&#8221; program.</p>
<p>However the quite chalanging task of developing a userland programe to act as a file system is just the start of what you would need to do.</p>
<p>There are then the problems of what sort of encryption modes to use, how and how many keys/IV&#8217;s/offsets, how these &#8220;keys&#8221; are stored and protected.</p>
<p>All of these have subtal gottchas so it is easy to make things not as secure as you would expect.</p>
<p>Which is why it would be best to have a look around for OpenSource solutions that have stood up to examination by others.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123727">

			<div class="comment by-bibidy ">

				<p class="commentcredit">

					<span class="commenter">bibidy</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123727">
						December 25, 2009 7:57 AM					</a>

				</p>

				<p>I don&#8217;t why nobody pointed this out, but I think this sort of attack can be prevented    , or at be detected in most of the situations where the user leaves his pc unattended for a short time by using hibernation instead of just shutting the pc down, if the FDE software support encryption of a hibernation file (although Truecrypt, the victim of the demonstrated attack, doesn&#8217;t).</p>
<p>As far as I know, when pc wakes up from hibernation, you cannot boot it from another device. If the attacker decides to turn off the pc, restart it and inject the malicious code (in this case, the &#8220;Evil Maid Sniffer&#8221;) into boot sector from the usb stick he brought with, not only the time of an attack gets longer, he/she must then launch the applications the user was working with and place it exactly where they were relying solely on his/her memory or the photo the attacker has taken right before the pc went to hibernation. Since humans are quite sensitive to the difference of similar (but different) images, it is pretty likely that a reasonably paranoid user would notice the difference if the window of a application is slightly out of place.</p>
<p>Only to make the matter worse, if  the user did a fair amount of writing and has not saved it into a file (let&#8217;s say he/she was using a windows notepad or a wordpad, which has no auto-saving feature) , then the attacker has to type it all over again and in this case he/she cannot rely on his/her memory unless he/she has has eidetic one.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123728">

			<div class="comment by-bibidy ">

				<p class="commentcredit">

					<span class="commenter">bibidy</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123728">
						December 25, 2009 6:50 PM					</a>

				</p>

				<p>Additional note to my comment above: when I said &#8220;he/she must then launch the applications&#8230;and place them exactly where they were&#8221; I was referring to a scenario where either the malicious code has a script to load and place them automatically after the logon to the os, or the attacker gains a remote access (if the code also has such a function) and run a script to load and place the applications (no, he/she shouldn&#8217;t manually drag them onto their place unless the attacker wants the user to know that he/she is playing with your pc) , both because the attacker cannot be in front of that pc once the user comes back.</p>
<p>This means it&#8217;s quite unlikely that this type of an attack would succeed when the pc is in hibernation because the attacker should have a complete list of installed applications (with their versions, too!) and edit the code right after the hibernation takes place for the attacker can only guess and cannot bet which app the user would leave open. Yes, the number of applications a user &#8220;usually&#8221; opens up is imited, so the attacker will probably get his/her chance if he/she stays around the user long enough(could be a couple of days up to months, depending on the attacker&#8217;s luck), but again there&#8217;s the position of the apps&#8217; windows which is very likely to vary everytime.</p>
<p>As for typing what the user wrote, I came to realize that the attacker wouldn&#8217;t type it manually because if he/she took a photo, then the image file of the picture can be read by an OCR software which would then do all the typing for you. Sure, you&#8217;d have to review the output because OCR softwares are not 100% accurate (especially if the photo was a tilted/side shot (which would be, in most of the cases since the user is sitting right in front of the monitor)) , but it&#8217;s much less time consuming.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123729">

			<div class="comment by-frankly ">

				<p class="commentcredit">

					<span class="commenter">frankly</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123729">
						February 9, 2010 10:47 AM					</a>

				</p>

				<p>Interesting to see that with physical access to a computer, the Trusted Platform Module (TPM) can also be overcome.</p>
<p>I find it most interesting how access is gained:</p>
<p>&#8220;Using off-the-shelf chemicals, Tarnovsky soaked chips in acid to dissolve their hard outer shells. Then he applied rust remover to help take off layers of mesh wiring, to expose the chips&#8217; cores. From there, he had to find the right communication channels to tap into using a very small needle.</p>
<p>The needle allowed him to set up a wiretap and eavesdrop on all the programming instructions as they are sent back and forth between the chip and the computer&#8217;s memory.</p>
<p>Those instructions hold the secrets to the computer&#8217;s encryption, and he didn&#8217;t find them encrypted because he was physically inside the chip. &#8221;<br />
<a href="http://www.independent.co.uk/life-style/gadgets-and-tech/news/supergeek-pulls-off-near-impossible-crypto-chip-hack-1894052.html" rel="nofollow ugc">http://www.independent.co.uk/life-style/gadgets-and-tech/news/supergeek-pulls-off-near-impossible-crypto-chip-hack-1894052.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123730">

			<div class="comment by-andrew ">

				<p class="commentcredit">

					<span class="commenter">Andrew</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123730">
						February 23, 2010 8:54 AM					</a>

				</p>

				<p>Maybe I am missing something but if you are so worried about a keylogger getting installed why not change the boot sequence to not allow booting from USB or CD period. Then password protect the BIOS so it can&#8217;t be easily changed.<br />
That way they can&#8217;t boot from the USB and install a keylogger, at least not without going through additional hoops.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123731">

			<div class="comment by-andre ">

				<p class="commentcredit">

					<span class="commenter">Andre</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123731">
						March 23, 2010 11:11 PM					</a>

				</p>

				<p>Truecrypt&#8217;s defense that if someone gains physical access to your computer then &#8220;all bets are off&#8221; begs the question: Why bother with encryption at all then??</p>
<p>Isn&#8217;t that why people use such software in the first place.. To ensure no one can access sensitive information WHEN WE&#8217;RE NOT AROUND???</p>
<p>Does Bootkit Remover from eSage lab (<a href="http://blog.alisa.sh/2009/10/02/cleaning-mebroot-and-more/" rel="nofollow ugc">http://blog.alisa.sh/2009/10/02/cleaning-mebroot-and-more/</a>) detect the Evil Maid attack? It is capable of detecting Stoned Bootkit.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123732">

			<div class="comment by-simon ">

				<p class="commentcredit">

					<span class="commenter">Simon</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123732">
						March 30, 2010 5:43 AM					</a>

				</p>

				<p>Seagate&#8217;s self-encrypting hard drives protect against this attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123733">

			<div class="comment by-robert-delahunt ">

				<p class="commentcredit">

					<span class="commenter">Robert Delahunt</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123733">
						September 16, 2010 7:51 AM					</a>

				</p>

				<p>This attack assumes no mechanism to ensure the integrity of the boot partition is in place.  One could automate such a thing using an md5sum of the partition.  You&#8217;d need to update the md5sum whenever the partition changed, of course.  Basically, upon boot, maybe at init level 1, check against md5sum.  This may take a while, true, but anyways, if it didn&#8217;t match, it could be scripted to wipe the boot partition with zeros, then recreate, or at least warn the user.</p>
<p>The attack here (Evil Maid) assumes you log into the machine.  If it is simply stolen without knowing the password, it won&#8217;t do any good.</p>
<p>Granted nothing is 100% secure.  If you used a fingerprint reader to grant access they could just chop off the finger you use.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123735">

			<div class="comment by-hagai-bar-el ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.hbarel.com' rel='external nofollow ugc' class='url'>Hagai Bar-El</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123735">
						October 28, 2010 4:41 PM					</a>

				</p>

				<p>A simple and practical solution to this attack: keep reverting the boot sector from a trusted copy.</p>
<p>See: <a href="http://www.hbarel.com/blog/index.php?itemid=37" rel="nofollow ugc">http://www.hbarel.com/blog/index.php?itemid=37</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123736">

			<div class="comment by-dradec ">

				<p class="commentcredit">

					<span class="commenter">dradec</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123736">
						November 1, 2010 2:49 PM					</a>

				</p>

				<p>What i would do is to set a bios password and set it to only boot from the hard drive.</p>
<p>The attacker would have to remove the bios password to change to implement this attack no? If so, then this would alert the user because he or she would not be prompt for a password upon turning on the system.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123737">

			<div class="comment by-derp ">

				<p class="commentcredit">

					<span class="commenter">Derp</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123737">
						November 23, 2010 3:23 PM					</a>

				</p>

				<p>&#8220;Maybe I am missing something but if you are so worried about a keylogger getting installed why not change the boot sequence to not allow booting from USB or CD period. Then password protect the BIOS so it can&#8217;t be easily changed.&#8221;</p>
<p>Unless you required a BIOS password for power-on, someone could just swap your HD, get access to your BIOS from there, etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123739">

			<div class="comment by-tlhonmey ">

				<p class="commentcredit">

					<span class="commenter">tlhonmey</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123739">
						June 9, 2011 2:33 AM					</a>

				</p>

				<p>The childishly simple counter to this (with TrueCrypt especially, but it should work with anything) is to install your bootloader on a read-only media, and carry it with you at all times.  TrueCrypt makes a boot CD for recovery purposes that can either boot or decrypt the system when you provide the password.  Burn it onto a business-card CD, and scrub the bootloader from the hard drive.  If a bootloader shows up on the hard drive, you know somebody&#8217;s tampered with your machine.  Otherwise, boot from the CD and you should be clean.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123740">

			<div class="comment by-bill ">

				<p class="commentcredit">

					<span class="commenter">Bill</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123740">
						August 28, 2011 12:40 PM					</a>

				</p>

				<p>Yep, what the above poster said. For people who don&#8217;t know how to do this I&#8217;ll write out the steps.</p>
<p>1) Make sure your rescue disk / rescue USB (can make bootable usb with unetbootin) works<br />
2) Boot with a Linux live CD. You may need to use sudo for the following commands depending on distribution.<br />
3) In console, type &#8220;fdisk-l&#8221; to find what your hard disk is called<br />
4) In console, type &#8220;dd if=/dev/zero of=/dev/sd* count=63 bs=512&#8221; where * is the hard drive letter found by &#8220;fdisk -l&#8221; &#8212; this will overwrite the Truecrypt boot loader in the master boot record with zeros.<br />
5) Boot from the rescue disk from now on. Inspect the MBR from time to time if you suspect anything. You can do this in linux with &#8220;dd if=/dev/sd* count=63 bs=512 | hexdump -C&#8221; (assuming you have hexdump) and if you see anything but zeros, it&#8217;s been tampered with!</p>
<p>In theory it shouldn&#8217;t matter if it has been tampered with though, as you can always just boot from the rescue disk, bypassing whatever is on the MBR. Unless I&#8217;m missing something about how this attack works.</p>
<p>Note there are still attacks against this such as hardware keyloggers. These may be hard to install in a laptop but on desktops they are quite easy and can be virtually impossible to detect. An adversary could for instance put one inside your keyboard, or buy an identical keyboard and alter it elsewhere to avoid risking discovery, then switch out the altered keyboard with yours when you are not home. I suppose you could install hidden cameras to watch your computer 24/7 and review the footage every time before powering on the computer, but that is not realistic for most people.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123741">

			<div class="comment by-bill ">

				<p class="commentcredit">

					<span class="commenter">Bill</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123741">
						August 28, 2011 12:58 PM					</a>

				</p>

				<p>Oh, by the way, BIOS passwords are practically useless. All it takes to bypass them is to flash the BIOS by CMOS jumper or to remove the battery for a few minutes. I don&#8217;t know whether laptops have the CMOS jumper but the battery method should work. Granted this adds some time to the Evil Maid attack but who is never away from their computer for more than a couple hours?</p>
<p>I don&#8217;t know much about password cracking in a BIOS environment but there is probably some way to do this. My computer limits the BIOS password to 6 characters, so if cracking BIOS passwords is computationally similar to cracking UNIX passwords (and I&#8217;m not saying it is) it would take less than an hour on a modern computer.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123742">

			<div class="comment by-will-2011 ">

				<p class="commentcredit">

					<span class="commenter">Will-2011</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123742">
						November 5, 2011 2:16 AM					</a>

				</p>

				<p>I am wondering&#8230;<br />
With encryption&#8230; is there a good way to use it that can&#8217;t be hacked?</p>
<p>I was playing with tru-crypt &amp; forgot a pass to a 40 G file&#8230; (LOL oh well)</p>
<p>I know that Bio-Metrics is not reasonable to use&#8230; &amp; the thumb version can be fooled (as shown by the mythbusters)</p>
<p>Next thing that you will see in Bio-Metrics is RFID&#8230;</p>
<p>Will</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123745">

			<div class="comment by-duncan-donut ">

				<p class="commentcredit">

					<span class="commenter">duncan donut</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123745">
						April 3, 2012 11:11 PM					</a>

				</p>

				<p>Ok guys so if I have all the facts right here in order to fully ensure my laptop or pc is protected I have to mark the keyboard in a unique way, i have to boot from usb and make sure they are read only, i have to have a camera watching the pc 24/7, i have to deploy the bios security options. I have to check for keyloggers, hardware and software, I have to encrypt all my data, and I have to put the pc in a walk-in safe with an armed security guard on  the outside and robotic infra-red activated sensors and movement sensors on the inside and i have to do a bugscan on every room in the vicinity<br />
before i log on<br />
cool</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123746">

			<div class="comment by-c-u-anon ">

				<p class="commentcredit">

					<span class="commenter">C U Anon</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123746">
						April 4, 2012 2:18 AM					</a>

				</p>

				<p>@ duncan donut</p>
<p><i>Ok guys so if I have all the facts right here in orde to fully ensure my laptop or pc is protected I have to&#8230; &#8230;and I have to do a bugscan on every room in the vicinity before I log on</i></p>
<p>I see you are getting the hang of it, BUT that armed guard did you do a thorough background check? and how do you ensure they&#8217;ve not been turned? Did you check to see they are not realy the maid wearing a &#8220;rubber face mask&#8221;?</p>
<p>Real paranoia comes only with lots of practice 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123747">

			<div class="comment by-slayer256 ">

				<p class="commentcredit">

					<span class="commenter">slayer256</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123747">
						June 2, 2012 7:36 AM					</a>

				</p>

				<p>I know it&#8217;s not always possible since some of us must use windows for certain tasks at work, home or for gaming but wouldn&#8217;t a live cd or live usb with the disk encryption program installed on it work 100% of the time against the angry maid with the exception of the hardware logger ?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123748">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123748">
						August 18, 2013 5:11 AM					</a>

				</p>

				<p>@ Node_8392,</p>
<p>The problem with many BIOS passwords is that not only are they stored in a &#8220;known place&#8221; in memeory, they are also usually stored as &#8220;plaintext&#8221;.</p>
<p>This makes them vulnerable to quite a few fairly easy to do technical attacks which don&#8217;t leave traces that are easy to spot. In essence as long as an attacker can access a system bus (via firewire, RAM expansion slot or some I/O busses) then it&#8217;s game over for the BIOS password.</p>
<p>So provided your Evil Maid is not technicaly trained then yes the BIOS password does provide a first line of defence, and for the technicaly trained it slows them down.</p>
<p>So you still need full disk encryption, and if you are sensible within the FDE other further encrypted containers with if you have any sense multiple deniable levels.</p>
<p>Further have the important passwords protected by a time based &#8220;duress key&#8221; system built around multipart keys on remote systems (see discussions in other threads on this blog about evading boarder control security).</p>
<p>Alternativly don&#8217;t have at any point in time any information that might embarress you or worse, on the laptop or about your person. And if you have to for reasons of work ensure you &#8220;zero the HD&#8221; and do a clean re-instal befor and after.</p>
<p>Oh and as was recently highlighted don&#8217;t use Leveno or other Chinese company built laptops, as these are now deamed &#8220;suspect&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123749">

			<div class="comment by-blah ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://blah.com' rel='external nofollow ugc' class='url'>blah</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123749">
						August 24, 2013 12:25 AM					</a>

				</p>

				<p>If I were truly worried about a laptop becoming monitored or compromised evil maid style, I would see out a specialized suitcase the laptop goes into that has high quality locks and is tamper evident if opened incorrectly.  I wouldn&#8217;t want to have to deal with if they put a bad boot loader on, or even installed a tap into the keyboard that transmits wirelessly.  On the unprotected laptop, I could imagine an evil maid quickly whipping out a laptop under the cleaning cart, opening your laptop to borrow your hdd to make an entire disk image copy and installing a physical keyboard sensor.  Then just wait for it to transmit later and he/she already has a copy of the hdd to use on.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123750">

			<div class="comment by-mark ">

				<p class="commentcredit">

					<span class="commenter">Mark</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123750">
						October 21, 2014 9:44 PM					</a>

				</p>

				<p>My way of encrypting, 1) use a separate read-only usb thumb drive to boot the laptop.<br />
2) line the hard drive cage with det cord or C4 that is rigged to explode when someone opens the lid to the hard drive cage. C4 is a very stable explosive and therefor is preferable.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123751">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123751">
						October 21, 2014 10:19 PM					</a>

				</p>

				<p>@ Mark</p>
<p>Will stop the local cops, but might not stop TLA&#8217;s. Compared to thermite, C4 has these disadvantages:</p>
<ol>
<li>
<p>It&#8217;s often illegal.</p>
</li>
<li>
<p>It explodes rather than burns.</p>
</li>
<li>
<p>Such explosions often blow the hardware into chunks of material that might have the information on it, rather than vaporizing layer after layer for a period of time.</p>
</li>
<li>
<p>Can&#8217;t be contained effectively like Skunkwork&#8217;s datacenter-friendly thermite appliance.</p>
</li>
</ol>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123753">

			<div class="comment by-izaac ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html' rel='external nofollow ugc' class='url'>izaac</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123753">
						December 1, 2014 9:43 PM					</a>

				</p>

				<p>switch hard drives and have fake data.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123754">

			<div class="comment by-bisnatch ">

				<p class="commentcredit">

					<span class="commenter">bisnatch</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123754">
						March 9, 2015 1:09 AM					</a>

				</p>

				<p>2 things:</p>
<p>For laptop, just pop-out the HD, put it in a &#8220;conductive bag&#8221; and take it with you.</p>
<p>For a tower or big box, place the entire box in a padlocked cage: attractive perforated/vented enclosures are available for all sorts of uses. Remove the side panels of the tower first to ensure cooling. Use that white sealer stuff on the keyboard&#8217;s bottom screw heads.</p>
<p>Re: pass-protected Boot partition, passphrase must be hashed/crypted.</p>
<p>After all that, treat yourself to a good bottle of aged Scotch.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123755">

			<div class="comment by-terrahertz ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://everist.org' rel='external nofollow ugc' class='url'>TerraHertz</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123755">
						August 23, 2015 9:16 PM					</a>

				</p>

				<p>All protections against evil-maid and other attacks requiring physical access to the PC, assume that the PC was not manufactured already compromised. That the CPU itself doesn&#8217;t contain evil firmware, major chips like Northbridges don&#8217;t, and the BIOS/firmware boot system is clean.</p>
<p>But with Intel now predominantly Israeli-owned, most Intel CPU production in Israel, talk of CPUs containing built-in stealth GSM transmitters and/or able to use the frequency-agile system clock as an FM transmitter using encryption as well, plus the Snowden leaks showing the NSA has weaponized the Internet backbone system with attack systems able to fully backdoor any PCs they wish, via insertions in normal packet traffic&#8230; there&#8217;s no such guarantee.</p>
<p>And that&#8217;s not even getting started on Windows, Win10 in particular, and the recent Microsoft &#8220;all your private data are belong to us&#8221; EULA changes. PCs these days don&#8217;t have &#8216;backdoors&#8217;, they are more like thin pretty facades standing at the front of bulldozed ruins and jungle out back.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123757">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">anon</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123757">
						September 15, 2015 7:45 AM					</a>

				</p>

				<p>If you are using Linux, you could boot from an external USB device, that is, keep your /boot folder on a USB so that there&#8217;s no bootloader at the machine at all.</p>
<p>You carry your flash drive with you and you need it to boot your machine.</p>
<p>This can be set up pretty easily and it&#8217;s a great technique especially if you&#8217;re using cryptsetup LUKS for full disk encryption.</p>
<p>This essentially RENDERS THE WHOLE ATTACK INVALID because your entire hard drive&#8217;s content is pure random noise and the only way to decipher that noise is to boot from an external flash drive with a proper password and/or a keyfile.</p>
<p>Here&#8217;s a great guide on how to set this up that I found and followed and it works great: <a href="http://thesimplecomputer.info/full-disk-encryption-with-ubuntu" rel="nofollow ugc">http://thesimplecomputer.info/full-disk-encryption-with-ubuntu</a></p>
<p>(I&#8217;m not affiliated with the site at all, it&#8217;s just the best guide I&#8217;ve found so far)</p>
<p>Cheers.</p>
<p>PS. Use Veracrypt instead of Truecrypt preferably. But LUKS for your main hard disk where your OS is.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123758">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123758">
						September 15, 2015 8:28 AM					</a>

				</p>

				<p>@ anon,</p>
<p>The problem these days when dealing with well resourced and state level attackers is the vast array of Flash memory in various chips on the motherboard and IO devices.</p>
<p>Once they have got to that Flash memory, it&#8217;s game over for all but a few very esoteric uses for a laptop.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123760">

			<div class="comment by-republic-day-status ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.statusp.com/republic-day-status-quotes-wishes-shayari/' rel='external nofollow ugc' class='url'>republic day status</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123760">
						January 3, 2020 10:25 AM					</a>

				</p>

				<p>If I were truly worried about a laptop becoming monitored or compromised evil maid style, I would see out a specialized suitcase the laptop goes into that has high quality locks and is tamper evident if opened incorrectly. I wouldn&#8217;t want to have to deal with if they put a bad boot loader on, or even installed a tap into the keyboard that transmits wirelessly. On the unprotected laptop, I could imagine an evil maid quickly whipping out a laptop under the cleaning cart, opening your laptop to borrow your hdd to make an entire disk image copy and installing a physical keyboard sensor. <a href="http://newslax.com" rel="nofollow ugc">http://newslax.com</a> Then just wait for it to transmit later and he/she already has a copy of the hdd to use on.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123761">

			<div class="comment by-basant-panchami-status ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.statusp.com/basant-panchami-status-quotes-wishes-shayari/' rel='external nofollow ugc' class='url'>basant panchami status</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123761">
						January 3, 2020 10:28 AM					</a>

				</p>

				<p>The problem with many BIOS <a href="https://www.statusp.com/all-status" rel="nofollow ugc">https://www.statusp.com/all-status</a> passwords is that not only are they stored in a <a href="https://www.statusp.com/" rel="nofollow ugc">https://www.statusp.com/</a> &#8220;known place&#8221; in memeory, they are also usually stored as &#8220;plaintext&#8221; <a href="https://newslax.com" rel="nofollow ugc">https://newslax.com</a> .</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-123762">

			<div class="comment by-good-night ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.statusp.com/good-night-in-sanskrit/' rel='external nofollow ugc' class='url'>Good Night</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123762">
						April 19, 2020 10:24 PM					</a>

				</p>

				<p>All protections against evil-maid and other attacks requiring physical access to the PC, assume that the PC was not manufactured already compromised. That the CPU itself doesn&#8217;t contain evil firmware, major chips like Northbridges don&#8217;t, and the BIOS/firmware boot system is clean.</p>
<p>But with Intel now predominantly Israeli-owned, most Intel CPU production in Israel, talk of CPUs containing built-in stealth GSM transmitters and/or able to use the frequency-agile system clock as an FM transmitter using encryption as well, plus the Snowden leaks showing the NSA has weaponized the Internet backbone system with attack systems able to fully backdoor any PCs they wish, via insertions in normal packet traffic&#8230; there&#8217;s no such guarantee.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-123763">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-123763">
						April 21, 2020 7:18 AM					</a>

				</p>

				<p>@ Good Night,</p>
<blockquote><p>with attack systems able to fully backdoor any PCs they wish, via insertions in normal packet traffic&#8230; there&#8217;s no such guarantee.</p></blockquote>
<p>Actually there are two,</p>
<p>1, Do not use PC&#8217;s.<br />
2, Use a microcontroler based system that you have developed yourself.</p>
<p>Whilst the former is easy, the use of &#8220;office electronics&#8221; is expected in most aspects of Western Culture these days. Unfortunately you get pushed by almost all those around you into using technology regardless of if you wish to or not.</p>
<p>Which means if you have certain fairly rare skill sets you can avail yourself of the second option. However there are many traps and pitfalls if you do not have the right skill set. However even so an Evil Maid on accessing bespoke technology will almost certainly not be prepared to exploit it, thus may well steal it. If you&#8217;ve taken well known precautions to protect &#8220;data at rest&#8221; then you will be ahead in that round of the game.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-360943">

			<div class="comment by-laundry-detergent ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://laundrydetergentideas.com/' rel='external nofollow ugc' class='url'>Laundry Detergent</a></span> •

					<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/#comment-360943">
						December 18, 2020 6:56 AM					</a>

				</p>

				<p>THIS IS TOO HELPFUL WEBSITE. I LIKE THIS WEBSITE.</p>
<p><a href="https://www.statusp.com/" rel="nofollow ugc">https://www.statusp.com/</a></p>
<p><a href="https://laundrydetergentideas.com/" rel="nofollow ugc">laundry detergent</a><br />
Whilst the former is easy, the use of “office electronics” is expected in most aspects of Western Culture these days. Unfortunately you get pushed by almost all those around you into using technology regardless of if you wish to or not.</p>
<p>Which means if you have certain fairly rare skill sets you can avail yourself of the second option. However there are many traps and pitfalls if you do not have the right skill set. However even so an Evil Maid on accessing bespoke technology will almost certainly not be prepared to exploit it, thus may well steal it. If you’ve taken well known precautions to protect “data at rest” then you will be ahead in that round of the game.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2009/10/evil_maid_attac.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2009/10/evil_maid_attac.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2009%2F10%2Fevil_maid_attac.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2009/10/evil_maid_attac.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='3093' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2009/10/james_bamford_o.html" rel="prev">← James Bamford on the NSA</a>		<a href="https://www.schneier.com/blog/archives/2009/10/friday_squid_bl_205.html" rel="next">Friday Squid Blogging: Draw-a-Squid Contest →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
