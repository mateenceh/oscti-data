<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>FIPS 140-2 Level 2 Certified USB Memory Stick Cracked - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; FIPS 140-2 Level 2 Certified USB Memory Stick Cracked Comments Feed" href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/3202" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=3202' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F01%2Ffips_140-2_leve.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F01%2Ffips_140-2_leve.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-3202 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-3202" class="post-3202 post type-post status-publish format-standard hentry category-uncategorized tag-certifications tag-cryptography tag-encryption tag-flash-drives tag-hardware tag-passwords tag-security-standards tag-vulnerabilities">

	<div class="article">

		<h2 class="entry">FIPS 140-2 Level 2 Certified USB Memory Stick Cracked</h2>
		<p>Kind of a <a href="http://www.h-online.com/security/news/item/NIST-certified-USB-Flash-drives-with-hardware-encryption-cracked-895308.html">dumb mistake</a>:</p>
<blockquote><p>The USB drives in question encrypt the stored data via the practically uncrackable AES 256-bit hardware encryption system. Therefore, the main point of attack for accessing the plain text data stored on the drive is the password entry mechanism. When analysing the relevant Windows program, the SySS security experts found a rather blatant flaw that has quite obviously slipped through testers&#8217; nets. During a successful authorisation procedure the program will, irrespective of the password, always send the same character string to the drive after performing various crypto operations &#8212; and this is the case for all USB Flash drives of this type.</p>
<p>Cracking the drives is therefore quite simple. The SySS experts wrote a small tool for the active password entry program&#8217;s RAM which always made sure that the appropriate string was sent to the drive, irrespective of the password entered and as a result gained immediate access to all the data on the drive. The vulnerable devices include the Kingston DataTraveler BlackBox, the SanDisk Cruzer Enterprise FIPS Edition and the Verbatim Corporate Secure FIPS Edition.</p></blockquote>
<p>Nice piece of analysis work.</p>
<p>The article goes on to question the value of the FIPS certification:</p>
<blockquote><p>The real question, however, remains unanswered ­ how could USB Flash drives that exhibit such a serious security hole be given one of the highest certificates for crypto devices? Even more importantly, perhaps ­ what is the value of a certification that fails to detect such holes?</p></blockquote>
<p>The problem is that no one really understands what a FIPS 140-2 certification means.  Instead, they think something like: &#8220;This crypto thingy is certified, so it must be secure.&#8221;  In fact, FIPS 140-2 Level 2 certification <a href="http://en.wikipedia.org/wiki/FIPS_140-2">only means</a> that certain good algorithms are used, and that there is some level of tamper resistance and tamper evidence.  Marketing departments of security take advantage of this confusion &#8212; it&#8217;s not only FIPS 140, it&#8217;s all the security standards &#8212; and encourage their customers to equate conformance to the standard with security.  </p>
<p>So when that equivalence is demonstrated to be false, people are surprised.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/certifications/" rel="tag">certifications</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/encryption/" rel="tag">encryption</a>, <a href="https://www.schneier.com/tag/flash-drives/" rel="tag">flash drives</a>, <a href="https://www.schneier.com/tag/hardware/" rel="tag">hardware</a>, <a href="https://www.schneier.com/tag/passwords/" rel="tag">passwords</a>, <a href="https://www.schneier.com/tag/security-standards/" rel="tag">security standards</a>, <a href="https://www.schneier.com/tag/vulnerabilities/" rel="tag">vulnerabilities</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html" rel="bookmark">Posted on January 8, 2010 at 7:24 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html#comments">102 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html" data-title="FIPS 140-2 Level 2 Certified USB Memory Stick Cracked" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-128510">

			<div class="comment by-ricky-bobby ">

				<p class="commentcredit">

					<span class="commenter">Ricky Bobby</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128510">
						January 8, 2010 7:28 AM					</a>

				</p>

				<p>There are multiple ways encryption has been broken in the past, including laptop encryption by cooling the ram.</p>
<p>However, I still believe these encryption techniques are still valid 95% of the time.  Because, not every company has the risk of someone with this kind of talent to be cracking their software.  How many people in the World could implement this crack?  I would not buy it now with other choices available, but it still works for most situations.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128511">

			<div class="comment by-xxx ">

				<p class="commentcredit">

					<span class="commenter">xxx</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128511">
						January 8, 2010 7:39 AM					</a>

				</p>

				<p>@Ricky Bobby:</p>
<p>Two fallacies:</p>
<ol>
<li>
<p>It only takes <em>one</em> person to crack it and make a tool available. The rest of us can just, you know, download the tool and <em>use</em> it, without understanding the details.</p>
</li>
<li>
<p>Unlike vulnerabilities that you mention, this is rather blatant bug: the password IS NOT USED for encryption.</p>
</li>
</ol>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128512">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128512">
						January 8, 2010 7:49 AM					</a>

				</p>

				<p>And as usual, it wasn&#8217;t the encryption itself that was cracked, it was weaknesses in the implementation that were exploited.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128513">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128513">
						January 8, 2010 8:04 AM					</a>

				</p>

				<p>My main question is how did the same flaw appear in the product of 3 different companies? Is this because all three are outsourcing to the same 4th company? Or is it that they&#8217;re following an industry standard? Or has someone who&#8217;s involved in the design been moving from company to company? But yes, it&#8217;s a really silly and stupid mistake.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128514">

			<div class="comment by-vedaal ">

				<p class="commentcredit">

					<span class="commenter">vedaal</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128514">
						January 8, 2010 8:05 AM					</a>

				</p>

				<p>&#8220;The article goes on to question the value of the FIPS certification&#8221;</p>
<p>maybe FIPS should re-check their certification/recommendation for asymmetric key lengths:</p>
<p>here is a Lenstra paper demonstrating factoring of RSA 768 bit, with predictions that 1024 bit RSA should fall relatively soon</p>
<p><a href="http://eprint.iacr.org/2010/006" rel="nofollow ugc">http://eprint.iacr.org/2010/006</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128515">

			<div class="comment by-ricky-bobby ">

				<p class="commentcredit">

					<span class="commenter">Ricky Bobby</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128515">
						January 8, 2010 8:13 AM					</a>

				</p>

				<p>@ xxx</p>
<p>So do you think this is still a huge threat for a elementary school?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128516">

			<div class="comment by-d ">

				<p class="commentcredit">

					<span class="commenter">D</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128516">
						January 8, 2010 8:21 AM					</a>

				</p>

				<p>@vedaal:</p>
<p>You missed the point. These devices passed certification for their use of an algorithm, but it&#8217;s not that algorithm that was broken. What broke (and is not addressed by the certification AT ALL) is the their not using the password to generate the key.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128517">

			<div class="comment by-billswift ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://williambswift.blogspot.com/' rel='external nofollow ugc' class='url'>billswift</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128517">
						January 8, 2010 8:31 AM					</a>

				</p>

				<p>@Ricky Bobby<br />
It&#8217;s a huge threat for anyone who actually <strong>needs</strong> encryption.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128518">

			<div class="comment by-e ">

				<p class="commentcredit">

					<span class="commenter">E</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128518">
						January 8, 2010 8:36 AM					</a>

				</p>

				<p>@D<br />
It would not be a wise decision to use the password as part of the encryption key. In that case you&#8217;ll have to de-encrypt with the old key and re-encrypt the data on the device with the new key.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128519">

			<div class="comment by-ricky-bobby ">

				<p class="commentcredit">

					<span class="commenter">Ricky Bobby</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128519">
						January 8, 2010 8:38 AM					</a>

				</p>

				<p>@ billswift</p>
<p>Agreed</p>
<p>The risk is minimal.  Not many security experts or others who have the knowledge are stealing these items.  It is generally people trying to make a quick buck.  There is a risk, but a risk i can accept if I already had this product in my line of work.  (is not govt)</p>
<p>Same with the laptop encryption hack, what are in the typical thieve will steal a laptop and freezes your ram, and breaks the encyption?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128520">

			<div class="comment by-hnn ">

				<p class="commentcredit">

					<span class="commenter">hnn</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128520">
						January 8, 2010 8:45 AM					</a>

				</p>

				<p>It&#8217;s the same with safety standards. (Such as EN 61508 that I&#8217;ve had the misfortune to work with.) Nobody understands them. Few actually follow them even though they claim to (not that it would matter much if they did). Everyone think &#8220;SIL 3&#8221; in the brochure makes everything magically safe. Probable does more harm than good.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128521">

			<div class="comment by-nik ">

				<p class="commentcredit">

					<span class="commenter">Nik</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128521">
						January 8, 2010 8:46 AM					</a>

				</p>

				<p>Lexar jump drive V1 even stored the password on the drive &#8211; xor&#8217;d with a fixed string.</p>
<p>Normal users just can&#8217;t evaluate how secure something really is &#8211; that&#8217;s why security analysts and publishing their results is essential</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128522">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">Dave</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128522">
						January 8, 2010 8:53 AM					</a>

				</p>

				<p>Please stop saying there is nothing wrong with the encryption, it&#8217;s just the implementation that&#8217;s wrong. That&#8217;s like saying they were perfectly healthy, except their heart stopped beating.</p>
<p>ALL implementations of encryption are problematic.</p>
<p>And those who say the risk is low and they&#8217;re willing to take the risk, really, you take the risk because you don&#8217;t have a practical choice. People operate vehicles all the time that aren&#8217;t safe, they just don&#8217;t want to hear about it. Are you saying that if something better came along you wouldn&#8217;t begin using it?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128523">

			<div class="comment by-vernon ">

				<p class="commentcredit">

					<span class="commenter">Vernon</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128523">
						January 8, 2010 8:56 AM					</a>

				</p>

				<p>This is absolutely terrible from reading the linked report.  Encrypting using the same string to encrypt rather than the password entered &#8211; that&#8217;s worse than incompetence, one could argue that&#8217;s broken by design.</p>
<p>Moreover, Sandisk&#8217;s and Verbatim&#8217;s response is insufficient.  It&#8217;s fine if people do rewrite data using the patched software, but the problem is that already written data is vulnerable, and many might not bother to rewrite the data.  At least Kingston&#8217;s response clearly indicates that the system is faulty and is properly fixing it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128524">

			<div class="comment by-tordr ">

				<p class="commentcredit">

					<span class="commenter">Tordr</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128524">
						January 8, 2010 8:59 AM					</a>

				</p>

				<p>@Rick Bobby</p>
<p>The risk for the ordinary person is minimal. A typical thieve will not steal a laptop, freeze the ram and break the encryption, but an ordinary person does not need a laptop with encryption that is certified to be secure.</p>
<p>The person that needs certified secure laptops and FIPS Level 2 Certified USBs on the other hand is the same person that might be targeted by a thieve that will break the encryption. For that person this break is important.</p>
<p>Now why do I care, I do not need that kind of security for myself? Well, the sensitive information on the certified secure laptop might be for example social security numbers, financial data or credit card numbers, some of which are connected to me.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128525">

			<div class="comment by-patrick-g ">

				<p class="commentcredit">

					<span class="commenter">Patrick G.</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128525">
						January 8, 2010 8:59 AM					</a>

				</p>

				<p>@RickyBobby</p>
<p>Your USB Stick (one of the 3 brands) is stolen/lost and anyone with a bit of knowledge and motivation can get your data off the stick.<br />
Without your PC, without your password, without breaking the or any encryption.</p>
<p>That&#8217;s 120 Dollars extra for less security than any compression tool with &#8220;password protection&#8221; has to offer.</p>
<p>Minimal indeed&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128526">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128526">
						January 8, 2010 9:06 AM					</a>

				</p>

				<p>@Dave: &#8220;Please stop saying there is nothing wrong with the encryption, it&#8217;s just the implementation that&#8217;s wrong. That&#8217;s like saying they were perfectly healthy, except their heart stopped beating. &#8221;</p>
<hr />
<p>Your analogy is good, but your conclusion is wrong.  The analogy is good because one flawed vital organ will kill the whole organism.  The conclusion is wrong because that doesn&#8217;t mean there is anything wrong with the other organs.</p>
<p>The encryption wasn&#8217;t cracked, the implementation was exploited.  That&#8217;s the fact.  Keep the same encryption, fix the implementation.</p>
<p>Your otherwise good analogy has been incorrectly concluded to basically say we could never donate organs, after all we can&#8217;t say there is nothing wrong with the kidney because the person died when their heart stopped beating.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128527">

			<div class="comment by-ricky-bobby ">

				<p class="commentcredit">

					<span class="commenter">Ricky Bobby</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128527">
						January 8, 2010 9:17 AM					</a>

				</p>

				<p>@ Patrick G</p>
<p>It is awful don&#8217;t get me wrong, but the risk of this hack getting implemented is very minimal in most areas.</p>
<p>Its the typical &#8220;movie plot&#8221; that everyone here loves to say.  Saying that everyone that steals laptops or usb sticks has the capability/knowledge to hack encryption to get the data.  It just doesn&#8217;t occur 99% of the time. At the govt level it is a risk that should not exist, but other places its minimal.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128528">

			<div class="comment by-ricky-bobby ">

				<p class="commentcredit">

					<span class="commenter">Ricky Bobby</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128528">
						January 8, 2010 9:22 AM					</a>

				</p>

				<p>At the same time, if I just bought these and found this out I would be extremely unhappy too.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128529">

			<div class="comment by-bryan ">

				<p class="commentcredit">

					<span class="commenter">Bryan</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128529">
						January 8, 2010 9:34 AM					</a>

				</p>

				<p>@HJohn</p>
<p>What&#8217;s your point?  If the data is compromised it doesn&#8217;t matter how the attacker got it.</p>
<p>The only difference I can see is:</p>
<p>If the implementation is broken, only devices implemented that way are vulnerable.</p>
<p>If the encryption technology or algorithm is broken, only devices using that technology or algorithm are vulnerable.</p>
<p>The latter being a potentially larger group.</p>
<p>Since the headline of Bruce&#8217;s post was specific to the device, I don&#8217;t understand the significance of your comment.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128530">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128530">
						January 8, 2010 9:39 AM					</a>

				</p>

				<p>@E &#8230; It would not be a wise decision to use the password as part of the encryption key.</p>
<p>Actually, the wise decision would be to have a random master key to encrypt the data on the drive and to store the master key on the drive after encryption by a key generated from the password. Effectively, you use the password to obtain the key used to encrypt the master key.</p>
<p>So changing the password is quick and simple. Yet, without the password, you can&#8217;t get the master encryption key.</p>
<p>The actual mention of encryption in the article is a red herring. What they effectively had was a system where a program running on the computer simply told the USB drive, &#8220;Yep. This person knows the password, so it&#8217;s OK for you to unlock yourself&#8221;. Any mention of encryption after that point is meaningless.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128531">

			<div class="comment by-jack ">

				<p class="commentcredit">

					<span class="commenter">Jack</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128531">
						January 8, 2010 9:40 AM					</a>

				</p>

				<p>@ vernon</p>
<p>Think of this. If Kingston is recalling the drives, you might have a situation where the data on the drives they are sending back is exposed&#8230;.better apply a patch and fix it. This patch fixes the bug. This stuff happens all the time in this business. No need to get all worked up. As long as the vendors react on time (which they did), it&#8217;s perfectly acceptable to me.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128532">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128532">
						January 8, 2010 9:41 AM					</a>

				</p>

				<p>@Bryan: What&#8217;s your point? If the data is compromised it doesn&#8217;t matter how the attacker got it.  Since the headline of Bruce&#8217;s post was specific to the device, I don&#8217;t understand the significance of your comment.</p>
<hr />
<p>I agree to a point (it doesn&#8217;t matter how he got it, it is vulnerable).</p>
<p>The point of my comment is that in terms of defense and resolution, understanding what really happened is essential.  Without that understanding, someone may mistakenly think that the encryption itself is flawed and what is in need of correction, which is not the case.  It is how it was implemented.</p>
<p>I&#8217;m sorry you can&#8217;t see the obvious significance of that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128533">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128533">
						January 8, 2010 9:51 AM					</a>

				</p>

				<p>@Bryan at January 8, 2010 9:34 AM</p>
<p>I really should leave it at my last comment, but your logic really got under my skin.  (I think you&#8217;ve confronted me under another name before, to be honest)</p>
<p>There is nothing off base about talking about the details of what happened and why.  Would be a pretty useless blog if people were only able to post in general about the exact headline.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128534">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128534">
						January 8, 2010 9:54 AM					</a>

				</p>

				<p>Complex security systems occasionally have unexpected and embarrassing failures, regardless of how well they were designed and tested. This is why ongoing peer review is such an important part of today&#8217;s security matrix.</p>
<p>It is also why we read these posts &#8211; to learn (hopefully) from the mistakes of other and try to improve and/or fix our own products, services, procedures and even user education.</p>
<p>After all, to err is human.  All three vendors have acted quickly and proactively to communicate their security bulletins and issue corresponding fixes (links in the original article).  These updates are thankfully rare.  Kudos to them.</p>
<p>I&#8217;m more worried about those vendors that never communicate security issues, never update their firmware or software, and never admit to making a mistake.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128535">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">Dave</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128535">
						January 8, 2010 10:03 AM					</a>

				</p>

				<p>@HJohn &#8211; It is commonly said one-time pads represent perfect security. The problem is they are very impractical and there is no way around it. Where does the one-time pad come from, and how does the far end party get YOUR one-time pad to XOR the cipher text? Where do you store the one-time pad, since it is equally sensitive? And it&#8217;s as big as the original plaintext! And don&#8217;t ever reuse one the way Soviets did after WWII and got busted.</p>
<p>The point is, there is no way around the impracticalities. You can repeat it a thousand times: that a gaussian source XOR&#8217;d with plaintext cannot be broken. So what? You can&#8217;t escape the impracticalities of it.</p>
<p>From your posts, I suspect you are just arguing for the sake of arguing. But I am willing to expound for other reasons. And I am in good company when I make this point.</p>
<p>There are inescapable impracticalities when using encryption. Yes, there are better implementations and there are worse implementations &#8211; I guess this is your only point, really. So, what. You cannot escape the problems with key management, key generation, key storage, and how do you share files encrypted with one key on your machine with someone distant? Do you use layers of encryption with multiple keys? Ouch. And if the key is based on your password, then it is no better than your password. No matter what the algorithm is, you are essentially exchanging the sensitivity of your plaintext with the sensitivity of the key. And there are many other serious problems with encryption implementations.</p>
<p>Don&#8217;t take it personally.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128536">

			<div class="comment by-president-scroob ">

				<p class="commentcredit">

					<span class="commenter">President Scroob</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128536">
						January 8, 2010 10:09 AM					</a>

				</p>

				<p>&#8230; and the string was &#8216;12345&#8217;, the same combination I have on my luggage.</p>
<p>Also, John is right, the correct way to handle this stuff is:</p>
<p>password verified against a hash.<br />
password used to decrypt key.<br />
key used to decrypt data.</p>
<p>Since the password is entered in software and the key done in hardware, I would also suggest that the log-in program should send the password to the drive encrypted with either shared secret (more hackable) or public key (more secure) encryption, not in plain text.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128537">

			<div class="comment by-jgreco ">

				<p class="commentcredit">

					<span class="commenter">jgreco</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128537">
						January 8, 2010 10:17 AM					</a>

				</p>

				<p>@John</p>
<p>&#8220;Complex security systems occasionally have unexpected and embarrassing failures, regardless of how well they were designed and tested. This is why ongoing peer review is such an important part of today&#8217;s security matrix.&#8221;</p>
<p>The issue here is the complete and absolute lack of any meaningful testing by the vendors.  This design was so braindead, that I&#8217;d like to chalk it up to malice because it pains me to think someone could ever be this dumb.</p>
<p>I must say, I am hesitant to hand out kudos to those who fail so dramatically the first time around, then admit their after someone else points it out.  Seems like that is setting the bar a tad low.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128538">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128538">
						January 8, 2010 10:18 AM					</a>

				</p>

				<p>@Dave: From your posts, I suspect you are just arguing for the sake of arguing. But I am willing to expound for other reasons. And I am in good company when I make this point.</p>
<hr />
<p>That&#8217;s certainly not the case, and I apologize if I sound that way.</p>
<p>I did, in fact, like your analogy.  I just disagreed with the conclusion, no malice or offense was intended.  It really is my point that one could misunderstand why this happened and, as such, implement the wrong solution.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128539">

			<div class="comment by-jgreco ">

				<p class="commentcredit">

					<span class="commenter">jgreco</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128539">
						January 8, 2010 10:26 AM					</a>

				</p>

				<p>@Dave at January 8, 2010 10:03 AM</p>
<p>Nobody here is arguing that absolute security is practical, or even exists in the real world.</p>
<p>However, suggesting that the encryption used here is somehow at all responsible is patently absurd.  Because of the way the device was implemented, encryption <em>wasn&#8217;t even being used</em> for all intents and purposes.</p>
<p>This is a textbook example of an implementation issue, not an encryption issue.  You are not doing anybody any good by clouding this fact.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128540">

			<div class="comment by-till ">

				<p class="commentcredit">

					<span class="commenter">Till</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128540">
						January 8, 2010 10:49 AM					</a>

				</p>

				<p>One-time pads work fantastically in certain use cases. Every bank in Germany uses TANs; to do online transactions, they send you a list of 6-digit numbers in a secure envelope via snail mail. For each transaction, you must enter one of these numbers. When you&#8217;re running low, they send you another.</p>
<p>It&#8217;s a bit of a pain in the ass, but it also means anyone who manages to steal your password can only look at your bank account, not touch anything. It&#8217;s a wonderfully simple, low-tech, effective use of one-time passwords.</p>
<p>Obviously not every encryption scheme can be wedged into every situation. But that hardly needs to be stated.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128541">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">Bob</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128541">
						January 8, 2010 11:01 AM					</a>

				</p>

				<p>FIPS is a joke that means nothing about real-world security.</p>
<p>Last time I looked, the highest-level FIPS standard for operating systems assumed that the system being tested was being run on an isolated network, where the only people around were white hats with normal user privileges. So what they were really testing was: &#8220;If everybody who has access to the keyboard or the network has good intentions, and doesn&#8217;t have an admin password, how is it hard to accidentally screw the system up?&#8221;</p>
<p>It&#8217;s a telling point that ancient, notoriously malware-prone versions of Windows are FIPS-certified, while demonstrably secure versions of Mac OS X, Linux, and *BSD aren&#8217;t &#8211; mostly because Microsoft was willing to pay a lab to slap their FIPS rubber stamp down, while Apple etc. weren&#8217;t.</p>
<p>So that&#8217;s why our government and business world runs its security-critical infrastructure on the most insecure operating systems on the market. When they get hacked, anybody called to account can bleat, &#8220;Oh, but it was FIPS certified!&#8221;</p>
<p>Of course, there&#8217;s been discussion of higher FIPS levels that actually mean something realistic, but the last I checked, they hadn&#8217;t gone anywhere. I&#8217;m not sure whether the biggest contributing factor is that the people charged with defining test protocols can&#8217;t figure out how to do anything beyond the trivial, or that vendors object strenuously to any raising of the bar.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128542">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">Bob</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128542">
						January 8, 2010 11:03 AM					</a>

				</p>

				<p>Oops &#8211; second paragraph, &#8220;how is it hard?&#8221; should be &#8220;how hard is it?&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128543">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128543">
						January 8, 2010 11:11 AM					</a>

				</p>

				<p>@Bob at January 8, 2010 11:01 AM</p>
<p>I&#8217;ve long been of the opinion that the government would be better of if the:<br />
1) got out of the business of legislating/promoting standards and methodologies; and<br />
2) instead, legislate the penalties for certain types of disclosures.</p>
<p>Make it of concern to the business through the penalties/sanctions/laws/etc. and let people that really know what they are doing find the solutions.</p>
<p>Sort of like speed limits.  They haven&#8217;t passed laws mandating that everyone use cruise control, or have warning alarms when exceeding a certain speed, or that we even must have an accurate speedometer.  They just give us tickets if we are in excessive violations of the speed limit and let us figure out how to comply with the law.</p>
<p>I know it isn&#8217;t as simple as speed limits, but the point is still correct, IMHO.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128544">

			<div class="comment by-nobody ">

				<p class="commentcredit">

					<span class="commenter">Nobody</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128544">
						January 8, 2010 11:12 AM					</a>

				</p>

				<p>@bob<br />
The FIPS (Orange book C2) that NT famously passed was even worse than that. It doesn&#8217;t require that an intrusion was prevented just that certain attempts were logged.<br />
One famous OS that passed C2 didn&#8217;t even have a way to extract the logs &#8211; apparently C2 doesn&#8217;t require that the logs can be read, only that they are created.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128545">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128545">
						January 8, 2010 11:17 AM					</a>

				</p>

				<p>@Nobody: &#8220;apparently C2 doesn&#8217;t require that the logs can be read, only that they are created.&#8221;</p>
<hr />
<p>I know an auditor that once was tasked to verify an entity routed all their traffic through an IDS, in accordance with State law.  He found an IDS box, turned off, with holes drilled on the side of it and the cable passing through&#8230;the entity explained that &#8220;we couldn&#8217;t get it to work, but the law just says it has to pass through the IDS&#8211;it doesn&#8217;t say it has to be turned on.&#8221;</p>
<p>We got a good laugh, but those responsible were clearly inept.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128546">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">Dave</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128546">
						January 8, 2010 11:27 AM					</a>

				</p>

				<p>I think it&#8217;s a mistake to assume &#8220;OK, so someone found a vulnerability here, good work. But they&#8217;ll fix it and then we&#8217;ll be OK, right?&#8221; We will never be &#8220;OK&#8221;. Hardware and operating systems, etc are always changing. And everytime someone moves the furniture it introduces new vulnerabilities.</p>
<p>Imagine a company designed a car, but if you hit the wrong button at the wrong time for whatever reason, the steering would lock up on the next turn. Then imagine everytime someone got killed the manufacturer responded &#8220;Oh, another idiot. Well, it&#8217;s not our fault. We warned them not to even brush up against that button at the wrong time. It&#8217;s their fault.&#8221;</p>
<p>People will always say &#8220;it&#8217;s just a bad implementation&#8221;. But the difficulty in NOT implementing good security is inherent in the way encryption works. I&#8217;m not clouding anything. There are many glaring problems with encryption no one even points out, because that is all anyone knows. It&#8217;s often overlooked that once you encrypt a file, that ciphertext is tied to the key used, forever. You might lose the ciphertext and say to yourself &#8220;it&#8217;s OK, it&#8217;s encrypted.&#8221; But someone can keep your ciphertext as long as they want and even get the key months later from a completely different incident. The algorithm isn&#8217;t a secret. If you remember later &#8220;oops, I encrypted a WinZip file&#8221;, too bad. Those weaknesses are in there and you can&#8217;t take them back. You can&#8217;t stop someone from decrypting the ciphertext and you may never know if they did or not. And today, whole drives are being encrypted with a single password/key. Yikes!</p>
<p>The security isn&#8217;t like ripstop nylon, it&#8217;s more like the side of a potato chip bag. Once the tear starts it races down the side of the bag. If someone gets that key, who cares HOW they do it, they get EVERYTHING. And it doesn&#8217;t stop there. They can then use the drive to perhaps penetrate an entire network. Do you think you will know about it first, when it happens? You may never know. Many companies have been breached, but don&#8217;t even know it. What should we say then &#8211; &#8220;oh, it&#8217;s just another bad implementation?&#8221;</p>
<p>People need to work and they need tools to do so. They need to access files and they also need to keep information away from adversaries. That&#8217;s what people want and need. They don&#8217;t need to worry &#8220;uh&#8230;wonder where this thing is storing my keys?&#8221; They don&#8217;t need to worry if their keystrokes are being sniffed, because all the security of all their files and maybe the integrity of their entire business depends on one little bitty string &#8220;johnny_ran_home_88&#8221;. And they don&#8217;t need people telling them everyday &#8220;don&#8217;t forget to choose a ten mile long password, and don&#8217;t forget to change it all every two weeks because if you don&#8217;t it&#8217;s YOUR FAULT.&#8221;</p>
<p>Don&#8217;t tell me it&#8217;s got nothing to do with encryption.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128547">

			<div class="comment by-dave ">

				<p class="commentcredit">

					<span class="commenter">Dave</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128547">
						January 8, 2010 11:36 AM					</a>

				</p>

				<p>Watch for this: Someone will lose a laptop, but because it is encrypted with FIPS approved and certified endpoint security software, the company doesn&#8217;t report it. Then someone will break into it and the unreported information will be made public.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128548">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">bob</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128548">
						January 8, 2010 11:48 AM					</a>

				</p>

				<p>I&#8217;m loving my IronKey!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128549">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128549">
						January 8, 2010 11:54 AM					</a>

				</p>

				<p>Dave,</p>
<p>All encryption schemes are, technically, a one-time pad these days.  Basically, an encryption algorithm like AES or RC4 is a pseudo-random number generator with a seed value, except its state is affected by a continuous stream of re-seed values (the plaintext).  We generate a stream of random data the size of the entire plaintext, XOR it over the plaintext, and have our output.</p>
<p>This is an oversimplification.  However, to answer your question of &#8220;how do we transport the one time pad,&#8221; our current model is to publish an algorithm that generates the same one time pad given the same input OR correct output and the same key.  Some algorithms use methods by which the same input can produce multiple random outputs, but each of those decays back to the correct input (welcome to modular arithmetic); but basically, same idea.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128550">

			<div class="comment by-jgreco ">

				<p class="commentcredit">

					<span class="commenter">jgreco</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128550">
						January 8, 2010 11:55 AM					</a>

				</p>

				<p>@Dave at January 8, 2010 11:27 AM</p>
<p>What you are saying is generally considered common knowledge around here.  Everyone knows that if you have a ciphertext, and the key used to decrypt it, that you can recover the plaintext.  All of these points are true, obvious, and I wouldn&#8217;t think of disagreeing with them.</p>
<p>What I disagree with is the relevance of all of your points to <em>this</em> article.  No weakness in AES caused this incident.  The weakest link in this device wasn&#8217;t the cipher used, but the &#8220;secret doorknock&#8221; that it uses to unlock.  Quite clearly an implementation issue.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128551">

			<div class="comment by-jgreco ">

				<p class="commentcredit">

					<span class="commenter">jgreco</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128551">
						January 8, 2010 12:00 PM					</a>

				</p>

				<p>@Dave</p>
<p>&#8220;But the difficulty in NOT implementing good security is inherent in the way encryption works.&#8221;</p>
<p>I&#8217;m not sure how to parse this sentence in a way that make sense* so I ignored it.</p>
<p>*Are you trying to say that it is hard to improperly implement encryption?  That doesn&#8217;t make any sense at all.  I don&#8217;t think this is just an accidental double negative as you emphasized &#8220;not&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128552">

			<div class="comment by-paul ">

				<p class="commentcredit">

					<span class="commenter">Paul</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128552">
						January 8, 2010 12:06 PM					</a>

				</p>

				<p><i>All encryption schemes are, technically, a one-time pad these days. Basically, an encryption algorithm like AES or RC4 is a pseudo-random number generator with a seed value, except its state is affected by a continuous stream of re-seed values (the plaintext). We generate a stream of random data the size of the entire plaintext, XOR it over the plaintext, and have our output.</i></p>
<p>XORing a stream of data generated by a stream or block cipher is NOT a one-time pad.  It does not fit the randomness requirement any more than using a random number generator instead of the cipher would.</p>
<p>So technically speaking, no we are not using one-time pads these days.  Some people may, but by far it is the minority of cases.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128553">

			<div class="comment by-jgreco ">

				<p class="commentcredit">

					<span class="commenter">jgreco</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128553">
						January 8, 2010 12:08 PM					</a>

				</p>

				<p>@John</p>
<p>I fear you may have oversimplified a bit too much.  By definition, if you are using an algorithm to recreate your pad, then you are not using a OTP.</p>
<p>OTPs are provably secure while stream ciphers are not, and that is an important distinction to make.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128554">

			<div class="comment by-paul ">

				<p class="commentcredit">

					<span class="commenter">Paul</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128554">
						January 8, 2010 12:12 PM					</a>

				</p>

				<p>Sorry, the first paragraph was me quoting John.  I am too used to blogs that accept limited HTML.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128555">

			<div class="comment by-bob2 ">

				<p class="commentcredit">

					<span class="commenter">bob2</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128555">
						January 8, 2010 12:15 PM					</a>

				</p>

				<p>I&#8217;m with Bob.  IronKey is the real deal and I&#8217;m lovin&#8217; mine right about now.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128556">

			<div class="comment by-fips-nist-mishmash ">

				<p class="commentcredit">

					<span class="commenter">FIPS NIST Mishmash</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128556">
						January 8, 2010 1:02 PM					</a>

				</p>

				<p>Do you think they built in this backdoor so that they could support customers who call in because they forgot their password?  I would always want to know if a vendor has a backdoor into my ostensibly &#8220;encrypted&#8221; device.</p>
<p>Speaking of which, I&#8217;m in the market for an external hard drive.  I&#8217;m wondering if I should get one with hardware encryption or just use TrueCrypt.  It&#8217;s for backup purposes because I&#8217;m tired of burning my data to multiple DVDs.  I haven&#8217;t bought one yet because I&#8217;m concerned about these kinds of flaws in implementation.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128557">

			<div class="comment by-zooadmin ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://www.ironkey.com/usb-flash-drive-flaw-exposed' rel='external nofollow ugc' class='url'>zooadmin</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128557">
						January 8, 2010 1:22 PM					</a>

				</p>

				<p>love my ironkey too and they&#8217;re having a field day on this 🙂</p>
<p><a href="https://www.ironkey.com/usb-flash-drive-flaw-exposed" rel="nofollow ugc">https://www.ironkey.com/usb-flash-drive-flaw-exposed</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128558">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.dscoduc.com' rel='external nofollow ugc' class='url'>Chris</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128558">
						January 8, 2010 1:25 PM					</a>

				</p>

				<p>Not cracked, rather Hijacked&#8230;  Crappy article that was misleading&#8230;</p>
<p>Interesting to note that IronKey doesn&#8217;t have this problem&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128559">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128559">
						January 8, 2010 1:39 PM					</a>

				</p>

				<p>@ Dave</p>
<p>There have been many instances of car vendors recalling cars that have proven defective or had safety issues. A large Japanese car manufacturer recently did just this across the whole US market, IIRC, and won strong customer feedback as a result.</p>
<p>A few decades ago, the Ford Pinto safety issue was treated in a very different way, resulting in a massive customer backlash. And rightly so.</p>
<p>In other words: do it properly, treat it seriously and the vendor can actually gain goodwill.  Do it badly (or not at all) and heaven help them.</p>
<p>@Chris</p>
<p>&#8220;Interesting to note that IronKey doesn&#8217;t have this problem&#8230;.&#8221;</p>
<p>&#8230; yet.<br />
&#8230; as far as we know.<br />
&#8230; says who?</p>
<p>Paranoid? Moi?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128560">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128560">
						January 8, 2010 1:40 PM					</a>

				</p>

				<p>@FIPS NIST Mishmash: &#8220;Do you think they built in this backdoor so that they could support customers who call in because they forgot their password? I would always want to know if a vendor has a backdoor into my ostensibly &#8220;encrypted&#8221; device.&#8221;</p>
<hr />
<p>It&#8217;s possible, but I find it unlikely for two reasons:<br />
1) it would be a deliberate weakness opening them up not only to public embarassment and scrutiny, but also to potential legal liability.  If they state that data can &#8220;only&#8221; be retrieved with the password yet knew this wasn&#8217;t true, they could be subject to a whole other hosts of accusations.<br />
2)  if I were them, I&#8217;d much rather say &#8220;hey, if you lost you&#8217;re password, we can&#8217;t help you.  our product is so secure that not even we can see your data once you&#8217;ve protected it.&#8221;  Makes for a shorter service incident than saving customers from themselves.</p>
<p>But, I&#8217;ll admit it is possible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128561">

			<div class="comment by-kg ">

				<p class="commentcredit">

					<span class="commenter">kg</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128561">
						January 8, 2010 1:54 PM					</a>

				</p>

				<p>Seems silly in the first place. They key incremental requirement of FIPS140-2 is tamper-evidence. A device whose primary threat is physical loss/theft, obtaining the certification strikes me as abusive marketing. That it suffered from fatal implementation flaws is hardly surprising.</p>
<p>This seems akin to selling a 2-hour safe with in a shoulder-strap. Even if its really 2-hour certified, the design obviates the apparent goal (barring a limited class of users for whom the appropriate applications are well-understood).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128562">

			<div class="comment by-jimmyd ">

				<p class="commentcredit">

					<span class="commenter">JimmyD</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128562">
						January 8, 2010 2:11 PM					</a>

				</p>

				<p>@Ricky Bobby<br />
&#8220;It is generally people trying to make a quick buck.&#8221; &#8220;Saying that everyone that steals laptops or usb sticks has the capability/knowledge to hack encryption to get the data. It just doesn&#8217;t occur 99% of the time.&#8221;</p>
<p>Do you have a source for that &#8220;99% of the time&#8221; statistic?</p>
<p>I hear time and again that no one is stealing devices for the data, but merely to sell the hardware. While that may be true is some cases, I doubt there is really any way to truely know.</p>
<p>Once unencrypted data (or vulnerable encrypted data as in this case) is out of your control, you have to conclude that it has been compromised. To do otherwise would simply be foolish.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128563">

			<div class="comment by-kangaroo ">

				<p class="commentcredit">

					<span class="commenter">kangaroo</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128563">
						January 8, 2010 2:31 PM					</a>

				</p>

				<p>@Rick Bobby: &#8220;Saying that everyone that steals laptops or usb sticks has the capability/knowledge to hack encryption to get the data. It just doesn&#8217;t occur 99% of the time.&#8221;</p>
<p>This is not a &#8220;hack&#8221; of the encryption! If this &#8220;encryption&#8221; is sufficient for your uses (aka, you don&#8217;t expect your attacker to bother to download some freeware to pull your data), then why are you encrypting at all?</p>
<p>Just using an unusual filesystem would be cheaper, faster and sufficient. Download software to use ext3 on your Doze PCs and use a regular stick. Or split it into two partitions, copy partition a to b while inverting the bits, and wipe a &#8212; it would be a teeny little program. Or give the partition a disk label, and put the partition inside that partition so you have to know a tiny bit to mount the internal partition. Or rename all your files on a 1:1 mapping that is obscure &#8212; a teeny fast program.</p>
<p>You don&#8217;t want encryption at all &#8212; you&#8217;re paying both monetarily and computationally for just obscuring the system a teeny, tiny bit. In ten minutes you should be able to come up with 20 better solutions than encryption.</p>
<p>Another example of process over thought. This is where security fails &#8212; people don&#8217;t know what the hell they&#8217;re talking about. I bet &#8220;Rick&#8221; is responsible for all his school&#8217;s PC &#8212; or is even head of IT for a school district!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128564">

			<div class="comment by-breach ">

				<p class="commentcredit">

					<span class="commenter">Breach</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128564">
						January 8, 2010 2:32 PM					</a>

				</p>

				<p>@Dave<br />
&#8220;Watch for this: Someone will lose a laptop, but because it is encrypted with FIPS approved and certified endpoint security software, the company doesn&#8217;t report it. Then someone will break into it and the unreported information will be made public.&#8221;</p>
<p>Worse yet, with the breach reporting requirements only stating that the laptop/data must be encrypted, the user&#8217;s password can be inscribed on the laptop (rendering the encryption meaningless), but yet the company will not have to report since the laptop/data was encrypted.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128565">

			<div class="comment by-marketingspeak ">

				<p class="commentcredit">

					<span class="commenter">MarketingSpeak</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128565">
						January 8, 2010 3:10 PM					</a>

				</p>

				<p>@Bruce<br />
&#8220;The problem is that no one really understands what a FIPS 140-2 certification means.&#8221; &#8220;Marketing departments of security take advantage of this confusion&#8230;&#8221;</p>
<p>I have to expect that many people are misguided by this. There is a lot of terminology used by NIST for FIPS (i.e. validation, certification, compliance). FIPS validation (which results in certification) is for cryptographic modules, not consumer level products. All one needs to do is to programmatically call into a FIPS validated/certified crypto module (i.e. RSA BSafe or MS CryptoAPI) to claim FIPS <em>compliance</em>. This tells nothing of the actual security of the application, process, etc. using the FIPS validated crypto module (as we found out with these USB flash vendors).</p>
<p>From the FIPS 140-2 Validation Certificate:<br />
&#8220;Products which use the above identified cryptographic module may be labeled as complying with the requirements of FIPs 140-2 so long as the product, throughout its life cycle, continues to use the validated version at the cryptographic module as specified in this certificate. The validation report contains additional details concerning test results. No reliability test has been performed and no warranty of the products by both agencies is either expressed or implied.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128566">

			<div class="comment by-veracitor ">

				<p class="commentcredit">

					<span class="commenter">Veracitor</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128566">
						January 8, 2010 4:07 PM					</a>

				</p>

				<p>I don&#8217;t trust Ironkey.  Read their docs (public on their website)&#8230; their USB drives will load any firmware or key updates signed with Ironkey&#8217;s corporate private key, and if you read carefully, they don&#8217;t credibly promise not to sign hacks for third parties.  In fact, they brag about their close relationships with alphabet agencies.  They explain their technical design in enough detail to show that it is not properly secure&#8211; the user is given no assurance* that he must provide unique key material from outside to decrypt the data stored inside.</p>
<p>*I don&#8217;t mean assurance in an absolute sense; obviously the user would be unable to detect any backdoor Ironkey might choose to hide in the device.  I mean assurance in the sense that if the device correctly implemented the spec it would protect the user.  The Ironkey spec gives Ironkey a &#8220;master secret&#8221; good for all customers&#8217; devices, so by design the device is insecure against Ironkey.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128567">

			<div class="comment by-furshlugginer ">

				<p class="commentcredit">

					<span class="commenter">Furshlugginer</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128567">
						January 8, 2010 4:14 PM					</a>

				</p>

				<p>Now we know why Sandisk and the others refused to document the host-to-drive protocol to permit implementation of a Linux driver.   As soon as the Linux driver writer found out that all the USB drives used the same key the game would have been over.</p>
<p>Corollary:  ANY device for which you can&#8217;t get enough documenation to write a Linux driver is untrustworthy.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128568">

			<div class="comment by-glenn-maynard ">

				<p class="commentcredit">

					<span class="commenter">Glenn Maynard</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128568">
						January 8, 2010 5:15 PM					</a>

				</p>

				<blockquote><p>
  Complex security systems occasionally have unexpected and embarrassing failures, regardless of how well they were designed and tested. This is why ongoing peer review is such an important part of today&#8217;s security matrix.
</p></blockquote>
<p>As security systems go, these are very simple.  But yes, a major cause of this embarrassment is hardware manufacturers&#8217; insistance on keeping drivers closed-source.</p>
<p>Is there no standard protocol for authenticating to an encrypted USB storage device?  If there is, this failure is an order of magnitude worse&#8211;there should be standard USB test harnesses to verify that drivers are behaving properly.</p>
<p>If there&#8217;s no standard for this, then that&#8217;s another major underlying problem.  Standardizing this would let users use third-party, verifiable open-source drivers.  Short of that (open-source drivers in Windows for any reason are rare), it&#8217;d mean that Windows would probably have generic built-in drivers for these devices.  That&#8217;d be a major step up&#8211;not because Microsoft is writing the drivers, but because theirs would be under much heavier scrutiny than individual third-party ones, even without source code.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128569">

			<div class="comment by-wow ">

				<p class="commentcredit">

					<span class="commenter">Wow</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128569">
						January 8, 2010 7:09 PM					</a>

				</p>

				<p>Amazing how many followers of a security website don&#8217;t seem to &#8220;get&#8221; this flaw &#8211; all the usb keys involved &#8220;Use The Same Access Key &#8221; &#8211; pretty much ignoring the password the customer types in.  This is incredibly stupid.<br />
It&#8217;s like selling 100,000 door locks all with the same key, but bragging how good the lock internal mechanism is.</p>
<p>Seems like a similar number of followers advocate security by obscurity as well.</p>
<p>The point is, these are sold as secure USB keys, and they are not at all secure. You may as well save your money and buy a plain unencrypted USB flash stick.</p>
<p>Whether or not a person needs an actual secure encrypted USB flash drive is another question, but if you pay security, you should get security..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128570">

			<div class="comment by-trsm-mckay ">

				<p class="commentcredit">

					<span class="commenter">trsm.mckay</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128570">
						January 8, 2010 8:34 PM					</a>

				</p>

				<p>On the whole, I think FIPS 140 provides some value, but this latest attack points out its big weakness. I have commented here before on this problem, like when Michael Bond attacked the decimalization tables on the IBM 4758 a few years back.</p>
<p>Before I get into that actual weakness, lets define some terms to help make it clear just where the problem is (borrowing from Common Criteria): Protection Profile (PP), Evaluation Level (EAL) and Target of Evaluation (TOE). Probably because FIPS 140 predates CC, it combines PP and EAL together in 4 levels of rating (1 to 4).  BTW &#8211; a pet peeve of my is the prominent mention of EAL by marketing folks, but with no details about the PP or TOE. The complaint about Windows NT&#8217;s Orange book rating illustrates the point, the PP and TOE did not include networking, hence it did not have much real world value. Before leaving this aside, I would be remiss if I did not point out that the latest Windows Vista certification did include networking and many other components.</p>
<p>So my real complaint about FIPS 140 is that the TOE tends to be too small and the PP is not through enough for logical security. My favorite illustration is TRSM (tamper respondent/resistant security modules) intended for host based PKCS #11 implementations. FIPS 140 is pretty good at making sure you have implemented PKCS #11 correctly (correct algorithms, good RNG, etc.). But what it misses is that straight PKCS #11 does not work very well for server applications.</p>
<p>Consider that PKCS #11 was originally designed for small tokens (like smartcards) that the user could present to make crypto calculations. The token is normally locked down, and won&#8217;t perform any sensitive calculations until the user supply&#8217;s their password. This works great in the context of a user presenting a token for limited transactions (like logging on, or approving a sensitive action) so long as you can ensure the password is not cached or captured.</p>
<p>But the whole thing breaks down once you start using PKCS #11 for servers. No longer are the tokens brought into the system by the user (part of what they have), but instead they are permanently installed on the server. And it is no longer a real person providing the password, instead it is applications that must store the password and provide it (in stock implementations &#8211; in the clear) to the TRSM each time they want to do a sensitive operation. Obviously anyone who can monitor the communication channel can recover the password and improperly perform sensitive operations. Remote hackers can capture the passwords stored by the applications, and mis-use them as well. In short a stock PKCS #11 token used for host systems cannot prevent insider attacks &#8212; the very thing FIPS 140 levels 3 and 4 are supposed to ensure.</p>
<p>So why did companies get host form factor PKCS #11 based TRSMs certified at levels 3 and 4? It is because the TOE was set too small, and the PP was not through enough (it either needed additional tests or to require a larger TOE).</p>
<p>You will note that this PKCS #11 vulnerability (which I have described on this blog several times in the past) is very similar to attacks on the USB tokens. I have not read the details yet, but the problems sounds so similar I wonder if the tokens were using stock PKCS #11?</p>
<p>Finally, let me close this with a restatement of what FIPS 140 actually does right. The have an extensive PP (and the labs have the derived test cases needed to test it) for physical protection. Not aware of any other public standard that does this. The PP is also good at making sure algorithms and RNG are correctly implemented. The failing is not evaluating the larger system of how those tested components are used.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128571">

			<div class="comment by-trsm-mckay ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.linkedin.com/pub/michael-mckay/1/237/808' rel='external nofollow ugc' class='url'>trsm.mckay</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128571">
						January 8, 2010 9:01 PM					</a>

				</p>

				<p>@xxx wrote: 1. It only takes <em>one</em> person to crack it and make a tool available. The rest of us can just, you know, download the tool and <em>use</em> it, without understanding the details.</p>
<p>Things are more nuanced when using hardware security. A hardware security designer (or at least a <em>good</em> designer) is always aware that there product can be cracked given enough time, access, and resources. The trick is to design things so that the opponent has to go through the expense of cracking the hardware each time they want something of value. Obviously there is a spectrum of security problems, depending upon cost, required tools, and knowledge is needed; to perform a particular attack.</p>
<p>@bob wrote: Last time I looked, the highest-level FIPS standard for operating systems assumed that the system being tested was being run on an isolated network, where the only people around were white hats with normal user privileges.</p>
<p>Absolutely not, you are confusing several different standards and problems together. FIPS 140 at levels 3+ are intended to resist all external attackers and fully knowledgeable insiders up to some point of collusion (e.g. if you require 3-of-5 to do an operation, then it will take 3 crooked employees to penetrate the system under evaluation).</p>
<p>@kg wrote: They key incremental requirement of FIPS140-2 is tamper-evidence.</p>
<p>Level 3 requires tamper-evidence (e.g. can&#8217;t tamper with it without leaving some evidence). Level 4 requires tamper-respondence (detect the tampering and securely erase all the secrets before they can be revealed). I&#8217;m not sure what you meant by the rest of your post.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128572">

			<div class="comment by-trsm-mckay ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.linkedin.com/pub/michael-mckay/1/237/808' rel='external nofollow ugc' class='url'>trsm.mckay</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128572">
						January 8, 2010 9:15 PM					</a>

				</p>

				<p>Rereading what @bob said, he was talking about FIPS and standards for operating systems; perhaps I need to clarify. Now NIST has a lot of standards (which FIPS publishes), and some of them do apply to OS. I guess it is possible that some of them work they way he mentions, but it is pretty unlikely.</p>
<p>I think he is primarily remembering the Windows NT Orange book certification (which I mentioned in an earlier post), which incidentally was DOD, not FIPS.  But even considering the NT evaluated without a network, this is not an accurate statement. Orange book requires controlling privileged users, which Windows NT did.</p>
<p>As mentioned before, it is a good example of why choosing the proper PP and TOE is more important than the EAL.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128573">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128573">
						January 8, 2010 11:05 PM					</a>

				</p>

				<p>I just had to say wow at the comments. This could be the least productive comment section I&#8217;ve ever seen on this blog. I see a few regulars trying to steer it in a good direction, so here&#8217;s my two cents. Clive Robinson and I already fleshed secure drive encryption out pretty good in a previous post. If one is building hardware, then it will likely be an inline media encryptor. Here&#8217;s a start for someone looking to design one:</p>
<ol>
<li>Enforce red-black separation. The plaintext must NEVER touch any resource shared with ciphertext side. The crypto component usually bridges the two sides &amp; uses periods processing (data scrubbing) &amp; partitioning of memory to ensure this.</li>
<li>Keep the interface simple on the plaintext side. THe implementation should be layered to allow for verification, possibly formal.</li>
<li>Use tried and true methods. Keep the protocol as simple as possible.</li>
<li>The device includes a TRNG and generates all keys itself, while having self-test features.</li>
<li>
<p>The device should use two factor authentication if possible.</p>
</li>
<li>
<p>The device MUST have a &#8220;trusted path.&#8221; This is a way to ensure user input is ONLY sent to the cryptoprocessor. In my designs, I usually have a miniature keyboard or something, similar to SafeNet&#8217;s, that connects directly to the encryptor. Even a PIN pad is decent &amp; an LCD for status or requests is better, if possible. External hard drives are idea for this kind of stuff, as they are expected to be a bit bigger than USB.</p>
</li>
<li>
<p>In my designs, I create the encryption key using a combination of a user-supplied password &amp; onboard (or USB-stored) key, mixed with SHA-2 over a number of iterations.</p>
</li>
<li>
<p>If intentional data destruction is a must, like for classified info, then a Erase button or command should be included &amp; the master key should be in a predictable location. Erase should first overwrite master key several times, then any plaintext (Red) buffers, &amp; then try to burn random data into flash memory that contains user-specific key. If time is left, further sanitize RAM &amp; storage. If a strong password is used and Red data is overwritten, then ciphertext is unrecoverable (assuming good crypto). If password is weak, then user-specific key must be wiped as well. All of this can happen in seconds. My strategy is just press the button and throw it as high as you can. It will be clear by the time enemy grabs it. 😉</p>
</li>
<li>
<p>Covert channel analysis. It&#8217;s quite easy, although tedious, to design a system without covert storage channels if one uses the MILS architecture &amp; a separation kernel. Many out there. Timing channels are trickier &amp; require clocking inputs and outputs &amp; preventing discrepencies in timing. Formal methods should also be used to catch them at the logic level. Some can be eliminated, but many can only be measured. Don&#8217;t discount the importance of these: real-world &#8220;side&#8221; channel attacks are based on exploiting covert channels. If high robustness is needed, then so is covert channel analysis.</p>
</li>
<li>
<p>EMSEC. If your device is to be considered high assurance, rather than medium, then you will also need Emanation Security. The design should meet at least TEMPEST Level 2 standards and protect against both passive and active electromagnetic emanations. Many think TEMPEST is impractical. WRONG! It&#8217;s been used against US many times and a recent attack by (Cambrige?) researchers used active emanations to drop a RNG&#8217;s entropy from 32 bits to like 8. High assurance drive encryption requires TEMPEST protection.</p>
</li>
</ol>
<p>Pretty tired tonight so may have left out something. Hope this helps you guys looking to design secure drive encryption. Most important parts are: red/black; design for verification; tried and true beats neat and new; crypto key = onboard-generated key (preferably stored off device) + user password; trusted path. That last feature is essential for secure distributed systems and would have prevented this attack. Have at it!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128574">

			<div class="comment by-oliver ">

				<p class="commentcredit">

					<span class="commenter">Oliver</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128574">
						January 9, 2010 5:24 AM					</a>

				</p>

				<p>Has anyone ever seen a certificate that is worth the paper that it is printed on?</p>
<p>Just my $0.02 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128575">

			<div class="comment by-packagedblue ">

				<p class="commentcredit">

					<span class="commenter">PackagedBlue</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128575">
						January 9, 2010 12:04 PM					</a>

				</p>

				<p>Stock or bond certificate is, if &#8230;still good.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128576">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128576">
						January 9, 2010 1:26 PM					</a>

				</p>

				<p>@ Oliver</p>
<p>Actually, some certificates are quite good. For instance, a CISSP tells you the person has a certain variety of general knowledge and maybe a little experience on a subject. A Red Hat Certified Engineer is usually very capable of working on a Red Hat box. And so on. Plenty of good certifications. Making a wide generalization that certification is useless for functionality or security is foolish.</p>
<p>In the security/crypto realm, it&#8217;s usually the Orange Book, C&amp;A, Common Criteria or NSA evaluation. Common Criteria is mostly useless at lower levels. An example of a meaningful certificate is Green Hill&#8217;s INTEGRITY-178B RTOS being certified to &#8220;High Robustness,&#8221; with an EAL6+ rating. The OS was developed like an EAL7 application against a realistic protection profile, mathematically proven down to the code, and survived months of NSA pentesting with source code. So, thanks to their certificate, if their security target says it can do something, I believe it probably does. On the other hand, if they say something not in the protection profile (&#8220;our virtualization scheme stops all attackers&#8221;), then I&#8217;m not buying into it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128577">

			<div class="comment by-yoram ">

				<p class="commentcredit">

					<span class="commenter">Yoram</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128577">
						January 9, 2010 2:02 PM					</a>

				</p>

				<p>Proper certification is a very good thing, but FIPS certification is useful mainly for marketing but for little else.</p>
<p>A good certification process will have actual attacks done against the product. This only happens with Common Criteria and not with FIPS.</p>
<p>Another issue &#8211; a CC certified product is more likely a mature product than an uncertified one. This helps to weed out immature products, even if it does not necessarily mean a more secure one.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128578">

			<div class="comment by-peter-hillier ">

				<p class="commentcredit">

					<span class="commenter">Peter Hillier</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128578">
						January 9, 2010 3:36 PM					</a>

				</p>

				<p>To those that commented a common criteria certified product is likely more mature, note that at least of of the SanDisk products in question, notably the Sandisk FIPS 140-2 product, was also certified EAL-2 by the Australian lab that conducted the FIPS testing!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128579">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128579">
						January 9, 2010 11:25 PM					</a>

				</p>

				<p>@ Peter</p>
<p>EAL 2 is the 2nd lowest level of the common criteria. The security target and/or protection profile tell you what security traits the product claims to have. Then the lab evaluates the product against those claims with a process of a certain amount of assurance. In this case, the claims made in the product were functionally and structurally tested as in EAL2. EAL2 doesn&#8217;t require source code inspection or even a &#8220;methodical&#8221; evaluation of each component. In other words, they turned it on, tried a few things, made sure paperwork was in order, and then stamped EAL2 on it. Maturity isn&#8217;t really an issue at that level, reinforcing your point.</p>
<p>However, starting at EAL4, I would agree with Yoram that evaluated products are likely more mature. Even FIPS 140-2 has some value in its algorithm requirements: how many products have been broken for using hombrew xor-based crypto? So, it helps a bit and the security targets and EAL&#8217;s, for those that really understand them, help compare and contrast different offerings pretty well. I still think no product certified below EAL5 should advertise itself as secure due to common criteria certificate.</p>
<p>Info on Common Criteria, particularly security target &amp; similar documents<br />
<a href="http://en.wikipedia.org/wiki/Common_Criteria" rel="nofollow ugc">http://en.wikipedia.org/wiki/Common_Criteria</a></p>
<p>Info on EAL2 assurance level<br />
<a href="http://en.wikipedia.org/wiki/Evaluation_Assurance_Level" rel="nofollow ugc">http://en.wikipedia.org/wiki/Evaluation_Assurance_Level</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128580">

			<div class="comment by-peter-hillier ">

				<p class="commentcredit">

					<span class="commenter">Peter Hillier</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128580">
						January 10, 2010 9:46 AM					</a>

				</p>

				<p>@Nick P</p>
<p>I totally understand the difference and agree with you, but in this case, do you think the protection profile of the stick would have changed anything, given the FIPS 140-2 cert was already in place?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128581">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128581">
						January 10, 2010 1:16 PM					</a>

				</p>

				<p>@ Peter</p>
<p>We already covered the inadequacy of the FIPS 140-2 cert. It&#8217;s mainly focused on crypto, while CC certs focus on whole system. That&#8217;s important: this attack is on a separate system that the SanDisk device trusts. So, I guess your question is: is there any way CC certification could have shown the attack was possible? Short answer: definitely.</p>
<p>I reviewed the CC documents for the product. In Australia, there is no Protection Profile for this stuff, so their functionality is in the security target. The important part is in 2.4.1.25 where it says it can establish a trusted path between it and a specific application on the PC, but that&#8217;s &#8220;not included in the TOE.&#8221; The TOE is what&#8217;s being evaluated and the authentication system isn&#8217;t in it. Hence, impossible to catch a flaw there. Also strange considering that software is at high risk.</p>
<p>The real problem here is that of a trusted path, which is impossible in commodity OS&#8217;s, and lack of source-level review. You don&#8217;t need to even look at the software or source until about EAL4 and at EAL5-7, NSA gets source for pentesting. This error was so obvious I&#8217;m sure NSA would have caught it, so an EAL5-7 cert would, as usual, mean the product is pretty secure. EAL4 might have caught it if augmented with source review or if the OS had a trusted path, like BAE XTS-400, INTEGRITY Workstation, or Turaya Desktop.</p>
<p>If anything, I think these products make the case for open source (or at least evaluated source) software in any security certification process. Additionally, it reinforces the idea that we need a secure desktop platform because most of these crypto exploits start with a design flaw in base OS. Products like those above allow us to isolate the Password Entry app and ensure that only it receives user input. It also could ensure that only that app communicated with the device, which means the attack would have failed even with the poor software design. The problem is that the TCBs of current OS&#8217;s are so large that no product running on them can ever be certain to work right or achieve its security goals.</p>
<p>SanDisk Documents<br />
<a href="http://www.dsd.gov.au/infosec/evaluation_services/epl/data_protection/SanDiskCruzerEnterpriseFIPS.html" rel="nofollow ugc">http://www.dsd.gov.au/infosec/evaluation_services/epl/data_protection/SanDiskCruzerEnterpriseFIPS.html</a></p>
<p>Turaya Desktop Data Loss Prevention Solution<br />
<a href="http://www.teletrust.de/fileadmin/files/Workshops/070205_RSA-WS/RSA-07_Dt-WS_Vortr8_ifis-Pohlmann.pdf" rel="nofollow ugc">http://www.teletrust.de/fileadmin/files/Workshops/070205_RSA-WS/RSA-07_Dt-WS_Vortr8_ifis-Pohlmann.pdf</a></p>
<p>INTEGRITY Desktop based on EAL6+ RTOS<br />
<a href="http://www.ghs.com/products/rtos/INTEGRITY_workstation.html" rel="nofollow ugc">http://www.ghs.com/products/rtos/INTEGRITY_workstation.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128582">

			<div class="comment by-dave-ironkey ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.ironkey.com' rel='external nofollow ugc' class='url'>Dave IronKey</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128582">
						January 10, 2010 2:30 PM					</a>

				</p>

				<p>@ Veracitor</p>
<p>Many of your statements regarding IronKey&#8217;s security architecture are incorrect.</p>
<p>This is 100% incorrect:  &#8220;The Ironkey spec gives Ironkey a &#8220;master secret&#8221; good for all customers&#8217; devices, so by design the device is insecure against Ironkey.&#8221;</p>
<p>There is NO backdoor, and no &#8220;master secret&#8221;.  Such a design would be fundamentally ridiculous, and completely unsalable.  Do you really think that IronKey enterprise and government customers haven&#8217;t spent man-years doing in-depth security analysis of the architecture and even the source code of the implementation???</p>
<p>Our design documentation, including our FIPS 140-2 Level 3 security profile, clearly explain how AES key generation is done, how AES keys are protected (ie. encrypted with a hash of your password), and how password verification and brute force protection is implemented.  These designs are both procedurally secure (ie. brute force counter stored in a hardened CryptoChip), and cryptographically secured (ie. AES key cannot be decrypted without your password).  Also the hashes used to verify your password and to decrypt the AES key are different (multiple hashes with salt for AES key).</p>
<p>Also, the entire product is FIPS validated, not a sub-component module.</p>
<p><a href="http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/140sp/140sp1149.pdf" rel="nofollow ugc">http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/140sp/140sp1149.pdf</a></p>
<p>I&#8217;m not sure where you get that we &#8220;don&#8217;t credibly promise not to sign hacks for third parties.&#8221; Why would we sign custom firmware for anyone??? One, the development and maintenance of multiple firmwares would be cost-prohibitive, and two, why would we risk the integrity of our brand and products???</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128583">

			<div class="comment by-dave-ironkey ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.ironkey.com' rel='external nofollow ugc' class='url'>Dave IronKey</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128583">
						January 10, 2010 2:36 PM					</a>

				</p>

				<p>@ Nick P.  Great post on Common Criteria.  I have heard that the US Government is working on developing a Protection Profile for hardware-encrypted portable storage devices.</p>
<p>These recent events re-enforce that security certifications are important, but do not by themselves make a product secure. Buyers, and vendors themselves, need to understand exactly what components have been validated, and whether they are being validated against a standard set of security requirements, or are simply being “validated” to do what the vendor says they do, even if that implies security vulnerabilities.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128584">

			<div class="comment by-trsm-mckay ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.linkedin.com/pub/michael-mckay/1/237/808' rel='external nofollow ugc' class='url'>trsm.mckay</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128584">
						January 11, 2010 12:46 AM					</a>

				</p>

				<p>@Nick wrote: A good certification process will have actual attacks done against the product. This only happens with Common Criteria and not with FIPS.</p>
<p>The labs that certify FIPS 140 products include a variety of physical penetration tests. Perhaps you meant something broader than &#8220;product&#8221;?</p>
<p>@Yoram wrote: This only happens with Common Criteria and not with FIPS.</p>
<p>Can you point to a CC standard PP that covers crypto hardware? I searched pretty extensively about 5 years ago, but only found some smartcard PPs that were much less through than FIPS 140. Of course I might have overlooked something, or perhaps a new standard has come out? Unless there is a comparable PP (and set of derived tests), this talk about CC being superior is just theoretical. Unless you trust individual entities to somehow on their own come up with an adequate PP?</p>
<p>@Dave Ironkey wrote: I have heard that the US Government is working on developing a Protection Profile for hardware-encrypted portable storage devices.</p>
<p>I think this could be good, but I&#8217;m not holding my breath until I see it (since I first heard of this plan in the late 90&#8217;s 🙂  . The obvious benefit would be getting the good parts of FIPS 140 into a form where they can be used as a sub-component of other CC PPs.</p>
<p>Finally, Nick P&#8217;s comments about the weakness of the PP is right on. It does not matter how good the EAL is, all the EAL establishes is that product operates like the design says it should operate. If you want to know if the design is actually secure, that is where the PP comes in (with proper selection of the TOE of course).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128585">

			<div class="comment by-stephen ">

				<p class="commentcredit">

					<span class="commenter">Stephen</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128585">
						January 11, 2010 3:33 AM					</a>

				</p>

				<p>These hardware encrypted devices seem to be cracked by different teams every other month. It&#8217;s a concerning trend as hardware encryption is being pushed to laptops &#8211; I certainly hope the Chinese manufacturers are not as careless as our own.</p>
<p>Besiders, I don&#8217;t see why anyone else than consumers would buy these expensive yet faulty point solutions when there are more capable software solutions available for a fraction of the cost. Software protection at least works with all devices like external hard disks and memory cards, not just usb sticks.</p>
<p>We are currently screening different solutions for our staff and one of the most promising technologies seems to be Envault&#8217;s system; it&#8217;s easier and cheaper to protect all our existing drives than try to get all users to use hw encrypted drives. Plus there are no user passwords at all so none of these password fails are possible, and there&#8217;s built-in remote disable and auditing in the protection method.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128586">

			<div class="comment by-twylite ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.crypt.co.za/' rel='external nofollow ugc' class='url'>Twylite</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128586">
						January 11, 2010 6:01 AM					</a>

				</p>

				<p>Four notes on FIPS-140:</p>
<p>(1) It tests that your algorithms are (statistically likely to be) implemented correctly.</p>
<p>(2) It ensures that your Critical Security Parameters (keys, other secret values) are protected against disclosure.</p>
<p>(3) It validates that your implementation performs according to its public specification.</p>
<p>(4) It validates that your hardware provides the level of protection claimed in the public specification.</p>
<p>The public specification for the Kingston device is at <a href="http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/140sp/140sp929.pdf" rel="nofollow ugc">http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/140sp/140sp929.pdf</a> .</p>
<p>The CMVP has validates that this device works as documented, and that the documentation meets certain requirements in terms of algorithms used and key management principles.</p>
<p>It does not validate that the device works <em>as expected</em> by an end-user who has been misled by the marketing information.  That is not the point of FIPS-140.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128587">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128587">
						January 11, 2010 4:52 PM					</a>

				</p>

				<p>@ Twylite</p>
<p>Nice summary of what FIPS 140-2 covers and its limitations.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128588">

			<div class="comment by-tobby ">

				<p class="commentcredit">

					<span class="commenter">Tobby</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128588">
						January 12, 2010 8:58 AM					</a>

				</p>

				<p>Well, it is worth remembering that whilst the &#8216;Evil Maid&#8217; attack can be used against a fully encrypted computer a simpler attack can be made against all of these encrypted usb sticks. Just install a copy of the USB Dump facility and you will get a copy of the USB&#8217;s data, each and every time it is inserted into a compromised computer.</p>
<p>USB Dump<br />
&#8220;USB Flash Drives dump without query<br />
Januar 11, 2010 Kategorie: Portable Programme , Software &amp; Co , Windows January 11, 2010 Category: Portable programs, software &amp; Co., windows</p>
<p>2006 habe ich mal über die Software USB Dumper gebloggt. In 2006 I once blogged about the software USB Dumper. Diese Software kopierte unsichtbar jeglichen Inhalts eines USB-Sticks auf die Festplatte. This software is invisible to any content copied a USB stick to the disk. Ohne Abfrage – einfach im Hintergrund. Without query &#8211; just in the background. Das Tool von 2006 läuft nicht mehr unter Windows Vista / 7, deshalb habe ich Bene gebeten “mal eben” etwas neues zu basteln. The tool of 2006 no longer runs on Windows Vista / 7, so I asked Bene &#8220;tinker times just&#8221; something new. &#8221;<br />
<a href="http://stadt-bremerhaven.de/usb-sticks-ohne-abfrage-dumpen/" rel="nofollow ugc">http://stadt-bremerhaven.de/usb-sticks-ohne-abfrage-dumpen/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128589">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128589">
						January 12, 2010 10:13 AM					</a>

				</p>

				<p>@ Tobby at January 12, 2010 8:58 AM<br />
@ Twylite at January 11, 2010 6:01 AM</p>
<hr />
<p>Yup.</p>
<p>It doesn&#8217;t matter how strong one&#8217;s encryption is if it can be bypassed.</p>
<p>As I tried to point out before, unless the really exploitation is misunderstood, decision makers may implement the wrong solution, which is a waste of resources (and worse, may not work).</p>
<p>Dave made a good analogy about cars, about how one faulty part can wreck the whole car, which is absolutely true.  However, it is often much less expensive and just as effective to fix the faulty part than buy or built an entire new vehicle.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128590">

			<div class="comment by-veractor ">

				<p class="commentcredit">

					<span class="commenter">Veractor</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128590">
						January 12, 2010 3:20 PM					</a>

				</p>

				<p>@ Dave Ironkey</p>
<p>Your firm seems to have removed the &#8220;Ironkey Enterprise&#8221; docs which explained how the Ironkey devices trust firmware updates from Ironkey from its website.  Why?</p>
<p>Also, as Furshlugginer pointed out, since you won&#8217;t tell anyone what they need to know to write a Linux driver (that is, document the host-to-Ironkey communications protocol), your devices cannot be trusted.  When you say &#8220;users must install opaque, proprietary, Windows-only drivers,&#8221; you&#8217;re saying &#8220;don&#8217;t trust our devices.&#8221;</p>
<p>Finally, your firm&#8217;s docs make obviously bogus claims, like saying Ironkey corporate admins must have Ironkey devices.  That&#8217;s marketing, not technology, since an administrator&#8217;s &#8220;Ironkey&#8221; could obviously be emulated in software (assuming your firm signed the relevant public keys).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128591">

			<div class="comment by-gh0st ">

				<p class="commentcredit">

					<span class="commenter">gh0st</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128591">
						January 12, 2010 4:41 PM					</a>

				</p>

				<p>They probably used Vinetto a well known forensics tool to recover the Thumbs.db from the flash drive and found it had the decryption hash stored inside it. Not saying thats what they did, but it&#8217;s a possibility or its what I would have tried myself.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128592">

			<div class="comment by-gh0st ">

				<p class="commentcredit">

					<span class="commenter">gh0st</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128592">
						January 12, 2010 5:17 PM					</a>

				</p>

				<p>@ Dave</p>
<p>&#8220;There is NO backdoor, and no &#8220;master secret&#8221;. Such a design would be fundamentally ridiculous, and completely unsalable. Do you really think that IronKey enterprise and government customers haven&#8217;t spent man-years doing in-depth security analysis of the architecture and even the source code of the implementation?&#8221;</p>
<p>Then the device would not be allowed for general sale to any consumer full stop. If there was no way to break the security of your product, then you would be refused to re-sell said product.</p>
<p>In the United Kingdom the Regulation of Investigatory Powers Act (RIP) of 2000 makes it a crime to withhold encryption keys from the government. The United States has a history of trying to limit civilian use of military-strength encryption. Legislation was proposed to require government back doors be built into encryption software during the Clinton administration. These proposals failed due to commercial opposition and protests that encryption bans simply would not work. Public outrage over post-9/11 legislation, ostensibly for “homeland defense”, has created greater awareness of encryption techniques. Government and law enforcement agencies, consequently, have a renewed interest in limiting access of strong encryption to the general public.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128593">

			<div class="comment by-caf ">

				<p class="commentcredit">

					<span class="commenter">caf</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128593">
						January 12, 2010 8:09 PM					</a>

				</p>

				<p>It seems that no-one else has noticed that the described algorithm also reduces the key down to an effective 64 bits.</p>
<p>I am also <em>very</em> curious to know how the supposed software patches fix the problem &#8211; at the very least it would appear to still be susceptible to an offline guessing attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128594">

			<div class="comment by-gh0st ">

				<p class="commentcredit">

					<span class="commenter">gh0st</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128594">
						January 13, 2010 3:14 AM					</a>

				</p>

				<p>@ caf</p>
<p>The only workable &#8220;attack&#8221; on the Rijndael (AES) cipher is published as &#8220;brute force&#8221;. But I digress that if applications can be written that effectively attack and recover keys from WEP by using packets of random data filed with entropy Data by using the same Brute force method, then it stands to reason applications can be written that recover and brute force peoples Private encryption Keys using a similar method.</p>
<p>When I see commercial encryption products on Sale I always avoid them and mark them as untrusted. If it said Encryption with a OTP using 8126bit Sapphire 2 &amp; Serpent in CBC (Cipher Block Chaining) then I would consider its implementation as a secure product.</p>
<p>So in closing, all I can say is, if you dont want to be busted with your Stash, then make like a Hippy and hide the Hash!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128595">

			<div class="comment by-gh0st ">

				<p class="commentcredit">

					<span class="commenter">gh0st</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128595">
						January 13, 2010 4:34 AM					</a>

				</p>

				<p>Remember when the NSA assured everyone that DES was unbreakable? IBM insisted there was no backdoor.. Yet in contrast how long does it take to break DES with John the Ripper today!?! Someone told a load of lies.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128596">

			<div class="comment by-luis ">

				<p class="commentcredit">

					<span class="commenter">Luis</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128596">
						January 13, 2010 5:17 AM					</a>

				</p>

				<p>&#8220;FIPS 104-2 Level 2 certification &#8230;&#8221; &lt;&#8211; an obvious typo but nobody seemed to have noticed?</p>
<p>Shouldn&#8217;t this be &#8220;FIPS 140-2 Level 2 certification &#8220;?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128597">

			<div class="comment by-jgreco ">

				<p class="commentcredit">

					<span class="commenter">jgreco</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128597">
						January 13, 2010 9:07 AM					</a>

				</p>

				<p>@gh0st</p>
<p>&#8220;When I see commercial encryption products on Sale I always avoid them and mark them as untrusted. If it said Encryption with a OTP using 8126bit Sapphire 2 &amp; Serpent in CBC (Cipher Block Chaining) then I would consider its implementation as a secure product.&#8221;</p>
<p>Funny, because if I saw a product claiming to use encryption with a OTP, I&#8217;d know they most likely had absolutely no idea what they were even talking about and I would RUN, not walk, away.</p>
<p>&#8220;Remember when the NSA assured everyone that DES was unbreakable? IBM insisted there was no backdoor.. Yet in contrast how long does it take to break DES with John the Ripper today!?! Someone told a load of lies.&#8221;</p>
<p>I suspect you don&#8217;t even know what John the Ripper does, it is quite apparent you don&#8217;t know how it works.  John the Ripper is a password cracker, not a DES cracker.  It rapidly guesses passwords, hash them, then compare them to the hashed password it is attempting to crack.  No &#8220;backdoor&#8221; in DES is involved.</p>
<p>The reason plain old DES isn&#8217;t used these days is because it&#8217;s keysize is way to small, something we&#8217;ve pretty much always suspected.</p>
<p>A little bit of paranoia is always a healthy thing to have, but keep it reasonable and keep your facts straight.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128598">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128598">
						January 13, 2010 2:25 PM					</a>

				</p>

				<p>According to the SANS Institute:</p>
<p>&#8211;USB Flaws Prompt NIST Review of Cryptographic Module Certification Process (January 8 &amp; 11, 2010) The National Institute of Standards and Technology (NIST) is investigating security flaws in several brands of USB drives that were thought to be secure.  The vulnerability can reportedly be exploited to allow attackers to read data on drives protected by the 256-bit Advanced Encryption Standard.  The vulnerabilities lie not in the cryptographic module, but in the software that authorizes decryption.  NIST will be considering whether it should make changes to its validation process, as the USB drives in question all met the criteria.  SanDisk, Verbatim and Kingston, the three companies that acknowledged the vulnerabilities in their devices, have issued fixes for the problem.<br />
<a href="http://isc.sans.org/diary.html?storyid=7894" rel="nofollow ugc">http://isc.sans.org/diary.html?storyid=7894</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128599">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128599">
						January 14, 2010 3:06 AM					</a>

				</p>

				<p>@ ghost</p>
<p>8,126 bit Sapphire 2!? Wow, that sounds like some serious encryption! Definitely better than a measily 256 bit ECC or 2048 bit RSA or a 256 bit AES. It has like 32 times the bits of AES, which means it should be ^32 harder to crack! Sign me up!</p>
<p>@ jgreco</p>
<p>I&#8217;m with you this time. Marketing guys usually don&#8217;t know jack about the technicalities in crypto and it shows when the posers try to pass for engineers. This dude is so full of it it&#8217;s unreal. Back on topic, FIPS and CC on encrypted USB drives isn&#8217;t adequate with regards to defining security and needs improvement. Saphire 10,000,000+ bit or whatever probably won&#8217;t change that&#8230;. (laughs hysterically)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128600">

			<div class="comment by-robert-wann ">

				<p class="commentcredit">

					<span class="commenter">Robert Wann</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128600">
						January 14, 2010 6:57 AM					</a>

				</p>

				<p>The said SySS report developed a memory patch program to be inserted into the HOST PC memory (where the main executable program ExmpSrv.exe ver 2.0.5.32 resides) to completely bypass the password authentication process. A 32 bytes signature block data is identified during password reset and is found to be the same on all affected USB flash drives regardless of multiple password changes or drive reformatting. Using that 32 bytes signature block along with the memory patch program can effectively bypass user’s password authentication thus would allow the access to read/write of an affected USB flash drive. Note that 32 bytes signature block data disclosed by the SySS report is the AES ECB 256-bit decrypted result using the correct password as a key.</p>
<p>The HEX of a 32 bytes signature block found on all affected USB drives:<br />
00 00 00 00|B5 D3 68 DC|8A 4D A5 B1|FD 2E 68 84|<br />
4D F2 0D 52|1E 2B F9 CD|00 00 00 00|00 00 00 00</p>
<p>Being said, however, the report failed to address if all user data blocks are indeed AES 256-bit encrypted using a secret AES key as claimed by the product as if user’s password is used to decrypt the same 32 bytes signature block data and that 32 bytes signature block does not look like a valid secret 256-bit AES key, there could be no secret AES key at all, or something simple like an XOR algorithm does that trick? Or there may be possible that signature block is used to decrypt the actual secret 256-bit AES key? Can Bruce help talk to SySS for further finding?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128601">

			<div class="comment by-endareth ">

				<p class="commentcredit">

					<span class="commenter">Endareth</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128601">
						January 20, 2010 11:14 PM					</a>

				</p>

				<p>@gh0st<br />
&#8220;In the United Kingdom the Regulation of Investigatory Powers Act (RIP) of 2000 makes it a crime to withhold encryption keys from the government.&#8221;</p>
<p>My (admittedly limited) understanding of the RIP act was it&#8217;s intended to force the actual user of the encryption software to hand over the encryption keys, nothing to do with requiring some sort of backdoor in a product to bypass the encryption.</p>
<p>&#8220;Government and law enforcement agencies, consequently, have a renewed interest in limiting access of strong encryption to the general public.&#8221;</p>
<p>There&#8217;s a significant step from a government trying to limit access, and them forcing a requirement of encryption devices having backdoors. Especially when the device in question (in this case the IronKey), was partly government funded and used extensively by US government and military. Something tells me the US government wouldn&#8217;t be too happy about using devices they knew had security flaws.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128602">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128602">
						January 21, 2010 4:01 AM					</a>

				</p>

				<p>@ Endareth,</p>
<p>&#8220;Something tells me the US government wouldn&#8217;t be too happy about using devices they knew had security flaws.&#8221;</p>
<p>Actualy there is a history of making machine &#8220;field ciphers&#8221; have flaws or be excessivly brittle in design.</p>
<p>And there is a reason postulated for what the NSA where up to when they did it, and it always comes down to &#8220;reuse against the US&#8221;.</p>
<p>If you regard crypto as a weapon that can be used against you it would be nice if you could design it to be strong enough for you, but blow up in your enimies faces when it is used against you&#8230;</p>
<p>One early mechanical machine (Haglin C34 using the &#8220;coin counter&#8221;) was found on later anaylisis to have many many weak keys and only a few strong keys (It is possible to know which is which but it is not obvious or simple).</p>
<p>Thus the logic of weak keys by design works as follows,</p>
<p>1, Alice having designed and built the equipment is fully aware of the issue.</p>
<p>2, Alice &#8220;issues keys&#8221; to those she issues the machine to.</p>
<p>3, Alice only issues keys from the stronger keys.</p>
<p>4, Bob is happy with the arrangment because he (is/maybe) only liable for equipment and small amounts of key loss.</p>
<p>5, At some point, as is expected of all field systems, Eve captures a device and occasionaly a limited amount of keying material.</p>
<p>So far this gets you up to &#8220;the enemy knows the system&#8221; point.</p>
<p>However&#8230;</p>
<p>Eve might at some point think,</p>
<p>Alice uses this equipment, I cann&#8217;t find a way to crack their messages other than by getting key material, so I&#8217;ll use the design for my field ciphers as well.</p>
<p>And there are a whole bunch of examples of people either using captured equipment or building their own identical or very similar system based on Alice&#8217;s system.</p>
<p>So lets make the following assumption about the keyspace</p>
<p>A, 5% &#8211; very strong<br />
B, 10% &#8211; strong<br />
C, 20% &#8211; medium<br />
D, 50% &#8211; weak<br />
E, 15% &#8211; very weak</p>
<p>Alice only uses the first three,</p>
<p>C &#8211; for front line &#8220;fox hole&#8221; traffic to comand post.<br />
B &#8211; for comand post to division HQ.<br />
A &#8211; for division to brigade etc.</p>
<p>Thuss the majority of Alice&#8217;s traffic which is just tactical and there fore has a life of maybe a few days uses the medium strength keys. And due to the volume of that traffic and the assumption Eve has a captured machine, will alow alice to get some low level tactical information over time.</p>
<p>However the information Eve does get is either already known to Eve via her own more timely command field reports, or of little or no use. That is it is past it&#8217;s shelf life or only unit and command designators that will change.</p>
<p>There are similar traffic level and lifetime assumptions for the strong and very strong keys.</p>
<p>That is Eve only gets low end tactical and very rarely gets command etc.</p>
<p>Now think about when Eve re-uses the system&#8230;</p>
<p>If she has little or no idea that the majority of the keys (80%) are weak she may just issue keys to all levels of her troops randomly.</p>
<p>This gives Alice a field day&#8230;</p>
<p>Thus Alice has an 80% chance of reading any traffic including the highest levels.</p>
<p>Now lets look at Ian one of a number of not realy trusted allies of Alice or Bob on the fringes of the war.</p>
<p>For any one of various reasons Ian decides to change sides. But as he has the equipment Alice issued and his troops are used to using it, pragmaticaly he is still going to carry on using it.</p>
<p>He or Eve now issue the keys to be used. Well he is effectivly in the same position as Eve unless he &#8220;re-uses&#8221; previous key material Alice issued (which is a major NoNo for obvious reasons).</p>
<p>Now in 1973 Fred P. Winterbottom blew the gaff on what the Americans and British had done with regards mechanical cipher machines a quater of a century earlier due to various claims and counter claims it became clear by 1980 that mechanical cipher machines realy where poisoned chalices. So most countries lacking the abilities aproached a little Swiss Company Crypto AG. Now one of the things Crypto AG had a habit of doing was supplying brochers that had &#8220;example key generation system&#8221; examples&#8230; In the 1990&#8217;s it was found that apparently Crypto AG had maintained a close liason with the bods at Fort Mead (NSA Research office 😉 supposadly due AG supplying NATO countries with crypto kit.</p>
<p>However 1973 was a funny year in many ways it marked the start of Electronic Data Processing in non major companies and there where those funny little experiments with data comms going on that gave rise to the internet. Oh and some Dutch TV engineer started playing around with reproducing pictures of peoples TV screens to see if PO TV licencing vans realy could do it. Within a year Intel produced the first micro computer chips and the writing was on the wall for crypto.</p>
<p>The NSA kind of admit they &#8220;got it wrong&#8221; with DES they did not realise just how fast software would make bespoke crypto chips obsoleat.</p>
<p>Which brings us around to making brittle systems. The NSA realised that as people had done with DES they would make software versions with &#8220;variations&#8221;. So something had to be done.</p>
<p>Somebody somewhere came up with the idea of designs that where like building with glass. As long as you did it one way it was strong and any variation would make it exceptionaly weak.</p>
<p>This resulted in the ill fated clipper chip and capstone project that was killed of at the end of the Bill Clinton Years.</p>
<p>Nobody outside of the NSA know what the NSA are actually doing but&#8230; Old habbits die hard and it&#8217;s not just elephant&#8217;s that have long memories.</p>
<p>But does the NSA matter anylonger well yes.</p>
<p>They are still tasked with protecting not just the US Government but the people of the USA which includes those wearing uniform.</p>
<p>They know just as well as the bazar salesmen in Iraq and Afganistan that US military personel lose thumb drives which turn up for sale &#8220;secrets and all&#8221; on market stands.</p>
<p>However the enemy has changed they are not Government funded organisations they are small. The loss of encrypting thumb drives in Iraq is said to out number the number of insurgents&#8230;</p>
<p>Thus crypto as a weapon of war is back on the table and the enemy is using US equipment against US personel.</p>
<p>AES may well be secure but what about the keys?</p>
<p>Specificaly key generation and key handeling.</p>
<p>Business want&#8217;s emergancy key recovery so do US and other Nations intel community&#8230;</p>
<p>Thus you may now be less surprised at just why FIPS works the way it does and the NSA still make &#8220;codeword&#8221; encryptors.</p>
<p>Welcome to the 20th Century &#8220;Great Game&#8221; the question is what is the 21st Century &#8220;Great Game&#8221;&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128603">

			<div class="comment by-tom-corwine ">

				<p class="commentcredit">

					<span class="commenter">Tom Corwine</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128603">
						January 26, 2010 9:34 AM					</a>

				</p>

				<p>I know I&#8217;m a bit late in responding to this, but since no one else commented:</p>
<p>@Till &#8220;One-time pads work fantastically in certain use cases. Every bank in Germany uses TANs; to do online transactions, they send you a list of 6-digit numbers in a secure envelope via snail mail. For each transaction, you must enter one of these numbers. When you&#8217;re running low, they send you another.&#8221;</p>
<p>An One Time Pad (OTP) is NOT the same as a one time password.</p>
<p>An one time password is great for defending credentials from keyboard sniffers and the like, but that has nothing to do with encryption.</p>
<p>An OTP is quite a different thing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128604">

			<div class="comment by-edwin ">

				<p class="commentcredit">

					<span class="commenter">Edwin</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128604">
						January 26, 2010 11:40 PM					</a>

				</p>

				<p>Standards provide for repeatability.  Standards do not ensure whether something is fit for duty.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128605">

			<div class="comment by-black-monk ">

				<p class="commentcredit">

					<span class="commenter">black monk</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128605">
						February 17, 2010 10:39 AM					</a>

				</p>

				<p>John posed the most interesting question, and so far no-one has commented on it.</p>
<p>&#8220;How did the same flaw appear in the product of 3 different companies? Is this because all three are outsourcing to the same 4th company? Or is it that they&#8217;re following an industry standard? Or has someone who&#8217;s involved in the design been moving from company to company? &#8221;</p>
<p>It would be interesting to know if the pw is the same on all devices.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128606">

			<div class="comment by-albion-zeglin ">

				<p class="commentcredit">

					<span class="commenter">Albion Zeglin</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128606">
						August 19, 2010 10:04 AM					</a>

				</p>

				<p>There has been excelent discussion of the limits of FIPS validation.    I always inquire as to the specifics of any validation before accepting.   I value validations of the entire devices much higher than specific modules.</p>
<p>However, there is a more basic issue here.    What protection can inherently be provided by the architecture if correctly applied.  I have investigated and rejected multiple &#8220;Secure&#8221; USB drives that rely upon host drivers for both encryption and fingerprint locking.    Without hardware enforcement such as the Ironkey or separate key storage (such as Pointsec), the encryption can not utilize more entropy (bits) than the password itself provides.</p>
<p>Hardware protection is not perfect, but it can raise the bar significantly.  Utilizing a separate channel for key transfer can raise the bar higher.   But the bigger risk is compromize of the host machine itself.   Consider all the risks, not just the easy ones.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128607">

			<div class="comment by-stephen-toussaint ">

				<p class="commentcredit">

					<span class="commenter">Stephen Toussaint</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128607">
						September 4, 2010 11:31 PM					</a>

				</p>

				<p>Have read &#8220;Secrets &amp; Lies&#8221; &#8230;thank you.<br />
Independent research like yours inspires<br />
my work. Therefore I ask your opinion. Is there any OS environment more secure than an original DOS 3.0 diskette running on a PC without a modem or wireless circuit as an isolated computing environment to receive keyboard PT msgs. and return CT text files on a 3.5&#8243; floppy disk to hand transfer to another system for email exchange?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128608">

			<div class="comment by-harvey-parisien ">

				<p class="commentcredit">

					<span class="commenter">Harvey Parisien</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128608">
						September 15, 2010 1:11 PM					</a>

				</p>

				<p>The folks at IRONKEY.COM claim to have built a FIPS 140-2 Level 3 USB key much like the ones you comment on here. Now Lockheed Martin has adopted this product as one of their own new product offerings.  It would be interesting to extend your initial comments and research here to this current variation.  It seems to me it is still likely just as weak.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128609">

			<div class="comment by-roy ">

				<p class="commentcredit">

					<span class="commenter">Roy</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128609">
						December 22, 2012 8:57 AM					</a>

				</p>

				<p>Written By: Dave • January 8, 2010 8:53 AM</p>
<p>Please stop saying there is nothing wrong with the encryption, it&#8217;s just the implementation that&#8217;s wrong.</p>
<p>That&#8217;s like saying they were perfectly healthy, except their heart stopped beating.</p>
<hr />
<p>It is not like saying it is BETTER than all other Encryption Devices because there is a &#8220;Special Spot&#8221; for Special People to write their Password on it.</p>
<p>WE are NOT saying &#8220;there is nothing wrong with the encryption&#8221;, NIST is; and they tested it to &#8220;Level 2&#8221;. Next you will say that you can leave it in the Box, not plug it into anything and it will exceed your expectations (and what it was Tested for).</p>
<p>Read: <a href="http://en.wikipedia.org/wiki/FIPS_140-2_Level_4#Security_Levels" rel="nofollow ugc">http://en.wikipedia.org/wiki/FIPS_140-2_Level_4#Security_Levels</a> and see what you get.</p>
<p>That is the only claim being made. If you want Level 3, 4 or two rounds of AES-256 then get that instead. If you need &#8220;authentication&#8221; then that is what you need. If you need Common Criteria Certification then buy that instead. The Crypto Algorithm was implemented correctly, <b>no</b> other guarantees apply.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-128610">

			<div class="comment by-daser-camp ">

				<p class="commentcredit">

					<span class="commenter">daser camp</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128610">
						January 23, 2014 7:34 AM					</a>

				</p>

				<p>my question is that how to crack the incripted drives by bit locker which is present in windows 7</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-128611">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">Anon</span> •

					<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/#comment-128611">
						May 18, 2014 5:48 PM					</a>

				</p>

				<p>FIPS means &#8220;key escrow&#8221;.  I just modified the RNG in source, to return genuine random numbers, and FIPS tests now fail.  Tracing back the cause &#8211; your &#8220;random&#8221; numbers must be the output from the NSA escrow keys, or FIPS will not validate.</p>
<p>FIPS exists principally to ensure no US Government employees can create ciphertext that the NSA cannot easily read, and of course, to help let them in to anyone else in the world silly enough to use FIPS too.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2010/01/fips_140-2_leve.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2010/01/fips_140-2_leve.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F01%2Ffips_140-2_leve.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2010/01/fips_140-2_leve.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='3202' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2010/01/connecting_the.html" rel="prev">← Connecting the Dots</a>		<a href="https://www.schneier.com/blog/archives/2010/01/cybersecurity_t.html" rel="next">Cybersecurity Theater at FOSE →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
