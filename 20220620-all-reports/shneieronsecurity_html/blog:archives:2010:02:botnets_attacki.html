<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Botnets Attacking Each Other - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Botnets Attacking Each Other Comments Feed" href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/3258" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=3258' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F02%2Fbotnets_attacki.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F02%2Fbotnets_attacki.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-3258 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-3258" class="post-3258 post type-post status-publish format-standard hentry category-uncategorized tag-botnets tag-malware">

	<div class="article">

		<h2 class="entry">Botnets Attacking Each Other</h2>
		<p>A new Trojan Horse named Spy Eye has <a href="http://www.computerworld.com/s/article/9154618/New_Russian_botnet_tries_to_kill_rival">code</a> that kills Zeus, a rival botnet.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/botnets/" rel="tag">botnets</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html" rel="bookmark">Posted on February 17, 2010 at 7:45 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html#comments">44 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html" data-title="Botnets Attacking Each Other" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-130833">

			<div class="comment by-beta ">

				<p class="commentcredit">

					<span class="commenter">Beta</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130833">
						February 17, 2010 7:55 AM					</a>

				</p>

				<p>And we&#8217;re one step closer to a real malware ecology.</p>
<p>In this case the behavior has an obvious human motive: information I&#8217;m stealing is more valuable if I&#8217;m the only one stealing it. But it would be a good tactic for a pure software parasite too: a virus is more likely to survive if it goes undetected, and that&#8217;s difficult if a clumsy rival is alerting the user to trouble.</p>
<p>The topic of &#8220;benevolent worms&#8221; has come up before. Mr. Schneier has said that it&#8217;s a bad idea to create them, I&#8217;ve said it&#8217;ll happen sooner or later.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130834">

			<div class="comment by-zith ">

				<p class="commentcredit">

					<span class="commenter">Zith</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130834">
						February 17, 2010 8:00 AM					</a>

				</p>

				<p>@Beta: Your second reason was actually the first reason that came to mind about why someone would take this approach. And it doesn&#8217;t even need to be that the rival is clumsy as users will eventually notice the lost resources if there are too many competitors.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130835">

			<div class="comment by-romeo-vitelli ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://drvitelli.typepad.com' rel='external nofollow ugc' class='url'>Romeo Vitelli</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130835">
						February 17, 2010 8:23 AM					</a>

				</p>

				<p>And now that we have evolution in action, will the new superbots be more dangerous than before?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130836">

			<div class="comment by-wiredog ">

				<p class="commentcredit">

					<span class="commenter">wiredog</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130836">
						February 17, 2010 8:32 AM					</a>

				</p>

				<p>The early stages of Skynet&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130837">

			<div class="comment by-derob ">

				<p class="commentcredit">

					<span class="commenter">derob</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130837">
						February 17, 2010 8:35 AM					</a>

				</p>

				<p>maybe there comes a time that two bots are able to procreate, creating totally new bots&#8230; that would be life!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130838">

			<div class="comment by-a-nonny-bunny ">

				<p class="commentcredit">

					<span class="commenter">A Nonny Bunny</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130838">
						February 17, 2010 8:38 AM					</a>

				</p>

				<p>@Beta<br />
&#8220;The topic of &#8220;benevolent worms&#8221; has come up before. Mr. Schneier has said that it&#8217;s a bad idea to create them, I&#8217;ve said it&#8217;ll happen sooner or later.&#8221;</p>
<p>It already has happened. For example, <a href="http://en.wikipedia.org/wiki/Welchia" rel="nofollow ugc">http://en.wikipedia.org/wiki/Welchia</a> in 2003<br />
And it was a bad idea, because it caused a lot of traffic in spreading and downloading patches for fixing the security of the computer it was on.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130839">

			<div class="comment by-angel-one ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.angelsofsecurity.com' rel='external nofollow ugc' class='url'>Angel One</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130839">
						February 17, 2010 8:42 AM					</a>

				</p>

				<p>This isn&#8217;t really imitating the natural world as much as it is imitating traditional street gang behavior. (If you read the interview with the Nigerian scammer a few posts back you&#8217;ll notice that his &#8220;organization&#8221; is set up almost the same way as a traditional street gang too).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130840">

			<div class="comment by-pragmatist ">

				<p class="commentcredit">

					<span class="commenter">pragmatist</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130840">
						February 17, 2010 8:52 AM					</a>

				</p>

				<p>Are governments so different from street gangs either?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130841">

			<div class="comment by-user-agent ">

				<p class="commentcredit">

					<span class="commenter">User Agent</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130841">
						February 17, 2010 8:57 AM					</a>

				</p>

				<p>I noticed that today the blog is blocking requests without the optional user-agent header. Is this planned to be a permanent change?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130842">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130842">
						February 17, 2010 8:59 AM					</a>

				</p>

				<p>This is technology imitating nature.</p>
<p>Most bacteriocides come from germs trying to kill off rival germs. And viruses trying to block infections by other viruses are also well known. As are viruses parasiting other viruses.</p>
<p>Some of the most potent poisons are secreted by bacteria trying to spoil dead meat for scavengers. These are the ones causing food poisoning.</p>
<p>If you create an feeding ground, an ecosystem will develop.</p>
<p>Winter</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130843">

			<div class="comment by-user-agent ">

				<p class="commentcredit">

					<span class="commenter">User Agent</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130843">
						February 17, 2010 9:01 AM					</a>

				</p>

				<p>It looks like it was really something else. I had gotten a 403 back, changed the user-agent setting and things worked, so I assumed that was the problem. But when I switched back things were working again.<br />
So I don&#8217;t know why I got the 403.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130844">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130844">
						February 17, 2010 9:24 AM					</a>

				</p>

				<p>@ Moderator,</p>
<p>Are you having &#8220;growing pains&#8221; as I&#8217;m getting the Apache &#8220;forbiden&#8221; on a daily basis (https pages) at US breki / lunch / tea times.</p>
<p>When I used to run a server I had similar and found it is sometimes caused by resource contention under load (sometimes just by two hits at the same time).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130845">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130845">
						February 17, 2010 9:36 AM					</a>

				</p>

				<p>So the botnets have stepped it up a notch.</p>
<p>However they still appear to be using vulnerable non covert control and upload channels so they are fairly readily spotted.</p>
<p>Oh a modified version of Zeus had a go at .mil and .gov a short while ago with a payload designed to grab PDF&#8217;s and other docs&#8230;</p>
<p>The thing is it was successfull against some computers even though they had AV etc software on them.</p>
<p>I think something like one third of commercial AV software missed it even though it is fairly well known.</p>
<p>The simple fact is that a zero-day Botnet with rootkit and uploadable payload covert coms channels is going to be an ideal intel gathering tool.</p>
<p>And saying it came from Russia without further evidence is about as usefull as saying I bank with MegaBank (substitute your local major bank).</p>
<p>That is Russia is a relativly safe place for cyber-naredowells to appear to operate from.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130846">

			<div class="comment by-kashmarek ">

				<p class="commentcredit">

					<span class="commenter">kashmarek</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130846">
						February 17, 2010 10:03 AM					</a>

				</p>

				<p>When they have no common enemy to fight, then they fight each other.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130847">

			<div class="comment by-paul ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://alltoosimple.wordpress.com' rel='external nofollow ugc' class='url'>paul</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130847">
						February 17, 2010 10:25 AM					</a>

				</p>

				<p>So essentially what this says is that we common users have become a substrate for the evolution of higher life forms&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130848">

			<div class="comment by-ts ">

				<p class="commentcredit">

					<span class="commenter">TS</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130848">
						February 17, 2010 11:29 AM					</a>

				</p>

				<p>@Clive Robinson</p>
<p>Maybe it&#8217;s a rival security blog trying to take out the competition, we readers only have a limited amount of time to read blogs&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130849">

			<div class="comment by-brandioch-conner ">

				<p class="commentcredit">

					<span class="commenter">Brandioch Conner</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130849">
						February 17, 2010 11:43 AM					</a>

				</p>

				<p>Fascinating.</p>
<p>And yet so many people have claimed that you cannot automatically remove a rootkit on a remote machine.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130850">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130850">
						February 17, 2010 11:45 AM					</a>

				</p>

				<p>@ Clive</p>
<p>Actually, there is a sneaky botnet similar to what you describe. However, it doesn&#8217;t need 0-days or even subliminal channels. The bad guys have found that regular, but highly encrypted, malware with semi-covert channels is good enough. Check out Clampi, credential thief extraordinaire:</p>
<p><a href="http://www.pcworld.com/article/169333/massive_botnet_stealing_financial_info.html" rel="nofollow ugc">http://www.pcworld.com/article/169333/massive_botnet_stealing_financial_info.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130851">

			<div class="comment by-paul-renault ">

				<p class="commentcredit">

					<span class="commenter">Paul Renault</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130851">
						February 17, 2010 12:48 PM					</a>

				</p>

				<p>I knew that Core Wars would come back, eventually.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130852">

			<div class="comment by-alan-kaminsky ">

				<p class="commentcredit">

					<span class="commenter">Alan Kaminsky</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130852">
						February 17, 2010 12:50 PM					</a>

				</p>

				<p>Maybe all this malware will achieve what Apple, GNU, Linux, and everything else in the world have never been able to pull off: the demise of Windows and Microsoft. It&#8217;s gotten to the point where no sane person would even consider running Windows.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130853">

			<div class="comment by-craig ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.securityking.com/' rel='external nofollow ugc' class='url'>Craig</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130853">
						February 17, 2010 2:14 PM					</a>

				</p>

				<p>No panic yet, more human motive for financial gain as stated earlier, need to worry once the Trojan has more control over its choice of rivals it kills</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130854">

			<div class="comment by-champs ">

				<p class="commentcredit">

					<span class="commenter">Champs</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130854">
						February 17, 2010 2:53 PM					</a>

				</p>

				<p>I&#8217;m with wiredog, this is dangerously close to the premise of Terminator 3. Let&#8217;s just hope that Zeus isn&#8217;t a false flag.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130855">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130855">
						February 17, 2010 3:57 PM					</a>

				</p>

				<p>@ Nick P,</p>
<p>&#8220;Check out Clampi, credential thief extraordinaire&#8221;</p>
<p>Sadly insufficient information and I suspect on just one reading that the artical contains some incorect information possibly by design possably by miscommunication with the researchers.</p>
<p>I will go have a hunt around 😉</p>
<p>That being said there are a number of ways botnets are spotted.</p>
<p>1, Down the machine and check the files against known good files.</p>
<p>2, Check the files whilst the machine is running.</p>
<p>3, Observe the internal behaviour of the computer.</p>
<p>4, Observe the external behaviou of the computer.</p>
<p>The first works simply because the code has nowhere to hide IFF you check all the mutable memory against a known good copy (however this presupposes good code as a refrence).</p>
<p>The second runs the same way as the first however it has the additional assumption that you have a non rooted monitor that cannot be lied to by the rest of the machine (as we know with root kits this can be a failing with many kernels).</p>
<p>It is the way a number of malware prevention systems work however many are not particularly good as they only recognise &#8220;known&#8221; malware (and often not very effectivly).</p>
<p>The third method observes the computers working with regards memory access etc. Currently there is not as much information out there as needed to say if this will reach down into the hardware as well. Imagine it as DPA type activity.</p>
<p>By and large most computers have fairly regular signitures where a change can be fairly easily spotted. However it kind of requires the same if not more horse power as the machine it&#8217;s observing.</p>
<p>The fourth method is where it&#8217;s currently at for many researchers. Basically you have a &#8220;honey pot&#8221; machine that you observe carefully both it&#8217;s inputs and it&#8217;s outputs. Changes in behaviour trigger an alarm and type 1 or type 3 investigations follow.</p>
<p>However as I have noted in the past there are ways to enumerate a lot of &#8220;honey pot&#8221; systems simply because they are virtual and things like timestamps stay in &#8220;lockstep&#8221; across many IP addressess simply because it is actually just one machine using virtualisation software to pretend to be many.</p>
<p>Timestamp enumeration for instance can be made to appear to be a very hamfisted script kiddy attack. The Honeypot owner ignores it as just an unsuccessfull script kiddy. The covert enumerator however knows from examing the time stamps from the &#8220;kiddy scan&#8221; that it&#8217;s a &#8220;honeypot&#8221; and marks the IP address range as bad news and leaves it alone&#8230;</p>
<p>The real trick for the covert bot net is as I have said for a while is to hide the control and upload comms in what would be seen as normal user activity (such as a Google search). There are ways by which you can use Google to compleatly break the need for conventional channels&#8230;</p>
<p>It will be interesting to see what happens in Botnet development over the next year or so&#8230;</p>
<p>However I suspect we will only see the bad not the good unless we get type 1 and type 3 searches working properly.</p>
<p>And it&#8217;s not going to happen with consumer grade OS&#8217;s and hardware, they are designed to be &#8220;efficient&#8221; and that is often incompatable with security due to various side channels.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130856">

			<div class="comment by-david ">

				<p class="commentcredit">

					<span class="commenter">David</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130856">
						February 17, 2010 5:23 PM					</a>

				</p>

				<p><a href="http://i.imgur.com/TwLkA.jpg" rel="nofollow ugc">http://i.imgur.com/TwLkA.jpg</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130857">

			<div class="comment by-concerned ">

				<p class="commentcredit">

					<span class="commenter">concerned</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130857">
						February 17, 2010 5:45 PM					</a>

				</p>

				<p>@ Alan Kaminsky</p>
<p>Windows is attacked because it has market share, not because it is particularly vulnerable.</p>
<p>Success in attacking 100% of Macs would be similar to having 6% success on Windows. ROI for attacking Windows is much higher.</p>
<p>As Windows gets better look for the action to move to Flash and PDF.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130859">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130859">
						February 17, 2010 5:50 PM					</a>

				</p>

				<p>@ Brandioch Conner,</p>
<p>&#8220;And yet so many people have claimed that you cannot automatically remove a rootkit on a remote machine.&#8221;</p>
<p>It depends on if you mean a rootkit as a &#8220;specific known instance&#8221; or a &#8220;general class of unknown&#8221; software.</p>
<p>In this case it is a &#8220;specific known instance&#8221; so yes it can be removed because you don&#8217;t have to &#8220;search for it&#8221; (though care would be needed to not crash the system and that is probably the hard part).</p>
<p>In the case of a &#8220;general unknown&#8221; you have to go search and part of the rootkit class definition is it &#8220;hides it&#8217;s existance (that is it prevents detection by providing false results to searches etc).</p>
<p>All rootkits can be found and removed if you do not alow the rootkit to start and thereby hide it&#8217;s self (the problem is knowing you&#8217;ve checked &#8220;it all&#8221; and that is another issue altogether).</p>
<p>Most rootkits can be found even when running if you can &#8220;search underneath&#8221; the point at which the rootkit lies to you.</p>
<p>Simplisticaly it&#8217;s a bit like phoning a person and their secretary answers and say&#8217;s &#8220;their in a meeting&#8221;  unless you can check between the sec and the person then you are going to have to accept what the sec says.</p>
<p>If however the person has a window and you can look into their office through it and see them sitting at their desk, then you have got between the person and the sec, and thus know the sec is lying&#8230;</p>
<p>The other way of course is to ask questions where the sec/rootkit is caught out in a deception because their answers are inconsistant. Doing this to find a root kit can be done but it&#8217;s a lot of hard work and relies on your ability to find a question that shows the deception (say missing Inodes on a Unix file system, inconsistant used/unused cluster info and file sizes).</p>
<p>It is of course possible to design a &#8220;deadman&#8217;s switch&#8221; root kit. That is it encryptes the user files. If you remove or tamper with the root kit the encryption key is lost, and so are all the files so far encrypted. Thus sometimes it is not desirable to remove a root kit untill you have got all the user files off of the machine and tested them on an entirely different machine.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130860">

			<div class="comment by-rob ">

				<p class="commentcredit">

					<span class="commenter">Rob</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130860">
						February 18, 2010 2:28 AM					</a>

				</p>

				<p>@Clive Robinson:<br />
&#8220;2, Check the files whilst the machine is running.&#8221;</p>
<p>That can be done, even on a utterly rooted machine. If you had access to it when it was in a good state.  You know, not only security is hard, protecting malware kits is too 😉</p>
<p>Make a hash of password+the system. Then ask for the hash with a set of random passwords. The machine should come up with OK only for the correct password.</p>
<p>It is easy to make a set of hashes, each time with a different password and store them with random correct/incorrect passwords. At testing time, you should get back a list of PAS/NO PASS, {0, 1}, lines, which make up a binary number which you can remember or write down off-line (eg, 137). The only way to defeat this scheme is to store all tested resources and present them when asked for it.</p>
<p>I tried this idea out with a Python program, just a proof of concept (it is at SourceForge and repo.or.cz).</p>
<p><a href="http://sourceforge.net/projects/signduterre/" rel="nofollow ugc">http://sourceforge.net/projects/signduterre/</a><br />
<a href="http://repo.or.cz/w/signduterre.git" rel="nofollow ugc">http://repo.or.cz/w/signduterre.git</a></p>
<p>Note that it can be broken if the malware is able to run a simulated system. That is, if it can dish up a copy of every file or service you try to &#8220;sign&#8221;.</p>
<p>Rob</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130861">

			<div class="comment by-kangaroo ">

				<p class="commentcredit">

					<span class="commenter">kangaroo</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130861">
						February 18, 2010 8:42 AM					</a>

				</p>

				<p>@Clive: All rootkits can be found and removed if you do not alow the rootkit to start and thereby hide it&#8217;s self (the problem is knowing you&#8217;ve checked &#8220;it all&#8221; and that is another issue altogether).</p>
<p>Not true for the general case. Most would be correct &#8212; but there can be no universal &#8220;rootkit&#8221; signature. Universally, you can&#8217;t identify anything complex in a complex system &#8212; you can&#8217;t know the effects of anything for the most general case (without iterating over all possible states).</p>
<p>But practically, of course, that&#8217;s usually irrelevant, since you can get almost all cases.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130862">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130862">
						February 18, 2010 9:49 AM					</a>

				</p>

				<p>@ kangaroo,</p>
<p>&#8220;&#8211; but there can be no universal &#8220;rootkit&#8221; signature.&#8221;</p>
<p>True,</p>
<p>&#8220;Universally, you can&#8217;t identify anything complex in a complex system &#8211;&#8221;</p>
<p>Not quite true, you forgot the word &#8220;unknown&#8221; prior to either complex or system.</p>
<p>If you know what should be in the mutable memory and why then you can remove anything that should not be there or is not required for how you intend to operate the system.</p>
<p>Even in an unknown system forensic &#8220;mutable memory structure investigation&#8221; (now given various fancy names) has a reasonably good chance of identifing when and how changes where made.</p>
<p>That is there is a level below which the root kit cannot get and still be able to remain hidden from examination.</p>
<p>For instance on a simple hard drive (FAT16 format for example) if you had &#8220;defraged&#8221; it prior to the root kit then the position of data within the cylinders, tracks, clusters, sectors and slack space would be effectivly linear and should align with the File Alocation Table. The rootkit would either create a non linear disruption or be &#8220;tacked on the end&#8221;.</p>
<p>This can enable additions and modifications to be found reasonably easily.</p>
<p>I demonstrated this back in the early 90&#8217;s to a bunch of students looking for project work. However the found it &#8220;to dull&#8221; as a concept&#8230;</p>
<p>However I can see their point back then as the effort involved in carrying out such an analysis was usually not worth it (and thus did not get paid for at a lucrative rate if at all). However the new &#8220;begger your opponent&#8221; legal techneique of &#8220;electronic discovery&#8221; has put a slightly differant shine on it these days (hence the new fancy names psuedo linking it to geology etc 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130863">

			<div class="comment by-brandioch-conner ">

				<p class="commentcredit">

					<span class="commenter">Brandioch Conner</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130863">
						February 18, 2010 10:58 AM					</a>

				</p>

				<p>I wonder why those people who said that this couldn&#8217;t be done keep claiming that it is impossible when it is already being done &#8220;in the wild&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130864">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130864">
						February 18, 2010 11:20 AM					</a>

				</p>

				<p>@ Rob,</p>
<p>&#8220;Note that it can be broken if the malware is able to run a simulated system. That is, if it can dish up a copy of every file or service you try to &#8220;sign&#8221;.&#8221;</p>
<p>The thing abot &#8220;simulated systems&#8221; is they are not perfect&#8230;</p>
<p>Thus things like response times can also be measured to see if the system is real or simulated.</p>
<p>Checking the timing is not perfect but if the rootkit designer has not built it in you know that something is wrong.</p>
<p>A system such as this used to be used to stop CD-ROM games being coppied to hard disk and run from there.</p>
<p>It worked fine untill some people realised what was going on and built a simulator to make the HD response times look like that of the CD-ROM.</p>
<p>All simulated systems have achelies heals the question is can they be identified in a sufficiently reliable way.</p>
<p>From the rootkit writers point of view there is only so much they can simulate before the system response times become such that things don&#8217;t work the same way.</p>
<p>For instance I&#8217;m aware of a piece of Unix malware (yes it does exist) getting found simply because it changed the system charecteristics sufficiently that initd got it&#8217;s &#8220;nickers in a twist&#8221; 😉 A service that had previously started before another due to Hardware latency and resource issues did not start in time due to the malware using resources and due to poor script writing by a sysadmin it caused a process to fail. The subsiquent investigation revealed the malware.</p>
<p>In the case of the Sony rootkit it likewise got found out due to changing the behaviour of a machine. The first indication was a researcher noticed it did an ET, and subsiquently found other effects on the effects on the CD and HD.</p>
<p>It is knowing this that alows signitures not just of the files but the system activity thus enabeling changes to be detected. A very early example of this was with the ICL George Operating system. It was a batch system, and the operators used to listen to some asspects of the system on a speaker (built into the Op Pannel). The warbaling used to alert them to changes that indicated bugs etc. There is a story about an AM radio at MIT being used for the same purpose.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130865">

			<div class="comment by-kangaroo ">

				<p class="commentcredit">

					<span class="commenter">kangaroo</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130865">
						February 18, 2010 2:48 PM					</a>

				</p>

				<p>@Clive: That is there is a level below which the root kit cannot get and still be able to remain hidden from examination.</p>
<p>No &#8212; there isn&#8217;t such a level &#8220;in general&#8221;. &#8220;In usual&#8221; there is.</p>
<p>Take your FAT16 example &#8212; for most cases (almost all), that&#8217;s true. But it&#8217;s not necessarily true &#8212; a super-genius rootkit could continuously defrag itself.</p>
<p>That&#8217;s the problem with general computational systems &#8212; it has states that are provably unpredictable, except by full iteration.</p>
<p>It&#8217;s kind of a pedantic point, I know, but I&#8217;m a pedant. When I say &#8220;all&#8221; I mean the mathematical operator.</p>
<p>So, even with a &#8220;known&#8221; system and a &#8220;known&#8221; rootkit, if the rootkit is capable of general operations, it could be there without you knowing it (extremely unlikely). With an unknown rootkit, it could be there at a less unlikely (but still very unlikely) probability. With both unknown, you start to reach the level of it not being terribly unlikely that you can not identify the rootkit.</p>
<p>It&#8217;s like proving that a system has no &#8220;bugs&#8221; essentially. For a general computer without some special assumptions, you can only do it by going through all states. A rootkit is essentially a bug.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130866">

			<div class="comment by-brandioch-conner ">

				<p class="commentcredit">

					<span class="commenter">Brandioch Conner</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130866">
						February 18, 2010 3:35 PM					</a>

				</p>

				<p>@kangaroo<br />
&#8220;So, even with a &#8220;known&#8221; system and a &#8220;known&#8221; rootkit, if the rootkit is capable of general operations, it could be there without you knowing it (extremely unlikely).&#8221;</p>
<p>And, as demonstrated in the article that Bruce posted, this is sufficient for real world work.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130867">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130867">
						February 18, 2010 5:18 PM					</a>

				</p>

				<p>@ kangaroo,</p>
<p>&#8220;It&#8217;s kind of a pedantic point, I know, but I&#8217;m a pedant. When I say &#8220;all&#8221; I mean the mathematical operator.&#8221;</p>
<p>This could prove interesting then 8)</p>
<p>One of the (so so) excepted attributes of a rootkit is it survives a full power cycle of the system.</p>
<p>IFF you agree with that then you must have some part of the root kit in a tangable form in semi-mutable memory on the system.</p>
<p>That is when the system is powered up there must be information (code) retreived from the semi-mutable memory WITHIN the system to activate the information that forms the rootkit (agreed?).</p>
<p>If not then the machine does not have a rootkit on it at powerup (agreed?)</p>
<p>Thus the rootkit can be said to have a tangable pressence on the system.</p>
<p>On a &#8220;known&#8221; (that is known to be good) system this information in tangable form will be in addition to that, that is &#8220;known&#8221;.</p>
<p>Because it is in tangable form it is using some of the systems resources whilst powered down.</p>
<p>It also cannot be hiding it&#8217;s self when powered down.</p>
<p>Thus examination of all the semi-mutable memory on a powered down &#8220;known&#8221; system will be able to find any additional or modified resources.</p>
<p>Thus an examination (by an imutable check agent) of the information in semi-mutable memory as data and not code will show where it has been changed and how.</p>
<p>Thus there is a level below which the rootkit cannot hide it&#8217;s self as it has to be available (in part) to be seen by the CPU as code on powerup.</p>
<p>So a scan of the memory before powerup compared to a scan of the memory after it is powered up will show a difference if the rootkit is hiding it&#8217;s self.</p>
<p>Now I would agree there may not be much you can do with the information IFF a difference is discovered but it is an indicator that something is unacountably different.</p>
<p>At which point you may simply oblitarate the contents of the memory concerned and re-load it with known good information.</p>
<p>I would however agree that you cannot ask the system it&#8217;s self to do the scan as there is usually semi-mutable memory within a modern CPU that does survive a power cycle.</p>
<p>Which gives rise to some issues if the design of the CPU is such that it&#8217;s semi-mutable memory is not verifiable via it&#8217;s pins.</p>
<p>So on a &#8220;known&#8221; system there are ways by which a rootkit or other unautherised change that has been made can be detected.</p>
<p>The problem is of course that the imutable resources required to do this put some interesting constraints on system design.</p>
<p>You will note that I&#8217;m avoiding the issue to do with the &#8220;known&#8221; system image actually containing a rootkit.</p>
<p>Thus if your instalation media comes with a built in rootkit, tough you are owned and there is I would agree little that you can do IFF the rootkit has been put in correctly.</p>
<p>However if we are going to discusse this in any real depth we do need to start nailing down meanings or we could easily argure at cross purposes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130868">

			<div class="comment by-jay ">

				<p class="commentcredit">

					<span class="commenter">Jay</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130868">
						February 18, 2010 6:03 PM					</a>

				</p>

				<p>@Clive</p>
<p>Sooner or later, inspecting all the &#8216;semi-mutable memory&#8217; on the system will require desoldering the BIOS Flash.</p>
<p>I figure the only reason we haven&#8217;t seen BIOS rootkits is a effort/risk vs. reward thing &#8211; it&#8217;s not <em>worth</em> it yet to make your rootkit practically undetectable&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130869">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130869">
						February 18, 2010 7:14 PM					</a>

				</p>

				<p>@ kangaroo,</p>
<p>I think for the sake of the Moderator&#8217;s blood presure I should explain something.</p>
<p>We are both right and both wrong&#8230;.</p>
<p>Which is why I said,</p>
<p>&#8216;This could prove interesting then 8)&#8217;</p>
<p>We are actually talking about to seperate things, that look very similar.</p>
<p>You are saying that &#8220;inside a system&#8221; the system cannot prove it is not infected (Alan Turing&#8217;s halting and Kurt Godel&#8217;s undecidability theorms).</p>
<p>I&#8217;m saying that by &#8220;being outside&#8221; the system you can detect unautherised changes made to the system (by malware etc) by simple image comparison.</p>
<p>As Brandioch and I have crossed foils over this in the past it needs a little further explanation for others (especialy as some may think I have changed my position).</p>
<p>There is a problem with Alan Turing&#8217;s little state machines that is not talked about very much.</p>
<p>They process &#8220;information&#8221; on a tape (memory). The information can be used as data or code or both.</p>
<p>The issue is there is no segregation between information that is data and information that is code.</p>
<p>From a security asspect the Universal Turing Machine is a foot with both barrels of a loaded shotgun with a hair trigger pressed very firmly up against it.</p>
<p>However the problem is a little deeper than that.</p>
<p>Broadly there are two types of computing engine.</p>
<p>1, those that change data but do not react to data</p>
<p>2, Those that change data and do react to data.</p>
<p>The difference is not immediatly obvious but has significant implications for what can be done with data and security.</p>
<p>A Digital Signal Processor is an example of the first type of computing engine. It reads data in and performs a set of instructions on the data such as multiply by a constant and add a previous value and outputs the changed data.</p>
<p>The data it&#8217;s self is never looked at by the DSP program, thus it is not working as a Universal Turing Machine because it&#8217;s behaviour is not modified by the data therefore there are certain things it cannot do (branching on compare).</p>
<p>From a security asspect such a computing engine is highly desirable as you can prove exactly what it will do under all circumstances.</p>
<p>Of the other type of computing engine there are again two basic types. Those where instructions and data are on seperate tapes (Harvard) and those where they are both on one tape (von Neumann).<br />
From a security asspect the Harvard architecture is preferable to the von Neumann. However for many reasons the von Neumann architecture is prefered for &#8220;general computation&#8221;.</p>
<p>From a security asspect the &#8220;Pure Harvard&#8221; architecture has the advantage that data can never be used as code. Although data can change the flow through the states of a program the data cannot add new states either deliberatly or accidentaly.</p>
<p>Thus with a &#8220;Pure Harvard&#8221; architecture any insecurity has to be &#8220;built in and excercised by the data&#8221;, the data cannot add insecurity.</p>
<p>From the security aspect the von Neumann architecture is Argh&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130870">

			<div class="comment by-kangaroo ">

				<p class="commentcredit">

					<span class="commenter">kangaroo</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130870">
						February 18, 2010 7:41 PM					</a>

				</p>

				<p>@Clive:</p>
<p>Yes, of course, you can use a machine that is not a general computing machine.</p>
<p>But, but, but for the non-DSP case &#8212; making code immutable doesn&#8217;t solve your problem. What you need to do is not only make code immutable &#8212; but remove any possible infinite loops, which requires as well making any branching decisions be to code that itself can&#8217;t make arbitrary branching decisions. Aka, no &#8220;interpreters&#8221; exist on the machine &#8212; which is not generally acceptable, since that eliminates most software programs, reducing all programs to the &#8220;DSP&#8221; class.</p>
<p>That is the little &#8220;Goedel&#8221; issue. Russell tried exactly to separate &#8220;data&#8221; from &#8220;code&#8221; to avoid infinite regress &#8212; and Goedel found that you can get around it, for the general case, no matter how hard you try.</p>
<p>Now, with a few assumptions, you can get around it &#8212; as you say, immutable code AND a hardware controlled offswitch (or a limited memory that is tractably iterated). Then, you can&#8217;t eliminate rootkits &#8212; but they can only survive temporarily and be predictably eliminated.</p>
<p>So, it depends on what your goals are &#8212; for a server, an offswitch is a bad assumption. For most general computers, immutable code is a bad assumption.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130871">

			<div class="comment by-rob ">

				<p class="commentcredit">

					<span class="commenter">Rob</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130871">
						February 19, 2010 1:15 AM					</a>

				</p>

				<p>@Clive Robinson:<br />
&#8220;The thing abot &#8220;simulated systems&#8221; is they are not perfect&#8230;&#8221;</p>
<p>My point completely.</p>
<p>The idea behind the signing is that &#8220;Security is hard&#8221;. Hard for the defender, but also hard for the attacker.</p>
<p>In most security situation, the defender must assume the attacker has more resources than &#8220;herself&#8221;. In this situation, it is the Rootkit that has less resources than the legitimate defender.</p>
<p>The rest of the discussion is about the fact that a rootkit theoretically could simulate the whole computer, say, by running it in a virtual machine with appropriate hooks.</p>
<p>In a &#8220;normal&#8221; security analysis you would indeed investigate this probability, as the attacker might indeed have the hardware to do this.</p>
<p>But YOUR computer is all the attacker has. It has to fit in limited storage, with limited power. So there will ALWAYS be operations you can ask it to perform that it will not be able to complete.</p>
<p>So, just make sure you ask a lot of unpredictable &#8220;questions&#8221; using a wide range of system commands and programs. And look at many different places.</p>
<p>The seminal paper on this would be &#8220;Reflections on Trusting Trust.&#8221;<br />
<a href="http://www.schneier.com/blog/archives/2006/01/countering_trus.html" rel="nofollow ugc">http://www.schneier.com/blog/archives/2006/01/countering_trus.html</a></p>
<p>Note that David A Wheeler has completed his PhD thesis on how to break the chain:<br />
<a href="http://www.dwheeler.com/blog/2009/11/29/#trusting-trust-success" rel="nofollow ugc">http://www.dwheeler.com/blog/2009/11/29/#trusting-trust-success</a></p>
<p>Rob</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130872">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130872">
						February 19, 2010 6:01 AM					</a>

				</p>

				<p>@ Rob,</p>
<p>&#8220;Note that David A Wheeler has completed his PhD thesis on how to break the chain:&#8221;</p>
<p>This I very much look forward to reading 8)</p>
<p>@ kangaroo,</p>
<p>&#8220;So, it depends on what your goals are&#8221;</p>
<p>Yes but as importantly how you define them, view them and most importantly implement them.</p>
<p>For instance you say,</p>
<p>&#8220;&#8211; for a server, an offswitch is a bad assumption. For most general computers, immutable code is a bad assumption.&#8221;</p>
<p>Which in a 20,000ft view I would agree with,</p>
<p>But these are end point conditions and in one case we know dosen&#8217;t exist (server never off).</p>
<p>Importantly recognition of this has enabled us to get closer to the desired state (server never off) by using other tricks and tradeoffs and thus doing an &#8220;end run&#8221; around the issue usually by making things worse&#8230;</p>
<p>In the case of &#8220;server never off&#8221; it is a trade on Mean Time To Fail (MTTF) and Mean Time To Repair  (MTTR), and putting parallel systems in place to make the trade work.</p>
<p>!!! Warning long dull explaination !!!</p>
<p>For those that don&#8217;t know Military systems have high &#8220;availability&#8221; figures that usually cannot be met by single components.</p>
<p>What engineers did was change the design goals.</p>
<p>Achiving MTTF figures is a game of diminishing returns on a single component. That is the cost of designing a single component that was twice as reliable was more than twice the cost at some point on the curve and starts getting exponentialy worse there after.</p>
<p>The solution is to use two or more components in parrallel thus if one fails you suffere a decrese in performance untill it is replaced. You then design the system to have a performance that works within specification with that decrese.</p>
<p>You then design the components in the system to be easily replacable thus vastly reducing the MTTR. The problem with doing this is it also brings the components MTTF down as well which appears to be counter intuative.</p>
<p>But the decrese in MTTF is considerably less than MTTR. Thus there appears to always be a &#8220;sweet spot&#8221; at which a trade can be made for the number of components you put in parellel</p>
<p>So you can make things better by making them worse 8)</p>
<p>Eventually you design a system to automatically detect and swap over failed components (fail over) the swap spares being kept in &#8220;hot standby&#8221;. You then design the system such that components can be &#8220;hot swapped&#8221; that is removed whilst still in operation for &#8220;Planed Maintenance&#8221; etc.</p>
<p>However the curves of component life times is complex (so called bath tub curve) and this makes the problem somewhat more complex.</p>
<p>!!! End of long Dull&#8230;</p>
<p>But getting back to your points,</p>
<p>&#8220;But, but, but for the non-DSP case &#8212; making code immutable doesn&#8217;t solve your problem. What you need to do is not only make code immutable &#8212; but remove any possible infinite loops&#8221;</p>
<p>Sorry I forgot to mention loops this time around but as Nick P knows I&#8217;ve mentioned them before along with both positive and negative, feedforward and feedback (not the best terms to use but they surfice).</p>
<p>Yes &#8220;infinate loops&#8221; in changes of state have to be removed and be replaced by &#8220;chains&#8221; of states and of course &#8220;halting&#8221; has to be enforced within a state as well.</p>
<p>Which does put a limit on what you can do.</p>
<p>However I need to be carefull with saying this point 😉 you don&#8217;t have to &#8220;remove&#8221; data dependent branching or looping or non halting from your system for security.</p>
<p>What you have to do is &#8220;prevent the detremental effects&#8221; of &#8220;state looping&#8221; and &#8220;state halting&#8221; for security.</p>
<p>That is you are doing what humans do best taking an &#8220;end run&#8221; around the problem (it&#8217;s how Monte Carlo methods started at Los Almos).</p>
<p>Which brings me back to,</p>
<p>&#8220;Aka, no &#8220;interpreters&#8221; exist on the machine &#8212; which is not generally acceptable, since that eliminates most software programs, reducing all programs to the &#8220;DSP&#8221; class.&#8221;</p>
<p>First off this is not always a problem for security as we have both noted.</p>
<p>But secondly whilst True (in the mathmatical sense) for a self contained systems, it&#8217;s not of necesity true of a system with a monitoring agent IFF you are prepared to accept a loss of functionality in return for control.</p>
<p>And this is where it gets very messy (think of it as the start of &#8220;Monte Carlo method&#8221; of security).</p>
<p>We know that in the mathmatical sense we have issues with both Turing&#8217;s and Goedel&#8217;s problems on &#8220;general computing engines&#8221;</p>
<p>As you put it,</p>
<p>&#8220;That is the little &#8220;Goedel&#8221; issue. Russell tried exactly to separate &#8220;data&#8221; from &#8220;code&#8221; to avoid infinite regress &#8212; and Goedel found that you can get around it, for the general case, no matter how hard you try.&#8221;</p>
<p>The point is that what Goedel, Russel and Turing where trying to do does not directly apply to security.</p>
<p>We know in very real terms that security can never be absolute. However the Universe is finite thus we can put security beyond that finite bound in various ways. That is we perform an end run around one particular aspect (brut force) of the security problem.</p>
<p>Kurt Goedel&#8217;s theorms show that ultimatly we can not determin some things. But do we need to determine that an action is actually insecure?</p>
<p>Now we can say on &#8220;probability&#8221; it is and therefore take action on the assumption it is insecure. Thus effectivly step back from Goedel&#8217;s theorms by &#8220;erring on the side of caution&#8221;.</p>
<p>To do this we have our general purpose computing platform doing it&#8217;s thing.</p>
<p>However we control what goes in and what comes out at the interfaces.</p>
<p>And we can design an imutable system with branches to do this, provided the branches always result in the &#8220;stop&#8221; state. We can also alow it to infinatly loop provided we check it is still moving from state to state in the correct sequence.</p>
<p>However as you will point out this monitoring suffers from the &#8220;lesser fleas&#8221; problem of infinate regretion which whilst true is something that is one of those issues you can end run arround with &#8220;Stop&#8221;.</p>
<p>It is not perfect but as noted by Rob above it&#8217;s our system thus,</p>
<p>&#8216;But YOUR computer is all the attacker has. It has to fit in limited storage, with limited power. So there will ALWAYS be operations you can ask it to perform that it will not be able to complete.</p>
<p>So, just make sure you ask a lot of unpredictable &#8220;questions&#8221; using a wide range of system commands and programs. And look at many different places.&#8217;</p>
<p>Hence welcome to the world of &#8220;probablistic security&#8221; and say goodbye to the world of &#8220;determanistic security&#8221;.</p>
<p>(Hence my Monte Carlo comment).</p>
<p>But it actually gets better do you remember my comments about MTTF and MTTR?</p>
<p>Well the same applies,</p>
<p>If you put a lot of little systems in parellel thay can each do a piece of your task. The attacker however has to do his compleate task in every one of those little systems and at some point he can not do it&#8230;</p>
<p>That is you starve the attacker of resources to do what they want whilst still acomplashing what you want.</p>
<p>Now it you&#8217;ll excuse me for a while I have a hefty paper to download and read.</p>
<p>@ Brandioch Conner,</p>
<p>I hope this goes some way to explaining why a single von Neumann system will always be vulnerable but a number of limited systems in parellel with appropriate watchdog may not.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130873">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130873">
						February 23, 2010 3:03 AM					</a>

				</p>

				<p>How did this discussion take off without me? Well, I&#8217;m reading this under the positive[-feeling] influence of vodka and I&#8217;m thinking: OMG! way too much abstract stuff! It reminds me of Clive and I&#8217;s previous discussion on high assurance hard drive encryption scheme, except much less concrete and hence less productive. Let me try to tackle a little bit of these issues from a different, more concrete perspective.</p>
<p>For rootkits, we are looking at three things: prevention; detection; removal. A lot of talk here centers around detection. There are many methods, but most compare a known correct state to an incorrect state to determine all is not well. They then assume (or argue for) the existence of a malicious rootkit. I say if your at the point of requiring many detection methods and removal is a chore, you&#8217;ve already failed at the design state. So, let&#8217;s look at prevention as it relates to what people are saying.</p>
<p>@ kangaroo</p>
<p>Oh sure, we can look at things pedantically and use pure mathematical operators, but this isn&#8217;t the world of mathematics. That&#8217;s just a deterministic abstraction of a chaotic, messy reality. Some theorems say I can&#8217;t predict general purpose systems without proving all their states, but if I control the inputs I beat that entirely. Likewise, I can limited it just enough that it&#8217;s general purpose enough, but not &#8216;all&#8217; in the mathematical sense, to do useful work that can be verified formally. Formal verification has pitfalls, as Guttman demonstrated amply. However, it&#8217;s been extremely useful when its weaknesses were considered and systems were developed in a way that suits analysis. The point you may ask? F*** math and its abstract rules, theorems, etc. It&#8217;s a tool, not a concrete reality. We should use it where it&#8217;s practical and work around it otherwise. We have repeatedly in the past and we shall in the future.</p>
<p>@ Clive</p>
<p>Well, I think that von Neuman architecture is inferior but can be secure. It requires trusted boot and trust in these components: TCB hardware; firmware; bootloader; kernel-mode stuff; drivers (usually); platform support services in TCB. There are systems that demonstrate this for the most part: Honeywell&#8217;s SCOMP; GEMSOS on x86; INTEGRITY-178B on Rockwell Collins&#8217; verified AAMP7 processor. If you have a trusted boot process and correctly verify it (e.g. formally with enough granularity), then you have a clean start. If the TCB prevents rootkit infection, then rootkits are no longer an issue at kernel or OS level. This means kernel- or OS-level apps can be used to monitor for violations in user-mode and non-TCB apps. Yeah, this is the detection stuff I said is a fail, but it&#8217;s a failure in the lesser stuff. At this point, we at least have the [ineffecient] method of destroying a rogue process and restoring from clean state. Can&#8217;t do that in traditional OS&#8217;s with insecure TCB&#8217;s.</p>
<p>So, we have a clean start. What next? Well, I like the virtualization concept. We create a trustworthy emulation layer that isolates untrusted legacy OS and app code. OK Linux on OKL4 and Green Hill&#8217;s INTEGRITY Padded Cell are the best examples I&#8217;ve seen. They start with a [semi-]trustworthy platform and highly verified microkernel OS, then they run guest OS&#8217;s and apps on a virtualization layer. The virtualization layer is in user-mode, as are drivers, and both are totally subject to kernel-level security policies. This has many implications for rootkits. They are easier to detect, isolate, purge, and prevent. One thing academics haven&#8217;t explored is that this makes it easier to do the security by diversity concept. You may have several different components redundantly doing a security-critical activity, with a trusted voting component producing the final result. The strong TCB almost guarantees that the compromise of one won&#8217;t hurt the rest and the overall system is still safe.</p>
<p>Random Stuff Follows</p>
<p>The main problem with von neumann and harvard architecture is that there is no central security enforcement mechanism for even local system activity. How? &gt;&gt;&gt;DMA&lt;&lt;&lt;. This performance enhancer bypasses the CPU that holds the security kernel and defeats the reference monitor concept totally. A high performance version of PIO would be nice.</p>
<p>SecVisor is a nice little recent tool that sits in the root mode of an Intel VT-capable processor and monitors the kernel. The tool is TINY, formally verified, and currently detects/fixes changes in Linux kernel. It would be a start on producing a trustworthy kernel-level rootkit prevention/monitoring tool that itself couldn&#8217;t be subverted.</p>
<p>I think microkernels are going to be a big problem solver here. Microkernels let us analyze things in an isolated and connected way. We can build systems bottom up, easily restrict information flows to what&#8217;s necessary, and replace faulty/subverted components on the fly. QNX Neutrino already does this to a degree with its automated restart of critical kernel services to achieve high uptime. I&#8217;d like to see a similar mechanism for integrity on a high assurance microkernel like, err, INTEGRITY. High assurance microkernel plus medium assurance virtualization layer plus decent OS plus isolated security-critical code = good enough 99% of the time. Some say, &#8220;What about the other 1%?&#8221; Hell, let&#8217;s try to get the first 99%, first, then worry about a 1% market. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130874">

			<div class="comment by-brandioch-conner ">

				<p class="commentcredit">

					<span class="commenter">Brandioch Conner</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130874">
						February 23, 2010 11:56 AM					</a>

				</p>

				<p>The most amusing thing is how many people don&#8217;t have the faintest idea of what they&#8217;re talking about with regards to mathematics.</p>
<p>Mathematics can be used to model Reality. But mathematics cannot define Reality.</p>
<p>If Reality contradicts the model you have, then the model is incorrect. And no matter how much mathematical jargon you throw at it, you will not change that fact.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130875">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130875">
						February 23, 2010 12:43 PM					</a>

				</p>

				<p>@ Nick P,</p>
<p>&#8220;How did this discussion take off without me?&#8221;</p>
<p>Well it could have something to do with other more popular posts pushing it out of the 100 new comments list in less than 24H (which is why I sometimes mis replies to my comments).</p>
<p>&#8220;Well, I&#8217;m reading this under the positive[-feeling] influence of vodka and I&#8217;m thinking: OMG! way too much abstract stuff!&#8221;</p>
<p>Yup but some people will look at your post and think,</p>
<p>&#8216;OMG! way too much technical stuff!&#8217;</p>
<p>Just kidding 8)</p>
<p>Kangaroo is correct in making the point that theoreticaly a single general purpose system cannot do what we want it to do. Due as we have said to the little problems of Turing and Goedel.</p>
<p>But as I also said we humans not being constrained by such mathmatical proofs do find end runs around them.</p>
<p>And my viev point is that yes a single general purpose system is going to be vulnerable and no there is nothing we can do to stop it happening by working within that system.</p>
<p>That is we need to step outside the system and look at it&#8217;s operating signitures with another system.</p>
<p>The question then arises does this second system have to be,</p>
<p>1, General Purpose.<br />
2, Mutable in operation.<br />
3, Accessable from the first system it is monitoring.</p>
<p>And the answer to all three is definatly NO to the first two and should not for the third. Depending on your view point the second system can see the data on the first and if the second system alows it then this could effect the behaviour adversly of the second system.</p>
<p>Which then brings forth two more questions.</p>
<p>The first being is this second system still subject to the issues arising from Turing and Goedel&#8217;s little problems. And the answer is probably not.</p>
<p>The second is what effect does this have on the first system.</p>
<p>Well to answer that you would have to look at how it works.</p>
<p>In a simplistic case it would halt the first system and check every piece of mutable memory held the correct values (how you know what they are is not of relevance at the moment) and therefore the first system is still &#8220;correctly known&#8221;.</p>
<p>Thus the second system time (SST) would take a time slice out of the first system time of operation thus you could have a first system availability (FSA) calculation of,</p>
<p>FSA = FST / (FST + SST)</p>
<p>However this availability figure is granular in nature. That is say SST was 0.1% of the total over 24Hs or ~86 seconds. This begs the question what happens in the other 23Hs 58mins.</p>
<p>Thus you also need to work out a minimum window time (MWT) between the second system monitoring runs. Obviously MWT should be sufficiently small as to reduce the effectivness of any untoward activity on the first system.</p>
<p>Thus you start looking at the probability of harm on the first system. In a different way.</p>
<p>The reason being that as you cannot do a simple check as frequently as required to prevent an attack and still get usefull work done.</p>
<p>The first thing that comes to most peoples mind is to do delta type checks on the file system. That is once it&#8217;s in a known state you keep an eye on what gets changed/accessed by the first system. This leads on to the notion of operating signitures etc.</p>
<p>Thus you have moved from activly getting into the first system to looking at what it is upto.</p>
<p>Which eventualy gives rise to thinking about the relationship between the two systems and what constitutes a system.</p>
<p>In a single system view point the CPU is king of all within it&#8217;s perimiter this is the Castle mentality system. The problem with it is that it requires &#8220;trust&#8221; where trust is not possable.</p>
<p>However in a system with multiparts that you watch over you get the idea of each sub system is effectivly a prisoner in a cell.</p>
<p>From this new view point you actualy realise you don&#8217;t realy care if you trust the general purpose computers (GPC&#8217;s) or not. You just have to worry about what goes in and what comes out.</p>
<p>Thus you can have I/O  signitures for all of the programs etc.</p>
<p>You can follow this logic all the way down and partition programs to run on diferent GPC&#8217;s.</p>
<p>This get&#8217;s you into an interesting state where programs become programlets and then just functions. You effectivly script the runtime together with mainly trusted component parts and a few untrusted parts.</p>
<p>The untrusted parts run in a prison cell and have no knowledge of the rest of the system. A prison warder provides inputs and takes away outputs.</p>
<p>It is very similar to the idea of hypervisors and minimal kernals just more so.</p>
<p>Effectivly splitting a program up this way alows each part to be &#8220;known&#8221; and thus decreasing the level of trust required for it.</p>
<p>The other thing is it alows a minimum of resources to be given to each part of the program. Malware that hides needs lots of resources, if it can not get them then it can not hide&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-130876">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130876">
						February 23, 2010 4:31 PM					</a>

				</p>

				<p>@ Clive</p>
<p>Well, your coprocessor idea is interesting. Indeed, something similar was implemented for running integrity checks on main memory to identify rootkits. The problem that I see is that, if you don&#8217;t trust the TCB, then you now have two instances of the same problem. Additionally, relying on IO signatures has the same pitfall the antivirus and IDS industry currently has: the IO signatures of malware can be made indistinguishable from innocent traffic. If the communication protocol and grammer were designed to facilitate signature-based detection, then I could see it working. But they aren&#8217;t and you still have attacks on the coprocessor being feasible. I&#8217;ve yet to software like this have no flaws. It&#8217;s a combination of hardware, firmware and/or software that does pattern-recognition and interacts in a distributed system. That&#8217;s a recipe for trouble.</p>
<p>The other idea you had, of partitioning the program into pieces, is basically MILS architecture. I agree with you on that one making it easier to prevent flaws: I&#8217;ve been promoting it for months. In fact, MILS architecture is the main source of my one-processor Castle mentality. With verified trusted components, mainly processor, firmware, drivers and MILS kernel, one can prevent all kernel-mode exploits. From that point, it&#8217;s on to defending userland. One can use a combination of MILS, verified components, and a careful security policy to make for a high assurance system. Anyone who doubts that the castle mentality can work should look to XTS-400 and GEMSOS-based Blacker platforms. They are very layered, but follow the centralized castle approach for client-side security. The distributed systems that are built on them assume the clients function correctly &amp; are secure. Point being, even if we want to use your coprocessor, we still have to build it like a fortress using COTS hardware components. It might be easier than a GPU, but it has the same issues.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-130877">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/#comment-130877">
						February 24, 2010 6:40 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>&#8220;Well, your coprocessor idea is interesting. Indeed, something similar was implemented for running integrity checks on main memory to identify rootkits.&#8221;</p>
<p>That&#8217;s a small part of what the idea can do. That is once you think &#8220;I&#8217;ve got to do this, thus what other benifits do I get&#8221; you suddenly see a whole load of rather interesting ideas spring up.</p>
<p>&#8220;The problem that I see is that, if you don&#8217;t trust the TCB, then you now have two instances of the same problem.&#8221;</p>
<p>Ahh my lack of explaining. The idea is you have a TCB that is a hardware hypervisor etc. Or more traditionaly it runs the schedular and security aspects of a more traditioonal kernel. Thus the Prison Gov trusts (to a certain extent) the warders but not the prisoners in their jail cells.</p>
<p>&#8220;Additionally, relying on IO signatures has the same pitfall the antivirus and IDS industry currently has: the IO signatures of malware can be made indistinguishable from innocent traffic.&#8221;</p>
<p>Yes and no. The problem with AV is it is looking at only inbound signitures, not signatures within the system.</p>
<p>That is if you have a function that loads a file of a given size from a given location, you know fairly well what you expect to see on the IO buss in terms of sectors accessed and at what times and in which order. Anything outside of that signiture should be flagged up as suspicious.</p>
<p>Likewise you usually know how long a program takes to load and in what order various parts of it are called. Anything outside of that signiture should be flagged.</p>
<p>The problem with most programs is they are complex and have complex signitures.</p>
<p>But&#8230; those complexities are based on simple signitures. If you split the program right down into constituent functional and IO parts etc you can have a more generic signiture for each functional part.</p>
<p>Thus you are not looking at a single complex signiture that malware can easily hide in you are looking at relativly simple expected signitures that any malware would find difficult to hide behind.</p>
<p>&#8220;If the communication protocol and grammer were designed to facilitate signature-based detection, then I could see it working.&#8221;</p>
<p>That&#8217;s the whole point defeate a single almost impossible to deal with complexity by breaking it down into many well understood and well charecterised simplicities instead.</p>
<p>&#8220;But they aren&#8217;t&#8221;</p>
<p>Currently that&#8217;s the point of doing the design to see if the extra work required to implement them is worth the security gain.</p>
<p>That is make a trade, a small reduction in efficiency to gain a lot security 😉</p>
<p>&#8220;and you still have attacks on the coprocessor being feasible.&#8221;</p>
<p>Yes and no. It depends on what the co-processor does and how.</p>
<p>If it is effectivly immutable and looks only to see if a signiture is within bounds, and if not fails safe, then it is effectivly a very simple state machine that can be fully modeled. Thus all the malware can do is trigger it and cause a DoS.</p>
<p>Likewise if you are running systems in parellel to look for diffs, it is effectivly a simple vote system that goes to fail on significant differences (The NASA ok to go type system).</p>
<p>The point is to make the warder as simple as possible and go for &#8220;lock down&#8221; at the sign of any odd behaviour from code in the jail cell.</p>
<p>&#8220;I&#8217;ve yet to software like this have no flaws.&#8221;</p>
<p>Which is why you make it as simple as possible to do the job (complexity is rarely security friendly).</p>
<p>&#8220;It&#8217;s a combination of hardware, firmware and/or software that does pattern-recognition and interacts in a distributed system.&#8221;</p>
<p>Yes it is the difference being unlike the normal systems to do this you manage the complexity by fundemental design criteria.</p>
<p>Not as a bolt on after thought on systems that are not designed to support it which is currently the norm. And as you say,</p>
<p>&#8220;That&#8217;s a recipe for trouble.&#8221;</p>
<p>&#8220;The other idea you had, of partitioning the program into pieces, is basically MILS architecture.&#8221;</p>
<p>Only more so. If you use the ideas of parellel computing to break your program down into very small functional units. You can more easily quantify what is and is not acceptable functioning.</p>
<p>&#8220;I agree with you on that one making it easier to prevent flaws: I&#8217;ve been promoting it for months. In fact, MILS architecture is the main source of my one-processor Castle mentality.&#8221;</p>
<p>The trick I&#8217;m promoting is to still have your castle to the outside world, but not make the mistake of trusting the slaves that do the work, just the warders that watch over them. Specifficaly you design the system like a prison not a castle.</p>
<p>&#8220;With verified trusted components, mainly processor, firmware, drivers and MILS kernel, one can prevent all kernel-mode exploits.&#8221;</p>
<p>I&#8217;m not sure you can 99.99% yes but at some point you have to say &#8220;I need real segregation&#8221; because as you noted some hardware (DMA &amp; VM controlers in particular) can do an &#8220;end run&#8221; attack in a single processor space. It&#8217;s an efficiency security trade off that is not worth paying the price for.</p>
<p>&#8220;From that point, it&#8217;s on to defending userland.&#8221;</p>
<p>The idea of the system is it is not just kernel and userland, it&#8217;s much more structured than that</p>
<p>Look on it as,</p>
<p>1, Prison Gov<br />
2, Gov&#8217;s deputies<br />
3, Block warder<br />
4, Floor warder<br />
5, Trusties<br />
6, Prisoners</p>
<p>A traditional system would only have two levels kernel and user with a hard trust transition, which is very brittle.</p>
<p>The idea is to have compleatly untrusted but heavily controled code at the prisoner / trustie levels rising through the levels to full trust and little controle at the Gov level.</p>
<p>&#8220;One can use a combination of MILS, verified components, and a careful security policy to make for a high assurance system.&#8221;</p>
<p>Yes this is the same but more so, the idea is to also be able to use untrusted and unverified components in a controled and monitored way.</p>
<p>&#8220;Anyone who doubts that the castle mentality can work should look to XTS-400 and GEMSOS-based Blacker platforms. They are very layered, but follow the centralized castle approach for client-side security.&#8221;</p>
<p>Yes they do work but generaly not down to the point of being able to run untrusted/unverified code.</p>
<p>The big bottle neck on systems development it programer time.</p>
<p>It has been obvious for many years that the &#8220;Unix Method&#8221; of components and scripts beats the &#8220;All in one Method&#8221; of compiled code in all but two areas,</p>
<p>1, Efficiency<br />
2, Performance</p>
<p>But in a modern environment neither of these are actually that important and are becoming less so with time (think Cloud computing for instance).</p>
<p>The real problem with the Unix Method of &#8220;components and scripts&#8221; in a security environment is trust and verification.</p>
<p>On a unix system the command line tools that can be scripted are not what they once where. They have become overly complex and thus are difficult to verify and turn into trusted components.</p>
<p>The simple idea I had was to minimalise them and put them in a framework whereby they could be more effectivly controled.</p>
<p>That is the framework they run in provides the &#8220;instrumentation&#8221; by which they can be monitored effectivly. The build process actually produces two pieces of code. That that does the work, and that that builds the signature to pass on to the control side. The work part is &#8220;general purpose&#8221; and therfore insecure by definition, the signature part is not &#8220;general purpose&#8221; and can be secure by definition.</p>
<p>Likewise this duality goes on up through the script building as well.</p>
<p>Thus the &#8220;verification&#8221; process is built into the framework and the components don&#8217;t need to be.</p>
<p>This should reduce the verification bottle neck considerably as it removes the current formal verification issues.</p>
<p>&#8220;[The] Point being, even if we want to use your coprocessor, we still have to build it like a fortress using COTS hardware components.&#8221;</p>
<p>That&#8217;s the point you don&#8217;t have to have the jails built like fortresses, just solid walls and bars on the door and windows.</p>
<p>If you use say PC104 cards as the jails you can connect them across a PCI or SCSI coms bus in a way that can be effectivly controled by another PC104 card acting as the hardware supervisor.</p>
<p>Thus your jails have CPU memory and a comms bus nothing else. All the code communicates with an external comms stack (think Unix Streams as a model).</p>
<p>If you have to use DMA it&#8217;s under the control of the control framework not the jail CPU.</p>
<p>Thus you starve the jail of the resources to hide behind. Things like library code and executanble code is made read only to the jail CPU and thus immutable to it call stacks etc are protected, passed values are not passed in CPU registers only on the stack. And the CPU can be halted and release it&#8217;s bus so that the memory can be checked (via DMA) etc.</p>
<p>The idea is that if you accept that no &#8220;general purpose&#8221; code can be secure you find ways using to make secure (state machines) parts that supervise.</p>
<p>At the end of the day other than resource usage it does not matter if malware runs on your system, IFF there is nothing it can do to communicate data out of the jail. Likewise malware will get removed each time the jail is &#8220;reloaded&#8221; with a new function and that can be done quickly and easily by DMA.</p>
<p>It is not actually that much less efficient than other semi-secure systems, but is one heck of a sight more secure.</p>
<p>It also scores highly on availability as well as on reliability (as you would expect).</p>
<p>However it does not work with standard off of the shelf code. It is much like any other parrellel processing cluster just with a security framework.</p>
<p>So from that point of view it is not currently that usable for end users nor those that want to use off the shelf closed source code.</p>
<p>But as a test bed for the way to go it is most definatly interesting especialy as cloud computing to be effective is going to have to be done in a massively parrellel form&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2010/02/botnets_attacki.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2010/02/botnets_attacki.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F02%2Fbotnets_attacki.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2010/02/botnets_attacki.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='3258' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2010/02/detecting_cheat.html" rel="prev">← Detecting Cheating by Analyzing Erased Answers</a>		<a href="https://www.schneier.com/blog/archives/2010/02/bruce_schneier_4.html" rel="next">Bruce Schneier Facebook Page →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
