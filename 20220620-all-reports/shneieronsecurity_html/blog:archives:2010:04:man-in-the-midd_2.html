<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Man-in-the-Middle Attacks Against SSL - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Man-in-the-Middle Attacks Against SSL Comments Feed" href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/3348" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=3348' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F04%2Fman-in-the-midd_2.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F04%2Fman-in-the-midd_2.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-3348 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-3348" class="post-3348 post type-post status-publish format-standard hentry category-uncategorized tag-academic-papers tag-certificates tag-cryptography tag-man-in-the-middle-attacks tag-privacy tag-ssl tag-surveillance">

	<div class="article">

		<h2 class="entry">Man-in-the-Middle Attacks Against SSL</h2>
		<p><a href="http://www.crypto.com/blog/spycerts/">Says</a> Matt Blaze:</p>
<blockquote><p>A decade ago, I observed that commercial certificate authorities protect you from anyone from whom they are unwilling to take money. That turns out to be wrong; they don&#8217;t even do that much.</p></blockquote>
<p>Scary <a href="http://files.cloudprivacy.net/ssl-mitm.pdf">research</a> by Christopher Soghoian and Sid Stamm:</p>
<blockquote><p><b>Abstract:</b>  This paper introduces a new attack, the <em>compelled certificate creation attack</em>, in which government agencies compel a certificate authority to issue false SSL certificates that are then used by intelligence agencies to covertly intercept and hijack individuals&#8217; secure Web-based communications. We reveal alarming evidence that suggests that this attack is in active use. Finally, we introduce a lightweight browser add-on that detects and thwarts such attacks.</p></blockquote>
<p>Even more scary, Soghoian and Stamm found that hardware to perform this attack is being <a href="http://www.wired.com/threatlevel/2010/03/packet-forensics/">produced and sold</a>:</p>
<blockquote><p>At a recent wiretapping convention, however, security researcher Chris Soghoian discovered that a small company was marketing internet spying boxes to the feds. The boxes were designed to intercept those communications &#8212; without breaking the encryption &#8212; by using forged security certificates, instead of the real ones that websites use to verify secure connections. To use the appliance, the government would need to acquire a forged certificate from any one of more than 100 trusted Certificate Authorities.</p>
<p>[&#8230;]</p>
<p>The company in question is known as Packet Forensics&#8230;.  According to the flyer: &#8220;Users have the ability to import a copy of any legitimate key they obtain (potentially by court order) or they can generate &#8216;look-alike&#8217; keys designed to give the subject a false sense of confidence in its authenticity.&#8221; The product is recommended to government investigators, saying &#8220;IP communication dictates the need to examine encrypted traffic at will.&#8221; And, &#8220;Your investigative staff will collect its best evidence while users are lulled into a false sense of security afforded by web, e-mail or VOIP encryption.&#8221;</p></blockquote>
<p>Matt Blaze has the <a href="http://www.crypto.com/blog/spycerts/">best analysis</a>.  Read his whole commentary; this is just the ending:</p>
<blockquote><p>It&#8217;s worth pointing out that, from the perspective of a law enforcement or intelligence agency, this sort of surveillance is far from ideal. A central requirement for most government wiretapping (mandated, for example, in the CALEA standards for telephone interception) is that surveillance be undetectable. But issuing a bogus web certificate carries with it the risk of detection by the target, either in real-time or after the fact, especially if it&#8217;s for a web site already visited. Although current browsers don&#8217;t ordinarily detect unusual or suspiciously changed certificates, there&#8217;s no fundamental reason they couldn&#8217;t (and the Soghoian/Stamm paper proposes a Firefox plugin to do just that). In any case, there&#8217;s no reliable way for the wiretapper to know in advance whether the target will be alerted by a browser that scrutinizes new certificates.</p>
<p>Also, it&#8217;s not clear how web interception would be particularly useful for many of the most common law enforcement investigative scenarios. If a suspect is buying books or making hotel reservations online, it&#8217;s usually a simple (and legally relatively uncomplicated) matter to just ask the vendor about the transaction, no wiretapping required. This suggests that these products may be aimed less at law enforcement than at national intelligence agencies, who might be reluctant (or unable) to obtain overt cooperation from web site operators (who may be located abroad).</p></blockquote>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/academic-papers/" rel="tag">academic papers</a>, <a href="https://www.schneier.com/tag/certificates/" rel="tag">certificates</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/man-in-the-middle-attacks/" rel="tag">man-in-the-middle attacks</a>, <a href="https://www.schneier.com/tag/privacy/" rel="tag">privacy</a>, <a href="https://www.schneier.com/tag/ssl/" rel="tag">SSL</a>, <a href="https://www.schneier.com/tag/surveillance/" rel="tag">surveillance</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html" rel="bookmark">Posted on April 12, 2010 at 1:32 PM</a>			•
			<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html#comments">76 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html" data-title="Man-in-the-Middle Attacks Against SSL" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-135327">

			<div class="comment by-jl ">

				<p class="commentcredit">

					<span class="commenter">jl</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135327">
						April 12, 2010 2:03 PM					</a>

				</p>

				<p>So if forged certificates are easy to detect, the won&#8217;t it be quite easy to (rightfully) trash the reputation of any &#8220;trusted&#8221; certificate authority if they got in bed with national intelligence agencies?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135328">

			<div class="comment by-jonathan-lundell ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://pragmatos.net' rel='external nofollow ugc' class='url'>Jonathan Lundell</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135328">
						April 12, 2010 2:24 PM					</a>

				</p>

				<p>It&#8217;s hard to see how this would be limited to law enforcement agencies. Selling copies of the coerced certificates sounds like a lucrative proposition for some underpaid tech in country Abc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135329">

			<div class="comment by-lazlo ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://dynamicequilibria.blogspot.com' rel='external nofollow ugc' class='url'>lazlo</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135329">
						April 12, 2010 2:30 PM					</a>

				</p>

				<p>One particularly insidious bit of this is that all it takes is for <em>one</em> of the &#8220;universally trusted&#8221; ca&#8217;s to violate that trust for it to work against any service.  Some among the more paranoid (and technically inclined) I know have actually looked at the list of ca&#8217;s that their browser trusts by default.  I don&#8217;t know of anyone who has actually deleted anything from that list.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135330">

			<div class="comment by-just-a-bulgarian ">

				<p class="commentcredit">

					<span class="commenter">Just a Bulgarian</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135330">
						April 12, 2010 2:35 PM					</a>

				</p>

				<p>Hmmm, we have one of our (approved by the state) CAs&#8217; root certs in IE&#8217;s trusted CA store. It is a private company. Since Bulgaria is probably the most corrupt country in the EU, that sounds somehow scary 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135331">

			<div class="comment by-francis-litterio ">

				<p class="commentcredit">

					<span class="commenter">Francis Litterio</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135331">
						April 12, 2010 2:39 PM					</a>

				</p>

				<p>The Firefox add-on &#8220;Certificate Patrol&#8221; will notify you if the previous certificate obtained from a site differs from the current certificate (and it will show you the two certs): <a href="https://addons.mozilla.org/en-US/firefox/addon/6415" rel="nofollow ugc">https://addons.mozilla.org/en-US/firefox/addon/6415</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135332">

			<div class="comment by-brian ">

				<p class="commentcredit">

					<span class="commenter">Brian</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135332">
						April 12, 2010 2:48 PM					</a>

				</p>

				<p>When I first heard about this, I dug into my certificate store and started changing certs to &#8220;Always ask&#8221;. Its hardly ideal, but its an acceptable interim solution for me.</p>
<p>The real question is, how do you mitigate this type of attack if you have never been to the site before?</p>
<p>Companies could theoretically add this to their firewalls without digging into the connection (by simply checking the servers returned cert every time and caching it for the clients).</p>
<p>Scary in any case.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135333">

			<div class="comment by-brandioch-conner ">

				<p class="commentcredit">

					<span class="commenter">Brandioch Conner</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135333">
						April 12, 2010 2:50 PM					</a>

				</p>

				<p>There&#8217;s something that doesn&#8217;t read right there.</p>
<p>&#8220;This paper introduces a new attack, the compelled certificate creation attack, in which government agencies compel a certificate authority to issue false SSL certificates that are then used by intelligence agencies to covertly intercept and hijack individuals&#8217; secure Web-based communications.&#8221;</p>
<p>So it is:<br />
a certificate<br />
issued by a legitimate CA.</p>
<p>But then &#8230;</p>
<p>&#8220;The boxes were designed to intercept those communications &#8212; without breaking the encryption &#8212; by using forged security certificates, instead of the real ones that websites use to verify secure connections.&#8221;</p>
<p>How so &#8220;forged&#8221; instead of &#8220;real&#8221;?</p>
<p>Or are we talking about a certificate for<br />
<a href="http://www.bank0famer1ca.com?" rel="nofollow ugc">http://www.bank0famer1ca.com?</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135334">

			<div class="comment by-francis-litterio ">

				<p class="commentcredit">

					<span class="commenter">Francis Litterio</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135334">
						April 12, 2010 3:00 PM					</a>

				</p>

				<p>Companies such as Blue Coat sell tools that other companies can install in their routing infrastructure that intercept (MITM-style) outbound SSL connections, substituting a self-signed cert for the cert received from the remote site (though it includes the public key of the remote site). This requires the company to install the Blue Coat CA cert into employees&#8217; browsers, but IT typically has the access levels needed to do that (IE lets the domain administrator do it remotely).</p>
<p>To quote from a Blue Coat whitepaper: &#8220;Blue Coat can selectively allow some users to use Skype and disallow others by locking down ports and then allowing only legitimate SSL traffc on port 443. Blue Coat&#8217;s ability to proxy HTTPS makes this very secure approach possible.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135335">

			<div class="comment by-john-f ">

				<p class="commentcredit">

					<span class="commenter">John F</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135335">
						April 12, 2010 3:11 PM					</a>

				</p>

				<p>Brandioch,</p>
<p>The appliance generates a signing certificate, which is signed by a real CA.</p>
<p>After the, the appliances generates (forges) per-site certs on the fly and signs them with the (signed) signing cert above.</p>
<p>Because the appliance&#8217;s signing cert has been signed by a trusted CA, the browser sees a valid certification path (trusted root -&gt; signed signing cert -&gt; signed host cert).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135336">

			<div class="comment by-steve-schultze ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://managingmiracles.blogspot.com' rel='external nofollow ugc' class='url'>Steve Schultze</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135336">
						April 12, 2010 3:11 PM					</a>

				</p>

				<p>I&#8217;d encourage folks reading this blog to contribute to the mozilla.dev.security.policy group, which has been discussing many of these issues lately.  We need more help reviewing root CA applications:</p>
<p><a href="http://groups.google.com/group/mozilla.dev.security.policy/topics" rel="nofollow ugc">http://groups.google.com/group/mozilla.dev.security.policy/topics</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135337">

			<div class="comment by-tim ">

				<p class="commentcredit">

					<span class="commenter">Tim</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135337">
						April 12, 2010 3:14 PM					</a>

				</p>

				<p>Brandioch: They&#8217;re real certificates, but &#8216;forged&#8217; in the sense that they aren&#8217;t the same ones used by the actual bankofamerica.com.</p>
<p>Bring on DNSSEC!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135338">

			<div class="comment by-steve-schultze ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://managingmiracles.blogspot.com' rel='external nofollow ugc' class='url'>Steve Schultze</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135338">
						April 12, 2010 3:14 PM					</a>

				</p>

				<p>@lazlo: and even if you do delete one of the root CA&#8217;s (actually, you have to change the trust bits because in Mozilla at least deleting doesn&#8217;t really  make it go away), that entity can always get a secret subordinate CA under another one of the many other root CAs&#8230; which your browser will silently trust.</p>
<p>More here:<br />
<a href="http://groups.google.com/group/mozilla.dev.security.policy/browse_thread/thread/9782ec0b32460edc" rel="nofollow ugc">http://groups.google.com/group/mozilla.dev.security.policy/browse_thread/thread/9782ec0b32460edc</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135339">

			<div class="comment by-kevinm ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.eriugena.org/blog/' rel='external nofollow ugc' class='url'>kevinm</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135339">
						April 12, 2010 4:47 PM					</a>

				</p>

				<p>That is why we have our own PKI and do not trust external CAs. Our monitoring checks our web servers once a month to be aware of when the certs expire using this method: <a href="http://www.eriugena.org/blog/?p=50" rel="nofollow ugc">http://www.eriugena.org/blog/?p=50</a><br />
Perhaps I should ask them to check some external servers more often and also control that the serial numbers of the certs do not change.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135340">

			<div class="comment by-check-title ">

				<p class="commentcredit">

					<span class="commenter">Check Title</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135340">
						April 12, 2010 4:53 PM					</a>

				</p>

				<p>&#8220;Againt&#8221;?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135341">

			<div class="comment by-security-novice ">

				<p class="commentcredit">

					<span class="commenter">Security Novice</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135341">
						April 12, 2010 4:57 PM					</a>

				</p>

				<p>Don&#8217;t know about that Security Patrol Add-on for Mozilla&#8211;the date arithmetic is odd (cert issue dates of 101/11/2010 that expire in NaN days).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135342">

			<div class="comment by-larry-seltzer ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://blogs.pcmag.com/securitywatch/' rel='external nofollow ugc' class='url'>larry seltzer</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135342">
						April 12, 2010 5:01 PM					</a>

				</p>

				<p>I really don&#8217;t get why people are worked up about this. Obviously if the trusted CA can&#8217;t be trusted then there&#8217;s a trust issue. Isn&#8217;t this inherent in the system?</p>
<p>Another part of the article just deals with automation of techniques described last year by Moxie Marlinspike at BlackHat. These techniques all involved some ancillary weakness in the system, such as an ARP-poisoned router.</p>
<p>With respect to the state coercion, the use of terms like &#8220;forged&#8221; certificates is incorrect. What&#8217;s happening is that the CA is betraying the trust relationship with the customer by sharing private keys. The authors say flat-out that it&#8217;s questionable whether this would be legal in the US. If it&#8217;s legal for a (for example) Chinese government order to a Chinese CA, well who&#8217;s surprised at that?</p>
<p>So the only issue I&#8217;m left wondering about is how the important vendors, like Microsoft and Mozilla, determine who gets into which list of trusted root certificates. But even this was just as legitimate a question before.</p>
<p>There&#8217;s no news here at all.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135343">

			<div class="comment by-james ">

				<p class="commentcredit">

					<span class="commenter">James</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135343">
						April 12, 2010 5:28 PM					</a>

				</p>

				<p>I don&#8217;t believe the scenario put by the authors. The chinese dissident already established a chain of trust with the other people, she got instructions from them. Why go around this trust to the CAs? That is, why not use some other method which depends on keys that cannot be forged by others such as real encryption? Seems to me this scenario is useless since the trust has been established. Even more, if she met with the actual people then she should use some symmetric encryption with a key she was given.</p>
<p>The real scenario would be what it is now, you go to a website that you&#8217;ve never been and you try and trust them, or contact with a website where you have to go through the CA to authenticate and communicate. That&#8217;s hard (unless your bank has some real security where they&#8217;ve generated private keys and such and no one else outside the organization can know ).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135344">

			<div class="comment by-peter ">

				<p class="commentcredit">

					<span class="commenter">Peter</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135344">
						April 12, 2010 5:33 PM					</a>

				</p>

				<p>How much collaboration do they need from the CAs?<br />
I don&#8217;t know exactly how things work, but I bet some intelligence agency could get the information to sign their own CAs anytime they want to or become one themselves.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135345">

			<div class="comment by-daniel ">

				<p class="commentcredit">

					<span class="commenter">Daniel</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135345">
						April 12, 2010 5:46 PM					</a>

				</p>

				<p>Larry. That&#8217;s correct. I don&#8217;t understand why this is &#8220;scary&#8221; unless one accepts that the current environment is scary.</p>
<p>I posted a comment on the Financial Security blog a week or so ago noting that the idea of &#8220;trust but verify&#8221; is an oxymoron. Either you trust or you don&#8217;t; it&#8217;s a binary proposition.</p>
<p>Tim, could you explain how DNSSEC is going to stop this type of thing. IIRC it&#8217;s coming to USA root in a few months but I&#8217;m have the sort of vague impression it&#8217;s window dressing. After all, isn&#8217;t a trust anchor just as easily violated as a certificate?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135346">

			<div class="comment by-chris-hills ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.cs.cmu.edu/~perspectives/firefox.html' rel='external nofollow ugc' class='url'>Chris Hills</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135346">
						April 12, 2010 6:09 PM					</a>

				</p>

				<p>If you are worried about this attack I highly recommend the Perspectives extension for Firefox. It checks the certificate presented against a database filled by sensors distributed through the internet. If the certificate does not match you are warned.</p>
<p><a href="http://www.cs.cmu.edu/~perspectives/firefox.html" rel="nofollow ugc">http://www.cs.cmu.edu/~perspectives/firefox.html</a></p>
<p>Personally I do not believe in the current hierarchical trust model since it is easy to so easy to obtain &#8220;trusted&#8221; certificates. I would sooner trust those certificates that I can verify directly with the site operator out of band.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135347">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135347">
						April 12, 2010 6:12 PM					</a>

				</p>

				<p>Daniel,</p>
<p>DNSSEC enables implementation of an SSL-like strategy (e.g. putting self-signed certs in the DNS where they can be authenticated by DNSSEC extensions) that doesn&#8217;t involve CAs. While DNSSEC keys might be compromised and used to sign forged certificates in the DNS, these forged certificates are naturally constrained to the hierarchy of the DNS beneath the compromised set of keys. This is in contrast to CA-based signature, where any public CA can sign a cert for any domain, and therefore anyone with either an intermediate CA cert from a public CA or simply a parallel &#8220;compelled&#8221; certificate (as in the Soghoian paper), and anyone who has acquired the private key for any public CA&#8217;s CA or intermediate CA certificate, can generate new certs that are valid for <em>any</em> domain. This has always been broken in SSL&#8211;there&#8217;s no existing mechanism for constraining the scope of a CA certificate (root or intermediate) to a subzone of the DNS.</p>
<p>If I understand the scenario described here correctly, an analogous scenario might be the DNS root maintainers&#8217; signing an additional, government-provided, KSK for, say, .com, and including that KSK in the DNS. The eavesdropper with the private part of that KSK could then construct a parallel DNSSEC chain to validate a cert for <a href="http://www.example.com" rel="nofollow ugc">http://www.example.com</a>, though I believe this attack would be much more difficult if it is in fact possible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135348">

			<div class="comment by-david-schwartz ">

				<p class="commentcredit">

					<span class="commenter">David Schwartz</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135348">
						April 12, 2010 7:26 PM					</a>

				</p>

				<p>A certificate is kind of like a passport. My passport vouches that the guy in the picture has my name, my birth date, my citizenship, and so on. My certificate vouches that the legitimate owner of the common name in the certificate generated the key in the certificate.</p>
<p>These certificates are &#8220;forged&#8221; in the sense that they make a false claim but are real in the sense that they were issued by a real authority. It&#8217;s as if the US government issued a passport with your name, birthdate, and citizenship but my picture.</p>
<p>I could then use this passport to convince people that I was you.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135349">

			<div class="comment by-david-schwartz ">

				<p class="commentcredit">

					<span class="commenter">David Schwartz</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135349">
						April 12, 2010 7:30 PM					</a>

				</p>

				<p>To respond to Chris Hills, I strongly recommend <em>against</em> the perspectives extension. This extension can hide browser warnings if the certificate is &#8220;known valid&#8221;, but I can find no documentation of their policies. You would have to completely trust their network of notaries.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135350">

			<div class="comment by-tom-t ">

				<p class="commentcredit">

					<span class="commenter">Tom T.</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135350">
						April 12, 2010 8:40 PM					</a>

				</p>

				<p>@ Steve Schultze and Anyone Else Who Knows:</p>
<p>&#8220;@lazlo: and even if you do delete one of the root CA&#8217;s (actually, you have to change the trust bits because in Mozilla at least deleting doesn&#8217;t really make it go away), that entity can always get a secret subordinate CA under another one of the many other root CAs&#8230; which your browser will silently trust&#8230;&#8221;</p>
<p>After reading of this issue in Steve Gibson&#8217;s podcast of April 8, 2010, <a href="http://www.grc.com/sn/sn-243.txt" rel="nofollow ugc">http://www.grc.com/sn/sn-243.txt</a> , I started deleting CAs from my browser, and found exactly as reported: They reappeared. Mozilla Help says you can delete them, but doesn&#8217;t address the they-come-back issue. You mentioned &#8220;changing the bits&#8221;. Please be more specific: what bits must be changed, where, through what path and interface, etc?</p>
<p>If possible, please include instructions for both Fx 2.x and 3.x.  Thanks in advance to you or to anyone else who can post this information.</p>
<p>(&#8230; and now I&#8217;m wondering why Mozilla makes them so persistent and undeletable&#8230;)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135351">

			<div class="comment by-tom-t ">

				<p class="commentcredit">

					<span class="commenter">Tom T.</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135351">
						April 12, 2010 9:25 PM					</a>

				</p>

				<p>@ Security Novice: The &#8220;101&#8221; seems to be ordinal date, often referred to as Julian date. I. e., &#8220;101&#8221; is the 101st day of the year, or, for any non-leap-year, April 11.</p>
<p>Haven&#8217;t figured out the &#8220;NaN&#8221; part yet. Might be a glitch in the sw.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135352">

			<div class="comment by-chris-jester-young ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://stackoverflow.com/users/13' rel='external nofollow ugc' class='url'>Chris Jester-Young</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135352">
						April 12, 2010 10:59 PM					</a>

				</p>

				<p>In some cases, even a compelled certificate creation attack is unnecessary: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=476766" rel="nofollow ugc">https://bugzilla.mozilla.org/show_bug.cgi?id=476766</a> 😛</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135353">

			<div class="comment by-caticat ">

				<p class="commentcredit">

					<span class="commenter">caticat</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135353">
						April 13, 2010 12:15 AM					</a>

				</p>

				<p>its even worse if you donot know who owns the root certificate!</p>
<p><a href="http://www.theregister.co.uk/2010/04/06/mysterious_mozilla_apple_certificate/" rel="nofollow ugc">http://www.theregister.co.uk/2010/04/06/mysterious_mozilla_apple_certificate/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135354">

			<div class="comment by-andrew-philips ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.sweetsoftware.com' rel='external nofollow ugc' class='url'>Andrew Philips</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135354">
						April 13, 2010 2:06 AM					</a>

				</p>

				<p>The SSL standard could be tweaked to stop most MITM attacks &#8211; at least those that wish to hijack session creation with a user previously known to the server and trying to create a new secure logon session.  The problem is that the client-server connection is protected by server-cert, only, while the password (hash) for the logon protocol is sent through the encrypted data channel, but is not used to create the encrypted channel.</p>
<p>Authentication should result in a Key used to protect the channel.  By separating server authentication (browser proving the cert is good) from client authentication (user proving she knows the password), we&#8217;ve left the user open to this attack.</p>
<p><em>IF</em> the connection establishment protocol were modified to mix the user&#8217;s password at the connection layer, a MITM attack would be hard &#8212; the owner of the &#8220;forged&#8221; cert would not have the user&#8217;s password/verifier to answer the client properly and the client/browser would detect this as a failure to establish a secure session.</p>
<p>The DH-EKE patent has expired, it should be rolled into the SSL standard.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135355">

			<div class="comment by-eirik-m ">

				<p class="commentcredit">

					<span class="commenter">Eirik M</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135355">
						April 13, 2010 2:57 AM					</a>

				</p>

				<p>See: <a href="http://matthias.vallentin.net/2010/03/should-you-trust-your-ssl-certificate.html" rel="nofollow ugc">http://matthias.vallentin.net/2010/03/should-you-trust-your-ssl-certificate.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135356">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135356">
						April 13, 2010 3:53 AM					</a>

				</p>

				<p>This SSL issue is but a small part of a number of larger issues.</p>
<p>For some reason as humans when we come up against an issue of &#8220;how do we verify an entity&#8221; we adopt a &#8220;bureaucratic hierarchical trust model&#8221; as oposed to a &#8220;social associative trust model&#8221;.</p>
<p>Which is odd, as humans generaly use associative models in our every day lives even in the work place. And the likes of banks etc used to untill very recent times in the form of &#8220;references&#8221;, and many employers still &#8220;take them up&#8221; before offering employment.</p>
<p>It is even odder when you consider that we know all hierarchical systems have significant &#8220;upstream&#8221; issues, yet we continue to abdicate responsability to them.</p>
<p>And I suspect it is this &#8220;abdication of responsability&#8221; which is the core issue not just in the use of systems but in the very design of them.</p>
<p>Perhaps it is time we considered &#8220;stop using CA&#8217;s&#8221; and started looking for an alternative. Say using self signed certs and establishing multiple points of signed references, that form intermeshed chains or a web of trust.</p>
<p>However we know from social systems that &#8220;webs of trust&#8221; have their own issues to do with our inherant &#8220;wanting to trust others around us&#8221;.</p>
<p>Which again brings us back to the issue of abdicating responsability.</p>
<p>From a legal perspective it is better as an entity to have a single line of trust thus if it should go wrong you only have one other party to blaim to try to get damages. The logic of which boils down to &#8220;never trust your friends&#8221;&#8230;</p>
<p>Time to mutter &#8220;pros and cons, pros and cons&#8221; and scratch the old wooden block 😉</p>
<p>Then there another &#8220;elephant in the room&#8221; issue to do with trust and all our online communications, over and above issues of certificates.</p>
<p>It also is a heirachical issue of trust and it is you have only one &#8220;up stream&#8221; point of reference through which everything goes.</p>
<p>This is again something quite alien to humans, as social creatures we so routienly use multiple points of contact to establish multiple viewpoints or channels I&#8217;m surprised we blythly accept a &#8220;key hole&#8221; access to the information world, we don&#8217;t in almost any other area of human endevor.</p>
<p>This is because we know from (bitter) experiance that dictators and other tyrants we fear, as a first step generally try to sieze controll of all information sources. This is so there is effectivly only one &#8220;view point&#8221; being impressed upon the &#8220;people&#8221;.</p>
<p>For our own piece of mind we should take responsability for establishing multiple channels of information and also establishing multiple associative views when trying to establish the identitiy and reliability of an online entity.</p>
<p>However this in it&#8217;s self has issues as has been seen with the likes of Google and Social Network sites &#8220;slurping up&#8221; Personal Information and making it available to others&#8230;</p>
<p>Sometimes our &#8220;need to participate&#8221; over rides any caution we might otherwise have especialy if those we know are doing it&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135357">

			<div class="comment by-roman ">

				<p class="commentcredit">

					<span class="commenter">Roman</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135357">
						April 13, 2010 5:42 AM					</a>

				</p>

				<p>Another (existing) firefox-plugin is &#8220;Perspectives&#8221; from some folks at CMU:</p>
<p><a href="http://www.cs.cmu.edu/~perspectives/" rel="nofollow ugc">http://www.cs.cmu.edu/~perspectives/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135358">

			<div class="comment by-mark-r ">

				<p class="commentcredit">

					<span class="commenter">Mark R</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135358">
						April 13, 2010 7:50 AM					</a>

				</p>

				<p>The approach of alerting the user when the cert changes don&#8217;t really solve the problem.  When you are alerted that the cert has changed, you&#8217;re basically back in the same situation you were in the first time you visited the site &#8211; you have to decide whether or not to trust a cert you&#8217;ve never seen before.  Sure, you could &#8220;crowd source&#8221; the problem and check whether others are seeing the same new cert, but if it&#8217;s government actors we&#8217;re talking about, that might not help, either.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135359">

			<div class="comment by-algol ">

				<p class="commentcredit">

					<span class="commenter">Algol</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135359">
						April 13, 2010 8:03 AM					</a>

				</p>

				<p>Certainly a scary scenario. However, I think more about the current state of affairs when end-users have to make the decisions. Most of them struggle telling apart good certificates from bad ones. Now we have to add another kind of forgery, which to them will look just like the real thing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135360">

			<div class="comment by-enterprise-mitm ">

				<p class="commentcredit">

					<span class="commenter">enterprise MITM</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135360">
						April 13, 2010 8:45 AM					</a>

				</p>

				<p>It is even simpler in a corporate enviroment where &#8220;trusted&#8221; root certificates can be installed by domain administrator on the fly.</p>
<p>For a MITM the administrator has to set up simply an intercepting proxy which exchange the original server side certificate with a forged certificate signed with the corporate root certificate.</p>
<p>Very few users will actually check the certificate tree as long as the browser will show a green padlock icon.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135361">

			<div class="comment by-asgeir-s-nilsen ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://blog.asgeirnilsen.com' rel='external nofollow ugc' class='url'>Asgeir S. Nilsen</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135361">
						April 13, 2010 8:46 AM					</a>

				</p>

				<p>This reinforces my impression that the TLS trust model using certificates from an ultimately trusted unknown is broken.</p>
<p>The two issues certificates try to solve: remote host authenticity and session key exchange, should be separated.</p>
<p>The former is best handed to DNS, with extensions like DNSSEC.</p>
<p>The latter could be either solved by reversing the initial key exchange, having the browser generate a key pair and present to the server, or by using pre-shared secrets already supported by TLS.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135362">

			<div class="comment by-francis-litterio ">

				<p class="commentcredit">

					<span class="commenter">Francis Litterio</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135362">
						April 13, 2010 9:27 AM					</a>

				</p>

				<p>@Asgeir: Separating the authenticity check from the key exchange won&#8217;t help. The key exchange is vulnerable to a MITM attack precisely <em>because</em> the certificate tells us the party at the other end of the connection is who we think they are. The weak link is the authentication, not the key exchange. If the authentication can be subverted, no key exchange algorithm can detect a MITM attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135363">

			<div class="comment by-vv ">

				<p class="commentcredit">

					<span class="commenter">VV</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135363">
						April 13, 2010 10:15 AM					</a>

				</p>

				<p>@antibozo: Isn&#8217;t DNSSEC itself vulnerable to MITM attack?<br />
As far as I understand, root authority&#8217;s key is obtained via a non-authenticated request, so a MITM could forge the whole authentication chain.</p>
<p>@Peter: It seems, even collaboration form CAs is not strictly necessary. There&#8217;re insecure CA certificates out there, that could probably be used to create a fake intermediate CA.<br />
For instance, when MD5 collision was demonstrated, Verisign stopped issuing MD5 certificates but didn&#8217;t revoke existing ones. And in the &#8220;standard&#8221; set of trusted CAs there is Verisign root certificate with MD2 signature (and valid until 2028).<br />
I wonder if some time in the future MD2 support will be dropped completely, and MD2 certificates will get &#8220;trusted by default&#8221;&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135364">

			<div class="comment by-andrew-philips ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.sweetsoftware.com' rel='external nofollow ugc' class='url'>Andrew Philips</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135364">
						April 13, 2010 11:08 AM					</a>

				</p>

				<p>One other twist: I recall several years ago when RSA revoked the Chaos Computer Club&#8217;s certificate.  The German hacking organization had acquired one and was using it to sign malicious applets.  At the time, I questioned RSA&#8217;s move.  So what if they produce malicious code &#8212; don&#8217;t accept certificates from people you don&#8217;t trust!  It effectively put RSA into the position of policeman of the certificate owners.  But, that&#8217;s not what a CA does!  It&#8217;s purpose is to create a system that securely identifies the holder of the cert.  It&#8217;s immaterial whether that individual is a saint or a sinner.</p>
<p>Most people want magic security pixie dust sprinkled on the computer, they don&#8217;t care whether it works.</p>
<p>@Clive: well said.  However, it&#8217;s not surprising that we defer to the hierarchical model.  Pre-agrariarn hunter/gatherer tribes work well up until around 150 people, then they split.  The rise of civilization with farming required a new, different (and hierarchical) model pasted onto the older model.  We modern humans respond to this precisely so we can enjoy the benefits of our culture.  We give up &#8220;knowing&#8221; the truth about our leaders for improved quality of life.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135365">

			<div class="comment by-not-anonymous ">

				<p class="commentcredit">

					<span class="commenter">Not anonymous</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135365">
						April 13, 2010 11:16 AM					</a>

				</p>

				<p>If we didn&#8217;t use a hierarchical model we could have certificate changes by signing new certificates with the old ones. If you regularly visited the same site you would see the change while the first certificate was still valid and that would give you good confidence that the new certificate was bonafide.</p>
<p>@lazlo</p>
<p>I delete all of the root certificates in my browser. So there is at least one person doing that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135366">

			<div class="comment by-kangaroo ">

				<p class="commentcredit">

					<span class="commenter">kangaroo</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135366">
						April 13, 2010 12:45 PM					</a>

				</p>

				<p>@Clive: Which is odd, as humans generaly use associative models in our every day lives even in the work place.</p>
<p>It&#8217;s not odd. You&#8217;re just misgeneralizing. &#8220;Humans&#8221; use associative, non-hierarchical  models. Bureaucracies use centralized models, despite their deficiencies, precisely because they are centralized.</p>
<p>GPG keys are quite usable and quite natural. Why isn&#8217;t that model used? Because organizations love the central approach where they control the keys, can charge for them, etc, so they build infrastructure preferring them. That&#8217;s not &#8220;human&#8221; &#8212; that&#8217;s a particular political model.</p>
<p>So &#8220;humans&#8221; end up using the centralized approach not because it&#8217;s natural &#8212; but because it&#8217;s been engineered into the systems they use. You can choose gpg, say, but it shrinks your pool of partners merely because most software makes it painful &#8212; the big corps don&#8217;t put it into their email and such programs.</p>
<p>Andrew: We modern humans respond to this precisely so we can enjoy the benefits of our culture.</p>
<p>We never &#8220;chose&#8221; this system. If you look at the rise of agriculture &amp; the city state, at every point along the way our &#8220;quality of life&#8221; went down &#8212; in health, longevity, freedom, variety of work&#8230; It&#8217;s just that 1000 starving farmers can kick the crap out of 100 healthy nomads, particularly when the former can develop more advanced technologies. Then you have the effect of propaganda &#8212; everybody hears how exciting and cool the city is, the young people head out there, and then they end up impoverished, and unhealthy. But it&#8217;s exciting &#8212; at least until their lives are chewed up. We&#8217;re not very good at comparing long vs. short term benefits.</p>
<p>Even today, &#8220;most&#8221; human beings lead shorter and more brutal lives than our ancestors 15kya, since most human beings aren&#8217;t Americans, Europeans or the upper crust of the rest of the world.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135368">

			<div class="comment by-francis-litterio ">

				<p class="commentcredit">

					<span class="commenter">Francis Litterio</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135368">
						April 13, 2010 12:57 PM					</a>

				</p>

				<p>@Tom: See this page for instructions on how to mark a CA cert (such as the one from CNNIC in China) as untrusted in Firefox:</p>
<p><a href="http://www.imminentweb.com/technologies/screenshot-remove-cnnic-firefox-and-thunderbird" rel="nofollow ugc">http://www.imminentweb.com/technologies/screenshot-remove-cnnic-firefox-and-thunderbird</a></p>
<p>Removing it completely is not advised, since it will come back when FF is upgraded.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135369">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135369">
						April 13, 2010 1:02 PM					</a>

				</p>

				<p>VV&gt; As far as I understand, root authority&#8217;s key is obtained via a non-authenticated request, so a MITM could forge the whole authentication chain.</p>
<p>No, ultimately the root key is preconfigured into DNS clients and recursive servers.</p>
<p>There is an interim period until the root is signed, during which trust anchors for various points in the DNS are similarly preconfigured. Once the root is signed, these can be eliminated, though I&#8217;m not sure what happens if, say, the root is preconfigured, .com is unsigned, and example.com is signed. In practice, I think example.com would have to exist as a preconfigured trust anchor until .com is signed.</p>
<p>There is also lookaside validation as another interim measure.</p>
<p>And there are last mile issues while client system resolvers are not DNSSEC-aware and rely on their recursive servers to do validation for them. But eventually every client will be able to validate DNSSEC answers from a single preconfigured root key.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135370">

			<div class="comment by-steve-schultze ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://managingmiracles.blogspot.com' rel='external nofollow ugc' class='url'>Steve Schultze</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135370">
						April 13, 2010 1:33 PM					</a>

				</p>

				<p>@Francis Litterio: Actually, the CNNIC Sub-CA cert is impossible to block in Mozilla without blocking all Entrust certs altogether (not great for most web users).  That blog post is wrong (or at least not complete).  See here:</p>
<p><a href="http://groups.google.com/group/mozilla.dev.security.policy/browse_thread/thread/eea04805fbd98045#79efb08f1cb7651a" rel="nofollow ugc">http://groups.google.com/group/mozilla.dev.security.policy/browse_thread/thread/eea04805fbd98045#79efb08f1cb7651a</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135371">

			<div class="comment by-francis-litterio ">

				<p class="commentcredit">

					<span class="commenter">Francis Litterio</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135371">
						April 13, 2010 2:10 PM					</a>

				</p>

				<p>@Steve Schultze: In Firefox 3.6.3, the CNNIC CA cert appears only under &#8220;CNNIC&#8221; and not under &#8220;Entrust, Inc.&#8221; or &#8220;Entrust.net&#8221;.  Perhaps the Mozilla folks removed the one shown in the article to which I linked.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135372">

			<div class="comment by-steve-m ">

				<p class="commentcredit">

					<span class="commenter">Steve M.</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135372">
						April 13, 2010 2:37 PM					</a>

				</p>

				<p>Tom T:  you noted that CA certs can&#8217;t be permanently be deleted from Mozilla products.  This is a &#8220;feature&#8221; of NSS, described in the following self-quotation from last year.  I have built the clean replacement libraries (*nix and Windows), but it&#8217;s a pain:</p>
<p>NSS Trickery</p>
<p>Like other comparable products Firefox and Thunderbird ship with a wide assortment of pre-installed CA certificates. Not only the usual ones from Verisign, Equifax, and the like but also ones from some obscure entities like “Staat der Nederlanden”, “”Camerfirma Chambers of Commerce”, “TURKTRUST Certificate Services”.</p>
<p>The DoD PKI policy mandates that CA trusted keystores should only contain the CA certs specifically authorized by DISA. This make sense if you think about it, as a desktop system in the Pentagon shouldn’t be trusting CA certs from foreign CAs.</p>
<p>Fixing the keystore should be easy, we just use the handy-dandy GUI based certificate management tool to remove the unauthorized certs, right? No so. If you try that you find that after tediously clicky-clicking your way through and deleting 100 plus certificates that they initially appear to be gone. But, as soon as you restart Firefox (or Thunderbird, etc.) they all reappear. What is happening is that the NSS shared library libnssckbi.so automatically re-adds the bundled CA certs to the disk resident keystore (the cert8.db file).</p>
<p>Now this is downright annoying. Presumably the Mozilla Foundation is being paid for the inclusion of the bundled CA certs and wants to discourage their removal in order to boost the commercial value of that placement, but as with the DoD policy there are legitimate reasons why end users may want to remove bundled certificates.</p>
<p>There appears to be no alternative to complete replacement of the libnssckbi.so library. The bundled certs are defined in the file mozilla/security/nss/lib/ckfw/builtins/certdata.txt in the source tree. The Mozilla specific build process is annoyingly awkward and different for both Linux/Unix and Windows.</p>
<p>It should be noted that we have essentially the same problem in a different form with Microsoft Windows, as routine Microsoft issued patches tend to reinsert CA certificates. As we don’t have the option of modifying the software culling the unwanted CA certs requires constant vigilance.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135373">

			<div class="comment by-roger ">

				<p class="commentcredit">

					<span class="commenter">Roger</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135373">
						April 13, 2010 3:44 PM					</a>

				</p>

				<p>Are CAs not selling certificates by claiming they prevent third party decryption?  Have any issued disclaimers clarifying that sessions secured by their certs may not be decryptable solely by the customer and remote browser?    If so isn&#8217;t this is a breach of contract?  If this is the case I look forward to becoming a party to any class action suit against corrupt CAs with whom I&#8217;ve done business.</p>
<p>Question is, who is responsible for this area of law i.e., who would one complain to?  The FCC, DOC, FTC?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135374">

			<div class="comment by-daniel ">

				<p class="commentcredit">

					<span class="commenter">Daniel</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135374">
						April 13, 2010 3:52 PM					</a>

				</p>

				<p>Clive.</p>
<p>Kangaroo is correct. The problem with associative models is that they don&#8217;t scale well. They are good for small communities but not for modern states whose primary existence is based upon atomistic disassociation.</p>
<p>This has caused a lot of problems beyond just security. It&#8217;s a problem with jury selection in legal system as well. One of the reasons that more than 80% of crimes in America result in plea bargains is because the jury system is based upon an associative system of trust and it turns out that this system is both expensive and inefficient when applied to the demands of modern living.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135375">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135375">
						April 13, 2010 7:10 PM					</a>

				</p>

				<p>@ Kangaroo,</p>
<p>&#8220;It&#8217;s not odd. You&#8217;re just misgeneralizing.&#8221;</p>
<p>Hmmm it&#8217;s a viewpoint issue but I phrased it that way to make a point which you appear to agree with,</p>
<p>&#8220;&#8221;Humans&#8221; use associative, non-hierarchical models. Bureaucracies use centralized models, despite their deficiencies, precisely because they are centralized.&#8221;</p>
<p>That is there is a difference between what we do as &#8220;social individuals&#8221; and &#8220;worker drones&#8221;.</p>
<p>&#8220;Because organizations love the central approach&#8230;&#8221;</p>
<p>Which is also known as &#8220;The King/God game&#8221;.</p>
<p>That is one or more individuals apply &#8220;might is right&#8221; to get people subserviant to them and then by initial force of arms then tradition/religion/education maintain the fiction that they are &#8220;better&#8221; than all others.</p>
<p>These others should thus suplicate and be gratefull for the illusion presented.</p>
<p>Which as you note is,</p>
<p>&#8220;That&#8217;s not &#8220;human&#8221; &#8212; that&#8217;s a particular political model.&#8221;</p>
<p>Which in theory we can change, but can we&#8230;</p>
<p>The first step is to discuss the alternatives to the self enforcing bureaucratic cry of &#8220;somebody has to be in charge&#8221;. And thus have the argument to follow up to the charge of &#8220;anarchy&#8221; when you make the sensible reply to the bureaucrats that &#8220;there is no reason why anybody has to be in charge&#8221;.</p>
<p>As you note,</p>
<p>&#8220;GPG keys are quite usable and quite natural. Why isn&#8217;t that model used? Because organizations love the central approach where they control the keys, can charge for them,&#8221;</p>
<p>And there in lies the key to the problem that is it is a &#8220;business model&#8221; based on a cartel viewpoint.</p>
<p>Thus the solution is to move the economic tipping point against the cartel viewpoint, and thus kill the CA marketplace (not before time).</p>
<p>Which brings me onto,</p>
<p>@ Roger&#8217;s point,</p>
<p>&#8220;Are CAs not selling certificates by claiming they prevent third party decryption? Have any issued disclaimers clarifying&#8230;&#8221;</p>
<p>Sadly most CA&#8217;s say in the small print that they carry no liability for the certificates they issue.</p>
<p>Thus all a certificate is, is an &#8220;entry ticket&#8221; for the entity that purchases it.</p>
<p>That is they are paying to play in a cartel market created by a web browser company (Netscape) that other companies lept on (Microsoft et al) and others are still supporting, even though they claim to be &#8220;Open&#8221;.</p>
<p>The reason that these entites get away with it is a lack of &#8220;user education&#8221; disgused as &#8220;user conveniance&#8221;.</p>
<p>And the result of this collusion to create a cartel market where one should not exist is the very problem with SSL Certs we are now discussing in this thread&#8230;</p>
<p>That is the &#8220;supposed need&#8221; has given rise to a false economy that actualy causes more harm than good.</p>
<p>Which brings me onto,</p>
<p>@ Daniel&#8217;s point,</p>
<p>&#8220;This has caused a lot of problems beyond just security. It&#8217;s a problem with jury selection in legal system as well.&#8221;</p>
<p>Yes it has and unfortunatly the bureaucrat solution is most definately the wrong one (as usuall).</p>
<p>The common and incorect viewpoint (the state encorages) which Daniel note&#8217;s is,</p>
<p>&#8220;One of the reasons that more than 80% of crimes in America result in plea bargains is because the jury system is based upon an associative system of trust and it turns out that this system is both expensive and inefficient when applied to the demands of modern living.&#8221;</p>
<p>It&#8217;s not the reason plea bargaining is so prevalent. It is the imbalance of the accused&#8217;s position with respect to those who are charged with enforcment by the state. The accused  is not alowed in any way to lie to any LEO without suffering extream censure. However LEO&#8217;s are activly encoraged to lie to the accused in order to get a conviction. The reason being the state has little or no interest in real justice just in the two greate Political mantras of &#8220;being seen to be hard on crime&#8221; and &#8220;being seen to be tough on inefficiency&#8221; (both of which are actually compleate false hoods).</p>
<p>That is state deliberatly misrepresent the cost to society for political gain, which is one of the reasons the US have so many prisoners that upset the likes of Amnesty International and other Pro Justice organisations.</p>
<p>As for Daniel&#8217;s point,</p>
<p>&#8220;The problem with associative models is that they don&#8217;t scale well.&#8221;</p>
<p>Is in most cases it&#8217;s been properly investigated a &#8220;myth&#8221;.</p>
<p>For instance, the 150 limit for hunter gather groups, that get&#8217;s widley touted.</p>
<p>It has absolutly nothing to do with the societal aspects of the group but everything to do with resource density in any given area.</p>
<p>That is the amount of energy expended to gather resources together in one place goes up with population density. For an unaided human this limit&#8217;s the practical size of a societal group. As man developed ways to improve (via dogs, cattle and horses) his natural limit&#8217;s the size of the societal groups grew.</p>
<p>At each &#8220;break point&#8221; there is a non societal limit such as that of cities at 40,000 prior to the 1800&#8217;s due to bacterial pathogens. Which was broken by the tea drinking UK, China and Japan due to the natural antibiotic effect of tea, and laterly the recognition of the need and efficient removal of waste. Currently our cities are enabled by medical intervention in the food supply, but limited by the cost of equality, that is we are finaly starting at the 1,000,000+ population density to see some societal reasons why we cannot progress further. However these reasons have their root cause in our political and economic viewpoints and thus society can chose to remove these constraints if it so desires (and the self apointed Kings/Gods alow or get overthrown).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135377">

			<div class="comment by-david-bullock ">

				<p class="commentcredit">

					<span class="commenter">David Bullock</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135377">
						April 13, 2010 10:29 PM					</a>

				</p>

				<p>It&#8217;s a bit late to be adding to this thread, but as a security novice, it seems that part of the &#8220;untrustworthy hierarchy&#8221; problem in PKI is that is the SSL server presents a certificate which contains the claim &#8220;I am site X, and Jim trusts me&#8221;.  This is an obstacle to a web-of-trust model, because it is wasteful of bandwidth to say &#8220;I am site X, and Jim, Mary, and 105,039 other people all trust me&#8221; on each presentation of the certificate.  Wouldn&#8217;t it be &#8216;better&#8217; (from a web-of-trust scale perspective) if the client could inquire of Jim &#8220;can I trust site X?&#8221;?  Presumably there are trade-offs (one that comes to mind is, that Jim might not know, or might be unavailable at the time we want to know).  Are there ways around these other than a hierarchical signing model?  Where can I go read about them? 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135378">

			<div class="comment by-tom-t ">

				<p class="commentcredit">

					<span class="commenter">Tom T.</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135378">
						April 13, 2010 10:56 PM					</a>

				</p>

				<p>@ Francis Litterio:</p>
<p>The situation apparently is not so bad as I thought. Although the certs come back in the list, they come back with all of the trust checkboxes unchecked, as described in your link and photo. So presumably, Firefox will no longer trust them. Thank you very much for the link.</p>
<p>@ Steve M:</p>
<p>You have built the clean replacement libraries? Could you post them for download somewhere? It would be a great service to all of us.</p>
<p>Also, there are still some diehards using Fx 2.0.0.20, if you can provide the compatible library for that.</p>
<p>It&#8217;s hard to understand why MZ won&#8217;t allow users to choose which certs they wish to include or delete from the list. If you can publish an empty library to which we could add only our own chosen certs, it won&#8217;t solve this problem completely, but it would be a huge first step, and you&#8217;d be awarded much good Karma.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135379">

			<div class="comment by-kurt-seifried ">

				<p class="commentcredit">

					<span class="commenter">Kurt Seifried</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135379">
						April 14, 2010 1:44 AM					</a>

				</p>

				<p>You don&#8217;t even need to compel them, just pony up the $79 and intercept their email (using something like carnivore perhaps). SSL domain verification is laughably weak. I covered this and some other issues in this months column:</p>
<p><a href="http://www.linux-magazine.com/Issues/2010/114/BREACH-OF-TRUST/" rel="nofollow ugc">http://www.linux-magazine.com/Issues/2010/114/BREACH-OF-TRUST/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135380">

			<div class="comment by-steve-schultze ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://managingmiracles.blogspot.com' rel='external nofollow ugc' class='url'>Steve Schultze</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135380">
						April 14, 2010 8:22 AM					</a>

				</p>

				<p>@Francis Litterio: No, nothing has changed.  Mozilla does not ship with the CNNIC Entrust Sub-CA.  Instead, when you visit a site, the TLS session can send you intermediate certs that are silently used and cached in your cert store (as long as they chain to a trusted root)&#8230; that&#8217;s when you can go back to the list and see it.  Frightening, eh?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135381">

			<div class="comment by-david ">

				<p class="commentcredit">

					<span class="commenter">David</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135381">
						April 14, 2010 9:39 AM					</a>

				</p>

				<p>@Daniel:  &#8220;Trust but verify&#8221; doesn&#8217;t work if trust is binary.  It does work if there&#8217;s only a certain level of trust.  I have a certain amount of trust of places where I use my credit card, but I still look at the monthly statements.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135383">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135383">
						April 14, 2010 11:34 AM					</a>

				</p>

				<p>@ David Bullock,</p>
<p>&#8220;Wouldn&#8217;t it be &#8216;better&#8217; (from a web-of-trust scale perspective) if the client could inquire of Jim &#8220;can I trust site X?&#8221;? Presumably there are trade-offs (one that comes to mind is, that Jim might not know, or might be unavailable at the time we want to know).&#8221;</p>
<p>The first problem is what do you mean by &#8220;can I trust site X?&#8221;. What you mean and what Jim thinks you mean may be poles apart. This is the current problem with CA&#8217;s all their issued certificates realy mean is &#8220;the cheque did not bounce&#8221; nothing more. There is no guarenty offered by the CA that the certificate holder even filled the forms in let alone that they filled them in honestly and absolutly no guarentee that once a certificate has been issued that the entity is going to behave honestly let alone anything else.</p>
<p>Also you forgot that Jim might not want to tell you what he does or does not think about site X..</p>
<p>As Jim may not wish to tell you who he associates with and thus trusts / does not trust for a whole heap of legitimate reasons.</p>
<p>However all that being said, as unlikley as it seams you are probably no more than seven steps/links away from direct knowledge of any entity on the Internet anywhere in the world. And probably no more than two for most major sites etc.</p>
<p>Thus establishing two or more independent chains of links to any chosen entity is the (not so) minor task of joining the links together to make the chains with no crosslinks.</p>
<p>The problem is getting co-operation from each set of link nodes to scan their &#8220;known (and trusted) associates&#8221; list.</p>
<p>&#8220;Are there ways around these other than a hierarchical signing model?&#8221;</p>
<p>Yes there are a number of ways other than trust webs, one of which is &#8220;trade refrence posts&#8221; where people can post if they have had good or bad experiance. These work similarly to the E-Bay etc system of rating. However as we know this has flaws as well.</p>
<p>Likewise online virtual life  systems, where people have been blackmailed upon creating and releasing their alter ego&#8217;s.</p>
<p>At the end of the day it apears that there is no system that cannot be abused in one way or another, and that the old fashioned &#8220;build your reputation&#8221; process is still one of the better ways. However this flies in the face of the &#8220;instant gratification&#8221; life style that people are being encoraged into.</p>
<p>Then there are a whole load of underlying issues to do with &#8220;identity&#8221; and &#8220;roles&#8221; sumed up best by the old cartoon of the two dogs sitting infront of a PC where on says to the other &#8220;The great thing about the Internet is nobody knows your a mut&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135384">

			<div class="comment by-greg ">

				<p class="commentcredit">

					<span class="commenter">Greg</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135384">
						April 14, 2010 7:33 PM					</a>

				</p>

				<p>Thanks for this Bruce, and I think what would be supremely more useful is if the Certificate Patrol add-on made use of crowd sourcing and made publicly available the oldest known valid cert for any organization so that it can be compared to the one a visitor just loaded on first visit to a site.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135385">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135385">
						April 14, 2010 9:31 PM					</a>

				</p>

				<p>For those interested in other viewpoints on the matter you could have a look at the Financial Cryptography blog. It has two articals the first on SSL</p>
<p><a href="https://financialcryptography.com/mt/archives/001232.html" rel="nofollow ugc">https://financialcryptography.com/mt/archives/001232.html</a></p>
<p>And the next artical on why CA&#8217;s should be brought under the browser users spotlight.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135386">

			<div class="comment by-woofle ">

				<p class="commentcredit">

					<span class="commenter">Woofle</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135386">
						April 15, 2010 11:31 PM					</a>

				</p>

				<p>@ David Bullock<br />
&#8220;&#8230;a web-of-trust model&#8230;<br />
&#8230;<br />
&#8230;<br />
Are there ways around these other than a hierarchical signing model? Where can I go read about them?&#8221;</p>
<p>Assuming your crypto-iggorance is even greater than mine (an achievement all by itelf!)<br />
Try Phil Zimmerman&#8217;s (the PGP bloke) Introduction to Cryptography<br />
<a href="ftp://ftp.pgpi.org/pub/pgp/7.0/docs/english/IntroToCrypto.pdf" rel="nofollow ugc">ftp://ftp.pgpi.org/pub/pgp/7.0/docs/english/IntroToCrypto.pdf</a><br />
(~ 1 MB pdf)</p>
<p>Read the section on Trust. It discusses Hierarchical Trust, and the PGP-style web of trust (you&#8217;re post indicates you probably know this much already). It&#8217;s a light read and non-technical. At the end of the book is a list for further reading.</p>
<p>Note that this dates from 2000. However, the principles are still the same – it’s the technical stuff that has moved on.</p>
<p>In principle (and simplistically), you can imagine a hybrid solution where web sites/people (not necessarily “authorities”) will sign and publish a server’s public key. An individual could check a site’s key/certificate at a few of these that he trusts. If money must be made from such a venture it could be garnered from suitable advertising – it is not necessary that the site being verified pay. So it is possible to avoid a conflict of interests (greed is entirely another issue).<br />
… or maybe I’m just talking about PGP keyservers…. Get rid of the formal, bureaucratic PKI and use the existing PGP / GPG infrastructure.</p>
<p>Anyways – the formal PKI as being foisted upon us is unnecessary. As someone once observed (it might have been Zimmerman): PKI is a proper subset of the”Web of Trust.”</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135387">

			<div class="comment by-craig ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.securityking.com' rel='external nofollow ugc' class='url'>Craig</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135387">
						April 16, 2010 7:14 AM					</a>

				</p>

				<p>&#8220;Trust&#8221; is the keyword here?<br />
Can it ever be achieved, I doubt it, but we need these purchase systems in place to function in the modern world and most governments aren&#8217;t interested in our personal purchases over the internet, alas that still does not make it acceptable.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135388">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135388">
						April 16, 2010 9:15 AM					</a>

				</p>

				<p>One thing that is often overlooked in these discussions is that there are two distinct problems:</p>
<ol>
<li>How do I know that I&#8217;m talking to the real bankofamerica.com and not a MITM?</li>
<li>How do I know that bankofamerica.com is operated by Bank of America and not a domain squatter?</li>
</ol>
<p>Problem 1 is solvable in a number of ways. DNSSEC-based PKI is the most natural, since the actual question boils down to whether the domain name does in fact identify the system I&#8217;m talking to.</p>
<p>Problem 2 used to be solved (though not well) by the CAs, back when they were charging $800/year for a certificate. Their authentication practices have gradually degraded over the last 10 years or so to the point where someone who can attack email can generally get a certificate for the subject domain. So now a select few CAs issue extended validation (i.e. &#8220;actual&#8221; validation) certificates to restore the former state of affairs, both in terms of &#8220;actual&#8221; validation and price.</p>
<p>As long as there&#8217;s a gap between our Internet naming system (currently DNS) and our real-world naming system, problem 2 will still need to be solved.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135389">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135389">
						April 16, 2010 12:04 PM					</a>

				</p>

				<p>@ Craig,</p>
<p>&#8220;&#8230; most governments aren&#8217;t interested in our personal purchases over the internet,&#8221;</p>
<p>That depends on where you live and how much you are spending.</p>
<p>For instance in the EU the money laundering laws basically say any transaction over a certain amount or any transaction that the bank etc may have reason to be suspicious of being used for money laundering.</p>
<p>The problem for a bank or other &#8220;professional&#8221; organization is the &#8220;reason to be suspicious&#8221; there is no definition or guidance, therefore any transaction can be viewed as suspicious. In the UK if you go to your bank or building society and ask to take out more that a few hundred pounds you will automatically be asked why you need the money in cash&#8230; and you will see the counter staff make a note on the system of what you say&#8230;</p>
<p>Also not so long ago the UK Gov purchased copies of &#8220;loyalty card DB&#8217;s&#8221;, various reasons have been suggested. One such is that the UK Gov was going to use the information to set property taxes in a give post code (they started putting this into place in N.I. until it got bad press).</p>
<p>Put simply in the UK the Gov both central and local are not getting enough money from businesses and the like. Therefor they are targeting those who cannot hide their assets and are going to bleed them dry. We have already seen court cases where Gov representatives feel quite happy about lying to juries in order to get a conviction under POCA and then they asset strip the individual so that they cannot either defend themselves in court or mount a recovery of rights action when it has been found that a government representative has lied to a court&#8230;</p>
<p>This is simply because not only does the UK Treasury make money out of it the investigators and legal representatives are on a substantial percentage as well.</p>
<p>In a recent case a business man was wrongly accused of various crimes, he had all his financial records and assets taken away from him under POCA, the prosecution deliberately with held the financial records from the defense team for as long as possible. When the defense applied to get access to the defendants assets so that a firm of forensic accountants could go through the records prior to the case. The prosecution told the judge (who was stupid enough to believe them) that the books could be analyzed &#8220;with a calculator&#8221; in short order. Of the three charges brought against the man he was found innocent by the jury of two of them. Between the trial and sentencing a firm of forensic accountants pro bona investigated his books and issued an opinion that the man was innocent. Effectively they said that rather than him owing money to the government they actually owed him a substantial amount of money&#8230;</p>
<p>What did the judge do, well he expressed grave misgivings and under pressure of the prosecution still sent the man to jail&#8230;</p>
<p>He now has to wait for the appeals process to grind around and at his age he may not actually last that long in jail&#8230;</p>
<p>As you say,</p>
<p>&#8220;alas that still does not make it acceptable.&#8221;</p>
<p>No it does not, but I fully expect such laws and behavior to spread because it is just so seductive to the politicos, they get cheap convictions and all the assets, without having to admit it is just revenue raising&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135390">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135390">
						April 16, 2010 12:25 PM					</a>

				</p>

				<p>@ antibozo,</p>
<p>&#8220;One thing that is often overlooked in these discussions is that there are two distinct problems:&#8221;</p>
<p>You missed the most important,</p>
<p>0, How do I trust the computer I&#8217;m using.</p>
<p>It&#8217;s game over from that point.</p>
<p>There have already been instances where malware on a PC has re-written the browser display window in an online banking system to hid the fact that money has been taken from the account by the malware operators&#8230;.</p>
<p>The only way that trust can be established is via multiple fully independent side channels and non mutable tokens that two way authenticate all transactions, not just the session. As long as malware operators can do an &#8220;end run&#8221; around the secure channel or the authentication application you cannot believe what your eyes tell you (they could have put malware in the display hardware for instance).</p>
<p>Then there are other issues such as relay attacks around the token.</p>
<p>Establishing trust in the information world where physical world constraints such as distance/locality, energy constrained force multipliers and duplication cost have no meaning is going to prove an interesting field of research.</p>
<p>Currently the only way we have a chance is to force the information through a physical token that is provably unique and provably not subject to alteration by a third party.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135391">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135391">
						April 16, 2010 6:41 PM					</a>

				</p>

				<p>Clive,</p>
<p>SSL/TLS is a protocol between computers. Obviously things between the operator and the protocol have ample opportunity to lie to the operator. I am not &#8220;missing the most important&#8221; by not bothering to address the obvious.</p>
<p>It&#8217;s not clear to me how a token can prevent the display from lying to or eavesdropping on the operator. Maybe you&#8217;re getting a little lost in the trees. You seem to have completely missed my point.</p>
<p>[Notice, BTW, how I didn&#8217;t put an @ in front of your name, because it is not necessary.]</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135392">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135392">
						April 17, 2010 5:53 AM					</a>

				</p>

				<p>antibozo,</p>
<p>(as you wish on the norm of the @)</p>
<p>&#8220;I am not &#8220;missing the most important&#8221; by not bothering to address the obvious.&#8221;</p>
<p>Obvious to whom?</p>
<p>Most people (and many on this blog until quite recently have) assumed incorrectly that AV / SSL etc protect their online transactions, the truth is they come nowhere close as they are all subject to &#8220;end runs&#8221; around them by being attacked at a lower level. The sad truth is the current design of MS OS&#8217;s and most *nix cannot in anyway prevent this &#8220;low level shim&#8221; issue. The touted solution of &#8220;code signing&#8221; is a joke at best, and not at all funny, and people need to be told this (frequently) for them to appreciate the implications.</p>
<p>With regards,</p>
<p>&#8220;It&#8217;s not clear to me how a token can prevent the display from lying to or eavesdropping on the operator.&#8221;</p>
<p>If the display shows,</p>
<p>&#8220;457289578 Transfer 1,000USD to IBAN&#8230;&#8230;. XYZABC345&#8221;</p>
<p>The first part is the unique transaction number picked randomly by the bank and the last part is a crypto checksum based on an account specific shared secret, when the user types the whole string into the token the token will say the checksum is incorrect.</p>
<p>You have moved the end authentication of the transaction beyond the Internet and the computer to the token.</p>
<p>Likewise if then checksum is good the token produces a string the user types in to the browser to accept the transaction. This string likewise based around the shared secret and the transaction identifier etc.</p>
<p>With regards the eavesdropping, the string displayed on the PC screen can be as easily ASCII armored cipher-text as in plain-text so as long as the key is based on a function of the shared secret that changes with every transaction or session then that covers the eavesdropping.</p>
<p>Anything other aspects of the token (such as it should be completely stand alone and non-mutable) puzzling you?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135393">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135393">
						April 17, 2010 3:12 PM					</a>

				</p>

				<p>Clive,</p>
<p>What about everything up to and after the point of authentication, e.g. what account the money is about to be transferred to, and how much?</p>
<p>Maybe if you have a token with a camera that reads QR codes you might be able to have the token display the actual transaction details before authentication. But good luck getting someone to correctly type in a string long enough to accomplish that.</p>
<p>That&#8217;s authentication/display/eavesdropping. What about data entry?</p>
<p>Your concerns about end-to-end security, while theoretically valid, are completely secondary to the topic of this post, which is the fundamental insecurity of SSL within the practice of CA behavior.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135394">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135394">
						April 17, 2010 9:31 PM					</a>

				</p>

				<p>antibozo,</p>
<p>I&#8217;ll deal with your points in reverse as that will keep the length of the post down.</p>
<p>&#8220;Your concerns about end-to-end security, while theoretically valid, are completely secondary to the topic of this post, which is the fundamental insecurity of SSL within the practice of CA behavior.&#8221;</p>
<p>It does not really matter if SSL can be made secure or not, or if the CA&#8217;s etc can be trusted not to be subverted or not, it really is not of that much relevance any more when it comes to phishing or MITM or most other attacks. Whatever solution they come up with to fix SSL/CA&#8217;s will be &#8220;little more than putting a BandAid&#8221; on a broken bone.&#8221;</p>
<p>This is because the attackers where ever possible will go for the weakest link in the chain and the likes of the banks etc will only make tiny incremental changes. So the game favors the attackers hands down currently (and is likely to continue to do so for quite some time to come).</p>
<p>It is a point I have been making since the 1990&#8217;s along with,</p>
<p>You need to fully authenticate a transaction in both directions, authenticating a session is insufficient. And the authentication has to be done where an attacker cannot get at it (ie an external non mutable token).</p>
<p>This is because as you strengthen each point along the communications chain the attackers will either attack the next weakest link or more simply just do an end run around the whole security chain (which they have started to do).</p>
<p>Ultimately that means they will attack either end (bank and client) of the security chain if they can. It is going to be easier for the bank to secure it&#8217;s systems and put in place the required mechanisms to provide a degree of protection for their end of the chain. However there is no conceivable way this can currently be done at the client end with the likes of MS and *nix OS&#8217;s on commodity hardware.</p>
<p>As has been shown for real it is not that difficult for an attacker to get at the PC keyboard and screen drivers of millions of PC&#8217;s at a fairly moderate price (see discussions about the recent additions to ZeuS botnet software and the price it&#8217;s for sale at). Which means you require a token to authenticate beyond this point in the communications chain. Which is what the external non mutable token is all about.</p>
<p>Which is why the likes of IBM (USB based) and Chronos Technologies (camera based with 2D bar code) make tokens to move the authentication of the transaction off of the PC and onto the token. Which answers your question about,</p>
<p>&#8220;What about data entry?&#8221;</p>
<p>My own viewpoint is that such systems as the IBM and Chronos systems have dangers of being vulnerable if they are not fully immutable (which given the track record on FMCE and other low cost production methods is something you need to guard against and no, code signing just does not hack it).</p>
<p>With regards to,</p>
<p>&#8220;What about everything up to and after the point of authentication, e.g. what account the money is about to be transferred to, and how much?&#8221;</p>
<p>The only parts that need to be fully authenticated is, what the bank understands the full transaction to be, and the user either authenticating it or rejecting it.</p>
<p>For authentication the part where the user puts in the details does not have to be secure because the bank sends this back as the &#8220;full transaction&#8221; details in between the transaction number and transaction authentication checksum.</p>
<p>However for confidentiality then the user would enter the information into the token that would encrypt the data and provide the information in the form of ASCII armored cipher text.</p>
<p>If you want to know more about this then have a look at my postings in previous of Bruce&#8217;s blogs, it has been gone into in some considerable depth on several occasions.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135395">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135395">
						April 18, 2010 4:32 AM					</a>

				</p>

				<p>Clive&gt; For authentication the part where the user puts in the details does not have to be secure because the bank sends this back as the &#8220;full transaction&#8221; details in between the transaction number and transaction authentication checksum.</p>
<p>Which is the part (i.e. the &#8220;full transaction&#8221; details) the display can lie about, after the input path lied to the bank while the user was typing in those details.</p>
<p>The token needs to present the details to the user or the user doesn&#8217;t know what he is authenticating with the token. Yes, you can work around this by having the user use the token to sign the transaction details as they are provided to the bank, but this is for authentication, not privacy.</p>
<p>In any case, the idea of &#8220;external non mutable tokens&#8221; is just begging the question. Governments will just force IBM to build a backdoor into their tokens, or produce lookalikes and swap them for the real thing. If you want real end-to-end security, the user has to do the ciphers with pencil and paper. And even then you haven&#8217;t solved key establishment. So let&#8217;s return to reality for a while, shall we?</p>
<p>In practice, SSL is broken in a number of ways, but it is not the problem. The problem Bruce posted about is the CAs&#8217; practices. The problem I wrote about is the CAs&#8217; lack of proper authentication strategies when issuing certificates, and the oft-overlooked distinction between authenticating a domain owner (easy) and authenticating the correspondence of a domain with a real business (hard).</p>
<p>The current problem in Internet banking is malware with keystroke loggers attacking Windows machines and stealing people&#8217;s static passwords. Authenticating sessions with plain old RSA tokens would solve that problem, as would, of course, getting rid of Windows&#8211;at least for the time being.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135396">

			<div class="comment by-robert ">

				<p class="commentcredit">

					<span class="commenter">Robert</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135396">
						April 19, 2010 2:00 AM					</a>

				</p>

				<p>@antibozo<br />
 I have to agree with Clive on this point. Your changes only fix a small portion of today&#8217;s problem, but do nothing to address the real system level authentication problem.</p>
<p>The only long term fix, in my mind, is secure external tokens (customers end) and mutual authentication of the end-points.</p>
<p>Unfortunately, the truth is, that the secure tokens business has become a race to the bottom of the cost curve. The buyer&#8217;s are totally ignorant of the differences between good, bad and outright ugly cryptography and refuse to pay for the chip area necessary to implement properly secure microcontrollers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135397">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135397">
						April 19, 2010 7:40 AM					</a>

				</p>

				<p>antibozo,</p>
<p>Upto this point it has not been clear if  you do not understand what I am saying or if you are not taking note of what I am saying for some reason.</p>
<p>Your last post strongly suggests the latter. Normally I would not respond further, however for the sake of other readers I will clear up your nitpicking points.</p>
<p>First off,</p>
<p>You say,</p>
<p>&#8220;&#8230; but this is for authentication, not privacy.&#8221;</p>
<p>In response to my comment you quoted that clearly says,</p>
<p>&#8216;For authentication &#8230;&#8217;</p>
<p>If you want to do just privacy then you can use the shared secret to derive a symmetric encryption key and pass ASCII armored cipher text back and forth between the token and the banks system. Provided one or two precautions are taken you can with some encryption systems dispense with the level of authentication you would otherwise need. However I would very much advise against it. From a system design point of view it would be far better to do both the authentication and the encryption as this simplifies what each part of the system does and thus aids not just testing but assurance.</p>
<p>Secondly with regards to your statment,</p>
<p>&#8220;In any case, the idea of &#8220;external non mutable tokens&#8221; is just begging the question. Governments will just force IBM to build a backdoor into their tokens, or produce lookalikes and swap them for the real thing.&#8221;</p>
<p>The US or UK Governments like most other countries have no need to have a &#8220;back door&#8221; they can simply use the various laws they have at hand (Patriot / RIPA et al) to get the details directly from the bank without requiring a warrant or other third party safe guard.</p>
<p>Likewise providing the token is not a general purpose crypto device which the token does not need to be there is no requirement for &#8220;007&#8221; behavior.</p>
<p>So as you say,</p>
<p>&#8220;So let&#8217;s return to reality for a while, shall we?&#8221;</p>
<p>Thirdly, you say,</p>
<p>&#8220;The problem I wrote about is the CAs&#8217; lack of proper authentication strategies when issuing certificates, and the oft-overlooked distinction between authenticating a domain owner (easy) and authenticating the correspondence of a domain with a real business (hard).&#8221;</p>
<p>Actually neither problem is easy or hard they are both effectively not possible to achieve. The reasons for this are varied, with regards the &#8220;domain owner&#8221; is it is not currently possible nor is it ever likely to be possible for you to prove who an &#8216;entity&#8217; is, nor if you think about it is it desirable that it be possible. Likewise linking a &#8220;real business&#8221; (entity) with any particular transaction or action. At a fundamental level it is an issue to do with hierarchies of trust and if false credentials can be produced, and this is not a solvable problem in a meaningful way. It is why you should read the small print on the CA sites very very carefully and their limits of liability, you will realize that the whole system like other bureaucratic shams is so broken it cannot possibly be fixed. Just look on it as being another form of confidence trick just like pyramid selling.</p>
<p>Fourthly, you said,</p>
<p>&#8220;The current problem in Internet banking is malware with keystroke loggers attacking Windows machines and stealing people&#8217;s static passwords.</p>
<p>Authenticating sessions with plain old RSA tokens would solve that problem, as would, of course, getting rid of Windows&#8211;at least for the time being.&#8221;</p>
<p>Your are out of date with regards to this. I suggested you go and look the latest additions to the ZeuS botnet software. It includes a remote shell so an attacker can effectively be you sitting at the keyboard after you have started an authenticated session. Thus &#8220;Authenticating sessions&#8221; will not work.</p>
<p>As I have said a number of times,</p>
<p>&#8216;You need to fully authenticate a transaction in both directions, authenticating a session is insufficient. And the authentication has to be done where an attacker cannot get at it (ie an external non mutable token).&#8217;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135398">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135398">
						April 19, 2010 7:44 AM					</a>

				</p>

				<p>@ Moderator / Bruce,</p>
<p>Can you check the IP address range &#8220;antibozo&#8221; is using and see if it corresponds to other posts under a different name?</p>
<p>There is something kind of familiar about the &#8220;style&#8221; of post being made.</p>
<p>Regards,</p>
<p>Clive.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment byuser comment-author-mod odd alt thread-odd thread-alt depth-1" id="comment-135399">

			<div class="comment by-moderator official">

				<p class="commentcredit">

					<span class="commenter">Moderator</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135399">
						April 19, 2010 10:39 AM					</a>

				</p>

				<p>Clive, Antibozo has been around for years.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135400">

			<div class="comment by-antibozo ">

				<p class="commentcredit">

					<span class="commenter">antibozo</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135400">
						April 19, 2010 11:35 AM					</a>

				</p>

				<p>Clive,</p>
<p>The part I was referring to did not begin with &#8220;For authentication&#8221;. It began with &#8220;However for confidentiality&#8221;:</p>
<p>Clive&gt; However for confidentiality then the user would enter the information into the token that would encrypt the data and provide the information in the form of ASCII armored cipher text.</p>
<p>I don&#8217;t think you understood the attack I described. You haven&#8217;t described your key establishment in detail, but if the user merely encrypts the data to the bank using a public key belonging to the bank, Mallory, sitting between the user&#8217;s keyboard/display and the operating system, can replace the details in transit. When the bank responds with the transaction details and an authentication challenge, Mallory displays the original details. To mitigate this you need to either authenticate the information presented to the bank with a signature from the user&#8217;s token, or have the token display the transaction details to the user, e.g. by encoding them in a QR code along with the challenge and a signature from the bank, as I suggested earlier.</p>
<p>Your other responses are generally oblique but I&#8217;m weary of banging my head against the wall. I&#8217;ll restate one last time and then you can have the last word.</p>
<ol>
<li>Begging the question: if the existing investigative process were sufficient in governments&#8217; view, there would be no need for them to have had the CAs issue special certs in the first place, so it&#8217;s silly to suggest that tokens would somehow be immune to this desire. Maybe there are banks somewhere in the world that don&#8217;t fall under U.S./U.K. subpoena authority?</li>
<li>Key establishment, both initial and re-keying in case of key compromise. How do we get these magic tokens, exactly, and get the keys onto them that are known only to the two parties involved?</li>
<li>Isn&#8217;t there some sort of Internet activity that requires privacy and/or secure authentication other than a bank transaction? Should I secure the download of every message over IMAP/SSL by entering a challenge on my immutable token? Do I need a different token with every email provider, WordPress blog, etc.? Or is there, perhaps, a place for session authentication and hierarchical PKI?</li>
</ol>
<p>What&#8217;s funny is that there are number of ways in which I agree with you, but you&#8217;re so keen to argue that you decided to attack my comment (the bipartite authentication problem) for no apparent reason.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135401">

			<div class="comment by-chris-k ">

				<p class="commentcredit">

					<span class="commenter">Chris K</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135401">
						April 30, 2010 6:57 AM					</a>

				</p>

				<p>To counter the problem of a government compelling a CA to provide a signing key (or a copy of the CA&#8217;s key) web sites could get their certificates signed by two or more CAs in different countries and browsers check the certificate was signed by the same list of CAs on each visit. As long as no government can compel all the CAs to provide fake keys then the attack won&#8217;t work.</p>
<p>A corporate email system should be protected by the browser only accepting the corporate certificate loaded onto the PC when it was originally configured in the office.</p>
<p>Banks etc should be required to print their key fingerprints on the various bit of paper they send out. That bypasses CAs altogether as long as users check the certificate the first time they visit the bank&#8217;s web site.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135402">

			<div class="comment by-uniken ">

				<p class="commentcredit">

					<span class="commenter">Uniken</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135402">
						May 11, 2010 7:22 AM					</a>

				</p>

				<p>It is worrying that most banks today still rely only on using SSL, Digital Certificates, OTPs and HTTPS for providing (supposedly) &#8216;secure&#8217; access to their Internet banking customers!</p>
<p>While SSL might provide an encrypted channel between the customer’s browser and the bank’s server, it does NOT authenticate the website that the customer is going to. The browser only validates whether the SSL certificate is valid or not &#8211; it does not authenticate whether the certificate indeed belongs to the Bank (except in the case of EV-SSL). Hence, the customer might see the “lock” icon in his/her browser and still may be connected to a malicious website that can steal their credentials.</p>
<p>Even the One-Time Password (OTP) Tokens, that generate a single-use password which the customer has to enter in addition to the regular Internet banking password, are prone to man-in-the-middle attacks. Regardless of how the OTP is generated (hardware device / software program / mobile SMS), its limitation is that the customer still enters this OTP on an unauthenticated page and over an insecure channel. Plus, it is cost-prohibitive to deploy, maintain &amp; renew the hardware tokens.</p>
<p>It&#8217;s time we moved beyond such redundant measures and stopped fooling ourselves into a fake/induced sense of so-called &#8216;security&#8217;. We need to significantly upgrade our technology and protect customers from not only Man-in-the-Middle, Man-in-the-Browser and Phishing attacks, but also key-loggers, trojans, screen-scrapers, and all known kinds of spyware and malware (resident on the desktops, in browsers and on the internet).</p>
<p>This might surprise you but two of India&#8217;s largest PSU banks (Bank of India &amp; State Bank of India) are already in the process of implementing this cutting-edge technology called REL-ID that does all of the above &amp; more!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135404">

			<div class="comment by-gordon-youd ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.toys-gadgets.com/' rel='external nofollow ugc' class='url'>Gordon Youd</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135404">
						October 2, 2015 4:25 PM					</a>

				</p>

				<p>If digital data streams could have an analogue signal imposed onto them and then the other end removes the analogue signal leaving clean data behind. Only the sender and receiver knows the start point of the data in the analogue stream.<br />
I think a hacker would have a hard time removing the data.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-135405">

			<div class="comment by-phil-lello ">

				<p class="commentcredit">

					<span class="commenter">Phil Lello</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135405">
						March 13, 2016 11:51 AM					</a>

				</p>

				<p>An important point to remember &#8211; even if using a closed-source vendor OS, a rich enough company can get source code to the OS to do custom builds &#8211; certainly this was the case with Windows in ~2000.</p>
<p>Ultimately, there&#8217;s always a requirement for a leap of faith that a system hasn&#8217;t been tampered with in a way you&#8217;re unaware of and unable to detect.</p>
<p>I&#8217;m surprised that a TLS MITM is legal, or at least hasn&#8217;t been challenged under DMCA and similar; given all the legislation-stuffing that occured to make DRM removal illegal. I&#8217;m sure it can and will be argued both ways; according to the current entry on wikipedia:</p>
<p>&#8220;The Digital Millennium Copyright Act (DMCA) is an amendment to United States copyright law, passed unanimously on May 14, 1998, which criminalizes the production and dissemination of technology that allows users to circumvent technical copy-restriction methods. Under the Act, circumvention of a technological measure that effectively controls access to a work is illegal if done with the primary intent of violating the rights of copyright holders.&#8221;</p>
<p>It is logical to assume (and therefore probably wrong in a legal context) that TLS MITM for the purposes of caching is no different from caching spinning-optical-disk-of-choice as an ISO on a hard-disk.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-135406">

			<div class="comment by-algot-runebjork ">

				<p class="commentcredit">

					<span class="commenter">Algot Runebjörk</span> •

					<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/#comment-135406">
						January 9, 2019 7:03 AM					</a>

				</p>

				<p>Matt Blaze has sold his old domain crypto.com and the new URL for your link is</p>
<p><a href="https://www.mattblaze.org/blog/spycerts" rel="nofollow ugc">https://www.mattblaze.org/blog/spycerts</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2010/04/man-in-the-midd_2.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2010/04/man-in-the-midd_2.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F04%2Fman-in-the-midd_2.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2010/04/man-in-the-midd_2.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='3348' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2010/04/makeup_to_fool.html" rel="prev">← Makeup to Fool Face Recognition Software</a>		<a href="https://www.schneier.com/blog/archives/2010/04/terrorist_attac.html" rel="next">Terrorist Attacks and Comparable Risks, Part 1 →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
