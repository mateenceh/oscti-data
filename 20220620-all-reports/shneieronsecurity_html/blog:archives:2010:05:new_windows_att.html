<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>New Windows Attack - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; New Windows Attack Comments Feed" href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/3397" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=3397' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F05%2Fnew_windows_att.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F05%2Fnew_windows_att.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-3397 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-3397" class="post-3397 post type-post status-publish format-standard hentry category-uncategorized tag-antivirus tag-malware tag-microsoft tag-windows">

	<div class="article">

		<h2 class="entry">New Windows Attack</h2>
		<p>It&#8217;s still <a href="http://www.zdnet.com/blog/hardware/update-new-attack-bypasses-every-windows-security-product/8268">only in the lab</a>, but nothing detects it right now:</p>
<blockquote><p>The attack is a clever &#8220;bait-and-switch&#8221; style move. Harmless code is passed to the security software for scanning, but as soon as it&#8217;s given the green light, it&#8217;s swapped for the malicious code. The attack works even more reliably on multi-core systems because one thread doesn&#8217;t keep an eye on other threads that are running simultaneously, making the switch easier.</p>
<p>The attack, called KHOBE (Kernel HOok Bypassing Engine), leverages a Windows module called the System Service Descriptor Table, or SSDT, which is hooked up to the Windows kernel. Unfortunately, SSDT is utilized by antivirus software.</p></blockquote>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/antivirus/" rel="tag">antivirus</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/microsoft/" rel="tag">Microsoft</a>, <a href="https://www.schneier.com/tag/windows/" rel="tag">Windows</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html" rel="bookmark">Posted on May 14, 2010 at 11:50 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html#comments">43 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html" data-title="New Windows Attack" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-137770">

			<div class="comment by-ac ">

				<p class="commentcredit">

					<span class="commenter">ac</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137770">
						May 14, 2010 12:03 PM					</a>

				</p>

				<p>&#8220;Nothing detects it right now&#8221;&#8211;not quite true.  Most antivirus software uses kernel hooks, but not all.  Those that do not would be able to detect anything using this attack.  One example of antivirus software that doesn&#8217;t use kernel hooks is Microsoft&#8217;s own Security Essentials.</p>
<p>Nevertheless, this is still a huge deal.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137771">

			<div class="comment by-brandioch-conner ">

				<p class="commentcredit">

					<span class="commenter">Brandioch Conner</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137771">
						May 14, 2010 12:12 PM					</a>

				</p>

				<p>re: &#8220;Nothing detects it right now&#8221;</p>
<p>The exact same phrase can be applied to &#8220;malware&#8221; almost every single day.</p>
<p>Which is why &#8220;anti-virus&#8221; signatures are released almost every single day.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137772">

			<div class="comment by-shane ">

				<p class="commentcredit">

					<span class="commenter">Shane</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137772">
						May 14, 2010 12:19 PM					</a>

				</p>

				<p>WTF @ KHOBE? What&#8217;s next? TYGERWOOD? OURKELLY?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137773">

			<div class="comment by-michael-argast ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.sophos.com' rel='external nofollow ugc' class='url'>Michael Argast</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137773">
						May 14, 2010 12:21 PM					</a>

				</p>

				<p>Bruce &#8211;</p>
<p>I&#8217;m surprised, this almost seems like you&#8217;re giving in to the fearmongering.</p>
<p>The reality of this theoretical attack is a bit more ho-hum. Here&#8217;s a response from Paul Ducklin at Sophos:</p>
<p><a href="http://www.sophos.com/blogs/duck/g/2010/05/11/khobe-vulnerability-earth-shaker/" rel="nofollow ugc">http://www.sophos.com/blogs/duck/g/2010/05/11/khobe-vulnerability-earth-shaker/</a></p>
<p>Yes, it is from an AV company. But still, don&#8217;t believe all the hype being spewed by threat researchers&#8230;</p>
<p>Michael</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137774">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137774">
						May 14, 2010 12:24 PM					</a>

				</p>

				<p>@Michael Argast: &#8220;I&#8217;m surprised, this almost seems like you&#8217;re giving in to the fearmongering.&#8221;</p>
<hr />
<p>I didn&#8217;t get that from the post.  To me it seemed he posted it because it was clever and interesting.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137775">

			<div class="comment by-kurt-wismer ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://anti-virus-rants.blogspot.com' rel='external nofollow ugc' class='url'>kurt wismer</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137775">
						May 14, 2010 12:31 PM					</a>

				</p>

				<p>@HJohn: &#8220;because it was clever and interesting&#8221;</p>
<p>and apparently not particularly new or well informed. see:<br />
<a href="http://www.eset.com/blog/2010/05/11/khobe-wan-these-arent-the-droids-youre-looking-for" rel="nofollow ugc">http://www.eset.com/blog/2010/05/11/khobe-wan-these-arent-the-droids-youre-looking-for</a></p>
<p>it also represents, once again, &#8216;security&#8217; researchers advancing the state of the black arts &#8211; which is not a particularly positive contribution.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137776">

			<div class="comment by-john-jenkins ">

				<p class="commentcredit">

					<span class="commenter">John Jenkins</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137776">
						May 14, 2010 12:34 PM					</a>

				</p>

				<p>The difference is that security researchers publish their results so people can take those results into account when assessing threats.  The &#8220;black arts&#8221; aren&#8217;t particularly black when everyone knows about them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137777">

			<div class="comment by-peri ">

				<p class="commentcredit">

					<span class="commenter">peri</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137777">
						May 14, 2010 12:34 PM					</a>

				</p>

				<p>I agree with Michael Argast. I read about this on Ars:<br />
<a href="http://arstechnica.com/security/news/2010/05/multicore-cpus-move-attack-from-theoretical-to-practical.ars" rel="nofollow ugc">http://arstechnica.com/security/news/2010/05/multicore-cpus-move-attack-from-theoretical-to-practical.ars</a></p>
<p>It doesn&#8217;t apply to security products that don&#8217;t use the SSDT like Microsoft Security Essentials. It also requires malware to have already skipped past your detection and be running code on your machine.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137778">

			<div class="comment by-shane ">

				<p class="commentcredit">

					<span class="commenter">Shane</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137778">
						May 14, 2010 12:38 PM					</a>

				</p>

				<p>@kurt</p>
<p>&#8220;it also represents, once again, &#8216;security&#8217; researchers advancing the state of the black arts &#8211; which is not a particularly positive contribution.&#8221;</p>
<p>Easily one of the most ignorant statements I&#8217;ve ever read here.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137779">

			<div class="comment by-kent ">

				<p class="commentcredit">

					<span class="commenter">Kent</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137779">
						May 14, 2010 12:40 PM					</a>

				</p>

				<p>It&#8217;s an old Windows attack:</p>
<p><a href="http://www.symantec.com/connect/articles/windows-rootkits-2005-part-one" rel="nofollow ugc">http://www.symantec.com/connect/articles/windows-rootkits-2005-part-one</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137780">

			<div class="comment by-peri ">

				<p class="commentcredit">

					<span class="commenter">peri</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137780">
						May 14, 2010 12:41 PM					</a>

				</p>

				<p>OT: Since I&#8217;m here I thought I would suggest a topic for Friday Squid Blogging:</p>
<p>Colossal Squid a Soft, Sluggish Drifter<br />
<a href="http://news.nationalgeographic.com/news/2010/05/100512-science-animals-colossal-squid-sea-monster/" rel="nofollow ugc">http://news.nationalgeographic.com/news/2010/05/100512-science-animals-colossal-squid-sea-monster/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137781">

			<div class="comment by-fred-p ">

				<p class="commentcredit">

					<span class="commenter">Fred P</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137781">
						May 14, 2010 12:47 PM					</a>

				</p>

				<p>This looks like a small modification of a very old class of attacks. There used to be (and perhaps still is) a similar way to get around CRC checks for programs (have the real one, perform the CRC check on the real program, but execute the other one).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137782">

			<div class="comment by-alans ">

				<p class="commentcredit">

					<span class="commenter">AlanS</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137782">
						May 14, 2010 12:52 PM					</a>

				</p>

				<p>The only surprising thing is that someone figured out a way to make anti-virus even less effective than it already is. That&#8217;s quite an accomplishment.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137783">

			<div class="comment by-larry-seltzer ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://blogs.pcmag.com/securitywatch/' rel='external nofollow ugc' class='url'>larry seltzer</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137783">
						May 14, 2010 12:54 PM					</a>

				</p>

				<p>The matousec guys had a point, but they grossly oversold it. First, it&#8217;s only really an issue on Windows XP. On Vista and Win7 there are APIs which make it unnecessary to hook the SSDT, so the attack is irrelevant. Second, it appears that they didn&#8217;t actually exploit all 35 of those products, they just verified that they hook the SSDT and presumed that they were vulnerable. Some vendors have denied that their own products are actually vulnerable, even on XP.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137784">

			<div class="comment by-peri ">

				<p class="commentcredit">

					<span class="commenter">peri</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137784">
						May 14, 2010 1:01 PM					</a>

				</p>

				<p>@larry seltzer: &#8220;it&#8217;s only really an issue on Windows XP&#8221;</p>
<p>The matousec article disagrees with you:<br />
&#8220;The research was done on Windows XP Service Pack 3 and Windows Vista Service Pack 1 on 32-bit hardware. However, it is valid for all Windows versions including Windows 7.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137785">

			<div class="comment by-kurt-wismer ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://anti-virus-rants.blogspot.com' rel='external nofollow ugc' class='url'>kurt wismer</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137785">
						May 14, 2010 1:03 PM					</a>

				</p>

				<p>@John Jenkins: &#8220;The difference is that security researchers publish their results so people can take those results into account when assessing threats.&#8221;</p>
<p>what one intends to happen and what actually happens are often not the same. the anti-malware field is rife with examples of researchers presenting attack-related research that then goes on to be used in actual attacks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137786">

			<div class="comment by-carl-sai-mitchell ">

				<p class="commentcredit">

					<span class="commenter">Carl &quot;SAI&quot; Mitchell</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137786">
						May 14, 2010 1:04 PM					</a>

				</p>

				<p>It is not known that any malicious software uses this technique, but it&#8217;s perfectly possible that some does. Security researchers demonstrating this provide users knowledge of which AV products to avoid, thus enhancing security.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137787">

			<div class="comment by-skorj ">

				<p class="commentcredit">

					<span class="commenter">Skorj</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137787">
						May 14, 2010 1:12 PM					</a>

				</p>

				<p>There are enough similar strategies for root kits that this doesn&#8217;t change anything: a good root kit can only be removed from a different system.</p>
<p>The attacks that escalate the threat potential of root kits in an interesting way are virtualization jailbreaks and BIOS attacks &#8211; anything that can infect the &#8220;clean&#8221; system while it&#8217;s being used to remove a root kit, if the &#8220;clean&#8221; system shares the physical hardware of the infected system.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137788">

			<div class="comment by-mv ">

				<p class="commentcredit">

					<span class="commenter">mv</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137788">
						May 14, 2010 1:25 PM					</a>

				</p>

				<p>Giving it a new name doesn&#8217;t make it a new attack.<br />
it is basically a time-of-check-to-time-of-use (TOCTTOU) flaw as described 14 years ago by Matt Bishop and Michael Dilger</p>
<p><a href="http://seclab.cs.ucdavis.edu/projects/vulnerabilities/scriv/1996-compsys.pdf" rel="nofollow ugc">http://seclab.cs.ucdavis.edu/projects/vulnerabilities/scriv/1996-compsys.pdf</a></p>
<p>Andrey Kolishak showed 7 years ago that Windows hooks are vunerable to TOCTTOU</p>
<p><a href="http://seclists.org/bugtraq/2003/Dec/351" rel="nofollow ugc">http://seclists.org/bugtraq/2003/Dec/351</a></p>
<p>So not only the method is old, but even using it on Windows hooks is old.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137789">

			<div class="comment by-grymoire ">

				<p class="commentcredit">

					<span class="commenter">Grymoire</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137789">
						May 14, 2010 1:35 PM					</a>

				</p>

				<p>The AV vendors say it&#8217;s not a problem because you  have to have the virus on the computer in order to bypass the virus check.</p>
<p>What if the malware is on a read-only file system (e.g. CD-ROM)?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137790">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137790">
						May 14, 2010 2:04 PM					</a>

				</p>

				<p>@Grymoire: &#8220;What if the malware is on a read-only file system (e.g. CD-ROM)?&#8221;</p>
<hr />
<p>Well, it obviously can&#8217;t delete or heal the source file(s) of the malware, but it certainly can prevent it from executing.  As long as CDs have been around, I can&#8217;t imagine any AV worth a nickel that would not be able to handle CDs.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137791">

			<div class="comment by-alans ">

				<p class="commentcredit">

					<span class="commenter">AlanS</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137791">
						May 14, 2010 2:42 PM					</a>

				</p>

				<p>Why would cyber criminals be bothered going to the trouble of using this exploit if the detection rate of new malware in only 20%?</p>
<p>Anti-virus is reactive security that&#8217;s always playing catchup. But criminals are adapting faster and only need a small window of opportunity. So by the time anti-virus has caught up with the latest malware the credentials and money have already gone and there&#8217;s new malware in place.</p>
<p>Anti-virus is to computer security what the TSA is to airport security. They are always responding to what just happened.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137792">

			<div class="comment by-alex-eckelberry ">

				<p class="commentcredit">

					<span class="commenter">alex eckelberry</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137792">
						May 14, 2010 2:57 PM					</a>

				</p>

				<p>There is quite a bit of disinformation and hype on this particular &#8220;exploit&#8221;.</p>
<p>As many have stated, the exploit requires malware to get on your machine and execute first.  This is not some exploit that you can get by visting some website.  In this context, I don&#8217;t really see how it&#8217;s theoretically different than the many current methods that malware uses to disable antivirus products.</p>
<p>To Larry Seltzer&#8217;s point, SSDT hooking is not needed in newer OSs like Vista and Windows 7, but on older OSs like Windows XP.  Some antivirus products may still use SSDT, but they don&#8217;t need to.</p>
<p>Matousec grossly exaggerates:<br />
&#8220;We have performed tests with [most of] today&#8217;s Windows desktop security products&#8230;The results can be summarized in one sentence: If a product uses SSDT hooks or other kind of kernel mode hooks on similar level to implement security features it is vulnerable. In other words, 100% of the tested products were found vulnerable.&#8221;</p>
<p>So basically he installed the products and checked to see if they hooked SSDT and really did not care why the product hooked SSDT, and then called them vulnerable. His own write up he says only some parameters can be swapped out for new stuff (pointers to data, some handles), not all parameters.</p>
<p>Yes the technique is a viable attack but that does not mean all security products that hook SSDT or other kernel objects are vulnerable. It heavily depends on how the hooks are being used by the security software, how the software blocks bad stuff, and which parameters of the hook functions the software cares about.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137793">

			<div class="comment by-rookie ">

				<p class="commentcredit">

					<span class="commenter">Rookie</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137793">
						May 14, 2010 3:13 PM					</a>

				</p>

				<p>@AlanS  “Anti-virus is to computer security what the TSA is to airport security. They are always responding to what just happened”</p>
<p>Yes, AV software is reactive and everybody’s favorite whipping boy.  But it does do the job for the 99.9% of the users who haven’t been infected yet with the new malware before they get the updates.</p>
<p>There seems to be a tendency to slam security processes and systems that don’t work with 100% efficiency, but I think many people, especially those that are not in the trenches struggling to keep a corporate network running on a day-to-day basis, are much too quick to “let the perfect be the enemy of the good”.  (I would venture to say the same is true for airport security.)</p>
<p>If 100% of the users on the Internet would have up-to-date AV software, the Internet would be a safer place, despite AV’s shortcomings.  If you want to run your network on the Internet without malware protection, be my guest.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137794">

			<div class="comment by-joe-dietz ">

				<p class="commentcredit">

					<span class="commenter">Joe Dietz</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137794">
						May 14, 2010 4:02 PM					</a>

				</p>

				<p>Um this is 3 year old research, <em>and</em> the only reason Msft security essentials is absent from the list is because they don&#8217;t implement tamper resistance.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137795">

			<div class="comment by-alans ">

				<p class="commentcredit">

					<span class="commenter">AlanS</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137795">
						May 14, 2010 4:13 PM					</a>

				</p>

				<p>@Rookie</p>
<p>Last year Trusteer estimated detection rates for Zeus at 23%. Some one at Cisco just did some tests and found the initial detection of new malware samples around 20%. That&#8217;s a very long way from 100% efficiency.</p>
<p>I am not slamming anti-virus as much as the perception of what anti-virus can accomplish. The seriousness of this &#8216;new exploit&#8217; plays on it accomplishing much more than it does. I run antivirus; the free products don&#8217;t have to accomplish much to have a good cost/benefit.</p>
<p>And as far as doing the &#8220;job for the 99.9% of the users who haven’t been infected yet&#8221; that ignores targeting. If you have something worth defending (e.g. you work in your company&#8217;s accounting department) you are much more likely to be in that initial 0.1%.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137796">

			<div class="comment by-aikimark ">

				<p class="commentcredit">

					<span class="commenter">aikimark</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137796">
						May 14, 2010 4:13 PM					</a>

				</p>

				<p>Vendor responses:</p>
<p>Sunbelt:<br />
&#8220;The &#8220;Earthquake&#8221; exploit is largely overblown hype, and has been around for many years.</p>
<p>First, in order for this particular &#8220;exploit&#8221; to actually work, malware has to already be ON THE PERSON&#8217;S MACHINE (in other words, the person&#8217;s PC is already pwned). In addition, it&#8217;s a big piece of code that has to be used to make this thing work.</p>
<p>Secondly, it would affect antivirus programs that use SSDT. Sunbelt doesn&#8217;t use SSDT in VIPRE for Windows Server 2008, Vista and Windows 7. We do use it for older operating systems, like Windows XP.</p>
<p>Third, there are no exploit kits available that we know of that use this exploit.</p>
<p>Finally, actually getting this exploit to really work in the real world is not trivial. Antivirus vendors have understandably been a little peeved by this artificial firestorm. We wrote about it here in our blog:&#8221;<br />
<a href="http://sunbeltblog.blogspot.com/2010/05/matouseccom-bait-and-switch.html" rel="nofollow ugc">http://sunbeltblog.blogspot.com/2010/05/matouseccom-bait-and-switch.html</a></p>
<p>Other vendor responses:<br />
<a href="http://www.thetechherald.com/article.php/201019/5611/Security-vendors-respond-to-Matousec-research" rel="nofollow ugc">http://www.thetechherald.com/article.php/201019/5611/Security-vendors-respond-to-Matousec-research</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137797">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137797">
						May 14, 2010 4:30 PM					</a>

				</p>

				<p>@AlanS: &#8220;I am not slamming anti-virus as much as the perception of what anti-virus can accomplish. The seriousness of this &#8216;new exploit&#8217; plays on it accomplishing much more than it does. I run antivirus; the free products don&#8217;t have to accomplish much to have a good cost/benefit. &#8221;</p>
<hr />
<p>I totally agree with you.  There is no holy grail in security.</p>
<p>I too run anti-virus to protect against what we know is a risk, especially if its a quality free product, there is little reason not to.  (especially when I share my home computer with non-tech-savvy users).  I also use its heuristics engine to give a bit of protection for what isn&#8217;t known.</p>
<p>I also take some reasonable steps against unknown threats.  My computer is behind two firewalls set as high as they&#8217;ll work.  I have to give a program permission to use the Internet.  I don&#8217;t run web facing apps as Admin (save for security updates), I block new programs from being added to startup, use a decent web browser configured as secureity as I can.</p>
<p>Probably most importantly, i backup frequently.  That doesn&#8217;t prevent malware exploits, but if my system is every compromised I have the option of reformating it without losing everything.</p>
<p>Perfect?  No, but I&#8217;m probably in good shape.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137798">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137798">
						May 14, 2010 5:04 PM					</a>

				</p>

				<p>@ AlanS, Rookie, HJohn,</p>
<p>The big problem with AV is not that it detects less than 20% of even quite old attacks, but the amount of bandwidth it consumes.</p>
<p>It uses a rather broken business model to distribute it&#8217;s wares and because of this it is stuck in a 1980&#8217;s mindset.</p>
<p>If we had an outbound internet charge, I think you would find AV software would rather rapidly evolve for the better (likewise several major software vendors code).</p>
<p>It is getting to the point where a substantial % of internet traffic is taken up with AV and security updates &#8220;freeloading&#8221; at others expense and actually remaininnng stuck in an outmoded thought model.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137799">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137799">
						May 14, 2010 11:38 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>Actually, the AV industry uses a very good business model. It&#8217;s why they are still in business after peddling crap for so long. The real problem is the security model. The mainstream OS&#8217;s don&#8217;t enforce POLA well and basically act like an admin/kernel mode interpreter for malicious apps in many ways.</p>
<p>A better security model would use a strong kernel, layered/modular design, and execute-only as the default TCB mode (controlled updates via different, restrictive mode). At the very least, the security-critical functions must be non-bypassable and resist being disabled/overwritten. This defeats malware attacking at the OS level and allows other applications to leverage OS security to achieve application security. This sort of assurance exists in defense platforms like XTS-400/STOP or INTEGRITY Workstation, but not in mainstream OS&#8217;s.</p>
<p>The short version: instead of closing doors and requiring credentials to get in, mainstream OS&#8217;s leave them open while relying on hungover, sleep-deprived security guards to identify malice by gut instinct. The results are predictable.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137800">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137800">
						May 15, 2010 1:34 AM					</a>

				</p>

				<p>Nick P,</p>
<p>You are quite correct the AV / security model used is crap and that is the visable problem.</p>
<p>However I contend it&#8217;s the busniess model that stops them evolving a new security model.</p>
<p>Look at it this way, if say MS had to pay outbound data charges for &#8220;patch Tuesday&#8221; how much would it cost them?</p>
<p>Currently &#8220;patch Tuesday&#8221; is a less costly business model for MS than supplying a secure OS, so there is no direct financial consideration to make them jump out of the mindset.</p>
<p>It&#8217;s not just MS but all the big industry players.</p>
<p>If they had to pay for their mistakes via outbound data charges then they would fairly quickly develop a less costly business model. One of which would be to actually fix the problems.</p>
<p>Other models would include making the end user pay a download subscription charge to cover the data charges, however you would fairly rapidly hear a scream of discontent by the end users as this anual charge could be more than the OS costs retail&#8230;</p>
<p>The AV business model is likewise broken and mobile broadband is beginning to show this to users as they seen not just their limited bandwidth but limited data alowance get chewed up daily by AV updates and MS and others &#8220;mega patches&#8221;.</p>
<p>We are getting close to a tipping point where the amount of AV and mega patch traffic on the Internet is larger than the traffic from malware etc. to the point it is not sustainable.</p>
<p>And people will fairly soon see the likes of MS &amp; Co as being &#8220;good for nothing freeloaders&#8221; rather than being a &#8220;responsable and profesional organisation&#8221;.</p>
<p>The evolutionary step that was QA was forced on FMCE manufactures by the asymetric costs of warranty returns obliterating profits.</p>
<p>It is time we saw the same costs being bourn not by the end user but by the manufacturer in an obvious manner not the way it is currently hidden away.</p>
<p>However I&#8217;m not sugesting outbound data charges are a good thing, because they would criticaly effect FOSS.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137801">

			<div class="comment by-ben ">

				<p class="commentcredit">

					<span class="commenter">Ben</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137801">
						May 15, 2010 5:25 AM					</a>

				</p>

				<p>@Clive Robinson</p>
<p>I think you will find that MS do have to pay data charges for Patch Tuesday, as well as run a lot of servers and a large security team.</p>
<p>I agree that AV, being based on enumerating badness, is fundamentally incapable of providing a complete solution.</p>
<p>Unfortunately it is no more possible to enumerate goodness.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137802">

			<div class="comment by-alans ">

				<p class="commentcredit">

					<span class="commenter">AlanS</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137802">
						May 15, 2010 9:17 AM					</a>

				</p>

				<p>Another big issue with anti-virus is that users with unreasonable expectations of the protection it offers have an excuse for being lazy and not doing all the stuff they should be doing: keeping up with OS and application patches, not running as admin unless necessary, turning on DEP for all applications, configuring apps like Adobe Reader to run securely, not doing crazy user things, etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137803">

			<div class="comment by-peter ">

				<p class="commentcredit">

					<span class="commenter">Peter</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137803">
						May 15, 2010 10:11 AM					</a>

				</p>

				<p>Comments from Microsoft EMEA Chief Security Advisor&#8230; <a href="http://www.halbheer.info/security/2010/05/12/the-khobe-8-0-earthquake-whats-behind-it" rel="nofollow ugc">http://www.halbheer.info/security/2010/05/12/the-khobe-8-0-earthquake-whats-behind-it</a> .</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137804">

			<div class="comment by-nostromo ">

				<p class="commentcredit">

					<span class="commenter">Nostromo</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137804">
						May 16, 2010 3:53 AM					</a>

				</p>

				<p>@alex eckelberry<br />
&#8216;As many have stated, the exploit requires malware to get on your machine and execute first. This is not some exploit that you can get by visting some website&#8217;</p>
<p>Just one word: ActiveX.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137805">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137805">
						May 16, 2010 10:26 AM					</a>

				</p>

				<p>@ Nostromo on ActiveX</p>
<p>&#8220;Listen to me Bobby! You stay away from that technology! That technology is the Devil!!!&#8221; (source: possibly Waterboy)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137806">

			<div class="comment by-mashiara ">

				<p class="commentcredit">

					<span class="commenter">mashiara</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137806">
						May 16, 2010 3:18 PM					</a>

				</p>

				<p>Ref outbound data charges: I&#8217;m fairly sure anyone who handles the amount of traffick we&#8217;re speaking about here is certainly paying for the outbound data in multitude of ways.</p>
<ol>
<li>Staff and equipment</li>
<li>If they&#8217;re big enough they have peering agreements if not they will pay through the proverbial nose for the bandwidth (these are not you 500% oversubscribed &#8220;best effort&#8221; consumer lines but proper guaranteed bandwidth, priced accordingly&#8230;), it&#8217;s possible to negotiate all kinds of peak and average transfer packages (either &#8220;flat rate&#8221; for a certain guaranteed bandwidth [which is priced on the assumption that it <em>will</em> be run at almost saturation <em>all the time</em>], or per GB charge and a guaranteed minimum and available peak bandwidth, or a combination&#8230;).</li>
</ol>
<p>Even my &#8220;home&#8221; (I run some devel servers here) line, a measly 4/4mbit (but proper, dedicated bandwidth), costs 8-10 times more than &#8220;10/1mbit&#8221; consumer offerings. If I was running it at full throttle 24/7 both ways I would get a decent price of ~12eurocents/GB  (I have no idea what the per GB costs for my ISP are but propably not less than 5eurocents). At the moment I&#8217;m not saturating the line 24/7 so my ISP gets better than expected profit out of me. OTOH I like the predictable price, besides I&#8217;m not sure they&#8217;d be willing to negotiate a good per/GB price for such small volume.</p>
<p>Ref signatures: I&#8217;m fairly sure all the major AV producers have used (also) heuristics-based engines for 15 years now (at least F-Secure has&#8230;) and in the last 5 years behaviour-based engines are becoming more common (again, at least FSC has one).</p>
<p>Full disclosure: I used to work for F-Secure 10 years ago (hell, it&#8217;s been a while), before joining a friends startup (still in that company), I try to keep at least somewhat up-to-date on the malware field still.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137807">

			<div class="comment by-craig ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.securityking.com' rel='external nofollow ugc' class='url'>Craig</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137807">
						May 17, 2010 6:17 AM					</a>

				</p>

				<p>As mentioned one of the best protection measures is having a back up of your system, and if compromised reinstallation, annoying but effective.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137808">

			<div class="comment by-eric ">

				<p class="commentcredit">

					<span class="commenter">Eric</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137808">
						May 17, 2010 10:52 AM					</a>

				</p>

				<p>Clive: While the points you raise are valid, I&#8217;ve never seen a study suggesting that update traffic is anything more than a tiny blip on the radar of overall internet traffic.</p>
<p>Heck, my daily AV updates are a few kilobytes in size. The picture of Bruce&#8217;s book on this page is worth a month&#8217;s worth of AV updates by itself.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137809">

			<div class="comment by-alex-eckelberry ">

				<p class="commentcredit">

					<span class="commenter">alex eckelberry</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137809">
						May 17, 2010 1:53 PM					</a>

				</p>

				<p>Incidentally, there is this twist to add to the story:</p>
<p><a href="http://blog.gdatasoftware.com/overview/article/1654-khobe-no-problem.html" rel="nofollow ugc">http://blog.gdatasoftware.com/overview/article/1654-khobe-no-problem.html</a></p>
<p>The &#8220;pay for play&#8221; aspect.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137810">

			<div class="comment by-mark ">

				<p class="commentcredit">

					<span class="commenter">mark</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137810">
						May 18, 2010 3:34 PM					</a>

				</p>

				<p>Ugh, how is this any deal at all and how does hooking into SSDT not require admin rights? I guess either me or everybody else is missing the point &#8211; it requires the machine to be infected first&#8230; hello??? if I manage to have infected your machine already, why bother evading the AV, I&#8217;m already in!<br />
The author of the article clear does not understand how security works.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-137811">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137811">
						May 20, 2010 1:41 PM					</a>

				</p>

				<p>Just a thought,</p>
<p>If this attack is dependent on &#8220;malware&#8221; being present on the machine&#8230;</p>
<p>How about a decapitated botnet.</p>
<p>When you take out the control node by altering the DNS etc (ie a take down) you leave all the infected machines out there&#8230;</p>
<p>Now let&#8217;s assume the Zeus net writer decides to put the next release of the bot net code in a format that allows this attack as a secondary attack vector&#8230;</p>
<p>It has been shown that Zeus is capable of infecting millions of machines quite easily most of which have not been cleaned up&#8230;</p>
<p>Thus potentialy there are a large number of targets already out there&#8230;</p>
<p>As I said just a thought.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-137812">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/#comment-137812">
						May 20, 2010 1:58 PM					</a>

				</p>

				<p>@ Ben,</p>
<p>Whilst I might agree that you cannot enumerate goodness you can certainly see badness in many cases. Thus the two are not logiical inverses of each other.</p>
<p>For many years AV worked on examining data V code against known signatures, however malware writers worked out how to hide by making what are random signitures for each instance.</p>
<p>There is a solution to this which is putting the code in a restricted environment where calls to I/O etc are checked by a hypervisor etc.</p>
<p>whilst far from perfect is still way better than just pattern matching. However it also has attendant risks in that you have passed control of the CPU to the rouge code and it may have exploit tricks the hypervisor might not detect. This is effectivly the same as code with out a known matching pattern so is not realy any more dangerous than existing AV systems.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2010/05/new_windows_att.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2010/05/new_windows_att.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F05%2Fnew_windows_att.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2010/05/new_windows_att.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='3397' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2010/05/fifth_annual_mo_1.html" rel="prev">← Fifth Annual Movie-Plot Threat Contest Semi-Finalists</a>		<a href="https://www.schneier.com/blog/archives/2010/05/i_won_the_cso_c.html" rel="next">I Won a CSO Compass Award →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
