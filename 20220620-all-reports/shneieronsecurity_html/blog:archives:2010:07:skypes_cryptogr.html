<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Skype&#039;s Cryptography Reverse-Engineered - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Skype&#039;s Cryptography Reverse-Engineered Comments Feed" href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/3493" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=3493' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F07%2Fskypes_cryptogr.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F07%2Fskypes_cryptogr.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-3493 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-3493" class="post-3493 post type-post status-publish format-standard hentry category-uncategorized tag-cryptography tag-obscurity tag-secrecy tag-skype tag-voip">

	<div class="article">

		<h2 class="entry">Skype&#039;s Cryptography Reverse-Engineered</h2>
		<p>Someone <a href="http://techcrunch.com/2010/07/08/skypes-innermost-security-layers-claimed-to-be-reverse-engineered/">claims</a> to have reverse-engineered Skype&#8217;s proprietary encryption protocols, and has <a href="http://www.enrupt.com/index.php/2010/07/07/skype-biggest-secret-revealed">published</a> pieces of it.</p>
<p>If the crypto is good, this is less of a big deal than you might think.  Good cryptography is designed to be made public; it&#8217;s only for business reasons that it remains secret.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/obscurity/" rel="tag">obscurity</a>, <a href="https://www.schneier.com/tag/secrecy/" rel="tag">secrecy</a>, <a href="https://www.schneier.com/tag/skype/" rel="tag">Skype</a>, <a href="https://www.schneier.com/tag/voip/" rel="tag">VoIP</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html" rel="bookmark">Posted on July 16, 2010 at 12:08 PM</a>			•
			<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html#comments">25 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html" data-title="Skype&#039;s Cryptography Reverse-Engineered" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-142087">

			<div class="comment by-spider ">

				<p class="commentcredit">

					<span class="commenter">Spider</span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142087">
						July 16, 2010 12:41 PM					</a>

				</p>

				<p>Its a modified version of RC4, right?</p>
<p>Then its likely to suffer the same fundamental flaws, including the weak key schedule. So, as long as they learned their lessons from the WEP cracking and didn&#8217;t simply concatenate the key and nonce together, it might be okay.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-142088">

			<div class="comment by-shai-machnes ">

				<p class="commentcredit">

					<span class="commenter">Shai Machnes</span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142088">
						July 16, 2010 12:44 PM					</a>

				</p>

				<p>Encryption that is hidden is rarely good.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-142089">

			<div class="comment by-aidan ">

				<p class="commentcredit">

					<span class="commenter">aidan</span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142089">
						July 16, 2010 12:52 PM					</a>

				</p>

				<p>Given the quality of their desktop app, I wouldn&#8217;t like to rely on them following best practices.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-142090">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142090">
						July 16, 2010 1:20 PM					</a>

				</p>

				<p>As is normmal for me it&#8217;s not the actual crypto that worries me it&#8217;s the nitty gritty implementation details.</p>
<p>Afterall it is not unknown for initial &#8220;negotiation&#8221; or hand shake protocols to drop transparently to the lowest common denominator, which in some past systems has been plain text&#8230;</p>
<p>_he devil is always in the details and rarely do you get to see those details as it requires &#8220;full Open Source disclosure&#8221; to achive&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-142091">

			<div class="comment by-monosonic ">

				<p class="commentcredit">

					<span class="commenter">monosonic</span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142091">
						July 16, 2010 1:36 PM					</a>

				</p>

				<p>is it any good? what can be said about it?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-142092">

			<div class="comment by-snark ">

				<p class="commentcredit">

					<span class="commenter">snark</span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142092">
						July 16, 2010 1:49 PM					</a>

				</p>

				<p>whether or not it&#8217;s a big deal depends on what you wish to do with it. oss client, perhaps.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-142093">

			<div class="comment by-lan ">

				<p class="commentcredit">

					<span class="commenter">Lan</span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142093">
						July 16, 2010 2:24 PM					</a>

				</p>

				<p>The Skype algorithm was reverse engineered by some guys at MSR about 2 years ago. They reported the fact to Skype at the time and also presented their findings at an FTE-only event. I don&#8217;t know whether the algorithm has been improved since then. It was definitely &#8220;security by obscurity&#8221; rather than a real crypto solution, albeit an extremely elaborate one.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-142094">

			<div class="comment by-milan ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.sindark.com' rel='external nofollow ugc' class='url'>Milan</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142094">
						July 16, 2010 3:13 PM					</a>

				</p>

				<p>Maybe this will help answer the question of whether Skype has built in any backdoors, to help out people like the NSA and GCHQ who want to intercept conversations.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-142095">

			<div class="comment by-milan ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.sindark.com' rel='external nofollow ugc' class='url'>Milan</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142095">
						July 16, 2010 3:19 PM					</a>

				</p>

				<p>Of course, if the NSA wants to listen to your calls, they can probably just slip a rootkit into your machine that captures the audio and forwards it to them covertly, regardless of what sort of encryption is used in transit.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-142096">

			<div class="comment by-er ">

				<p class="commentcredit">

					<span class="commenter">ER</span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142096">
						July 16, 2010 3:24 PM					</a>

				</p>

				<p>I&#8217;m still waiting to see if someone will analyze the key schedule for the RC4 cipher.  I thought I heard that it was customized, so hopefully they improved it.</p>
<p>But improving cryptography is hard, so it will be interesting to see if they did it correctly.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-142097">

			<div class="comment by-renato-golin ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.systemcall.org/' rel='external nofollow ugc' class='url'>Renato Golin</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142097">
						July 16, 2010 3:59 PM					</a>

				</p>

				<p>Elaborate were all the means they used to hide the true algorithm.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-142098">

			<div class="comment by-mike ">

				<p class="commentcredit">

					<span class="commenter">Mike</span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142098">
						July 16, 2010 5:39 PM					</a>

				</p>

				<p>If the presentation by Philippe Biondi and Fabrice Desclaux from BlackHat 2006 (Silver Needle in the Skype[1]) is accurate, then this isn&#8217;t the encryption used in the Skype protocol, but merely the seed expansion function to provide a key stream used for obfuscation (slide 42).  They used Skype itself as an oracle, and were able to read the de-obfuscated packets, but I think that encryption (based on AES if Tom Berson&#8217;s report is to believed) is used <em>inside</em> the obfuscated stream (see slide 50&#8217;s mention of almost everything being ciphered and the Enc block&#8217;s position in the diagram).</p>
<p>It will be interesting to see their talk at CCC in December.</p>
<p>[1] <a href="http://www.secdev.org/conf/skype_BHEU06.pdf" rel="nofollow ugc">http://www.secdev.org/conf/skype_BHEU06.pdf</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-142100">

			<div class="comment by-roger ">

				<p class="commentcredit">

					<span class="commenter">Roger</span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142100">
						July 17, 2010 7:21 PM					</a>

				</p>

				<p>The Skype <em>protocol</em> ago was reverse engineered some time and is discussed in many places, including two reasonably detailed articles on Wikipedia. This publication is about additional detail in a particular layer, called the obfuscation layer.</p>
<p>This publication does <em>not</em> affect voice and video data, which are encrypted under AES-256 using a unique session key set up by asymmetric cryptography. This part of the protocol has been analysed and so far to date, it seems sound. What is affected here is the &#8220;obfuscation layer&#8221;. Other than voice and video data, <em>all</em> other data exchanged between Skype servers and peers is obfuscated by RC4. It is obfuscation rather than encryption because the key is derived from externally observable data, but the derivation uses an unknown algorithm. What seems to have been published here &#8212; and it remains to be verified &#8212; is the key derivation algorithm for the obfuscation layer.</p>
<p>What this means is that it may now be easier for an attacker to interfere with call control. I would speculate that worst case might be an attack which simultaneously causes many calls to disconnect. Possibly &#8212; and this is rampant speculation here, I don&#8217;t known anything like enough about the protocol to be know if this is possible &#8212; an attacker might be able to re-reroute call set-ups to pass through his supernode, so he can tell when and how often a pair of clients connect. A sort of Skype pen register, if you will. However he won&#8217;t be able to intercept the calls themselves, and would&#8217;t be able to listen in even if he could.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-142101">

			<div class="comment by-robert ">

				<p class="commentcredit">

					<span class="commenter">Robert</span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142101">
						July 19, 2010 4:07 AM					</a>

				</p>

				<p>@Roger,<br />
 good explanation, however the implied call security, due to AES encryption, assumes that the attacker would even bother trying to brute force AES. I&#8217;ve always assumed a side channel attack or an attack on the key exchange protocol.</p>
<p>I&#8217;ve always assumed that a simple trick like intentionally jittering the packet launch and encoding the voice information in the packet launch jitter would work well to defect Skype encryption.  I assume this launch jitter can be achieved with a simple worm.</p>
<p>The trick would be to maintain the jitter throughout the routing network.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-142102">

			<div class="comment by-leuk_he ">

				<p class="commentcredit">

					<span class="commenter">leuk_he</span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142102">
						July 19, 2010 5:06 AM					</a>

				</p>

				<p>Anyone can join the skype p2p network. But everyone i a p2p network will have to ibide to the protocols used. If there is a roque client they can do all kind of mishaps that is hard to protect against. Spam will be the most visible one. Now you could make the network more resistent by checking all other nodes you connect to, but this is not easy.</p>
<p>It is much simple to obfuscate the protocol, so thirth party apps can not join the p2p, and only well-behaved apps can access the p2p network via the API.</p>
<p>Again, protecting a p2p network against deliberate abuse has very little to do with encryption, and much more with network protocols.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-142103">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142103">
						July 19, 2010 6:59 AM					</a>

				</p>

				<p>@ Robert,</p>
<p>&#8220;[Against AES] I&#8217;ve always assumed a side channel attack or an attack on the key exchange protocol&#8221;</p>
<p>When it comes to AES and side channels on modern CPU&#8217;s it is effectivly broken.</p>
<p>There are several ways by which it can be attacked and the solution is the old TEMPEST &#8220;clock the inputs and clock the outputs&#8221;.</p>
<p>You can read a bit more &#8220;general purpose&#8221; reading on it in the IEE &#8220;crypto corner&#8221; article by Nate Taylor at,</p>
<p><a href="http://www.rootlabs.com/articles/IEEE_SideChannelAttacks.pdf" rel="nofollow ugc">http://www.rootlabs.com/articles/IEEE_SideChannelAttacks.pdf</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-142104">

			<div class="comment by-sasha-van-den-heetkamp ">

				<p class="commentcredit">

					<span class="commenter">Sasha van den Heetkamp</span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142104">
						July 19, 2010 10:58 PM					</a>

				</p>

				<p>Skype&#8217;s using the Win CryptoApi, no big deal here, already known. Move along.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-142105">

			<div class="comment by-robert ">

				<p class="commentcredit">

					<span class="commenter">Robert</span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142105">
						July 20, 2010 12:01 AM					</a>

				</p>

				<p>@Clive<br />
 Thanks for linking the article, this is exactly what I&#8217;m talking about.</p>
<p>The advantage of side channel attacks is that they can also defeat all the firewalls and other impediments that the system / user might create, to protect the information stream.  As far as the system is concerned there is only one process communicating with the external world, of course, unbeknown to the user,  their desired comms channel contains a buried covert channel.</p>
<p>I was actually suggesting a variant of a timing attack, which you allude too by reference to the old Tempest axiom &#8220;clock the input clock the outputs&#8221;<br />
However what is missing from this axiom is that the clock must be guaranteed stable at 1/10 information density of the application to be protected. For properly protecting voice this implies a very stable source, with vibration and temp protection = very expensive (test instrument quality clock)</p>
<p>This is something that is ALWAYS overlooked by the young guys, especially wrt voice encryption.  I&#8217;ve seen someone implement clocked I/O  and than allow FIFO fails on the I/O buffer section. He even accused me of &#8220;cheating&#8221; when I constructed parallel process to force FIFO fails. Naturally the covert channel was encoded in the FIFO fails. System meet all Tempest requirements but still leaked information.</p>
<p>In the end analysis, the problem of securing voice comms, is the incredibly low information density of real Voice communication. So any time that the communications channel bandwidth / noise ratio substantially exceeds the Shannon link criteria (wrt the real voice information density) you must assume the possibility of a covert sub channel.</p>
<p>Typically voice communications only have between 10bps and 100bps actual information. So all good secure comms systems will try to encode voice with a codec requiring less than 1000bps.  Skype does exactly the opposite preferring to get greater voice fidelity by using a very high bit rate encoder.  Burying an undetectable 100bps covert channel in a 1000bps (Shannon limited) comms channel is extremely difficult. However burying 100bps in a 64Kbps stream, flowing over a 10Mbps comms channel is absolutely trivial.</p>
<p>Of course, I can always base my voice security decision on the, wondrous mathematics of modern cryptography,  and assume that the NSA (GCHQ) know less about covert comms channels than I do&#8230;&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-142106">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142106">
						July 20, 2010 3:45 AM					</a>

				</p>

				<p>@ Robert,</p>
<p>&#8220;However what is missing from this axiom is that the clock must be guaranteed stable at 1/10 information density of the application to be properly protected.&#8221;</p>
<p>True(ish) for a side channel that leaks data accidently (but I would put the divide rate higher, and as we are talking voice and possibly just phonem envolopes at 3 or 4 a second so we are looking at milli Hz stability.</p>
<p>With a covert channel it depends on the infomation density that the &#8220;attacker is trying to leak and that could be just a master key at one or two bits a minute (the majority of voice calls don&#8217;t need to be monitored in real time more than 99% of them not even within an hour&#8230;) Usually the routing information is more urgent than the content.</p>
<p>All of which means the old axiom of clock the inputs and clock the outputs only works so far.</p>
<p>Another two axioms that help are &#8220;fail hard&#8221; and &#8220;fail long&#8221;. That is on any timing error assume it&#8217;s a covert channel and close both the communications signal and control channels. Don&#8217;t ever try and correct any timing error as this as you noted gives rise to an external attack.</p>
<p>Importantly don&#8217;t try and re-establish coms for a long period which needs to be atleast semi-random in duration. It should also be known what this back off duration is to both ends to remove another covert channel issue.</p>
<p>Now I know that Skype is not going to do either of those simply because it negativly impacts the users view of the quality of the service.</p>
<p>Another EmSec axiom people realy realy should remember is &#8220;data should be constant in all channels&#8221;.</p>
<p>For instance if you use compression it gives away the envolope of voice comms which some older musicians may remember is all a vocoder uses to make a violin not just weep but talk as well 😉</p>
<p>Therefore you have to rate stuff back to a higher data rate, and again you have to be very carefull how you do that. Simply because it&#8217;s fraut with side channels not just in the comms signal channel but in the control channel as well (no point taking the envelope out of the signal channel if your &#8220;data stuffing&#8221; &#8220;signalling method&#8221; reproduces it in the comms control channel).</p>
<p>Which for side channels implies as you say,</p>
<p>&#8220;For properly protecting voice this implies a very stable source, with vibration and temp protection = very expensive (test instrument quality clock)&#8221;</p>
<p>Which is effectivly impractical to do even with modern mobile phone Xtals.</p>
<p>However it&#8217;s worse, it cannot be done for covert channels as I said they might leak data at millibit rates.</p>
<p>The solution to this is to deliberatly introduce &#8220;jitter&#8221; into the system effectivly you spread spectrum modulate the clocking in and clocking out clock at a rate just below the bottom of the audio band. The spreading code needs however to be highly nonlinear and known to both ends of the channel. This then effectivly encrypts any low bandwidth timing based covert channel to an external entity. It also has other advantages as the CCITT have shown for years with &#8220;channel whitening&#8221; with short LFBS&#8217;s to spread the energy across the channel bandwidth.</p>
<p>Oh and this clocking in clocking out and spreader needs to be fully independent of anything else&#8230;</p>
<p>It also has another use in that it shows if either party is moving and if somebody is trying to time remodulate the signal post output clocking etc &#8230;</p>
<p>Oh and of course there are other wrinkles that need to be ironed out as I often say &#8220;the devil is in the details&#8221; &gt;;}</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-142107">

			<div class="comment by-jonadab-the-unsightly-one ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mistersanity.blogspot.com' rel='external nofollow ugc' class='url'>Jonadab the Unsightly One</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142107">
						July 23, 2010 6:10 AM					</a>

				</p>

				<blockquote><p>
  whether or not it&#8217;s a big deal depends on<br />
  what you wish to do with it. oss client, perhaps.
</p></blockquote>
<p>One that actually works, perhaps, in the sense of &#8220;playing nice&#8221; on a desktop where the user wants to be able to play sound from other applications too?  Maybe even one that works with esd <em>and</em> Pulse?  Maybe even one that respects the system-wide color settings?</p>
<p>I know, I know, that&#8217;s crazy talk.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-142108">

			<div class="comment by-ouani ">

				<p class="commentcredit">

					<span class="commenter">Ouani</span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142108">
						December 23, 2010 7:08 AM					</a>

				</p>

				<p>I Think you guys should like this :</p>
<p><a href="http://www.youtube.com/watch?v=9xW-BYayh7w" rel="nofollow ugc">http://www.youtube.com/watch?v=9xW-BYayh7w</a></p>
<p>Seeing a PoC of the protocol reverse engineering, from login to chat !</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-142109">

			<div class="comment by-skype-open-source ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://skype-open-source.blogspot.com/' rel='external nofollow ugc' class='url'>skype open source</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142109">
						June 2, 2011 12:12 AM					</a>

				</p>

				<p>Check this for skype crypto analyze. <a href="http://skype-open-source.blogspot.com/" rel="nofollow ugc">http://skype-open-source.blogspot.com/</a></p>
<p>Its uses RC4 and AES and RSA.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-142110">

			<div class="comment by-skype-open-source ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://skype-open-source.blogspot.com/' rel='external nofollow ugc' class='url'>skype open source</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142110">
						June 8, 2011 9:21 PM					</a>

				</p>

				<p>URGENT: Hacker claims about skype CA private key compromised <a href="http://skype-open-source.blogspot.com/2011/06/some-thoughts.html" rel="nofollow ugc">http://skype-open-source.blogspot.com/2011/06/some-thoughts.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-142111">

			<div class="comment by-delores ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://madchatroulette.com/category/chatroulette/' rel='external nofollow ugc' class='url'>Delores</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142111">
						March 19, 2013 7:59 PM					</a>

				</p>

				<p>If some one wishes expert view about running a blog after that i recommend him/her to pay a quick visit this web site, Keep up the fastidious job.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-142112">

			<div class="comment by-ariel ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.weeklyvolcano.com/community/people/BradleyPr/' rel='external nofollow ugc' class='url'>Ariel</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/#comment-142112">
						April 19, 2013 4:30 AM					</a>

				</p>

				<p>I am extremely inspired with your writing talents as well as with the layout on<br />
your blog. Is this a paid subject matter or did you modify it your self?<br />
Anyway stay up the nice high quality writing, it&#8217;s rare to look a great weblog like this one nowadays..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2010/07/skypes_cryptogr.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2010/07/skypes_cryptogr.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F07%2Fskypes_cryptogr.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2010/07/skypes_cryptogr.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='3493' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2010/07/the_nsas_perfec.html" rel="prev">← The NSA&#039;s Perfect Citizen</a>		<a href="https://www.schneier.com/blog/archives/2010/07/friday_squid_bl_234.html" rel="next">Friday Squid Blogging: Hawaiian Bobtail Squid →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
