<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Internet Quarantines - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Internet Quarantines Comments Feed" href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/3638" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2010/11/quarantine.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=3638' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F11%2Fquarantine.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F11%2Fquarantine.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-3638 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-3638" class="post-3638 post type-post status-publish format-standard hentry category-uncategorized tag-computer-security tag-cost-benefit-analysis tag-essays tag-internet tag-isps tag-malware tag-mitigation">

	<div class="article">

		<h2 class="entry">Internet Quarantines</h2>
		<p>Last month, <a href="http://s.technet.com/b/microsoft_on_the_issues/archive/2010/10/05/the-need-for-global-collective-defense-on-the-internet.aspx">Scott Charney</a> of Microsoft <a href="http://www.bbc.co.uk/go/news/technology-11483008/ext/_auto/-/http://go.microsoft.com/?linkid=9746317">proposed</a> that <a href="http://news.cnet.com/8301-27080_3-10462649-245.html">infected computers</a> be quarantined from the Internet. Using a public health model for Internet security, the idea is that infected computers spreading worms and viruses are a risk to the greater community and thus need to be isolated. Internet service providers would administer the quarantine, and would also clean up and update users&#8217; computers so they could rejoin the greater Internet.</p>
<p>This isn&#8217;t a new idea. Already there are <a href="http://technet.microsoft.com/en-us/network/bb545879.aspx">products</a> that test computers trying to join private networks, and only allow them access if their security patches are up-to-date and their antivirus software certifies them as clean. Computers denied access are sometimes shunned to a limited-capability sub-network where all they can do is download and install the updates they need to regain access. This sort of system has been used with great success at universities and end-user-device-friendly corporate networks. They&#8217;re happy to let you log in with any device you want&#8211;this is the consumerization trend in action&#8211;as long as your security is up to snuff.</p>
<p>Charney&#8217;s idea is to do that on a larger scale. To implement it we have to deal with two problems. There&#8217;s the technical problem&#8211;making the quarantine work in the face of malware designed to evade it, and the social problem&#8211;ensuring that people don&#8217;t have their computers unduly quarantined. Understanding the problems requires us to understand quarantines in general.</p>
<p>Quarantines have been used to contain disease for millennia. In general several things need to be true for them to work. One, the thing being quarantined needs to be easily recognized. It&#8217;s easier to quarantine a disease if it has obvious physical characteristics: fever, boils, etc. If there aren&#8217;t any obvious physical effects, or if those effects don&#8217;t show up while the disease is contagious, a quarantine is much less effective.</p>
<p>Similarly, it&#8217;s easier to quarantine an infected computer if that infection is detectable. As Charney points out, his plan is only effective against worms and viruses that our security products recognize, not against those that are new and still undetectable.</p>
<p>Two, the separation has to be effective. The leper colonies on Molokai and Spinalonga both worked because it was hard for the quarantined to leave. Quarantined medieval cities worked less well because it was too easy to leave, or&#8211;when the diseases spread via rats or mosquitoes&#8211;because the quarantine was targeted at the wrong thing.</p>
<p>Computer quarantines have been generally effective because the users whose computers are being quarantined aren&#8217;t sophisticated enough to break out of the quarantine, and find it easier to update their software and rejoin the network legitimately.</p>
<p>Three, only a small section of the population must need to be quarantined. The solution works only if it&#8217;s a minority of the population that&#8217;s affected, either with physical diseases or computer diseases. If most people are infected, overall infection rates aren&#8217;t going to be slowed much by quarantining. Similarly, a quarantine that tries to isolate most of the Internet simply won&#8217;t work.</p>
<p>Fourth, the benefits must outweigh the costs. Medical quarantines are expensive to maintain, especially if people are being quarantined against their will. Determining who to quarantine is either expensive (if it&#8217;s done correctly) or arbitrary, authoritative and abuse-prone (if it&#8217;s done badly). It could even be both. The value to society must be worth it.</p>
<p>It&#8217;s the last point that Charney and others emphasize. If Internet worms were only damaging to the infected, we wouldn&#8217;t need a societally imposed quarantine like this. But they&#8217;re damaging to everyone else on the Internet, spreading and infecting others. At the same time, we can implement systems that quarantine cheaply. The value to society far outweighs the cost.</p>
<p>That makes sense, but once you move quarantines from isolated private networks to the general Internet, the nature of the threat changes. Imagine an intelligent and malicious infectious disease: That&#8217;s what malware is. The current crop of malware ignores quarantines; they&#8217;re few and far enough between not to affect their effectiveness.</p>
<p>If we tried to implement Internet-wide&#8211;or even countrywide&#8211;quarantining, worm-writers would start building in ways to break the quarantine. So instead of nontechnical users not bothering to break quarantines because they don&#8217;t know how, we&#8217;d have technically sophisticated virus-writers trying to break quarantines. Implementing the quarantine at the ISP level would help, and if the ISP monitored computer behavior, not just specific virus signatures, it would be somewhat effective even in the face of evasion tactics. But evasion would be possible, and we&#8217;d be stuck in another computer security arms race. This isn&#8217;t a reason to dismiss the proposal outright, but it is something we need to think about when weighing its potential effectiveness.</p>
<p>Additionally, there&#8217;s the problem of who gets to decide which computers to quarantine. It&#8217;s easy on a corporate or university network: the owners of the network get to decide. But the Internet doesn&#8217;t have that sort of hierarchical control, and denying people access without due process is fraught with danger. What are the appeal mechanisms? The audit mechanisms? Charney proposes that ISPs administer the quarantines, but there would have to be some central authority that decided what degree of infection would be sufficient to impose the quarantine. Although this is being presented as a wholly technical solution, it&#8217;s these social and political ramifications that are the most difficult to determine and the easiest to abuse.</p>
<p>Once we implement a mechanism for quarantining infected computers, we create the possibility of quarantining them in all sorts of other circumstances. Should we quarantine computers that don&#8217;t have their patches up to date, even if they&#8217;re uninfected? Might there be a legitimate reason for someone to avoid patching his computer? Should the government be able to quarantine someone for something he said in a chat room, or a series of search queries he made? I&#8217;m sure we don&#8217;t think it should, but what if that chat and those queries revolved around terrorism? Where&#8217;s the line?</p>
<p>Microsoft would certainly like to quarantine any computers it feels are not running legal copies of its operating system or applications software.The music and movie industry will want to quarantine anyone it decides is downloading or sharing pirated media files&#8211;they&#8217;re <a href="http://news.bbc.co.uk/2/hi/7240234.stm">already pushing</a> similar <a href="http://www.zeropaid.com/news/9114/france_to_ban_illegal_filesharers_from_the_internet/">proposals</a>.</p>
<p>A security measure designed to keep malicious worms from spreading over the Internet can quickly become an enforcement tool for corporate business models. Charney addresses the need to limit this kind of function creep, but I don&#8217;t think it will be easy to prevent; it&#8217;s an enforcement mechanism just begging to be used.</p>
<p>Once you start thinking about implementation of quarantine, all sorts of other social issues emerge. What do we do about people who need the Internet? Maybe VoIP is their only phone service. Maybe they have an Internet-enabled medical device. Maybe their business requires the Internet to run. The effects of quarantining these people would be considerable, even potentially life-threatening. Again, where&#8217;s the line?</p>
<p>What do we do if people feel they are quarantined unjustly? Or if they are using nonstandard software unfamiliar to the ISP? Is there an appeals process? Who administers it? Surely not a for-profit company.</p>
<p>Public health is the right way to look at this problem. This conversation&#8211;between the rights of the individual and the rights of society&#8211;is a valid one to have, and this solution is a good possibility to consider.</p>
<p>There are some applicable parallels. We require drivers to be licensed and cars to be inspected not because we worry about the danger of unlicensed drivers and uninspected cars to themselves, but because we worry about their danger to other drivers and pedestrians. The small number of parents who don&#8217;t vaccinate their kids have already caused minor outbreaks of whooping cough and measles among the greater population. We all suffer when someone on the Internet allows his computer to get infected. How we balance that with individuals&#8217; rights to maintain their own computers as they see fit is a discussion we need to start having.</p>
<p><em>This essay <a href="http://www.forbes.com/2010/11/10/microsoft-viruses-security-technology-quarantine.html?boxes=Homepagechannels">previously appeared</a> on Forbes.com.</em></p>
<p>EDITED TO ADD (11/15):  From an anonymous reader:</p>
<blockquote><p>In your article you mention that for quarantines to work, you must be able to detect infected individuals.  It must also be detectable quickly, before the individual has the opportunity to infect many others.  Quarantining an individual after they’ve infected most of the people they regularly interact with is of little value.   You must quarantine individuals when they have infected, on average, less than one other person.</p>
<p>Just as worm-writers would respond to the technical mechanisms to implement a quarantine by investing in ways to get around them, they would also likely invest in outpacing the quarantine.  If a worm is designed to spread fast, even the best quarantine mechanisms may be unable to keep up.</p>
<p>Another concern with quarantining mechanisms is the damage that attackers could do if they were able to compromise the mechanism itself.  This is of especially great concern if the mechanism were to include code within end-user’s TCBs to scan computers­ essentially a built-in root kit.  Without a scanner in the end-user’s TCB, it’s hard to see how you could reliably detect infections.</p></blockquote>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/computer-security/" rel="tag">computer security</a>, <a href="https://www.schneier.com/tag/cost-benefit-analysis/" rel="tag">cost-benefit analysis</a>, <a href="https://www.schneier.com/tag/essays/" rel="tag">essays</a>, <a href="https://www.schneier.com/tag/internet/" rel="tag">Internet</a>, <a href="https://www.schneier.com/tag/isps/" rel="tag">ISPs</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/mitigation/" rel="tag">mitigation</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html" rel="bookmark">Posted on November 15, 2010 at 4:55 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html#comments">74 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2010/11/quarantine.html" data-title="Internet Quarantines" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-148641">

			<div class="comment by-shadowfirebird ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://shadowfirebird.tumblr.com' rel='external nofollow ugc' class='url'>shadowfirebird</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148641">
						November 15, 2010 5:18 AM					</a>

				</p>

				<p>&#8220;We require drivers to be licensed and cars to be inspected not because we worry about the danger of unlicensed drivers and uninspected cars to themselves, but because we worry about their danger to other drivers and pedestrians.&#8221;</p>
<p>Linux drivers aren&#8217;t licensed, and that works out okay AFAIK.  (And I suppose you could argue that if drivers were prosecuted for negligently failing to maintain their vehicles, inspections might not be necessary?)</p>
<p>I think you&#8217;ve nailed the concerns nicely, but maybe it&#8217;s simply that the quarantine model isn&#8217;t a useful one in this context.  Sometimes a model seems to fit but actually doesn&#8217;t &#8212; prohibition / alcohol springs to mind.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148642">

			<div class="comment by-simon-bridge ">

				<p class="commentcredit">

					<span class="commenter">Simon Bridge</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148642">
						November 15, 2010 5:18 AM					</a>

				</p>

				<p>Media companies have been wanting to get NZ isps to enforce quarantines against accused copyright infringers.<br />
<a href="http://lawgeeknz.posterous.com/nzs-copyright-proposal-guilty-until-you-prove" rel="nofollow ugc">http://lawgeeknz.posterous.com/nzs-copyright-proposal-guilty-until-you-prove</a></p>
<p>&#8230; internet users managed to get part of the law repealed by pressuring ISPs (who were expected to enforce it). But it keeps coming back in many guises.</p>
<p>Unfortunately the economic incentives to implement good quarantines are nonexistent.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148643">

			<div class="comment by-richard ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.richardsnotes.org' rel='external nofollow ugc' class='url'>Richard</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148643">
						November 15, 2010 5:48 AM					</a>

				</p>

				<p>This is a great discussion Bruce. Social engineering comes with costs and brings other issues (that need to be socially engineered).</p>
<p>Your list of liabilities of quarantining remind me of the slippery slope Amazon (and all of us) found themselves in when it was revealed that they were carrying a book on pedophilia. Get rid of Polanski films? Woody Allen&#8217;s Manhattan? Where does it end?</p>
<p>No doubt we&#8217;re on the way to quarantining in the background with operating systems that update themselves and applications that send companies information about our computers.</p>
<p>On the face of it, quarantining sounds like a reasonable way to save the whole from the part but the social liabilities are many.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148644">

			<div class="comment by-stephen ">

				<p class="commentcredit">

					<span class="commenter">Stephen</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148644">
						November 15, 2010 5:50 AM					</a>

				</p>

				<p>@shadowfirebird:</p>
<p>&#8220;I suppose you could argue that if drivers were prosecuted for negligently failing to maintain their vehicles, inspections might not be necessary?&#8221;</p>
<p>Except that people who don&#8217;t maintain their vehicles are less likely to have the means to pay the resulting fines.  They may be less likely to be concerned about jail time resulting from violations &#8211; just like habitual drunk drivers don&#8217;t care if they don&#8217;t have a license.  The value of the license isn&#8217;t the perceived authority to drive, it&#8217;s access to the vehicle that the license permits.  Chronic drunks can&#8217;t buy or rent cars legitimately for lack of a license, so they end up riding scooters (which require no license). This works out nicely because they&#8217;re no much more likely to kill themselves than someone else.</p>
<p>If you made vehicle inspections an enforcement issue &#8211; rather than a regulatory issue &#8211; you&#8217;re transferring highly technical work onto police and insisting that they perform it flawlessly under all sorts of sub-optimal circumstances.  Do you want your local police attaching an emissions detector to a &#8217;73 Vega at the side of the road at 4:30 in the morning or investigating a string of local assaults?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148645">

			<div class="comment by-cae ">

				<p class="commentcredit">

					<span class="commenter">Cae</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148645">
						November 15, 2010 6:04 AM					</a>

				</p>

				<p>To draw a parallel &#8211; this is like imposing a military curfew to the internet.</p>
<p>Also, I&#8217;ve used tools/programs that is detected as a virus by the anti-virus tools but the program is totally legit, then what ?</p>
<p>What about other OS besides Mac and Win, will they be considered &#8220;not-normal&#8221; (just ask WOW gamers) and be quanrantine?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148646">

			<div class="comment by-roland-dobbins ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.arbornetworks.com' rel='external nofollow ugc' class='url'>Roland Dobbins</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148646">
						November 15, 2010 6:17 AM					</a>

				</p>

				<p>Qwest have been quarantining abusive/compromised hosts, based solely upon observed external behaviors, since 2006.  And Comcast just announced they&#8217;re doing the same thing.</p>
<p>In both these systems, users can get themselves out of the penalty-box by asserting that they&#8217;ve remediated their boxes.  In Qwest&#8217;s case, repeated quarantines leads to proactive help-desk communications with the user (which translates into opex).</p>
<p>Posture assessment doesn&#8217;t work, because once you&#8217;re pwn3d, the malware can like to the assessment system.  When I was at Cisco, I pointed out that this alone was the fatal flaw which would render &#8216;NAC&#8217; unusuable, not to mention all the opex associated with the version-checking nonsense, and events proved me right.</p>
<p>But quarantining based upon observed behavior can and does work at scale, provided that the architectural and operational models are worked out in advance.  The practical span of control of such a system is a single network under a single administrative aegis; as long as more networks do this, one ends up with &#8216;inkblots&#8217; of quarantine-enabled networks gradually permeating the Internet as a whole.</p>
<p>Yes, countermeasures in order to ensure that the bots don&#8217;t let themselves out of the quarantine must certainly be developed and actualized, but that&#8217;s just part of the ongoing arms race between the miscreants and the rest of us.  Nothing new, in that regard.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148647">

			<div class="comment by-stephen ">

				<p class="commentcredit">

					<span class="commenter">Stephen</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148647">
						November 15, 2010 6:24 AM					</a>

				</p>

				<p>@Simon Bridge</p>
<p>&#8220;Unfortunately the economic incentives to implement good quarantines are nonexistent.&#8221;</p>
<p>There are some fairly straightforward means to construct incentives:<br />
1. Establish a minimum acceptable infection rate (&#8220;base rate&#8221;) for nodes on a well-maintained network.<br />
2. Rate networks according to their actual rate of active infected nodes (with assessments performed over a random 24 hour period once each quarter).<br />
3. Normalize the results to multiples of the base rate and throw out any multiples below 2.0.<br />
4. Stratify the remaining (high) rate multiples into percentiles.<br />
5. Assess per-node fees / fines on the owners of networks according to the percentile rank of their network over the course of the preceding year.</p>
<p>Step 2 is clearly the problematic one, but the audit function could be built into existing enterprise security / network management software suites or devices.  Every time the security solution performs a routine scan, there&#8217;s a chance that it will be used to grade the network. You&#8217;d have to make allowances for zero-day worms and the like with calendar-date blackouts, but that&#8217;s pretty easy, IMO.</p>
<p>The revenue generated could be used to sponsor security research and to support enforcement / auditing.  Could even be implemented as a private or non-profit venture &#8211; a kind of &#8220;Better Internet Bureau&#8221; &#8211; rather than as an initiative of government.  That body could also independently certify security solutions that met auditing or other criteria for use in operating environments of varying scale and complexity.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148648">

			<div class="comment by-peter-n-m-hansteen ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://bsdly.blogspot.com/' rel='external nofollow ugc' class='url'>Peter N. M. Hansteen</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148648">
						November 15, 2010 6:32 AM					</a>

				</p>

				<p>One fairly useful indicator of malware or other takeover is that a machine is sending spam or is exhibiting other distinct (unesirable) behavior on the network level.</p>
<p>If we limit ourselves to the spam case, greytrapping (trapping machines that try to deliver mail to known-bogus addresses) can be very effective, at least for easing the load on the content filtering. In fact several greytrapping generated blacklists are available for general use, ie <a href="http://www.openbsd.org/spamd/traplist.gz" rel="nofollow ugc">http://www.openbsd.org/spamd/traplist.gz</a> or <a href="http://www.bsdly.net/~peter/bsdly.net.traplist" rel="nofollow ugc">http://www.bsdly.net/~peter/bsdly.net.traplist</a>).</p>
<p>Key to keeping the number of false positives low is aggressive auto-expiry of entries &#8211; the spamd greytrapping default is 24 hours, others such as nixspam go as low as 12 hours of no undesirable activity seen for expiry.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148649">

			<div class="comment by-lamer ">

				<p class="commentcredit">

					<span class="commenter">lamer</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148649">
						November 15, 2010 6:46 AM					</a>

				</p>

				<p>Qwest&#8217;s quarantine program is nothing but a marketing program for McAfee &#8211; they demand that you install it, even when network is undeniably clean. Which works great for them when they practically have a local monopoly and the customer has no understanding of why they are disconnected or recourse. Qwest also provides no evidence whatsoever that malware has been on the network.</p>
<p>Nice idea, but non-profit enforcement must be a MUST on this rfc. The ISPs and security vendors would just monetize this baloney.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148650">

			<div class="comment by-claudio ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.telmon.org' rel='external nofollow ugc' class='url'>claudio</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148650">
						November 15, 2010 7:06 AM					</a>

				</p>

				<p>I agree with most of the post, however I feel that &#8220;If we tried to implement Internet-wide&#8211;or even countrywide&#8211;quarantining, worm-writers would start building in ways to break the quarantine&#8221; is the kind of generic assertions that are too generic to be true, like &#8220;security through obscurity is useless&#8221;.<br />
It is true that they would try, but this doesn&#8217;t mean that they would be able to. If this would be true, then every countermeasure would be useless, because then the bad guys would &#8220;try to evade it&#8221; and automatically succeed.<br />
A quarantine would mean that the ISP would put the pc on a separate network with limitefd access to e.g. a <em>whitelist</em> of antivirus sites. Being able to do this is a basic feature of every ISP. Think at something like: &#8220;if the ISPs would start to autenticate DSL users, then users would try to evade authentication&#8221;: ISPs <em>do</em> have the upper hand on this, and also on putting users on specific subnets; worms would need to turn to a different ISP in order to be able to access the Internet. The key is that the control is small, simple and based on default deny. If there were holes in this it&#8217;s not because worms are intelligent, but because some political/contractual issue would turn this simple mechanism in something different.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148651">

			<div class="comment by-george-h-h-mitchell ">

				<p class="commentcredit">

					<span class="commenter">George H. H. Mitchell</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148651">
						November 15, 2010 7:08 AM					</a>

				</p>

				<p>Remember the Usenet Death Penalty?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148652">

			<div class="comment by-brian-duffy ">

				<p class="commentcredit">

					<span class="commenter">Brian Duffy</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148652">
						November 15, 2010 7:13 AM					</a>

				</p>

				<p>This sort of scheme is a dangerous slippery slope. Once you allow someone to be quarantined for undesirable activity, whomever controls the definition of undesirable controls who can use the network.</p>
<p>I&#8217;m not pro-malware, but I don&#8217;t want my company quarantined and put out of business because an employee found a way to surf shemale porn or play poker at work. Or because a competitor lobbied the quarantine bureaucracy and convinced them that we were guilty of undesirable behavior.</p>
<p>Historically, extremist groups like the Puritans in the US adopted this model for their societies &#8212; they called it lofty things like &#8220;a city on the hill&#8221;. The modern legacies of this sort of nannyism are things like being unable to get a tattoo in the state of Massachusetts, because someone in the state house knew that only scurvy sailors up to no good had tattoos. At the end of the day they created a repressive environments that took decades to fix.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148653">

			<div class="comment by-thomas ">

				<p class="commentcredit">

					<span class="commenter">Thomas</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148653">
						November 15, 2010 7:31 AM					</a>

				</p>

				<p>&#8220;Microsoft would certainly like to quarantine any computers it feels are not running legal copies of its operating system or applications software.&#8221;</p>
<p>I guess they mean me.</p>
<p>Operating System aside, who gets to decide which virus scanner, office suite or browser is up to scratch?</p>
<p>This quarantine filter could easily be subverted into a tool for ensuring you get all your software from companies big enough to be able to afford certification.</p>
<p>Such a &#8216;security&#8217; measure would ensure a startup (like Firefox a few years back) could never attain any significant market share. Ironically the pressure Firefox has placed on Internet Explorer to evolve and improve has done more to improve security for the average user than anything else I can think of.</p>
<p>Ideas like this, sponsored by companies like Microsoft, are more than a little unsettling to us Penguins. Maybe we&#8217;re just paranoid&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148654">

			<div class="comment by-shadowfirebird ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://shadowfirebird.tumblr.com' rel='external nofollow ugc' class='url'>shadowfirebird</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148654">
						November 15, 2010 7:58 AM					</a>

				</p>

				<p>@Stephen:</p>
<p>Good point.  I wasn&#8217;t sure about that when I typed it, hence the question mark.   Nice to be proved wrong.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148655">

			<div class="comment by-jill ">

				<p class="commentcredit">

					<span class="commenter">Jill</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148655">
						November 15, 2010 8:23 AM					</a>

				</p>

				<p>Quarantines are good, but effective vaccines are better by far.</p>
<p>The existence and widespread use of AV software means there is very little to gain from network-level quarantining.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148656">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148656">
						November 15, 2010 8:31 AM					</a>

				</p>

				<p>I can see a big issue as to why ISP&#8217;s would not wish to have anything to do with over and above cost and resources.</p>
<p>There is the thorny issue of who guards the gate to the citadel has to be responsable in BOTH directions.</p>
<p>That is they would effectivly be liable for having alowed your machine to become infected&#8230;</p>
<p>Now if you consider mobile phones running say some stripped down version of Windows then who is responsable for upgrading it phones &#8220;sold under contract&#8221; are technicaly not the phone users property (otherwise they could unlock them) so it will turn around and byte various OS developers in the backside MS beying the main one.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148657">

			<div class="comment by-pc-tech ">

				<p class="commentcredit">

					<span class="commenter">PC.Tech</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148657">
						November 15, 2010 8:50 AM					</a>

				</p>

				<p>What about &#8220;false positives&#8221;?<br />
Suppose the appointed &#8220;traffic cop&#8221; (whoever the &#8216;Big Brothers&#8217; anoint) decides you are guilty?<br />
U R screwed. Period.</p>
<p>Meanwhile, the online criminal element is free to do whatever they want&#8230;<br />
What&#8217;s wrong with this picture?</p>
<p>.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148658">

			<div class="comment by-d ">

				<p class="commentcredit">

					<span class="commenter">D</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148658">
						November 15, 2010 8:57 AM					</a>

				</p>

				<p>@shadowfirebird:</p>
<p>But Linux drivers <em>are</em> licensed. Since they are copyrighted works, they&#8217;re either licensed or you&#8217;re not allowed to have them.</p>
<p>OK, perhaps technically, YOU are licensed by the software maker to use their software, but that&#8217;s not how we tend to discuss it in the industry.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148659">

			<div class="comment by-peter ">

				<p class="commentcredit">

					<span class="commenter">Peter</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148659">
						November 15, 2010 8:59 AM					</a>

				</p>

				<p>I&#8217;ve often thought that putting a default limit on the number of e-mails an ISP subscriber could send per day would be a useful tool. The vast majority of users don&#8217;t send more than, say, 25/day. Anyone who actually needs more would have to call their ISP and have the limit increased, or removed. But for most people, hitting the limit would suggest that their machine was being used as a spam forwarder, and they would be encouraged to take action.</p>
<p>The main effect would be to make many machines much less valuable to botnet operators.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148660">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148660">
						November 15, 2010 9:16 AM					</a>

				</p>

				<p>The quarantine method I think is relatively simple here.</p>
<p>If the machine shows worm activity, i.e. attempts to infect things by way your IDS recognizes, block everything outgoing from it except 80 and 443.  QED.  You can now use the WWW, but nothing else.  No e-mail, no IM, no Skype, no games.</p>
<p>Continue to monitor of course.  Whenever it makes an attempt, set the unblock time to now + 24 hours.  So first offense, 24 hour block.  Second offense 8 hours later, the block stays active for 32 hours total&#8211;24 hours from the second offense.  A thousand offenses in 10 minutes&#8230; 24 hours and 10 minutes blocked.</p>
<p>Immediately on a NEW block and then every 24 hours, set something on your network to change their routing.  When they get on the WWW it redirects them to a captive portal, which tells them why they have been blocked.  They hit OK and the 24 hour timer is set; they&#8217;ll see the message again then, or the next time they&#8217;re blocked after being unblocked, whichever comes first.</p>
<p>The message says &#8220;Use one of these products to remove the infection: X Y Z.&#8221;  It also says &#8220;We think your OS is this, so go to Microsoft Update/Apple Update/Ubuntu Update/etc and run updates.&#8221;  QED.</p>
<p>This is not a disaster for most users.  It still allows gmail/hotmail webmail access.  It allows you to web browse blissfully while infected.  You can do your e-banking at your own risk.</p>
<p>Best effort, you know?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148661">

			<div class="comment by-rich ">

				<p class="commentcredit">

					<span class="commenter">Rich</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148661">
						November 15, 2010 9:34 AM					</a>

				</p>

				<p>A client was on the receiving end of an isp quarantine for spewing spam. Attempts to bring up the web brought a notification page of the problem with contact info. Finding the offending office machine and cleaning it took longer than getting the ISP to clear the block.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148663">

			<div class="comment by-john-campbell ">

				<p class="commentcredit">

					<span class="commenter">John Campbell</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148663">
						November 15, 2010 9:46 AM					</a>

				</p>

				<p>Evolving after the Code Red worm hit IBM&#8217;s internal network the &#8220;Boundary Service Offering&#8221; was created in order to provide isolation for &#8220;computer labs&#8221; within the IntraNet.  It seemed strange to me how a &#8220;mandatory device&#8221; was a mandatory addition.</p>
<p>It was&#8211; and is, still&#8211; my belief that these devices provided a &#8220;quarantine&#8221; ability, in effect providing a kill switch for a specific lab, allowing cleansing operations to be performed before allowing the labspace to have connectivity to the intranet restored.</p>
<p>The problem, however, is that I can see quarantine &#8220;layers&#8221; in an OS or switch or router or whatnot becoming a plaything (like the &#8220;kill code&#8221; for OnStar equipped cars) for folks who are not part of the authorized food-chain.</p>
<p>It is a WONDERFUL means of implementing a denial of service attack, right?  And it can be played against servers, too, so you can silence dissent almost instantly.</p>
<p>This &#8220;kill switch&#8221; is just adding a new vulnerability to the internet.</p>
<p>Mind you, ISPs may be the ones who need to pay attention to abusive systems  and they must be far more amenable to licensing and inspection, not that they want to do that, but how can anything like this be done on a global scale?</p>
<p>Should anything like this be attempted on a global scale?</p>
<p>Vaccination leading to immunization has its risks on an individual level but the benefit to the larger community&#8211; family, friends, co-workers, people in the food-court at the mall, etc&#8211; where compliance reaches 99% provided benefits&#8230; to those who choose NOT to vaccinate, but that&#8217;s not quite a compatible model since those running Windows are the ones w/o any vaccination.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148664">

			<div class="comment by-cdmiller ">

				<p class="commentcredit">

					<span class="commenter">cdmiller</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148664">
						November 15, 2010 10:06 AM					</a>

				</p>

				<p>This appears to be a blatant attempt at Internet censorship and control.  People <em>will</em> be quarantined unjustly under this type of regime for many reasons beyond malware infection.  It could easily go so far as &#8220;unknown&#8221; software or network behaviour gets quarantined by default.</p>
<p>Running an encrypted channel?  Prove it&#8217;s not malware to the grand inquisitor.</p>
<p>Microsoft is pushing for this, but Microsoft&#8217;s poor product engineering is the cause of much malware taking root in the first place.</p>
<p>&#8220;We require drivers to be licensed and cars to be inspected&#8221;</p>
<p>Do Internet users need a license, or should it be the proprietary software vendors who hide their bug ridden source code from public audit?</p>
<p>&#8220;parents who don&#8217;t vaccinate their kids have already caused minor outbreaks of whooping cough and measles among the greater population&#8221;</p>
<p>How were there outbreaks among the greater population, if the greater population was vaccinated?</p>
<p>Who decides what a valid vaccine is?  Have there been reports of folks in Europe or the U.S. who refused the recent rushed to market swine flu vaccine causing outbreaks among the greater population?</p>
<p>There have been reports recently and in the past of malware scanners and software update mechanisms themselves being infected.</p>
<p>&#8220;We all suffer when someone on the Internet allows his computer to get infected&#8221;</p>
<p>I simply don&#8217;t suffer that much when this occurs.  Perhaps another message in my SPAM folder, or another log entry of a portscan.  If however this type of system comes to pass I could suffer greatly by running software the &#8220;general population&#8221; deems unusual or inappropriate.</p>
<p>&#8220;How we balance that with individuals&#8217; rights to maintain their own computers as they see fit is a discussion we need to start having&#8221;</p>
<p>If we don&#8217;t try this over reaching Internet control scheme we don&#8217;t need to have the conversation at all.  The earlier points in Bruce&#8217;s essay show there is no balance to be had.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148665">

			<div class="comment by-muffin ">

				<p class="commentcredit">

					<span class="commenter">Muffin</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148665">
						November 15, 2010 10:10 AM					</a>

				</p>

				<p>Here&#8217;s another problem. How do you, as an outside party (ISP etc.) even find out whether a user&#8217;s computer is properly patched or not?</p>
<p>There is, after all, no API to query this. Microsoft could conceivably build one into their products, but would others? There&#8217;s literally hundreds of Linux distributions, for instance, and I&#8217;m sure quite a few would disapprove of the idea. Would niche OSes like OpenBSD etc. do it?</p>
<p>How would this work with firewalls? With routers? With NAT?</p>
<p>What&#8217;s more, if there is an API that tells you whether a machine is properly patched or not, what would keep the bad guys from using it to conveniently find out who can be infected easily?</p>
<p>What would prevent this API from being abused? What kind of information would be gleaned, by whom, where would it be saved, for how long, and with whom would it be shared?</p>
<p>Does the government get to access this API? If yes, under what circumstances? If no, what&#8217;ll keep the three-letter-agency du jour from doing so, anyway?</p>
<p>What about foreign governments? Will e.g. Russian computers be monitored by the Russian government? Do we want to enable that sort of thing &#8211; in fact, is it legal for us to enable that sort of thing?</p>
<p>How do we get everyone to join in, anyway (since obviously, as long as a significant share of Internet users will not be subject to possible quarantining, it will not achieve anything to begin with)? What are the challenges posed by international law, different legal systems, different cultural values? Can we even overcome those?</p>
<p>The whole thing just isn&#8217;t worth it, IMO.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148666">

			<div class="comment by-johnm ">

				<p class="commentcredit">

					<span class="commenter">JohnM</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148666">
						November 15, 2010 10:12 AM					</a>

				</p>

				<p>This is one of those &#8220;problems&#8221; that is not really on anyone&#8217;s plate. Check systems before VPN? Yes. Sure. Quarantine from ISP?</p>
<p>AV continues to not do their job as they should. Heuristics should be far better, but they are not. Malware keeps to identifiable patterns not so difficult to catch with software&#8230; but this is not done.</p>
<p>It is really not hard to observe zombie or worm behavior &#8211; or spam, to get more specific &#8211; on a system.</p>
<p>One reason is white list rules need continual update so you do not just pay once for your software&#8230; you get married. Keep paying.</p>
<p>Just think about it. This is not advanced AI being talked about.</p>
<p>That is the kind of problem people should be working on&#8230; not this hitleresque nonsense.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148667">

			<div class="comment by-carlo-graziani ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://catbag.wordpress.com' rel='external nofollow ugc' class='url'>Carlo Graziani</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148667">
						November 15, 2010 10:21 AM					</a>

				</p>

				<p>@Clive:</p>
<p>ISP liability is the point.  Under the externality-management theory of &#8220;place the liability in the lap of the entity that is capable of dealing with the problem&#8221;, it is precisely the ISPs who are positiioned to monitor  network activity for misbehavior (contacting botnet control servers, say, or participating in a spam or DDOS campaign), and to send affected machines to the penalty box.</p>
<p>If ISPs were legally held liable for not mitigating damage to other entities due to malware on their customers&#8217; PCs, they&#8217;d get tooled up to squash the problem in a big hurry.</p>
<p>The new enforcement would mean that customers, in turn, would get themselves educated about their responsibilities as owners of networked computers, at least to the same extent as they are educated about their responsibilities as owners of motor vehicles (admittedly a low bar, but an improvement over what they understand now).  The pressure said customers would put on computer vendors for basic security would at least rise to the level they demand of their locksmiths as homeowners (again, a low bar but an improvement).</p>
<p>The problem is that as things stand now, <em>nobody</em> is either liable for infection or responsible for abatement.  I&#8217;m convinced there will be no progress on malware until some participant asses start getting lined up for a legal shoeing.  When malware really starts costing people and corporations in a tangible way, the pervasive &#8220;Inshallah/manana&#8221; attitude about security will change, and maybe it won&#8217;t be trivial to make cybercrime pay anymore.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148668">

			<div class="comment by-phred14 ">

				<p class="commentcredit">

					<span class="commenter">phred14</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148668">
						November 15, 2010 10:43 AM					</a>

				</p>

				<p>@Jill</p>
<blockquote><p>
  The existence and widespread use of AV software means there is very<br />
  little to gain from network-level quarantining.
</p></blockquote>
<p>But then some of us think that AV software is fundamentally broken at the conceptual level.  To put it simply, it&#8217;s reactive, and will always lag the latest&#8217;n&#8217;greatest threats.  There&#8217;s also the fact that AV software only came about because the underlying OS security usage (Beginning with NT, the model was good, but common usage negated all of that.) was also fundamentally broken.</p>
<p>Since we&#8217;re also talking public health, it&#8217;s worth remembering that we don&#8217;t need 100% coverage.  The way I&#8217;ve heard, with vaccines the real target is somewhere between 60% and 70% and the disease becomes sufficiently sparse to quit being a threat.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148669">

			<div class="comment by-derf ">

				<p class="commentcredit">

					<span class="commenter">derf</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148669">
						November 15, 2010 10:54 AM					</a>

				</p>

				<p>Make Microsoft directly responsible and accountable for infected operating systems and the next version of Windows will be a lot more secure.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148670">

			<div class="comment by-dmc ">

				<p class="commentcredit">

					<span class="commenter">dmc</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148670">
						November 15, 2010 10:55 AM					</a>

				</p>

				<p>Can&#8217;t wait till hackers get access to the quarantine mechanism.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148671">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148671">
						November 15, 2010 11:11 AM					</a>

				</p>

				<p>Like most things, quarrantine has good and bad.</p>
<p>The bad could be used for profiteering.  Get a little too bold on heuristics so people get locked out a bit too much, even though they have good security, with a solution:  &#8220;For just $X.XX per month, you can ensure this never happens again with [insert ISP name]&#8217;s revolutionary Internet protection suite.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148672">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148672">
						November 15, 2010 11:13 AM					</a>

				</p>

				<p>FWIW I think a UK ISP does this already. This is a few years back. Think unpatched, fresh, XP pre &#8211; SP1 install got plugged in where it shouldn&#8217;t. Got a prompt email from their NOC. Because it was on a public IP, they blocked only that IP.</p>
<p>Now, I see how this could all suck very hard under some circumstances . .</p>
<p>But if you used IPv6 as even the tunnel across the local loop and backhaul, their ISP NOC could block by the MAC address in the packet header and not waste out your whole service.</p>
<p>And that&#8217;s being crude, blocking entire addresses. You can do this by ports.</p>
<p>As for worries over disconnecting people in quarantine, i seriously wonder how many people have just a <em>single</em> means of contact with the outside world?</p>
<p>If you&#8217;re running critical VOIP, that ought to be tunneled, so that traffic iseasily separable, maybe even multi-homed.</p>
<p>Can you even get DSL service without a functional landline? How many SME&#8217;s installing fiber to the cabinet ethernet do not keep DSL as a backup?</p>
<p>If this was an Opt-In service, i can think a lot of SME&#8217;s would be better off.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148673">

			<div class="comment by-hjohn ">

				<p class="commentcredit">

					<span class="commenter">HJohn</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148673">
						November 15, 2010 11:14 AM					</a>

				</p>

				<p>@dmc:  Can&#8217;t wait till hackers get access to the quarantine mechanism.</p>
<hr />
<p>Goes in line with my post at 11:11am.  A hacker could falsely quarrantine and then sell a bogus product.  Basically ransomware.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148674">

			<div class="comment by-jd-bertron ">

				<p class="commentcredit">

					<span class="commenter">JD Bertron</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148674">
						November 15, 2010 11:33 AM					</a>

				</p>

				<p>Quarantines work only because the people under quarantine either die or get better.<br />
This isn&#8217;t true for computers.<br />
Quarantines also work with people when infection rates are high and when incubation is relatively slow compared to the speed of making the decision to quarantine.<br />
Not true for computers. Rates are usually low, and spread rates are much faster than the time it would take to make the quarantine decision.<br />
This proposal is akin to suggesting that people affected by the flu should be quarantined.<br />
It should be obvious that the sort of quarantine that could be implemented would target only mild trojans and worms while being completely ineffective toward containment of zero-day situations.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148675">

			<div class="comment by-peter ">

				<p class="commentcredit">

					<span class="commenter">Peter</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148675">
						November 15, 2010 11:38 AM					</a>

				</p>

				<p>HJohn &#8211; Yes, that could (would) happen. But it would almost certainly be a much smaller problem than the current problem.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148676">

			<div class="comment by-dragonfrog ">

				<p class="commentcredit">

					<span class="commenter">dragonfrog</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148676">
						November 15, 2010 11:41 AM					</a>

				</p>

				<p>&#8220;Might there be a legitimate reason for someone to avoid patching his computer?&#8221;</p>
<p>Absolutely &#8211; if the patch bundles undesirable behaviour along with bug fixes.  This is doubtless a more common situation with proprietary software than with FOSS, but I can imagine it happening with FOSS as well from time to time.</p>
<p>iTunes is a classic example of this nefarious, user-hostile &#8220;patch&#8221; problem.  When iTunes came out, it allowed you to handily manage your music, including copying music off an iPod e.g. after you rebuilt your computer.</p>
<p>Then out came an iTunes update, which listed a few bugfixes, maybe even security patches, in its summary.  What it didn&#8217;t mention was that it crippled the software &#8211; you now couldn&#8217;t copy mp3s off an iPod, only onto it.  Some time later, the interaction with iPods was further crippled (to do with syncing files &amp; such).  The iTunes music store stuff got gradually more and more annoying and intrusive into the user interface.</p>
<p>If you wanted to maintain a full-featured, fully functional iTunes, that basically meant foregoing all security updates to iTunes after a certain date.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148677">

			<div class="comment by-noble_serf ">

				<p class="commentcredit">

					<span class="commenter">Noble_Serf</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148677">
						November 15, 2010 12:30 PM					</a>

				</p>

				<p>MOVIE PLOT TIME!</p>
<p>It&#8217;s 2015. The government passes the long awaited &#8220;Personal Computer Security Act&#8221; and establishes the &#8220;Computer Defense Agency&#8221; in the wake of the 9/11/14 Cyber Terror Attack.</p>
<p>Now that ISPs are centrally managed and computers are quarantined at will in defense of the nation, one man, CDA director Bruce Slider holds the keys to the grid and the net. But while the nation sleeps under the blanket of protection he provides, and rumors of his popularity have the pundits talking about a presidential bid, the horrible truth is about to be known&#8230;..</p>
<p>cue evil guy inserting world domination bug in US network&#8230;. glimpse of west point ring&#8230;. glimpse of CDA seal&#8230;..</p>
<p>cut to global chaos</p>
<p>screen goes dark to focus on our hero, a middle aged net cop 2 days from retirement and his wise-cracking rookie sidekick</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148678">

			<div class="comment by-skila ">

				<p class="commentcredit">

					<span class="commenter">skila</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148678">
						November 15, 2010 12:43 PM					</a>

				</p>

				<p>@Muffin:</p>
<p>&#8220;Does the government get to access this API? If yes, under what circumstances? If no, what&#8217;ll keep the three-letter-agency du jour from doing so, anyway?&#8221;</p>
<p>No the government will not get access to the API because all their computers will have been quarantined for continuing to run Internet Explorer 6 and other software-non-grata.</p>
<p>That&#8217;s the irony &#8211; if the government allowed this to happen, everything would stop working!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148679">

			<div class="comment by-swhx7 ">

				<p class="commentcredit">

					<span class="commenter">swhx7</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148679">
						November 15, 2010 12:55 PM					</a>

				</p>

				<p>It&#8217;s a little disappointing that neither you, Bruce, nor anyone but (partially) &#8220;muffin&#8221; above has identified the egregious defect in the whole concept.</p>
<p>Actually it&#8217;s fine if the only inspection of the endpoint is monitoring its network traffic for hostile behavior. If your box is spewing spam or malware, a quarantine until it&#8217;s fixed is a good thing.</p>
<p>That scenario, however, is mixed up, in the discussion, with an idea of inspecting the endpoint device to assess its software.  This latter idea is a recipe for cyber-totalitarianism and tyranny.</p>
<p>To see this, simply ask how the ISP (or other outside party) would instpect the PC.  If they send me the source code, and it passes my review for acceptable behavior, I might run it on a user account &#8211; but I could make it lie to the server.  If it is closed-source, no one with a sane security policy would run it as root.</p>
<p>But to prevent false reports, it would be necessary to not only force outside software on the user, but to effectively remove root from the computer owner.</p>
<p>The idea that a &#8220;quarantine&#8221; or NAC scheme of this kind would help computer security is based on a total misconception of security. Security means, inter alia, that the owner is in control. If the owner gives root to someone else, even for a moment, security has been breached, and the system must be rebuilt to restore security.</p>
<p>Thus, taken to its logical conclusion &#8211; as would be necessary for it to work &#8211; the &#8220;inspect everyone&#8217;s PC as a condition of network access&#8221; idea is a pretext for an Orwellian &#8220;trusted computing&#8221; regime, where no one would be able to control their own PC, and consequently no one could trust any communications it would provide.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148680">

			<div class="comment by-peter-a ">

				<p class="commentcredit">

					<span class="commenter">Peter A.</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148680">
						November 15, 2010 1:06 PM					</a>

				</p>

				<p>Quarantine based on patch status is plain extortion. What if I chose to run an ol&#8217; good W98 I&#8217;ve bought ten years ago on that old 486 PC I&#8217;ve just assembled from parts dug out of some trash heap to run Eudora in order to access my email? What if I run some experimental or outlandish OS? An ISP would simply force you to buy the latest and greatest piece of crap from M$ (and probable get kickbacks from them). And ascertaining the patch status remotely simply means having a mandatory backdoor in your OS.</p>
<p>On the other hand, quarantine based on traffic analysis (a&#8217;la IDS) will just make the malware evolve to avoid detection and greatly harm the evolution of legitimate Internet services at the same time. Function creep will be inevitable as the malware evolves. For a start the quarantine trigger rules may involve considerable volume of spamming, contacting the well-known botnets&#8217; C&amp;Cs etc. This will immediately cause malware writers to lower the number of emails sent per botnet node per unit of time (which they already do to some degree) up to the point of the same order of magnitude as legitimate users&#8217; outgoing email traffic, switch to covert C&amp;C protocols (read some Clive Robinson&#8217;s posts here for ideas) and so on. This will induce ISPs to implement stringer quarantine triggers only to have malware writers to invent even more clever ways etc. In the end, every traffic that does not match the rules for one of the blessed protocols will get you outed, which would make development and dissemination of new uses, protocols and applications impossible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148681">

			<div class="comment by-julien-couvreur ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://blog.monstuff.com' rel='external nofollow ugc' class='url'>Julien Couvreur</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148681">
						November 15, 2010 1:08 PM					</a>

				</p>

				<p>Since ISPs own the network (thru mutual contracts) and let consumers in, each ISP is responsible for who it lets in.</p>
<p>It&#8217;s like a co-hosted party.<br />
If one of your guests gets drunk and attacks other people (ie. breaking the rules that the host set or the mutual rules between hosts), then you are responsible for kicking the guest out.</p>
<p>This is not akin to a &#8220;public health&#8221; problem, since this falls perfectly within the framework of private property and contracts.</p>
<p>To answer common questions: (1) If you are unjustly kicked out, your contract with your ISP can be used as a recourse. (2) If an ISP offers &#8220;unfair&#8221; contracts, then change ISP. (3) If all ISPs offer &#8220;unfair&#8221; contracts, then you or some other entrepreneur will start a business and make millions.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148682">

			<div class="comment by-joe ">

				<p class="commentcredit">

					<span class="commenter">Joe</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148682">
						November 15, 2010 1:18 PM					</a>

				</p>

				<p>How about just charging for email?</p>
<p>If the users were charged for the spam their computers sent out, then they would have more incentive to keep their systems clean.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148683">

			<div class="comment by-john-f ">

				<p class="commentcredit">

					<span class="commenter">John F</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148683">
						November 15, 2010 1:25 PM					</a>

				</p>

				<p>@dragonfrog:</p>
<p>&#8220;Might there be a legitimate reason for someone to avoid patching his computer?&#8221;</p>
<p>With some of the more specialized systems out there, patching the OS (at all) can void the vendors support of their product.  I&#8217;ve seen this firsthand is on devices supporting scientific instruments, I&#8217;ve also heard of medical instrumentation, SCADA type systems, etc where you get similar situations.  (whether or not these devices should be network connected or not is a moot point, in this case &#8211; they are connected, and so they have to be accounted for.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148684">

			<div class="comment by-swhx7 ">

				<p class="commentcredit">

					<span class="commenter">swhx7</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148684">
						November 15, 2010 1:35 PM					</a>

				</p>

				<p>Julien Couvreur: &#8220;(3) If all ISPs offer &#8220;unfair&#8221; contracts, then you or some other entrepreneur will start a business and make millions.&#8221;</p>
<p>I don&#8217;t know the other pros and cons of your country, but it is very fortunate in regard to internet, if such competition is a realistic possibiltity there.</p>
<p>Here in the USA, broadband internet in each area is a closely guarded monopoly or duopoly, because a few giant cablecos and telcos own the &#8220;last mile&#8221; infrastructure.  It would cost many billions of dollars for someone new to lay new wires or fiber, if they could even get permission from the governments, which is doubtful.</p>
<p>These monopolies and duopolies have come about through government subsidies and grants of privileges. Yet although much of the funds to build the &#8220;last mile&#8221; infrastructure, and the land easements to make it possible, have been extracted by force from the citizens, the citizens do not own it. Instead, it has been given to private companies.</p>
<p>Because of this local-duopoly situation, real competition is a distant dream, prices are high and bandwidth is lagging behind the rest of the developed world.  This is a classic picture of a market failure in need of regulation to protect the public.</p>
<p>In countries where there is good government in regard to internet, the &#8220;last mile&#8221; is a public resource and there is real competition among companies to provide service on it.  Only in such a scenario do your remarks make sense.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148685">

			<div class="comment by-whiskers-in-menlo ">

				<p class="commentcredit">

					<span class="commenter">Whiskers in Menlo</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148685">
						November 15, 2010 1:44 PM					</a>

				</p>

				<p>Quarantined doe not imply that nothing gets in.<br />
i.e. food, water and medicine get in to a human<br />
or animal quarantine.</p>
<p>Anyone that designs a quarantine program must also<br />
include remedial actions.  A number of positive actions are possible.</p>
<p>While hateful it is common for ISPs to return valid pages when an invalid URL is requested.   i.e. an<br />
invalid domain name returns marketing or other junk.</p>
<p>This or proxy tools could be extended to establish a way to connect to a trusted site with trusted remedial tools.  Further we need a return to delivery of physical install and recovery media so customers have tools.</p>
<p>Quarantine without a remedial plan is<br />
yet another denial of service plan.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148686">

			<div class="comment by-piet ">

				<p class="commentcredit">

					<span class="commenter">Piet</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148686">
						November 15, 2010 2:13 PM					</a>

				</p>

				<p>Isn&#8217;t it the case the worms spread to fast to be bothered by quarantine? How many vulnerable PC&#8217;s can my PC infect in the say 5 minutes it takes to cut it off? Also: one infected PC can infect every PC in the world, which is clearly not the case with one infected person escaping the city.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148687">

			<div class="comment by-rob ">

				<p class="commentcredit">

					<span class="commenter">Rob</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148687">
						November 15, 2010 2:14 PM					</a>

				</p>

				<p>@cdmiller: Vaccines are not 100% effective, nor are they permanent.</p>
<p>I have a problem with this, given the technical competence of ISPs. I got warning of infection from my ISP. Checked my network for anomalous traffic. nada. Virus scanned. nada. Scanned the Windows boxes with a security scanner that was not yet available to the public. nada. Everything came up clean.</p>
<p>After finally managing to escalate it to someone with a clue, they were considering my spamassassin blacklist queries as a DoS.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148688">

			<div class="comment by-randall ">

				<p class="commentcredit">

					<span class="commenter">Randall</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148688">
						November 15, 2010 2:41 PM					</a>

				</p>

				<p>Seems important that we can stop worms from spreading from infected computers by just <em>degrading</em> their service, not cutting it off.  Maybe we shut off particular ports.  Maybe we scan for &#8220;signatures&#8221; of the worm in network traffic, like antivirus software and the Great Firewall of China do.</p>
<p>If some worm really does need everything blocked to stop it, or as a temporary measure against a new kind of worm, some computers might need to be quarantined.  But seems important that we have less drastic options available.</p>
<p>&#8216;Nother, possibly more important problem is, our philosophy about updates is all screwed up.  Everyone but Google has it wrong: updates should happen frequently, automatically, and the user should have to disable them, not actively accept them.  And the millions of pirated copies of Windows ought to be updated too, for legitimate users&#8217; sake.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148690">

			<div class="comment by-peter ">

				<p class="commentcredit">

					<span class="commenter">Peter</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148690">
						November 15, 2010 4:08 PM					</a>

				</p>

				<p>Viruses fall into two categories: 1) Zero day/unknown and 2) known.</p>
<p>You cannot quarantining zero day/unknown viruses (don&#8217;t know what to quarantine) therefore it would be useless for this category.</p>
<p>As for the known viruses category they only harm society to the extent that society is unprepared to deal with them.  Thus the blame for the harm caused by known viruses has less to do with where they originated from then why the systems in question that they infected were not adequately protected in the first place.</p>
<p>On the whole the concept of quarantining systems at any level is a matter of censorship and therefore while it may be well intended will, nevertheless inevitably result abuse for political, financial or religious (or anti-religious) gain.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148691">

			<div class="comment by-david-thornley ">

				<p class="commentcredit">

					<span class="commenter">David Thornley</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148691">
						November 15, 2010 4:11 PM					</a>

				</p>

				<p>@Randall:  I believe Microsoft likes to ship Windows with automatic updates enabled.  I hadn&#8217;t done anything to my new W7 update settings when I noticed that it really wanted to reboot, despite what I was doing.  That&#8217;s about 90% of desktop computers right there, and the 90% most vulnerable to the current batch of exploits.  Adding auto-update to Macs and Linux boxes wouldn&#8217;t improve things noticeably.</p>
<p>Therefore, the problem is either that updates are insufficient, or that people turn off automatic updating.  If you stop me from turning off automatic updating, I don&#8217;t know that my computer is mine anymore, because another party has the ability and presumes the right to change my operating system at will.  There are, further, many computers running things that updates might break, and there are legal consequences.  Medical equipment is certified in a particular configuration, for example, and must be re-certified if anything changes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148692">

			<div class="comment by-rob ">

				<p class="commentcredit">

					<span class="commenter">Rob</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148692">
						November 15, 2010 4:35 PM					</a>

				</p>

				<p>@Peter:</p>
<p>From the point of view of the quarantining, known or unknown for the virus is almost completely moot.</p>
<p>Something is sending out a million e-mails a second. Something is forging packets. You look at the symptoms, not the cause.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148693">

			<div class="comment by-_arthur ">

				<p class="commentcredit">

					<span class="commenter">_Arthur</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148693">
						November 15, 2010 4:47 PM					</a>

				</p>

				<p>Whatever credentials a machine may present to show it is &#8220;clean&#8221;, can be faked without any difficulty.<br />
So the next generation of viruses and botnet will circumvent the quarantine attempt without any difficulty.</p>
<p>But Microsoft will get to push it&#8217;s &#8220;Trusted Comouting&#8221; once more.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148694">

			<div class="comment by-david-thomas ">

				<p class="commentcredit">

					<span class="commenter">David Thomas</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148694">
						November 15, 2010 5:14 PM					</a>

				</p>

				<p>Requiring patches to be up-to-date drives us toward a monoculture, in which new viruses will do better not worse.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148695">

			<div class="comment by-brandioch-conner ">

				<p class="commentcredit">

					<span class="commenter">Brandioch Conner</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148695">
						November 15, 2010 5:25 PM					</a>

				</p>

				<p>I think Bruce put it best.</p>
<p>&#8220;Similarly, a quarantine that tries to isolate most of the Internet simply won&#8217;t work.&#8221;</p>
<p>With millions of zombies out there, attempting to keep THEM isolated is useless.</p>
<p>Quarantines can work on corporate networks because the controlled machines usually outnumber the risky machines.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148696">

			<div class="comment by-sunshiny_optimist ">

				<p class="commentcredit">

					<span class="commenter">Sunshiny_Optimist</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148696">
						November 15, 2010 6:01 PM					</a>

				</p>

				<p>It&#8217;s about the money that can be made. I&#8217;m shocked. Shocked, I tell you.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148697">

			<div class="comment by-havacuppajoe ">

				<p class="commentcredit">

					<span class="commenter">HavaCuppaJoe</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148697">
						November 15, 2010 6:03 PM					</a>

				</p>

				<p>@Stephen:</p>
<p>Quoting:</p>
<blockquote><p>
  &#8221; 1. Establish a minimum acceptable infection rate (&#8220;base rate&#8221;) for nodes on a &gt;well-maintained network.<br />
  2. Rate networks according to their actual rate of active infected nodes (with &gt;assessments performed over a random 24 hour period once each quarter).<br />
  3. Normalize the results to multiples of the base rate and throw out any multiples &gt;below 2.0.<br />
  4. Stratify the remaining (high) rate multiples into percentiles.<br />
  5. Assess per-node fees / fines on the owners of networks according to the &gt;percentile rank of their network over the course of the preceding year.</p>
<p>  Step 2 is clearly the problematic one&#8230;&#8221;
</p></blockquote>
<p>Hmm.  I think you forgot a few, and, IMHO, yours weren&#8217;t even close to the hardest to achieve.   If you&#8217;ll allow me:</p>
<ol>
<li>Buy at least 60 US Senators and 218 US House members.<br />
 6b)  Must outbid AT&amp;T, Verizon, and Comcast in combined &#8220;contributions&#8221;</li>
<li>Repeat step 6 for all other relevant jurisdictions until critical mass is achieved</li>
<li>Create and pass relevant legislation making said ISPs liable (for ANYTHING)</li>
<li>Repeat step 8 for all other relevant jurisdictions until critical mass is achieved</li>
<li>Buy the largest law firm in the world<br />
10b) Must fund at least 15 years of appeals<br />
10c) Must outspend combined litigation teams of AT&amp;T, Verizon, and Comcast</li>
<li>Repeat step 10 for all other relevant jurisdictions until critical mass is achieved</li>
</ol>
<p>HavaCuppaJoe</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148698">

			<div class="comment by-a-n-other ">

				<p class="commentcredit">

					<span class="commenter">A N O&#039;Ther</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148698">
						November 15, 2010 6:46 PM					</a>

				</p>

				<p>Or, alternatively, we could just quarantine any computer running software produced by Mr Charney&#8217;s employer. In practical terms, this would be the simplest and most effective measure.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148699">

			<div class="comment by-peter-maxwell ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.allicient.co.uk/' rel='external nofollow ugc' class='url'>Peter Maxwell</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148699">
						November 15, 2010 7:07 PM					</a>

				</p>

				<p>This is definitely something that requires discussion: firstly to determine whether the benefits outweigh the downsides, but also to regulate the private companies providing our internet access from implementing unsatisfactory systems unilaterally.  This will need to be regulated one way or another.</p>
<p>There are a number of technical problems:</p>
<p>i) attempting to quarantine infected hosts from compromising other hosts is at best only partially effective as the means of detection are also the means of infection &#8211; closing the barn door after the horse has bolted;</p>
<p>ii) quarantining hosts from doing &#8220;noisy&#8221; activities like sending spam or port scanning should work, but one has to wonder what the utility of this is;</p>
<p>iii) for large ISPs, to implement this correctly could be a substantial resource and administrative burden that perhaps could be more advantageously used elsewhere.</p>
<p>Potentially, the most desirable solution would be to have a system where users are automatically opted in then upon undesirable network activity the hosts are cut off.  At any point &#8211; before or after cut off &#8211; the connection owner has the option to opt out.  That would catch most of the ignorant users and not give the rest of us undue hassle.</p>
<p>In a more pragmatic view, those hosts that a quarantine is likely to protect are exactly those hosts that are likely to instigate undesirable behaviour in the first place &#8211; the unpatched and poorly secured hosts.</p>
<p>Those of us that that have bothered to pay basic attention to rudimentary security procedures will either be willing to &#8220;take the hit&#8221; or be unaffected anyway.</p>
<p>Why further reduce everyone&#8217;s right to privacy in a futile attempt to protect those that will not take simple measures to protect themselves.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148700">

			<div class="comment by-richrumble ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://xinn.org' rel='external nofollow ugc' class='url'>richrumble</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148700">
						November 15, 2010 9:34 PM					</a>

				</p>

				<p>The internet is too big for any quarantines, even at the ISP levels. I run an open wifi, Bruce runs an open wifi, we&#8217;d get quarantined for sure, and we wouldn&#8217;t be the ones with the infection. We run scanners from outside IP&#8217;s, how do we get them white-listed like we do with our SMTP servers when AOL/MSN think we&#8217;ve sent too much &#8220;spam&#8221; from our company (it is opt-in only). How do I use my home DSL/Cable lines for pentesting if I&#8217;m likely to get some sort of isolation from the activity (nessus). Nothing about quarantine makes sense for the internet, and it barely makes sense from smaller internal networks, it&#8217;s more overhead putting NAC or whatever into place than it is to &#8220;config t &gt; int fa0/1 shut&#8221;. Posture assessment is a joke, to put this simply, we need new and better systems. We need an internet renaissance.<br />
Perhaps IPv6 could be the beginning of that period. The principal of least privilege is dead, we need more of what DJB did (<a href="http://www.schneier.com/blog/archives/2007/11/thoughts_on_the.html" rel="nofollow ugc">http://www.schneier.com/blog/archives/2007/11/thoughts_on_the.html</a>) and less patches/service packs/hotfixes/mitigation/workarounds/. We need programmers to create programs to do what, and only what they are supposed to do. We need kernels and operating systems that are slower to emerge but better/secure for having waited.<br />
No ISP level anything will quell the tide of a poorly written or less maintained OS. We need &#8220;thicker water&#8221;, not more cement and crack filler.<br />
-rich</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148702">

			<div class="comment by-steve ">

				<p class="commentcredit">

					<span class="commenter">Steve</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148702">
						November 15, 2010 10:05 PM					</a>

				</p>

				<p>A vulnerability of the quarantine model would be malware that quietly spreads and bides its time. At the appropriate predetermined moment, the malcode awakens, gets correctly detected by the quarantine system, and causes the client&#8217;s access to be cut. The quarantine system itself then becomes part of the exploit &#8212; one giant CDoS (centralized denial of service) attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148703">

			<div class="comment by-tuz ">

				<p class="commentcredit">

					<span class="commenter">tuZ</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148703">
						November 15, 2010 10:35 PM					</a>

				</p>

				<p>My guess is that Scott Charney has not lived in, or ventured beyond the hotel presentation rooms in a 3rd world country.  If he had, he would understand in emerging markets the vast majority of software is stolen, he would understand the vast majority of operating systems are infected with malicious software, and  understand that his proposal would disconnect entire countries from the internet.</p>
<p>Charney’s solution is myopic at best.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148704">

			<div class="comment by-joe ">

				<p class="commentcredit">

					<span class="commenter">Joe</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148704">
						November 15, 2010 10:44 PM					</a>

				</p>

				<p>At an ISP that I worked at back in 2001, we placed all home users, by default, in a quarantine network that blocked outbound SMTP not to our mail server. We also blocked inbound access to the default proxy ports and SMTP. This was opt-out for those users who claimed to have the expertise to maintain their own equipment properly and was conditional on their obeying their ToS (ie not causing harm to others on the Internet). We also blocked all outbound traffic that had a non-valid source address (reverse path forward) and blocked all inbound traffic source from invalid IP addresses. This didn&#8217;t create a huge overhead and was a trade-off between expense and standing in the community. I was shocked by the amount of obviously bogus traffic which arrived from our upstream providers with no filtering on their part. This isn&#8217;t about censorship but rather dropping invalid traffic and blocking, by default, services that are easily abused and the average user doesn&#8217;t need.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148705">

			<div class="comment by-davi-ottenheimer ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.flyingpenguin.com/' rel='external nofollow ugc' class='url'>Davi Ottenheimer</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148705">
						November 15, 2010 10:54 PM					</a>

				</p>

				<p>&#8220;It must also be detectable quickly, before the individual has the opportunity to infect many others. Quarantining an individual after they’ve infected most of the people they regularly interact with is of little value&#8221;</p>
<p>This presumes a predictable level and rate of infection, which is not the case.</p>
<p>Systems are often infected differently and at different rates, just like people. This has been a nagging problem for ages &#8212; how to spread antibodies (patches) quickly. A 60% deploy on first-pass would be lucky for most software.</p>
<p>Some comments suggest a single PC can infect the world, but they forget simple things like timezone-based behavior (systems powered off, removed from the network, compatibility, etc.) make this improbable if not impossible.</p>
<p>&#8220;Quickly&#8221; thus depends. The spread rate is not as fast as we can dream.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148706">

			<div class="comment by-ab ">

				<p class="commentcredit">

					<span class="commenter">ab</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148706">
						November 16, 2010 6:52 AM					</a>

				</p>

				<p>We should ask NSA. They probably have some backdoors in Windows machines at least.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148707">

			<div class="comment by-pedro-fortuny ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://pfortuny.net' rel='external nofollow ugc' class='url'>Pedro Fortuny</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148707">
						November 16, 2010 6:56 AM					</a>

				</p>

				<p>Ehm,</p>
<p>HIV positive persons are not quarantined. The argument is obsolete.</p>
<p>Pedro Fortuny.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148708">

			<div class="comment by-imperfect-citizen ">

				<p class="commentcredit">

					<span class="commenter">Imperfect Citizen</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148708">
						November 16, 2010 7:46 AM					</a>

				</p>

				<p>My PC doesn&#8217;t want to go on the cart, he says he&#8217;s not dead/infected yet.<br />
<a href="http://www.youtube.com/watch?v=grbSQ6O6kbs" rel="nofollow ugc">http://www.youtube.com/watch?v=grbSQ6O6kbs</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148709">

			<div class="comment by-lm ">

				<p class="commentcredit">

					<span class="commenter">LM</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148709">
						November 16, 2010 8:22 AM					</a>

				</p>

				<p>Microsoft contributes to this number of unpatched machines by preventing machines using illegal copies to be patched. While i agree that someone using illegal copy can&#8217;t complain, the rest of the world will have to handle with botnets as this machines are exploited.<br />
If they want to quarantine machines, then they must provide any kind of assurance and quality control, they must take blame (and pay fines) any time it&#8217;s proven a given vuln is their fault, unpatched vulnerabilities  should be handled as &#8220;negligent&#8221; behavior by the manufacturer and if patch is not produced in given time frame and hefty fines applied&#8230;</p>
<p>Microsoft, do you still want to go this way?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148710">

			<div class="comment by-minchinweb ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://blog.minchin.ca' rel='external nofollow ugc' class='url'>MinchinWeb</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148710">
						November 16, 2010 11:29 AM					</a>

				</p>

				<p>Another problem that I&#8217;ve run into with such a university network is that they can be really slow to update their definition files.</p>
<p>My story:<br />
I could log on to the university&#8217;s secure network just fine. Then one day, I find out my antivirus software (AVG, I think) has a new version, so I update it. (Good security practice, right?) Well, the next day, I can&#8217;t log on! After spending two hours on the phone with tech support to finally get someone who really understands the system works, they tell me that my new version of antivirus software wasn&#8217;t on the approved list, and they didn&#8217;t know when it would be &#8211; the university IT people couldn&#8217;t add it; the definition file can from their software vendor! Four months later, I graduated and never did manage to log on to the network with my new antivirus software&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148711">

			<div class="comment by-richard-steven-hack ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.computerproblemssolvedcheap.com' rel='external nofollow ugc' class='url'>Richard Steven Hack</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148711">
						November 16, 2010 4:49 PM					</a>

				</p>

				<p>There are two issues I have with quarantines.</p>
<p>First, who pays for the cost? It&#8217;s not going to be cheap for ISPs to monitor everyone on their network, despite the assertion frequently heard from the anti-piracy people that ISPs already monitor your monthly quota and the like. That just shows they don&#8217;t comprehend the technology. It&#8217;s not an answer.</p>
<p>Second, the point of quarantining someone is to TREAT THEM. You don&#8217;t allow them to &#8220;just die&#8221; &#8211; that&#8217;s &#8220;triage&#8221;. So if you have the technology to identify who must be quarantined then, unlike disease where the ill person cannot treat themselves, the quarantining authority needs to PROVIDE the technology to the person to allow them to resolve the problem.  The person involved can be charged for that if they want to resume access to the Net, but they must be given the chance.</p>
<p>Otherwise you&#8217;re just creating &#8220;mini Guantanamos&#8221; where people are held hostage with no charges ever filed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148712">

			<div class="comment by-jay-libove-cissp-cipp-cism ">

				<p class="commentcredit">

					<span class="commenter">Jay Libove, CISSP, CIPP, CISM</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148712">
						November 17, 2010 10:01 AM					</a>

				</p>

				<h2>I&#8217;m a bit late to this party, but here goes anyway&#8230;</h2>
<p>Hi Bruce,</p>
<p>For a rare change, I think you’ve missed a couple of already-settled points, and proposed a balance different than where I think we actually live today, in the discussion of Internet Quarantines.</p>
<p>Specifically, you remind us of the spectre of corporate feature creep (aka abuse) of quarantine technology.  This is an important spectre, because we’ve seen it happen, and we know that, unchecked, it will happen again. But it has been checked in some cases already &#8211;  the Comcast anti-P2P TCP RST experience showed us this, as does the current net neutrality discussion in both the US and Europe (and, despite the recent setback against the FCC’s apparent regulatory power on this point, and Europe’s recent statement that it favors sensible self-regulation, I believe that companies are and will remain sufficiently cautious because they know that stepping over the line now will result in legislation and regulation).  Another example we’ve already seen and gotten past is Microsoft’s desire to block what appear to be pirated copies of their software.  They did this with Windows Activation and limitations on non-security patches for non-activated systems.  And then they backed off quite a bit, turning non-activation and even pirated copies from “won’t work” to “nag”, as a result of user pushback.<br />
So, well-intentioned commercial actors are unlikely to go too far, and ill-intentioned actors (rogue states, totalitarian states) already go “too far” and don’t care one whit about our deliberations here.  This suggests that we should, conservatively, go forward with technical quarantines, even keeping in mind the spectre.</p>
<p>A second detailed consideration which can help with, though not solve, the above spectre, is for ISPs to impose a conservative quarantine (only that which definitely identified and known-very-bad), and then allow users to elect further layers such as “warn me if I appear to be vulnerable”, “let me know if (my children) are using P2P from my network”, etc.  This could include, as part of the ISP enabling quarantine capability for each individual user, a chance for the user to identify things like “I rely on VoIP”, “my alarm system (foolishly) can’t signal unless it has an Internet connection”, etc, potentially reducing the impact of or even opting out from quarantine for those few who make the effort – with the caveat that truly egregious symptoms would still result in IPS-like responses.</p>
<p>The second spectre is of government abuse.  This is covered above – governments will impose technology solutions (Clipper chip debacle in the US, Piracy disconnects in France, the Great Firewall of China, Iran, Turkey, you name it), or they won’t.  Thinking that we should delay the creation of a technology which absolutely will help secure the Internet because some governments would abuse it is unlikely to reduce government abuse, and maintains the ugly status quo much longer.</p>
<p>Regarding the balance issue, so many computers today are infected and causing harm to the Internet at large by lack of old patches and presence of old malware that a quarantine, even only against known bad things, would still be very helpful.  As new attacks become known attacks, the much smaller number of computers now infected only by new attacks will become recognizable to the quarantine agents.  A highly infectious new attack will of course infect a large number of computers in a short period of time, but that would still lead to a much smaller number of infected computers at any one moment in time than we live with and suffer from every day in the current situation.  This leads to the suggestion that deploying a very conservative quarantine mechanism (only quarantine that which currently suffers a known definitely-bad thing) would still pay large dividends.</p>
<p>This actually leads me to wonder about a third point in your article: You note that quarantines are only effective when not-more-than-a-minority of the overall population needs to be quarantined. That’s surely true with medical quarantines of humans, where remediation of the illness ranges from long/expensive to impossible. But for computers where most infections are readily curable with free tools, I suggest that even when a substantial portion of the population needs to be briefly quarantined to a remediate-only (+ critical services) corral it is still a very effective technique.  And this places one more challenge: The human/ medical quarantine model isn’t really the same, and we must be careful of allowing it to guide us without challenging each possible non-parallel between the two realities.</p>
<p>Thanks, as always!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148713">

			<div class="comment by-moo ">

				<p class="commentcredit">

					<span class="commenter">moo</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148713">
						November 17, 2010 10:24 AM					</a>

				</p>

				<p>I&#8217;m not so sure &#8220;net neutrality&#8221; is alive and well.  Tens of thousands of Canadian players of World of Warcraft discovered yesterday that after installing the latest mandatory patch to the game, their ping times had risen by 400ms or more.  Most but not all of these customers get their internet service from Bell Canada or some smaller ISP that buys service wholesale from Bell Canada.  On Blizzard&#8217;s end, World of Warcraft servers are run from the AT&amp;T network.  Many players did traceroutes and posted them, and what they all showed was that the extra lag gets added on the first hop out of Bell&#8217;s network and into AT&amp;T&#8217;s.  It turns out that Blizzard changed something about their traffic pattern (nobody has said in public exactly what) which is now causing AT&amp;T&#8217;s traffic shaping algorithms to mis-classify this traffic as P2P traffic instead of &#8220;Gaming&#8221; traffic.  So it now goes in the lowest priority queues instead of the highest, and gets crowded out by actual P2P traffic.</p>
<p>I know that traffic management is a reasonable thing to do, but the various &#8220;traffic pattern&#8221; machinations of both Blizzard and AT&amp;T have now combined to change players&#8217; typical latency from 50-100ms into 500ms or more (some players get 2000 to 3000ms and frequent disconnects).  Unless it is fixed soon, Blizzard is actually going to lose some customers over this.  Which is ludicrous, because they pay AT&amp;T huge amounts of money for all the bandwidth and network services used to run WoW.  So its in the interests of both AT&amp;T and Blizzard to make sure these players get a good experience.</p>
<p>Note that the &#8220;ideal&#8221; short term solution to this problem is for AT&amp;T to simply mark all of the traffic to and from Blizzard&#8217;s ranges of IP addresses, as being high priority &#8220;Gaming&#8221; traffic.  Which would certainly go against net neutrality, even if they were to do it for benign traffic management reasons rather than economic extortion reasons.</p>
<p>And I&#8217;m not sure that discriminating against certain &#8220;traffic patterns&#8221; is any less neutral than discriminating against certain sources or destinations of the traffic.  If a big ISP has their own video-conferencing thing, and they can recognize the &#8220;traffic pattern&#8221; of a competing video conferencing application and degrade its QoS, then you can get non-neutral results with economic consequences.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148714">

			<div class="comment by-brian ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://bmurray.ca/' rel='external nofollow ugc' class='url'>Brian</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148714">
						November 17, 2010 10:53 AM					</a>

				</p>

				<p>I wrote my Masters thesis on something quite similar. Basically a DDoS defense at the core that could be used to single out potentially infected machines. It could either block them or tag the machines for further deep packet inspection in order to prevent the machines from creating further attacks. It was more reactive then proactive, but could increase the accuracy of detection quite a bit.</p>
<p>Email me if you want a copy of that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148715">

			<div class="comment by-doug-coulter ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.coultersmithing.com/forums' rel='external nofollow ugc' class='url'>Doug Coulter</a></span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148715">
						November 17, 2010 8:33 PM					</a>

				</p>

				<p>I don&#8217;t have much to say on the heavier aspects of the issue Bruce and others have brought up; that would take a book to cover adequately anyway, and the frailty of human nature would take most of that book, but I have a cool true anecdote.</p>
<p>I&#8217;m with a small-time effective-monopoly ISP out in the boonies.  Most of their customers are more or less clueless (and so was the ISP, who allowed HELO etc on their email service and a lot of other things that made getting a list of their clients easy), and many are infected. This got to the point of stressing their service due to spam and so on, so they thought to offer a service you&#8217;d have to pay for to filter spam coming in.</p>
<p>I pointed out to them that about 90% of it was coming from their other customers, not outside, and they were missing a business opportunity.</p>
<p>First, do the filtering free &#8212; it was for their own good, and cost effective.  Second, since they were in the best place to detect infected customers by the sheer volume of their outgoing mails and so on, why not offer a service to those people that they would charge for, that would disinfect their machines and put in the relevant security updates and patches?</p>
<p>They&#8217;d know who to contact to sell it to, easy.</p>
<p>To my utter surprise, they did!  It worked, too!<br />
Not that their customer base is all infection free, but it knocked the problem way, way back from where it was, and they made money and created a couple of jobs doing it.  Pretty cool.</p>
<p>The key, as Bruce likes to point out, is incentive &#8212; they were losing money due to the costs of keeping up with the spam and DDOS coming from their own customers &#8212; now they could not only put a stop to that (more or less) but get paid to do it.</p>
<p>They jumped right on it and are doing a fairly decent job now.  How about that?  Rare, but good things do happen now and then.</p>
<p>And this doesn&#8217;t help evil outfits like the media mafiaa or MS &#8212; they have no part or control over this, and the ISP couldn&#8217;t care less if you&#8217;re angering someone by file sharing or pirating windows.  But they&#8217;ll happily install Linux for you if you like, and will suggest it if you don&#8217;t ask.<br />
It&#8217;s what they use in-house once they got a good sysadmin, so they can easily show it off.</p>
<p>Which I do for my neighbors when they ask me to support them.  Very convincing argument &#8212; I&#8217;ll support you free, or for minor favors if it&#8217;s Linux (you might pay me for hardware and I make a little on that, since I have a way to get very good deals myself), and for quite a sum if it&#8217;s Windows.  I get few arguments, and with these type people, do very little work supporting Linux &#8212; the base distros pretty much do all they know how to do on computers anyway.  I tell them to do the updates in Ubuntu and that seems to work pretty well, but I manually upgrade to the next major version for them as that&#8217;s trouble prone sometimes.  I generally put them on a long term support version, for obvious reasons.</p>
<p>They feed me and give me free drinks whilst I do that, could be worse, all are nice people to hang out with anyway, while we wait for the odd updates and downloads to do it.</p>
<p>For those who just can&#8217;t live without Windows, I install virtual box on Linux, and don&#8217;t let it on the internet &#8212; shared folders to Linux only.  If they can figure out how to turn that back on, it&#8217;s on them to keep it working, or I charge for that.<br />
That way, about all the MS updates are meaningless anyway, and that big time waster doesn&#8217;t hit them at all.  Those people all run XP of course.</p>
<p>It&#8217;s a working system, admittedly in an almost ideal situation, but it&#8217;s an example of how to do this right.  An existence proof, if you will.</p>
<p>This is one of the few instances where small beats big coming and going.  Can you imagine Verizon or AT&amp;T, or Comcast doing this?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-148716">

			<div class="comment by-j-rochkind ">

				<p class="commentcredit">

					<span class="commenter">J. Rochkind</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148716">
						November 19, 2010 10:24 AM					</a>

				</p>

				<p>The university where I work is already doing this, probably other universities are too.</p>
<p>How did I find out? My computer got quaranteed as a result of my use of IRC&#8211;they apparently had systems in place that automatically considered any IRC use evidence of an infection, since some worms apparently use IRC to communicate with each other. I never got notified, I had to contact tech support, about a problem with my internet connection. Took two days to convince them that I did not have a worm infection, I used IRC as part of my job (really).   VERY annoying.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-148717">

			<div class="comment by-j-rochkind ">

				<p class="commentcredit">

					<span class="commenter">J. Rochkind</span> •

					<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/#comment-148717">
						November 19, 2010 10:33 AM					</a>

				</p>

				<p>Oh, and I&#8217;d add that I am a fairly technically competent person (my job is in software development), so I was able to interpret what they were saying to understand that my computer had been quarantied for network activity that made them think it was infected, and that the the port numbers they were telling me about were IRC ports. And then get to work convincing them that, no, I actually intentionally use IRC.  A non-technical person would know nothing but that IT told them their computer was infected and couldn&#8217;t be on the internet again until it was uninfected, and then go through painful attempts to uninfect their computer (with no internet access), all for nothing because the computer was never infected in the first place. Who knows how long it would take them to get back on the internet.</p>
<p>And this was at a medium-large organization where I was an employee. Can you imagine dealing with a giant ISP (with typical giant ISP customer service) on something like this? You&#8217;d never be back on the net. And presumably would shortly stop paying the ISP for a service you weren&#8217;t getting. Which is fortunately a reason that giant ISP&#8217;s will never implement such a thing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2010/11/quarantine.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2010/11/quarantine.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2010%2F11%2Fquarantine.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2010/11/quarantine.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='3638' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2010/11/friday_squid_bl_252.html" rel="prev">← Friday Squid Blogging: Tentacle Pot Pie</a>		<a href="https://www.schneier.com/blog/archives/2010/11/term_paper_writ.html" rel="next">Term Paper Writing for Hire →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
