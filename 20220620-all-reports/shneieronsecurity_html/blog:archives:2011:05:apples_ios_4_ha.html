<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Apple&#039;s iOS 4 Hardware Encryption Cracked - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Apple&#039;s iOS 4 Hardware Encryption Cracked Comments Feed" href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/3885" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=3885' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2011%2F05%2Fapples_ios_4_ha.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2011%2F05%2Fapples_ios_4_ha.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-3885 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-3885" class="post-3885 post type-post status-publish format-standard hentry category-uncategorized tag-apple tag-cryptanalysis tag-cryptography tag-encryption tag-hardware tag-iphone tag-operating-systems tag-side-channel-attacks">

	<div class="article">

		<h2 class="entry">Apple&#039;s iOS 4 Hardware Encryption Cracked</h2>
		<p>All I know is what&#8217;s in <a href="http://.crackpassword.com/2011/05/elcomsoft-breaks-iphone-encryption-offers-forensic-access-to-file-system-dumps/">these</a> <a href="http://.crackpassword.com/2011/05/extracting-the-file-system-from-iphone-ipad-ipod-devices/">two</a> blog posts from Elcomsoft.  Note that they didn&#8217;t break AES-256; they figured out how to extract the keys from the hardware (iPhones, iPads).  The company &#8220;will be releasing the product implementing this functionality for the exclusive use of law enforcement, forensic and intelligence agencies.&#8221;</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/apple/" rel="tag">Apple</a>, <a href="https://www.schneier.com/tag/cryptanalysis/" rel="tag">cryptanalysis</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/encryption/" rel="tag">encryption</a>, <a href="https://www.schneier.com/tag/hardware/" rel="tag">hardware</a>, <a href="https://www.schneier.com/tag/iphone/" rel="tag">iPhone</a>, <a href="https://www.schneier.com/tag/operating-systems/" rel="tag">operating systems</a>, <a href="https://www.schneier.com/tag/side-channel-attacks/" rel="tag">side-channel attacks</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html" rel="bookmark">Posted on May 27, 2011 at 6:04 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html#comments">59 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html" data-title="Apple&#039;s iOS 4 Hardware Encryption Cracked" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-160722">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160722">
						May 27, 2011 6:18 AM					</a>

				</p>

				<p>I see that many of their products are available to the general public and they are originally a Russian company.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160723">

			<div class="comment by-pedro-melo ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.simplicidade.org' rel='external nofollow ugc' class='url'>Pedro Melo</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160723">
						May 27, 2011 6:31 AM					</a>

				</p>

				<p>Interesting, but I don&#8217;t see any mention on the amount of time to obtain the keys, only how much it takes to brute-force the passcode and that after you have them deciphering the information is instantaneous.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160724">

			<div class="comment by-larry-seltzer ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://blogs.pcmag.com/securitywatch/' rel='external nofollow ugc' class='url'>Larry Seltzer</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160724">
						May 27, 2011 6:56 AM					</a>

				</p>

				<p>What Pedro said. It&#8217;s brute force against a 4-digit PIN.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160725">

			<div class="comment by-larry-seltzer ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://blogs.pcmag.com/securitywatch/' rel='external nofollow ugc' class='url'>Larry Seltzer</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160725">
						May 27, 2011 6:59 AM					</a>

				</p>

				<p>BTW, you can enable stronger passcodes with  &#8220;Settings &gt; General &gt; Passcode Lock &gt; Simple Passcode &gt; OFF.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160726">

			<div class="comment by-mark-nunnikhoven ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://markn.ca' rel='external nofollow ugc' class='url'>Mark Nunnikhoven</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160726">
						May 27, 2011 7:17 AM					</a>

				</p>

				<p>Their product works against some stronger passwords as well. It runs a brute force startin w/0000&#8211;9999 and then moves through a dictionary and combination data set (eg, password1).</p>
<p>Speed depends on the hardware and edition of the software. Pro version supports GPU acceleration.</p>
<p>2 additional notes:</p>
<ul>
<li>the product works on backups obtained from a workstation and may work against a forensic image (haven&#8217;t tested the image)</li>
<li>the product also pulls the data highlighted in the Fraunhofer password study from Feb/11</li>
</ul>
<p>Mark<br />
@marknca</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160727">

			<div class="comment by-bf-skinner ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.epic.org' rel='external nofollow ugc' class='url'>BF Skinner</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160727">
						May 27, 2011 7:26 AM					</a>

				</p>

				<p>I know what law enforcement and  intelligence agencies are. But what&#8217;s a &#8220;forensic&#8221; agency? Forensic specialists in some states are regulated but not all.</p>
<p>But here again we see a company selling rooting to Gov&#8217;t/LEO/IC. I couldn&#8217;t find it is this another case like our French friends who will NOT disclose their method to Apple? They didn&#8217;t say they wouldn&#8217;t but I can&#8217;t believe their business model allows for disclosure.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160728">

			<div class="comment by-andrey-belenko ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.elcomsoft.com' rel='external nofollow ugc' class='url'>Andrey Belenko</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160728">
						May 27, 2011 7:28 AM					</a>

				</p>

				<p>@all: it&#8217;s not about passcode bruteforce at all. You can decrypt most of the files without knowing the passcode.</p>
<p>GPU is irrelevant since bruteforce (should you decided to do it) must be run on the device so you simply can&#8217;t use GPU.</p>
<p>@Pedro Melo: key extraction is instant, passcode bruteforce (in rare cases in is really needed) is slow – about 30-40 mins for all 4-digits passcodes, significantly more if passcode is longer/alphanumeric.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160729">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">Chris</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160729">
						May 27, 2011 7:54 AM					</a>

				</p>

				<p>I was waiting for Bruce to weigh in on this. Here&#8217;s the rub that I have yet to determine:</p>
<p>Since PIN authentication must be performed on-device, does the &#8220;Wipe after 10 attempts&#8221; setting essentially render this &#8220;recovery software&#8221; useless for getting keychain items (and thus data) secured by kSecAttrAccessibleWhenUnlocked?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160730">

			<div class="comment by-neil ">

				<p class="commentcredit">

					<span class="commenter">Neil</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160730">
						May 27, 2011 8:23 AM					</a>

				</p>

				<p>There&#8217;s a response from Elcom in the comments section on their first blog post that says they are able to bypass the portion of the API that counts passcode attempts.  So, they are free to make as many attempts against the passcode as they like without wiping the device.</p>
<p>Based on how long they claim it takes them to crack a 4-digit passocde, you can estimate the number of attempts per minute (I think about 250).  You would in theory be able to determine an acceptable attack period and work backwards to a minimum complexity and length for the passcode.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160731">

			<div class="comment by-muzaffar-mahkamov ">

				<p class="commentcredit">

					<span class="commenter">Muzaffar Mahkamov</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160731">
						May 27, 2011 8:46 AM					</a>

				</p>

				<p>@Chris: ElcomSoft replies that they don&#8217;t use the API for the bruteforce attack, hence the attempts are not counted (<a href="http://blog.crackpassword.com/2011/05/elcomsoft-breaks-iphone-encryption-offers-forensic-access-to-file-system-dumps/comment-page-1/#comment-23319" rel="nofollow ugc">http://blog.crackpassword.com/2011/05/elcomsoft-breaks-iphone-encryption-offers-forensic-access-to-file-system-dumps/comment-page-1/#comment-23319</a>)</p>
<p>I&#8217;m surprised that bruteforce protection is not implemented in the security processor level.</p>
<p>What&#8217;s more disturbing is the amount of data recorded by the iPhone. &#8220;screen shots of applications being used&#8221;?</p>
<p>What&#8217;s the purpose of gathering &amp; storing all that information if Apple claims it&#8217;s not transmitted to the Apple servers?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160732">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160732">
						May 27, 2011 8:47 AM					</a>

				</p>

				<p>Hmm, why am I not surprised.</p>
<p>Not being nasty but Apple for the past twenty years has been about style over substance.</p>
<p>They have had numerous security issues with their mobile devices, including shipping product with a PC virus on it.</p>
<p>Has this stopped people buying their product?</p>
<p>No, much like Apple many of their users are style over substance not juszt in their outlook but in their entire life (as those who have worked with them find out).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160733">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">Chris</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160733">
						May 27, 2011 9:05 AM					</a>

				</p>

				<p>@Neil, @Muzaffar</p>
<p>Thanks for the clarification/link on the PIN code wipe API bypass Elcomsoft is using. I&#8217;d love to see more details, but they&#8217;re not likely to reveal their secret sauce. Theorycrafting below.</p>
<p>If they&#8217;re bypassing the API, Apple likely hasn&#8217;t signed whatever code is necessary to do that. So this likely requires a jailbreak to run (tethered, even) &#8211; what happens if iOS (N+1) is jailbreak-proof? Also, wonder if a microcode update is possible to the SoC that would close that hole? Either way, I&#8217;m sure Apple has bought a license to this software and is working on how to make it useless.</p>
<p>@Muzaffar re: screenshots<br />
Apple takes the screenshot of the running app as part of the iOS task switching &#8211; that way when you switch back to the app in question, it shows the zoom-in animation to the static snapshot while the app itself is being relaunched in the background.</p>
<p>@all re: protecting against this<br />
Looks like a nice fat complex password is the safest bet. At a rate of ~250 attempts/minute bruteforce, eight characters in the 72-character Aa1! keyspace should be enough that the device suffers a manufacturing defect before being broken. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160734">

			<div class="comment by-mark-nunnikhoven ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://markn.ca' rel='external nofollow ugc' class='url'>Mark Nunnikhoven</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160734">
						May 27, 2011 9:19 AM					</a>

				</p>

				<p>@all &#8211; re:capabilities<br />
One thing to point out to make sure everyone is on the same page, this tool works on device BACKUPS and not the device itself.</p>
<p><a href="http://www.elcomsoft.com/help/eppb/index.html" rel="nofollow ugc">http://www.elcomsoft.com/help/eppb/index.html</a> &gt; Program Information &gt; System Requirements</p>
<p>and</p>
<p><a href="http://www.elcomsoft.com/phone_password_recovery.html" rel="nofollow ugc">http://www.elcomsoft.com/phone_password_recovery.html</a> &gt; question #2</p>
<p>@all &#8211; re:brute force<br />
In my testing, the tool caught 4-digit PIN and simple passwords in a reasonable amount of time (~4 hrs running in a non-accelerated VM) but was unable to break a complex&#8211;but easy to remember&#8211;multi-word password. When run overnight on the complex password, the application displayed a message stating that it was unable to find the password after running through all combinations it knew about.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160735">

			<div class="comment by-neil ">

				<p class="commentcredit">

					<span class="commenter">Neil</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160735">
						May 27, 2011 9:26 AM					</a>

				</p>

				<p>The screen captures cached on the device are used to make the fancy animated context shifts when a screen is twisted, flipped, or slides. It&#8217;s not nefarious, although it does seem sloppy from a device security standpoint.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160736">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">Chris</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160736">
						May 27, 2011 9:39 AM					</a>

				</p>

				<p>@Mark: &#8220;One thing to point out to make sure everyone is on the same page, this tool works on device BACKUPS and not the device itself.&#8221;</p>
<p>From the first link, Elcomsoft states:</p>
<p>&#8220;Ten thousand combinations do not sound like much. On a PC, breaking a passcode of this length would only take a few moments. Unfortunately, passcodes can only be bruteforced on the device itself.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160737">

			<div class="comment by-atn ">

				<p class="commentcredit">

					<span class="commenter">ATN</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160737">
						May 27, 2011 9:40 AM					</a>

				</p>

				<blockquote><p>
  a complex&#8211;but easy to remember&#8211;multi-word password.
</p></blockquote>
<p>Ah, so you are not using a complexity checker for your password, which fails because the password is not a word!!! (Windows tools, no multi-word password)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160738">

			<div class="comment by-mark-nunnikhoven ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://markn.ca' rel='external nofollow ugc' class='url'>Mark Nunnikhoven</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160738">
						May 27, 2011 9:46 AM					</a>

				</p>

				<p>@Chris<br />
Good reference, you&#8217;re right. Looks like they&#8217;ve added more information and&#8211;finally&#8211;a section detailing what&#8217;s available only to law-enforcement:</p>
<p><a href="http://www.elcomsoft.com/iphone-forensic-toolkit.html" rel="nofollow ugc">http://www.elcomsoft.com/iphone-forensic-toolkit.html</a></p>
<p>So that makes 3 editions;</p>
<p>Home, Pro, LE</p>
<p>Only LE works on the device. Home and Pro only work on backups from the device.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160739">

			<div class="comment by-spaceman-spiff ">

				<p class="commentcredit">

					<span class="commenter">Spaceman Spiff</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160739">
						May 27, 2011 9:51 AM					</a>

				</p>

				<p>Well, now that it is known that this attack is possible, who wants to wager how long before the black hats have it?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160740">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">Chris</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160740">
						May 27, 2011 10:01 AM					</a>

				</p>

				<p>@Spiff &#8211; The only really new thing here is the ability to attack the PIN code without triggering the bruteforce protection; there&#8217;s been methods to grab an image of an iDevice for some time now IIRC.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160741">

			<div class="comment by-not-an-iphone-or-android-user ">

				<p class="commentcredit">

					<span class="commenter">not-an-iphone-or-android-user</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160741">
						May 27, 2011 10:44 AM					</a>

				</p>

				<p>@Muzaffar Mahkamov</p>
<h2>What&#8217;s more disturbing is the amount of data recorded by the iPhone. &#8220;screen shots of applications being used&#8221;?</h2>
<p>Perhaps that explains the &#8220;camera shutter&#8221; like sounds from my two friends iPhones every time they were done using them.</p>
<p>Or alternatively does the iPhone take a snapshot of the user at the end of each &#8220;session&#8221;?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160742">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">Chris</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160742">
						May 27, 2011 10:50 AM					</a>

				</p>

				<p>@not-an-etc</p>
<p>The &#8220;camera shutter&#8221; is the &#8220;lock closing&#8221; noise to indicate the iPhone going into sleep mode.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160743">

			<div class="comment by-mijail ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://hmijailblog.blogspot.com' rel='external nofollow ugc' class='url'>Mijail</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160743">
						May 27, 2011 11:06 AM					</a>

				</p>

				<p>@Chris &#8211; They say the capability of grabbing an image was useless since iOS 4, because of the filesystem encryption. But they have found a method to get the needed keys.</p>
<p><a href="http://blog.crackpassword.com/2011/05/elcomsoft-breaks-iphone-encryption-offers-forensic-access-to-file-system-dumps/comment-page-1/#comment-23320" rel="nofollow ugc">http://blog.crackpassword.com/2011/05/elcomsoft-breaks-iphone-encryption-offers-forensic-access-to-file-system-dumps/comment-page-1/#comment-23320</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160744">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160744">
						May 27, 2011 11:15 AM					</a>

				</p>

				<p>So this is an attack on key management rather than an attack on encryption. Protecting a 256-bit key with a 4-digit pin does not give you 256 bits of cryptographic strength. I&#8217;d say it&#8217;s more like 13 bits: 10^4 pins = 2^13.3 pins, meaning a 4-digit pin makes for about 13 bits of cryptographic strength.</p>
<p>The increasing popularity of OS X an i-devices may well end up pushing Apple in the same corner where Microsoft has been for such a long time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160745">

			<div class="comment by-hacker ">

				<p class="commentcredit">

					<span class="commenter">hacker</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160745">
						May 27, 2011 11:44 AM					</a>

				</p>

				<p>Everything elcomsoft can do is covered by the code and slides here:  <a href="http://code.google.com/p/iphone-dataprotection/" rel="nofollow ugc">http://code.google.com/p/iphone-dataprotection/</a></p>
<p>To get the code on google to work requires some domain knowledge, but free and easy to use tools to brute force the passcode and extract needed keys to read acquired filesystem (dd) images will likely materialize.</p>
<p>But so will new hardware from apple along with iOS 5.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160746">

			<div class="comment by-pepijn ">

				<p class="commentcredit">

					<span class="commenter">Pepijn</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160746">
						May 27, 2011 12:43 PM					</a>

				</p>

				<p>Elcomsoft is the company whose employee, Dmitry Sklyarov, was arrested and tried in the US for allegedly violating the DMCA. How ironic and disappointing that now they appear to work for the man&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160747">

			<div class="comment by-shane ">

				<p class="commentcredit">

					<span class="commenter">Shane</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160747">
						May 27, 2011 2:02 PM					</a>

				</p>

				<p>&#8216;Exclusive use of Law Enforcement&#8217; huh?</p>
<p>Way to think that one through.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160748">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">Chris</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160748">
						May 27, 2011 2:10 PM					</a>

				</p>

				<p>@hacker</p>
<p>Well, I stand corrected then; it appears that all Elcomsoft has done is put that existing ability into a shiny package.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160749">

			<div class="comment by-aikimark ">

				<p class="commentcredit">

					<span class="commenter">aikimark</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160749">
						May 27, 2011 2:30 PM					</a>

				</p>

				<p>@Andrey Belenko</p>
<p>Thank you for participating in the discussion and clarifying/correcting us.  Congratulations to Elcomsoft on this crypto work.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160750">

			<div class="comment by-nz ">

				<p class="commentcredit">

					<span class="commenter">NZ</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160750">
						May 27, 2011 2:47 PM					</a>

				</p>

				<p>The second post mentions three ways to access the file system, the 1st one being &#8220;One can &#8216;mount&#8217; the device, mapping it as a drive letter and copy data file after file.&#8221; Does that mean using a tool like iPhoneBrowser? It seems so, since they &#8220;In &#8220;jailbroken&#8221; state, all information stored on the device may be available.&#8221;, that is afc2 service&#8230; errm, daemon gives full access. If so, then all this encryption could be bypassed long ago&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160751">

			<div class="comment by-andrey-belenko ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.elcomsoft.com' rel='external nofollow ugc' class='url'>Andrey Belenko</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160751">
						May 27, 2011 3:43 PM					</a>

				</p>

				<p>@aikimark My pleasure. There is quite some misunderstanding of what&#8217;ve done (even here in comments), so I am trying to clarify things 🙂</p>
<p>@NZ Yes – in theory. That is called logical acquisition as opposed to (more thorough) physical acquisition. Also, the &#8220;afc2&#8221; method have considerable limitations: you can&#8217;t read files that are protected with passcode (not unless you know the passcode; with new tools you can use escrow keys instead of the passcode) and you have to deal with each file separately instead of just one filesystem image. Besides, I am not sure if non-invasive tethered jailbreak will be enough for this theoretical mode to work.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160752">

			<div class="comment by-aikimark ">

				<p class="commentcredit">

					<span class="commenter">aikimark</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160752">
						May 27, 2011 4:29 PM					</a>

				</p>

				<p>@Andrey</p>
<p>Questions:<br />
1. Once you&#8217;ve gathered all the keys, couldn&#8217;t you get better decryption performance working on a byte-by-byte copy of the hard drive and a more powerful emulator?</p>
<ol>
<li>
<p>How do you address the (US) courts insistence on forensic cyber work done on a read-only copy?</p>
</li>
<li>
<p>Although Elcomsoft has come a long way toward establishing credibility in the business community, do you still encounter prejudice because you&#8217;re based in Russia? (lingering Soviet or mob fears)</p>
</li>
</ol>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160753">

			<div class="comment by-tommy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.amiright.com/parody/80s/bonnietyler47.shtml' rel='external nofollow ugc' class='url'>tommy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160753">
						May 27, 2011 4:35 PM					</a>

				</p>

				<p>At the risk of sounding like a confirmed Luddite, this writer has been saying for years that sensitive transactions, like banking, should not be done on &#8220;smart phones&#8221;. Surprising that anyone at this blog would do so, or that they&#8217;re surprised that this happened.</p>
<p>Personally, I&#8217;d rather not even have a sensitive <em>conversation</em> on <em>any</em> cell phone, since it&#8217;s so easy to eavesdrop. To monitor my home phone, you at least have to go to a little more trouble&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160754">

			<div class="comment by-richard-steven-hack ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.computerproblemssolvedcheap.com' rel='external nofollow ugc' class='url'>Richard Steven Hack</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160754">
						May 27, 2011 9:38 PM					</a>

				</p>

				<p>Chris: &#8220;what happens if iOS (N+1) is jailbreak-proof?&#8221;</p>
<p>Until they find out how to do that &#8211; which so far appears unlikely &#8211; we don&#8217;t know. I wouldn&#8217;t hold my breath waiting for Apple to outwit the best hackers in the world (short of sealing the entire device in Carbonite &#8211; and even Leia beat that one.)</p>
<p>As for the &#8220;Law Enforcement&#8221; edition leaking, it&#8217;s only a matter of time. It may be hard to find but someone will get their hands on it outside of LE. I think most of Elcomsoft&#8217;s stuff is available illegally somewhere if you look around.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160755">

			<div class="comment by-richard-steven-hack ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.computerproblemssolvedcheap.com' rel='external nofollow ugc' class='url'>Richard Steven Hack</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160755">
						May 27, 2011 10:08 PM					</a>

				</p>

				<p>Offtopic but relevant since it implies RSA SecurID compromise:</p>
<p>Hackers Broke Into Lockheed-Martin Networks: Source<br />
<a href="http://www.msnbc.msn.com/id/43199200/ns/technology_and_science-security/" rel="nofollow ugc">http://www.msnbc.msn.com/id/43199200/ns/technology_and_science-security/</a></p>
<p>Quotes</p>
<p>&#8220;They breached security systems designed to keep out intruders by creating duplicates to &#8220;SecurID&#8221; electronic keys from EMC Corp&#8217;s RSA security division, said the person who was not authorized to publicly discuss the matter&#8230;.The hackers learned how to copy the security keys with data stolen from RSA during a sophisticated attack that EMC disclosed in March, according to the source&#8230;Rick Moy, president of NSS Labs, an information security company, said the original attack on RSA was likely targeted at its customers, including military, financial, governmental and other organizations with critical intellectual property.</p>
<p>He said the initial RSA attack was followed by malware and phishing campaigns seeking specific data that would link tokens to end-users, which meant the current attacks may have been carried out by the same hackers.</p>
<p>&#8220;Given the military targets, and that millions of compromised keys are in circulation, this is not over,&#8221; he said.</p>
<p>EMC disclosed in March that hackers had broken into its network and stolen some information related to its SecurIDs. It said the information could potentially be used to reduce the effectiveness of those devices in securing customer networks.</p>
<p>EMC said it worked with the Department of Homeland Security to publish a note on the March attack, providing Web addresses to help firms identify where the attack might have come from.</p>
<p>It briefed individual customers on how to secure their systems. In a bid to ensure secrecy, the company required them to sign nondisclosure agreements promising not to discuss the advice that it provided in those sessions, according to two people familiar with the briefings. [In other words, &#8220;security through obscurity&#8221; &#8211; MY NOTE]</p>
<p>End Quotes</p>
<p>Fun quote: &#8220;Security experts say that it is virtually impossible for any company or government agency to build a security network that hackers will be unable to penetrate.&#8221;</p>
<p>i.e., &#8220;There is no security. Suck it up.&#8221; 🙂</p>
<p>These companies are precisely the ones I&#8217;d target if I was a hacker looking for some really juicy data to sell on the open market, say, to China, other Asian countries, the EU, Israel.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160756">

			<div class="comment by-an-ios-dev ">

				<p class="commentcredit">

					<span class="commenter">An iOS Dev</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160756">
						May 28, 2011 12:59 AM					</a>

				</p>

				<p>Re &#8216;Screenshots&#8217; being taken by iOS:<br />
True. iOS does that so that switching between Apps looks more fluent. Apple specifically points that out in their developer docs and warns devs to clear sensitive info from the display before an App relinquishes control.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160757">

			<div class="comment by-andrey-belenko ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.elcomsoft.com' rel='external nofollow ugc' class='url'>Andrey Belenko</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160757">
						May 28, 2011 1:38 AM					</a>

				</p>

				<p>@ aikimark</p>
<ol>
<li>We actually decrypt image (byte-by-byte) offline, on a PC. The on-line (on the device) phase includes extracting the keys (few seconds), obtaining filesystem image (if you don&#8217;t already have one; takes about 1 hour 30 minutes for 32 Gb iPhone, files in resulting image are encrypted), and, possibly, passcode bruteforce. Passcode bruteforce can&#8217;t be offline because it uses UID key which is currently undetachable from the device. Once you&#8217;ve got extracted keys and image you go to PC, and decrypt the image.</li>
<li>We try to address this by providing two-step process: obtain physical (encrypted) image and the decrypt it. This way the steps are reproducible. It is possible that vendors of mobile forensics toolkits will provide ability of on-the fly-decryption one day – and this will effectively eliminate the need of producing decrypted image and make whole process compliant to US regulations.</li>
<li>I do see some prejudice in press sometimes, but I&#8217;d say that things are much better than, say, 3 years ago. I can&#8217;t tell whether this affect sales or not because I&#8217;m not involved in sales.</li>
</ol>
<p>@ Chris: &#8220;what happens if iOS (N+1) is jailbreak-proof?&#8221;</p>
<p>This particular method relies on a jailbreak which can&#8217;t be fixed by iOS upgrade, so it will work for supported devices with any iOS version. The real thing is that Apple might well change data protection/encryption mechanisms in iOS 5 and this will require additional research.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160758">

			<div class="comment by-muzaffar-mahkamov ">

				<p class="commentcredit">

					<span class="commenter">Muzaffar Mahkamov</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160758">
						May 28, 2011 2:16 AM					</a>

				</p>

				<p>@Dirk Praet:<br />
I guess the security processor is most likely using some key derivation algorithm on the PIN before using it for key encryption (e.g.  mixing the PIN with a secret salt and hashing with SHA-256 in multiple rounds, giving 256-bit key at the output). That&#8217;s why the keys can be bruteforced on-chip only. Since you cannot obtain the secret salt without cracking the hardware, which is much more expensive &amp; cannot be automated, the resulting key encryption key is reasonably 256-bit strong.<br />
Ideally, the encryption keys should be stored in a (secure)  crypto processor which never reveals them, even to the OS. Then the PIN can be used only for authentication to the security processor. The data encryption/decryption would be done &#8216;on the chip&#8217;.<br />
But again, the security processor has to enforce a policy on the number of PIN attempts, otherwise everything else is useless.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160759">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160759">
						May 28, 2011 6:15 AM					</a>

				</p>

				<p>@ Muzaffar Mahkamov,</p>
<p>&#8220;Ideally, the encryption keys should be stored in a(secure) crypto processor which never reveals them, even to the OS&#8221;</p>
<p>Or as importantly the hardware.</p>
<p>There is a &#8220;Catch-22&#8221; situation with a lot of hardware which is verification of functionality during the manufacturing process. You have to be able to &#8220;excercise all functionality&#8221; as part of the test process.</p>
<p>This also applies to the chips etc., so if this test functionality is not built correctly it can leak information in one way or another alowing recovery of &#8220;hidden data&#8221; (Some Intel devices have been shown to suffer from this issue in the past).</p>
<p>As far as I&#8217;m aware there are no consumer grade secure CPU&#8217;s manufactured in places where the actual chip designs can be guaranteed not to be altered by others in some way prior to mainline production.</p>
<p>Further even when the chips are supposadly guarenteed to be &#8220;as designed&#8221; and payed for out of Mil budgets, the Chinese (for one) appear to be able to still get at data supposadly beyond recovery (as supposadly shown from the downed US aircraft).</p>
<p>So&#8230; If you have access to the actual device then it&#8217;s a reasonable chance it&#8217;s game over, irespective of the OS or other software.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160760">

			<div class="comment by-gabriel ">

				<p class="commentcredit">

					<span class="commenter">Gabriel</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160760">
						May 28, 2011 7:48 AM					</a>

				</p>

				<p>@Richard: I believe at the point she freed Solo, Leia would have been an insider threat. A mole who got in due to a lack of proper authentication and a certain crime lord&#8217;s affinity for ruthless scum like himself (by proving yourself willing to use a thermal detonator)</p>
<p>I thought the problem with locking down a phone, game console, and any other devices is that they either use software locks that can be exploited or they use hardware based encryption, which don&#8217;t have the robust key management required to thwart a determined attacker. Usually this is due to cost.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160761">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160761">
						May 28, 2011 11:29 AM					</a>

				</p>

				<p>@ Muzaffar Mahkamov</p>
<p>&#8220;e.g. mixing the PIN with a secret salt and hashing with SHA-256 in multiple rounds, giving 256-bit key at the output&#8221;</p>
<p>Good point. Ideally, yes, but since I&#8217;m not familiar with the specs of the security processor, I&#8217;m not taking that for granted. If there&#8217;s one thing I&#8217;ve learned in this business, then it&#8217;s that assumption is often the mother of all f*ck-ups. Some recent breaches have learned that even so-called security firms like HBGary didn&#8217;t bother to salt the password hashes in their database.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160762">

			<div class="comment by-richard-steven-hack ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.computerproblemssolvedcheap.com' rel='external nofollow ugc' class='url'>Richard Steven Hack</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160762">
						May 28, 2011 10:07 PM					</a>

				</p>

				<p>The Lockheed story is all over the news. I found this comment from PC Magazine funny as well as probably stupid:</p>
<p>&#8220;Classified information is likely out of hackers&#8217; hands: Due to the volume of attacks that these kinds of systems on a daily basis, it&#8217;s highly doubtful that Lockheed—or any security contractor—would keep top-secret information within reach, should one ever breach the remote access gates.&#8221;</p>
<p>If PC Magazine thinks classified info is only kept on boxes unattached to the internal network (let alone the external Internet), they are being really naive. I have no doubt that classified info is regularly kept on machines attached to the internal network.</p>
<p>ANY breach IS a breach and has the potential to be exploited beyond the initial breach location. That should be obvious. That it&#8217;s not always the case does not change that fact.</p>
<p>This Lockheed spokesman says: &#8220;we remain confident in the integrity of our robust, multilayered information systems security.&#8221;</p>
<p>And that remark is just stupid PR. ANY security person who &#8220;remains confident&#8221; of his security is by definition insecure.</p>
<p>And this: &#8220;According to a source, once Lockheed was made aware of the attack, the company began instigating new security measures to prevent future breaches. These included shutting down some of the company&#8217;s remote access capabilities on its systems, as well as a new order for 90,000 replacement SecurID tokens for the company&#8217;s employees. Users were also asked to change their passwords company-wide.&#8221;</p>
<p>Wow &#8211; employees had to change their passwords &#8211; which probably means they weren&#8217;t regularly changing them anyway. Way to inspire &#8220;confidence&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160763">

			<div class="comment by-richard-steven-hack ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.computerproblemssolvedcheap.com' rel='external nofollow ugc' class='url'>Richard Steven Hack</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160763">
						May 28, 2011 10:19 PM					</a>

				</p>

				<p>This is funny. Found this comment over at BoingBoing:</p>
<p>Quote</p>
<p>jackbird</p>
<p>I&#8217;ve done some on-site contract work for LMCO, and their IT is extremely tightly locked-down (and this is for non-clearance-requiring stuff).</p>
<p>So much so that employees have trouble doing things like provisioning servers.</p>
<p>So they end up running test servers off their home internet connections and other foolishness.</p>
<p>End Quote</p>
<p>Great. Sheer genius. Lockheed employees run their TEST SERVERS off their HOME networks.</p>
<p>Tell me again how &#8220;confident&#8221; they are about their security.</p>
<p>Note what this also proves yet again: that the more security you implement, the LESS secure your system becomes because your people start evading the security system to get work done.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160764">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160764">
						May 28, 2011 10:48 PM					</a>

				</p>

				<p>&#8220;Note what this also proves yet again: that the more security you implement, the LESS secure your system becomes because your people start evading the security system to get work done.&#8221;</p>
<p>It&#8217;s a recurring theme that looks unavoidable. It&#8217;s always about hitting the sweet spot between too little and too much.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160765">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160765">
						May 29, 2011 8:41 AM					</a>

				</p>

				<p>@ Muzaffar Mahkamov,</p>
<p>&#8220;Ideally, the encryption keys should be stored in a (secure) crypto processor which never reveals them, even to the OS. Then the PIN can be used only for authentication to the security processor. The data encryption/decryption would be done &#8216;on the chip&#8217;.&#8221;</p>
<p>I know a tiny bit about secure processor design, so let me say unequivocally, there is ABSOLUTELY no known way to store data on a chip that can not be recovered by a motivated well funded adversary.</p>
<p>The costs to rent the machine to help extract this information is about $1500/hr. It is conceivable that someone, with detailed knowledge of the  secure processor layout, could complete this key recovery task in under 2 hours.  It is also possible that a secure processor could be be opened-up have the stored keys extracted AND be put back into a system and still be completely functional. There might be some anti tamper &#8220;trip wires&#8221; to bypass, but most anti-tamper stuff is really just delays access, it has never been particularly problematic to bypass anti tamper systems.</p>
<p>So even in this extreme worst case, when a direct FIB attack on the Chip IC was required it could cost as little as $3000USD.</p>
<p>As Clive mentioned the normal approach to recovering data from a secure processor, is to find some way to re-enable a test mode circuit or repair a Lock-out-bit, these activities are trivial and cost just $100&#8217;s  primarily in labor costs. Often the lock-out functions can be made to work at some over / under voltage condition.  In these cases there is not even physical evidence that the chip was tampered with.</p>
<p>So before you trust your most valuable secrets to a &#8220;secure processor&#8221; I think you need to consider just how insecure even the best mil grade parts actually are.</p>
<p>The most important aspect of hiding a secret on an IC is protecting the database. So it is fundamentally security by obscurity, no one knows where to look for the answer.  This means believing that the adversary has neither extracted the database himself  (from a product he obtained) or procured a copy of the database from some willing lowly paid individual.</p>
<p>Just to empathizes this point, I have seen a situation where the person entrusted with managing the chip databases (and mask generation) was actually a high ranking employee of the Stasi. Now that was 20 years ago, but I&#8217;d say the that the desire to embedded your people into these key jobs has only increased over the last 20 years.<br />
For me what is truly disturbing. is that this key individual, probably now lives in S-Korea, Taiwan or China.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160766">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160766">
						May 29, 2011 12:49 PM					</a>

				</p>

				<p>@ Richard Steven Hack, Nick P,</p>
<p>&#8220;Note what this also proves yet again: that the more security you implement, the LESS secure your system becomes because your people star evading the security system to get work done.&#8221;</p>
<p>That appears to be the case, and as Nick P notes there might be a sweet spot. Or at some point the &#8220;see-saw&#8221; balances between &#8220;Usability -v- Security&#8221;.</p>
<p>However I&#8217;m going to go out on a bit of a limb here and say that it&#8217;s actually not true.</p>
<p>We know from other security activities that there appears to be atleast one other similar rule  &#8220;Efficiency -v- Security&#8221;.</p>
<p>But I know from designing some systems that it&#8217;s not a generalised case, there are some situations where with the correct knowledge &#8220;Efficiency -v- Security&#8221; is not an issue. That is you can design efficient systems that are secure.</p>
<p>But the designs have not been generalised systems but designed for very specific functions.</p>
<p>This tends to make me think that it is actually the same issue with regards to &#8220;Usability -v- security&#8221;, as long as we aim for &#8220;generalised&#8221; we will not achive the level of security we either want or need.</p>
<p>So the next time a requirments spec crosses your desk, get the big red marker pen out and as a first step remove all the marketing kruft/crud and gut it back to the bare minimum/essentials.</p>
<p>I firmly belive that security is a quality issue and exactly the same methods that give us quality products will give us secure products. What we have to give up is the &#8220;jack of all trades&#8221; attitude where our systems have to be &#8220;all things to all men&#8221; in &#8220;every possible way&#8221;. Then maybe without all the baggage our systems might stand a chance to get off the ground.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160767">

			<div class="comment by-asd ">

				<p class="commentcredit">

					<span class="commenter">asd</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160767">
						May 29, 2011 2:49 PM					</a>

				</p>

				<p>Does the chip need to be secure?. You could proable take of-the-shelve processor and run a program and data that is encrypted.<br />
Even weakness in the chip wouldn&#8217;t effect the data.<br />
Some people are trying to do this and say you could only do specfic tasks, but if you want to display text in a document viewer for etc, you could have a function that takes 16 bytes, and use xor/or/and to change that to one byt&#8221;e&#8221;.<br />
There would be multiable ways the 16 bytes could produce that one byte &#8220;e&#8221;, were the xor/or/and function is genertated on running or random function.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160768">

			<div class="comment by-asd ">

				<p class="commentcredit">

					<span class="commenter">asd</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160768">
						May 29, 2011 3:27 PM					</a>

				</p>

				<p>@Richard Steven Hack , The attack is proable a diversion. I would think if you going after a target like that you would get things setup so they would notice straight away, and if you can make them work to find something they will more likly be over-comfent it is the only one</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160769">

			<div class="comment by-asd ">

				<p class="commentcredit">

					<span class="commenter">asd</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160769">
						May 29, 2011 3:45 PM					</a>

				</p>

				<p>I bet there web server was pwned, and in say 1.5 months we will here a story that, the attackers had used a different door to access there internal network and are now dumping gigs of data 🙁</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160770">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160770">
						May 29, 2011 4:16 PM					</a>

				</p>

				<p>@ asd,</p>
<p>&#8220;Does the chip need to be secure?. You could proable take of-the-shelve processor and run a program and data that is encrypted.&#8221;</p>
<p>The idea is you are protecting a secret, it does not matter what the secret is, but you are trying to protect it. Usually the secret is data and it is kept by encrypting it against a key that in turn becomes the secret, thus you have not solved the problem of keeping a secret you have mearly moved it.</p>
<p>Currently if the hardware you use is owned at the chip internal circuit level then it means that in a single CPU system the secret must be known to the CPU therefore the circuitry that makes the chip owned can reveal the secret in some manner.</p>
<p>That is, with regards to encryption, obviously the program that goes into the ALU and programe control unit cannot be encrypted or it would not function the way intended. Which means at some point an encrypted program needs to be decoded. Wether it is in the instruction control unit or address decode unit or earlier realy does not much matter as the decryption key needs to be known and applied at some point and is thus available to the chip owning circuits.</p>
<p>Currently likewise with regards encrypted data (though this might change in time).</p>
<p>Currently there are some operations that you can do irrespective of the encryption type such as compare (provided it&#8217;s sized at an integer multiple of the encryption block size). And others such as add and subtract can be performed on &#8220;additive&#8221; ciphers provided over or underflow is addressed correctly.</p>
<p>However the bulk of manipulations that you might wish to apply to data cannot be done unless the data is decrypted first. This means that the key to the data has to be known to the CPU.</p>
<p>Which brings you back to the point that the key is available to the owning circuits.</p>
<p>Can the use of multiple CPU&#8217;s solve the issue, well yes and no&#8230; There are ways of sharing a secret amongst multiple parties without them knowing the whole secret. For instance look at the way a block cipher key is expanded into round keys. In theory each round key is expanded by a one way function from part or all of the actual cipher key. Provided the one way function is one way then it is not possible for the single round CPU to leak the cipher key because it is unknown to it. Further if whitening by stream cipher is employed to the data then the block cipher round CPU even if owned has little or no information to leak.</p>
<p>However you have actually now moved the problem from the block cipher to the stream cipher used for whitening the data both before and after encryption.</p>
<p>So the trick is coming up with some way such that not only is the secret shared only in part with any given CPU, but the CPU does not know what it&#8217;s part of the encryption/decryption or other function it is involved with. To do this means that you need another CPU or state machine responsable for dividing the work up amongst the CPU&#8217;s but also the data and the key. With care it should be possible to provide data switching etc such that the secret does remain in lots of unknown (to the adversary) pieces, but it is unlikely to be either efficient or fast.</p>
<p>It is however something I am looking into in my spare time as it is an area that interests me as a technical chalenge.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160771">

			<div class="comment by-asd ">

				<p class="commentcredit">

					<span class="commenter">asd</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160771">
						May 29, 2011 4:38 PM					</a>

				</p>

				<p>@Clive Robinson<br />
&#8220;However the bulk of manipulations that you might wish to apply to data cannot be done unless the data is decrypted first. This means that the key to the data has to be known to the CPU.&#8221;<br />
I type of understand what you mean, say, the code(binery) is encrypted with a basic encryption apart from the first block(the OS passes it a key), which then can be used to decode a group of instructions upto a call/jmp which then gets overriding and make it point back to the start to then decode more instructions(rinse/repeat)<br />
The code might be xored withe the key,then maybe rotated back to frount.<br />
The key the OS passes is genertated on the spot and before it start the binery it encodes the data.<br />
Even if the CPU can pass the key to a third party, there will be mutliabe keys that get randomly created or even changed by the binery itself and the old key will now longer beable to decode the binery(as long as the computer is runinng).<br />
For data a real encryption..truecrypt or whatever</p>
<p>It should stop exploit in software, unless the shellcode can carry the whole asm to run, as the binery code would be garbage</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160772">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160772">
						May 29, 2011 6:20 PM					</a>

				</p>

				<p>@ Clive</p>
<p>&#8220;So the next time a requirements spec crosses your desk, get the big red marker pen out and as a first step remove all the marketing kruft/crud and gut it back to the bare minimum/essentials.&#8221;</p>
<p>A similar result can generally be obtained by replacing the question &#8220;what do you want&#8221; by &#8220;what are you trying to achieve, and why&#8221;. In most cases, this approach is guaranteed to yield an entirely different spec.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160773">

			<div class="comment by-asd ">

				<p class="commentcredit">

					<span class="commenter">asd</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160773">
						May 29, 2011 9:22 PM					</a>

				</p>

				<p>@Clive Robinson<br />
&#8220;However the bulk of manipulations that you might wish to apply to data cannot be done unless the data is decrypted first. This means that the key to the data has to be known to the CPU.</p>
<p>Which brings you back to the point that the key is available to the owning circuits.&#8221;</p>
<p>Would a password you enter at the keyboard that gets sent to a program, the program displays a message(if g press t,cessar but more high tec), all the cpu would see would be the cessar cipher(mutlable) and keyboard inputs.<br />
The program might takes input (a hash) from a usb stick to generate &#8220;g&#8221;-&#8220;t&#8221;.<br />
How would the cpu know the password. Keyboard inputs? Weakness?<br />
Cheers</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160774">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160774">
						May 29, 2011 9:42 PM					</a>

				</p>

				<p>@asd,</p>
<p>Unfortunately with security there are no half measures. If you need to encrypt  the program it must use the same strength algorithms as data encryption, otherwise it is only a distraction (there is no real security increase rather you just have one more insecure task to do before obtaining the real program.</p>
<p>Many &#8220;secure processors&#8221; try to cheat with program encryption and just do something simple like XOR the program op-code with several Keys. This is trivial to undo because the opcode set size is only 8 bits or 16 bits. As a result the encrypted program looks like a simple substitution cypher. Simple frequency analysis techniques tell you which encrypted op-codes are the most common so by comparing this encrypted &#8220;most common instruction&#8221; with the  most common instruction for the processor core you can extract half the program.</p>
<p>The next level up is to XOR the PC address with the data (this is very common) but equally insecure. To do this  task properly you need to pick a sufficiently wide ROM Block size (say 256 bits) and encrypt this block. Now this is OK for linear programming BUT it is extremely inefficient for Calls and branches.</p>
<p>Oh in case I forgot to mention it, the decrypt key for the program needs to be stored on the chip, so this takes us back to the original system where the security is limited by your ability to hide the key in the chip circuitry&#8230;</p>
<p>For more secure mil type systems the program decrypt key is loaded into RAM at the beginning of the session, here it is typically stored as the sum/difference of several synchronous on chip counters.  Usually the individual counter segments are used as-is and the encryption algorithm is designed to do the addition / subtraction within the decode process. This way we never have a plain text copy of the KEY directly stored on chip at any time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160775">

			<div class="comment by-asd ">

				<p class="commentcredit">

					<span class="commenter">asd</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160775">
						May 30, 2011 3:25 AM					</a>

				</p>

				<p>@RobertT, would you have a probelm with frequency analysis, if you only ecoded small blocks(bound to be dupiclates code somewere), and would it be possable to use different keys for different blocks, but still beable to decode them latter, without storing to many keys in predictable places in memory(but easyly to find or workout for the code).<br />
Cipher or Hash?<br />
Cheers</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160776">

			<div class="comment by-ac2 ">

				<p class="commentcredit">

					<span class="commenter">AC2</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160776">
						May 30, 2011 3:36 AM					</a>

				</p>

				<p>@Clive</p>
<p>&#8221;<br />
Currently if the hardware you use is owned at the chip internal circuit level then it means that in a single CPU system the secret must be known to the CPU therefore the circuitry that makes the chip owned can reveal the secret in some manner.<br />
However the bulk of manipulations that you might wish to apply to data cannot be done unless the data is decrypted first. This means that the key to the data has to be known to the CPU.<br />
Which brings you back to the point that the key is available to the owning circuits.<br />
Can the use of multiple CPU&#8217;s solve the issue, well yes and no&#8230;<br />
&#8221;</p>
<p>Re data only, one way is an encrypted drive that has an independent user interface for key entry and which handles the decryption itself&#8230;</p>
<p>Eg a USB drive with a built-in PIN pad..</p>
<p><a href="http://www.crunchgear.com/2009/04/20/review-lenovo-thinkpad-keypad-protected-usb-drive/" rel="nofollow ugc">http://www.crunchgear.com/2009/04/20/review-lenovo-thinkpad-keypad-protected-usb-drive/</a></p>
<p>Of course you then have to trust the chip on the drive to not leak the key or get &#8216;owned&#8217;.</p>
<p>And any CPU will have the decrypted data available to it (if not the key), and that gap is applicable to this approach as well..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160777">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160777">
						May 30, 2011 5:55 AM					</a>

				</p>

				<p>@Asd<br />
&#8220;would you have a probelm with frequency analysis, if you only ecoded small blocks(bound to be dupiclates code somewere), and would it be possable to use different keys for different blocks&#8221;</p>
<p>Yes you can do this BUT this program cypher is definitely not a secure cypher, it is not even close to being secure. So anyone who understands what the was done can decypher the program quite easily.  You may say.. so what!, it is the data that must be secure not the program, however I would argue that each layer you add to the decryption problem adds to the time required.</p>
<p>Encrypting the program allows you to hide the nature of the cypher (I know its security by obscurity) but even simple program ossification adds a level of difficulty to the decrypt task.</p>
<p>All of this discussion does nothing to change my original point which is that IF the key is in any way stored on the chip than it can be recovered. So if you cannot maintain physical security of the product than you also cannot be absolutely certain that someone has not extracted the encryption key.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160779">

			<div class="comment by-vladk ">

				<p class="commentcredit">

					<span class="commenter">VladK</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160779">
						May 30, 2011 6:48 AM					</a>

				</p>

				<p>Wouldn&#8217;t Elcomsoft be reinventing the wheel ?<br />
<a href="http://www.cellebrite.com/fr/forensic-products/produits-dinvestigation-numerique/ufed-physical-pro.html" rel="nofollow ugc">http://www.cellebrite.com/fr/forensic-products/produits-dinvestigation-numerique/ufed-physical-pro.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-160780">

			<div class="comment by-andrey-belenko ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.elcomsoft.com' rel='external nofollow ugc' class='url'>Andrey Belenko</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160780">
						May 30, 2011 10:34 AM					</a>

				</p>

				<p>@VladK No, because all currently available products (including one you&#8217;re linking to) can&#8217;t decrypt that physical image they acquire. So you end up with a filesystem image in which files are encrypted.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-160781">

			<div class="comment by-jonadab ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mistersanity.blogspot.com/' rel='external nofollow ugc' class='url'>Jonadab</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/#comment-160781">
						May 31, 2011 5:31 AM					</a>

				</p>

				<blockquote><p>
  what happens if iOS (N+1) is jailbreak-proof?
</p></blockquote>
<p>Theoretically, I don&#8217;t know how they would accomplish that.  If the user has unlimited physical access to the device, then ipso facto the user ultimately has control over what software it runs (within limits &#8212; e.g., obviously, the software in question must be compiled for the correct architecture).  Many attempts have been made to prevent the user from being able to change a programmable device&#8217;s programming.  To my knowledge, the only such attempts that have succeeded were ones where the device was only produced in small numbers (and thus there were not many people working on the problem).</p>
<p>@ATN:  A multi-word password can have considerable complexity even if the attacker has a copy of your dictionary, assuming your dictionary is reasonably large.</p>
<p>The last time I did the calculation, using the dictionary file I had at the time on FreeBSD, umm, version 5, I think, I estimated that a password composed of three words contains slightly more complexity (37.1) than an eight-character password composed of arbitrary printable ASCII characters (i.e., anything you can easily type on a standard US keyboard &#8212; complexity 36.4).  The dictionary file on my current system (Debian Squeeze) appears to be somewhat smaller, but adding a fourth word more than overcomes that, yielding a complexity of 45.9.  The result, four words strung together, is still easier to remember than a traditional eight-character mixed-case alphanumeric password (complexity 33.0).</p>
<p>The disadvantage is that such a password takes a larger number of keypresses to type, which can be inconvenient, particularly for passwords that you type very frequently.  But they&#8217;re fantastic for passwords that you use more infrequently and have more trouble remembering.</p>
<p>(The complexity formula I used for the above numbers is simple:  natural log of the number of possible passwords.  Of course, if you choose your password in a way that makes some passwords much more likely than others, then your complexity is reduced.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2011/05/apples_ios_4_ha.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2011/05/apples_ios_4_ha.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2011%2F05%2Fapples_ios_4_ha.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2011/05/apples_ios_4_ha.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='3885' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2011/05/us_presidential.html" rel="prev">← U.S. Presidential Limo Defeated by Steep-Grade Parking Ramp</a>		<a href="https://www.schneier.com/blog/archives/2011/05/friday_squid_bl_280.html" rel="next">Friday Squid Blogging: Hand-Cut Paper Silhouette →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
