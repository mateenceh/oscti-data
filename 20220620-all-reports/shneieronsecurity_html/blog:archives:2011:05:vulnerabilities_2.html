<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Vulnerabilities in Online Payment Systems - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Vulnerabilities in Online Payment Systems Comments Feed" href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/3862" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=3862' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2011%2F05%2Fvulnerabilities_2.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2011%2F05%2Fvulnerabilities_2.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-3862 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-3862" class="post-3862 post type-post status-publish format-standard hentry category-uncategorized tag-banking tag-paypal tag-replay-attacks">

	<div class="article">

		<h2 class="entry">Vulnerabilities in Online Payment Systems</h2>
		<p>This <a href="http://www.newscientist.com/article/mg21028095.600-hackers-trick-goods-out-of-online-shopping-sites.html">hack</a> was conducted as a research project.  It&#8217;s unlikely it&#8217;s being done in the wild:</p>
<blockquote><p>In one attack, Wang and colleagues used a plug-in for the Firefox web browser to examine data being sent and received by the online retailer Buy.com. When users make a purchase, Buy.com directs them to PayPal. Once they have paid, PayPal sends Buy.com a confirmation message tagged with a code that identifies the transaction.</p>
<p>PayPal handles its side of the process securely, says Wang, but Buy.com was relatively easy to fool. First the team purchased an item and noted the confirmation code used by PayPal. Then they selected a second item on Buy.com but did not pay up. Instead, they used the code from the first transaction to fake a confirmation message, which Buy.com accepted as proof of payment.</p></blockquote>
<p>Paper <a href="http://research.microsoft.com/pubs/145858/caas-oakland-final.pdf ">here</a>.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/banking/" rel="tag">banking</a>, <a href="https://www.schneier.com/tag/paypal/" rel="tag">PayPal</a>, <a href="https://www.schneier.com/tag/replay-attacks/" rel="tag">replay attacks</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html" rel="bookmark">Posted on May 9, 2011 at 1:50 PM</a>			•
			<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html#comments">24 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html" data-title="Vulnerabilities in Online Payment Systems" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-159347">

			<div class="comment by-noah ">

				<p class="commentcredit">

					<span class="commenter">noah</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159347">
						May 9, 2011 2:09 PM					</a>

				</p>

				<p>I was implementing PayPal integration for an online store just last week and almost left a similar hole. I&#8217;d be surprised if it wasn&#8217;t being used in the wild.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-159348">

			<div class="comment by-andrew ">

				<p class="commentcredit">

					<span class="commenter">Andrew</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159348">
						May 9, 2011 2:21 PM					</a>

				</p>

				<p>May not have been before but after this went public I&#8217;m sure it is now.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-159349">

			<div class="comment by-atul-agarwal ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.secfence.com' rel='external nofollow ugc' class='url'>Atul Agarwal</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159349">
						May 9, 2011 2:23 PM					</a>

				</p>

				<p>Interesting..</p>
<p>I haven&#8217;t extensively looked into this, but I think the PayPal&#8217;s IPN system solves this problem.</p>
<p>&#8220;The IPN message is not actually part of the response sent to your website. Rather, the IPN message is sent to the your listener, which allows you to take actions that are not directly tied to the operation of your website.&#8221;</p>
<p>Source : <a href="https://cms.paypal.com/cgi-bin/marketingweb?cmd=_render-content&#038;content_ID=developer/e_howto_admin_IPNIntro" rel="nofollow ugc">https://cms.paypal.com/cgi-bin/marketingweb?cmd=_render-content&#038;content_ID=developer/e_howto_admin_IPNIntro</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-159350">

			<div class="comment by-kaur ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.kaurkuut.com/' rel='external nofollow ugc' class='url'>Kaur</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159350">
						May 9, 2011 2:49 PM					</a>

				</p>

				<p>This is definetly being done in the wild. Every &gt;1000 user site I&#8217;ve built that has paypal has experienced several attack attempts similar to this.</p>
<p>The IPN can be used to solve it somewhat but one other big mistake that people seem to do is not double-check the amount payed. People are trying to attack it by completing the whole process but changing the amount the pay.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-159351">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159351">
						May 9, 2011 3:39 PM					</a>

				</p>

				<p>Isn&#8217;t this basically a replay attack? Replay attacks are a common attack strategy in the wild for hitting any kind of e-commerce site. It&#8217;s very shoddy design work on buy.com&#8217;s part, violating best practices in validation.</p>
<p>I&#8217;d also be surprised if something like this hasn&#8217;t been done in the wild. Are today&#8217;s crackers so used to things like metasploit and premade infection kits that they no longer can identify simple opportunities such as this?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-159352">

			<div class="comment by-walter ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://walterjohnstone.com' rel='external nofollow ugc' class='url'>Walter</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159352">
						May 9, 2011 3:42 PM					</a>

				</p>

				<p>I have had the unfortunate experience of working on quite a few sites that were all susceptible to this type of attack.  It is quite common on small sites where there isn&#8217;t a high risk of scammers.  Or where the owner prefers the quick and dirty over secure (or the original developer was just incompetent).<br />
Fortunately all the quick and dirty solutions I&#8217;ve seen were breaking down because of technical reasons before they could be abused.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-159353">

			<div class="comment by-christopher ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.christopher-kunz.de' rel='external nofollow ugc' class='url'>Christopher</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159353">
						May 9, 2011 4:26 PM					</a>

				</p>

				<p>There are indeed two different methods of payment data transmission in place at PayPal.</p>
<p>PDT is the one abused in the paper. It employs a transaction ID that is reusable by the attacker if the attacked online shop doesn&#8217;t stick to PP&#8217;s development guidelines. They are rather verbose about this issue at PayPal.</p>
<p>IPN, the one mentioned by you, Atul, doesn&#8217;t piggyback payment processing info onto the customer&#8217;s browsing session, but the paper still shows an angle against it (although I am too tired to look if it&#8217;s actually valid, and the paper&#8217;s presentation is exceptionally bad).</p>
<p>All in all, I think IPN is a lot safer, but PDT is a lot easier to hack down for the average web developer. So here we are again, with the old balance of security and commodity.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-159354">

			<div class="comment by-steve-parker ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://steve-parker.org/book' rel='external nofollow ugc' class='url'>Steve Parker</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159354">
						May 9, 2011 6:08 PM					</a>

				</p>

				<p>I&#8217;ve been selling PDFs online since 2004, and have covered this from day one. It is clearly documented in the PayPal notes (or it was then, I haven&#8217;t read them closely since). The merchant site gets a key to verify the transaction, and can validate every part of the transaction (currency, value, etc). That is what the &#8220;Return to Merchant&#8221; button is for.</p>
<p>It would be nice if PayPal could find a way to tell a merchant that a customer went through the whole process but didn&#8217;t notice the &#8220;Return to Merchant&#8221; button on the Paypal site; when that happens, customers pay but do not get their files, because my website has not received any kind of notification that the payment has been made.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-159355">

			<div class="comment by-tommy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.amiright.com/parody/60s/thebeatles1718.shtml' rel='external nofollow ugc' class='url'>tommy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159355">
						May 9, 2011 6:49 PM					</a>

				</p>

				<p>The very concept of PayPal and their business model stunk when first I heard about it. Never used it from the beginning, never will. This, and other exploits, really shouldn&#8217;t surprise anyone remotely concerned with security.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-159356">

			<div class="comment by-cuddlefish ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://ubitex.org' rel='external nofollow ugc' class='url'>cuddlefish</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159356">
						May 9, 2011 9:45 PM					</a>

				</p>

				<p>Bitcoin is an&#8230; interesting solution to this problem. Of course, companies who don&#8217;t host their own daemons and instead rely on an e-wallet will have basically the same problems.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-159357">

			<div class="comment by-cuddlefish ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://ubitex.org' rel='external nofollow ugc' class='url'>cuddlefish</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159357">
						May 9, 2011 9:50 PM					</a>

				</p>

				<p>Oh, wait, no. MyBitcoin (the most popular e-wallet) GPG-signs all its outgoing data. So I guess that&#8217;s more secure.</p>
<p>On a side note, why aren&#8217;t more payment processors doing that?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-159358">

			<div class="comment by-daniel-wijk ">

				<p class="commentcredit">

					<span class="commenter">Daniel Wijk</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159358">
						May 10, 2011 2:19 AM					</a>

				</p>

				<p>Another interesting vulnerability I discovered when making a purchased a couple of months back was that the web-shop I used did not check the items payed for versus the items in my shopping bag.</p>
<p>When I accidentally added another item into my shopping bag while paying the company thanked me for purchasing item A and B although I only payed for item A.</p>
<p>I contacted the web-shop asap when the receipt came to my email address and I discovered I had payed for just 1 item but where promised a delivery of two. Sadly (for the web-shop) they never replied me despite trying to both phone them, email them and using their &#8220;24/7 online support&#8221; and I got two items for the price of one. I still haven&#8217;t heard anything from them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-159359">

			<div class="comment by-danny-moules ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.rushyo.com' rel='external nofollow ugc' class='url'>Danny Moules</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159359">
						May 10, 2011 3:28 AM					</a>

				</p>

				<p>Of course PayPal provide solutions to prevent this being a problem but that doesn&#8217;t mean individual implementations actually make use of it properly.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-159360">

			<div class="comment by-adam ">

				<p class="commentcredit">

					<span class="commenter">Adam</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159360">
						May 10, 2011 3:29 AM					</a>

				</p>

				<p>Cuddlefish, Bitcoin is interesting, but who&#8217;s to say it&#8217;s not vulnerable to it&#8217;s own manner of attacks? After all what&#8217;s to stop someone grinding the whole network to a halt by flooding clients with bogus transactions or transactions for very trivial amounts, e.g. two bitcoin clients ping ponging a 0.00000001 BC transaction back and forth a billion times. At the very least you could probably make the entire system chug. At worst, well you might be able to corrupt people&#8217;s wallets which I suspect in most cases are not backed up.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-159361">

			<div class="comment by-kaur ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.kaurkuut.com/' rel='external nofollow ugc' class='url'>Kaur</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159361">
						May 10, 2011 7:14 AM					</a>

				</p>

				<p>@Adam</p>
<p>Currently every bitcoin transaction that is for an amount less than 0.01 will need to include a transaction fee of at least 0.01. This is exactly to combat a potential attack. These exact numbers are enforced by miners and as such can be changed on the fly. It&#8217;s also possible to set up your own miner that will allow transactions of very small fractions without a fee.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-159362">

			<div class="comment by-adam ">

				<p class="commentcredit">

					<span class="commenter">Adam</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159362">
						May 10, 2011 8:32 AM					</a>

				</p>

				<p>@Kaur, fair enough but what if I transfer 0.01 then? Or 1 BC? I could even fraudulently buy a pot of bitcoins through one of the various exchanges, allocate the coins to various machines set up in any arbitrary configuration I liked and continuously start transactions between them. I expect at the moment that my traffic would vastly exceed the rest of the network combined and I&#8217;d probably swamp it at the very least.</p>
<p>I just think the thing is untested and likely to be very fragile.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-159363">

			<div class="comment by-anton ">

				<p class="commentcredit">

					<span class="commenter">Anton</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159363">
						May 10, 2011 11:09 AM					</a>

				</p>

				<p>A similair attack was used some time ago in the Netherlands. A webshop to order food, justeat.nl, had a flawed iDeal implementation (iDeal is a payment system by the dutch banks similair to paypal) . It allowed an attacker to intercept the request to iDeal and modify the amount of money to pay. After the transaction the site didn&#8217;t verify the amount payed.</p>
<p>This hack became quite popular with students in the whole country. About 30.000 euro damage was done when it was discovered, but most of it was payed back by the students.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-159364">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159364">
						May 10, 2011 6:15 PM					</a>

				</p>

				<p>One of the problems I see is that several e-commerce systems offer 3rd party payment plugins that haven&#8217;t necessarily been scrutinized for security by the main developer team. And thus get implemented no questions asked by quite some people that are more concerned with a slick look-and-feel than what is actually under the hood. By the time the shop gets defrauded, most bills are paid and both shopkeeper and customer get told a story of evil hackers or Chinese APT&#8217;s nobody has any defense against.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-159365">

			<div class="comment by-roger-wolff ">

				<p class="commentcredit">

					<span class="commenter">Roger Wolff</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159365">
						May 11, 2011 3:44 AM					</a>

				</p>

				<p>@adam, re bitcoin.</p>
<p>The developers have put a lot of thought into protecting the bitcoin network against all sorts of attacks, including the ones brought up by you.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-159366">

			<div class="comment by-daniel-wijk ">

				<p class="commentcredit">

					<span class="commenter">Daniel Wijk</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159366">
						May 11, 2011 5:36 AM					</a>

				</p>

				<p>Adam: If you think its untested and likely to be fragile then by all means share your thoughts with the developers and see what they say about your thoughts.</p>
<p>Only good things can come out of critical thinking and constructive criticism.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-159367">

			<div class="comment by-doug-coulter ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.coultersmithing.com/forums' rel='external nofollow ugc' class='url'>Doug Coulter</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159367">
						May 11, 2011 12:11 PM					</a>

				</p>

				<p>I know, I didn&#8217;t RTFA and this isn&#8217;t slashdot, but:</p>
<p>Wouldn&#8217;t anyone be putting those tokens from Paypal in a database for their records (maybe required to balance the books anyway and make sure Paypal wasn&#8217;t ripping them off), and wouldn&#8217;t it be trivial to do a search on each new token to prevent any playback?  Does Paypal not make them unique?  They&#8217;d have to, wouldn&#8217;t they?</p>
<p>//</p>
<p>Despite them not being the guilty party here, I think Paypal is a disaster waiting to happen.  They are getting to act like a bank without even the minimal regulation that has shown to be not good enough even for those banks subjected to it.</p>
<p>It&#8217;s a big waving red flag most people ignore out of &#8220;it works and I&#8217;m lazy&#8221;.  Well,,,,,look what happened last time &#8212; want more?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-159368">

			<div class="comment by-tangurena ">

				<p class="commentcredit">

					<span class="commenter">Tangurena</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159368">
						May 11, 2011 1:07 PM					</a>

				</p>

				<p>Pay.gov (run by the federal reserve bank of Cleveland) avoids this problem by using a separate back channel to submit payment details to the &#8220;merchant&#8221; (some government agency). That back channel uses certificates which have to be previously distributed, so this avoids man-in-the-middle attacks. They also avoid the &#8220;return to merchant&#8221; button problem by redirecting the user back to the originating site.</p>
<p>I worked on one government website that brought in about 1/4 billion/year in taxes/fees/revenue this way.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-159369">

			<div class="comment by-kaur ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.kaurkuut.com/' rel='external nofollow ugc' class='url'>Kaur</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159369">
						May 11, 2011 1:08 PM					</a>

				</p>

				<p>@Adam</p>
<p>The total transaction block size limit is 512KB I belive. The storage is provided to transactions prioritized by the included transaction fees. So if you make a bunch of useless transactions and fill up the space then regular users will essentially have to outbid you for that space by including a higher transaction fee. So in order to not completely be ignored you have to start including transaction fees yourself. These fees come from your wallet and go into the winning miner&#8217;s wallet. Basically, this attack will get real expensive real fast.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-159370">

			<div class="comment by-ross ">

				<p class="commentcredit">

					<span class="commenter">Ross</span> •

					<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/#comment-159370">
						May 13, 2011 2:32 PM					</a>

				</p>

				<p>@Doug: yes, it&#8217;s really easy to do protections like you note &#8212; verify no duplicate transaction IDs. I do that on my site. I also use PayPal&#8217;s other tools which both verify the transaction amount and prevent against the article&#8217;s attack if you use them right.</p>
<p>I&#8217;ve also got the benefit of working in digital goods inside a game, so if anyone really tried to scam me I&#8217;d just terminate their account.</p>
<p>Like Steve Parker, one of my biggest problems is the &#8220;customer failed to return to the website&#8221; issue. I tend to assume it&#8217;s user error (not waiting for the forwarder, not seeing the backup link) but it happens enough some of it may be PayPal. One way or the other, I get a lot of follow up emails that the automatic delivery didn&#8217;t work.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2011/05/vulnerabilities_2.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2011/05/vulnerabilities_2.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2011%2F05%2Fvulnerabilities_2.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2011/05/vulnerabilities_2.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='3862' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2011/05/status_report_t.html" rel="prev">← Status Report: <i>The Dishonest Minority</i></a>		<a href="https://www.schneier.com/blog/archives/2011/05/the_era_of_stea.html" rel="next">The Era of "Steal Everything" →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
