<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>TDSS Rootkit - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; TDSS Rootkit Comments Feed" href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/3935" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=3935' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2011%2F07%2Ftdss_rootkit.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2011%2F07%2Ftdss_rootkit.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-3935 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-3935" class="post-3935 post type-post status-publish format-standard hentry category-uncategorized tag-economics-of-security tag-kaspersky tag-malware tag-operating-systems tag-rootkits">

	<div class="article">

		<h2 class="entry">TDSS Rootkit</h2>
		<p>There&#8217;s a <a href="http://www.theregister.co.uk/2011/06/29/tdss_alureon_advances/">new version</a>:</p>
<blockquote><p>The latest TDL-4 version of the rootkit, which is used as a persistent backdoor to install other types of malware, infected 4.52 million machines in the first three months of this year, according to a <a href="http://www.securelist.com/en/analysis/204792180/TDL4_Top_Bot">detailed technical analysis</a> published Wednesday by antivirus firm Kaspersky Lab. Almost a third of the compromised machines were located in the United States. With successful attacks on US-based PCs fetching premium fees, those behind the infections likely earned $250,000 on that demographic alone.</p>
<p>TDL-4 is endowed with an array of improvements over TDL-3 and previous versions of the rootkit, which is also known as Alureon or just TDL. As previously reported, it is now <a href="http://www.theregister.co.uk/2010/11/16/tdl_rootkit_does_64_bit_windows/">able to infect 64-bit versions of Windows</a> by bypassing the OS&#8217;s kernel mode code signing policy, which was designed to allow drivers to be installed only when they have been digitally signed by a trusted source. Its ability to create ad-hoc DHCP servers on networks also gives the latest version <a href="http://www.theregister.co.uk/2011/06/03/tdss_self_propagation_powers/">new propagation powers</a>.</p></blockquote>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/economics-of-security/" rel="tag">economics of security</a>, <a href="https://www.schneier.com/tag/kaspersky/" rel="tag">Kaspersky</a>, <a href="https://www.schneier.com/tag/malware/" rel="tag">malware</a>, <a href="https://www.schneier.com/tag/operating-systems/" rel="tag">operating systems</a>, <a href="https://www.schneier.com/tag/rootkits/" rel="tag">rootkits</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html" rel="bookmark">Posted on July 1, 2011 at 12:08 PM</a>			•
			<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html#comments">108 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html" data-title="TDSS Rootkit" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-163400">

			<div class="comment by-al ">

				<p class="commentcredit">

					<span class="commenter">al</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163400">
						July 1, 2011 12:51 PM					</a>

				</p>

				<p>hmmm&#8230;the The Register article states that:</p>
<p>&#8220;The first is by infecting removable media drives with a file that gets executed each time a computer connects to the device.&#8221;</p>
<p>Brings us to that USB stick issue Bruce just blogged about.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163401">

			<div class="comment by-al ">

				<p class="commentcredit">

					<span class="commenter">al</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163401">
						July 1, 2011 12:54 PM					</a>

				</p>

				<p>&#8230;and this feature (also from the The Register article) would probably spread the bot in places where infected PC is sharing the network (Starbucks, open Wifi, etc)&#8230;</p>
<p>&#8220;The second method is to spread over local area networks by creating a rogue DHCP server and waiting for attached machines to request an IP address. When the malware finds a request, it responds with a valid address on the LAN and an address to a malicious DNS server under the control of the rootkit authors. The DNS server then redirects the targeted machine to malicious webpages.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163402">

			<div class="comment by-alan-kaminsky ">

				<p class="commentcredit">

					<span class="commenter">Alan Kaminsky</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163402">
						July 1, 2011 1:59 PM					</a>

				</p>

				<p>From the linked article (<a href="http://www.securelist.com/en/analysis/204792180/TDL4_Top_Bot" rel="nofollow ugc">http://www.securelist.com/en/analysis/204792180/TDL4_Top_Bot</a>):</p>
<p>&#8220;When developing the kad.dll module for maintaining communication with the Kad network, code with a GPL license was used — this means that the authors [of TDL-4] are in violation of a licensing agreement.&#8221;</p>
<p>So there&#8217;s no need to fear! Richard Stallman will save us from this pernicious GPL-violating rootkit!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163403">

			<div class="comment by-foosion ">

				<p class="commentcredit">

					<span class="commenter">foosion</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163403">
						July 1, 2011 2:06 PM					</a>

				</p>

				<p>How does one detect and remove this?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163404">

			<div class="comment by-timothy-keith ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.keithieopia.com/' rel='external nofollow ugc' class='url'>Timothy Keith</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163404">
						July 1, 2011 4:13 PM					</a>

				</p>

				<p>&#8220;How does one detect and remove this?&#8221;<br />
-foosion</p>
<p>Pretty much the normal ways one detects malware&#8230; if you find most of your removal tools (AVs, etc) are being killed when ran regardless of being in safe mode or not, you&#8217;re probably dealing with a ring0 rootkit like TDSS.</p>
<p>Kaspersky has a free tool called TDSSKiller that will remove the rootkit from the kernel, then you can use your tools to clean the infection.</p>
<p>Make sure you run scandisk afterwards, the several infections I&#8217;ve dealt with have corrupted parts of the filesystem in some degree&#8230; although this might be malware that simply uses TDSS, and not TDSS itself.</p>
<p>Your best and safest bet is probably to backup your files with a known safe bootable OS and do a complete reinstall.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163405">

			<div class="comment by-tommy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.amiright.com/parody/60s/thebeatles1949.shtml' rel='external nofollow ugc' class='url'>tommy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163405">
						July 1, 2011 8:04 PM					</a>

				</p>

				<p>Calling Nick P&#8230;. Calling Nick P&#8230;. The market demand for your eventual high-assurance hw and OS just grew a little more, and will continue to do so&#8230;</p>
<p>Apparently, my 32-bit XP is as safe as any Win7, since the new security features seem to be so easily defeasible.</p>
<p>Perhaps the MBR should be hard-coded into firmware or hw,  requiring some type of actual physical access or physical token to modify? Just a thought.</p>
<p>@ Timothy Keith:</p>
<p>Probably even safer to nuke the drive first, perhaps with Darik&#8217;s Boot And Nuke, or with a tool like Eraser that overwrites it many times with random data, before reformatting and reinstalling.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163406">

			<div class="comment by-carl-sai-mitchell ">

				<p class="commentcredit">

					<span class="commenter">Carl &#039;SAI&#039; Mitchell</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163406">
						July 1, 2011 9:29 PM					</a>

				</p>

				<p>Never assume that a rootkit can be removed from an infected system. Use a LiveCD to scan for and remove such malware.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163407">

			<div class="comment by-timothy-keith ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.keithieopia.com/' rel='external nofollow ugc' class='url'>Timothy Keith</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163407">
						July 2, 2011 12:25 AM					</a>

				</p>

				<p>@ Tommy<br />
Only if your foes have electron microscopes 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163408">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163408">
						July 2, 2011 12:39 AM					</a>

				</p>

				<p>@ tommy</p>
<p>&#8220;Calling Nick P&#8230;. Calling Nick P&#8230;. The market demand for your eventual high-assurance hw and OS just grew a little more, and will continue to do so&#8230; &#8221;</p>
<p>It goes up and it goes down. I&#8217;ve decided, though, that I&#8217;m tired of catering to those who don&#8217;t look after themselves. I was seriously considering leaving IT security but its my passion &amp; I have too much vested in it. So, I figure I&#8217;ll take a Theo de Raadt stance (paraphrased in my words): &#8220;we don&#8217;t add those features or do it that way because we don&#8217;t build it for you. we build it for us. we want portable, reliable, clean, secure code. anything else takes a back seat.&#8221; Might be a better way to go. 😉</p>
<p>&#8220;Perhaps the MBR should be hard-coded into firmware or hw, requiring some type of actual physical access or physical token to modify? Just a thought. &#8221;</p>
<p>Nah. MBR protection is already built into TPM schemes and even TrueCrypt that I&#8217;m aware of. The idea is that the peripheral components, like hard disks, should be considered untrusted. The best method uses an embedded private key to sign the clean version of the software. So, when it&#8217;s loaded (or before), it can be hashed &amp; checked. If the check passes, the firmware passes execution control over to it.</p>
<p>I often apply this to the firmware in my designs. The idea is that a small, high assurance component wouldn&#8217;t need to be fixed (hopefully). This does nothing but load the firmware and verify its signature. Then, the firmware would do self-tests of the hardware, load/verify the software, and give it control. This means that only a tiny piece of functionality truly need to be trusted and architected with the highest assurance. The rest can be gradually built on and improved via patches/updates if necessary.</p>
<p>This rootkit changes nothing. It doesn&#8217;t really change anything in any way so far as security issues go. The architectures and principles that lead to trustworthy devices still defeat this rootkit. The &#8220;penetrate and patch&#8221;, bloatware approach fails even more. I have to say that I agree with that minority of security professionals: I loved LulzSec and miss them. They, and people like them, showed just how pathetically weak the current security approach is. They gave more robust solutions some free advertising by making many lay people ask their geek friends: &#8220;How could anyone avoid this stuff?&#8221; The answers vary, but probably made us all safer. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163409">

			<div class="comment by-mesrik ">

				<p class="commentcredit">

					<span class="commenter">mesrik</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163409">
						July 2, 2011 3:30 AM					</a>

				</p>

				<p>FYI,</p>
<p>On network edge the dhcp-snooping and DHCP option 82 has been widely available many moons (4-5 yrs) already to managed switches .</p>
<p>If there are still sites which don&#8217;t block DHCP-servers on unauthorized ports you should definitely expect good explanation from your network management and fail to approve anything but yes sir, we&#8217;ll do it right away!</p>
<p>I recommend also enabling DAI (Dynamic Arp Inspection) on Cisco switches and ARP protection  on HP switches. Both allow traffic only from DHCP provided addresses from the port.</p>
<p>Port security and reasonable mac-address limits should also be enabled  everywhere but absolutely not possible.</p>
<p>Those are most important L2 level protections available and used today.</p>
<p>Lot of problems can be avoided by proper network equipment configurations and there is no real good reason not to use it.</p>
<p>Only if you run with zero-budjet and haven&#8217;t been able to purchase new gear in 5 years you are mostly out of luck.</p>
<p>But then, you should reconsider is it worth being vulnerable as these kind of issues can be avoided by uprading those old switches up to date. Prices of the proper managed switches is very reasonable today compared what they were 5-10 years ago.</p>
<p>Cheers,</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163410">

			<div class="comment by-tommy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.amiright.com/parody/60s/thetokens15.shtml' rel='external nofollow ugc' class='url'>tommy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163410">
						July 2, 2011 4:01 AM					</a>

				</p>

				<p>@ Timothy Keith:</p>
<p>I read somewhere that some malware, especially in MBR, can survive a reformat. Don&#8217;t remember where; didn&#8217;t dig into the details; perhaps I hallucinated it. Hence the step of nuking before reformatting, not for privacy, but to be sure the malware is truly off of every sector of the drive.</p>
<p>@ Nick P.: Can you confirm or deny the above vague memory from some years back, about malware surviving reformatting?</p>
<p>&#8220;portable, reliable, clean, secure code. anything else takes a back seat.&#8221;</p>
<p>Works for me. Let me know when you have something ready to test. Will gladly give it a test drive, although it would still have to run on my x86 machines, unless you&#8217;ll lend the machine, too. 😉</p>
<p>As usual, you&#8217;re way ahead of the crowd   with your designs for the single HA module building a chain of trust. The issue here was MS&#8217;s claim that only drivers with digital signatures from trusted authorities could be loaded. And  that just went down the drain. They&#8217;re trying to lock it from above or from the side; you&#8217;re locking it from below. Much better.</p>
<p>I know the &#8220;increased demand&#8221; was a bit of an exaggeration, but as each new attempt to patch at the OS or kernel level or MBR level fails (ASLR, anyone?), it adds to the growing body of evidence that your path is probably the only hope.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163411">

			<div class="comment by-mesrik ">

				<p class="commentcredit">

					<span class="commenter">mesrik</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163411">
						July 2, 2011 4:18 AM					</a>

				</p>

				<p>One more comment, about MBR &amp; OS-bootsector infecting rootkits.</p>
<p>I believe that a bit twisted pc&#8217;s boot system should be enough to circumwent these kind of problems.</p>
<p>First, pc should boot always from attached read-only flash drive (microSD, SDHC,&#8230;) unless you keep pressed some sufficently hard key combination (A-F-H-L) and that doesn&#8217;t exsist fail to boot showing kind message why boot failed.</p>
<p>Now, if you press that combination you can boot directly from HD, CD, DVD, USB, NET, &#8230; etc.</p>
<p>But the whole point is that pressing those keys every time is tedious and booting from that microSD which is prepared before OS-install would enable many usefull features and while it must be hardware write-protected manually it won&#8217;t easily be tampered.</p>
<p>On that microSD you would have an advanced mini OS (EFI, kind of) which then would be able to verify the boot sectors of the chain booted OS&#8217;s before launching them, set up full encrypted HD etc. Have a capability to contact OS makers support site and verify system even deeper etc.</p>
<p>So, what&#8217;s the difference with TPM? A lot ofcourse, but most importantly it would be open system, you could any time pop that microSD from slot, make a copy and verify it. No risk at tweaking for those who like to do that. And it wouldn&#8217;t be too expensive either as it uses common easily available technology already in wide use.</p>
<p>Sure we would have some occations where dog ate that microSD and people would complain, but most parts it would not be problem.</p>
<p>Just to think of it makes me wonder why we don&#8217;t have these already?</p>
<p>Cheers,</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163412">

			<div class="comment by-andy ">

				<p class="commentcredit">

					<span class="commenter">Andy</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163412">
						July 2, 2011 5:23 AM					</a>

				</p>

				<p>Not at me but..&#8221;Can you confirm or deny the above vague memory from some years back, about malware surviving reformatting? &#8221;<br />
You can mark parts of HDD as bad sectors and the hdd will skip them, even thought they might not be bad, to remark them as good bios/graphics what not or &#8220;hypthical&#8221; some logic code stuff up if the computer code is place on the hdd at the same place.<br />
something like fff0h.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163413">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163413">
						July 2, 2011 8:47 AM					</a>

				</p>

				<p>@ tommy,</p>
<p>&#8220;Can you confirm or deny the above vague memory from some years back, about malware surviving reformatting?&#8221;</p>
<p>It rather depends on what you mean by &#8220;reformatting&#8221;, there were at one time or another four names attached &#8220;High level&#8221;, &#8220;Low level&#8221;, &#8220;Fast&#8221; and &#8220;Full&#8221;.</p>
<p>Back when HD&#8217;s had two ribbon cables (data and control) and MFM encoding was considered &#8220;neat&#8221; the &#8220;High Level format&#8221; was carried out by the OS and the &#8220;Low Level format&#8221; carried out by the HD Hardware. Even the original &#8220;Shugart Asoc System Interface&#8221; (SASI) which later became &#8220;Shugart Compatible Systems Interface&#8221; (SCSI) and standardized as the &#8220;Small Computer Systems Interface One&#8221; (SCSI-1) had a command for the drive to &#8220;self-format&#8221; which at the time was the only way to make a &#8220;bad block table&#8221;. So any malware could hide from &#8220;High Level Formats&#8221; provided it could &#8220;refind&#8221; it&#8217;s self after the process.</p>
<p>at one time a fast reformat simply ment reseting the first charecter of each entry in the File Allocation Table, in just the same way as &#8216;del <em>.</em>&#8216;.</p>
<p>Often formating a drive very specificaly avoided the whole first cylinder (and still does) and you had to force rewriting of the MBR with the /MBR flag to FDISK which would only over write the first 512byte sector of cylinder 0.</p>
<p>Few reformats used to go to every byte of the hard drive and change them to known values (even now this is avoided due to the time involved).</p>
<p>And many of those that claim to, still make the mistake of reading the disk size etc back off of the HD before doing it or ignoring cylinder 0.</p>
<p>Thus some software / malware new/knows how to hide &#8220;beyond&#8221; the end of the drive or in cyclinder 0.</p>
<p>The problem with increasing drive size got quite bad due to MicroSoft&#8217;s in built assumptions about the number of heads/platters, cylinders and their sizes.</p>
<p>For those old enough back in the late 1980&#8217;s &#8220;Compaq Computers&#8221; brought out a hard disk system that was larger than MS Desktop OS&#8217;s could handle, so they came up with a typical kludge to get around the problem. It was the knowledge of how to do this that a short while later gave rise to malware manipulating the HD drive size parameters.</p>
<p>Even NT 4 still suffered from in built assumptions as to drive size for the boot disk, and who remembers the Linux issue with /root having to be entirely inside of the first 1024 cylinder limit for LILO to work?</p>
<p>Then there was the flaky issue of drive partitions and MS assumptions that they would always end at the end of a cylinder etc.</p>
<p>The list goes on some, and many of these can be used or have been used as refuges for malware in one way or another.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163414">

			<div class="comment by-simon-zerafa ">

				<p class="commentcredit">

					<span class="commenter">Simon Zerafa</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163414">
						July 2, 2011 10:23 AM					</a>

				</p>

				<p>Hi,</p>
<p>Firstly TDL4 is not that new; it&#8217;s been in the wild since July 2010 (v0.01).</p>
<p>The current current v0.03 variants were first seen in April 2011.</p>
<p>This rootkit has been in the wild for about a year!</p>
<p>It&#8217;s fairly easy to remove TDL4 TDL3 and the earlier TDSS rootkits using publically available tools such as the Kaspersky TDSSKiller:</p>
<p><a href="http://support.kaspersky.com/viruses/solutions?qid=208280684" rel="nofollow ugc">http://support.kaspersky.com/viruses/solutions?qid=208280684</a></p>
<p>It&#8217;s updated regularly and does a good job of detecting and removing these rookits.</p>
<p>Regards</p>
<p>Simon</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163415">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163415">
						July 2, 2011 1:29 PM					</a>

				</p>

				<p>@ tommy</p>
<p>&#8220;Can you confirm or deny the above vague memory from some years back, about malware surviving reformatting? &#8221;</p>
<p>What they said. Additionally, it depends where the malware persists. If it&#8217;s a BIOS malware or in PCI device firmware, it will survive any activity on the harddisk.</p>
<p>&#8220;As usual, you&#8217;re way ahead of the crowd with your designs for the single HA module building a chain of trust. &#8221;</p>
<p>I learned from the best. People like Paul Karger, Richard Kemmerer, Bell, and Cynthia Irvine paved the way for me by figuring out what works and doesn&#8217;t. The best approaches came down to two: keep the critical part as small &amp; verified as possible. This part also should be isolated by hardware, booted first, and mediate any accesses to information. This gave birth to security kernels. These paved the way for both separation kernels and modern OS security. I&#8217;m just reusing a similar scheme to start with something ultra-small and simple to boot a signed piece of code. The less the coders have to get right, the better things will be. (Esp at the firmware level)</p>
<p>&#8220;Let me know when you have something ready to test. Will gladly give it a test drive, although it would still have to run on my x86 machines, unless you&#8217;ll lend the machine, too. ;)&#8221;</p>
<p>A secure system? Running on x86? You&#8217;re kidding me right? If it&#8217;s a virtualization solution, then I might port to x86 just to make legacy code safer. Problem is x86 is complex, buggy, and totally controlled by Intel. I&#8217;m more likely to use a POWER- or MIPS-based design. China went with MIPS and their Loongson processors even emulate x86. If I do anything x86 in a robust design, it would likewise be emulation. But that&#8217;s so slow&#8230; Probably better to just port OpenOffice &amp; Flash over to POWER/MIPS. 😉</p>
<p>But, sure, I&#8217;d lend you a system to play with. The first things I design would probably be appliances just to keep it small and get a reputation going for the organization. Maybe one EAL7 evaluation using our development process. Then, we&#8217;d do private evaluations from that point on. The first thing you get would probably be a firewall, VPN, transaction appliance, SCM system, or undefaceable web server. Those are on my todo list.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163416">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163416">
						July 2, 2011 1:41 PM					</a>

				</p>

				<p>@ Clive Robinson on next best design<br />
(tommy you might want to look at it too)</p>
<p>You and I have been working a HA TCB for a while now. Remember back when I was talking about trying to get a hold of the Secure Ada Target (ASOS) and LOCK specs? I had a design that combined the tagged memory of ASOS, the trusted coprocessor for enforcement tactic of LOCK, and a verified separation kernel with root of trust booting for software security. The design would be simple, run on a verified processor, and provide pervasive POLA. It combines aspects of your prison approach and my castle approach.</p>
<p>Guess what? I just found out a team independently came up with this and took it further to the point it doesn&#8217;t require a kernel and every operation on the  system maintains POLA using a functional paradigm. (Kind of like your prison approach, eh?) It&#8217;s called TIARA. I want you to read through their presentation &amp; paper and check it out. If it has no obvious design flaws, I might shift my design efforts to target that platform as my underlying TCB. And I&#8217;m not concerned with any hardware-level attacks or side channels in this analysis: it&#8217;s a separate security issue &amp; we need to solve the software issue first to eliminate low hanging fruit.</p>
<p>TIARA Main Site<br />
<a href="http://people.csail.mit.edu/hes/TIARA/" rel="nofollow ugc">http://people.csail.mit.edu/hes/TIARA/</a></p>
<p>TIARA Technical Paper<br />
<a href="http://people.csail.mit.edu/hes/TIARA/public-proposal.pdf" rel="nofollow ugc">http://people.csail.mit.edu/hes/TIARA/public-proposal.pdf</a></p>
<p>TIARA Overview Powerpoint<br />
<a href="http://people.csail.mit.edu/hes/TIARA/overview-presentation.ppt" rel="nofollow ugc">http://people.csail.mit.edu/hes/TIARA/overview-presentation.ppt</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163417">

			<div class="comment by-optimus-crime ">

				<p class="commentcredit">

					<span class="commenter">Optimus Crime</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163417">
						July 2, 2011 6:56 PM					</a>

				</p>

				<p>Prevention is better than cure. Operating system hardening. Daily use of user privileges rather than Admin privileges. Running suspect files on virtual machines and most important COMMON SENSE!!!, for example a 2 Mbytes executable file cannot be a 2:00 hours movie (hint: it&#8217;s a F*cking malware!!) &#8230;but the antivirus said it was a clean file&#8230; ANTIVIRUS CAN BE EASILY BYPASSED.</p>
<p>PD:Deeply sorry about the caps</p>
<p>Have a nice day.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163418">

			<div class="comment by-tommy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.amiright.com/parody/60s/dustyspringfield54.shtml' rel='external nofollow ugc' class='url'>tommy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163418">
						July 2, 2011 7:25 PM					</a>

				</p>

				<p>@ Clive Robinson:</p>
<p>Would gladly have invited you to the party, but Nick P. was already on the thread, and hadn&#8217;t seen you around. As usual, you not only answered the question, but filled in some great bits of history as well, to give context. Please don&#8217;t feel left out, old chum &#8211; excellent answer as always, and of course you have a blanket invitation to contribute any and all of your huge knowledge base AFAIC. 🙂</p>
<p>&#8220;Often formating a drive very specificaly avoided the whole first cylinder (and still does) and you had to force rewriting of the MBR with the /MBR flag to FDISK which would only over write the first 512byte sector of cylinder 0. Few reformats used to go to every byte of the hard drive and change them to known values (even now this is avoided due to the time involved). And many of those that claim to, still make the mistake of reading the disk size etc back off of the HD before doing it or ignoring cylinder 0.Thus some software / malware new/knows how to hide &#8220;beyond&#8221; the end of the drive or in cyclinder 0.&#8221;</p>
<p>Ah, so I didn&#8217;t hallucinate that. Malware can indeed survive most reformats, including, apparently, many still done today by &#8220;standard&#8221; methods.</p>
<p>If you nuke the drive with Darik&#8217;s or Eraser (presumably running from a CD or from another machine to which the infected drive has been connected), they&#8217;ll get every last &#8220;bit&#8221; of it, correct? (Sorry for the awful pun on &#8220;bit&#8221;.) Acronis also has a Drive Cleanser tool that I&#8217;ve never used, but it apparently allows selecting the entire drive, which would presumably include the first cylinder and track, and lets you choose from their overwrite algorithms, importing algorithms, or creating your own. You can view the contents of the HD after the process is complete. Booting from the recovery CD that you already have, it eliminates the need for a second machine &#8212; and being a read-only CD, it&#8217;s our old frined, the unchangeable Live CD (Linux kernel, in my case) that can&#8217;t get infected itself. Anyone ever used this?</p>
<p>@ Nick P,:</p>
<p>&#8220;If it&#8217;s a BIOS malware or in PCI device firmware, it will survive any activity on the harddisk.&#8221;</p>
<p>Understood. The issue in question was my suggestion to nuke the drive to get rid of specifically <em>HD</em> malware, rather than merely reformat it, and Timothy Keith&#8217;s reply that was more concerned with forensic drive content analysis than with eliminating malware. Clive confirmed my recollections very well; your work on the other issues of building BIOS and PCI trust is of course critical.</p>
<p>&#8220;A secure system? Running on x86? You&#8217;re kidding me right?&#8221;</p>
<p>Yes. Hence the 😉 at the end &#8212; guess that should have been after &#8220;run on my x86&#8221; so it would be clearer. My bad. You&#8217;ve told us repeatedly that x86 (and 64) are not only insecure, but insecurable. Sorry for the confusion. Would still love to test anything, including an x86-emulator, no matter how slow, or a prototype machine with your choice of CPU, etc. &#8230; btw, I wouldn&#8217;t need a server, but it&#8217;s probably quicker to design, build, and test the client side first anyway. If those all hit the mark (or get debugged completely), then move on to the server side &#8212; what do you think?</p>
<p>Re: TIARA: GMTA. Be honored.</p>
<p>@ Andy:</p>
<p>Clever attack! Never thought of that. Does anyone know of that being done in the wild? If I may take the liberty of clarifying Andy&#8217;s ESL (no offense, Andy, just do your best): The malware marks certain drive sectors as bad, but also stores some of itself there. User reformats drive, &#8220;full, low-level&#8221;, or whatever is the most complete on Clive&#8217;s list; reinstalls OS. Malware then removes the &#8220;bad&#8221; marking by some means, thus giving the falsely-reassured user the same infection as before the reformat. <em>Everyone</em> is invited to answer! 🙂</p>
<p>I admit that I haven&#8217;t had to format a drive in ages. Last time HD died, went to shop, got new one, went home, booted Acronis recovery CD, and in about 15 minutes, entire HD was painted to where it was yesterday (when last incremental backup was made), including formatting, OS, MFT, contents and all. Much easier than reformat, reinstall, add all your apps, restore all your data, redo all your configs and tweaks&#8230; So I really can&#8217;t remember the process &#8211; thank goodness!</p>
<p>@ Optimus Crime:</p>
<p>All Best Practices, of course. But what Nick P. Clive Robinson, and others have been discussing is creating systems that are &gt;inherently secure&lt;, rather than the band-aid approach that hasn&#8217;t worked. As you said, AV can be bypassed; and the blog post was that MS&#8217;s kernel/driver protection has already been bypassed. You have a great day, too.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163419">

			<div class="comment by-andy ">

				<p class="commentcredit">

					<span class="commenter">Andy</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163419">
						July 2, 2011 8:13 PM					</a>

				</p>

				<p>@tommy, About your live-cd secuirty thing, have you thought about putting it on a stick of ram. If its in the first bay and can change the address mapping it should beable to see ever thats on the computer, same level has the cpu maybe.</p>
<p>Most tec shops or half the users could install it in laptops and destops them selfs.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163420">

			<div class="comment by-andy ">

				<p class="commentcredit">

					<span class="commenter">Andy</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163420">
						July 2, 2011 8:26 PM					</a>

				</p>

				<p><a href="http://www.phrack.org/issues.html?issue=59&#038;id=6#article" rel="nofollow ugc">http://www.phrack.org/issues.html?issue=59&#038;id=6#article</a><br />
hdd hack</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163421">

			<div class="comment by-jj ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.surrogat.us' rel='external nofollow ugc' class='url'>JJ</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163421">
						July 2, 2011 9:22 PM					</a>

				</p>

				<p>Dear all,</p>
<p>I and two schoolmates just started a project for an external device as part of our university studies. This device (which we have named the surrogatus box) is supposed to run some flavor of Linux strictly on firmware and has multiple possible uses such as:<br />
A. running a scan on your PC from the device to determine malware infections<br />
B. using the device as a proxy to surf the web from (through a remote control session)<br />
C. using the device to trace the network traffic from your PC.</p>
<p>Plus some other future uses such as providing a proxy service to somebody living in a country behind a firewall.</p>
<p>Some of these configuration options are shown here:<br />
<a href="http://blog.surrogat.us/post/2011/06/09/Some-configuration-examples" rel="nofollow ugc">http://blog.surrogat.us/post/2011/06/09/Some-configuration-examples</a></p>
<p>Since this place has a great collection of people with a good understanding of computer security I thought I ask for feedback on what you think of a device like this.</p>
<p>Thanks,</p>
<p>JJ</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163422">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163422">
						July 2, 2011 9:33 PM					</a>

				</p>

				<p>@Nick P<br />
 &#8221; Problem is x86 is complex, buggy, and totally controlled by Intel. I&#8217;m more likely to use a POWER- or MIPS-based design. &#8230;&#8221;</p>
<p>Have you given any thought to building a HA platform using GPU&#8217;s (say from Nvidia)?  There are certainly a lot of additional issues to be addressed but this sort of hardware parallelism, can be directly mapped to a separation kernel  approach without the efficiency hit, inherent in a single CPU separation kernel, that&#8217;s needed to eliminate covert timing channels.</p>
<p>There are already companies building simulation boxes and high speed servers based on the GPU concept, so a HA platform would be able to leverage this infrastructure.  I also think I could sell this concept to  Nvidia and get them to incorporate trusted hardware concepts,  because they need to add value to their offering and HA EAL6+ certification would open up some interesting markets for them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163423">

			<div class="comment by-andy ">

				<p class="commentcredit">

					<span class="commenter">Andy</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163423">
						July 2, 2011 9:40 PM					</a>

				</p>

				<p>@JJ, it would be good if you could plug a mouse and keyboard into the device and control the computer throught it, any inet onections when the mouse or keyboard hasn&#8217;t send any movements gets block or delayed, or if port 80(dest) is open and  if there is traffic but the mouse hasn&#8217;t being clicked etc&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163424">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163424">
						July 2, 2011 9:47 PM					</a>

				</p>

				<p>@NickP<br />
&#8221; Problem is x86 is complex, buggy, and totally controlled by Intel. I&#8217;m more likely to use a POWER- or MIPS-based design. &#8230;&#8221;</p>
<p>Just one more thought: MIPS is the dominant processor for TV and STB chipsets. Today the big design challenge for TV/STB is to fully integrate IPTV, this is not just displaying, youtube and netflix but rather involves targeted integrated IP advertising into a TV channel model.</p>
<p>This market requirement is creating a sort of parallel home computing platform that could benefit if it develops from scratch as a HA platform.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163425">

			<div class="comment by-jj ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.surrogat.us' rel='external nofollow ugc' class='url'>JJ</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163425">
						July 2, 2011 9:50 PM					</a>

				</p>

				<p>Hi Andy,</p>
<p>do you mean to control the users main PC through the device? I must admit that is  one aspect we had not thought about.</p>
<p>Thank you for bringing that up.</p>
<p>Besides that we did think to have it so that the Linux running on the surrogatus box can be controlled directly by plugging a mouse and keyboard into the USB ports (actually that is one of the reasons for so many of those ports).</p>
<p>Best regards,</p>
<p>JJ</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163426">

			<div class="comment by-andy ">

				<p class="commentcredit">

					<span class="commenter">Andy</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163426">
						July 2, 2011 11:14 PM					</a>

				</p>

				<p>@JJ, not so much controled just let it pass throught it and have a sniffer attached. GPL for the sniffer code 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163427">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163427">
						July 3, 2011 12:02 AM					</a>

				</p>

				<p>@ tommy</p>
<p>&#8220;Would still love to test anything, including an x86-emulator, no matter how slow, or a prototype machine with your choice of CPU, etc&#8221;</p>
<p>Well, this isn&#8217;t one of my designs, but you might like to play with it. Check out VX32. It&#8217;s a sandbox that uses Intel hardware to restrict untrusted binary code, dynamically rewrites it to remove unsafe instructions, and works on legacy OS&#8217;s. Idk of its quality: it&#8217;s a &#8220;stable research prototype.&#8221; But I like their scheme &amp; I&#8217;ve thought of quite a few applications for it, especially using risky 3rd party libraries in a medium assurance app.</p>
<p>VX32 Virtual Extension Environment<br />
<a href="http://pdos.csail.mit.edu/~baford/vm/" rel="nofollow ugc">http://pdos.csail.mit.edu/~baford/vm/</a></p>
<p>&#8220;@ andy Clever attack! Never thought of that. Does anyone know of that being done in the wild?&#8221;</p>
<p>Yes. It&#8217;s a well-known trick for hiding information on your hard disk in plain sight. I can&#8217;t remember if it was first designed for virus&#8217;s or stego, but I know forensics guys were taught to watch for that back when Win 2000 was new. Modern tools like EnCase might defeat that approach, might not. I didn&#8217;t bother to take a chance trying it. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163428">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163428">
						July 3, 2011 12:09 AM					</a>

				</p>

				<p>@ RobertT</p>
<p>&#8220;Have you given any thought to building a HA platform using GPU&#8217;s (say from Nvidia)?&#8230; this sort of hardware parallelism, can be directly mapped to a separation kernel approach without the efficiency hit&#8221;</p>
<p>I&#8217;ve thought about baking security into them, but I haven&#8217;t thought of them as the platform. Hmmm. Aren&#8217;t those processors much simpler, making it difficult to do general-purpose software on each one? (I&#8217;m thinking of CUDA in particular.) Well, if we could, then it might be a decent idea. A similar advantage is won by using a Cell processor. Those have many security features baked-in, including isolating the SPU&#8217;s and a TRNG. But the number of isolation cores was too limited for the apps I wanted to build. A GPU is significantly more, but can we decompose a common application amongst those cores?</p>
<p>&#8220;This market requirement is creating a sort of parallel home computing platform that could benefit if it develops from scratch as a HA platform. &#8221;</p>
<p>&#8220;I also think I could sell this concept to Nvidia and get them to incorporate trusted hardware concepts, because they need to add value to their offering and HA EAL6+ certification would open up some interesting markets for them.&#8221;</p>
<p>These could make some good motivations if the aforementioned issues work out positively.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163429">

			<div class="comment by-ronk ">

				<p class="commentcredit">

					<span class="commenter">RonK</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163429">
						July 3, 2011 1:16 AM					</a>

				</p>

				<p>@ Alan Kaminsky</p>
<p>You missed the fine print. The rootkit authors offer to send you the full source code if you fill in a few personal details on their web page. 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163430">

			<div class="comment by-tommy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.amiright.com/parody/70s/johnlennon95.shtml' rel='external nofollow ugc' class='url'>tommy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163430">
						July 3, 2011 1:44 AM					</a>

				</p>

				<p>@ Clive and Andy:</p>
<p>First, an apology. In the refreshing flood of ideas here, I told Clive he didn&#8217;t need to apologize for answering (he never does, d&#8217;oh!), but it was Andy who opened with &#8220;not at me, but&#8230;&#8221; and replied. Same thing, Andy. Anyone who can contribute is welcome. It&#8217;s just that Nick P. and I have had a running discusson at another thread.</p>
<p>@ Them + Nick P.:</p>
<p>Another facepalm here. Clive had already answered my question about Andy&#8217;s stealth-bad-sector HDD attack being used in the wild, by saying &#8220;many of these can be used or have been used as refuges for malware in one way or another.&#8221;. D&#8217;oh^2 here.</p>
<p>@ Andy:</p>
<p>&#8220;About your live-cd secuirty thing, have you thought about putting it on a stick of ram.&#8221;</p>
<p>Umm, I may be setting myself up for yet another facepalm, but I thought RAM was volatile, and you&#8217;d have to keep power to it constantly (or freeze-dry it &#8211; the &#8220;cold boot attack&#8221;), which would be impossible to do while plugging it into a bay? I mean, we ground ourselves, and everything&#8230;</p>
<p>@ All:</p>
<p>Andy&#8217;s link to the anti-forensics, even though Unix-only, was interesting enough just for the table of contents, though Clive and Nick say that this is old stuff. Which reinforces the idea of Your Humble Servant that nuking the drive with overwrites of <em>all</em> cylinders/heads/sectors/tracks/clusters/bits/label/packaging/warranty/receipt was about the only way to hope for a truly clean HDD before reinstalling.</p>
<p>Given the plunge in price of moderate-sized HDs these days, I&#8217;d probalby just buy a new one, in a sealed package, from my local factory-authorized sales-and-repair facility, just as I did when the old one died. &#8230; if that infection ever happens.</p>
<p>@ Nick P.:</p>
<p>&#8220;Check out VX32. It&#8217;s a sandbox that uses Intel hardware to restrict untrusted binary code&#8230;&#8221;</p>
<p>Did. This was in the second paragraph:</p>
<p>&#8220;Vx32 runs on unmodified x86 FreeBSD, Linux, and Mac OS X systems without special permissions, privileges, or kernel modules. It also runs on x86-64 Linux systems. Ports to x86-64 FreeBSD and Mac OS X should not be difficult. A port to Windows XP should also be possible.&#8221;</p>
<p>So I need to wait for that &#8220;port to Win XP&#8221;.  In the meantime, no one ever responded to my suggestion at the USB-in-the-street thread,</p>
<p><a href="http://www.schneier.com/blog/archives/2011/06/yet_another_peo.html#comments" rel="nofollow ugc">http://www.schneier.com/blog/archives/2011/06/yet_another_peo.html#comments</a></p>
<p>that using Sandboxie (or any other good sandboxing or virtualizing solution) was a good-as-it-gets stop-gap measure to keep us safe on the Web, as well as from found USB drives, until such time as HA becomes the norm. Have you looked at Sandboxie, or do you just to complete VM? The latter is a little &#8220;heavy&#8221; for low-end home machines, and a bit complex for some users. If you don&#8217;t have an opinion on Sandboxie, you might take a look at it. It solved the found-flash-drive problem for me &#8211; safely look for owner info without getting infected. It keeps my browsing safe, too, even when asked to go to some strange sites to do diagnostics. And it&#8217;s here-and-now, light, small, and free-nagware or low cost.</p>
<p>Repeating the disclaimer there: I have no personal or financial connection to Sandboxie, and my experience is not a guarantee of results nor assumption of liability for your results. Choose your own virtualizing solution after careful investigation. <a href="http://www.sandboxie.com" rel="nofollow ugc">http://www.sandboxie.com</a></p>
<p>And Nick,</p>
<p>WILL YOU PLEASE GET SCHNEIER BLOG BETA THREAD-BASED MODEL UP AND RUNNING, ALREADY???? &gt;grin&lt; .. this is starting to get <em>really</em> hard to follow so many great discussions at so many different threads, some gone from the home page, or about to go. 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163431">

			<div class="comment by-andy ">

				<p class="commentcredit">

					<span class="commenter">Andy</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163431">
						July 3, 2011 2:43 AM					</a>

				</p>

				<p>@tommy, &#8220;Umm, I may be setting myself up for yet another facepalm, but I thought RAM was volatile, and you&#8217;d have to keep power to it constantly (or freeze-dry it &#8211; the &#8220;cold boot attack&#8221;), which would be impossible to do while plugging it into a bay? I mean, we ground ourselves, and everything&#8230; &#8220;,<br />
The chip isn&#8217;t meant to be ram stick, it would be more of a processor with a small bit of storage, it just uses the first bays i/o pins to control what the cpu sees and input data, and chages in some way were the data gets stored in ram(or modifer OS A20(I need to look into that area abit more)) to beable to intercept that info.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163432">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163432">
						July 3, 2011 3:47 AM					</a>

				</p>

				<p>@ Andy (and others ;),</p>
<p>With regards the Phrack Mag article, take carefull note about the &#8220;proof of concept&#8221;&#8230;</p>
<p>What the article did not mention or deal with is &#8216;meta-evidence&#8217; (which is evidence about evidence).</p>
<p>For instance it talks about setting dirty inodes back to a virgin state but nothing about &#8220;packing&#8221; the result.</p>
<p>Back in the 1990&#8217;s I started looking at what is now refered to by some half hartedly as &#8220;forensic geology&#8221; in that you examin the way the files map in time to the inodes etc.</p>
<p>Put simply if you have a directory entry you do not expect to find &#8220;virgin&#8221; entries in the middle of the inode list only at the end as their life cycle is &#8216;virgin, used, dirty, re-used&#8217; the system does not reset them to virgin. Thus seeing virgin entries anywhere other than at the end of the inode list is meta-evidence of file deletions, and as such can be used as secondary evidence. The solution is to &#8220;pack the list&#8221; by either moving valid inodes into the position of the inodes you wish to &#8220;vanish&#8221; or fill the inodes with harmless crud that looks like valid entries made by an editor or some such.</p>
<p>However even this has it&#8217;s problems because an examination of inode usage against file meta-data such as creation dates etc can show how blocks of inodes are missing or out of order time wise which should throw up the question of Why?</p>
<p>Then on top of this are jouraling file systems that have a habit of puting time identifiable cruft through out the drive as files are added and this in turn provides meta-evidence. Likewise we now have &#8220;file system snap shots&#8221; to deal with as well, and more recently &#8220;Flash HD&#8221; with &#8220;wear-leveling&#8221;</p>
<p>These systems make &#8220;on the fly&#8221; anti-forensics very difficult at best, however few forensic examiners have the time or knowledge to pursue meta-evidence as it is not something the legal process realy deals with yet (but it will, as evidenced by cases where the pocession of encryption software is used as evidence of ill intent or guilt).</p>
<p>It is also the reason I have looked at things like &#8220;data shadows&#8221; for storing information, but this is a whole different game at the &#8220;spook-v-spook&#8221; level.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163433">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163433">
						July 3, 2011 4:17 AM					</a>

				</p>

				<p>@ tommy,</p>
<p>No need to apologise for not inviting me to the party 8)</p>
<p>The reason I have not been around much is I&#8217;ve partialy succumbed to one of my myriad of illnesses. I&#8217;m not a good patient, I resent being ill and as a result tend to over do things and my body gets it&#8217;s own back by cutting the oxygen supply of to my brain to make my take rest in the horizontal possition (without the need of alcohol). Which this time thankfully ment I fell flat on my face in private not public otherwise they would have carted me off to hospital yet again for a week to top me up with somebody else&#8217;s blood 8(</p>
<p>Anyway enough of that I&#8217;ve probably already put you and other readers of their next meal 😉 Back to the topic&#8230;</p>
<p>With regards hiding stuff on a hard disk through a reformat there is one issue people tend to forget about and it&#8217;s important. Data on a disk is just data it&#8217;s not malware or anything else. To become malware the computer has to load it into it&#8217;s execution space either directly or through an interpreter (ie malware in java byte code does not execute nativly but through the byte code interpreter, the same with the old MS Word macro virus etc).</p>
<p>Now if the computer is unaware of the &#8220;data&#8221; it will not be executed or even found and the chances are it won&#8217;t unless you make the computer aware in some way.</p>
<p>The simplest way with PC Hard drives is to create a hidden partition at the end of the drive and put it there, then modify the MBR to make that partition bootable, this then loads the malware into memory and makes it &#8216;visable&#8217; to the OS that gets loaded next.</p>
<p>The old way to do this was to make it look like a &#8220;device driver&#8221; installed during boot from the device (see PCI hardware spec for this or the original IBM PC I/O design). Aside from &#8220;I/O Shims&#8221; the new funky way is to make the malware the base OS and run the users OS in a virtual machine&#8230;</p>
<p>Then it realy does not mater what Anti-Malware software they run because it&#8217;s all running in it&#8217;s own private world that it cann&#8217;t see out of, and there is no malware in that private world to be seen or removed etc&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163435">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163435">
						July 3, 2011 5:13 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>Thanks for the info on TIARA, I will look into it.</p>
<p>However as you are probably aware &#8220;tagged containers&#8221; go back a long way and the ideas behind them can still be seen in modern hardware and OS&#8217;s where the containers (ie 4K pages) of memory are tagged as Read Only, No EXecute etc as well as being assigned to a process via the MMU page table.</p>
<p>Tagged Containers have a number of issues which have ment they have been unpopular in the past.</p>
<p>The first of which is the container size, the minimum sized container on a digital computer is the single bit, the next logical size after that is the width of the addressable memory be it registers or RAM in bytes or words of multiple bytes. The next logical sized container being contiguous regions of memory allined at sutable address boundries (ie Memory pages). Obviously the tag has to be a certain minimum size so the larger the container size the more efficient the tagging system is in memory usage, hence the modern page being 4K in size.</p>
<p>What is less obvious is that the tag is also a constraint on the system, in that it&#8217;s size dictates certain restrictions. For instance if the tag contains bits for Read Only, Write Only, No Execute and one or more process ID&#8217;s then it is going to be quite a few bit&#8217;s in width. The bit width for the process ID obviously limits the number of processes that can be used on the CPU at anyone time and the translation between the tag ID and role ID opens up vulnerabilities of re-use (much like hanging pointers in a threaded environment).</p>
<p>This also gives rise to the issue of container assignment and re-use, on a single CPU system it is the same CPU that in different contexts that asigns the tags in a privileged context and creates exceptions with the tags in a non privileged context. Context switching should be atomic but rarely is, nor is it generaly fool proof. To do it properly needs considerable sillicon resources which is why much of it is done in kernel memory tables, which are effectivly vulnerable from anything the kernel trusts or cannot see (such as DMA or I/O).</p>
<p>Now saying &#8220;no kernel&#8221; is a bit of a misnomer in many cases as the bottom end function of a kernel is context switching, and the only way to avoide this on a single CPU is run everything in the same memory space cooperatively which we know from MS DOS with Windows on top just does not work (which is why MS gave up on it as a design with 98/ME and moved to NT entirly with Win2K/XP).</p>
<p>However even having a CPU run a single task generaly does not obviate the issue due to I/O, which generaly requires the &#8220;task switch&#8221; from background to foreground for interupt handeling.</p>
<p>So doing it on the same CPU is almost guaranteed to leave a vulnerability that can be exploited some how to escalate privilege irrespective of the additional container tagging.</p>
<p>Which is why for my &#8220;prison&#8221; concept, I went with the idea of multiple simple CPU&#8217;s that had their resources controled externaly by a hypervisor. The &#8220;user&#8221; working CPU&#8217;s never task switch and all the I/O is done through memory buffers, access to which is mediated by the hypervisor (that is each CPU has a MMU between it and the system memory, that it cannot see that is controled by the hypervisor, when it writes or requests it gets &#8220;halted&#8221; the hypervisor makes the appropriate changes and then lets the CPU run again).</p>
<p>Now this taged container structure would be a good idea to add to a state machine style hypervisor controling many slave (prisoner) CPU&#8217;s but not to a general purpose CPU which switches between contexts both for privileged/unprivileged work and for I/O work.</p>
<p>I&#8217;m a great beliver in KISS and Seperation with clear simple easy atomic interfaces where all the states can be modelled unambiguously, especially where if minimises and simplifies the design and removes hardware that otherwise complicates a boundary security issue (ie a context switch for privi / IO operation).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163436">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163436">
						July 3, 2011 6:47 AM					</a>

				</p>

				<p>@ Andy,</p>
<p>&#8220;The chip isn&#8217;t meant to be ram stick, it would be more of a processor with a small bit of storage, i just uses the first bays i/o pins to control what the cpu sees and input data, and chages in some way were the data gets stored in ram&#8221;</p>
<p>You can do that on some architecturs but not all it depends on how the address decoding is done and if you can &#8220;chain&#8221; it etc.</p>
<p>&#8220;(or modifer OS A20(I need to look into that area abit more)) to beable to intercept that info.&#8221;</p>
<p>If you are refering to the Address line 20 issue with IaX86 CPU&#8217;s it was a hardware cludge by IBM on the PC AT motherboard to get around an issue that arose by a silicon mistake on Intel CPU&#8217;s prior to the 80286 and it&#8217;s 16Mbyte memory addressing. And in turn lead to a CPU cludge on the 486 and later CPU&#8217;s due to the inclusion of cache memory in the CPU which necessitated an extra pin on the chip to resolve the issue).</p>
<p>The mistake arose by the use of segmented addressing on the IaX86 architecture (a poor way to get away without an MMU and still have virtual memory).</p>
<p>What happened with &#8220;real mode&#8221; &#8220;segmented addressing&#8221; was two sixteen bit addresses held in two CPU registers where added together with a four bit offset to provide a 20bit address range.</p>
<p>However if you think a little on it you will realise that the addition of the two registers allows for more than a 20bit address range (ie not 1Mbyte but 1Mbyte + 64Kbyte &#8211; 16bytes).</p>
<p>Intel decided to ignore the &#8220;out of range memory&#8221; issue above 1Mbyte by simply making it&#8217;s address &#8220;wrap around&#8221; to the low memory addresses rather than raising an exception.</p>
<p>Some namless software droid thought he was being &#8220;oh so clever&#8221; by using this offset wrap around to access IO etc at what was now the top of his memory address range for his &#8220;broken&#8221; segment.</p>
<p>Due to it appearing to be a &#8220;neat solution&#8221; to a problem (that didn&#8217;t realy exist) the idea caught on and spread to many DOS programs.</p>
<p>[Worse idiocy happened with the likes of Compaq who actually designed &#8220;expanded memory&#8221; cards in the early 1980s to page lots of extra memory into the region just below the top of the 1Mbyte memory, in the UMA memory region above the original IBM PC 640K memory limit as well. This became formalised in the EMS specification cooked up by Lotus Software, Microsoft and Intel all of whom should have known better].</p>
<p>Thus without the IBM A20 Gate (out) cludge on the IBM PC AT motherboard many earlier DOS programs would be broken in the new 16Mbyte memory model as addressess above the A20 (1Mbyte) limit where now valid. The A20 Gate was simply an AND gate with one input being the A20 address line and the other &#8220;control&#8221; input coming from the keyboard controller chip (8048 single chip microcontroller).</p>
<p>If you think this nonsense is all in the dim and distant past of the early 1990&#8217;s, yould be wrong, because Intel by default starts the IaX86 CPU&#8217;s in &#8220;real mode&#8221; at boot and the software then has to flip the CPU to &#8220;32bit&#8221; &#8220;Protected Mode&#8221;, but those pesky segment registers still exist as a poor mans MMU, only they make the problems of debugging code many many times more complicated than it should be and the results can be seen in the mind numbing ELF format and the troubles it causes loaders for 32bit OS&#8217;s like Linux and BSD. It even effected the &#8220;C standard&#8221; with addressing arrays, it is why for array[n] the address array[n+1] is legal but invalide but address array[0-1] is both illegal and invalid because the array might begin at address 0 of the segment, thus segment -1 might address some other unknown memory 64k above it&#8230;</p>
<p>There are a couple of pages up on wikipedia that explains it in more depth,</p>
<p><a href="http://en.m.wikipedia.org/wiki/A20_line" rel="nofollow ugc">http://en.m.wikipedia.org/wiki/A20_line</a></p>
<p><a href="http://en.m.wikipedia.org/wiki/High_memory_area" rel="nofollow ugc">http://en.m.wikipedia.org/wiki/High_memory_area</a></p>
<p>And also the other expanded (paged) memory nonsense,</p>
<p><a href="http://en.m.wikipedia.org/wiki/Expanded_memory" rel="nofollow ugc">http://en.m.wikipedia.org/wiki/Expanded_memory</a></p>
<p><a href="http://en.m.wikipedia.org/wiki/Upper_memory_area" rel="nofollow ugc">http://en.m.wikipedia.org/wiki/Upper_memory_area</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163437">

			<div class="comment by-jj ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.surrogat.us' rel='external nofollow ugc' class='url'>JJ</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163437">
						July 3, 2011 11:15 AM					</a>

				</p>

				<p>@Andy</p>
<p>yes having the surrogatus box as a proxy to sniff on traffic flowing through it is one of the initial intentions. That is why it has two LAN ports (one on both ends).</p>
<p>It is supposed to have no hard disk and purely run the Linux in RAM. Not sure how doable this is but we thought to give it a try.</p>
<p>Best regards,</p>
<p>JJ</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163439">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163439">
						July 3, 2011 12:22 PM					</a>

				</p>

				<p>@ Nick P,</p>
<p>I don&#8217;t know if you have seen this,</p>
<p><a href="http://mobile.nytimes.com/2011/06/30/technology/30morris.xml" rel="nofollow ugc">http://mobile.nytimes.com/2011/06/30/technology/30morris.xml</a></p>
<p>But Bob Morris senior has died just a few days ago.</p>
<p>He was responsible amongst other things for the C maths library, parts of the security design of the Unix operating system and spent some time working at the NSA.</p>
<p>Although he trained as a mathematician he developed an interest in cryptography and whilst at the bell labs he and a colleague (Dennis Ritchie) worked out independently a way to automate Jim Reed&#8217;s attack on a WWII Haglin M-209 cipher system ( <a href="http://cm.bell-labs.com/cm/cs/who/dmr/crypt.html" rel="nofollow ugc">http://cm.bell-labs.com/cm/cs/who/dmr/crypt.html</a> ).</p>
<p>[For those who don&#8217;t know the M-209 cipher system was based on the &#8220;coin counter mechanism&#8221; Hagelin had developed, and in a slightly different form was at the time still in active use in various middle east countries. And the supplier of the equipment was Crypto AG in Zug Switzerland. As an indication of how serious this was one of Crypto AG&#8217;s senior sales people was later arrested on espionage charges in the middle east and after negotiating his release he was subsiquently prosecuted by a Swiss court.]</p>
<p>Although Bob and Dennis where not specifficaly asked not to publish the paper the authors and contributors decided to withold publication. As Denise put it they all felt they had shaken the friendly velvet glove over the hand of steel.</p>
<p>Because of Bob&#8217;s work at Bell labs he later got an invite to visit the NSA who gave him a job which led to him becoming their chief computer scientist, where he in turn he invited Clifford Stoll when he was &#8220;stalking the whilley hacker&#8221;.</p>
<p>Bob Morris at one time or another issued sage words on computers and security including,</p>
<p>1) The thre golden rules of computer security are one; never own one, two; never turn it on, and three never use it!</p>
<p>2) The first rule of cryptoanalysis, always look for plain text (specifficaly &#8220;known plaintext&#8221;).</p>
<p>Oh and he also advised never underestimating the time effort and resources a determined adversary will employ in trying to read your traffic.</p>
<p>He is survived by his wife children and grandchildren.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163440">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163440">
						July 3, 2011 1:31 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>THanks for the reply. You really have to look at their technical paper, though. Plenty of your worries don&#8217;t apply. They were designed out. One example is container size: it&#8217;s a memory word and every word is tagged. Apps already use word sized containers, so no big deal. 😉</p>
<p>&#8220;context switching should be atomic&#8230;&#8221;</p>
<p>It&#8217;s a &#8220;zero kernel&#8221; design. There is no kernel. The hardware provides mechanisms that effectively replace it. There might still be atomicity issues.</p>
<p>&#8220;is run everything in the same memory space cooperatively which we know from MS DOS with Windows on top just does not work&#8221;</p>
<p>Actually, it can work. Both Microsoft&#8217;s Singularity and NICTA&#8217;s Mungi were single-address space OS&#8217;s far as apps could tell. They still maintained POLA. In this case, memory is structured and every subject/object labeled in such a way as to enforce POLA without a kernel &amp; user mode. (From what I recall&#8230;)</p>
<p>So, like I said, this is quite different from many tagging or kernelized approaches. I&#8217;d like you to read the technical paper &amp; overview presentation first so that you can hone in on any <em>real</em> weaknesses in the design.</p>
<p>Btw, I compared it to your prisons approach because of functional mediation. You always said you wanted some kind of checking or access control at the function level. You also had simple, MMU-less processors to further isolate them. This designs structures the whole of system operation as a series of functions being performed on objects. It also applies mediation to each function &amp; the word-level permissions apply isolation similar to your prisons approach. Those are my only points of comparison, as I understand your approach is quite different otherwise.</p>
<p>On Morris</p>
<p>I appreciate the link. I honestly hadn&#8217;t followed him much because most of his best work wasn&#8217;t public. That&#8217;s why I like groups like Navy Research Lab: they tell me some of what they figure out. Where would I be without all those papers about covert channel identification and suppression? Oh yeah, still trying to decipher your posts on the subject and reverse engineer the fundamentals out of them. The papers were a much easier solution. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163441">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163441">
						July 3, 2011 1:46 PM					</a>

				</p>

				<p>@ JJ</p>
<p>I know your device can work because it&#8217;s similar to designs other people and I have posted in the past. OK Labs demoed a way to plug a smart phone into a keyboard &amp; monitor to form a Citrix thin client computer. I once posted a radically different way to do computing. Everyone would have kind of a compute card with onboard processor, IOMMU, RAM, and PCI. Laptops, desktops and kiosks would be designed to just accept someone&#8217;s device. The design allows malicious or otherwise untrustworthy connections because the compute card contains the protection mechanisms. Users wouldn&#8217;t have to carry a laptop across the border: just the card and rent a laptop shell (or whatever else) when they get there. It can be used for other things as well, but this is primary usage. Onto your design.</p>
<p>The first thing about your design that concerns me is that it&#8217;s essentially a stand-alone, general-purpose PC. It has Linux, networking, security software, USB stacks, graphics, etc. It&#8217;s effectively no different from having a second, small-form factor Linux PC, like my VIA Artigo board designs. All of the attack vectors available to people targetting Linux, which are numerous, are available to target your system.</p>
<p>I also don&#8217;t see you using firmware to your advantage here. The reason is that Linux is so complex and changes so often that updates to important modules happen regularly. I could see you having a &#8220;factory state&#8221; Linux kernel in the firmware to boot up the updated one, run checks, etc, but that still doesn&#8217;t stop a compromise of the kernel being updated. So, the design has less assurance than some of the others proposed, including a LiveCD [because it&#8217;s non-writeable by malware].</p>
<p>So, I see it being useful. It might even temporarily have a security purpose due to its obscurity (e.g. Mac OS X). But systems like that are still sandcastles. Even arrows can put holes in castles made of sand.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163442">

			<div class="comment by-jj ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.surrogat.us' rel='external nofollow ugc' class='url'>JJ</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163442">
						July 3, 2011 3:11 PM					</a>

				</p>

				<p>Hi Nick P.,</p>
<p>thanks for your feedback!</p>
<p>It is true that the device is like a second, small-form factor Linux PC with some specialized functionality. This was the only way we saw it being able to accomplish the tasks we wanted. Our intention has been to make it as small and inexpensive as possible.</p>
<p>But how is the firmware different from LiveCD, as the firmware is not directly writable by the Linux it runs?</p>
<p>Besides, since the device does not have a hard disk, any attack vectors would have to deal with that the code would have to be directly executable (as it could only be embedded into the RAM memory and thus could not utilize any of the &#8216;autostart-at-boot&#8217; functionality in an OS).</p>
<p>Another issue is that any code that would be executed on it would still have to make it to the main PC somehow, and if the main PC is a Windows, the code would also have to take that into consideration.</p>
<p>Best regards,</p>
<p>JJ</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163443">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163443">
						July 3, 2011 3:59 PM					</a>

				</p>

				<p>@ JJ</p>
<p>Thanks for the additional information. I didn&#8217;t know it wouldn&#8217;t have a hard drive. As for the firmware, I figured you meant it loaded from a EEPROM or flash-type memory like most BIOS&#8217;s do. The reason I made this assumption is that any device using the Linux platform needs to be able to do security updates for the OS and important libraries like OpenSSL. Otherwise, it remains insecure, lacks necessary functionality to remain interoperable, etc. Without a hard drive, I&#8217;d assume it would update and somehow write the new state to memory. That makes the memory writeable. The alternative LiveCD approach just sends out updated LiveCD&#8217;s every month or so and hence maintains its read-only capabilities.</p>
<p>&#8220;Another issue is that any code that would be executed on it would still have to make it to the main PC somehow, and if the main PC is a Windows, the code would also have to take that into consideration.&#8221;</p>
<p>Definitely. I was kind of curious as to how your machine would check the main OS. Malware typically escalates privileges and destroys or subverts any software used to detect or monitor malware. If your detection scheme used software, it would have to have kernel-mode privileges and be able to hide from malware that scan memory. This is tricky and brings much risk.</p>
<p>Then I thought you might use hardware. You mentioned USB in one design, but that relies on the OS not being subverted. Else, the rootkit feed your device BS data. Next is Firewire, which has direct access to memory. This could work, but requires the other system doesn&#8217;t have a IOMMU. In other words, the PC has to intentionally get rid of a very important security feature for pain-free scanning of memory. Otherwise, we have to figure out how to set up Intel VT-d to let your device have total access, while restricting others.</p>
<p>It all just sounds a lot harder to do than the virtual machine or sandboxing approaches. So, how were you planning to get information from the main PC while ensuring it isn&#8217;t spoofed by a rootkit?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163444">

			<div class="comment by-tommy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.amiright.com/parody/misc/frankielaine10.shtml' rel='external nofollow ugc' class='url'>tommy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163444">
						July 3, 2011 4:47 PM					</a>

				</p>

				<p>@Nick P., a Quick-E.: 😉</p>
<p>&#8220;the firmware would do self-tests of the hardware, load/verify the software, and give it control.&#8221;</p>
<p>How does it &#8220;verify the software&#8221;? OS are constantly changing, as users make config choices. I could change a single bit in one Reg value from 0 to 1 or 1 to 0, and the OS will hash differently. Even BIOS has user-configurable settings, which would change a hash output.</p>
<p>So, are we back to AV-style signatures and heueristics? Not seeing how the verified firmware would &#8220;verify&#8221; anything higher up, though I&#8217;m sure you have a solution.</p>
<p>Back to the parades and fireworks! Catch you tonight or tomorrow.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163445">

			<div class="comment by-tommy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.amiright.com/parody/70s/threedegrees0.shtml' rel='external nofollow ugc' class='url'>tommy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163445">
						July 3, 2011 5:01 PM					</a>

				</p>

				<p>@ Clive R.:</p>
<p>Meant to say (memory lapse), sorry to hear of your illness. Here&#8217;s to a swift and full recovery!</p>
<p>&#8220;Get-well-card&#8221; disguised as song parody, written to a friend:</p>
<p><a href="http://www.amiright.com/parody/70s/gordonlightfoot136.shtml" rel="nofollow ugc">http://www.amiright.com/parody/70s/gordonlightfoot136.shtml</a></p>
<p>The original song, about an actual US shipping disaster, isn&#8217;t so well-known in the UK, though it&#8217;s all over YouTube, I&#8217;m sure. I&#8217;d write one for you, but don&#8217;t know the details and don&#8217;t need to know. (also, it&#8217;s a holiday weekend here.) Please consider it adapted for yourself. ;-D</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163446">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163446">
						July 3, 2011 5:23 PM					</a>

				</p>

				<p>I wonder just how difficult it would be for BIOS manufacturers to allow for an OS-independent MBR backup/recovery feature throwing an error at boot time when checksums don&#8217;t match. For most computer literate people, that would be a dead giveaway that something really fishy is going on.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163447">

			<div class="comment by-jj ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.surrogat.us' rel='external nofollow ugc' class='url'>JJ</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163447">
						July 3, 2011 5:24 PM					</a>

				</p>

				<p>Hi Nick P.,</p>
<p>about how to get information from the main PC while it is running and while ensuring that the information is not spoofed by a rootkit, that is a good question.</p>
<p>I do not think there is a solution to this that will work in every case. Mechanisms such as communicating directly with the miniport driver are under consideration but because they all go through the host OS in one way or another, they stand the risk of being intercepted. With the exception of somehow detaching the hard disk, plugging it to the box and scanning it that way (which is not extremely user friendly).</p>
<p>Another thought was to use the box to scan for all open ports on the users PC. Sort of like a personal penetration testing tool.</p>
<p>Besides that, thank you for those points about DMA. This is one aspect that we have not had a chance to put much of any thought into yet.</p>
<p>By the way that other issue from my previous posting, about the code &#8220;that would be executed on [the surrogatus box] would still have to make it to the main PC somehow&#8221;, that would mainly work in cases where user is browsing the web (or their own computer) through a remote terminal session running on the surrogatus box.</p>
<p>If the box is just being used for tracing network connections from the PC (by connecting LAN cable from PC to the box, and another LAN cable from box to inet router), the PC will be just as vulnerable as without the box.</p>
<p>Best regards,</p>
<p>JJ</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163448">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163448">
						July 3, 2011 5:37 PM					</a>

				</p>

				<p>@ tommy</p>
<p>&#8220;How does it &#8220;verify the software&#8221;? OS are constantly changing, as users make config choices.&#8221;</p>
<p>That&#8217;s not the software: that&#8217;s the system. This one word change makes a big difference. The verification is done on the code of the software, optionally the data as well. Maybe a whole image that&#8217;s copied directly into RAM, with some careful initialization afterward. Either way, the initial software TCB is digitally signed by the producer and the high assurance boot system makes sure the software matches the signature before booting.</p>
<p>An on-board signing mechanism, similar to a TPM, is used to sign any changes to the system. I usually force booting into an update or maintenance mode that ensures a secure system state before validating the updates, applying them, signing the new configuration, and storing it. Note that this level of protection is applied to the TCB of the platform, which the user rarely messes with. Other things are protected by the TCB in a robust way (like the Nizza architecture signing app) or just managed within a partition/application in low assurance way (legacy software, Linux API layer, etc.).</p>
<p>Note that we still have to trust that the software wasn&#8217;t modified before releasing. The whole platform has excellent security, but if they&#8217;re running Subversion on an off-the-shelf Linux PC then attackers might help their software live up to it&#8217;s name. So, here&#8217;s the trusted development path in a nutshell:</p>
<ol>
<li>Requirements must make sense.</li>
<li>Every high-level design element must correspond to one or more requirements.</li>
<li>The security policy must be ambiguous, meet requirements, and be embedded in the design.</li>
<li>The Low Level implementation modules must correspond with high level design elements, at least one each.</li>
<li>The source code must implement the low level design with few to no defects.<br />
(EAL6-7 requires all of this)</li>
<li>The object code must be shown to correspond to the source code and no security-critical functionality lost during optimizations.<br />
(DO-178B Level A requires this &amp; CompCert can do it.)</li>
<li>At least one trustworthy, independent evaluator must evaluate the claims and sign the source code to detect later modifications by the developers or repository compromise.</li>
<li>The executable should be produced using the compilation strategy above by no less than 3 mutually distrusting parties, with the resulting binary hashed, signed and signatures released. (My original scheme used government labs in US, China and France, although could substitute Japan for China if US complains.)</li>
<li>
<p>Administrators can then download a binary from anywhere, get the hashes from each party, verify their signatures, and then use that trustworthy hash to hash/verify the binary. Like Schell said of GEMSOS, &#8220;you can buy it from your worst enemy&#8221; [and still know it wasn&#8217;t subverted]. This process is stronger.</p>
</li>
</ol>
<p>This is essentially what it takes to make a software product trustworthy from conception to distribution. If we&#8217;re satisfied with a product and just worried about subverted binaries, then we can just do 6-9. That&#8217;s still more work than hardly anyone else is doing and a significant improvement in assurance if the source code gets lots of review, Linux kernel being the best example.</p>
<p>So, the software TCB must be made, installed, initialized, configured and operated in a trustworthy fashion to call the result a secure (trustworthy) system.</p>
<p>I&#8217;ve been thinking about making a SCM (e.g. repository) system my first high assurance implementation to bootstrap trust into other projects. The system would be designed for ease of use, compatibility with existing tools, utter confidentiality/integrity protection, and defeat all non-physical attacks. A distributed SCM would reduce risk of corrupt administrators by increasing the number and locations of SCM to be subverted. It would also reduce risk of loss of availability due to failure of a node.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163449">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163449">
						July 3, 2011 5:40 PM					</a>

				</p>

				<p>@ JJ</p>
<p>&#8220;Besides that, thank you for those points about DMA. This is one aspect that we have not had a chance to put much of any thought into yet.&#8221;</p>
<p>The tools already exist. They were used for hacking, but you can repurpose them. Have at it&#8230;</p>
<p>Firewire Toolkit<br />
<a href="http://www.storm.net.nz/projects/16" rel="nofollow ugc">http://www.storm.net.nz/projects/16</a><br />
(Site is currently down. Maybe tools are available elsewhere. Wayback machine should have the descriptions.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163450">

			<div class="comment by-jj ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.surrogat.us' rel='external nofollow ugc' class='url'>JJ</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163450">
						July 3, 2011 6:07 PM					</a>

				</p>

				<p>Thanks for the tip Nick P., the wayback machine had indeed the stuff.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163451">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163451">
						July 3, 2011 6:56 PM					</a>

				</p>

				<p>@NickP<br />
&#8220;3. The security policy must be ambiguous, meet requirements, and be embedded in the design.&#8221;</p>
<p>I&#8217;ve got a feeling there are some letters missing, such as un- in front of ambiguous!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163452">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163452">
						July 3, 2011 7:00 PM					</a>

				</p>

				<p>@ RobertT</p>
<p>LOL! Thanks for spotting the typo. Yes &#8220;unambiguous&#8221; requirements. Typos are one easy way to tell when im writing in a hurry.</p>
<p>What are your thoughts on my breakdown? I left some aspects out because i was trying to describe the fundamentals. Care to write one up for SOC trusted from dedign to deployment. Is it even possible with current attack and defense capabilities?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163453">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163453">
						July 4, 2011 1:19 AM					</a>

				</p>

				<p>@NickP<br />
&#8220;Care to write one up for SOC trusted from dedign to deployment. Is it even possible with current attack and defense capabilities?&#8221;</p>
<p>Interesting question. The completely honest answer is that it is impossible to guarantee SOC integrity using current methodologies and accessing typical commercial fabs.  But this analysis is theoretical rather than a practical, because to date nobody has ever reported any evidence of an SOC hardware exploit, or exploit assist.</p>
<p>Having said the above, nobody is actively looking for signs of SOC corruption.  This makes an SOC exploit like the perfect rootkit, because if it is completely unobservable, and  never screws-up, than nobody will ever have reason to check the correctness of  the exploited hardware</p>
<p>To be honest the best chance for discovering a hardware SOC exploit is when someone fixing another unrelated problem stumbles across metal traces that are wrong according to the reference &#8220;tape-out&#8221; database. But even this assumes that the error is introduced after the Tape-out, truth is it is more likely to be inserted ahead of this stage.</p>
<p>Consider the organizational position of anyone trusted by a company to develop specific anti-exploit hardware . You&#8217;ll hear a lot of statements like: We added that exactly this way because RobertT said &#8220;Add it&#8221;. He supervised it and this is exactly what he wanted.</p>
<p>One last conundrum: Almost everyone with an in-depth knowledge of EAL5-EAL7 hardware requirements, is indirectly affirming their affiliation, with a  certain TLA&#8217;s, or the organizational equivalents within other countries. In other words they&#8217;re all sus!</p>
<p>BTW: if that&#8217;s not enough to depress you, think about who really issues EAL5+ certification? Now consider the problems:<br />
1) Do they really want perfect security?<br />
   &#8211; Even if you are capable of it<br />
   &#8211; Especially if you are capable of delivering it.<br />
2) What actual recourse iexists to contest an EAL7 certification fail.<br />
3) What metadata, about your organization,  is implied by a successful EAL6+ level certification.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163454">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163454">
						July 4, 2011 1:40 AM					</a>

				</p>

				<p>@ RobertT</p>
<p>Thanks for the reply. Well, all of that kind of sucks. 🙁 I guess subversion-free hardware development is the next frontier for those wanting maximum assurance or trust in their systems. Cheap, DIY fabs anyone? (I know at least one person working on something like that.)</p>
<p>You pose interesting questions about EAL5-7. I&#8217;d actually say that, at the EAL6/7 level, they really do want [near-]perfect security. The NSA spends tens of millions of dollars of its own money on a A1/EAL7 certification. The resulting software product is legally classified as a munition and subject to export restrictions, possibly domestic sale restrictions. The NSA also uses them internally for highly classified information. All of this together makes me think they want the product to be truly secure. (Note: EAL5 isn&#8217;t considered &#8220;secure&#8221; but &#8220;significant increase in assurance with minimal application of specialist security engineering techniques,&#8221; is how one document described it. &#8220;A step up from the norm&#8221; I&#8217;d say.)</p>
<p>That said, we do know they want backdoors and control. So, how can they achieve both? Well, hardware is the first issue. Running a secure OS on top of high quality firmware that the NSA vetted and has no source might lead to an &#8220;update&#8221; or &#8220;remote troubleshooting&#8221; feature that does an end run around the software TCB. They might also expect to get in using application-level attacks, TEMPEST, social engineering, physical attacks, or users not using the evaluated configuration.</p>
<p>I mentioned the configuration issue last because it&#8217;s the best: an evaluation&#8217;s results only applies to the evaluated configuration &amp; people rarely use it. INTEGRITY-178B was EAL6+ on a PowerPC board with certain firmware. It&#8217;s security claims may not hold virtualizing Windows on a COTS x86 PC with vPro management enabled. I see this so often it&#8217;s barely a punch line anymore.</p>
<p>As for metadata and stuff, a company wanting to hide its procedures should certainly worry about that. A private evaluation by a lab accredited for EAL6-7 evaluations would be better for confidentiality and probably cost (red tape eliminated). If they want to sell to the government, they can just do a cheap EAL4+ evaluation in addition to the private one. I&#8217;m also concerned about any restrictions that the developer might have to agree to in order to get a high assurance evaluation going. Again, a private evaluation is better here too. The context of my efforts wouldn&#8217;t be like this: our organization would be more open and work closely with academia &amp; other companies. So, it wasn&#8217;t a concern for me, but I see others being bothered by the issues you bring up.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163455">

			<div class="comment by-tommy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.amiright.com/parody/60s/raypeterson3.shtml' rel='external nofollow ugc' class='url'>tommy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163455">
						July 4, 2011 2:56 AM					</a>

				</p>

				<p>@ Nick P.:</p>
<p>Sorry for my one-word confusion between TCB and OS. I think perhaps  I shouldn&#8217;t post on holiday weekends. 😉</p>
<p>OTOH, I also noticed &#8220;ambiguous&#8221;, though I was later in replying. Perhaps we all need to watch ourselves when cheering the holidays. 🙂</p>
<p>The silver lining to the cloud was the nice enumeration of requirements, even though shortened. I especially liked the &#8220;three mutually DIStrusting parties&#8221; and &#8220;you can buy it from your worst enemy&#8221; &#8212; hadn&#8217;t heard those anywhere else.</p>
<p>Very unsure how US-China would play out. Big easing of tensions if it worked. But with all the talk of Chinese attacks on US gov and mil, would the Chinese even want to do this mutual-security thing with us? They might be the sticking point rather than the US. Idle thoughts.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163457">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163457">
						July 4, 2011 3:40 AM					</a>

				</p>

				<p>@NickP<br />
As a business proposal do I really want one customer, who may or may not buy my product, telling me who I can and cannot sell it to. It seems to me that INTEGRITY has asked themselves the same question. They seem to imply buy our Eal4+ product with this specific PowerPC plug-in board and you&#8217;ll get EAL6+ performance (wink wink)</p>
<p>@tommy<br />
&#8220;Very unsure how US-China would play out&#8230;.&#8221;<br />
In politics there is an age old adage &#8220;keep your friends close and your enemies closer&#8221;<br />
These wise words can be easily parlayed into profitable enterprises, by anyone willing to live a little on the edge. But even such a cynic, would be wise to consider who&#8217;s really being fooled by whom, in the whole charade.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163458">

			<div class="comment by-richard-steven-hack ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.computerproblemssolvedcheap.com' rel='external nofollow ugc' class='url'>Richard Steven Hack</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163458">
						July 4, 2011 3:45 AM					</a>

				</p>

				<p>Clive:  &#8220;however few forensic examiners have the time or knowledge to pursue meta-evidence&#8221;</p>
<p>Exactly. As long as your hacker can hide enough forensic evidence to make the examiner exceed his time limit and budget, he&#8217;s home free. I read somewhere that British police have something like 16 hours to do their forensics search, after which time they have to move on to the next case because they are so backlogged.</p>
<p>Presumably every other police (local or Federal) are in the same boat.</p>
<p>&#8220;Some namless software droid thought he was being &#8216;oh so clever'&#8221;&#8230;</p>
<p>Precisely the industry&#8217;s problem &#8211; too many &#8220;clever&#8221; blokes by half and not enough with common sense&#8230;or any concept of usability, reliability, security, or any other concept except &#8220;can we do this and get it out the door&#8221;?</p>
<p>And THAT will never change because THAT is human (corporate AND open source) nature.</p>
<p>&#8220;1) The thre golden rules of computer security are one; never own one, two; never turn it on, and three never use it!&#8221;</p>
<p>I just spent the weekend rebuilding a box for a client who is one of those people who should follow all three rules!  I guarantee you he will find a way to hose the box within the next 48 hours&#8230;And he can&#8217;t afford to pay me until next month&#8230;</p>
<p>So this time I installed openSUSE 11.4 in a dual-boot configuration. As long as he only hoses Windows and not the boot sector, he has a chance of having a functioning OS to work with until he can afford to have me fix Windows&#8230;again&#8230;</p>
<p>As you know, Bob Morris&#8217; son is also famous for having released the &#8220;Morris Worm&#8221; &#8211; although there are people (like me) who suspect that really was an NSA &#8220;pulse the system&#8221; test&#8230;</p>
<p>Bottom line of all the &#8220;secure hardware and software&#8221; stuff above:</p>
<p>1) Not going to happen because governments are afraid the secure stuff will end up in &#8220;unfriendly&#8221; (read: anyone else&#8217;s) hands;</p>
<p>2) Even if it is produced and deployed by one state, the specs will be stolen (by kidnapping the designers if necessary) and the systems produced by &#8220;unfriendlies&#8221; (read: everyone else), ergo you end up with the state&#8217;s worst nightmare: being unable to spy on everyone else.</p>
<p>3) and finally: someone will figure out how to defeat it &#8211; probably within 24-48 hours of first implementation &#8211; even if they have to develop a nanotech analysis device that crawls inside the hardware and specs it out, a capability that should exist within the next decade or two. Or as I said above, just kidnapping someone who knows&#8230;</p>
<p>Sooooo&#8230;we&#8217;re back to my meme.</p>
<p>It&#8217;s a fun challenge to try to develop something no one else can defeat &#8211; but it&#8217;s ultimately a waste of time, except to the degree that it can be implemented well enough to at least &#8220;keep out the riffraff&#8221;.</p>
<p>The question is how much do you want to spend in developing an entirely new form of computer and software technology just to keep out your enemies?</p>
<p>Once again, there is only one way to deal with enemies: don&#8217;t make any. Failing that, become their friends &#8211; then poison them.</p>
<p>Tommy: &#8220;Big easing of tensions if it worked.&#8221;</p>
<p>Actually, no. Those tensions exist for a reason and it&#8217;s not because either side is worried about being penetrated. They exist because there&#8217;s money (and power) involved in making them exist.</p>
<p>It&#8217;s like the anti-nuclear people never understood that all those nuclear weapons were never intended to be USED &#8211; just PAID FOR.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163459">

			<div class="comment by-richard-steven-hack ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.computerproblemssolvedcheap.com' rel='external nofollow ugc' class='url'>Richard Steven Hack</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163459">
						July 4, 2011 4:30 AM					</a>

				</p>

				<p>From another article on the rootkit: &#8220;Yaneza explained that by using repair tools found on the Windows system restore disk, users can repair the boot sectors targeted by the attack.&#8221;</p>
<p>Right, sure &#8211; not one of the clients I&#8217;ve ever had could do that. They don&#8217;t even know what a boot sector is. Nor do they have bootable recovery disks for Windows 7 or bootable XP boot CDs.</p>
<p>Which brings me to another point: Anyone tried to fix a Windows 7 boot problem lately? Supposedly all you have to do is reboot, wait for Windows 7 to detect a problem, select the OS and then select &#8220;Repair System&#8221;. If it can&#8217;t succeed in repairing it, you can drop to a command line and run bootsec or other tools.</p>
<p>Except what happens when the corruption is bad enough that Windows can&#8217;t detect the OS? I&#8217;ll tell you. You can&#8217;t break out of the &#8220;Repair System&#8221; process to get to the command line tools! Catch-22!</p>
<p>You have to boot from a WINDOWS 7 PE environment which is sufficiently complete that you have a DOT NET environment and whatever else is necessary to enable those tools to properly initialize themselves.</p>
<p>Microsoft won&#8217;t even let you run a &#8220;Repair Install&#8221; any more from the command line like you used to do in XP. You must run it from WITHIN a RUNNING Windows 7! How smart is that?</p>
<p>They claim the reason is that doing repair installs on XP made XP &#8220;less stable&#8221; (despite the fact that this was a recommended procedure for years when all else fails). So how is doing a repair install from within a running 7 going to make 7 any more stable? How often would anyone have to do a repair install for a system that is running fine enough to DO a repair install?</p>
<p>It&#8217;s a ridiculous statement. It&#8217;s lies, plain and simple.</p>
<p>It&#8217;s almost as if Microsoft wanted to make sure that no one could repair their systems if they were infected with something like this.</p>
<p>If this new rootkit gets spread around, I&#8217;m going to make a fortune cleaning or reinstalling Windows PCs. I better raise my rates&#8230;</p>
<p>Actually most people IF they even realize they have such a rootkit will probably just reinstall Windows and not call me at all (assuming they have an install CD or partition and know how, which is maybe one percent of the clients.)</p>
<p>Timothy:  &#8220;Your best and safest bet is probably to backup your files with a known safe bootable OS and do a complete reinstall.&#8221;</p>
<p>If you know a home user who knows how to do this and actually does it, I&#8217;d like to know who.  Most home users don&#8217;t even have their original install CDs, let alone a bootable recovery or live CD.</p>
<p>And what good is a reinstall when the user will immediately do the same thing that got him infected in the first place?</p>
<p>I just spent the weekend cleaning up a box for a guy like that (although I was really just installing a new hard drive since the old one had bad sectors). I had to do a clean install of XP however because earlier, despite what I told him previously not to do, he ran IE against a porn site. He managed to clean up the system (supposedly) with various anti-spyware tools but his XP was now riddled with problems.</p>
<p>He&#8217;s got a PC death wish.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163460">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163460">
						July 4, 2011 4:55 AM					</a>

				</p>

				<p>$RSH<br />
OT:  I just discovered my father-in-law has a TDL-4 infection, his Toshiba laptop, it got really flaky at starting. and powerdown so I recommend he scan for this with a LiveCD.. bingo!</p>
<p>What&#8217;s the recommendation:</p>
<p>Full re-format / reinstall<br />
or<br />
New HD + clean install</p>
<p>He is somewhat mobility constrained so I don&#8217;t want to force him to run all over town finding a laptop HD, unless it is highly probable that the HD is beyond normal repair</p>
<p>BTW: he has no user personal data on the drive and basically just uses a standard &#8220;out-of-the-box&#8221; MS load.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163461">

			<div class="comment by-richard-steven-hack ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.computerproblemssolvedcheap.com' rel='external nofollow ugc' class='url'>Richard Steven Hack</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163461">
						July 4, 2011 6:27 AM					</a>

				</p>

				<p>Run a Live CD like UBCD4Win or even better a Linux Live CD, use available utilities on the boot CD or the UNIX DD command to fill the entire drive including the boot sector with zeros. Then reinstall.</p>
<p>I&#8217;d say try to clean it but if he has no personal data on it, a reinstall is faster (although zeroing the drive could take a while depending on the disk size). Also if it&#8217;s Windows XP, it could take a couple hours to re-apply all the patches. I just did that the other day for a client and you&#8217;ll be applying around a hundred patches on top of an original CD install, plus Service Pack 3. If Windows Vista or 7, less so.</p>
<p>Keep in mind everyone has SOME personal data on a machine if nothing more than some browser bookmarks.</p>
<p>The important thing is to find out how he got it in the first place so he doesn&#8217;t do it again five minutes after he re-installs. Put Avast AV, Superantispyware, MalwareBytes Anti-malware, and ThreatFire 3 &#8211; all free to home users &#8211; on the machine. Only let him use the current Firefox 5.0 with NoScript and AdBlock installed, and never run IE for any reason. Beyond that, there&#8217;s not much you can do.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163462">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163462">
						July 4, 2011 7:30 AM					</a>

				</p>

				<p>Re. Live CD to restore MBR, fix TDSS-infection</p>
<p>One of the utilities I always carry on my bootable USB-stick is a copy of Hiren&#8217;s BootCD. R14 contains pretty much everything you need. See  <a href="http://www.hiren.info/pages/bootcd" rel="nofollow ugc">http://www.hiren.info/pages/bootcd</a> .</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163463">

			<div class="comment by-richard-steven-hack ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.computerproblemssolvedcheap.com' rel='external nofollow ugc' class='url'>Richard Steven Hack</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163463">
						July 4, 2011 7:45 AM					</a>

				</p>

				<p>Yeah, I have several different boot CDs as well as several different Linux Live CDs. Hirens used to be mostly warez but they cleaned up in the last couple years and now mostly has freeware on it. There are several such repair CDs based on Windows XP PE environment with good collections of tools.</p>
<p>The thing now for me is to get a Windows 7 PE environment similar to UBCD4Win. The reboot.pro Web site is the center for that sort of thing. They have a couple Win7-based PE projects. I use their LiveXP project for WinBuilder when UBCD4Win has a problem with a particular machine&#8217;s hardware.</p>
<p>I need to build a Win7PE live CD that can handle .NET so I can use some of the freeware and shareware Windows 7 BCD fix tools like EasyBCD.  Windows 7 seems to corrupt its boot system very easily &#8211; I had a brand new install of Win7 do that within 8 hours of its being put in production. Google for tons of reports of it doing that. It&#8217;s as unreliable at handling its boot process as XP was. And it&#8217;s hard to fix if the corruption screws up Windows System Repair function.  And with this new bootkit malware, that&#8217;s going to be a problem.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163464">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163464">
						July 4, 2011 8:40 AM					</a>

				</p>

				<p>Thanks Richard, sounds like good practical advice!<br />
I&#8217;ve actually got him using Ubuntu11 with FF as an interim fix from LiveCD.  I&#8217;ll see if he complains if not he&#8217;ll get an Ubuntu load  on the HD I find it much easier to load than XP or Vista. I&#8217;m not sure it has any better security, but it may be different enough to just make him a less attractive target.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163465">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163465">
						July 4, 2011 4:13 PM					</a>

				</p>

				<p>@ Richard Steven Hack</p>
<p>&#8220;1) Not going to happen because governments are afraid the secure stuff will end up in &#8220;unfriendly&#8221; (read: anyone else&#8217;s) hands&#8221;</p>
<p>It&#8217;s already happening and been happening: INTEGRITY-178B, VXWORKS MILS, GEMSOS, Boeing SNS, MULTOS, Caernarvon, etc. They might restrict some of the evaluated products stateside, but it wouldn&#8217;t happen in a few other countries. Could just keep the I.P. there and use ITSEC instead of Common Criteria for the high assurance evaluation. That&#8217;s how MULTOS was certified. Got ITSEC E6 to prove security, then a basic EAL4+ Common Criteria certificate just to sell it over here. Cheaper &amp; dodges all that legal B.S.</p>
<p>&#8220;2) Even if it is produced and deployed by one state, the specs will be stolen (by kidnapping the designers if necessary) and the systems produced by &#8220;unfriendlies&#8221; (read: everyone else), ergo you end up with the state&#8217;s worst nightmare: being unable to spy on everyone else.&#8221;</p>
<p>My scheme was very open. It&#8217;s necessary to ensure security and subversion resistance. It doesn&#8217;t matter though. They would just worry about it, but it wouldn&#8217;t have those results. OpenBSD is a high quality UNIX that defeats many attacks, but the state can still spy on most people. Only a small segment would use the secure platform and only a small percentage would use it correctly. 😉</p>
<p>&#8220;3) and finally: someone will figure out how to defeat it &#8211; probably within 24-48 hours of first implementation &#8211; even if they have to develop a nanotech analysis device that crawls inside the hardware and specs it out, a capability that should exist within the next decade or two. Or as I said above, just kidnapping someone who knows&#8230;&#8221;</p>
<p>Dude, are you drunk? A ranting pessimist venting on the blog perhaps? Since when does knowing the source or design guarantee an exploit? I can give you a link to the source code for OpenBSD, AES-256 or good old PGP. And now you can automagically defeat them, right? Not a chance and less so for a high assurance product. Maybe hardware as it&#8217;s usually obfuscation but high assurance security works regardless of whether enemies have the source code or not. The thing that&#8217;s hidden is always small, like a private key. See Kerckhoffs&#8217; principle.</p>
<p>&#8220;Once again, there is only one way to deal with enemies: don&#8217;t make any. Failing that, become their friends &#8211; then poison them.&#8221;</p>
<p>Ok, definitely alcohol. Probably something 50% if you think that statement even party applies to remote, unknown or nameless enemies. Bad analogy. I&#8217;d say make their exploits as hard as possible, force them to come in with physical attacks, and then unload on them with hydroshock. Or you can try your approach, poisoning them via TCP/IP&#8230; Somehow&#8230; Just down another shot, RSH.</p>
<p>&#8220;It&#8217;s like the anti-nuclear people never understood that all those nuclear weapons were never intended to be USED &#8211; just PAID FOR.&#8221;</p>
<p>Tell that to the previous residents of Hiroshima and Nagasaki, along with many Cold War folks who nearly shot them off a few times. They were definitely made to be used. Politicians just wisened up, realized it was a M.A.D. idea, and decided they&#8217;re better for posturing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163467">

			<div class="comment by-richard-steven-hack ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.computerproblemssolvedcheap.com' rel='external nofollow ugc' class='url'>Richard Steven Hack</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163467">
						July 4, 2011 5:42 PM					</a>

				</p>

				<p>Nick: All wrong.</p>
<p>First, Hiroshima and Nagasaki were done with the first couple of A-bombs. A few thousand more were built to allow the US to bomb most of Russia, first on bombers, then on nuclear subs.</p>
<p>ALL the rest were built just to  be paid for because everyone knows in a full-scale nuclear war all the US airfields, arsenals, and missile sites would be destroyed in the first 30 minutes (and the same on the Russian side.) So all those other thousands of stockpiled nukes were a complete waste of money (even allowing for rotation, degradation, etc.)</p>
<p>&#8220;Since when does knowing the source or design guarantee an exploit?&#8221;</p>
<p>You have great confidence in your ability to design a completely secure system, right?</p>
<p>Well, you&#8217;re wrong. I stand by my statement. Anything you can come up with will be defeated by someone else, no matter how much effort that takes or what kind of end-run around your technology has to be done. History bears this out and doesn&#8217;t even come close to bearing you out.</p>
<p>&#8220;remote, unknown or nameless enemies.&#8221;</p>
<p>While these are possible, they rarely exist in reality. Almost always, just like some who murders you, you know who your enemies are. Very rarely does someone come out of nowhere. You may not know precisely WHO they are until they reveal themselves but you know they exist and you know why they exist.</p>
<p>&#8220;I&#8217;d say make their exploits as hard as possible, force them to come in with physical attacks, and then unload on them with hydroshock.&#8221;</p>
<p>Yes, generally that is a good approach &#8211; unless they come in with their own hydroshock. Then you&#8217;d better be prepared to flee (or make sure they can&#8217;t find you in the first place) and retaliate when your tactical situation is better.</p>
<p>In other words, you&#8217;re not always the one with the superior firepower. This is especially true if you&#8217;re going up against a government.</p>
<p>Keep in mind that a given computer system with your &#8220;secure&#8221; technology isn&#8217;t being protected by &#8220;the government&#8221;. It&#8217;s one device being protected by a limited number of people, a limited amount of technology and whatever benefits your technology brings to the situation. It&#8217;s enemies may include thousands of civilian hackers of varying skills, an unknown but large number of hackers from other states, not to mention other forms of compromise.</p>
<p>The odds are NEVER in your favor in that contest.</p>
<p>&#8220;OpenBSD is a high quality UNIX that defeats many attacks, but the state can still spy on most people. Only a small segment would use the secure platform and only a small percentage would use it correctly. ;)&#8221;</p>
<p>And the same is true of any system you can devise. Which means the systems on which it is deployed are not secure &#8211; there are still ways to end-run the security, usually by tricking the end user. Unless your technology can prevent a human from screwing up (good luck with that), it doesn&#8217;t matter how secure your technology is.</p>
<p>You&#8217;re myopic. You&#8217;re too fixated on the hardware and software solutions to realize that that&#8217;s a very small part of security. And that&#8217;s not even including the fact that whatever you can build, someone can defeat &#8211; even if they have to build ever newer technology to do so.</p>
<p>It&#8217;s an arms race. It will always be an arms race. It&#8217;s that simple. At best, you can only be &#8220;secure&#8221; to a certain degree against certain enemies for a certain time. Nothing more.</p>
<p>In most people&#8217;s cases, that is adequate because the odds for most people is that they won&#8217;t be attacked because they don&#8217;t have specific enemies who want to attack them because they&#8217;re nobodies.</p>
<p>That doesn&#8217;t apply for people who have something worth attacking them for or who have made enemies the way the US (or Al Qaeda or Iran or whoever) has made enemies.</p>
<p>For those people, nothing you come up with will be sufficient forever. The best that can be done, again, is to &#8220;keep out the riffraff&#8221; and make it harder to penetrate your security.</p>
<p>I&#8217;ll repeat my meme: You can haz better security, You can haz worse security. But you cannot haz security. There is no security. Suck it up.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163468">

			<div class="comment by-richard-steven-hack ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.computerproblemssolvedcheap.com' rel='external nofollow ugc' class='url'>Richard Steven Hack</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163468">
						July 4, 2011 5:53 PM					</a>

				</p>

				<p>RobertT: &#8220;I&#8217;m not sure it has any better security, but it may be different enough to just make him a less attractive target.&#8221;</p>
<p>Trust me, it has better security. Enough to &#8220;keep out the riffraff&#8221; (i.e., Windows script kiddies) at least, which is the best you can do with any system. If a pro hacker wants to get in, he&#8217;ll get in. But malware isn&#8217;t as smart as a pro (until someone invents real AI), so it&#8217;s easier to keep out.</p>
<p>As long as he runs NoScript in Firefox he can prevent most browser hijacks while he&#8217;s running, and as long as he&#8217;s running from a write only media he can prevent system compromise.</p>
<p>Even installed on his hard drive, as long as he&#8217;s patched he would only be vulnerable to a zero-day, and very few hackers are searching for and finding zero days on Linux. That will only change if Linux gets more desktop share.  Although you&#8217;d think since Linux has such a large server share that hackers would be more proactive about trying to learn how to breach it &#8211; especially since most computer security tools are developed and run on Linux rather than Windows.</p>
<p>It&#8217;s just a lot of work to become expert enough in an OS&#8217; internals to develop zero day exploits and there aren&#8217;t enough Linux boxes to make that worthwhile when Windows is so much easier.</p>
<p>That&#8217;s why most hackers are coming in through Web sites these days &#8211; Web sites are programmed by people who aren&#8217;t competent programmers, still less security experts, and they&#8217;re full of security vulnerabilities that are much easier to spot and utilize.</p>
<p>No OS is invulnerable and no OS can be made invulnerable. But Linux is significantly more secure than Windows will ever be &#8211; as long as the end user doesn&#8217;t run as root. Almost every Windows home user runs as administrator on his box, violating PC security rule number one.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163469">

			<div class="comment by-tommy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.amiright.com/parody/60s/hermanshermits130.shtml' rel='external nofollow ugc' class='url'>tommy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163469">
						July 4, 2011 6:08 PM					</a>

				</p>

				<p>@ Robert T.:</p>
<p>&#8220;keep enemies closer&#8221; &#8230; also said by The Godfather in Mario Puzo&#8217;s novel, and, IIRC, the movie. The Mob knows a &#8220;little bit&#8221; about security, though they don&#8217;t have even the small restraints placed on LE (yes, oft ignored, I know.) I agree with your using that analogy, and share your cynicism about who&#8217;s fooling whom.</p>
<p>@ Richard Steven Hack:</p>
<p>I&#8217;ve previously voiced the same concern on other threads, about Gov not wanting to let high-assurance systems get into private or foreign hands. I share your cynicism in general, but will let Nick P. and you argue &#8211; uh, <em>discuss</em> the practicalities.</p>
<p>Re: Win DVD/recovery DVDs: Like so many OEM pre-loaded machines, mine doesn&#8217;t even include a retail Win DVD, only the OEM&#8217;s &#8220;recovery disk&#8221;, complete with their pre-loaded, paid crapware, and from which you can&#8217;t really extract one file or do a repair-only install, except for certain individual apps or modules on the pre-load system and DVD. Hence the need for true boot-and-recover CDs and backups. Acronis has been mentioned on this site &#8212; has worked for me &#8212; but there are several others out there. I don&#8217;t know how well the others work.</p>
<p>Most home users wouldn&#8217;t do the frequent backups &#8212; keeps you in business with your friend, and I say, don&#8217;t give him back the machine until he pays. 😉 They rely on System Restore, but if the HD dies, or &#8220;unmountable boot volume&#8221; (0x&#8230; ED) &#8211; I&#8217;ve had both &#8212; how do you get to SysRestore? Hence, independent boot/recovery is a necessity.</p>
<p>More advice for helping home users: Virtualization is beyond most, but they can be taught to use Sandboxie in only a brief session, especially if you configure it for them. (Just yesterday, helped a friend drill the required holes to allow bookmarks, NoScript permissions, etc. to be saved to HD.) I&#8217;ve mentioned it at the USB-found-in-street thread,</p>
<p><a href="http://www.schneier.com/blog/archives/2011/06/yet_another_peo.html" rel="nofollow ugc">http://www.schneier.com/blog/archives/2011/06/yet_another_peo.html</a></p>
<p>No response as of last night.</p>
<p>@ All regarding USB Boot sticks:</p>
<p>Tried to make one a year or so ago. After hours of torture, I finally called OEM tech support, and was assured that none of this OEM&#8217;s laptops were USB-bootable, except for their top-end line. The mobos just aren&#8217;t made to boot from USB flash drives. Guess I should have called before trying&#8230; But it boots fine from USB-connected non-flash memory, such as an external USB-connected CD or DVD drive with bootable media. Go figure&#8230;</p>
<p>@ SM Builders and Moderator:</p>
<p>Yep, it&#8217;s true. Non-savvy users are lost.</p>
<p>And we hope you&#8217;re an owner or otherwise connected with the construction company in your sig, because the Moderator doesn&#8217;t take too kindly to spam (nor do the rest of us). Please let us know your connection to the company, or the post will probably be deleted. Cheers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163470">

			<div class="comment by-p ">

				<p class="commentcredit">

					<span class="commenter">P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163470">
						July 4, 2011 8:34 PM					</a>

				</p>

				<p>@RobertT</p>
<p>Are you making good use of Apparmor on Ubuntu?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163471">

			<div class="comment by-richard-steven-hack ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.computerproblemssolvedcheap.com' rel='external nofollow ugc' class='url'>Richard Steven Hack</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163471">
						July 4, 2011 11:19 PM					</a>

				</p>

				<p>Tommy: Haven&#8217;t messed with Sandboxie yet. Probably should look into it.</p>
<p>I have several bootable USB drives &#8211; one with UBCD4Win, one with BackTrack 4 (soon to be upgraded to 5 on that stick), and one with openSUSE 11.4 &#8211; or is it still 11.1, can&#8217;t remember&#8230;:-)</p>
<p>I need to set up Windows XP all-in-one installs and Windows 7 all-in-one installs on USB keys as well. Because one problem I find in relying on CD and DVD drives is how often those drives are either defective on client machines or simply don&#8217;t like the CD/DVD I burned on mine.</p>
<p>Netbooks don&#8217;t even have CD/DVD drives. If your hard drive conks out on those, you&#8217;re really in trouble, at least in trying to install Windows XP. I think Windows 7 can be booted from a USB drive if I&#8217;m not mistaken (I can&#8217;t remember), but XP can&#8217;t be. Only a USB flash drive can recover you then.</p>
<p>As for some laptops not booting USB devices, frankly laptops are a crippled form of PC. They&#8217;re expensive, fragile, not expandable, missing useful features frequently, and generally otherwise crap. Nice to have, as are netbooks, for specific purposes, but should never be used as one&#8217;s primary machine. Despite all the tablet and smartphone talk, a desktop remains the best way to use a computer.</p>
<p>But even many desktops, older ones I constantly run into with my (cheap) clients certainly, frequently won&#8217;t boot a USB device.</p>
<p>At least Windows Vista and 7 allow you to install device drivers during install from a CD these days instead of a floppy disk. Otherwise with XP, frequently one has to resort to &#8220;slip-streaming&#8221; the drivers. Not difficult but another time-wasting step due to Microsoft myopia.</p>
<p>The latest trick is multiboot USB drives that allow you to boot any of a dozen or more Linux distros or antivirus rescue disks from one flash drive (given sufficient size). Not sure how often that&#8217;s really needed, but the capability is there.</p>
<p>USBs do have their problems. This weekend I put my 16GB in my client&#8217;s machine and Windows corrupted it so my Linux box couldn&#8217;t see it. Had to reformat it and lose everything on it. Almost all of it is replaceable &#8211; but I have to either remember what I had on it or decide to just reload new stuff anyway.</p>
<p>I have around nine or ten USB drives with various utilities, OS&#8217;s and other things on them. I could use a couple more. I carry them around in two Case Logic USB drive cases that hold six drives each &#8211; very convenient and insures I don&#8217;t lose them. When I take one out, I pull off the cap and leave it in the open case, so I remember to find it and replace it before I leave. Haven&#8217;t lost one yet! 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163472">

			<div class="comment by-tommy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.amiright.com/parody/70s/thefifthdimension8.shtml' rel='external nofollow ugc' class='url'>tommy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163472">
						July 5, 2011 3:03 AM					</a>

				</p>

				<p>@ Richard Steven Hack:</p>
<p>I would be interested in your analysis of Sandboxie (and of everyone else&#8217;s here), <em>in context</em> &#8212; not as the &#8220;perfect solution&#8221;, but as a here-and-now method to increase greatly the safety of non-tech users (or techies, for that matter) who are willing to spend 20-30 minutes to learn how to keep stuff in the sandbox, and how to get it out when desired. Once that&#8217;s done, and it&#8217;s configged to save bookmarks, whitelists, etc., it&#8217;s a no-brainer from there. Looking forward to all, whenever.</p>
<p>&#8220;one problem I find in relying on CD and DVD drives is how often those drives are either defective on client machines&#8221;</p>
<p>No kidding. The older machine&#8217;s optical has been highly intermittent for years (shop repairs/replaces it; fails next day), and the newer machine&#8217;s is pretty reliable on the read side, but if I try to burn my FDI-backups, it might stop in the middle, thus wasting a DVD blank.</p>
<p>So both are equipped to recognize an external CD/DVD read/writer that has been unfailingly reliable for years, small, lightweight, and not very expensive. If I need my Acronis restore, and I cannot boot from USB flash as noted, and the native optical drive fails &#8230;. hosed, except that the external writer will be recognized by BIOS and will boot/load/recover.</p>
<p>You are looking at the world&#8217;s greatest supporter of redundancy. 🙂 Note having two machines, in case one is in the shop awaiting parts. It&#8217;s happened. Could borrow friends&#8217; machines, but can&#8217;t trust them &#8211; the machines, not the friends, lol.</p>
<p>&#8220;frankly laptops are a crippled form of PC. They&#8217;re expensive, fragile, not expandable, missing useful features frequently, and generally otherwise crap. &#8221;</p>
<p>Yup. But not that expensive for low-end, which meets my needs, and not that fragile. This one&#8217;s been dropped twice. And don&#8217;t know what &#8220;features&#8221; are missing&#8230;</p>
<p>&#8220;Nice to have, as are netbooks, for specific purposes, but should never be used as one&#8217;s primary machine.&#8221;</p>
<p>Except I do. (Mine were expanded in RAM, up to 3-4x OOB, and the dead 80 GB HD was replaced with a 250, not because I needed it &#8211; I use less than 1 GB &#8212; but the 250 was in stock and cost not much more than waiting a couple of days for the 80.)</p>
<p>For a good while, I was seasonally employed. Roughly half a year here, then half a year a long distance away. Needed car and personal stuff &#8212; too long a time away to fly with enough luggage, and cost too much to rent a car at destination for six months. So everything had to fit in the trunk or passenger seats. Which means, &#8220;laptop&#8221;.</p>
<p>Not so anymore, but still, I wouldn&#8217;t spend so much time here, or anywhere else on the Net, if it meant being locked in front of a monitor in the den or office or whatever. Wireless &#8212; sit on the living room sofa, or I have an outdoor deck with a very pleasant view and fresh air, which is where I&#8217;m writing this now. And where I can write business documents and e-mails as well. (Which a smartphone won&#8217;t do.)</p>
<p>Wirelessly-accessed printer/scanner&#8230; ahhh! 🙂</p>
<p>&#8220;I put my 16GB in my client&#8217;s machine and Windows corrupted it so my Linux box couldn&#8217;t see it.&#8221;</p>
<p>Well, that bites. (no pun intended). Which is why everything essential on my USB sticks is regularly burned to CD/DVD &#8220;just in case&#8221;.</p>
<p>I switched to the capless variety, with the slide, but admit they&#8217;re more fragile. And I &#8220;lose&#8221; the darn things around the house so much (the sofa eats them), that I tied brightly-colored ribbons through the loops. They show up in My Computer as &#8220;Cruzer Blue (drive:) and &#8220;Cruzer Gold&#8221; (drive:) to match the ribbons.  It all helps.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163473">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163473">
						July 5, 2011 3:14 AM					</a>

				</p>

				<p>@ RSH,</p>
<p>&#8220;&#8230; only be vulnerable to a zero day, and very few hackers are searching for and finding zero days on Linux.&#8221;</p>
<p>That I&#8217;m not sure on for the simple reason most admins only know their machines are owned when abnormal things happen.</p>
<p>If the more intelligent black hats have woken up to the ROI on APT as oposed to losses on DDoS / SPAM bots then well I&#8217;ll let you join the dots (the Chinese and Russians already appear to have from what I can see 😉</p>
<p>&#8220;That will only change if Linux gets more desktop share.&#8221;</p>
<p>That applies more to low hanging fruit criminals and script kiddies, after a small return at best. If and when the Banks get woken up by the legislators then I expect the position will change as the nice ripe peach low hanging fruits of EBanking in small businesses will (hopefully) disapear.</p>
<p>&#8220;Although you&#8217;d think since Linux has such a large server share that hackers would be more proactive about trying to learn how to breach it&#8221;</p>
<p>Yes and no, if you think about APT types the server targets they are after are mainly intra not extra net and here MS still rules the roost in high value targets like lawyers etc (infrastructure high end engineering and high end finance still use *nix for &#8220;uptime&#8221; reasons).</p>
<p>Also as you note further down why go after the OS when the Internet facing apps are so baddly designed and implemented&#8230;</p>
<p>My personal view is that many *nix users and admins are much more switched on than there MS equivalents at any hierarchical spine point.</p>
<p>They generaly show an independent train of thought and seek out answers themselves rather than waiting for those large organisations in Washington State etc to spoon feed them solutions. This is especialy true of those who did not major in CS but other science/engineering/ maths subjects.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163474">

			<div class="comment by-heat-death-of-the-universe ">

				<p class="commentcredit">

					<span class="commenter">heat death of the universe</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163474">
						July 5, 2011 5:34 AM					</a>

				</p>

				<blockquote><p>
  If and when the Banks get woken up by the legislators
</p></blockquote>
<p>In which century will the average legislator have the understanding of the average reader of this blog?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163475">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163475">
						July 5, 2011 6:36 AM					</a>

				</p>

				<p>@ Heat death,</p>
<p>&#8220;In which century will the average legislator have the understanding of the average reader of this blog?&#8221;</p>
<p>The answer to that question is down to educating &#8220;joe public&#8221; as much as the legislators, And this will involve of necessitary the press.</p>
<p>And thereby hangs the problem, the press are in general ill educated on matters technological and prone to look for any &#8220;angles&#8221; to push the story up the stack to the front page. In this respect they are often like the little boy who cried wolf.</p>
<p>Thus educating the general press is going to be the first uphill struggle, and the second trying to stop them sensationalising what is often trivia.</p>
<p>The legislators do react to the press sensationalism however only once or twice and then usually badly. Often due to the fact they don&#8217;t talk to respected experts in the field of endevor only those that look and behave as the politicos do or come from Public Service Agencies with considerable vested interests. Further when they do get beyond the three letter agency fiefdoms they usually only get as far as the lobbyists of the major vested interests that in turn only promote what protects their bailwick.</p>
<p>It is only when the politicos position is threatened in some way or there is a clear public out cry do the legislators actualy act for the voters, and then usually incorrectly and badly due to the afor mentioned reasons.</p>
<p>So the answer to your question might be best answered &#8220;come the revolution&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163476">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163476">
						July 5, 2011 7:39 AM					</a>

				</p>

				<p>@ Richard Steven Hack</p>
<p>&#8220;Nick: All wrong.First, Hiroshima and Nagasaki were done with the first couple of A-bombs. A few thousand more were built to allow the US to bomb most of Russia, first on bombers, then on nuclear subs.ALL the rest were built just to be paid for because everyone knows&#8221;</p>
<p>Blah blah blah. Straw man argument because you changed your original claim, which was bullshit. Let me remind you what I replied to:</p>
<p>&#8220;It&#8217;s like the anti-nuclear people never understood that all those nuclear weapons were never intended to be USED &#8211; just PAID FOR.&#8221; (RSH)</p>
<p>You&#8217;re claim, as stated, applied to all nuclear weapons or nukes in general. So, let&#8217;s look at history. The Manhattan project was started with the intention of producing a powerful WEAPON (not a financial instrument). The weapon was tested to ensure it would do the job. The weapon was used on two cities, killing hundreds of thousands of people. They were also preprogrammed to hit a bunch of cities if we detected a barrage coming at us  during the Cold War and a few incidents nearly had that happen. So far, the facts are against &#8220;never intended to be used.&#8221; Your argument <em>might</em> have been defensible if you said &#8220;most of the current arsenal was never intended to be used.&#8221; However, recent plans to use low-yield nukes to hit bunkers even undermines that. So, you&#8217;re first point was BS and your recent one is quite debatable.</p>
<p>&#8220;Anything you can come up with will be defeated by someone else, no matter how much effort that takes or what kind of end-run around your technology has to be done. History bears this out and doesn&#8217;t even come close to bearing you out.&#8221;</p>
<p>Bears what out? That low assurance methods will produce systems that continue to be broken? Or that my systems won&#8217;t be absolutely secure? I think this is another straw man because I usually talk about &#8220;high assurance/robustness&#8221; systems, not perfectly secure systems. I&#8217;ve also given definitions of the term several times on this blog: &#8220;Defeats attacks by sophisticated, well-funded, attackers with high confidence.&#8221; This means that they would have quite a hard time trying to compromise it and such a machine might go for years without a flaw being found. That&#8217;s a hell of a lot better than our current situation, ya think?</p>
<p>&#8220;You&#8217;re myopic. You&#8217;re too fixated on the hardware and software solutions to realize that that&#8217;s a very small part of security.&#8221;</p>
<p>You&#8217;re&#8230; missing the whole point of what I&#8217;m doing. OF COURSE there&#8217;s more to it than the hardware and software. The issue is called economics. This force makes specialization superior to generalization. My specialty is designing secure systems, especially the software side. Someone ELSE has the specialty of putting together the physical protection mechanisms, training the users, etc. I don&#8217;t know about the best alarm system, TEMPEST shielding, etc. If we&#8217;re talking about high assurance software in general, why would I specify all of that without a set of requirements or the necessary expertise? Makes no sense.</p>
<p>Besides, what good is all that shit if a 13 year old can remotely own your computer from 10,000 miles away using a kit someone else made? My designs focus on eliminating remote or software-based attacks, which are the majority today. Someone else with the necessary expertise can or will do the rest. This certainly happens when I implement one for a client. All things are considered.</p>
<p>&#8220;At best, you can only be &#8220;secure&#8221; to a certain degree against certain enemies for a certain time. &#8221;</p>
<p>No shit lol&#8230;</p>
<p>&#8220;In other words, you&#8217;re not always the one with the superior firepower. This is especially true if you&#8217;re going up against a government.&#8221;</p>
<p>Red herring. Again, whose even talking about that? The level of physical and personnel security is determined by the opponents&#8217; resources, which varies case by case. Most of my designs are made to defeat online attacks. EAL7 defeats the very best in this regard. EAL7 also covers trusted distribution, installation, configuration and maintenance. History proves me out on this one: not one high assurance system has ever been compromised on record or failed to do its job during serious natural faults. And you can bet some customer would have complained if it did. An example in security is the Boeing SNS Server (also called &#8220;MLS LAN&#8221;) and in availability would be an IBM&#8217;s System/390 mainframe going 20-30 years before a reboot is required. Wow&#8230;</p>
<p>&#8220;And the same is true of any system you can devise. Which means the systems on which it is deployed are not secure &#8211; there are still ways to end-run the security, usually by tricking the end user. &#8221;</p>
<p>It&#8217;s not my problem. I don&#8217;t care about them. Like I told tommy, I design these things for people who do care about security &amp; are willing to make the necessary sacrifices to immunize themself to certain classes of attacks. That&#8217;s also the stance of the OpenBSD team, who inspired me to take that approach. If the users screw it up, it&#8217;s not my fault &amp; doesn&#8217;t make my designs any less secure. If anything, the number of times dumb users&#8217; PC&#8217;s are compromised and used to launch attacks gives me more reason to do my part in this.</p>
<p>&#8220;For those people, nothing you come up with will be sufficient forever. The best that can be done, again, is to &#8220;keep out the riffraff&#8221; and make it harder to penetrate your security. &#8221;</p>
<p>Exactly. That&#8217;s what high assurance development claims to produce. The difference is that it <em>actually</em> produces it most of the time. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163477">

			<div class="comment by-richard-steven-hack ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.computerproblemssolvedcheap.com' rel='external nofollow ugc' class='url'>Richard Steven Hack</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163477">
						July 5, 2011 8:32 PM					</a>

				</p>

				<p>@ Richard Steven Hack</p>
<p>&#8220;You&#8217;re claim, as stated, applied to all nuclear weapons or nukes in general.&#8221;</p>
<p>The two &#8211; &#8220;all nukes&#8221; and &#8220;nukes in general&#8221; &#8211; are not identical. My claim applied to the second. Q.E.D.</p>
<p>&#8220;The Manhattan project was started with the intention of producing a powerful WEAPON (not a financial instrument).&#8221;</p>
<p>History lesson no longer relevant since 1) my claim is established to be about nukes in general, and 2) I already discussed this part.</p>
<p>&#8220;So far, the facts are against &#8220;never intended to be used.&#8221; Your argument <em>might</em> have been defensible if you said &#8220;most of the current arsenal was never intended to be used.&#8221; &#8221;</p>
<p>That&#8217;s what I said in my response.</p>
<p>&#8220;However, recent plans to use low-yield nukes to hit bunkers even undermines that.&#8221;</p>
<p>I was referring to strategic weapons, not tactical weapons, obviously. And it&#8217;s not even clear that bunker busters are intended to be used, since the effects of such weapons if used specifically against Iran or North Korea would likely include serious collateral damage and contamination as far east as India.</p>
<p>Once again, I submit these devices are mostly intended to be paid for, not actually used.</p>
<p>And certainly not all of them are intended to be used since the manufacture order is usually orders of magnitude higher than the likely number of targets. How many nukes did the US stockpile &#8211; and did Russia (and China combined) really have that many targets worthy of a nuke strike? I don&#8217;t think so.</p>
<p>&#8220;Anything you can come up with will be defeated by someone else, no matter how much effort that takes or what kind of end-run around your technology has to be done. History bears this out and doesn&#8217;t even come close to bearing you out.&#8221;</p>
<p>&#8220;Bears what out?&#8221;</p>
<p>What I said explicitly.</p>
<p>&#8220;I usually talk about &#8220;high assurance/robustness&#8221; systems, not perfectly secure systems.&#8221;</p>
<p>&#8220;High assurance&#8221; is one of those industry PR terms which are completely meaningless if it&#8217;s not measured in specific metrics &#8211; which in security terms means long and competent penetration testing by people other than the developers.</p>
<p>&#8220;I&#8217;ve also given definitions of the term several times on this blog: &#8216;Defeats attacks by sophisticated, well-funded, attackers with high confidence.'&#8221;</p>
<p>And this was tested by who? Those sophisticated, well-funded attackers were identify as who?</p>
<p>This is the idea that if it hasn&#8217;t been penetrated YET it works. That&#8217;s nonsense.</p>
<p>&#8220;This means that they would have quite a hard time trying to compromise it and such a machine might go for years without a flaw being found.&#8221;</p>
<p>And it might go two weeks.</p>
<p>&#8220;That&#8217;s a hell of a lot better than our current situation, ya think?&#8221;</p>
<p>Obviously &#8211; if it can actually be done &#8211; which is the point under discussion.</p>
<p>&#8220;You&#8217;re&#8230; missing the whole point of what I&#8217;m doing.&#8221;</p>
<p>No, YOU&#8217;RE missing my point completely.</p>
<p>&#8220;My specialty is designing secure systems, especially the software side. Someone ELSE has the specialty of putting together the physical protection mechanisms, training the users, etc. I don&#8217;t know about the best alarm system, TEMPEST shielding, etc. If we&#8217;re talking about high assurance software in general, why would I specify all of that without a set of requirements or the necessary expertise? Makes no sense.&#8221;</p>
<p>I&#8217;m not complaining about any of that. I&#8217;m complaining about your talking about your specific technology as being &#8220;high assurance&#8221; when in fact there is zero evidence to prove that it is absent long and sustained actual success in the field actually repulsing competent attackers.</p>
<p>And I see zero evidence of that. Can you provide it? Just because some of the systems you cite have been fielded in a low number of government systems (which ones? Protecting what? From whom? And when were they attacked, by whom, and what was the outcome &#8211; certified?) does not prove those systems are either &#8220;high assurance&#8221; or anything stronger.</p>
<p>&#8220;In other words, you&#8217;re not always the one with the superior firepower. This is especially true if you&#8217;re going up against a government.&#8221;</p>
<p>&#8220;Red herring.&#8221;  I was referring to your reference about bringing attackers into physical range. You initiated that part. Now you&#8217;re saying I&#8217;m conflating that with your emphasis on remote software systems. I didn&#8217;t &#8211; you did.</p>
<p>&#8220;Again, whose even talking about that?&#8221;</p>
<p>Your reference to hydroshock, I believe.</p>
<p>But beyond that, my point stands. My point being: no matter how well your &#8220;high-assurance&#8221; solution works against certain types of remote attacks, there are other ways to compromise a system. And I&#8217;m not even talking about something that requires a physical penetration. I&#8217;m talking about things like social engineering and even more extreme methods like kidnapping the guy (or the kids of the guy) who knows the info rather than digging it out of the computer itself (better, having him dig it out because he&#8217;s being blackmailed.)</p>
<p>So in response to what good is physical security if some kid can remote own you, what good is a &#8220;high assurance OS&#8221; when the guy running it is compromised?</p>
<p>It&#8217;s six of one and a half dozen of the other. If it&#8217;s not ALL covered adequately, there is no security. A security system is only as good as its weakest link &#8211; rule number one.</p>
<p>&#8220;Most of my designs are made to defeat online attacks. EAL7 defeats the very best in this regard. EAL7 also covers trusted distribution, installation, configuration and maintenance. History proves me out on this one: not one high assurance system has ever been compromised on record or failed to do its job during serious natural faults. And you can bet some customer would have complained if it did.&#8221;</p>
<p>Now we get to the meat of it. How many such systems have been deployed, to whom, to protect what &#8211; and most importantly, how do we KNOW they have never been compromised?</p>
<p>What you just said is that to date, historically, these systems HAVE BEEN invulnerable. That&#8217;s not the same as saying they will ALWAYS be or that they CAN be.</p>
<p>In other words, this historical evidence is essentially anecdotal (read: worthless).</p>
<p>Again, without real evidence of sustained attack over significant time by competent attackers against these systems, no security system can be regarded as &#8220;successful&#8221;. Success in the real world is all that counts.</p>
<p>&#8220;An example in security is the Boeing SNS Server (also called &#8220;MLS LAN&#8221;) and in availability would be an IBM&#8217;s System/390 mainframe going 20-30 years before a reboot is required. Wow&#8230;&#8221;</p>
<p>Uh, &#8220;availability&#8221; is not a security issue vis-a-vis penetration, so that isn&#8217;t even remotely relevant.</p>
<p>&#8220;It&#8217;s not my problem. I don&#8217;t care about them. &#8221;</p>
<p>LOL.</p>
<p>&#8220;If the users screw it up, it&#8217;s not my fault &amp; doesn&#8217;t make my designs any less secure.&#8221;</p>
<p>And we&#8217;re back to you&#8217;re only fixated on the hardware and software which is what my point was.</p>
<p>My other point was that no matter how good you are at devising such a system someone else can defeat it. Which you still can&#8217;t prove BY DEFINITION other than to say, &#8220;Well, they haven&#8217;t beat it yet &#8211; and without providing any evidence to establish that anyone competent and well funded has actually tried.</p>
<p>&#8220;Exactly. That&#8217;s what high assurance development claims to produce. The difference is that it <em>actually</em> produces it most of the time. ;)&#8221;</p>
<p>Except when I talk about security not being possible, I&#8217;m not talking about &#8220;riff-raff&#8221;. I&#8217;m talking about competent motivated attackers.</p>
<p>It&#8217;s like terrorists. The only reason the US is still standing is because ninety nine percent of terrorists are incompetent, ill-equipped, and inadequately motivated, not to mention stupid.</p>
<p>I suspect the only reason your systems have not been compromised is that no competent attacker with a mandated objective has ever really tried. Or at least we don&#8217;t know for sure whether that is the case. If you do, cite the case if you can do so without breaching someone&#8217;s security. And even one case proves nothing &#8211; only a significant length of time (i.e., several years, longer probably isn&#8217;t feasible given technology changes) during which a number of competent attacks by more or less identified known competent and motivated attackers were identified and repulsed in the real world would establish actual &#8220;success&#8221;.</p>
<p>I submit there is no such proof.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163478">

			<div class="comment by-richard-steven-hack ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.computerproblemssolvedcheap.com' rel='external nofollow ugc' class='url'>Richard Steven Hack</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163478">
						July 5, 2011 8:48 PM					</a>

				</p>

				<p>Clilve:  ME: &#8220;&#8230; only be vulnerable to a zero day, and very few hackers are searching for and finding zero days on Linux.&#8221;</p>
<p>YOU: &#8220;That I&#8217;m not sure on for the simple reason most admins only know their machines are owned when abnormal things happen.&#8221;</p>
<p>I&#8217;m basing my opinion on what I&#8217;ve read about hacker emphasis. It just doesn&#8217;t seem like most hackers are really trying to penetrate Linux given the preponderance of Windows and the relative ease of penetrating Windows.</p>
<p>And as you say, I think UNIX sysadmins are more likely to be aware of a compromise than a Windows Server &#8220;mouse monkey&#8221;. You just don&#8217;t hear about a lot of Linux server compromises &#8211; outside of the Web facing side at least.</p>
<p>&#8220;If the more intelligent black hats have woken up to the ROI on APT as oposed to losses on DDoS / SPAM bots then well I&#8217;ll let you join the dots (the Chinese and Russians already appear to have from what I can see ;)&#8221;</p>
<p>I&#8217;m sure that&#8217;s true. But again, the profit is in Windows systems since Linux personal systems are only 1-3 percent of the market, and Linux server systems are last I heard maybe 30% (with UNIX taking up another 20% or so).</p>
<p>&#8220;That will only change if Linux gets more desktop share.&#8221;</p>
<p>&#8220;That applies more to low hanging fruit criminals and script kiddies, after a small return at best.&#8221;</p>
<p>True. But if Linux had a 30% desktop share instead of a 3% share, there would be more exploits devoted to penetrating Linux in order to create the same botnets as are based on Windows. And that would drive more Linux penetration research on the part of hackers.</p>
<p>&#8220;If and when the Banks get woken up by the legislators then I expect the position will change as the nice ripe peach low hanging fruits of EBanking in small businesses will (hopefully) disapear.&#8221;</p>
<p>I also doubt that&#8217;s going to happen, or at least not any time soon. Even if the Feds mandate more secure e-banking, it will take time for small businesses to convert over and a lot might never. If the Feds mandated something that cost SMBs a lot of money (rather than some $30-100 device like we were discussing in an earlier thread) and required modifying their normal business practices, you can bet it would be resisted mightily even if would reduce such losses.</p>
<p>&#8220;Yes and no, if you think about APT types the server targets they are after are mainly intra not extra net and here MS still rules the roost in high value targets like lawyers etc (infrastructure high end engineering and high end finance still use *nix for &#8220;uptime&#8221; reasons).&#8221;</p>
<p>True. But APT is designed to bypass the external OS defenses entirely. So it almost doesn&#8217;t matter what the OS defenses are. If you can get someone to drop something in their Linux personal account that allows you to capture their domain resource access passwords, you can access any data they have access to. No need for root or even logon access at all. Same with Windows. All you need to do is identify the OS to determine what applications they&#8217;re using and look for an unpatched application flaw. The OS itself doesn&#8217;t matter except to indicate which application version to exploit.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163479">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163479">
						July 6, 2011 4:07 AM					</a>

				</p>

				<p>&#8220;The two &#8211; &#8220;all nukes&#8221; and &#8220;nukes in general&#8221; &#8211; are not identical. My claim applied to the second. Q.E.D.&#8221;</p>
<p>Yeah, afterwards. At first, it was an overly broad claim without a context. Anyone can say.. after the fact&#8230; that they implied or meant to say something that made a then-poor argument make sense. Like you did. Yet, your first argument was still wrong and your recent one not nearly as open-and-shut as you believe it to be.</p>
<p>&#8220;&#8221;High assurance&#8221; is one of those industry PR terms which are completely meaningless if it&#8217;s not measured in specific metrics &#8211; which in security terms means long and competent penetration testing by people other than the developers.&#8221;</p>
<p>Not quite. I see a problem here with this and many other parts of your posts. I see you don&#8217;t know too much about why these high assurace, such as EAL7 or DO-178B designs, invoke so much confidence. Testing? PLEASE! EAL7 uses formal (mathematical) verification to prove correspondence because &#8220;testing can only prove the presence, not the absence, of bugs&#8221; (Dijkstra). And they use requirements to design to code correspondence proofs, source testing, reviews, code analysis, covert channel identification, pen testing by top notch attackers, an independent lab doing the same thing, and years of effort for the evaluation. The result is usually that, whatever its security target said, it WILL do almost EVERY time. By almost, the industry norm is to say that there will not be a critical failure in the field for a long time, if ever. History proves this out.</p>
<p>The bigger question in my mind is why you, a smart guy, don&#8217;t seem to know much about this and just talk about testing &amp; guys doing reviews that you describe that sound like basic code reviews, not strong mathematical techniques. Why do you see no &#8220;historical&#8221; evidence or &#8220;metrics?&#8221; There are TONS of papers showing metrics, cost analyses, effectiveness of verification, and even defect counts of certain processes. How could you miss all of this?</p>
<p>The answer: Richard Steven Hack doesn&#8217;t believe in security and for this reason the only thing he looks for is evidence that there is no security. You have no shortage of stories about how this failed, how these lawmakers schemed, etc. While I cite both security successes and failures, you only seem to post about failures of security claims. Anyone looking for the opposite would have found the likes of Cleanroom, Fagan&#8217;s Software Inspection Process and Praxis&#8217; Correct by Construction. These pop up in lots of places and show very low defect counts measured with mainstream statistical techniques.</p>
<p>You might have also found things like the LOCK program that broke down specifically what the extra high assurance techniques accomplished, among other examples. You apparently found none of this. It&#8217;s there. I&#8217;ve mentioned the names of these methodologies plenty (and most are the &#8220;medium&#8221; end in spite of these great metrics). So, why do you still say &#8220;PR terms which are completely meaningless if it&#8217;s not measured in specific metrics&#8221; and &#8220;And this was tested by who? Those sophisticated, well-funded attackers were identify as who?&#8221;</p>
<p>Try 2 to 5 years of NSA, SAIC and Cygnacom&#8217;s best people. Try products that withstood attacks for years with no signs of compromise, after source &amp; design level validation couldn&#8217;t find anything useful either. Try products, like Praxis&#8217;, where the defect rate was 2 1/2 better than the Space Shuttle control code and no serious defects were found. Cleanroom empirical studies, which you&#8217;d seen had you Googled for this stuff, consistently show low defect density and many fielded systems that had no significant problems far as the users were concerned. (User-centric reliability &amp; meeting requirements is usually the goal of Cleanroom, hence that focus.)</p>
<p>Why I mention mainframe? Availability is part of security, especially where fuzz testing and online attacks are concerned. 20 years of both accidental and malicious problems without a reboot is significant evidence to my claims that certain engineering processes can produce systems that meet their goals with high confidence for long periods of time w/out failure. The old Orange Book A1 class systems and current EAL7 class systems just apply an even more extreme version of these principles to achieving confidentiality and integrity (read: security in their context). Strange as it seems, these are easier to verify with high assurance because they can be easily modeled in mathematics (e.g. Bell Lapadula, Biba, Lattices &amp; Type Enforcement).</p>
<p>&#8220;I&#8217;m complaining about your talking about your specific technology as being &#8220;high assurance&#8221; when in fact there is zero evidence to prove that it is absent long and sustained actual success in the field actually repulsing competent attackers.&#8221;</p>
<p>I promote approaches to high assurance: principles, methodologies, design approaches, etc. I also call certain products, like GEMSOS or INTEGRITY-178B, high assurance with regard to what their security targets claimed to accomplish, the evaluations they survived, and what they accomplished in the field. My designs are made to be consistent with high assurance design principles and certifiable to those levels if a high assurance development process creates a concrete design, implementation, etc.</p>
<p>So, you could say the designs have the potential to be developed and certified to high assurance, but they aren&#8217;t high assurance by themselves. However, most designs people present have problems that prevent them from being certified to high assurance, esp. complexity. Also, my designs&#8217; use of secure design principles (see Saltzer &amp; Schroder, Parnas, Schell, etc.) certainly eliminates many classes of attacks. Like I often say, eliminate the low hanging fruit first and raise the rest much higher.</p>
<p>&#8220;My point being: no matter how well your &#8220;high-assurance&#8221; solution works against certain types of remote attacks, there are other ways to compromise a system. &#8221;</p>
<p>Again, WHO CARES. If we can&#8217;t get the system itself right, then those methods never have to be used. They can always just do a few keystrokes and be on their merry way. Of course, extreme physical attacks would defeat such systems. Guess what? Systems designed to deal with that are different and take that into account. But, the vast majority of attackers WILL NOT &#8220;kidnap,&#8221; get face-to-face with, have a shootout with, or try any other physical attack on their victim. The majority of attackers do what they do because the risk is low, the battle is easily won, and the expenses are minimal. (Carders, drive-by downloads, ACH fraud, and others come to mind).</p>
<p>Change these things and you defeat the majority of attackers. If they get physical, newsworthy exploits just give me all the market demand I need to come up with something that beats that too for most physical attackers. Most won&#8217;t get physical though: they just drop out of the race and the damage done drops that much. The vast majority of attacks right now take place due to poorly configured discretionary controls that allow simple social engineering attacks and software that sucks. High assurance designs with mandatory controls raise the bar so high that few would even attempt to attack them. That translates to significantly lower risk for businesses and governments.</p>
<p>&#8220;And we&#8217;re back to you&#8217;re only fixated on the hardware and software which is what my point was.&#8221;</p>
<p>You&#8217;re point was that that was a bad thing. That&#8217;s like saying a lock designer is &#8220;fixated&#8221; on designing locks and this is bad because people might loan bad people keys. Tell that to one and he&#8217;d laugh at you. He&#8217;d tell you, as I am now, that the purpose of this focus is to give users the tools they need for a specific part of their security and guidance on proper usage. Users choose what to do with them. I&#8217;m not trying to give security to people who don&#8217;t care about it: they&#8217;ll always subvert themselves for the most part. I&#8217;m creating the tools and techniques that responsible people can use to improve their security. Others create different tools and approaches. They are combined for overall security. There&#8217;s no &#8220;fixated:&#8221; there&#8217;s just &#8220;We each do what part we&#8217;re good at and try to make our parts work together to achieve security as a whole.&#8221;</p>
<p>&#8220;I suspect the only reason your systems have not been compromised is that no competent attacker with a mandated objective has ever really tried.&#8221;</p>
<p>I keep thinking you only say this stuff because you failed. If I recall correctly, you got caught. So many of us were smart enough to dodge those that chased us. The statute of limitations has passed&#8230; no guarantee, there. Back when I was younger, I humiliated plenty of admins, property managers and occasionally political bigwigs. I caused no <em>actual</em> damage to decent people. The high end opponents, who I think you&#8217;ll know, apparently didn&#8217;t pursue me en masse. (Luck or proper choice of targets?) Those that tried (and we certainly detected them), couldn&#8217;t find jack because we were good at dealing with that. Paranoia pays off sometimes I guess.</p>
<p>Academics have replicated some of my methods in theory and prototype, but they still work in practice due to the lag between academic theory and widespread adoption. Anyway, just because you weren&#8217;t good enough doesn&#8217;t mean all others will fail. &#8220;There [truly] is no security&#8221; for Richard Steven Hack. I can believe that. But, many of us have accomplished far more in practice, maybe not forever. We instead say &#8220;practical high security is hard and painful to accomplish, but possible.&#8221; You just seem to be projecting your own failures on everyone and everything else. That&#8217;s what I keep feeling.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163480">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163480">
						July 6, 2011 9:53 AM					</a>

				</p>

				<p>@nickP, man you make my head hurt. this thread is going to make me research for days. My understanding condensed would be the basic premise that operators and admin screw up in execution and operation of systems. There is no perfect security. You weigh the threats, act accordingly and have losts of backup/recovery plans. oh, and that software is written poorly. If a professional wants in your system they can. Anybody can read this stuff from clive, you, or bruce and many others. The problem it is not applied. There should be licenses to own a computer.<br />
That goes out to all the &#8220;family&#8221; IT people out there. &#8220;what did you do?&#8221;</p>
<p>the ugly stepchild of access control is physical security. I have seen spaces that a two year old could kick in through the wall (but readers, no latch guard)It&#8217;s enough to make you scream or &#8220;professionals&#8221; not even thinking twice about using an unsecured wifi at starbucks.</p>
<p>For me, the more I learn the less I have to admit I know. 😉 Bowing to the greats in this thread.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163481">

			<div class="comment by-miriam-r ">

				<p class="commentcredit">

					<span class="commenter">Miriam R</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163481">
						July 6, 2011 10:21 AM					</a>

				</p>

				<p>[warning &#8211; n00b post]<br />
I&#8217;m a little surprised that no one here has mentioned the Qubes Project.  Given the discussion of trusted computing and sandboxing, evil USB and access to MBR from within the OS, it seems that Qubes would be part of the solution.</p>
<p>Yes, the trust chain starts with Intel TPM, but it&#8217;s a start at creating a functional desktop for end users that has isolation built in.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163482">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163482">
						July 6, 2011 12:49 PM					</a>

				</p>

				<p>@ Miriam R,</p>
<p>&#8220;I&#8217;m a little surprised that no one here has mentioned the Qubes Project&#8221;</p>
<p>It was mentioned by Mashiara in another thred on this blog just a little while ago,</p>
<p><a href="http://www.schneier.com/blog/archives/2011/06/malware_in_goog.html#c552007" rel="nofollow ugc">http://www.schneier.com/blog/archives/2011/06/malware_in_goog.html#c552007</a></p>
<p>@ Jacob,</p>
<p>&#8220;&#8230; man you make my head hurt &#8230;&#8221;</p>
<p>It get&#8217;s like that from time to time ask Nick P about &#8220;Castles-v-Prisons&#8221; I thing he had similar setiments 8)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163483">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163483">
						July 6, 2011 1:16 PM					</a>

				</p>

				<p>@clive my guess that would depend on whether you wanted to keep people in vs. out?? Just stirring it up. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163485">

			<div class="comment by-richard-steven-hack ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.computerproblemssolvedcheap.com' rel='external nofollow ugc' class='url'>Richard Steven Hack</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163485">
						July 6, 2011 2:36 PM					</a>

				</p>

				<p>Nick: &#8220;The two &#8211; &#8220;all nukes&#8221; and &#8220;nukes in general&#8221; &#8211; are not identical. My claim applied to the second. Q.E.D.&#8221;</p>
<p>&#8220;Yeah, afterwards. At first, it was an overly broad claim without a context. Anyone can say.. after the fact&#8230; that they implied or meant to say something that made a then-poor argument make sense. Like you did.&#8221;</p>
<p>And anyone can misunderstand the first statement. As you did.</p>
<p>OBVIOUSLY I have never believed that ALL &#8211; i.e., every single one &#8211; of existing nukes were never meant to be used. Since two WERE used, that is a historical fact. It&#8217;s irrelevant to my argument.</p>
<p>You&#8217;re just complaining now because your response was overly broad and irrelevant.</p>
<p>&#8220;Testing? PLEASE! EAL7 uses formal (mathematical) verification to prove correspondence because &#8220;testing can only prove the presence, not the absence, of bugs&#8221; (Dijkstra). And they use requirements to design to code correspondence proofs, source testing, reviews, code analysis, covert channel identification, pen testing by top notch attackers, an independent lab doing the same thing, and years of effort for the evaluation.&#8221;</p>
<p>Nonsense. Yes, I said nonsense. There is no way a sufficiently complicated system of that type can be formally proven. It&#8217;s too complicated.</p>
<p>The only relevant part is your &#8220;pen testing by top notch attackers&#8221;. The problem with that is those attackers, while being reasonably well motivated, are by definition NOT as well motivated as the people who REALLY want to get into that system, not because they are being a salary but because they are either criminally or ideologically motivated.</p>
<p>I repeat &#8211; only a history in the real world of resisting ACTUAL attacks by ACTUAL attackers &#8211; not people pretending to be attackers &#8211; can one assume one&#8217;s security is &#8211; for the moment &#8211; adequate. The real world is the ONLY validator.</p>
<p>&#8220;Why do you see no &#8220;historical&#8221; evidence or &#8220;metrics?&#8221; There are TONS of papers showing metrics, cost analyses, effectiveness of verification, and even defect counts of certain processes. How could you miss all of this?&#8221;</p>
<p>Because I have other things to do than read them. I know they exist, that is sufficient.</p>
<p>What I do NOT know exists is formal proof of a complex operating system. It is my understanding that formal proofs have only been applied to relatively small systems, single programs, and the like. I do not believe &#8211; correct me if I&#8217;m wrong &#8211; that anyone has applied a formal proof to a multi-million lines of code operating system. If you can cite where that has been done, I&#8217;ll take your word for it.</p>
<p>&#8220;The answer: Richard Steven Hack doesn&#8217;t believe in security and for this reason the only thing he looks for is evidence that there is no security.&#8221;</p>
<p>Because that is what you do with security &#8211; look for the failures and potential failures. Because if you have failures, you have no security. Again, Q.E.D.</p>
<p>You have the mindset of a designer. I have the mindset of a criminal penetrator. And that is precisely the guy you have to worry about when designing your stuff. That is the guy you need to have testing your stuff &#8211; not some mathematician doing a proof.</p>
<p>&#8220;show very low defect counts measured with mainstream statistical techniques.&#8221;</p>
<p>And they&#8217;ve never formally proven a multi-million line OS to be mathematically correct. Am I wrong?</p>
<p>&#8220;Try 2 to 5 years of NSA, SAIC and Cygnacom&#8217;s best people. Try products that withstood attacks for years with no signs of compromise, after source &amp; design level validation couldn&#8217;t find anything useful either.&#8221;</p>
<p>Once again &#8211; deployed where, protecting what, and attacked by whom &#8211; external attackers, not government guys &#8211; and when?</p>
<p>&#8220;many fielded systems that had no significant problems far as the users were concerned. (User-centric reliability &amp; meeting requirements is usually the goal of Cleanroom, hence that focus.)&#8221;</p>
<p>And once again, you&#8217;re blowing smoke up my ass with generalities about &#8220;reliable systems&#8221; which is irrelevant to my question. You still haven&#8217;t cited one single system deployed to protect something of importance that actual attackers have repeatedly attempted to access which has withstood such attacks for a minimum of say, three years without a single compromise &#8211; and that success has been verified, not just guessed at because no one detected it.</p>
<p>&#8220;Availability is part of security&#8221;</p>
<p>No, it is not.</p>
<p>&#8220;20 years of both accidental and malicious problems without a reboot is significant evidence&#8221;</p>
<p>No, it is not. Not without direct evidence that malicious attacks by competent attackers attempting to obtain something of value were verified not to have been successful. Again, this is the ONLY criteria which can be applied to prove success.</p>
<p>&#8220;I also call certain products, like GEMSOS or INTEGRITY-178B, high assurance with regard to what their security targets claimed to accomplish, the evaluations they survived, and what they accomplished in the field.&#8221;</p>
<p>And the only relevant part is &#8220;what they accomplished in the field&#8221;. Which means you list the attacks that were made against them, the nature and competence of the attackers involved &#8211; again, real world attackers, not pen testers &#8211; and verify that not one of those attackers ever made it into the system over a period of at least three years, if not longer. Cite that and I will believe that your systems are &#8220;high assurance&#8221; &#8211; for now.</p>
<p>My designs are made to be consistent with high assurance design principles and certifiable to those levels if a high assurance development process creates a concrete design, implementation, etc.&#8221;</p>
<p>Yeah, yeah, blah, blah. Answer the question: where was it deployed, what was it protecting, who attacked it, and is it certified that it was never ever penetrated for at least three years?</p>
<p>&#8220;However, most designs people present have problems that prevent them from being certified to high assurance, esp. complexity.&#8221;</p>
<p>Exactly what I said above. No one has proven a multi-million line operating system to be provable correct &#8211; and it&#8217;s unlikely outside of an AI approach that anyone ever will.</p>
<p>&#8220;If we can&#8217;t get the system itself right, then those methods never have to be used.&#8221;</p>
<p>Never said one shouldn&#8217;t try. Although there are limits to how much money and effort should be expended to try, depending on the value of what one is trying to protect. Just don&#8217;t believe you succeeded until you have years of actual real world success against real world opponents. If a system remains un-compromised until it is retired for a new and better system, then you can claim it was a complete success (IF in fact it was attacked repeatedly &#8211; a system that was never attacked or only attacked by &#8220;riff-raff&#8221; is not a success on the level we&#8217;re talking about.)</p>
<p>&#8220;High assurance designs with mandatory controls raise the bar so high that few would even attempt to attack them. That translates to significantly lower risk for businesses and governments.&#8221;</p>
<p>Once again, this is irrelevant to my point. My point is about committed, high competence attackers, not riff-raff. You don&#8217;t spend millions or billions on high-assurance systems to stop script kiddies.</p>
<p>&#8220;I&#8217;m creating the tools and techniques that responsible people can use to improve their security.&#8221;</p>
<p>I&#8217;m not talking about that. I&#8217;m talking about your assumption that because you design such systems that you believe they cannot be compromised by committed, high competence attackers. I&#8217;m telling you that isn&#8217;t true.</p>
<p>And there are a hell of a lot of supposed &#8220;unbreakable, un-pickable&#8221; locks being defeated daily &#8211; or bypassed all together.</p>
<p>&#8220;There&#8217;s no &#8216;fixated:'&#8221;  The fixation comes when you believe that any given part of security is BY ITSELF unbeatable. Which is precisely what you are claiming when you say these &#8220;high assurance&#8221; operating systems have done twenty years without compromise.</p>
<p>&#8220;I keep thinking you only say this stuff because you failed. If I recall correctly, you got caught.&#8221;</p>
<p>I know precisely how I got caught doing a physical crime. I also know that if I had done a little more research &#8211; in fact, if I had come out of a criminal milieu where other criminals could have informed me of the proper methods for dealing with radio transmitters &#8211; I would have succeeded. Which means I would have defeated a technological means which the bank and law enforcement believed made them more secure but which in fact could be easily evaded and in fact is frequently so evaded.</p>
<p>&#8220;Paranoia pays off sometimes I guess.&#8221;  It does, indeed.</p>
<p>&#8220;Anyway, just because you weren&#8217;t good enough doesn&#8217;t mean all others will fail.&#8221;</p>
<p>It&#8217;s funny that you&#8217;re citing my point back to me. Just because your systems may have worked for some people against some attackers doesn&#8217;t mean all other attackers will fail. That is the whole point: you can NEVER know that you have security until the day you drop dead &#8211; from natural causes 🙂 &#8211; without having been defeated.</p>
<p>Not even Miyamoto Mushashi achieved that. Legend has it a ninja with a fan defeated the greatest Japanese swordsman who ever lived. Which is perfectly relevant to what we&#8217;re talking about &#8211; someone with the technological equivalent of a fan might defeat your &#8220;high assurance&#8221; sword if they&#8217;re clever enough.</p>
<p>&#8220;We instead say &#8216;practical high security is hard and painful to accomplish, but possible.'&#8221;</p>
<p>And I don&#8217;t say it&#8217;s totally impossible to have &#8220;high&#8221; security. My meme says this explicitly: You can haz worse security. You can haz better security. But you can&#8217;t haz security.&#8221; Because there is no absolute known as &#8220;security&#8221;.</p>
<p>And the reason for that is because of what could be called the &#8220;uncertainty principle.&#8221;  Or simply, &#8220;shit happens&#8221;. As I said elsewhere, stop trying to control the universe. Because you can&#8217;t. Instead, concentrate on dealing with what happens.</p>
<p>This is a principle long known in martial arts. You don&#8217;t master a few techniques and then use them to deal with everything. You learn to merge with what&#8217;s happening and do what is necessary to turn it to your advantage.</p>
<p>&#8220;You just seem to be projecting your own failures on everyone and everything else. That&#8217;s what I keep feeling.&#8221;</p>
<p>Unfortunately, your feelings aren&#8217;t relevant here. I make an argument which is based on logic and the real world of security and the history of actual attempts to achieve &#8220;security&#8221;, not theoretical proofs.</p>
<p>&#8220;Bowing to the greats in this thread.&#8221;</p>
<p>That would be me. 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163486">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163486">
						July 6, 2011 4:53 PM					</a>

				</p>

				<p>@ Richard Steven Hack</p>
<p>It&#8217;s starting to become clear this is a religion for you, not a science. Less worth a debate. I&#8217;ll address a few points.</p>
<p>&#8220;Nonsense. Yes, I said nonsense. There is no way a sufficiently complicated system of that type can be formally proven. It&#8217;s too complicated.&#8221;</p>
<p>You have proof, right? As opposed to a statement of faith that there is no possibility?</p>
<p>&#8220;The only relevant part is your &#8220;pen testing by top notch attackers&#8221;. &#8221;</p>
<p>Utter nonsense. Design &amp; code reviews by pro&#8217;s catch most of the problems in a rigorous design process, as well as internal testing. People like Smith, of LOCK program, also reported that merely using a formal specification eliminated many problems just because it forced them to be unambiguous &amp; make the design more straightforward. Covert channel analysis also found tons of leaks &amp; choked attackers further. The &#8220;new&#8221; Jitterbug &amp; DNS attacks would have been caught that way. Finally, numerous project leaders, esp. SCOMP &amp; LOCK, noted that using formal proofs found flaws in the security model and implementation.</p>
<p>Then, they started the pen testing. Even an amateur developer would laugh at your claim that only pentesting is important. The previous methods force a system to be correct, with high likelihood, right out the door &amp; prevent defects all throughout. It&#8217;s no surprise that subsequent evaluations &amp; pen testing never found any significant problems.</p>
<p>&#8220;Because I have other things to do than read them. I know they exist, that is sufficient. &#8221;</p>
<p>Paraphrased: I know there exists papers that contain empirical evidence about these claims, but I&#8217;m not going to read them &amp; will instead find evidence supporting my own view point. Reminds me of creationists debating style&#8230;</p>
<p>&#8220;What I do NOT know exists is formal proof of a complex operating system. It is my understanding that formal proofs have only been applied to relatively small systems, single programs, and the like.&#8221;</p>
<p>The first sensible thing you&#8217;ve said! Absolutely. There&#8217;s efforts right now at systems with a million lines of code. However, the traditional approach is to use these approaches to make a big system verifiable: layering; decomposition into small modules; precisely specified interfaces and interactions; then modeling of each module to prove it&#8217;s correctness, then use those results &amp; a model of component interactions to prove system correctness as a whole. Real-world examples: GEMSOS&#8217;s kernel was a bunch of non-looping layers &amp; interactions were verified; BLACKER VPN modeled each component as a system and then the overall VPN combined those results into a network-level model.</p>
<p>So, like with any complex system engineering, it&#8217;s all about turning a big problem into a bunch of little ones, solving the little ones, and tying it all together. It&#8217;s been done plenty of times and the reports often give very specific metrics. More recent reports, like L4.Verified, are careful to say when an assumption is made &amp; exactly what the proofs apply too. Again, it&#8217;s why designers try to keep the TCB to a minimum so the formal processes are focused on that.</p>
<p>&#8220;Because that is what you do with security &#8211; look for the failures and potential failures. Because if you have failures, you have no security&#8221;</p>
<p>No, that&#8217;s one aspect of security. Another is thinking in terms of information flow and transformation, which is the original model of security (i.e. Shannon). Every effective access control mechanism tries to control how information flows, the process management mechanism tries to isolate information into compartments, &amp; control of write privileges ensures integrity of information. So, it&#8217;s all about controlling information. The failures just taught us about approaches that didn&#8217;t work. You also have to look at successes &amp; there have been many.</p>
<p>Reusing a successful approach against another instance indicates likely success. Bell-Lapadula model, for instance, has been ensuring multi-level security for two decades now. It will probably work in the next system. The type-safe, memory managed language defeats buffer overflows at application level by design becaues they are logically impossible. (We focus on VM &amp; libraries instead.) So do I have to pen test my next Java application to ensure each of it&#8217;s variables won&#8217;t overflow? Or can I trust its design and previous successes to tell me that? So, there&#8217;s definitely more ways to prove &amp; produce correctness without just thinking of failure. That should be just one element in the process.</p>
<p>&#8220;No, it is not. Not without direct evidence that malicious attacks by competent attackers attempting to obtain something of value were verified not to have been successful. Again, this is the ONLY criteria which can be applied to prove success.&#8221;</p>
<p>&#8220;And the only relevant part is &#8220;what they accomplished in the field&#8221;. Which means you list the attacks that were made against them, the nature and competence of the attackers involved&#8221;</p>
<p>The first problem with these repetitions is that you deny every measurement I give and yet you fail to give any practical alternative. How exactly does one look at a system, know it&#8217;s had an advanced compromise, know what type of attacker did it, and know how often it&#8217;s happened over three years? You&#8217;ve simply made the criteria as such that&#8217;s impossible to provide evidence that you would accept.</p>
<p>My alternative is easier. You talk about failure modes. Let&#8217;s apply them to the mainframe. How would an attack happen? An application-level attack that get&#8217;s a new process started, possibly crashing the old app? A ton of extra network traffic leaving the mainframe to an unusual IP? A bunch of login attempts? There&#8217;s only so many general and specific avenues of attack and most get noticed as the attacker probably doesn&#8217;t know the system and networking configuration ahead of time. That no admin&#8217;s report a compromise and the system stayed stable for 20 years indicate it resisted whatever was thrown at it.</p>
<p>As for GEMSOS &amp; INTEGRITY-178B, they were deployed in the field protecting highly classified information with no evidence of a compromise. GEMSOS was a MLS system, so any residual covert channel only let 10 bits per second through &amp; was audited. Three years field use? Try ten for INTEGRITY-178B. It got it&#8217;s EAL6+ certification in 2008, after 2 years of pen testing. It&#8217;s 2011 and still no failure. Boeing&#8217;s SNS was certified to high assurance by NSA in 1994, with every improvement making the grade again. It&#8217;s been deployed to protect high value assets from hackers for 17 years now without a compromise &amp; they&#8217;re doing an EAL7 evaluation just in case.</p>
<p>These systems were built with so-called Correct by Construction approaches and, like you said, what happens in the field says a lot about the approachs&#8217; claims. Medium assurance approaches have achieved similar success. MULTOS was targetted at a lower level of assurance, is deployed in tons of smart cards, and nobody has compromised the OS. OKL4 4.0, medium assurance, has been deployed in hundreds of millions of phones without a reported compromise or OS-related failure. BAE&#8217;s XTS/STOP line reused the SCOMP OS &amp; built a medium to high assurance platform on it. Originally certified to EAL6/B3 in 1992, it&#8217;s got no public compromises and currently protects at least 200 sites according to their web site.</p>
<p>So, we have several systems using the approaches I advocate that have survived over ten years in the field. So, yes, these approaches obviously work, it has been done in 20th century, it can be done now with superior technology, and the systems are usually trustworthy for years afterward. It&#8217;s not absolute, it&#8217;s not perfect, and it&#8217;s not the only part of security, but it&#8217;s there and does its part.</p>
<p>Repeating &#8220;there is no security&#8221; repeatedly while ignoring evidence of high security in certain contexts doesn&#8217;t change the truth: in all likelihood, you nor anyone else will ever hack something designed like this &amp; if you do it will take years. That&#8217;s what I mean when I usually say &#8220;secure,&#8221; because  I honestly get tired of typing &#8220;high assurance.&#8221; History proves me out, as I&#8217;ve illustrated. We can&#8217;t take this approach for all systems. We can do it for the core functionality of critical systems, networks, etc. Pessimism with religious zeal is a poor excuse not to apply methods proven to work to do what we can.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163487">

			<div class="comment by-tommy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.amiright.com/parody/misc/julieandrews50.shtml' rel='external nofollow ugc' class='url'>tommy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163487">
						July 6, 2011 8:48 PM					</a>

				</p>

				<p>@ Richard Steven Hack and Nick P.:</p>
<p>Wow, this blog has always had high information value. Who knew it had high entertainment value as well? ;-D</p>
<p>Seriously, it&#8217;s good to see these things hashed (no pun intended) out, and the more links and potential search terms of what&#8217;s out there, the better.</p>
<p>@ Nick P.:</p>
<p>&#8220;Reminds me of creationists debating style&#8230;&#8221;</p>
<p>Did you mean, a group of creationists sitting around, watching Bravo, and talking about next season&#8217;s fashions? &#8230;<br />
hmm, no, I think you meant,</p>
<p>&#8220;Reminds me of creationists&#8217; debating style&#8230;&#8221; i. e., the debating style used by creationists. 🙂</p>
<p>Of course we all knew what you meant, and it&#8217;s a blog, not a legal contract. But it&#8217;s a cool example &#8212; not at your expense; everyone does it, self included, at blogs and such &#8212; of why I&#8217;m a rigid &#8220;prescriptivist&#8221; in grammar, derided by modern &#8220;descriptivists&#8221; as being old-fashioned or OCD or anal or whatever. One single apostrophe, to show possessiveness, or the lack of same, completely changes the literal meaning.</p>
<p>People who write code for a living understand that, then turn around and write their English with no such care or respect for syntax. I&#8217;m not talking about you or me or this blog, but about professional, academic, scientific, didactic, or other &#8220;serious&#8221; works. (Which is why I&#8217;ve offered proofreading service several times.) OK, you guys have had your rants; now I&#8217;ve had mine. 🙂</p>
<p>Speaking of the creation/evolution debate, here&#8217;s my satiric take on the whole thing:</p>
<p>&#8220;Where Do I Begin? (Theme from &#8220;Love Story&#8221;)&#8221; by Andy Williams =</p>
<p>&#8220;Where Did Man Begin? (Creation / Evolution)&#8221; by Your Humble Servant, Tommy Turtle:</p>
<p><a href="http://www.amiright.com/parody/70s/andywilliams5.shtml" rel="nofollow ugc">http://www.amiright.com/parody/70s/andywilliams5.shtml</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163488">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163488">
						July 6, 2011 9:15 PM					</a>

				</p>

				<p>@NickP Hopefully not stirring up a hornet&#8217;s nest.<br />
1. People who are pessimistic may be guilty of assuming that because something &#8220;can&#8221; be defeated that a security system has less than perfect value.<br />
2.They don&#8217;t understand the concept that security is not perfect and never will be. You evaluate the risks, value of what you are protecting, and how much loss you are willing to swallow.<br />
3. Security is more than computer code. It involves physical security, access control, user rights, audits, pen testing (yes i said it), and many other things.<br />
4. If a space with servers had physical security with readers, electric strikes, a heavy duty door, etc. and has no extended wall but drop ceiling it&#8217;s a security risk..If users don&#8217;t have the ability to operate the mouse, chances are they can send a confidential document by mistake.<br />
5. It&#8217;s like putting a camera in place, the thief knows it and wears a mask or that snatch and grab. It&#8217;s pretty hard to defend against in some cases.<br />
6. The security industry is pessimistic by nature but we risk blaming customers or each other for a &#8220;perfect&#8221; solution that does not exist and never will.<br />
7. I am a noob so to speak but always trying to learn and realize that are many bright and more experienced people than me out there. I try to talk and listen to them. I know how Bruce feels about certs but I would certainly give someone with a GSE and proven track record the job for evaluation or hopefully he/she could help with the  project for an enterprise deployment.<br />
8. Sometimes I have seriously considered taking cd drives out, disabling the USBs and putting resin in the holes. Less chance for mischief. I have VERY strongly advocated encryption for practically anything. esp. notebooks and usb devices. walling off info, and procedures.<br />
9. Most of the time it is not how much I know or even remember that is important. It is a matter of who I bring in to project and who can explain to the customer.<br />
10. I have thought for years that say 10 small businesses could pool their resources and hire an IT security team or contract one for the group. They may not be able to afford a crack team (pun intended) alone but together could do it. Just my thoughts.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163489">

			<div class="comment by-tommy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.amiright.com/parody/misc/littleanthonyandtheimperials6.shtml' rel='external nofollow ugc' class='url'>tommy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163489">
						July 6, 2011 9:33 PM					</a>

				</p>

				<p>@ Jacob:</p>
<p>&#8220;8. Sometimes I have seriously considered taking cd drives out, disabling the USBs and putting resin in the holes. Less chance for mischief. I have VERY strongly advocated encryption for practically anything. esp. notebooks and usb devices. walling off info, and procedures.&#8221;</p>
<p>Don&#8217;t take out the CD drives. We had an extensive discussion about raising the security of online banking,</p>
<p><a href="http://www.schneier.com/blog/archives/2011/06/court_ruling_on.html" rel="nofollow ugc">http://www.schneier.com/blog/archives/2011/06/court_ruling_on.html</a></p>
<p>and the idea of booting from a live CD, which is non-writeable and hence non-infectible, came up a good bit. Also, tools like Acronis create full-disk-image backups and emergency boot CDs that can reboot a totally hosed, non-bootable computer and restore it to a pre-infection state, if that date is known. Other CD tools can remove malware that Windows or whatever can&#8217;t even see while it&#8217;s running.</p>
<p>I&#8217;ve recommended Sandboxie for unknown USB sticks, optical discs, and <em>all</em> browsing (as I am doing right now), with appropriate disclamers (not connected with the company; I can&#8217;t be liable for your results). Low-cost, low-tech, available now. Not perfect, but a quantum (no pun) leap in average-user security.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163490">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163490">
						July 6, 2011 10:33 PM					</a>

				</p>

				<p>@ jacob</p>
<p>&#8220;hopefully not stirring up a hornets nest&#8221;</p>
<p>Hardly. Richard and I often focus on the opposite extremes of the situation. I started firing posts at him because he was basically ignoring, not reading, etc. any evidence against his claims. People rarely do that on this blog, so the discussions are more civil. Another reason for the content in my posts was to provide useful, verifiable anecdotes for anyone else reading our posts who wanted to know what has been achieved and what&#8217;s achievable.</p>
<p>&#8220;3. Security is more than computer code. It involves physical security, access control, user rights, audits, pen testing (yes i said it), and many other things.&#8221;</p>
<p>Oh, absolutely. Like I told Richard, we all have our specialties. Mine are system analysis, pentesting (surprise!), software security, system-level security, subversion and covert channels. I have medium knowledge of most of the other issues, maybe just a bit more or less than a CISSP or GSEC cert requires. Real implementations involve physical and information security. I also have to tell users about proper usage of the system, what risks they might face, illustrate them (seeing is believing), and tell them how to respond to each. This must also be codified in policies for legal reasons. There&#8217;s testing, maintenance issues, etc. There&#8217;s usually a team of us doing all of that.</p>
<p>These are also all required to be addressed in a robust way for a high assurance product evaluation. Just look up Orange Book A1 &amp; Common Criteria EAL7 requirements if you doubt this. But, my focus is on my specialties. If my designs were productized, all the other stuff would be addressed, probably by domain experts. Would you really want a guy like me to try to give advice on what constitutes &#8220;high assurance&#8221; physical security? Nah, better to leave that to someone else. 😉</p>
<p>&#8220;Sometimes I have seriously considered taking cd drives out, disabling the USBs and putting resin in the holes. Less chance for mischief. I have VERY strongly advocated encryption for practically anything. esp. notebooks and usb devices. walling off info, and procedures.&#8221;</p>
<p>All good ideas and not as paranoid as you think. Executives have been known to pull batteries out of their cell phones during confidential meetings and physically plug USB ports. Matter of fact, I have done exactly what you described: removing potentially buggy devices; disabling DMA on IDE with a jumper change; clogging up ports; buying a Core i7 and disabling all but one core, among other BIOS options. The last might leave you puzzled but most paradoxes have an answer: i7&#8217;s had fewer security-critical processor errata (see Kris Kaspersky&#8217;s CPU bug presentation) and the use of multiple cores sharing one cache allows covert leaking of information. So, a one core i7 kills two birds with one stone.</p>
<p>But, for a  general-purpose PC, tommy is right in recommending you keep the CD-ROM. So long as your BIOS is intact, a CD is one of the cleanest ways to boot to a secure state. Might be to bank online, restore your computer, whatever. The important point is that read-only, bootable media is inherently more trustworthy than something your software can change.</p>
<p>&#8220;Most of the time it is not how much I know or even remember that is important. It is a matter of who I bring in to project and who can explain to the customer. &#8221;</p>
<p>Yes, user or customer acceptance often makes or breaks a security opportunity. The higher the cost, the more justification is required. To make it even harder, lay people naturally have a hard time understanding these kinds of risks and the security industry&#8217;s F.U.D. makes it hard to earn customer&#8217;s trust.</p>
<p>&#8220;I have thought for years that say 10 small businesses could pool their resources and hire an IT security team or contract one for the group. They may not be able to afford a crack team (pun intended) alone but together could do it. Just my thoughts.&#8221;</p>
<p>tommy, he&#8217;s stumbling on one of my business models. 😉 The concept is doable. My previous thinking about these ideas led me to think about creating a nonprofit that targeted small businesses and non-profits. For a certain membership fee, they get access to the services based on need. There might be a higher fee the first year to cover the extra costs. The services end would focus on the core services that provide the highest security ROI, like secure configuration of critical servers or apps.</p>
<p>The nonprofit might even be started with grant money &amp; offer to advertise which big companies are &#8220;helping small businesses secure their network.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163491">

			<div class="comment by-tommy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.amiright.com/parody/70s/jimmybuffet23.shtml' rel='external nofollow ugc' class='url'>tommy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163491">
						July 7, 2011 12:24 AM					</a>

				</p>

				<p>@ Nick P.:</p>
<blockquote>
<blockquote>
<blockquote><p>
      &#8220;I have thought for years that say 10 small businesses could pool their resources and hire an IT security team or contract one for the group. They may not be able to afford a crack team (pun intended) alone but together could do it. Just my thoughts.&#8221;
    </p></blockquote>
</blockquote>
</blockquote>
<p>&#8220;tommy, he&#8217;s stumbling on one of my business models. ;)&#8221;</p>
<p>And on one of mine, proving once again  that GMTA. You&#8217;ll recall, I hope, that in discussing the Bank-Only Live CD idea, and the Bank-Only Secure VPN idea, I mentioned that the more banks adopted any given idea, the more cost-efficient it becomes, as third parties or inter-bank joint ventures could achieve economies of scale in production, maintenance, etc.<br />
Those particular ideas may have not survived the cut, but the idea of pooling to share expense surely did?</p>
<p>Anyway, I think your idea is superb &#8212; and even more important, feasible and economically doable. I&#8217;d strongly encourage you to pursue that further.</p>
<p>Speaking of economies, here&#8217;s a word to save you a few keystrokes:</p>
<p>&#8220;productized&#8221; &#8230; how about &#8220;produced&#8221;? 😀</p>
<p>Seriously, I think jargon-speak turns off customers, and I try to keep my presentations in plain English when dealing with customers who are not in my specialty, finance/economics. It isn&#8217;t always easy, and certainly very hard in IT &#8212; Stephen Hawking doesn&#8217;t have to sell his ideas to high-school dropouts or Liberal Arts majors. No charge for the consult, especially given all I&#8217;ve learned from your posts and messages. 🙂</p>
<p>More usage guides, &#8220;there, their, they&#8217;re&#8221; with super-mnemonics:<br />
<a href="http://www.amiright.com/parody/60s/thebyrds27.shtml" rel="nofollow ugc">http://www.amiright.com/parody/60s/thebyrds27.shtml</a></p>
<p>&#8220;Who/Whom&#8221;:<br />
<a href="http://www.amiright.com/parody/60s/thebeatles2006.shtml" rel="nofollow ugc">http://www.amiright.com/parody/60s/thebeatles2006.shtml</a></p>
<p>&#8220;Fewer/Less&#8221;:<br />
<a href="http://www.amiright.com/parody/60s/thebeatles2007.shtml" rel="nofollow ugc">http://www.amiright.com/parody/60s/thebeatles2007.shtml</a></p>
<p>Puctuation:<br />
<a href="http://www.amiright.com/parody/60s/thebeatles1719.shtml" rel="nofollow ugc">http://www.amiright.com/parody/60s/thebeatles1719.shtml</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163492">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163492">
						July 7, 2011 3:55 AM					</a>

				</p>

				<p>@ tommy,</p>
<p>&#8220;I try to keep my presentations in plain English when dealing with customers who are not in my specialty, finance/economics.&#8221;</p>
<p>Yup a wise thing to do, however there is also the issue over being overly formal in the presentation.<br />
Legislators are realy bad offenders then standards bodies and those writing specifications. Sometimes you have to &#8220;legalize&#8221; it as well as crossing the T&#8217;s and dotting the I&#8217;s, and that almost always makes for a dull read if not eye and mind straining to the point of migrain.</p>
<p>With regard the Finance / Economics do you drop in on the Financial Cryptography blog?</p>
<p>@ Nick P &amp; RSH,</p>
<p>No system is perfect not just by definition but the laws of physics as well.</p>
<p>However with (nearly) determanistic systems there are two basic methods of finding attack vectors on an unknown (ie blackbox) system. These are the old &#8220;brut force&#8221; and &#8220;random&#8221; methods.</p>
<p>As normal we give them fancy names as befiting our field of endevor, however the best results are usually had with a mixture of both as in directed fuzzing. This can be further improved by having some knowledge of the system in advance of testing to better direct the attack.</p>
<p>But there is a time issue to consider, at a low level a &#8220;stateless black box&#8221; is assumed to consist of a number of inputs and a number of outputs, the problem is determaning the likley internal circuit by observing the outputs from actions at the inputs. To do this on a system without internal state means cycling through all the input states of each and every input whilst determaning the state of each and every output.</p>
<p>With a logic system where all inputs and outputs have a binary state you can show that the number of possible logical circuits for each output is 2^(2^n) that is 4 inputs gives 2^16= 64K potential logic circuits per output (although half the number are inverses of each other and likewise half of those are the sequence in reverse, have a look at Walsh functions to see how to analyse for the minimal circuit)</p>
<p>Thus it can be seen that you cann&#8217;t realy know what is in the black box just an aproximation based on deduction.</p>
<p>When you then add state into the blackbox problems realy arise. Firstly because you have to work out which circuits have state in them and which circuits contain the control functions of the &#8220;latch&#8221;. Even with very few inputs realisticaly there is not enough time within the expected life of the product to do a brut force test.</p>
<p>When you then move to a black box not just with state but feedback around the state etc the time scales start aproaching that of the life times of stars. but also you will be constrained long before that by the lack of state in the system you are using to analyse the black box.</p>
<p>Thus it can be seen it is not possible to black box test something like an 8bit CPU core in the lifetime of a product.</p>
<p>As engineers we resolve this issue by breaking the internal circuit into logical blocks that we can test and testing those and assume that if each small block has passed then the whole system has passed.</p>
<p>However there are a couple of problems. Firstly I said &#8220;(nearly) determanistic system&#8221; even though we call them &#8220;logic circuits&#8221; they are not they are analog circuits designed to behave like an aproximation to a logic circuit. You can see this in the design of some oscilator circuits where a &#8220;logic inverter&#8221; is actually used as an amplifier with the crystal or RC circuit used as the feedback element to define the operating frequency. You will also see in old circuit designs Hex Inverters in CMOS (40 series) logic packages used as not just as analog amplifiers (with about a gain of ten) but also as other analog functions such as frequency translators (mixers). Motorola in one of their engineering notes on their MC40XX range showed how to do a number of analog functions. Even 74HSxx TTL packages could be used to make not just oscilators but FM modulators as well, which alowed a 74HS13 30Mhz Xtal and an electret microphone to make a nice little FM band (third harmonic) bug.</p>
<p>These &#8220;unexpected analog&#8221; functions apply to all logic circuits and cause non determanistic behaviour (very) occasionaly. Which at the chip level gives rise to the question of if the &#8220;analog behaviour&#8221; can be exploited in chip etc. It is a discussion I&#8221;m having with @ RobertT, over on another thread, and the answer appears to be yes. That is you can design a logic circuit that passess all the &#8220;logic&#8221; testing but has hidden &#8220;analog&#8221; function that can then be exploited in some way.</p>
<p>Thus the bottom line is you cannot trust the chips in the system</p>
<p>The second issue is that of Systems On a Chip (SOC) as seen in the likes of mobile phones. These are so integrated and made up of so many logic macros that lie on top of each other that realisticaly it is not possible to know anylonger where some macros are used and have been absorbed into larger macros and thus into complex fuctions. That is even the designers of SOC&#8217;s don&#8217;t know what is happening at gate level they pick high level functions out of libraries, most of which have never been looked at for anything other than &#8220;wanted functionality&#8221;.</p>
<p>That is we have know way of knowing if even the logic design is secure, let alone if there are extra anaolog side channels there.</p>
<p>The bottom line is the chips cannot be trusted.</p>
<p>And this gives rise to the question of how to design a system that can be verifiably secure even if it does use chips that have been &#8220;backdoored&#8221; either accidentaly or by design.</p>
<p>And the second question of what we mean by &#8220;verifiably secure&#8221;&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163493">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163493">
						July 7, 2011 9:35 AM					</a>

				</p>

				<p>@NickP, Clive.<br />
It&#8217;s reasuring that I&#8217;m not an idiot, thanks,<br />
I am project manager in the security industry (think more like constr rather then pen testing).<br />
I have to bring in and talk to a lot of different people from the construction worker to suits and IT. It is not boring I can assure you.</p>
<p>My dream is to get my CISSP and GSE. Not career-wise but because I enjoy it. It probably would help with opening up some horizons, but the knowledge not even the cert is important to me.<br />
Thanks</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163494">

			<div class="comment by-pete-dumas ">

				<p class="commentcredit">

					<span class="commenter">Pete Dumas</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163494">
						July 7, 2011 9:53 AM					</a>

				</p>

				<p>As far as the eralier mentioned DHCP server that apears to be their preferred method of route hijacking, I can tell you based on my own analysis that they appear to be using zeroconf and mDNS to achieve their results.</p>
<p>Multicast and Anycast is playing a big part in all of this and traffic analysis should be focused on these protocols.</p>
<p>Capturing interprocess communications will reveal this. On an infected machine, the &#8220;undernet&#8217; network that they are running can be made visible on a windows machine by viewing particular process strings of an infected service (meaning you can actually see their real-time communications).</p>
<p>The rootkit is without a doubt placed in a LOCKed state and is only removed via a new hard drive&#8230;low level formatting (HDDErase) does not work. My experience with assembly is very limited, so it was cheaper in time to simply get a new hard drive and build from scratch. Hope this might help any &#8220;experts&#8221; that are reading this.</p>
<p>Also, I noticed that high-priority targets (i.e. Engineers &amp; SysOps) have a kill switch which renders the drive inoperable after activation. This kill switch was seen on my machine by very quickly pressing the num-locks, cap-locks, and scroll locks immediately at system startup during the POST sequences.</p>
<p>I am also really worried about the ease that BIOS is able to be flashed. Making ROM just that again will go a long way in protection from these sophisticated attacks. The average home user doesn&#8217;t need this functionality and even experienced technicians continuously update their BIOS. If you think that the state-sponsered black hats aren&#8217;t proficient enough to alter BIOS, your just kidding yourself.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163495">

			<div class="comment by-pete-dumas ">

				<p class="commentcredit">

					<span class="commenter">Pete Dumas</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163495">
						July 7, 2011 9:57 AM					</a>

				</p>

				<p>I apologize about all the typos in my previous post. I also meant to say that even experienced technicians rarely keep their BIOS continuously updated.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163496">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163496">
						July 7, 2011 11:09 AM					</a>

				</p>

				<p>@ Jacob,</p>
<p>&#8220;&#8230; but the knowledge not even the cert is important to me.&#8221;</p>
<p>A word of caution from a jaded old xxxx (I &#8216;ll let Nick P fill in the appropriate word 😉</p>
<p>The more you learn, the more you will find you have to learn&#8230;</p>
<p>And learn the fundementals not the &#8220;latest tools and methods&#8221;, fundementals will always work for you the other toys tend to come and go like mayflys.</p>
<p>Oh and although the tech world appears to change overnight, at the end of the day the people that pay the bills, businesses will always want to talk to each other, so err on the side of Comms for longevity in your career.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163497">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163497">
						July 7, 2011 11:44 AM					</a>

				</p>

				<p>Oh absolutely. More than 1/2 my time is spent on communication. Learning is the challenge and the fun part.</p>
<p>You and I are old enough to remember 8088 processors.<br />
I just recently upgraded an old system that customer was still using and didn&#8217;t want to upgrade. It was isolated so alright, but I didn&#8217;t like it. It recently crashed hard and we finally were able to upgrade it. It was a windows3 sytem. How many commands do you remember? Look at who I&#8217;m talking to? you probably do and have a system tucked away somewhere. 😉</p>
<p>On another note: comms of another kind are big now. Now people are talking about SCADA and &#8220;cloud&#8221; computing. Or I think data servers is better than a fad moniker. The risks and loss of data is the growing pains of putting these things on exterior access.</p>
<p>The SCADA are practically bulletproof. I have seen PLCs that were churning 20yrs later. The problem came when people began to put them on networks or access from outside world. Some apps required one heck of a throw and thumb size voltage/amps wouldn&#8217;t work. Now software can do more, but still. The software was never expected to be exposed to outside influence.</p>
<p>The law of unintended consequences&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163498">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163498">
						July 7, 2011 1:42 PM					</a>

				</p>

				<p>@ tommy</p>
<p>&#8220;Those particular ideas may have not survived the cut, but the idea of pooling to share expense surely did? Anyway, I think your idea is superb &#8212; and even more important, feasible and economically doable. I&#8217;d strongly encourage you to pursue that further. &#8221;</p>
<p>I&#8217;ve noticed that when enough people start independently coming up with the same solution to a hard problem it&#8217;s usually worth a deeper look. I appreciate your feedback. Yes, this was similar to one of the business models I came up with for high assurance. I&#8217;ll elaborate further in email.</p>
<p>&#8221; &#8216;productized&#8217;&#8230; how bout &#8216;produced&#8217;?&#8221;<br />
&#8220;Seriously, I think jargon-speak turns off customers, and I try to keep my presentations in plain English when dealing with customers who are not in my specialty&#8221;</p>
<p>Yes, I figured that out the hard way a while back. You think IT is hard to communicate to lay people? Try high assurance methodologies, security engineering or covert channels. Hard to break down into lay terms, so esoteric. I&#8217;ve found visually illustrating things with simple diagrams, especially animated, helps.</p>
<p>&#8220;No charge for the consult, especially given all I&#8217;ve learned from your posts and messages. :)&#8221;</p>
<p>Likewise, although I think my balance sheet wouldn&#8217;t be in the red if we were both charging for posts. I&#8217;d pull a Kurt Russel and charge by the word, but with others actually getting value in return. Clive would probably manage to get a disproportionate share of the wealth, although I get a cut of it for transating his posts to English. (Which is even funnier considering he&#8217;s in the country that invented modern English&#8230;)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163499">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163499">
						July 7, 2011 2:06 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>&#8220;And this gives rise to the question of how to design a system that can be verifiably secure even if it does use chips that have been &#8220;backdoored&#8221; either accidentaly or by design. And the second question of what we mean by &#8220;verifiably secure&#8221;&#8230;&#8221;</p>
<p>Indeed. In our previous discussions, I told you I stop at the VHDL and Netlist level. Maybe the semiconductor design houses can secure other layers, but most researching hardware security don&#8217;t have the resources to prove it that far down. It&#8217;s another reason why I focus on software secure against remote attackers and hardware secure against people who aren&#8217;t running electrical engineering labs. It&#8217;s about the best I can do while still keeping costs down.</p>
<p>Even with the macro issue, I&#8217;ve found that high assurance software on high quality hardware seems to work out fine in practice. The PowerPC&#8217;s Integrity-178B were certified on aren&#8217;t high assurance, but the final product was considered to be if no hardware failure occurred. It worked out that way in practice. Same with SNS &amp; GEMSOS, which used x86 with customized firmware. So, it seems we can get away with using non-perfect hardware so long as it doesn&#8217;t introduce any problems the software can see &amp; it&#8217;s regularly tested to ensure it operates within its specs.</p>
<p>This is not to say high assurance hardware doesn&#8217;t exist. It does. AAMP7G has formally verified isolation and microcode. VAMP is formally verified to an extent with MIPS-like instructions (DLX, specifically). But they stop at VHDL, Netlist, etc. I&#8217;m not a hardware guy, but I understand that those are compiled further into more primitive stuff that goes on an ASIC, correct? So, the best approaches currently can only go so far down. But, so long as the stuff further down works ok, this is good enough for most applications. Now, designing hardware free of side channels is another issue entirely &amp; needs full bottom-to-top analysis.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163500">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163500">
						July 7, 2011 6:44 PM					</a>

				</p>

				<p>@NickP<br />
Just to see if I understand. You are saying that VHDL and Netlist, etc. are good enough? Back in the day you could always check gates etc and be reasonably sure you had checked throughly. Now with the complexity of the chips you have to take it to fab in order to have any hope of &#8220;absolutely&#8221; checking them out. Just too many &#8220;transistors&#8221;.</p>
<p>I thought about this back when lenovo was bought out and people were flipping out on procurement, etc. What if the Chinese did something? My thought was that could be a two edged sword for them. Then they started talking about in-house o/s. I tend to think that the two edged sword threat would tend to keep players honest from a blatant attempt like cooking the chips (pun intended). It would be possible to turn that right around and compromise the attackers.</p>
<p>Does the NSA and CIA have backdoors, zero day exploits, or side channels? Yep, I&#8217;d bet on it. It&#8217;s a game for the big boys. I would quote bruce willis in Armageddon, &#8220;Don&#8217;t you got people just thinking up s***?&#8221; I hope so. But then again, maybe the answer is no and some digital asteroid is just waiting and a smoldering silicon crater is in our future.</p>
<p>The arrest headlines are just low hanging fruit. There are gifted people out there that will never show up for most analysis. They are in and out without anyone knowing or able to track. I hope that govts thought carefully before unleashing sux* on infrastructure. That was a rather interesting work of art. It could have gone undetected. And probably more is already worked up for future use.</p>
<p>I pay attention to news/papers/etc. esp. for timing. I don&#8217;t think it was coincidence that one week it was discussed about Chinese sponsored hacking and then 2 wks later about how vulnerable Chinese infrastructure was to hacking. Warning shot?</p>
<p>People have a tendency to read stories or white papers, etc. and not look at bigger picture to get a sense of what agendas may be in play.</p>
<p>For example, I am paying very close attention to TSA stories and Chinese economy and military stories. The sheer volume of discussion about chinese economy should hint that something&#8217;s afoot there and sides are jockeying for position. Same with using GPUs for computing power.</p>
<p>In the context of security. Cloud computing and how do you secure it is either hot, or beat to a pulp trying to monetize it depending on how you look at it. 😉 Sorry so long. I tried to keep it on security with limited success.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163501">

			<div class="comment by-tommy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.amiright.com/parody/misc/williamshakespearehamletlordpolonius0.shtml' rel='external nofollow ugc' class='url'>tommy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163501">
						July 7, 2011 7:11 PM					</a>

				</p>

				<p>@ Clive Robinson:</p>
<blockquote>
<blockquote>
<blockquote><p>
      &#8220;I try to keep my presentations in plain English when dealing with customers who are not in my specialty, finance/economics.&#8221;
    </p></blockquote>
</blockquote>
</blockquote>
<p>&#8220;Yup a wise thing to do, however there is also the issue over being overly formal in the presentation.<br />
Legislators are realy bad offenders then standards bodies and those writing specifications. Sometimes you have to &#8220;legalize&#8221; it as well as crossing the T&#8217;s and dotting the I&#8217;s, and that almost always makes for a dull read if not eye and mind straining to the point of migrain.&#8221;</p>
<p>Sorry I wasn&#8217;t more clear. I was referring to the verbal presentation, whereas the actual documents, contracts, etc. will of course dot the i&#8217;s, cross the t&#8217;s, and are full of legal boilerplate. But I think I do a fair job of explaining all of that in a way that a non-lawyer, non-financier can understand. And yes, I&#8217;ve gotten many headaches proofreading my own work, my partner&#8217;s, or that prepared by third parties. ;D</p>
<p>&#8220;With regard the Finance / Economics do you drop in on the Financial Cryptography blog?&#8221;</p>
<p>Wasn&#8217;t aware of it, but the security of data in this field is atrocious. Others will send the potential customer&#8217;s name, DOB, Social Security number, etc. via regular e-mail. I prefer them to fax it, since the concept of encryption is foreign to them. (Yes, finance people are as tunnel-visioned as everyone else.) If I have to discuss it with my trusted associate other than in person, then either land-line (not cell or smartphone), or PGP mail.</p>
<p>@ Nick P.:</p>
<p>&#8220;One picture is worth a thousand words&#8221; &#8212; probably even more so in IT and, as you said, esp. in HA, though not so much in finance, where one spreadsheet is worth a thousand words. Someone sent me a proposal with tons of 3-D bar graph projections, etc. It was junk. Usually, the more distracting graphics in such things, the less substance. Only the hard numbers count.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163502">

			<div class="comment by-tommy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.amiright.com/parody/misc/jimmiejonesjamestaylor0.shtml' rel='external nofollow ugc' class='url'>tommy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163502">
						July 7, 2011 7:16 PM					</a>

				</p>

				<p>@ jacob:</p>
<p>The first time I heard of the concept of cloud computing, I thought, &#8220;That sux.&#8221; Hard enough to keep my own apps and data secure. Darned if I&#8217;ll hand it over to someone I don&#8217;t know, and about whose procedures and security I cannot possibly know, despite their reassurances. When it comes to storing or processing data, I&#8217;m like Dorothy in &#8220;The Wizard Of Oz&#8221;: &#8220;There&#8217;s no place like home&#8221;.</p>
<p>IMHO. YMMV.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163503">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163503">
						July 7, 2011 8:03 PM					</a>

				</p>

				<p>@tommy It&#8217;s worse than that. Given current events  they want to charge you money to store it insecurely.  And those assurances you speak of? On what basis can we trust them? Many major players have been hit including RSAsecureID. And their entire business model is security. Citibank? Lockheed, it just goes on and on.</p>
<p>Cloud computing on Google. Doing it for free? Why? Trust them with information? ug. I think I threw up in my mouth a little. LOL</p>
<p>It&#8217;s a hackers holiday with hits on Sony and many others. I thought the hits on Sony were a little funny at first. I hate their policies and actions for the last 10 years with a purple passion. But, it&#8217;s gotten to be a movie punchline. Standing over the lifeless body, kick em and then say &#8220;he moved&#8221;.  \m/</p>
<p>Also, contrary to the fad tag, it&#8217;s remote access data servers&#8230;not cloud computing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163504">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163504">
						July 7, 2011 10:17 PM					</a>

				</p>

				<p>@ tommy</p>
<p>Yeah, you should definitely check on the Financial Cryptography blog. You&#8217;ll benefit from it more than most of us.</p>
<p>Financial Cryptography blog<br />
<a href="https://financialcryptography.com/" rel="nofollow ugc">https://financialcryptography.com/</a><br />
(Note: You will probably get an SSL issue. It&#8217;s not an attack&#8230; unless you matter to <em>them</em> than most visitors 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163505">

			<div class="comment by-tommy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.amiright.com/parody/60s/hermanshermits173.shtml' rel='external nofollow ugc' class='url'>tommy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163505">
						July 7, 2011 11:35 PM					</a>

				</p>

				<p>@ jacob:</p>
<p>Agree.</p>
<p>@ Nick P.:</p>
<p>CACert was indeed new to me. I see that they&#8217;re trying to meet the standards to have their authority included in Mozilla browsers. I didn&#8217;t need the SSL for just browsing the articles, though.</p>
<p>I could have told anyone what was wrong with bitcoins &#8211; it&#8217;s the same as what&#8217;s wrong with any fiat currency (artificial). Esp. since &#8220;The currency’s architecture is designed to inflate its value over time.&#8221; You don&#8217;t design currencies to do this or that. The market does that for us all, the market being the sum of us all.</p>
<p>Someone wants a new global currency? Go back to the old global currency, the one that was used for the past 5000 years, and with good reason: gold. Most econ troubles start when currencies are disconnected from actual value (gold or silver).</p>
<p>You&#8217;ve already seen this, but for anyone else interested, here is my thesis-disguised-as-song-parody, explaining the economic history of the US; why the current mess, both within the US and globally; why gold&#8217;s abandonment caused it; and only a return to a gold standard can save it. (may Don McLean forgive me, but it&#8217;s &#8220;Fair Use&#8221;):</p>
<p>&#8220;American Pie&#8221; by Don McLean =<br />
&#8220;American Pie Shrinks As More Slices Handed Out&#8221; by Fiddlegirl and Tommy Turtle</p>
<p><a href="http://www.amiright.com/parody/70s/donmclean152.shtml" rel="nofollow ugc">http://www.amiright.com/parody/70s/donmclean152.shtml</a></p>
<p>Thanks for the link, Clive and Nick. Will keep an eye on that site, but much is stuff I already know, and apparently, they&#8217;re just learning &#8211; or don&#8217;t know yet.</p>
<p>One sage did compare it to my fave example of the &#8220;last-fool&#8221; philosophy, namely, the bubble in Dutch tulip bulbs. But no one learns, regardless of whether the tulip bulbs become railroad stocks or  Microwave Communications Inc. (MCI) or dot.com stocks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163506">

			<div class="comment by-jj ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://team1@surrogat.us' rel='external nofollow ugc' class='url'>JJ</a></span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163506">
						July 8, 2011 9:55 AM					</a>

				</p>

				<p>a question&#8230;</p>
<p>If the PCs, smartphones, or their operating systems were actually secure in the sense that has been discussed here&#8230;how much would that affect the ability of The Government to access them?</p>
<p>(Besides the access of companies such as Apple-Google?)</p>
<p>Wouldn&#8217;t it be a potential &#8220;problem&#8221; to make them really secure?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163507">

			<div class="comment by-pete-dumas ">

				<p class="commentcredit">

					<span class="commenter">Pete Dumas</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163507">
						July 8, 2011 12:42 PM					</a>

				</p>

				<p>Mr. Schneier would probably agree that &#8220;security through obscurity&#8221; is a proven model of Trust that does not work (I am making an assumption here, which truly makes me a dum-ass&#8230;go ahead and laugh, you know you want to). But, the fact is that this is an antiquated model that somehow continues to apparently remain a viable metric of &#8220;risk management&#8221;.</p>
<p>On one hand, you have Law Enforcement who could quite possibly have the purest and best intentions at heart in safeguarding it&#8217;s citizens from people who seek to harm the most defenseless of our ranks (the children) and then in the other hand, through military grade backdoors implemented at the firmware level (ACPI I&#8217;m looking at you) you now have a separate collection of society that can covertly access any internet connected machine at will, which in essence has the potential to facilitate the same crime (although abuse of power is such a rarity these days, wouldn&#8217;t you agree Strauss-Kahn?). This just brings us back to the original issue that &#8220;security through obscurity&#8221; is inherently flawed. We already know this.</p>
<p>As the engineer of an Autonomous System, I can no longer discern the good guys from the bad guys. They are both guilty of the same crime which is the unauthorized access of a private individuals personal computer, which gives them access to family photos, work related projects, individual likes and dislikes unique to each and every one of us, and financial information. The absolute ease of this is trivial (which provides you with your low hanging fruit). Do you really want strangers viewing your family&#8217;s photos?</p>
<p>I strongly urge individuals to change their perception of the Internet and use extreme caution and discretion before writing any personal or private documents or data on a machine connected to the Internet. The fact that you are surrounded by a relatively comfortable setting (i.e your home) has no bearing on your privacy or safety. This applies exponentially for children and teenagers. Think of the contents of any Internet connected device as being relative to putting everything you currently have stored on that device up on a publically accessible facebook account.</p>
<p>I really apologize about the &#8220;fear mongering&#8221;. I hate people like that too. I&#8217;m not saying this is the end of the world as we know it, I just think that it would be a good idea to make a habit of keeping personal and family oriented material on a separate machine that is intentionally kept as a form of replacement for the old &#8220;home filing cabinet&#8221; or &#8220;photo album&#8221; and ensure that that machine is never connected either wirelessly or wired to &#8220;the internet&#8221;. This advice not only applies to individuals, but is also helpful to SMB&#8217;s and Enterprises alike. You cant steal something that is physically rather than &#8220;logically&#8221; (hint of sarcasm) inaccessible.</p>
<p>I am giving my full name because I am not, nor have I ever been Anonymous. While I am able to see the logic behind the anti-sec movement, I have always been what they call a &#8220;selectiva&#8221;. In other words, it&#8217;s my job to attempt to deflect as much of this garbage as I legally can to keep it from reaching my end-users, so these guys are a thorn in my side too. My ongoing war with them is comical because of the giant headstart that they had on me as well as the overwhelming odds and technical superiority that they display&#8230;talk about trials by fire.</p>
<p>Pete Dumas</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163508">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163508">
						July 8, 2011 1:14 PM					</a>

				</p>

				<p>@JJ It is a two edged sword.<br />
1. If secured the big agencies could still get in with patches, updates, search warrants for records. Even keyloggers. Years ago I asked FBI about how prevalent cracking encryption, etc. was. He said never have to bother.<br />
2. I am more concerned/irritated with the data mining of habits or info with the goal of selling information. I don&#8217;t want suggestions on what I might be interested in.<br />
3. Another concern 4th amendment. One justice summed it up as the right &#8220;to be left alone&#8221;. I rather like that sentiment.<br />
4. For most people, the basic rules apply.</p>
<p>@pete You need to loosen that tin foil hat  I do and have put isolated systems in place for just the reasons you state. BUT anytime to go online you leave fingerprints. Anytime you move those pictures from one computer to another or email them you are doing the same thing. Precautions need to be taken absolutely. But your aunt sue might scan an old picture of you and put it up on facebook. Guess what? It&#8217;s now in the wild. Not very many people are that interested in your pictures or mine for that matter. Fewer still are willing or able to go off the grid.</p>
<p>Hackers want your cc info to buy stuff and companies want to sell you stuff. That and business data is probably 90% of anything applicable to us. Unless someone is involved in a criminal enterprise, of course.</p>
<p>I&#8217;m teasing you a little but deep breathe and enjoy a cup of tea. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163509">

			<div class="comment by-pete ">

				<p class="commentcredit">

					<span class="commenter">pete</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163509">
						July 8, 2011 2:19 PM					</a>

				</p>

				<p>@jacob</p>
<p>🙂</p>
<p>I made no illusions that it was anything more than intentional &#8220;fear mongering&#8221;. It&#8217;s just that perception can be very easily misconceptualized in the digital world. I get nervous when we begin baseing our character judgement for a given individual solely on a consumer based data model or other form of automated analytics&#8230;.whether that be BI or criminal profiling. Thank you for taking the time to weigh in on my comment!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163510">

			<div class="comment by-andy ">

				<p class="commentcredit">

					<span class="commenter">Andy</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163510">
						July 8, 2011 8:25 PM					</a>

				</p>

				<p>@JJ, &#8220;If the PCs, smartphones, or their operating systems were actually secure in the sense that has been discussed here&#8230;how much would that affect the ability of The Government to access them?</p>
<p>(Besides the access of companies such as Apple-Google?)</p>
<p>Wouldn&#8217;t it be a potential &#8220;problem&#8221; to make them really secure?&#8221;</p>
<p>Do they need access to the device, A computer that isn&#8217;t pluged into the internet would have minimal ways to effect the world.<br />
If it is pluged into the internet any thing that goes over the wire promisc sniffer(no routing or what not) can be read in plain text(send to backend number cruncher).<br />
In thoery I wouldn&#8217;t mind whats on my computer as long as its not sent on the internet</p>
<p>How good are the program that goverment want to put onto your computer&#8230;.if pariond one dropped screen frame the black helicopters are after you and from the start of the invesercation they are wereing a bell.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-163511">

			<div class="comment by-andy ">

				<p class="commentcredit">

					<span class="commenter">Andy</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163511">
						July 8, 2011 10:37 PM					</a>

				</p>

				<p>I&#8217;m pretty damn sure it would only take one second to do it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-163512">

			<div class="comment by-lahjah ">

				<p class="commentcredit">

					<span class="commenter">Lahjah</span> •

					<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/#comment-163512">
						July 11, 2011 8:06 AM					</a>

				</p>

				<p>For some time, I used Safeboot (forwarded by McAfee Endpoint and now, Intel-McAfee Endpoint) , that was a criptography tool capable to encrypt the whole disk. This softw change the boot loader by one from itself. When booted, first of all, is loaded a decrypotgraphy module, in a way to read the disk and continue the windows ordinary boot. Question: it is a proactive solution against these kind of virus to use it ?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2011/07/tdss_rootkit.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2011/07/tdss_rootkit.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2011%2F07%2Ftdss_rootkit.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2011/07/tdss_rootkit.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='3935' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2011/07/menwith_hill.html" rel="prev">← Menwith Hill</a>		<a href="https://www.schneier.com/blog/archives/2011/07/giant_squid_as.html" rel="next">Friday Squid Blogging: Giant Squid as an Emblem for Ocean Conservation →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
