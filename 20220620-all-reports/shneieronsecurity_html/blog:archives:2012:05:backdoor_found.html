<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Backdoor Found (Maybe) in Chinese-Made Military Silicon Chips - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Backdoor Found (Maybe) in Chinese-Made Military Silicon Chips Comments Feed" href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/4367" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=4367' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F05%2Fbackdoor_found.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F05%2Fbackdoor_found.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-4367 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-4367" class="post-4367 post type-post status-publish format-standard hentry category-uncategorized tag-academic-papers tag-backdoors tag-china tag-cyberwar tag-espionage tag-hardware tag-military tag-nuclear-power">

	<div class="article">

		<h2 class="entry">Backdoor Found (Maybe) in Chinese-Made Military Silicon Chips</h2>
		<p>We all knew this was possible, but researchers have <a href="https://www.cl.cam.ac.uk/~sps32/sec_news.html#Assurance">found the exploit in the wild</a>:</p>
<blockquote><p>Claims were made by the intelligence agencies around the world, from MI5, NSA and IARPA, that silicon chips could be infected. We developed breakthrough silicon chip scanning technology to investigate these claims. We chose an American military chip that is highly secure with sophisticated encryption standard, manufactured in China. Our aim was to perform advanced code breaking and to see if there were any unexpected features on the chip. We scanned the silicon chip in an affordable time and found a previously unknown backdoor inserted by the manufacturer. This backdoor has a key, which we were able to extract. If you use this key you can disable the chip or reprogram it at will, even if locked by the user with their own key. This particular chip is prevalent in many systems from weapons, nuclear power plants to public transport. In other words, this backdoor access could be turned into an advanced Stuxnet weapon to attack potentially millions of systems. The scale and range of possible attacks has huge implications for National Security and public infrastructure.</p></blockquote>
<p><a href="https://www.cl.cam.ac.uk/~sps32/Silicon_scan_draft.pdf">Here&#8217;s</a> the draft paper:</p>
<blockquote><p><b>Abstract</b>. This paper is a short summary of the first real world detection of a backdoor in a military grade FPGA. Using an innovative patented technique we were able to detect and analyse in the first documented case of its kind, a backdoor inserted into the Actel/Microsemi ProASIC3 chips. The backdoor was found to exist on the silicon itself, it was not present in any firmware loaded onto the chip. Using Pipeline Emission Analysis (PEA), a technique pioneered by our sponsor, we were able to extract the secret key to activate the backdoor. This way an attacker can disable all the security on the chip, reprogram crypto and access keys, modify low-level silicon features, access unencrypted configuration bitstream or permanently damage the device. Clearly this means the device is wide open to intellectual property theft, fraud, re-programming as well as reverse engineering of the design which allows the introduction of a new backdoor or Trojan. Most concerning, it is not possible to patch the backdoor in chips already deployed, meaning those using this family of chips have to accept the fact it can be easily compromised or it will have to be physically replaced after a redesign of the silicon itself.</p></blockquote>
<p>The chip in question was designed in the U.S. by a U.S. company, but manufactured in China.  <a href="http://www.theregister.co.uk/2012/05/29/silicon_backdoor/">News</a> <a href="http://www.information-age.com/channels/security-and-continuity/news/2105468/security-backdoor-found-in-chinamade-us-military-chip.thtml">stories</a>. <a href="http://it.slashdot.org/story/12/05/28/1454222/backdoor-found-in-china-made-us-military-chip?utm_source=feedburner&#038;utm_medium=feed&#038;utm_campaign=Feed%3A+Slashdot%2Fslashdot+%28Slashdot%29">Comment</a> <a href="http://boingboing.net/2012/05/28/security-researcher-i-found-s.html">threads</a>.</p>
<p>One researcher <a href="http://erratasec.blogspot.co.uk/2012/05/bogus-story-no-chinese-backdoor-in.html">maintains</a> that this is not malicious:</p>
<blockquote><p>Backdoors are a common problem in software. About 20% of home routers have a backdoor in them, and 50% of industrial control computers have a backdoor. The cause of these backdoors isn&#8217;t malicious, but a byproduct of software complexity. Systems need to be debugged before being shipped to customers. Therefore, the software contains debuggers. Often, programmers forget to disable the debugger backdoors before shipping. This problem is notoriously bad for all embedded operating systems (VxWorks, QNX, WinCE, etc.).</p>
<p>[&#8230;]</p>
<p>It could just be part of the original JTAG building-block. Actel didn&#8217;t design their own, but instead purchased the JTAG design and placed it on their chips. They are not aware of precisely all the functionality in that JTAG block, or how it might interact with the rest of the system.</p>
<p>But I&#8217;m betting that Microsemi/Actel know about the functionality, but thought of it as a debug feature, rather than a backdoor.</p>
<p>It&#8217;s remotely possible that the Chinese manufacturer added the functionality, but highly improbable. It&#8217;s prohibitively difficult to change a chip design to add functionality of this complexity. On the other hand, it&#8217;s easy for a manufacturer to flip bits. Consider that the functionality is part of the design, but that Actel intended to disable it by flipping a bit turning it off. A manufacturer could easily flip a bit and turn it back on again. In other words, it&#8217;s extraordinarily difficult to add complex new functionality, but they may get lucky and be able to make small tweaks to accomplish their goals.</p></blockquote>
<p>EDITED TO ADD (5/29): <a href="http://s.computerworlduk.com/unscrewing-security/2012/05/chinese-cyberwarriors-in-your-chips/index.htm">Two</a> <a href="http://www.theregister.co.uk/2012/05/29/researcher_trolls_internet_with_silicon_backdoor/">more</a> articles.</p>
<p>EDITED TO ADD (6/8):  <a href="http://www.csoonline.com/article/707542/china-not-to-blame-for-backdoor-in-us-military-chip">Three</a> <a href="http://www.zdnet.com.au/microsemi-denies-it-put-a-backdoor-in-chips-339338961.htm">more</a> <a href="http://erratasec.blogspot.co.uk/2012/05/bogus-story-no-chinese-backdoor-in.html">articles</a>.</p>
<p>EDITED TO ADD (6/10):  A <a href="http://www.microsemi.com/documents/corporate/Microsemi%20Response%20Security%20Claims%20With%20Respect%20to%20ProASIC3%20053112.pdf">response</a> from the chip manufacturer.</p>
<blockquote><p>The researchers assertion is that with the discovery of a security key, a hacker can gain access to a privileged internal test facility typically reserved for initial factory testing and failure analysis.  Microsemi verifies that the internal test facility is disabled for all shipped devices.  The internal test mode can only be entered in a customer-programmed device when the customer supplies their passcode, thus preventing unauthorized access by Microsemi or anyone else.  In addition, Microsemi&#8217;s customers who are concerned about the possibility of a hacker using DPA have the ability to program their FPGAs with its highest level of security settings.  This security setting will disable the use of any type of passcode to gain access to all device configuration, including the internal test facility.</p></blockquote>
<p>A <a href="http://www.cl.cam.ac.uk/~sps32/microsemi_re.pdf">response</a> from the researchers.</p>
<blockquote><p>In order to gain access to the backdoor and other features a special key is required. This key has very robust DPA protection, in fact, one of the best silicon-level protections we have ever encountered. With our breakthrough PEA technique we extracted the key in one day and we found that the key is the same in all ProASIC3, Igloo, Fusion and SmartFusion FPGAs. Customers have an option to program their chosen passcode to increase the security; however, Actel/Microsemi does not tell its customers that a special fuse must be programmed in order to get the backdoor protected with both the passcode and backdoor keys. At the same time, the passcode key can be extracted with our PEA technique which is public and covered in our patent so everyone can independently verify our claims. That means that given physical access to the device an attacker can extract all the embedded IP within hours.</p>
<p>There is an option for the highest level of security settings – Permanent Lock. However, if the AES reprogramming option is left it still exposes the device to IP stealing. If not, the Permanent Lock itself is vulnerable to fault attacks and can be disabled opening up the path to the backdoor access as before, but without the need for any passcode.</p></blockquote>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/academic-papers/" rel="tag">academic papers</a>, <a href="https://www.schneier.com/tag/backdoors/" rel="tag">backdoors</a>, <a href="https://www.schneier.com/tag/china/" rel="tag">China</a>, <a href="https://www.schneier.com/tag/cyberwar/" rel="tag">cyberwar</a>, <a href="https://www.schneier.com/tag/espionage/" rel="tag">espionage</a>, <a href="https://www.schneier.com/tag/hardware/" rel="tag">hardware</a>, <a href="https://www.schneier.com/tag/military/" rel="tag">military</a>, <a href="https://www.schneier.com/tag/nuclear-power/" rel="tag">nuclear power</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html" rel="bookmark">Posted on May 29, 2012 at 2:07 PM</a>			•
			<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html#comments">67 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html" data-title="Backdoor Found (Maybe) in Chinese-Made Military Silicon Chips" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-180387">

			<div class="comment by-aaron-andrusko ">

				<p class="commentcredit">

					<span class="commenter">Aaron Andrusko</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180387">
						May 29, 2012 2:47 PM					</a>

				</p>

				<p>Amazing that this article will be the end of the public discussion too.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180388">

			<div class="comment by-jason ">

				<p class="commentcredit">

					<span class="commenter">Jason</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180388">
						May 29, 2012 2:48 PM					</a>

				</p>

				<p>Is there one master key that unlocks the backdoor?  So you would not require physical access to the device to discover it?  It sounds like it is separate from the user-generated key.</p>
<p>Actel reprogrammable devices typically program via JTAG, which means either that it is programmed once in the factory with a fixture, or else you need some other external logic or controller connected to the JTAG pins to be able to reprogram it.  In the fixture case, you&#8217;d need physical access to the device to compromise it.  In the second case, you&#8217;d need to be able to break into the system, replace the programming file, and force the system to initiate a programming cycle (JTAG player, if it is available.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180389">

			<div class="comment by-ken ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://caffeinesecurity.blogspot.com' rel='external nofollow ugc' class='url'>Ken</a></span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180389">
						May 29, 2012 3:14 PM					</a>

				</p>

				<p>How interesting that this comes just a month after I touched this subject on my blog&#8230;</p>
<p><a href="http://caffeinesecurity.blogspot.com/2012/04/what-if-your-hardware-was-infected-with.html" rel="nofollow ugc">What if your hardware was infected with a virus?</a></p>
<p>A few key points:</p>
<blockquote><p>
While the chances of this occurring are unlikely, it&#8217;s still a possibility.  Chances are that if a piece of hardware were modified that significantly, it would most likely be deliberate actions of a well funded organization, with malware rivaling that of Stuxnet or Duqu.  This organization would need to do a lot more than just infect a USB stick &#8211; the organization would need someone on the inside of the manufacturing process to implement any hardware based malware, and most likely would be government funded.  This malware would be well beyond the complexity of Stuxnet or Duqu, as it would be malware written at the physical hardware layer, incorporated into the equipment.</p>
<p>&#8230;</p>
<p>While the likelihood of this being detected at a manufacturer level is relatively high, thanks to quality control processes, if a hardware based piece of malware were missed by a manufacturer, or intentionally introduced by a manufacturer under direction of its government, once a piece of hardware leaves the factory, hardware based malware would be near impossible to detect until it was too late.</p>
<p>&#8230;</p>
<p>Ultimately, this raises the question of &#8220;how well do you trust your manufacturers?&#8221;  Are you having a local, trusted manufacturer you&#8217;ve dealt with for years build your equipment, or do you outsource your manufacturing to the cheapest supplier overseas who you&#8217;ve never even met face-to-face?</p>
<p>In a world where best practices such as configuration management and configuration standardization are becoming key, should a piece of hardware based malware be created, configuration standardization may ultimately be our own downfall.</p></blockquote>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180390">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180390">
						May 29, 2012 4:37 PM					</a>

				</p>

				<p>Fabs in America or very friendly countries. I repeat it again here. Add to it designs reviewed in full [by DOD/NSA] for stuff like backdoors. Then, we might be getting somewhere.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180391">

			<div class="comment by-greg-a ">

				<p class="commentcredit">

					<span class="commenter">Greg A</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180391">
						May 29, 2012 5:02 PM					</a>

				</p>

				<p>If, as sounds plausible, this debug feature is from the generic JTAG block, the obvious next question is how many other chips are also vulnerable to this exact same exploit? Presumably the key would be the same for ALL the chips&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180392">

			<div class="comment by-russ ">

				<p class="commentcredit">

					<span class="commenter">Russ</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180392">
						May 29, 2012 5:12 PM					</a>

				</p>

				<p>I am an FPGA designer, and I can tell you that while this backdoor is not surprising. Both because of the complexity that Graham (@ErrataRob) aka &#8220;researcher&#8221; points out, but also because the JTAG interface that is mentioned is such a low level interface, that touches almost everything in the chip.</p>
<p>I can&#8217;t speak authoritatively on this particular Actel family. However,most FPGAs do not use the JTAG interface in the field. Typically, this interface is brought to its own connector on the board, and is only used during initial development. In the field, it is usually not connected to anything at all, since the FPGA has alternate, faster methods and interfaces for loading its brains.  So, if the hardware (the board that the FPGA is installed on) is designed with security in mind, then a JTAG  security hole shouldn&#8217;t be an issue.</p>
<p>I can already hear some people saying that depending on the FPGA family, some of the JTAG pins are re-purposed for general IO, but can be force to their original JTAG purpose. But again this depends on the voltage levels of a few pins at power up. So, again with proper attention to detail, this risk can be significantly mitigated.</p>
<p>Of course, even if the JTAG pins are connected to other chips on the same board, such as microprocessors, just being able to twiddle these pins,  would require either a Herculean brute force effort, or access/knowledge of the board level design. Given that an attacker is targeting a product where the FPGA in question is a known component, maybe that isn&#8217;t much of a leap in imagination. But it doesn&#8217;t really keep me awake at night. At this point I think social engineering of the people controlling the products is a much easier target.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180393">

			<div class="comment by-dragonfrog ">

				<p class="commentcredit">

					<span class="commenter">dragonfrog</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180393">
						May 29, 2012 5:15 PM					</a>

				</p>

				<p>@Jason</p>
<p>You&#8217;d still need either physical access to the chip, or remote access to a computer connected by JTAG to the chip, to take advantage of this backdoor.</p>
<p>That doesn&#8217;t invalidate the seriousness of the vulnerability.  Take this scenario as a hypothetical example:</p>
<p>The application is a guidance system for a surface-to-air missile.  The primary goal is of course that the missiles will hit aircraft as often as possible; an important secondary goal is that any unexploded missiles that land in enemy territory do not enable future opponents to make sophisticated SAM guidance systems to shoot down your own planes with.</p>
<p>So, you pick an FPGA whose manufacturer makes strong claims that it is impossible to extract the program from the chip.  Confident in those claims, you burn your most sophisticated guidance algorithms into the chip and end up littering them all over battlefields for the next couple of decades.</p>
<p>Some years after selecting this FPGA, you read this paper.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180394">

			<div class="comment by-ken ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://caffeinesecurity.blogspot.com' rel='external nofollow ugc' class='url'>Ken</a></span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180394">
						May 29, 2012 5:31 PM					</a>

				</p>

				<p>@Jason</p>
<p>&#8220;You&#8217;d still need either physical access to the chip, or remote access to a computer connected by JTAG to the chip, to take advantage of this backdoor.&#8221;</p>
<p>Yep&#8230;No way for a completely offline piece of hardware to get exploited by malware&#8230;just ask Iran&#8217;s nuclear engineers.</p>
<p>You can attempt to justify using vulnerable hardware because there are mitigations, but not fixes, available, but without a fix, it&#8217;s still a vulnerability.  For a mission critical piece of hardware, that&#8217;s unacceptable.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180395">

			<div class="comment by-charlie ">

				<p class="commentcredit">

					<span class="commenter">charlie</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180395">
						May 29, 2012 6:06 PM					</a>

				</p>

				<p>Title seems deliberately misleading.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180396">

			<div class="comment by-alan-hargreaves ">

				<p class="commentcredit">

					<span class="commenter">Alan Hargreaves</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180396">
						May 29, 2012 6:09 PM					</a>

				</p>

				<p>Alec Muffett&#8217;s take on this is worth having a read of &#8211; <a href="http://blogs.computerworlduk.com/unscrewing-security/2012/05/chinese-cyberwarriors-in-your-chips/index.htm" rel="nofollow ugc">http://blogs.computerworlduk.com/unscrewing-security/2012/05/chinese-cyberwarriors-in-your-chips/index.htm</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180397">

			<div class="comment by-petrea-mitchell ">

				<p class="commentcredit">

					<span class="commenter">Petréa Mitchell</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180397">
						May 29, 2012 6:13 PM					</a>

				</p>

				<p><a href="http://www.theregister.co.uk/2012/05/29/researcher_trolls_internet_with_silicon_backdoor/" rel="nofollow ugc">Another dissenting voice here</a>, asserting that the only threat is to chip designers&#8217; IP.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180398">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180398">
						May 29, 2012 7:02 PM					</a>

				</p>

				<p>@ Alan Hargreaves</p>
<p>IMHO our former collegue Alec (as usual) pretty much nails it. If you hadn&#8217;t pointed to his blog post, I would have.</p>
<p>I&#8217;m pretty curious what the official Microsemi/Actel explanation is gonna be. One of the more interesting side phenomena of the story is the very strong polarisation over it in the infosec community, with some parties crying bloody murder and others calling it bogus and a non-event. Same thing with Flame/Skywiper, by the way.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180399">

			<div class="comment by-m-v ">

				<p class="commentcredit">

					<span class="commenter">M.V.</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180399">
						May 29, 2012 7:15 PM					</a>

				</p>

				<p>A little research shows that the Actel/ProASIC3 is manufactured at UMC. UMC is a taiwanese company with Fabs in Taiwan, Singapore and Japan.</p>
<p>So I ask where does that manufactured in China hyperbole comes from?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180400">

			<div class="comment by-hans ">

				<p class="commentcredit">

					<span class="commenter">Hans</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180400">
						May 29, 2012 8:48 PM					</a>

				</p>

				<p>I&#8217;m sick of these &#8220;dissenting&#8221; voices downplaying the severity of this. From what is reported, the secret backdoor allows e.g. to read values which should never be possible to read back (and as an additional note manufacturer claimed that the logic for this is not even there, so a big lie).</p>
<p>I fail to see how being able to read back &#8220;secret&#8221; values is not a severe security risk, especially considering that it is reported that the same backdoor key works on all chips.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180401">

			<div class="comment by-carey ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://careykohl.com' rel='external nofollow ugc' class='url'>carey</a></span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180401">
						May 29, 2012 8:54 PM					</a>

				</p>

				<p>You mean relying on your sworn ideological enemy for all your manufacturing needs will eventually bite you in the ass? Shocking!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180402">

			<div class="comment by-thomas ">

				<p class="commentcredit">

					<span class="commenter">Thomas</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180402">
						May 29, 2012 9:57 PM					</a>

				</p>

				<p>Obligatory link: &#8220;Reflections on Trusting Trust&#8221;</p>
<p><a href="http://www.ece.cmu.edu/~ganger/712.fall02/papers/p761-thompson.pdf" rel="nofollow ugc">http://www.ece.cmu.edu/~ganger/712.fall02/papers/p761-thompson.pdf</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180403">

			<div class="comment by-sbilly ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.sinoutopia.org/' rel='external nofollow ugc' class='url'>sbilly</a></span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180403">
						May 30, 2012 2:58 AM					</a>

				</p>

				<p>Caused by design or manufacturing??</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180404">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180404">
						May 30, 2012 3:39 AM					</a>

				</p>

				<p>@ M.V.,</p>
<p><i>MC is a taiwanese company with Fabs in Taiwan, Singapore and So I ask where does that manufactured in China hyperbole comes from?</i></p>
<p>First off Taiwan if also known as the &#8220;Republic of China&#8221; and contrary to what you read in US newspapers their is not a siege situation.</p>
<p>Goods and people fairly routienly move between the two, the ethnic Taiwanese are the same as the ethnic Chinese ass they were one and the same people for a considerable period before WWII.</p>
<p>It is known that the Chinese Government have invested quite heavily in Taiwanese companies or their parent companies through various other &#8220;cut out&#8221; organisations.</p>
<p>So getting and placing Chinese Government Agents in these companies is more a question of logistics as opposed to Cloak and Dagger.</p>
<p>The term &#8220;Chines knock off&#8221; originaly applied to the ROC not to the mainland so the name just shifted back to the mainland in more recent times as they became more industrialised.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180405">

			<div class="comment by-atn ">

				<p class="commentcredit">

					<span class="commenter">ATN</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180405">
						May 30, 2012 3:52 AM					</a>

				</p>

				<p>I wonder if the &#8220;aes encrypt&#8221; assembly instruction on PC microprocessors has a backdoor on some of these contrefeit microprocessors so that it keeps its input somewhere inside the chip&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180406">

			<div class="comment by-ewan ">

				<p class="commentcredit">

					<span class="commenter">ewan</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180406">
						May 30, 2012 3:54 AM					</a>

				</p>

				<p>&#8220;It&#8217;s remotely possible that the Chinese manufacturer added the functionality, but highly improbable. It&#8217;s prohibitively difficult to change a chip design to add functionality of this complexity&#8221;</p>
<p>This seems to assume that the manufacturer would be doing this on their own without help from any well resourced sponsor.</p>
<p>With Stuxnet and Flame a common line seems to have been &#8220;This is to complex for individuals, it must have been a state&#8221; in this case it&#8217;s &#8220;This is to complex for individuals, it must not be happening&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180407">

			<div class="comment by-mark-currie ">

				<p class="commentcredit">

					<span class="commenter">Mark Currie</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180407">
						May 30, 2012 4:11 AM					</a>

				</p>

				<p>I doubt that missile designers would rely on a chip’s protection mechanisms alone. I would be more inclined to believe that they would follow the kind of methods used by crypto module designers.</p>
<p>Generally the crypto hardware community just assume that all chips have a backdoor that the manufacturers use for testing their chip. Sensitive firmware and FPGA configs etc. are typically protected by encapsulating the chips and associated circuitry within a custom-designed anti-tamper enclosure. It also allows the possibility of erasing the sensitive information when tampering is detected.</p>
<p>It&#8217;s not 100% secure, but it does force the attacker to start from an unknown position and requires breaking-in using sophisticated wafer fab equipment, rather than being able to simply plug into the JTAG or access the manufacturer testing backdoor.</p>
<p>For me the real danger lies with integrated comms interfaces and particularly RF comms. Physical protection in this case is useless if there is a backdoor through an external comms interface. Ideally the comms interfaces should be on separate chips.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180408">

			<div class="comment by-v ">

				<p class="commentcredit">

					<span class="commenter">v</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180408">
						May 30, 2012 5:22 AM					</a>

				</p>

				<p>&#8220;American military chip that is highly secure with sophisticated encryption standard, manufactured in China.&#8221;<br />
I may be being simplistic but doesn&#8217;t this one sentence tell you enough&#8230;<br />
You only need to ask yourself one question &#8211; if the US manufactured military chips for China would they insert a backdoor?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180409">

			<div class="comment by-terryg ">

				<p class="commentcredit">

					<span class="commenter">terryg</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180409">
						May 30, 2012 7:25 AM					</a>

				</p>

				<p>re. UMC: we&#8217;ve been designing some custom silicon, and my understanding (I&#8217;m not the chip designer) is UMC is the Chinese version (poorly phrased) of TSMC.</p>
<p>re. JTAG: every product i&#8217;ve designed this century has a decent-sized FPGA in it (I dont code the VHDL, i just design hardware). we always have a JTAG port to get the FPGA going, but we also always connect the FPGA JTAG to our micro &#8211; allowing in-situ firmware upgrades through the hardware comms interface (usually Gig-E) without cracking the case.</p>
<p>and when it is done, voila &#8211; the system is now that much closer to hackable.</p>
<p>I can see why this might not be done, but I doubt I&#8217;ll ever come across circumstances in which we would not connect the micro to the FPGA JTAG. you&#8217;d want to be mighty confident the VHDL was perfect&#8230;..</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180410">

			<div class="comment by-someone ">

				<p class="commentcredit">

					<span class="commenter">Someone</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180410">
						May 30, 2012 7:51 AM					</a>

				</p>

				<p>Ten years ago I worked on updating a design of some equipment normally sold commercially, so that it could be used by the US DoD. One change we were required to make was removing Chinese-manufactured FPGAs; we were told by the DoD that these were not acceptable for use in secure products.</p>
<p>So I&#8217;m surprised that there is any US military equipment out there using Chinese-manufactured FPGAs at all.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180411">

			<div class="comment by-m-v ">

				<p class="commentcredit">

					<span class="commenter">M.V.</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180411">
						May 30, 2012 8:04 AM					</a>

				</p>

				<p>Clive:&#8221;First off Taiwan if also known as the &#8220;Republic of China&#8221; and contrary to what you read in US newspapers their is not a siege situation.&#8221;</p>
<p>I should have added that i know that Taiwan calls itself Repuplic of China.</p>
<p>The relationship may not be a siege, but it is still rather strained. Direct travelling between the two countries is only possible since a few years.</p>
<p>They may be the same ethnic for the outsider, but there are even language barriers. So it is not that easy to place spys, probably harder than to place chinese spys in Silicon Valley. (When i last was there i had the impression that every other engineer is from chinese origin).</p>
<p>I stay to it, Manufactured in China (as it is today implied) is not the same as Manufactured in Taiwan (aka R.o.C).</p>
<p>This is simply blown out of proportion, just like the shoe and the underpant bomber (and they have been real).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180412">

			<div class="comment by-chris ">

				<p class="commentcredit">

					<span class="commenter">Chris</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180412">
						May 30, 2012 9:09 AM					</a>

				</p>

				<p>Think of it this way, if the Chinese were getting chips fabricated in the US would the government there try to get a backdoor enabled/installed.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180413">

			<div class="comment by-michael-brady ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://eclecticbreakfast.blogspot.com/' rel='external nofollow ugc' class='url'>Michael Brady</a></span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180413">
						May 30, 2012 9:58 AM					</a>

				</p>

				<p>Doesn&#8217;t everyone put backdoors in their export grade military electronic hardware?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180414">

			<div class="comment by-wumpus ">

				<p class="commentcredit">

					<span class="commenter">wumpus</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180414">
						May 30, 2012 1:24 PM					</a>

				</p>

				<p>Anybody familiar with their use?</p>
<p>I see two ways to attack with such a back door:</p>
<ol>
<li>
<p>Reverse engineering.  Commercial FPGAs include encryption to make reverse engineering slightly more expensive (at least for TLAs and larger corporations).  At first, I assumed this was the extent of the issue.</p>
</li>
<li>
<p>Remote hacking.  If it can run an (even abbridged) TCP/IP stack, somewhere, somebody has left one remotely controllable.  It doesn&#8217;t matter how strong you try to use the LART, somewhere along the lines, it just had to be connected to the open internet.  Reflash and away you go.  Before claiming that the military never does this, ask yourself how in the world drone controlling computers have viruses.</p>
</li>
</ol>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180415">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180415">
						May 30, 2012 1:28 PM					</a>

				</p>

				<p>@ M.V.</p>
<p>Chine != Taiwan certainly. I trust Taiwan far more. However, I think you&#8217;re overstating the difficultly of turning one into a spy. Do they care about their family? Is what you&#8217;re offering them more than they make in a year? Will they be forced to loose their job anyway?</p>
<p>And so on and so on&#8230; An evil and often effective game, tradecraft is.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180416">

			<div class="comment by-bob-g ">

				<p class="commentcredit">

					<span class="commenter">Bob G</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180416">
						May 30, 2012 1:54 PM					</a>

				</p>

				<p>I used to work for a major Defense Contractor.  &#8220;Military Silicon Chip&#8221; means what?  What product uses these chips?  Milspec (Military Spec) chips are not made by Chineese or outside the US.  Even contacting China by email causes a review for disclosure to Foreign Controlled Nationals.  Any information transfered to them would come under control.  For Milspec the entire mfg process is controlled.  It is not some test at the end of fab that makes an item MilSpec.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180417">

			<div class="comment by-a_nonny_mouse ">

				<p class="commentcredit">

					<span class="commenter">A_Nonny_Mouse</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180417">
						May 30, 2012 2:36 PM					</a>

				</p>

				<p>I have long been CONVINCED this exact scenario would be discovered.</p>
<p>When you contract WITH YOUR ENEMY for critical security or military products, you can bet they&#8217;re going to find a way to use it against you.</p>
<p>NOW, WHO HAD THE BRILLIANT IDEA TO TURN THE MANUFACTURING OF  CRITICAL SECURITY COMPONENTS OVER TO CHINA?</p>
<p>It was treason and needs to be treated as such.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180418">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180418">
						May 30, 2012 3:41 PM					</a>

				</p>

				<p>@ Bob G on Foreign Sourced Stuff</p>
<p>The article below and my own experience regarding rigorous gov.t requirements having lax enforcement seem to contradict your position. An example on the latter is that a &#8220;controlled interface&#8221; connecting a highly sensitive network with a less trusted one like the Internet must be assured at very high levels. However, they&#8217;ve been using solutions built on EAL4 (read: LOW assurance) technology to do this.</p>
<p>Requirements on paper != requirements in practice.</p>
<p><a href="http://www.huffingtonpost.com/michele-nashhoff/what-led-to-the-problem-o_b_1097158.html" rel="nofollow ugc">http://www.huffingtonpost.com/michele-nashhoff/what-led-to-the-problem-o_b_1097158.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180419">

			<div class="comment by-jarda ">

				<p class="commentcredit">

					<span class="commenter">Jarda</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180419">
						May 30, 2012 4:47 PM					</a>

				</p>

				<p>The advantages of outsourcing at work&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180420">

			<div class="comment by-yu ">

				<p class="commentcredit">

					<span class="commenter">YU</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180420">
						May 30, 2012 10:43 PM					</a>

				</p>

				<p>It looks like guys from cl.cam.ac.uk try to sell technology,</p>
<p>opensource firmware could be safer</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180421">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180421">
						May 31, 2012 4:55 AM					</a>

				</p>

				<p>@ Mark Currie<br />
&#8220;I doubt that missile designers would rely on a chip’s protection mechanisms alone. I would be more inclined to believe that they would follow the kind of methods used by crypto module designers.&#8221;</p>
<p>Would you care to elaborate?</p>
<p>Because as far as I know these FPGA&#8217;s are internally Flash programmed. So the &#8220;program&#8221; resides inside the FPGA, unlike RAM based FPGA&#8217;s where the load data could reside inside a secure ROM.</p>
<p>If you have access to the JTAG than you can probably dump the FPGA state, which for something like a Missile control system  is probably very valuable, I&#8217;d imagine the FPGA contains the information on things like  electronic counter measures and intercept avoidance technology. I&#8217;ve gotta believe that that kinda stuff is pretty secret and closely guarded information.</p>
<p>The only saving position is that the attack requires physical access to the FPGA, hopefully this access is also closely guarded.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180422">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180422">
						May 31, 2012 6:14 AM					</a>

				</p>

				<p>WRT FPGA chips you will find that all of them incorporate some from of serial testing port. In this case JTAG.</p>
<p>Now with ANY serial test port like this you have limited  options after doing wafer-level and package test.</p>
<p>You Can<br />
1) Not bond the JTAG pads (test only available at wafer level)<br />
2) Bond but use lock-out EEPROM or Fuse bits<br />
3) Intentionally Burn_out some circuitry (typically input buffer)<br />
4) Intentionally blow out gate oxides to create an Anti-fuse (internal shunts on critical lines like the CLK)<br />
5) Add some long complex enable sequence</p>
<p>Unfortunately fixes 2 through 4 can be repaired using FIB equipment and extra wires can easily be added with manual wire bonders. So of these choices a complex JTAG enable sequence is probably the most secure, but this is merely security by obscurity&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180423">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180423">
						May 31, 2012 7:49 AM					</a>

				</p>

				<p>@ RobertT,</p>
<p><i>&#8230;a complex&#8230;  &#8230;enable sequence is probably the most secure, but this is merely security by obscurity&#8230;</i></p>
<p>It is and more importantly it goes both ways&#8230;</p>
<p>For an attacker, they need to have some &#8220;keying feature&#8221; to stop the hidden hardware being discovered by chance during the purchasors test and use etc.</p>
<p>Now a lot of people have gone on about &#8220;pin connectivity&#8221; or lack there of, which as you, Nick P  and I have discussed before is not a necessity, just being reasonably close with a sufficiently large and appropriatly modulated EM carrier is sufficient.</p>
<p>As for the harm it could do, a simple reset on the CPU PC or Acc would probably send an active weapon wild, which in modern smart weapons is probably all it would take to make them very un smart.</p>
<p>The advantage of this of course is when wars are being fought by proxie. Imagine how usefull a little box of electronics that would make a &#8220;bunker buster&#8221; Thermobaric weapon miss the cave entrance would be in &#8220;asymetric warfare&#8221; in the Afghan mountains or Pakistani boarder region. Or worse a 1K old iron bomb losing it&#8217;s &#8220;added smarts&#8221; and dropping a few tens or hundreds of feet wide in a heavily built up population would be in terms of &#8220;negative propaganda&#8221;&#8230;</p>
<p>The advantage would be that even if it failed to expload there would be in effect little or no evidence on the test bench, nor would a video of the drop actually produce much of anything either&#8230;</p>
<p>The problem with the information so far presented is it is lacking in sufficient detail to properly evaluate it&#8217;s potential.</p>
<p>And before anyone else raises the point, yes I&#8217;m glad there is insufficient information, simply because it will leave the otherside to some extent guessing as to what can and can not be found by the technology.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180424">

			<div class="comment by-david-marks ">

				<p class="commentcredit">

					<span class="commenter">David Marks</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180424">
						May 31, 2012 8:18 AM					</a>

				</p>

				<p>I was really interested in finding out a lot more about the technology they used to find the backdoor and break the key and today on the Cambridge website they have posted one of the patents detailing how the side channel attack technology works that they used. There is also a brief post about there is a patch that can be used on the backdoor if anyone is interested.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180425">

			<div class="comment by-anonymous-coward ">

				<p class="commentcredit">

					<span class="commenter">Anonymous Coward</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180425">
						May 31, 2012 11:35 AM					</a>

				</p>

				<p>A few quick comments:</p>
<p>1) UMC is a competitor to TSMC.  Both are primarily located in Taiwan with some fabs elsewhere.  I know TSMC has at least one fab located in the US.</p>
<p>2) Silicon is normally programmed in RTL (Verilog or VHDL).  This is then used to produce gates and connections between them.  This is the point where simulation is usually done.  Then the gates are used to produce actual transistors at a specific point on a die.  Finally masks are generated to control the manufacturing; etch here, don&#8217;t etch there, oxide goes here, etc.  In a single die there may be hundreds of layers of masks in the silicon plus additional layers for the metal on the topside.  Only the masks are sent to the fab.  Not the RTL.</p>
<p>The impact of this means it is very hard for the fab to actually know what the die they are building does.  They have the instructions on how to build a transistor at a very low level.  They would have to analyze a lot of layers to determine exactly where the transistor are located and how they are connected together.  And then then they have to go backwards to determine how the gates (groupings of transistors) are connected.</p>
<p>Of course some IP blocks are added at the fab.  For example a standard JTAG interface may be in the fabs library.  So the masks from the designer don&#8217;t have that, they just have instructions to the fab to merge the JTAG interface masks at a specific location.  In this case the fab does have RTL for the JTAG interface.</p>
<p>It is possible to reverse engineer from the masks.  But it is very non-trivial to do.  And it will take time.  Especially when you think that a chip contains millions of transistors.</p>
<p>Manufacturing on a fab has a known time; a few weeks from masks arriving to chips out, as few as 2 if it&#8217;s a rush order.  That doesn&#8217;t leave a lot of time for a reverse engineering job to hack the masks.</p>
<p>If <em>I</em> was going to hack a chip I&#8217;d do it at the RTL level.  Get someone at the company to insert the hack there.  It&#8217;s easier to implement.  Maybe harder to hide though, the RTL is usually under fairly tight control at the company.  Of course there still may be dozens or hundreds of people with access to parts of the code base.</p>
<p>I would worry more about the fab introducing failures.  Make a layer thinner than specified.  Hard to detect.  And it could shorten the lifetime of the part if done correctly.  Which leads to a slow denial of service attack sometime in the future.</p>
<ul>
<li>SW guy at a large silicon company </li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180426">

			<div class="comment by-mark-currie ">

				<p class="commentcredit">

					<span class="commenter">Mark Currie</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180426">
						May 31, 2012 2:12 PM					</a>

				</p>

				<p>@RobertT – Back when I programmed FPGA’s, SRAM-fuse based FPGA’s could also be programmed using a micro (soft config).</p>
<p>Ideally you want to try to “design-out” having to trust chips. You don’t want to hard-code, hard-burn or hard-wire your sensitive stuff. Keep it soft. Then you can store it in encrypted form and all you have to worry about is protecting a key.</p>
<p>Of course it’s not that straight-forward and there are many considerations when designing an anti-tamper system. It’s a whole field on its own. However, many of these techniques are discussed in groups like the Cryptographic Hardware and Embedded Systems (CHES) group. Ross Anderson and the guys at Cambridge often discuss this kind of thing too and their stuff is more easily accessible.</p>
<p>There is also an ISO standard &#8211; ISO/IEC 19790:2006 that provides good info on this kind of thing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180427">

			<div class="comment by-mark-currie ">

				<p class="commentcredit">

					<span class="commenter">Mark Currie</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180427">
						May 31, 2012 2:20 PM					</a>

				</p>

				<p>@RobertT &#8211; Actually the ISO doc I referred to was not the right one. The one I wanted to point is still under development I think:</p>
<p>ISO/IEC WD TR 30104 Information Technology &#8212; Security Techniques &#8212; Physical Security Attacks, Mitigation Techniques and Security Requirements</p>
<p><a href="http://www.iso.org/iso/iso_catalogue/catalogue_tc/catalogue_detail.htm?csnumber=56890" rel="nofollow ugc">http://www.iso.org/iso/iso_catalogue/catalogue_tc/catalogue_detail.htm?csnumber=56890</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180428">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180428">
						May 31, 2012 11:31 PM					</a>

				</p>

				<p>@Mark Currie,</p>
<p>&#8220;ISO/IEC WD TR 30104 Information Technology &#8212; Security Techniques &#8212; Physical Security Attacks, Mitigation Techniques and Security Requirements&#8221;</p>
<p>Thanks for the links, I can certainly agree that this is desirable but the devil is always in the detail. I&#8217;ve seen many complex key controlled encryptions degrade into &#8220;the secret method&#8221; because key management is a difficult task</p>
<p>BTW I also have just a little experience with hardware hacking 🙂 maybe even some techniques that Russ is yet to discover.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180429">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180429">
						May 31, 2012 11:42 PM					</a>

				</p>

				<p>@Clive R<br />
&#8220;As for the harm it could do, a simple reset on the CPU PC or Acc would probably send an active weapon wild, which in modern smart weapons is probably all it would take to make them very un smart.&#8221;</p>
<p>I agree, the knowledge that this exploit exists is what gets people thinking about how to utilize it, and that is always the beginning of the end.</p>
<p>it can take the form of someone sneaking through a mod to hook up these pins (probably labeled &#8220;do not connect&#8221;), The PCB Technician will use some excuse about floating pins error on the PCB layout package. this will usually get it authorized especially if the belief is that it does nothing anyway.  Give me a couple of inches PCB of track and I can definitely induce  a voltage on it sufficient to flip a CMOS input.</p>
<p>The point is that these types of changes can happen well away from the oversight of any security experts.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180430">

			<div class="comment by-m-v ">

				<p class="commentcredit">

					<span class="commenter">M.V.</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180430">
						June 1, 2012 12:00 PM					</a>

				</p>

				<p>Actel has published a response:</p>
<p><a href="http://www.microsemi.com/documents/corporate/Microsemi%20Response%20Security%20Claims%20With%20Respect%20to%20ProASIC3%20053112.pdf" rel="nofollow ugc">http://www.microsemi.com/documents/corporate/Microsemi%20Response%20Security%20Claims%20With%20Respect%20to%20ProASIC3%20053112.pdf</a></p>
<p>Response to the  Response</p>
<p><a href="http://www.cl.cam.ac.uk/~sps32/microsemi_re.pdf" rel="nofollow ugc">http://www.cl.cam.ac.uk/~sps32/microsemi_re.pdf</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180431">

			<div class="comment by-david-marks ">

				<p class="commentcredit">

					<span class="commenter">David Marks</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180431">
						June 1, 2012 1:02 PM					</a>

				</p>

				<p>One thing I dont get about Actels response is they dont even mention anything about the fact you can readback the IP using this <code>test</code> feature which having read Actels documentation clearly states is not even physically implemented. Most odd.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180432">

			<div class="comment by-mark-currie ">

				<p class="commentcredit">

					<span class="commenter">Mark Currie</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180432">
						June 1, 2012 1:46 PM					</a>

				</p>

				<p>@RobertT<br />
“I&#8217;ve seen many complex key controlled encryptions degrade into &#8220;the secret method&#8221; because key management is a difficult task“</p>
<p>Absolutely.</p>
<p>However, this is the one case where no key management is required. The key is not shared. The device is initialised with, or (better still) generates its own random key and encrypts the info for its own exclusive use.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180433">

			<div class="comment by-mark-currie ">

				<p class="commentcredit">

					<span class="commenter">Mark Currie</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180433">
						June 1, 2012 2:34 PM					</a>

				</p>

				<p>@RobertT</p>
<p>Apologies if this post gets sent twice.</p>
<p>“I&#8217;ve seen many complex key controlled encryptions degrade into &#8220;the secret method&#8221; because key management is a difficult task“</p>
<p>Absolutely.</p>
<p>However, this is the one case where no key management is required. The key is not shared. The device is initialised with, or (better still) generates its own random key and encrypts the info for its own exclusive use.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180434">

			<div class="comment by-tamara ">

				<p class="commentcredit">

					<span class="commenter">Tamara</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180434">
						June 1, 2012 3:03 PM					</a>

				</p>

				<p>After reading all of your comments I had an enjoyable time reading <a href="http://www.fpga4fun.com" rel="nofollow ugc">http://www.fpga4fun.com</a>.  Really readable and interesting descriptions of what JTAG is and how FPGA&#8217;s work.</p>
<p>Left me thinking this issue is really BIG.</p>
<p>But today it hit me that if the chips and boards are being made offshore, why is the JTAG issue so important?  Couldn&#8217;t any of the chips on the board already be compromised?<br />
I&#8217;m confused&#8211;why the emphasis on this (seemingly important) vulnerability of JTAG, when, since the whole board is in someone else&#8217;s hands they could put their own chips on the board?</p>
<p>Are there inspections that preclude suspicious mountings that make the possibility of the JTAG exploit more optimal?   Educate me.</p>
<p>As I was pondering, it was the question of whether this exploit of JTAG would require physical access, in which case, game already over, or NOT, if restricting future access to the JTAG vulnerability is the issue, or whether this could become a type of remote attack, or time delayed exploit.</p>
<p>Seems like, if the JTAG vulnerability is significant, either an attacker has to get a cable to the pins, or something on the board has to access those pins, which may involve the sw on the pc to be in cahoots.   Have a I misunderstood this whole thing?</p>
<p>I would love to understand this better,<br />
Tamara</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180435">

			<div class="comment by-tamara ">

				<p class="commentcredit">

					<span class="commenter">Tamara</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180435">
						June 1, 2012 9:58 PM					</a>

				</p>

				<p>Sh*t, last time I saw this kind of silence I was declaring a student pilot emergency landing, and everyone on air just shut up and went away when they heard a woman&#8217;s voice declaring an emergency landing.</p>
<p>Is there anyone here to help?  🙂<br />
Maybe  I could change my name: okay, this is bob everyone, asking for some help understanding this chip issue.  for my own personal edification.  Have limited logic and reasoning skills, eager to understand it all, confused by all the arguments about it.</p>
<p>Is there any known wifi or rf way to remotely manipulate these chips, or would this vulnerability require some kind of physical access to the vulnerable chip via the JTAG? Physical Access can theoretically be controlled.  If I&#8217;m a complete moron, have at it mates, lemme have it.  🙂  really, I can take the criticism.<br />
&#8220;Bob&#8221; aka a girl</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180436">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180436">
						June 2, 2012 12:42 AM					</a>

				</p>

				<p>@ Tamara,</p>
<p>I&#8217;m your Huckleberry! (Doc Holiday, Tombstone)<br />
Yes, they could be compromised. That is one reason some countries refuse to use certain security chips manufactured by a foreign country.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180437">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180437">
						June 2, 2012 6:00 AM					</a>

				</p>

				<p>@ Mark Currie,</p>
<p><i>However, this is the one case where no key management is required. The key is not shared.</i></p>
<p>I guess it depends on your meaning of key managment, but mine covers all asspects of the key including how it is stored in memory and how it is used by software. The reason for this is simple I see no reason nor have I seen for very many years any reason to suppose that there are any bounderiess that limit an attackers ability to get inside a hardware system including inside the chips.</p>
<p>Many years ago I was tasked with defending against such issues and it&#8217;s a hard problem to solve (technicaly speaking impossible). I came up with three methods of making key storage attacking more difficult,</p>
<p>1, Don&#8217;t store the key.<br />
2, Store &#8220;round key&#8221; or &#8220;Sarray&#8221; values in rapidly rotating circular buffers (with a twist).<br />
3, Don&#8217;t store values but &#8220;shadows&#8221; of values.</p>
<p>Over the years it appears that others have subsiquently worked some or all of it out for themselves so there is little point in maintaining the &#8220;required secrecy&#8221;.</p>
<p>For those that are not quite sure what I mean by the three ways I&#8217;ll explain,</p>
<p>The first, &#8220;Don&#8217;t store the key&#8221; is based on the simple observation that all modern cipher systems &#8220;expand the key&#8221; through &#8220;one way algorithms&#8221; before using them as &#8220;rounds keys&#8221; or initial state to store in a stream ciphers State Array (Sarry). You only need to store the expanded key form, which has the advantage of making &#8220;key recovery&#8221; as hard a task as reversing the one way functions which is usually (but not always) as hard as finding the key from a ciphertext only attack.</p>
<p>The second method, &#8220;using circular buffers (with a twist)&#8221; I used to describe as like &#8220;a snake eating it&#8217;s tail&#8221;. In an ordinary circular buffer there is a pointer to tell you where the start and end of the data is and the assumption is it follows in a linear order. If you add values and use say a fast timer interupt to move the values around in the buffer then providing the pointer is not stored directly in memory it becomes a hard task to decide what values are used where and how. Further the &#8220;with a twist&#8221; is where you don&#8217;t just increment the pointer thus providing the values in linear order in memory you use an evolving mapping process to shuffle them about in memory.</p>
<p>Thirdly is another one that appears odd &#8220;don&#8217;t store values but &#8220;shadows&#8221; of values&#8221;. I&#8217;ll start by explaining what a data shadow is. If you have two bytes of memory they hold individual values of data. However there are a number of ways you can use these two stored values to generate a third ephemeral value. The simplest way is that of XORing the two values to get the third value. Likewise you could add them mod 256 etc, you can also use more than two stored values to generate the ephemeral value. This ephemeral value only ever appears in a CPU register, and is generated each and every time it is needed then promptly overwritten by a new value. If you use the values from the circular buffers and also regenerate stored values during the fast timer interupt things become quite opaque to an attacker.</p>
<p>And yes before somebody points it out it is all &#8216;security by obscurity&#8217; but when it come to attackers who can get on or at the chips, it&#8217;s the only thing you have left to fight them with&#8230;</p>
<p>@ Tamara / &#8220;Bob&#8221; aka a girl,</p>
<p><i>&#8230; last time I saw this kind of silence I was declaring a student pilot emergency landing, and everyone on air just shut up and went away&#8230;</i></p>
<p>As they say about comedy &#8220;Timing is everything&#8221;&#8230;</p>
<p>First off a lot of the posters are not from US time zones so a post at 3PM US time is 9PM or later for the rest of the posters and Firday Evenings are generaly reserved for getting the &#8220;muscle relaxant&#8221; down the throat in convivial suroundings and company not bloging. Secondly it&#8217;s been very very noticable that in the US not many people post during &#8220;working hours&#8221; any longer (job fear?).</p>
<p>But any how back to your original question,</p>
<p><i>But today it hit me that if the chips and boards are being made offshore, why is the JTAG issue so important?</i></p>
<p>The problem is not just reserved to the JTAG system or pins, it&#8217;s three questions realy,</p>
<p>1, Is there a backdoor?<br />
2, How is it accessed?<br />
3, How do we find it?</p>
<p>Which I&#8217;ll cover along with your other questions.</p>
<p>But first you ask,</p>
<p><i>Couldn&#8217;t any of the chips on the board already be compromised</i></p>
<p>The simple answer is yes and that&#8217;s been an assumption made by some (myself included) for some time now.</p>
<p>The number of FAB plants around the world doing the higher density devices is very small (Robert T has listed them in the past) and most of them are in the Far East and conceivably under Chinese State Agency access either directly or indirectly&#8230; So it&#8217;s safe to assume that some if not many are indeed &#8220;backdoored&#8221;.</p>
<p>With regards,</p>
<p><i>I&#8217;m confused&#8211;why the emphasis on this(seemingly important) vulnerability of JTAG,</i></p>
<p>The simple answer is a test point is a spying point. JTAG is used for testing the chip at various stages and as such has access to places you would not normaly expect to find access to the outside world (like CPU registers etc). Making a secure system testable in this way is a bit like pouring a reinforced vault but leaving hundreds of holes in the walls to put windows in so you can &#8220;look in to see things are secure&#8221;&#8230;.</p>
<p>I have a rule of thumb that put simply is,</p>
<p><b>Security-v-Testing</b></p>
<p>The reason I say this is that every time you run a &#8220;trace&#8221; into a circuit it provides an overt/known path for a wanted signal, but also a covert/unknown path for other signals due to &#8220;cross talk&#8221; etc. Also a long trace is effectivly an antenna and like all &#8220;trancducers&#8221; it&#8217;s two way that is it both &#8220;emits signals&#8221; and at the same time is &#8220;susceptible to signals&#8221; and can be used for both &#8220;pasive&#8221; and &#8220;active&#8221; EmSec or TEMPEST attacks. Usually on chip traces are so short their effective frequency response is in the THz range.</p>
<p>Disconnecting this trace at &#8220;some point&#8221; does not remove it (except in the mind of an unknowing engineer) it physicaly remains and thus can be used by an attacker in some way&#8230; You might not know how but it&#8217;s best to assume it can unless you are sufficiently experianced to say otherwise (and there are darned few people with anything close to sufficient experiance).</p>
<p>Which brings us onto,</p>
<p><i>since the whole board is in someone else&#8217;s hands they could put their own chips on the board</i></p>
<p>Yes but they won&#8217;t have the all important program loaded untill the final board has been thoroughly tested and delivered to the customer and in all probability further tested there. This specific attack is all about getting the (encrypted) code out of a device (in plaintext) long after it&#8217;s been programed (see comments up the page about unexploded weapons lying around on the battle field etc).</p>
<p><i>As I was pondering, it was the question of whether this exploit of JTAG would require physical access, in which case, game already over, or NOT</i></p>
<p>Yes and no, In the general case a backdoor only needs sufficient energy to &#8220;flip a bit&#8221; which if it is already biased in some way is very very little, thus could be done with an RF carrier tuned to the resonant frequency (or multiple there of) of any track or circuit connected to the desired pin, that is then modulated with a desired signal.</p>
<p>This particular attack would be to get hold of the software within the device in plaintext format which would require very close almost direct contact distances.</p>
<p>As I discused with RobertT the sort of attack that would make a smart weapon very unsmart just needs an ariel, tuned &#8220;pre-selector&#8221; circuit feeding a base band matched filter the output of which does the brief fliping of a reset line etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180438">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180438">
						June 2, 2012 1:38 PM					</a>

				</p>

				<p>Continuing with Clive Robinson&#8217;s input &#8230;</p>
<p>The threat we are talking about here is probably referring to a class III adversary (major government with virtually unlimited resources or a major research institute). As such, JTAG disabling is a small hurdle to such an adversary. For commercial products, JTAG functionality is normally disabled before shipping and after testing. Not by removing the traces, but by blowing fuses on the chip; OTP (one time programmable, not one time pad). However, In some products that require more invasive debugging tools after deployment, there are ways to override the fuse fuse blowing, and re-enable JTAG by, say, changing an NV item (non-volatile memory location). These type of NV item locations and purposes are often hidden even from the OEM. So if someone finds such an item, they may claim it is used for a back door. Back door, it is. The purpose may or may not be malicious. Back doors are not always a good idea, and are susceptible to inside attackers (class II). If this back door is hidden from the designer &#8211; the customer &#8211; by the manufacturer, then the intention should be suspected. The customer (government, in this case) bares the responsibility for verifying and validating the chip at all stages, with auditing. Chips are becoming very complex, and the test and verification tools are also in sync, one would hope.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180441">

			<div class="comment by-tamara ">

				<p class="commentcredit">

					<span class="commenter">Tamara</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180441">
						June 2, 2012 10:06 PM					</a>

				</p>

				<p>@Clive  Thanks!  I&#8217;m currently digesting this, and while I am processing this info, one question:<br />
If there is a worry about RF or any other connectivity to the JTAG pins, couldn&#8217;t it be thwarted by rendering them useless?  Or are they needed later?  Until I fully digest your excellent response, I&#8217;m still trying to figure out why this issue is so critical, and I&#8217;m only interested because it <em>might</em> be so critical.    So if a board is manufactured in a competing nation, and it controls important stuff here, and it&#8217;s well protected from physical access and shielded from RF or other local access&#8230;this might not be a major problem?  Believe me, I&#8217;m not minimizing the issue, just trying to box it in and figure out where the boundaries are.  Back to reading your excellent discussion of the issue, thank you.<br />
Tamara</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180444">

			<div class="comment by-mark-currie ">

				<p class="commentcredit">

					<span class="commenter">Mark Currie</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180444">
						June 3, 2012 12:22 AM					</a>

				</p>

				<p>@Clive Robinson,</p>
<p>I like your idea, and as you suggest, it can be made even more complicated, thus drawing out the reverse-engineering process as long as possible in the final stand. But I would hope that this would be the last gasp. I believe that you have more allies than you give credit to. I think that you are writing off hardware defences too easily.</p>
<p>We agree that all we can really hope to do us delay information discovery. Information propagates and prevails in all sorts of subtle ways, thwarting our feeble attempts to hide, suppress or even destroy it. While we may not be able to defeat nature, defending against other humans is always possible, even if it entails the endless tit-for-tat cycle of measure/counter-measure.</p>
<p>When it comes down to the final stand, as I am sure you know, there are other defences than pure obfuscation. If the attacker only has one or two samples to play with then the risk of triggering an intrusion detect-and-respond defence can slow the process down quite a bit.</p>
<p>As an example of an intrusion detect-and-respond system in the public/commercial domain you can look at a chip like the Dallas/Maxim DS3644. Now I am not sure how effective this chip is against FIB and laser, but there are other ways of defending against the instruments in this game.</p>
<p>This is a game whose secrets are important (as RobertT will agree), so although much has been revealed in recent years, the state of the art will never be published.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180445">

			<div class="comment by-joel-norvell ">

				<p class="commentcredit">

					<span class="commenter">Joel Norvell</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180445">
						June 3, 2012 1:54 AM					</a>

				</p>

				<p>It&#8217;s too bad that Amr Mohsen is behind bars. He could have stopped this in its tracks. It seems &#8220;criminal&#8221; to me not to consider the cost to society of prosecuting someone like Amr – who apparently went a bit off the rails but could do so much to benefit society.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180446">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180446">
						June 3, 2012 3:10 PM					</a>

				</p>

				<p>@ Mark Currie,</p>
<p><i>I believe that you have more allies than you give credit to. I think that you are writing off hardware defences too easily</i></p>
<p>Yes and no, the problem is what you design today will still be put in products X years down the road when what is currently &#8220;bleeding edge&#8221; is droping of the bottom of the &#8220;obsolete product&#8221; list.</p>
<p>I used to work for a company that designed embeded systems for the Oil&amp;Gas industry, some code I developed (in assembler) for the then leading edge 8086 is still being used&#8230; Guess what it&#8217;s not even in the original assembler form, I (apparently) wrote it so well and commented it carefully they paid a consultant to re-develop it in C so. that they could more easily port it onto other systems&#8230; If I&#8217;d know I&#8217;d have probably done it for them for just a few quid and the &#8220;vanity/ego&#8221;. The real joke of it was I actually prototyped the code originaly in C and then re-worked it in assembler (I&#8217;ve still got it as a print out in my &#8220;old jobs&#8221; morgue).</p>
<p>It is because of this &#8220;rapid change&#8221; in hardware (some components only have a 12month &#8220;design in&#8221; life these days) you have to code very very defensivly.</p>
<p>For instance back in the 1980&#8217;s AMD made memory devices that had a &#8220;self destruct&#8221; feature, but unless you&#8217;ve got an original product guide you would not know about it even AMD themselves don&#8217;t admit to having (available) records and data sheets&#8230;</p>
<p>So whilst today I might as you say &#8220;have more allies than you give credit to&#8221; they might be &#8220;fair weather friends&#8221; who are not to be found tomorrow 😉</p>
<p>However of seemingly more interest is,</p>
<p><i>This is a game whose secrets are important (as RobertT will agree), so although much has been revealed in recent years, the state of the art will never be publishe</i></p>
<p>Actually it&#8217;s a little less glamorous than that sounds 🙁 most of the &#8220;classes&#8221; of defense measure are well known and have been published one way or another for many years, what is kept &#8220;secret&#8221; is the &#8220;specifics&#8221; of each instance, so falls truly into &#8220;security by obscurity&#8221; but daming as that may sound it&#8217;s actually not.</p>
<p>In the real tangible physical world security by obscurity works much of the time because of fundemental rules of the physical universe (such as only being in one place, having only limited resources of &#8220;scale&#8221;, energy is proportional to work, etc). Where it does not work is where those fundimental rules do not apply and that is in the intangable information world.</p>
<p>Thus the real trick is working out how to turn intangible nearly infinatly reproducible at virtualy zero cost information into a unique virtualy non reproducible even at huge cost physical object as and where required. And this is where crypto amongst other tools provide little pieces of the solution.</p>
<p>For instance a little whimsy take a nearly perfect but not quite crystal, it&#8217;s faults are as near unique as you could reasonably hope for, if you could find some way of using these faults to encode the information without going through having the crystals faults being capable of being turned into easily reproducable information you would have found a way to use the crystal as a &#8220;unique uncopyable key&#8221; to the information.</p>
<p>Oddly as fantastic as this stands we have reason to believe it is possible with quantum effects. It has been pointed out that you can do something similar with an aproach similar to holograms where the refrence mirror involves the crystal and thus has it&#8217;s unique flaws, thus it becomes possible to encode an image of the information with only the crystal being able to acuratly reproduce the image back. If the image could be encoded in some way such that if only one part of it was incorect then none of th€eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180447">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180447">
						June 4, 2012 1:09 AM					</a>

				</p>

				<p>@Tamara:</p>
<p>In my opinion, most of the comments on this thread reflect a &#8220;maximalist&#8221; attitude, that any crack in the concrete is equivalent to the dam breaking and all the cities downstream being washed away.</p>
<p>Actually, in information security, such a mindset is highly desirable when it comes to design and analysis.  On the other hand, it is an EXTREMELY POOR basis for judging the relative magnitude of various vulnerabilities.</p>
<p>As an (admittedly unfair) example, I have repeatedly tried to explain to people that theoretically realizable related-key attacks on the AES cipher DON&#8217;T mean that there exists even one real-world application, in which it is possible to recover an AES key from looking at or manipulating the ciphertexts (or ciphertexts and plaintexts together).  In other words, a deviation from perfection is not the same thing as a break.</p>
<p>Now, I&#8217;m not expert on these matters, but here&#8217;s my &#8220;arithmetic&#8221; on exploiting the JTAG capabilities.</p>
<p>[1]  If the JTAG pins are not connected, it is most unlikely (notwithstanding Clive&#8217;s discussion of radio beams) that any practical attack could be made.</p>
<p>[2]  If the JTAG pins are connected, this would most often be to some on-board microcontroller.  An adversary who can seize control of the micro, could then extract information from the FPGA and/or reprogram it.</p>
<p>[2a]  Now, in most cases, if an adversary can do whatever he wishes with the on-board micro, the security situation is very poor.  So the &#8220;extra bonus&#8221; of FPGA manipulation via JTAG only has a real security impact, when the FPGA performs a critical security function, for example encryption or decryption.<br />
     For example, if a secret key is &#8220;burned&#8221; onto the FPGA, it could be extracted via JTAG.  (Note:  often, &#8220;hard coding&#8221; a key in this way is a sign that the security design already has gone wrong.)<br />
     In a trickier attack, the FPGA might be reprogrammed to do its job with subtle errors that could leak information outside the system.  This attack generally requires that the adversary know quite a lot about the details of board&#8217;s design and operation.</p>
<p>[2b]  Please note that in the &#8220;missile&#8221; scenario, if the adversary can do whatever he wants with the on-board micro, he can defeat the missile whether there&#8217;s a JTAG vulnerability, or not.  If the adversary can beam enough RF power at the missile to twiddle bits on its internal electronics package &#8212; whilst in mid-flight! &#8212; then he can probably defeat the missile without worrying about FPGA internals, and so on.</p>
<p>[3]  Note that in the foregoing, the adversary must gain control of the on-board micro (and the micro must be connected to the JTAG pins).  This means the attacker must control the programming of the micro, or control some data link that talks to the micro and have found a vulnerability.<br />
     Further, in most systems, that micro will not be connected to the outside world.  It will be on some data bus with one or more other computers as intermediaries, so the adversary must hack those as well.</p>
<p>None of this is to say that exploitation is impossible, or even infeasible.  But whether this vulnerability matters to an actual system, and if so to what extent, will depend very strongly and the system&#8217;s design and modes of operation.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180448">

			<div class="comment by-markh ">

				<p class="commentcredit">

					<span class="commenter">MarkH</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180448">
						June 4, 2012 1:20 AM					</a>

				</p>

				<p>To those commenters, who are dismayed that the FPGA programming can (reportedly) be read out, even though the manufacturer says it can&#8217;t:</p>
<p>In my professional work, I have evaluated programmable devices that are supposed to &#8220;protect&#8221; the information programmed into them.</p>
<p>THEY CAN BE HACKED.  DO NOT TRUST THEM.</p>
<p>In certain countries, bypassing these &#8220;protections&#8221; is so routine that any ordinary engineer knows it is possible, and where to find the techniques for doing so.</p>
<p>Unless something is sold by a reputable manufacturer as a &#8220;tamper resistant module,&#8221; it is a mistake to base any security case on an adversary being unable to extract the programmed data.</p>
<p>This isn&#8217;t a reason to give up on designing for security &#8212; but the security analysis must either include protecting the chips from access by an adversary, or else offer protection even when the adversary can extract the programming.</p>
<p>PS  Even the well-designed tamper resistant modules have been successfully attacked (see Ross Anderson).  Practical security analysis must be based on some assumptions as to the extent of resources an attacker will bring to bear.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180449">

			<div class="comment by-enki-2 ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://firstchurchofspacejesus.blogspot.com' rel='external nofollow ugc' class='url'>ENKI-2</a></span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180449">
						June 4, 2012 9:53 AM					</a>

				</p>

				<p>Had the chips been manufactured in the united states, the same vulnerabilities would exist, but we wouldn&#8217;t be reading about it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180450">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180450">
						June 4, 2012 2:14 PM					</a>

				</p>

				<p>@ Mark Currie,</p>
<p>Hmm sory about the end of my previous post, this smart phone occasionaly does some odd things (such as hang the keyboard code up&#8230;)</p>
<p>As I was saying,</p>
<p>If the image could be encoded in some way such that if only one part of it was incorect then none of the image could be recovered then you would be close to achieving the idea.</p>
<p>@ Tamara, Mark H,</p>
<p><i>In my opinion, most of the comments on this thread reflect a &#8220;maximalist&#8221; attitude, that any crack in the concrete is equivalent to the dam breaking and all the cities downstream being washed away</i></p>
<p>Let me explain why the little crack is the equivalent of the biblical flood, or could be in some cases such that it has to be defended against,</p>
<p>If you are the likes of the NSA, GCHQ et al, you have two conflicting interests,</p>
<p>1, Protect your own nations communications.<br />
2, Break the communications of every other nation (friend or foe).</p>
<p>One thing you know for certain is other countries will try and break your communications with all possible prejudice (yup, theft, burglary, paying/blackmailing people to become traitors and abduction, torture and murder). This is not a &#8220;movie plot scenario&#8221; this is real life and it hapens all to frequently one way or another (look up the &#8220;walker family&#8221; for one).</p>
<p>Another thing you can also assume with certainty is you are going to lose equipment on the battle field. It&#8217;s unavoidable and you know that the enemy will either copy it as is or try to analys it.</p>
<p>Back during the Second World War all cipher machines were essentialy mechanical in nature and it was thus impossible to hide the functioning of the machine, once it was lost.</p>
<p>Thus even though you might want to make the cipher machine as cryptographicaly strong as is reasonably possible to &#8220;protect your nation&#8221; you know darn well the enemy will only copy it and thus put their communications beyond reach, thus destroying your other mission of &#8220;reading the enemies communications&#8221;&#8230;</p>
<p>A seamingly impossible problem arises, or atleast appears to&#8230; However analysis of US Army and Navy cipher systems shows that in the old mechanical systems &#8220;not all keys had the same strength&#8221;. That is some keys were very strong or strong, and some weak or very weak. Unless you had a very good understanding of &#8220;why&#8221;, all keys appeared to be equaly as strong.</p>
<p>Thus an enemy just copying the machine without understanding how it worked would send a proportion of their traffic under the very weak or weak keys thus enabling the US to &#8220;read their communications&#8221; (or atleast some of them and then use other techniques to shorten the break time on other messages). If however they had the smarts to know what were strong and weak keys, the chances were their own systems were atleast as strong.</p>
<p>In fact it has been said that GCHQ never approved a cipher for use unless it knew how to break it or knew it could not be broken. Thus they knew how long a message would be secure under that cipher.</p>
<p>However there is a third problem known in some circles as the &#8220;tactical generals problem&#8221;. Field ciphers generaly only have to be secure for very short periods of time as tactical signals are generally very very short lived. Staff ciphers generaly have to be secure for much longer periods of time as battle plans may be in the planning for months (think D-day landings). Now what do you do when you have a general who for some reason only has a tactical cipher available when he needs to send staff traffic (this happens quite frequently in practice).</p>
<p>The solution is to reserve some of the very strong keys on tactical ciphers for staff use or what is call &#8220;Officer only&#8221; communications. The language in such communications is likley to be very very different from tactical communications such that any field/tactical traffic broken by the enemy will be of little or no use in breaking staff/&#8221;officer only&#8221; communications.</p>
<p>Now in order for this to all work, you need to have one authority for issuing keys, and for many years this was one of the NSA&#8217;s (and GCHQ et al) primary functions.</p>
<p>However as electronics has progressed the ability to copy ciphers has become a lot more difficult to do but is still possible for many nations. But we can see from the NSA&#8217;s &#8220;skipjack&#8221; algorithm used in the CapStone chips for Clipper and Fotezza systems that they are still playing the game, but slightly differently. Skipjack is a very brittle cipher, that is it&#8217;s like a porcelain rod very strong in compression but load it in any other way and it is very brittle and will break. The Skipjack algorithm was declasified as an algorithm some years ago and has been analysed by quite a few people, they have found that even very small apparently quite insignificant changes significantly weaken the cipher. However what was not released was the information regarding the &#8220;tamper proofing&#8221; of the actual chips themselves.</p>
<p>Now the Key Escrow etc that cliper and skipjack were supposedly developed for are long gone and AES has come along. But it is interesting to note that the ideas behind skipjack were probably atleast fourty years old when Key Escrow was first suggested and interestingly like DES just meeting the 56bit key length Skipjack only just met the 80bit keylength, AES on the other hand appears to comfortably meet 128bits and even larger key sizes&#8230;</p>
<p>Has the NSA given up it&#8217;s games? probably not, they just (according to some) rigged the contest using &#8220;human nature&#8221;. It was known befor the ink was dry on the signiture of the NIST announcment of the AES winner that there were problems with practical implementations of the AES winner. Specifficaly when used in &#8220;online&#8221; systems it leaked information badly via various timing attacks on moden CPU&#8217;s. Specifficaly the &#8220;candidate code&#8221; had &#8220;all been optomised for efficiency and speed&#8221; the result was thiss opened up numerous side channels. Because the candidate code for various CPUS etc was available it was just dropped into products &#8220;as is&#8221; along with all the side channels.</p>
<p>I for one always advise people to only use AES in &#8220;offline mode&#8221; that is encrypt your data on a seperate &#8220;Air Gaped&#8221; machine and transfer only the encrypted files via checked media to your &#8220;online&#8221; ssystem for onwards transmission. My reasons are many and only one of them is to do with poor AES implementations.</p>
<p>It is interesting to note (and it adds fuel to the conspirital fire) that the NSA although approving AES for secret and above, only do so for &#8220;data at rest&#8221; in products like their Inline Media Encryptor (IME) which is used inline for storage equipment like hard drives etc. That is it is not considered secure &#8220;in use&#8221; (and I personaly can think of a whole load of good reasons other than time based side channels for this).</p>
<p>However when designing systems because of the &#8220;tactical general problem&#8221; it is best to assume that &#8220;any crack is a dam buster&#8221; and design accordingly&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180452">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180452">
						June 6, 2012 12:56 AM					</a>

				</p>

				<p>@ Tamara,</p>
<p>You might find this an interesting read,</p>
<p><a href="http://www.emsec.rub.de/media/crypto/veroeffentlichungen/2011/11/29/preprint_version_ISSE_wireless.pdf" rel="nofollow ugc">http://www.emsec.rub.de/media/crypto/veroeffentlichungen/2011/11/29/preprint_version_ISSE_wireless.pdf</a></p>
<p>It&#8217;s a paper from Bochum University in Germany and it covers embedded wireless devices and covers attacks by type I &amp; II personnel and the equipmant they might find of use.</p>
<p>The paper is a little dated, but when reading it keep in mind just how much easier some of the attacks on the likes of KeyLoq fobs etc will be with new analysis vectors showing the same levels of improvment PEA does over preceading methods&#8230;</p>
<p>As Bruce once (now famously 😉 remarked &#8220;attacks only improve with time&#8221;.</p>
<p>Oh pay special attention to the likes of devices powered from the EM field, back when the E Passports were first seriously touted I commented that all these chips work in slightly different ways and thus their effect on the EM field would be different and measurable, thus it would be possible to identify the country of origin of ssome passports &#8220;sight unseen&#8221; just by examining the trace. This still holds true, however as you will see in the paper another attack on the crypto setup phase timing trace revealed the actuall user details&#8230;</p>
<p>Much of the equipment in use can either be purchased (some of it very cheaply second hand now we are in a &#8220;double-dip recession&#8221;) rented for short periods, or if you are handy with a soldering iron built with &#8220;Off The Shelf Components&#8221;. These can usually be sourced either on the Internet from the manufacturer or via the likes of &#8220;componet catalogue&#8221; outlets used by small and medium sized businesses and Schools/Universities in most parts of the world (have a look at, DigiKey, RS Components, Farnell etc as examples).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180453">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180453">
						June 6, 2012 1:07 AM					</a>

				</p>

				<p>@ Mark Currie, Mark H, Nick P, Tamara,</p>
<p>You all might find this both interesting and reasonably upto date,</p>
<p><a href="http://www.lightbluetouchpaper.org/2012/05/31/three-paper-thursday-issisp2012/" rel="nofollow ugc">http://www.lightbluetouchpaper.org/2012/05/31/three-paper-thursday-issisp2012/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180454">

			<div class="comment by-mark-currie ">

				<p class="commentcredit">

					<span class="commenter">Mark Currie</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180454">
						June 6, 2012 4:16 PM					</a>

				</p>

				<p>@ Clive Robinson,</p>
<p>Sorry for the delayed response. I hope I haven’t lost everyone. Thanks for the ref.</p>
<p>“the problem is what you design today will still be put in products X years down the road when what is currently &#8220;bleeding edge&#8221; is droping of the bottom of the &#8220;obsolete product&#8221; list.”</p>
<p>Yes, this is a very valid issue when it comes to protecting long-term secrets. R&amp;D in this field is very expensive and life-cycles cannot always be controlled.</p>
<p>In the tactical scenario the protection mechanisms need only provide protection for the duration of the mission. So sensitive info could be automatically destroyed by the device itself based on certain cues e.g. timeout, lack of keep-alive, power failure, kill signal, etc….</p>
<p>@ MarkH</p>
<p>“Even the well-designed tamper resistant modules have been successfully attacked (see Ross Anderson).”</p>
<p>It&#8217;s probably safe to say that all modules can eventually be successfully attacked. The skill lies in whether the module can hold out long enough to make a difference.</p>
<p>You may have heard of Christopher Tarnovsky. Tarnovsky is a formidable chip hacker, very experienced at reverse engineering chips. He has access to decent instruments and has a pretty well-equipped lab himself (including FIB). While some of the “secure” chips he has examined are almost trivial to crack, he can take 9 months and many samples to crack a well-designed chip. Perhaps a well-funded organisation with better labs could do better, but Tarnovsky’s accounts show the kind of effort required when no prior knowledge exists. Therefore design secrecy (also a difficult task) is imperative. Bear in mind that the security mechanisms here are only based on the chip’s capabilities, which have severe disadvantages. Chips rely only on external power and do not have the luxury of a crypto module which has more space to allow for things like decent filtering and other protection mechanisms.</p>
<p>I suppose I could be accused of being overly optimistic towards the designers who have all the odds stacked up against them. However I have great faith in human innovation. What I like about this blog is that many commentators balance their negative warnings with a positive idea as well. Crypto designers (no matter how experienced) need all the ideas and encouragement they can get.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180455">

			<div class="comment by-nathan-fain ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://deadhacker.com' rel='external nofollow ugc' class='url'>Nathan Fain</a></span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180455">
						June 8, 2012 5:38 AM					</a>

				</p>

				<p>In the first paper they claim there was a backdoor without providing any proof to the claims. The vendor responds saying that this is a feature that can be turned off. The researchers give nothing that can refute this and its likely that manufacturers clients can easily verify. The researchers then release a new paper with moderated backdoor claims that contradict themselves:</p>
<blockquote><p>Ultimately, an attacker can extract the intellectual property (IP) from the device as well as make a number of changes to the firmware such as inserting new Trojans into its configuration.</p></blockquote>
<p>A vulnerability that allows one to <b>insert</b> a trojan is not the same as a device or system &#8216;with&#8217; a trojan. It&#8217;s not snake-oil but the language, and insistence on this language still, is certainly FUD. Only examination of common configuration practice (likely through access to documentation) could re-assert the claim that the features found are backdoors. If you need a more full rundown and dissection of the papers, <a href="http://deadhacker.com/2012/06/08/backdoor-silicon-fud/" rel="nofollow ugc">err</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180456">

			<div class="comment by-david-marks ">

				<p class="commentcredit">

					<span class="commenter">David Marks</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180456">
						June 8, 2012 8:07 AM					</a>

				</p>

				<p>@ Nathan Fain</p>
<p>There is no new paper, only the old draft paper the final paper as they say is for CHES so what other paper are you talking about? On their page there is reference to another paper regarding AES that was submitted it IACR. I think you are perhaps confusing them.</p>
<p>What you have mentioned about a trojan is not really anything to do with the paper, its just to show that you can extract the IP and reprogram the chip as you can easily break the AES key and PASSKEY. I dont see anything wrong in that.</p>
<p>Actel doesnt say anything about the fact that they can readback all the IP from the device when Actel claims its physically impossible even in the companies own literature. They dont even deny it. This speaks volumes. So it seems there is another key used to allow readback of the device thats not documented and exists alongside a host of other functionality. I would suggest this looks pretty dodgy.</p>
<p>I cant see how any undocumented feature that allows you to circumnavigate user security and readback all the IP thats supposed to be impossible is some <code>test</code> feature or <code>other</code> feature for failure analysis.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180458">

			<div class="comment by-r-macrae ">

				<p class="commentcredit">

					<span class="commenter">R. MacRae</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180458">
						June 16, 2012 4:53 AM					</a>

				</p>

				<p>In the old days we used to have fun looking for the undocumented CPU instructions in the 8086/8088 &amp; 6502 series. Don&#8217;t see why things would have changed. Find the key(s) to get to the undocumented instructions via software and your there. All the old CPU&#8217;s had them along with the support chips. Just the key&#8217;s are more difficult to crack. I would say being creatures of habit the same method would be implemented in today&#8217;s chips to access a lower undocumented register level. KISS method.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180459">

			<div class="comment by-john-langman ">

				<p class="commentcredit">

					<span class="commenter">John Langman</span> •

					<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/#comment-180459">
						June 17, 2012 5:56 AM					</a>

				</p>

				<p>The analysis and reverse engineering of chips whilst sophisticated is mainly the application of standard processes. Reading ROM contents with the use of an FIB is well documented. The extraction of circuitry with an electron microscope is available world wide. Re-engineering a device to insert new features is highly expensive especially if the device is fabbed in sub 50nm feature processes. The result would require access to superb<br />
facilities and the re-manufacture of 10 to 20 mask sets at upwards of 1mdlrs per. Then make test and prove, such an endeavour can only reasonably non commercially be undertaken by states. However the existence within most complex micro-electronics of test routines including JTAG with a pre-requisite of being available to the test machine and not the user has been extant in the industry since inception. If security is so important then devices can be built with scribe and crack removal post test. This feature has been utilised in smart card systems for 30 plus years. Leaving in test systems with vulnerabilities is symptomatic of the lack of appreciation of the nefarious use they may be used for post delivery.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2012/05/backdoor_found.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2012/05/backdoor_found.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F05%2Fbackdoor_found.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2012/05/backdoor_found.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='4367' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2012/05/interview_with_23.html" rel="prev">← Interview with a Safecracker</a>		<a href="https://www.schneier.com/blog/archives/2012/05/the_problem_of_1.html" rel="next">The Problem of False Alarms →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
