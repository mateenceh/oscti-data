<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Friday Squid Blogging: Baby Opalescent Squid - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Friday Squid Blogging: Baby Opalescent Squid Comments Feed" href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/4370" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=4370' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F06%2Ffriday_squid_bl_330.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F06%2Ffriday_squid_bl_330.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-4370 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-4370" class="post-4370 post type-post status-publish format-standard hentry category-uncategorized tag-squid">

	<div class="article">

		<h2 class="entry">Friday Squid Blogging: Baby Opalescent Squid</h2>
		<p>Baby squid larvae are transparent after they hatch, so you can <a href="http://s.scientificamerican.com/psi-vid/2012/05/28/baby-opalescent-squid-a-beautiful-start-to-the-week/">see</a> the chromataphores (color control mechanisms) developing after a few days.</p>
<p>As usual, you can also use this squid post to talk about the security stories in the news that I haven&#8217;t covered.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/squid/" rel="tag">squid</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html" rel="bookmark">Posted on June 8, 2012 at 4:28 PM</a>			•
			<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html#comments">94 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html" data-title="Friday Squid Blogging: Baby Opalescent Squid" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-180541">

			<div class="comment by-anonymous-coward ">

				<p class="commentcredit">

					<span class="commenter">anonymous coward</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180541">
						June 8, 2012 4:45 PM					</a>

				</p>

				<p><a href="http://www.cwi.nl/news/2012/cwi-cryptanalist-discovers-new-cryptographic-attack-variant-in-flame-spy-malware" rel="nofollow ugc">http://www.cwi.nl/news/2012/cwi-cryptanalist-discovers-new-cryptographic-attack-variant-in-flame-spy-malware</a></p>
<p>Cryptanalist Marc Stevens from the Centrum Wiskunde &amp; Informatica (CWI) in Amsterdam, known for &#8216;breaking&#8217; the MD5 hash function for https security in 2008, analyzed the recent Flame virus this week. He discovered that for this spy malware an as yet unknown cryptographic attack variant of his own MD5 attack is used. Stevens analyzed this with new forensic software that he developed. Initially, the researcher assumed that Flame used his own attack, which was made public in June 2009, but this was not the case. “Flame uses a completely new variant of a ‘chosen prefix collision attack’ to impersonate a legitimate security update from Microsoft. The design of this new variant required world-class cryptanalysis,” says Marc Stevens. “It is very important to invest in cryptographic research, to continue to be ahead of these developments in practice.”</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180542">

			<div class="comment by-petra-mitchell ">

				<p class="commentcredit">

					<span class="commenter">Petr&eacute;a Mitchell</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180542">
						June 8, 2012 5:15 PM					</a>

				</p>

				<p><a href="http://abcnews.go.com/blogs/politics/2012/06/senator-asks-doj-to-investigate-swat-ting-attacks-on-conservative-bloggers/" rel="nofollow ugc">SWATting is in the news again</a>. This is the first case I&#8217;ve heard of where the motive is allegedly political.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180543">

			<div class="comment by-daniel ">

				<p class="commentcredit">

					<span class="commenter">Daniel</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180543">
						June 8, 2012 5:30 PM					</a>

				</p>

				<p>A fascinating article written by a law professor entitled &#8220;The Perils of Social Reading&#8221;.  From the abstract.</p>
<p><i>We are quite literally rewiring the public and private spheres for a new century. Choices we make now about the boundaries between our individual and social selves, between consumers and companies, between citizens and the state, will have unforeseeable ramifications for the societies our children and grandchildren inherit. We should make choices that preserve our intellectual privacy, not destroy it. This Article suggests practical ways to do just that. </i></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180544">

			<div class="comment by-daniel ">

				<p class="commentcredit">

					<span class="commenter">Daniel</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180544">
						June 8, 2012 5:30 PM					</a>

				</p>

				<p>Gah! Here is the link:</p>
<p><a href="http://papers.ssrn.com/sol3/papers.cfm?abstract_id=2031307" rel="nofollow ugc">http://papers.ssrn.com/sol3/papers.cfm?abstract_id=2031307</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180545">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180545">
						June 8, 2012 6:11 PM					</a>

				</p>

				<p>OFF Topic:</p>
<p>It would appear that the US judiciary are getting to breaking point with &#8220;Patent-Spats&#8221; and being used by large commercial organisations as proxy business drivers.</p>
<p>The Judge overseaing the Apple-Google case has told them he&#8217;s minded to throw it out with prejudice&#8230;</p>
<p>So far both Apple &amp; Google appear not to want to say anything, and are waiting for a formal ruling.</p>
<p>The judge has also made a very interesting blog comment on the state of the US patent system and the us in general (he starts with the point that it is realy only the fact that the USD is the international trading currency that is stoping the US being hosed).</p>
<p><a href="http://gigaom.com/mobile/famous-judge-spikes-apple-google-case-calls-patent-system-dysfunctional/" rel="nofollow ugc">http://gigaom.com/mobile/famous-judge-spikes-apple-google-case-calls-patent-system-dysfunctional/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180546">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180546">
						June 8, 2012 6:31 PM					</a>

				</p>

				<p>OFF Topic:</p>
<p>Something for the weekend?</p>
<p>Are you looking for an out of this world experiance to put the WoW factor back in your life?</p>
<p>Well have a look at these,</p>
<p><a href="http://www.flickr.com/photos/nasa_jsc_photo/sets/72157629726792248/with/7257867240/" rel="nofollow ugc">http://www.flickr.com/photos/nasa_jsc_photo/sets/72157629726792248/with/7257867240/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180547">

			<div class="comment by-jamesbond ">

				<p class="commentcredit">

					<span class="commenter">jamesbond</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180547">
						June 8, 2012 7:22 PM					</a>

				</p>

				<p>Spook Number Station Monitoring</p>
<p>mailman (dot) qth (dot) net/pipermail/spooks/</p>
<p>growing tired of trying to post and smashing up against the comment blocked page! loosen up your filter!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180548">

			<div class="comment by-beer-in-the-fridge ">

				<p class="commentcredit">

					<span class="commenter">beer in the fridge</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180548">
						June 8, 2012 7:58 PM					</a>

				</p>

				<p>I bet this will post, instead of the post I was going to make&#8230;</p>
<p>Comment Blocked</p>
<p>Your comment was blocked from appearing on the site. This may have happened for one of the following reasons:</p>
<pre><code>You posted without typing anything in the name field, or you simply typed "Anonymous." Please choose a name or handle to use on the blog and try again. Conversations among several people all called "Anonymous" get too confusing.
Your comment was a duplicate of another recent comment. If you double-posted accidentally, you don't need to do anything more -- the first copy of the comment will still be published.
You posted using the name of an administrative account, but the blog couldn't authenticate you. If you are an administrator, please log in and try again; otherwise, please choose a different name. 
</code></pre>
<p>If none of these reasons apply, then your message was spam filtered and will be held for review by a human. We apologize for the inconvenience.</p>
<p>stupid shit filter</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180549">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180549">
						June 8, 2012 8:37 PM					</a>

				</p>

				<p>@ 3rd world jamesbond</p>
<p>Looka like the filter is performing admirably</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180550">

			<div class="comment by-pick-n-ose ">

				<p class="commentcredit">

					<span class="commenter">Pick N.ose</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180550">
						June 8, 2012 11:37 PM					</a>

				</p>

				<p>Nick P &#8211; this coming from the same person who requested a certain informative post be DELETED under the pretense it was spam, when in fact it was not, and further went to the trouble of also saying to the effect &#8220;and remove this post requesting the removal&#8221; (re: examiner links to people with real implants in their body, highly controversial for TPTB who would prefer this information remain silent)</p>
<p>cowardice runs rampant on the web, so back atcha, pally.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180551">

			<div class="comment by-anon ">

				<p class="commentcredit">

					<span class="commenter">Anon</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180551">
						June 9, 2012 6:19 AM					</a>

				</p>

				<p>Bruce, your radio interview with Skeptically Speaking aired last night, and the podcast is available now.<br />
<a href="http://skepticallyspeaking.ca/episodes/167-liars-and-outliers" rel="nofollow ugc">http://skepticallyspeaking.ca/episodes/167-liars-and-outliers</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180552">

			<div class="comment by-alan-kaminsky ">

				<p class="commentcredit">

					<span class="commenter">Alan Kaminsky</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180552">
						June 9, 2012 11:26 AM					</a>

				</p>

				<p><a href="http://abcnews.go.com/US/wireStory/flashlight-bombs-puzzle-phoenix-authorities-16531427" rel="nofollow ugc">Flashlight Bombs</a> Puzzle Phoenix Authorities</p>
<p>&#8220;Flick the switch on these flashlights and they don&#8217;t light up. They blow up.</p>
<p>&#8220;Three of these bombs have exploded within the last month in the Phoenix area, causing minor injuries to five people and raising fears of more serious ones.</p>
<p>&#8220;Police still have no idea who is behind them and have taken the unusual step of putting up 22 billboards across the sprawling metro area to warn residents about discarded flashlights. . . . In addition to the billboards, police are offering a $10,000 reward for tips that lead to an arrest or conviction.</p>
<p>&#8220;Police have received dozens of calls reporting possible flashlight bombs that either turned out to be false alarms or hoaxes, including one from a Goodwill store.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180553">

			<div class="comment by-owen ">

				<p class="commentcredit">

					<span class="commenter">Owen</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180553">
						June 9, 2012 11:43 AM					</a>

				</p>

				<p>From the flashlight bomb article: Mangan said the agency has ruled out any connection to terrorism because the targets have been random and there have been no messages or demands.</p>
<p>How desperately sad. The govt/police have been so busy calling any murder/crime &#8220;terrorism&#8221; that when the real thing appears, they don&#8217;t recognize it anymore.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180554">

			<div class="comment by-daniel ">

				<p class="commentcredit">

					<span class="commenter">Daniel</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180554">
						June 9, 2012 11:48 AM					</a>

				</p>

				<p>@Alan</p>
<p>Oh how silly. If the only damage done is a small abrasion to the forehead how can it be called a &#8220;bomb&#8221;. I&#8217;ve done worse damage (to myself) with a sparkler. Under that definition the police had better be on the alert for FIREWORKS. Hold a BlackCat in your hand and it will do more damage than one of those so-called bombs.</p>
<p>It reminds me of all the &#8220;terror&#8221; in Boston. What a load of crap.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180555">

			<div class="comment by-daniel ">

				<p class="commentcredit">

					<span class="commenter">Daniel</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180555">
						June 9, 2012 11:51 AM					</a>

				</p>

				<p>I realized that I used the terms bomb, terror, and Boston in a single post. Come and get me NSA!!</p>
<p>Airplane.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180556">

			<div class="comment by-ronnie ">

				<p class="commentcredit">

					<span class="commenter">Ronnie</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180556">
						June 9, 2012 12:33 PM					</a>

				</p>

				<p>I was reading an article on hardening your passwords (because of the LinkedIn and eHarmony breeches)<br />
<a href="http://www.informationweek.com/news/security/client/240001775" rel="nofollow ugc">http://www.informationweek.com/news/security/client/240001775</a><br />
One of the recommendations was to use a password manager &#8211; with the caution that some had poorly implemented crypto.<br />
<a href="http://www.informationweek.com/news/security/encryption/232602738" rel="nofollow ugc">http://www.informationweek.com/news/security/encryption/232602738</a><br />
Interestingly, two of the iOS apps used Blowfish <i>&#8220;for which password experts have spent less time developing cracking tools.&#8221;</i></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180557">

			<div class="comment by-joe-loughry ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.cs.ox.ac.uk/people/joe.loughry/' rel='external nofollow ugc' class='url'>Joe Loughry</a></span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180557">
						June 9, 2012 12:48 PM					</a>

				</p>

				<p>Clive,</p>
<p>The long-exposure photos taken on the space station are especially interesting if you look at the highest resolution and zoom in.  Sensor damage and noise from high energy particles is clearly evident in the images.  Permanent inhabitants of the space station exist in a high radiation environment.  Incredible photos, though.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180558">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180558">
						June 9, 2012 4:11 PM					</a>

				</p>

				<p>@ Ronnie,</p>
<p>Checking in from area code 11221 &#8230;</p>
<p><i><br />
Some say passwords are out of style<br />
I recon passwords will remain for quiet a while<br />
If you insist to say otherwise<br />
Then for you I have this advise<br />
Your forcast is but a crap pile<br />
</i><br />
🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180559">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180559">
						June 9, 2012 4:32 PM					</a>

				</p>

				<p>@ Clive</p>
<p>Nice pics, I&#8217;m sure you&#8217;ve seen the video of the Aurora Australis from the ISS.  Supernovae are my favorites.</p>
<p>@ Pick N.ose Re: Nick P</p>
<p>I&#8217;m not accusing, but it&#8217;s good that people&#8217;s comments are being scrutinized for &#8220;trolliness&#8221;, there are a billion other places to waste people&#8217;s time (facebook? twitter?).  You can tell that Mr. NP takes great care in always using the least amount of words in his posts and links articles of high quality.  What sucks is that you (typically) have to read said nonsense to determine if it&#8217;s f&#8217;in nonsense (like some &#8220;AlienReptilianLizard&#8221; guy a while back who POSTED stuff LIKE this, CAPITALIZING every OTHER word; it&#8217;s really annoying).</p>
<p>For gawt&#8217;s sake all you wannabe-spammers/trollers; have a little respect for people here who have likely done a little cryptanalysis and don&#8217;t need/want to sift thru anymore nonsense than is necessary to do their jobs&#8230;</p>
<p>Also, the articles were from the same source, Deborah Dupre and Suzanne LeBoeuf of Examiner.  We need more sources, more evidence.  The picture of the &#8220;implanted chip&#8221; was too small to see.  What specific spectrum analyzer was used to detect the RF in Walbert&#8217;s back?  I won&#8217;t entirely dismiss the possibility (look up &#8220;Elmer Allen&#8221;, how he was diagnosed with paranoid schizophrenia b/c he thought he was being experimented with, when in fact he was) but there were many mistakes in the articles, S.LeBoeuf&#8217;s articles were pretty worthless and only 1 of D.Dupre&#8217;s articles needed to be posted as they were part of a &#8220;series&#8221;.  We should be worried when a majority of imbeciles willingly chip themselves to &#8220;get VIP access to a club&#8221; or maybe the &#8220;Kardashians&#8221; or &#8220;LiLo&#8221; is doing it, so it&#8217;s the &#8220;in&#8221; thing to do!</p>
<p>Anyways whew, my little funny story.</p>
<p>Upon a visit to a local hardware store and after making a small purchase and waiting for my change at a &#8220;self-checkout kiosk&#8221;, the oh-so-sophisticated, highly-technical procedure of <i>kicking 3 times</i> (3rd time&#8217;s the charm) the key-locked change-box below the check-out scanner made the P.O.Shyte work and give me my change.</p>
<p>Aside from making my day, and making me smile; it made me wonder what else would spit out money after being kicked&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180560">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180560">
						June 9, 2012 4:47 PM					</a>

				</p>

				<p>@ figureitout</p>
<p>I appreciate your support. The reason i use few words is that trolls want attention and to make people waste time. So, i just say &#8220;hey mod&#8230; prolly a troll. clear it all up will ya?&#8221;</p>
<p>Of course, anyone citing the Examiner is always suspect&#8230; 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180561">

			<div class="comment by-jack ">

				<p class="commentcredit">

					<span class="commenter">Jack</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180561">
						June 9, 2012 6:49 PM					</a>

				</p>

				<p>@Clive Robinson &#8211; about the patent system in the US -&gt; it&#8217;s worse than anyone says. 99% of all attacks against the patent system are about allowance errors. Typically, complaints are by someone who does not believe a patent should have been issued (uh&#8230;I could have thought of that), or even that patents are altogether bad (everything should be free man&#8230;free!). There are hundreds of blogs in which SW patents are attacked.</p>
<p>But far more destructive to the nation&#8217;s future are dis-allowance errors. These range from a result of examiners who do not understand what they&#8217;re looking at, to inventors and small companies eventually going broke pursuing their application. No one cares about dis-allowance errors, they&#8217;re rarely discussed beyond attorneys. Almost everyone thinks the patent examiners tend to allow all sorts of crap, so therefore, it&#8217;s unthinkable something really useful and novel would be dis-allowed. Nothing could be further from the truth. It happens all the time and it&#8217;s worse now than ever before. Most of the time someone else will just pick up a design from rejected or abandoned applications, then take it and go.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180562">

			<div class="comment by-iab_jlr ">

				<p class="commentcredit">

					<span class="commenter">iab_jlr</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180562">
						June 9, 2012 8:34 PM					</a>

				</p>

				<p>It seems stupid for the secret services to let everyone know about an improved MD5 collision attack &#8220;with practical implications&#8221; when there were already published attacks.<br />
Reading the article, the timing was tighter than I recalled between the release of the free-for-all source and the attack, but more than enough to avoid using the improved version.<br />
Is there any reason the known attack wouldn&#8217;t have worked?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180563">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180563">
						June 10, 2012 4:29 AM					</a>

				</p>

				<p>Nick P,</p>
<p>The world turns and somethings never change.</p>
<p>Back in the late 1970&#8217;s and early 1980&#8217;s I remember people geting all excited by the Russian Over The Horizon Radar that was nicknamed &#8220;woodpecker&#8221; because of the noise it made. All sorts of people were wheeled out to comment on it including a bunch who genuinely did talk about &#8220;soviet mind control&#8221; and what we now call &#8220;tinfoil hats&#8221;&#8230;.  What also came up again were the &#8220;number stations&#8221; because at the time (hight of the Cold War) many were out of &#8220;Russian aligned&#8221; countries pointing at the West and had the anoying habit of interfering with legitimate broadcasts.</p>
<p>For some reason people were fascinated by number stations and thus like to scan the HF/shortwave &#8220;broadcast bands&#8221; and report their characteristics. There was (and may still be) a group called ENIGMA who did it fairly proffesionaly and produced annual reports.</p>
<p>However you may remember back to a post Bruce had about what once was the worlds most powerfull AM broadcast station &#8220;aspidistra&#8221; that was located in Crowborough UK and was run by BBC engineers for the UK DWS (Diplomatic Wirless Service then running out of Pounden and now out of Hanslop Park as far as I&#8217;m aware). Well the BBC/DWS ran a lot of HF broadcast stations around the world including some in Cyprus, which caused a bit of a political stink or two in their time. One number station &#8220;The Linconshire Poacher&#8221; supposadly run for MI6/SIS came from the main RAF base there (according to Cyprus TV who were activly &#8220;raising a stink&#8221; at the time). One thing that realy made me laugh was the BBC &#8220;light service&#8221; actually had a program in 2005 about people trying to track down the transmitters location (they could have just asked their &#8220;over seas&#8221; department who knew almost exactly where many number stations were located as it was part of their job to keep an eye on them). The &#8220;poacher&#8221; appeared to be aimed at the Middle East and went off air around four years ago but apparently a simillar/replacment station is now running out of Australia as &#8220;cherry pie&#8221; which North Korea keeps trying to jam much to the anoyance of South Korea who appear to be raising their own political stink for saber rattling purposes (If you believe the S.Korean media N.Korea is the third most dangerous &#8220;cyber-warfare nation after the US and Russia which makes me smile).</p>
<p>Are number stations broadcast messages to &#8220;agents in the field&#8221; using One Time Pads?, possibly, possibly not, who knows, nobody talks about them officialy (although there is documentation from the fallen parts of the &#8220;Iron Curtain&#8221; giving strong evidence that&#8217;s what the Russian alied ones were used for). But even if the operators of the stations did talk what are they going to say &#8220;a bloke in a small van turns up with a bunch of prerecorded tapes (or their modern equivalent) and we put them on air&#8221;. So it&#8217;s reasonable to say they could have a number of purposes including being the land equivalent of the &#8220;Submarine Fleet Broadcast Services&#8221;.</p>
<p>Aside from their mystique and usage speculation the number stations are however quite useful though as a quick and easy way to test you&#8217;ve set a broadband HF antenna up correctly for which ever way you want to work and check you&#8217;ve got the right &#8220;lift&#8221; to work into a place.</p>
<p>They come in a variety of forms including CW, voice, and even &#8220;music&#8221; nearly always AM and in the HF Broadcast bands. Which only needs the simplest of &#8220;travel pocket radios&#8221; to pick up. And it is this fact that is often used as an argument that the number stations are primarily for &#8220;agents&#8221;. This is plausible because as an agent you don&#8217;t want a load of &#8220;high tech&#8221; radio gear around effectivly it would be an Albatros hanging round your neck as you could not easily explain it away. But as always arguing from effect to cause is a fraut and very imprecise business.</p>
<p>However some of the number stations do transmitt much more complex signal formats including the likes of multi-tone FSK and fast morse and RTTY.</p>
<p>The DWS developed &#8220;Piccolo&#8221; back in the 1960&#8217;s ( <a href="http://ieeexplore.ieee.org/iel5/5247218/5251375/05251432.pdf" rel="nofollow ugc">http://ieeexplore.ieee.org/iel5/5247218/5251375/05251432.pdf</a> ) which was used for diplomatic trafic which would have included messages for MI6/SiS &#8220;resident&#8221; officers. Originaly Piccolo used 32 tones (one for each TTY char) a later version used 6 tones sent as time seperated pairs (giving 36 pairs) with a small amount of AM to indicate which tone was the first of the pair. The tones are orthagonal and ten Hz apart and use a charecteristic of &#8220;orthagonal perfect quenched resonantors&#8221; to get exceptional discrimination and thus very very narrow bandwidth and very good performance. I was activly involved in designing a very low cost version of a Piccolo system ( <a href="http://www.dtic.mil/cgi-bin/GetTRDoc?AD=ADA215692" rel="nofollow ugc">http://www.dtic.mil/cgi-bin/GetTRDoc?AD=ADA215692</a> ) to be much smaller and very much lighter than the then &#8220;Kaynard&#8221; LA1117 system from RACAL (sadly little or nothing of it remains now as it was a very clever design based around an 8bit processor and a handfull of other components).</p>
<p>The advantage of the more complex systems such as Piccolo is that they can be fully automated and used by &#8220;stay behind&#8221; teams and with more modern designs used by behind lines &#8220;bricks&#8221; of advanced/forward troops. This advantage is that they work very well with HF condittions and very very low RF power and fairly short transmission times, thus making them very very difficult to DF. I remember one series of tests pulled very reliable comms from a skywave using around 5 watts from the &#8220;brick&#8221; end which was around about a quater of the way around the world.</p>
<p>Getting back to the traditional number stations they are extreamly simple just a &#8220;plate modulated&#8221; class C output stage and a tape recorder will do. This is something a 14 year old can do, as it only requires the knowledge you can get from any one of several hundred &#8220;amateur radio&#8221; constructor books. And I do know that in the late 70&#8217;s a couple of tenagers did just that and set upt their own number station just to poke a bit of fun at the &#8220;number hunters&#8221;, when they weren&#8217;t using the transmitter for &#8220;Pirate Radio&#8221; at the weekends&#8230;</p>
<p>Any way it would appear that number stations are still up and running and perhaps surprisingly on the increase in recent times. Which if they are being used for &#8220;agents&#8221; might suggest that old school espionage is on the rise&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180564">

			<div class="comment by-david ">

				<p class="commentcredit">

					<span class="commenter">David</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180564">
						June 10, 2012 6:40 AM					</a>

				</p>

				<p>@Clive Robinson&#8230;</p>
<p><i>in the late 70&#8217;s a couple of tenagers did just that and set up their own number station just to poke a bit of fun at the &#8220;number hunters&#8221; </i></p>
<p>so, who was the other teenager?  ~grin~</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180565">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180565">
						June 10, 2012 12:56 PM					</a>

				</p>

				<p>@ Joe Loughry,</p>
<p>I think they are realy nice photos, I might just blow one or two up to &#8220;poster&#8221; size and hang them on the walls.</p>
<p>With regards,</p>
<p><i>Permanent inhabitants of the space station exist in a high radiation environment.</i></p>
<p>This is my second post that is going to involve Chernobal&#8230; Up above I mention the Russian &#8220;Woodpecker&#8221; the transmitter and antenna array are in it&#8217;s &#8220;exclusion zone&#8221; but people still visit for the photos and to actually use the antenna&#8230;</p>
<p>The funny thing about the exclusion zone is contrary to expectations the wild life is healthy and thriving even though the backround radiation levels suggest they should have been effected considerably.</p>
<p>Likewise the &#8220;moon walkers&#8221; are doing better than you might expect on average.</p>
<p>So some are thinking perhaps radiation in it&#8217;s various ionizing forms at lower levels might actually be healthy as opossed to the original &#8220;dangerous at any level&#8221; thinking.</p>
<p>On another subject I note from your home page that Andrew Martin is your advisor. He and I have similar interests, which reminds me,</p>
<p>@ Wael, Nick P,</p>
<p>You might find the following of interest,</p>
<p><a href="http://www.cs.ox.ac.uk/files/1873/RR-08-11.PDF" rel="nofollow ugc">http://www.cs.ox.ac.uk/files/1873/RR-08-11.PDF</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180566">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180566">
						June 10, 2012 1:58 PM					</a>

				</p>

				<p>@ Clive Robinson, Nick P</p>
<p>&#8220;http://www.cs.ox.ac.uk/files/1873/RR-08-11.PDF&#8221; Was of intrest to me at one point, and still is. I was a participating member in the TCPA steering committee, and later TCG. Stay tuned&#8230; Organizing and proof-reading my next post&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180567">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180567">
						June 10, 2012 3:47 PM					</a>

				</p>

				<p>@ Clive Robinson and Nick P,</p>
<p>This is why I was interested in the “castle-v-prison” model and discussion: Long post alert!</p>
<p>Quick background:<br />
A few years ago, I was working on a definition of security. I did not like the Confidentiality / Integrity / Availability / (Accountability) definition. Was too abstract, and only partially applied to information security (don&#8217;t ask me why). It did not easily apply to general security. Still, that definition did not help quantify the security level of the object under investigation – That was my thinking then. My thinking now is “Security” is still a fuzzy term that cannot be quantified for a system (Algorithms are exempted).  That is a different discussion, however…</p>
<p>Came up with this definition:<br />
<b>“Security”</b> is <i>“The painless ability to protect the asset through complete awareness and total assured control by the owner of the asset.”</i></p>
<p>I guess you can already see where the castle and prison may fit.</p>
<p>A brief explanation:<br />
<i>Painless</i>: Users’ perspective: If it’s too painful, users will elect to bypass it. Other perspectives were skipped. Pain could also refer to the amount of money and resources spent to “Secure” an asset. It could also refer to “Usability”, which also implies Usability-v-Security tradeoff.</p>
<p><i>Ability</i>: Is a successful defense against an attack (or all attacks) a necessary condition to claim a device to be “secure”? Ignore “sufficient” for now.<br />
Example: A person is about to go on a trip to the jungle. He asks for someone to protect him from the dangers their. They tell him take this rifle with you, the only threats you will face are lions. He takes the gun and goes on the trip. The question is:<br />
Does the lion have to attack that person and the person comes back unharmed after using the gun to claim security, or was it sufficient that he had the ability to protect himself? The assumption is that we know that guns are effective against lions. That’s why “Ability” was used.</p>
<p><i>Protect</i>: Had a problem with this one – sounds like circular definition because “protect” is related to safety and “security”, it could even be a synonym in some languages – as some have indicated in previous posts. For the sake of the definition, protect means the dictionary definition or basically deflecting or defending against harm. Harm is any threat &#8211; independent of known or unknown &#8211; which will be covered in <i>Awareness</i>. Linearity and superposition at work here 😉</p>
<p><i>Asset</i>: The object to be protected &#8211; Could be a physical device, an operating system, a keystroke, the whole network infrastructure, or just some information residing on a device.</p>
<p><i>Complete awareness</i>: This is necessary. We cannot protect against some unknown threat. “Known unknowns”, or “Unknown unknowns” (that seems redundant to me, Mr. Robinson.) Obviously complete awareness is elusive, and we can only aspire to achieve that, but no one can claim they have exhausted enumerating all threats. In the example above, if the person going on a trip falls in quicksand and croaks. What was the reason? The rifle did not help him! It’s the lack of awareness (analogous to a 0-day vulnerability) that got him.</p>
<p><i>Total assured Control</i>: Control, with feedback that the control mechanism has been applied successfully. Cryptography can be the method of assurance here (challenge response.). And after your last post, Clive, this implies “Trusted Computing”.  “Assured” also implies accountability, logging mechanisms, etc.<br />
Example: A mobile phone is lost, and a remote command is issued to it to erase data. We know the command was issued, but to be sure, we need to get some feedback from the device that the command was executed successfully. This feedback should be immune from various attacks (replay, cut and paste, DoS, etc. …). Otherwise we can only claim that a command has been issued, but we are not sure if it was executed, in which “security” degenerates to a “best effort” approach.</p>
<p><i>By the owner of the asset</i>: To protect against “role misappropriation” type vulnerabilities. Who is the owner? There could be many owners for, say, a cell phone &#8211; with different and sometimes overlapping and / or conflicting concerns: <cite><br />
1-  Manufacturer of the chip set: Concerns may include bad reputation or lawsuits<br />
2-  Content providers: Movies, eBooks, music, etc.… They want to be compensated for their product, and not lose revenue to piracy (DRM related)<br />
3-  Carriers: They don’t want to lose subsidization money, phone cloning, billing fraud, etc. …<br />
4-  OS providers: Overlapping concerns as chip manufacturers, more or less…<br />
5-  End users: The human beings that purchased the device, they care about privacy (private files, GPS privacy, browsing habits, call privacy, texting privacy, identity theft, billing fraud as well (900 numbers in the US for example), physical device security, etc. …<br />
6-  OEM: Reputation, law suites, bad relations with the other owners and lost business opportunities.<br />
7-  Enterprises: They want to be able to enforce IT policies.<br />
8-  Governments: Who knows what they want …<br />
9-  Enemies: are not an owner per se, but they have concerns (Subversion)</p>
<p>So why by the owner? The one who is most interested in the asset should protect it; the one who is legally liable should protect it. The one who actually owns the asset should take the responsibility of protecting the asset. The owner should not delegate the protection of an asset to someone else (non owner). This has caused some security breaches in the past. Examples omitted for the sake of brevity.</p>
<p>From the above definition, absolute security is not possible for two reasons:</p>
<p>1-  </cite><cite>No one has complete awareness of the threats</cite><br />
2-  <cite>No one has total control (let alone assured) – subversion is a possibility as well here. </cite> (Nick P: hint-hint, wink-wink)</p>
<p>So this is where the Castle-v-prison comes to play!<br />
For example, to mask the holes (known unknowns, or unknown unknowns) in an Operating system, one can put that OS on top of higher assurance Hypervisor or Micro-visor (OKL4, which claims to have proven to be 100% bug free, and achieved EAL7). The hypervisor gives the control (to compensate for the lack of awareness of the vulnerabilities of the OS). Hypervisors are smaller, and easier to evaluate that a full Operating system.</p>
<p>It’s no longer (in my opinion) a “castle-v-prison problem”, but a set of prisons within the castle. With different levels: Jails (Think FreeBSD style jails), prisons, and maximum Security cells (No quotation marks for security, because this is the real world “prison security level” nomenclature). These cells can be allocated to high value assets.</p>
<p>Prisons are a model of sandboxes, Virtual Machines, or Appliances (applications running directly on top of a hypervisor without an OS), or full applications / OSs running in a trusted world (Trust zone). The could be the “enclosure” or system that protects some assets. It could be modeled as the hardware and the mechanisms to protect against entry into the castle; Firewalls (moats), etc.…</p>
<p>Regarding Trust, it is also an overloaded term. Some use it interchangeably with “Secure”. Trust does not imply goodness (TCG point of view). Trust simply means that you have high confidence believing the reported state. Example: I trust that a doctor will help me (a psychiatrist for some spammers, a veterinarian for some trolls), as much as I trust that a thief will mug me – this is behavioral trust. So trusted booting has a completely different meaning than secure booting. All Trusted boot mechanisms are secure by default, but not all secure boots are trusted. Trusted means a device can attest or prove to a challenger that it is in a certain state. The challenger has the ability to (cryptographically) verify that state, and consequently trust it and act accordingly. Secure boot normally means that the boot image can not be tampered with (Immutable Boot block, Firmware, boot loader, etc. …); It can only be updated by the manufacturer, OEM, OS vendor (one of the identified owners). It also means that an end user cannot just boot any image they want (low level images, for example modem image on a cell phone). This implies digital signatures …</p>
<p>To evaluate the security of the device, you look at all those elements and judge.<br />
During a design stage, one will keep the owners in mind, and make it easy for them to “secure” the device (or assets they care about). Simplicity is also good. Complexity and security are not a good mix – That is one reason I had some questions about what Clive meant by “security-v-efficiency”. Efficiency can also be an efficiency of design – but I guess we ironed that one out.</p>
<p>Is it evident from the Confidentiality/Integrity/Availability definition that 100% security is not achievable? That definition is adapted to help in Threat analysis, but not so much in design. AND the “castle-v-prison” does not jump out of the definition either ☺</p>
<p>That summarizes my interest in the model you guys came up with, although I <i>maybe</i> using your model from a different perspective ☺</p>
<p>I was tempted to talk more about who is in the Castle and their roles (IT guys are guards, security guards at the door (modeling authentication and sometimes authorization), Sharks and crocodiles swimming in the moat, and sometimes jumping to other castles’ moats to bite their counter parts (modeling attorneys),<br />
Clive Robinson studying the composition of the castle bricks, and the electromagnetic properties of the building materials (CPUs, threads, RF bitflip mechanisms, …) Mr. Schneier sitting in a blimp up their watching the castles around the world, and giving them advise, and sometimes enjoying movies at “Security Theaters” near you ☺</p>
<p>Just for *hits and giggles, apply the above definition to the TSA:<br />
Painless: Nope, extremely painful for some passengers. Some of them avoid air travel, because of the pain they have to go through. Also pain here means a lot of money is spent (wasted?)<br />
Awareness? Nope! They (TSA) are only aware of security levels: Yellow, Orange, and Red. They, however, compensate for that impediment by being colorblind too ☺<br />
Control? Trying to, but they do have a lot of control – I give them that!<br />
Owner? Nope, the “real owners” delegate the task to a group of poorly trained consultants (TSA). “Owners” here is debatable.<br />
Ability? Nope – News of many overlooked breaches (guns going through, etc.)<br />
Assured? Nope<br />
Secure? You tell me!</p>
<p>Appling the CIA (Confidentiality, Integrity, Availability) definition of security does not really help in the TSA example.</p>
<p>The definition move can be applied to all the layers of the system (HW, FW, Microcode, and up the stack(s) ), I would think &#8230;</p>
<p>Tag! You&#8217;re it 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180568">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180568">
						June 10, 2012 4:22 PM					</a>

				</p>

				<p>Never fails!</p>
<p>&#8220;as much as I trust that a thief will mug me – this is behavioral trust.&#8221;</p>
<p>should be:<br />
as much as I trust that a thief will mug me – this is social trust.&#8221;, and TCG is about behavioral trust.</p>
<p>&#8220;The could be the “enclosure” or system that protects some assets.&#8221;</p>
<p>Should say:<br />
&#8221; The castle could be the “enclosure” or system that protects some assets.</p>
<p>&#8220;The definition move can be applied to all the layers&#8221;</p>
<p>Should say:<br />
&#8220;The definition above can be applied to all the layers&#8221;</p>
<p>&#8220;I was tempted to talk more about ..&#8221;<br />
Actually slipped &#8211; was not supposed to be there <em>blush</em></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180569">

			<div class="comment by-kashmarek ">

				<p class="commentcredit">

					<span class="commenter">kashmarek</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180569">
						June 10, 2012 6:29 PM					</a>

				</p>

				<p>More FUD from the duds:</p>
<p><a href="http://hardware.slashdot.org/story/12/06/10/1838212/kinect-you-are-the-controlled" rel="nofollow ugc">http://hardware.slashdot.org/story/12/06/10/1838212/kinect-you-are-the-controlled</a></p>
<p>which is about serving ads based on emotion (and who has time to watch ads while using Kinect?)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180570">

			<div class="comment by-pentester ">

				<p class="commentcredit">

					<span class="commenter">PenTester</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180570">
						June 11, 2012 9:31 AM					</a>

				</p>

				<p>@Clive Thank you for those really awesome ISS pictures.</p>
<p>I LOLed at the spy number database site. They have amazon adverts, first item on display: Tinfoil.</p>
<p>Another thing why those stations are still around and very active. Nothing is more suspicious and interesting as a station that suddenly starts transmitting out of the blue or changing its transmission habits, schedule, format, frequency, etc. Very likely, that most of them are just there for the fact that they are there and are just transmitting rubbish for the time being.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180571">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180571">
						June 11, 2012 1:56 PM					</a>

				</p>

				<p>Interesting definitions and stuff. I&#8217;ll critique the parts that seem relevant. First, the TPM has to go or be changed.</p>
<p>I have real concerns about TPM&#8217;s. The link Clive posted mentioned three good counterarguments against them: vendor lock in, DRM &amp; large number of configurations measured. The first is enough reason to avoid purchasing any TPM&#8217;enabled device. Major vendors, including big time TPM pushers like Microsoft, have a long track record trying to put obstacles between their customers and any competing product. It&#8217;s a form of centralized control of people&#8217;s devices that sends profit in the direction of the controllers.</p>
<p>Recently, Microsoft showed this again with Win8 ARM devices needed firmware-enabled signing ability. Customers options: trusted boot with MS-signed software or no trusted boot at all. And pay extra for their choice of OS. Missing 3rd option: set your own public signature verification key &amp; boot what YOU (or your organization) trust. My designs allow for this. It should be the default. Not in TPM&#8217;s alliance interests.</p>
<p>Second counter is DRM. Both the methods employed for it &amp; the uses for it show the industries promoting DRM are quite shady. In the past, we&#8217;ve seen these industries trying to force people into proprietary DRM-ed formats whereby they need to buy an extra copy to use the content on different devices. We see something similar in the siloization of the web. DRM locks things down &amp; hampers innovation, much like patents. Let&#8217;s not give them better methods.</p>
<p>The third issue is more technical. The paper mentioned that a device&#8217;s configuration might have a huge number of possible measured values. This depends on is usage, patching strategy, &amp; even customization by software. The TPM&#8217;s strategy doesn&#8217;t seem efficient for the job. In my designs, there&#8217;s a certain amount of abstraction so that each level in the system is responsible for updating, verifying or re-hashing its own layer&#8217;s components. Each layer is handled separately, as well. There&#8217;s other possible variations that beat out the TPM.</p>
<p>&#8220;This is necessary. We cannot protect against some unknown threat. &#8221;</p>
<p>Not necessarily true. Compete mediation, good design &amp; good security policy means anything subject to it can be compromised in an unlimited number of ways &amp; still not break security policy. This is an explicit goal of systems heading toward EAL6/7. Every (or almost) non-covert channel application attack discovered since GEMSOS was certified A1 (eal7-equiv) in the 90&#8217;s would have failed to violate its main security policy. That was the point of using these methods. A number of modern approaches are explicitly designed to defeat 0-days in certain parts of the security.</p>
<p>&#8220;Control, with feedback that the control mechanism has been applied successfully. Cryptography can be the method of assurance here (challenge response.).&#8221;</p>
<p>Total assured control requires that the TCBs of the host &amp; server are untampered with, that they&#8217;re implemented correctly, that their comms stacks can&#8217;t subvert the process, and that the protocol works as advertised against sophisticated attackers. Cryptography is usually only a tiny part of the security of any real system. In fact, I rarely think about it at all, even in crypto appliances. (Hint: total assured control of anything is all about ensuring correct information flows &amp; transformations.)</p>
<p>Good thought on owner having responsibility to protect things. Problem comes with the fact that there are often people who compete to be in control of the information, with their own justifications. As in DRM example, there was the owner (copyright holder) using the obscure format to limit the song to the device &amp; the user believing they should be allowed to play content they purchase on whatever device they&#8217;re carrying (standard up to that point). Who is right? It&#8217;s philosophy and law. However, enforcement is owner&#8217;s responsibility.</p>
<p>&#8220;So this is where the Castle-v-prison comes to play!<br />
For example, to mask the holes (known unknowns, or unknown unknowns) in an Operating system, one can put that OS on top of higher assurance Hypervisor or Micro-visor (OKL4, which claims to have proven to be 100% bug free, and achieved EAL7). The hypervisor gives the control (to compensate for the lack of awareness of the vulnerabilities of the OS). Hypervisors are smaller, and easier to evaluate that a full Operating system.&#8221;</p>
<p>The funny thing is that they&#8217;re reinventing the old Orange Book security kernels. The point of a security kernel was that it could cover holes in all application &amp; OS functionality. It would be the lowest software layer. It was also small enough to evaluate. (Sound familiar? 😉 That failed for a number of reasons in the general case &amp; succeeded in other cases.. Btw, OKL4 isn&#8217;t EAL7 or bug free: the <i>seL4/OKL4Verified</i> version has EAL7+-equiv software correctness proofs (just one EAL7 requirement) and we never claim bug-free of anything.</p>
<p>I think it would have helped you if Clive explained his castle and prison analogy better. (or it be easier to understand for newcomers haha) You&#8217;re thinking of an actual prison cell &amp; how it&#8217;s isolated. Clive uses it b/c of prison guars &amp; the warden. His idea is that the system will have tons of very simple processing elements with limited hardware access. They can have program/data inserted in, turned on, run fine grained functions, &amp; be suspended at any time to check for &#8220;signatures&#8221; of foul-play going on.</p>
<p>You were also thinking of an actual castle, whereas Clive mainly uses the term as &#8220;impenetrable fortress&#8221; or &#8220;weathers all conditions.&#8221; My castle approach is about prevention. It&#8217;s the previous standard in INFOSEC. (Current one is non-INFOSEC 8). The castle starts at its foundations. It&#8217;s built ground up to resist problems. Each layer has a rigorously analysed specification &amp; an implementation that provably corresponds to it. Any safe implementation principles are applied where they can &amp; pen testing is used. Upper layers use the functionality of lower ones via carefully constructed interfaces. Any looping between layers is nonexistent or minimized. Applications have minimal privileges &amp; can only ask for things to be done. Like GEMSOS &amp; Smith&#8217;s LOCK, it&#8217;s built with the best assurance techniques possible to achieve what it must achieve.</p>
<p>(Papers on LOCK are available at cryptosmith.com. For GEMSOS, look up Final evaluation report Gemini Trusted network processor. Focus on design and assurance sections for GEMSOS security kernel.)</p>
<p>Recently, as insecure COTS is inevitable, I&#8217;ve switched to a hybrid that&#8217;s similar to his approach, but castles up wherever appropriate. I try to lock in anything security critical into some small part of the system, then do any extra assurance there, ignoring or selectively monitoring the rest. So, if it fails, only availibility hurts.</p>
<p>I&#8217;ll let you rethink it in light of this information. The links I sent you before, maybe plus GEMSOS/LOCK, are critical in understanding discussions of <em>truly</em> secure systems. You might also want to Google Cygnacom&#8217;s Evaluated Assurance Levels description, focusing on what makes EAL5-7 different from the rest.</p>
<p>(Btw: I&#8217;d appreciate if you&#8217;d never use TSA in an analogy for security again. They are the most hated example of security theater in existence &amp; a distraction from all things good.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180572">

			<div class="comment by-phred14 ">

				<p class="commentcredit">

					<span class="commenter">phred14</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180572">
						June 11, 2012 3:06 PM					</a>

				</p>

				<p>I traveled by air last week, and a few fun observations&#8230;</p>
<ul>
<li>I learned hear that the tall cylindrical scanners that rotate are not the backscatter x-ray units, here on this list.  Thank you very much.  They are currently installed here in Burlington, Vt and in Grand Junction, Co.</li>
<li>I&#8217;m tall, and they had me hold my hands over my head with my boarding pass in them.  Turns out I held them too high, and when I came out, they wanted to pat my hair, and asked me to hold out my hands for visual inspection.</li>
<li>At the Grand Jct airport, they pulled my daughter&#8217;s backpack aside, because the scanner had &#8220;identified a bottle of Gatorade&#8221;.  They didn&#8217;t say &#8220;something suspicious&#8221;, they said, &#8220;Gatorade&#8221;.  The false-color scanner photo had a bottle in a rectangular outline.  My daughter didn&#8217;t have a bottle of Gatorade in there.  What&#8217;s worse, it was obvious from the rest of the picture that they had pulled the wrong backpack.  The overall outline looked nothing like hers.  She was upset because they pulled everything out, and repacked it wrong.</li>
<li>Speaking of the false-color scans, what are they using to do the colorization?  I presume it must begin live as a standard B&amp;W x-ray.</li>
<li>
<p>In Newark, NJ, if you go in through the A terminal, there is no full-body scanner.  I presume there is one over at the C terminal.  The A terminal is for &#8220;express jets&#8221; and the C terminal is for the big guys.  There is a shuttle bus running between A and C terminals.  I guess the people at each security line do look at your boarding pass, so it probably isn&#8217;t a simple as going to the A security line with your C boarding pass.  But I&#8217;m sure it&#8217;s an exploitable hole.</p>
</li>
</ul>
<p>Nothing major here, just a little amusement.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180574">

			<div class="comment by-a ">

				<p class="commentcredit">

					<span class="commenter">a</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180574">
						June 11, 2012 3:31 PM					</a>

				</p>

				<p>@Owen: Against what well accepted definition of terrorism do you make that claim?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180575">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180575">
						June 12, 2012 1:52 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>Thanks for the feedback. I don&#8217;t have the stamina tonight to talk about everything. What I can do is start with the easy things.</p>
<ul>
<li>TPM, TCG: One should go to the specs directly rather than quote a paper. We can pick up this discussion later, and I hope it will be short. TPMs by the way were meant for opt-in. How someone uses the TPM does not necessarily mean TPMs were designed for that purpose.</li>
<li>As a courtesy to you, I will not talk about TSA again. But Please don&#8217;t limit what I can or can not talk about in the future. I will however abide by what the moderator requests.</li>
<li>I understood the castle-v-prison from the posts I have read (warden, guards, and all &#8211; I did read the links). I stated that I have used your model from a different perspective, but will elaborate later on that later.</li>
</ul>
<p>I propose we take it a step at a time, if you are okay with that rather than address everything in one post. What do you think? Hopefully Clive Robinson is not upset with me, and understands my sense of humor.</p>
<p>Speaking of TSA&#8230;<br />
Just kidding 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180576">

			<div class="comment by-roel-spilker ">

				<p class="commentcredit">

					<span class="commenter">Roel Spilker</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180576">
						June 12, 2012 8:19 AM					</a>

				</p>

				<p><a href="http://www.ted.com/talks/david_birch_identity_without_a_name.html" rel="nofollow ugc">http://www.ted.com/talks/david_birch_identity_without_a_name.html</a></p>
<p>Nice talk about how identity and authorization should be decoupled:</p>
<p>&#8220;There is no earthly reason why your name is printed on your chip-and-PIN card.&#8221; &#8230; &#8220;The only people that benefit from having the name on the card are criminals. You know what your name is, right?&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180577">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180577">
						June 12, 2012 10:05 AM					</a>

				</p>

				<p>@ Wael,</p>
<p><i>What I can do i start with the easy things.</i></p>
<p>Sadly that&#8217;s the wrong place to start&#8230;</p>
<p>I know Nick P did not originaly agree with me but I think RobertT and myself have ground him down a bit.</p>
<p>The first thing you have to consider is &#8220;trust&#8221; and that it does not exist and more importantly why. If you don&#8217;t then you are &#8220;building your house on foundations of sand&#8221;&#8230;</p>
<p>Back in the 1930&#8217;s Kurt Godel can up with an unfortunate truth which along with Turings later work shows that what we regards as &#8220;trust&#8221; (ie that a system that has and currently does behave in a particular way will carry on doing so in the future) is a mear illusion.</p>
<p>The reasons for this are complex but without going into them a good starting point is,</p>
<p>1, No system can be trusted irespective of past behaviour.</p>
<p>There is however another outcome of Godel&#8217;s work, that can be put as,</p>
<p>2, No sufficiently complex locig system can prove it&#8217;s self.</p>
<p>Further there is a human issue, that few if any programers can actually write secure code at any level&#8230;</p>
<p>Getting back to &#8220;Castles-v-Prisons&#8221; from the outside they are both the same, that is they are a fortified or hardend structure designed not to be easily breached from the outside.</p>
<p>On the inside however they are very different. In a castle it is generally assumed tha &#8220;all insiders are trustworthy&#8221; but the oposit assuption applies to prisons.</p>
<p>This has further implications in that in a castle the command structure is also assumed to be trusted, however in a prison only the upper layers (Warden and warders) are trusted the low layers of &#8220;trustees&#8221; (prisoners who have earned privileges and limited authority over prisoners) are not trusted and continuously &#8220;measured&#8221;.</p>
<p>Now if you look at the silicon area on some modern CPU&#8217;s it&#8217;s vast, and the same area can hold upwards of 1000 very basic RISC style CPU&#8217;s</p>
<p>If you put an MMU between each CPU and the main busses going off to memory and I/O the CPU can be effectivly issolated. Now think what you can do by putting the MMU not under the control of the CPU but a hypervisor&#8230; You can then make the CPU effectivly blind as well.</p>
<p>One. asspect of this is that the CPU is also effectivly imprisoned. The hypervissor only gives it sufficient memory to carry out it&#8217;s execution thread and no more. Further it read/writes to buffers not memory or devices. It means that it actually does not require an operating system just a very very simple interface equivalent to a very striped down API all of which is unprivaledged and requires just a few bytes to implement (I&#8217;ve got one which is just a couple of hundred bytes and that&#8217;s still bloated). This API effectivly talks to the Hypervisor.</p>
<p>Now because you have so many CPU&#8217;s you could effectivly have each one running an independent thread of a task. The more you strip the fat of each thread the clearer a signiture it will have and the easier it is for a hypervisor to check.</p>
<p>As Nick mentioned above the CPU&#8217;s do not load their execution code into memor</p>
<p>$$$</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180578">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180578">
						June 12, 2012 1:26 PM					</a>

				</p>

				<p>@ wael</p>
<p>TPM specs. Yeah, well theres theory and practice. The main people pushing it are lockin loving vendors, pro DRM types, and the NSA, which has always undermined/restricted true secure systems in favor of vulnerable systems. Most likely, the group is doing a fait accompli strategy.</p>
<p>Say a group has an ominous plan to control anothers assets for their own selfish purposes. They cant just release version 1 of Total Govt and Corporate Control for x86. People resist, like Clipper. Fait accompli breaks main goal into pieces separated over time, each with a legit sounding and independent justification. After each passes.and chips widespread, protests are too late. Most likely whats going on. Theory! = practice.</p>
<p>Glad you are getting the castles and prisons thing but may i suggest u forget the castle analogy? Clives recent post shows its relevance is straining. Just go with ur mental model of what was in the links i gave u on security kernels, assurance techniques, etc. His prison analogy is fine for his stuff, though.</p>
<p>Re TSA dont take such statements too seriously  formally whatever.  Im not a Mod and pro free speech. The TSA is just such a clear example of security theater and beauracracy gone wrong that it has earned constant hate and ridicule here. The only way they tie into security is an example of doing it horribly wrong. You can say whatever u want it&#8217;s just that those letters can cause instant negativity among some.</p>
<p>And Clive definitely wont be offended by anything u say unless you&#8217;re trying to insult him. This blog&#8217;s readers are quite diverse but the regulars are laid back about things. We just come to share knowledge and have good discussions. We also shun Slashdot types 😉</p>
<p>Btw, one step at a time is fine. My post&#8217;s size or complexity is a habit from talking to Clive. He rubbed off on me or something haha.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180579">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180579">
						June 12, 2012 1:34 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>I suggested Wael drop the castle part of ur analogy bc i think it&#8217;s straining to fit. For instance, the description you give might imply there is much trusted code inside in the sense people normally think about it. However, the security kernels and other high assurance systems were requirrd to be internally structured so that models and source-level analysis could show higher lvl layers cant abuse lower ones. Then there were integrity controls or capabilities (keykos).</p>
<p>So, this approach proved safe if the developers used correct layering and modeling. They got plenty good at that. The VAX Security Kernel Retrospective is a good read on those things. So, not quite as much POLA as yours, but the trustef aspects are quite restricted anyway.</p>
<p>If you really want prisons, its time you downloaded those TIARA and SAFE (or SAFER?) architecture papers. They aim to use taggef architectures to assure security at the word and function levels.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180580">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180580">
						June 12, 2012 9:49 PM					</a>

				</p>

				<p>@wael</p>
<p>I don&#8217;t really have time for this right now, so I&#8217;ll be very brief.</p>
<p>Assurance must start at the most basic level (atomic / material physics) and build upon successive layers of trust, whenever that chain of trust is compromised there is a chance of a security compromise.</p>
<p>Clive is suggesting a Hypervisor overseeing 1000&#8217;s of cpu&#8217;s because these CPU&#8217;s can be kept so simple that their complete functional space can be effectively mapped. I&#8217;ve actually played around with a more complex version of Clive&#8217;s simple CPU with hypervisor model to add program encryption and data encryption (I&#8217;m assuming Harvard arch)</p>
<p>The Hypervisor controls the program decryption map which changes dynamically. I also devote certain CPU&#8217;s to the task of dynamically encrypting the programs for critical control and data calculation stream CPU&#8217;s. The reasons for this is to not only defeat any form of code injection but to also prevent any useful side channel information leakage, even assuming the attacker has physical possession of the system.</p>
<p>The way each hypervisor works and which cpu&#8217;s are assigned secure tasks is determined by a random number sequence generated at power-up.</p>
<p>This is intended to prevent someone modifying one or more critical CPU&#8217;s to extract information.</p>
<p>Upon this CPU beast one needs to build a model of trusted computing high assurance kernels, however this task is relatively simple if the CPU&#8217;s are not multitasking  and largely operate completely within there own dedicated RAM space. All MMU external / shared memory accesses use encrypted data.</p>
<p>Part of the problem, that Nick P alludes to  is that most interested parties don&#8217;t want high assurance computing released to the public, these concepts are not even remotely new, the last operational VAX that I saw was in 1988&#8230;..</p>
<p>Anyway, got to go</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180581">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180581">
						June 13, 2012 2:01 AM					</a>

				</p>

				<p>@ RobertT</p>
<p>Thanks! That explains a lot. I still have some homework to do (links from Clive Robinson and Nick P) before I come back to this thread again.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180582">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180582">
						June 13, 2012 2:07 AM					</a>

				</p>

				<p>@ Clive Robinson and Nick P</p>
<p>I got immersed reading Kurt Godel&#8217;s work which I never heard of before. I am not comfortable reading his stuff, but still reading it.</p>
<p>I will leave TPM out for now, too many branches in this discussion&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180583">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180583">
						June 13, 2012 2:21 AM					</a>

				</p>

				<p>@ RobertT</p>
<p>Here is a suggestion for your random number generator:</p>
<p>int  getTrueRandomNumber()<br />
{<br />
    // This function returns a true random number</p>
<pre><code>return 4;  // the number 4 is random. It was
               // found by throwing dice
</code></pre>
<p>}</p>
<p>This &#8220;program&#8221; was pinned on a previous collegue&#8217;s office door. I would like to give him credit but don&#8217;t want to reveal his name and invade his privacy.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180585">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180585">
						June 13, 2012 4:00 AM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>Quick question:<br />
&#8221; Further it read/writes to buffers not memory or devices.&#8221;</p>
<p>What is &#8220;buffers&#8221; here if it is neither memory nor devices? CPU memory? Registers?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180586">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180586">
						June 13, 2012 11:43 AM					</a>

				</p>

				<p>@ Wael, Nick P, RobertT,</p>
<p>First of my appologies for being quiet, I&#8217;m not well yet again (no surprises there)</p>
<p>And if you don&#8217;t know UK hospitals, your choice of bed is &#8220;dictated&#8221; by nurses and thus you several times more likely to be by the door than the window, so very poor MobPhn signal 🙁 worse some hospitals have policies to force you to use the 10USD a day &#8220;personal entertainment&#8221; system which I refuse to do as the company that runs it not only sstings you for money they also sell your data on to other parties&#8230;</p>
<p>Wael, sorry I didn&#8217;t finish my previous post I had to &#8220;be seen&#8221; and got dragged into the very depth and guts of the building through doors marked &#8220;No Exit&#8221; which is always cheary not 😉</p>
<p>Any way RobertT provided a better finish than I did 🙂</p>
<p>With regards the buffers there are a couple of ways to do them one being hardware FIFO&#8217;s, another being a memory region controlled by the hypervisor such that it is either read or write and a pointer and indicator to indicate when full. You can likewise use a read only or write only stack. The point is it is one way. The CPU writes to it and the hypervisor or other CPU reads from it. To help reduce covert channels the size of the buffer is &#8220;changed&#8221; every so often asymetricaly to the two CPU&#8217;s.</p>
<p>I think I had better explain a little more about the Castle view. Most modern CPU&#8217;s are far from light weight and most are actually Harvard architectures for efficiency reasons with the two busses getting joined together shortly before leaving the CPU for the various &#8220;memory caches (ie after the seperate instruction and data caches) etc. Such designs have so many &#8220;step level&#8221; dependancies that they will be virtually impossible to analyse for security (for instance modern caches leak more information than most people can imagine over and above the well known &#8220;timing attacks&#8221;&#8230; Thus a modern CPU like the IAx86 family most ARM, PowerPC etc have way way to many little nooks&amp;crannies to hide/pass/ communicate data that a hypervisor has absolutly no chance of recognising let alone mittigating&#8230; Thus they are like a castle in that most of those within have fairly free run of the place and don&#8217;t get heavily checked or supervised as it&#8217;s not possible to do so. So even with Nick P&#8217;s suggested ways of doing things there is still the odd &#8220;eye in the needle&#8221; that can pass not just a camels but an entire cities trade&#8230; BUT before I go further I will say that what Nick suggests is currently the only way to go unless you can cut your own sillicon and will get you 99.9999% of the way there, but each additional 9 is going to cost you very dear exponentialy. When you can cut your own silicon you can create lots of little prisons where there is no place or space to hide things and thus the hypervisor can check then in just a few CPU cycles.</p>
<p>As RobertT notes security starts with the physics and works upwards. However as long as you stick with a simple state machine where every state is known and dealt with appropriately, you can continue to assure your security. However as you get closer to a Turing Machine things become more and more problematic as the number of states rise to some power law of an exponential rise (simple logic with a single bit output rises at 2^(2^N) of inputs and any feedback or storage at the very least adds to N linearly but usually as some power&#8230; of the bits involved).</p>
<p>Put overly simply Kurt Godel showed that once a system of logic (not logic system 😉 gets beyond a very very simple state it cannot prove it&#8217;s self and when you work this over with the work of Turing you will realise that no single &#8220;Turing engine&#8221; can check it&#8217;s self to be secure&#8230;</p>
<p>Once you accept that as an idea it stops you chasing up a lot of blind alleys looking to find solutions that cannot actually exist.</p>
<p>So what to do&#8230;</p>
<p>Well when you accept the notion that you cannot get 100% or worse even 99% security without increasing cost and complexity (which always works in the attackers favour) you start thinking</p>
<p><i>Keep it, simple, keep it small, and look hard</i></p>
<p>Now the first two parts are relativly easy it&#8217;s the looking that&#8217;s hard to do. One of the first rules of secure hardware design is &#8220;segregation&#8221; that is you put individual functions in their own seperate hardware and then you heavily monitor the states and information on the inputs and the outputs.</p>
<p>One of the failings of nearly all modern software is it is so complex it is virtually impossible to debug, let alone check for security after the fact (it&#8217;s why I say security has to be built in before the product is even thought of which makes it kin of a qualitty process). Further as a percentage of the code cutters in the world the number who are truly engineers and can further design securely is so small as to be vanishingly small (even security experts often cannot code securely). They are certainly less than 1 in a Million. Further it&#8217;s not possible to train even a small fraction of code cutters to code securely in anything like a reasonable time.</p>
<p>So how to get secure software without the pain?</p>
<p>Well one way is to &#8220;follow the *nix prototyping path&#8221;. In shell programing the shell provides a simple framework into which you drop little tasklets that do specific jobs. You can very quickly build a working prototype of a program without cutting a single line of C or other &#8220;programing&#8221; language and usually it is fairly secure because of coding to the pipeline API. The disadvantage is it&#8217;s slow due to all the task switching.</p>
<p>Now imagine if you will that the shell has two parts, the first being the traditional shell programing interface, the second being a hypervisor. Each tasklet is written not only to be secure but also to interface with the hypervisor doing amongst other things signiture checking of the tasklet, and giving it the absolute minimum of resources to run.</p>
<p>A programer builds their &#8220;shell code&#8221; in the usual way and the tool chain then sets the security parameters for the tasklet for the hypervisor.</p>
<p>This sort of system alows software to still be written but at a much higher level from &#8220;know to be secure&#8221; tasklets. The secure control of resources stops being the code cutters responsibility and helps remove many side channels. Importantly the tool chain giving each tasklet it&#8217;s own CPU and only sufficient resources to do the job does not give malware any place to hide.</p>
<p>Further as the hypervisor loads each CPU it can be a full Harvard design and the tasks written such that they neither &#8220;evolve&#8221; or be &#8220;self calling&#8221; in an uncontroled way. Whilst making the code cutters life marginally more difficult it makes signiture analysis and memory checking very very much easier.</p>
<p>Now to introduce a heretical idea&#8230; systems need only be &#8220;occasionaly secure&#8221;. That is in a hardware segregated environment you don&#8217;t need to check the hardware inside a segregated unit is secure all the time only when it has produced an output or has failed to produce an output within a given period of time. As the task effectivly &#8220;blocks&#8221; at output, the hypervisor can scan it&#8217;s instruction and data memories for anomalies to look for attempts at subversion. As it&#8217;s the hypervisor doing this not the CPU it&#8217;s self there are no &#8220;dynamic issues&#8221; involved as the CPU is in effect or practice halted.</p>
<p>It&#8217;s important to note at this point that the hypervisor is running on a CPU of it&#8217;s own, and thus it is possible if incorrrectly programed for it to be effected by the data it sees. This should not be allowed to happen, that is it is written as a simple state machine that either OK&#8217;s each simple test or &#8220;fails hard&#8221; (and in turn it is &#8220;watched&#8221; by a more trusted hypervisor).</p>
<p>Now for the realy heretical idea &#8220;Probablistic Security&#8221;. From the above I indicated that the security of a tasklet CPU only needs be checked on error such as a time out or when it blocks on output. Two points arise unless it&#8217;s an error you don&#8217;t need to check every time the CPU blocks only a percentage of them. Secondly it is possible that rouge code in the CPU could in some way sync it&#8217;s activities to the blocked state and thus avoid detection (very very unlikely due to resource limitations but theoreticaly possible).</p>
<p>So let us say you only check 1% of the times the CPU blocks (on average as you should do the checkinng randomly) and occasionaly at random times you just halt the CPU and check the memory etc.</p>
<p>Thus malware &#8220;injected&#8221; from &#8220;outside&#8221; has virtualy no memory to be in, no time refrence to communicate by and has no idea when the hypervisor is going to look for it&#8221;. Thus it&#8217;s not impossible to do but way way way above the malware games we crrently see or are ever likely to see. Importantly the amount of checking from zero to 100% is adjustable not in the tasklets but in the hypervisor, thus the degree of checking is dynamicaly adjustable as required.</p>
<p>It needs to be said that so far this is only a defence from &#8220;malware&#8221; or modification of exisiting code, not from deliberate insider attacks during code development. To protect against this is more difficult and this is where the higher level tool chains that Nick P talks about come in.</p>
<p>That is the &#8220;prison&#8221; system enables a significant security gap between the &#8220;tool chain&#8221; and the &#8220;Castle&#8221; Single CPU to be closed.</p>
<p>That said will it ever be likely to be built in practice, probably not in an &#8220;off the shelf design&#8221; because there are to many vested interests in the &#8220;castle&#8221; approach. And as Nick P has noted the tool chains are reaching lower and the kernels are becoming lighter and easier to protect thus in effect alowing them to reach higher if the rest of the system is designed accordingly (but the won&#8217;t actually ever meet in a Castle design thus an exploitable gap will always exist with current architectures).</p>
<p>What you will see is more of what RobertT outlined, that is the prison idea will move into System on a Chip (Soc) designs as a mater of routine because the security advantages it offers in such environments is immense. And as you will realise that with a little thought the prison system can be split across a number of chips such that you can with carefull design actually use chips that might have been &#8220;backdoored&#8221; in some distant Fab by some &#8220;Chinese APT&#8221; agents.</p>
<p>Any way use the &#8220;prison&#8221; idea as a thinking tool, to generate more ideas with, because even if you never get the chance to use it for real just thinking about how you would will broaden the possabilities available to you and also hopefully stop you chasing yourself down dead end path ways.</p>
<p>Any way I&#8217;ve just heard the sounds of &#8220;dinner&#8221; being brought up (in trollies not by a patient that will be later 😉 so I must skulk back to my appointed &#8220;black hole&#8221; again lest I not get fed the delights of over cooked starch and cellulose&#8230;</p>
<p>One quick last thought hospital wards have a classic example of efficiency-v-security&#8230; Many years ago the more senior nurses and doctors had &#8220;rooms&#8221; where patients were not allowed where discussions could be held and records kept. In the name of &#8220;efficiency&#8221; these were all replaced with &#8220;open plan &#8220;central nursing stations&#8221; where patients and their relatives are expected to be to make requests and enquiries. Well patient information is thus freely on display to any one with working eyes and ears with multiple doctors and nurses making the best of limited space often with their backs to patients and their relatives when working at computers so &#8220;sholder surfing&#8221; data is easy. Finally the so called &#8220;Quality Care Commission&#8221; has woken up to this so the &#8220;patient data&#8221; has to be put out of sight&#8230;</p>
<p>But where&#8230; the offices don&#8217;t exist on modern wards they have been &#8220;designed out&#8221; to maximise ward space thus &#8220;efficiency&#8221;. Thus the result is actually in some cases to close &#8220;bays&#8221; on a ward or convert &#8220;therapy rooms&#8221; on the ward to &#8220;office space&#8221; no matter how inconvenient or (mentaly) unhealthy such places may be&#8230; I&#8217;ve even seen a room that used to hold supplies of dressings and other day to day items being converted to office space, but&#8230; as the only place to store the &#8220;drugs trolly&#8221; is in this room or at the nursing station I&#8217;ll leave you to imagine how bad a solution that is 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180587">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180587">
						June 13, 2012 2:18 PM					</a>

				</p>

				<p>@ O W</p>
<p>I believe you&#8217;re quoting Wael, who I think was speculating on hypervisor-based security. If you&#8217;re interested in that, the better modern examples of that are INTEGRITY Padded Cell, LynxSecure, PikeOS &amp; OKL4. The source of OKL4 3.0, Turaya, Nova microhypervisor and Fiasco.OC are available. To see what a high assurance hypervisor takes, google &#8220;Retrospective on VAX Security Kernel.&#8221; A modern, complex one on x86 would be MUCH harder to do right. Then, there&#8217;s weaknesses in the chip and firmware&#8230; (sighs)</p>
<p>@ Wael</p>
<p>I wouldn&#8217;t put TOO much into the Godel work. The current line of thought in mathematics can apply one day &amp; totally not the next. There&#8217;s huge debate in the formal (mathematical) methods community over how to apply his work. The thing is that he might be right overall, technically, etc. However, they keep finding potential shortcuts, exceptions and just ways of applying their ideas successfully in spite of Godel&#8217;s proclamaition of doom. Peter Guttman&#8217;s pessimistic paper on formal methods was sadly much more realistic. Most of that&#8217;s overcome by doing it right with experienced people, with much exp. accumulated since the paper.</p>
<p>(Yet, if you look at A1/EAL7 systems, they&#8217;ve lived up to their security claims. The verified CompCert compiler did amazing in tests where competing compiler&#8217;s middle ends were buggy by comparison. INTEGRITY-178B RTOS, MULTOS smart card os &amp; AAMP7G processor have similarly lived up to claims. Anyone listening to Godel or Guttman might have not tried.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180588">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180588">
						June 13, 2012 2:23 PM					</a>

				</p>

				<p>@ Clive Robinson,</p>
<p>Hoping you will get better soon and get out of there. Your posts require a lot of thought to reply to. So if I take too long, its not because I lost intrest.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180589">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180589">
						June 13, 2012 3:04 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>Ah, so now all of our work finally starts to intersect in cross-roads. It seems that things are getting interesting right as I was considering leaving INFOSEC for a field where I could get things done. 😉</p>
<p>&#8220;so many &#8216;step level&#8217; dependancies&#8230;&#8221;</p>
<p>Never heard it put that way. I always say legacy. Nice way to put it, though. x86 might be the worst for this because, unlike ARM, many of its vestigial (there&#8217;s one!) parts have almost NO use due to being superceeded. The cache&#8217;s alone are very high bandwidth timing channels. I would say this stuff doesn&#8217;t matter but it might if we remove low hanging fruit: current malware model has sophisticated people devising the exploits, packaging them as kits, and selling them to less sophisticated. I figure we&#8217;d see timing channel kits, firmware subversion kits, etc.</p>
<p>Best recommendation for this, for now, is combining a verified processor like VAMP (or a simple one, at least) with a modern non-leaking cache, IOMMU, trusted boot, &amp; firmware that uses non-writable boot ROM &amp; writeable flash together. That should provide foundation to stop most software attacks. I agree with exponential increases in difficulty past a certain security margin w/out chip-based security.</p>
<p>&#8220;Now to introduce a heretical idea&#8230; systems need only be &#8220;occasionaly secure&#8221;. &#8221;</p>
<p>It&#8217;s not so heretical. Different forms of it have been in security for a while. Examples include not doing permission stuff until an access, recovery base systems that wait 15 min b/f restores, and integrity-check/attestation during critical operation.</p>
<p>&#8220;It&#8217;s important to note at this point that the hypervisor is running on a CPU of it&#8217;s own, and thus it is possible if incorrrectly programed for it to be effected by the data it sees. This should not be allowed to happen, that is it is written as a simple state machine that either OK&#8217;s each simple test or &#8220;fails hard&#8221; (and in turn it is &#8220;watched&#8221; by a more trusted hypervisor).&#8221;</p>
<p>I&#8217;ve always had a problem with this. Your design is great for POLA &amp; information flow control. The problem comes with the other big requirement: timing. Just mere context switches brought old systems to a crawl. Your design wouldn&#8217;t just require putting code/data into processing units &amp; managing them. It would also require scheduling a large number of activities across a (likely) smaller number of processing units, possibly integrating their outputs at some point, managing hardware IO, and managing UI activities. How would you do all of this w/out your system comparing unfavorably to a 20Mhz IBM PC circa 1993? 😉</p>
<p>Btw, what I just wrote is sounding similar to the Cell processor. You might want to read Green Hill&#8217;s or other security analysis of it. Has some interesting features. It&#8217;s just too weird and expensive for me.</p>
<p>&#8220;Secondly it is possible that rouge code in the CPU could in some way sync it&#8217;s activities to the blocked state and thus avoid detection (very very unlikely due to resource limitations but theoreticaly possible).&#8221;</p>
<p>It would seem very hard. If it happened, I think the components would be relying on external input to clock the channel OR take advantage of the fact that many applications demand a response in a certain time range. The latter would make the former easier.</p>
<p>Btw, it might be easier to autogenerate the hardware for your prison approach from application requirements. i.e. application-specific TCB to run on ASIC or FPGA. The reason I thought about it was Tensillica&#8217;s Xtensa processor kits. Unlike FPGA acceleration, the Xtensa kit lets you design a processor, then the tools generate it and an entire toolchain to go with it. Honestly, I think that was the realistic version of the dream goal driving original interest into FPGA&#8217;s by software people. Really neat product idea.</p>
<p><a href="http://www.tensilica.com/products/hw-sw-dev-tools/for-processor-designers.htm" rel="nofollow ugc">http://www.tensilica.com/products/hw-sw-dev-tools/for-processor-designers.htm</a></p>
<p>&#8220;And as you will realise that with a little thought the prison system can be split across a number of chips such that you can with carefull design actually use chips that might have been &#8220;backdoored&#8221; in some distant Fab by some &#8220;Chinese APT&#8221; agents.&#8221;</p>
<p>I agree totally. I&#8217;ve done that in my designs that I worked on for the past year or so. No doubt inspired by increasing paranoia from discussions with you hardware guys on this blog. My basic model is to use more trustworthy, but maybe limited, chips for the critical code. Then, non-security-relevant functions like storage, networking, etc. are put on one or more boards that can be backdoored for all I care. It will only matter if I let it. 😉</p>
<p>&#8220;Well patient information is thus freely on display to any one with working eyes and ears with multiple doctors and nurses making the best of limited space often with their backs to patients and their relatives when working at computers so &#8220;sholder surfing&#8221; data is easy. &#8221;</p>
<p>Tell me about it. I was in the doctor&#8217;s office yesterday for [hopefully] my final checkup on rotator cuff strain (thank God not &#8216;tear&#8217;!). Hopefully, back to the gym and martial arts soon! Getting ahead of myself. Anyway, I was concerned about all the personal info. Scheduling was done with name and birthdate. This was not optional&#8230; What disturbed me most is I could always tell if someone was about to see me by hearing them rummage through the papers outside the door. All this HIPPA, encryption, access control, monitoring, etc. &amp; someone just has to walk up in scrubs and pick up my chart. Medical record security my (bleeeep!)&#8230;</p>
<p>Unrelated</p>
<p>The group behind the Flicker architecture keeps doing interesting work on minimal means to get low TCB execution on Intel/AMD using TPM&#8217;s and stuff. The paper below from Microsoft Research claims Flicker (at that time) had a TCB of 250 lines thanks to design. (They exclude hardware TCB, which is there anyway I guess.)</p>
<p><a href="http://research.microsoft.com/pubs/165720/parno-cacm.pdf" rel="nofollow ugc">http://research.microsoft.com/pubs/165720/parno-cacm.pdf</a></p>
<p>Here&#8217;s other stuff from that group. I plan to read the Lockdown and CARMA papers later. Eventually: I just updated my stuff by downloading over a 100 papers from IEEE and ACM for mid-2011 to 2012. I&#8217;m glad I have no access to SpringerLink. It has some good abstracts and I already put way too much time into this stuff. 🙂</p>
<p><a href="https://sparrow.ece.cmu.edu/group/publications.html" rel="nofollow ugc">https://sparrow.ece.cmu.edu/group/publications.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180590">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180590">
						June 13, 2012 4:31 PM					</a>

				</p>

				<p>@ Nick P,</p>
<p><i>and I already put way too much time into this stuff</i></p>
<p>And I predict you will continue to do so&#8230; untill that day you think, I&#8217;d better write this up as a paper/book etc, then and only then the reading and thinking looks easy 😉</p>
<p>With regards,</p>
<p><i>rotator cuff strain</i></p>
<p>I&#8217;m assuming it was semi self inflicted from a &#8220;sporting activity&#8221;. Sadly my sporting activities from yeas ago and doing such things as jumping off walls and out of second story windows etc with 50+ pounds of kit on my back because &#8220;Her Maj&#8221; was paying me to, have caught up with me in compressed spine, shot hips knees and ankles&#8230;</p>
<p>Whilst I can still get about there are days when it would be less painfull to hang upside down like a bat 😉</p>
<p>With regards the FPGA&#8217;s I can remember a time when you would &#8220;roll your own&#8221; state machines come CPU&#8217;s because the likes of the 68K were just not cutting the mustard for IO and other related high through put activities. Some where I have a copy of a paper from Charles Moore and others about turning a TI-DSP into a RISK CPU using a subset of Forth as the native code&#8230; People just don&#8217;t seem to be as inventive these days with digital chips up in the THz range&#8230;</p>
<p>And this lack of inventiveness actually hurts security because people are not encoraged to &#8220;think outside the box&#8221; just to get an ordinary days work done any more.</p>
<p>Any way you have given me some more reading to do, where is a nice hot cup of the brown stuff 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180591">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180591">
						June 13, 2012 5:54 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>Haha. I keep seeing old timers telling me about how their bodies suffer so much for all the activity they did as they were young. Is God sending me a warning? I wonder.</p>
<p>&#8220;People just don&#8217;t seem to be as inventive these days with digital chips up in the THz range&#8230;&#8221;</p>
<p>Yeah, most aren&#8217;t. You must give us credit though: designs are so complex these days that, even with great tools, it&#8217;s still hard to fully grasp &amp; properly execute them. Also, most of the modern &#8220;hackers&#8221; aren&#8217;t throwing their best ideas at boring jobs at work: they channel that into their creative side projects, some of which end up being useful for work.</p>
<p>My personal experience with hacking stuff together like you describe is a bit scattered. Probably the best example was doing &#8220;Web 2.0&#8221; stuff on &#8220;Web 1.0&#8221; clients and servers. Back then, we called it &#8220;DHTML&#8221; (a la dynamicdrive.com) and scripting. My goal was to make the browser just a bit more like an application interactivity-wise and do most work in real applications written in real programming languages. (Sound familiar? 8)</p>
<p>And by <em>real</em> programming language, I mean Visual Basic 6.0. Haha. People hated on me for it, but I liked its RAD/GUI abilities so much I wrapped plenty of good C/C++ functionality in it &amp; just did most one-off stuff in VB. I think I used Perl for much server side stuff, hacking scripts and administration. All of this was before I fully understood concepts like TCB, maintainable code &amp; vendor neutrality. Still fun though.</p>
<p>Hope you enjoy the reading. The CARMA thing is directed at reducing hardware TCB in the face of very serious threats. Flicker has potential short-term. Some form of Tiara or SAFE(R) architectures might be desirable compromise between castle and prison for specific apps in the future. It&#8217;s all fun to read.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180592">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180592">
						June 15, 2012 5:02 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>I don&#8217;t know if you have seen the bruh har about PGP designer Phil Zimmerman, apparently he has linked up with a couple of Ex SEAL&#8217;s and the CEO/CTO of EnTrust to form a new company called Silent Circle, offering &#8220;no backdoors comms&#8221; for 20USD/Month.</p>
<p><a href="https://silentcircle.com/" rel="nofollow ugc">https://silentcircle.com/</a></p>
<p>Apparently they did some research over &#8220;friendly legislation&#8221; countries and of the top three Canada, Iceland &amp; Switzerland they went for the one closest to the US&#8230;</p>
<p>However they appear to have designed things around mobile phones&#8230;</p>
<p>I wonder how they are going to deal with &#8220;end run&#8221; issues within the OS and hardware of such platforms&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180593">

			<div class="comment by-mrs-robinson ">

				<p class="commentcredit">

					<span class="commenter">Mrs. Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180593">
						June 15, 2012 10:53 AM					</a>

				</p>

				<p>cell phone dildo for easy storage but not so deep that it requires a doctor to retrieve it. it should fit deep within my &#8220;silent circle&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180594">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180594">
						June 15, 2012 12:47 PM					</a>

				</p>

				<p>@ Clive Robinson on Zimmerman&#8217;s new products</p>
<p>Thanks for the link. Hate debunking someone like Zimmerman. Oh, we used SEAL&#8217;s so the software is better! They &#8216;shot holes through the bad ideas&#8217; no pun intended (ok, my quote haha). BS detector at 90%. Anyway, let&#8217;s take a look at this.</p>
<p>First claim: &#8220;We have for very unique, elegant products. (email/phone/video/text)&#8221;</p>
<p>You mean we can now buy an encryption app for email, phone, video or text? That didn&#8217;t exist before? Usably?</p>
<p>Second claim: &#8220;With the level of defense Silent Circle provides, it meets Department of Defense and Federal Govt standards.&#8221;</p>
<p>Which are lower than ever before &amp; segregated based on risk. FIPS 140-2 &amp; EAL4 are almost certified insecure, yet they are standards. TS/SCI accreditation or Type 1 certification are (supposed to be) high robustness, yet I doubt the product will make that cut. Even Windows is pushed as Fed Govt certified.</p>
<p>Third claim: (Zimmerman) &#8220;Generally speaking, this is designed for hostile environments&#8230; traveling overseas in a hostile environment.&#8221;</p>
<p>BS meter is around 95% now. In hostile environment, people are likely to try to eavesdrop on you in a number of ways. Overseas, evil maid attacks are a real threat. There&#8217;s snatching &amp; bugging your phone, bugging your room, getting a hotel next door &amp; using a plastic cup on the wall. 😉 A mobile phone app is NOT suitable for a hostile environment. Usually.</p>
<p>Conclusion</p>
<p>Phil Zimmermann once was a forerunner in deploying solutions that work for the masses to stop govt intrusion into their lives. Back then, people also often said what a product couldn&#8217;t do. Today, Phil is in a company using SEAL&#8217;s as a publicity stunt to push products with bogus claims. It&#8217;s sad: I was once a big Zimmermann fan.</p>
<p>Honestly, if I faced off against Zimmermann on this, I would give Frank Rieger et. al. at Cryptophone credit for doing what Zimmerman claims to do. They have a good protocol, opened it &amp; their code for review, hardened the OS, &amp; test their supply chain periodically.</p>
<p>Rieger and I certainly had a nice little debate on this blog in 2007 regarding whether they could prove no subversion exists. However, I&#8217;ve always said that they&#8217;re doing things the right way. The only thing they needed to do is get their TCB in control, maybe using a microkernel. Well, OK Lab&#8217;s and their partners built that stuff, so if Cryptophone retargets to that on their own hardware, they&#8217;ll be as good as usable mobile security will get. Alternately, I hope Silent Circle finds a timely end in the marketplace.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180595">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180595">
						June 15, 2012 1:11 PM					</a>

				</p>

				<p>Interesing developments for the Boeing Secure Network Server (SNS). Honestly don&#8217;t know what to make of it. SNS, previously MLS LAN, is one of the last two surviving A1-class systems of Orange Book days (Aesec&#8217;s GEMSOS is other). The NSA said, under RAtings Maintenance Program (RAMP), A1 vendors would only have to recertify what updates changed. Then, upon Common Criteria, they said all B3/A1 programs must re-certify under EAL schemes. Most couldn&#8217;t afford it, but Boeing is a big defense contractor.</p>
<p>So, first Boeing SNS was quickly certified to EAL4+. This means nothing in practice &amp; was likely done so they could begin sales to federal govt. Everyone <i>knew</i> Boeing SNS would get certified higher than competing border security solutions, probably close to EAL7. The article stated EAL7 was their next target.</p>
<p>Source<br />
<a href="http://www.boeing.com/news/releases/2007/q2/070621b_nr.html" rel="nofollow ugc">http://www.boeing.com/news/releases/2007/q2/070621b_nr.html</a></p>
<p>A number of people CV&#8217;s and LinkedIn talked about building EAL7 evidence for Boeing SNS. Yet, I had to hit the Wayback Machine to pull up 2010 &#8220;In Evaluation&#8221; list to prove it for sure.</p>
<p>SNS going for EAL7<br />
<a href="http://web.archive.org/web/20100103081527/http://www.niap-ccevs.org/in_evaluation/" rel="nofollow ugc">http://web.archive.org/web/20100103081527/http://www.niap-ccevs.org/in_evaluation/</a></p>
<p>I went to do my periodic check, as EAL7 border security is nice. Imagine how surprised I was to see it was successfully evaluated at&#8230; EAL5+. Same as more recent XTS-400. Dropped an entire assurance level, then another. 😉 Well, to be fair, the + = &#8220;augmented/extra&#8221; &amp; it has a LOT of extra&#8217;s (see yourself).</p>
<p>Certified Products List<br />
<a href="http://www.commoncriteriaportal.org/products/" rel="nofollow ugc">http://www.commoncriteriaportal.org/products/</a></p>
<p>So, I grabbed the validation report and security target. I had an old copy of both, which were targeted at EAL4+. Now, you guys might have to take my word for this, the Boeing SNS in EAL7 evaluation didn&#8217;t have a dedicated security target. I figure they would just swap EAL4+ for EAL7. Instead, the final reports have a target and completion at EAL5+, plenty lower than before. Although, admittedly, the TOE security is rated HIGH.</p>
<p>So, it seems that the last A1-class product going for evaluation failed to meet both EAL6 and EAL7, dropping to EAL5 Very Augmented. So, a major defense contracter can&#8217;t or won&#8217;t do an EAL7 guard. Is this truly the end of high robustness outside of smartcards and separation kernels? Stay tuned!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180596">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180596">
						June 15, 2012 1:32 PM					</a>

				</p>

				<p>I&#8217;m thinking I should have read the validation report before posting. Too much coffee I guess. I stand by the previous post with these two amendments.</p>
<p>The validation report says:</p>
<p>&#8220;Boeing performed a search of all public domain sources for known vulnerabilities and performed a flaw hypothesis strategy to identify potential product vulnerabilities. <b>No residual vulnerabilities remain in the product</b>.&#8221;</p>
<p>I checked the glossay to see if there was a definition of &#8220;residual vulnerabilities&#8221; that might be different than mine. Not seeing one, this led me to believe they are saying no vulnerabilities remain in the product. Quite a claim for a product that didn&#8217;t make high assurance. Most high assurance projects in safety-critical industries don&#8217;t say there are &#8220;no flaws,&#8221; just unlikely to be any serious ones.</p>
<p>It&#8217;s getting kind of deep in Common Criteria circles, if you know what I mean. 😉</p>
<p>Section 12 &#8220;National and international interpretations and precedent decisions&#8221;</p>
<p>Well, I forgot what that meant &amp; it&#8217;s irrelevant. &#8220;International&#8221; got me thinking: there&#8217;s a possibility they dropped to EAL5 to make international sales easier. They no doubt spent a ton of money on this thing &amp; want to earn it back. I&#8217;ve said before B3/A1 systems had export controls &amp; premably their equivalents EAL6/EAL7 do, too. A number of EAL5 products are available internationally. Maybe no export controls on them?</p>
<p>I don&#8217;t want to give them an out in the event that they just didn&#8217;t make the cut for EAL6-7. However, it&#8217;s possible that they targeted for EAL5, augmented with the most important EAL6-7 requirements, so that they could sell to US and allies unimpeded. Honestly, I was thinking about targeting any secure products I developed at EAL5 for same reason. (Maybe certifying the first at EAL6-7 to prove our process is that good.)</p>
<p>Just a thought&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180597">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180597">
						June 15, 2012 1:44 PM					</a>

				</p>

				<p>I&#8217;m thinking I should have read the validation report before posting. Too much coffee I guess. I stand by the previous post with these two amendments.</p>
<p>The validation report says:</p>
<p>&#8220;Boeing performed a search of all public domain sources for known vulnerabilities and performed a flaw hypothesis strategy to identify potential product vulnerabilities. <b>No residual vulnerabilities remain in the product</b>.&#8221;</p>
<p>I checked the glossay to see if there was a definition of &#8220;residual vulnerabilities&#8221; that might be different than mine. Not seeing one, this led me to believe they are saying no vulnerabilities remain in the product. Quite a claim for a product that didn&#8217;t make high assurance. Most high assurance projects in safety-critical industries don&#8217;t say there are &#8220;no flaws,&#8221; just unlikely to be any serious ones.</p>
<p>It&#8217;s getting kind of deep in Common Criteria circles, if you know what I mean. 😉</p>
<p>Section 12 &#8220;National and international interpretations and precedent decisions&#8221;</p>
<p>Well, I forgot what that meant &amp; it&#8217;s irrelevant. &#8220;International&#8221; got me thinking: there&#8217;s a possibility they dropped to EAL5 to make international sales easier. They no doubt spent a ton of money on this thing &amp; want to earn it back. I&#8217;ve said before B3/A1 systems had export controls &amp; premably their equivalents EAL6/EAL7 do, too. A number of EAL5 products are available internationally. Maybe no export controls on them?</p>
<p>I don&#8217;t want to give them an out in the event that they just didn&#8217;t make the cut for EAL6-7. However, it&#8217;s possible that they targeted for EAL5, augmented with the most important EAL6-7 requirements, so that they could sell to US and allies unimpeded. Honestly, I was thinking about targeting any secure products I developed at EAL4/5 for same reason. Just a thought&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180599">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180599">
						June 15, 2012 10:29 PM					</a>

				</p>

				<p>@ OW</p>
<p>I appreciate it. Read the links I gave Wael (below) and you&#8217;ll be off to a nice start in INFOSEC defense. Of course, there&#8217;s developing the security mindset, learning how things are broken, reading up on Schneier, &amp; reading both editions of Ross Anderson&#8217;s Security Engineering book (1st is free online).</p>
<p><a href="http://www.schneier.com/blog/archives/2012/06/friday_squid_bl_329.html#c779145" rel="nofollow ugc">http://www.schneier.com/blog/archives/2012/06/friday_squid_bl_329.html#c779145</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180600">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180600">
						June 16, 2012 12:25 AM					</a>

				</p>

				<p>@ O W,</p>
<p>Whatever do you mean? 🙂</p>
<p>I am Stil here. Just thinking of nice words &#8211; thats all 😉 And last minute travel is not helping me &#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180601">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180601">
						June 17, 2012 12:30 AM					</a>

				</p>

				<p>@ O W,</p>
<p>I&#8217;m still around and back at home &#8220;recovering&#8221; from my recent medical probs.</p>
<p>First and foremost in any study of things technical or scientific is the &#8220;Scientific Method&#8221; ( Bacon/Abbot not Aristotle). Which Francis Ellingwood Abbot&#8217;s described in 1885 with,</p>
<p><i>Now all the established truths which are formulated in the multifarious propositions of science have been won by the use of Scientific Method. This method consists in essentially three distinct steps,</p>
<ul>
<li>(1) observation and experiment,</li>
<li>(2) hypothesis,</li>
<li>(3) verification by fresh observation and experiment.</li>
</ul>
<p></i></p>
<p>The important thing to notice is &#8220;observation and experiment&#8221; on which all else rests.</p>
<p>To be able to &#8220;observe&#8221; you need some rational and testable method of measurment by which comparison can be made (sadly InfoSec lacks usable &#8220;measurands&#8221; currently).</p>
<p>To &#8220;experiment&#8221; you not only need measurands you also need a &#8220;testing rational&#8221; which is generaly derived from your hypothesis.</p>
<p>Thus you need to have a fundemental grip on &#8220;Testing Techniques&#8221; at numerous levels. Due to the lack of real measurands, InfoSec testing techniques lack any rational basis (and similar can also be said for software and other intangible information based fields of endevor).</p>
<p>Luckily most tangible engineering fields of endevor have a strong rational basis of measurands and thus mature testing techniques.</p>
<p>The field of endevor with good testing techniques that are well documented for the beginer and onwards which is clossest in rational to InfoSec is electronics.</p>
<p>A good understanding of testing techniques I would also say <b>Should Be</b> a prerequisite for anyone trying to write software that is maintainable or supportable and it is an absolute must for anyone trying to design high availability or high assurance systems.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180602">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180602">
						June 17, 2012 8:12 AM					</a>

				</p>

				<p>@ Clive Robinson, Nick P, O W,</p>
<p>Clive, I am now in your time zone now for the next few days. Looked at all the links you guys provided. One question I have is where is the root of trust in both your designs? Nick P, the link about the modern hypervisors, etc. is nothing new. And the link about TCB also came from people that previously worked on TPMs. I have met at least one of them in the past.</p>
<p>Also Clive, the description of the hypervisor in your design includes functionalities outside what hypervisors do today, such as breaking down a process into various simple threads and distributing them among some CPUs. You may want to give your &#8220;hypervisor&#8221; a different name, such as a &#8220;wardenvisor&#8221;. I have a lot more comments later once I get rid of the jet lag (forward in this case).</p>
<p>Execuse the lack of sleep, but I leave you with a comment from area code 11221</p>
<p>On thier discussion, Clive and Nick got stuck<br />
With Guards and Wardens running amock<br />
Serving within the castle are the two grunts<br />
Pulling all kinds of &#8220;trusted&#8221; stunts<br />
The grunts are overwhelmed and need help from another trusted schmuck</p>
<p>🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180603">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180603">
						June 17, 2012 3:08 PM					</a>

				</p>

				<p>@ Clive Robinson, Nick P,</p>
<p>I am often confronted with statements that seem conflicting when I read the posts. That is one reason I wanted to get some definitions out of the way, or reach an agreement on them.</p>
<p>You say: “No system can be trusted irespective of past behaviour.”</p>
<p>Then later you say:</p>
<p>“In a castle the command structure is also assumed to be trusted, however in a prison only the upper layers (Warden and warders) are trusted the low layers of &#8220;trustees&#8221; (prisoners who have earned privileges and limited authority over prisoners) are not trusted and continuously &#8220;measured&#8221;.”</p>
<p>&#8220;Earned privileges&#8221; imply &#8220;previous behavior&#8221; which conflicts with &#8220;No system can be trusted irespective of past behavior&#8221;</p>
<p>There are two ways I can reconcile these two statements in my mind, 1- That you are referring to the current state of security models, which you are improving on with your suggestion. 2- I have to give the word &#8220;assumed&#8221; in &#8220;assumed to be trusted&#8221; a higher precedence, and take the whole trust thing with a pound of salt &#8211; a grain of salt is not enough to enhance the taste here, but a pound still makes it difficult to swallow &#8211; if you know what I mean 😉</p>
<p>I have yet again some more questions:</p>
<p>1-  What do you mean by “trust”? Nick P, please don’t send me links.<br />
2-  Who does the measurement? I am presuming the hypervisor as you mentioned previously<br />
3-  Is the hypervisor also measured? How often? Or is it immutable?</p>
<p>Suppose you have an application or a process running. According to your suggestion, the hypervisor will distribute it over 10’s or 1000’s of CPU’s – a simple thread each. Then the hypervisor will randomly stop some CPU’s and check their state for anomalies. According to RobertT, the hypervisor is running on a random CPU chosen during bootstrap:</p>
<p>Question and a suggestion:</p>
<p>First the question:<br />
1-  How would the hypervisor know what to look for? You suggested some heuristics, but are these sufficient to detect deviations by the CPU or the code that is running on it?<br />
2-  How would the hypervisor know what an anomaly looks like if it is not described in the “set of policies” that define what is outside the norm (unless you are implying “complete awareness” here)<br />
3-  Does not your scheme suggest that to verify what is running on a CPU, the hypervisor must also be able to run that exact thread on another CPU and compare the two states at any given time – time synchronization assumed.</p>
<p>Suggestion follows:<br />
1-  Define the target of the system (commercial, military grade, etc&#8230;) – For Nick P, CC and the EAL levels, etc. …<br />
2-  Describe the high level simplest system we can look at and analyze.<br />
a.  Hardware configuration<br />
b.  Boot strapping<br />
c.  Firmware and its relationship with the hypervisor<br />
d.  CPUs<br />
e.  The component responsible for dividing a process into simple threads and distributing them among the CPUs<br />
f.  The component that gathers the threads again and combines them into a meaningful output<br />
g.  The actual threat you are protecting against with this scheme<br />
h.  Characteristics of the OS</p>
<p>We can ignore manufacturing, deployment, upgrading, repurposing, maintenance, and decommissioning and relevant security implication for now…</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180604">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180604">
						June 17, 2012 4:07 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>I was wondering where you were going with that at first. With respect, I disagree. I know proving security can be likened to proving a negative, but I see it as a positive proof of information flow properties.</p>
<p>With regard to empirical, we certainly DO have measures to use in science. Fagan&#8217;s inspection process and the Cleanroom method were both proven via defect counts. Cleanroom is statistically certifiable, leading to it being warrantied by some firms.</p>
<p>Other methods focus on the process (e.g Common Criteria) or artifact attributes. For the former, we can track security defect rates of a process overtime to predict the likely No. of defects of future products. EAL5-7 or higher DO-178B typically produce WAY better stuff than others.</p>
<p>As for artifact attributes, we have indirect measures that give insights into security rating. Bernstein noted the benefits of reducing code, esp trusted code. We also know language and runtime design can provably eliminate certain issues. All confirmed by measurements at different points.</p>
<p>So, testing is important and all, but scientific measurements do exist to support the use of other methods.Ill personally say relying on those i could afford has worked as advertised.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180605">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180605">
						June 17, 2012 5:08 PM					</a>

				</p>

				<p>@ Wael</p>
<p>It seems you&#8217;re mostly addressing Clive&#8217;s design, adding in stuff from RobertT and I. Ill address what I think might be relevant to my stuff.</p>
<p>The root of trust is the hardware. It has to be b/c security is ground up. I simplify by making it a simpler than x86 chip (if possible), integrated crypto a la VIA Padlock, two state at least, IOMMU, read-only boot memory, &amp; flash for main boot stuff.</p>
<p>The first function is the immutable bootloader loading, doing basic tests, loading from the rewritable flash, verifying its signature, and passing control. This lets us modify core stuff in the future in a trustworthy fashion and helps defeat software subversion of firmware, BIOS, or core kernel code. Now it is trusted.</p>
<p>This layer initializes and runs checks of its own. This might be driver stuff, CPRNG&#8217;s, unique capabilities, verified transition of core state (e.g Production to Auditing), etc. This layer might have compinents for dynamic monitoring of applications/VMs, mandatory access, integrity checks, etc.</p>
<p>At app layer, things are decomposed a bit. The designs approach the sep. kernel vendors are pushing looks nice for the basics. However, it doesnt address things like provenance or assured pipelines well. So my stack might be modified at any of the lvl&#8217;s to accomplish this &amp; xtra-trusted boot helps too.</p>
<p>Without a whole system EAL5-7 effort, I dont find the hypervisor, etc approaches to be as robust as vendors claim. Worse, theyre doing it on Intel&#8217;s overly.complex, legacy ridden, errata prone platform. This is why my recent designs over past year or two have bypassed the issue by turning logical into physical separation wherever possible. Example follows.</p>
<p>The SINA architecture is Germany&#8217;s answer to HAIPE and govt IPSEC. The mental model is red-black, with crypto/guard in middle. MicroSINA used decomposition &amp; L4 kernel to essentially turn the system into three logical components: internal facing network (in VM or bare min); external networking; viaduct IPsec. The networking components were complex, but untrusted. The trusted Viaduct component&#8217;s TCB was tiny.</p>
<p>This is the kind of thing sep kernel vendors are pushing. Issue: plenty of shared hardware and firmware not factored into assurance and TCB claims. Also, Intel-like stuff better for untrusted stuff and robust SOC better for security critical stuff. Solution: divide system into components logically separated both within hardware and across hardware. Either COTS nonDMA IO or DMA IO into a sec-critical board with IOMMU.</p>
<p>Applied to MicroSINA. Cheap, high performance boards do networking on both sides. Maybe run robust in general OS like OpenBSD. DOS protection &amp; initial filtering of malicious activity happens here very fast. Both connected to SOC with hardware design i mentioned paragraphs ago. It has a robust RTOS, fine-grained POLA, &amp; designed to ensure correct flows. A coprocessor or separate board might be tied into memory buses to detect and act on privileged code modifications. Most assurance evidence and stuff is limited to one board and component.</p>
<p>Another proposal along these lines was using a PCI backplane for the system. Most safety-critical RTOSes and SOCs are targeted to PCI or VME boards anyway. Can pick cheap/fast boards for stuff like storage, networking, apps, etc. Can pick higher end boards for trusted apps or appliances. Maybe add secure traffic to backplane or backplane-level IOMMU on card interfaces.</p>
<p>Many, many types of systems and networks can be built on such an architecture with varying levels of security.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180606">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180606">
						June 18, 2012 1:48 AM					</a>

				</p>

				<p>@ Clive Robinson,</p>
<p>I need to retract this statement: &#8220;Earned privileges&#8221; imply &#8220;previous behavior&#8221; which conflicts with &#8220;No system can be trusted irespective of past behavior&#8221;</p>
<p>Upon rereading your post I realized that I missed that &#8220;prisoners are not trusted&#8221; and need to be measured. This still does not change the apparent conflict&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180607">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180607">
						June 18, 2012 1:53 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>&#8220;It seems you&#8217;re mostly addressing Clive&#8217;s design, &#8230;&#8221;<br />
&#8212; Correct! Will talk about &#8220;your stuff&#8221; later 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180608">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180608">
						June 18, 2012 6:14 AM					</a>

				</p>

				<p>@ Wael,</p>
<p><i>One question I have is where is the root of trust in both your designs? N</i></p>
<p>Agh you&#8217;ve just fallen into the &#8220;my axioms don&#8217;t work&#8221; problem.</p>
<p>There are two issues with a &#8220;root of trust&#8221;,</p>
<p>1, It&#8217;s inherently hierarchical.<br />
2, It implies an &#8220;overall trust&#8221;.</p>
<p>Both of which are very bad for security in any form.</p>
<p>Your first question should be,</p>
<p>A, Do I need to trust?</p>
<p>To which the answer is no. Further as Kurt Godel little theroms have shown ultimatly you can not trust. Further with a little thought you will realise that past behaviour is no indicator of future behaviour, afterall you have to kill someone first to become a murderer&#8230;</p>
<p>A second question is,</p>
<p>B, If I chose to trust does it have to be absolute?</p>
<p>Again to which the answer is no. Trust has multiple dimensions which are to numerous to relate so simplisticaly you can chose to trust in terms of time or function or both. As Bruce noted in his recent book he got a workman in to do a job did he trust him and if so what did he trust?</p>
<p>The simple answer was he acttually did not consider giving him any trust other than the mild trust he would be at a specific time and place and a larger trust to do a specific job. But did Bruce have to worry about the larger trust, well probably not many houeshold insurance policies have a section to do with &#8220;faulty work&#8221; as do some payment cards. That is Bruce had mittigation against his larger worry. Bruce might have had further trust wories in that the person might steal, abuse or assult him, Bruce could quite easily have mittigated these risks if he&#8217;d wished to.</p>
<p>And this is an important point about trust, you mittigate it where possible and when you think about it it is always possible to mittigate against, it becomes a question of resources. The way to minimise the mittigation resources is to minimise the requirment for mittigation by minimising the requirment for trust.</p>
<p>The problem with a hierarchical system is it concentrates trust in very few entities at the top of the hierarchie&#8230; Further the larger the hierarchie is the more powerfull the upper levels have to be so the more potential they have for creating breach of trust.</p>
<p>Now a specific example, a prisoner is by definition &#8220;untrusted&#8221; in one or more things. Thus a prison is dessigned to give the absolute minimum of resources to the prisoner to survive the confinment.</p>
<p>About the only thing a prisoner is initialy &#8220;trusted not to do&#8221; is &#8220;kill themselves&#8221; in inventive ways, because the normal ways have usually been mittigated against by the removal of anything that could be used as a weapon including, personal effects including matches, lighters jewelry, watches, specticals, etc. further anything they might conceivably use as a ligiture such as laces, belt, blankets sheets and even clothing. Further modern cells usuall have no points to which you can attach a ligiture to hang yourself from. And assuming you decided to chew through a vein or two they have CCTV cameras and regular patrols by trusties or guards. That being said some prisoners do manage to attempt to kill themselves and a few of those occasionally succeed.</p>
<p>Eventually prisoners are trusted to do work of some kind. However this is again mittigated against in that what they can do is strictly controlled and the minimum of resources provided to carry out a specific functtion are provided. That is they are provided with the minimum of tools and raw materials and the finished work is quality checked and the tools taken away when the work is finished. Also the prisoner is subject to randon searches etc.</p>
<p>Now if you are talking about non sentient devices such as CPU&#8217;s there are some things you can do.</p>
<p>The first is &#8220;black box&#8221; test it&#8217;s response to input stimuli to find out if it is capable of carrying out an individual task. What you cann&#8217;t do is ensure it is &#8220;reliably&#8221; functional because your test inputs cannot go through all possible states to ensure there are no &#8220;hidden&#8221; circuits to change functionanlity. Further even if it was sufficiently simple that all states could be checked, you do not have the abbility to test continuously. So an expired time timer may be in place which might trigger at some point in the future to await a trigger state.</p>
<p>How do you mittigate this well simply with supply chain diversity and voting protocols of one form or another that look for changes of behaviour.</p>
<p>However asside from &#8220;functional trust&#8221; there is communications trust. Let us assume we have mittigated against a CPU (group) trust breach by using say a 2 of 3 voting protocol. We need to ensure that collusion is not possible so we have to close down communications paths etc. This can be done in a number of ways but it gets complex to describe them. The simplest is to actually have say 5 CPU&#8217;s carrying out repetative tasks. What you do is randomly halt 2 of the 5 and use the remaining 3 to do this particular itteration and select the vote. The next itteration you randomly select another 2. This way no CPU getts to see all itterations and has no idea of where in the sequence of itterations it might be in. This makes collusion difficult at best. Likewise you can feed different CPU&#8217;s with different data where only part of the data is actually required the other parts of the data act as a canary that is you know in advance what the result should be and if it&#8217;s not right it &#8220;sings out&#8221; that the CPU in question is not behaving as expected.</p>
<p>You can go on with these mittigation techniques to your hearts content and at various degrees of testing. The point is they start from the position of assuming the individual CPUs are not to be trusted so play them off against each other in a way where when they &#8220;go bad&#8221; you have a very high probability of discovering it.</p>
<p>It&#8217;s not perfect and it uses a lot of resources, however the &#8220;extra resources&#8221; range from zero upwards. Where zero is where you do not have the need to mitigate or test.</p>
<p>The further trick is designing such a system that allows for variable &#8220;traitor checking&#8221; resources whilst aalso not having a hierarchical trust tessting/signaling system.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180609">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180609">
						June 18, 2012 11:44 AM					</a>

				</p>

				<p>@ Wael and Clive Robinson</p>
<p>Wael: Thanks for clearing that up. Well, you already have an initial answer. Please save that description as it took 10+ minutes to type on a mobile phone. 😉</p>
<p>Clive: I&#8217;m actually interested in your answer to Wael&#8217;s question, if you have one. I&#8217;ve asked for specifics on your design in the past &amp; you said you prototyped it a bit. Here&#8217;s what he asked for specifically:</p>
<p>&#8220;Question and a suggestion:<br />
First the question:<br />
1-  How would the hypervisor know what to look for? You suggested some heuristics, but are these sufficient to detect deviations by the CPU or the code that is running on it?<br />
2-  How would the hypervisor know what an anomaly looks like if it is not described in the “set of policies” that define what is outside the norm (unless you are implying “complete awareness” here)<br />
3-  Does not your scheme suggest that to verify what is running on a CPU, the hypervisor must also be able to run that exact thread on another CPU and compare the two states at any given time – time synchronization assumed.</p>
<p>Suggestion follows:<br />
1-  Define the target of the system (commercial, military grade, etc&#8230;) – For Nick P, CC and the EAL levels, etc. …<br />
2-  Describe the high level simplest system we can look at and analyze.<br />
a.  Hardware configuration<br />
b.  Boot strapping<br />
c.  Firmware and its relationship with the hypervisor<br />
d.  CPUs<br />
e.  The component responsible for dividing a process into simple threads and distributing them among the CPUs<br />
f.  The component that gathers the threads again and combines them into a meaningful output<br />
g.  The actual threat you are protecting against with this scheme<br />
h.  Characteristics of the OS</p>
<p>We can ignore manufacturing, deployment, upgrading, repurposing, maintenance, and decommissioning and relevant security implication for now…&#8221;</p>
<p>The a-h parts, in particular, allow the system to be modeled, analyzed and tested in software.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180611">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180611">
						June 20, 2012 4:00 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>Time to talk ‘bout your stuff. Just the first relevant paragraph for now to keep the discussion contained.</p>
<blockquote><p>The root of trust is the hardware. It has to be b/c security is ground up. I simplify by making it a simpler than x86 chip (if possible), integrated crypto a la VIA Padlock, two state at least, IOMMU, read-only boot memory, &amp; flash for main boot stuff.<br />
The first function is the immutable bootloader loading, doing basic tests, loading from the rewritable flash, verifying its signature, and passing control. This lets us modify core stuff in the future in a trustworthy fashion and helps defeat software subversion of firmware, BIOS, or core kernel code. Now it is trusted. </p></blockquote>
<p>I will take two points from your paragraph:</p>
<blockquote><p><strong>The root of trust is the hardware. It has to be b/c security is ground up. </strong></p></blockquote>
<p>Hardware? So the root of trust is the Motherboard, CPU, Chipset, MMU, memory, monitor, keyboard, mouse, peripheral cards, printers, your wireless hotspot (?), the works …</p>
<p>Trust is a relation of sorts between two or more entities. When you say the root of trust is the hardware, there are two meanings:</p>
<p>1- <strong> You</strong> trust the hardware<br />
2- Another <strong>machine</strong>; a server trusts the hardware (or the system as a whole)</p>
<p>#1 is subjective; I am ok with EAL4+ for my needs, and you want nothing less than EAL7, for example. And #2 you have not explicitly addressed.</p>
<blockquote><p><strong>The first function is the immutable boot loader loading, doing basic tests, loading from the rewritable flash, verifying its signature, and passing control. This lets us modify core stuff in the future in a trustworthy fashion and helps defeat software subversion of firmware, BIOS, or core kernel code. Now it is trusted. </strong></p></blockquote>
<p>How do you as a <strong>user</strong>, not as a <strong>designer</strong>, verify, and consequently “Trust” or “Believe” that:</p>
<p>1- The system has an immutable boot block<br />
2- The <strong>chain of trust</strong> was followed in the bootstrapping process, meaning each stage “measured” the next stage before handing control to it, and flagged any signature mismatch.</p>
<p>The other part of the question:</p>
<p>How does a remote machine “Trust” or “believe” the current state of the your machine; same two questions above?</p>
<p>Let&#8217;s get this out of the way and then continue. We’ll give Clive time to consider whether he wants to share his IP with us.</p>
<p>@ Clive Robinson:<br />
“Trust” here is about the <strong>current state</strong> of the machine, not about past or future states. Also “Trust” does not imply goodness in this context. Trust means you believe that the entity reported the honest state. That honest state may very well be something really bad (that is you “Trust the reporting”, but don’t necessarily like it) &#8212; then you can react accordingly. Or it can be something you like and believe with a certain degree of assurance.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180612">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180612">
						June 20, 2012 6:16 AM					</a>

				</p>

				<p>@ Nick P, O W, Wael,</p>
<p>The first trouble is finding time to reply as time is in short supply at the moment (don&#8217;t get ill you only get sicker by trying to catch up 🙁</p>
<p>OK a definition of trust is always a pain because it means different things to different people in different ways&#8230; It generaly has a tendancy to be nebulous to the extream and thuss &#8220;wooly&#8221; to the point of uselessness. In essence it always boils down to &#8220;don&#8217;t trust as you will be let down&#8221; or similar.</p>
<p>You should therefore ignore the all encompassing terms used by many (that only appear to make things more difficult to understand) land look at it in a more practical way,</p>
<p>You have a job that needs doing by an entity (human/computer/pet dog/whatever) what do you actutally expect to occurre?</p>
<p>Well the human race has been doing &#8220;business&#8221; longer than written records go back. Thus it&#8217;s a well trodden path, and the usuall &#8220;business driver&#8221; is &#8220;Compleated to Specification on Time and Budget&#8221; or,</p>
<p>1, The job get&#8217;s done.<br />
2, It get&#8217;s done correctly.<br />
3, It get&#8217;s done within a timeframe.<br />
4, The costs are within norms.</p>
<p>A fail in any of these is generaly a breach of contract either express or implied and is thus also a breach of the &#8220;trust&#8221; the contract forms. But a contract can and often is also used to define various other terms of &#8220;trust&#8221; such as,</p>
<p>5, Non-Disclosure.</p>
<p>It&#8217;s why I prefer to think not in terms of &#8220;all encompassing trust&#8221; but interms of a &#8220;contract of behaviour&#8221; simply because it&#8217;s practical and fairly easy to identify fault. Further you can have a specific contract for a specific job which alows for variation as required.</p>
<p>Importantly &#8220;If it ain&#8217;t in the contract, it ain&#8217;t covered&#8221; which clearly indicates on who&#8217;s shoulders the responsability lies. As you draw up a contract you will identify each area that needs to be addressed and importantly how to test for breach etc. Obviously this contract goes on to form part of the initial and subsiquent specifications. As such it realy should be done before you even think about specific projects, products or processes, which means you need to think of the contract in terms of a standard or base methodology.</p>
<p>Importantly don&#8217;t get caught on the &#8220;specifics&#8221; at the higher levels as frequently they become &#8220;prescriptive&#8221; and quickly out of date it&#8217;s a fault you often see in legislation (&#8220;cabs for general hire should carry a bale of straw&#8221; etc).</p>
<p>Also remember &#8220;every rule has an exception&#8221; and you need to identify the &#8220;Who Where &amp; Why&#8221;. Likewise identify other &#8220;edge cases&#8221; as these are where most &#8220;security issues&#8221; arise.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180613">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180613">
						June 20, 2012 7:03 AM					</a>

				</p>

				<p>@ Clive Robinson, O W, Nick P</p>
<p>Ok. As long as we agree on a definition. We can use &#8220;Trust&#8221; the way you defined it.  Let&#8217;s see what Nick P has to say when he wakes up.</p>
<p>BTW,<br />
 <strong>&#8220;every rule has an exception&#8221;</strong> is a self contradicting statement &#8212; It&#8217;s a logical fallacy. But worry not, your message got across &#8212; &#8220;Trust&#8221; me 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180614">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180614">
						June 21, 2012 8:37 PM					</a>

				</p>

				<p>@ Wael</p>
<p>&#8220;Hardware? So the root of trust is the Motherboard, CPU, Chipset, MMU, memory, monitor, keyboard, mouse, peripheral cards, printers, your wireless hotspot (?), the works … &#8221;</p>
<p>I figured you&#8217;d know I meant the main chip: CPU or SOC. Most of that other stuff ties into it in a way where they can be shutdown on fail, ignored, or secured with additional layers on top of (or protocols alongside) a trusted core piece of hardware.</p>
<p>&#8220;1- You trust the hardware. 2- Another machine; a server trusts the hardware (or the system as a whole)&#8221;</p>
<p>Or the hardware is trustworthy in what is the generally accepted case. (People always forget &#8220;trustworthy&#8221;, maybe b/c many &#8220;trusted&#8221; systems aren&#8217;t. 😉 Similar to Clive&#8217;s definition, the hardware we&#8217;re focusing on should do what it&#8217;s supposed to do. At the least, the security-critical part should meet spec in practice. Since the spec covers many threats &amp; situations, the system would be secure in spite of those.</p>
<p>&#8220;How do you as a user, not as a designer, verify, and consequently “Trust” or “Believe” that:&#8221;</p>
<p>The user often can&#8217;t. They can be lied to in so many ways. The user DOES NOT evaluate the security of the system in the general case. Typically, an independent assessment by experts with plenty of access to the system and time on their hands is used to verify the claims. As the assurance level goes up, the amount of verification and knowledge of internals does as well. Specs, code, implementation, compiler, configuration, distribution&#8230; this is all examined in a medium to high assurance CC evaluation.</p>
<p>The first trick is, &#8220;Do you trust the process?&#8221; So, the process must be correct to ensure it can catch the issues you need to worry about. Mine exceeds CC requirements in a number of ways to account for issues that have appeared since it was formed. It will be less than EAL7 in practice b/c of cost, time-to-market, usability &amp; legacy issues. A protocol &amp; design done at EAL7, followed by a robust implementation, is a good compromise. EAL5 is already better than 99% of the market &amp; a market viable product of mine would be EAL5+ certified, with EAL6/7 pentesting &amp; other additions.</p>
<p>Additionally, you need to trust the evaluator. First, they must have the competence to evaluate the product. The main evaluation labs for highly robust products are Cygnacom, SAIC, &amp; NSA. They&#8217;re competent. Next, you need to know they won&#8217;t subvert the product. If it&#8217;s your product &amp; you&#8217;re out of their jurisdiction, you just worry about your own employees &amp; your hardware supply chain. (Use multiple competent bughunting groups, too.) If you&#8217;re a customer buying a certified product, you must be sure the producer &amp; evaluater didn&#8217;t work together for subversion.</p>
<p>I&#8217;m in favor of trying to make the hardware layer manufacturer neutral &amp; getting the rest validated by mutually distrusting national evaluators. The owner of the IP should be in a neutral country that respects IP laws &amp; is friendly with the G8 type countries. To assist with SCM or compiler issues, I have a concept that I&#8217;ve promoted online before for an automated, decentralized, high assurance SCM that&#8217;s operated by mutually distrusting intelligence agencies. Everything could be continuously authenticated, tested, built, and distributed in a trustworthy fashion. Its trustworthiness could be bootstrapped overtime &amp; implementations/configs could be done by local groups against a shared behavioral spec.</p>
<p>&#8220;2- The chain of trust was followed in the bootstrapping process, meaning each stage “measured” the next stage before handing control to it, and flagged any signature mismatch.&#8221;</p>
<p>&#8220;How does a remote machine “Trust” or “believe” the current state of the your machine; same two questions above?&#8221;</p>
<p>These are somewhat related, but not in my design. I&#8217;m not working on remote attestation b/c the use-cases I work on don&#8217;t require it. Additionally, remote attestation of non-TCB software can be layered on as an additional function done on top of the evaluated TCB. (Or the TCB could be modified in the future for it.)</p>
<p>The thing about my design is that it&#8217;s focused on risk mitigation. The design simply doesn&#8217;t allow incorrect firmware, OS components, etc. to be loaded. The flow control analysis, design &amp; robust implementation strategies have stopped systems in the past from having TCB-level compromises or serious defects (see Praxis or B3/A1 vendors). Non-TCB compromise attempts can be dealt with at other layers via prevention, monitoring or regular recovery. An instance authentication mechanism, maybe with a trusted 3rd party for verification, could be used to show the system is running the robust environment &amp; therefore probably not compromised.</p>
<p>&#8221; &#8220;every rule has an exception&#8221; is a self contradicting statement&#8221;</p>
<p>The statement is a rule of thumb, not a concrete law of reality. It would be more accurate to say that &#8220;most rules have at least one exception&#8221; or &#8220;every rule seems to have at least one exception.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180615">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180615">
						June 23, 2012 3:53 AM					</a>

				</p>

				<p>@ Wael,</p>
<p><i>&#8230;. is a self contradicting statement &#8212; It&#8217;s a logical fallacy</i></p>
<p>Is it? we are dealing with humans here&#8230; 😉</p>
<p>The reality is looked at on mass we are actually quite bad at making rules usually because of underlying assumptions.</p>
<p>Just a few humans (scientists /engineers / etc) actually take the time to get to the bottom of things to produce the axioms and laws we can sometimes build on. As for the rest of humanity they wave there arms a little and say &#8220;You know what I mean&#8221;&#8230; hence as long as rules are made on unstated or faulty assumptions they are not laws or axioms, just rules with all the usual human failings.</p>
<p>Thus &#8220;Every rule has an exception&#8221; is a rule unless you know what I mean then it&#8217;s an axiom 😉</p>
<p>@ Nick P,</p>
<p><i>1- How would the hypervisor know what to look for? You suggested some heuristics, but are these sufficient to detect deviations by the CPU or the code that is running on it?</i></p>
<p>There&#8217;s a couple of questions there and I hope to answer both by only answering the first one.</p>
<p>But first just to make it clear to all who may read this, the whole point of the &#8220;Prison-v-Castle&#8221; idea is to try to plug the gap in the middle between the top down approach to security of the programers tool chain &#8220;formal methods&#8221; and the bottom up approach to security of making the underlying hardware trustworthy (which is another issue alltogether which will be discussed in another post on this page).</p>
<p>In practice it is this middle ground where the (supposadly) correct code is &#8220;executed&#8221; on the (supposadly) trustworthy hardware where the information (the security seeks to protect) is most vulnerable to an external attacker.</p>
<p>So back to your questions, the answer to the first is obviously the hypervisor can only look for what it is designed to look for, and that depends very much on,</p>
<p>A, The complexity of what is being observed.<br />
B, The capabilities of the underlying sensors.<br />
C, The capabilities of the hypervisor design [1].</p>
<p>The first issue (A) is the most crucial issue because at some point on the complexity curve there is a threshold where it is not possible to distinguish the signal from noise in real time (which is the point you raise in your second question). Below that point is another based on the capabilities of the hardware and a long way below that a point on what is practical to observe. Thus the primary issue of the design is to get the complexity of the observed tasks down below this point on the complexity curve whilst still being able to do usefull work [2].</p>
<p>So the essence of the design is to use a &#8220;divide and conquer&#8221; approach to reduce the complexity of monolithic programes into smaller less complex and well found [3] tasks (an almost identical requirment occurs in Parallel Programming). Thus reducing the complexity of a task that is being observed to a point where it is practical to do so.</p>
<p>This is the opposite of what was tried in the 1990&#8217;s to stop the various forms of Power Analysis that had proved so problematic for smart cards etc. Back then they added complexity to try to generate noise at a level where the task signiture was (partialy) masked. This did not work so the current aproach is the opposite, that is the idea is to make a given task produce a signiture that is not &#8220;data dependent&#8221; so that even if the signiture is visable to an attacker it leakes no information about the data. That is the signiture in effect becomes stable to the task not erratic due to data.</p>
<p>So the design links work in two different fields of endevor together to advance a third.</p>
<p>To give you an idea of the work involved for getting a task stable signiture, a simple task such as a loop has a very clear signiture in time provided the payload of the loop is likewise well found.  However if the payload is complex and full of data dependent branches then it&#8217;s time signitures will appear erratic to the point of chaotic and likewise those of the loop. So data dependent times etc need to be either mitigated or moved up and out of the loop or individual task.</p>
<p>Thus the design of the payload should be such that timings should be as independent of the data as is reasonably possible. Doing this requires carefull thought, as in general usefull programs work on the data input to them. And worse programing is usually taught in a way (recursion et al) where data dependancies are increased not reduced.</p>
<p>I don&#8217;t propose to go into the methods to do this here as it&#8217;s very much a function of the task writer. As noted above it is a more generalised area that some Smart Card designers are working in to reduce the data leakage combined with that of parallel programing both of which will be in some published papers you&#8217;ve no doubt read.</p>
<p>So making a viable signiture with a simple or well found task is relativly easy to do as the inputs are few and the signitures very easily seen and stable.</p>
<p>This is effectivly the opposit approach of current practice where modern CISC CPU architectures with fast task switching and monolithic programs have signitures that becoming their own noise and thus very difficult to see.</p>
<p>So a RISC based &#8216;CPU lite&#8217; has less places for things to hide and produces better time signitures than a CISC based &#8216;heavyweight CPU&#8217;. And as the hypervisor is on the same silicon as the CPU the signitures can be obtained directly from various points on the CPU as opposed to trying to &#8220;guess from the noise&#8221; on the power rail.</p>
<p>Further the simpler the task on a CPU the easier it is to check the signiture for exceptions, and the faster they can be found, the less potential harm can be done (in an ideal situation the hypervisor spots a problem before the injected code has been fully loaded).</p>
<p>Thus the main thrust of the design is to keep tasks to small size with well found behaviour. To do this you have to break down a typical monolithic design into well defined tasks thereby reducing the complexity in the execution environment greatly at the expense of shifting part of it up into the tool chain and part down onto the hardware where in both cases it can be better managed.</p>
<p>What the hypervisor is actually looking at in real time is either elapsed time or event counts from the sensor inputs. So if the task loop is not &#8220;running to time&#8221; then something is wrong. The hypervisor does not know what is wrong just that something is and thus it throws an exception and halts the task CPU.</p>
<p>What happens after this potential error is found is dependent on the hypervisor. It could simply flag it as a warning for the programers and dump the CPU core. Or it could examine the loop counter etc to see if it&#8217;s in range or examine the program memory for consistency. If all is in bounds it can simply &#8220;un-halt&#8221; the CPU. Such events do occur in programs normally when some kind of error occurs &#8220;down stream&#8221; or insufficcient data validation has occurred &#8220;up stream&#8221; simply because code cutters all to frequently don&#8217;t consider let alone address such issues when they code [4].</p>
<p>The response type/level is a function of what is observable by the hypervisor and what actions have been programed into it. In turn the hypervisor needs a usefull or well found signiture for the task to check against. As indicated above this is the hard part and needs to be built by those who know what they are doing. But if done properly it only needs to be done once.</p>
<p>In effect what you end up with is a library of. high(ish) level tasks that consist of a block of code and a signiture profile. The block of code has a very specific calling API that also provides information to the hypervisor to adjust the signiture profile appropriatly.</p>
<p>Provided the task API is defined correctly and likewise the code/signiture then an ordinary programer can use the task by just pluging in the numbers (or more correctly the tool chain does). The ordinary programmer does not need to know how to write low level &#8220;secure code&#8221; they simply pipline tasks together much like a shell script program.</p>
<p>Thus those very rare entities the &#8220;secure code writer&#8221; spreads their goodness across many many ordinary code cutters. In essence the secure programmers are like those experianced programmers who write (secure) operating systems they provide the less experianced coder with a safe environment.</p>
<p>It should be noted that this is designed to stop malware being injected into a correct task, not to stop coders writing code with potential malware in it. That task falls to the development tool chains you have previously mentioned and specification validators.</p>
<p>However there are some very usefull secondary effects in all of this.</p>
<p>One is that, as the complexity of the observed task is reduced, the resources required to carry out the task become reduced but more importantly more easily quatifiable and thus the required &#8220;program memory&#8221; can be rationed to do the specific task. In the process the ability to inject malware becomes considerably more difficult for an attacker (if not practicaly impossible). In practice this particular secondary effect actually gives the best bang for the buck (which I suspect is what RobertT found out for himself).</p>
<p>Another is that the process of making the well found tasks have their data independant signitures means that side channel leakage of data is also significantly reduced (though the tool chain still has work to do at a higher level).</p>
<p>And another occurrs as a side effect in the development process, the hypervisor is in effect a &#8220;debugging tool&#8221; [4] in hardware that cannot be turned off this forces the code cutters to up their game and deal with exceptions and input validation correctly.</p>
<p>[1] It is intended that the hypervisor be a state machine of reduced capabilities to that of a Turing engine so it is not &#8220;programed&#8221; in the normal sense of today.</p>
<p>[2] I&#8217;m ignoring &#8220;efficient&#8221; because it&#8217;s a marketing &#8220;red herring&#8221; these days. Long gone are the days where the cost of doubling a computer systems performance was significant in anything other than the very very short term. Further as can be seen with High Reliability/Availability systems having multiply redundant parts is a cost worth paying to achive the desired reliability / availability figures, the same applies to High Assurance systems.</p>
<p>[3] The term &#8220;well found&#8221; is not often seen these days as it goes back to the days of the building of sailing ships, you could substitute &#8220;well designed&#8221; but it misses the essence of being fully fit for purpose well found conveys. That is a well designed object may not be fit for a specific purpose for a number of reasons not least of which is a deficient specification.</p>
<p>[4] By far the largest set of exploitable weaknesses in modern programs are lazy or overworked programmers who don&#8217;t do proper input validation or proper exception handling. The reality of life is that the enjoyable part of coding which is &#8220;solving the problem of the business logic&#8221; follows the old 40/60 rule in that it should only be around 40% of the job the other 60% should be trapping and dealing with predictable exceptions and input errors.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180616">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180616">
						June 25, 2012 1:02 PM					</a>

				</p>

				<p><cite> Is it? we are dealing with humans here&#8230; 😉 </cite></p>
<p>Is it? Yup!</p>
<p><strong> Thus &#8220;Every rule has an exception&#8221; is a rule unless you know what I mean then it&#8217;s an axiom 😉 </strong></p>
<p>What is this double talk Clive?<br />
&#8220;Every rule has an exception&#8221; is a <strong> Rule </strong>.<br />
So, it must have an exception!<br />
An exception could be:<br />
<strong> &#8220;One rule has no exception&#8221; </strong><br />
which contradicts the original <strong> Rule </strong>.</p>
<p>And no! I don&#8217;t know what you mean, so it&#8217;s not an Axiom 🙂</p>
<p>One thing apparant from your &#8220;Castle-V-Prison&#8221; discussion is that you are<br />
focusing on side channel attacks &#8212; Timings, caches, CPU architecture, etc &#8230;<br />
You need to clearly identify the types of attacks you are protecting against.<br />
You seem to imply &#8212; if not explicitly state &#8212; that all weaknesses are a result<br />
of &#8220;Bad coding&#8221; or bad programmers. Can you enumerate where security weaknesses<br />
come from? Let&#8217;s enumerate say a dozen. Then <em>sniffle</em> tell me which of them your proposal targets.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180617">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180617">
						June 25, 2012 1:12 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>My comment below is addressed to you.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180618">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180618">
						June 25, 2012 2:06 PM					</a>

				</p>

				<p>@ Clive Robinson and Nick P</p>
<p>Clive,<br />
<i>&#8220;There&#8217;s a couple of questions there and I hope to answer both by only answering the first one.&#8221;</i></p>
<p>In the long response you posted, you have answered neither question!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180619">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180619">
						June 26, 2012 1:01 PM					</a>

				</p>

				<p>@ Clive Robinson, Nick P, O W</p>
<p>&#8220;Can you enumerate where security weaknesses come from? Let&#8217;s enumerate say a dozen. &#8221;</p>
<p>And if you can fit these &#8220;weaknesses&#8221; in the Castle / Prison analogy &#8211; That would be super! 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180620">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180620">
						June 26, 2012 6:21 PM					</a>

				</p>

				<p>@ Clive Robinson, Nick P, O W</p>
<p>&#8220;enumerate where security weaknesses come from? &#8221; &#8212; Ok, here is a starter:</p>
<p>1- Faulty architecture (software &#8211; example would be no memory protection, no separation between user mode address space and kernel mode address space, and such)<br />
2- Flawed Protocol (code implementation is perfect!, but protocol sucks)<br />
3- Role misappropriation (giving the wrong task to the wrong person (owner, remember?)<br />
4- Weak code &#8212; faulty code (not secure code)<br />
5- User factors (device not idiot proof)<br />
6- Too complex<br />
7- Device lifetime mismanagement (manufacture, deployment,&#8230;,decommission) Basically womb-to-tomb device protection<br />
8- Weak algorithms (Code faithfully implements the algorithm, code is bug free, but Algorithm sucks)<br />
9- Weak hardware (leaks too much information, susceptible to various known attacks, can be put in debug mode by the user (JTAG for example))<br />
10- Weak tool chain (compilers, debuggers, etc &#8230;)<br />
&#8230;</p>
<p>Your Castle addresses these?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180621">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180621">
						June 26, 2012 6:29 PM					</a>

				</p>

				<p>@ Wael,</p>
<p><i>In the long response you posted, you have answered neither question</i></p>
<p>Hmm&#8230;</p>
<p>As I said,</p>
<p>&#8220;What the hypervisor is actually looking at in real time is either elapsed time or event counts from the sensor inputs&#8221;</p>
<p>That is the CPU it is watching, produces various &#8220;heart beats&#8221; via the sensors which should happen at known times for a known number of occurrences. Remember these watched CPU&#8217;s are always in &#8220;background&#8221; operation as they do not get interupts of any kind causing a state switch into &#8220;foreground&#8221; operation, thus their behaviour is very determanistic and easily measurable. Any deviation from the expected signal of heart beats is an indicator that ther is a problem. It does not matter if the problem is an exception or error in the program or an attempt to load malicious code into the execution space. The hypervisor halts the CPU and inspects it&#8217;s registers counters and execution space if all is not as expected then the hypervisor creates an exception.</p>
<p>How the exception is dealt with is another issue, for a higher level in the security stack to deal with.</p>
<p>The second question raised the question of &#8220;sufficiency&#8221;, this is one of these issues that is dependent of the complexity of an individual task. Beyond a certain point of complexity it is not realisticaly possible to have &#8220;reliable signitures&#8221; thus each task has to stay appreciably below that point.</p>
<p>If you then consider what malware has to do and how as a series of steps, the first is to cause a branch in the expected flow of execution. This branch will cause the timing of heart beats to change in time and this should be recognisable in a well found task, this should then trigger the hypervisor inspection of the CPU and it&#8217;s reduced environment. In most cases the malware will have corupted either the execution memory or program counter to gain control, the hypervisor should be able to see this as the execution code should not change in any way and the PC should be within an accepted range.</p>
<p>So the question falls to can a task be written in such a way that it produces the regular heart beat without it being effected by the data it&#8217;s processing? to which I believe the answer is yes.</p>
<p>Then the next question is can the heartbeat signiture be sufficient in of it&#8217;s self to indicate an attempt to branch the CPU away from it&#8217;s correct execution path? to which again I believe the answer is yes.</p>
<p>The next question is then can the CPU do sufficiently complex work either within one task or a series of tasks? to which again I believe the answer is yes.</p>
<p>My reason for beliving the answer is yes to the last question is the existance of &#8220;stack operated languages&#8221; such as Forth. They work by using simple tasks to build up complex tasks thus the working signiture of each simple task is what is being measured and observed by the hypervisor not the overal task which does have a complex signiture.</p>
<p>Does that answer the two question for You?</p>
<p>P.S. the comment about rules is a light harted way of saying humans are very bad at making &#8220;formal rules&#8221; that do fall within the bounds of logic. As Nick P indicated it&#8217;s a &#8220;rule of thumb&#8221; but in the general case due to the failability of ordinary human made rules actually need exceptions</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180622">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180622">
						June 26, 2012 6:45 PM					</a>

				</p>

				<p>@ Clive Robinson, Nick P, O W</p>
<p>Clive, look! I loooove your castle and prison. I think it&#8217;s elegant, and that&#8217;s why I talk about it so much. It needs a lot of thought through though. Funny! The last three words of last sentence look weird together&#8230; Anyway, there is a lot to it. I am not trying to give you hard time, or prove you wrong. I just want to see this analogy  go further.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180623">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180623">
						June 27, 2012 3:10 AM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>&#8220;Does that answer the two question for You?&#8221;</p>
<p>How rude of me! I forgot to mention that:<br />
Yes, that answers my two questions. Thank you for putting up with me and for typing so much content on your virus infected smart phone 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180624">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180624">
						June 27, 2012 3:43 AM					</a>

				</p>

				<p>@ Wael,</p>
<p><i>and for typing so much content on your virus infected smart phone 😉</i></p>
<p>I&#8217;m not so certain it is a virus but a bug in the keyboard debounce and interupt generation. Basicaly like many smart phones it has way way to many buttons on it&#8217;s sides which makes holding it and two thumb typing on the midget keyboard an interesting problem esspecialy in a moving vehicle (which is where I do a lot of my typing 😉 Well the common denominator appears to be accidental preasure on the power button for a short period of time. I guess this is a known problem with Android phones as later ones have &#8220;raised guards&#8221; around the button or it&#8217;s sufficiently recessed to prevent accidental pressing whilst holding. As for re-flashing no it did not cure the problem. As it&#8217;s upgrade time in a few weeks I&#8217;m not sure spending further time on solving the problem is worth it.</p>
<p>Any way back to the more important stuff.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180625">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180625">
						June 27, 2012 6:25 AM					</a>

				</p>

				<p>@ Wael,</p>
<p><i>Can you enumerate where security weaknesse come from? Let&#8217;s enumerate say a dozen.</i></p>
<p>Hmm which &#8220;dirty dozen&#8221; to select.</p>
<p>Is the wrong place to start, the first thing to do is set the common and aaccepted back ground for the discussion.</p>
<p>So the initial thing is to realise that there are many areas where security issues arise. Very broadly at the 20,000ft overview level you have,</p>
<p>1, Hardware<br />
2, Software<br />
3, Specification</p>
<p>With their own major classes of attack, which have their own sub classes and so on down to actual instants of attack where the &#8220;dirty dozen&#8221; can be found.</p>
<p>The next realisation just to make it even more fun is to realise attacks come in two very basic forms,</p>
<p>A, Passive<br />
B, Active</p>
<p>And also a combination of both where what are effectivly passive attacks can be stimulated by apparantly harmless actions. For instance timing attacks usually work by trying to synchronise an effect to a known refrence point. So if we assume you as an attacker want to enumerate the CPU clock drift you don&#8217;t want to be sending continous packets to get the TCP time stamp, you only want to send them slightly befor during and after the clock roll over period to catch it in the edge of the timestamp change.</p>
<p>The logical conciquence of this realisation is if you don&#8217;t know what an attacker is doing you can not always recognise you are being attacked because the stimuli may not be easily determanable from ordinary work. So in effect you only pick up &#8220;known knowns&#8221; some &#8220;unknown knowns&#8221; and no &#8220;unknown unknowns&#8221; except by chance (The Sony root kit, CarrierIQ being examples of type two adversary attacks, and Stuxnet and Flame being examples of type three adversary attacks oh and various malware being type one adversary attacks).</p>
<p>So lets first look at a &#8220;system host&#8221; consisting of hardware software and all derived from a specification as a unified whole as a &#8220;black box&#8221; (which is how an attacker sees it).</p>
<p>As a black box the host has inputs and outputs some of which are known and an unknown internal state. The internal state changes due to changes at the input and output and it also changes state due to internal operations which can be triggered non determanisticaly by an asynchronous event or determanisticaly by a function processing to a conclusion (such as a loop and it&#8217;s payload).</p>
<p>The aim of an attacker is to gain information sufficient to carry out a desired activity, this is usually called &#8220;target enumeration&#8221; a lot of which initialy involves just finding the desired host but is not realy part of this discussion. The second part of enumeration is having found the host identifing the host type ie hardware, OS, applications etc. So far much of this work can be done passivly by just observing traffic flows and types and other information. However unless the point of observation is very close to the host the types of information available by passive observation are (or should be) quite limited.</p>
<p>To get further information an attacker moves onto the third stage of providing stimulus to the inputs of the host and observing the various outputs. Again the closer the point of observation the better the quality of observed data and the less stimulation required. But in a reasonable host this will be limited to service banners and timebased information leakage. This usually means an attacker will move to the fourth stage of enumeration which is to use active attacks to get a toe hold on the host, to use either for observation, or a bridge head for further active attacks or a combination of both.</p>
<p>Obviously stopping the first type of enumeration is by conventional not IT security measures and sometimes means gaging the likes of the marketing and HR people who tend to give out to much information. For instance one organisation I&#8217;m aware of in a &#8220;puf piece&#8221; identified that they had taken on a Sun SPARC server to run a custom database of customer information and accounts and further indicated it was a break away from their traditional MS Server systems by saying they had taken on &#8220;fred smith&#8221; to administer it&#8230; Talk about giving an attacker a nice helpful sign post or three to find the system&#8230; Further a little look back in time showed rather detailed info in a job advert, and a hunt online gave &#8220;Fred Smith&#8217;s&#8221; CV full of other useful info which alowed other info to be googled for&#8230;</p>
<p>The second stage of enumeration is likewise difficult to stop without carefull thought. Almost invariably the information that gets out here is due to &#8220;Business goals&#8221;, and whilst IT solutions can partialy mitigate these problems, if there is a hole in your ICT perimeter through which data passess then people can see it to some degree (hence the idea behind &#8220;air gapping&#8221;).</p>
<p>At this point an attacker usually has a host systems location and a whole load of other info. If they are a type three adversary they have a whole host of possibilities open to them one of which is to get physical access to the machine or electrical connections to it which EmSec attacks might be carried out. Simillar applies to a knowledgable type two or one adversary who is also an insider.</p>
<p>But there are other significant holes by which air gaps are crossed, many of which are due to &#8220;crap software production&#8221; or an emphasis on &#8220;usability&#8221; over &#8220;security&#8221; (think USB issues).</p>
<p>As @ Nick P and myself have discussed in the distant past &#8220;code signing&#8221; is actualy in the main &#8220;security theater&#8221;. This is because all it actually does is attest to the fact that at some point somebody with access to the secret key has used it to sign a hash of a block of code.</p>
<p>Nothing more, that is it says nothing about the code or where it&#8217;s come from. Thus all that is needed is either access to the code upstream of signing, the private key or a way of finding colisons in hashes. Of the three a quick &#8220;black bag&#8221; or &#8220;insider theft&#8221; is all that is required to get code into the upstream side or a copy of the code signing key in the majority of cases.</p>
<p>Prior to Stuxnet Nick P was going through a thought process of how to improve this situation and as no dout he will admit it&#8217;s not an easy task.</p>
<p>Now we have Flame as well as Stuxnet, and people regularly getting into CA&#8217;s to make fake certificates indicating that all three methods of attack are fully viable attack vectors for even type one adversaries. Proving to some peoples horror that &#8220;information loves to be free&#8221; of constraint, thus security based on constraint of information is a very hard problem and not even amenable to audit unless you&#8217;ve 24&#215;365.25 hard assed physical security (see A1 requirments) throughout the entire system life time.</p>
<p>Thus getting a toe hold can be done by the simple process of being at a point &#8220;upstream&#8221; of the host system&#8217;s security patch process&#8230;</p>
<p>Are there preventative measures, yes but only for some attacks and by amd large only to type two and three organisations who can use many access points to check the signed patches are genuine (as far as the code provider can tell&#8230; so not realy at all).</p>
<p>So one potential mittigation is to run an original CD copy of &#8220;old code&#8221; and don&#8217;t patch it or upgrade it on a properly &#8220;air gapped&#8221; system.</p>
<p>Does it sound practical in our modern world? No not realy although some of us still do have Win 3.1 / MSDOS 5 and code development systems from the 1980&#8217;s including a hand built C compiler and tool chain (have you ever seen a cross platform two pass assembler written in Apple Basic? 😉</p>
<p>Thus the assumption has to be these days that even type one attackers in the right place can effect general security greatly, whilst more targeted attacks are still in the relm of type two and three adversaries.</p>
<p>And the follow on from this is you cannot trust anything you don&#8217;t have 100% control over and even type three organisations have moved out of this relm due to COTS requirments.</p>
<p>Thus the only current solution to this is &#8220;voting protocols&#8221; on diversity sourced hardware to try and establish &#8220;trustworthiness&#8221; on a continual and ongoing basis.</p>
<p>Does this sound OK to you so far?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180626">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180626">
						June 27, 2012 1:01 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p><cite>“Hmm which &#8220;dirty dozen&#8221; to select<br />
Is the wrong place to start, the first thing to do is set the common and aaccepted back ground for the discussion. .</cite></p>
<p>I tried that twice already. And this is the second time you say “this is the wrong place to start”. When I first read Security-V-Efficiency post, I kept it in the back of my mind. I knew what you were talking about <i>exactly</i>. I only responded when I saw another post (The response to BitSplit and his new password idea) from you that seemed to negate your Security-Efficiency claims, then I asked you to clarify. That is how the discussion started with me. I quickly realized, as I have with others in the past, that the terminology we use is not consistent. Terms like “Security”, “Trust”, “Trustworthy”, “Efficiency”, and even “hypervisors” or “Virtual Machine Monitors”. So I decided to set a common plateau, so to speak, by posting something about what security means. I thought that would be the right place to start.</p>
<p><cite>The next realisation just to make it even more fun is to realise attacks come in two very basic forms …,</cite></p>
<p>Now you are talking about attacks and their classifications. It is accepted that there are 3 classes of attackers. Class I, II, and III.<br />
Differences are more or less delineated (IBM classification).</p>
<p><cite>And the follow on from this is you cannot trust anything you don&#8217;t have <strong> 100% control over </strong> and even type three organisations have moved out of this relm due to COTS requirments.<br />
Thus the only current solution to this is &#8220;voting protocols&#8221; on diversity sourced hardware to try and establish &#8220;trustworthiness&#8221; on a continual and ongoing basis.</cite></p>
<p><strong> 100% control over </strong> is a subset of <strong>Total assured control</strong> in the security definition I posted earlier.</p>
<p><cite>Does this sound OK to you so far?</cite><br />
Sounds OK.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180627">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180627">
						June 28, 2012 2:37 PM					</a>

				</p>

				<p>@ Wael on the security weaknesses &amp; countermeasures</p>
<p>I&#8217;ll note that the Orange Book and Common Criteria requirements address a number of those. I don&#8217;t have an enumeration I go by. I think of it in terms of layers, system components, and interactions. That let&#8217;s me spot old things and new potential weaknesses. An example was when I avoided the &#8220;hyperthreading&#8221; feature for any MLS usage b/c I figured it was a glorified timing channel. Two decade old methods could prove this. Modern academics eventually did. (Not to say checklists, enumerations, etc. aren&#8217;t useful: they would be part of any commercial development I did in this area.)</p>
<p>First, though, I have to be clear who I&#8217;m defending against. Almost all the products on the market assume the administrator is trustworthy &amp; the box isn&#8217;t in bad guy&#8217;s possession. There are tamper-resistant products that try to deal with these situations, but I&#8217;m currently focused on eliminating remote attacks. I say let&#8217;s deal with the 14 year old kiddies &amp; state sponsered 0-day problem before we try to use technical solutions to stop insiders &amp; physical attacks. (That said, I try to keep outside ports DMA-free &amp; use tamper-resistance or 3rd party verification where useful.)</p>
<p>So, how do remote attacks happen? Generally, they will exploit a hardware/firmware bug, software bug, overprivileged piece of usable functionality, or misconfigured piece of privileged functionality. I&#8217;ll add special categories for attacks on protocols, attacks that use cross-platform portable OS&#8217;s (err, web browsers ;), and those that trick user into escalating privilges. If we deal with these, then we&#8217;ve knocked out the vast majority of options the attacker has.</p>
<p>Guess what? Much of it is doable with the right design or tools. Let&#8217;s start with how Orange Book B2-A1 (EAL5-7) systems handled things. They were required to use hardware features as much as possible: dedicated hardware optionally; rings to protect OS from apps &amp; security kernel from OS parts; MMU; segments commonly acted as a less functional IOMMU. So far, the design ensures that security can be enforced at a granular level even if apps or certain OS functionality is compromised. The enforcer is also very small to allow top notch verification. Modern separation kernels follow suite, typically 10KLOC or less.</p>
<p>(Note: Capabilities have been the most popular primitive recently to use for access control purposes. From seL4 to the A1 LOCK design, they&#8217;ve matured overtime. They can be used to implement the conceptual ring models, access/integrity control, etc.)</p>
<p>The systems required other features. For one, a trusted path was required to let the user be absolutely sure they were talking to the system &amp; not a hacker. Additionally, &#8220;trusted&#8221; window managers were demanded a la CMW to label/color various windows by security level &amp; control how information was shared between them. TX is an older example. Modern Nitpicker GUI combines these concepts a bit to provide a way for applications to undisputedly prove the user input &amp; output are on the right path, with very little code in TCB. Pitbull turns Solaris into a CMW, but with huge TCB &amp; less assurance.</p>
<p>These two strategies, combined, would stop attacks that spring from a non-critical app to the system level or from non-trusted OS part to trusted component. The user couldn&#8217;t even authorize a browser- or app-based execution strain to access critical OS functionality. There goes most rootkits. I&#8217;ve added special update modes &amp; unspoofable screens to the concept to allow that stuff to be safe. What&#8217;s next? Oh yeah, ensuring correct information flow &amp; keeping software defects (possible vulnerabilities) low.</p>
<p>The early systems gave us ideas there. C was avoided for most privileged software in Multics &amp; GEMSOS to make verification easier. Additionally, they used Parnas information hiding, modularization, strong module to spec correspondence, tons of tests, static analysis, &amp; call-by-value where possible. This tells us to use safe languages, libraries, design strategies &amp; coding patterns. It also tells us to do things in a way that our tools can analyze &amp; catch problems. Lastly, it tells us to TOTALLY AVOID doing something whose effects we can&#8217;t predict, like tons of hyper-efficient pointer magic. Praxis&#8217; Correct by Construction approach is a modern continuation of a subset of these principles.</p>
<p>The above paragraph mostly pertains to an individual piece of software. The best method so far for local systems is to define their behavior, model security, etc. by modeling each individual component, modeling interactions of components at well-defined interfaces, &amp; analyzing these. So, both formal and informal methods can be used to see any influence a given component has over another component &amp; to see information flows in the system. Illegal information flows can be detected &amp; the design changed to minimize or remove them.</p>
<p>Now, connect something to a network &amp; everything changes, eh? Well, this was the problem they had in an early A1 project, the BLACKER VPN. They noticed that a group of participating devices was essentially a system as well, just at higher granularity. So, they did the local level modeling to prove system level components, but also modeled interactions between systems (esp on any shared state). There are many variations on this to handle proving properties on networked systems, including decentralized. How they talk to each other is important, though. This leads us to protocols.</p>
<p>Personally, I hate protocols. They seem like they should be so easy to get right. Yet, years of brains thrown at certain conceptually simple protocols has yielded mistake after mistake after mistake. A number could have been avoided: poor implementation, models way to abstract to capture important details, etc. Yet, what do we do? Well, it depends on whether we&#8217;re talking comms protocols or security-critical protocols. For the former, just use Google&#8217;s Protocol Buffers or similar setup that automagically handles it. Try to get the logic right, handle problems gracefully, etc. For the other type, read on &amp; bear with me.</p>
<p>I think we should just not trust protocols. In the past, I said we should have several ways of doing something that can be randomly chosen (or each explicitly avoided if weakness is found). Others contended that we do security protocols in app-level virtual machines or interpreters where they can include their definition with them, with us able to swap them out at will. Others promote formal proofs of design correctness, autogeneration of protocol handlers from specs, etc. My friends, I still don&#8217;t have an answer as I&#8217;m not a protocol wizard (and they screwed up enough). So, here&#8217;s what I&#8217;ve been doing in designs. 😉</p>
<p>I assume the protocol will be flawed. I include a protocol number field &amp; tell the handler to have a plug-in approach to protocols, able to hand off the computation to whatever module is necessary. Then, have several protocols to rely on that each used whatever assurance techniques they wanted from above paragraph. The protocols should be fail-safe &amp; SIMPLE (see XML-based tech for opposite). They should have minimal opportunities for info leakage, DOS, etc.</p>
<p>Examples include using JSON or certain ASN.1 instead of XML; UDT instead of TCP for reliable transmission; preloaded public key recognition instead of CA&#8217;s for authentication; encrypted messages encapsulated by proven crypto tech instead of whatever &#8220;new improved&#8221; crap they&#8217;re using. It&#8217;s really all just risk reduction principles, minimizing complexity, &amp; shoehorning new functionality into existing protocols IF SENSIBLE (i.e. crypto example or UDT using UDP).</p>
<p>Almost an afterthought: firmware, peripherals, etc. I&#8217;ve found that many attacks on this kind of stuff requires privilged access. The methods above largely prevent that. This makes it a non-issue in many cases. This may be why it was ignored in the old days. Today, we have to consider it for clients, esp thanks to the likes of firewire &amp; USB. I recommend a good IOMMU on all processors &amp; trusted boot process that allows safe update of firmware, trusted OS components, &amp; other software. USB HID needs to be revisited, as it can defeat many DLP software. (I just disable anything I can&#8217;t trust.) Processor errata can be reduced by verification technology (VAMP, AAMP7G) or using processors that are less complex than x86 (PPC, MIPS). VIA Padlock style onboard TRNG, crypto acceleration, etc. is a plus.</p>
<p>Browsers? Avoid them where possible. They were created to deal with the fact that cross-platform &amp; networked applications weren&#8217;t happening very well. Today, we have numerous mature toolsets for doing that well. If the app itself can&#8217;t be made portable, then the way it interacts can &amp; you can use whichever tool you want. The Apache Portable Runtime is nice on server side, while there are numerous cross-platform GUI toolkits. Interactive shell minimalism is also possible. However it is approached, privilges, complexity and TCB should be kept to a minimum.</p>
<p>Another side of it is handling security-critical functionality. Let&#8217;s say we have a trustworthy platform with many features I&#8217;ve described above. You can trust its key generation, crypto, storage, auditing, access control, etc. Wherever possible, the large risky applications should offload security-critical functionality to the OS or more trustworthy applications. This has been promoted by microkernel advocates for a while &amp; the embedded virtualization vendors are targeting their products for it.</p>
<p>Additionally, the apps should offload privilges when possible, so a privileged launch != a privileged compromise. Multiple processes that communicate with each other can be used to emulate this, as DJB did in qmail. Using multiple, inexpensive devices together to segregate information &amp; functionality can help as well. I did this  in my transaction appliance posted on Schneier &amp; Krebs blogs.</p>
<p>As I closed, multithreading and scalability come to mind. There&#8217;s been many formal methods (e.g. CSP), special languages (e.g. X10, Cilk), and entire books around to deal with the incredible issues that come from that. I recommend app developers using platforms or design approaches that minimize those issues whereever possible. One for scalable, correct multi(whatever) apps that&#8217;s I&#8217;ve come to like recently is ZeroMQ. It seems like a magic bullet for that stuff &amp; makes it superbly easy in tons of languages. There&#8217;s similar languages/frameworks aiming to solve security problems in general in web development, like SIF &amp; Opa. Time will tell.</p>
<p>Anything I miss? Comments? Criticisms? Massive amounts of funding? 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180628">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180628">
						June 29, 2012 2:42 AM					</a>

				</p>

				<p>@ Nick P</p>
<p>Good that you identified your threat domain. I will need some time to digest your post. For some reason, your comments and Clive Robinson&#8217;s take some time to understand.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180629">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180629">
						June 29, 2012 11:22 AM					</a>

				</p>

				<p>@ Wael</p>
<p>Awesome. It&#8217;s natural for Clives posts to be a tad difficult to follow. As  for mine, it must be that a certain amount of assumed knowledge comes with my posts. Assume reader knows a lot, my post is condensed with stuff they dont get. Assume too little, i have to drop small books. So, it&#8217;s prolly a sign im gradually figuring out your lvl of background knowledge.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180630">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180630">
						June 29, 2012 11:52 AM					</a>

				</p>

				<p>@ Nick P</p>
<p>The time consumed (not difficulty) arises from starting a thread and ending up discussing a branch of a branch of a branch of the original topic and its uncles. Now I am trying to go up the stack again, and bypass the ancillary branches that were traversed on the way down.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180631">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180631">
						July 1, 2012 9:17 PM					</a>

				</p>

				<p>@ Nick P</p>
<p>&#8220;Massive amounts of funding?&#8221;</p>
<p>Not yet Nick P! This is a massive amount of information. I am not sure where to start. Where is the prison model in this?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180632">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180632">
						July 2, 2012 2:44 AM					</a>

				</p>

				<p>@ Wael,</p>
<p><i>Massive amounts of funding?</i></p>
<p>I wish 🙂 everyone you speak to these days say&#8217;s &#8220;Money what money, we barely keep our noses above water&#8221;&#8230;</p>
<p>With regards,</p>
<p><i>Where is the prison model in this?</i></p>
<p>Like the dungeons of old it lurks way beneath the glitz and glamour where the traditional courtly activities visitors are treated to take place 🙂</p>
<p>If you take a look at the traditional single CPU multi-tasking OS &#8220;onion&#8221; model you have three main layers.</p>
<p>1, Hardware.<br />
2, Kernel.<br />
3, User software.</p>
<p>With each layer subsiquently broken down a little further into other segmented layers in subsiquently more detailed models.</p>
<p>In the kernel layer you see it traditionaly split into user (U) space and kernel (K) space for shared memory and generaly a very simple interface based around software interupts between the two.</p>
<p>This simple interface is actually a rather usefull &#8220;pinch point&#8221; which is where conceptualy the prison door goes where the &#8220;Uside&#8221; (User / Untrusted prison) &#8220;Kside&#8221; (Kernel / corridor) are actually running on different CPUs etc.</p>
<p>Provided the CPU MMU&#8217;s are correctly controled by the Hypervisor stack then any task on the Uside is kept locked up with all access to the outside world and other parts of the system controled by the Hypervisor stack.</p>
<p>This is also a place frequently chosen by OS designers for mult CPU multi-tasking hardware to split tasks up to put on seperate CPU&#8217;s (with one CPU delegated with also running the Kernel etc to simplify design).</p>
<p>So from the User / task side it all looks just like a typical *nix setup. And importantly it uses the same basic IPC API&#8217;s (with certain restrictions). So anybody used to doing typical &#8220;shell prototyping&#8221; on *nix where the shell provides the &#8220;pipes&#8221; would not see any real difference.</p>
<p>On the Kside it&#8217;s very different and has the Hypervisor stack mediating all activities. The IPC restrictions are to allow the Hypervisor and scheduling system to work effectivly. Whilst shared memory is possible this is considered very undesirable except in the previously described buffer processes (as shared memory opens all sorts of potential side channel issues). So IPC is treated in the same way as other communications streams. Unlike other multitasking systems with either few or one CPU where, when a task &#8220;blocks&#8221; a CPU performs a complex context switches into another task, each Prison CPU only has a single occupant task and thus just halts (allowing the hypervisor to sniff registers and memory etc). This actually allows for quite a simplification of the Kside design which further aids the security objective of reducing complexity.</p>
<p>Does that answer &#8220;where is it question&#8221;?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180633">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180633">
						July 2, 2012 1:07 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>&#8220;Does that answer &#8220;where is it question&#8221;?&#8221;</p>
<p>It does &#8212; thank you!</p>
<p>Sounds like:<br />
Nick P&#8217;s model: Old school<br />
Clive Robinson&#8217;s Model: Hypermodern</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180634">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180634">
						July 3, 2012 11:45 AM					</a>

				</p>

				<p>@ Wael</p>
<p>I can&#8217;t repeat enough that Clive labeled my model &#8220;castle&#8217;s&#8221; &amp; it would be easier if you drop the whole analogy, instead focusing on the design description. Mine is a bottom-up design focusing on extensive prevention, info control, breach containment, &amp; legacy reuse. His uses very-fine-grained decomposition, a special type of POLA, signature monitoring, &amp; little to no legacy capabilities.</p>
<p>I&#8217;d love to try his but I still can&#8217;t see it being implemented in hardware. (I&#8217;m not a hardware guy either, so it&#8217;s hard to wrap my mind around practicality of a totally radical hardware approach.)</p>
<p>To see radical stuff that&#8217;s being built, see DARPA Clean Slate contestants below.</p>
<p>Preliminary design of SAFE platform<br />
<a href="http://www.crash-safe.org/sites/default/files/plos11-submission.pdf" rel="nofollow ugc">http://www.crash-safe.org/sites/default/files/plos11-submission.pdf</a></p>
<p>TIARA architecture<br />
<a href="http://dspace.mit.edu/bitstream/handle/1721.1/37589/MIT-CSAIL-TR-2007-028.pdf?sequence=1" rel="nofollow ugc">http://dspace.mit.edu/bitstream/handle/1721.1/37589/MIT-CSAIL-TR-2007-028.pdf?sequence=1</a></p>
<p>SAFE will be easier to build. There was a prototype of its concreteware by the time they published that paper. TCG types might like TIARA better, though. It has so many neat attributes. I suspect both of these, based on a &#8220;castle&#8221;-like approach, will be more practical than Clive&#8217;s prison approach. Also, designers that take my approach will have an easier time retargeting their systems to these platforms. Might also be able to port some legacy stuff to SAFE with auto-translation technologies (a la Semantic Designs Inc.).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180635">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180635">
						July 3, 2012 11:52 AM					</a>

				</p>

				<p>Nick P</p>
<p>Sorry &#8211; my bad &#8230;</p>
<p>You said previously.<br />
&#8221; His is the Prison, mine was the Castle.&#8221;</p>
<p>Somehow it was reversed in my head&#8230;<br />
Dropping analogy as you suggested &#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180636">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180636">
						July 11, 2012 3:11 PM					</a>

				</p>

				<p>@ Clive Robinson, Nick P</p>
<p>I know my timing is off, I should be talking about the subject du jour, but I have to get this action item off my back &#8230;</p>
<p>Looking back at our discussions on C-v-P:<br />
I see validity in both approaches. Nick P&#8217;s approach makes sense. Close all holes or entrances that have been known to cause problems (DMA, Browsers, &#8230;) then make sure the system has an immutable state that can be initialized to, if needed &#8212; an immutable bootblack / boot loader. I also see Clive Robinson&#8217;s approach as a valid one, and makes sense too. Although maybe harder to implement. The one thing I have not been able to grasp in his approach is the threat he protects against. Both approaches also push the limits of S-v-U &#8212; Security versus Usability.</p>
<p>My interest however was in the model. Or a combination of both approaches, since I see them as complimentary, and not necessarily orthogonal, or mutually exclusive. I just want to say, both approaches have their own charm. As for Clive Robinson&#8217;s &#8220;Don&#8217;t worry most people I know off who write C code I would not consider to be programmers but &#8220;Code Cutters&#8221;. Come on Clive! That&#8217;s just pure Bull S**t 😉 Listen to what they say!<br />
<i><br />
We had a programer with a slight stutter<br />
Who&#8217;s code had an overflow in the buffer<br />
    He saw some code on the &#8216;net<br />
    And copied some of&#8217;et<br />
But claimed he ain&#8217;t no code cu-cu-cu-cutter<br />
</i><br />
Hopefully I got the structure, meter, and rhyme close this time 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-180637">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180637">
						July 11, 2012 5:36 PM					</a>

				</p>

				<p>@ Wael</p>
<p>Timing is fine. Or about darned time. Whichever. 😉</p>
<p>Yeah, they certainly push usability to the limit. No doubt about that. I was thinking about trying to secure appliance-type offerings first. As for general purpose stuff, thin clients are straightforward enough to take my approach. Matter of fact, Aesec has a thin client prototype/design for their A1/EAL7-class GEMSOS security kernel. More recent companies have been doing that. Then there&#8217;s VPN&#8217;s, web servers, app servers, databases, etc. You can also accomplish plenty in security in user-land (e.g. tripwire) &amp; with middleware (e.g. message broker) if you can trust the underlying platform. As for a full GP computer, eh I see serious usability issues too. However, many roles don&#8217;t need those capabilities. Heck, many companies run DOS-like apps for their critical stuff. I&#8217;m sure even an ancient B3/A1 system could run those pretty fast, ya think? 😉</p>
<p>Re Clive on code cutters</p>
<p>I think there&#8217;s merit in what he says. The comment has some unstated premises though. In his previous statements and our discussions, the idea that software development and engineering (hardware or in general) are very different. There are engineering-style ways of producing quality software, but most developers don&#8217;t use them. Theirs is an art and, from a quality perspective, it sucks. Hence, his negative term &#8220;code cutters&#8221; for people throwing stuff together or to a lesser extent using low quality methods to produce software.</p>
<p>Ignoring radical full Agile methods, there are numerous software production methods that have empirically-measured higher success at achieving requirements, keeping defects low, etc. If you want to look them up, the Fagan Software Inspection Process and the Cleanroom process are two old ones still in use. Newer ones include Praxis Correct by Construction, PSP/TSP, and any that can meet a high security- or safety-critical certification. The latter vary, but the quality is consistently good.</p>
<p>Groups using some of these methods can statistically certify their defect rate &amp; have been known to warranty software. Name a well-known application vendor that will warranty their product against failures. If you can&#8217;t, you might be sensing the difference between results of software ENGINEERING and development/coding. 😉</p>
<p>Note: High quality code can be made without such methods. It&#8217;s just harder to do &amp; requires more skilled labor &amp; effort. Also, requires time to pass to watch bug count, as typical development has less predictable bug count.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-180638">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/#comment-180638">
						July 11, 2012 5:42 PM					</a>

				</p>

				<p>@ Nick P</p>
<p>&#8220;Re Clive on code cutters, I think there&#8217;s merit in what he says. &#8221;</p>
<p>I know, and I agree with Clive. I&#8217;s just my sense of humor 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2012/06/friday_squid_bl_330.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2012/06/friday_squid_bl_330.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F06%2Ffriday_squid_bl_330.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2012/06/friday_squid_bl_330.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='4370' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2012/06/the_catastrophi.html" rel="prev">← The Catastrophic Consequences of 9/11</a>		<a href="https://www.schneier.com/blog/archives/2012/06/changing_survei.html" rel="next">Changing Surveillance Techniques for Changed Communications Technologies →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
