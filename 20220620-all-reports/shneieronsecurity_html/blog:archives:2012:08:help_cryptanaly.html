<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Help Cryptanalyze Gauss - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Help Cryptanalyze Gauss Comments Feed" href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/4477" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=4477' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F08%2Fhelp_cryptanaly.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F08%2Fhelp_cryptanaly.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-4477 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-4477" class="post-4477 post type-post status-publish format-standard hentry category-uncategorized tag-cryptanalysis tag-cryptography tag-encryption tag-gauss tag-kaspersky">

	<div class="article">

		<h2 class="entry">Help Cryptanalyze Gauss</h2>
		<p>Kaspersky is looking for <a href="http://www.infosecurity-magazine.com/view/27590/information-please-kaspersky-lab-needs-help-decrypting-gauss-warhead/">help</a> <a href="http://www.esecurityplanet.com/malware/kaspersky-seeks-help-decrypting-gauss-malware-payload.html">decrypting</a> <a href="https://www.securelist.com/en/blog/208193781/The_Mystery_of_the_Encrypted_Gauss_Payload">the</a> <a href="http://www.theregister.co.uk/2012/08/14/gauss_mystery_payload/">Gauss</a> <a href="http://www.pcmag.com/article2/0,2817,2408459,00.asp">payload</a>.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/cryptanalysis/" rel="tag">cryptanalysis</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/encryption/" rel="tag">encryption</a>, <a href="https://www.schneier.com/tag/gauss/" rel="tag">Gauss</a>, <a href="https://www.schneier.com/tag/kaspersky/" rel="tag">Kaspersky</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html" rel="bookmark">Posted on August 21, 2012 at 5:53 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html#comments">32 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html" data-title="Help Cryptanalyze Gauss" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-184873">

			<div class="comment by-mikko0j ">

				<p class="commentcredit">

					<span class="commenter">mikko0j</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184873">
						August 21, 2012 6:06 AM					</a>

				</p>

				<p>Bruce.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-184874">

			<div class="comment by-chris-w ">

				<p class="commentcredit">

					<span class="commenter">Chris W</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184874">
						August 21, 2012 6:50 AM					</a>

				</p>

				<p>As mentioned in the friday squidy blog this might be rather difficult to do.</p>
<p>It is obvious the Godel payload isn&#8217;t looking for any commonly used installed application. But rather an application rather specific for the target, whether it may be a banking system, industrial or government system. Without access to those systems it will be nearly impossible to find out. On the other hand, it is reasonably likely the targets already discovered their infected systems and will be able to decipher the payload. Unfortunately for us that will not be public.</p>
<p>I guess modern anti-virus will have to designate iterating through Program files as suspicious behavior.</p>
<p>From a cryptanalysis perspective it basically comes down to a md5 pre-image attack or an attack on RC4 stream cipher.<br />
Neither seem feasible at this point. The best known pre-image attack on md5 has ~2^123 complexity, out of the 2^128 for bruteforce, so not practical.<br />
In relation to the RC4. We only have the magic value of 0x20332137 at position 0 OR 7 of the plaintext to go with. Position 0 seems unlikely though, coz according to my assembler 0x20332137 is pretty much useless as first instruction.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-184875">

			<div class="comment by-ac2 ">

				<p class="commentcredit">

					<span class="commenter">AC2</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184875">
						August 21, 2012 6:56 AM					</a>

				</p>

				<p>Store the payload on tape and run an electromagnet over it which chanting &#8216;Bruce Schneier&#8217;&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-184876">

			<div class="comment by-ac2 ">

				<p class="commentcredit">

					<span class="commenter">AC2</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184876">
						August 21, 2012 6:58 AM					</a>

				</p>

				<p>Err &#8220;&#8230; WHILE chanting &#8216;Bruce Schneier'&#8221;&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-184877">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184877">
						August 21, 2012 8:32 AM					</a>

				</p>

				<p>As also commented of Fiday Squid page there are some other oddities, like the fact it loads a narrow pitch font into the system (why is an open question though I can think of a number of reasons)</p>
<p>@ Chris W,</p>
<p><i>In relation to the RC4. We only have the magic value of 0x20332137 at position 0 OR 7 of the plaintext to go with. Position 0 seems unlikely plaintext to go with. Position 0 seems unlikely though, coz according to my assembler 0x20332137 is pretty much useless as first instruction.</i></p>
<p>I guess it depends on how the code is ment to be loaded and then jumped into for execution.</p>
<p>On the assumption it is &#8220;known plaintext&#8221; to check the decryption has worked correctly is 32bits sufficient to prevent a &#8220;false start in on garbage code&#8221;? at an ~1 in 4billion chance it might actually not be.</p>
<p>The &#8220;fastest hope&#8221;  we have currently is from the potential &#8220;targets&#8221;. That is if somebody found that their machine had been identified &#8220;correctly&#8221; by some method, and posted either the resulting ARC4 key or actuall code up on an anonymous site somewhere.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-184878">

			<div class="comment by-gubmint ">

				<p class="commentcredit">

					<span class="commenter">gubmint</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184878">
						August 21, 2012 8:46 AM					</a>

				</p>

				<p>Just put it in a virtual machine emulating nuclear SCADA devices and change the language to Farsi. Kind of obvious this is prob yet another Israeli/US made malware</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-184879">

			<div class="comment by-captain-obvious ">

				<p class="commentcredit">

					<span class="commenter">Captain Obvious</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184879">
						August 21, 2012 8:56 AM					</a>

				</p>

				<p>@Chris</p>
<p>If it&#8217;s looking for something specific, it shouldn&#8217;t be iterating through Program Files.  It will make one check which will pass or fail.</p>
<p>Perhaps programs could be restricted from modifying anything outside their own directory without special approval.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-184880">

			<div class="comment by-cerebus ">

				<p class="commentcredit">

					<span class="commenter">Cerebus</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184880">
						August 21, 2012 9:34 AM					</a>

				</p>

				<p>Very nice work.  Basically this is a two-round variation of PBKDF#2; the first round finds the trigger application, and second round derives the key.  The high iteration count is just paranoia at work; c=10K is overkill.</p>
<p>Very fragile work, though.  Gauss is defeated by renaming the directory.</p>
<p>&#8212; C</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-184881">

			<div class="comment by-peter-maxwell ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.allicient.co.uk/' rel='external nofollow ugc' class='url'>Peter Maxwell</a></span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184881">
						August 21, 2012 9:50 AM					</a>

				</p>

				<p>The analysis given by @Chris W is pretty much correct.</p>
<p>There are really only three ways to attack the problem:</p>
<p>i. find the correct pairing for directory+filename;</p>
<p>ii. pre-image the validation hash digest; or,</p>
<p>iii. derive the internal state of an RC4 cipher that was initalised with a 128bit key using only 32bits of entropy.</p>
<p>So, handling these in reverse order, iii. is not likely to happen as even with RC4&#8217;s oddities, I doubt one would be lucky enough to find a key-partitioning property that would allow retrieval of a 128bit key from only 32bits of data&#8230; it&#8217;s essentially the old unicity distance question.</p>
<p>Now, turning to ii. &#8211; even though md5 is a bit mangled these days, it still is not possible to mount a pre-image attack in practical time (or even near that).  So this option is out.</p>
<p>That leaves us with i.  The process used to construct the key requires taking the cartesian product of the set that is the union of all path variables along with all files in %PROGRAM_FILES% that start with a character value if 7A (irrc), with itself; salting each of those values and hashing 10001 times to try find one digest that matches the validation; if you&#8217;ve found one that matches the validation then salt the original pair with a second value and hash 10001 times to get your key.  Given the potential key-space of each pair is <em>far</em> more than 128bits, one really needs to know what they&#8217;re looking for (just think, even a microsoft GUID is 128bit).</p>
<p>The bottom line is that, unless one has a massive stroke of luck, you need to know what system is targeted.  Fairly clever really.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-184882">

			<div class="comment by-james-sutherland ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.deadnode.org/' rel='external nofollow ugc' class='url'>James Sutherland</a></span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184882">
						August 21, 2012 10:13 AM					</a>

				</p>

				<p>&#8220;Just put it in a virtual machine emulating nuclear SCADA devices and change the language to Farsi. Kind of obvious this is prob yet another Israeli/US made malware &#8221;</p>
<p>Setting language to Farsi won&#8217;t help you &#8211; from the p-code the Kaspersky guy posted online, it only tries hashing the first directory name in program files starting with { (or higher) &#8211; either the hash matches, or it gives up. Give it a bunch of non-ASCII-named programs, even if it does have the target installed you&#8217;ll never get a hit!</p>
<p>(In fact, NTFS uses a B*-tree, meaning the enumeration will be in ascending character order &#8211; so if the target name does start with {, neither higher nor lower characters will interfere. The bigger the distance between { and the actual first character, the more likely it is to trip over false positives.)</p>
<p>I also suspect the use of PATH is obfuscation, with the value used being C:\WINDOWS or C:\WINDOWS\system32 &#8211; effectively just an extra bit of salt, with the program file being the real goal. Still, without knowing what vulnerable application installs in a GUID-named ProgramFiles directory, it remains anybody&#8217;s guess!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-184883">

			<div class="comment by-peter-a ">

				<p class="commentcredit">

					<span class="commenter">Peter A.</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184883">
						August 21, 2012 11:15 AM					</a>

				</p>

				<p>@captain obvious: if the code made only one check it would be obvious what it&#8217;s looking for. Now it is looking for <em>some</em> program out of huge number of software packages out there and nobody will know which one unless someone actually installs (or pretends to install) the right one. Tricky.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-184884">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184884">
						August 21, 2012 12:13 PM					</a>

				</p>

				<p>@ Peter A., Captn Obvious,</p>
<p><i>Now it is looking for <em>some</em> program out of huge number of software packages out there and nobody will know which one unless someone actually installs (or pretends to install) the right one. Tricky</i></p>
<p>It might not be as tricky as we think.</p>
<p>First off the number of packages is very finite in number and way way way less than 128bit equivalent required for a brute force attack.</p>
<p>Due to &#8220;forensic investigation&#8221; there are already databases of package names directory structures and component file hashes. Admittedly most are for standard packages but they can be used to find/eliminate fairly quickly.</p>
<p>I suspect that the details of many other packages will quickly become known as well now there is a reason to search for them.</p>
<p>There is also another way to find out and that is by using a similar &#8220;attack vector&#8221; as used by the main body of Gauss&#8230;.</p>
<p>That is write a piece of malware and instead of delivering the &#8220;Godel package&#8221; get it to report back with matching directory structures. The chances are within aa very short time it would deliver up a candidate (otherwise Gauss would not have got there in the first place).</p>
<p>The question becomes who the writers are hidding the code from and why. If it&#8217;s from the general masses then the plan might work against them but what about others?</p>
<p>I will make an assumption that Gauss/Godel left recognisable traces that might (or might not) still be valid by which it can be recognised.</p>
<p>I will further assume that those attacked will consist of &#8220;intended targets&#8221; and &#8220;collateral damage&#8221;.</p>
<p>Primary targets are potentialy going to keep quiet, but what of collateral damage sites? We know from how Gauss was discovered that &#8220;people reach out for help&#8221; in this case it was via the ITU.</p>
<p>Collateral damage sites don&#8217;t have any real reason to keep quiet, thus the question then becomes can Gausses prescence or previous precence be determined?</p>
<p>Even if Gauss/Godel had a self erase function it will nomatter how they do it leave recognisable traces behind.</p>
<p>That is if they uses a secure delete process the result will be significantly different from other areas of the hard disk. Likewise if legitimate data gets copied from another place on the hard drive to overwrite it it will still leave recognisable anomalies. Even if they muck about with the &#8220;free list&#8221; process the chances are that bits will be left behind depending on the size of files etc the host writes to the HD. But even if the blocks do get compleatly overwriten they will be &#8220;out of sequence&#8221; and thus still vaguely visable by &#8220;out of sequence&#8221; disk usage compared to known history.</p>
<p>If nothing else Gauss/Godel may be caught on backup / archive tapes&#8230; In effect that&#8217;s how it was found by Kaspersky in the first place. Remember it was such tapes that brough Ollie North down, so these things do happen.</p>
<p>Thus there is a small chance that a collateral damage site will know it&#8217;s had problems and the prescence of Gauss assumed and the site come forward with it&#8217;s directory structure to unlock the code.</p>
<p>The question then becomes will these people keep quiet or will they spill the beans. Further can / will Kaspersky keep quiet or will they publish an analysis at the very least.</p>
<p>Whilst an analysis may not be helpfull to most people, there are enough lateral thinkers who will read it and be able to re-create a good facsimile.</p>
<p>And at the end of the day it&#8217;s not the actuall Gauss/Godel code that needs to be kept secret but the ideass behind it&#8230; and I realy don&#8217;t think those can be kept quiet&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-184885">

			<div class="comment by-lolbot ">

				<p class="commentcredit">

					<span class="commenter">lolbot</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184885">
						August 21, 2012 12:28 PM					</a>

				</p>

				<p>Make a directory called Seekrit Nuclear Filez or change user to Ahmadinajad, payload decryptz.</p>
<p>This is obviously state made spyware to find out Iranian govt bank accounts they can either fleece illegally or have shut down.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-184886">

			<div class="comment by-joe-buck ">

				<p class="commentcredit">

					<span class="commenter">Joe Buck</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184886">
						August 21, 2012 12:53 PM					</a>

				</p>

				<p>&#8220;I guess modern anti-virus will have to designate iterating through Program files as suspicious behavior.&#8221;</p>
<p>Hmm. What programs commonly iterate through program files?  Anti-virus programs, of course; they are analyzing all programs looking for viruses. So anti-virus programs of the future will flag their competitors as suspect, and the best way to implement really sneaky malware could be to disguise it as an anti-virus program. A government might try to subvert anti-virus companies if they want to do a targeted attack (find a specific target or class of targets to sabotage or gather intelligence on).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-184887">

			<div class="comment by-jimrandomh ">

				<p class="commentcredit">

					<span class="commenter">jimrandomh</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184887">
						August 21, 2012 1:59 PM					</a>

				</p>

				<p>People are assuming that this is looking for an installed program, but I don&#8217;t think that&#8217;s very likely. What seems more likely is that this malware likes to spread key material in hard-to-reach places, so that if a sample is captured it&#8217;s likely to be missing pieces of the decryption key. Under that interpretation, the directory name it&#8217;s looking for in Program Files would not correspond to an actual program, but to a key deposited by another piece of malware (or by a missing piece of this malware&#8217;s installer). Similarly, the font that it installs probably contains some sort of key, to be used by a different stage of the malware&#8217;s unpacker which we haven&#8217;t seen.</p>
<p>If this is true, then nothing short of a complete memory+disk image of the correct target machine will reveal anything interesting. (Or if really unlucky, it might also need firmware images). The interesting thing here is that this malware has gone to such great lengths to protect its payload from analysis; but it looks like we can only speculate as to what that might be.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-184888">

			<div class="comment by-chris-w ">

				<p class="commentcredit">

					<span class="commenter">Chris W</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184888">
						August 21, 2012 3:12 PM					</a>

				</p>

				<p>@Joe Buck</p>
<p>Yes, and practically all anti-virus solutions explicitly tell you not to install them in conjunction with another to avoid conflicts. Or more likely, they tell you to remove the other anti-virus and then install theirs instead. 😉</p>
<p>@Clive</p>
<p>&#8220;That is write a piece of malware and instead of delivering the &#8220;Godel package&#8221; get it to report back with matching directory structures. The chances are within aa very short time it would deliver up a candidate (otherwise Gauss would not have got there in the first place).&#8221;</p>
<p>Albeit illegal I would consider it a very good idea, if the method of spreading wasn&#8217;t via USB. Using the same exploit is unlikely to succeed since both the exploit and the virus signatures are known for a while now. And finding another zero-day would require a significant financial investment.</p>
<p>It is true that the number of different packages existing is much lower than 2^128. But the pool from which those package names derive is bigger.<br />
If you only consider {GUIDs} as directory name, the pool IS 2^128.<br />
The only way to retrieve a list of likely candidates would be to cooperate with the likely targets. I would start with financial institutions in Lebanon.<br />
Although this is conjecture and far from certain. At least we would be avoiding an attack on the crypto at its strongest point. (which, as we occasionally hear here at Schneier&#8217;s blog, is stupid.)<br />
You basically mention the same thing, with collateral targets. But you&#8217;re expecting them to come forward. I think it requires a more active approach.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-184890">

			<div class="comment by-salty ">

				<p class="commentcredit">

					<span class="commenter">salty</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184890">
						August 21, 2012 6:36 PM					</a>

				</p>

				<p>Gauss only needs two file/folder names from program files:</p>
<p>A. Make all possible pairs from the entries of the resulting list.<br />
B. For each pair, append the first hard-coded 16-byte salt and calculate MD5 hash.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-184891">

			<div class="comment by-peter-maxwell ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.allicient.co.uk' rel='external nofollow ugc' class='url'>Peter Maxwell</a></span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184891">
						August 21, 2012 6:48 PM					</a>

				</p>

				<p>@Clive Robinson at August 21, 2012 12:13 PM</p>
<p>&#8220;It might not be as tricky as we think.</p>
<p>First off the number of packages is very finite in number and way way way less than 128bit equivalent required for a brute force attack.&#8221;</p>
<p>Presuming the malware is targetting a specific system or systems, it is quite likely that the required pair will not exist in the &#8220;wild&#8221;, i.e it could quite easily be proprietary software which is not used outside the target institution.  The fact that Kaspersky has put it out to public scrutiny suggests that they do not have the required pair in their records and they will have a very large list of potential pars at their disposal.</p>
<p>There is a small chance you might get lucky but unless you happen to be the NSA or GCHQ, I wouldn&#8217;t waste the time on it.</p>
<p>The acid test here for anyone suggesting that it may not be that tricky would be decrypting the archive.  If you cannot then any speculations of it being easier than it looks are really unfounded.</p>
<p>Sorry for being blunt but it is really that simple.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-184892">

			<div class="comment by-ac2 ">

				<p class="commentcredit">

					<span class="commenter">AC2</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184892">
						August 22, 2012 12:14 AM					</a>

				</p>

				<p>So I guess no one liked the joke about De-Gauss ing the payload&#8230; Le sigh&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-184893">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184893">
						August 22, 2012 1:06 AM					</a>

				</p>

				<p>@ AC2,</p>
<p><i>So I guess no one liked the joke about De-Gauss ing the payload..</i></p>
<p>Perhaps you should ask of your sense of humour,</p>
<p><i>Is mine magnetic or not?</i></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-184894">

			<div class="comment by-roger ">

				<p class="commentcredit">

					<span class="commenter">Roger</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184894">
						August 22, 2012 3:57 AM					</a>

				</p>

				<p>Reading the comments are Kaspersky, it is amazing how many commenters have either not read the description, or have misunderstood it.</p>
<p>SO to quickly recap, what actually happens is:</p>
<ol>
<li> The PATH variable is split on &#8220;;&#8221; (its normal delimiter);</li>
<li> A Windows system call is used to deliver a wide-character list of all entries directly in the Program Files folder (both files and directories), filtered by those where the first character is above 0x7A (&#8220;z&#8221;);</li>
<li> The Cartesian product of these two lists is created. I&#8217;ll call these the list of candidate passphrases;</li>
<li> Each candidate passphrase is then concatenated with a first salt, and repeatedly hashed 10,000 times;</li>
<li> 32 bits of this are compared to a &#8220;magic value&#8221;;</li>
<li> If any passphrases give the correct magic value, they will be processed into a key;</li>
<li> To process into a key, a passphrase is concatenated with a different, second salt, and then repeatedly hashed 10,000 times;</li>
<li> The result of this is used as the 128 bit key for RC4</li>
</ol>
<p>So, a few comments about widespread misconceptions about this process.</p>
<ul>
<li> The items in PATH are unrelated to the Program Files entries. In fact, they don&#8217;t even need to be real directories. Actually, they don&#8217;t even need to be constructed like a directory name. I have tried appending random junk to the end of the PATH, and Windows doesn&#8217;t mind. So if the target machine is already infected by something (which seems likely), the relevant part of the the PATH could potentially be anything.</li>
<li> The item from the Program Files does not need to be the installation directory of an installed application. Again, if the machine is already infected, it could be anything. The restriction to characters above 0x7A does indeed include non-Latin alphabets but it also includes some punctuation marks, including some that Windows uses to name special directories. For example, some special directories have a GUID as name, wrapped in curly braces. There&#8217;s quite a bit of entropy there.</li>
<li> The key has a lot more than 32 bits of entropy. The key is derived down a completely different processing path to the magic value check. The whole 32 bit check thing is to eliminate incorrect choices without giving too many clues to cryptanalysts. It will slightly speed up a brute-force cryptanalysis, but not by much.</li>
<li> The people who designed this knew what they are doing. It is a very smart system. Any &#8220;candidate passphrases&#8221; that have a reasonable chance of being guessed in a simple dictionary attack are almost certainly wrong. On the other hand, the 10,000 times slow-down is there for a reason. Maybe it&#8217;s just &#8220;belt and braces&#8221;, but I suspect it&#8217;s because the actual entropy of their passphrase was about 13 bits below their comfort level. I also suspect that their comfort level is &#8220;total roadblock even for national intelligence agencies.&#8221;</li>
<li> I suspect that the only practical way to attack this is to identify a target machine.</li>
</ul>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-184895">

			<div class="comment by-chris-w ">

				<p class="commentcredit">

					<span class="commenter">Chris W</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184895">
						August 22, 2012 7:17 AM					</a>

				</p>

				<p>@Roger</p>
<p>Aren&#8217;t you making a mistake at Step 5?<br />
There is no mention of the magic number in the &#8216;Validation&#8217; section. Only in the &#8216;Decryption&#8217; section, that section specifies that the magic number of compared to portions of the RC4 decrypted buffer.</p>
<p>&#8220;6. Decrypt the section (RC4), treating its first DWORD as the length of the buffer to decrypt and encrypted buffer starting at offset 4 of the section.<br />
7. Compare DWORDs in the decrypted buffer at positions 0 or 7 with magic value “0x20332137”. Proceed only if any of the DWORDs match.&#8221;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-184896">

			<div class="comment by-roger ">

				<p class="commentcredit">

					<span class="commenter">Roger</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184896">
						August 22, 2012 8:00 AM					</a>

				</p>

				<p>@ChrisW:<br />
&#8220;Aren&#8217;t you making a mistake at Step 5?&#8221;</p>
<p>Ah, you&#8217;re right, I did &#8212; but it doesn&#8217;t make much difference. The check value in the validation phase is 128 bits, not 32.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-184897">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184897">
						August 22, 2012 9:50 AM					</a>

				</p>

				<p>It might be looking for specific programs and maybe use updates or patches to hide start point. I was wondering if maybe it used a either/or on harddrive then feed that into encryption. 128 bits?It could be bigger using module principles. We really have no idea yet how close to true random this thing is using to hide what it&#8217;s doing. That could make it tricky. A lot of steps to try to find forensically if done correctly.</p>
<p>Why hide? The Israelis and NSA, etc. probably has some mathematic or engineering tricks they don&#8217;t want in the wild. Flame is already being looked at as a new way to engineer malware. I still maintain this is a breakout similiar to encryption..</p>
<p>I want to see this thing dissected. I suspect we are going to find some really clever work on this..and there are probably some even higher classified stuff that looks like it was found written on the ship in roswell. 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-184898">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184898">
						August 22, 2012 12:06 PM					</a>

				</p>

				<p>@ Roger,</p>
<p>Aside from the minor glitch your last point,</p>
<p><i>I suspect that the only practical way to attack this is to identify a target machine</i></p>
<p>Is as I&#8217;ve indicated above is probably the easiest way to go to solving this. Because attacking the crypto is probably pointless unless a new break against ARC4 comes up, and a simplistic brut force search is going to take longer than the code will be valid for.</p>
<p>However two questions arise from this,</p>
<p>1, How do you identify a suceptable machine.</p>
<p>2, How do you detect if a machine has been infected.</p>
<p>With in effect the second question giving rise to the only legal way of answering the fisrt (though I have sugested a less than legal way above).</p>
<p>To answer the second question is actually quite complicated because it&#8217;s probably time dependent when looking for side effects.</p>
<p>However I suscpect the developers missed a trick, as you describe it there is no need for the full payload to be provided for the initial detector to work (your numbered point 7).</p>
<p>Thus a sugestion is how about including a detector in the next update of AV software that runs upto stage 7? There is a reasonable probability it will be detected (if the target machines run AV software).</p>
<p>That is we look for the &#8220;known signiture&#8221; rather than the &#8220;unknown effects&#8221; of the payload.</p>
<p>However if a match is found do we get to know about it?&#8230;</p>
<p>We are back to my point about the primary target and the collateral damage sites. Will one of either group come forward witth the key [we don&#8217;t actually need to know the director structure to decode the payload just the resulting key].</p>
<p>If not then we will have to go back to the other options.</p>
<p>As I mentioned a simplistic brut force attack against a 128bit unknown text is pointless as it will take a lot longer time than I have.</p>
<p>But does the search have to be simplistic?</p>
<p>If you think about it most program names suffer from the same failing as passwords in that they usually have to be &#8220;human interpretable&#8221; to be memorable thus usable. Human memorable passwords usually make a very very tiny fraction of all the available random password space, which is why the likes of rainbow tables and password lists work.</p>
<p>Thus I suspect that due to this the actuall &#8220;real world&#8221; search space on program names is going to be much less than 2^32 and could be down below 2^20. Hence my comments above about forensic databases.</p>
<p>More importantly unlike passwords the program developers were unlikely to be trying to obsficate the human memorable name as they would not consider it to be a secure more probably &#8220;public knowledge&#8221;.</p>
<p>Now as others have sugested the information may be currently unknown as the program name etc may be in a non English language and be semi or fully custom in nature.</p>
<p>I don&#8217;t think that this is such a hurdle as others are making out.</p>
<p>Unless this attack was designed very specifficaly for a single target for which a high degree of intel is known then the information is out there and deducable as the Guass writers or their sponsors did.</p>
<p>As an example, let us assume it&#8217;s looking for a banking application program. The bank it&#8217;s self is unlikely to make the name of the program or it&#8217;s derived files secret. Thus if you know who the likely targets are you may well be able to find out which banks they use.</p>
<p>However the downside of this for the Guass writers is the number of targets it would attack would be effectivly the same as the number of bank customers at that level, which is likely to be in the thousands.</p>
<p>But I also think that the mechanism could not be highly targeted simply because the implication of this is an &#8220;insider&#8221; who has actuall access to the machine. In which case why go to all the trouble of developing and testing Gauss knowing full well it has a high probability of being found.</p>
<p>Thus I suspect that the actual number of targets that Guass could potentially attack is probably in the low thousands</p>
<p>Which makes the odds of somebody coming forward much much greater than might at first be thought.</p>
<p>Further what would probably help identify the potential targets is effectivly &#8220;Traffic Analysis&#8221; on where Gauss came from and where it was going because this would help identify the targets Gauss was aimed at.</p>
<p>Thus we need to think less like a Crypto Guru and more like a &#8220;forensic accountant&#8221; who can see the trails of money in myriads of financial transactions</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-184899">

			<div class="comment by-llacer-latot ">

				<p class="commentcredit">

					<span class="commenter">llacer latot</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184899">
						August 22, 2012 8:58 PM					</a>

				</p>

				<p>Do &#8216;Soft TEMPEST&#8217; fonts exist? If not,<br />
what is the <i>closest</i> font selection(s) you can get to them? It&#8217;s not like I can verify this myself in my own party van.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-184900">

			<div class="comment by-outsourced-fetus ">

				<p class="commentcredit">

					<span class="commenter">outsourced fetus</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184900">
						August 22, 2012 9:01 PM					</a>

				</p>

				<p>&#8220;I suspect that the only practical way to attack this is to identify a target machine&#8221;</p>
<p>I&#8217;ve heard whispers of remote wireless attacks against PC serial and usb ports without devices attached to them other than the motherboard.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-184901">

			<div class="comment by-roger ">

				<p class="commentcredit">

					<span class="commenter">Roger</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184901">
						August 23, 2012 8:40 AM					</a>

				</p>

				<p>Hello @Clive,<br />
<i> &#8230;a simplistic brut force search is going to take longer than the code will be valid for.</i></p>
<p>You may not realise, but the payload is probably already not valid. Kaspersky says that the C&amp;C network was taken off-line 2 months ago.</p>
<p><i>Thus a sugestion is how about including a detector in the next update of AV software that runs upto stage 7? There is a reasonable probability it will be detected (if the target machines run AV software)&#8230;. However if a match is found do we get to know about it?&#8230;</i></p>
<p>Yes indeed. I think this is a good idea, and has a reasonable chance of success. It&#8217;s probably also permissible within some AV vendors&#8217; terms of service to simply &#8220;phone home&#8221; with the key.</p>
<p><i>&#8230;much less than 2^32 and could be down below 2^20. &#8230;</i></p>
<p>As a point of reference, Kaspersky say they have already trialled more candidates than that. That probably isn&#8217;t enough to exhaust &#8220;ordinary&#8221; combinations of PATH and Program Files. However it does cast considerable doubt on that approach, and is the reason Kaspersky has asked for other approaches.</p>
<p><i>&#8230; the program developers were unlikely to be trying to obsficate the human memorable name &#8230;</i></p>
<p>This assumes that the object within Program Files is a normal application. Since it is considered likely that the machines have previously been infected with something else, there is no reason for that to be the case.</p>
<p>It is even easier for malware to append something to PATH. On many systems, <i>appending</i> to the local profile version of PATH doesn&#8217;t even require privileged access.</p>
<p><i>Unless this attack was designed very specifficaly for a single target for which a high degree of intel is known then the information is out there and deducable as the Guass writers or their sponsors did.</i></p>
<p>That is the thing, though. Firstly, whoever wrote Gauss obviously intended it (the special payload) to run on only a limited subset of machines. They went to a lot of trouble with that, and the mechanism they chose is intended to be difficult to reverse engineer. It simply doesn&#8217;t make sense if it is keyed off an application name that is readily guessed. Secondly, they <b>must</b> have some intel on the target machines, in order to know passphrase elements of PATH and Program Files. Just guessing has too high a probability of failure, unless they picked something really common &#8212; and Kaspersky has already verified that they didn&#8217;t pick something common.</p>
<p><i>As an example, let us assume it&#8217;s looking for a banking application program. </i></p>
<p>Just by the way, Kaspersky has already been examining it on Lebanese bank systems, and so presumably has a list of any special in-house applications.</p>
<p><i>Further what would probably help identify the potential targets is effectivly &#8220;Traffic Analysis&#8221; on where Gauss came from and where it was going because this would help identify the targets Gauss was aimed at.</i></p>
<p>Kaspersky says they have been unable to determine how it propagated. So far, it seems not to have a built-in propagation mechanism. (Some people are speculating that it was &#8220;dropped&#8221; by one of the other members of its family, Duqu or Flame.) It had a C&amp;C network but that was dismantled months ago.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-184902">

			<div class="comment by-peter-maxwell ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.allicient.co.uk' rel='external nofollow ugc' class='url'>Peter Maxwell</a></span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184902">
						August 28, 2012 11:27 PM					</a>

				</p>

				<p>@Roger at August 22, 2012 3:57 AM</p>
<p>&#8220;3. The Cartesian product of these two lists is created. I&#8217;ll call these the list of candidate passphrases;&#8221;</p>
<p>Close but that is not what was described.  What is described is the Cartesian product of the union of the two sets, i.e. if A is the set of the path variables and B is the set returned form the function call then the final set is ( A U B ) x ( A U B)   what you describe is A x B, which if A and B are non-empty is strictly smaller.</p>
<p>@Clive Robinson at August 22, 2012 12:06 PM</p>
<p>&#8220;I don&#8217;t think that this is such a hurdle as others are making out.&#8221;</p>
<p>Shall we hold our breath while you decrypt the archive? 😉</p>
<p>Seriously though, if one wants to support an argument in favour of the problem being easy, decrypt the darn archive otherwise it is just hot air.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-184903">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184903">
						August 29, 2012 8:28 AM					</a>

				</p>

				<p>@ Peter Maxwell,</p>
<p><i>Shall we hold our breath while you decrypt the archive?</i></p>
<p>If you wish to then by all means do so, but I personaly would not do it because the expectation in normal circumstances is, in around 15mins max death will have occured, and we already know that various AV companies have spent more time than that on Gauss/Godel.</p>
<p>The argument I&#8217;ve put forward is one bassed on practicalities, that is a brut force attack on the Crypto (at ~2^1700 states for ARC4) is not going to work nor are brut force attacks on other parts of the detection and key formation process (~2^128 states). What is in effect needed is a good old fashioned &#8220;pinch&#8221;.</p>
<p>I&#8217;ve outlined a couple of methods by which a pinch could be obtained, and it would appear that others think likewise as they have already written software to test to see if your computer is the one in a few million or so selected for the Gauss/Godel treatment.</p>
<p>As I&#8217;ve also indicated that the result of such methods is probablistic in nature you need to consider the probabilities, for a start just how many computers are there running in the world that Gauss will run on? would it be as high as 2^30?</p>
<p>I take it from your view point you consider the probability as close to zero as makes no effective difference and I don&#8217;t and you take exception to that.</p>
<p>Some of the reassons I&#8217;ve given above already but I&#8217;ll make it a little clearer for you as to why I&#8217;ve adopted my view point.</p>
<p>That is there is also another asspect to consider which is important.</p>
<p>If Gauss/Godel is to specific then it is a &#8220;red flag&#8221; that the computer concerned is &#8220;known&#8221; to a level that could only have been done by an &#8220;insider&#8221; either by direct eyeball inspection or via a software agent. Which would inform the target organisation that they have either a witting or unwitting spy with direct access to the computer.</p>
<p>Now I know the US is happy to &#8220;burn&#8221; their and other peoples agents for political publicity (Scooter Libby &amp; the latest &#8220;underpants&#8221; bomb). But it is a policy that will in short order cost them and their allies Humint resources. The golden rule has previously been you don&#8217;t betray your agents even if you know they are doubled, because it&#8217;s bad publicity, which makes getting future agents difficult or impossible (which is a point the US keep banging on about with regards the likes of Bradly Manning).</p>
<p>Usually you either use the suspect or doubled agents in other ways or arrange a suitable misfortune to befall them if they cannot be used (it&#8217;s one of the reasons why tripple agents are so highly prized and also very carefully watched).</p>
<p>So unless the writers of Gauss/Godel were not cognizant of this and neither were their supperiors which is doubtfull I would expect that the Gauss mechanism is not to specific. Otherwise even if a human agent was not known to be involved the risk of accidentaly starting a witch hunt for one would be considered to great. Historicaly you go to great lengths not to give your target cause to change their activites in any way lest they take action that hurts you or your allies.</p>
<p>And so it would be sensible to make it not to specific, that is there is a trade off in &#8220;harms&#8221;. To specific you potential get &#8220;burned&#8221; badly, insufficiently specific and potentialy your code get known and used against you or your allies. If it was down to me I would err on the side of not being to specific, as there are other advantages to this.</p>
<p>If it&#8217;s not to specific, then there is a probablity that those who are either the target or collateral damage will find this out.</p>
<p>The question then becomes &#8220;what do they do&#8221;, and there are several options which depend on them. And again I&#8217;ve highlighted some of this.</p>
<p>But there is also the question of if those effected try to make the information known will those receiving the information make it public?</p>
<p>One possibility is that somebody will &#8220;sell the key&#8221; to an exploit broker or criminal organisation because the estimated value of the payload is high. If they chose this option then we may never get to hear about it. And this amongst other possabilities effectivly negates your argument.</p>
<p>Now when comparing this to &#8220;Brut Force&#8221; methods it has a much much greater probability of success hence my various comments. And as I&#8217;ve said other people who have written software to perform the checks must likewise think it has a reasonable chance of success otherwise why would they write the software?</p>
<p>As I&#8217;ve already said,</p>
<p>&#8220;Whilst an analysis may not be helpfull to most people, there are enough lateral thinkers who will read it and be able to re-create a good facsimile. And at the end of the day it&#8217;s not the actual Gauss/Godel code that needs to be kept secret but the ideass behind it&#8230; and I realy don&#8217;t think those can be kept quiet&#8230;&#8221;</p>
<p>The simple fact that this and other blogs are discussing this in an open way is already making &#8220;food for thought&#8221; for those who are lateral thinkers.</p>
<p>On a non technical issue whilst I respect your right to a different view point I don&#8217;t have to respect an unwarented personal attack which is what your childish comment can be viewed as. Can I therefore suggest if you do disagree with me you stick to valid reasoning and comment, oh and perhaps come up with your own suggestions of how to go about resolving the issue at hand, otherwise people may start to suspect you are developing unsocial habits applicable to those legandary Old Norse / Scandinavian, less than attractive cave dwelling mythical beasts&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-184904">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184904">
						August 29, 2012 10:53 PM					</a>

				</p>

				<p>I&#8217;m actually surprised that no one has mentioned the possibility that Gauss/Godel has no payload at all, it&#8217;s just the ultimate in FUD.</p>
<p>From my reading of the released information we know that no standard windows PC&#8217;s have the programs that are being searched for, SO we suspect that the target PC&#8217;s must run a very unusual program (Maybe associated with some sort of military systems)</p>
<p>Sometimes causing an enemy unnecessary Fear is the only purpose of an exercise.  They spin their wheels trying to defeat a threat that does not even exist&#8230;.</p>
<p>Welcome to the 21st century wilderness of mirrors.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-184905">

			<div class="comment by-peter-maxwell ">

				<p class="commentcredit">

					<span class="commenter">Peter Maxwell</span> •

					<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/#comment-184905">
						September 4, 2012 8:47 PM					</a>

				</p>

				<p>@Clive Robinson at August 29, 2012 8:28 AM</p>
<p><em>&#8220;On a non technical issue whilst I respect your right to a different view point I don&#8217;t have to respect an unwarented personal attack which is what your childish comment can be viewed as. Can I therefore suggest if you do disagree with me you stick to valid reasoning and comment, oh and perhaps come up with your own suggestions of how to go about resolving the issue at hand, otherwise people may start to suspect you are developing unsocial habits applicable to those legandary Old Norse / Scandinavian, less than attractive cave dwelling mythical beasts&#8230;&#8221;</em></p>
<p>What I said was not a personal attack, it was fair comment.  If you cannot decrypt the archive, there is absolutely no way to discern any further information: it&#8217;s merely guess work and speculation.  In Scotland, we call that type of talk &#8220;hot air&#8221;; there is another word for it but I suspect that would be moderated.</p>
<p>Anyway, I cannot decrypt it; Kaspersky seemingly cannot; nobody here can, so it&#8217;s looking pretty much like there is nowhere else to go &#8211; there is no resolving this one.</p>
<p>&#8220;Develop&#8221;, jeez-oh, by this point in life I suspect I&#8217;m decidedly unsociable.  Perhaps it&#8217;s the Scandinavian genes in me 🙂  Thankfully, if &#8220;people&#8221; have a problem with me they can always say.   Hope your week is going in well.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2012/08/help_cryptanaly.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2012/08/help_cryptanaly.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F08%2Fhelp_cryptanaly.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2012/08/help_cryptanaly.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='4477' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2012/08/passive_sensor.html" rel="prev">← Passive Sensor that Sees Through Walls</a>		<a href="https://www.schneier.com/blog/archives/2012/08/is_iphone_secur.html" rel="next">Is iPhone Security Really this Good? →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
