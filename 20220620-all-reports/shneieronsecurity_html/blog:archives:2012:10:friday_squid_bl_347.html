<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Friday Squid Blogging: Squid Car - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Friday Squid Blogging: Squid Car Comments Feed" href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/4513" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=4513' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F10%2Ffriday_squid_bl_347.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F10%2Ffriday_squid_bl_347.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-4513 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-4513" class="post-4513 post type-post status-publish format-standard hentry category-uncategorized tag-squid">

	<div class="article">

		<h2 class="entry">Friday Squid Blogging: Squid Car</h2>
		<p>A squid <a href="http://laughingsquid.com/squidcar-by-ryon-gesink/">art car</a>.</p>
<p>As usual, you can also use this squid post to talk about the security stories in the news that I haven&#8217;t covered.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/squid/" rel="tag">squid</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html" rel="bookmark">Posted on October 12, 2012 at 4:17 PM</a>			•
			<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html#comments">48 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html" data-title="Friday Squid Blogging: Squid Car" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-186219">

			<div class="comment by-dennis ">

				<p class="commentcredit">

					<span class="commenter">Dennis</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186219">
						October 12, 2012 5:02 PM					</a>

				</p>

				<p>This link:<br />
<a href="http://www.cbsnews.com/2300-504784_162-10014097-1.html?tag=page;next" rel="nofollow ugc">http://www.cbsnews.com/2300-504784_162-10014097-1.html?tag=page;next</a><br />
shows photos of people being scared out of their wits at a haunted house. The text next to the gallery says: &#8220;Much like snowflakes, no two people seem to react to a good scare the same way&#8230;&#8221;</p>
<p>That got me thinking. What about a new security system. Instead of fingerprint scan or iris scan, your laptop can pop up a terrifying photo and take your picture as you react. How many people would be able to imitate someone else&#8217;s instinctive fear reaction?</p>
<p>Of course I am not serious, but what do you think?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186220">

			<div class="comment by-vlad ">

				<p class="commentcredit">

					<span class="commenter">Vlad</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186220">
						October 12, 2012 5:11 PM					</a>

				</p>

				<p>One flow will be that one will not be able to repeat the same reaction every time. The problem is that the act of authenticating actually changes the response of that authentication challenge &#8211; in other words &#8211; it will work once and after that you&#8217;ll not be scared the same way or at all after a while.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186221">

			<div class="comment by-bf-skinner ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.eff.org' rel='external nofollow ugc' class='url'>BF Skinner</a></span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186221">
						October 12, 2012 6:25 PM					</a>

				</p>

				<p>I don&#8217;t know how they did it but Trey and Matt captured unreasoned fear, security theater, and the ultimate result of giving into to phantoms of the mind.</p>
<p>Of course this episode will become available again in a few days.</p>
<p><a href="http://www.southparkstudios.com/full-episodes/s16e10-insecurity#" rel="nofollow ugc">http://www.southparkstudios.com/full-episodes/s16e10-insecurity#</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186222">

			<div class="comment by-martino ">

				<p class="commentcredit">

					<span class="commenter">martino</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186222">
						October 12, 2012 7:53 PM					</a>

				</p>

				<p>Eeewwww!  Squid eyeball!?!  Ugh&#8230;</p>
<p><a href="http://www.ctvnews.ca/mobile/sci-tech/mysterious-blue-eyeball-may-be-from-squid-1.993083" rel="nofollow ugc">http://www.ctvnews.ca/mobile/sci-tech/mysterious-blue-eyeball-may-be-from-squid-1.993083</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186223">

			<div class="comment by-martino ">

				<p class="commentcredit">

					<span class="commenter">martino</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186223">
						October 12, 2012 8:02 PM					</a>

				</p>

				<p>Ok&#8230;It just dawned on me&#8230;what&#8217;s with the squid fascination?  I mean I get that their cool and smart and all but why not octopus then?  Why squid?  What&#8217;s with the whole squid thing?!?  I&#8217;m a long time reader and it never occurred to me till now&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186224">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186224">
						October 12, 2012 8:46 PM					</a>

				</p>

				<p>Court rules against the privacy of cloud email. Reverses an older, good decision.</p>
<p><a href="http://arstechnica.com/tech-policy/2012/10/reading-someones-gmail-doesnt-violate-federal-statute-court-finds/" rel="nofollow ugc">http://arstechnica.com/tech-policy/2012/10/reading-someones-gmail-doesnt-violate-federal-statute-court-finds/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186225">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186225">
						October 13, 2012 4:03 AM					</a>

				</p>

				<p>OFF Topic:</p>
<p>It would appear the &#8220;US China APT&#8221; mob are up to their usual political shananigens,</p>
<p><a href="http://www.computerworld.com/s/article/9232180/Chinese_telecom_firms_pose_national_security_threat_US_committee_finds?source=CTWNLE_nlt_security_2012-10-09" rel="nofollow ugc">http://www.computerworld.com/s/article/9232180/Chinese_telecom_firms_pose_national_security_threat_US_committee_finds?source=CTWNLE_nlt_security_2012-10-09</a></p>
<p>Now let me be clear there is a lot of difference between taking sensible security measures and using faux security scares as a smoke screen for politicaly inspired protectionism.</p>
<p>The US made a political choice many years ago to let go of it&#8217;s US based secure fabrication plants etc and go do the COTS route to save a few dollars to look good come election time.</p>
<p>In the process they handed over much in the way of IP, skills, job security and National Security. They let the genie out of the bottle and in the process also opened a whole pandora&#8217;s box of problems. There is no excuse they were told very clearly that this would be the result.</p>
<p>Now the &#8220;Chinese War Hawks&#8221; and others are jumping on a political bandwagon, It&#8217;s not just the Chinese but any nation that produces base component parts that are a threat to US National Security, and at the end of the day &#8220;when the chips are down&#8221; on the work bench no matter where you got them from if there was no security custody chain from design to the bench you cannot implicitly trust the chips.</p>
<p>Thus you have two choices, the first is the hugely expensive set up US based secure fabrication again, or find some other technical way to mitigate the risk.</p>
<p>A politicaly inspired idea such as this one will not and cannot provide the security it claims to be for. Because at the end of the day supply chain security is horribly horribly complex and inordinatly difficult, thus it has more gaps and holes for individuals with ill intent to worm their way into than most could even. attempt to imagine.</p>
<p>I suspect if after rational non politicaly biased thought the proposed solution will involve a slow migration back to secure design and manufacture of chips and other key components and to use these in appropriate technical mitigation strategies for the bulk of components.</p>
<p>But it&#8217;s a big &#8220;IF&#8221; simply because there are to many rice bowls / pork barrels to be filled and there will be no change other than more political rhetoric.</p>
<p>In theory the US people will have a chance to make a choice on such matters fairly soon, but the reality is the Dog and Pony show of the Monkey in a Suit Pollitical process of &#8220;representative democracy&#8221; that most Western and other nations have will be compleatly subverted post election by the holders of the rice bowls and pork barrels who bought the &#8220;peoples representatives&#8221; a long long time ago from the previous fillings of their bowls and barrels.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186226">

			<div class="comment by-martino ">

				<p class="commentcredit">

					<span class="commenter">martino</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186226">
						October 13, 2012 5:14 AM					</a>

				</p>

				<p>Ooohh, another spy story here too:</p>
<p><a href="http://www.ctvnews.ca/mobile/canada/russian-ambassador-downplays-spying-in-canada-1.994124" rel="nofollow ugc">http://www.ctvnews.ca/mobile/canada/russian-ambassador-downplays-spying-in-canada-1.994124</a></p>
<p>$3K/month for 5 years?  I&#8217;d have thought he&#8217;d have been paid more (the risk he took&#8230;not quite worth that little; wouldn&#8217;t he have thought to cut it off after a year or two too?  Obviously he couldn&#8217;t have expected to have gotten away with it forever&#8230;.but aparently he did!).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186227">

			<div class="comment by-vatos ">

				<p class="commentcredit">

					<span class="commenter">Vatos</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186227">
						October 13, 2012 7:33 AM					</a>

				</p>

				<p>With my latest UK-equivalent of &#8220;TV Guide&#8221;, there was an ad for a wallet that thwarts RFID attacks.</p>
<p>Is this sort of thing worth the money?  How much damage can an attacker do if you are not protected?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186228">

			<div class="comment by-petrea-mitchell ">

				<p class="commentcredit">

					<span class="commenter">Petréa Mitchell</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186228">
						October 13, 2012 11:11 AM					</a>

				</p>

				<p><a href="http://hevelincollection.tumblr.com/post/33444738050/heres-an-interesting-flyer-from-inconjunction-a" rel="nofollow ugc">Paranoia, 1980s-style</a>&#8212; a good reminder that this sort of thing didn&#8217;t spring up from nowhere in 2001.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186229">

			<div class="comment by-petra-mitchell ">

				<p class="commentcredit">

					<span class="commenter">Petr&eacute;a Mitchell</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186229">
						October 13, 2012 11:18 AM					</a>

				</p>

				<p>martino:</p>
<p>&#8220;Why squid?&#8221;</p>
<p>There&#8217;s no accounting for taste.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186230">

			<div class="comment by-civil-libertarian ">

				<p class="commentcredit">

					<span class="commenter">Civil Libertarian</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186230">
						October 13, 2012 12:53 PM					</a>

				</p>

				<p><a href="http://www.wired.com/threatlevel/2012/10/clear-ballot" rel="nofollow ugc">New Election System Promises to Help Catch Voting-Machine Problems<br />
wired.com/threatlevel/2012/10/clear-ballot</a></p>
<blockquote><p>When voting system activists in the U.S. managed to get many paperless electronic voting machines replaced a few years ago with optical-scan machines that use paper ballots, some believed elections would become more transparent and verifiable.</p></blockquote>
<blockquote><p>But a spate of problems with optical-scan machines used in elections across the country have shown that the systems are just as much at risk of dropping ballots and votes as touchscreen voting machines, either due to intentional manipulation or unintentional human error.</p></blockquote>
<blockquote><p>A new election system promises to resolve that issue by giving election officials the ability to independently and swiftly audit the performance of their optical-scan machines.</p></blockquote>
<blockquote><p>[. . .]</p></blockquote>
<blockquote><p>So far, Moore says they do not intend to make their software open source so that it can be examined by others, but he did not rule this out for the future. The company does, however, make its source code available to election districts that have requested it.</p></blockquote>
<p>Any preliminary opinions on whether this might be promising?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186231">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186231">
						October 13, 2012 2:51 PM					</a>

				</p>

				<p>@Petréa Mitchell&#8211;that was great.</p>
<p>$5.8 mil &#8220;Text Against Terror&#8221; gives no intelligence or leads.</p>
<p><a href="http://www.judicialwatch.org/blog/2012/10/5-8-mil-text-against-terror-fails-to-provide-any-tips/" rel="nofollow ugc">http://www.judicialwatch.org/blog/2012/10/5-8-mil-text-against-terror-fails-to-provide-any-tips/</a></p>
<p>Yet over on the Homeland Security Newswire, they are calling the program a success and want to expand.</p>
<p><a href="http://www.homelandsecuritynewswire.com/dr20121011-new-jersey-texting-against-terror-program-a-success" rel="nofollow ugc">http://www.homelandsecuritynewswire.com/dr20121011-new-jersey-texting-against-terror-program-a-success</a></p>
<p>Leaves me wondering what some of the &#8220;tips&#8221; were like&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186232">

			<div class="comment by-wim-l ">

				<p class="commentcredit">

					<span class="commenter">Wim L</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186232">
						October 13, 2012 9:19 PM					</a>

				</p>

				<p>Nice squidcar. If it pulls up next to another squidcar will it change its pattern seductively? ( <a href="http://news.sciencemag.org/sciencenow/2012/07/two-faced-fish-tricks-competitor.html" rel="nofollow ugc">http://news.sciencemag.org/sciencenow/2012/07/two-faced-fish-tricks-competitor.html</a> )</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186233">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186233">
						October 14, 2012 5:12 AM					</a>

				</p>

				<p>@ Vatos,</p>
<p><i>How much damage can an attacker do if you are no protected</i></p>
<p>It&#8217;s not a simple question to answer, and currently we are only at the begining of what people are thinking of doing with &#8220;Near Field Communications&#8221; which covers RFID and other &#8220;Contactless Technology&#8221;.</p>
<p>The first question to ask is what the technology actually does and how, as this puts a bound on what is practical to achieve using it. It is important to remember that the technology is agnostic, it is just a tool that like any other such as a knife and thus can be used for good or bad, and can thus also cause accidents.</p>
<p>Historicaly the technology started out to solve a simple problem of how to identify an object from something inside it as opossed to outside it. The reason for this is things on the outside are generaly the first to get damaged, obliterated, removed or changed. Thus by putting it in the object they make the identity much more secure.</p>
<p>Also the method chosen helps to prevent mis-identification of one object as another due to human transcribing error.</p>
<p>The original RFIDs where made by companies likes Dallas Semiconductors and consisted of a tiny silicon chip a capacitor and coil wrapped around it all sealed in a small package with some small enough and safe enough to go down a hypodermic needle and be embedded in live stock in areas they were not likely to enter the food chain. Each device supposadly had a unique serial number and would respond when energised by repeating the serial number over and over whilst it remained energised. Unfortunatly the number of bits asigned too the serial number was to few for serial numbers to be realy unique.</p>
<p>The purpose of the coil was to act as the secondary of a tuned transformer by which energy would be received from the primary coil in the scanning device and also provide the back path for the data that was the serial number. As such these devices generaly ran at very low frequencies and low data rates and had very short ranges of just a few inches and had no mechanism to deal with more than one device in the scanners &#8220;field&#8221;.</p>
<p>Various things were done to solve these issues including working with scanning frequencies upto the bottom of the UHF band, use of  varying time delay before sending data and repeating it such that the multiple device in the scanners field issue was solved, and also modification of the way data was sent back to the scanner such that more data could be sent from the device.</p>
<p>However other uses for &#8220;contactless technology&#8221; became envisioned including programability and as such the chips have now become comparable in function to contact based Smart Card chips or SIMs you find in your mobile phone or credit card.<br />
As such the use had changed from a pasive unidirectional data transmission of a serial number tag to one with bi-directional data communications and very large amounts of data that could be cryptographicaly protected, and used for carrying out financial transactions for such things as public transport fares.</p>
<p>But the development has not stopped there, others have realised that &#8220;Smart Devices&#8221; could actually act as many RFID devices and thus now mobile phones are getting the backend &#8220;Near Field&#8221; technology built in and can look like one of many RFID devices including all your credit and other payment cards, identity systems used to provide security in buildings etc as well as some proposed National Identity cards.</p>
<p>So in effect all of your financial and identity data including medical records etc will become put on these Near Field devices and as such stand as a witness for all your societal requirments. And when put on a smart phone the phone becomes for practical purposes you&#8230;</p>
<p>The reality is of course that any of these RFIDs can be cloned and thus are totaly reliant on other security measures such as PKI certs shared secrets etc all of which are known to be vulnerable in many ways as they are dependent on other security technology, likewise smartphones and other smart devices are known to be vulnerable because of their trust on other security technology.</p>
<p>In all cases this &#8220;other security technology&#8221; was designed with totaly different security goals in mind and thus can and is inappropriate for the new uses it is put to with the likes of RFIDs.</p>
<p>My solution to the problem is not to have RFID / Contactless / Near Field devices on my person. This already causes me problems as it effects my use of public transport. Currently in London you pay about twice as much for a bus ride if you pay by cash as you do if you use the insecure Oyster card, the alternative of paper based annual travel cards is being phased out fairly rapidly and cash payment is being made extreamly difficult with ticket offices being run on reduced hours or closed entirely. Some banks are including Near Field Technology in existing contact based credit cards, from what has been said it appears you will have to move banks if you want to opt out, which as it&#8217;s an Industry drive just as was Chip-n-Pin you won&#8217;t be able to do fairly quickly.</p>
<p>Now when you add the mismatched security aims of the base systems to that of the financial systems overlaid ontop of them you are going to have more security holes than a second hand pair of string underpants and a consiquent loss of support from those who sold you the systems (ie they will as with Chip-n-Pin Externalise the risk back onto the &#8220;customer&#8221;). And with potentialy large amounts of money to be made you can guaranty that Organised Crime are going to get involved just as we currently see with OnLine Banking.</p>
<p>So as all these Near Field Contactless RFID systems can be made to work at considerably more than arms length you have to ask how long before you get &#8220;walk by contactless mugging&#8221;?</p>
<p>Such crime will become a numbers game just as it is with ATM skiming of peoples current bank cards. If you are in a high risk area you need to take more precautions than in a low risk area to have the same level of risk. But the risk is always there as long as society pushes you to use the technology and opting out is not possible. The more precautions that people take or the easier it is to use the attacking technology the more wide spread the crime will be. Thus sensible people will use whatever precautions they can and if they work RF shielding wallets will become a sensible precaution.</p>
<p>However they have downsides both personal and societal.</p>
<p>On the personal side you have the conveniance or more correctly the inconveniance factor to consider. In London we have the Oyster contactless card for buying bus / train / underground / over ground / tram and other public transport services. Standing on a bus near the card reader you can observe peoples habbits, it&#8217;s got to the point where women press quite sizable handbags up against the reader rather than get the card out. In many cases the time it takes them is longer than it would takee them to pull it out of a pocket and put it back again. You also see people holding their purses and wallets up to the reader and it failing because they either have two Oyster cards or they also have one or more of the newer bank cards with near field contactless technology built in. Basicaly two or more near field cards confuse the readers that are not that reliable anyway which is why quite a few people have two oyster cards&#8230;</p>
<p>Think about how the conveniance / inconveniance of an RFID proof wallet would effect you?</p>
<p>However you may not get the choice because of society aka the Gubbymint and it&#8217;s money grabbing ways to pay the voter bribes that get them elected to their personal grave trains.</p>
<p>The very proflagate previous UK Government (many of them caught for illegal activities involving money)  wanted compulsory ID cards with Near Field Comms in and heavy fines for not carrying them on you at all times.</p>
<p>It is an idea that is not going to go away as the tax take from big businesses carries on dropping in various ways (google HMRC and &#8220;Dave Hartnel&#8221; and the outrageous sums he alowed various big businesses such as Vodafone Tescos and a couple of hundred other major companies to avoid over a good dinner and a handshake). So we are moving from a tax on business based government revenue system to a &#8220;personal tax and fine&#8221; revenue system.</p>
<p>Some years ago I predicted that in the UK what we would have is a &#8220;big brother&#8221; style system where there would be random mandatory checking of ID and on the spot fines for not carrying ID&#8230; Well we&#8217;ve started well in on that path by &#8220;conditioning the plebs&#8221;.</p>
<p>In East London the Border and Imigration people are already running random (usually racialy profiled) spot checks at public transport hubs like Stratford to look for illegal immigrants. Even when those members of the racialy profield group do carry their ID they are often detained for lengthy periods of time whilst they are &#8220;cross checked&#8221; which causes them problems with their employers for being late to work etc. We also have due to the &#8220;war on terror&#8221;, &#8220;Get tough on knife crime&#8221; and a whole host of other initiatives various LEAs setting up random walk through metal detectors and stop and search initiatives.</p>
<p>Think how easy it would be to add an extra detector in the &#8220;walk through&#8221; for your National ID card, if it&#8217;s not detected you get pulled to one side and seriously inconvenianced to show it or be fined a substantial amount&#8230;</p>
<p>As such RFID proof wallets would slow such a cash cow system down and raise costs initialy you would be very servealy hassled and humiliated (TSA style) because &#8220;you obviously have something to hide&#8221; then if sufficient people did it the wallets would become a prohibited item subject to yet another fine etc&#8230; Oh and to ensure that it works they way it should each person on the walk through team will be on a bonus scheme bassed on how many people they catch, not just for ID card fines but all sorts of other finable offenses as well&#8230;</p>
<p>Such is the society we are having forced on us by the Politico&#8217;s and their Big Business pay masters.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186234">

			<div class="comment by-vatos ">

				<p class="commentcredit">

					<span class="commenter">Vatos</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186234">
						October 14, 2012 8:12 AM					</a>

				</p>

				<p>Thanks for the reply Clive.</p>
<p>Am I correct in saying that if someone uses a scanner near my contactless bank card, they then have enough information to perform a fraudulent transaction?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186235">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186235">
						October 14, 2012 10:25 AM					</a>

				</p>

				<p>@ Vatos,</p>
<p><i>Am I correct in saying that if someone uses a scanner near my contactless bank card, they then have enough information to perform a fraudulent transaction?</i></p>
<p>It depends on a number of things, firstly if it is an ordinary &#8220;radio scanner&#8221; as used by &#8220;Hams&#8221; it is only capable of picking up the field generated by the contactles card if it is activly being used within the range of it&#8217;s antenna system. Further the data should be multi level requiring knowledge of not just the protocols in use but any encryption as well.</p>
<p>Thus even if an attacker has access to the same hardware that is used in a shop EPOS terminal it may well be incapable of initiating any kind of transaction beyond the very basic levels.</p>
<p>That said fialings in the systems may well make PK Certs and shared secrets vulnerable in all sorts of ways. You only need to see the issues arising from Chip-n-Pin to realise just how difficult a process it is to secure financial systems. Further some of the near field systems used for paying for public transport have had their secret keys and shared secrets found by researchers, which means it is very likely organised crime is also more than aware of these secrets.</p>
<p>The problem is neither you or the system designers and implementors can prove these systems are in any way secure (you cannot prove a negative any way). So a wise person, to limit their risk proffile must assume they are not secure in any way, and that it is simply a numbers game that they cannot win at. The best they can hope for is to draw before their number comes up and they lose, unless they take further action such as &#8216;not playing the game&#8217; or &#8216;moving the goal posts&#8217;.</p>
<p>As I noted earlier &#8220;society&#8221; will not let you be a member and not play the game, so you have to look at how to &#8220;move the goal posts&#8221; for your own protection.</p>
<p>One way to do this is to only ever use a debit card attached to an acccount that you keep virtualy empty. That is you plan ahead and only transfer money into the account shortly before you make a purchase. However you need to use a process that is in turn not liable to attack so don&#8217;t use online banking. This can be done because some banks alow you to make transfers from an ATM machine but only to pre-aranged accounts. Providing the account with the debit card is with one bank and the ATM transfer account is with a different bank then the level of work done by an attacker has vastly increased. You can further back stop this in other ways, the important thing is not to have any credit or overdraft facilities in any of the back stopped accounts involved. Thus the worse loss if you do get attacked is the small amount of money in the accounts at the time and any bank charges run up by the attackers that you should be able to get back in most juresdictions from the banks.</p>
<p>As an individual or organisation you realy should not have to do such things, however because many of the banks have poor security and protect themselves by externalising the risk onto their customers in many juresdicitons you have to think creativly to protect yourself.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186236">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186236">
						October 14, 2012 10:26 AM					</a>

				</p>

				<p>@ Vatos</p>
<p>Maybe, maybe not. It&#8217;s one of those things that is easy in theory, but rarely happens in practice. Krebs on Security does pretty good coverage of what crooks are actually doing. Most of it is hacking databases, ACH fraud, or getting credit cards via ATM skimmers. Get a non-RFID card if you can. Otherwise, just don&#8217;t worry about it until attackers start focusing on it.</p>
<p>Snope&#8217;s link on Electronic RFID Skimming<br />
<a href="http://www.snopes.com/fraud/identity/pickpocket.asp" rel="nofollow ugc">http://www.snopes.com/fraud/identity/pickpocket.asp</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186237">

			<div class="comment by-peter-a ">

				<p class="commentcredit">

					<span class="commenter">Peter A.</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186237">
						October 15, 2012 6:55 AM					</a>

				</p>

				<p>Re: contactless credit/debit cards.</p>
<p>One way to go for some time now is to cut the antenna loop embedded in the card &#8211; you only need to know where exactly it runs. A friend of mine has exploited the fact that his wife works at a hospital with digital X-ray machine (so no expendables like the film, chemicals etc.) and has made her X-ray the card to see where the antenna is, then drilled small holes in two places along the path, just to make sure. The card works OK in ATMs and such but not with the contactless terminals.</p>
<p>Now I am considering exploiting my own aquiantances in the X-ray rooms&#8230;</p>
<p>Of course this is not applicable to RFID-only fare cards etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186238">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186238">
						October 15, 2012 7:25 AM					</a>

				</p>

				<p>@ Vantos,</p>
<p>Just one thing when it comes to &#8220;scanning&#8221; many EPOS systems have dinky little &#8220;mobile units&#8221; that are carried around the premises. These are not &#8220;near field&#8221; devices and often use the ISM band some actually use WiFi.</p>
<p>Which as people have been able to &#8220;line of sight&#8221; evesdrop WiFi at several Km raises the notion of your local outlet being a major source of your Plastic details being put into free space.</p>
<p>The question then becomes what level of security is used on these ISM non near field radio systems?</p>
<p>It could be that the answer (being implementor choice) could be none ranging upto the better (but still breakable) levels of the WiFi protocols.</p>
<p>Then again consider that some EPOS terminals did have a cellular radio / mobile phone and other gizmos added in the &#8220;supply chain&#8221; before they were instaled at various retail outlets in the UK.</p>
<p>So it&#8217;s not just the near field link you need to consider when using your plastic even if it does not have near field comms your details may be vulnerable further down the comms chain or as @ Nick P notes where the current action is with getting at EPOS DBs etc.</p>
<p>Which with the usual &#8220;low hanging fruit&#8221; principle the attackers are going to move along the comms chain from the DB towards the cards one weak link at a time as each successive link gives less oportunity for in most cases increased risk of getting caught.</p>
<p>However with the ISM band stuff the risk of being found activly exploiting this is very very small as you don&#8217;t have to be anywhere close to the plastic. or place it&#8217;s being used at&#8230;</p>
<p>At the end of the day the real issue is the level of security that the plastic has on it&#8217;s comms channel, it realy should be PK cert SSL equivalent or better, but in most systems I&#8217;ve had some knowledge of it&#8217;s been little more than plain text or simple obsfication.</p>
<p>And one thing history teaches us with comercial organisations security at best plays second fiddle to many other business drivers such as cost reduction, and as long as it remains a &#8220;free market solution&#8221; then security will be a race for the bottom. And to be honest the Payment Card Industry (PCI) even though it mandates standards has a history of security blunders and faults not least being the audit process they use where the incentives are not best aligned with customer detail security at anything more than a rudimentry level (ie data at rest and a limited scope data in use/transit).</p>
<p>And as has been pointed out in the past this lack of security has much to do with a desire by card issuers and merchants to have the &#8220;conveniance of off line transactions&#8221; be it to make sales or process sales less expensively or more bluntly to do both as cheaply as possible.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186239">

			<div class="comment by-kashmarek ">

				<p class="commentcredit">

					<span class="commenter">kashmarek</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186239">
						October 15, 2012 2:03 PM					</a>

				</p>

				<p>How long will it take before there is a fatwa against this sort of thing?</p>
<p><a href="http://yro.slashdot.org/story/12/10/15/1651216/the-uae-claims-to-hold-the-worlds-largest-biometric-database" rel="nofollow ugc">http://yro.slashdot.org/story/12/10/15/1651216/the-uae-claims-to-hold-the-worlds-largest-biometric-database</a></p>
<p>The fact that those other countries don&#8217;t make such a claim lends NO credence to the UAE claim.  If another country makes such a claim and indicates that it includes Muslums from the UAE, watch the fireworks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186240">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186240">
						October 15, 2012 3:22 PM					</a>

				</p>

				<p>CIA adds Skyhook system instructions to its museum<br />
<a href="http://www.networkworld.com/community/blog/cia-flying-skyhook-wasn%E2%80%99t-just-james-bond-it-actually-rescued-agents" rel="nofollow ugc">http://www.networkworld.com/community/blog/cia-flying-skyhook-wasn%E2%80%99t-just-james-bond-it-actually-rescued-agents</a></p>
<p>They used a variant of this in the movie The Dark Knight. My brother and I were watching it. He told me it would be awesome if we had something like that. I told him, per Richard Marcinko, we <i>used</i> something like that over a decade ago. It had a few kinks compared to Batman&#8217;s version. However, it was also <i>real</i>, making it more useful.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186241">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186241">
						October 15, 2012 5:13 PM					</a>

				</p>

				<p>@Vatos<br />
 I&#8217;ve never heard of anyone extracting need bank account information ( to make fradulent transactions) from an RFID card, (using only the RF interface).</p>
<p>I wont go so far as to say it is impossible, but it definitely belongs in the VERY hard bin.</p>
<p>So while it might not be possible to directly extract a cards account information details, it is possible to use the mobile reader to mount a MiTM attack. Basically an RF link / NFC bridge  device (maybe BT or simple FM )is held near the real contactless card reader, the mobile attack terminal relays the information between the real card and the real reader. Classic relay MitM attack.</p>
<p>Typically an attacker would still need the PIN before any transaction was possible BUT this can often be gotten with a little shoulder surfing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186242">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186242">
						October 16, 2012 2:16 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p>Yup the skyhook was real, and I for one would not have liked to be lifted by it for various reasons. One being the idea of the mechanism that first clamps the cable and then cuts the balloon side of it, the second was what happens if the cable missies the &#8220;scisors&#8221; and ends up against the wing or an engine or its prop?&#8230; Then there was the very predictable flight path the plane had to follow could get it easily shot down, and of course the deployment of the balloon was not exactly covert and would be almost as good as firing flaress into the air to attract the enemy to your ground position&#8230;. It was however recomended for the US Coastguard and even to NASA for astronaut recovery.</p>
<p>However did you follow one of the links in the article to this little jem,</p>
<p><a href="http://www.networkworld.com/community/blog/cia-five-particularly-timeless-tips-simple-sabotage-field-manual" rel="nofollow ugc">http://www.networkworld.com/community/blog/cia-five-particularly-timeless-tips-simple-sabotage-field-manual</a></p>
<p>It provides some good tips on how to totaly kybosh an office or other workplace efficiency and reduce morale to the point that even the worst of employees will make like rats on a sinking ship.</p>
<p>Just adding two ideas from Scott Adams would make it instantly recognisable as the &#8220;secret to cubical life&#8221;. Those two rules being,</p>
<p>Catbert&#8217;s Managment Rule number 1, &#8220;never be in the same room as a decision&#8221;.</p>
<p>Wallie&#8217;s &#8220;annoying sounds screen saver&#8221;.</p>
<p>Oh and one other Rule that I identified independently and others have also done the same would make it the Senior managers guide to getting ahead,</p>
<p>Start a major &#8220;company saving&#8221; project and then jump ship about 1/3 of the way through.</p>
<p>This enables you to always claim it as a success on your C.V. and at job interviews. Because if the project succeeds it was down to your skills in giving it the strong footing and giving the employees confidence in their own abilities etc etc, If however it goes bad you still claim the same initial success but say that those brought in after you demoralised the workers, did not have the confidence, did not see the strategic vision etc etc. Win-Win just what a hopless sociopath needs to get to the top and do an Enron, or get into Government Service post election&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186243">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186243">
						October 16, 2012 1:32 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>Yeah, I saw that one. I enjoyed your expansion of the idea too. My favorite:</p>
<p>&#8220;Start a major &#8220;company saving&#8221; project and then jump ship about 1/3 of the way through.</p>
<p>This enables you to always claim it as a success on your C.V. and at job interviews. Because if the project succeeds it was down to your skills in giving it the strong footing and giving the employees confidence in their own abilities etc etc, If however it goes bad you still claim the same initial success but say that those brought in after you demoralised the workers, did not have the confidence, did not see the strategic vision etc etc. Win-Win just what a hopless sociopath needs to get to the top and do an Enron, or get into Government Service post election&#8230;&#8221;</p>
<p>Might have to try that sometime. In mean time, I have used techniques 2, 3, &amp; 4 against major retailers trying to make us &#8220;efficient&#8221; (read: cheating us for profits). Now, sabotage is probably illegal in this country. So, you could say that I just changed the focus of how I was doing business during serious time constraints from making the company money to (arbitrary goal here). 😉</p>
<p>If labor got low, I&#8217;d ignore the phone &amp; claim we lost business b/c they had me doing too much at once. Couldn&#8217;t get to it. I&#8217;d focus on quality rather than quantity &amp; quality takes time. I&#8217;d try to innovate new ways of doing things, most of which were unfortunately slower than best practices. And so on.</p>
<p>Of course, I did excellent work for the companies not jerking us around. Quite a few different industries. I was dedicated &amp; always improving how I did my job. But for those companies that like to play Dilbert&#8217;s boss, I always have a work strategy for them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186244">

			<div class="comment by-vatos ">

				<p class="commentcredit">

					<span class="commenter">Vatos</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186244">
						October 16, 2012 3:15 PM					</a>

				</p>

				<p>Thanks for the responses people.  It sounds like the wallet is not a good investment at the moment.  I will follow the Krebs site. If attacks by criminals using RFID become significant, I will consider what countermeasures to employ</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186245">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186245">
						October 16, 2012 3:24 PM					</a>

				</p>

				<p>OFF TOPIC (entropy generation)</p>
<p>Alright, years ago I told a bunch of people (here?) about a clever TRNG of last resort. Maybe first resort for people who are broke &amp; running complex workloads. That was my excuse. So, what did the TRNG do?</p>
<p>Well, the designers noticed that what developers &amp; admins see is an illusion. There&#8217;s isn&#8217;t a single clock, a computer, a anything: it&#8217;s many different things acting together with a bit of uncertainty all throughout. Processors also have plenty of hidden state that affects the timing of their activity. So, the algorithm just tried certain operations dependent on such timings &amp; measured how off the timing was. This was used as an entropy source. I can&#8217;t recall if the original I learned of was TrueRand or 2003-4ish Havage.</p>
<p>Well, I was thinking of making an improved version of it that utilized a number of cheap COTS boards w/ different OS&#8217;s &amp; architectures. I do that anyway in diversity setups, so why not? I serendipitously found the article below where Dan Kaminsky essentially redoes TrueRand into DakaRand.</p>
<p><a href="http://dankaminsky.com/2012/08/15/dakarand/" rel="nofollow ugc">http://dankaminsky.com/2012/08/15/dakarand/</a></p>
<p>Things got more interesting in the comments. Two other similar solutions popped up. Havaged had an interesting design that also messes with the branch predictors &amp; its output passes the AIS-31 test suite. Another commenter mentioned Entropy Broker, which is for distributing random numbers from other devices. Links below.</p>
<p><a href="http://www.issihosts.com/haveged/" rel="nofollow ugc">http://www.issihosts.com/haveged/</a></p>
<p><a href="http://vanheusden.com/entropybroker/" rel="nofollow ugc">http://vanheusden.com/entropybroker/</a></p>
<p>Unlike Dan, I have little objection to using these techniques &amp; how they work doesn&#8217;t seem so mysterious. It&#8217;s kind of the opposite of Orange Book-era timing channel elimination, just more black box. I&#8217;d add that it would be a good idea to try to figure out the entropy amounts of each part of the hardware skewing the clock or timing. That way, we could figure out which one&#8217;s are the best to focus on for entropy &amp; performance improvement. I see in each of the linked designs pieces that could be combined into a more effective one. Wonder who can guess it?</p>
<p>I was also thinking about the issue in general. The main danger, if the entropy exctraction mechanism is good, is that there might be little actual entropy. The enemies <i>might</i> be able to model system behavior to measure the entropy &amp; predict randomness. So, the system behavior itself might need to be erratic. How to ensure that?</p>
<p>The main objection might inspire the solution: servers. Modern networks do plenty of things that are user and application driven. A server-grade OS has many protocols &amp; many potential services. Each of these is likely to have a different effect on CPU state, cache &amp; other sources of timing. So, a simple example would be to randomly launch services on the machines. The services might even be simulated with a random looking dataset &amp; done locally so networked attackers never glean information from sniffing the exchange.</p>
<p>Let&#8217;s look at the details. We can use a few basic protocols or services with EXTREMELY watered down &amp; isolated implementations. TCP with odd settings, TFTP transferring random tiny file, gopher (!), telnet leading nowhere, etc. Let&#8217;s say 8 services available, meaning 3 bits. So, 3 bits of actual entropy chooses a service, it runs in background alongside actual work &amp; dies. Practically speaking, we get an entropy magnification effect because that 3 bits affects the network stack, OS, caches, CPU state &amp; more. So, anything harvesting them will get plenty of variance from baseline pre-service launch, more chaotic state during service launch, &amp; maybe-modified baseline after service ends. Our key assumption is the attacker has an extremely hard time guessing this stuff anyway, so the entropy addition is unlikely to be shortcut around mathematically.</p>
<p>There&#8217;s many possibilities. My old tried and true concept is a dedicated system for certain security critical activities, including TRNG. It creates plenty of quality randomness that others can use upon system initialization. Remember that we only need a little because a CRNG is good enough if it changes seeds periodically &amp; seeds are unique per machine. So, you can have a protected delivery over the network to the starting machine or generate a bunch of seed files for each one to use on load, never reusing one. Of course, the remote seed material should be cryptographically combined with local entropy or static information first to give attackers more headaches.</p>
<p>So, let&#8217;s assume we have an easy way to give each machine a bit of quality randomness to go on for a while. The DakaRand-type system should be running in the background this whole time, with events affecting its entropy pool. It might even use a bit of seed material itself. After a set period of system work, which hopefully has many affects on CPU/cache state, the component starts producing output that adds to the main entropy source.</p>
<p>So, how to launch the services. Well, it can be done periodically using data from onboard entropy sources. As stated with 3 bit example, it&#8217;s not as if there&#8217;s a simple formula going from the input to the output. Closest thing to overunity I&#8217;ve ever designed. 😉 Alternatively, the system can have a port listening for service execution instructions (with limits on what &amp; how often it will execute things). The port might accept truly random instructions from a central server or (decentralized) might accept it from other machines. Heck, might even have each one occasionally send a request to the whole network, with each machine interpreting it a different way.</p>
<p>The performance &amp; security implications are straightforward enough. Feeding the initial entropy is fast &amp; uses existing mechanisms/primitives. We have proven CRNG&#8217;s for THEM to use to stretch it out a bit from there. Actual TRNG&#8217;s and/or CRNG&#8217;s on central device can make the seed material (VIA PadLock is cheap&#8230;). Any DakaRand-style component should be designed to impose minimal execution impact during operation. Limits on service execution &amp; careful design of the simple listener should prevent this from being a DOS tool. Simplification of the services themselves &amp; limits on their resource utilization should cause them to have little impact. Custom services might also be written to mess with timing of various components of the system long enough to impact measurement (not operations).</p>
<p>Thoughts, concerns, criticisms?</p>
<p>Note: I&#8217;m ignoring Clive&#8217;s active emanation attacks &amp; assuming physical security. I mean, how many RNG issue are caused by that versus bad entropy sources or generation mechanisms? Let&#8217;s solve the easy one first guys.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186246">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186246">
						October 16, 2012 6:41 PM					</a>

				</p>

				<p>@NickP</p>
<p>The following is all related to standalone microcontroller systems rater than complex server based CPU&#8217;s, however many of the same synchronization mechanisms exist within servers&#8230;.</p>
<p>One of the things to be aware of is that most external events used inputs to a computer are sampled by an IO clock and buffered through a suitable FIFO so that a condition called metastability is avoided.</p>
<p>This has the effect of making randomly timed external events all appear synchronous to the I/O sample clock.  So if the event has time jitter (uncertainity) it will appear as a beat pattern with the I/O sample clock.</p>
<p>A second issue is the way in which events are processed in a microcontroller. Generally speaking, task execution is driven by an Interrupt (say 1millisecond timer) so external events, as seen from within the CPU, are synchronously sampled by the IO clock and executed when the OS tasker allocates CPU cycles to this task, usually the Interrupt task clock will be some divide of the I/O sample clock so thw two are effectively locked.</p>
<p>What this means is that CPU clock jitter, branch fails, cache misses etc will only increase entropy if they cause a process to overrun the minimum task interval.</p>
<p>The problem with all TRNG&#8217;s is convincing yourself (and others) that the underlying noise source is truly random, which for most professionals means the RNG source must be some form of amplified thermal noise.</p>
<p>Most of my RNG&#8217;s use an LSFR (PRNG) with a unique loadable state which is Xor&#8217;ed with the TRNG. This output drives a stream cipher.  I always include a mechanism to directly measure the TRNG stream separate from the PRNG / CRNG streams. In the test I want to see at least 12 bits of &#8220;randomness&#8221; in the TRNG. Usually I find simple FFT analysis to be the best tool for determining if the TRNG is working properly. Most failure mechanisms involve some form of unexpected task synchronization  which shows up as a frequency spur on the FFT. If you can pass the FFT test then the rest of the randomness tests tend to be easy to pass, especially if your sampler also has some form of algorithmic &#8220;noise, if you fail FFT you will definitely fail any larger randomness test suite.</p>
<p>Unfortunately if you only have access to the final RNG output you will pass every test every time BUT you will never really know what&#8217;s true randomness and what is simply complexity.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186247">

			<div class="comment by-nickp ">

				<p class="commentcredit">

					<span class="commenter">NickP</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186247">
						October 16, 2012 9:44 PM					</a>

				</p>

				<p>Kaspersky to make a secure OS for Scada/ICS. Seems to target unmodified apps. In other words, they&#8217;ll develop what the Green Hills and SYSGO have been selling for years now. Lol&#8230;</p>
<p><a href="http://it.slashdot.org/story/12/10/16/1711222/kaspersky-to-build-secure-os-for-scada-systems" rel="nofollow ugc">http://it.slashdot.org/story/12/10/16/1711222/kaspersky-to-build-secure-os-for-scada-systems</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186248">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186248">
						October 16, 2012 10:47 PM					</a>

				</p>

				<p>@ Nick P,</p>
<p>Back in the 1990&#8217;s I had to design an external RNG for an organisation to make cheaply but not in the numbers that would make any kind of custom silicon viable.</p>
<p>As @ RobertT has mentioned True RNGs are almost always based on some &#8220;Noise Source&#8221; that uses at it&#8217;s base some kind of thermal effect. The reasons for this are many including not wanting radio active materials being easily accessable, using very expensive detector equipment or quite a bit of electrical power (think fluorescent tubes).</p>
<p>But thermal noise is actually a very very rare beast and hides behind all sorts of other noise most of which is not random but just looks random. Worse it is usually very faint and needs considerable amplification before it&#8217;s usable and the amplifiers have their own noise which is again usually (but incorectly) considered to be random.</p>
<p>Overly simply all amplifiers act as receivers not just to the wanted very weak signal but any stray EM field that happens to be around as well be it radiated or conducted or creeping through the dielectric. The materials the active devices use also generate noise dependent on the current passing through them or the voltage applied across them. One of the joys (read nightmares) of mixed analog and digital design is stopping the digital edges that have considerable energy getting back into the analog sections and going through the aplification to create new digital edges that feedback to create more digital edges&#8230;. Oh and then there are filters that are in reality tuned circuits which add resonance or ringing when they get hit by a digital edge or stray EM field from some other part of the circuit or external source. Oh and speaking of tuned circuits, your entire curcuit layout has as many inductors as there are traces and component leads, an almost unlimited source of capacitance between components etc etc. There is an old joke in RF engineering &#8220;Oscillators don&#8217;t but amplifiers do&#8230;&#8221; and as a historical note nearly all early radio receivers that had RF as opposed to AF gain did not actually use amplifiers but quenched oscillators, or were what we now would call &#8220;parametric amplifiers&#8221;.</p>
<p>The trick with analog design is to seperate the wanted weak signal from all those unwanted strong signals, and one way to do this is to restrict the bandwidth. The problem with this is it &#8220;adds colour&#8221; to the noise signal which in the case of RNGs is unwanted bias that has to be addressed. A reduced bandwidth also reduces the bit rate of the RNG.</p>
<p>So you need another way to do things, one of which is to use an oscillator as your noise amplifier. Basicaly you take your very weak noise source and use it to change the reactance of the tuned circuit of the oscillator. In effect what you end up with is a VFO driven by the noise from your thermal noise source. You then use this randomly changing frequency source to &#8220;sample&#8221; another frequency source. One simple way to do this is with a D-Type latch. However you have to be very very carefull because the latch is effectivly mixing the two frequencies together and reflecting them down to base band which means you have a strong set of frequency components to deal with which could end up &#8220;in band&#8221;.</p>
<p>In essence this is what you are trying to do with your design have some kind of &#8220;unknown&#8221; signal that looks random and sample it what you end up with is not quite what you might think as RobertT indicated.</p>
<p>Any way my design used a reverse biased semiconductor junction as the noise source this was amplified in a diferential amplifier that fed a low frequency oscillator the output of which went into an interupt pin of a PIC micro controler which in effect sampled the CPU clock signal. The CPU main task was to run a modified ARC4 stream generator as fast as it could go, the interupt from the VFO simply copied the latest byte into a circular buffer. This buffer was in effect randomly sampled by the IO request from the comms signal which worked it&#8217;s way around the buffer for each request from the computer the TRNG was attached to.</p>
<p>It worked well and passed the required randomnes tests.</p>
<p>However&#8230; I made a modified version that did not use a noise source at all what it did was use a BBS generator to modify the output process of the ARC4 stream cipher. The output of this generator also passed all the tests required of it.</p>
<p>And this raises the point that RobertT did which is almost philisophical in nature, you have to ask the question does a fully determanistic generator act as a random generator to an observer if they cannot reproduce the determanistic process or identify the next bit with anything other than a 50:50 chance?</p>
<p>And the simple answer is &#8220;yes&#8221; that is if it walks like a duck, quacks like a duck and looks like a duck, do you have any reason to suppose it&#8217;s a goose?&#8230;</p>
<p>In essence this is the idea behind many CS-PRNGs, what you are actually doing is taking away the hand waving magic of making a TRNG and replacing it with a mathmatical model that you can actually draw some valid conclusions about. Oh and it can also run a darn sight faster and produce considerably more random bits with less hardware&#8230;</p>
<p>It only leaves the issue of the &#8220;startup test&#8221;&#8230; But that&#8217;s another issue altogether.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186249">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186249">
						October 17, 2012 2:24 PM					</a>

				</p>

				<p>@ RobertT</p>
<p>&#8220;Unfortunately if you only have access to the final RNG output you will pass every test every time BUT you will never really know what&#8217;s true randomness and what is simply complexity.&#8221; (RobertT)</p>
<p>&#8220;In essence this is what you are trying to do with your design have some kind of &#8220;unknown&#8221; signal that looks random and sample it what you end up with is not quite what you might think as RobertT indicated.&#8221; (Clive)</p>
<p>That&#8217;s actually the point of these designs, I think. Ironically, it&#8217;s the mathematical techniques that keep failing because we can&#8217;t get enough true randomness in them or are wrong about the source. The internal state of the machine is probably not truly random, merely complex as all get out. The result to outside observers, though, is something that might be computationally equivalent to predicting a TRNG. &#8220;Might&#8221; is a key word, but do you know of any practical attack w/out full system compromise?</p>
<p>I don&#8217;t. And I know real-time programmers that would be interested in a modeling technique that precisely times arbitrarily complex hardware/software systems w/out the initial state supplied. 😉 It seems that&#8217;s what it would take unless there&#8217;s a shortcut I&#8217;m not seeing. And it&#8217;s not lost on me that there <em>could</em> be a shortcut: a key reason my design has a trusted start &amp; CRNG.</p>
<p>Thanks for the alternatives. I&#8217;m sure they might come in handy in a future design attempt that&#8217;s closer to hardware. Thanks especially for the tip about FFT&#8217;s. I had never heard of that trick before.</p>
<p>&#8220;Most of my RNG&#8217;s use an LSFR (PRNG) with a unique loadable state which is Xor&#8217;ed with the TRNG. This output drives a stream cipher. I always include a mechanism to directly measure the TRNG stream separate from the PRNG / CRNG streams.&#8221;</p>
<p>Why do you do it that way? I have ideas about why, but I&#8217;d rather hear your security argument for the construction.</p>
<p>@ Clive Robinson</p>
<p>&#8220;The reasons for this are many including not wanting radio active materials being easily accessable, using very expensive detector equipment or quite a bit of electrical power (think fluorescent tubes).&#8221;</p>
<p>Yeah, I asked for a pound of weapons-grade uranium for a TRNG project. They never got back to me on that. So, I&#8217;m exploring alternatives. How did you guess?</p>
<p>&#8220;Any way my design used a reverse biased semiconductor junction as the noise source this was amplified in a diferential amplifier that fed a low frequency oscillator the output of which went into an interupt pin of a PIC micro controler which in effect sampled the CPU clock signal. The CPU main task was to run a modified ARC4 stream generator as fast as it could go, the interupt from the VFO simply copied the latest byte into a circular buffer. This buffer was in effect randomly sampled by the IO request from the comms signal which worked it&#8217;s way around the buffer for each request from the computer the TRNG was attached to.&#8221;</p>
<p>Ah, more designs to work with. Maybe one of my hardware knowledgeable friends can build the thing. Or give me an idea of what it would cost.</p>
<p>&#8220;In essence this is the idea behind many CS-PRNGs, what you are actually doing is taking away the hand waving magic of making a TRNG and replacing it with a mathmatical model that you can actually draw some valid conclusions about. Oh and it can also run a darn sight faster and produce considerably more random bits with less hardware&#8230;&#8221;</p>
<p>Yup. &#8220;Unpredictable to them&#8221; is more important than &#8220;unpredictable.&#8221;</p>
<p>&#8220;It only leaves the issue of the &#8220;startup test&#8221;&#8230; But that&#8217;s another issue altogether.&#8221;</p>
<p>I hate it when you do that. Care to elaborate?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186250">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186250">
						October 17, 2012 3:08 PM					</a>

				</p>

				<p>Links relevant to TRNG discussion for any crypto fans reading along.</p>
<p>Intels old design (passed Kocher&#8217;s review)<br />
<a href="http://www.cryptography.com/public/pdf/IntelRNG.pdf" rel="nofollow ugc">http://www.cryptography.com/public/pdf/IntelRNG.pdf</a></p>
<p>Intel&#8217;s new design (2012 analysis)<br />
<a href="http://www.cryptography.com/public/pdf/Intel_TRNG_Report_20120312.pdf" rel="nofollow ugc">http://www.cryptography.com/public/pdf/Intel_TRNG_Report_20120312.pdf</a></p>
<p>&#8220;Provably random&#8221; TRNG design<br />
<a href="http://www.ipam.ucla.edu/publications/scws4/scws4_6650.pdf" rel="nofollow ugc">http://www.ipam.ucla.edu/publications/scws4/scws4_6650.pdf</a></p>
<p>Stateless, small, FPGA-neutral design<br />
<a href="http://www.cosic.esat.kuleuven.be/publications/article-790.pdf" rel="nofollow ugc">http://www.cosic.esat.kuleuven.be/publications/article-790.pdf</a></p>
<p>Old favorite: lava lamps<br />
<a href="http://www.lavarnd.org/what/process.html" rel="nofollow ugc">http://www.lavarnd.org/what/process.html</a></p>
<p>(Note: This one is interesting in that it can be made subversion resistant &amp; you don&#8217;t need much hardware knowledge to build it. Subversion resistant comes from ease of building it using components from arbitrary hardware vendors. Semiconductors verification, on other hand, isn&#8217;t happening for non-hardware experts.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186251">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186251">
						October 17, 2012 7:01 PM					</a>

				</p>

				<p>@Nick P<br />
 &#8220;&#8221;Most of my RNG&#8217;s use an LSFR (PRNG) with a unique loadable state which is Xor&#8217;ed with the TRNG. This output drives a stream cipher. I always include a mechanism to directly measure the TRNG stream separate from the PRNG / CRNG streams.&#8221;<br />
Why do you do it that way? I have ideas about why, but I&#8217;d rather hear your security argument for the construction.&#8221;</p>
<p>I always have separate PRNG and TRNG because each has different pros / cons.</p>
<p>ALL real TRNG&#8217;s are subject to signal injection lock attacks. This might be caused by very strong EM / RF fields or intentionally added power supply noise (whatever) point is the analog circuit can be made to lock up (all 1&#8217;s or all 0&#8217;s) or simply produce an output which is a down modulation of the sample frequency with the injection frequency. This signal can still be very complex but it is no longer random.</p>
<p>By contrast the LFSR will continue to work correctly even in the presence of VERY strong EM fields. If the PRNG sequence is long enough and changeable then it is difficult to predict the next state, it is just a problem that is too complex. I always seed the LFSR startup with a key which both sets the start vector and determines the order of the LFSR.</p>
<p>So even if the real TRNG is compromised the attacker still has a difficult problem to solve.</p>
<p>The final stage is  an intermittently re-seeded stream cipher. This exists because it allows the system to generate lots of RNG&#8217;s quickly,  rather then requiring the accumulation of entropy from the TRNG.</p>
<p>WRT to the FFT analysis of the TRNG, I want to see a minimum of 12 bits (72 dB) randomness free running, additionally I want to see that this never decreases below 48dB even when power supply noise (sine wave signal) is added that is sufficient to cause the device to reset. (typically about 0.5 to 1 volt PS noise on a 1.2 to 1.5V process)</p>
<p>With the Server based system that you have proposed I dont think you can ever quantify the randomness of the sources, nor can you ever access their susceptibility to intentional jamming / injection. So this means you have to assume the worst and add / XOR another pseudo random sequence. The result is complexity plus an unknowable start states. This will RNG output definitely look random and as Clive has pointed out it will be good enough for almost all applications, especially if physical security can be guaranteed.</p>
<p>Having said all this, my last design was actually the opposite, it used a PRNG to seed a TRNG. The TRNG section was a 4th order Sigma delta modulator (very similar to a standard Audio ADC signal delta stage). The modulator was self oscillating type so it&#8217;s output has both amplitude and timing uncertainty.  A low frequency PRNG feeds the sigma delta input and the output is a 16 fold over sampled 4 bit output.  The advantage of this approach is that it is very difficult to jam or frequency lock and furthermore it creates strings with maximum sequence lengths for all 1&#8217;s / all 0&#8217;s guaranteed by the PRNG, this is important for certain applications. BTW it also lets us reuse analog hardware rather than designing it from scratch.  Higher order sigma delta modulators especially for Audio are well studied for TONE problems, because our hearing is very sensitive to Tones. So this absence of Tones means they always pass the FFT tests.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186252">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186252">
						October 18, 2012 3:08 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p><i>I hate it when you do that. Care to elaborate</i></p>
<p>Yes it&#8217;s quite simple 😉</p>
<p>To do start up tests you do a couple of different things, firstly you take several of your RNGs and &#8220;cold start&#8221; them all together and see how much they differ or not in their outputs. Secondly you take individual examples of your RNG and repetadly cold start it and record and compare the outputs to see how they differ.</p>
<p>The hard. part is &#8220;see how they differ&#8221; it involves many many tests over and above the usual test suite for randomness. You&#8217;d be surprised at just how many otherwise acceptable generators fail this test.</p>
<p>Also if used during incremental design and build (such sensitive systems are rarely just built on paper and final tested) it can be a rather usefull test tool or indicator that something hidden from plain sight is going wrong.</p>
<p>For instance if you take five examples of your thermal noise source and run them all from the same power supply if they show some kind of corelation then you know you have an issolation issue that you need to address. Oddly perhaps as a test tool it&#8217;s way way more sensitive than the best of lab scopes and other off the shelf test tools.</p>
<p>Which reminds me about FFT&#8217;s watch out for window artifacts of the FFT not the DUT. Even test tools have their failings. The important thing to remember with FFT&#8217;s is that they are &#8220;bandpass filters&#8221; in their own right that is they don&#8217;t go down to DC and don&#8217;t go up to daylight. Similarly another interesting tool FWT&#8217;s don&#8217;t do DC to daylight either.</p>
<p>Oh and the &#8220;startup tests&#8221; are a different issue, due in the main to engineers seeing the trees not the wood.</p>
<p>If you think of your RNG as just a complex determanistic process or even a simple LFSR it has a &#8220;start state&#8221; dependent on the hardware and what the designer has done or not done to offset the hardware start state issues.</p>
<p>Unfortunatly the reality of the hardware start state is, contrary to many design engineers beliefs hardware at start up has little or no entropy.</p>
<p>The reason for the incorrect belief is that you cannot predict the state a bunch of flip flops (cross coupled NAND gates) will come up in the first time in any one instance of hardware. However if you look a little further after ten or fifteen cold starts of an individual hardware instance you will see that most times individual flip flops will start in the same state with much greater than 50:50 odds&#8230;</p>
<p>The consiquence of this is you cannot leave the start up to &#8220;chance&#8221; (as there is next to none), you need to have a hardware &#8220;seed&#8221; in a hardware RNG just as you do a software seed in a software RNG.</p>
<p>The need for this seeding of the hardware raises three issues,</p>
<p>1, How do you maintain a seed through various power cycles.<br />
2, How do you select seed values the first time.<br />
3, How do you ensure the seed value is different each time.</p>
<p>With regards power cycles it&#8217;s not just on and off cycles it&#8217;s under and over volt, spikes and other overlay waveforms (which brings back issues of stray EM and other energy sources).</p>
<p>Selecting seed values the first time is obviously a factory issue but you could easily make serious problems there if you just used the serial number or some other predictable number.</p>
<p>Ensuring that the seed value changes for each and every power cycle is two fold, not only should it be unique for each power cycle for each RNG but IMPORTANTLY it has to be unique to each RNG you make (and that&#8217;s what is politely known as a hard problem). The simplest way to do this is a fully determanistic solution such as using a seeded counter a block cipher and a unique key to each RNG put in in the factory.</p>
<p>Which with other issues is a good reason to consider not using True Random &#8220;Noise&#8221; Generators.</p>
<p>However there is also a philisophical issue as well. If you look at definitions of random you find from a practical view it is actually no different from that of an unknown (to the tester) complex determanistic generator&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186253">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186253">
						October 18, 2012 11:09 AM					</a>

				</p>

				<p>@ RobertT and Clive</p>
<p>I appreciate the additional insights. RobertT&#8217;s approach is looking to be the easiest, so far. Assuming I don&#8217;t use a COTS trng.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186254">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186254">
						October 19, 2012 5:06 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p><i>RobertT&#8217;s approach is looking to be the easiest, so far Assuming I don&#8217;t use a COTS trng</i></p>
<p>Maybe maybe not 😉</p>
<p>As I indicated I realy would not use a TRNG COTS (thermal noise or otherwise) these days except say a diceware solution to generate three or four intitial secret values of counter Increment (I) Initialisation Vector (V), whitening (W) and Key (K) for AES in a modifed CTR mode which you use as your &#8220;factory generator&#8221;, which provides &#8220;unique secret values&#8221; for your production fully determanistic CS-PRNGs, this way you avoid all of the problems both RobertT and I have outlined.</p>
<p>Effecivly run the factory generator to generate values for your production RNGs,</p>
<p>//Factory Generator.<br />
START :</p>
<ul>
<li>create data-out file;
</li>
<li>load(I,V,W,K) from secrets file;
</li>
<li>AESKey(K);
</li>
<li>CTR = V;
</li>
</ul>
<p>TL1 :</p>
<ul>
<li>PTXT = CTR xor W;
</li>
<li>ROUT = aes(PTXT);
</li>
<li> append(ROUT) to data-out file;
</li>
<li>CTR = CTR + I;
</li>
<li> if (not done) goto TL1;
</li>
</ul>
<p>END :</p>
<ul>
<li>V = (CTR + I);
</li>
<li>write(I,V,W,K) to secrets file;
</li>
<li>exit(end_ok);
</li>
</ul>
<p>As for your production RNGs consider them software only and these days I would use a modified &#8220;card shuffling&#8221; stream generator as the &#8220;entropy pool&#8221; and &#8220;entropy stirrer&#8221; and mix it with another stream generator that uses an &#8220;orthagonal&#8221; method to &#8220;card shuffling&#8221;. Oh and remember RAM and FROM are dirt cheap these days so go for big state arays in the stream generators and fast update/generation.</p>
<p>That is take RC4 it has a State array which is in effect a pack of cards, it&#8217;s state is the entropy pool which is stirred by the Card Shuffling algorithm.</p>
<p>In the case of RC4 the Shuffling algorithm is also the output algorithm and key schedualing algorithm and uses two pointers one that increments Pi and one that jumps Pj based on it&#8217;s current value the value in the state array pointed to by Pi and a key value,</p>
<p>//Update pointers and get cards to shuffle</p>
<ul>
<li>Pi = (Pi + 1) mod X;
</li>
<li>T1 = Sarray[Pi];
</li>
<li>Pj = (Pj + T1 + K) mod X;
</li>
<li>T2 = Sarray[Pj];
</li>
</ul>
<p>//Shuffle Sarray</p>
<ul>
<li>Sarray[Pi] = T2;
</li>
<li>Sarray[Pj] = T1;
</li>
</ul>
<p>//Return &#8220;random value&#8221;</p>
<p>&lt;</p>
<p>ul&gt;<br />
return((T1 + T2 + Off) mod Y)</p>
<p>In normal RC4 K is set to zero during a stream (byte) output and is only used during a Key load Sarray shuffle and the output offset Off is nott used. Likewise the mod values X and Y are the same and are the size of the Sarray.</p>
<p>Now consider a modified form of RC4 I call BOARC1024, I thought it up back at the turn of the last century whilst designing a TRNG for a customer but needed to be able to repeatedly test how it behaved so I replaced the True random thermal noise source with a BBS generator. It uses an augmented RC4 stream cipher as an &#8220;entropy streacher&#8221; and adds extra confusion by way of &#8220;whitening&#8221; the output by adding values from a maximal length PRBSR (modifed multiplying Mitchel-Moore generator)</p>
<p>BOARC1024 outputs bytes just as RC4 does so Y=256, however the Sarray is 1024 bytes so X=1024. As the ARC1024 is used as the equivalent of an entropy stretching entropy pool it takes two inputs from other stream generators. Originaly a thermal noise source TRNG but replaced with a  BBS RNG and modified multiplying Mitchel-Moore generators to add &#8220;whitening&#8221; or &#8220;confusion&#8221; at the output.</p>
<p>The lower ten bits of each BBS output is used to provide a vale for K once every compleat cycle of the incrementing pointer Pi, and the Mitchel-Moore generator provides a new value to be used  for the output offset Off every output of the BOARC1024 generator.</p>
<p>Thus each BOARC1024 production generator needs secret values from the AES256-MCTR factory generator for,</p>
<p>1) Primes for the BBS which needs to be atleast 1024 bits in size.<br />
2) The BBS startup updating seed value.<br />
3) The BOARC1024 key value.<br />
4) The Mitchel-Moore generator startup updating seed value.</p>
<p>Which maxes out around 9-11Kbits or 44 AES256 outputs from the factory generator&#8230;. Oh and obviously an equivalent amount of F PROM in the device to store it across power cycles. In practice the bulk of this is actualy the max size of the RC Key and this could quite easily be made much smaller if required. Importantly you can get PIC or other microcontrolers with this amount of Flash or EE PROM and a USB interface for less than 5USD these days in quite small quantities. As they also have &#8220;pins to burn&#8221; you could add all sorts of fancy indicators, displays, keys and other inputs to produce an entire range of CS-PRNGs to customer requirments&#8230;</p>
<p>Now if you look at RobertT&#8217;s design as described it is actually about the same (he goes for 12bits of TRNG I use 10bits BBS and we both use stream generators as &#8220;entropy streatching&#8221; &#8220;entropy pools&#8221; and semi linear stream generators. The main difference is RobertT uses his linear stream generator at the input to the entropy pool and I use mine at the output. I did consider doing exactly this originaly for exactly the same reasons RobertT outlines, however I was being overly cautious on my card shuffling entropy pool (this was due to some ARC4 analysis showing potential issues with cycle shortening if the basic operation was changed slightly).</p>
<p>Since I did the original design I have thought about if the computationaly very expensive extra security of BBS is actually needed and have since played around with the idea of using the Modified Multiplying Mitchel-Moore Generator (MMMMG) or its Additive (MAMMG) or Subtractive (MSMMG) forms with the output sent through a couple of filters to taylor it&#8217;s output to replace the BBS. Oh and as a consiquence find another orthagonal stream generator to replace the &#8220;confussion&#8221; generator (thankfully eStream has provided contenders for this 😉</p>
<p>The problem now however is actually getting the required computational resources to run a full set of the latest tests&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186255">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186255">
						October 19, 2012 11:52 AM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>The main takeaway from both of you is combining several generators in a way that leverages their strengths over potential weaknesses. Additionally, as I suspected, some secret initial state is the best option for avoiding many pitfalls. That&#8217;s actually getting easier to do these days as there are quite a few methods for &#8220;burning in&#8221; chip values. I do think your design could use an update.</p>
<p>So, I looked at some tests on RNG&#8217;s. Mitchell &amp; Moore seems to be a good choice. It has a clustering problem early on, so I&#8217;d iterate it a few hundred times upon initialization. Salsa20 is a quality and very fast stream cipher. AES acceleration is common, so your first design is a better idea. I&#8217;ve also considered using one of these fast SHA-3 hash functions in a CRNG design. Not sure of security implications, though. Doubt there is a justification for BBS &amp; its computational complexity. A correctly designed RNG system is virtually never cracked in practice.</p>
<p>I really caught myself focusing on your shuffling algorithm. It&#8217;s certainly interesting. The point seems to make sure there&#8217;s a bunch of state driving the process that complicates things for the attacker. An improvement dawned on me: scrypt. It&#8217;s designed to take a long time in hardware and software to interate in part due to memory usage. As I&#8217;m not a cryptographer, I must keep things simple to avoid pitfalls. So, here&#8217;s a stab at it.</p>
<p>I&#8217;m calling it a memory-heavy counter. On startup, the system generates a huge array (preferrably high in MB) of statistically random numbers. There are two counters: one that increments &amp; one that is an index to the array. Both are used in the input process during each round. This means a prediction will need to break more than the algorithms: it will be memory intensive for each step. As in PBKDF&#8217;s, we might do a bunch of iterations upon initialization to further cause problems for the attacker.</p>
<p>This scheme might even work on a PIC, albeit with less memory usage. I&#8217;ve essentially forced them into a serial process. They&#8217;re not parallelizing it. The process itself is also kind of slow. It&#8217;s simple for analysis purposes. It feeds a stream cipher, so the RNG itself will be very fast. For safety, could optionally use two ciphers (with different keys): AES in CTR mode &amp; Salsa20. These outputs would be xored together. If simple hardware, then just Salsa20 or reduced-round Salsa.</p>
<p>The question would be&#8230; what&#8217;s the ideal input process? Got to be careful about mixing things so that your implementation performs well &amp; doesn&#8217;t invalidate a security property. I want a counter, a value pulled from the huge state array, an extra step like one of your PRNG&#8217;s, &amp; then somehow shoved into the stream cipher. The obvious answer is to tweak one of you guys&#8217; designs to use my huge array, but asking in case I&#8217;m missing something obvious.</p>
<p>(Uh oh, Fortuna just popped into my head. I sense a Big Array slash Fortuna slash Salsa20 hybrid monster forming.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186256">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186256">
						October 19, 2012 6:55 PM					</a>

				</p>

				<p>@Nick P, @Clive Robinson</p>
<p>&#8220;As I indicated I realy would not use a TRNG COTS (thermal noise or otherwise) these days except &#8230;..&#8221;</p>
<p>I agree the TRNG is a problem circuit that I would rather do without, however there is only one problem more difficult than making a good TRNG and that is making a near perfect RESET circuit.</p>
<p>The only real purpose of the TRNG is to generate some entropy regardless of the Start-up state. Since the circuit always runs it always generates entropy.<br />
Now if you have physical control of the system and can ensure a known good start-up sequence is followed for ALL start-ups then the Start-up problem does not really exist and therefore previously accumulated /and stored entropy ( or stream cipher output) can be used to seed the system re-start.</p>
<p>Unfortunately for products that I work on the hacker will have physical access to the device so they can easily fiddle with the Power Supply to create nonstandard start-up sequences which do not properly trigger the Reset circuit.  Typically tricks involve using non-monotonic supply ramps, Narrow supply glitches and VERY slow ramping of the power supply (slower than the Reset time constant). Sometimes combinations of these conditions are used to try to achieve a partial reset (something like uC Program Counter (PC) resets to 0000H without generating a system wide Power-on reset) In other words software restarts but hardware does not restart.</p>
<p>It is also worth mentioning that non-volatile memory (to store the previous entropy state) is easy to bypass by simple tricks like disabling chargepump used to generate the high voltages needed for EEProm and Flash operation.</p>
<p>So the real purpose of the TRNG is to remove the need for nonvolatile entropy storage between power-off and power-on AND to remove the need for a perfect POR (power-on-reset) circuit.</p>
<p>For the record, with my latest Sigma Delta RNG, I actually get about 110dB to 120dB , so this is 18 to 20 bits of entropy (under non attack conditions) and about 70dB (close to 12 bits) under signal injection attack conditions.  Interestingly most of the injection signal  feed-through comes via the Bandgap reference circuit. So there is still room for improvement.</p>
<p>One other thing that I forgot to mention is removing signal bias from the TRNG. I do this with a combination of digital tricks and a feedback offset cancellation circuit that basically insures average 1&#8217;s and average 0&#8217;s count is equal, this is done with a low frequency digital IIR filter on the output. For most uncorrected analog  circuits a DC bias exists at about the 8 bit to 10 bit level. For most digital type circuits the systemic bias is much higher 4 bits to 6 bits. This is something that you need to test for&#8230;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186257">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186257">
						October 19, 2012 11:51 PM					</a>

				</p>

				<p>@ RobertT, Nick P,</p>
<p><i>&#8230; the hacker will have physical access to the device so they can easily fiddle with the Power Supply to create nonstandard start-up sequences which do not properly trigger the Reset circuit. Typically tricks involve using non-monotonic supply ramps&#8230;</i></p>
<p>And before the hacker was the low cost battery charger&#8230;</p>
<p>I kid you not, I used to be involved with FMCE design for the likes of cordless and mobile phones and looked into issues with electronic wallets and pocket gambaling machines going back into the 1980&#8217;s.</p>
<p>One persistant problem was lockup or eratic behaviour caused by the rechargable (NiCad) batteries and the 10cent or less charger circuits. In the hand held device to save cost there was no power switch that is the battery was always connected to the electronics&#8230;</p>
<p>Essentialy what happens (and it&#8217;s difficult to reproduce reliably) is that the charge circuit is effectivly currentl limited and the very nonlinear load of the discharged (but not compleatly) battery and the CPU trying to reset pulls the charger into currentl limiting and &#8220;wierd Sh1t&#8221; (Trade mark claimed for 😉 starts happening.</p>
<p>What is happening is aproximatly as follows,</p>
<p>The battery is at some low voltage Y that is bellow the threshold Z that the CPU will work reliably but not below the CPU off voltage of X. Although the difference between X and Z is small at some point the battery will be in the gap. CPU manufactures like Motorola put circuits into their CPU chips to try and detect the condition and prevent it, they also try to arange that the reset cascade happens in a certain sequence to stop excessive current being drawn. What the chip makers cannot do is use &#8220;time&#8221; for the sequencing as there will always be a slower rise time, thus they often use voltage which is also problematic. What their designers did not expect was for the slowly rising voltage to dip again, and this happens due to the current limit effect and the increasse in load as the CPU cycles up&#8230;</p>
<p>The obvious solution is put the physical switch back but this has it&#8217;s own problems which was why it was removed in the first place. So the next best solution is an &#8220;electronic switch&#8221; but&#8230; they have their own problems as well when you are designing them with descreate transistors and resistors etc. Not the least of which is all the designs people had come up with had very poor and unreliable switching charecteristics due to getting the series pass element to switch. In effect they were all linear high gain amps using multiple transistors (expensive) which also sucked almost as much current from the battery as the CPU in standby mode cutting the standby time by nearly 70%.</p>
<p>The solution I came up with back then used just two transistors the series pass &#8220;switching&#8221; element (PNP) and the detector/driver (NPN) the trick was to make the detector/driver a current biased circuit using two resistors one from before the series pass element and one from after the series pass element thus using the start of the turn on of the series pass element to significantly increase the current bias to the base of the driver transistor. The detector was in effect the base bias turn on voltage of the transistor (aprox 0.7V) which although temperature sensitive was sufficiently reliable. The two currents also ment importantly that unlike the other linear amp designs the circuit had hysteresis so the turn on voltage could be set well above CPU voltage Z and the turn off just above the CPU turn off voltage X so the CPU did not see a reversing voltage in the gap. Further it also alowed the turn on voltage to be set such that the battery was sufficiently charged so that it would be able to handel the current rush of the CPU turn on without it&#8217;s voltage dipping back below Z. Although I urged the company to pattent the idea they decided not to&#8230; Any way the UK arm of the company is now long gone because it never went out to get pattents to protect it&#8217;s IP because it thought the process to slow and to costly&#8230;</p>
<p>All that aside as you note there is a choice between a fully determanistic CS-PRNG and one which is augmented by a TRNG as a TRNG on it&#8217;s own is way way to far from being sufficient in it&#8217;s own right even for low security applications. At the end of the day it is very much down to how you chose to do things based on the application involved and the &#8220;real estate&#8221; costs in the design. In the likes of electronic wallets and pocket gambling machines you have no choice but to use real entropy somewhere in the system, and importantly it has to be somewhere fundemental and inherantly not &#8220;get atable&#8221; without being atleast tamper evident if not preferably destroying the device entirely.</p>
<p>Where you are not dealing with attackers with direct physical access and you are not working at the chip level you have to consider &#8220;supply chain poisoning&#8221; etc where you cannot trust the components to be what they say they are in the data sheet and on the package. And this is probably not be with the intent by covert foreign Gov operatives of owning a down stream system at some point in the future. No it&#8217;s much more likely to be &#8220;Chinese Knock Offs&#8221; or stolen &#8220;out of spec&#8221; parts or even low spec parts relabled as high spec parts carried out by organised crime.</p>
<p>The result of these faux parts is in most cases the internal function is broadly the same just not to spec in ways you can easily measure from the device pins. Unfortunatly TRNG&#8217;s for the most part work at the edges where &#8220;out of spec&#8221; most often happens. Which is why from a COTS system developers point of view avoiding TRNG&#8217;s is advisable as it&#8217;s less costly than mittigating them</p>
<p>I like your idea of using a ADC as a seeded TRNG however I will need time to mull it over. One thing I would note however is your seeding LFSR should realy have a nonlinear output that drives the ADC to make the attacks harder. As a quick &#8220;off the top of my head thought&#8221;, you should be able to get a realistic nonlinear circuit using an AND and OR gate array with little difficulty and not much real estate. And you could always gate paths through the array or simpler add a little &#8220;whitening&#8221; at the array input with XOR gates and &#8220;PUFs&#8221; to make it more unique to each actuall chip.</p>
<p>The joys of COTS system design as opposed to chip design is you are always &#8220;piggy in the middle&#8221; and avoidance or mittigation of your suspect component parts is all you can do. The former is generaly reliable in outcome the latter definatly a &#8220;cross your fingers and hope&#8221; stratagie.</p>
<p>However it&#8217;s getting to the point now with SOC that avoidance is just not cost effective in an ever increasing set of cases and mittigation unavoidable even though it&#8217;s costly and unreliable unless done with extream care.</p>
<p>As I&#8217;ve indicated in the past &#8220;Prisons-v-Castles&#8221; is a mitigation stratagie of parts of unknown provinence that could be suspect in many ways. Unfortunatly TRNGs by the very definition of their function are very difficult to mitigate if not impossible when it&#8217;s possible to hide in the grass of the statistical tests&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186258">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186258">
						October 20, 2012 8:42 PM					</a>

				</p>

				<p>@Clive Robinson<br />
&#8220;I like your idea of using a ADC as a seeded TRNG however I will need time to mull it over. One thing I would note however is your seeding LFSR should realy have a nonlinear output that drives the ADC to make the attacks harder&#8230;&#8221;</p>
<p>I&#8217;m not a believer in &#8220;full disclosure&#8221; of security related circuits / systems, so I think you might find that some critical information is missing from my descriptions.</p>
<p>I also like to use an assortment of non-linear circuits to mix together digital and analog signals so that complexity plus unknownable signals are combined. Having said this you need to be very careful when combining Gaussian signal distributions with non-linear systems, because the resultant output data PDF can easily be non-gaussian.  (If you have any marine friends working in ASW then ask them about mixing random data with nonlinear effects)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186259">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186259">
						October 21, 2012 1:48 AM					</a>

				</p>

				<p>@ RobertT,</p>
<p><i>I&#8217;m not a believer in &#8220;full disclosure&#8221; of security related circuits / systems</i></p>
<p>It is another one of those philosophical questions 🙂</p>
<p>Back in the days of code books and mechanical cipher machines and simple ciphers that could be memorised and carried out with pencil and paper a Proffessor of Languages in a select Paris accademic institution thought the problem with obscurity in largely deployed systems used by the Diplomatic and Military services was insoluble. So Auguste Kerckhoffs came up with a series of principles that still carry his name which were published in 1883 [1]. A lifetime later a mathematically inclined individual who would become one of the founders of information theory Claude Shannon re-expressed one of Kerckhoffs Principles as &#8220;The Enemy Knows the System&#8221;.</p>
<p>Which gives rise to the question have we advanced sufficiently in our understanding and science to make obscurity / obsfication sufficient such that the enemy does not know the system?</p>
<p>Hmm two deeply philosophical security questions in one thread&#8230; I guess @ Nick P will be bookmarking this page 😉</p>
<p>Your comment suggests that you think in certain areas, security by obscurity is worth while if not valid in mass produced items. And my personal guess is it&#8217;s again an open question in certain respects.</p>
<p>My guess is based on the following thought chain,</p>
<p>1, We know all security is a tool.<br />
2, We know all tools are agnostic and can be used both in defence and offence.<br />
3, We further know that in the main defence against offence relies on Information or Mitigation.<br />
4, We also know that broad mitigation can work against attacks we have know knowledge of thus we don&#8217;t need to know all information [2].</p>
<p>Therefor it&#8217;s sensible to mitigate by obscurity specific details as even though it may not stop an attack it will raise the thersholds of ability and time against potential attackers. It also helps reduce the oportunity of others to turn the tool on you which is a viewpoint taken by most major Governments and their security organisations and in certain respects used as a double bluff in the likes of the Haglin coin counting mechanism used in some US field cipher machines.</p>
<p>But in recent times it would appear that the US and other Mil organisations realise that the boot can be firmly on the other foot with obscurity being most definatly out of sight. And thus  recent behaviour by the US Mil on funding to finding supply chain poisoning appears to confirm we are not alone in that thought that in certain places and certain ways obscurity can be good security.</p>
<p>[1] See David Khan&#8217;s book Codebreakers.</p>
<p>[2] We saw this point in practice in the 9/11 attacks where a fire/safety officer in one company had made sure that the employees all knew the fire evacuation proceadure and had often practiced it. The result was a much greater percentage of that organisations staff survived compared to other less well prepared organisations in similar positions. There is little or no chance he would have considered a plane flying into the building as part of the evacuation training [3]</p>
<p>[3] The 9/11 attacks were not the first time NY had had a plane fly into the side of a skyscraper. Back in WWII at 9:49 on Sat 28th July 1945 a ten tonne B52 bomber piloted by Lt. Col. Bill Smith in low visability conditions missed several skyscrapers before it did fly into the side of the Empire State Building. But compared to 9/11 it actually caused minor damage, of a 18 by 20 foot hole on the 79th floor, killing the three crewmen, 11 office workers and injuring 26 others, with repair costs estimated at around 1million USD.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186260">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186260">
						October 21, 2012 11:34 AM					</a>

				</p>

				<p><i>I&#8217;m not a believer in &#8220;full disclosure&#8221;..</i><br />
&#8211;Me neither, hence some of my questions may ask for too much.  Regarding the other philosophical question, my dad has said simply &#8220;There&#8217;s no such thing as random&#8221;.</p>
<p>@RT, CR, NP</p>
<p>First, thanks for publicizing your convo.  Could you possibly post some of your random output, right next to non/pseudo random output? (That may be pointless but I&#8217;m curious, sorry)</p>
<p>I was going to ask if you could send out circuit schematics, and how you could do that in an ultra secure manner (hand-drawn and delivered maybe), but that may be too much.</p>
<p>Do folks in the military get access to special suppliers or are you getting your parts truly COTS-style?</p>
<p>Have any of you ever thought of either starting a business or buying one, with like-minded people, where you can be a supplier and sell parts that aren&#8217;t poisoned?&#8211;Ofc, money, time, expertise will be barriers; and my generation is known for its lack of initiative (which is why I love working w/ engineers and military-folk).  Basically was wondering if there&#8217;s a better solution besides crossing my fingers and hoping for best&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186261">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186261">
						October 21, 2012 2:06 PM					</a>

				</p>

				<p>@ figureitout</p>
<p>The military and govt have switched to COTS for many of their supply needs. The primary defense contractors are also known to subcontract this way. The COTS products proved superior to GOTS products in most ways, so they dominated. Both DOD &amp; academia have projects in place to develop technology that accomplishes things like&#8230;</p>
<ol>
<li>Prove an arbitrary component behaves according to a specification. The specification is considered trusted &amp; is somewhat abstract, the component is a concrete instance from untrusted source.</li>
<li>Detect the presence of malicious circuits in foreign chips. (Yeah, I&#8217;m sure THAT will work out&#8230;)</li>
<li>Develop constraints for untrusted builders that make it provably impossible to cause certain security violations or make it easier to detect them.</li>
<li>Develop easier methods of producing provably correct systems/software/hardware/components along with evidence/proof of what it does.</li>
</ol>
<p>Both high assurance &amp; security communities have been researching this stuff for a while anyway. Fresh infusions of funding were given to good teams recently via NSF, DARPA, DOD, European, &amp; Australian efforts. China is doing less in Correct by Construction, I think, but they have similar concerns leading to development of their own processors, firmware &amp; OS stack.</p>
<p>So, no, there&#8217;s no shortcut. As for trusted suppliers, assuming that&#8217;s even possible&#8230;</p>
<p>The focus of the demand side on more releases, more features, more integration with untrusted legacy stuff, long shelf life &amp; cheap cost means any kind of assurance efforts take the back seat. Safety- and security-critical markets are the exception, but they have dominant players. (You really going to beat likes of Boeing or Raytheon on big contracts?)</p>
<p>This means we have few strategies. I&#8217;ve been working on them (and throwing them away) for years. Here&#8217;s some right off the top of my head.</p>
<ol>
<li>Ignore the problem. Focus almost exclusively on recovery abilities, insuring against damages, &amp; employ only standard security practices. Lawyer up, too. This is the COTS standard.
</li>
<li>
<p>Use high assurance methods to develop critical, long-lasting components of our IT infrastructure. Focus on interface level &amp; make almost any part of infrastructure easy to swap out. We WILL have to.</p>
</li>
<li>
<p>Systems with a single function can be created with limited TCB &amp; robust software stacks. Diversity happening here can reduce risk of compromise, as well. There are quite a few processor, firmware, RTOS, middleware, etc. vendors to choose from.</p>
</li>
<li>
<p>For complex systems, we can analyze them for the most critical points &amp; put assurance efforts there. If it&#8217;s secrets, that part can be extracted into a secure component or device. And so on.</p>
</li>
<li>
<p>Code development. All best practices in software development, esp quality centric, should be implemented. Various methodologies have proven low-defect track record. Certain tools help reduce development problems. Certain languages &amp; platforms either make working code easier to create or are provably immune to key problems. We need to use what we have better.</p>
</li>
<li>
<p>External components. All components should include a behavioral specification describing inputs, outputs, &amp; ESPECIALLY error states/behaviors. Components should be tested/reviewed to some extent to ensure they behave as specified. They might also be wrapped or externalized in such a way as to control how information flows through them &amp; contain issues. Monitoring is a good idea for coarse-grained complex components.</p>
</li>
<li>
<p>If hardware subversion is a concern, the system should be made a bit hardware agnostic if possible. The entity acquiring the hardware can do it through a third party with NDA, disguise the usage case within legal allowance (EULA&#8217;s &amp; stuff can be an issue), &amp; randomly select from a range of usable providers. Some systems can be designed with mixed hardware/OS platforms running the same software, minimizing risks a bit.</p>
</li>
<li>
<p>An old strategy of mine to deal with governments is to make sure you buy the hardware or host the systems in their opponents&#8217; jurisdiction. If it&#8217;s data or a system, it might go through several jurisdictions during operation that are all unlikely to cooperate. It also helps if those organizations benefit the local government in some way, but I&#8217;ll leave that to your imagination.</p>
</li>
</ol>
<p>There&#8217;s more strategies. I&#8217;m keeping a few secret until I&#8217;m sure there&#8217;s nothing I can do with them. Particularly, a business model for producing high assurance components sustainably in unsustainable markets. The one&#8217;s above will help solve many problems. Think of them as a mental framework for dealing with issues during requirements gathering, design &amp; implementation.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186262">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186262">
						October 21, 2012 6:41 PM					</a>

				</p>

				<p>@Clive Robinson<br />
&#8220;Your comment suggests that you think in certain areas, security by obscurity is worth while &#8230;.&#8221;</p>
<p>I absolutely believe obscurity is worthwhile, I&#8217;d even go so far as to say that it is mathematically inclined (Academic) Crypto types that have bad mouthed obscurity just to sell their own brand of snake oil.</p>
<p>Having said this, the problem with obscurity is maintaining absolute secrecy in the techniques used to obscure AND changing these techniques too often for the attacker to learn all your tricks.</p>
<p>I use a lot of special circuits that I believe the attacker has never seen before. Many times this means reaching back into my past to combine very old styles of logic in modern systems/processes.  For example recently I used I2L logic (Integrated Injection Logic)  in an advanced CMOS process, this logic was used to hide some critical steps. In another section I used NP domino logic, both are very old design styles that would confound someone new to the game and defeat any automatic reverse engineering system.</p>
<p>You might say that these steps will not stop a well funded state actor, but I&#8217;m not sure that this is true. Even the best funded organization are prisoners of their own institutional bias, especially intellectual bias.  Think about the report from a young engineer at some TLA, his boss does not want to hear &#8220;its tricky&#8221; his boss just wants a report on top level architecture followed up by analysis of each individual block as needed.  Generally the first report back on the &#8220;tricky circuit&#8221; is that it is TRIVIAL and not worth further study. It&#8217;s nothing but circuit tricks and obfuscation, hardly the kinda thing a prestigious organization should waste its precious budget on, but you know what that level of study suits me just fine!</p>
<p>Sometimes I&#8217;ll even use logic that changes it&#8217;s function when a micro-probe is added at a certain obvious test point.  This way the individual block level analysis never matches the extracted &#8220;top level&#8221; functionality.</p>
<p>By contrast think about the fragility of algorithms like AES when analysed with the help of DPA techniques. Frankly I find it intellectually dishonest that so many in the field of security were prepared to simply bow reverently in the direction of the crypto algorithm guys.  They even had/have the audacity to lecture me on the properties that make brute force the best attack against their algo. (Side channel anyone?)</p>
<p>So Yes I do believe that obscurity is a very valuable security technique.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186263">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186263">
						October 21, 2012 8:13 PM					</a>

				</p>

				<p>@ RobertT</p>
<p>&#8220;I absolutely believe obscurity is worthwhile, I&#8217;d even go so far as to say that it is mathematically inclined (Academic) Crypto types that have bad mouthed obscurity just to sell their own brand of snake oil.&#8221;</p>
<p>I&#8217;ve been slammed on this blog &amp; BinRev for saying the same thing. However, many successful security tricks in the old days of UNIX administration were essentially obfuscation. And they worked. A perfect example is not using the default port for common services. This stops automated worms &amp; attacks that just aim for that port on tons of IP&#8217;s. It&#8217;s obscurity, but it works for the threat.</p>
<p>Another example of me using principle this is recommending businesses use Linux on POWER, SPARC or MIPS instead of x86. (Critical services, at least.) I tell them to hide evidence of what OS it is whereever possible (anti-OS fingerprinting). Just to make sure that the attacker isn&#8217;t told it&#8217;s &#8220;Red Hat for POWER&#8221; or something. All their system-level code injections will fail &amp; most will never figure out why. With hardware security, it&#8217;s even harder to look inside at the details. Hence, obfuscation has even more benefits by significantly raising the bar for attackers. We&#8217;re seeing that to a degree with iOS hardware encryption. Feds aren&#8217;t cracking it left and right, so it&#8217;s working. 😉</p>
<p>&#8220;Frankly I find it intellectually dishonest that so many in the field of security were prepared to simply bow reverently in the direction of the crypto algorithm guys. They even had/have the audacity to lecture me on the properties that make brute force the best attack against their algo. (Side channel anyone?)&#8221;</p>
<p>Yes. Most of their stuff failed. That&#8217;s why I push for methods to still make beating COMSEC a hard COMPUSEC problem in addition. There is a benefit to well-vetted algorithms. However, crack one standard &amp; everyone is toast. I prefer to make a solution that applies something well-vetted in a way where an attack on it won&#8217;t crack the whole thing.</p>
<p>&#8220;So Yes I do believe that obscurity is a very valuable security technique.&#8221;</p>
<p>It&#8217;s literally saved people&#8217;s lives and assets. Evidence is on our side on that one. I would also bet that NSA&#8217;s Type 1 crypto, good as it probably is, would get cracked quickly if they didn&#8217;t keep its design secret &amp; the equipment accounted for.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186264">

			<div class="comment by-wael ">

				<p class="commentcredit">

					<span class="commenter">Wael</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186264">
						October 21, 2012 10:21 PM					</a>

				</p>

				<p>@ Nick P, Clive Robinson, RobertT</p>
<blockquote><p><i> I absolutely believe obscurity is worthwhile&#8230;</i></p></blockquote>
<p>I agree as well. Obfuscation does have its place.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-186265">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186265">
						October 22, 2012 7:34 AM					</a>

				</p>

				<p>On obsfication &amp; randomness.</p>
<p>For a moment flip your thinking the other way up and instead of thinging &#8220;information&#8221; is an artifact of our &#8220;physical universe&#8221; ask yourself what the implication of our &#8220;physical universe&#8221; being an artifact of an &#8220;information universe&#8221;?</p>
<p>It is very easy to realise that there is more information in the universe than there is physical matter, that is information can be encoded not just on the state of the most fundamental particles it can also be encoded by the relationship of particles to each other and other encodings as well (what I call data shadows).</p>
<p>The problem with information encoded by relationships is two fold, firstly like a one time pad you need to know the key to reveal the information, secondly you need to be able to store and communicate the encoded information and the key to also be able to store and communicate thus recover usably the information&#8230;</p>
<p>Thus we know from this that it is not possible to know all the information there is to be known&#8230;</p>
<p>Therefor we know we will not always be able to determine information because even our physical universe obsficates it from us.</p>
<p>Now if we assume our physical universe is a subset of an information universe (which is what it appears it might be) we need to ask questions about information, but can we actually get meaningfull answers?</p>
<p>Possibly not, look at it this way unstable atoms break down to other atoms that may or may not be stable untill you get down to the bottom of the curve where the atoms are stable. The thing is the process is both apparently random on which individual atom breaks and when but seen overall is very predictable in terms of a half life even in quite small quantities. Ask yourself how do reconcile this in reality (not statisticaly), that is how does an individual atom know it&#8217;s time for it to break to maintain the half life curve?</p>
<p>Then look at all our other &#8220;random processes&#8221; which in reality when they are below a certain scale are not realy independent of each other, because on mass their behaviour is predictable statisticaly.</p>
<p>You could argue that on a higher level than the physical universe we perceive there is actually a determanistic process we cannot see going on, and on the levels we can see on an individual basis of the minimum quantity of matter or energy a process that looks random put on mass determanistic.</p>
<p>Our definitions of random are manyfold but at the end of the day they come down to &#8220;unpredictability&#8221; which as far as we can see means not &#8220;nondetermanistic&#8221; only &#8220;we cannot see the determanistic process&#8221; thus it is hidden or obsficated from us.</p>
<p>So as for the &#8220;mathematically inclined (Academic) Crypto types that have bad mouthed obscurity just to sell their own brand of snake oil&#8221; they know (One Time Pad) obscurity is actually the bench mark against which their determanistic models are measured.</p>
<p>But obscurity has just like the one time pad to be bounded in it&#8217;s use otherwise determanism shows through. In the case of the OTP use the same key twice and you can cancel the random noise out to leave the addition of two determanistic but unknown sequences (plaintexts) which can usually be seperated from each other.</p>
<p>For instance if you take several plain texts and add them together (mod 2 etc) at some point their determanistic charecteristics will be nolonger determinable from an unknown or random sequence (at one point it was belived that a book code using four books was from a practical viewpoint unbreakable).</p>
<p>And it is this &#8220;add independent determanistic effects&#8221; to get &#8220;random effects&#8221; which is where obsscurity does work. That is you can raise the bar to the point where our current mathmatical tools cannot tell the diference. In this respect it is a form of &#8220;defense in depth&#8221;.</p>
<p>But&#8230; tools are methods and we know at the end of the day methods like wine generaly get better with time.</p>
<p>This is something we see with block crypto with the safety margin of extra Fiestel rounds.</p>
<p>So I don&#8217;t think at heart cryptographers are trying to sell snake oil, but ONLY &#8220;mathmaticaly valid methods&#8221;. It&#8217;s the next step to practical implementation where it all goes wrong and &#8220;side channels&#8221; especialy timing side channels open up because they were not considered as part of the idealised / clean mathmatical model.</p>
<p>Now I know one reason why this happens and it&#8217;s the perenial war of &#8220;security -v- efficiency&#8221; whilst it is possible to have special purpose dedicated systems that are both secure and efficient they are of no use for other things. General purpose systems are neither inherantly efficient or secure but are of use for many things.</p>
<p>It&#8217;s squaring this circle between specialised and general purpose that is extreamly difficult. An unoptomised CPU design is actually easier to write secure code for than an optomised CPU design, it is the optomisation to improve efficiency in certain operations that opens up the side channels. If and only if you are aware of exactly how these optomisations work can you mitigate their effects and have a secure design.</p>
<p>I very firmly point the finger at the NSA for the problems we have seen with timing channels in practical AES implementations. Why. Because they would have known without doubt about &#8220;security -v- efficiency&#8221; and as NIST&#8217;s domain experts they should have included this in the AES competition specs. The fact they did not can only be seen as a fairly deliberate &#8220;oversight&#8221;. When you add in the deliberate requirment for speed/efficiency into the competition with the requirment that this &#8220;speed freak&#8221; software be made available to all it was inevitable that nearly all initial AES implementations would be riddled with timing channel issues.</p>
<p>The question is why did the entrants not raise this with NIST it is clear that some of the other entrants have higher immunity to side channels than novel &#8220;bricklayer design&#8221; of Rinjdael.</p>
<p>It is in effect a higher than &#8220;specification level&#8221; subversion attack and as such you have to wonder who thought it up.</p>
<p>Although we are not stuck with AES NIST never put into consideration a mitigation policy of what to do when (not if) AES defficiencies come up. For sometime now I&#8217;ve advocated for flexible and extensible framework standards that allow for the changing of not just the primatives such as AES but the modes they can be used in as well but further what you might call the Meta-Modes which are in effect the practical realisations of the way we implement crypto in applications. For instance a PRBS to generate a nonce is defined by the size of the output and the seed values, the fact it could be done with either a stream or block cipher is fairly irrelevant to it&#8217;s function, likewise if it was a block cipher it&#8217;s mode be it CTR or a block feedback mode with or without IV/whitening is again irrelevant to the overall function, likewise if the block cipher is AES/blowfish/etc.</p>
<p>One of the things about the latest competition for hashes is that again the &#8220;novelty act&#8221; appears to have been selected, giving rise to the thought about what practical implementation issues such as timing side channels are we going to see with it down the line&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-186266">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/#comment-186266">
						October 22, 2012 8:54 AM					</a>

				</p>

				<p>@ figureitout,</p>
<p>&#8220;I was going to ask if you could send out circuit schematics, and how you could do that in an ultra secure manner (hand-drawn and delivered maybe), but that may be too much&#8221;</p>
<p>It&#8217;s not realy necessary, there are many agnostic designs already out there. The important thing to remember that the less complexity there is any individual circuit element the harder it is to &#8220;backdoor&#8221; in some way at the factory it is made in.</p>
<p>You can make a simple low level noise source by using a didoe junction and a resistor from a clean power source like a battery. Some diodes are inherantly more noisy than others and lowish voltage zenner diodes have been used for some time to produce usable noise up into the RF bands.</p>
<p>You can improve it&#8217;s performance by actually using two resistors one from supply to zenner and one from zenner to ground, and capacitivly coupling both ends of the zenner into a differential amplifier like a low noise Op-Amp. You can then take the output of the Op-Amp and feed it into another Op-amp to provide either more gain or provide hysterisis like a Schmitt trigger. Providing you run the second Op-Amp of the same rails as the CPU chip then you can connect it into a CPU pin via a resistor.</p>
<p>There is a trick whereby you don&#8217;t need to build the Schmitt triger, what you do is AC (capacitivly) couple the high level noise signal into a CPU input pin via a resistor and put a small value capacitor from the input pin to ground, you also connect another resistor to the input but DC (ie directly) couple it to a CPU output pin. By taking the output high the input will at some later point also go high the time interval is based on the sum of the two input voltages integrating on the small value cap you then take the output low and some time later the input will go low. If you average the go high times and go low times over several reading the difference between this average and a single reading time can be used as a crude but effective A to D converter. It&#8217;s often called a ramp- compare ADC or dual-ramp compare ADC ( <a href="http://www.atmel.com/dyn/resources/prod_documents/doc0942.pdf" rel="nofollow ugc">http://www.atmel.com/dyn/resources/prod_documents/doc0942.pdf</a> ). Similarly you can with a little extra effort make it an Integrating or dual-slope ADC which is often used in Digital Volt Meters for their high linearity conversion. Either of these can be used with oversampling to make a simple Sigma-Delta converter which trades conversion time for accuracy using digital filtering techniques.</p>
<p>However where ever there is analogue circuitry there are not just noise issues but EM and other energy (mechanical/sound etc) fields that will cause a low level desired signal to be swamped and disapear below the noise floor. There are many books and application notes on EMC and good circuit layout techniques for analogue circuits there are even those specific to &#8220;the care and feeding of ADC&#8217;s ( <a href="http://www.linear.com/docs/4160" rel="nofollow ugc">http://www.linear.com/docs/4160</a> ).</p>
<p>As RobertT indicated FFT&#8217;s are a good way to spot when such fields are having an effect (FWT&#8217;s do a similar thing for &#8220;sequency&#8221; not &#8220;frequency&#8221; space). Although FFT&#8217;s are somewhat complicated to code in software you can use a DFT built around lookup tables to get a less resource hungery solution ( <a href="http://www.ieee.li/pdf/adc_evaluation_rf_expo_east_1987.pdf" rel="nofollow ugc">http://www.ieee.li/pdf/adc_evaluation_rf_expo_east_1987.pdf</a> ).</p>
<p>That kind of takes care of a low end TRNG &#8220;noise source&#8221;. However as indicated by RobertT you can partialy protect yourself from external attack by adding in the output of a stream generator into your ADC the effects it has are a little complicated to put it mildly but you can see the interferance being re-modulated by the stream cipher and in effect pushing it down by the coding gain to a point after which the Noise source ceases to be having any significant input and the RNG becomes in effect a CS-PRNG. There are various ways you can use the stream cipher but one is as the driver for the slope or ramp generator if done right this also has the effect of adding &#8220;jitter&#8221; which can actually improve an ADC.</p>
<p>RobertT indicated a Linear Feedback Shift Register or LFSB, many stream ciphers are based on &#8220;lagged generators&#8221; of one form or another, however they all have the defect of being &#8220;linear&#8221; and thus amenable to mathmatical annalysis. So although the lagged generator is the heart the output is actualy done by nonlinear combining of the various latch outputs. The simplest way to do this is with a combination of AND and OR gates if you draw out the truth table of a two input AND gate and two input OR gate you will see that in either case the four output states are unbalanced that is for the OR gate you get zero out for the zero zero input and one for the other three combinations with the AND gate you get zero out except for the one one input state. If however you feed an OR gate with the output of two AND gates which are attached to four of the latches you get a more balanced output from the sixteen states. The problem for an analyst is they cannot go backwards from the output being a zero or one to find the actual input state on the four inputs. Various combinations and levels of such gates make the mathmatics not impossible but generaly a lot harder than trying to brut force every state&#8230; You can also add elements like the &#8220;stop and go&#8221; generator technique but be carefull you don&#8217;t unbalance the output to much.</p>
<p>Any way have fun 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2012/10/friday_squid_bl_347.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2012/10/friday_squid_bl_347.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F10%2Ffriday_squid_bl_347.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2012/10/friday_squid_bl_347.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='4513' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2012/10/ask_nicely_does.html" rel="prev">← "Ask Nicely" Doesn&#039;t Work as a Security Mechanism</a>		<a href="https://www.schneier.com/blog/archives/2012/10/another_liars_a_1.html" rel="next">Another <i>Liars and Outliers</i> Review →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
