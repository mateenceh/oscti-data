<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Stealing VM Keys from the Hardware Cache - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Stealing VM Keys from the Hardware Cache Comments Feed" href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/4585" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=4585' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F11%2Fstealing_vm_key.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F11%2Fstealing_vm_key.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-4585 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-4585" class="post-4585 post type-post status-publish format-standard hentry category-uncategorized tag-academic-papers tag-cryptanalysis tag-cryptography tag-encryption tag-keys tag-side-channel-attacks">

	<div class="article">

		<h2 class="entry">Stealing VM Keys from the Hardware Cache</h2>
		<p><a href="http://www.cs.unc.edu/~reiter/papers/2012/CCS.pdf">Research</a> into one VM stealing crypto keys from another VM running on the same hardware.</p>
<blockquote><p><b>ABSTRACT</b>:  This paper details the construction of an access-driven side-channel attack by which a malicious virtual machine (VM) extracts fine-grained information from a victim VM running on the same physical computer. This attack is the first such attack demonstrated on a symmetric multiprocessing system virtualized using a modern VMM (Xen). Such systems are very common today, ranging from desktops that use virtualization to sandbox application or OS compromises, to clouds that co-locate the workloads of mutually distrustful customers. Constructing such a side-channel requires overcoming challenges including core migration, numerous sources of channel noise, and the difficulty of preempting the victim with sufficient frequency to extract fine-grained information from it. This paper addresses these challenges and demonstrates the attack in a lab setting by extracting an ElGamal decryption key from a victim using the most recent version of the libgcrypt cryptographic library.</p></blockquote>
<p><a href="http://arstechnica.com/security/2012/11/crypto-keys-stolen-from-virtual-machine/">Two</a> <a href="http://gizmodo.com/5958778/how-crypto-keys-can-be-stolen-across-the-cloud">articles</a>.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/academic-papers/" rel="tag">academic papers</a>, <a href="https://www.schneier.com/tag/cryptanalysis/" rel="tag">cryptanalysis</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/encryption/" rel="tag">encryption</a>, <a href="https://www.schneier.com/tag/keys/" rel="tag">keys</a>, <a href="https://www.schneier.com/tag/side-channel-attacks/" rel="tag">side-channel attacks</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html" rel="bookmark">Posted on November 16, 2012 at 6:13 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html#comments">17 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html" data-title="Stealing VM Keys from the Hardware Cache" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-188546">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html/#comment-188546">
						November 16, 2012 7:37 AM					</a>

				</p>

				<p>Hmm, why has it taken so long for the academic research community to get around to this&#8230;.</p>
<p>Seriously the knowledge has been around for a very long time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-188547">

			<div class="comment by-yep ">

				<p class="commentcredit">

					<span class="commenter">yep</span> •

					<a href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html/#comment-188547">
						November 16, 2012 8:39 AM					</a>

				</p>

				<p>This is why OpenBSD devs on the mailing list relentlessly flame anybody claiming VMs by Xen or virtualbox provide any sort of seperation or supposedly increase security. Another reason is the layering of new bugs on top of the already mess of arch that is x86</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-188548">

			<div class="comment by-simon ">

				<p class="commentcredit">

					<span class="commenter">Simon</span> •

					<a href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html/#comment-188548">
						November 16, 2012 9:18 AM					</a>

				</p>

				<p>@Clive &#8211; do you believe this is limited to machines running only two vm&#8217;s?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-188549">

			<div class="comment by-firefox ">

				<p class="commentcredit">

					<span class="commenter">Firefox</span> •

					<a href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html/#comment-188549">
						November 16, 2012 12:01 PM					</a>

				</p>

				<p>Don&#8217;t understand this.  On any grown-up system, separation of VMs should be designed and built into the <i>hardware</i>, so that the operating system, working with the hardware separation facilities, can make it <i>impossible</i> for a VM to access any memory space used by another VM.  If your box uses things like &#8220;shared microarchitectural components such as caches&#8221; which all VMs can get at, it&#8217;s not suitable for multi-user computing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-188550">

			<div class="comment by-lawrence-garvin ">

				<p class="commentcredit">

					<span class="commenter">Lawrence Garvin</span> •

					<a href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html/#comment-188550">
						November 16, 2012 12:19 PM					</a>

				</p>

				<p>A key point of this research, to which the author has readily admitted, was that the issue has only been demonstrated on XEN, and the only reason it has only been demonstrated on XEN is that the source code was readily available.</p>
<p>It remains to be determined whether this just a BUG in XEN, or an inherent design flaw in hypervisors everywhere.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-188551">

			<div class="comment by-moo ">

				<p class="commentcredit">

					<span class="commenter">moo</span> •

					<a href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html/#comment-188551">
						November 16, 2012 4:54 PM					</a>

				</p>

				<p>@Firefox:<br />
They don&#8217;t have any access to each other&#8217;s memory, but any time different software is sharing the same hardware, completely eliminating side-channel information leakage is very difficult.</p>
<p>The physical CPUs are connected to shared cache hardware.  When you ask the cache to access some memory, it takes a short time or a long time depending on what is already in the cache.  The attacker&#8217;s VM can do a bunch of accesses to force the other VM&#8217;s data out of the cache, and then it can measure the timings of its own accesses to the cache.  By doing this, it can deduce which parts of the cache the <em>target</em> VM has been using.  This is information leaking from the target VM to the attacker&#8217;s VM over a side-channel.</p>
<p>If the attacker&#8217;s VM knows (or assumes) that the target VM is currently running some particular crypto code that manipulates the key bits, and that crypto code changes its memory access pattern depending on what the key bits contain (for example, by using some of those key bits to index into a lookup table) then the attacker&#8217;s VM is able to detect those variations, and deduce what at least some of the key bits are.</p>
<p>As noted already by Clive, the idea behind this kind of attack is pretty old.  It sort of reminds me of an old attack I read about somewhere, against a password check function in some old time-sharing OS&#8230; it compared one character at a time and it let the caller supply his own buffer, which means you could tell if the character was correct or not by aligning it at the end of a memory page with unmapped memory right after it and seeing if you got a page fault or not.  In that case it was the OS that leaked information about what it was doing, in this case its the cache hardware that &#8220;leaks&#8221; some vague info about what other software in some other VM has been doing.</p>
<p>But anyway, while the ideas are not new, actually exploiting cache timings to recover key bits sounds pretty tricky.  This research is a practical demonstration of it actually being done on a certain kind of commodity setup which is rather common in the wild.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-188552">

			<div class="comment by-moo ">

				<p class="commentcredit">

					<span class="commenter">moo</span> •

					<a href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html/#comment-188552">
						November 16, 2012 5:09 PM					</a>

				</p>

				<p>Many other variations on &#8220;timing attacks&#8221; are possible.  The most obvious one is detecting the running time of a small piece of code running on another processor, and inferring whether it took the &#8220;fast&#8221; branch or the &#8220;slow&#8221; branch in the code (this is apparently often possible even when that other processor is at the other end of a network connection from the attacker&#8217;s processor&#8211;you can spam it with requests and if a bunch of consequtive requests get routed along the same route, their latencies will tell the story).</p>
<p>Think of any code manipulating large primes (RSA) or elliptic curves, or whatever.  To avoid leaking any timing info, all such code has to be written to take the EXACT SAME AMOUNT OF TIME to manipulate the key material bits, regardless of what those bits contain.  Most library code for multiplying big numbers has the opposite goal (be as fast as possible, for each particular input), making them unsafe for doing crypto with.  Data-dependent conditional branches are an obvious no-no, but there&#8217;s other difficulties too: for example, a multiply instruction might take fewer cycles if the top half of the bits of either operand are all zero.  Thats pretty difficult to work around.</p>
<p>Crypto implementors should be extremely careful when they write their code, to make sure its cycle count, load on execution units, branching pattern, cache usage, etc. are all as invariant as possible across different inputs.  This is just one of the MANY reasons why average programmers should NOT be writing their own cryptographic primitives, they will always fail at this part.  If you care about security, don&#8217;t roll your own&#8211;only use cryptographic routines that were carefully written and vetted by actual security experts.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-188553">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html/#comment-188553">
						November 17, 2012 5:59 AM					</a>

				</p>

				<p>@ Simon,</p>
<p><i>do you believe this is limited to machines running only two vm&#8217;s?</i></p>
<p>There is no reason why it should be at the end of the day it boils down to Signal to Noise Ratio (SNR) and measurment sensitivity.</p>
<p>If you read their paper they say there current limit for measurment accuracy which limits the measurment sensitivity is based on the interupt time they use.</p>
<p>They can either improve the resolution some other way or work out a way to better synchronize it to the desired information in the side channel, which could give them the equivalent of a 100:1 improvment in resolution which in reality would give maybe 100^-2 improvment in the number of VM&#8217;s</p>
<p>Another thing that could be done is to predictively remove noise from the signal. Unlike real noise the noise from the other VM&#8217;s is determanistic but highly complex. If the effects of the other VM&#8217;s can be generated and synced to the coresponding VM&#8217;s in anti-phase then you reduce the artificial noise floor which improves the SNR.</p>
<p>However they don&#8217;t of necesity need to generate an anti-noise signal if they can force the other VM&#8217;s to be effectivly blocked as processes then the VM control programe will &#8220;round robin&#8221; or even swap out the processes depending on how it works in a much easier to predict way.</p>
<p>Now two things I need to say, althought the knowledge of how to do this has been around for quite some time (think back to about a month after AES finalist was anounced). And I&#8217;ve done similar on single processor systems, what these resarchers have done is actually quite difficult to do even in a controled environment so a significant hat tip in their direction. BUT as Bruce has observed on a number of occasions &#8220;Attacks get better with time&#8221;.</p>
<p>Now you need to remember these are academic researchers not those payed for out of the likes of the NSA budget. Now back in the 1980&#8217;s I did my own research out of curiosity into fault injection via modulated EM carrier. The first academic investigation resulting in a published paper was only a couple of years ago and that was with an unmodulated EM carrier. So there was around a quater century gap between me and them. Now I&#8217;m not daft enought to think I was the only person to have thought of it so conceviably the likes of NSA, GCHQ et al had done the same at or before that time&#8230;</p>
<p>So whilst this might be new in terms of published papers as the authors of the paper make fairly clear it might well have been done before confidentialy (I&#8217;d put money on it 😉 so it might well be a standard attack or method for the likes of the NSA or well funded corporate or even a smart individual. Further it might well have been improved upon.</p>
<p>Now one thing to note they mention in their paper that they had their agent running as a VM, but they did mention using network timing (which is what the original AES cache attack used), thus it may well be possible to extract KeyMat from other much less well written libraries/code (think ccommercial closed source) with just a probing attack from the network.</p>
<p>I&#8217;ve mentioned this possability a number of times on this blog as well as a networked way to enumerate a VM host from the network using just the TCP time stamps. I even emailed one of the bods on the honeynet project to warn that what appears to be a &#8220;brain dead script kiddy attack&#8221; could actually be an enumeration attack looking to find VM &#8220;networks&#8221; that are frequently used as research honeynet traps. So a smart attacker with their new zero day can scope out the network first and if they discover a VM network give it a wide birth. Obviously the same attack can be used to work out which VMs are running on the same machine in a co-log site. So even if the web site you want to attack is fully hardened and does not offer any exploitable weaknesses you can find other VM services on the same hardware that are much more accommodating thus get a toe hold into the server and potentialy get out of the VM &#8220;sand pit&#8221; and potentialy root the system to get down into tthe other VM instance of interest. I menttioned this on this blog a number of years back so with it&#8217;s large readership I suspect some people are already doing it.</p>
<p>Hopefully now the developers of VM systems will take this onboard and develop ways to decouple timing on VM networks on a single hardware platform so they cannot be easily enumerated (this is actually quite a hard task as it means digging much further into the base OS than they currently do).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-188554">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html/#comment-188554">
						November 17, 2012 10:18 AM					</a>

				</p>

				<p>@ moo</p>
<p>&#8220;Thats pretty difficult to work around.&#8221;</p>
<p>My solution was that it&#8217;s usually a black box analysis they&#8217;re trying to do. They&#8217;re looking at the network level, process level, or cache. My next move was to defeat the first two by implementing it using normal methods. The tweak was that I&#8217;d already have a timing profile of the algorithms, quick times to slow times. I&#8217;d also take a sample of the time before I do the operation. After the operation, I just loop until the highest time is reached &amp; BAM.</p>
<p>As for cache, I say flush it upon context switch, turn it off or suck it up. Cache is kind of a necessary evil I can live with. I take plenty of measures to prevent new software from running on a system I design. I also have monitoring &amp; auditing of applications. So, I can usually see where a likely cache attack is and haven&#8217;t found any happening. That said, there are recent innovations in this space:</p>
<p>Work on new caches resistant to timing channels<br />
<a href="http://people.engr.ncsu.edu/hzhou/HPCA09.pdf" rel="nofollow ugc">http://people.engr.ncsu.edu/hzhou/HPCA09.pdf</a></p>
<p>Runtime for detecting storage &amp; timing channels<br />
<a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.142.4048" rel="nofollow ugc">http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.142.4048</a></p>
<p>Caisson &#8211; hardware description language for secure information flow<br />
<a href="http://www.cs.ucsb.edu/~xun/papers/caisson-pldi11.pdf" rel="nofollow ugc">http://www.cs.ucsb.edu/~xun/papers/caisson-pldi11.pdf</a></p>
<p>Hey, RobertT, what do you think of Caisson as a language? It&#8217;s targeted for hardware guys, of course, and I can&#8217;t evaluate it due to lack of experience.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-188555">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html/#comment-188555">
						November 17, 2012 6:47 PM					</a>

				</p>

				<p>@Nick P<br />
&#8220;Hey, RobertT, what do you think of Caisson as a language?&#8230;&#8217;</p>
<p>It is very impressive for what it is / does, but IMHO the inherent limitations are of more concern then the accomplishments.</p>
<p>Points to think about:</p>
<p>1) Verilog is the only universal HDL language in wide spread use. Nothing else will be well enough understood by the majority of digital hardware designers to ever give it critical mass.  So asking about the security of hardware designs generated by Caisson is a little like asking about the robustness of Pascal vs C code.  There are clear features in Pascal that make it a more robust language then C, but this  advantage has to be weighted against the limited experience most programmers have with Pascal. This raises the question, Are you trading one set of known problems for a set of unknown problems?</p>
<p>2) WRT trading known for unknown they do make a comment<br />
Note: non-digital side channel attacks like power analysis are not within the scope of this paper.</p>
<p>Physics and process fundamentally dictate the minimum power required for to accomplish a given calculation. furthermore this power is data dependent because Zeros in the upper bits result in a simpler multiply calculation. It is easy to address the timing side channel associated with fast / slow multiply by just matching the cycle count, however the power side channel is not so easily masked because it is inherent in the number of gates flipping. The fixes for the power side channel are far more complex than those required for the timing side channel.</p>
<p>3) Modern CPU chips are power limited not speed limited, which is the main reason we don&#8217;t have CPU clock rates doubling every year or so, the way we did back in the 90&#8217;s .  A modern quad core processor core has a chip die area of about 1sq cm and consumes about 100A , typically from a 1V to 1.2V power supply.  Careful power management is ALL that stops these chips from glowing like a light bulbs.  BTW secure computing fundamentally suggests that both power and timing must be constant. The laws of physics say there must exist some minimum power for all functions. So Secure computers must therefore consume at least double the power to avoid timing side channels and double again to avoid power side channels.</p>
<p>Try to sell 4 times the power, to a chip designer who&#8217;s main concern is the power budget (just look at the problems Intel is trying to overcome to make X86 into a cell phone processor and then tell them that for security reasons you want to increases the power by a factor of 4)</p>
<p>If you ever get to present this idea please invite me along because I want to be ready with a tape measure so I can accurately document exactly how hard your *** gets kicked.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-188556">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html/#comment-188556">
						November 18, 2012 12:26 PM					</a>

				</p>

				<p>@ RobertT</p>
<p>Thanks for your feedback.</p>
<p>&#8220;So asking about the security of hardware designs generated by Caisson is a little like asking about the robustness of Pascal vs C code. There are clear features in Pascal that make it a more robust language then C, but this advantage has to be weighted against the limited experience most programmers have with Pascal. &#8221;</p>
<p>It&#8217;s funny you mention that. I was recently looking into using Modula-3 or a modern Pascal for systems programming. Plenty of great work in OS security &amp; type safety wen&#8217;t into those languages. Robust OS&#8217;s were also easily implemented in them. Ignoring libraries &amp; IDE&#8217;s, my main issue was &#8220;will other people be able to pick this stuff up or will it just be constant problems?&#8221; I&#8217;ve held off so far.</p>
<p>&#8220;If you ever get to present this idea please invite me along because I want to be ready with a tape measure so I can accurately document exactly how hard your *** gets kicked.&#8221;</p>
<p>LOL. A camcorder might be more effective. Even as you say this, you give me an out.</p>
<p>&#8220;Note: non-digital side channel attacks like power analysis are not within the scope of this paper.&#8221;</p>
<p>The 2 and 3 portions mostly apply to solving both timing channels &amp; power channels. I was thinking of using the tech for security appliances or secure co-processors. Most such devices assume physical security &amp; a trusted administrator. I doubt power analysis is an issue here. So, the worst case takeaway is 2x the power for secure against timing channels.</p>
<p>Considering the likely use model, this doesn&#8217;t seem all that bad. I&#8217;m in the boardroom talking about some components that make up a small part (or a security-critical part) of the company&#8217;s IT space. I say the chips are made with verification technology to do what they say they will do. I say they also take 2x the power of competing low-power chips w/out assurance. So far, it sounds like a small issue rather than a dealbreaker. I could see your argument if it was a smartphone, server system, etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-188557">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html/#comment-188557">
						November 18, 2012 1:33 PM					</a>

				</p>

				<p>@ Nick P, RobertT,</p>
<p><i>BTW secure computing fundamentally suggests that both power and timing must be constant. The laws of physics say there must exist some minimum power for all functions.</i></p>
<p>The laws of physics are a bit iffy on this score 😉</p>
<p>For instance it is claimed that the energy is recoverable if the computation is reversable in some way (look up the theory behind FredKin and Toffolie gates).</p>
<p>But what is reversable and what is not&#8230;</p>
<p>In classical logic the output of the some gates is not considered reversable for various reasons and others only reversable if you know the output of the gate and N-1 of the inputs (AND, OR, XOR).</p>
<p>Normally for security the assumption is as an external observer you ONLY ever KNOW THE OUTPUT&#8230;</p>
<p>However that said the binary 1bit by 1bit multiplier is a strange beast because multiplying the two bits together never produces a carry (0x0=0, 0x1=0, 1&#215;0=0 and 1&#215;1=1 which is your basic AND gate function) with all other numbers it does produce a carry or to look at it another way you have nx2 input digits which will produce a 2n number of output digits. Thus you make an Nbit multiplier with an array of AND gates which then feed an adder tree to produce the final output (this has some distinct disadvantages that I will ignore for now 😉</p>
<p>So for half the multiply power issue you can resolve it by making a complementary array of AND gates where you invert the input thus the power signiture is the same for both arrays (assuming you can get delay diffs down sufficient to stop a microwave sig being formed). As for the other half of the multiplier the adder, a similar thing can be done but it&#8217;s rather more difficult to describe.</p>
<p>Similar reversability can be done with many logic circuits however there is the question of the one way functions in Fiestel networks&#8230; Even though the text function (XOR) is clearly reversable the way the one way function is used it has no reason to be either reversable or for that matter have an inverse that would give a balanced power signiture&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-188558">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html/#comment-188558">
						November 18, 2012 3:55 PM					</a>

				</p>

				<p>These days the actual Gate power losses are much lower than the charge / discharge losses associated with interconnect between the gates.  since most of this capacitance is to adjacent bit signals it also means that the power losses are data dependent. So two bits changing together can have lower power tan one bit switching.</p>
<p>In modern processes a lot of effort goes into lowering the dielectric constant of the insulator. It used to be that SOG (spin on glass) was the standard Interlevel dielectric (ILD) used by everyone, but know exotic organic compounds like &#8220;black diamond&#8221; or a whipped up glass called OSG are the most common.</p>
<p>There are ways to levelize the power, without completely killing the project. Ross&#8217;s team at Cambridge has played around with fully differential logic which helps with the equalizing gate power but not necessarily with ILD switching losses.</p>
<p>My preferred method is to simply use a Shunt regulator. This can take the form of a Switched Capacitor regulator system whereby the storage cap charges when power is lower than average and reverses delivering power back to the system when the peaks occur.  So you get some energy storage and because it is all local someone external will have real trouble doing DPA on the system, especially if the VDD (power) rail is variable.</p>
<p>The problem with my solution is that I have in effect created my own on chip DPA system. So I&#8217;d better be absolutely certain that no one can access any information about the state of this circuit. Otherwise&#8230;&#8230;.</p>
<p>Herein lies the basic problem with designing high assurance chips. There are a lot of things that you can do but most of the time you don&#8217;t know if you are helping or hurting because the answer depends on what glasses you are wearing.</p>
<p>Another real problem that is never discussed is &#8220;educating the hacker&#8221;. If you assume that the &#8220;Enemy knows the system&#8221; or will know the system Than you also have to accept that the enemy will analysis every defensive circuit that you create. They will asks themselves Why is he doing that?  Think about showing an anti DPA circuit to someone that does not know about this technique.  It wont take them long to understand what you are trying to obscure.</p>
<p>When I analysis other peoples defensive circuits I sometimes say Wow, but more often Huh! what&#8217;s that trying to do?  There are cases where Huh becomes WOW when I&#8217;ve had some time to think about it.   I remember being totally confused when I first saw an anti PICA  (photon emission analysis ) circuit. Basically it was a distributed circuit designed to randomly generate photon emissions over a wide area of the circuit.</p>
<p>My take away upon discovering this circuit was that the use of chip backside photon emissions analysis is far more advanced / common than I had previously assumed. Naturally this knowledge effects where I focus my efforts.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-188559">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html/#comment-188559">
						November 18, 2012 5:17 PM					</a>

				</p>

				<p>@ RobertT,</p>
<p>Your mention of Camb labs and PICA jogged my memory also your previous menttion of some quite nice optical gear bubbled up</p>
<p>So llike all itches I had a scratch and a little hunt around later,</p>
<p><a href="http://www.cl.cam.ac.uk/~sps32/fdtc2009_slides.pdf" rel="nofollow ugc">http://www.cl.cam.ac.uk/~sps32/fdtc2009_slides.pdf</a></p>
<p>I dont know if you&#8217;ve seen the slides or even heard the talk, but the impression given is that rudimentary PICA can be done with what is in effect &#8220;hobbyists&#8221; equipment that can be purchased for around a quater of the average takehome pay&#8230;</p>
<p>One thing it does point out though is photon emmission from semiconductor nunctions has been well known for over fourty years, so I would suspect there are some &#8220;insiders&#8221; who have had good funding to make very significant efforts in taking advantage.</p>
<p>One thing I do remember from the late 70&#8217;s was near IR optics were made of some interesting substances back then, some of which although common (ie potassium chloride) did not like being used in ordinary atmospheric conditions (due to such anoying things as water vapour etc).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-188560">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html/#comment-188560">
						November 18, 2012 6:39 PM					</a>

				</p>

				<p>@Clive Robinson<br />
&#8220;I dont know if you&#8217;ve seen the slides or even heard the talk, but the impression given is that rudimentary PICA can be done with what is in effect &#8220;hobbyists&#8221; equipment&#8230;&#8221;</p>
<p>The equipment does not necessarily need to be overly expensive you just need to know where to get what you want.</p>
<p>Personally I use oil immersion optics for back side analysis, (which IMHO is actually much simpler than topside optical analysis).</p>
<p>The semiconductor photons are generally emitted in the 700nm to 1100nm range so you don&#8217;t need exotic sensors, typical Digital Camera sensors are actually very good (especially if you cool them and polish off the IR filter ) The CCD senors can then be directly laid on the back of the chip. if the sensor pixel area is less than 4um then you are at about the same focus limit as exists for any far field optical setup.  This setup only requires you to buy a professional grade digital camera (less than $5K ) but even a cheap $100 camera will work albeit with a higher noise floor and no access to the actual image file (cheap cameras give  JPEG compression)</p>
<p>I have my own techniques for getting much better resolution and sensitivity but I&#8217;m not willing to discuss this at the moment.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-188561">

			<div class="comment by-l-sica ">

				<p class="commentcredit">

					<span class="commenter">L Sica</span> •

					<a href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html/#comment-188561">
						November 19, 2012 8:41 PM					</a>

				</p>

				<p>It may be architectural.  I only say this because in talking with a rather large cloud vendor they stated they were aware of the issue and had already modified their stack to deal with this sort of thing.  They use a heavily modified XEN.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-188562">

			<div class="comment by-z ">

				<p class="commentcredit">

					<span class="commenter">z</span> •

					<a href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html/#comment-188562">
						November 20, 2012 9:27 AM					</a>

				</p>

				<p>moo is probably thinking of TENEX and the password weakness resulting from page alignment with testing one character at a time.   <a href="http://www.scs.stanford.edu/nyu/02sp/notes/l2.pdf" rel="nofollow ugc">http://www.scs.stanford.edu/nyu/02sp/notes/l2.pdf</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2012/11/stealing_vm_key.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2012/11/stealing_vm_key.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2012%2F11%2Fstealing_vm_key.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2012/11/stealing_vm_key.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='4585' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2012/11/the_terrorist_r.html" rel="prev">← The Terrorist Risk of Food Trucks</a>		<a href="https://www.schneier.com/blog/archives/2012/11/jamming_4g_cell.html" rel="next">Jamming 4G Cell Networks →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
