<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>Really Clever TLS Attack - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Really Clever TLS Attack Comments Feed" href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/4689" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=4689' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2013%2F02%2Freally_clever_t.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2013%2F02%2Freally_clever_t.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-4689 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-4689" class="post-4689 post type-post status-publish format-standard hentry category-uncategorized tag-aes tag-cryptanalysis tag-cryptography tag-hashes tag-sha-1 tag-tls">

	<div class="article">

		<h2 class="entry">Really Clever TLS Attack</h2>
		<p><a href="http://www.isg.rhul.ac.uk/tls/TLStiming.pdf">This</a> is an extremely clever man-in-the-middle timing attack against TLS that exploits the interaction between how the protocol implements AES in CBC mode for encryption, and HMAC-SHA1 for authentication.  (And <a href="http://nakedsecurity.sophos.com/2013/02/07/boffins-crack-https-encryptionin-lucky-thirteen-attack/">this</a> is a really good plain-language description of it.)</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/aes/" rel="tag">AES</a>, <a href="https://www.schneier.com/tag/cryptanalysis/" rel="tag">cryptanalysis</a>, <a href="https://www.schneier.com/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://www.schneier.com/tag/hashes/" rel="tag">hashes</a>, <a href="https://www.schneier.com/tag/sha-1/" rel="tag">SHA-1</a>, <a href="https://www.schneier.com/tag/tls/" rel="tag">TLS</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html" rel="bookmark">Posted on February 11, 2013 at 1:25 PM</a>			•
			<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html#comments">21 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html" data-title="Really Clever TLS Attack" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-191702">

			<div class="comment by-bobd ">

				<p class="commentcredit">

					<span class="commenter">bobD</span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191702">
						February 11, 2013 1:50 PM					</a>

				</p>

				<p>what about CTR</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-191703">

			<div class="comment by-matthew-x-economou ">

				<p class="commentcredit">

					<span class="commenter">Matthew X. Economou</span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191703">
						February 11, 2013 2:42 PM					</a>

				</p>

				<p>I&#8217;m somewhat astounded to read that TLS doesn&#8217;t include proper authenticated encryption.  Or did I misunderstand the paper?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-191704">

			<div class="comment by-alan-kaminsky ">

				<p class="commentcredit">

					<span class="commenter">Alan Kaminsky</span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191704">
						February 11, 2013 3:47 PM					</a>

				</p>

				<p>@Matthew: <i>TLS doesn&#8217;t include proper authenticated encryption.</i></p>
<p>I wouldn&#8217;t make so broad a statement. TLS <i>with AES-CBC and HMAC-SHA1</i> leaks some information about the plaintext. As pointed out in the related blog post by Paul Ducklin, TLS version 1.2 <i>with AES-GCM</i> authenticated encryption is not susceptible to this attack.</p>
<p>It&#8217;s probably fair to say that TLS has accrued too many options and versions to remain secure overall. Time to throw it out and build a new protocol that avoids all the problems identified with TLS over the years. Who&#8217;ll go first?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-191705">

			<div class="comment by-john ">

				<p class="commentcredit">

					<span class="commenter">John</span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191705">
						February 11, 2013 3:55 PM					</a>

				</p>

				<p>A proposal for a new secure protocol? Time for obigatory xkcd: <a href="http://xkcd.com/927/" rel="nofollow ugc">http://xkcd.com/927/</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-191706">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191706">
						February 11, 2013 5:09 PM					</a>

				</p>

				<p>@ Alan Kaminsky,</p>
<p><i>Time to throw it out and build a new protocol that avoids all the problems identified with TLS over the years. Who&#8217;ll go first?</i></p>
<p>Opps there goes baby with the bath water&#8230;</p>
<p>Two of the things I warn against regularly are,</p>
<p>1, Protocol Attacks.<br />
2, Fall back Attacks.</p>
<p>The likes of the NSA are aware that putting the fix in on standards and protocols is going to make a happy hunting ground for their activities.</p>
<p>But even more devistating is the &#8220;Fall Back&#8221; effect caused by the legacy issue of trying to fix broken protocols and standards.</p>
<p>Put simply there are always going to be systems using the old insecure protocols that cannot be upgraded or patched (and the closer to the physical infrastructure the more likely it is). Thus all new software will need to be &#8220;backwards compatible&#8221; and this means you need a working &#8220;fallback mechanism&#8221;. Unfortunatly many will insist that this mechanism will need too be as transparant as possible so as not to cause users to worry their pretty little heads over. And the software developers will thus take it as read that &#8220;out of sight is out of mind&#8221; for the user.</p>
<p>The problem is if the user cannot see the protocol fall back happening they will not be aware that what they are doing is insecure at best. Or as is increasingly more likely at worst having the fall back being initiated and controled by a Man In the Middle (MITM) attack which deliberatly forces the negotiation to the weakest combination which could (and has been) plain text&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-191707">

			<div class="comment by-mik ">

				<p class="commentcredit">

					<span class="commenter">mik</span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191707">
						February 11, 2013 5:17 PM					</a>

				</p>

				<p>I think a good pruning of the default ciphersuites is due, at the very least.</p>
<p>It&#8217;s quite frightening the surface area that a typical TLS handshake has.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-191708">

			<div class="comment by-jonathan-wilson ">

				<p class="commentcredit">

					<span class="commenter">Jonathan Wilson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191708">
						February 11, 2013 5:21 PM					</a>

				</p>

				<p>I think the biggest problem we have with TLS/SSL is the number of broken clients and servers that say &#8220;I support &#8221; but will fail if you actually try to use it. Which means many clients and servers cant default to enabling the secure versions.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-191709">

			<div class="comment by-paul-suhler ">

				<p class="commentcredit">

					<span class="commenter">Paul Suhler</span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191709">
						February 11, 2013 5:49 PM					</a>

				</p>

				<p>This inspired me to look for information on upgrading Chrome to TLS 1.2 (which it turns out isn&#8217;t supported).  Way down one of the paths I followed, I ran across a developer who reported (<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=480514#c63" rel="nofollow ugc">https://bugzilla.mozilla.org/show_bug.cgi?id=480514#c63</a>) that an unnamed financial institution he&#8217;d worked with was not willing to incur the expense to upgrade their security unless there was a <em>guarantee</em> that it would prevent their being hacked.  Of course, no such guarantee is possible.  The institution would prefer to spend millions of dollars per quarter for insurance to cover themselves against regulatory fines and to fix customer problems resulting from a breach.</p>
<p>That was one voice.  Does anyone else have related cost/benefit stories?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-191710">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191710">
						February 11, 2013 6:49 PM					</a>

				</p>

				<p>Oh &#8220;Obligitory word of Caution&#8221;</p>
<p>For those that read what Bruce describes as the &#8220;good plain language&#8221; descriiption. In the remidies section it mentions the use of a &#8220;stream cipher&#8221; to remove the need for &#8220;plain text padding&#8221; for using with a block cipher.</p>
<p>If you are going to use a stream cipher be aware that you have to amour the plaintext to stop bit flipping attacks.</p>
<p>Bruce has mentioned many years ago in his book on cryptography why you should not use a stream cipher without first armouring the plain text.</p>
<p>However tiime has moved on (around one sixth of a century&#8230; 😉 and people forget. Worse they also are lazy with what they write. In the easy to read version the author talks about &#8220;checksums&#8221; in a fairly free way and neglects to mention that there are a whole variety of checksums out there to use, only a few of which are &#8220;Secure Checksums&#8221; that could be used to armour plaintext against stream cipher bit flipping attacks. Whilst those with specialist knowledge correctly expand in their heads the authors use of &#8220;checksum&#8221; others without the specialist knowledge might well see &#8220;checksum&#8221; and think of CRC or additive checksums&#8230;.</p>
<p>Further even if the plaintext is correctly armourd it won&#8217;t of necesity stop time based attacks such as the one described in the Royal Holloway paper, because they are an &#8220;implementation dependent&#8221; attack chosen inadvertantly by the person writing the software.</p>
<p>One of the things I&#8217;ve mentioned on this blog quite a few times is &#8220;Efficiency -v- Security&#8221; time based attacks are a direct consiquence of this. That is the software writter does not take the time to ensure that response times are the same regardles of success or fail, because &#8220;fail fast&#8221; is seen as more efficient than &#8220;fail at the end&#8221;.</p>
<p>As I&#8217;ve also said on this blog a number of times with regards to TEMPEST/EmSec and ComSec in general is &#8220;Clock the inputs and clock the outputs&#8221; and also &#8220;Fail hard on error&#8221; as both help remove time based attacks as well as reducing the information leak bandwidth of any incidental side channels.</p>
<p>Untill code cutters and those who manage them grasp these thorny issues and address them properly then we will continue to read papers such as these.</p>
<p>And don&#8217;t be fooled into thinking that the 8million or so tries makes this an impractical attack.</p>
<p>Because where there is one fault there is almost always another. And the use of one can be levreged by the use of another.</p>
<p>That is on a busy site 8million failures might well be down in the noise floor of the overall number of failures. If you can find a way to spread these failures across all the traffic then it might well not be noticed. Then by correlating the results you may gain sufficient information about another weakness in the system (such as say synchronising to the random number generator) which enables you to significantly reduce the number of tries required in other areas or on a single target or all targets.</p>
<p>That is we tend to think about &#8220;our communications being secure&#8221; not &#8220;all communications being secure&#8221; represive and other nation state regimes usually don&#8217;t care about speciffic communications, but any communications they can get/weaken/read. That is we think &#8220;target and scalpel&#8221; they think &#8220;hoover and sort&#8221;, and the differences in these mindsets give rise to different attack viewpoints and thus attack vectors.</p>
<p>As has been pointed out the sports fisherman dreams of that special catch, but will be happy with a decent catch thus they bait their hook. The commercial fisherman cares only for the total catch thus spreads a net far and wide.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-191711">

			<div class="comment by-martinr ">

				<p class="commentcredit">

					<span class="commenter">martinr</span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191711">
						February 12, 2013 3:15 AM					</a>

				</p>

				<p>It&#8217;s really a pity that the 2006 change of GenericCipherBlock PDU in TLSv1.1 only added an explicit CBC-IV, but did <em>not</em> follow Serge Vaudenay&#8217;s explicit recommendation to pad-mac-encrypt rather than the SSLv3/TLSv1.0 mac-pad-encrypt.</p>
<p><a href="http://infoscience.epfl.ch/record/52417/files/IC_TECH_REPORT_200150.pdf" rel="nofollow ugc">http://infoscience.epfl.ch/record/52417/files/IC_TECH_REPORT_200150.pdf</a></p>
<p>Section 5.1 SSL/TLS (2nd paragraph):</p>
<p>TLS v1.0 also provides an optional MAC which failed to thwart the attack:<br />
  when the server figures out that the MAC is wrong, it yields the bad_record_mac<br />
  error. However, the message padding is performed after the MAC algorithm, so<br />
  the MAC does not preclude our attack since it cannot be checked before the<br />
  padding in the decryption.</p>
<p>Section 6.5 CBC-PAD with Integrity Check</p>
<p>One can propose to add a cryptographic checkable redundancy code<br />
  (crypto-CRC) of the whole padded message (like a hashed value)<br />
  in the plaintext and encrypt</p>
<pre><code>            message|padding|h(message|padding)
</code></pre>
<p>This way, any forged ciphertext will have a negligible probability<br />
  to be accepted as a valid ciphertext. Basically, attackers are no<br />
  longer able to forge valid cipher-texts, so the scheme is virtually<br />
  resistant against chosen ciphertext attacks.</p>
<p>Obviously it is important to pad before hashing: padding after<br />
  hashing would lead to the a similar attack. The right enciphering<br />
  sequence is thus</p>
<pre><code>            pad, hash, encrypt
</code></pre>
<p>Conversely, the right deciphering sequence consists of decrypting,<br />
  checking the hashed value, then checking the padding value.<br />
  Invalid hashed value must abort the decipherment.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-191712">

			<div class="comment by-peter ">

				<p class="commentcredit">

					<span class="commenter">Peter</span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191712">
						February 12, 2013 3:36 AM					</a>

				</p>

				<p>What about ARIA and Camellia? They&#8217;re included in the TLS cipher suite options, but not mentioned in the paper: is this because they use a different MAC/padding construction?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-191713">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191713">
						February 12, 2013 5:53 AM					</a>

				</p>

				<p>Where is that guy last week that was so absolutely certain that smart meter communications were safe and secure.</p>
<p>It&#8217;s simple timing attacks like this that make MiTM attacks so difficult to defend against (even for a wired comms system). When the comms link is RF, as in a Zigbee mesh meter system, you have to expect attackers to will attempt to interfere with the link (bit-flipping / bit jamming attacks). These bit attacks can be used to jam the mesh link communications and observe the comms packet jitter. Meaning you do not necessarily need to be sitting in the middle (as in MitM) you can safely sit on the side lines and still implement your attack.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-191714">

			<div class="comment by-link ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://hackerkepzes.hu' rel='external nofollow ugc' class='url'>LINK</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191714">
						February 12, 2013 6:51 AM					</a>

				</p>

				<p>That&#8217;s why MiTM attacks are hard to defend.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-191715">

			<div class="comment by-garrett ">

				<p class="commentcredit">

					<span class="commenter">Garrett</span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191715">
						February 12, 2013 9:22 AM					</a>

				</p>

				<p>I&#8217;m not an expert in the field, but from looking at the &#8220;simplified&#8221; explanation, it seems to me that if the padding was before the MAC and thus covered by it, the MAC would be checked before the padding is even evaluated. The result would be then that the tampering would be detected right away and in deterministic time.<br />
Only after the MAC verification has passed would the padding then be evaluated for length and stripped.<br />
Am I missing something here?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-191716">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191716">
						February 12, 2013 11:55 AM					</a>

				</p>

				<p>I think I might be missing something here. In the past, the crypto people taught me to encrypt, then MAC. This allows both plaintext and ciphertext integrity, maybe with other benefits. They also talked about padding issues. So, I used Counter modes, fixed packet lengths, and total fail error handling to counter them. My designs seem to still be safe. One plexing question.</p>
<p>Why don&#8217;t they encrypt and then MAC?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-191717">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191717">
						February 13, 2013 6:55 AM					</a>

				</p>

				<p>@ Nick P,</p>
<p><i>Why don&#8217;t they encrypt and then MAC?</i></p>
<p>The short answer is two words &#8220;History &amp; Perspective&#8221;, the long answer is explaining why&#8230;</p>
<p>Depending on how you look at it the history of &#8220;cryptograhy&#8221; is very old more simply people have &#8220;been keeping secrets since befor they could communicate&#8221;. It goes back even prior to &#8220;Hunter Gatherer&#8221; tribal society and can be seen in the behaviour of animals. In essence it&#8217;s a survival trait to not communicate to competitors sources of food etc.</p>
<p>This continued through tribal life and promoted the ability to &#8220;cheat&#8221; or &#8220;lie&#8221; to protect &#8220;you and yours&#8221;. And it&#8217;s still going strong today, we all likes society for what it brings us but when push comes to shove and things come down to basic survival and a choice between &#8220;you and yours and society&#8221; you know the preference order.</p>
<p>Whilst the basic rules of the game have not changed technology has repeatedly moved the goal posts and thus the perspective.</p>
<p>Prior to writing to communicate a secret required a person to go to the person they were going to share the secret with and tell them in person or&#8230; involve a third party as a go between who would also become privy to the secret for as long as they lived. Which brought up various issues of &#8220;trust&#8221;&#8230;</p>
<p>These trust issues were partialy solved with writing and the invention of tamper evident ways of hiding them from the go between (baked clay tablets that were then put in clay enevelops that had seals impressed and then baked again).</p>
<p>However there were still trust issues in that the messenger was party to the fact of communication and thus could reveal that a problem we would now call &#8220;traffic analysis&#8221;.</p>
<p>The idea of courier services and multiple envelops partialy resolved this in a way we would now associate with Onion Routing. However it introduced other problems such as &#8220;nodes&#8221; where all communications went through and thus were vulnerable so we got the various &#8220;Black Chambers&#8221; where envelops could be opened and resealed without being (easily) detected.</p>
<p>And as we know the ciphers were not upto hiding the information except in isolated cases as Mary Queen of Scots exemplified resulting in her losing her head. Even code books were fairly easily broken if sufficient traffic was available for examination, and rather less if the communications context was known.</p>
<p>So the idea of &#8220;Super Encryption&#8221; came about where the message was first coded via a code book that only rarely changed, and this was then encrypted via a cipher system. But all the while the special papers and envelopes with seals etc were retained which still gave the impression of authenticating the communication.</p>
<p>Thus the idea of what we now refer to as the CIA triade was inplace several hundred years ago with Confidentiality provided by codes and ciphers, Authentication provided by special papers and seals, with Integraty given by the design and use of the envelopes and seals.</p>
<p>Then we had the application of electricity to communications giving rise to firstly the telegraph, which had the side effect of destroying the existing Authentication and Integrity methods and also made the passing of traffic obvious. Then the telephone which did atleast alow some (all be it faux) authentication to return. But as WWI showed the use of the telephone alowed the start of what was later to be called TEMPEST attacks. But there was also the new fangled Radio Telegraphy using &#8220;spark gap transmitters&#8221; where authentication and any kind of integrity were just not possible in anything aproaching a reliable way.</p>
<p>But worse it was also painfully obvious that the existing codes and ciphers were just not upto the job and this was made quite public in the writings of Winston Churchill after the war who put a lot of the UK Navies successes to code breaking in the English Admiralty Office.</p>
<p>Thus it was clear to all major Governments that the whole security of millitary communications rested on these inadiquate, difficult and thus untimely codes and ciphers.</p>
<p>It however had come to the notice of one or two people that whilst the various military organisations had basicaly stayed in the past commercial organisations had been much more forward thinking and in a limiited way had embraced machine cryptography and thus in some cases had more security than the equivalent military communications. And it would appear had also solved the authentication issue with such machines.</p>
<p>The result as we know was the German Enigma the British Typex and the later US and Nato SIGBA systems. But as we now know all the pre-war mechanical systems could be easily replaced with paper analogs and worse the use of mechanics for ciphering had been taken a step further with automated attacks by motorised machines and early electronic devices that were the forrunners of computers.</p>
<p>However what it did put in way to many minds was the belief that basic crypto alone could give you the CIA triad. And thus emphasis was given to Basic Crypto as being the magical solution even where various people knew very much otherwise (GCHQ,NSA etc) but for operational reasons wanted to keep it very very hush hush.</p>
<p>But due to government policy and a whole load of other issues prior to the DES competition civilian/comercial crypto was to be blunt a joke.</p>
<p>DES in effect kick started civilian and academic interest in Crypto again and arguably it has now in some areas beaten the governmant agencies at their own game and is in other areas progressing more rapidly than such agencies worst nightmares.</p>
<p>Back in the 1980&#8217;s I and a very few others were banging on about how to attack systems via what you might call &#8220;Reverse TEMPEST&#8221; and slowely but surely the academic world is catching up.</p>
<p>The academic world has likewise realised that there is one heck of a lot more to do with security than just algorithms. Part of this can be seen with the HASH competition, where the &#8220;so what&#8221; attitude has hit home because the game has moved on significantly in other areas. The pigeons are coming home to roost on protocols and the resulting chinks in the armour which we call side channels, that like tiny holes in the bucket drain secrecy away not instantly but still very very effectivly.</p>
<p>We are finding out that contrary to theoretical ideas in the practical world it realy does matter in what order you do things and how.</p>
<p>But importantly we are finaly waking upto the fact that our preconceptions and assumptions inherited from a previous age are wrong.</p>
<p>Thus the long held assumption by many that the final Crypto Envelope gives the CIA triad is wrong it&#8217;s not &#8220;magical pixie dust&#8221; you sprinkle on and all is right with the world. Other considerations apply. Just as with real world envelops you can feel through them and under certain conditions even see through them to get a good idea of what&#8217;s inside, all you need are the right tools.</p>
<p>We currently talk glibly of &#8220;time based&#8221; side channels but forget there are many others that the likes of electronic engineers are only too aware of.</p>
<p>As I&#8217;ve indicated in the past &#8220;Efficiency -v- Security&#8221; is a very real issue. If you do things the right way you can make all theoreticaly secure algorithms used to construct crypto enevelopes transparent&#8230;</p>
<p>Matt Blaze and some of his students ably demonstrated this several years ago by implementing a bug device in a keyboard that simply by delaying key stroke information in a predictable way made the entire computer and it&#8217;s OS and applications transparent and thus leaked information directly onto the network.</p>
<p>If the hardware designers or even the OS or App software writers had thought about it it would not have been that easily possible because they would have &#8220;clocked the input&#8221; in the right way.</p>
<p>Even now many theoretical frameworks and the resulting design verification systems don&#8217;t take clocking of the inputs and clocking of the outputs into consideration.</p>
<p>Those doing TEMPEST / EmSec design at indepth levels are only too well aware of this requirment but many are not.</p>
<p>Back in the 1980&#8217;s I was demonstrating &#8220;active fault injection&#8221; and how it could be synchronised to the operation of a CPU outside of the case with no direct electrical connection. The result was I could make a &#8220;pocket gambling device&#8221; pay out way way more than it should. Others have used the same ideas to (supposadly) &#8220;defraud&#8221; the likes of Casinos in Nevada etc in much more recent times.</p>
<p>As far as I&#8217;m aware the only academic paper on RF fault injection is by a couple of people at the UK Cambridge labs who pointed an unmodulated carrier at a supposedly secure TRNG and reduced its entropy from 32bits to less than 8bits. They however did not put envelope or phase modulation on the carrrier or make any attempt to synchronize it to the devices operation. The chances are if they did they may well reduce the entropy to zero and actually force the TRNG to output what ever thirty two bit number they desired, thus being able to defeat any defenders statistical analysis of the output&#8230;</p>
<p>Then what about Quantum Key Distrubution, the designers of many of the practical devices appear too be compleatly unaware that the order you put certain components in was important to stop active fault injection. If you can some how read Alices polariser (or it&#8217;s random generator) then it&#8217;s game over for the security. Some designers failed to realise that you could couple out of band energy back into Alice&#8217;s transmitter and read the state of the very broad band polariser simply due to what it reflected or did not reflect of the out of band signal&#8230;</p>
<p>There are a whole load more interesting fault injection attacks you can make on QKD equipment some of which have been published none of which so far are (as far as I&#8217;m aware) what I would call synchronised fault injection attacks.</p>
<p>Every time you can trace the root of these failings back to assumptions that often are actually sufficiently well known to be false but like our DNA appear hard coded into us by our forebears..</p>
<p>I&#8217;m reminded of the mem of a once frequent poster (RSH) here 😉</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-191718">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191718">
						February 13, 2013 10:17 AM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>&#8220;I&#8217;m reminded of the meme of a once frequent poster (RSH) here ;-)&#8221;</p>
<p>It&#8217;s funny you mention that. I was messing with him on Krebs a while back. Posted our old debate for the Krebs audience, started a new one. Lulz.</p>
<p><a href="https://krebsonsecurity.com/2013/02/security-firm-bit9-hacked-used-to-spread-malware/comment-page-1/#comment-152064" rel="nofollow ugc">https://krebsonsecurity.com/2013/02/security-firm-bit9-hacked-used-to-spread-malware/comment-page-1/#comment-152064</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-191719">

			<div class="comment by-sparkygsx ">

				<p class="commentcredit">

					<span class="commenter">sparkygsx</span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191719">
						February 15, 2013 9:21 AM					</a>

				</p>

				<p>Encrypting first and adding the checksum afterwards seems quite useless to me, because the attacker CAN calculate the correct checksum for any forged or modified packet anyway. The &#8220;plain language&#8221; article didn&#8217;t mention any secret included in the checksum (without any secret, a it&#8217;s not really a MAC).</p>
<p>Wouldn&#8217;t it be easier and better in many ways to add the padding at the beginning of the packet, using 16-31 bytes of random data, before encryping? That would have prevented the transmission of separate packets with identical cyphertext, making this and many other statistical attacks much more difficult or impossible?</p>
<p>I&#8217;d think any reasonable amount of packet switching would make such timing attacks very difficult; if the natural timing variation is much larger than the time difference being measured, it becomes very difficult to measure the signal that is way below the noise floor.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-191720">

			<div class="comment by-jonadab ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mistersanity.blogspot.com/' rel='external nofollow ugc' class='url'>Jonadab</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191720">
						February 16, 2013 6:55 AM					</a>

				</p>

				<p>In practice, an attack that relies on perfectly measurable server-response timing over thousands of iterations is effectively meaningless on the public internet.</p>
<p>You know what&#8217;s a lot easier to pull off than this attack?  Just go down the (entirely too lengthy) list of trusted certificate authorities, find <em>one</em> that doesn&#8217;t have adequate security, infiltrate it, and issue yourself whatever fake key you need.  The user&#8217;s browser will not complain when the certificate is suddenly unexpectedly different from the one presented last time.  As long as it&#8217;s signed by anybody on the list, the browser is happy and the user suspects nothing.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-191721">

			<div class="comment by-jonadab ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://mistersanity.blogspot.com/' rel='external nofollow ugc' class='url'>Jonadab</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191721">
						February 16, 2013 6:59 AM					</a>

				</p>

				<p>Err, where I said &#8220;fake key&#8221;, I clearly meant &#8220;fake cert&#8221;.  Sorry about that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-191725">

			<div class="comment by-guru ">

				<p class="commentcredit">

					<span class="commenter">Guru</span> •

					<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/#comment-191725">
						June 24, 2014 10:44 AM					</a>

				</p>

				<p><cite>@sparkygsx: Encrypting first and adding the checksum afterwards seems quite useless to me, because the attacker CAN calculate the correct checksum for any forged or modified packet anyway</cite></p>
<p>An attacker CAN&#8217;T calculate the correct HMAC checksum for a VALID packet.</p>
<p>CipherText is calculated:</p>
<p>CipherText = iv || aes(key1, iv, message) // || symbol is concatenation<br />
tag = hmac(key2, CipherText)</p>
<p>You should use a different key for the hmac. In practice taking a secure hashing value of your encryption key is good enough.<br />
Of course, there are authenticated modes which do not need an hmac. Take a look on GCM.</p>
<p><a href="http://stackoverflow.com/questions/10279403/confused-how-to-use-aes-and-hmac/10290712#10290712" rel="nofollow ugc">see details here</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2013/02/really_clever_t.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2013/02/really_clever_t.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2013%2F02%2Freally_clever_t.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2013/02/really_clever_t.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='4689' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2013/02/platform_fragme.html" rel="prev">← Platform Fragmentation as a Security Issue</a>		<a href="https://www.schneier.com/blog/archives/2013/02/our_new_regimes.html" rel="next">Our New Regimes of Trust →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
