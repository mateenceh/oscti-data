<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>New NSA Leak Shows MITM Attacks Against Major Internet Services - Schneier on Security</title>
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Feed" href="https://www.schneier.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; Comments Feed" href="https://www.schneier.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Schneier on Security &raquo; New NSA Leak Shows MITM Attacks Against Major Internet Services Comments Feed" href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.7/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='schneier-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/style.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='schneier-main-css'  href='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/dist/css/style.css?ver=1.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/9.5.2/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1' id='jquery-js'></script>
<link rel="https://api.w.org/" href="https://www.schneier.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.schneier.com/wp-json/wp/v2/posts/5008" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.schneier.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.schneier.com/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html" />
<link rel='shortlink' href='https://www.schneier.com/?p=5008' />
<link rel="alternate" type="application/json+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2013%2F09%2Fnew_nsa_leak_sh.html" />
<link rel="alternate" type="text/xml+oembed" href="https://www.schneier.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2013%2F09%2Fnew_nsa_leak_sh.html&#038;format=xml" />
	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://149400697.v2.pressablecdn.com/wp-content/uploads/2020/06/cropped-favicon-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#schneier_promotion-2 img {
    max-width: 180px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-5008 single-format-standard theme-schneier woocommerce-no-js">

	<div id="wrapper">
		<div id="main">

			<header>
				<div id="header">
					<h1>
						<a href="https://www.schneier.com/" rel="home">
							Schneier on Security						</a>
					</h1>
				</div>
			</header>

			<nav>
				<div class="nav" id="header-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu" class="menu"><li id="menu-item-50175" class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li id="menu-item-50916" class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li id="menu-item-50166" class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li id="menu-item-50169" class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li id="menu-item-50170" class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li id="menu-item-50171" class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li id="menu-item-50167" class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li id="menu-item-50174" class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>

			
<aside>
	<div class="sidebar" id="sidebar-one">
		<section><div class="sidesection widget widget_schneier_search" id="schneier_search-3"><h3>Search</h3>
<p class="small">
	<em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>

<form method="get" action="https://duckduckgo.com/">

	<input type="hidden" name="kh" value="1" /><!-- use https -->

	<input id="search" name="q" size="15" maxlength="255" />

	<input type="submit" value="Go" /><br>

	<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" />
	<label for="searchblog">Blog</label>

	<input type="radio" name="sites" id="searchessays" value="www.schneier.com/essays" />
	<label for="searchessays">Essays</label>

	<input type="radio" name="sites" id="searchall" value="www.schneier.com" checked="" />
	<label for="searchall">Whole site</label>

</form>
</div></section><section><div class="sidesection widget widget_schneier_social" id="schneier_social-2"><h3>Subscribe</h3>
<div id="subscription-buttons">

	<a href="https://www.schneier.com/feed/atom"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png" alt="Atom Feed" /></a><a href="https://www.facebook.com/bruce.schneier"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png" alt="Facebook" /></a><a href="https://twitter.com/schneierblog/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png" alt="Twitter" /></a><a href="https://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/kindle-32px.png" alt="Kindle" /></a><a href="https://www.schneier.com/crypto-gram"><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png" alt="E-Mail Newsletter (Crypto-Gram)" /></a>
</div>
</div></section>	</div>
</aside>

			<div id="content">

				
		<p id="breadcrumbs">

			<a href="https://www.schneier.com">Home</a><a href="https://www.schneier.com/blog/archives/">Blog</a>		</p>

		
<article id="post-5008" class="post-5008 post type-post status-publish format-standard hentry category-uncategorized tag-brazil tag-certificates tag-data-breaches tag-e-mail tag-edward-snowden tag-google tag-lies tag-man-in-the-middle-attacks tag-national-security-policy tag-nsa tag-privacy tag-surveillance tag-tor">

	<div class="article">

		<h2 class="entry">New NSA Leak Shows MITM Attacks Against Major Internet Services</h2>
		<p>The Brazilian television show &#8220;Fantastico&#8221; <a href="http://g1.globo.com/fantastico/noticia/2013/09/nsa-documents-show-united-states-spied-brazilian-oil-giant.html">exposed</a> an NSA training presentation that discusses how the agency runs man-in-the-middle attacks on the Internet. The point of the story was that the NSA engages in <a href="http://www.techdirt.com/articles/20130909/04383424450/latest-leak-shows-nsa-engaging-economic-espionage-not-fighting-terrorism.shtml">economic</a> <a href="http://www.theguardian.com/world/2013/sep/09/nsa-spying-brazil-oil-petrobras">espionage</a> against Petrobras, the Brazilian giant oil company, but I&#8217;m more interested in the tactical details.</p>
<p>The <a href="http://g1.globo.com/fantastico/noticia/2013/09/nsa-documents-show-united-states-spied-brazilian-oil-giant.html">video on the webpage</a> is long, and includes what I assume is a dramatization of an NSA classroom, but a few screen shots are important.  The pages from the training presentation <a href="http://www.slate.com/s/future_tense/2013/09/09/shifting_shadow_stormbrew_flying_pig_new_snowden_documents_show_nsa_deemed.html">describe</a> how the NSA&#8217;s MITM attack works:</p>
<blockquote><p>However, in some cases GCHQ and the NSA appear to have taken a more aggressive and controversial route &#8212; on at least one occasion bypassing the need to approach Google directly by performing a man-in-the-middle attack to impersonate Google security certificates. <a href="http://www.scribd.com/doc/166819124">One document</a> published by <i>Fantastico</i>, apparently taken from an NSA presentation that also contains some GCHQ slides, describes “how the attack was done” to apparently snoop on SSL traffic. The document illustrates with a diagram how one of the agencies appears to have hacked into a target’s Internet router and covertly redirected targeted Google traffic using a fake security certificate so it could intercept the information in unencrypted format.</p>
<p><a href="http://www.scribd.com/doc/166822246">Documents</a> from GCHQ’s &#8220;network exploitation&#8221; unit show that it operates a program called &#8220;FLYING PIG&#8221; that was started up in response to an increasing use of SSL encryption by email providers like Yahoo, Google, and Hotmail. The FLYING PIG system appears to allow it to identify information related to use of the anonymity browser Tor (it has the option to query &#8220;<a href="http://www.scribd.com/doc/166821334">Tor events</a>&#8220;) and also allows spies to collect information about specific SSL encryption certificates.</p></blockquote>
<p>It&#8217;s that first link &#8212; also <a href="https://www.documentcloud.org/documents/785152-166819124-mitm-google.html">here</a> &#8212; that shows the MITM attack against Google and its users.</p>
<p>Another <a href="http://imgur.com/a/g3UGP#1">screenshot</a> implies is that the 2011 DigiNotar <a href="http://www.informationweek.com/security/attacks/stolen-digital-certificates-compromised/231600810">hack</a> was either the work of the NSA, or exploited by the NSA.</p>
<p>Here&#8217;s another <a href="http://www.motherjones.com/politics/2013/09/flying-pig-nsa-impersonates-google">story</a> on this.</p>

		
			<p class="entry-tags">
				<span class="tags-links">Tags: <a href="https://www.schneier.com/tag/brazil/" rel="tag">Brazil</a>, <a href="https://www.schneier.com/tag/certificates/" rel="tag">certificates</a>, <a href="https://www.schneier.com/tag/data-breaches/" rel="tag">data breaches</a>, <a href="https://www.schneier.com/tag/e-mail/" rel="tag">e-mail</a>, <a href="https://www.schneier.com/tag/edward-snowden/" rel="tag">Edward Snowden</a>, <a href="https://www.schneier.com/tag/google/" rel="tag">Google</a>, <a href="https://www.schneier.com/tag/lies/" rel="tag">lies</a>, <a href="https://www.schneier.com/tag/man-in-the-middle-attacks/" rel="tag">man-in-the-middle attacks</a>, <a href="https://www.schneier.com/tag/national-security-policy/" rel="tag">national security policy</a>, <a href="https://www.schneier.com/tag/nsa/" rel="tag">NSA</a>, <a href="https://www.schneier.com/tag/privacy/" rel="tag">privacy</a>, <a href="https://www.schneier.com/tag/surveillance/" rel="tag">surveillance</a>, <a href="https://www.schneier.com/tag/tor/" rel="tag">Tor</a></span>			</p>

		
		
		<p class="posted">
			<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html" rel="bookmark">Posted on September 13, 2013 at 6:23 AM</a>			•
			<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html#comments">141 Comments</a>		</p>

		<aside><div class="schneier-share share" data-uri="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html" data-title="New NSA Leak Shows MITM Attacks Against Major Internet Services" data-order="facebook twitter tumblr" data-social-share-privacy="true" /></aside>
	</div>

</article>


	<h3 id="comments">Comments</h3>

	
		<article class="comment even thread-even depth-1" id="comment-204032">

			<div class="comment by-tyrranum-i-liberati ">

				<p class="commentcredit">

					<span class="commenter">Tyrranum i Liberati</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204032">
						September 13, 2013 6:40 AM					</a>

				</p>

				<p>Exactly how <i>does</i> one trust someone we cannot see or meet with a service we rely on for security?</p>
<p>These MITM attacks seem to be the final solution for the NSA and I can&#8217;t see any way around them with their current grip on the interlinks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204033">

			<div class="comment by-z ">

				<p class="commentcredit">

					<span class="commenter">z</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204033">
						September 13, 2013 6:52 AM					</a>

				</p>

				<p>Install the Perspectives browser add-on and then take a look at how many certs have been presented by Google over the last 30 days. There are a LOT of them.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204034">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204034">
						September 13, 2013 6:53 AM					</a>

				</p>

				<p>Bruce,</p>
<p>I composed a similar response earlier but for some reason it didn&#8217;t apply so I will retype.</p>
<p>What are your thoughts on hardware as a potential vector to facilitate eavesdropping? Example in point the SSL accelerator cards that many servers are using and the TPM modules that are making their way onto consumer motherboards.</p>
<p>I was made to defend my position on incinerating HDDs as a policy against data remanance the other day and I feel somewhat vindicated as we slowly find out about what the NSA has been up to. The customer argued it was wasteful and bad for the environment but I insisted.</p>
<p>Modern HDDs have a microcontroller inside that runs proprietary firmware that we &#8211; the admins &#8211; don&#8217;t get a chance to audit. We also know that there is often additional capacity that is not exposed at a block layer ostensibly for remapping failing sectors but as we have seen sometimes the capacity made available is far different (eg some WD 1TB HDDs a few years back had the same physical parts as their 2TB and only had the firmware changed to simplify manufacturing). How do we know that &#8216;interesting&#8217; content is not retained, even when erased. I can think of several OS and filesystem ways to do this, the clever way being using file carving algo to search for, say DOC or JPEG headers and stash them away. Or if you have lots of space to play with as in the case above you could merely make a delete operation remap. An algorithm could detect repeat overwrites (say by shredding tools) and preserve the mirrored copy. Obviously full disk encryption would defeat this so long as the key is secured off the media.</p>
<p>A more expected threat is SATA secure erase. We&#8217;re told to trust it but how do we know for sure?! This is why we need open hardware and open firmware.</p>
<p>I suspect that the NSA has not broken RSA at least at sensibly large key sizes but that they are &#8216;cheating it&#8217; through bad implementations. That said for those websites not using PFS what would stand in the way of picking a select few targets and putting all their resources into cracking (or stealing through human assets or remote exploits on the target host) just those?</p>
<p>The recent revelations about MITM attacks make sense but aren&#8217;t as elegant as I would expect. I figured they were getting their traffic through a fiber tap and thus were limited to passive attacks but clearly I was wrong.</p>
<p>I think there needs to be a discussion on hardware as we now /know/ some of it has been subverted. Hardware crypto and RNGs are a good place to start. Remember the kerfuffle over RdRAND in Linux kernel?</p>
<p>Keep digging Bruce. Full disclosure is the only cure to this crisis.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204035">

			<div class="comment by-gervase-markham ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.gerv.net/' rel='external nofollow ugc' class='url'>Gervase Markham</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204035">
						September 13, 2013 7:03 AM					</a>

				</p>

				<p>Sorry if I&#8217;m being dumb (although I don&#8217;t understand Portuguese), but the slide demonstrating an MITM doesn&#8217;t mention SSL at all. And the Flying Pig software screenshot seems to show it providing information about SSL connections, which is not the same thing as MITMing them. It&#8217;s called an &#8220;SSL Knowledge Base&#8221;.</p>
<p>Can someone connect the dots for me and show me where the released information shows that the NSA were MITMing <em>SSL</em> connections to Google?</p>
<p>If that slide does show them doing that, and if it&#8217;s a network-level rerouting, then if they want to remain undetected then they must be able to MITM all SSL traffic, regardless of client. That&#8217;s a risky strategy now that Chrome has cert pinning with reporting &#8211; if the target uses Chrome, they will get busted. (Unless they&#8217;ve managed to get a fake cert from the same CA Google uses. I don&#8217;t know whether Google pins to roots, or its own intermediates. Or unless Google has been enjoined to not reveal certain reported cert pinning violations.)</p>
<p>In other browsers it is, of course, technically possible to see the changed cert chain if you look. But perhaps they rely on no-one doing that.</p>
<p>If they were MITMing SSL, then then either the target clicked through warnings (unlikely) or they have subverted a widely trusted CA. (Again, if you want to be able to MITM all SSL traffic, you need a widely-trusted CA to avoid giving errors on some clients.) The $64,000 question is: which one?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204036">

			<div class="comment by-z ">

				<p class="commentcredit">

					<span class="commenter">z</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204036">
						September 13, 2013 7:14 AM					</a>

				</p>

				<p>@Gervase Markham</p>
<p>Law enforcement has had the ability to use their own valid certs signed by real CAs for some time now. I have no doubt that the NSA can as well.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204037">

			<div class="comment by-aaron-w ">

				<p class="commentcredit">

					<span class="commenter">Aaron W</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204037">
						September 13, 2013 7:23 AM					</a>

				</p>

				<p>Google <a href="http://googleonlinesecurity.blogspot.com/2011/11/protecting-data-for-long-term-with.html" rel="nofollow ugc">rolled out forward secrecy to its SSL connections in late 2011</a>. In theory, that made MITM attacks impossible, even if the NSA had a forged certificate, yes? Or just much, much harder?</p>
<p>So did Google roll out forward secrecy when it realized the NSA/GCHQ was using MITM attacks against its users?  Or is this a MITM attack that&#8217;s effective even against forward secrecy? Or is it a MITM attack against plain old HTTP, which would be much less of a concern?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204038">

			<div class="comment by-marian ">

				<p class="commentcredit">

					<span class="commenter">Marian</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204038">
						September 13, 2013 7:34 AM					</a>

				</p>

				<p>@Aaron W</p>
<blockquote><p>
  Google rolled out forward secrecy to its SSL connections in late 2011. In theory, that made MITM attacks impossible, even if the NSA had a forged certificate, yes? Or just much, much harder?
</p></blockquote>
<p>Forward secrecy (achieved in SSL by using DHE and ECDHE suites) makes impossible to recover past (or future) particular sessions when long-term keys are compromised. It does not protect against MITM, which is possible when authentication is not done correctly.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204039">

			<div class="comment by-dns666 ">

				<p class="commentcredit">

					<span class="commenter">DNS666</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204039">
						September 13, 2013 7:36 AM					</a>

				</p>

				<p>@Gervase Markham</p>
<p>What would be the point of executing an <em>active</em> attack (MITM) and risking exposure against non-SSL traffic?! One would just listen in on the unencrypted traffic passively (as NSA et al. are now known to do extensively), no MITM shenanigans necessary.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204040">

			<div class="comment by-nicholas-weaver ">

				<p class="commentcredit">

					<span class="commenter">Nicholas Weaver</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204040">
						September 13, 2013 7:37 AM					</a>

				</p>

				<p>The journalists need to start searching for DigiNotar in their document set in more details.  It would explain alot about the DigiNotar hack if either the NSA was involved or the NSA stole the fake certs from whoever did it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204041">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204041">
						September 13, 2013 7:48 AM					</a>

				</p>

				<p>I would also imagine they would need a diverse allocation of IP space (and preferably use tunnels to different locations rather than have all the routes go to one AS and make it look dodgy if scrutinized) as having a few blocks repeatedly connect to a target&#8217;s web servers would look very strange indeed. Of course they could be using this attack in a very targeted way and not routing everyone through it which would be a lot more subtle.</p>
<p>The commenter who spoke of the Perspectives project makes an interesting point. The notary servers on perspectives may contain the smoking gun(s)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204042">

			<div class="comment by-tor ">

				<p class="commentcredit">

					<span class="commenter">tor</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204042">
						September 13, 2013 7:49 AM					</a>

				</p>

				<p>Quick Ant QFD Tor events. I assume qfd doesn&#8217;t mean what it does in the civillian world. Maybe that is their Tor exit node tracker, or possibly servers they deploy with one click to run a tor MITM attack when victims try to download Tor Browser Bundle, they get the NSA version instead</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204043">

			<div class="comment by-nicholas-weaver ">

				<p class="commentcredit">

					<span class="commenter">Nicholas Weaver</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204043">
						September 13, 2013 7:53 AM					</a>

				</p>

				<p>Some background for those unfamiliar:</p>
<p>Non-encrypted traffic doesn&#8217;t need MITM to capture, so the MITM diagram only applies to SSL.</p>
<p>The DigiNotar hack was discovered when the Google certificate was used to MITM all traffic going to Google from Iran (it tripped the newly installed Chrome certificate pinning IIRC).</p>
<p>The fake certificates from DigiNotar match the NSA&#8217;s interest list, including Google, the Tor Project, WordPress, and others.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204044">

			<div class="comment by-nicholas-weaver ">

				<p class="commentcredit">

					<span class="commenter">Nicholas Weaver</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204044">
						September 13, 2013 7:55 AM					</a>

				</p>

				<p>A MITM attack doesn&#8217;t have to change the IPs seen by the server.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204045">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204045">
						September 13, 2013 8:06 AM					</a>

				</p>

				<p>Nicholas: no, I mean detected by server logs.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204046">

			<div class="comment by-jenny-juno ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://addons.mozilla.org/en-us/firefox/addon/certificate-patrol/' rel='external nofollow ugc' class='url'>Jenny Juno</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204046">
						September 13, 2013 8:09 AM					</a>

				</p>

				<p>&#8220;take a look at how many certs have been presented by Google over the last 30 days. There are a LOT of them.&#8221;</p>
<p>I use the Cert Patrol add-on for firefox and over the last month it seems like every single time I go to google I get a different certificate for them.  Frequently they are from different authorities.</p>
<p>Has there been a discussion of this anywhere?  I&#8217;d really like to see an informed analysis (versus my own paranoid speculation) of what the hell is going on.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204047">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204047">
						September 13, 2013 8:13 AM					</a>

				</p>

				<p>@tor: it certainly brings the revelations from the tor project of some ideas being decloaked by visiting any sites hosted by Freedom Hosting (which were mostly illegal stuff but also some services like tormail) into a new light. From what I remembered the guy went down for some charges and the FBI or whatever alphabet soup agency involved took over his servers and put a nice bit of Java which made a CONNECT to an IP in Maryland using some shellcode. Obviously this would go through the standard windows TCP stack and bypass tor unless they were running a VM or the routing onto tor was done upstream (say, on an OpenWRT router)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204048">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204048">
						September 13, 2013 8:22 AM					</a>

				</p>

				<p>@Jenny &#8211; prior to their transition to 2048 certs starting Aug 1 all Google certs /should/ have been signed by the Equifax issued Google root cert. This sounds very dodgy.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204049">

			<div class="comment by-wes-the-mod ">

				<p class="commentcredit">

					<span class="commenter">Wes the Mod</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204049">
						September 13, 2013 8:25 AM					</a>

				</p>

				<p>Funny thing about Bresnan up here in Montana, they were doing this for at least 4 years via DNS for Google as well as other sites. Due to their lack of ability to set up a fully functional network in Butte none of this seemed to matter. There were certificate mismatches, the web server would run out of connections on it&#8217;s connection pool&#8230; This whole idea of hijacking traffic via routing seems a bit excessive when you can proxy the traffic and only a few people notice.</p>
<p>Needless to say the solution in this case was just to change your DNS servers to public ones. For a more global solution there are always the root hint servers at which point you only have to get the cooperation of one group of people.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204050">

			<div class="comment by-marcio-lima ">

				<p class="commentcredit">

					<span class="commenter">Marcio Lima</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204050">
						September 13, 2013 8:41 AM					</a>

				</p>

				<p>I am Brazilian and the NSA slide indeed mentions SSL MITM attack. Although it is not clear whether NSA had actually attacked the Petrobras&#8217;s private network or it was just an exercise. It is being a little passionate the discussion here in Brazil. In a previous program, Fatastico showed some NSA documents that implied that the US Government has succeeded to trace the President Dilma Roussef&#8217;s  mobile calls  to her secretaries, ministers and even relatives. The President had talked to Obama in the G20 meeting and maybe she is going to call off a visit to US because yesterday the talks between Susan Rice and Brazil&#8217;s Minister of Foreign Affairs in White House was not considered productive. Many brazilians are outrageous about this matter since this is not an expected  behavior from a nation that has been a long history of fiorendship including fighting together in the two World Wars.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204051">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204051">
						September 13, 2013 8:43 AM					</a>

				</p>

				<p>@Wes &#8211; agreed. I previously worked as Chief NOC engineer for a medium sized ISP. We received warrants for subscriber information so regularly that it made me despair! I remember we were required to support Cisco&#8217;s lawful interception technology at OUR cost by a certain date. As a consequence of all our network equipment being x86 running FreeBSD this caused us some problems. Even our DSL tails were terminated by a few Linux boxes running l2tpns. As a consequence of this any &#8216;targets&#8217; had to specifically be routed through a 7xxx series Cisco which provided them with the proprietary solution they so desired (I am certain LI has been standardized now). In an act of disobedience I setup packetfilter to slightly delay those routed to the capture router so that the net result was an additional 4ms on latency and a change in TTL. I told a few of my more paranoid enterprise customers that we were legally obliged to say nothing but told them to take notice of their ping times. Funnily enough you&#8217;d also see in a traceroute the reverse DNS name was revealing enough 😉</p>
<p>We also stopped transparently caching with squid as when we were doing just that we were required to maintain logs. Note that this took place outside of the US but in one of the countries mentioned in the &#8220;five eyes&#8221; in the late 90s early 2000s.</p>
<p>I often wondered as to why they even bothered with LI as it was common knowledge that our country&#8217;s surveillance organization occupied an entire floor of the data center in which we had colocation. I guess anyone who has been in a largeish data center will know the level of access control is just far too excessive if they were merely protecting customer&#8217;s racks. We were escorted to our floor and couldn&#8217;t even exit the floor via the elevator without picking up the security phone and asking them. I often worried about fire code compliance. The only obvious safety equipment was a &#8216;escape closet&#8217; which they installed on each floor when they transitioned from halon fire suppression to CO2 (asphixiating in a chilled data center isn&#8217;t my idea of a nice place to die).</p>
<p>Anyway my point is this stuff has been going on for years. It needs to stop now.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204052">

			<div class="comment by-bob ">

				<p class="commentcredit">

					<span class="commenter">bob</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204052">
						September 13, 2013 9:11 AM					</a>

				</p>

				<p>It would be nice to be able to grab a server&#8217;s signature via existing secure connections. If I&#8217;ve already visited local government sites, facebook and the bbc when I visit momandpopstore.com I could ask all the sites to verify the connection. Any MITM attack would have to be prolonged but still specific to avoid detection.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204053">

			<div class="comment by-adam ">

				<p class="commentcredit">

					<span class="commenter">Adam</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204053">
						September 13, 2013 9:14 AM					</a>

				</p>

				<p>It would go a long way to defeat this kind of attack if certs could be signed by more than one signatory and not just CAs but business partners, business bureaus, governments etc. to build a web of trust.</p>
<p>And if browsers were far more proactive in validating discrepancies between certs and actively cached them so that it could validate they didn&#8217;t suddenly change for no apparent reason.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204054">

			<div class="comment by-gervase-markham ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.gerv.net/' rel='external nofollow ugc' class='url'>Gervase Markham</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204054">
						September 13, 2013 9:17 AM					</a>

				</p>

				<p>z: citation needed. (If Mozilla discovers any trusted CA has been providing certs for MITM purposes, we will un-trust them.)</p>
<p>Marcio: thanks for the confirmation. I wonder if the NSA still think this sort of attack is safe to run, now that pinning is a reality.</p>
<p>Re: DigiNotar, the NSA would need to have serious control over the Iranian internet infrastructure in order to mount an attack with the pattern that was seen. Watch <a href="http://www.youtube.com/watch?v=wZsWoSxxwVY" rel="nofollow ugc">this video</a>, which geolocates the source IPs of OCSP pings, which are indicative of certificate use. Whoever conducted the Iran attack was able to control the routing of a great deal of Internet traffic from inside Iran, but not outside. (Or they chose not to.) I&#8217;m not saying it&#8217;s impossible, but the Iranian government seem like a much more likely culprit.</p>
<p>That&#8217;s not to say that the NSA couldn&#8217;t have re-stolen the certs from the hacker, or from the Iranians, or have <em>also</em> broken into Diginotar themselves and used the certs they took in much more targetted attacks. (Only a tiny number of the stolen certs were ever detected in the wild.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204055">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204055">
						September 13, 2013 9:23 AM					</a>

				</p>

				<p>Diginotar was the certificate notary of the Dutch government. The hack caused quite a lot of damages in the Netherlands.</p>
<p>If the hack of Diginotar really was perpetrated by our friends from the USA, we (the Dutch) sure do need no enemies anymore.</p>
<p>In other words, the NSA has waged cyber war against their allies.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204056">

			<div class="comment by-stanislav-datskovskiy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.loper-os.org' rel='external nofollow ugc' class='url'>Stanislav Datskovskiy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204056">
						September 13, 2013 9:42 AM					</a>

				</p>

				<p>At this point, if you still trust in the very idea of PKI, or rely on security software you haven&#8217;t personally understood the source code of, <a href="http://www.loper-os.org/?p=1299" rel="nofollow ugc">you&#8217;re a chump.</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204057">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204057">
						September 13, 2013 9:51 AM					</a>

				</p>

				<p>@Marcio &#8211; re cell phones. I imagine any kind of conference where large numbers of people are in a single area could be owned by just running your own BTS and doing a MITM attack that way. GSM was never a protocol that was particularly security oriented. I remember a Black Hat presentation a few years back where a guy whose name I cannot remember showed how he was able to quite accurately geolocate someone by combining HLR data (which should be confined to trusted telcos but is exposed by several companies to query online) with a vulnerability I believe in SS7 which gave relative signal strength on more than one tower allowing rudimentary geolocation. Hell, even HLR data is bad enough. I think the US gov&#8217;t would be crazy not to use that data. It would be easy to target too &#8211; sniff traffic while people are in the airport and you have a list of IMSI&#8217;s to query in 24 hours or so when you know they&#8217;ll be at their destination. Keep watching and you will easily detect if you have been into any geographical area they deem interesting enough to screen you when you return.</p>
<p>@Gervase &#8211; I think the fundamental problem is with the centralized trust we put in the CAs. Clearly given all of the stuff ups (ignoring the NSA scandal) indicates this trust is misplaced. A PGP like trust model would be more cumbersome but more resilient. When DNSSEC becomes a widespread reality (and if we can trust the roots, which is another post in itself) perhaps the fingerprint can be put in a TXT record. That at least increases the number of organizations they need to subvert.</p>
<p>@Bob &#8211; even if browser&#8217;s were to implement an openssh style known_hosts style fingerprint cache at least we would get a warning when a cert changes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204058">

			<div class="comment by-matthijsk ">

				<p class="commentcredit">

					<span class="commenter"><a href='https://cyberwar.nl/' rel='external nofollow ugc' class='url'>MatthijsK</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204058">
						September 13, 2013 9:54 AM					</a>

				</p>

				<p>About Schneier&#8217;s suggestion regarding DigiNotar: I fail to see how the contents of that slide in any way warrant the claim that it implies that the NSA was involved in, or exploited the consequence of, the compromise of DigiNotar. The screenshots show a <em>mention</em> of DigiNotar in a slide that . Am I missing something?</p>
<p>(Note: I am not claiming that NSA was NOT involved in, or exploited the consequence of, the compromise of DigiNotar.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204059">

			<div class="comment by-winter ">

				<p class="commentcredit">

					<span class="commenter">Winter</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204059">
						September 13, 2013 10:09 AM					</a>

				</p>

				<p>&#8220;I use the Cert Patrol add-on for firefox and over the last month it seems like every single time I go to google I get a different certificate for them. Frequently they are from different authorities&#8221;</p>
<p>I get the same from the Netherlands. It has been this way for years. But only for Google.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204060">

			<div class="comment by-sami-lehtinen ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.sami-lehtinen.net/' rel='external nofollow ugc' class='url'>Sami Lehtinen</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204060">
						September 13, 2013 10:19 AM					</a>

				</p>

				<p>Ahem, Yahoo nor Hotmail / Outlook does encrypt email, those use plain SMTP without STARTSSL. To protect email properly you need to use STARTSSL, with authenticated certificate fingerprint.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204061">

			<div class="comment by-jacob ">

				<p class="commentcredit">

					<span class="commenter">Jacob</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204061">
						September 13, 2013 10:52 AM					</a>

				</p>

				<p>Re DigiNotar<br />
I seriously doubt that this was a NSA work. At the time of the breach, there was an active &#8220;discussion&#8221; by the hacker who claimed to did it (can&#8217;t recall the site). He identified himself as a self-taught hacker expert from Iran, boasting that he could do wonders in penetrating servers, and that he decided as a nationalist Iranian to help the Iranian gov in its fight against internal political subversion by letting them use fake certs as MITM against the &#8220;enemies of the state&#8221;. He also vaguely explained how he hacked DigiNotar.<br />
From the language, the content, the psyche, it was not NSA.</p>
<p>Re Pespectives add-on to Firefox:<br />
How fool-proof is this? this add-on lets you see if your browser see a different cert from what other clients (about 10), running on a known list of geo-distributed servers, see.<br />
If Eve targets you and presents you with a fake cert, what will stop her from also feeding you fake acknowledgements from those geo-distributed clients?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204062">

			<div class="comment by-douglas-knight ">

				<p class="commentcredit">

					<span class="commenter">Douglas Knight</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204062">
						September 13, 2013 11:00 AM					</a>

				</p>

				<p>Is there a centralized repository of leaked slides?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204063">

			<div class="comment by-jeffh ">

				<p class="commentcredit">

					<span class="commenter">JeffH</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204063">
						September 13, 2013 11:10 AM					</a>

				</p>

				<p>@Stanislav Datskovskiy &#8220;At this point, if you still &#8230; rely on security software you haven&#8217;t personally understood the source code of, you&#8217;re a chump.&#8221;</p>
<p>This sort of crazy talk is why Stallman is considered a fringe nut despite his message being a sensible one. If you can&#8217;t come up with sensible suggestions on how to fix problems, there&#8217;s little value associated with the underlying message.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204064">

			<div class="comment by-merp ">

				<p class="commentcredit">

					<span class="commenter">merp</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204064">
						September 13, 2013 11:16 AM					</a>

				</p>

				<p>Understanding the source is pointless unless you build it yourself, since there&#8217;s no guarantee the source for the binary you downloaded wasn&#8217;t backdoored. Now we have to do deterministic building to make sure even the compiler isn&#8217;t adding hidden backdoors or malware since the NSA could be intercepting your repository traffic if you are a security software engineer and they want access to your encrypted VoIP app or tor browser</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204065">

			<div class="comment by-stanislav-datskovskiy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.loper-os.org' rel='external nofollow ugc' class='url'>Stanislav Datskovskiy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204065">
						September 13, 2013 11:25 AM					</a>

				</p>

				<p>JeffH: &#8216;don&#8217;t shoot the messenger.&#8217; Stallman, old dervish though he may be, turned out to be <a href="http://www.gnu.org/philosophy/can-you-trust.html" rel="nofollow ugc">right</a> about virtually everything.</p>
<p>And it is perfectly feasible to rely on properly-implemented security software that you understood (or wrote) yourself. A one-time pad engine can be a 20 line Perl script (assuming you have access to a good TRNG.) Granted, you&#8217;re stuck using this strictly between your own systems, and it isn&#8217;t as convenient as public-key. Such is life. Life never was easy for people who want genuine security, rather than a placebo like SSL.</p>
<p>Don&#8217;t hate the &#8216;conspiracy nuts&#8217; who tell you that mainstream crypto was doctored, just because there is no easy answer to the problem. We&#8217;ve been saying it for years, and nobody listened.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204066">

			<div class="comment by-nick-semenkovich ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://nick.semenkovich.com' rel='external nofollow ugc' class='url'>Nick Semenkovich</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204066">
						September 13, 2013 11:27 AM					</a>

				</p>

				<p>FWIW, some prominent members of Google&#8217;s security/Chrome teams just blacklisted a <b>Verisign</b> intermediate (&#8220;VeriSignClass3SSPIntermediateCA&#8221;) — perhaps suggesting it was enabling MITMs for Google properties.</p>
<p>See the HSTS commit: <a href="https://chromiumcodereview.appspot.com/23523051" rel="nofollow ugc">https://chromiumcodereview.appspot.com/23523051</a></p>
<p>Note that the associated bug is private: <a href="https://code.google.com/p/chromium/issues/detail?id=173460" rel="nofollow ugc">https://code.google.com/p/chromium/issues/detail?id=173460</a></p>
<p>There&#8217;s a good explanation of the &#8220;bad_static_spki_hashes&#8221; parameter here: <a href="http://ritter.vg/blog-cas_and_pinning.html" rel="nofollow ugc">http://ritter.vg/blog-cas_and_pinning.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204067">

			<div class="comment by-pete-s ">

				<p class="commentcredit">

					<span class="commenter">Pete S.</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204067">
						September 13, 2013 12:09 PM					</a>

				</p>

				<p>@Jenny: According to <a href="http://googleonlinesecurity.blogspot.com/2013/05/changes-to-our-ssl-certificates.html" rel="nofollow ugc">http://googleonlinesecurity.blogspot.com/2013/05/changes-to-our-ssl-certificates.html</a> Google started transitioning to an all-2048-bit certificate chain (i.e. 2048-bit root, intermediate, and server certificates) at the beginning of August. During this process, they changed CAs (from Equifax to GeoTrust) and they state that they may change CAs at any point in the future without warning.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204068">

			<div class="comment by-chart ">

				<p class="commentcredit">

					<span class="commenter">Chart</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204068">
						September 13, 2013 12:28 PM					</a>

				</p>

				<p>Equifax and Geotrust are the same CA (Equifax root was bought by Geotrust, which was then bought by Verisign, and is now part of Symantec).</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204069">

			<div class="comment by-brian-m ">

				<p class="commentcredit">

					<span class="commenter">Brian M</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204069">
						September 13, 2013 12:42 PM					</a>

				</p>

				<p>@Mike the goat:</p>
<p>When was the last time you audited any driver code?  As a system administrator, not as a developer.  I have been working with that hardware since the controllers were separate MFM and RLL controller cards.  Give some thought to what you just wrote.  The drive isn&#8217;t going to be &#8220;squirreling away&#8221; any data, because the drive can&#8217;t tell the difference between data.  All sectors get overwritten, some more than others.  Any drive with a swap partition would go absolutely nuts trying to hoard data.  The reason that &#8220;shredding tools&#8221; do the multiple overwrites to erase data is so that the residual magnetic signature from the previous data on the disk is erased.  Detecting that residual magnetic signature is not something that normal drive electronics can do.  It has to be done with specialized equipment.  The normal drive electronics and controller code is not going to go back and and say, &#8220;Oh, this must be valuable because it&#8217;s being scrubbed, so I&#8217;ll copy it off for the NSA to review.&#8221;  One overwrite is enough to erase it so the OEM electronics won&#8217;t detect it.</p>
<p>The only way to tell if a drive&#8217;s built-in erasure is effective is to hook up rather specialized equipment to view the read head&#8217;s signals.  Yes, you can buy that equipment from Tektronix or HP, and it costs more than a new car.  I have worked with that stuff in an OEM hardware lab.</p>
<p>The real question is, who wants that customer&#8217;s data?  Is it a national agency, or not?  If it&#8217;s not the NSA, CIA, etc., then a normal erasure is fine.  Somebody dumpster diving is not going to go through those lengths to pull data off the drive.</p>
<p>As for eavesdropping on computers: The data has to <b>go</b> somewhere.  If there is no data traveling back out of your computer to someplace you don&#8217;t know, then there&#8217;s nothing to worry about.  It&#8217;s easier to eavesdrop on a monitor than a computer.  The SSL and TPM hardware isn&#8217;t a threat vector.  A rootkit is a threat vector, and it&#8217;s easier to drop a rootkit on a box than bother with the hardware manufacturers.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204070">

			<div class="comment by-cryptoki ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.twitter.com/cryptoki' rel='external nofollow ugc' class='url'>Cryptoki</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204070">
						September 13, 2013 12:51 PM					</a>

				</p>

				<p>The Diginotar hint is significant and should not be bandied about without more substance.  Diginotar provided outsourced PKI to the Dutch Government.  So the US attacks allies now?  This was an outright criminal attack &#8211; not just exploiting a vuln or enabling a backdoor.  And it is alleged that the same Ichsunx attacker was involved in hack attempts against Comodo and StartSSL.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204071">

			<div class="comment by-stanislav-datskovskiy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.loper-os.org' rel='external nofollow ugc' class='url'>Stanislav Datskovskiy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204071">
						September 13, 2013 1:09 PM					</a>

				</p>

				<p>Brian M: subverted HDD firmware could do quite a few interesting things. Say, return a diddled boot sector &#8211; or OS loader &#8211; once in a while (exactly once after power-up, naturally.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204072">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204072">
						September 13, 2013 1:10 PM					</a>

				</p>

				<p>@Brian &#8211; I don&#8217;t claim that this would be even viable but was more just thinking aloud as to what threat vectors could be lurking in our hardware. If the microcontroller was smart enough it could conceivably use file carving heuristics to  target a particular file format that was deemed to be interesting. I don&#8217;t think the drive would actually do this but conceivably it could. Why they would do this? I don&#8217;t know.</p>
<p>I was more or less brainstorming on the revelation that the NSA modified consumer <em>hardware</em> and what one could conceivably do. I think subverting a hardware RNG would be the cheekiest way of weakening any crypto.</p>
<p>Of course we know that Linux, for example only uses RDRAND as one source of entropy and /dev/random isn&#8217;t directly sourced from RDRAND (although there was heated discussion about doing just this to get higher throughout).</p>
<p>As for me, I am just a sysadmin and occasional dev and I am not a crypto geek.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204073">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204073">
						September 13, 2013 1:32 PM					</a>

				</p>

				<p>Stanislav: l like that idea. Perhaps if it was ntfs aware it could serve up a modified rpcnet.exe on first read (eg during boot) that had the rootkit inside and then loaded the real rpcnet just like Dell&#8217;s laptop BIOS does with computrace.</p>
<p>Your mention of a 20 line one time pad in Perl reminded me of people who used to get that RSA implementation in Perl tattoed on them so they could make a statement about the then US crypto law. I think about five years later they were doing it with deCSS. Always going to be something, eh?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204074">

			<div class="comment by-stanislav-datskovskiy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.loper-os.org' rel='external nofollow ugc' class='url'>Stanislav Datskovskiy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204074">
						September 13, 2013 1:38 PM					</a>

				</p>

				<p>Mike the goat: the nearly-universal disdain for the OTP (including our gracious host&#8217;s) puzzles me. There are situations where it fits, and it is bulletproof &#8220;when used as prescribed.&#8221; IMHO, if you <i>can</i> use it, you <i>should</i>. Let the snoops choke on gigs of entropic garbage.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204075">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204075">
						September 13, 2013 1:51 PM					</a>

				</p>

				<p>Stanislav: agreed. You hear many say &#8220;don&#8217;t use asymmetric key exchange&#8221; but fact is &#8211; if you are going to meet physically to share your key then you may as well share a BDROM full of pads and have 22 GB of perfectly secure communication. That&#8217;s a lot of text!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204076">

			<div class="comment by-simon ">

				<p class="commentcredit">

					<span class="commenter">Simon</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204076">
						September 13, 2013 1:56 PM					</a>

				</p>

				<p>Encrypting random data does not make it more &#8220;random.&#8221; That&#8217;s crazy &#8211; why do people keep saying stuff like this?<br />
In fact, if you used AES256 (or any other cipher) to encrypt a large file of noise and even used noise to create a strong key and the IV, the entropy of the ciphertext would fall because structure was introduced into it. How in the world can it NOT?<br />
You should use large amounts of data to measure it properly. There are a lot of different tests you can run on it, but the result is the same. Every last comment about attacking block ciphers mentions only attacks against keys, not the cipher text itself. That&#8217;s because it seems easier.<br />
Here is one way to create all the noise you will need <a href="http://www.fourmilab.ch/hotbits/hardware3.html" rel="nofollow ugc">http://www.fourmilab.ch/hotbits/hardware3.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204077">

			<div class="comment by-nameless ">

				<p class="commentcredit">

					<span class="commenter">nameless</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204077">
						September 13, 2013 1:57 PM					</a>

				</p>

				<p>@Douglas Knight</p>
<p>It looks like they are not at Wikileaks as of yet (unless maybe I ended up on some NSA-approved version of Wikileaks).</p>
<p>BTW Wikileaks has an <a href="http://wikileaks.org/Op-ed-Google-and-the-NSA-Who-s.html" rel="nofollow ugc">interesting article about Google connections in Washington</a>:</p>
<p>Looking at how NSA operates they probably have people in the Anonymous as well.</p>
<p>@Jacob</p>
<blockquote><p>
From the language, the content, the psyche, it was not NSA.
</p></blockquote>
<p>Sorry for laughing but if I worked for NSA and we got that sort of a reaction from a reader because of something my semantic analysis specialist colleagues had put together, we would have considered the mission a success. You can not be certain that your conclusion is correct <b><i>even if</i></b> that &#8220;Iranian self-taught hacker&#8221; had been your personal friend. He may still have worked for NSA.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204078">

			<div class="comment by-simpson ">

				<p class="commentcredit">

					<span class="commenter">simpson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204078">
						September 13, 2013 2:51 PM					</a>

				</p>

				<p>By now you heard about the ADE 651</p>
<p>See <a href="http://www.theguardian.com/world/2013/aug/20/government-fake-bomb-detectors-bolton" rel="nofollow ugc">http://www.theguardian.com/world/2013/aug/20/government-fake-bomb-detectors-bolton</a></p>
<p>Also see <a href="http://en.wikipedia.org/wiki/ADE_651" rel="nofollow ugc">http://en.wikipedia.org/wiki/ADE_651</a></p>
<p>Study this carefully because it says a LOT about security. How can so many people think that open-source is categorically safer JUST BECAUSE it&#8217;s open? That&#8217;s because they think the other guy is looking at it, surely all those people can&#8217;t be wrong?</p>
<p>And why do you keep saying don&#8217;t worry about breaks, 2048-bit SSL is fine. And you can always just increase the key length. Aaronson said it&#8217;s so simple, just increase the key length by 10. So, this is probably a good time to start thinking about coming back to reality. Besides the implementation and SW development nightmare, and all the nonsense people are spewing about OpenSSL&#8230;</p>
<p>DON&#8217;T FORGET that if you exchange private keys and your stuff gets stored away somewhere, a few years from now it won&#8217;t matter how long you made the keys. Let&#8217;s tell people then, to just go back and increase the key length used in all the stuff that has been archived.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204079">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204079">
						September 13, 2013 2:58 PM					</a>

				</p>

				<p>@ Brian and mike the goat</p>
<p>Re attack via hard drive firmware</p>
<p>You&#8217;re getting warm. Remember, &#8220;subversion is the attackers tool of choice.&#8221; (Schell) You are focusing on what they can embed in the hard disk itself. Remember that they have pervasively compromised protocols and systems as support for their activities. Let&#8217;s call it &#8220;offence in depth.&#8221; 😉</p>
<p>So, they like subversion and we want to know what a HD&#8217;s onboard software can do. Combine them, then the better attack methodology is programming the HD to use its DMA, drivers or other trusted access to subvert the <em>system</em>. This might be as simple as inserting a tiny trap door and modifying the networking stack to pass TCP requests through it. Upon a tiny unique trigger (maybe in TCP fields), it puts payload from that source into memory w/ kernel or admin privileges. Attacker goes from there.</p>
<p>The attack code needed to do this on the HD itself would be totally unnoticeable in normal operation. The key enablers such as DMA are also normal. It would be a tiny piece of code, optionally inserted on a tiny subset of PC&#8217;s (precedent: stuxnet), that could allow data from an untrusted source to enter the system and assume privileged status. It would be a blip on defenders radar they&#8217;d miss entirely. Probably.</p>
<p>Improvement: use a chipset that can covertly receive wireless command that are unique but blend into background a bit. Then you can activate the subversion, have the operative do their work, and remove it. Reduces exposure at system level just like that.</p>
<p>Next improvement: Over-the-air update or command erases the subverting tool from the firmware (and its flash) in certain emergency scenarios.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204080">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204080">
						September 13, 2013 3:12 PM					</a>

				</p>

				<p>Nick: given the market share of Microsoft Windows in the domestic market you could safely make assumptions regarding OS choice. Take the Computrace &#8216;trojan&#8217; on Dell laptop BIOS&#8217;s &#8211; the example I gave before. There would be nothing stopping a rogue BIOS from doing whatever the hell it wanted. Conversely I think a rogue HDD could indirectly do whatever it wanted &#8211; if not via physical direct access (think a FireWire connected disk having direct memory access) then it could certainly inject arbitrary code where it&#8217;s likely to get executed (and the MBR is probably too overt; I would prefer to pick some obscure driver windows always loads on startup. We know that they have keys to digitally sign them 😉</p>
<p>What about microcode on x86? It is encrypted by Intel, completely proprietary and without scrutiny. AMT? etc&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204082">

			<div class="comment by-tim-l ">

				<p class="commentcredit">

					<span class="commenter">Tim L</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204082">
						September 13, 2013 3:26 PM					</a>

				</p>

				<p>@DNS666</p>
<blockquote><p>What would be the point of executing an *active* attack (MITM) and risking exposure against non-SSL traffic?! One would just listen in on the unencrypted traffic passively (as NSA et al. are now known to do extensively), no MITM shenanigans necessary.</p></blockquote>
<p>Surveillance is only half of the control loop.</p>
<p>MITM is required to be able to shape Google search results for psychological subversion purposes.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204083">

			<div class="comment by-z ">

				<p class="commentcredit">

					<span class="commenter">z</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204083">
						September 13, 2013 3:31 PM					</a>

				</p>

				<p>@Gervase Markham</p>
<p>I should have worded my post more cautiously. I don&#8217;t have any hard evidence myself; I&#8217;m going off of a conversation I had with an LEO who said they had  implemented MITM attacks using SSL intercepting hardware to display their own  valid certs signed by legitimate CAs. I trust him and he has no reason to lie about it in this way, but I&#8217;m afraid that&#8217;s all I can offer. It does fit with the pattern of the government coercing companies to do their will, and I certainly would be shocked if the NSA  did not try to get a CA to do this, but again, I have no evidence.</p>
<p>@Jacob</p>
<p>Yes, it is possible for an attacker to feed you fake results, but that would require the attacker to go after you specifically. Mass MITM attacks (like SSL decryption hardware parked in front of Google&#8217;s servers gobbling up everyone&#8217;s SSL traffic) would be detected though, because it would be infeasible to  alter the results of  every single Perspectives user. Even if they did something to the notaries themselves to make them feed the results they want, they have no control over who runs a notary. IIRC anyone can set one up whenever they want and you can delete any notary you decide you don&#8217;t trust from your list.</p>
<p>Moxie Marlinspike based his Convergence tool off of Perspectives. It works similarly, but I couldn&#8217;t get it to work on my browser and have been too lazy to figure out a solution. The main difference is that Convergence caches the results from the first lookup and alerts you when the key your browser sees is different from the cached key for that site. This is faster than  Perspectives, which  checks every time. Perspectives  gives you a nice graph of the key history over time though.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204084">

			<div class="comment by-timothy ">

				<p class="commentcredit">

					<span class="commenter">Timothy</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204084">
						September 13, 2013 3:36 PM					</a>

				</p>

				<p>Bruce, are you not a little scared about getting arrested from all this disclosure? It&#8217;s fascinating to find out the intrusive goings-on of the secret services and I love your analysis of it all, but I&#8217;m rather concerned for your safety.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204085">

			<div class="comment by-nameless ">

				<p class="commentcredit">

					<span class="commenter">nameless</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204085">
						September 13, 2013 3:42 PM					</a>

				</p>

				<p>@Tim L</p>
<blockquote><p>
MITM is required to be able to shape Google search results for psychological subversion purposes.
</p></blockquote>
<p>subversion, yes, and not necessarily only in USA. The previously linked article <a href="http://wikileaks.org/Op-ed-Google-and-the-NSA-Who-s.html" rel="nofollow ugc">Op-ed: Google and the NSA: Who’s holding the ‘shit-bag’ now?</a> says the following:</p>
<blockquote><p>
Documents published last year by WikiLeaks obtained from the US intelligence contractor Stratfor, show that in 2011 Jared Cohen, then (as he is now) Director of Google Ideas, was off running secret missions to the edge of Iran in Azerbaijan. In these internal emails, Fred Burton, Stratfor’s Vice President for Intelligence and a former State Department official, describes Google as follows:</p>
<blockquote><p>
    Google is getting WH [White House] and State Dept support and air cover. In reality they are doing things the CIA cannot do…[Cohen] is going to get himself kidnapped or killed. Might be the best thing to happen to expose Google’s covert role in foaming up-risings, to be blunt. The US Gov’t can then disavow knowledge and Google is left holding the shit-bag.
</p></blockquote>
</blockquote>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204086">

			<div class="comment by-malcolm-digest ">

				<p class="commentcredit">

					<span class="commenter">Malcolm Digest</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204086">
						September 13, 2013 3:45 PM					</a>

				</p>

				<p>Re: hostile hard drives:</p>
<p>By using host based full disk encryption you will prevent the HDD from tampering with your system. Outside of the MBR, nothing that the drive sees will be in the clear. Anything it wants to inject will fail to decrypt or will be mangled by decryption to the point of unusability.</p>
<p>There&#8217;s still a chicken and egg problem of getting enough OS installed to enable FDE, but that seems like a solvable problem.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204087">

			<div class="comment by-andrew ">

				<p class="commentcredit">

					<span class="commenter">Andrew</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204087">
						September 13, 2013 3:45 PM					</a>

				</p>

				<p>A decade ago I warned a company I worked for that enabling SSL for email connections (via Outlook or other dedicated email reader) did not prevent MITM unless the 100+ CAs were culled from our employees&#8217; browsers.  No one listened.  At the time, they were worried about foreign espionage by a friendly ally and assumed this took care of it.  Ten years later, we have a potential example of our own government doing it.</p>
<p>Craig, I told you so.</p>
<p>Ahhh, so, satisfying.</p>
<p>Sorry, folks, I had to do that.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204088">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204088">
						September 13, 2013 3:45 PM					</a>

				</p>

				<p>@nameless &#8211; but Google told us that it won&#8217;t be evil! 🙂</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204089">

			<div class="comment by-stanislav-datskovskiy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.loper-os.org' rel='external nofollow ugc' class='url'>Stanislav Datskovskiy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204089">
						September 13, 2013 3:47 PM					</a>

				</p>

				<p>Malcolm Digest: It&#8217;s a safe bet that TrueCrypt etc. would be the primary target of a diddled HDD firmware. Followed by the normal boot sector.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204090">

			<div class="comment by-leon-s ">

				<p class="commentcredit">

					<span class="commenter">Leon S</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204090">
						September 13, 2013 3:48 PM					</a>

				</p>

				<p>@Brian M</p>
<p>I agree that some aspects of Mike the Goat&#8217;s hypothetical scenario seem less than plausible,  but it would certainly be possible to design a firmware that could save away certain kinds of information without causing a huge amount of thrashing.   Instead of moving information around,  you just maintain a mapping of logical sectors to physical sectors,  and don&#8217;t overwrite data you want to keep around.  How do you think ZFS supports snapshots efficiently?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204091">

			<div class="comment by-peter-bright ">

				<p class="commentcredit">

					<span class="commenter">Peter Bright</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204091">
						September 13, 2013 3:49 PM					</a>

				</p>

				<blockquote><p>Another screenshot implies is that the 2011 DigiNotar hack was either the work of the NSA, or exploited by the NSA.
</p></blockquote>
<p>It really doesn&#8217;t imply that. I think the much more likely explanation (especially given that <em>we know how DigiNotar-originated fraudulent certificates were used</em>) is that it&#8217;s an NSA presentation <em>explaining</em> that attack, or using that attack as a <em>reference</em>.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204092">

			<div class="comment by-dns666 ">

				<p class="commentcredit">

					<span class="commenter">DNS666</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204092">
						September 13, 2013 3:52 PM					</a>

				</p>

				<p>@Tim L</p>
<p>Well, yes. However, as far as I am aware (a) the actual case we&#8217;re discussing here <em>is</em> about surveillance not subversion and (b) so far we have not seen anything pointing to such PSYOPS in the Snowden leaks.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204093">

			<div class="comment by-malcolm-digest ">

				<p class="commentcredit">

					<span class="commenter">Malcolm Digest</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204093">
						September 13, 2013 3:57 PM					</a>

				</p>

				<p>Stanislav Datskovskiy: True. Though to the point of the MBR being the crack that lets a hostile HDD in, you could put your boot blocks on a USB thumb drive, or MicroSD card. That way the hard drive never gets a chance to substitute data. You could source a dozen different USB thumb drives and pick on at random as well as rewrite your boot loader to be equivalent but different enough that it&#8217;s improbable that any micro controller on the USB stick could recognize the code. Alternately you could modify your BIOS to have the decrypting boot block in the BIOS itself.</p>
<p>At some point, though, you have to trust your hardware or else not use it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204094">

			<div class="comment by-leon-s ">

				<p class="commentcredit">

					<span class="commenter">Leon S</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204094">
						September 13, 2013 3:58 PM					</a>

				</p>

				<p>Alternatively,  if you have double number of platters than you need,  it would be possible to copy one platter to another very efficiently.</p>
<p>There&#8217;s probably a hundred and one ways to do surreptitiously store data without affecting the performance characteristics of the drive too badly.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204095">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204095">
						September 13, 2013 4:09 PM					</a>

				</p>

				<p>@ Mike the goat</p>
<p>&#8220;Nick: given the market share of Microsoft Windows in the domestic market you could safely make assumptions regarding OS choice. Take the Computrace &#8216;trojan&#8217; on Dell laptop BIOS&#8217;s &#8211; the example I gave before. There would be nothing stopping a rogue BIOS from doing whatever the hell it wanted. Conversely I think a rogue HDD could indirectly do whatever it wanted &#8211; if not via physical direct access (think a FireWire connected disk having direct memory access) then it could certainly inject arbitrary code where it&#8217;s likely to get executed (and the MBR is probably too overt; I would prefer to pick some obscure driver windows always loads on startup. We know that they have keys to digitally sign them ;-)&#8221;</p>
<p>Yep, you&#8217;re getting it. 😉</p>
<p>@ Malcom Digest</p>
<p>FDE from host is a good idea to protect data at rest and maybe reduce leaks. It <em>doesn&#8217;t</em> protect against subverted hard disks unless the subversion <em>only</em> reads incoming filesystem data. As Mike and I discussed, there are many ways for a HD to hit a system that require more thorough protections. In your scheme, our DMA or driver-based attacks could do an end run around the whole thing. If I didn&#8217;t want to inject code, I&#8217;d just grab the key material from memory via privileged access (eg DMA) and store it with the encrypted files in the hidden disk location. Game over.</p>
<p><b>Dealing with untrustworthy hardware</b></p>
<p>Untrustworthy hardware is a big problem due to the high integration of CPU, memory, and IO devices in COTS systems. They&#8217;re designed to share for efficiency. Sharing often = compromise in security. So, isolations and info flow restrictions must be imposed on each device you don&#8217;t trust. The market isn&#8217;t exactly pouring out such options for us, either.</p>
<p>My solution has always been to fight the integration, going back to plug n play components. Divide security- or performance-critical functions into dedicated physical components. These have isolated local memories, optionally a shared global memory, and a high speed comms bus. The security protections would be spread out between the components, memories and bus, each doing the part they were good at.</p>
<p>We&#8217;ve seen the logical version of this for security. We&#8217;ve also seen the physical version in safety-critical systems, rarely in security critical systems, and in NUMA-style machines like SGI&#8217;s or mainframes for both performance and reliability. I encourage hardware designers to explore opportunities there. It <em>seems</em> like it would be the low hanging fruit for providing basic hardware protection against malicious devices. It seems, anyway.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204096">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204096">
						September 13, 2013 4:13 PM					</a>

				</p>

				<p>@Leon &#8211; yes, that&#8217;s sort of where I was going with the 1TB logical drive with 2GB physical space. If you were doing as you suggested and merely remapping you would have heaps of unallocated space to play with. An ATA_SECURE_ERASE command could go ahead and thrash the disk for a while then add all of the blocks it would have actually erased to a table so when the disk is inspected they appear zeroed. You could even detect common write patterns indicative of software level erasure tools (eg GNU wipe).</p>
<p>@Malcolm &#8211; this wasn&#8217;t put out as a legitimate attack merely a hypothetical concept to point out that without secure hardware we cannot have secure software.</p>
<p>This needs to change. Anyone notice that so many vendors particularly of WiFi chips only give binary blobs for Linux? I know they probably have commercial reasons, NDAs (or maybe the FCC in the case of software defined radios possibly being able to be reprogrammed or retuned) but this isn&#8217;t acceptable.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204097">

			<div class="comment by-nsa-shill ">

				<p class="commentcredit">

					<span class="commenter">NSA Shill</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204097">
						September 13, 2013 4:24 PM					</a>

				</p>

				<p>Bruce Schneier,</p>
<p>Though I strongly disagree with your opinion and your methodology, I do have a lot of respect for the fact you haven&#8217;t deleted comments that disagree with you or question your reasoning.</p>
<p>-NSA Shill</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204098">

			<div class="comment by-gregory-schlomoff ">

				<p class="commentcredit">

					<span class="commenter">Gregory Schlomoff</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204098">
						September 13, 2013 4:40 PM					</a>

				</p>

				<blockquote><p>
  One document [1] published by Fantastico, apparently taken from an NSA presentation [&#8230;]</p>
<p>  Another screenshot [2] implies is that the 2011 DigiNotar hack was either the work of the NSA, or exploited by the NSA.
</p></blockquote>
<p>I doubt that those 2 documents are original slides or screenshots from NSA material. They both are written with the familiar rounded font that Globo uses for all its text [3]</p>
<p>[1] <a href="http://www.scribd.com/doc/166819124" rel="nofollow ugc">http://www.scribd.com/doc/166819124</a></p>
<p>[2] <a href="http://imgur.com/a/g3UGP#1" rel="nofollow ugc">http://imgur.com/a/g3UGP#1</a></p>
<p>[3] <a href="http://www.fonts.com/font/urw/vag-rundschrift?siteId=2c670c80-4121-4446-893f-d7fe9690be92" rel="nofollow ugc">http://www.fonts.com/font/urw/vag-rundschrift?siteId=2c670c80-4121-4446-893f-d7fe9690be92</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204099">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204099">
						September 13, 2013 4:47 PM					</a>

				</p>

				<p>This thread is fantastic! Anyway, moving on&#8230;</p>
<p>@Nick &#8211; I agree with everything you&#8217;ve mentioned. I try and maintain a secure OS. I compile my FreeBSD builds from source after I have verified the hashes published by the project. I don&#8217;t use any precompiled binaries. Assuming I trust the project and I trust the compiler not to do anything underhanded I can have a medium level of assurance that my software hasn&#8217;t been modified by a third party (obviously all bets are off if there is a rogue in the core FreeBSD team ala OpenBSD IPSEC saga, their CVS/SVN/got repo is compromised and nobody notices or somesuch other event).</p>
<p>Even if I somehow audited every single line of code (this would be humanly impossible with FreeBSD but doable with MINIX or an embedded RTOS) I still can not be certain my BIOS, IPMI interface, etc etc are not compromised.</p>
<p>This is the problem with closed hardware and I don&#8217;t think it is going to get any better with TPM, UEFI, Secure Boot etc adding further complexity to the already unnecessarily complicated x86 architecture.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204100">

			<div class="comment by-stanislav-datskovskiy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.loper-os.org' rel='external nofollow ugc' class='url'>Stanislav Datskovskiy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204100">
						September 13, 2013 5:05 PM					</a>

				</p>

				<p>Stallman&#8217;s dream might become a reality: there is, at last, at least the theoretical possibility of a market for <i>clean</i> hardware and software.</p>
<p>But, to be useful, it must be clean not only of &#8216;binary blobs&#8217;, but of all blobs which leave open the possibility of a Ken Thompson attack. That means: free of legacy operating systems, compilers, etc. &#8211; and hardware.</p>
<p>And even this will be a waste of time if the resulting machine has the brain-destroying complexity of &#8216;wintel&#8217; &#8211; where one could easily hide an elephant. I expect that several such &#8216;elephants&#8217; will be found in due course.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204101">

			<div class="comment by-malcom-digest ">

				<p class="commentcredit">

					<span class="commenter">Malcom Digest</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204101">
						September 13, 2013 5:20 PM					</a>

				</p>

				<p>Nick P: DMA shouldn&#8217;t be a worry as modern machines have IOMMU which will prevent a random device from performing arbitrary DMA transfers. If you&#8217;ve got a rogue driver running on the host, then it doesn&#8217;t matter whether your HDD is malicious, you&#8217;re already screwed.</p>
<p>Mike: I&#8217;m sure you&#8217;ve seen this, but it&#8217;s not exactly <a href="http://spritesmods.com/?art=hddhack" rel="nofollow ugc">theoretical.</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204102">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204102">
						September 13, 2013 5:25 PM					</a>

				</p>

				<p>@Malcolm &#8211; wow&#8230; I knew it was theoretically possible but didn&#8217;t think someone had successfully exploited it. Fantastic work.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204104">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204104">
						September 13, 2013 7:38 PM					</a>

				</p>

				<p>Some what Off topic:</p>
<p>The most fun I ever had with system design was when I was tasked with creating a module that would monitor and interfere with the operation of a section of hardware that we had reason to believe contained an intentional backdoor.  Needless to say the hardware that I added needed to be invisible to any adversary including one with full access to the design database.  The purpose of my modification was to make the output of this block appear to fail intermittently, requiring a reset. Through this process we wanted to see the manner by which this block got set and reset and thereby reveal the depth of our adversaries control.  We also added some notification scripts that were triggered whenever our design databases (for this block AND adjacent hardware functional blocks) were accessed, think of this as our very own &#8220;honey pot&#8221; for anyone interested in discovering what was wrong with this block. The whole exercise was very revealing!</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204105">

			<div class="comment by-urban-myth ">

				<p class="commentcredit">

					<span class="commenter">urban myth</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204105">
						September 13, 2013 8:29 PM					</a>

				</p>

				<p>@nameless</p>
<blockquote><p>
Google is getting WH [White House] and State Dept support and air cover. In reality they are doing things the CIA cannot do…[Cohen] is going to get himself kidnapped or killed. <b>Might be the best thing to happen to expose Google’s covert role in foaming up-risings</b>, to be blunt.
</p></blockquote>
<p><b>&#8230;that could perhaps explain why Eric Schmidt, the Google ex-chairman, traveled to North Korea&#8230;</b></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204106">

			<div class="comment by-anonymous-coward ">

				<p class="commentcredit">

					<span class="commenter">Anonymous Coward</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204106">
						September 13, 2013 8:55 PM					</a>

				</p>

				<p>@Nick P</p>
<p>You can weaken/compromise the security of FDE with appropriate exploits, even without DMA. Clive enlightened us about this a week ago:</p>
<p><a href="https://www.schneier.com/blog/archives/2013/08/opsec_details_o.html#c1661951" rel="nofollow ugc">https://www.schneier.com/blog/archives/2013/08/opsec_details_o.html#c1661951</a></p>
<p>It looks like there&#8217;s very good reasons the US Gov&#8217;t (and other security-conscious entities) will de-gauss hard disks on site, and then ship them off for complete destruction (with a trusted chain of custody). The NSA anticipated (and could very well have exploited) the methodology employed in Malcom&#8217;s link, and the malicious possibilities.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204107">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204107">
						September 13, 2013 9:11 PM					</a>

				</p>

				<p>@ Stanislav Datskovskiy, Mike the goat,</p>
<ul><i>&#8230; the nearly-universal disdain for the OTP puzzles me. There are situations where it fits, and it is bulletproof &#8220;when used as prescribed.&#8221; IMHO, if you can use it, you should.</i></ul>
<p>Almost every time I see someone recomend OTPs it turns out they have not used them in anger, and when they do they discover just how much of a problem they are even when used in a calm unpreasurised environment.</p>
<p>As the Russians found OTP use goes horribly wrong due to assumptions about Keying Material (KeyMat) handeling / managment (KeyMan).</p>
<p>Firstly putting big gobs of OTP on a CD/DVD sounds great untill you start thinking about &#8220;end run&#8221; attacks on the &#8220;end points&#8221;. If you don&#8217;t have an &#8220;air gap&#8221; simple malware by any one of thousands of &#8220;zero days&#8221; will slurp your OTP down the nearest comms channel whilst you are dunking a doughnut in a coffee whilst reading / writing the latest message. And please don&#8217;t think an &#8220;air gap&#8221; is going to protect you because to read a message the ciphertext has to cross the air gap some how, and ages ago I worked out how to do this bi-directional trip with malware on the favoured file shifting device the USB thumb drive.</p>
<p>The cardinal rule with OTPs is not as most people think &#8220;only use the keymat once&#8221; it&#8217;s &#8220;destroy the keymat immediatly it&#8217;s been used&#8221;. You can not do this with a CD/DVD so you can not use one. Likewise you can not do it with a flash drive, and ordinary HDs are not sufficiently reliable either, nor for that matter is any magnetic media.</p>
<p>If you don&#8217;t destroy the keymat immediatly after using it then malware will as I&#8217;ve said rob you of it.</p>
<p>The simplest form of OTP is a stream cipher and thus the OTP suffers from nearly all the failings of using a stream cipher which are many (bit fliping, no authentication, etc etc).</p>
<p>One serious issue with stream ciphers and thus OTP&#8217;s is &#8220;run length&#8221;, that is you can not have a run of more than around 30bits of all zeros, ones or any other repeating pattern or the plaintext statistics will show through. This is esspecialy worrysm where you have known format plaintext at the begining or end of a message.</p>
<p>Then there is the question of just how long it&#8217;s going to take to generate all that Truely Random Keymat.</p>
<p>Whilst you can buy or build a TRNG you realy realy have to know what you are doing.</p>
<p>Further up this blog is a link of to a design using a GM tube and radiation source.</p>
<p>I&#8217;ve designed and built TRNGs using GM tubes and they and their associated electronics are very susceptable to interferance from the surrounding circuitry or any stray EM fields that happen to cross the TRNG analog electronics.</p>
<p>I don&#8217;t have the link handy but two members of the UK&#8217;s Cambridge Labs took a quite expensive 32bit TRNG designed and built by an internationaly reputable firm and subjected it to an unmodulated microwave EM field. The output range of the generator dropped from 32bits to a little over seven bits. If they had used a modulated carrier the chances are they could sync the TRNG to the modulation applied to the EM carrier. Back in the 1980&#8217;s I was doing similar but not to TRNGs but digital wallets and hand held gambling devices&#8230;</p>
<p>If you feel the need to use an OTP I would suggest you write it out on paper and use each line to do a key transfere protocol of some form to be used with a high grade block cipher.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204108">

			<div class="comment by-wesley-parish ">

				<p class="commentcredit">

					<span class="commenter">Wesley Parish</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204108">
						September 13, 2013 9:54 PM					</a>

				</p>

				<p>@Stanislav Datskovskiy</p>
<p>Something RISCky? There&#8217;s a ton of <a href="http://opencores.org/" rel="nofollow ugc">Verilog and VHDL code out there</a>. But as I&#8217;ve said previously, you&#8217;d need to check the postprocessing &#8211; the postprocessor is usually closed-source.</p>
<p>It wouldn&#8217;t be impossible to design a chip fabrication machine, just difficult; the actual circuit layout is essentially toolpath work, and that is hardly a secret, being the basis for CAM software. Not expressible in G-code, naturally, because G-code&#8217;s a machining language, but the essence is the same.</p>
<p>The question of whether or not any such open source chip fabrication machine would ever get built&#8217;s another matter, and depends very much on great ape politics.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204109">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204109">
						September 14, 2013 12:20 AM					</a>

				</p>

				<p>@Clive &#8211; I agree with you partially. Some of the disadvantages you discuss would be just as applicable to a symmetric block cipher, e.g. if they have physical access (black bag cryptanalysts) then they could conceivably use forensic techniques to obtain the cleartext from your HDD (many people write the cleartext file to the HDD, gpg it, then software erase the original &#8211; if we are talking nation state capabilities recovery may be conceivable) or they could go after your secret key directly. Of course PGP tries to prevent this with a keychain passphrase but there is no reason why you can&#8217;t implement this with your OTP media (e.g. symmetrically encrypt your padbooks, preferably a &#8216;chunk&#8217; individually and keep the key to each chunk on flash paper). Sure, /if/ they get physical access you are no more secure than you would be using a block cipher directly but if they have physical access to your residence then chances are it is game over anyway and they will coerce the data out of you directly.</p>
<p>Re a DVD being unerasable &#8211; perhaps you could use a DVDRW or BDRE and somehow disable wear levelling when packet writing so you can selectively overwrite those sections. Even easier would be to use &#8216;tracks&#8217; and simply use the burner&#8217;s erase function on that track, then write random over it (just in case we don&#8217;t trust the burner), then erase. You could probably visually verify erasure if the tracks are big enough, at least for say CDRW media.</p>
<p>On another note, does anyone here use OPIE for authentication on their Unix machines? I used it on FreeBSD years back and it worked flawlessly. I transitioned to ssh certificates only for convenience but the implementation never failed to work.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204110">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204110">
						September 14, 2013 1:48 AM					</a>

				</p>

				<p>@ Anonymous Coward</p>
<p>&#8220;You can weaken/compromise the security of FDE with appropriate exploits, even without DMA. Clive enlightened us about this a week ago:&#8221;</p>
<p>&#8220;It looks like there&#8217;s very good reasons the US Gov&#8217;t (and other security-conscious entities) will de-gauss hard disks on site, and then ship them off for complete destruction (with a trusted chain of custody). The NSA anticipated (and could very well have exploited) the methodology employed in Malcom&#8217;s link, and the malicious possibilities.&#8221;</p>
<p>That was about SSD&#8217;s. Without them and w/ the right crypto setup, you&#8217;re in pretty good shape. Clive and I worked out details on here a few years back to the requirements for a very secure inline-media encryptor [using COTS hardware] for hard drives. The whole point of such a design is so you don&#8217;t have to worry about the HD going into enemy hands. And NSA has one of these&#8230;</p>
<p><a href="http://www.nsa.gov/ia/programs/inline_media_encryptor/" rel="nofollow ugc">http://www.nsa.gov/ia/programs/inline_media_encryptor/</a></p>
<p>I certainly referenced it in Clive and I&#8217;s discussions. Data goes in at up to TS/SCI and comes out as ciphertext that&#8217;s considered &#8220;unclassified&#8221; and &#8220;secure&#8221; when &#8220;at rest.&#8221; I&#8217;d say they&#8217;re not worried about recovery. The trick is that they engineered a high assurance crypto system to do it. And all the specs and requirements are laid out for you right on that page. People wanting to beat NSA snoops out of their encrypted volumes just consider that a little present for you. 😉</p>
<p>Re hard disk destruction</p>
<p>They mainly do that, imho, because most devices and software DOD uses aren&#8217;t high assurance. It&#8217;s COTS crap that might leak plenty of stuff. It&#8217;s anything but trustworthy. That includes many encryption products for windows and such. It&#8217;s probably better to destroy any storage for such stuff after use, just in case. However, the NSA IME should show if you use the high security approach it&#8217;s not strictly necessary.</p>
<p>Exception: Unless you use an SSD some people here claimed. I&#8217;ll take their word for it. I got along for years without one so I won&#8217;t miss them.</p>
<p>Revision: &#8220;COTS crap taht might leak plenty of stuff&#8221; + &#8220;COTS crap they subverted to leak plenty of stuff.&#8221; 😉</p>
<p>@ Malcom</p>
<p>&#8220;DMA shouldn&#8217;t be a worry as modern machines have IOMMU which will prevent a random device from performing arbitrary DMA transfers. If you&#8217;ve got a rogue driver running on the host, then it doesn&#8217;t matter whether your HDD is malicious, you&#8217;re already screwed.&#8221;</p>
<p>IOMMU is one of the answers to dealing with rogue DMA. However, IOMMU is mainly on the complicated x86 chipsets with plenty subversion potential (SMM, AMT, NSA&#8230;). The chips with low-subversion risk often don&#8217;t have IOMMU&#8217;s. It&#8217;s two options I&#8217;ve been back and forth with for a while. I think another commenter had the right idea with opencores. I&#8217;ve pushed that too. An open IOMMU and processor spec designed for simplicity/security would be ideal. Open peripherals too.</p>
<p>And yes, with rogue drivers, you are certainly screwed. It&#8217;s why I mentioned them. I can&#8217;t even recall when malware started posing as drivers or admin programs it&#8217;s been so long now. And yet only in recent years are we seeing usable solutions to the [security] problems drivers pose.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204111">

			<div class="comment by-jarda ">

				<p class="commentcredit">

					<span class="commenter">Jarda</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204111">
						September 14, 2013 2:11 AM					</a>

				</p>

				<p>Now if a random cybercriminal did all that and did some wee industrial espionage and got caught for it, he&#8217;d get at least 20 years of jail in the USA. If he wasn&#8217;t from USA, the US administration would be screeming &#8220;extradition&#8221;. But if NSA does it, however illegal it is, everything is in perfect order and the worst which will happen is they&#8217;ll make pay the guy whose fault caused the leak. Laws are just for the commoners, some people are above the law.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204112">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204112">
						September 14, 2013 6:25 AM					</a>

				</p>

				<p>@Nick &#8211; I assume the SSD is deemed to be an unacceptable risk as it is unable to be reliably and provably erased (well, at least not as easily as degaussing) and not just because of the wear leveling implemented by the flash controller.</p>
<p>The forensics magazine I occasionally get had an advertisement for an interesting device &#8211; basically a briefcase like UPS. If the target computer was on a power strip, you would plug a cable into the power strip and upon removal from the wall socket its logic would kick in and give power quick enough to prevent it from powering off. They also had scotch like connectors that, if the PC was plugged directly into the wall socket you could carefully unscrew the wall socket and I guess take their wall socket with you.</p>
<p>It was reportedly for allowing you to take a FDE enabled PC back to your office where you can do a cold boot attack at your leisure.</p>
<p>Crazy times we are living in. But we knew this was coming for a long time.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204113">

			<div class="comment by-jon ">

				<p class="commentcredit">

					<span class="commenter">jon</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204113">
						September 14, 2013 7:10 AM					</a>

				</p>

				<p>I am horrified and disgusted by CP but if the Rebublic extradites him to the US I hope the Irish people understand and accept that it will be a death penalty which I am pretty sure that most people in the Republic are against. As am I.  I&#8217;ve been a victim of child abuse and have no sympathy for anyone but I don&#8217;t believe that hosting servers containing CP content warrents the kind of prison sentence that will be handed out in the USSA.  Hi will either spend his life in solitary or be murdered by a guard or fellow inmate in one of our PRIVATE prisons.<br />
to my Irish friends, punish who you will the way you will but never let your Govt let anyone ever be extradited to the US to enter into our only real growing business, The PRIVATE PRISON system.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204114">

			<div class="comment by-marcio-lima ">

				<p class="commentcredit">

					<span class="commenter">Marcio Lima</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204114">
						September 14, 2013 8:32 AM					</a>

				</p>

				<p>Gregory Schlomoff • September 13, 2013 4:40 PM</p>
<p>The Globo Icon is indeed in the two slides you mentioned but this does not imply that the documents are not real. I suppose Globo wanted that the slides were not used by a third party without give the credits for Fatanstico program.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204115">

			<div class="comment by-marcio-lima ">

				<p class="commentcredit">

					<span class="commenter">Marcio Lima</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204115">
						September 14, 2013 8:46 AM					</a>

				</p>

				<p>The question in Brazil now is whether NSA stole sensitive information from the pre-salt oil reserves. The Congress is even discussing a law to forbid american companies to participate in the bid for the exploitation of the pre-salt oil reserves and the acquisition of 35 F16 for the modernization of the Air Force is certainly lost. The chineses(oil) and the french(figthers) are very grateful to Keith Alexander.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204116">

			<div class="comment by-mike-acker ">

				<p class="commentcredit">

					<span class="commenter">Mike Acker</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204116">
						September 14, 2013 8:51 AM					</a>

				</p>

				<p>this excellent discussion of SSL/x.509 touches of the key issue in two spots.</p>
<p>the key issue is the existing CA structure is extensive &#8212; presenting a large attack surface &#8212; and not under user supervision &#8212; as described for public key encryption in Phil Zimmerman&#8217;s original essay.</p>
<p>users should be offered an option to generate a key-pair at any point when they are editing their account credentials.   once this is done they should then have the option to mark CA signatures as marginal trust.  this would then require an additional signature to promote the certificate to full trust and the user would be able to do this using the keypair he generated as part of his log on credentials</p>
<p>i note we are using https here with Bruce&#8217; site.    marginal trust will be enough for this.    but for anything dealing with money &#8212; Amazon, TurboTax, Credit Union etc &#8212; full trust would be needed.</p>
<p>this means i need to get a copy of the certificate i want to have full trust from a separate source &#8212; one that  i consider reliable such as my Credit Union.   I would then verify the fingerprint and then sign their certificate.</p>
<p>a bit more than we do now?    yep, but for a society that loves computers i don&#8217;t see it as a game stopper, particularly if its is introduced as an optional process.</p>
<p>i think it is important to note that much of the process we try to use to authenticate transactions is simply our old pen&amp;ink process, partly jammed into a digital environment.   notice how much hacking is accomplished by faking or bypassing proper authentications.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204117">

			<div class="comment by-stanislav-datskovskiy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.loper-os.org' rel='external nofollow ugc' class='url'>Stanislav Datskovskiy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204117">
						September 14, 2013 9:51 AM					</a>

				</p>

				<p>Clive Robinson: note that I have carefully specified that an OTP is &#8220;safe when used as prescribed.&#8221;</p>
<p>That means: no obvious idiocies like keymat reuse (the Venona break, etc.)  And no runs of 30 zeroes &#8211; what is the chance of this in a reasonable entropy generator? EM isolation isn&#8217;t hard either. Enclose the device in a grounded steel box, with no electrical connections whatsoever to the outside. Data and power both must travel over optical fibers; the only openings in the box are the minimal size needed to admit the fibers.</p>
<p>In practice, malware (in the usual sense) is only an issue for Ms-Win users. Avoid the crapware peddled by the Redmond Criminal and you&#8217;re a considerably harder target. To the point that you will be a good candidate for <i>Rectothermal Cryptoanalysis</i>.</p>
<p>As for airgap, anyone who can build a fully-automatic &#8216;USB Stick of Death&#8217; compatible with all variants of Linux <i>deserves</i> your data.</p>
<p>Also consider one simple defense against anyone at all &#8220;slurping up your OTP&#8221;: a very large OTP, and a very slow Internet connection.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204118">

			<div class="comment by-stanislav-datskovskiy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.loper-os.org' rel='external nofollow ugc' class='url'>Stanislav Datskovskiy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204118">
						September 14, 2013 10:03 AM					</a>

				</p>

				<p>Mike the goat:</p>
<p><i>&gt; The forensics magazine I occasionally get had an advertisement for an interesting device &#8211; basically a briefcase like UPS&#8230; allowing you to take a FDE enabled PC back to your office where you can do a cold boot attack at your leisure.</i></p>
<p>There are some fairly simple defenses against this kind of trick. One could, for instance, embed a GPS receiver into the machine. Better still, a 3-axis accelerometer. Any appreciable motion and the keys get zeroed and repeatedly bit-walked over.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204119">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204119">
						September 14, 2013 1:15 PM					</a>

				</p>

				<p>@ Stanislav Datskovskiy,</p>
<ul><i>And no runs of 30 zeroes &#8211; what is the chance of this in a reasonable entropy generator?</i></ul>
<p>It&#8217;s not just runs of zeros or ones it&#8217;s any repeating patern as I originaly said.</p>
<p>So the probability of bad sequences is based on the bit pattern length, number of repeats and their seperation.</p>
<p>For instance the bit pattern &#8220;10&#8221; would be expected one time in four thus on average once every eight bits. What you would not want is for it to appear in a regular or fixed pattern such as at the begining of every eight bit frame. Which can happen with TRNGs when power supply regulation breakes down with age or some twit has put an electrolitic capacitor in the wrong way around.</p>
<p>The problem is that such a sequence would pass some statistical tests without issue, and it&#8217;s not possible to do more than basic statistical tests on a live TRNG.</p>
<p>Which means you have a lot of post-generation testing to do.</p>
<p>Which is why people prefer to use the likes of crypto algorithms to actualy generate the random output and use the TRNG output to augment the CS-PRNG.</p>
<p>A simple example is a counter that is double incremented on the changing edge of the TRNG, the counter value is then put through a crypto function. Think of it as say AES-CTR where the counter value jumps unpredictably. It has all the security guarentees of CTR mode but with the added advantage of not being as predictable over time.</p>
<p>As for &#8220;power over optical cable&#8221; it actual does not solve the EM problem it mearly shifts it upto the optical source where the EM field effects the optical source driver electronics, However doing this power by light source actually adds a problem which is power fluctuation from mechanical vibration. I won&#8217;t bother going into the ins and outs of it but it&#8217;s always there.</p>
<p>Oh and don&#8217;t forget any wire that moves in a field is a transducer and will convert part of the energy of that movment into electrical energy. It&#8217;s known to analog and RF engineers as &#8220;microphonics&#8221; and some components are realy very susceptable to it.</p>
<p>Oh and grounded or not even perfectly welded steel boxes are not as EM proof as you might beleive partly because steel is not a pure metal or crystal it&#8217;s effectivly a granular combination of both and magnetic fields will penetrate into it quite a distance at verious frequencies. Likewise when looking at copper it suffers from the &#8220;skin effect&#8221; which as a rough rule of thumb will tell you how far in an electrical field will penetrate at any given frequency.</p>
<p>Oh and don&#8217;t forget ionising radiation the likes of X-Rays can quite easily get through a few milimeters of steel or copper and electronics especialy small transister microelectronics are quite susceptable to them.</p>
<p>As I and others have repeatedly said designing TRNGs is not easy. Basicaly they can all be got at one way or another when engineering them with parts that are cost effective to manufacture. It&#8217;s always a game of &#8220;trade offs&#8221;.</p>
<p>As for &#8220;malware&#8221; you are assuming a level 1 not 3 adversary. Beleive me most *nixs have zero days and other flaws just as much as any comercial software. If a level 3 adversary targets you you will without a doubt have malware on any system that has been connected to any kind of communications network even if as with bluetooth or WiFi you thought it was disabled. Put simply at power up the hardware jumps to a known state and tests it&#8217;s self then the BIOS comes along and does further setup and test before loading in drivers etc to boot up the OS. Neither you nor I know what goes on before the OS recognises the &#8220;soft switch&#8221; status or if it actually disbles it. If you want to be sure you need to pull the device data sheets, and trace tracks and then using needle point probes attached to wires onto a 12volt car/motorbike batter treat the appropriate PCB traces to a quick &#8220;fuse blow&#8221; to permanently open circuit them.</p>
<p>As for a &#8220;USB stick of death&#8221; it does not have to recognise your OS just the COTS BIOS of which there are not very many, for when you power up with the USB stick pluged in because you forgot to unplug it after you last used it. But the reality with Linux is the kernel and drivers are fairly standard across most distros. Further you don&#8217;t know what goes on at the firmware level with the USB hardware&#8230;</p>
<p>As for OTP size-v-network speed, malware only has to push out the bits of the OTP you&#8217;ve used so in reality if the network speed is fast enough to send messages it&#8217;s fast enough to send out the equivalent bit of the OTP&#8230;</p>
<p>Security is hard at the basic level and gets exponentialy more difficult as you move up levels, but what we do know (it&#8217;s been proved) there is no such thing as 100% secure not even close.</p>
<p>As I said if you are going to use OTP stick to paper for the pads and a box of matches and an ash tray, it&#8217;s security is way way easier to control, and use it for sending keys for an appropriate cipher. And as for generating the OTP use four or five dice in a beer glass, it might be slow but from a practical point of view way way more secure than any TRNG you are likely to come across.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204120">

			<div class="comment by-turky ">

				<p class="commentcredit">

					<span class="commenter">Turky</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204120">
						September 14, 2013 1:47 PM					</a>

				</p>

				<p>Diginotar was already hacked, since May 2009.<br />
<a href="http://www.f-secure.com/weblog/archives/00002228.html" rel="nofollow ugc">http://www.f-secure.com/weblog/archives/00002228.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204121">

			<div class="comment by-stanislav-datskovskiy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.loper-os.org' rel='external nofollow ugc' class='url'>Stanislav Datskovskiy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204121">
						September 14, 2013 1:47 PM					</a>

				</p>

				<p>Clive Robinson: this is all true;</p>
<p>Dr. Evil can drive up to your house and transmit a pulse of modulated X-rays that will trigger the backdoor in your CPU, Northbridge, etc. squirreled away inside all such products on the Führer&#8217;s personal orders.</p>
<p>However, rectothermal cryptoanalysis is still cheaper and more effective. Dr. Evil&#8217;s minions won&#8217;t sit patiently in the van, instead they drag you out, stuff you in &#8211; and drive off to the Grand Inquisitor&#8217;s house for some tea, cookies, and frank conversation.</p>
<p>If the hypothetical X-ray vans (or magic packets for doctored ethernet cards triggering diddled BIOS, etc.) were to barrage everybody en masse, some alert fellow might discover the trick. They are being saved for some very special occasion, and I doubt that any of us here are worthy of such treatment. So they are not particularly relevant to the question of mass dragnet surveillance.</p>
<p>Aside from living on an island fortress guarded by nuke subs, there is no real defense against the black van. But there are plenty of very cheap and easy things one can do to become truly worthy of the van (the proverbial <i>gasenwagen</i>.) For instance, the use of <a href="http://www.coreboot.org" rel="nofollow ugc">Coreboot</a> (formerly known as LinuxBIOS) with crapola like USB boot snipped out, inline HDD encryptors of one&#8217;s own design, a reasonably-custom Linux (e.g. Gentoo) with unnecessary drivers snipped out, etc.</p>
<p>Perhaps we&#8217;ll all meet in a slave labor camp one day and compare notes: what worked, what didn&#8217;t.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204122">

			<div class="comment by-bert-kerstens ">

				<p class="commentcredit">

					<span class="commenter">Bert Kerstens</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204122">
						September 14, 2013 1:53 PM					</a>

				</p>

				<p>Amazing, how everyone runs around in panic, all because of some &#8216;leaked&#8217; Powerpont slides&#8230; Knowing a lot of details about the Diginotar case (I&#8217;m Dutch and live 2 blocks from their former office), I&#8217;m calling it total B-S.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204123">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204123">
						September 14, 2013 1:57 PM					</a>

				</p>

				<p>@Clive &#8211; I remember years ago when an undergrad I designed a RNG by making a matrix of contacts along the bottom of my perspex enclosure which fed a controller from an old keyboard. I then used small copper foil squares as my &#8216;bits&#8217;. I made several ducts to introduce compressed air and it operated by bursting air into the enclosure. The copper foils would land where they wanted to and my code would output random bits. Of course it was just a college project but I have since seen designs based on lava lamps, sources like americum from a smoke detector and even a CCD focused on a waterfall with the difference between frames being used (I also saw one supposedly using the background noise of a camera in the dark as a source of entropy) but it seems there is nothing practical and miniaturized that also fits the bill of being auditable (I am looking at you Intel!)</p>
<p>I can also think of numerous ways bias could be introduced into any one of these aforementioned designs. Is there such a thing as a perfect TRNG?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204124">

			<div class="comment by-stanislav-datskovskiy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.loper-os.org' rel='external nofollow ugc' class='url'>Stanislav Datskovskiy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204124">
						September 14, 2013 2:05 PM					</a>

				</p>

				<p>Mike the goat: so long as you need physical proximity to induce the bias, it is still fair to call it a good TRNG. Consider the degenerate case: anybody can significantly reduce the entropic quality of any TRNG ever built using: a hammer.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204125">

			<div class="comment by-anonymous-coward ">

				<p class="commentcredit">

					<span class="commenter">Anonymous Coward</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204125">
						September 14, 2013 3:31 PM					</a>

				</p>

				<p>@ Nick P</p>
<p>I recognize that Clive&#8217;s comments were with regards to SSDs, but the trouble with those, as I understand it, is ensuring that you&#8217;ve securely erased every chip. Those devices internally maintain extra capacity not directly exposed from the e.g. SATA interface, but which is hidden behind the controller.</p>
<p>&#8216;Mike the goat&#8217; mentioned that it&#8217;s not unheard of for platter HDDs to be overbuilt in terms of capacity (in his anecdotal case, 2GB physical capacity drives were marketed as, and firmware-limited to, 1TB).</p>
<p>By subverting the firmware in the HDD controller, one could, in principle, maintain extra copies of data outside the user&#8217;s control. This is obviously very bad for plaintext. What I was getting at when linking Clive&#8217;s post was that maintaining extra copies of ciphertext <i>also</i> presents a security risk. Of course, this is very much implementation-dependent. I understand Clive&#8217;s post referred specifically to this being a weakness for stream ciphers, but surely there are implications for various implementations of block ciphers as well?</p>
<p>I&#8217;m no cryptologist or security engineer, so I&#8217;m more than happy to be corrected for any misgivings I may have.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204126">

			<div class="comment by-rolf-weber ">

				<p class="commentcredit">

					<span class="commenter">Rolf Weber</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204126">
						September 14, 2013 3:55 PM					</a>

				</p>

				<p>Stupid question: Why does the NSA bothers with man-in-the-middle attacks, when they already have &#8220;direct access&#8221; to the servers? This is, at least, what the press wants to make us believe. Or is the &#8220;direct access&#8221; theory now disproved? Eventually.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204127">

			<div class="comment by-stanislav-datskovskiy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.loper-os.org' rel='external nofollow ugc' class='url'>Stanislav Datskovskiy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204127">
						September 14, 2013 4:12 PM					</a>

				</p>

				<p>Rolf Weber: that one&#8217;s easy: direct access for NSA toadies like Google, Microsoft, et al., MITM for some minor pesthole (small company mail server, etc.) that hasn&#8217;t been properly pwned yet.</p>
<p><i><a href="http://www.poetryloverspage.com/poets/kipling/cold_iron.html" rel="nofollow ugc">Gold is for the mistress &#8212; silver for the maid /<br />
Copper for the craftsman cunning at his trade.&#8221; /<br />
&#8220;Good!&#8221; said the Baron, sitting in his hall, /<br />
&#8220;But Iron &#8212; Cold Iron &#8212; is master of them all.</a></i></p>
<p>Cheap malware gimmicks for the Winblows luser; MITM for the Hushmail hipsters; bare metal attacks (see Clive Robinson&#8217;s comments) for the hard targets.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204128">

			<div class="comment by-z ">

				<p class="commentcredit">

					<span class="commenter">z</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204128">
						September 14, 2013 4:15 PM					</a>

				</p>

				<p>@Rolf Weber</p>
<p>I suspect even Google would be skittish to hand over the amount and type of data the NSA wants. I bet they use MITM attacks for the data they can&#8217;t get Google to give them voluntarily and can&#8217;t get an NSL for.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204129">

			<div class="comment by-cleyton-s-santos ">

				<p class="commentcredit">

					<span class="commenter">cleyton s santos</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204129">
						September 14, 2013 6:16 PM					</a>

				</p>

				<p>Who in the world, can it stop NSA? or won&#8217;t we have a savior?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204130">

			<div class="comment by-stanislav-datskovskiy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.loper-os.org' rel='external nofollow ugc' class='url'>Stanislav Datskovskiy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204130">
						September 14, 2013 6:34 PM					</a>

				</p>

				<p>cleyton s santos: &#8220;Save yourself &#8211; and around you, others will be saved.&#8221; (Eastern Orthodox church, if I recall.)</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204131">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204131">
						September 14, 2013 6:43 PM					</a>

				</p>

				<p>I wonder how much Googles cooperation with the NSA is driven by the frustration with trying to keep them out of the loop. Imagine you find that most of your software quality problems are caused when someone (on your team) has intentionally inserted vulnerabilities into the code. They are doing this so that their real boss (NSA) has systemic access, intentional zero-days, which are somewhat easier to find then the unintentional type AND are much easier to protect with unlikely trigger sequences.</p>
<p>Eventually you&#8217;d get sick of trying to keep them out so in the interests of quality you&#8217;d invite them into the loop, at least than their code would be subject to the same quality controls and regression tests that apply to the rest of your product.</p>
<p>The more you (as a company) resist the NSA, the more vulnerable (and valuable) your employees become, you spend $100M keeping them out, they spend $1M getting in. The old Counter Human Intel maxim of MICE (Money, Ideology, Coercion, Ego) applies to your employees today just as it applied to foreign operatives  in years gone by.  Would Google really want their employees to be coerced, or bribed into cooperating (think of the legal problems this could create). How could they possibly weed out those driven by Ego or Ideology?</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204132">

			<div class="comment by-stanislav-datskovskiy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.loper-os.org' rel='external nofollow ugc' class='url'>Stanislav Datskovskiy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204132">
						September 14, 2013 6:54 PM					</a>

				</p>

				<p>RobertT: this is a bit like how nations allow some measure of foreign spying under diplomatic cover: &#8216;legal residents&#8217; (in Soviet parlance.) Doesn&#8217;t stop anyone from sending in &#8216;illegals&#8217; (spies in the ordinary sense) as they are considerably more useful.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204133">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204133">
						September 14, 2013 7:35 PM					</a>

				</p>

				<p>@ Clive Robinson</p>
<p>&#8220;But there are plenty of very cheap and easy things one can do to become truly worthy of the van (the proverbial gasenwagen.) For instance, the use of Coreboot (formerly known as LinuxBIOS) with crapola like USB boot snipped out, inline HDD encryptors of one&#8217;s own design, a reasonably-custom Linux (e.g. Gentoo) with unnecessary drivers snipped out, etc.</p>
<p>Perhaps we&#8217;ll all meet in a slave labor camp one day and compare notes: what worked, what didn&#8217;t.&#8221; (Stanislav Datskovskiy)</p>
<p>I think I like this guy haha. He would probably have had interesting things to say during our big discussions a few years back where we worked out quite a few secure solutions&#8217; details. Particularly on hardware.</p>
<p>@ <b>Stanislav Datskovskiy</b></p>
<p>The comments you&#8217;ve made here and on your blog that grab my attention the most involve high[er] level processors. Recently, I&#8217;ve been referencing the same thing on this blog. Many software errors are removed by giving programmers higher abstractions. However, the safer software platforms keep having trouble at the lower level stuff the language assumptions ignore or which is right at an abstraction boundary. The obvious solution is to raise the hardware&#8217;s level of abstraction/operation up to reflect what we&#8217;re trying to do with it. Not to mention, it&#8217;s better to work on screws with a screwdriver rather than an old hammer. 😉</p>
<p>So, what to do? The first idea I had was to look into high level systems of the past. The LISP machines came to mind. You referenced a Scheme system I didn&#8217;t know about. Then, there were tagged/capability architectures that allowed fine-grained control over how the processor worked with specific pieces of data.  Most recently, as there exist Java OS&#8217;s and security-oriented tech, I&#8217;ve been thinking of enhancing Java processors for security appliances or addons. Example: Java Processor + Crypto Coprocessor + JX Operating System might give attackers quite a bit of headaches.</p>
<p>(Note: You might find HISC instruction set processor interesting. It&#8217;s mostly made for Java and OOP. However, it&#8217;s pretty straightforward design where small features give plenty of bang for the buck. That&#8217;s the kind of approach I prefer. )</p>
<p>To me, the trick is to really build into hardware the following:</p>
<ol>
<li>Trustworthy boot process.</li>
<li>Device restriction tech.</li>
<li>Safe control flow: ability to tell difference between instructions and data IN PRACTICE. And instructions follow valid paths.</li>
<li>Most essential security primitives in hardware (incl TRNG)</li>
<li>Strong support for fine-grained componentization and isolation of software.</li>
</ol>
<p>These alone can be used to build highly secure, usable systems. I know it&#8217;s the case because a subset of these accomplished those goals in the past (KeyKOS comes to mind). So, the trick is, what modern processors can do this already? If none, what routes or past examples will lead to one? The old capability/tagged architectures had good wisdom. Should we just update and clone one of those solutions? Or how could it be done better given what progress in chip design that academics and companies have made?</p>
<p>I mainly think of Java processors as interim solutions to eliminate low hanging fruit (always a priority of mine). And I&#8217;m aware the DARPA Clean Slate programs, especially crash-safe.org, are working on a modern functional and tagged architecture. I&#8217;m talking something less radical that lets us reuse existing code in language like Java (or Python/LISP) and simply secures what&#8217;s underneath it. That will make it more marketable as it&#8217;s easier to port apps to it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204134">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204134">
						September 14, 2013 7:42 PM					</a>

				</p>

				<p>@ Anonymous Coward</p>
<p>Thanks for clarifying.</p>
<p>&#8221; I understand Clive&#8217;s post referred specifically to this being a weakness for stream ciphers, but surely there are implications for various implementations of block ciphers as well?&#8221;</p>
<p>Honestly, I&#8217;m not sure. It&#8217;s worth looking into.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204135">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204135">
						September 14, 2013 8:31 PM					</a>

				</p>

				<p>@Nick &#8211; so, if I understand what you and Stanislav are saying correctly &#8211; our current architectures build in a level of complexity that effectively makes complete transparency practically infeasible, and if we could have a CPU that understood a higher level language we could engineer some of this out of the system? Is that the supposition, in essence?</p>
<p>While I may not see the utility in, say going back to the LISP machine style architecture I can certainly see the wisdom in sitting down and deciding what is important and what is not &#8211; in the case of x86 there is just too much legacy and redundant fluff.</p>
<p>On the topic of systemic complexity &#8211; One only has to look at, say the source of OpenSSL and say CyaSSL and compare the two implementations not just in code readability but in how many lines of code to see that simplifying any implementation can indirectly improve its security.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204136">

			<div class="comment by-stanislav-datskovskiy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.loper-os.org' rel='external nofollow ugc' class='url'>Stanislav Datskovskiy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204136">
						September 14, 2013 10:01 PM					</a>

				</p>

				<p>Nick P and Mike the goat:</p>
<p>There&#8217;s a right way and a (very much) wrong way to go about the &#8220;secure hardware&#8221; game.</p>
<p>The wrong way involves layer upon layer of &#8220;trustworthy&#8221; restriction crapolade &#8211; compartmentalization, cryptoprocessors, etc. This is great for making a system &#8220;safe&#8221; &#8211; from <i>you</i>, the <a href="http://glyf.livejournal.com/46589.html" rel="nofollow ugc">supposed</a> owner. And is certainly no defense at all against the adversary under consideration, considering that his minions will be the inevitable architects of all the &#8220;secure&#8221; junk.</p>
<p>Now, the <i>right way</i> &#8211; which has a Snowden&#8217;s chance in hell of actually happening in our lifetimes &#8211; is a computer whose design <i>actually fits in one head</i> &#8211; like a Kalashnikov&#8217;s. Don&#8217;t add to the complexity, eschew laboriously-standardized protocols of every kind, burn the legacy garbage &#8211; a computer whose complete description, from the ground up &#8211; including basic system software &#8211; would in one mind.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204137">

			<div class="comment by-z ">

				<p class="commentcredit">

					<span class="commenter">z</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204137">
						September 14, 2013 10:28 PM					</a>

				</p>

				<p>Well, this is interesting. One of the Perspectives notaries is seeing  a different cert  for Bruce&#8217;s blog  than the one I am.</p>
<p>Key I&#8217;m using: a2:47:7c:cc:07:c7:f5:e7:3b:a4:3f:09:0e:9d:ed:e7</p>
<p>Key that notary &#8220;perspectives6.networknotary.org:8080&#8221; sees:<br />
ce:be:43:11:9d:80:6e:d6:0a:13:12:03:4a:9f:b5:5e</p>
<p>The rest of the notaries concur with the one I have. The strange one has been in use for the last 30 days at least according to that notary.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204138">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204138">
						September 14, 2013 10:33 PM					</a>

				</p>

				<p>@Stanislav Datskovskiy<br />
Agreed, even when you invite your enemy to be part of the creation process he MUST always maintain a separate capability to subvert your product, if for no other reasons than simply to maintain an element of deniability.  Look this is what we agreed to! the stuff you&#8217;re pointing at is the work of some lunatic that Google or whoever hired.</p>
<p>As for CPU and system simplicity being the correct route to security,  I think I&#8217;ll have to take issue with that because the simpler you make the system the simpler its operational signatures become. Simplicity aids analysis like DPA which as we have seen in the past is a very effective way to attack AES encryption.</p>
<p>Invariably you also end up wanting to hide a secret on the chip/system (mutual authentication for instance) Simplicity help the attacker to extract this critical information &#8230;.. Ahhh I knew their was a reason I gave up working in this area.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204139">

			<div class="comment by-stanislav-datskovskiy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.loper-os.org' rel='external nofollow ugc' class='url'>Stanislav Datskovskiy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204139">
						September 14, 2013 10:45 PM					</a>

				</p>

				<p>RobertT: simplicity of the &#8220;physically no place whatsoever to hide a nasty&#8221; variety is <i>the only</i> real answer to the nation-state adversary.</p>
<p>Aside from the benefits of doing some good slash-and-burn on the jungle of legacy crapware, consider other possibilities.</p>
<p>Dare to think some very weird thoughts: Asynchronous logic (Muller gate) built on ECL transistors. Power analysis, gone. No cache hierarchy (no caches) &#8211; timing analysis, mostly out the window.</p>
<p>A genuinely-simple and exhaustively-documented architecture also means you can have your silicon fabbed locally by persons you trust, whether you are Putin or Castro. 1970s MOS will do fine, because <a href="http://www.loper-os.org/?p=300" rel="nofollow ugc">computers only come in two speeds.</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204140">

			<div class="comment by-robertt ">

				<p class="commentcredit">

					<span class="commenter">RobertT</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204140">
						September 14, 2013 11:20 PM					</a>

				</p>

				<p>@ Stanislav Datskovskiy</p>
<p>Asynchronous logic only seems like a good idea until you implement it because it makes DPA trivial.  It only changes the skill set needed to undertake the DPA task because the signature is no longer locked to the instruction clock frequency. Think of the Asynchronous DPA signature as being like a doppler shifted DSSS transmission, exactly the same correlation Rx techniques you would use for this problem works for Asynchronous logic DPA.</p>
<p>Getting the silicon fabbed by people you trust now thats a good laugh, you&#8217;ve created a system that is completely subvertable by just owning a single step of the process. Modern chip lithography is capable of fabricating logic gates with area of less than 1000sqnm (under 1/10th the wavelength of light in every dimension) How would you ever know that some of these ultra small gates were not added to your simple system.  BTW typical SiN/SiO2 sandwich chip passivation layers are completely opaque to deepUV.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204141">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204141">
						September 14, 2013 11:35 PM					</a>

				</p>

				<p>@ Mike</p>
<p>&#8221; so, if I understand what you and Stanislav are saying correctly &#8211; our current architectures build in a level of complexity that effectively makes complete transparency practically infeasible, and if we could have a CPU that understood a higher level language we could engineer some of this out of the system? Is that the supposition, in essence? &#8221;</p>
<p>Well, I don&#8217;t speak for him just me&#8230; 😉 What I&#8217;m saying is that current CPU&#8217;s were designed for another era. That era had people whose programming routine was about moving memory and data around in primitive ways to accomplish work. This was incrementally improved on, but kept legacy &amp; backward compatibility. Processor companies rarely innovated b/c the market wanted backward compatibility, more speed, and optionally performance enhancing features (even more speed).</p>
<p>Today, we have managed runtimes, concurrency issues, security issues, portability issues, etc. Some of these could be solved or a solution aided by a better hardware base. A departure from the norm, shall we say. A few companies tried that back then with object architectures. Intel 432 and IBM AS/400 were examples. Intel&#8217;s was much safer than average and supported more modern paradigms, but ran at 25% speed. AS/400 wasn&#8217;t a pure object processor but was good at what it was designed to do. It made it. 432 died. And that&#8217;s it far as non-embedded market went for a while.</p>
<p>I mean, there are enterprise Java processors for application servers. Itanium tried to be a bit different with a simpler architecture and built-in safety/security features. However, hardly any company is designing the chips to provably eliminate problems that have been plaguing us for over a decade. Current chips have to be <em>forced</em> to operate correctly with great effort. Certain chips in the past did well naturally by design.</p>
<p>Far as complexity goes, the you are right in that you don&#8217;t want more than you need. Proper use of abstractions is the main way of managing complexity, along with translation/generation tools. Examples of trying to increase hardware assurance are VAMP processor for correctness, AAMP7G for isolation, and Cassion language for specifying it. Compare that to say Verilog + typical specs and you can see a world of difference in likelihood that end result will work properly.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204142">

			<div class="comment by-stanislav-datskovskiy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.loper-os.org' rel='external nofollow ugc' class='url'>Stanislav Datskovskiy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204142">
						September 14, 2013 11:39 PM					</a>

				</p>

				<p>RobertT: I&#8217;m distinctly uninterested in DPA, because &#8220;tamper proof&#8221; hardware is an idiot&#8217;s game. If you can get a hold of a few thousand samples, it doesn&#8217;t matter what kind of unobtainium a &#8220;tamper proof&#8221; widget is made of.</p>
<p><a href="http://glyf.livejournal.com/46589.html" rel="nofollow ugc">The &#8220;machine owner as the adversary&#8221; segment of the &#8220;security community&#8221;</a> should really be run out of town on a rail. If that&#8217;s what you (not you, RobertT, specifically, anybody reading this) are working on, <i>I hope you fail miserably and go broke.</i> I want no part of that kind of &#8220;security.&#8221;</p>
<p>Unless you&#8217;re thinking of power line analysis by an adversary at the mains plug end, something which AFAIK has never been demonstrated (though I do believe it was once carried out, in anger, on&#8230; electric typewriters.)</p>
<p>The solution to paragraph #2 is simple: stick to 1980s VLSI. A desktop user doesn&#8217;t really need modern CPU power for much of anything. Especially once you get off the Microshaft treadmill.</p>
<p>The 1980s state-of-the-art workstation was better-designed, more responsive, and in various other ways more useful than what you and I have now. Most of the increase in density has gone to waste. It is being used to churn garbage (idiot bloat like XML; multiple <a href="http://www.loper-os.org/?p=38" rel="nofollow ugc">overlapping memory allocators with mismatched impedance, etc.</a>) while the hapless user twiddles his thumbs and curses.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204143">

			<div class="comment by-stanislav-datskovskiy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.loper-os.org' rel='external nofollow ugc' class='url'>Stanislav Datskovskiy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204143">
						September 14, 2013 11:44 PM					</a>

				</p>

				<p>Nick P: &#8220;you can&#8217;t transition from the informal to the formal by formal means.&#8221; Where is the mathematical proof, the formal specification, which shows that your doorknob turns? And yet it turns. A Kalashnikov fires, though no mathematical proof of this fact exists or is likely to exist. Simplicity is power.</p>
<p>We can do the same re: computing. It really isn&#8217;t such a complicated business &#8211; once you <a href="http://herpolhode.com/rob/utah2000.pdf" rel="nofollow ugc">build the Bonfire of the Protocols and dispense with all the design-by-committee garbage.</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204144">

			<div class="comment by-nick-p ">

				<p class="commentcredit">

					<span class="commenter">Nick P</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204144">
						September 14, 2013 11:50 PM					</a>

				</p>

				<p>@ Stanislav Datskovskiy</p>
<p>&#8220;This is great for making a system &#8220;safe&#8221; &#8211; from you, the supposed owner. &#8221;</p>
<p>And tons of other attackers, including FBI and NSA to a degree. We&#8217;re screwed if they subvert the fab itself. Otherwise, a decent design provides more protection than crappier designs.</p>
<p>&#8220;Now, the right way&#8230; is a computer whose design actually fits in one head &#8211; like a Kalashnikov&#8217;s. &#8221;</p>
<p>It should fit in the mind of a designer. If people can&#8217;t thoroughly understand every bit of it, then it will conceal problems. Both LISP Machines and Wirth&#8217;s Oberon/Modula workstations remind me of this.</p>
<p>&#8220;Don&#8217;t add to the complexity, eschew laboriously-standardized protocols of every kind, burn the legacy garbage &#8211; a computer whose complete description, from the ground up &#8211; including basic system software &#8211; would in one mind.&#8221;</p>
<p>Problem is we don&#8217;t just need a computer. We need a computer that can securely interact with untrustworthy input and hardware/software faults. Security requires a few things: control of information flow; isolation of certain information; recovery from problems; assurance of design &amp; implementation of former.</p>
<p>So, we have a data-driven action and then we have a version that prevents problems from affecting us. The latter will always be more complex and less pure than the former. As will the features I mentioned. The result is that the complexity must be managed by the designer using modular design with careful interfaces, rigorous specification of behavior, and strong correspondence between implementation/design/requirements. The design might fit in one&#8217;s head all at once or might only do so one part at a time. Nature of the game.</p>
<p>Another reason for those things you don&#8217;t like are to contain issues when system developer or user screws up. (See Inevitability of Failure) A system assuming perfection of developers, users or hardware will be compromised. Call it one of my maxims of security.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204145">

			<div class="comment by-stanislav-datskovskiy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.loper-os.org' rel='external nofollow ugc' class='url'>Stanislav Datskovskiy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204145">
						September 15, 2013 12:06 AM					</a>

				</p>

				<p>Nick P:</p>
<p><i>&gt; And tons of other attackers, including FBI and NSA to a degree.</i></p>
<p>Pray tell, how?</p>
<p>I think a new security maxim is called for: <i>any system physically-capable of concealing a design detail from its owner will end up concealing an NSA master key.</i></p>
<p><i>&gt; &#8230;contain issues when system developer or user screws up.</i></p>
<p>This is really a dream of &#8220;fried ice.&#8221; A harmful, physically-impossible dream, which will be happily catered to by snake oil peddlers of all stripes until the world awakens from it.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204146">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204146">
						September 15, 2013 3:01 AM					</a>

				</p>

				<p>@Stanislav Datskovskiy,</p>
<p>I know that you think RobertT and myself are thinking way beyond what you think is possible or will be done, but history shows that what is deemed impossible today will be an operational weapon tomorow.</p>
<p>Thus it&#8217;s sensible to keep a &#8220;weather eye&#8221; for approaching storm clouds and follow a few basic rules of thought.</p>
<p>One aproaching storm cloud is the Ed Snowden revelations, the simple fact is that people in the security industry have been pointing out that what the NSA are supposadly doing has been possible for twenty years or so one way or another and it would be daft not to consider they are doing so. The general industry concensus was &#8220;so what&#8221; and &#8220;carry on as usuall&#8221; ignoring the problem.</p>
<p>That was great for two sets of people, the NSA et all and those who have taken the warnings seriously. Why the latter well it&#8217;s in part the &#8220;low hanging fruit&#8221; principle and in part the old joke about the two men and the tiger where one realises he only has to run that little bit faster than his friend to survive because the tiger will go for the &#8220;low hanging fruit&#8221; of the slowest man.</p>
<p>The Snowden revelations are going to act as a wake up call for quite a few (but probably not many as a percentage) and they are going to take the time to tie their laces and run that bit harder than the others, which is going to vastly increase that second group, and that&#8217;s a real problem.</p>
<p>Why is it a problem, well few people are going to climb a tree for just one or two very good apples when there are hundreds of thousands of perfectly acceptable apples within reach of the ground with a bit of a stretch. But if there are now thousands of very good apples up there then it pays to go and get a ladder or cherry picker crane to get them.</p>
<p>That is that second group that were outside of the NSA general harvesting methods were to small in number to bother with will now grow a thousand fold and as such now sufficient in number to be worth bothering with.</p>
<p>This gives the NSA two choices extend their existing hoovering methods to cover them or directly target on a &#8220;personal&#8221; basis. The most efficient with anything other than a very small number of select targets is to extend the existing hoovering methods.</p>
<p>I can say this with a degree of certainty because this is what the criminal element on the Internet has done already and as history shows, where criminals lead spys will follow just a foot step or two behind [1].</p>
<p>Right now there are very many &#8220;Personaly Identifing Information&#8221; handeling organisation executives having conversations with the legal fraternity about liability under verious pieces of legislation. Because yesterdays &#8220;best practice&#8221; has just in effect become an admission of guilt for not taking due caution and diligence. So they are going to talk to their technical staff and open their cheque books and pay for a whole load of new security product. Much of which will be based on what is current practice in that small second group (with luck it will spike BYOD and external Cloud which could be good news for sysadmins). So it will cause the Feds etc to &#8220;go dark&#8221; untill they have extended the hoovering or changed the legislation (which appears unlikely in the immediate future).</p>
<p>This guarenteed extension to the hoovering methods means that the small second group have the choice of either notching up their security efforts or getting hoovered up with the rest. So whilst the Snowden revelations are a bright shining light to many for the few they have cast dark storm clouds across the horizon and tempestuous times are ahead.</p>
<p>Thus the use of minority operating systems and permiable air gaps is nolonger sufficient more technical means are required. Some of this will be acheived by better OpSec such as replacing air gap crossing media such as thumb drives with media that is either very cheap to buy and securely destroy to do one off unidirectional use, or can be easily and reliably sanitised such as old school magnetic media like floppies and mag tapes (but not hard drives), all with properly audited and fully traceable media use.</p>
<p>But some will by necesit,y be by hardening systems at a more fundemental level than has been done previously. As a first step by reducing systems to the point of single function not just in the application but in the OS and hardware as well. How far down the hardware stack is currently an open debatable but certainly below CPU level.</p>
<p>As Nick P has noted he and I along with several others have been discussing this for some time in both speciffic areas (financial authentication methods, IMEs, data diodes etc) and more generaly such as computer architecture (see Castles-v-Prisons). We have also along with RobertT looked at just what would be required as a process to &#8220;poison the supply chain&#8221; at SoC and lower levels and even how to store data in ways that can only be meaningfull to one small part of a chips functionality and thus defeat &#8220;flip top&#8221; and &#8220;embedded&#8221; attacks on the silicon.</p>
<p>On the above CPU side of the computing stack we have criticaly looked at faux techniques like &#8220;code signing&#8221; long before Stuxnet reared it&#8217;s head to briefly wake the rest of the industry up. We also looked at ways of subverting PKI.</p>
<p>But in the more distant past we have talked about what you might call TEMPEST or EmSec, not in just the &#8220;passive&#8221; way but the &#8220;active&#8221; way as well and importantly the ways you manage it and how they relate to managing complexity.</p>
<p>You make the point about &#8220;in a single persons head&#8221; this has been discussed before on this blog and it&#8217;s been repeatedly pointed out that our computing needs are beyond this &#8220;strip back to basics&#8221; idea which from one perspective (supposed efficiency) is true. However it&#8217;s not the only game in town and it is also an evolutionary culdersac as the likes of Intel have realised [2]. The solution is to manage complexity by divide and concour. That is you have one &#8220;function&#8221; per computer and strongly controled choke points between them. In this way a single person can hold the design of each striped down computer, switching buss and control buss and hypervisor in their head.</p>
<p>I&#8217;ve discussed this in the past as part of Castels-V-Prisons and it follows on from the logical design prrocess of the highest security systems.</p>
<p>Whilst you are considering this think carefully about the purpose an MMU has and what advantages this can give you in a multi CPU+MMU system with common memory BUT where the MMU is not controled by the attached CPU but a security Hypervisor.</p>
<p>[1] The reason for this as history clearly shows contrary to the impression some spy stories may give, in general the Inteligence Services &#8220;officers&#8221; don&#8217;t get involved with the &#8220;risk&#8221; of actual &#8220;spying&#8221;. That&#8217;s what the expendable MICE driven &#8220;agents&#8221; and &#8220;contractors&#8221; are for. The officers mearly act as middle men passing orders down to the operatives and the resulting intel &#8220;product&#8221; from these &#8220;methods and sources&#8221; operatives up to the &#8220;analysts&#8221;. The analysts then do what is in effect &#8220;investagative journalism&#8221; and produce the refined and sanitised &#8220;intel&#8221; that gets used by those in government or other Inteligence Service departments/compartments.</p>
<p>[2] As a broad overview the Intel x86 design started when Complex Instruction Set Computers (CISC) became viable due to reductions in transistor size on chips. At that time the opposit aproach of Reduced Instruction Set Computing (RISC) was the vogue for high performance computing which became multi CPU for Cray and IBM. Sun purchased the rights to Cray&#8217;s switching techniques and the Sun StarFire series of computers became the way to go until clustering took off. Intel stuck with CISC for quite some time but as problems increased they first switched to an internal Harvard design with seperate data and instruction caches, and eventually even they had to do a wolf in sheeps clothing where by they wrapped a RISC core in CISC clothing. But as we see now even that idea is nolonger cutting the mustard so Intel has gone down the multi core process quite late in the day as the reduction in transistor size and other chip fab techniques have made it viable. More interestingly perhaps is what has happened to Intel&#8217;s main rival in core count Advanced RISC Machines (originaly Acorn Computers but spun off). ARMs RISC CPU pops up all over the place and some SOCs have not just multiple ARM cores but multiple computers with each CPU core having it&#8217;s own seperate RAM and IO, in what is effectivly &#8220;clustering on a chip&#8221;.</p>
<p>[]</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204147">

			<div class="comment by-rolf-weber ">

				<p class="commentcredit">

					<span class="commenter">Rolf Weber</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204147">
						September 15, 2013 4:03 AM					</a>

				</p>

				<blockquote><p>
  Rolf Weber: that one&#8217;s easy: direct access for NSA toadies like Google, Microsoft, et<br />
  al., MITM for some minor pesthole (small company mail server, etc.) that hasn&#8217;t been<br />
  properly pwned yet.
</p></blockquote>
<p>The report was about a MITM against <em>Google</em>.</p>
<blockquote><p>
  I wonder how much Googles cooperation with the NSA is driven by the frustration<br />
  with trying to keep them out of the loop.
</p></blockquote>
<p>Consider the time flow: The reports said the &#8220;direct access&#8221; was established before the attacks.</p>
<p>No guys, there is only one logical explanation: The &#8220;direct access&#8221; story was a lie.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204148">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204148">
						September 15, 2013 4:16 AM					</a>

				</p>

				<p>@ Nick P,</p>
<ul><i>Many software errors are removed by giving programmers higher abstractions. However, the safer software platforms keep having trouble at the lower level stuff the language assumptions ignore or which is right at an abstraction boundary. The obvious solution is to raise the hardware&#8217;s level of abstraction/operation up to reflect what we&#8217;re trying to do with it. Not to mention, it&#8217;s better to work on screws with a screwdriver rather than an old hammer</i></ul>
<p>The problems with &#8220;obvious solutions&#8221; is whilst they might be right in the short term they are often wrong in the long term (as I commented above in my sub 1 Intel fell into this trap a number of times).</p>
<p>I&#8217;ve mentioned before the Unix idea of pipelining small special function programs in interpretive shell scripts as being a possability for decreasing hardware complexity whilst also increasing security whilst also increasing code cutter productivity. All of which are desirable outcomes, the downside being that it&#8217;s some what slower on any given platform (the reality of which is it usualy does not matter).</p>
<p>In effect you do what Intel did when switching from a CISC to RISC core, you wrap a layer around the core in essence dressing a wolf up to look like a sheep.</p>
<p>This wrap can be hardware, microcode, byte code or executable programes it does not matter. They are all interpreters, they are all less efficient than working at the layer below, however that is irrelavant all that matters is the wrap is secure in it&#8217;s own right.</p>
<p>Importantly we know that software bugs are more proportianate to lines of code than they are to the complexit of what each functional instruction has. Thus there are significant &#8220;code cutter&#8221; advantages to having as higher level of code as possible in terms of both bug minimisation and increased productivity. It also makes code easier to review as well.</p>
<p>So at the highest level you have a machine with what is in effect a striped down interpreter (like the Unix reduced shell) and a file of very high level interpreter code that pipelines data throuch executable code functions but does not have a compiler etc to write the executable code.</p>
<p>The executable code is written not by jobbing code cutters but by experienced secure code developers via formal methods which goes through independant accreditation for both security and formal function. However the addition is another file for the hypervisor that monitors the data paths between functions looking for limits and exceptions to the data formats as well as ensuring data is segregated correctly against function. Thus for instance data taged as an encryption key could not go to any place that was not formaly identified in that file as a port on a function being both capable of and authorised to receiving that data type.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204149">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204149">
						September 15, 2013 5:30 AM					</a>

				</p>

				<p>@ Mike the goat,</p>
<ul><i>I can also think of numerous ways bias could be introduced into any one of these aforementioned designs. Is there such a thing as a perfect TRNG?</i></ul>
<p>The simple answer &#8220;not that I&#8217;ve seen&#8221;.</p>
<p>And to be quite honest part of the reason is the definition we glibly say &#8220;True Random&#8221; but what do we mean? Usually we realy mean &#8220;unpredictable&#8221; or more correctly &#8220;non determanistic&#8221; but in turn what does that mean? When you consider limited knowledge of determanistic processes and our inability to have full knwoledge, not just as a human limitation but a hard limitation on computing and physics.</p>
<p>Apparently Einstien like many scietists of his time did not believe in what we now call quantum mechanics and the effect it has on the world. In effect he actualy believed that everything was fully determanistic and thus &#8220;pre-ordained&#8221;. Which in turn means that we run like trains on a track and have no free will to chose our own direction. Thus there could be no random only that which we could not predict due to our limitations of information and comprehension.</p>
<p>But Heisenberg amongst others gave rise to the notion that it was not possible to know everything that there are fundemental limits, in that the more precisley we know one measure of a particle (ie its position) the less certain we became on another (ie it&#8217;s momentum). Thus our knowledge is both finite and probabalistic in nature.</p>
<p>Few scientists these days have any trouble with the notion of free will and most physicists whilst they may not be comfortable with it accept the ideas of the quantum world and are fully paid up card carrying members of the &#8220;Shut up, sit down and calculate&#8221; club. And thats the part of the problem our view of the quantum world is not one based on what we can see and touch but what our statistical models tell us.</p>
<p>We thus have no way of determaning if an individual bit or number is &#8220;random&#8221; or &#8220;determanistic&#8221; by observation, only if it falls near or on a statistical line when compared to many individual values so far observed.</p>
<p>So we have a series of determanistic tests that get ever more complex. The simplest being we read out X bits from the generator and we expect to get X/2 zero bits and X/2 one bits. We then go to two bit values and expect them to fall as X/4 in frequency and so on. Obviously the more tests the generator passes the more likely it is to be a &#8220;random&#8221; number generator of some form. But it&#8217;s quality can only be witnessed by passing tests, as there is no one difinitive test by which it can be said to be &#8220;non-determanistic&#8221;. And as we know we can develop determanistic sequences that pass all tests that don&#8217;t have specific knowledge of the determanistic process</p>
<p>However there is an issue that differentites TRNGs from PRNGs which is when a value appears next. The easiest way to visualise it is the generator is an urn filled with balls &#8211;the number of which is defined by the generator internal state size&#8211; into which you put your hand and draw a ball to get a value. The difference is what you do with the ball you&#8217;ve drawn, do you put it back (TRNG) or do you leave it out (PRNG). From just examining the drawn balls it&#8217;s not initialy possible to tell the two generators appart. But after a sufficient number of balls have been drawn the abcence of any repeate balls drawn enables you to say with some confidence that it&#8217;s a PRNG not a TRNG. However this test can be mitigated simply by having non unique values on the balls, or putting such a number of balls into the urn it is not possible in a realistic time period to draw out sufficient numbers of balls to have confidence in a prediction.</p>
<p>So the real answer is we can not test for a TRNG in any meaningful way in a realistic time period and providing our models of quantum mechanics don&#8217;t change we never will.</p>
<p>Which leaves the question of bias, if a signal of sufficient level is injected into a TRNG source we know that by a process called &#8220;injection locking&#8221; the source can be pulled into synchronisation with the signal, if this signal contains no bias then the output of the TRNG will show no bias. If however the injection signal is insufficient to achive locking it&#8217;s effect may be seen on the TRNG source output as addative or multiplative noise this may cause bias to appear on the TRNG output. This is why in a good TRNG the output of the source buffer prior to any bias removal circuitry should be made available for testing on a spectrum analyser in waterfall mode or more complex test unit. The reason for this might sound odd, but all usable sources will either be biased or show bias from time to time simply due to the nature of noise. If that bias is not there or to large or changes in some way then it&#8217;s an indication the source is failing in some way.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204150">

			<div class="comment by-backdoornation ">

				<p class="commentcredit">

					<span class="commenter">BackdoorNation</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204150">
						September 15, 2013 5:35 AM					</a>

				</p>

				<p>I&#8217;ve been saying for years that NSA was doing this.  I said that NSA most certainly owns various CA&#8217;s (or clandestinely ran their own, which is much easier) and people called me paranoid.  The CIA, for instance, is quite expert in running faux corporations or businesses and using them as fronts for intelligence activities (mostly in foreign countries).  NSA could easily do the same with something like a CA.</p>
<p>Like Bruce always says, being a good security person requires thinking of how to break systems in unique ways.  Well, CA subversion is not unique, but is flat-out common sense.  We&#8217;ve known for years how big of a joke the CA chain of trust was, with some CA&#8217;s even giving out root certs for free and others selling them to various corporations who had no business needing a root cert.  Not to mention all of the hacks of the various CA&#8217;s.   Get one root or intermediary cert and you own the PKI, at least until someone bothers to check.</p>
<p>A lot of people sort of shunned this idea because they said MITM is hard to perform without getting caught.  That might be true for Joe Sixpack script kiddie.  But when you are NSA and literally <em>own</em> the backbone of the Internet with fiber taps, you can do as you damn well please and it will be hard for anyone to figure it out.</p>
<p>The CA and the MITM problems can be resolved.  Of course, it will take industry 10 years to implement fixes we already have (for instance, why are we still using decrepit TLS versions from 5-6 years ago?  It&#8217;s preposterous, but IT security has always moved at a snail&#8217;s pace).</p>
<p>But what is more concerning is the subversion of hardware.  I will bet my bottom dollar that NSA has their own circuits built into Intel/AMD processors.  With all of the widespread collusion we have seen from American tech companies with NSA (thanks to Snowden), it would be surprising if there <em>weren&#8217;t</em> such backdoors in commodity hardware.  If I worked for NSA, this is exactly what I&#8217;d be spending money and time on doing.  Screw breaking crypto.  You don&#8217;t <em>need</em> to when you own the hardware.</p>
<p>This is one reason I am highly suspicious of Intel&#8217;s latest RNG implanted on their CPU&#8217;s (Bull Mountain with the RDRAND API).  Intel reps tried to recently convince Theodore Ts&#8217;o (the guy who created /dev/random module on Linux) to make it the <em>default</em> entropy input into the kernel.  Ts&#8217;o said no thanks, but Linus Torvalds is calling people &#8220;idiots&#8221; who think Intel is up to no good.  I&#8217;m not sure who won that battle, but obviously Linus&#8217;s decision is final.</p>
<p>You know what they say: those who accuse a significant other of cheating for no good reason are usually guilty of it themselves (those who bark the loudest and all that).  If you will recall, earlier this year it came out that NSA was accusing Huwaei and Lenevo of putting backdoors in it&#8217;s hardware.  Most of their reasoning for believing this was &#8220;classified,&#8221; of course, even though it would benefit American companies if we all knew more details (but classification trumps all when talking about the NSA).  I suspect NSA is so suspicious of China because they know that they do the same damned things to American products.</p>
<p>I read an article recently where a professor of computer science who specializes in chip fab designs said she has had personal talks with various NSA people (off the record) who said that NSA has spent a lot of money researching hardware backdoors.  She said they have put a lot of foreign made COTS hardware under thorough analysis in their labs.  This is probably how they discovered that Lenevo PC&#8217;s were compromised and is why they have told all &#8220;5 eyes&#8221; allies not to use Lenevo products in classified networks.</p>
<p>So, I ask you, dear reader, do you not think an agency with NSA&#8217;s budget, expertise, and lab equipment could use this knowledge for their own nefarious purposes?</p>
<p>So what&#8217;s my point?  I hate to say it, but it&#8217;s come to the point that even non-paranoid people are having to wake up to the fact that we can&#8217;t trust anything electronic (at least not if you care about government snooping).  Even Adi Shamir said at RSA this year that cryptography is basically dead &#8212; not because it isn&#8217;t an interesting or important field, but because it simply doesn&#8217;t matter when you can&#8217;t trust anything else about your security.</p>
<p>I would like to see public researchers and academics take a stand and start their own standards groups, and most importantly, start their own open hardware initiatives (nothing else matters if the hardware isn&#8217;t clean).  Will it happen?  Probably not.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204151">

			<div class="comment by-mile-acker ">

				<p class="commentcredit">

					<span class="commenter">mile acker</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204151">
						September 15, 2013 6:04 AM					</a>

				</p>

				<p>if we concede that the bad guys &#8212; whoever they may be &#8212; will be able to access information from any on line computer then the obvious counter is to make sure whatever it is they take is of no value</p>
<p>setting up a crypto machine with an air gap to the online machine is not difficult, nor is setting up a Vernam Cipher program</p>
<p>when the beast can&#8217;t read your cipher he may get mad though. so when the black van shows up that is when you will need the Kalashnikov</p>
<p>Better to escape before that.  I hear John McAffee is looking for people to play poker ( bring money )</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204152">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204152">
						September 15, 2013 6:46 AM					</a>

				</p>

				<p>@BackdoorNation &#8211; indeed the battle between Torvalds and T&#8217;so got quite heated I believe, perhaps it wasn&#8217;t quite as caustic on lkml but T&#8217;so himself said that it was a significant bone of contention. If my memory serves me right he eventually reverted the code as a compromise where it would use RdRAND to seed the entropy pool (along with other inputs) instead of relying on it directly. This seems like a reasonable enough compromise given that even if the hardware RNG is backdoored it is being used only as one of a diverse range of inputs into the software PRNG. Interestingly enough T&#8217;so wrote a <a href="https://plus.google.com/app/basic/117091380454742934025/posts?cbp=1edalzfyhjpka&amp;sview=25" rel="nofollow ugc">Google+ post</a> a week back saying that in light of the NSA scandal that he feels vindicated.</p>
<p>@Stanislav &#8211; I agree wholeheartedly re PC owner being viewed as an adversary. We /own/ the damn thing. This is why DRM is a huge mistake.</p>
<p>@jon &#8211; These kind of exploitative porn are abhorrent but I do think there shouldn&#8217;t be any content that is illegal to merely view. Data is data. The idea that there are URLs you can conceivably enter in someone&#8217;s browser that will get someone investigated and potentially jailed is scary. Not that I am defending those legit offenders. Absolutely go after, prosecute, castrate etc those producing and uploading sickening material but the laws on accessing material are poorly implemented and have been used to frame innocent people in the past. Those who have open wireless networks, run proxy exit nodes or otherwise share internet are at risk of their lives being systematically destroyed even if there is ultimately never a conviction. Those browsing internet pornography sites can inadvertedly stumble upon illegal content through following links that may not necessarily reveal their true nature or through pop ups. What better way for the gov&#8217;t (or a business rival) to destroy someone than to download some illegal material (using either physical access or a remote exploit), dump it on your HDD and then start a p2p server to start pushing it out to the world. It would only be a matter of time before they were imprisoned. Never mind the fact that even those who are actually deliberately looking t anything sick (and this includes &#8216;shock&#8217; pictures of autospy photos etc) are basically just kids themselves and are just fulfilling our basic human curiosity to see the worst the internet has to offer. I have no doubt that &#8211; when properly targeted this intelligence probably gets genuinely sick people off the streets who were a genuine threat to the young or otherwise defenseless but at what cost to civil liberties, especially those scenarios mentioned where it is a legitimate false positive. Nothing is more repugnant or polarizing than these kind of accusations which is why law enforcement needs to get it right and make sure they are fsnn right before destroying someone&#8217;s career, marriage and liberty.</p>
<p>@Clive &#8211; Thank you for your detailed response.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204153">

			<div class="comment by-stanislav-datskovskiy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.loper-os.org' rel='external nofollow ugc' class='url'>Stanislav Datskovskiy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204153">
						September 15, 2013 9:36 AM					</a>

				</p>

				<p>Heads-up to anyone who posts a link to a WordPress blog here: an apparent botnet will chug away for many hours trying to brute-force your login.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204154">

			<div class="comment by-nameless ">

				<p class="commentcredit">

					<span class="commenter">nameless</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204154">
						September 15, 2013 12:18 PM					</a>

				</p>

				<p>@RobertT</p>
<blockquote><p>
I wonder how much Googles cooperation with the NSA is driven by the frustration with trying to keep them out of the loop.
</p></blockquote>
<p>I cannot claim to know but Julian Assange seems to be of the opinion that Google works with the government because they want to show <i>&#8220;Washington that Google can be its partner, its geopolitical visionary, who will help Washington see further about America’s interests. And by tying itself to the US state, Google thereby cements its own security, at the expense of all competitors.&#8221;</i></p>
<p>According to some emails leaked from Stratfor, Google is involved in sponsoring uprisings in some countries abroad, and this is supposedly because they are able to get away with stuff that the US government cannot officially touch.</p>
<p>Source:<br />
<a href="http://www.wikileaks.org/Op-ed-Google-and-the-NSA-Who-s.html" rel="nofollow ugc">Google and the NSA: Who’s holding the ‘shit-bag’ now</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204155">

			<div class="comment by-nameless ">

				<p class="commentcredit">

					<span class="commenter">nameless</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204155">
						September 15, 2013 12:25 PM					</a>

				</p>

				<p>and whilst on subject of Google:</p>
<p><a href="http://blogs.computerworld.com/android/22806/google-knows-nearly-every-wi-fi-password-world" rel="nofollow ugc">Google knows nearly every Wi-Fi password in the world</a></p>
<blockquote><p>
If an Android device (phone or tablet) has ever logged on to a particular Wi-Fi network, then Google probably knows the Wi-Fi password. Considering how many Android devices there are, it is likely that Google can access most Wi-Fi passwords worldwide.<br />
[&#8230;]<br />
Many (probably most) of these Android phones and tablets are phoning home to Google, backing up Wi-Fi passwords along with other assorted settings. And, although they have never said so directly, it is obvious that Google can read the passwords.<br />
[&#8230;]<br />
Android devices have defaulted to coughing up Wi-Fi passwords since version 2.2. And, since the feature is presented as a good thing, most people wouldn&#8217;t change it. I suspect that many Android users have never even seen the configuration option controlling this. After all, there are dozens and dozens of system settings to configure.<br />
[&#8230;]<br />
Specifically:</p>
<p>In Android 2.3.4, go to Settings, then Privacy. On an HTC device, the option that gives Google your Wi-Fi password is &#8220;Back up my settings&#8221;. On a Samsung device, the option is called &#8220;Back up my data&#8221;. The only description is &#8220;Back up current settings and application data&#8221;. No mention is made of Wi-Fi passwords.<br />
In Android 4.2, go to Settings, then &#8220;Backup and reset&#8221;. The option is called &#8220;Back up my data&#8221;. The description says &#8220;Back up application data, Wi-Fi passwords, and other settings to Google servers&#8221;. </p>
<p>Needless to say &#8220;settings&#8221; and &#8220;application data&#8221; are vague terms. A longer explanation of this backup feature in Android 2.3.4 can be found in the Users Guide on page 374:</p>
<p>Check to back up some of your personal data to Google servers, with your Google Account. If you replace your phone, you can restore the data you’ve backed up, the first time you sign in with your Google Account. If you check this option, a wide variety of you personal data is backed up, including your Wi-Fi passwords&#8230;
</p></blockquote>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204156">

			<div class="comment by-dirk-praet ">

				<p class="commentcredit">

					<span class="commenter">Dirk Praet</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204156">
						September 15, 2013 12:58 PM					</a>

				</p>

				<p>@ Clive, Nick P, RobertT, Mike the goat, Stanislav Datskovskiy</p>
<p>Thanks for your enlightning posts on secure systems/hardware. These are the kind of discussions that got me on Bruce&#8217;s blog and that keep me come back.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204158">

			<div class="comment by-rhialto ">

				<p class="commentcredit">

					<span class="commenter">Rhialto</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204158">
						September 15, 2013 7:43 PM					</a>

				</p>

				<p>Re attack via hard drive firmware: at OHM 2013 there was a lecture titled &#8220;Hard disks: More than just block devices&#8221; (<a href="https://program.ohm2013.org/event/67.html" rel="nofollow ugc">https://program.ohm2013.org/event/67.html</a>). It was recorded and can be viewed here: <a href="http://bofh.nikhef.nl/events/OHM/video/d2-t1-13-20130801-2300-hard_disks_more_than_just_block_devices-sprite_tm.m4v" rel="nofollow ugc">http://bofh.nikhef.nl/events/OHM/video/d2-t1-13-20130801-2300-hard_disks_more_than_just_block_devices-sprite_tm.m4v</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204159">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204159">
						September 15, 2013 10:16 PM					</a>

				</p>

				<p>Stanislav Datskovskiy<br />
<i> I doubt that any of us here are worthy of such treatment</i><br />
&#8211;Uh, I wasn&#8217;t worthy of it but I still received it (and it still lingers&#8230;) I can confirm some of the so-called &#8220;way too expensive&#8221; attacks; bluetooth in particular.  Physically accessing your devices is the end all though; do you like to sleep?  I&#8217;ve seen the van too, unmarked; and other devices.  They will move in next door to you if they haven&#8217;t already, so be sure to welcome the new neighbors.  Well, they can&#8217;t figure out [one] of my means of countering, I even blurted it out in the clear to shove it in their face.  I also stated that there are possibilities of the brain that enable some capabilities that will blow their mind (useful to determine which girl likes you as a kid) and it&#8217;s like magnetic field, that will remain a secret too.  I didn&#8217;t deserve the treatment I got and they created a lifelong enemy, my own gov&#8217;t&#8230;</p>
<p>BackdoorNation<br />
<i>I would like to see public researchers and academics take a stand and start their own standards groups, and most importantly, start their own open hardware initiatives (nothing else matters if the hardware isn&#8217;t clean)</i><br />
&#8211;Oh how many dreams I&#8217;ve had&#8230;I really think it&#8217;s time and that young engineers need to see this.  Eventually the old farts die.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204160">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204160">
						September 15, 2013 10:23 PM					</a>

				</p>

				<p>RobertT<br />
&#8211;If I ever manage to scrunge up enough to start up my own fab lab, there will be a hell of a fight to subvert my lab.  How do they even verify all the transistors?  They don&#8217;t, always a failure. They&#8217;re just as insecure as us, idiots.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204161">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204161">
						September 15, 2013 10:56 PM					</a>

				</p>

				<p><a href="http://www.righto.com/2013/09/intel-x86-documentation-has-more-pages.html" rel="nofollow ugc">http://www.righto.com/2013/09/intel-x86-documentation-has-more-pages.html</a></p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204162">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204162">
						September 15, 2013 11:07 PM					</a>

				</p>

				<p>@nameless &#8211; This is precisely why I don&#8217;t do <em>anything</em> trusted on my android device. I have no doubt that in an implementation as clumsy as android there is bound to be numerous remotely exploitable flaws in addition to the possibly deliberately placed ones (CarrierIQ anyone?). It would be really convenient for me to install GNUPG on my cellular phone but I have resisted the temptation. The closest I may come is generating a subkey which I will mark in the comments as being of low trust, e.g. &#8220;Low trust key used on cell for signing. Don&#8217;t encrypt to this ID&#8221; and use it strictly for signing purposes. Hopefully people will understand that it carries only mild trust, especially considering that cells can also go &#8220;wallies&#8221; uh, get stolen and android&#8217;s &#8220;security&#8221; is a misnomer. Even FDE is silly as phones are always left on and the key left in RAM.</p>
<p>@Stanislav &#8211; why doesn&#8217;t that surprise me? I would guess that script kiddies love pages like these where many security oriented people &#8211; some very well known. What better way to get kudos from their pimply friends on 4chan than owning a security researcher&#8217;s blog? Guess if you talk the talk, you&#8217;re expected to walk the walk.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204163">

			<div class="comment by-daveyjones ">

				<p class="commentcredit">

					<span class="commenter">DaveyJones</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204163">
						September 16, 2013 9:16 AM					</a>

				</p>

				<p>Mike,</p>
<p>&#8220;Even FDE is silly as phones are always left on and the key left in RAM.&#8221;</p>
<p>Valid, but there are times when there is time to shut it down. The most likely scenario is a traffic stop &#8211; FDE and shutting down, guards against a Cellebrite device.</p>
<p>Also, while at home &#8211; but this depends if you have other security to warn of &#8220;uninvited guests&#8221; &#8211;  cameras, dog, etc&#8230;</p>
<p>FDE isn&#8217;t entirely useless on phones.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204164">

			<div class="comment by-mike-the-goat-now-with-added-horns ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat (now with added horns)</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204164">
						September 16, 2013 9:41 AM					</a>

				</p>

				<p>@DaveyJones &#8211; if I had a few minutes before the feds knocked in my door my cell would be going in the wood stove 😉 if it had even a kilobyte of potentially incriminating data on it (encrypted or otherwise). I do not trust a kernel compiled by a proprietary cellular manufacturer or even worse a carrier to do &#8220;the right thing&#8221;. For all we know their dm-crypt might be subtly leaking the key. But yes, I appreciate that FDE has some benefit. The problem is that the end user (who is often uneducated) isn&#8217;t aware of the limitations and the potential for the code to be (deliberately or inadvertently) broken. Ethically android should produce an EULA style dialog that requires you to page to its end before being dismissable before the user enables FDE explaining that a) the code may contain vulnerabilities b) no cipher is immune to brute force attacks on the passphrase c) in some jurisdictions you may be compelled to provide your key, and failure to do so can be an imprisonable offense [e.g. UK] d) FDE implementations are vulnerable to cold boot style attacks e) all your bases belong to Google.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204165">

			<div class="comment by-daveyjones ">

				<p class="commentcredit">

					<span class="commenter">DaveyJones</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204165">
						September 16, 2013 10:39 AM					</a>

				</p>

				<p>Again, I agree with a lot of what you just posted. The bottom line is that very few will <em>not</em> carry a phone. For the few of us that know security, to me, buying a Nexus device, installing an Android Open Source Project ROM, and going pre-paid, is the best way to go.</p>
<p>Remove permissions from ADB, re-lock the bootloader, firewall it (especially any GPS services), secondary container encryption, Tor/VPN, Gibberbot, etc&#8230;</p>
<p>It&#8217;s either not carry a phone, or do what you can, with what you are given</p>
<p>But yeah, non-nerds need not apply, and you are spot on for the masses.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204166">

			<div class="comment by-stanislav-datskovskiy ">

				<p class="commentcredit">

					<span class="commenter"><a href='http://www.loper-os.org' rel='external nofollow ugc' class='url'>Stanislav Datskovskiy</a></span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204166">
						September 16, 2013 10:59 AM					</a>

				</p>

				<p>At present, the best defense is the one which seems to work for most of us: <i>being uninteresting</i>.</p>
<p>The fellow in the black van doesn&#8217;t work for free.</p>
<p>But this is rather like recommending anorexia as a defense against cannibals. It might work, for so long as your are skinnier than the cannibals are hungry.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204167">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204167">
						September 16, 2013 9:25 PM					</a>

				</p>

				<p>Stanislav Datskovskiy<br />
&#8211;The van can be gray too.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204168">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204168">
						September 16, 2013 9:34 PM					</a>

				</p>

				<p>Being uninteresting works wonders too; Idk though, there was a pretty hot chick the other day in the MAC (math assistance center) lol.  Well they definitely won&#8217;t be in some other labs lol.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204169">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204169">
						September 17, 2013 2:40 AM					</a>

				</p>

				<p>@ Figureitout,</p>
<ul><i>&#8211;The van can be gray too</i></ul>
<p>Or white 🙂</p>
<p>In the UK we have an expression &#8220;White van man&#8221; due not just to the vast numbers of white vans, but also in part to some percentage of the drivers of these white vans driving either recklessly, illegaly or out right dangerously. As well as some of them being near grey with dirt sufficient for others to write comments in that critique the van&#8217;s driver&#8217;s abilities with a somewhat barbed witisism&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204170">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204170">
						September 18, 2013 12:22 AM					</a>

				</p>

				<p>Clive Robinson<br />
&#8211;Yeah, or have false logos.  I remember their plate #&#8217;s and driver faces anyway to track down when I feel like it.  Plus I love seeing spooks passing my house as I&#8217;m mowing the lawn, found another &#8220;stash house&#8221; near me; will have to check it out too I guess.  One individual even parked backwards in a pitiful attempt to hide his plates, haha, got&#8217;em anyway and his face and his residence.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204171">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204171">
						September 18, 2013 5:28 AM					</a>

				</p>

				<p>@figureitout &#8211; I am not going to suggest you are not being surveiled but it is quite common for people to be unsettled by the first discovery to the point that they start becoming paranoid and find data to support their hypotheses. Unless you are a particularly high value target government surveillance in &#8216;meatspace&#8217; is typically of short duration and typically hard to detect. They certainly don&#8217;t need the SIGINT vans they used to use anymore. A HSUPA DC equipped bug aggregator can push a day of G729 compressed audio surveillance in under a minute. In fact the longest delay is network association. It is common for them to burst data out like this to reduce their chance of detection. There are self contained devices that replace a standard wall socket and include both a sensitive mic and UMTS transmitter and there are standard bugs that are designed to be littered throughout the place that phone home to the hidden aggregator. I have even seen low energy listening devices powered by zinc/air cells that can last for weeks without an external power source.</p>
<p>My point is &#8211; if you are being surveiled by the pro&#8217;s you won&#8217;t see a telltale van sitting around, nor will they need to move next door (although I have heard of this, particularly in apartment buildings). Now local law enforcement might be a different story. I know many still do it the old fashioned (and legal) way, with stake outs and tailing. The pro&#8217;s will likely use your vehicle&#8217;s GSM radio (OnStar equipped vehicle) and your personal cell to keep tabs on you and won&#8217;t need to physically follow you.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204172">

			<div class="comment by-figureitout ">

				<p class="commentcredit">

					<span class="commenter">Figureitout</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204172">
						September 18, 2013 7:27 PM					</a>

				</p>

				<p>Mike the goat<br />
&#8211;It&#8217;s ok, you don&#8217;t know my situation so you can think what you will.  It was a really stupid investigation and I wanted to make that extremely clear.  I made some slip ups but overall my methods remain secure.  It was both, local law enforcement was truly a joke; extremely easy.  The &#8220;pros&#8221;, lol; I taught myself my skills since I was a kid and got bullied so it was my revenge since it was generally a group of kids who would otherwise beat me up by myself.  Obviously it&#8217;s not like they&#8217;re tailing me like that, no; it&#8217;s used to transport equipment.</p>
<p>I made sure to eat plenty of taco bell for the bugs too; I didn&#8217;t really care about them, I can do it too&#8230;</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204173">

			<div class="comment by-clive-robinson ">

				<p class="commentcredit">

					<span class="commenter">Clive Robinson</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204173">
						September 19, 2013 8:41 AM					</a>

				</p>

				<p>@ Mike the goat, Figureitout,</p>
<p>Being under the &#8220;eye&#8221; or suspecting so is very moraly corrosive, look up &#8220;long gun fear&#8221; it can cause an entire batalion to become ineffective. Or look back to the times of &#8220;The Washington Sniper&#8221;.</p>
<p>The behaviour people emitt at such times looks, tastes and feels like paranoia but it&#8217;s actualy not it&#8217;s actually an inbuilt protection system in your acient &#8220;monkey brain&#8221; to make you run up a tree when things just don&#8217;t quite add up. People who are more sensitive to &#8220;something odd&#8221; in the environment have the makings of &#8220;prey that survives to mate&#8221; or in modern parlance has the makings of &#8220;good situational awarness&#8221;. It&#8217;s something several thousand years of &#8220;soft social living&#8221; has been breeding out of humans.</p>
<p>And it can all go wrong through no fault of your own and others.</p>
<p>A friend of mine from years back invested his Army Leaving pension money into a property or two figuring not incorrectly that the financial industry were a bunch of crooks.</p>
<p>One property was in a part of West London close to Wilsden, a not particularly &#8220;good area&#8221; but improving. It was in a block of flats, but unknown to him and his tennant a number of the other properties had been taken over for a drug growing farm. His &#8220;something hinky&#8221; alarm was going full tilt and he was certain he wass being followed.</p>
<p>Now when it comes to field craft following people is a real art that few are any good at especialy if they don&#8217;t think about a &#8220;check tail&#8221; who folows on behind a principle to see if people are acting in a way that indicats they may be following the principle. Check tails are almost always impossible to spot if they are even half way good at their job and those that do surveilance know it&#8217;s safer to get a &#8220;man inside&#8221; than it is to follow people around.</p>
<p>So my friend asked me to check his tail, I aranged for him to walk slowly past a well known fast foodd outlet that had seating in the window and sure enough he had three people following him which was odd. So I decided to follow the last one and note where he ended up when my friend ditched the tails on a pre aranged signal. Well the last one on being ditched made a phone call and walked back to a point where he was picked up buy a couple of similar types. The car registration matched onethat was seen parked down the road from the flat quite often.</p>
<p>So a few days later I photographed all the tails to get nice clear face shots and printed them out A4 size and poped them in an envolope along with a few photos of the car and put a pole job up to watch the car. Sure enough about six different people used the car on &#8220;turn about&#8221; and 8 identified the property they were using which overlooked the block my friends flat was in. So the photos and a pice of paper with &#8220;who&#8217;s watching the watchers&#8221; in it was hand delivered to the property on the next turn about by my friend who then went and sat on a wall on the other side of the road and just waited. It took about half an hour for the crap to hit the fan. Needless to say they were not happy bunnies.</p>
<p>Any way they had another problem, theyed been blown but the other tails were unacounted for&#8230; Any way the upshot was a &#8220;drugs bust&#8221; two days later and all the tails disapeared.</p>
<p>We checked for tails again a couple of times later and did full sweeps with thermal and non linear equipmet of his home and office and did cell checks etc. and they all came up clean. But he has become more cautious and does a lot off basic OpSec field craft now including ditching the car and mobile and paying for a call taking service, and getting proper security in place. Oh and he gets on well with the local police as well they say hello and smile and he smiles back and is on first name terms with some of the more experianced ones</p>
<p>Is he now paranoid, not realy just more cautious and it&#8217;s payed off as the improved security has stopped a couple of break ins before much damage ws done and nothing got stolen and his tennants like the extra security as it makes them feel safer oh and his insurance costs are quite a bit lower as a result. Oh and he&#8217;s a lot fitter as well ditching the car in favour of a push bike gets him around faster as well as no more parking tickets or &#8220;congestion charge&#8221;.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment odd alt thread-odd thread-alt depth-1" id="comment-204174">

			<div class="comment by-mike-the-goat ">

				<p class="commentcredit">

					<span class="commenter">Mike the goat</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204174">
						September 22, 2013 4:41 AM					</a>

				</p>

				<p>Figureitout: wasn&#8217;t attacking you personally. I am aware how being surveilled makes one paranoid and was merely pointing out that I have personally observed people who remain convinced they  are being tailed years after the surveillance has ceased.</p>
<p>Clive: agreed, and that was the point I was driving at. Sometimes the unease and paranoia such intense surveillance and scrutiny generates can be worse than the initial &#8220;seed&#8221; that planted the suspicions in the first place. This is used to great effect by organized crime outfits who run a protection racket &#8211; &#8220;watch your back, you never know when we will strike if you refuse to pay&#8221; etc.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

		<article class="comment even thread-even depth-1" id="comment-204175">

			<div class="comment by-kimani ">

				<p class="commentcredit">

					<span class="commenter">Kimani</span> •

					<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/#comment-204175">
						October 1, 2013 9:52 AM					</a>

				</p>

				<p>This doesn&#8217;t surprise me at all. The world is turning into a virtual battlefield. No longer do nations need to take a large standing army to invade and topple a nation and/or government. In todays world it is much easier and vastly more efficient to have a government destroy itself and replace leadership. I&#8217;m not saying that&#8217;s what is going on here, but it always seems to start slow and non-threatening when agencies move into foreign contries to ply their arts to whatever bebefit they deem worthy. Its a scarey world out there. You have to be careful in everything you do cause it is all vulnerable to intrusion. Great article. I love to see the news that mainstream ALWAYS deems unworthy.</p>

				
			</div>

		</article>

		</li><!-- #comment-## -->

	<p class="subscribe-comments">
		<a href="https://www.schneier.com/blog/archives/2013/09/new_nsa_leak_sh.html/feed/">
			<img alt="Atom Feed" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png">
			Subscribe to comments on this entry		</a>
	</p>

		<div id="respond" class="comment-respond">
		<h2 class="comments-open-header">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/archives/2013/09/new_nsa_leak_sh.html#respond" style="display:none;">Cancel reply</a></small></h2><form action="https://www.schneier.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><a href="https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2013%2F09%2Fnew_nsa_leak_sh.html" title="Login">Login</a><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" /></p>
<p class="comment-form-url"><label for="url">URL:</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Remember personal info?</label></p>

<p class="comment-form-author">

	<label for="comm_capt_challenge">
		Fill in the blank: the name of this blog is Schneier on ___________ (required):	</label>

	<input id="comm_capt_challenge" name="comm_capt_challenge" size="30" type="text" />
</p>

<div class="comment-form-comment">

	<label for="comment">Comments:</label>

	<textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea>

	<div id="preview-box" class="preview-box hide"></div>
	<img class="comment-loading hide" src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif" />

</div>

<p id="allowed">

	<strong>Allowed HTML</strong>
	&lt;a href=&quot;URL&quot;&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;
	<strong>Markdown Extra</strong> syntax via <a href="https://michelf.ca/projects/php-markdown/extra/">https://michelf.ca/projects/php-markdown/extra/</a>
</p>

<input type="hidden" id="wp_comment_nonce" name="wp_comment_nonce" value="4b1534b792" /><input type="hidden" name="_wp_http_referer" value="/blog/archives/2013/09/new_nsa_leak_sh.html" />
<input type="button" id="comment-preview" class="comment-preview comment-actions" value="Preview" />
<input type="button" id="comment-write" class="comment-write comment-actions hide" value="Edit" />

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit" /> <input type='hidden' name='comment_post_ID' value='5008' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p></form>	</div><!-- #respond -->
	
	<div class="stepthrough">
		<a href="https://www.schneier.com/blog/archives/2013/09/did_i_actually.html" rel="prev">← Did I Actually Say That?</a>		<a href="https://www.schneier.com/blog/archives/2013/09/radio_interview_2.html" rel="next">Radio Interviews with Me →</a>	</div>

	
<p id="powered">Sidebar photo of Bruce Schneier by Joe MacInnis.</p>
		</div>

		
<aside>
	<div class="sidebar" id="sidebar-two">
		<section><div class="sidesection widget widget_schneier_about" id="schneier_about-2"><h3>About Bruce Schneier</h3><img src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg" /><p><p class="small">I am a <a href="https://public-interest-tech.com/">public-interest technologist</a>, working at the intersection of security, technology, and people. I've been writing about security issues on my <a href="/">blog</a> since 2004, and in my monthly <a href="/crypto-gram/">newsletter</a> since 1998. I'm a fellow and lecturer at Harvard's <a href="https://www.hks.harvard.edu/faculty/bruce-schneier">Kennedy School</a>, a board member of <a href="https://www.eff.org/">EFF</a>, and the Chief of Security Architecture at <a href="https://inrupt.com/">Inrupt, Inc.</a> This personal website expresses the opinions of none of those organizations.</p>
</p></div></section><section><div class="sidesection widget widget_schneier_related_posts" id="schneier_related_posts-2"><h3>Related Entries</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/archives/2021/03/illegal-content-and-the-blockchain.html">Illegal Content and the Blockchain</a></li><li><a href="https://www.schneier.com/blog/archives/2021/03/national-security-risks-of-late-stage-capitalism.html">National Security Risks of Late-Stage Capitalism</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/weis-2021-call-for-papers.html">WEIS 2021 Call for Papers</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/ransomware-profitability.html">Ransomware Profitability</a></li><li><a href="https://www.schneier.com/blog/archives/2021/02/presidential-cybersecurity-and-pelotons.html">Presidential Cybersecurity and Pelotons</a></li><li><a href="https://www.schneier.com/blog/archives/2021/01/police-have-disrupted-the-emotet-botnet.html">Police Have Disrupted the Emotet Botnet</a></li>
</ul>
</div></section><section><div class="sidesection widget widget_schneier_featured_essays" id="schneier_featured_essays-2"><h3>Featured Essays</h3>
	<ul>
		<li><a href="https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html">The Value of Encryption</a></li><li><a href="https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html">Data Is a Toxic Asset, So Why Not Throw It Out?</a></li><li><a href="https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html">How the NSA Threatens National Security</a></li><li><a href="https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html">Terrorists May Use Google Earth, But Fear Is No Reason to Ban It</a></li><li><a href="https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html">In Praise of Security Theater</a></li><li><a href="https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html">Refuse to be Terrorized</a></li><li><a href="https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html">The Eternal Value of Privacy</a></li><li><a href="https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html">Terrorists Don&#039;t Do Movie Plots</a></li>	</ul>

	<p><a href="https://www.schneier.com/essays/">More Essays</a></p></div></section><section><div class="sidesection widget widget_schneier_archives" id="schneier_archives-2"><h3>Blog Archives</h3>
<ul>

	<li><a href="https://www.schneier.com/blog/calendar.html/">Archive by Month</a></li><li><a href="https://www.schneier.com/blog/newcomments.html/">100 Latest Comments</a></li></ul>

<h4>Blog Tags</h4><ul class="top-tags"><li><a href="https://www.schneier.com/tag/3d-printers/">3d printers</a></li><li><a href="https://www.schneier.com/tag/9-11/">9/11</a></li><li><a href="https://www.schneier.com/tag/aaron-swartz/">Aaron Swartz</a></li><li><a href="https://www.schneier.com/tag/academic/">academic</a></li><li><a href="https://www.schneier.com/tag/academic-papers/">academic papers</a></li><li><a href="https://www.schneier.com/tag/accountability/">accountability</a></li><li><a href="https://www.schneier.com/tag/aclu/">ACLU</a></li><li><a href="https://www.schneier.com/tag/activism/">activism</a></li><li><a href="https://www.schneier.com/tag/adobe/">Adobe</a></li><li><a href="https://www.schneier.com/tag/advanced-persistent-threats/">advanced persistent threats</a></li><li><a href="https://www.schneier.com/tag/adware/">adware</a></li><li><a href="https://www.schneier.com/tag/aes/">AES</a></li><li><a href="https://www.schneier.com/tag/afghanistan/">Afghanistan</a></li><li><a href="https://www.schneier.com/tag/air-marshals/">air marshals</a></li><li><a href="https://www.schneier.com/tag/air-travel/">air travel</a></li><li><a href="https://www.schneier.com/tag/airgaps/">airgaps</a></li><li><a href="https://www.schneier.com/tag/al-qaeda/">al Qaeda</a></li><li><a href="https://www.schneier.com/tag/alarms/">alarms</a></li><li><a href="https://www.schneier.com/tag/algorithms/">algorithms</a></li><li><a href="https://www.schneier.com/tag/alibis/">alibis</a></li><li><a href="https://www.schneier.com/tag/amazon/">Amazon</a></li><li><a href="https://www.schneier.com/tag/android/">Android</a></li><li><a href="https://www.schneier.com/tag/anonymity/">anonymity</a></li><li><a href="https://www.schneier.com/tag/anonymous/">Anonymous</a></li><li><a href="https://www.schneier.com/tag/antivirus/">antivirus</a></li><li><a href="https://www.schneier.com/tag/apache/">Apache</a></li><li><a href="https://www.schneier.com/tag/apple/">Apple</a></li><li><a href="https://www.schneier.com/tag/applied-cryptography/">Applied Cryptography</a></li><li><a href="https://www.schneier.com/tag/artificial-intelligence/">artificial intelligence</a></li><li><a href="https://www.schneier.com/tag/assassinations/">assassinations</a></li></ul><p><a href="https://www.schneier.com/blog/tags.html/">More Tags</a></p></div></section><section><div class="sidesection widget widget_schneier_latest_book" id="schneier_latest_book-3"><h3>Latest Book</h3><a href="https://www.schneier.com/books/click-here/"><img class="sidepic" alt="Click Here to Kill Everybody" src="https://149400697.v2.pressablecdn.com/wp-content/uploads/2018/07/book-ch2-200w.png" /></a><p><a href="https://www.schneier.com/books/">More Books</a></p></div></section><section><div class="sidesection widget widget_schneier_promotion" id="schneier_promotion-2">
<a href="https://www.eff.org/issues/bloggers/legal/join">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png" id="effbutton" alt="Support Bloggers' Rights!" title="Support Bloggers' Rights!" /></a>

<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252">
	<img src="https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png" alt="Defend Privacy--Support Epic" title="Defend Privacy--Support Epic" /></a>
</div></section>	</div>
</aside>

		<footer>
			<nav>
				<div class="nav" id="footer-nav">
					<div class="menu-main-menu-container"><ul id="menu-main-menu-1" class="menu"><li class="menu1 menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-50175 current-menu-item"><a href="https://www.schneier.com">Blog</a></li>
<li class="menu2 menu-item menu-item-type-post_type menu-item-object-page menu-item-50916"><a href="https://www.schneier.com/crypto-gram/">Newsletter</a></li>
<li class="menu3 menu-item menu-item-type-post_type menu-item-object-page menu-item-50166"><a href="https://www.schneier.com/books/">Books</a></li>
<li class="menu4 menu-item menu-item-type-custom menu-item-object-custom menu-item-50169"><a href="https://www.schneier.com/essays/">Essays</a></li>
<li class="menu5 menu-item menu-item-type-custom menu-item-object-custom menu-item-50170"><a href="https://www.schneier.com/news/">News</a></li>
<li class="menu6 menu-item menu-item-type-custom menu-item-object-custom menu-item-50171"><a href="https://www.schneier.com/talks/">Talks</a></li>
<li class="menu7 menu-item menu-item-type-post_type menu-item-object-page menu-item-50167"><a href="https://www.schneier.com/academic/">Academic</a></li>
<li class="menu8 menu-item menu-item-type-post_type menu-item-object-page menu-item-50174"><a href="https://www.schneier.com/blog/about/">About Me</a></li>
</ul></div>				</div>
			</nav>
		</footer>

		</div><!--#main-->
	</div><!--#wrapper-->

		<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	<script type='text/javascript' src='https://c0.wp.com/p/woocommerce/5.1.0/assets/js/jquery-cookie/jquery.cookie.min.js' id='jquery-cookie-js'></script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/socialshareprivacy.js?ver=1.0.1' id='social-share-privacy-js'></script>
<script type='text/javascript' id='social-share-privacy-icons-js-extra'>
/* <![CDATA[ */
var schneierSocial = {"path":"https:\/\/www.schneier.com\/wp-content\/themes\/schneier\/assets\/vendor\/socialshareprivacy\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/vendor/socialshareprivacy/js/icons.js?ver=1.0.0' id='social-share-privacy-icons-js'></script>
<script type='text/javascript' id='schneier-comment-js-extra'>
/* <![CDATA[ */
var schneierComment = {"translateErrorSecurityAnswerWrong":"Your response to the challenge question ('The name of this blog is Schneier on ____') was not correct. Please try again.","ajax_url":"https:\/\/www.schneier.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/js/comment.js?ver=1.0.1' id='schneier-comment-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>

</body>

</html>
